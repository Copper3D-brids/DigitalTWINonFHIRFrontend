(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function r(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(n){if(n.ep)return;n.ep=!0;const a=r(n);fetch(n.href,a)}})();/**
* @vue/shared v3.4.31
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function uT(e,t){const r=new Set(e.split(","));return i=>r.has(i)}const wi={},Xf=[],Io=()=>{},aG=()=>!1,U1=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),dT=e=>e.startsWith("onUpdate:"),Ki=Object.assign,hT=(e,t)=>{const r=e.indexOf(t);r>-1&&e.splice(r,1)},oG=Object.prototype.hasOwnProperty,Br=(e,t)=>oG.call(e,t),Zt=Array.isArray,Kf=e=>j1(e)==="[object Map]",l5=e=>j1(e)==="[object Set]",dr=e=>typeof e=="function",Qi=e=>typeof e=="string",ju=e=>typeof e=="symbol",yi=e=>e!==null&&typeof e=="object",c5=e=>(yi(e)||dr(e))&&dr(e.then)&&dr(e.catch),u5=Object.prototype.toString,j1=e=>u5.call(e),sG=e=>j1(e).slice(8,-1),d5=e=>j1(e)==="[object Object]",fT=e=>Qi(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,Ev=uT(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),V1=e=>{const t=Object.create(null);return r=>t[r]||(t[r]=e(r))},lG=/-(\w)/g,dl=V1(e=>e.replace(lG,(t,r)=>r?r.toUpperCase():"")),cG=/\B([A-Z])/g,Xp=V1(e=>e.replace(cG,"-$1").toLowerCase()),H1=V1(e=>e.charAt(0).toUpperCase()+e.slice(1)),Jw=V1(e=>e?`on${H1(e)}`:""),Du=(e,t)=>!Object.is(e,t),eS=(e,...t)=>{for(let r=0;r<e.length;r++)e[r](...t)},h5=(e,t,r,i=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:i,value:r})},uG=e=>{const t=parseFloat(e);return isNaN(t)?e:t},dG=e=>{const t=Qi(e)?Number(e):NaN;return isNaN(t)?e:t};let S3;const f5=()=>S3||(S3=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function yp(e){if(Zt(e)){const t={};for(let r=0;r<e.length;r++){const i=e[r],n=Qi(i)?mG(i):yp(i);if(n)for(const a in n)t[a]=n[a]}return t}else if(Qi(e)||yi(e))return e}const hG=/;(?![^(]*\))/g,fG=/:([^]+)/,pG=/\/\*[^]*?\*\//g;function mG(e){const t={};return e.replace(pG,"").split(hG).forEach(r=>{if(r){const i=r.split(fG);i.length>1&&(t[i[0].trim()]=i[1].trim())}}),t}function Bo(e){let t="";if(Qi(e))t=e;else if(Zt(e))for(let r=0;r<e.length;r++){const i=Bo(e[r]);i&&(t+=i+" ")}else if(yi(e))for(const r in e)e[r]&&(t+=r+" ");return t.trim()}const vG="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",gG=uT(vG);function p5(e){return!!e||e===""}const m5=e=>!!(e&&e.__v_isRef===!0),vi=e=>Qi(e)?e:e==null?"":Zt(e)||yi(e)&&(e.toString===u5||!dr(e.toString))?m5(e)?vi(e.value):JSON.stringify(e,v5,2):String(e),v5=(e,t)=>m5(t)?v5(e,t.value):Kf(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((r,[i,n],a)=>(r[tS(i,a)+" =>"]=n,r),{})}:l5(t)?{[`Set(${t.size})`]:[...t.values()].map(r=>tS(r))}:ju(t)?tS(t):yi(t)&&!Zt(t)&&!d5(t)?String(t):t,tS=(e,t="")=>{var r;return ju(e)?`Symbol(${(r=e.description)!=null?r:t})`:e};/**
* @vue/reactivity v3.4.31
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let fo;class g5{constructor(t=!1){this.detached=t,this._active=!0,this.effects=[],this.cleanups=[],this.parent=fo,!t&&fo&&(this.index=(fo.scopes||(fo.scopes=[])).push(this)-1)}get active(){return this._active}run(t){if(this._active){const r=fo;try{return fo=this,t()}finally{fo=r}}}on(){fo=this}off(){fo=this.parent}stop(t){if(this._active){let r,i;for(r=0,i=this.effects.length;r<i;r++)this.effects[r].stop();for(r=0,i=this.cleanups.length;r<i;r++)this.cleanups[r]();if(this.scopes)for(r=0,i=this.scopes.length;r<i;r++)this.scopes[r].stop(!0);if(!this.detached&&this.parent&&!t){const n=this.parent.scopes.pop();n&&n!==this&&(this.parent.scopes[this.index]=n,n.index=this.index)}this.parent=void 0,this._active=!1}}}function y5(e){return new g5(e)}function yG(e,t=fo){t&&t.active&&t.effects.push(e)}function b5(){return fo}function bG(e){fo&&fo.cleanups.push(e)}let Wd;class pT{constructor(t,r,i,n){this.fn=t,this.trigger=r,this.scheduler=i,this.active=!0,this.deps=[],this._dirtyLevel=4,this._trackId=0,this._runnings=0,this._shouldSchedule=!1,this._depsLength=0,yG(this,n)}get dirty(){if(this._dirtyLevel===2||this._dirtyLevel===3){this._dirtyLevel=1,Vu();for(let t=0;t<this._depsLength;t++){const r=this.deps[t];if(r.computed&&(xG(r.computed),this._dirtyLevel>=4))break}this._dirtyLevel===1&&(this._dirtyLevel=0),Hu()}return this._dirtyLevel>=4}set dirty(t){this._dirtyLevel=t?4:0}run(){if(this._dirtyLevel=0,!this.active)return this.fn();let t=xu,r=Wd;try{return xu=!0,Wd=this,this._runnings++,C3(this),this.fn()}finally{_3(this),this._runnings--,Wd=r,xu=t}}stop(){this.active&&(C3(this),_3(this),this.onStop&&this.onStop(),this.active=!1)}}function xG(e){return e.value}function C3(e){e._trackId++,e._depsLength=0}function _3(e){if(e.deps.length>e._depsLength){for(let t=e._depsLength;t<e.deps.length;t++)x5(e.deps[t],e);e.deps.length=e._depsLength}}function x5(e,t){const r=e.get(t);r!==void 0&&t._trackId!==r&&(e.delete(t),e.size===0&&e.cleanup())}let xu=!0,h2=0;const w5=[];function Vu(){w5.push(xu),xu=!1}function Hu(){const e=w5.pop();xu=e===void 0?!0:e}function mT(){h2++}function vT(){for(h2--;!h2&&f2.length;)f2.shift()()}function S5(e,t,r){if(t.get(e)!==e._trackId){t.set(e,e._trackId);const i=e.deps[e._depsLength];i!==t?(i&&x5(i,e),e.deps[e._depsLength++]=t):e._depsLength++}}const f2=[];function C5(e,t,r){mT();for(const i of e.keys()){let n;i._dirtyLevel<t&&(n??(n=e.get(i)===i._trackId))&&(i._shouldSchedule||(i._shouldSchedule=i._dirtyLevel===0),i._dirtyLevel=t),i._shouldSchedule&&(n??(n=e.get(i)===i._trackId))&&(i.trigger(),(!i._runnings||i.allowRecurse)&&i._dirtyLevel!==2&&(i._shouldSchedule=!1,i.scheduler&&f2.push(i.scheduler)))}vT()}const _5=(e,t)=>{const r=new Map;return r.cleanup=e,r.computed=t,r},rx=new WeakMap,Gd=Symbol(""),p2=Symbol("");function ro(e,t,r){if(xu&&Wd){let i=rx.get(e);i||rx.set(e,i=new Map);let n=i.get(r);n||i.set(r,n=_5(()=>i.delete(r))),S5(Wd,n)}}function nc(e,t,r,i,n,a){const o=rx.get(e);if(!o)return;let s=[];if(t==="clear")s=[...o.values()];else if(r==="length"&&Zt(e)){const l=Number(i);o.forEach((c,u)=>{(u==="length"||!ju(u)&&u>=l)&&s.push(c)})}else switch(r!==void 0&&s.push(o.get(r)),t){case"add":Zt(e)?fT(r)&&s.push(o.get("length")):(s.push(o.get(Gd)),Kf(e)&&s.push(o.get(p2)));break;case"delete":Zt(e)||(s.push(o.get(Gd)),Kf(e)&&s.push(o.get(p2)));break;case"set":Kf(e)&&s.push(o.get(Gd));break}mT();for(const l of s)l&&C5(l,4);vT()}function wG(e,t){const r=rx.get(e);return r&&r.get(t)}const SG=uT("__proto__,__v_isRef,__isVue"),A5=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(ju)),A3=CG();function CG(){const e={};return["includes","indexOf","lastIndexOf"].forEach(t=>{e[t]=function(...r){const i=Sr(this);for(let a=0,o=this.length;a<o;a++)ro(i,"get",a+"");const n=i[t](...r);return n===-1||n===!1?i[t](...r.map(Sr)):n}}),["push","pop","shift","unshift","splice"].forEach(t=>{e[t]=function(...r){Vu(),mT();const i=Sr(this)[t].apply(this,r);return vT(),Hu(),i}}),e}function _G(e){ju(e)||(e=String(e));const t=Sr(this);return ro(t,"has",e),t.hasOwnProperty(e)}class M5{constructor(t=!1,r=!1){this._isReadonly=t,this._isShallow=r}get(t,r,i){const n=this._isReadonly,a=this._isShallow;if(r==="__v_isReactive")return!n;if(r==="__v_isReadonly")return n;if(r==="__v_isShallow")return a;if(r==="__v_raw")return i===(n?a?BG:D5:a?P5:T5).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(i)?t:void 0;const o=Zt(t);if(!n){if(o&&Br(A3,r))return Reflect.get(A3,r,i);if(r==="hasOwnProperty")return _G}const s=Reflect.get(t,r,i);return(ju(r)?A5.has(r):SG(r))||(n||ro(t,"get",r),a)?s:Zi(s)?o&&fT(r)?s:s.value:yi(s)?n?bp(s):Wu(s):s}}class E5 extends M5{constructor(t=!1){super(!1,t)}set(t,r,i,n){let a=t[r];if(!this._isShallow){const l=rg(a);if(!ix(i)&&!rg(i)&&(a=Sr(a),i=Sr(i)),!Zt(t)&&Zi(a)&&!Zi(i))return l?!1:(a.value=i,!0)}const o=Zt(t)&&fT(r)?Number(r)<t.length:Br(t,r),s=Reflect.set(t,r,i,n);return t===Sr(n)&&(o?Du(i,a)&&nc(t,"set",r,i):nc(t,"add",r,i)),s}deleteProperty(t,r){const i=Br(t,r);t[r];const n=Reflect.deleteProperty(t,r);return n&&i&&nc(t,"delete",r,void 0),n}has(t,r){const i=Reflect.has(t,r);return(!ju(r)||!A5.has(r))&&ro(t,"has",r),i}ownKeys(t){return ro(t,"iterate",Zt(t)?"length":Gd),Reflect.ownKeys(t)}}class AG extends M5{constructor(t=!1){super(!0,t)}set(t,r){return!0}deleteProperty(t,r){return!0}}const MG=new E5,EG=new AG,TG=new E5(!0);const gT=e=>e,W1=e=>Reflect.getPrototypeOf(e);function O0(e,t,r=!1,i=!1){e=e.__v_raw;const n=Sr(e),a=Sr(t);r||(Du(t,a)&&ro(n,"get",t),ro(n,"get",a));const{has:o}=W1(n),s=i?gT:r?wT:ig;if(o.call(n,t))return s(e.get(t));if(o.call(n,a))return s(e.get(a));e!==n&&e.get(t)}function R0(e,t=!1){const r=this.__v_raw,i=Sr(r),n=Sr(e);return t||(Du(e,n)&&ro(i,"has",e),ro(i,"has",n)),e===n?r.has(e):r.has(e)||r.has(n)}function I0(e,t=!1){return e=e.__v_raw,!t&&ro(Sr(e),"iterate",Gd),Reflect.get(e,"size",e)}function M3(e){e=Sr(e);const t=Sr(this);return W1(t).has.call(t,e)||(t.add(e),nc(t,"add",e,e)),this}function E3(e,t){t=Sr(t);const r=Sr(this),{has:i,get:n}=W1(r);let a=i.call(r,e);a||(e=Sr(e),a=i.call(r,e));const o=n.call(r,e);return r.set(e,t),a?Du(t,o)&&nc(r,"set",e,t):nc(r,"add",e,t),this}function T3(e){const t=Sr(this),{has:r,get:i}=W1(t);let n=r.call(t,e);n||(e=Sr(e),n=r.call(t,e)),i&&i.call(t,e);const a=t.delete(e);return n&&nc(t,"delete",e,void 0),a}function P3(){const e=Sr(this),t=e.size!==0,r=e.clear();return t&&nc(e,"clear",void 0,void 0),r}function z0(e,t){return function(i,n){const a=this,o=a.__v_raw,s=Sr(o),l=t?gT:e?wT:ig;return!e&&ro(s,"iterate",Gd),o.forEach((c,u)=>i.call(n,l(c),l(u),a))}}function k0(e,t,r){return function(...i){const n=this.__v_raw,a=Sr(n),o=Kf(a),s=e==="entries"||e===Symbol.iterator&&o,l=e==="keys"&&o,c=n[e](...i),u=r?gT:t?wT:ig;return!t&&ro(a,"iterate",l?p2:Gd),{next(){const{value:d,done:h}=c.next();return h?{value:d,done:h}:{value:s?[u(d[0]),u(d[1])]:u(d),done:h}},[Symbol.iterator](){return this}}}}function Tc(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function PG(){const e={get(a){return O0(this,a)},get size(){return I0(this)},has:R0,add:M3,set:E3,delete:T3,clear:P3,forEach:z0(!1,!1)},t={get(a){return O0(this,a,!1,!0)},get size(){return I0(this)},has:R0,add:M3,set:E3,delete:T3,clear:P3,forEach:z0(!1,!0)},r={get(a){return O0(this,a,!0)},get size(){return I0(this,!0)},has(a){return R0.call(this,a,!0)},add:Tc("add"),set:Tc("set"),delete:Tc("delete"),clear:Tc("clear"),forEach:z0(!0,!1)},i={get(a){return O0(this,a,!0,!0)},get size(){return I0(this,!0)},has(a){return R0.call(this,a,!0)},add:Tc("add"),set:Tc("set"),delete:Tc("delete"),clear:Tc("clear"),forEach:z0(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(a=>{e[a]=k0(a,!1,!1),r[a]=k0(a,!0,!1),t[a]=k0(a,!1,!0),i[a]=k0(a,!0,!0)}),[e,r,t,i]}const[DG,OG,RG,IG]=PG();function yT(e,t){const r=t?e?IG:RG:e?OG:DG;return(i,n,a)=>n==="__v_isReactive"?!e:n==="__v_isReadonly"?e:n==="__v_raw"?i:Reflect.get(Br(r,n)&&n in i?r:i,n,a)}const zG={get:yT(!1,!1)},kG={get:yT(!1,!0)},LG={get:yT(!0,!1)};const T5=new WeakMap,P5=new WeakMap,D5=new WeakMap,BG=new WeakMap;function FG(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function NG(e){return e.__v_skip||!Object.isExtensible(e)?0:FG(sG(e))}function Wu(e){return rg(e)?e:bT(e,!1,MG,zG,T5)}function O5(e){return bT(e,!1,TG,kG,P5)}function bp(e){return bT(e,!0,EG,LG,D5)}function bT(e,t,r,i,n){if(!yi(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const a=n.get(e);if(a)return a;const o=NG(e);if(o===0)return e;const s=new Proxy(e,o===2?i:r);return n.set(e,s),s}function wu(e){return rg(e)?wu(e.__v_raw):!!(e&&e.__v_isReactive)}function rg(e){return!!(e&&e.__v_isReadonly)}function ix(e){return!!(e&&e.__v_isShallow)}function Tv(e){return e?!!e.__v_raw:!1}function Sr(e){const t=e&&e.__v_raw;return t?Sr(t):e}function xT(e){return Object.isExtensible(e)&&h5(e,"__v_skip",!0),e}const ig=e=>yi(e)?Wu(e):e,wT=e=>yi(e)?bp(e):e;class R5{constructor(t,r,i,n){this.getter=t,this._setter=r,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this.effect=new pT(()=>t(this._value),()=>Tb(this,this.effect._dirtyLevel===2?2:3)),this.effect.computed=this,this.effect.active=this._cacheable=!n,this.__v_isReadonly=i}get value(){const t=Sr(this);return(!t._cacheable||t.effect.dirty)&&Du(t._value,t._value=t.effect.run())&&Tb(t,4),I5(t),t.effect._dirtyLevel>=2&&Tb(t,2),t._value}set value(t){this._setter(t)}get _dirty(){return this.effect.dirty}set _dirty(t){this.effect.dirty=t}}function UG(e,t,r=!1){let i,n;const a=dr(e);return a?(i=e,n=Io):(i=e.get,n=e.set),new R5(i,n,a||!n,r)}function I5(e){var t;xu&&Wd&&(e=Sr(e),S5(Wd,(t=e.dep)!=null?t:e.dep=_5(()=>e.dep=void 0,e instanceof R5?e:void 0)))}function Tb(e,t=4,r,i){e=Sr(e);const n=e.dep;n&&C5(n,t)}function Zi(e){return!!(e&&e.__v_isRef===!0)}function me(e){return k5(e,!1)}function z5(e){return k5(e,!0)}function k5(e,t){return Zi(e)?e:new jG(e,t)}class jG{constructor(t,r){this.__v_isShallow=r,this.dep=void 0,this.__v_isRef=!0,this._rawValue=r?t:Sr(t),this._value=r?t:ig(t)}get value(){return I5(this),this._value}set value(t){const r=this.__v_isShallow||ix(t)||rg(t);t=r?t:Sr(t),Du(t,this._rawValue)&&(this._rawValue,this._rawValue=t,this._value=r?t:ig(t),Tb(this,4))}}function ze(e){return Zi(e)?e.value:e}const VG={get:(e,t,r)=>ze(Reflect.get(e,t,r)),set:(e,t,r,i)=>{const n=e[t];return Zi(n)&&!Zi(r)?(n.value=r,!0):Reflect.set(e,t,r,i)}};function L5(e){return wu(e)?e:new Proxy(e,VG)}function B5(e){const t=Zt(e)?new Array(e.length):{};for(const r in e)t[r]=F5(e,r);return t}class HG{constructor(t,r,i){this._object=t,this._key=r,this._defaultValue=i,this.__v_isRef=!0}get value(){const t=this._object[this._key];return t===void 0?this._defaultValue:t}set value(t){this._object[this._key]=t}get dep(){return wG(Sr(this._object),this._key)}}class WG{constructor(t){this._getter=t,this.__v_isRef=!0,this.__v_isReadonly=!0}get value(){return this._getter()}}function pt(e,t,r){return Zi(e)?e:dr(e)?new WG(e):yi(e)&&arguments.length>1?F5(e,t,r):me(e)}function F5(e,t,r){const i=e[t];return Zi(i)?i:new HG(e,t,r)}/**
* @vue/runtime-core v3.4.31
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Su(e,t,r,i){try{return i?e(...i):e()}catch(n){G1(n,t,r)}}function Fo(e,t,r,i){if(dr(e)){const n=Su(e,t,r,i);return n&&c5(n)&&n.catch(a=>{G1(a,t,r)}),n}if(Zt(e)){const n=[];for(let a=0;a<e.length;a++)n.push(Fo(e[a],t,r,i));return n}}function G1(e,t,r,i=!0){const n=t?t.vnode:null;if(t){let a=t.parent;const o=t.proxy,s=`https://vuejs.org/error-reference/#runtime-${r}`;for(;a;){const c=a.ec;if(c){for(let u=0;u<c.length;u++)if(c[u](e,o,s)===!1)return}a=a.parent}const l=t.appContext.config.errorHandler;if(l){Vu(),Su(l,null,10,[e,o,s]),Hu();return}}GG(e,r,n,i)}function GG(e,t,r,i=!0){console.error(e)}let ng=!1,m2=!1;const ma=[];let Ys=0;const Qf=[];let Zc=null,wd=0;const N5=Promise.resolve();let ST=null;function aa(e){const t=ST||N5;return e?t.then(this?e.bind(this):e):t}function $G(e){let t=Ys+1,r=ma.length;for(;t<r;){const i=t+r>>>1,n=ma[i],a=ag(n);a<e||a===e&&n.pre?t=i+1:r=i}return t}function CT(e){(!ma.length||!ma.includes(e,ng&&e.allowRecurse?Ys+1:Ys))&&(e.id==null?ma.push(e):ma.splice($G(e.id),0,e),U5())}function U5(){!ng&&!m2&&(m2=!0,ST=N5.then(V5))}function qG(e){const t=ma.indexOf(e);t>Ys&&ma.splice(t,1)}function YG(e){Zt(e)?Qf.push(...e):(!Zc||!Zc.includes(e,e.allowRecurse?wd+1:wd))&&Qf.push(e),U5()}function D3(e,t,r=ng?Ys+1:0){for(;r<ma.length;r++){const i=ma[r];if(i&&i.pre){if(e&&i.id!==e.uid)continue;ma.splice(r,1),r--,i()}}}function j5(e){if(Qf.length){const t=[...new Set(Qf)].sort((r,i)=>ag(r)-ag(i));if(Qf.length=0,Zc){Zc.push(...t);return}for(Zc=t,wd=0;wd<Zc.length;wd++){const r=Zc[wd];r.active!==!1&&r()}Zc=null,wd=0}}const ag=e=>e.id==null?1/0:e.id,XG=(e,t)=>{const r=ag(e)-ag(t);if(r===0){if(e.pre&&!t.pre)return-1;if(t.pre&&!e.pre)return 1}return r};function V5(e){m2=!1,ng=!0,ma.sort(XG);try{for(Ys=0;Ys<ma.length;Ys++){const t=ma[Ys];t&&t.active!==!1&&Su(t,null,14)}}finally{Ys=0,ma.length=0,j5(),ng=!1,ST=null,(ma.length||Qf.length)&&V5()}}function KG(e,t,...r){if(e.isUnmounted)return;const i=e.vnode.props||wi;let n=r;const a=t.startsWith("update:"),o=a&&t.slice(7);if(o&&o in i){const u=`${o==="modelValue"?"model":o}Modifiers`,{number:d,trim:h}=i[u]||wi;h&&(n=r.map(f=>Qi(f)?f.trim():f)),d&&(n=r.map(uG))}let s,l=i[s=Jw(t)]||i[s=Jw(dl(t))];!l&&a&&(l=i[s=Jw(Xp(t))]),l&&Fo(l,e,6,n);const c=i[s+"Once"];if(c){if(!e.emitted)e.emitted={};else if(e.emitted[s])return;e.emitted[s]=!0,Fo(c,e,6,n)}}function H5(e,t,r=!1){const i=t.emitsCache,n=i.get(e);if(n!==void 0)return n;const a=e.emits;let o={},s=!1;if(!dr(e)){const l=c=>{const u=H5(c,t,!0);u&&(s=!0,Ki(o,u))};!r&&t.mixins.length&&t.mixins.forEach(l),e.extends&&l(e.extends),e.mixins&&e.mixins.forEach(l)}return!a&&!s?(yi(e)&&i.set(e,null),null):(Zt(a)?a.forEach(l=>o[l]=null):Ki(o,a),yi(e)&&i.set(e,o),o)}function $1(e,t){return!e||!U1(t)?!1:(t=t.slice(2).replace(/Once$/,""),Br(e,t[0].toLowerCase()+t.slice(1))||Br(e,Xp(t))||Br(e,t))}let wn=null,q1=null;function nx(e){const t=wn;return wn=e,q1=e&&e.type.__scopeId||null,t}function Y1(e){q1=e}function X1(){q1=null}function Je(e,t=wn,r){if(!t||e._n)return e;const i=(...n)=>{i._d&&G3(-1);const a=nx(t);let o;try{o=e(...n)}finally{nx(a),i._d&&G3(1)}return o};return i._n=!0,i._c=!0,i._d=!0,i}function rS(e){const{type:t,vnode:r,proxy:i,withProxy:n,propsOptions:[a],slots:o,attrs:s,emit:l,render:c,renderCache:u,props:d,data:h,setupState:f,ctx:p,inheritAttrs:v}=e,m=nx(e);let g,y;try{if(r.shapeFlag&4){const x=n||i,S=x;g=Gs(c.call(S,x,u,d,f,h,p)),y=s}else{const x=t;g=Gs(x.length>1?x(d,{attrs:s,slots:o,emit:l}):x(d,null)),y=t.props?s:QG(s)}}catch(x){Rv.length=0,G1(x,e,1),g=Le(zn)}let b=g;if(y&&v!==!1){const x=Object.keys(y),{shapeFlag:S}=b;x.length&&S&7&&(a&&x.some(dT)&&(y=ZG(y,a)),b=hl(b,y,!1,!0))}return r.dirs&&(b=hl(b,null,!1,!0),b.dirs=b.dirs?b.dirs.concat(r.dirs):r.dirs),r.transition&&(b.transition=r.transition),g=b,nx(m),g}const QG=e=>{let t;for(const r in e)(r==="class"||r==="style"||U1(r))&&((t||(t={}))[r]=e[r]);return t},ZG=(e,t)=>{const r={};for(const i in e)(!dT(i)||!(i.slice(9)in t))&&(r[i]=e[i]);return r};function JG(e,t,r){const{props:i,children:n,component:a}=e,{props:o,children:s,patchFlag:l}=t,c=a.emitsOptions;if(t.dirs||t.transition)return!0;if(r&&l>=0){if(l&1024)return!0;if(l&16)return i?O3(i,o,c):!!o;if(l&8){const u=t.dynamicProps;for(let d=0;d<u.length;d++){const h=u[d];if(o[h]!==i[h]&&!$1(c,h))return!0}}}else return(n||s)&&(!s||!s.$stable)?!0:i===o?!1:i?o?O3(i,o,c):!0:!!o;return!1}function O3(e,t,r){const i=Object.keys(t);if(i.length!==Object.keys(e).length)return!0;for(let n=0;n<i.length;n++){const a=i[n];if(t[a]!==e[a]&&!$1(r,a))return!0}return!1}function e$({vnode:e,parent:t},r){for(;t;){const i=t.subTree;if(i.suspense&&i.suspense.activeBranch===e&&(i.el=e.el),i===e)(e=t.vnode).el=r,t=t.parent;else break}}const t$="components";function Gu(e,t){return i$(t$,e,!0,t)||e}const r$=Symbol.for("v-ndc");function i$(e,t,r=!0,i=!1){const n=wn||kn;if(n){const a=n.type;{const s=X$(a,!1);if(s&&(s===t||s===dl(t)||s===H1(dl(t))))return a}const o=R3(n[e]||a[e],t)||R3(n.appContext[e],t);return!o&&i?a:o}}function R3(e,t){return e&&(e[t]||e[dl(t)]||e[H1(dl(t))])}const n$=e=>e.__isSuspense;function a$(e,t){t&&t.pendingBranch?Zt(e)?t.effects.push(...e):t.effects.push(e):YG(e)}function K1(e,t,r=kn,i=!1){if(r){const n=r[e]||(r[e]=[]),a=t.__weh||(t.__weh=(...o)=>{Vu();const s=Jg(r),l=Fo(t,r,e,o);return s(),Hu(),l});return i?n.unshift(a):n.push(a),a}}const yc=e=>(t,r=kn)=>{(!J1||e==="sp")&&K1(e,(...i)=>t(...i),r)},Kg=yc("bm"),Or=yc("m"),o$=yc("bu"),W5=yc("u"),la=yc("bum"),Qg=yc("um"),s$=yc("sp"),l$=yc("rtg"),c$=yc("rtc");function u$(e,t=kn){K1("ec",e,t)}function io(e,t){if(wn===null)return e;const r=ew(wn),i=e.dirs||(e.dirs=[]);for(let n=0;n<t.length;n++){let[a,o,s,l=wi]=t[n];a&&(dr(a)&&(a={mounted:a,updated:a}),a.deep&&au(o),i.push({dir:a,instance:r,value:o,oldValue:void 0,arg:s,modifiers:l}))}return e}function ed(e,t,r,i){const n=e.dirs,a=t&&t.dirs;for(let o=0;o<n.length;o++){const s=n[o];a&&(s.oldValue=a[o].value);let l=s.dir[i];l&&(Vu(),Fo(l,r,8,[e.el,s,e,t]),Hu())}}function vs(e,t,r,i){let n;const a=r;if(Zt(e)||Qi(e)){n=new Array(e.length);for(let o=0,s=e.length;o<s;o++)n[o]=t(e[o],o,void 0,a)}else if(typeof e=="number"){n=new Array(e);for(let o=0;o<e;o++)n[o]=t(o+1,o,void 0,a)}else if(yi(e))if(e[Symbol.iterator])n=Array.from(e,(o,s)=>t(o,s,void 0,a));else{const o=Object.keys(e);n=new Array(o.length);for(let s=0,l=o.length;s<l;s++){const c=o[s];n[s]=t(e[c],c,s,a)}}else n=[];return n}function d$(e,t){for(let r=0;r<t.length;r++){const i=t[r];if(Zt(i))for(let n=0;n<i.length;n++)e[i[n].name]=i[n].fn;else i&&(e[i.name]=i.key?(...n)=>{const a=i.fn(...n);return a&&(a.key=i.key),a}:i.fn)}return e}/*! #__NO_SIDE_EFFECTS__ */function je(e,t){return dr(e)?Ki({name:e.name},t,{setup:e}):e}const Pv=e=>!!e.type.__asyncLoader;function gs(e,t,r={},i,n){if(wn.isCE||wn.parent&&Pv(wn.parent)&&wn.parent.isCE)return t!=="default"&&(r.name=t),Le("slot",r,i);let a=e[t];a&&a._c&&(a._d=!1),ht();const o=a&&G5(a(r)),s=Ci(mr,{key:r.key||o&&o.key||`_${t}`},o||[],o&&e._===1?64:-2);return!n&&s.scopeId&&(s.slotScopeIds=[s.scopeId+"-s"]),a&&a._c&&(a._d=!0),s}function G5(e){return e.some(t=>lg(t)?!(t.type===zn||t.type===mr&&!G5(t.children)):!0)?e:null}const v2=e=>e?fN(e)?ew(e):v2(e.parent):null,Dv=Ki(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>v2(e.parent),$root:e=>v2(e.root),$emit:e=>e.emit,$options:e=>_T(e),$forceUpdate:e=>e.f||(e.f=()=>{e.effect.dirty=!0,CT(e.update)}),$nextTick:e=>e.n||(e.n=aa.bind(e.proxy)),$watch:e=>R$.bind(e)}),iS=(e,t)=>e!==wi&&!e.__isScriptSetup&&Br(e,t),h$={get({_:e},t){if(t==="__v_skip")return!0;const{ctx:r,setupState:i,data:n,props:a,accessCache:o,type:s,appContext:l}=e;let c;if(t[0]!=="$"){const f=o[t];if(f!==void 0)switch(f){case 1:return i[t];case 2:return n[t];case 4:return r[t];case 3:return a[t]}else{if(iS(i,t))return o[t]=1,i[t];if(n!==wi&&Br(n,t))return o[t]=2,n[t];if((c=e.propsOptions[0])&&Br(c,t))return o[t]=3,a[t];if(r!==wi&&Br(r,t))return o[t]=4,r[t];g2&&(o[t]=0)}}const u=Dv[t];let d,h;if(u)return t==="$attrs"&&ro(e.attrs,"get",""),u(e);if((d=s.__cssModules)&&(d=d[t]))return d;if(r!==wi&&Br(r,t))return o[t]=4,r[t];if(h=l.config.globalProperties,Br(h,t))return h[t]},set({_:e},t,r){const{data:i,setupState:n,ctx:a}=e;return iS(n,t)?(n[t]=r,!0):i!==wi&&Br(i,t)?(i[t]=r,!0):Br(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(a[t]=r,!0)},has({_:{data:e,setupState:t,accessCache:r,ctx:i,appContext:n,propsOptions:a}},o){let s;return!!r[o]||e!==wi&&Br(e,o)||iS(t,o)||(s=a[0])&&Br(s,o)||Br(i,o)||Br(Dv,o)||Br(n.config.globalProperties,o)},defineProperty(e,t,r){return r.get!=null?e._.accessCache[t]=0:Br(r,"value")&&this.set(e,t,r.value,null),Reflect.defineProperty(e,t,r)}};function I3(e){return Zt(e)?e.reduce((t,r)=>(t[r]=null,t),{}):e}let g2=!0;function f$(e){const t=_T(e),r=e.proxy,i=e.ctx;g2=!1,t.beforeCreate&&z3(t.beforeCreate,e,"bc");const{data:n,computed:a,methods:o,watch:s,provide:l,inject:c,created:u,beforeMount:d,mounted:h,beforeUpdate:f,updated:p,activated:v,deactivated:m,beforeDestroy:g,beforeUnmount:y,destroyed:b,unmounted:x,render:S,renderTracked:w,renderTriggered:_,errorCaptured:C,serverPrefetch:A,expose:M,inheritAttrs:P,components:T,directives:R,filters:z}=t;if(c&&p$(c,i,null),o)for(const N in o){const U=o[N];dr(U)&&(i[N]=U.bind(r))}if(n){const N=n.call(r,r);yi(N)&&(e.data=Wu(N))}if(g2=!0,a)for(const N in a){const U=a[N],ie=dr(U)?U.bind(r,r):dr(U.get)?U.get.bind(r,r):Io,te=!dr(U)&&dr(U.set)?U.set.bind(r):Io,X=re({get:ie,set:te});Object.defineProperty(i,N,{enumerable:!0,configurable:!0,get:()=>X.value,set:W=>X.value=W})}if(s)for(const N in s)$5(s[N],i,r,N);if(l){const N=dr(l)?l.call(r):l;Reflect.ownKeys(N).forEach(U=>{xr(U,N[U])})}u&&z3(u,e,"c");function H(N,U){Zt(U)?U.forEach(ie=>N(ie.bind(r))):U&&N(U.bind(r))}if(H(Kg,d),H(Or,h),H(o$,f),H(W5,p),H(TT,v),H(PT,m),H(u$,C),H(c$,w),H(l$,_),H(la,y),H(Qg,x),H(s$,A),Zt(M))if(M.length){const N=e.exposed||(e.exposed={});M.forEach(U=>{Object.defineProperty(N,U,{get:()=>r[U],set:ie=>r[U]=ie})})}else e.exposed||(e.exposed={});S&&e.render===Io&&(e.render=S),P!=null&&(e.inheritAttrs=P),T&&(e.components=T),R&&(e.directives=R)}function p$(e,t,r=Io){Zt(e)&&(e=y2(e));for(const i in e){const n=e[i];let a;yi(n)?"default"in n?a=_t(n.from||i,n.default,!0):a=_t(n.from||i):a=_t(n),Zi(a)?Object.defineProperty(t,i,{enumerable:!0,configurable:!0,get:()=>a.value,set:o=>a.value=o}):t[i]=a}}function z3(e,t,r){Fo(Zt(e)?e.map(i=>i.bind(t.proxy)):e.bind(t.proxy),t,r)}function $5(e,t,r,i){const n=i.includes(".")?iN(r,i):()=>r[i];if(Qi(e)){const a=t[e];dr(a)&&rr(n,a)}else if(dr(e))rr(n,e.bind(r));else if(yi(e))if(Zt(e))e.forEach(a=>$5(a,t,r,i));else{const a=dr(e.handler)?e.handler.bind(r):t[e.handler];dr(a)&&rr(n,a,e)}}function _T(e){const t=e.type,{mixins:r,extends:i}=t,{mixins:n,optionsCache:a,config:{optionMergeStrategies:o}}=e.appContext,s=a.get(t);let l;return s?l=s:!n.length&&!r&&!i?l=t:(l={},n.length&&n.forEach(c=>ax(l,c,o,!0)),ax(l,t,o)),yi(t)&&a.set(t,l),l}function ax(e,t,r,i=!1){const{mixins:n,extends:a}=t;a&&ax(e,a,r,!0),n&&n.forEach(o=>ax(e,o,r,!0));for(const o in t)if(!(i&&o==="expose")){const s=m$[o]||r&&r[o];e[o]=s?s(e[o],t[o]):t[o]}return e}const m$={data:k3,props:L3,emits:L3,methods:hv,computed:hv,beforeCreate:Ea,created:Ea,beforeMount:Ea,mounted:Ea,beforeUpdate:Ea,updated:Ea,beforeDestroy:Ea,beforeUnmount:Ea,destroyed:Ea,unmounted:Ea,activated:Ea,deactivated:Ea,errorCaptured:Ea,serverPrefetch:Ea,components:hv,directives:hv,watch:g$,provide:k3,inject:v$};function k3(e,t){return t?e?function(){return Ki(dr(e)?e.call(this,this):e,dr(t)?t.call(this,this):t)}:t:e}function v$(e,t){return hv(y2(e),y2(t))}function y2(e){if(Zt(e)){const t={};for(let r=0;r<e.length;r++)t[e[r]]=e[r];return t}return e}function Ea(e,t){return e?[...new Set([].concat(e,t))]:t}function hv(e,t){return e?Ki(Object.create(null),e,t):t}function L3(e,t){return e?Zt(e)&&Zt(t)?[...new Set([...e,...t])]:Ki(Object.create(null),I3(e),I3(t??{})):t}function g$(e,t){if(!e)return t;if(!t)return e;const r=Ki(Object.create(null),e);for(const i in t)r[i]=Ea(e[i],t[i]);return r}function q5(){return{app:null,config:{isNativeTag:aG,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let y$=0;function b$(e,t){return function(i,n=null){dr(i)||(i=Ki({},i)),n!=null&&!yi(n)&&(n=null);const a=q5(),o=new WeakSet;let s=!1;const l=a.app={_uid:y$++,_component:i,_props:n,_container:null,_context:a,_instance:null,version:Q$,get config(){return a.config},set config(c){},use(c,...u){return o.has(c)||(c&&dr(c.install)?(o.add(c),c.install(l,...u)):dr(c)&&(o.add(c),c(l,...u))),l},mixin(c){return a.mixins.includes(c)||a.mixins.push(c),l},component(c,u){return u?(a.components[c]=u,l):a.components[c]},directive(c,u){return u?(a.directives[c]=u,l):a.directives[c]},mount(c,u,d){if(!s){const h=Le(i,n);return h.appContext=a,d===!0?d="svg":d===!1&&(d=void 0),u&&t?t(h,c):e(h,c,d),s=!0,l._container=c,c.__vue_app__=l,ew(h.component)}},unmount(){s&&(e(null,l._container),delete l._container.__vue_app__)},provide(c,u){return a.provides[c]=u,l},runWithContext(c){const u=Zf;Zf=l;try{return c()}finally{Zf=u}}};return l}}let Zf=null;function xr(e,t){if(kn){let r=kn.provides;const i=kn.parent&&kn.parent.provides;i===r&&(r=kn.provides=Object.create(i)),r[e]=t}}function _t(e,t,r=!1){const i=kn||wn;if(i||Zf){const n=i?i.parent==null?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides:Zf._context.provides;if(n&&e in n)return n[e];if(arguments.length>1)return r&&dr(t)?t.call(i&&i.proxy):t}}function x$(){return!!(kn||wn||Zf)}const Y5={},X5=()=>Object.create(Y5),K5=e=>Object.getPrototypeOf(e)===Y5;function w$(e,t,r,i=!1){const n={},a=X5();e.propsDefaults=Object.create(null),Q5(e,t,n,a);for(const o in e.propsOptions[0])o in n||(n[o]=void 0);r?e.props=i?n:O5(n):e.type.props?e.props=n:e.props=a,e.attrs=a}function S$(e,t,r,i){const{props:n,attrs:a,vnode:{patchFlag:o}}=e,s=Sr(n),[l]=e.propsOptions;let c=!1;if((i||o>0)&&!(o&16)){if(o&8){const u=e.vnode.dynamicProps;for(let d=0;d<u.length;d++){let h=u[d];if($1(e.emitsOptions,h))continue;const f=t[h];if(l)if(Br(a,h))f!==a[h]&&(a[h]=f,c=!0);else{const p=dl(h);n[p]=b2(l,s,p,f,e,!1)}else f!==a[h]&&(a[h]=f,c=!0)}}}else{Q5(e,t,n,a)&&(c=!0);let u;for(const d in s)(!t||!Br(t,d)&&((u=Xp(d))===d||!Br(t,u)))&&(l?r&&(r[d]!==void 0||r[u]!==void 0)&&(n[d]=b2(l,s,d,void 0,e,!0)):delete n[d]);if(a!==s)for(const d in a)(!t||!Br(t,d))&&(delete a[d],c=!0)}c&&nc(e.attrs,"set","")}function Q5(e,t,r,i){const[n,a]=e.propsOptions;let o=!1,s;if(t)for(let l in t){if(Ev(l))continue;const c=t[l];let u;n&&Br(n,u=dl(l))?!a||!a.includes(u)?r[u]=c:(s||(s={}))[u]=c:$1(e.emitsOptions,l)||(!(l in i)||c!==i[l])&&(i[l]=c,o=!0)}if(a){const l=Sr(r),c=s||wi;for(let u=0;u<a.length;u++){const d=a[u];r[d]=b2(n,l,d,c[d],e,!Br(c,d))}}return o}function b2(e,t,r,i,n,a){const o=e[r];if(o!=null){const s=Br(o,"default");if(s&&i===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&dr(l)){const{propsDefaults:c}=n;if(r in c)i=c[r];else{const u=Jg(n);i=c[r]=l.call(null,t),u()}}else i=l}o[0]&&(a&&!s?i=!1:o[1]&&(i===""||i===Xp(r))&&(i=!0))}return i}function Z5(e,t,r=!1){const i=t.propsCache,n=i.get(e);if(n)return n;const a=e.props,o={},s=[];let l=!1;if(!dr(e)){const u=d=>{l=!0;const[h,f]=Z5(d,t,!0);Ki(o,h),f&&s.push(...f)};!r&&t.mixins.length&&t.mixins.forEach(u),e.extends&&u(e.extends),e.mixins&&e.mixins.forEach(u)}if(!a&&!l)return yi(e)&&i.set(e,Xf),Xf;if(Zt(a))for(let u=0;u<a.length;u++){const d=dl(a[u]);B3(d)&&(o[d]=wi)}else if(a)for(const u in a){const d=dl(u);if(B3(d)){const h=a[u],f=o[d]=Zt(h)||dr(h)?{type:h}:Ki({},h);if(f){const p=U3(Boolean,f.type),v=U3(String,f.type);f[0]=p>-1,f[1]=v<0||p<v,(p>-1||Br(f,"default"))&&s.push(d)}}}const c=[o,s];return yi(e)&&i.set(e,c),c}function B3(e){return e[0]!=="$"&&!Ev(e)}function F3(e){return e===null?"null":typeof e=="function"?e.name||"":typeof e=="object"&&e.constructor&&e.constructor.name||""}function N3(e,t){return F3(e)===F3(t)}function U3(e,t){return Zt(t)?t.findIndex(r=>N3(r,e)):dr(t)&&N3(t,e)?0:-1}const J5=e=>e[0]==="_"||e==="$stable",AT=e=>Zt(e)?e.map(Gs):[Gs(e)],C$=(e,t,r)=>{if(t._n)return t;const i=Je((...n)=>AT(t(...n)),r);return i._c=!1,i},eN=(e,t,r)=>{const i=e._ctx;for(const n in e){if(J5(n))continue;const a=e[n];if(dr(a))t[n]=C$(n,a,i);else if(a!=null){const o=AT(a);t[n]=()=>o}}},tN=(e,t)=>{const r=AT(t);e.slots.default=()=>r},_$=(e,t)=>{const r=e.slots=X5();if(e.vnode.shapeFlag&32){const i=t._;i?(Ki(r,t),h5(r,"_",i,!0)):eN(t,r)}else t&&tN(e,t)},A$=(e,t,r)=>{const{vnode:i,slots:n}=e;let a=!0,o=wi;if(i.shapeFlag&32){const s=t._;s?r&&s===1?a=!1:(Ki(n,t),!r&&s===1&&delete n._):(a=!t.$stable,eN(t,n)),o=t}else t&&(tN(e,t),o={default:1});if(a)for(const s in n)!J5(s)&&o[s]==null&&delete n[s]};function x2(e,t,r,i,n=!1){if(Zt(e)){e.forEach((h,f)=>x2(h,t&&(Zt(t)?t[f]:t),r,i,n));return}if(Pv(i)&&!n)return;const a=i.shapeFlag&4?ew(i.component):i.el,o=n?null:a,{i:s,r:l}=e,c=t&&t.r,u=s.refs===wi?s.refs={}:s.refs,d=s.setupState;if(c!=null&&c!==l&&(Qi(c)?(u[c]=null,Br(d,c)&&(d[c]=null)):Zi(c)&&(c.value=null)),dr(l))Su(l,s,12,[o,u]);else{const h=Qi(l),f=Zi(l);if(h||f){const p=()=>{if(e.f){const v=h?Br(d,l)?d[l]:u[l]:l.value;n?Zt(v)&&hT(v,a):Zt(v)?v.includes(a)||v.push(a):h?(u[l]=[a],Br(d,l)&&(d[l]=u[l])):(l.value=[a],e.k&&(u[e.k]=l.value))}else h?(u[l]=o,Br(d,l)&&(d[l]=o)):f&&(l.value=o,e.k&&(u[e.k]=o))};o?(p.id=-1,Wa(p,r)):p()}}}const Wa=a$;function M$(e){return E$(e)}function E$(e,t){const r=f5();r.__VUE__=!0;const{insert:i,remove:n,patchProp:a,createElement:o,createText:s,createComment:l,setText:c,setElementText:u,parentNode:d,nextSibling:h,setScopeId:f=Io,insertStaticContent:p}=e,v=(G,Z,de,Se=null,we=null,_e=null,Ee=void 0,fe=null,B=!!Z.dynamicChildren)=>{if(G===Z)return;G&&!Sd(G,Z)&&(Se=Q(G),W(G,we,_e,!0),G=null),Z.patchFlag===-2&&(B=!1,Z.dynamicChildren=null);const{type:D,ref:I,shapeFlag:O}=Z;switch(D){case Zg:m(G,Z,de,Se);break;case zn:g(G,Z,de,Se);break;case Pb:G==null&&y(Z,de,Se,Ee);break;case mr:T(G,Z,de,Se,we,_e,Ee,fe,B);break;default:O&1?S(G,Z,de,Se,we,_e,Ee,fe,B):O&6?R(G,Z,de,Se,we,_e,Ee,fe,B):(O&64||O&128)&&D.process(G,Z,de,Se,we,_e,Ee,fe,B,ue)}I!=null&&we&&x2(I,G&&G.ref,_e,Z||G,!Z)},m=(G,Z,de,Se)=>{if(G==null)i(Z.el=s(Z.children),de,Se);else{const we=Z.el=G.el;Z.children!==G.children&&c(we,Z.children)}},g=(G,Z,de,Se)=>{G==null?i(Z.el=l(Z.children||""),de,Se):Z.el=G.el},y=(G,Z,de,Se)=>{[G.el,G.anchor]=p(G.children,Z,de,Se,G.el,G.anchor)},b=({el:G,anchor:Z},de,Se)=>{let we;for(;G&&G!==Z;)we=h(G),i(G,de,Se),G=we;i(Z,de,Se)},x=({el:G,anchor:Z})=>{let de;for(;G&&G!==Z;)de=h(G),n(G),G=de;n(Z)},S=(G,Z,de,Se,we,_e,Ee,fe,B)=>{Z.type==="svg"?Ee="svg":Z.type==="math"&&(Ee="mathml"),G==null?w(Z,de,Se,we,_e,Ee,fe,B):A(G,Z,we,_e,Ee,fe,B)},w=(G,Z,de,Se,we,_e,Ee,fe)=>{let B,D;const{props:I,shapeFlag:O,transition:j,dirs:L}=G;if(B=G.el=o(G.type,_e,I&&I.is,I),O&8?u(B,G.children):O&16&&C(G.children,B,null,Se,we,nS(G,_e),Ee,fe),L&&ed(G,null,Se,"created"),_(B,G,G.scopeId,Ee,Se),I){for(const We in I)We!=="value"&&!Ev(We)&&a(B,We,null,I[We],_e,G.children,Se,we,ee);"value"in I&&a(B,"value",null,I.value,_e),(D=I.onVnodeBeforeMount)&&Ts(D,Se,G)}L&&ed(G,null,Se,"beforeMount");const Ae=T$(we,j);Ae&&j.beforeEnter(B),i(B,Z,de),((D=I&&I.onVnodeMounted)||Ae||L)&&Wa(()=>{D&&Ts(D,Se,G),Ae&&j.enter(B),L&&ed(G,null,Se,"mounted")},we)},_=(G,Z,de,Se,we)=>{if(de&&f(G,de),Se)for(let _e=0;_e<Se.length;_e++)f(G,Se[_e]);if(we){let _e=we.subTree;if(Z===_e){const Ee=we.vnode;_(G,Ee,Ee.scopeId,Ee.slotScopeIds,we.parent)}}},C=(G,Z,de,Se,we,_e,Ee,fe,B=0)=>{for(let D=B;D<G.length;D++){const I=G[D]=fe?eu(G[D]):Gs(G[D]);v(null,I,Z,de,Se,we,_e,Ee,fe)}},A=(G,Z,de,Se,we,_e,Ee)=>{const fe=Z.el=G.el;let{patchFlag:B,dynamicChildren:D,dirs:I}=Z;B|=G.patchFlag&16;const O=G.props||wi,j=Z.props||wi;let L;if(de&&td(de,!1),(L=j.onVnodeBeforeUpdate)&&Ts(L,de,Z,G),I&&ed(Z,G,de,"beforeUpdate"),de&&td(de,!0),D?M(G.dynamicChildren,D,fe,de,Se,nS(Z,we),_e):Ee||U(G,Z,fe,null,de,Se,nS(Z,we),_e,!1),B>0){if(B&16)P(fe,Z,O,j,de,Se,we);else if(B&2&&O.class!==j.class&&a(fe,"class",null,j.class,we),B&4&&a(fe,"style",O.style,j.style,we),B&8){const Ae=Z.dynamicProps;for(let We=0;We<Ae.length;We++){const Ve=Ae[We],ke=O[Ve],et=j[Ve];(et!==ke||Ve==="value")&&a(fe,Ve,ke,et,we,G.children,de,Se,ee)}}B&1&&G.children!==Z.children&&u(fe,Z.children)}else!Ee&&D==null&&P(fe,Z,O,j,de,Se,we);((L=j.onVnodeUpdated)||I)&&Wa(()=>{L&&Ts(L,de,Z,G),I&&ed(Z,G,de,"updated")},Se)},M=(G,Z,de,Se,we,_e,Ee)=>{for(let fe=0;fe<Z.length;fe++){const B=G[fe],D=Z[fe],I=B.el&&(B.type===mr||!Sd(B,D)||B.shapeFlag&70)?d(B.el):de;v(B,D,I,null,Se,we,_e,Ee,!0)}},P=(G,Z,de,Se,we,_e,Ee)=>{if(de!==Se){if(de!==wi)for(const fe in de)!Ev(fe)&&!(fe in Se)&&a(G,fe,de[fe],null,Ee,Z.children,we,_e,ee);for(const fe in Se){if(Ev(fe))continue;const B=Se[fe],D=de[fe];B!==D&&fe!=="value"&&a(G,fe,D,B,Ee,Z.children,we,_e,ee)}"value"in Se&&a(G,"value",de.value,Se.value,Ee)}},T=(G,Z,de,Se,we,_e,Ee,fe,B)=>{const D=Z.el=G?G.el:s(""),I=Z.anchor=G?G.anchor:s("");let{patchFlag:O,dynamicChildren:j,slotScopeIds:L}=Z;L&&(fe=fe?fe.concat(L):L),G==null?(i(D,de,Se),i(I,de,Se),C(Z.children||[],de,I,we,_e,Ee,fe,B)):O>0&&O&64&&j&&G.dynamicChildren?(M(G.dynamicChildren,j,de,we,_e,Ee,fe),(Z.key!=null||we&&Z===we.subTree)&&MT(G,Z,!0)):U(G,Z,de,I,we,_e,Ee,fe,B)},R=(G,Z,de,Se,we,_e,Ee,fe,B)=>{Z.slotScopeIds=fe,G==null?Z.shapeFlag&512?we.ctx.activate(Z,de,Se,Ee,B):z(Z,de,Se,we,_e,Ee,B):F(G,Z,B)},z=(G,Z,de,Se,we,_e,Ee)=>{const fe=G.component=W$(G,Se,we);if(Q1(G)&&(fe.ctx.renderer=ue),G$(fe),fe.asyncDep){if(we&&we.registerDep(fe,H,Ee),!G.el){const B=fe.subTree=Le(zn);g(null,B,Z,de)}}else H(fe,G,Z,de,we,_e,Ee)},F=(G,Z,de)=>{const Se=Z.component=G.component;if(JG(G,Z,de))if(Se.asyncDep&&!Se.asyncResolved){N(Se,Z,de);return}else Se.next=Z,qG(Se.update),Se.effect.dirty=!0,Se.update();else Z.el=G.el,Se.vnode=Z},H=(G,Z,de,Se,we,_e,Ee)=>{const fe=()=>{if(G.isMounted){let{next:I,bu:O,u:j,parent:L,vnode:Ae}=G;{const nt=rN(G);if(nt){I&&(I.el=Ae.el,N(G,I,Ee)),nt.asyncDep.then(()=>{G.isUnmounted||fe()});return}}let We=I,Ve;td(G,!1),I?(I.el=Ae.el,N(G,I,Ee)):I=Ae,O&&eS(O),(Ve=I.props&&I.props.onVnodeBeforeUpdate)&&Ts(Ve,L,I,Ae),td(G,!0);const ke=rS(G),et=G.subTree;G.subTree=ke,v(et,ke,d(et.el),Q(et),G,we,_e),I.el=ke.el,We===null&&e$(G,ke.el),j&&Wa(j,we),(Ve=I.props&&I.props.onVnodeUpdated)&&Wa(()=>Ts(Ve,L,I,Ae),we)}else{let I;const{el:O,props:j}=Z,{bm:L,m:Ae,parent:We}=G,Ve=Pv(Z);if(td(G,!1),L&&eS(L),!Ve&&(I=j&&j.onVnodeBeforeMount)&&Ts(I,We,Z),td(G,!0),O&&Ce){const ke=()=>{G.subTree=rS(G),Ce(O,G.subTree,G,we,null)};Ve?Z.type.__asyncLoader().then(()=>!G.isUnmounted&&ke()):ke()}else{const ke=G.subTree=rS(G);v(null,ke,de,Se,G,we,_e),Z.el=ke.el}if(Ae&&Wa(Ae,we),!Ve&&(I=j&&j.onVnodeMounted)){const ke=Z;Wa(()=>Ts(I,We,ke),we)}(Z.shapeFlag&256||We&&Pv(We.vnode)&&We.vnode.shapeFlag&256)&&G.a&&Wa(G.a,we),G.isMounted=!0,Z=de=Se=null}},B=G.effect=new pT(fe,Io,()=>CT(D),G.scope),D=G.update=()=>{B.dirty&&B.run()};D.id=G.uid,td(G,!0),D()},N=(G,Z,de)=>{Z.component=G;const Se=G.vnode.props;G.vnode=Z,G.next=null,S$(G,Z.props,Se,de),A$(G,Z.children,de),Vu(),D3(G),Hu()},U=(G,Z,de,Se,we,_e,Ee,fe,B=!1)=>{const D=G&&G.children,I=G?G.shapeFlag:0,O=Z.children,{patchFlag:j,shapeFlag:L}=Z;if(j>0){if(j&128){te(D,O,de,Se,we,_e,Ee,fe,B);return}else if(j&256){ie(D,O,de,Se,we,_e,Ee,fe,B);return}}L&8?(I&16&&ee(D,we,_e),O!==D&&u(de,O)):I&16?L&16?te(D,O,de,Se,we,_e,Ee,fe,B):ee(D,we,_e,!0):(I&8&&u(de,""),L&16&&C(O,de,Se,we,_e,Ee,fe,B))},ie=(G,Z,de,Se,we,_e,Ee,fe,B)=>{G=G||Xf,Z=Z||Xf;const D=G.length,I=Z.length,O=Math.min(D,I);let j;for(j=0;j<O;j++){const L=Z[j]=B?eu(Z[j]):Gs(Z[j]);v(G[j],L,de,null,we,_e,Ee,fe,B)}D>I?ee(G,we,_e,!0,!1,O):C(Z,de,Se,we,_e,Ee,fe,B,O)},te=(G,Z,de,Se,we,_e,Ee,fe,B)=>{let D=0;const I=Z.length;let O=G.length-1,j=I-1;for(;D<=O&&D<=j;){const L=G[D],Ae=Z[D]=B?eu(Z[D]):Gs(Z[D]);if(Sd(L,Ae))v(L,Ae,de,null,we,_e,Ee,fe,B);else break;D++}for(;D<=O&&D<=j;){const L=G[O],Ae=Z[j]=B?eu(Z[j]):Gs(Z[j]);if(Sd(L,Ae))v(L,Ae,de,null,we,_e,Ee,fe,B);else break;O--,j--}if(D>O){if(D<=j){const L=j+1,Ae=L<I?Z[L].el:Se;for(;D<=j;)v(null,Z[D]=B?eu(Z[D]):Gs(Z[D]),de,Ae,we,_e,Ee,fe,B),D++}}else if(D>j)for(;D<=O;)W(G[D],we,_e,!0),D++;else{const L=D,Ae=D,We=new Map;for(D=Ae;D<=j;D++){const se=Z[D]=B?eu(Z[D]):Gs(Z[D]);se.key!=null&&We.set(se.key,D)}let Ve,ke=0;const et=j-Ae+1;let nt=!1,lt=0;const ut=new Array(et);for(D=0;D<et;D++)ut[D]=0;for(D=L;D<=O;D++){const se=G[D];if(ke>=et){W(se,we,_e,!0);continue}let Be;if(se.key!=null)Be=We.get(se.key);else for(Ve=Ae;Ve<=j;Ve++)if(ut[Ve-Ae]===0&&Sd(se,Z[Ve])){Be=Ve;break}Be===void 0?W(se,we,_e,!0):(ut[Be-Ae]=D+1,Be>=lt?lt=Be:nt=!0,v(se,Z[Be],de,null,we,_e,Ee,fe,B),ke++)}const vt=nt?P$(ut):Xf;for(Ve=vt.length-1,D=et-1;D>=0;D--){const se=Ae+D,Be=Z[se],Ye=se+1<I?Z[se+1].el:Se;ut[D]===0?v(null,Be,de,Ye,we,_e,Ee,fe,B):nt&&(Ve<0||D!==vt[Ve]?X(Be,de,Ye,2):Ve--)}}},X=(G,Z,de,Se,we=null)=>{const{el:_e,type:Ee,transition:fe,children:B,shapeFlag:D}=G;if(D&6){X(G.component.subTree,Z,de,Se);return}if(D&128){G.suspense.move(Z,de,Se);return}if(D&64){Ee.move(G,Z,de,ue);return}if(Ee===mr){i(_e,Z,de);for(let O=0;O<B.length;O++)X(B[O],Z,de,Se);i(G.anchor,Z,de);return}if(Ee===Pb){b(G,Z,de);return}if(Se!==2&&D&1&&fe)if(Se===0)fe.beforeEnter(_e),i(_e,Z,de),Wa(()=>fe.enter(_e),we);else{const{leave:O,delayLeave:j,afterLeave:L}=fe,Ae=()=>i(_e,Z,de),We=()=>{O(_e,()=>{Ae(),L&&L()})};j?j(_e,Ae,We):We()}else i(_e,Z,de)},W=(G,Z,de,Se=!1,we=!1)=>{const{type:_e,props:Ee,ref:fe,children:B,dynamicChildren:D,shapeFlag:I,patchFlag:O,dirs:j,memoIndex:L}=G;if(O===-2&&(we=!1),fe!=null&&x2(fe,null,de,G,!0),L!=null&&(Z.renderCache[L]=void 0),I&256){Z.ctx.deactivate(G);return}const Ae=I&1&&j,We=!Pv(G);let Ve;if(We&&(Ve=Ee&&Ee.onVnodeBeforeUnmount)&&Ts(Ve,Z,G),I&6)le(G.component,de,Se);else{if(I&128){G.suspense.unmount(de,Se);return}Ae&&ed(G,null,Z,"beforeUnmount"),I&64?G.type.remove(G,Z,de,ue,Se):D&&(_e!==mr||O>0&&O&64)?ee(D,Z,de,!1,!0):(_e===mr&&O&384||!we&&I&16)&&ee(B,Z,de),Se&&q(G)}(We&&(Ve=Ee&&Ee.onVnodeUnmounted)||Ae)&&Wa(()=>{Ve&&Ts(Ve,Z,G),Ae&&ed(G,null,Z,"unmounted")},de)},q=G=>{const{type:Z,el:de,anchor:Se,transition:we}=G;if(Z===mr){$(de,Se);return}if(Z===Pb){x(G);return}const _e=()=>{n(de),we&&!we.persisted&&we.afterLeave&&we.afterLeave()};if(G.shapeFlag&1&&we&&!we.persisted){const{leave:Ee,delayLeave:fe}=we,B=()=>Ee(de,_e);fe?fe(G.el,_e,B):B()}else _e()},$=(G,Z)=>{let de;for(;G!==Z;)de=h(G),n(G),G=de;n(Z)},le=(G,Z,de)=>{const{bum:Se,scope:we,update:_e,subTree:Ee,um:fe,m:B,a:D}=G;j3(B),j3(D),Se&&eS(Se),we.stop(),_e&&(_e.active=!1,W(Ee,G,Z,de)),fe&&Wa(fe,Z),Wa(()=>{G.isUnmounted=!0},Z),Z&&Z.pendingBranch&&!Z.isUnmounted&&G.asyncDep&&!G.asyncResolved&&G.suspenseId===Z.pendingId&&(Z.deps--,Z.deps===0&&Z.resolve())},ee=(G,Z,de,Se=!1,we=!1,_e=0)=>{for(let Ee=_e;Ee<G.length;Ee++)W(G[Ee],Z,de,Se,we)},Q=G=>G.shapeFlag&6?Q(G.component.subTree):G.shapeFlag&128?G.suspense.next():h(G.anchor||G.el);let ne=!1;const V=(G,Z,de)=>{G==null?Z._vnode&&W(Z._vnode,null,null,!0):v(Z._vnode||null,G,Z,null,null,null,de),ne||(ne=!0,D3(),j5(),ne=!1),Z._vnode=G},ue={p:v,um:W,m:X,r:q,mt:z,mc:C,pc:U,pbc:M,n:Q,o:e};let ve,Ce;return{render:V,hydrate:ve,createApp:b$(V,ve)}}function nS({type:e,props:t},r){return r==="svg"&&e==="foreignObject"||r==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:r}function td({effect:e,update:t},r){e.allowRecurse=t.allowRecurse=r}function T$(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function MT(e,t,r=!1){const i=e.children,n=t.children;if(Zt(i)&&Zt(n))for(let a=0;a<i.length;a++){const o=i[a];let s=n[a];s.shapeFlag&1&&!s.dynamicChildren&&((s.patchFlag<=0||s.patchFlag===32)&&(s=n[a]=eu(n[a]),s.el=o.el),!r&&s.patchFlag!==-2&&MT(o,s)),s.type===Zg&&(s.el=o.el)}}function P$(e){const t=e.slice(),r=[0];let i,n,a,o,s;const l=e.length;for(i=0;i<l;i++){const c=e[i];if(c!==0){if(n=r[r.length-1],e[n]<c){t[i]=n,r.push(i);continue}for(a=0,o=r.length-1;a<o;)s=a+o>>1,e[r[s]]<c?a=s+1:o=s;c<e[r[a]]&&(a>0&&(t[i]=r[a-1]),r[a]=i)}}for(a=r.length,o=r[a-1];a-- >0;)r[a]=o,o=t[o];return r}function rN(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:rN(t)}function j3(e){if(e)for(let t=0;t<e.length;t++)e[t].active=!1}const D$=Symbol.for("v-scx"),O$=()=>_t(D$);function no(e,t){return ET(e,null,t)}const L0={};function rr(e,t,r){return ET(e,t,r)}function ET(e,t,{immediate:r,deep:i,flush:n,once:a,onTrack:o,onTrigger:s}=wi){if(t&&a){const w=t;t=(..._)=>{w(..._),S()}}const l=kn,c=w=>i===!0?w:au(w,i===!1?1:void 0);let u,d=!1,h=!1;if(Zi(e)?(u=()=>e.value,d=ix(e)):wu(e)?(u=()=>c(e),d=!0):Zt(e)?(h=!0,d=e.some(w=>wu(w)||ix(w)),u=()=>e.map(w=>{if(Zi(w))return w.value;if(wu(w))return c(w);if(dr(w))return Su(w,l,2)})):dr(e)?t?u=()=>Su(e,l,2):u=()=>(f&&f(),Fo(e,l,3,[p])):u=Io,t&&i){const w=u;u=()=>au(w())}let f,p=w=>{f=b.onStop=()=>{Su(w,l,4),f=b.onStop=void 0}},v;if(J1)if(p=Io,t?r&&Fo(t,l,3,[u(),h?[]:void 0,p]):u(),n==="sync"){const w=O$();v=w.__watcherHandles||(w.__watcherHandles=[])}else return Io;let m=h?new Array(e.length).fill(L0):L0;const g=()=>{if(!(!b.active||!b.dirty))if(t){const w=b.run();(i||d||(h?w.some((_,C)=>Du(_,m[C])):Du(w,m)))&&(f&&f(),Fo(t,l,3,[w,m===L0?void 0:h&&m[0]===L0?[]:m,p]),m=w)}else b.run()};g.allowRecurse=!!t;let y;n==="sync"?y=g:n==="post"?y=()=>Wa(g,l&&l.suspense):(g.pre=!0,l&&(g.id=l.uid),y=()=>CT(g));const b=new pT(u,Io,y),x=b5(),S=()=>{b.stop(),x&&hT(x.effects,b)};return t?r?g():m=b.run():n==="post"?Wa(b.run.bind(b),l&&l.suspense):b.run(),v&&v.push(S),S}function R$(e,t,r){const i=this.proxy,n=Qi(e)?e.includes(".")?iN(i,e):()=>i[e]:e.bind(i,i);let a;dr(t)?a=t:(a=t.handler,r=t);const o=Jg(this),s=ET(n,a.bind(i),r);return o(),s}function iN(e,t){const r=t.split(".");return()=>{let i=e;for(let n=0;n<r.length&&i;n++)i=i[r[n]];return i}}function au(e,t=1/0,r){if(t<=0||!yi(e)||e.__v_skip||(r=r||new Set,r.has(e)))return e;if(r.add(e),t--,Zi(e))au(e.value,t,r);else if(Zt(e))for(let i=0;i<e.length;i++)au(e[i],t,r);else if(l5(e)||Kf(e))e.forEach(i=>{au(i,t,r)});else if(d5(e)){for(const i in e)au(e[i],t,r);for(const i of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,i)&&au(e[i],t,r)}return e}const Q1=e=>e.type.__isKeepAlive;function TT(e,t){nN(e,"a",t)}function PT(e,t){nN(e,"da",t)}function nN(e,t,r=kn){const i=e.__wdc||(e.__wdc=()=>{let n=r;for(;n;){if(n.isDeactivated)return;n=n.parent}return e()});if(K1(t,i,r),r){let n=r.parent;for(;n&&n.parent;)Q1(n.parent.vnode)&&I$(i,t,r,n),n=n.parent}}function I$(e,t,r,i){const n=K1(t,e,i,!0);Qg(()=>{hT(i[t],n)},r)}const Jc=Symbol("_leaveCb"),B0=Symbol("_enterCb");function aN(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Or(()=>{e.isMounted=!0}),la(()=>{e.isUnmounting=!0}),e}const bo=[Function,Array],oN={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:bo,onEnter:bo,onAfterEnter:bo,onEnterCancelled:bo,onBeforeLeave:bo,onLeave:bo,onAfterLeave:bo,onLeaveCancelled:bo,onBeforeAppear:bo,onAppear:bo,onAfterAppear:bo,onAppearCancelled:bo},sN=e=>{const t=e.subTree;return t.component?sN(t.component):t},z$={name:"BaseTransition",props:oN,setup(e,{slots:t}){const r=xh(),i=aN();return()=>{const n=t.default&&DT(t.default(),!0);if(!n||!n.length)return;let a=n[0];if(n.length>1){for(const h of n)if(h.type!==zn){a=h;break}}const o=Sr(e),{mode:s}=o;if(i.isLeaving)return aS(a);const l=V3(a);if(!l)return aS(a);let c=og(l,o,i,r,h=>c=h);xp(l,c);const u=r.subTree,d=u&&V3(u);if(d&&d.type!==zn&&!Sd(l,d)&&sN(r).type!==zn){const h=og(d,o,i,r);if(xp(d,h),s==="out-in"&&l.type!==zn)return i.isLeaving=!0,h.afterLeave=()=>{i.isLeaving=!1,r.update.active!==!1&&(r.effect.dirty=!0,r.update())},aS(a);s==="in-out"&&l.type!==zn&&(h.delayLeave=(f,p,v)=>{const m=lN(i,d);m[String(d.key)]=d,f[Jc]=()=>{p(),f[Jc]=void 0,delete c.delayedLeave},c.delayedLeave=v})}return a}}},k$=z$;function lN(e,t){const{leavingVNodes:r}=e;let i=r.get(t.type);return i||(i=Object.create(null),r.set(t.type,i)),i}function og(e,t,r,i,n){const{appear:a,mode:o,persisted:s=!1,onBeforeEnter:l,onEnter:c,onAfterEnter:u,onEnterCancelled:d,onBeforeLeave:h,onLeave:f,onAfterLeave:p,onLeaveCancelled:v,onBeforeAppear:m,onAppear:g,onAfterAppear:y,onAppearCancelled:b}=t,x=String(e.key),S=lN(r,e),w=(A,M)=>{A&&Fo(A,i,9,M)},_=(A,M)=>{const P=M[1];w(A,M),Zt(A)?A.every(T=>T.length<=1)&&P():A.length<=1&&P()},C={mode:o,persisted:s,beforeEnter(A){let M=l;if(!r.isMounted)if(a)M=m||l;else return;A[Jc]&&A[Jc](!0);const P=S[x];P&&Sd(e,P)&&P.el[Jc]&&P.el[Jc](),w(M,[A])},enter(A){let M=c,P=u,T=d;if(!r.isMounted)if(a)M=g||c,P=y||u,T=b||d;else return;let R=!1;const z=A[B0]=F=>{R||(R=!0,F?w(T,[A]):w(P,[A]),C.delayedLeave&&C.delayedLeave(),A[B0]=void 0)};M?_(M,[A,z]):z()},leave(A,M){const P=String(e.key);if(A[B0]&&A[B0](!0),r.isUnmounting)return M();w(h,[A]);let T=!1;const R=A[Jc]=z=>{T||(T=!0,M(),z?w(v,[A]):w(p,[A]),A[Jc]=void 0,S[P]===e&&delete S[P])};S[P]=e,f?_(f,[A,R]):R()},clone(A){const M=og(A,t,r,i,n);return n&&n(M),M}};return C}function aS(e){if(Q1(e))return e=hl(e),e.children=null,e}function V3(e){if(!Q1(e))return e;const{shapeFlag:t,children:r}=e;if(r){if(t&16)return r[0];if(t&32&&dr(r.default))return r.default()}}function xp(e,t){e.shapeFlag&6&&e.component?xp(e.component.subTree,t):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function DT(e,t=!1,r){let i=[],n=0;for(let a=0;a<e.length;a++){let o=e[a];const s=r==null?o.key:String(r)+String(o.key!=null?o.key:a);o.type===mr?(o.patchFlag&128&&n++,i=i.concat(DT(o.children,t,s))):(t||o.type!==zn)&&i.push(s!=null?hl(o,{key:s}):o)}if(n>1)for(let a=0;a<i.length;a++)i[a].patchFlag=-2;return i}const L$=e=>e.__isTeleport,Ov=e=>e&&(e.disabled||e.disabled===""),H3=e=>typeof SVGElement<"u"&&e instanceof SVGElement,W3=e=>typeof MathMLElement=="function"&&e instanceof MathMLElement,w2=(e,t)=>{const r=e&&e.to;return Qi(r)?t?t(r):null:r},B$={name:"Teleport",__isTeleport:!0,process(e,t,r,i,n,a,o,s,l,c){const{mc:u,pc:d,pbc:h,o:{insert:f,querySelector:p,createText:v,createComment:m}}=c,g=Ov(t.props);let{shapeFlag:y,children:b,dynamicChildren:x}=t;if(e==null){const S=t.el=v(""),w=t.anchor=v("");f(S,r,i),f(w,r,i);const _=t.target=w2(t.props,p),C=t.targetAnchor=v("");_&&(f(C,_),o==="svg"||H3(_)?o="svg":(o==="mathml"||W3(_))&&(o="mathml"));const A=(M,P)=>{y&16&&u(b,M,P,n,a,o,s,l)};g?A(r,w):_&&A(_,C)}else{t.el=e.el;const S=t.anchor=e.anchor,w=t.target=e.target,_=t.targetAnchor=e.targetAnchor,C=Ov(e.props),A=C?r:w,M=C?S:_;if(o==="svg"||H3(w)?o="svg":(o==="mathml"||W3(w))&&(o="mathml"),x?(h(e.dynamicChildren,x,A,n,a,o,s),MT(e,t,!0)):l||d(e,t,A,M,n,a,o,s,!1),g)C?t.props&&e.props&&t.props.to!==e.props.to&&(t.props.to=e.props.to):F0(t,r,S,c,1);else if((t.props&&t.props.to)!==(e.props&&e.props.to)){const P=t.target=w2(t.props,p);P&&F0(t,P,null,c,0)}else C&&F0(t,w,_,c,1)}uN(t)},remove(e,t,r,{um:i,o:{remove:n}},a){const{shapeFlag:o,children:s,anchor:l,targetAnchor:c,target:u,props:d}=e;if(u&&n(c),a&&n(l),o&16){const h=a||!Ov(d);for(let f=0;f<s.length;f++){const p=s[f];i(p,t,r,h,!!p.dynamicChildren)}}},move:F0,hydrate:F$};function F0(e,t,r,{o:{insert:i},m:n},a=2){a===0&&i(e.targetAnchor,t,r);const{el:o,anchor:s,shapeFlag:l,children:c,props:u}=e,d=a===2;if(d&&i(o,t,r),(!d||Ov(u))&&l&16)for(let h=0;h<c.length;h++)n(c[h],t,r,2);d&&i(s,t,r)}function F$(e,t,r,i,n,a,{o:{nextSibling:o,parentNode:s,querySelector:l}},c){const u=t.target=w2(t.props,l);if(u){const d=u._lpa||u.firstChild;if(t.shapeFlag&16)if(Ov(t.props))t.anchor=c(o(e),t,s(e),r,i,n,a),t.targetAnchor=d;else{t.anchor=o(e);let h=d;for(;h;)if(h=o(h),h&&h.nodeType===8&&h.data==="teleport anchor"){t.targetAnchor=h,u._lpa=t.targetAnchor&&o(t.targetAnchor);break}c(d,t,u,r,i,n,a)}uN(t)}return t.anchor&&o(t.anchor)}const cN=B$;function uN(e){const t=e.ctx;if(t&&t.ut){let r=e.children[0].el;for(;r&&r!==e.targetAnchor;)r.nodeType===1&&r.setAttribute("data-v-owner",t.uid),r=r.nextSibling;t.ut()}}const mr=Symbol.for("v-fgt"),Zg=Symbol.for("v-txt"),zn=Symbol.for("v-cmt"),Pb=Symbol.for("v-stc"),Rv=[];let ls=null;function ht(e=!1){Rv.push(ls=e?null:[])}function N$(){Rv.pop(),ls=Rv[Rv.length-1]||null}let sg=1;function G3(e){sg+=e}function dN(e){return e.dynamicChildren=sg>0?ls||Xf:null,N$(),sg>0&&ls&&ls.push(e),e}function Pt(e,t,r,i,n,a){return dN(st(e,t,r,i,n,a,!0))}function Ci(e,t,r,i,n){return dN(Le(e,t,r,i,n,!0))}function lg(e){return e?e.__v_isVNode===!0:!1}function Sd(e,t){return e.type===t.type&&e.key===t.key}const hN=({key:e})=>e??null,Db=({ref:e,ref_key:t,ref_for:r})=>(typeof e=="number"&&(e=""+e),e!=null?Qi(e)||Zi(e)||dr(e)?{i:wn,r:e,k:t,f:!!r}:e:null);function st(e,t=null,r=null,i=0,n=null,a=e===mr?0:1,o=!1,s=!1){const l={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&hN(t),ref:t&&Db(t),scopeId:q1,slotScopeIds:null,children:r,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:a,patchFlag:i,dynamicProps:n,dynamicChildren:null,appContext:null,ctx:wn};return s?(OT(l,r),a&128&&e.normalize(l)):r&&(l.shapeFlag|=Qi(r)?8:16),sg>0&&!o&&ls&&(l.patchFlag>0||a&6)&&l.patchFlag!==32&&ls.push(l),l}const Le=U$;function U$(e,t=null,r=null,i=0,n=null,a=!1){if((!e||e===r$)&&(e=zn),lg(e)){const s=hl(e,t,!0);return r&&OT(s,r),sg>0&&!a&&ls&&(s.shapeFlag&6?ls[ls.indexOf(e)]=s:ls.push(s)),s.patchFlag=-2,s}if(K$(e)&&(e=e.__vccOpts),t){t=j$(t);let{class:s,style:l}=t;s&&!Qi(s)&&(t.class=Bo(s)),yi(l)&&(Tv(l)&&!Zt(l)&&(l=Ki({},l)),t.style=yp(l))}const o=Qi(e)?1:n$(e)?128:L$(e)?64:yi(e)?4:dr(e)?2:0;return st(e,t,r,i,n,o,a,!0)}function j$(e){return e?Tv(e)||K5(e)?Ki({},e):e:null}function hl(e,t,r=!1,i=!1){const{props:n,ref:a,patchFlag:o,children:s,transition:l}=e,c=t?$u(n||{},t):n,u={__v_isVNode:!0,__v_skip:!0,type:e.type,props:c,key:c&&hN(c),ref:t&&t.ref?r&&a?Zt(a)?a.concat(Db(t)):[a,Db(t)]:Db(t):a,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:s,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==mr?o===-1?16:o|16:o,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:l,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&hl(e.ssContent),ssFallback:e.ssFallback&&hl(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return l&&i&&xp(u,l.clone(u)),u}function Lr(e=" ",t=0){return Le(Zg,null,e,t)}function Z1(e,t){const r=Le(Pb,null,e);return r.staticCount=t,r}function Ga(e="",t=!1){return t?(ht(),Ci(zn,null,e)):Le(zn,null,e)}function Gs(e){return e==null||typeof e=="boolean"?Le(zn):Zt(e)?Le(mr,null,e.slice()):typeof e=="object"?eu(e):Le(Zg,null,String(e))}function eu(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:hl(e)}function OT(e,t){let r=0;const{shapeFlag:i}=e;if(t==null)t=null;else if(Zt(t))r=16;else if(typeof t=="object")if(i&65){const n=t.default;n&&(n._c&&(n._d=!1),OT(e,n()),n._c&&(n._d=!0));return}else{r=32;const n=t._;!n&&!K5(t)?t._ctx=wn:n===3&&wn&&(wn.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else dr(t)?(t={default:t,_ctx:wn},r=32):(t=String(t),i&64?(r=16,t=[Lr(t)]):r=8);e.children=t,e.shapeFlag|=r}function $u(...e){const t={};for(let r=0;r<e.length;r++){const i=e[r];for(const n in i)if(n==="class")t.class!==i.class&&(t.class=Bo([t.class,i.class]));else if(n==="style")t.style=yp([t.style,i.style]);else if(U1(n)){const a=t[n],o=i[n];o&&a!==o&&!(Zt(a)&&a.includes(o))&&(t[n]=a?[].concat(a,o):o)}else n!==""&&(t[n]=i[n])}return t}function Ts(e,t,r,i=null){Fo(e,t,7,[r,i])}const V$=q5();let H$=0;function W$(e,t,r){const i=e.type,n=(t?t.appContext:e.appContext)||V$,a={uid:H$++,vnode:e,type:i,parent:t,appContext:n,root:null,next:null,subTree:null,effect:null,update:null,scope:new g5(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(n.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Z5(i,n),emitsOptions:H5(i,n),emit:null,emitted:null,propsDefaults:wi,inheritAttrs:i.inheritAttrs,ctx:wi,data:wi,props:wi,attrs:wi,slots:wi,refs:wi,setupState:wi,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:r,suspenseId:r?r.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return a.ctx={_:a},a.root=t?t.root:a,a.emit=KG.bind(null,a),e.ce&&e.ce(a),a}let kn=null;const xh=()=>kn||wn;let ox,S2;{const e=f5(),t=(r,i)=>{let n;return(n=e[r])||(n=e[r]=[]),n.push(i),a=>{n.length>1?n.forEach(o=>o(a)):n[0](a)}};ox=t("__VUE_INSTANCE_SETTERS__",r=>kn=r),S2=t("__VUE_SSR_SETTERS__",r=>J1=r)}const Jg=e=>{const t=kn;return ox(e),e.scope.on(),()=>{e.scope.off(),ox(t)}},$3=()=>{kn&&kn.scope.off(),ox(null)};function fN(e){return e.vnode.shapeFlag&4}let J1=!1;function G$(e,t=!1){t&&S2(t);const{props:r,children:i}=e.vnode,n=fN(e);w$(e,r,n,t),_$(e,i);const a=n?$$(e,t):void 0;return t&&S2(!1),a}function $$(e,t){const r=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,h$);const{setup:i}=r;if(i){const n=e.setupContext=i.length>1?Y$(e):null,a=Jg(e);Vu();const o=Su(i,e,0,[e.props,n]);if(Hu(),a(),c5(o)){if(o.then($3,$3),t)return o.then(s=>{q3(e,s,t)}).catch(s=>{G1(s,e,0)});e.asyncDep=o}else q3(e,o,t)}else pN(e,t)}function q3(e,t,r){dr(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:yi(t)&&(e.setupState=L5(t)),pN(e,r)}let Y3;function pN(e,t,r){const i=e.type;if(!e.render){if(!t&&Y3&&!i.render){const n=i.template||_T(e).template;if(n){const{isCustomElement:a,compilerOptions:o}=e.appContext.config,{delimiters:s,compilerOptions:l}=i,c=Ki(Ki({isCustomElement:a,delimiters:s},o),l);i.render=Y3(n,c)}}e.render=i.render||Io}{const n=Jg(e);Vu();try{f$(e)}finally{Hu(),n()}}}const q$={get(e,t){return ro(e,"get",""),e[t]}};function Y$(e){const t=r=>{e.exposed=r||{}};return{attrs:new Proxy(e.attrs,q$),slots:e.slots,emit:e.emit,expose:t}}function ew(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(L5(xT(e.exposed)),{get(t,r){if(r in t)return t[r];if(r in Dv)return Dv[r](e)},has(t,r){return r in t||r in Dv}})):e.proxy}function X$(e,t=!0){return dr(e)?e.displayName||e.name:e.name||t&&e.__name}function K$(e){return dr(e)&&"__vccOpts"in e}const re=(e,t)=>UG(e,t,J1);function E(e,t,r){const i=arguments.length;return i===2?yi(t)&&!Zt(t)?lg(t)?Le(e,null,[t]):Le(e,t):Le(e,null,t):(i>3?r=Array.prototype.slice.call(arguments,2):i===3&&lg(r)&&(r=[r]),Le(e,t,r))}const Q$="3.4.31";/**
* @vue/runtime-dom v3.4.31
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const Z$="http://www.w3.org/2000/svg",J$="http://www.w3.org/1998/Math/MathML",Vl=typeof document<"u"?document:null,X3=Vl&&Vl.createElement("template"),eq={insert:(e,t,r)=>{t.insertBefore(e,r||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,r,i)=>{const n=t==="svg"?Vl.createElementNS(Z$,e):t==="mathml"?Vl.createElementNS(J$,e):r?Vl.createElement(e,{is:r}):Vl.createElement(e);return e==="select"&&i&&i.multiple!=null&&n.setAttribute("multiple",i.multiple),n},createText:e=>Vl.createTextNode(e),createComment:e=>Vl.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Vl.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,r,i,n,a){const o=r?r.previousSibling:t.lastChild;if(n&&(n===a||n.nextSibling))for(;t.insertBefore(n.cloneNode(!0),r),!(n===a||!(n=n.nextSibling)););else{X3.innerHTML=i==="svg"?`<svg>${e}</svg>`:i==="mathml"?`<math>${e}</math>`:e;const s=X3.content;if(i==="svg"||i==="mathml"){const l=s.firstChild;for(;l.firstChild;)s.appendChild(l.firstChild);s.removeChild(l)}t.insertBefore(s,r)}return[o?o.nextSibling:t.firstChild,r?r.previousSibling:t.lastChild]}},Pc="transition",Am="animation",wp=Symbol("_vtc"),La=(e,{slots:t})=>E(k$,vN(e),t);La.displayName="Transition";const mN={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},tq=La.props=Ki({},oN,mN),rd=(e,t=[])=>{Zt(e)?e.forEach(r=>r(...t)):e&&e(...t)},K3=e=>e?Zt(e)?e.some(t=>t.length>1):e.length>1:!1;function vN(e){const t={};for(const T in e)T in mN||(t[T]=e[T]);if(e.css===!1)return t;const{name:r="v",type:i,duration:n,enterFromClass:a=`${r}-enter-from`,enterActiveClass:o=`${r}-enter-active`,enterToClass:s=`${r}-enter-to`,appearFromClass:l=a,appearActiveClass:c=o,appearToClass:u=s,leaveFromClass:d=`${r}-leave-from`,leaveActiveClass:h=`${r}-leave-active`,leaveToClass:f=`${r}-leave-to`}=e,p=rq(n),v=p&&p[0],m=p&&p[1],{onBeforeEnter:g,onEnter:y,onEnterCancelled:b,onLeave:x,onLeaveCancelled:S,onBeforeAppear:w=g,onAppear:_=y,onAppearCancelled:C=b}=t,A=(T,R,z)=>{Kc(T,R?u:s),Kc(T,R?c:o),z&&z()},M=(T,R)=>{T._isLeaving=!1,Kc(T,d),Kc(T,f),Kc(T,h),R&&R()},P=T=>(R,z)=>{const F=T?_:y,H=()=>A(R,T,z);rd(F,[R,H]),Q3(()=>{Kc(R,T?l:a),Fl(R,T?u:s),K3(F)||Z3(R,i,v,H)})};return Ki(t,{onBeforeEnter(T){rd(g,[T]),Fl(T,a),Fl(T,o)},onBeforeAppear(T){rd(w,[T]),Fl(T,l),Fl(T,c)},onEnter:P(!1),onAppear:P(!0),onLeave(T,R){T._isLeaving=!0;const z=()=>M(T,R);Fl(T,d),Fl(T,h),yN(),Q3(()=>{T._isLeaving&&(Kc(T,d),Fl(T,f),K3(x)||Z3(T,i,m,z))}),rd(x,[T,z])},onEnterCancelled(T){A(T,!1),rd(b,[T])},onAppearCancelled(T){A(T,!0),rd(C,[T])},onLeaveCancelled(T){M(T),rd(S,[T])}})}function rq(e){if(e==null)return null;if(yi(e))return[oS(e.enter),oS(e.leave)];{const t=oS(e);return[t,t]}}function oS(e){return dG(e)}function Fl(e,t){t.split(/\s+/).forEach(r=>r&&e.classList.add(r)),(e[wp]||(e[wp]=new Set)).add(t)}function Kc(e,t){t.split(/\s+/).forEach(i=>i&&e.classList.remove(i));const r=e[wp];r&&(r.delete(t),r.size||(e[wp]=void 0))}function Q3(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let iq=0;function Z3(e,t,r,i){const n=e._endId=++iq,a=()=>{n===e._endId&&i()};if(r)return setTimeout(a,r);const{type:o,timeout:s,propCount:l}=gN(e,t);if(!o)return i();const c=o+"end";let u=0;const d=()=>{e.removeEventListener(c,h),a()},h=f=>{f.target===e&&++u>=l&&d()};setTimeout(()=>{u<l&&d()},s+1),e.addEventListener(c,h)}function gN(e,t){const r=window.getComputedStyle(e),i=p=>(r[p]||"").split(", "),n=i(`${Pc}Delay`),a=i(`${Pc}Duration`),o=J3(n,a),s=i(`${Am}Delay`),l=i(`${Am}Duration`),c=J3(s,l);let u=null,d=0,h=0;t===Pc?o>0&&(u=Pc,d=o,h=a.length):t===Am?c>0&&(u=Am,d=c,h=l.length):(d=Math.max(o,c),u=d>0?o>c?Pc:Am:null,h=u?u===Pc?a.length:l.length:0);const f=u===Pc&&/\b(transform|all)(,|$)/.test(i(`${Pc}Property`).toString());return{type:u,timeout:d,propCount:h,hasTransform:f}}function J3(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((r,i)=>eO(r)+eO(e[i])))}function eO(e){return e==="auto"?0:Number(e.slice(0,-1).replace(",","."))*1e3}function yN(){return document.body.offsetHeight}function nq(e,t,r){const i=e[wp];i&&(t=(t?[t,...i]:[...i]).join(" ")),t==null?e.removeAttribute("class"):r?e.setAttribute("class",t):e.className=t}const sx=Symbol("_vod"),bN=Symbol("_vsh"),nh={beforeMount(e,{value:t},{transition:r}){e[sx]=e.style.display==="none"?"":e.style.display,r&&t?r.beforeEnter(e):Mm(e,t)},mounted(e,{value:t},{transition:r}){r&&t&&r.enter(e)},updated(e,{value:t,oldValue:r},{transition:i}){!t!=!r&&(i?t?(i.beforeEnter(e),Mm(e,!0),i.enter(e)):i.leave(e,()=>{Mm(e,!1)}):Mm(e,t))},beforeUnmount(e,{value:t}){Mm(e,t)}};function Mm(e,t){e.style.display=t?e[sx]:"none",e[bN]=!t}const aq=Symbol(""),oq=/(^|;)\s*display\s*:/;function sq(e,t,r){const i=e.style,n=Qi(r);let a=!1;if(r&&!n){if(t)if(Qi(t))for(const o of t.split(";")){const s=o.slice(0,o.indexOf(":")).trim();r[s]==null&&Ob(i,s,"")}else for(const o in t)r[o]==null&&Ob(i,o,"");for(const o in r)o==="display"&&(a=!0),Ob(i,o,r[o])}else if(n){if(t!==r){const o=i[aq];o&&(r+=";"+o),i.cssText=r,a=oq.test(r)}}else t&&e.removeAttribute("style");sx in e&&(e[sx]=a?i.display:"",e[bN]&&(i.display="none"))}const tO=/\s*!important$/;function Ob(e,t,r){if(Zt(r))r.forEach(i=>Ob(e,t,i));else if(r==null&&(r=""),t.startsWith("--"))e.setProperty(t,r);else{const i=lq(e,t);tO.test(r)?e.setProperty(Xp(i),r.replace(tO,""),"important"):e[i]=r}}const rO=["Webkit","Moz","ms"],sS={};function lq(e,t){const r=sS[t];if(r)return r;let i=dl(t);if(i!=="filter"&&i in e)return sS[t]=i;i=H1(i);for(let n=0;n<rO.length;n++){const a=rO[n]+i;if(a in e)return sS[t]=a}return t}const iO="http://www.w3.org/1999/xlink";function nO(e,t,r,i,n,a=gG(t)){i&&t.startsWith("xlink:")?r==null?e.removeAttributeNS(iO,t.slice(6,t.length)):e.setAttributeNS(iO,t,r):r==null||a&&!p5(r)?e.removeAttribute(t):e.setAttribute(t,a?"":ju(r)?String(r):r)}function cq(e,t,r,i,n,a,o){if(t==="innerHTML"||t==="textContent"){i&&o(i,n,a),e[t]=r??"";return}const s=e.tagName;if(t==="value"&&s!=="PROGRESS"&&!s.includes("-")){const c=s==="OPTION"?e.getAttribute("value")||"":e.value,u=r==null?"":String(r);(c!==u||!("_value"in e))&&(e.value=u),r==null&&e.removeAttribute(t),e._value=r;return}let l=!1;if(r===""||r==null){const c=typeof e[t];c==="boolean"?r=p5(r):r==null&&c==="string"?(r="",l=!0):c==="number"&&(r=0,l=!0)}try{e[t]=r}catch{}l&&e.removeAttribute(t)}function uq(e,t,r,i){e.addEventListener(t,r,i)}function dq(e,t,r,i){e.removeEventListener(t,r,i)}const aO=Symbol("_vei");function hq(e,t,r,i,n=null){const a=e[aO]||(e[aO]={}),o=a[t];if(i&&o)o.value=i;else{const[s,l]=fq(t);if(i){const c=a[t]=vq(i,n);uq(e,s,c,l)}else o&&(dq(e,s,o,l),a[t]=void 0)}}const oO=/(?:Once|Passive|Capture)$/;function fq(e){let t;if(oO.test(e)){t={};let i;for(;i=e.match(oO);)e=e.slice(0,e.length-i[0].length),t[i[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):Xp(e.slice(2)),t]}let lS=0;const pq=Promise.resolve(),mq=()=>lS||(pq.then(()=>lS=0),lS=Date.now());function vq(e,t){const r=i=>{if(!i._vts)i._vts=Date.now();else if(i._vts<=r.attached)return;Fo(gq(i,r.value),t,5,[i])};return r.value=e,r.attached=mq(),r}function gq(e,t){if(Zt(t)){const r=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{r.call(e),e._stopped=!0},t.map(i=>n=>!n._stopped&&i&&i(n))}else return t}const sO=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,yq=(e,t,r,i,n,a,o,s,l)=>{const c=n==="svg";t==="class"?nq(e,i,c):t==="style"?sq(e,r,i):U1(t)?dT(t)||hq(e,t,r,i,o):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):bq(e,t,i,c))?(cq(e,t,i,a,o,s,l),!e.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&nO(e,t,i,c,o,t!=="value")):(t==="true-value"?e._trueValue=i:t==="false-value"&&(e._falseValue=i),nO(e,t,i,c))};function bq(e,t,r,i){if(i)return!!(t==="innerHTML"||t==="textContent"||t in e&&sO(t)&&dr(r));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const n=e.tagName;if(n==="IMG"||n==="VIDEO"||n==="CANVAS"||n==="SOURCE")return!1}return sO(t)&&Qi(r)?!1:t in e}const xN=new WeakMap,wN=new WeakMap,lx=Symbol("_moveCb"),lO=Symbol("_enterCb"),SN={name:"TransitionGroup",props:Ki({},tq,{tag:String,moveClass:String}),setup(e,{slots:t}){const r=xh(),i=aN();let n,a;return W5(()=>{if(!n.length)return;const o=e.moveClass||`${e.name||"v"}-move`;if(!_q(n[0].el,r.vnode.el,o))return;n.forEach(wq),n.forEach(Sq);const s=n.filter(Cq);yN(),s.forEach(l=>{const c=l.el,u=c.style;Fl(c,o),u.transform=u.webkitTransform=u.transitionDuration="";const d=c[lx]=h=>{h&&h.target!==c||(!h||/transform$/.test(h.propertyName))&&(c.removeEventListener("transitionend",d),c[lx]=null,Kc(c,o))};c.addEventListener("transitionend",d)})}),()=>{const o=Sr(e),s=vN(o);let l=o.tag||mr;if(n=[],a)for(let c=0;c<a.length;c++){const u=a[c];u.el&&u.el instanceof Element&&(n.push(u),xp(u,og(u,s,i,r)),xN.set(u,u.el.getBoundingClientRect()))}a=t.default?DT(t.default()):[];for(let c=0;c<a.length;c++){const u=a[c];u.key!=null&&xp(u,og(u,s,i,r))}return Le(l,null,a)}}},xq=e=>delete e.mode;SN.props;const CN=SN;function wq(e){const t=e.el;t[lx]&&t[lx](),t[lO]&&t[lO]()}function Sq(e){wN.set(e,e.el.getBoundingClientRect())}function Cq(e){const t=xN.get(e),r=wN.get(e),i=t.left-r.left,n=t.top-r.top;if(i||n){const a=e.el.style;return a.transform=a.webkitTransform=`translate(${i}px,${n}px)`,a.transitionDuration="0s",e}}function _q(e,t,r){const i=e.cloneNode(),n=e[wp];n&&n.forEach(s=>{s.split(/\s+/).forEach(l=>l&&i.classList.remove(l))}),r.split(/\s+/).forEach(s=>s&&i.classList.add(s)),i.style.display="none";const a=t.nodeType===1?t:t.parentNode;a.appendChild(i);const{hasTransform:o}=gN(i);return a.removeChild(i),o}const Aq=["ctrl","shift","alt","meta"],Mq={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>Aq.some(r=>e[`${r}Key`]&&!t.includes(r))},Nf=(e,t)=>{const r=e._withMods||(e._withMods={}),i=t.join(".");return r[i]||(r[i]=(n,...a)=>{for(let o=0;o<t.length;o++){const s=Mq[t[o]];if(s&&s(n,t))return}return e(n,...a)})},Eq=Ki({patchProp:yq},eq);let cO;function Tq(){return cO||(cO=M$(Eq))}const Pq=(...e)=>{const t=Tq().createApp(...e),{mount:r}=t;return t.mount=i=>{const n=Oq(i);if(!n)return;const a=t._component;!dr(a)&&!a.render&&!a.template&&(a.template=n.innerHTML),n.innerHTML="";const o=r(n,!1,Dq(n));return n instanceof Element&&(n.removeAttribute("v-cloak"),n.setAttribute("data-v-app","")),o},t};function Dq(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function Oq(e){return Qi(e)?document.querySelector(e):e}let cx=[];const _N=new WeakMap;function Rq(){cx.forEach(e=>e(..._N.get(e))),cx=[]}function AN(e,...t){_N.set(e,t),!cx.includes(e)&&cx.push(e)===1&&requestAnimationFrame(Rq)}function Ou(e,t){let{target:r}=e;for(;r;){if(r.dataset&&r.dataset[t]!==void 0)return!0;r=r.parentElement}return!1}function lc(e){return e.composedPath()[0]||null}function nn(e){return typeof e=="string"?e.endsWith("px")?Number(e.slice(0,e.length-2)):Number(e):e}function Pd(e){if(e!=null)return typeof e=="number"?`${e}px`:e.endsWith("px")?e:`${e}px`}function zo(e,t){const r=e.trim().split(/\s+/g),i={top:r[0]};switch(r.length){case 1:i.right=r[0],i.bottom=r[0],i.left=r[0];break;case 2:i.right=r[1],i.left=r[1],i.bottom=r[0];break;case 3:i.right=r[1],i.bottom=r[2],i.left=r[1];break;case 4:i.right=r[1],i.bottom=r[2],i.left=r[3];break;default:throw new Error("[seemly/getMargin]:"+e+" is not a valid value.")}return t===void 0?i:i[t]}function MN(e,t){const[r,i]=e.split(" ");return{row:r,col:i||r}}const uO={black:"#000",silver:"#C0C0C0",gray:"#808080",white:"#FFF",maroon:"#800000",red:"#F00",purple:"#800080",fuchsia:"#F0F",green:"#008000",lime:"#0F0",olive:"#808000",yellow:"#FF0",navy:"#000080",blue:"#00F",teal:"#008080",aqua:"#0FF",transparent:"#0000"},Kp="^\\s*",Qp="\\s*$",Dd="\\s*((\\.\\d+)|(\\d+(\\.\\d*)?))\\s*",Od="([0-9A-Fa-f])",Rd="([0-9A-Fa-f]{2})",Iq=new RegExp(`${Kp}rgb\\s*\\(${Dd},${Dd},${Dd}\\)${Qp}`),zq=new RegExp(`${Kp}rgba\\s*\\(${Dd},${Dd},${Dd},${Dd}\\)${Qp}`),kq=new RegExp(`${Kp}#${Od}${Od}${Od}${Qp}`),Lq=new RegExp(`${Kp}#${Rd}${Rd}${Rd}${Qp}`),Bq=new RegExp(`${Kp}#${Od}${Od}${Od}${Od}${Qp}`),Fq=new RegExp(`${Kp}#${Rd}${Rd}${Rd}${Rd}${Qp}`);function Va(e){return parseInt(e,16)}function ah(e){try{let t;if(t=Lq.exec(e))return[Va(t[1]),Va(t[2]),Va(t[3]),1];if(t=Iq.exec(e))return[fa(t[1]),fa(t[5]),fa(t[9]),1];if(t=zq.exec(e))return[fa(t[1]),fa(t[5]),fa(t[9]),Iv(t[13])];if(t=kq.exec(e))return[Va(t[1]+t[1]),Va(t[2]+t[2]),Va(t[3]+t[3]),1];if(t=Fq.exec(e))return[Va(t[1]),Va(t[2]),Va(t[3]),Iv(Va(t[4])/255)];if(t=Bq.exec(e))return[Va(t[1]+t[1]),Va(t[2]+t[2]),Va(t[3]+t[3]),Iv(Va(t[4]+t[4])/255)];if(e in uO)return ah(uO[e]);throw new Error(`[seemly/rgba]: Invalid color value ${e}.`)}catch(t){throw t}}function Nq(e){return e>1?1:e<0?0:e}function C2(e,t,r,i){return`rgba(${fa(e)}, ${fa(t)}, ${fa(r)}, ${Nq(i)})`}function cS(e,t,r,i,n){return fa((e*t*(1-i)+r*i)/n)}function il(e,t){Array.isArray(e)||(e=ah(e)),Array.isArray(t)||(t=ah(t));const r=e[3],i=t[3],n=Iv(r+i-r*i);return C2(cS(e[0],r,t[0],i,n),cS(e[1],r,t[1],i,n),cS(e[2],r,t[2],i,n),n)}function Xt(e,t){const[r,i,n,a=1]=Array.isArray(e)?e:ah(e);return t.alpha?C2(r,i,n,t.alpha):C2(r,i,n,a)}function N0(e,t){const[r,i,n,a=1]=Array.isArray(e)?e:ah(e),{lightness:o=1,alpha:s=1}=t;return Uq([r*o,i*o,n*o,a*s])}function Iv(e){const t=Math.round(Number(e)*100)/100;return t>1?1:t<0?0:t}function fa(e){const t=Math.round(Number(e));return t>255?255:t<0?0:t}function Uq(e){const[t,r,i]=e;return 3 in e?`rgba(${fa(t)}, ${fa(r)}, ${fa(i)}, ${Iv(e[3])})`:`rgba(${fa(t)}, ${fa(r)}, ${fa(i)}, 1)`}function oh(e=8){return Math.random().toString(16).slice(2,2+e)}function EN(e,t="default",r=[]){const n=e.$slots[t];return n===void 0?r:n()}function zv(e,t=[],r){const i={};return t.forEach(n=>{i[n]=e[n]}),Object.assign(i,r)}function TN(e,t=[],r){const i={};return Object.getOwnPropertyNames(e).forEach(a=>{t.includes(a)||(i[a]=e[a])}),Object.assign(i,r)}function Cu(e,t=!0,r=[]){return e.forEach(i=>{if(i!==null){if(typeof i!="object"){(typeof i=="string"||typeof i=="number")&&r.push(Lr(String(i)));return}if(Array.isArray(i)){Cu(i,t,r);return}if(i.type===mr){if(i.children===null)return;Array.isArray(i.children)&&Cu(i.children,t,r)}else{if(i.type===zn&&t)return;r.push(i)}}}),r}function ct(e,...t){if(Array.isArray(e))e.forEach(r=>ct(r,...t));else return e(...t)}function cg(e){return Object.keys(e)}const Fn=(e,...t)=>typeof e=="function"?e(...t):typeof e=="string"?Lr(e):typeof e=="number"?Lr(String(e)):null;function sh(e,t){console.error(`[naive/${e}]: ${t}`)}function tw(e,t){throw new Error(`[naive/${e}]: ${t}`)}function _2(e){switch(typeof e){case"string":return e||void 0;case"number":return String(e);default:return}}function A2(e,t="default",r=void 0){const i=e[t];if(!i)return sh("getFirstSlotVNode",`slot[${t}] is empty`),null;const n=Cu(i(r));return n.length===1?n[0]:(sh("getFirstSlotVNode",`slot[${t}] should have exactly one child`),null)}function jq(e){return t=>{t?e.value=t.$el:e.value=null}}function e0(e){return e.some(t=>lg(t)?!(t.type===zn||t.type===mr&&!e0(t.children)):!0)?e:null}function Cr(e,t){return e&&e0(e())||t()}function M2(e,t,r){return e&&e0(e(t))||r(t)}function ti(e,t){const r=e&&e0(e());return t(r||null)}function Jf(e){return!(e&&e0(e()))}function uS(e){const t=e.filter(r=>r!==void 0);if(t.length!==0)return t.length===1?t[0]:r=>{e.forEach(i=>{i&&i(r)})}}const E2=je({render(){var e,t;return(t=(e=this.$slots).default)===null||t===void 0?void 0:t.call(e)}}),Vq=/^(\d|\.)+$/,dO=/(\d|\.)+/;function fs(e,{c:t=1,offset:r=0,attachPx:i=!0}={}){if(typeof e=="number"){const n=(e+r)*t;return n===0?"0":`${n}px`}else if(typeof e=="string")if(Vq.test(e)){const n=(Number(e)+r)*t;return i?n===0?"0":`${n}px`:`${n}`}else{const n=dO.exec(e);return n?e.replace(dO,String((Number(n[0])+r)*t)):e}return e}function ug(e){return e.replace(/#|\(|\)|,|\s|\./g,"_")}function Hq(e){const{left:t,right:r,top:i,bottom:n}=zo(e);return`${i} ${r} ${n} ${t}`}function Wq(e){let t=0;for(let r=0;r<e.length;++r)e[r]==="&"&&++t;return t}const PN=/\s*,(?![^(]*\))\s*/g,Gq=/\s+/g;function $q(e,t){const r=[];return t.split(PN).forEach(i=>{let n=Wq(i);if(n){if(n===1){e.forEach(o=>{r.push(i.replace("&",o))});return}}else{e.forEach(o=>{r.push((o&&o+" ")+i)});return}let a=[i];for(;n--;){const o=[];a.forEach(s=>{e.forEach(l=>{o.push(s.replace("&",l))})}),a=o}a.forEach(o=>r.push(o))}),r}function qq(e,t){const r=[];return t.split(PN).forEach(i=>{e.forEach(n=>{r.push((n&&n+" ")+i)})}),r}function Yq(e){let t=[""];return e.forEach(r=>{r=r&&r.trim(),r&&(r.includes("&")?t=$q(t,r):t=qq(t,r))}),t.join(", ").replace(Gq," ")}function hO(e){if(!e)return;const t=e.parentElement;t&&t.removeChild(e)}function rw(e,t){return(t??document.head).querySelector(`style[cssr-id="${e}"]`)}function Xq(e){const t=document.createElement("style");return t.setAttribute("cssr-id",e),t}function U0(e){return e?/^\s*@(s|m)/.test(e):!1}const Kq=/[A-Z]/g;function DN(e){return e.replace(Kq,t=>"-"+t.toLowerCase())}function Qq(e,t="  "){return typeof e=="object"&&e!==null?` {
`+Object.entries(e).map(r=>t+`  ${DN(r[0])}: ${r[1]};`).join(`
`)+`
`+t+"}":`: ${e};`}function Zq(e,t,r){return typeof e=="function"?e({context:t.context,props:r}):e}function fO(e,t,r,i){if(!t)return"";const n=Zq(t,r,i);if(!n)return"";if(typeof n=="string")return`${e} {
${n}
}`;const a=Object.keys(n);if(a.length===0)return r.config.keepEmptyBlock?e+` {
}`:"";const o=e?[e+" {"]:[];return a.forEach(s=>{const l=n[s];if(s==="raw"){o.push(`
`+l+`
`);return}s=DN(s),l!=null&&o.push(`  ${s}${Qq(l)}`)}),e&&o.push("}"),o.join(`
`)}function T2(e,t,r){e&&e.forEach(i=>{if(Array.isArray(i))T2(i,t,r);else if(typeof i=="function"){const n=i(t);Array.isArray(n)?T2(n,t,r):n&&r(n)}else i&&r(i)})}function ON(e,t,r,i,n){const a=e.$;let o="";if(!a||typeof a=="string")U0(a)?o=a:t.push(a);else if(typeof a=="function"){const c=a({context:i.context,props:n});U0(c)?o=c:t.push(c)}else if(a.before&&a.before(i.context),!a.$||typeof a.$=="string")U0(a.$)?o=a.$:t.push(a.$);else if(a.$){const c=a.$({context:i.context,props:n});U0(c)?o=c:t.push(c)}const s=Yq(t),l=fO(s,e.props,i,n);o?r.push(`${o} {`):l.length&&r.push(l),e.children&&T2(e.children,{context:i.context,props:n},c=>{if(typeof c=="string"){const u=fO(s,{raw:c},i,n);r.push(u)}else ON(c,t,r,i,n)}),t.pop(),o&&r.push("}"),a&&a.after&&a.after(i.context)}function Jq(e,t,r){const i=[];return ON(e,[],i,t,r),i.join(`

`)}function P2(e){for(var t=0,r,i=0,n=e.length;n>=4;++i,n-=4)r=e.charCodeAt(i)&255|(e.charCodeAt(++i)&255)<<8|(e.charCodeAt(++i)&255)<<16|(e.charCodeAt(++i)&255)<<24,r=(r&65535)*1540483477+((r>>>16)*59797<<16),r^=r>>>24,t=(r&65535)*1540483477+((r>>>16)*59797<<16)^(t&65535)*1540483477+((t>>>16)*59797<<16);switch(n){case 3:t^=(e.charCodeAt(i+2)&255)<<16;case 2:t^=(e.charCodeAt(i+1)&255)<<8;case 1:t^=e.charCodeAt(i)&255,t=(t&65535)*1540483477+((t>>>16)*59797<<16)}return t^=t>>>13,t=(t&65535)*1540483477+((t>>>16)*59797<<16),((t^t>>>15)>>>0).toString(36)}typeof window<"u"&&(window.__cssrContext={});function eY(e,t,r,i){const{els:n}=t;if(r===void 0)n.forEach(hO),t.els=[];else{const a=rw(r,i);a&&n.includes(a)&&(hO(a),t.els=n.filter(o=>o!==a))}}function pO(e,t){e.push(t)}function tY(e,t,r,i,n,a,o,s,l){let c;if(r===void 0&&(c=t.render(i),r=P2(c)),l){l.adapter(r,c??t.render(i));return}s===void 0&&(s=document.head);const u=rw(r,s);if(u!==null&&!a)return u;const d=u??Xq(r);if(c===void 0&&(c=t.render(i)),d.textContent=c,u!==null)return u;if(o){const h=s.querySelector(`meta[name="${o}"]`);if(h)return s.insertBefore(d,h),pO(t.els,d),d}return n?s.insertBefore(d,s.querySelector("style, link")):s.appendChild(d),pO(t.els,d),d}function rY(e){return Jq(this,this.instance,e)}function iY(e={}){const{id:t,ssr:r,props:i,head:n=!1,force:a=!1,anchorMetaName:o,parent:s}=e;return tY(this.instance,this,t,i,n,a,o,s,r)}function nY(e={}){const{id:t,parent:r}=e;eY(this.instance,this,t,r)}const j0=function(e,t,r,i){return{instance:e,$:t,props:r,children:i,els:[],render:rY,mount:iY,unmount:nY}},aY=function(e,t,r,i){return Array.isArray(t)?j0(e,{$:null},null,t):Array.isArray(r)?j0(e,t,null,r):Array.isArray(i)?j0(e,t,r,i):j0(e,t,r,null)};function RN(e={}){const t={c:(...r)=>aY(t,...r),use:(r,...i)=>r.install(t,...i),find:rw,context:{},config:e};return t}function oY(e,t){if(e===void 0)return!1;if(t){const{context:{ids:r}}=t;return r.has(e)}return rw(e)!==null}function sY(e){let t=".",r="__",i="--",n;if(e){let p=e.blockPrefix;p&&(t=p),p=e.elementPrefix,p&&(r=p),p=e.modifierPrefix,p&&(i=p)}const a={install(p){n=p.c;const v=p.context;v.bem={},v.bem.b=null,v.bem.els=null}};function o(p){let v,m;return{before(g){v=g.bem.b,m=g.bem.els,g.bem.els=null},after(g){g.bem.b=v,g.bem.els=m},$({context:g,props:y}){return p=typeof p=="string"?p:p({context:g,props:y}),g.bem.b=p,`${(y==null?void 0:y.bPrefix)||t}${g.bem.b}`}}}function s(p){let v;return{before(m){v=m.bem.els},after(m){m.bem.els=v},$({context:m,props:g}){return p=typeof p=="string"?p:p({context:m,props:g}),m.bem.els=p.split(",").map(y=>y.trim()),m.bem.els.map(y=>`${(g==null?void 0:g.bPrefix)||t}${m.bem.b}${r}${y}`).join(", ")}}}function l(p){return{$({context:v,props:m}){p=typeof p=="string"?p:p({context:v,props:m});const g=p.split(",").map(x=>x.trim());function y(x){return g.map(S=>`&${(m==null?void 0:m.bPrefix)||t}${v.bem.b}${x!==void 0?`${r}${x}`:""}${i}${S}`).join(", ")}const b=v.bem.els;return b!==null?y(b[0]):y()}}}function c(p){return{$({context:v,props:m}){p=typeof p=="string"?p:p({context:v,props:m});const g=v.bem.els;return`&:not(${(m==null?void 0:m.bPrefix)||t}${v.bem.b}${g!==null&&g.length>0?`${r}${g[0]}`:""}${i}${p})`}}}return Object.assign(a,{cB:(...p)=>n(o(p[0]),p[1],p[2]),cE:(...p)=>n(s(p[0]),p[1],p[2]),cM:(...p)=>n(l(p[0]),p[1],p[2]),cNotM:(...p)=>n(c(p[0]),p[1],p[2])}),a}const lY="n",ux=`.${lY}-`,cY="__",uY="--",IN=RN(),zN=sY({blockPrefix:ux,elementPrefix:cY,modifierPrefix:uY});IN.use(zN);const{c:ge,find:UVe}=IN,{cB:oe,cE:he,cM:xe,cNotM:br}=zN;function kN(e){return ge(({props:{bPrefix:t}})=>`${t||ux}modal, ${t||ux}drawer`,[e])}function LN(e){return ge(({props:{bPrefix:t}})=>`${t||ux}popover`,[e])}const dY=(...e)=>ge(">",[oe(...e)]);function Ze(e,t){return e+(t==="default"?"":t.replace(/^[a-z]/,r=>r.toUpperCase()))}let dS;function hY(){return dS===void 0&&(dS=navigator.userAgent.includes("Node.js")||navigator.userAgent.includes("jsdom")),dS}const qu=typeof document<"u"&&typeof window<"u",fY=new WeakSet;function dg(e){fY.add(e)}function pY(e,t,r){var i;const n=_t(e,null);if(n===null)return;const a=(i=xh())===null||i===void 0?void 0:i.proxy;rr(r,o),o(r.value),la(()=>{o(void 0,r.value)});function o(c,u){if(!n)return;const d=n[t];u!==void 0&&s(d,u),c!==void 0&&l(d,c)}function s(c,u){c[u]||(c[u]=[]),c[u].splice(c[u].findIndex(d=>d===a),1)}function l(c,u){c[u]||(c[u]=[]),~c[u].findIndex(d=>d===a)||c[u].push(a)}}function mY(e,t,r){const i=me(e.value);let n=null;return rr(e,a=>{n!==null&&window.clearTimeout(n),a===!0?r&&!r.value?i.value=!0:n=window.setTimeout(()=>{i.value=!0},t):i.value=!1}),i}function vY(e){const t=me(!!e.value);if(t.value)return bp(t);const r=rr(e,i=>{i&&(t.value=!0,r())});return bp(t)}function qi(e){const t=re(e),r=me(t.value);return rr(t,i=>{r.value=i}),typeof e=="function"?r:{__v_isRef:!0,get value(){return r.value},set value(i){e.set(i)}}}function gY(){return xh()!==null}const yY=typeof window<"u";let ep,kv;const bY=()=>{var e,t;ep=yY?(t=(e=document)===null||e===void 0?void 0:e.fonts)===null||t===void 0?void 0:t.ready:void 0,kv=!1,ep!==void 0?ep.then(()=>{kv=!0}):kv=!0};bY();function BN(e){if(kv)return;let t=!1;Or(()=>{kv||ep==null||ep.then(()=>{t||e()})}),la(()=>{t=!0})}function Rb(e){return e.composedPath()[0]}const xY={mousemoveoutside:new WeakMap,clickoutside:new WeakMap};function wY(e,t,r){if(e==="mousemoveoutside"){const i=n=>{t.contains(Rb(n))||r(n)};return{mousemove:i,touchstart:i}}else if(e==="clickoutside"){let i=!1;const n=o=>{i=!t.contains(Rb(o))},a=o=>{i&&(t.contains(Rb(o))||r(o))};return{mousedown:n,mouseup:a,touchstart:n,touchend:a}}return console.error(`[evtd/create-trap-handler]: name \`${e}\` is invalid. This could be a bug of evtd.`),{}}function FN(e,t,r){const i=xY[e];let n=i.get(t);n===void 0&&i.set(t,n=new WeakMap);let a=n.get(r);return a===void 0&&n.set(r,a=wY(e,t,r)),a}function SY(e,t,r,i){if(e==="mousemoveoutside"||e==="clickoutside"){const n=FN(e,t,r);return Object.keys(n).forEach(a=>{Ui(a,document,n[a],i)}),!0}return!1}function CY(e,t,r,i){if(e==="mousemoveoutside"||e==="clickoutside"){const n=FN(e,t,r);return Object.keys(n).forEach(a=>{Si(a,document,n[a],i)}),!0}return!1}function _Y(){if(typeof window>"u")return{on:()=>{},off:()=>{}};const e=new WeakMap,t=new WeakMap;function r(){e.set(this,!0)}function i(){e.set(this,!0),t.set(this,!0)}function n(_,C,A){const M=_[C];return _[C]=function(){return A.apply(_,arguments),M.apply(_,arguments)},_}function a(_,C){_[C]=Event.prototype[C]}const o=new WeakMap,s=Object.getOwnPropertyDescriptor(Event.prototype,"currentTarget");function l(){var _;return(_=o.get(this))!==null&&_!==void 0?_:null}function c(_,C){s!==void 0&&Object.defineProperty(_,"currentTarget",{configurable:!0,enumerable:!0,get:C??s.get})}const u={bubble:{},capture:{}},d={};function h(){const _=function(C){const{type:A,eventPhase:M,bubbles:P}=C,T=Rb(C);if(M===2)return;const R=M===1?"capture":"bubble";let z=T;const F=[];for(;z===null&&(z=window),F.push(z),z!==window;)z=z.parentNode||null;const H=u.capture[A],N=u.bubble[A];if(n(C,"stopPropagation",r),n(C,"stopImmediatePropagation",i),c(C,l),R==="capture"){if(H===void 0)return;for(let U=F.length-1;U>=0&&!e.has(C);--U){const ie=F[U],te=H.get(ie);if(te!==void 0){o.set(C,ie);for(const X of te){if(t.has(C))break;X(C)}}if(U===0&&!P&&N!==void 0){const X=N.get(ie);if(X!==void 0)for(const W of X){if(t.has(C))break;W(C)}}}}else if(R==="bubble"){if(N===void 0)return;for(let U=0;U<F.length&&!e.has(C);++U){const ie=F[U],te=N.get(ie);if(te!==void 0){o.set(C,ie);for(const X of te){if(t.has(C))break;X(C)}}}}a(C,"stopPropagation"),a(C,"stopImmediatePropagation"),c(C)};return _.displayName="evtdUnifiedHandler",_}function f(){const _=function(C){const{type:A,eventPhase:M}=C;if(M!==2)return;const P=d[A];P!==void 0&&P.forEach(T=>T(C))};return _.displayName="evtdUnifiedWindowEventHandler",_}const p=h(),v=f();function m(_,C){const A=u[_];return A[C]===void 0&&(A[C]=new Map,window.addEventListener(C,p,_==="capture")),A[C]}function g(_){return d[_]===void 0&&(d[_]=new Set,window.addEventListener(_,v)),d[_]}function y(_,C){let A=_.get(C);return A===void 0&&_.set(C,A=new Set),A}function b(_,C,A,M){const P=u[C][A];if(P!==void 0){const T=P.get(_);if(T!==void 0&&T.has(M))return!0}return!1}function x(_,C){const A=d[_];return!!(A!==void 0&&A.has(C))}function S(_,C,A,M){let P;if(typeof M=="object"&&M.once===!0?P=H=>{w(_,C,P,M),A(H)}:P=A,SY(_,C,P,M))return;const R=M===!0||typeof M=="object"&&M.capture===!0?"capture":"bubble",z=m(R,_),F=y(z,C);if(F.has(P)||F.add(P),C===window){const H=g(_);H.has(P)||H.add(P)}}function w(_,C,A,M){if(CY(_,C,A,M))return;const T=M===!0||typeof M=="object"&&M.capture===!0,R=T?"capture":"bubble",z=m(R,_),F=y(z,C);if(C===window&&!b(C,T?"bubble":"capture",_,A)&&x(_,A)){const N=d[_];N.delete(A),N.size===0&&(window.removeEventListener(_,v),d[_]=void 0)}F.has(A)&&F.delete(A),F.size===0&&z.delete(C),z.size===0&&(window.removeEventListener(_,p,R==="capture"),u[R][_]=void 0)}return{on:S,off:w}}const{on:Ui,off:Si}=_Y();function Hn(e,t){return rr(e,r=>{r!==void 0&&(t.value=r)}),re(()=>e.value===void 0?t.value:e.value)}function Yu(){const e=me(!1);return Or(()=>{e.value=!0}),bp(e)}function Sp(e,t){return re(()=>{for(const r of t)if(e[r]!==void 0)return e[r];return e[t[t.length-1]]})}const AY=(typeof window>"u"?!1:/iPad|iPhone|iPod/.test(navigator.platform)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1)&&!window.MSStream;function MY(){return AY}function RT(e={},t){const r=Wu({ctrl:!1,command:!1,win:!1,shift:!1,tab:!1}),{keydown:i,keyup:n}=e,a=l=>{switch(l.key){case"Control":r.ctrl=!0;break;case"Meta":r.command=!0,r.win=!0;break;case"Shift":r.shift=!0;break;case"Tab":r.tab=!0;break}i!==void 0&&Object.keys(i).forEach(c=>{if(c!==l.key)return;const u=i[c];if(typeof u=="function")u(l);else{const{stop:d=!1,prevent:h=!1}=u;d&&l.stopPropagation(),h&&l.preventDefault(),u.handler(l)}})},o=l=>{switch(l.key){case"Control":r.ctrl=!1;break;case"Meta":r.command=!1,r.win=!1;break;case"Shift":r.shift=!1;break;case"Tab":r.tab=!1;break}n!==void 0&&Object.keys(n).forEach(c=>{if(c!==l.key)return;const u=n[c];if(typeof u=="function")u(l);else{const{stop:d=!1,prevent:h=!1}=u;d&&l.stopPropagation(),h&&l.preventDefault(),u.handler(l)}})},s=()=>{(t===void 0||t.value)&&(Ui("keydown",document,a),Ui("keyup",document,o)),t!==void 0&&rr(t,l=>{l?(Ui("keydown",document,a),Ui("keyup",document,o)):(Si("keydown",document,a),Si("keyup",document,o))})};return gY()?(Kg(s),la(()=>{(t===void 0||t.value)&&(Si("keydown",document,a),Si("keyup",document,o))})):s(),bp(r)}const IT="n-internal-select-menu",NN="n-internal-select-menu-body",zT="n-modal-body",kT="n-drawer-body",iw="n-popover-body",UN="__disabled__";function Wn(e){const t=_t(zT,null),r=_t(kT,null),i=_t(iw,null),n=_t(NN,null),a=me();if(typeof document<"u"){a.value=document.fullscreenElement;const o=()=>{a.value=document.fullscreenElement};Or(()=>{Ui("fullscreenchange",document,o)}),la(()=>{Si("fullscreenchange",document,o)})}return qi(()=>{var o;const{to:s}=e;return s!==void 0?s===!1?UN:s===!0?a.value||"body":s:t!=null&&t.value?(o=t.value.$el)!==null&&o!==void 0?o:t.value:r!=null&&r.value?r.value:i!=null&&i.value?i.value:n!=null&&n.value?n.value:s??(a.value||"body")})}Wn.tdkey=UN;Wn.propTo={type:[String,Object,Boolean],default:void 0};let mO=!1;function EY(){if(qu&&window.CSS&&!mO&&(mO=!0,"registerProperty"in(window==null?void 0:window.CSS)))try{CSS.registerProperty({name:"--n-color-start",syntax:"<color>",inherits:!1,initialValue:"#0000"}),CSS.registerProperty({name:"--n-color-end",syntax:"<color>",inherits:!1,initialValue:"#0000"})}catch{}}function D2(e,t,r="default"){const i=t[r];if(i===void 0)throw new Error(`[vueuc/${e}]: slot[${r}] is empty.`);return i()}function O2(e,t=!0,r=[]){return e.forEach(i=>{if(i!==null){if(typeof i!="object"){(typeof i=="string"||typeof i=="number")&&r.push(Lr(String(i)));return}if(Array.isArray(i)){O2(i,t,r);return}if(i.type===mr){if(i.children===null)return;Array.isArray(i.children)&&O2(i.children,t,r)}else i.type!==zn&&r.push(i)}}),r}function vO(e,t,r="default"){const i=t[r];if(i===void 0)throw new Error(`[vueuc/${e}]: slot[${r}] is empty.`);const n=O2(i());if(n.length===1)return n[0];throw new Error(`[vueuc/${e}]: slot[${r}] should have exactly one child.`)}let Dc=null;function jN(){if(Dc===null&&(Dc=document.getElementById("v-binder-view-measurer"),Dc===null)){Dc=document.createElement("div"),Dc.id="v-binder-view-measurer";const{style:e}=Dc;e.position="fixed",e.left="0",e.right="0",e.top="0",e.bottom="0",e.pointerEvents="none",e.visibility="hidden",document.body.appendChild(Dc)}return Dc.getBoundingClientRect()}function TY(e,t){const r=jN();return{top:t,left:e,height:0,width:0,right:r.width-e,bottom:r.height-t}}function hS(e){const t=e.getBoundingClientRect(),r=jN();return{left:t.left-r.left,top:t.top-r.top,bottom:r.height+r.top-t.bottom,right:r.width+r.left-t.right,width:t.width,height:t.height}}function PY(e){return e.nodeType===9?null:e.parentNode}function VN(e){if(e===null)return null;const t=PY(e);if(t===null)return null;if(t.nodeType===9)return document;if(t.nodeType===1){const{overflow:r,overflowX:i,overflowY:n}=getComputedStyle(t);if(/(auto|scroll|overlay)/.test(r+n+i))return t}return VN(t)}const wh=je({name:"Binder",props:{syncTargetWithParent:Boolean,syncTarget:{type:Boolean,default:!0}},setup(e){var t;xr("VBinder",(t=xh())===null||t===void 0?void 0:t.proxy);const r=_t("VBinder",null),i=me(null),n=g=>{i.value=g,r&&e.syncTargetWithParent&&r.setTargetRef(g)};let a=[];const o=()=>{let g=i.value;for(;g=VN(g),g!==null;)a.push(g);for(const y of a)Ui("scroll",y,d,!0)},s=()=>{for(const g of a)Si("scroll",g,d,!0);a=[]},l=new Set,c=g=>{l.size===0&&o(),l.has(g)||l.add(g)},u=g=>{l.has(g)&&l.delete(g),l.size===0&&s()},d=()=>{AN(h)},h=()=>{l.forEach(g=>g())},f=new Set,p=g=>{f.size===0&&Ui("resize",window,m),f.has(g)||f.add(g)},v=g=>{f.has(g)&&f.delete(g),f.size===0&&Si("resize",window,m)},m=()=>{f.forEach(g=>g())};return la(()=>{Si("resize",window,m),s()}),{targetRef:i,setTargetRef:n,addScrollListener:c,removeScrollListener:u,addResizeListener:p,removeResizeListener:v}},render(){return D2("binder",this.$slots)}}),Sh=je({name:"Target",setup(){const{setTargetRef:e,syncTarget:t}=_t("VBinder");return{syncTarget:t,setTargetDirective:{mounted:e,updated:e}}},render(){const{syncTarget:e,setTargetDirective:t}=this;return e?io(vO("follower",this.$slots),[[t]]):vO("follower",this.$slots)}}),Uh="@@mmoContext",DY={mounted(e,{value:t}){e[Uh]={handler:void 0},typeof t=="function"&&(e[Uh].handler=t,Ui("mousemoveoutside",e,t))},updated(e,{value:t}){const r=e[Uh];typeof t=="function"?r.handler?r.handler!==t&&(Si("mousemoveoutside",e,r.handler),r.handler=t,Ui("mousemoveoutside",e,t)):(e[Uh].handler=t,Ui("mousemoveoutside",e,t)):r.handler&&(Si("mousemoveoutside",e,r.handler),r.handler=void 0)},unmounted(e){const{handler:t}=e[Uh];t&&Si("mousemoveoutside",e,t),e[Uh].handler=void 0}},jh="@@coContext",Ru={mounted(e,{value:t,modifiers:r}){e[jh]={handler:void 0},typeof t=="function"&&(e[jh].handler=t,Ui("clickoutside",e,t,{capture:r.capture}))},updated(e,{value:t,modifiers:r}){const i=e[jh];typeof t=="function"?i.handler?i.handler!==t&&(Si("clickoutside",e,i.handler,{capture:r.capture}),i.handler=t,Ui("clickoutside",e,t,{capture:r.capture})):(e[jh].handler=t,Ui("clickoutside",e,t,{capture:r.capture})):i.handler&&(Si("clickoutside",e,i.handler,{capture:r.capture}),i.handler=void 0)},unmounted(e,{modifiers:t}){const{handler:r}=e[jh];r&&Si("clickoutside",e,r,{capture:t.capture}),e[jh].handler=void 0}};function OY(e,t){console.error(`[vdirs/${e}]: ${t}`)}class RY{constructor(){this.elementZIndex=new Map,this.nextZIndex=2e3}get elementCount(){return this.elementZIndex.size}ensureZIndex(t,r){const{elementZIndex:i}=this;if(r!==void 0){t.style.zIndex=`${r}`,i.delete(t);return}const{nextZIndex:n}=this;i.has(t)&&i.get(t)+1===this.nextZIndex||(t.style.zIndex=`${n}`,i.set(t,n),this.nextZIndex=n+1,this.squashState())}unregister(t,r){const{elementZIndex:i}=this;i.has(t)?i.delete(t):r===void 0&&OY("z-index-manager/unregister-element","Element not found when unregistering."),this.squashState()}squashState(){const{elementCount:t}=this;t||(this.nextZIndex=2e3),this.nextZIndex-t>2500&&this.rearrange()}rearrange(){const t=Array.from(this.elementZIndex.entries());t.sort((r,i)=>r[1]-i[1]),this.nextZIndex=2e3,t.forEach(r=>{const i=r[0],n=this.nextZIndex++;`${n}`!==i.style.zIndex&&(i.style.zIndex=`${n}`)})}}const fS=new RY,Vh="@@ziContext",HN={mounted(e,t){const{value:r={}}=t,{zIndex:i,enabled:n}=r;e[Vh]={enabled:!!n,initialized:!1},n&&(fS.ensureZIndex(e,i),e[Vh].initialized=!0)},updated(e,t){const{value:r={}}=t,{zIndex:i,enabled:n}=r,a=e[Vh].enabled;n&&!a&&(fS.ensureZIndex(e,i),e[Vh].initialized=!0),e[Vh].enabled=!!n},unmounted(e,t){if(!e[Vh].initialized)return;const{value:r={}}=t,{zIndex:i}=r;fS.unregister(e,i)}},IY="@css-render/vue3-ssr";function zY(e,t){return`<style cssr-id="${e}">
${t}
</style>`}function kY(e,t,r){const{styles:i,ids:n}=r;n.has(e)||i!==null&&(n.add(e),i.push(zY(e,t)))}const LY=typeof document<"u";function Xu(){if(LY)return;const e=_t(IY,null);if(e!==null)return{adapter:(t,r)=>kY(t,r,e),context:e}}function gO(e,t){console.error(`[vueuc/${e}]: ${t}`)}const{c:el}=RN(),nw="vueuc-style";function yO(e){return e&-e}class BY{constructor(t,r){this.l=t,this.min=r;const i=new Array(t+1);for(let n=0;n<t+1;++n)i[n]=0;this.ft=i}add(t,r){if(r===0)return;const{l:i,ft:n}=this;for(t+=1;t<=i;)n[t]+=r,t+=yO(t)}get(t){return this.sum(t+1)-this.sum(t)}sum(t){if(t===void 0&&(t=this.l),t<=0)return 0;const{ft:r,min:i,l:n}=this;if(t>n)throw new Error("[FinweckTree.sum]: `i` is larger than length.");let a=t*i;for(;t>0;)a+=r[t],t-=yO(t);return a}getBound(t){let r=0,i=this.l;for(;i>r;){const n=Math.floor((r+i)/2),a=this.sum(n);if(a>t){i=n;continue}else if(a<t){if(r===n)return this.sum(r+1)<=t?r+1:n;r=n}else return n}return r}}function bO(e){return typeof e=="string"?document.querySelector(e):e()}const FY=je({name:"LazyTeleport",props:{to:{type:[String,Object],default:void 0},disabled:Boolean,show:{type:Boolean,required:!0}},setup(e){return{showTeleport:vY(pt(e,"show")),mergedTo:re(()=>{const{to:t}=e;return t??"body"})}},render(){return this.showTeleport?this.disabled?D2("lazy-teleport",this.$slots):E(cN,{disabled:this.disabled,to:this.mergedTo},D2("lazy-teleport",this.$slots)):null}}),V0={top:"bottom",bottom:"top",left:"right",right:"left"},xO={start:"end",center:"center",end:"start"},pS={top:"height",bottom:"height",left:"width",right:"width"},NY={"bottom-start":"top left",bottom:"top center","bottom-end":"top right","top-start":"bottom left",top:"bottom center","top-end":"bottom right","right-start":"top left",right:"center left","right-end":"bottom left","left-start":"top right",left:"center right","left-end":"bottom right"},UY={"bottom-start":"bottom left",bottom:"bottom center","bottom-end":"bottom right","top-start":"top left",top:"top center","top-end":"top right","right-start":"top right",right:"center right","right-end":"bottom right","left-start":"top left",left:"center left","left-end":"bottom left"},jY={"bottom-start":"right","bottom-end":"left","top-start":"right","top-end":"left","right-start":"bottom","right-end":"top","left-start":"bottom","left-end":"top"},wO={top:!0,bottom:!1,left:!0,right:!1},SO={top:"end",bottom:"start",left:"end",right:"start"};function VY(e,t,r,i,n,a){if(!n||a)return{placement:e,top:0,left:0};const[o,s]=e.split("-");let l=s??"center",c={top:0,left:0};const u=(f,p,v)=>{let m=0,g=0;const y=r[f]-t[p]-t[f];return y>0&&i&&(v?g=wO[p]?y:-y:m=wO[p]?y:-y),{left:m,top:g}},d=o==="left"||o==="right";if(l!=="center"){const f=jY[e],p=V0[f],v=pS[f];if(r[v]>t[v]){if(t[f]+t[v]<r[v]){const m=(r[v]-t[v])/2;t[f]<m||t[p]<m?t[f]<t[p]?(l=xO[s],c=u(v,p,d)):c=u(v,f,d):l="center"}}else r[v]<t[v]&&t[p]<0&&t[f]>t[p]&&(l=xO[s])}else{const f=o==="bottom"||o==="top"?"left":"top",p=V0[f],v=pS[f],m=(r[v]-t[v])/2;(t[f]<m||t[p]<m)&&(t[f]>t[p]?(l=SO[f],c=u(v,f,d)):(l=SO[p],c=u(v,p,d)))}let h=o;return t[o]<r[pS[o]]&&t[o]<t[V0[o]]&&(h=V0[o]),{placement:l!=="center"?`${h}-${l}`:h,left:c.left,top:c.top}}function HY(e,t){return t?UY[e]:NY[e]}function WY(e,t,r,i,n,a){if(a)switch(e){case"bottom-start":return{top:`${Math.round(r.top-t.top+r.height)}px`,left:`${Math.round(r.left-t.left)}px`,transform:"translateY(-100%)"};case"bottom-end":return{top:`${Math.round(r.top-t.top+r.height)}px`,left:`${Math.round(r.left-t.left+r.width)}px`,transform:"translateX(-100%) translateY(-100%)"};case"top-start":return{top:`${Math.round(r.top-t.top)}px`,left:`${Math.round(r.left-t.left)}px`,transform:""};case"top-end":return{top:`${Math.round(r.top-t.top)}px`,left:`${Math.round(r.left-t.left+r.width)}px`,transform:"translateX(-100%)"};case"right-start":return{top:`${Math.round(r.top-t.top)}px`,left:`${Math.round(r.left-t.left+r.width)}px`,transform:"translateX(-100%)"};case"right-end":return{top:`${Math.round(r.top-t.top+r.height)}px`,left:`${Math.round(r.left-t.left+r.width)}px`,transform:"translateX(-100%) translateY(-100%)"};case"left-start":return{top:`${Math.round(r.top-t.top)}px`,left:`${Math.round(r.left-t.left)}px`,transform:""};case"left-end":return{top:`${Math.round(r.top-t.top+r.height)}px`,left:`${Math.round(r.left-t.left)}px`,transform:"translateY(-100%)"};case"top":return{top:`${Math.round(r.top-t.top)}px`,left:`${Math.round(r.left-t.left+r.width/2)}px`,transform:"translateX(-50%)"};case"right":return{top:`${Math.round(r.top-t.top+r.height/2)}px`,left:`${Math.round(r.left-t.left+r.width)}px`,transform:"translateX(-100%) translateY(-50%)"};case"left":return{top:`${Math.round(r.top-t.top+r.height/2)}px`,left:`${Math.round(r.left-t.left)}px`,transform:"translateY(-50%)"};case"bottom":default:return{top:`${Math.round(r.top-t.top+r.height)}px`,left:`${Math.round(r.left-t.left+r.width/2)}px`,transform:"translateX(-50%) translateY(-100%)"}}switch(e){case"bottom-start":return{top:`${Math.round(r.top-t.top+r.height+i)}px`,left:`${Math.round(r.left-t.left+n)}px`,transform:""};case"bottom-end":return{top:`${Math.round(r.top-t.top+r.height+i)}px`,left:`${Math.round(r.left-t.left+r.width+n)}px`,transform:"translateX(-100%)"};case"top-start":return{top:`${Math.round(r.top-t.top+i)}px`,left:`${Math.round(r.left-t.left+n)}px`,transform:"translateY(-100%)"};case"top-end":return{top:`${Math.round(r.top-t.top+i)}px`,left:`${Math.round(r.left-t.left+r.width+n)}px`,transform:"translateX(-100%) translateY(-100%)"};case"right-start":return{top:`${Math.round(r.top-t.top+i)}px`,left:`${Math.round(r.left-t.left+r.width+n)}px`,transform:""};case"right-end":return{top:`${Math.round(r.top-t.top+r.height+i)}px`,left:`${Math.round(r.left-t.left+r.width+n)}px`,transform:"translateY(-100%)"};case"left-start":return{top:`${Math.round(r.top-t.top+i)}px`,left:`${Math.round(r.left-t.left+n)}px`,transform:"translateX(-100%)"};case"left-end":return{top:`${Math.round(r.top-t.top+r.height+i)}px`,left:`${Math.round(r.left-t.left+n)}px`,transform:"translateX(-100%) translateY(-100%)"};case"top":return{top:`${Math.round(r.top-t.top+i)}px`,left:`${Math.round(r.left-t.left+r.width/2+n)}px`,transform:"translateY(-100%) translateX(-50%)"};case"right":return{top:`${Math.round(r.top-t.top+r.height/2+i)}px`,left:`${Math.round(r.left-t.left+r.width+n)}px`,transform:"translateY(-50%)"};case"left":return{top:`${Math.round(r.top-t.top+r.height/2+i)}px`,left:`${Math.round(r.left-t.left+n)}px`,transform:"translateY(-50%) translateX(-100%)"};case"bottom":default:return{top:`${Math.round(r.top-t.top+r.height+i)}px`,left:`${Math.round(r.left-t.left+r.width/2+n)}px`,transform:"translateX(-50%)"}}}const GY=el([el(".v-binder-follower-container",{position:"absolute",left:"0",right:"0",top:"0",height:"0",pointerEvents:"none",zIndex:"auto"}),el(".v-binder-follower-content",{position:"absolute",zIndex:"auto"},[el("> *",{pointerEvents:"all"})])]),Ch=je({name:"Follower",inheritAttrs:!1,props:{show:Boolean,enabled:{type:Boolean,default:void 0},placement:{type:String,default:"bottom"},syncTrigger:{type:Array,default:["resize","scroll"]},to:[String,Object],flip:{type:Boolean,default:!0},internalShift:Boolean,x:Number,y:Number,width:String,minWidth:String,containerClass:String,teleportDisabled:Boolean,zindexable:{type:Boolean,default:!0},zIndex:Number,overlap:Boolean},setup(e){const t=_t("VBinder"),r=qi(()=>e.enabled!==void 0?e.enabled:e.show),i=me(null),n=me(null),a=()=>{const{syncTrigger:h}=e;h.includes("scroll")&&t.addScrollListener(l),h.includes("resize")&&t.addResizeListener(l)},o=()=>{t.removeScrollListener(l),t.removeResizeListener(l)};Or(()=>{r.value&&(l(),a())});const s=Xu();GY.mount({id:"vueuc/binder",head:!0,anchorMetaName:nw,ssr:s}),la(()=>{o()}),BN(()=>{r.value&&l()});const l=()=>{if(!r.value)return;const h=i.value;if(h===null)return;const f=t.targetRef,{x:p,y:v,overlap:m}=e,g=p!==void 0&&v!==void 0?TY(p,v):hS(f);h.style.setProperty("--v-target-width",`${Math.round(g.width)}px`),h.style.setProperty("--v-target-height",`${Math.round(g.height)}px`);const{width:y,minWidth:b,placement:x,internalShift:S,flip:w}=e;h.setAttribute("v-placement",x),m?h.setAttribute("v-overlap",""):h.removeAttribute("v-overlap");const{style:_}=h;y==="target"?_.width=`${g.width}px`:y!==void 0?_.width=y:_.width="",b==="target"?_.minWidth=`${g.width}px`:b!==void 0?_.minWidth=b:_.minWidth="";const C=hS(h),A=hS(n.value),{left:M,top:P,placement:T}=VY(x,g,C,S,w,m),R=HY(T,m),{left:z,top:F,transform:H}=WY(T,A,g,P,M,m);h.setAttribute("v-placement",T),h.style.setProperty("--v-offset-left",`${Math.round(M)}px`),h.style.setProperty("--v-offset-top",`${Math.round(P)}px`),h.style.transform=`translateX(${z}) translateY(${F}) ${H}`,h.style.setProperty("--v-transform-origin",R),h.style.transformOrigin=R};rr(r,h=>{h?(a(),c()):o()});const c=()=>{aa().then(l).catch(h=>console.error(h))};["placement","x","y","internalShift","flip","width","overlap","minWidth"].forEach(h=>{rr(pt(e,h),l)}),["teleportDisabled"].forEach(h=>{rr(pt(e,h),c)}),rr(pt(e,"syncTrigger"),h=>{h.includes("resize")?t.addResizeListener(l):t.removeResizeListener(l),h.includes("scroll")?t.addScrollListener(l):t.removeScrollListener(l)});const u=Yu(),d=qi(()=>{const{to:h}=e;if(h!==void 0)return h;u.value});return{VBinder:t,mergedEnabled:r,offsetContainerRef:n,followerRef:i,mergedTo:d,syncPosition:l}},render(){return E(FY,{show:this.show,to:this.mergedTo,disabled:this.teleportDisabled},{default:()=>{var e,t;const r=E("div",{class:["v-binder-follower-container",this.containerClass],ref:"offsetContainerRef"},[E("div",{class:"v-binder-follower-content",ref:"followerRef"},(t=(e=this.$slots).default)===null||t===void 0?void 0:t.call(e))]);return this.zindexable?io(r,[[HN,{enabled:this.mergedEnabled,zIndex:this.zIndex}]]):r}})}});var $d=[],$Y=function(){return $d.some(function(e){return e.activeTargets.length>0})},qY=function(){return $d.some(function(e){return e.skippedTargets.length>0})},CO="ResizeObserver loop completed with undelivered notifications.",YY=function(){var e;typeof ErrorEvent=="function"?e=new ErrorEvent("error",{message:CO}):(e=document.createEvent("Event"),e.initEvent("error",!1,!1),e.message=CO),window.dispatchEvent(e)},hg;(function(e){e.BORDER_BOX="border-box",e.CONTENT_BOX="content-box",e.DEVICE_PIXEL_CONTENT_BOX="device-pixel-content-box"})(hg||(hg={}));var qd=function(e){return Object.freeze(e)},XY=function(){function e(t,r){this.inlineSize=t,this.blockSize=r,qd(this)}return e}(),WN=function(){function e(t,r,i,n){return this.x=t,this.y=r,this.width=i,this.height=n,this.top=this.y,this.left=this.x,this.bottom=this.top+this.height,this.right=this.left+this.width,qd(this)}return e.prototype.toJSON=function(){var t=this,r=t.x,i=t.y,n=t.top,a=t.right,o=t.bottom,s=t.left,l=t.width,c=t.height;return{x:r,y:i,top:n,right:a,bottom:o,left:s,width:l,height:c}},e.fromRect=function(t){return new e(t.x,t.y,t.width,t.height)},e}(),LT=function(e){return e instanceof SVGElement&&"getBBox"in e},GN=function(e){if(LT(e)){var t=e.getBBox(),r=t.width,i=t.height;return!r&&!i}var n=e,a=n.offsetWidth,o=n.offsetHeight;return!(a||o||e.getClientRects().length)},_O=function(e){var t;if(e instanceof Element)return!0;var r=(t=e==null?void 0:e.ownerDocument)===null||t===void 0?void 0:t.defaultView;return!!(r&&e instanceof r.Element)},KY=function(e){switch(e.tagName){case"INPUT":if(e.type!=="image")break;case"VIDEO":case"AUDIO":case"EMBED":case"OBJECT":case"CANVAS":case"IFRAME":case"IMG":return!0}return!1},Lv=typeof window<"u"?window:{},H0=new WeakMap,AO=/auto|scroll/,QY=/^tb|vertical/,ZY=/msie|trident/i.test(Lv.navigator&&Lv.navigator.userAgent),Ps=function(e){return parseFloat(e||"0")},tp=function(e,t,r){return e===void 0&&(e=0),t===void 0&&(t=0),r===void 0&&(r=!1),new XY((r?t:e)||0,(r?e:t)||0)},MO=qd({devicePixelContentBoxSize:tp(),borderBoxSize:tp(),contentBoxSize:tp(),contentRect:new WN(0,0,0,0)}),$N=function(e,t){if(t===void 0&&(t=!1),H0.has(e)&&!t)return H0.get(e);if(GN(e))return H0.set(e,MO),MO;var r=getComputedStyle(e),i=LT(e)&&e.ownerSVGElement&&e.getBBox(),n=!ZY&&r.boxSizing==="border-box",a=QY.test(r.writingMode||""),o=!i&&AO.test(r.overflowY||""),s=!i&&AO.test(r.overflowX||""),l=i?0:Ps(r.paddingTop),c=i?0:Ps(r.paddingRight),u=i?0:Ps(r.paddingBottom),d=i?0:Ps(r.paddingLeft),h=i?0:Ps(r.borderTopWidth),f=i?0:Ps(r.borderRightWidth),p=i?0:Ps(r.borderBottomWidth),v=i?0:Ps(r.borderLeftWidth),m=d+c,g=l+u,y=v+f,b=h+p,x=s?e.offsetHeight-b-e.clientHeight:0,S=o?e.offsetWidth-y-e.clientWidth:0,w=n?m+y:0,_=n?g+b:0,C=i?i.width:Ps(r.width)-w-S,A=i?i.height:Ps(r.height)-_-x,M=C+m+S+y,P=A+g+x+b,T=qd({devicePixelContentBoxSize:tp(Math.round(C*devicePixelRatio),Math.round(A*devicePixelRatio),a),borderBoxSize:tp(M,P,a),contentBoxSize:tp(C,A,a),contentRect:new WN(d,l,C,A)});return H0.set(e,T),T},qN=function(e,t,r){var i=$N(e,r),n=i.borderBoxSize,a=i.contentBoxSize,o=i.devicePixelContentBoxSize;switch(t){case hg.DEVICE_PIXEL_CONTENT_BOX:return o;case hg.BORDER_BOX:return n;default:return a}},JY=function(){function e(t){var r=$N(t);this.target=t,this.contentRect=r.contentRect,this.borderBoxSize=qd([r.borderBoxSize]),this.contentBoxSize=qd([r.contentBoxSize]),this.devicePixelContentBoxSize=qd([r.devicePixelContentBoxSize])}return e}(),YN=function(e){if(GN(e))return 1/0;for(var t=0,r=e.parentNode;r;)t+=1,r=r.parentNode;return t},eX=function(){var e=1/0,t=[];$d.forEach(function(o){if(o.activeTargets.length!==0){var s=[];o.activeTargets.forEach(function(c){var u=new JY(c.target),d=YN(c.target);s.push(u),c.lastReportedSize=qN(c.target,c.observedBox),d<e&&(e=d)}),t.push(function(){o.callback.call(o.observer,s,o.observer)}),o.activeTargets.splice(0,o.activeTargets.length)}});for(var r=0,i=t;r<i.length;r++){var n=i[r];n()}return e},EO=function(e){$d.forEach(function(r){r.activeTargets.splice(0,r.activeTargets.length),r.skippedTargets.splice(0,r.skippedTargets.length),r.observationTargets.forEach(function(n){n.isActive()&&(YN(n.target)>e?r.activeTargets.push(n):r.skippedTargets.push(n))})})},tX=function(){var e=0;for(EO(e);$Y();)e=eX(),EO(e);return qY()&&YY(),e>0},mS,XN=[],rX=function(){return XN.splice(0).forEach(function(e){return e()})},iX=function(e){if(!mS){var t=0,r=document.createTextNode(""),i={characterData:!0};new MutationObserver(function(){return rX()}).observe(r,i),mS=function(){r.textContent="".concat(t?t--:t++)}}XN.push(e),mS()},nX=function(e){iX(function(){requestAnimationFrame(e)})},Ib=0,aX=function(){return!!Ib},oX=250,sX={attributes:!0,characterData:!0,childList:!0,subtree:!0},TO=["resize","load","transitionend","animationend","animationstart","animationiteration","keyup","keydown","mouseup","mousedown","mouseover","mouseout","blur","focus"],PO=function(e){return e===void 0&&(e=0),Date.now()+e},vS=!1,lX=function(){function e(){var t=this;this.stopped=!0,this.listener=function(){return t.schedule()}}return e.prototype.run=function(t){var r=this;if(t===void 0&&(t=oX),!vS){vS=!0;var i=PO(t);nX(function(){var n=!1;try{n=tX()}finally{if(vS=!1,t=i-PO(),!aX())return;n?r.run(1e3):t>0?r.run(t):r.start()}})}},e.prototype.schedule=function(){this.stop(),this.run()},e.prototype.observe=function(){var t=this,r=function(){return t.observer&&t.observer.observe(document.body,sX)};document.body?r():Lv.addEventListener("DOMContentLoaded",r)},e.prototype.start=function(){var t=this;this.stopped&&(this.stopped=!1,this.observer=new MutationObserver(this.listener),this.observe(),TO.forEach(function(r){return Lv.addEventListener(r,t.listener,!0)}))},e.prototype.stop=function(){var t=this;this.stopped||(this.observer&&this.observer.disconnect(),TO.forEach(function(r){return Lv.removeEventListener(r,t.listener,!0)}),this.stopped=!0)},e}(),R2=new lX,DO=function(e){!Ib&&e>0&&R2.start(),Ib+=e,!Ib&&R2.stop()},cX=function(e){return!LT(e)&&!KY(e)&&getComputedStyle(e).display==="inline"},uX=function(){function e(t,r){this.target=t,this.observedBox=r||hg.CONTENT_BOX,this.lastReportedSize={inlineSize:0,blockSize:0}}return e.prototype.isActive=function(){var t=qN(this.target,this.observedBox,!0);return cX(this.target)&&(this.lastReportedSize=t),this.lastReportedSize.inlineSize!==t.inlineSize||this.lastReportedSize.blockSize!==t.blockSize},e}(),dX=function(){function e(t,r){this.activeTargets=[],this.skippedTargets=[],this.observationTargets=[],this.observer=t,this.callback=r}return e}(),W0=new WeakMap,OO=function(e,t){for(var r=0;r<e.length;r+=1)if(e[r].target===t)return r;return-1},G0=function(){function e(){}return e.connect=function(t,r){var i=new dX(t,r);W0.set(t,i)},e.observe=function(t,r,i){var n=W0.get(t),a=n.observationTargets.length===0;OO(n.observationTargets,r)<0&&(a&&$d.push(n),n.observationTargets.push(new uX(r,i&&i.box)),DO(1),R2.schedule())},e.unobserve=function(t,r){var i=W0.get(t),n=OO(i.observationTargets,r),a=i.observationTargets.length===1;n>=0&&(a&&$d.splice($d.indexOf(i),1),i.observationTargets.splice(n,1),DO(-1))},e.disconnect=function(t){var r=this,i=W0.get(t);i.observationTargets.slice().forEach(function(n){return r.unobserve(t,n.target)}),i.activeTargets.splice(0,i.activeTargets.length)},e}(),hX=function(){function e(t){if(arguments.length===0)throw new TypeError("Failed to construct 'ResizeObserver': 1 argument required, but only 0 present.");if(typeof t!="function")throw new TypeError("Failed to construct 'ResizeObserver': The callback provided as parameter 1 is not a function.");G0.connect(this,t)}return e.prototype.observe=function(t,r){if(arguments.length===0)throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!_O(t))throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': parameter 1 is not of type 'Element");G0.observe(this,t,r)},e.prototype.unobserve=function(t){if(arguments.length===0)throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!_O(t))throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': parameter 1 is not of type 'Element");G0.unobserve(this,t)},e.prototype.disconnect=function(){G0.disconnect(this)},e.toString=function(){return"function ResizeObserver () { [polyfill code] }"},e}();class fX{constructor(){this.handleResize=this.handleResize.bind(this),this.observer=new(typeof window<"u"&&window.ResizeObserver||hX)(this.handleResize),this.elHandlersMap=new Map}handleResize(t){for(const r of t){const i=this.elHandlersMap.get(r.target);i!==void 0&&i(r)}}registerHandler(t,r){this.elHandlersMap.set(t,r),this.observer.observe(t)}unregisterHandler(t){this.elHandlersMap.has(t)&&(this.elHandlersMap.delete(t),this.observer.unobserve(t))}}const dx=new fX,nl=je({name:"ResizeObserver",props:{onResize:Function},setup(e){let t=!1;const r=xh().proxy;function i(n){const{onResize:a}=e;a!==void 0&&a(n)}Or(()=>{const n=r.$el;if(n===void 0){gO("resize-observer","$el does not exist.");return}if(n.nextElementSibling!==n.nextSibling&&n.nodeType===3&&n.nodeValue!==""){gO("resize-observer","$el can not be observed (it may be a text node).");return}n.nextElementSibling!==null&&(dx.registerHandler(n.nextElementSibling,i),t=!0)}),la(()=>{t&&dx.unregisterHandler(r.$el.nextElementSibling)})},render(){return gs(this.$slots,"default")}});let $0;function pX(){return typeof document>"u"?!1:($0===void 0&&("matchMedia"in window?$0=window.matchMedia("(pointer:coarse)").matches:$0=!1),$0)}let gS;function RO(){return typeof document>"u"?1:(gS===void 0&&(gS="chrome"in window?window.devicePixelRatio:1),gS)}const mX=el(".v-vl",{maxHeight:"inherit",height:"100%",overflow:"auto",minWidth:"1px"},[el("&:not(.v-vl--show-scrollbar)",{scrollbarWidth:"none"},[el("&::-webkit-scrollbar, &::-webkit-scrollbar-track-piece, &::-webkit-scrollbar-thumb",{width:0,height:0,display:"none"})])]),fg=je({name:"VirtualList",inheritAttrs:!1,props:{showScrollbar:{type:Boolean,default:!0},items:{type:Array,default:()=>[]},itemSize:{type:Number,required:!0},itemResizable:Boolean,itemsStyle:[String,Object],visibleItemsTag:{type:[String,Object],default:"div"},visibleItemsProps:Object,ignoreItemResize:Boolean,onScroll:Function,onWheel:Function,onResize:Function,defaultScrollKey:[Number,String],defaultScrollIndex:Number,keyField:{type:String,default:"key"},paddingTop:{type:[Number,String],default:0},paddingBottom:{type:[Number,String],default:0}},setup(e){const t=Xu();mX.mount({id:"vueuc/virtual-list",head:!0,anchorMetaName:nw,ssr:t}),Or(()=>{const{defaultScrollIndex:P,defaultScrollKey:T}=e;P!=null?p({index:P}):T!=null&&p({key:T})});let r=!1,i=!1;TT(()=>{if(r=!1,!i){i=!0;return}p({top:d.value,left:u})}),PT(()=>{r=!0,i||(i=!0)});const n=re(()=>{const P=new Map,{keyField:T}=e;return e.items.forEach((R,z)=>{P.set(R[T],z)}),P}),a=me(null),o=me(void 0),s=new Map,l=re(()=>{const{items:P,itemSize:T,keyField:R}=e,z=new BY(P.length,T);return P.forEach((F,H)=>{const N=F[R],U=s.get(N);U!==void 0&&z.add(H,U)}),z}),c=me(0);let u=0;const d=me(0),h=qi(()=>Math.max(l.value.getBound(d.value-nn(e.paddingTop))-1,0)),f=re(()=>{const{value:P}=o;if(P===void 0)return[];const{items:T,itemSize:R}=e,z=h.value,F=Math.min(z+Math.ceil(P/R+1),T.length-1),H=[];for(let N=z;N<=F;++N)H.push(T[N]);return H}),p=(P,T)=>{if(typeof P=="number"){y(P,T,"auto");return}const{left:R,top:z,index:F,key:H,position:N,behavior:U,debounce:ie=!0}=P;if(R!==void 0||z!==void 0)y(R,z,U);else if(F!==void 0)g(F,U,ie);else if(H!==void 0){const te=n.value.get(H);te!==void 0&&g(te,U,ie)}else N==="bottom"?y(0,Number.MAX_SAFE_INTEGER,U):N==="top"&&y(0,0,U)};let v,m=null;function g(P,T,R){const{value:z}=l,F=z.sum(P)+nn(e.paddingTop);if(!R)a.value.scrollTo({left:0,top:F,behavior:T});else{v=P,m!==null&&window.clearTimeout(m),m=window.setTimeout(()=>{v=void 0,m=null},16);const{scrollTop:H,offsetHeight:N}=a.value;if(F>H){const U=z.get(P);F+U<=H+N||a.value.scrollTo({left:0,top:F+U-N,behavior:T})}else a.value.scrollTo({left:0,top:F,behavior:T})}}function y(P,T,R){a.value.scrollTo({left:P,top:T,behavior:R})}function b(P,T){var R,z,F;if(r||e.ignoreItemResize||M(T.target))return;const{value:H}=l,N=n.value.get(P),U=H.get(N),ie=(F=(z=(R=T.borderBoxSize)===null||R===void 0?void 0:R[0])===null||z===void 0?void 0:z.blockSize)!==null&&F!==void 0?F:T.contentRect.height;if(ie===U)return;ie-e.itemSize===0?s.delete(P):s.set(P,ie-e.itemSize);const X=ie-U;if(X===0)return;H.add(N,X);const W=a.value;if(W!=null){if(v===void 0){const q=H.sum(N);W.scrollTop>q&&W.scrollBy(0,X)}else if(N<v)W.scrollBy(0,X);else if(N===v){const q=H.sum(N);ie+q>W.scrollTop+W.offsetHeight&&W.scrollBy(0,X)}A()}c.value++}const x=!pX();let S=!1;function w(P){var T;(T=e.onScroll)===null||T===void 0||T.call(e,P),(!x||!S)&&A()}function _(P){var T;if((T=e.onWheel)===null||T===void 0||T.call(e,P),x){const R=a.value;if(R!=null){if(P.deltaX===0&&(R.scrollTop===0&&P.deltaY<=0||R.scrollTop+R.offsetHeight>=R.scrollHeight&&P.deltaY>=0))return;P.preventDefault(),R.scrollTop+=P.deltaY/RO(),R.scrollLeft+=P.deltaX/RO(),A(),S=!0,AN(()=>{S=!1})}}}function C(P){if(r||M(P.target)||P.contentRect.height===o.value)return;o.value=P.contentRect.height;const{onResize:T}=e;T!==void 0&&T(P)}function A(){const{value:P}=a;P!=null&&(d.value=P.scrollTop,u=P.scrollLeft)}function M(P){let T=P;for(;T!==null;){if(T.style.display==="none")return!0;T=T.parentElement}return!1}return{listHeight:o,listStyle:{overflow:"auto"},keyToIndex:n,itemsStyle:re(()=>{const{itemResizable:P}=e,T=Pd(l.value.sum());return c.value,[e.itemsStyle,{boxSizing:"content-box",height:P?"":T,minHeight:P?T:"",paddingTop:Pd(e.paddingTop),paddingBottom:Pd(e.paddingBottom)}]}),visibleItemsStyle:re(()=>(c.value,{transform:`translateY(${Pd(l.value.sum(h.value))})`})),viewportItems:f,listElRef:a,itemsElRef:me(null),scrollTo:p,handleListResize:C,handleListScroll:w,handleListWheel:_,handleItemResize:b}},render(){const{itemResizable:e,keyField:t,keyToIndex:r,visibleItemsTag:i}=this;return E(nl,{onResize:this.handleListResize},{default:()=>{var n,a;return E("div",$u(this.$attrs,{class:["v-vl",this.showScrollbar&&"v-vl--show-scrollbar"],onScroll:this.handleListScroll,onWheel:this.handleListWheel,ref:"listElRef"}),[this.items.length!==0?E("div",{ref:"itemsElRef",class:"v-vl-items",style:this.itemsStyle},[E(i,Object.assign({class:"v-vl-visible-items",style:this.visibleItemsStyle},this.visibleItemsProps),{default:()=>this.viewportItems.map(o=>{const s=o[t],l=r.get(s),c=this.$slots.default({item:o,index:l})[0];return e?E(nl,{key:s,onResize:u=>this.handleItemResize(s,u)},{default:()=>c}):(c.key=s,c)})})]):(a=(n=this.$slots).empty)===null||a===void 0?void 0:a.call(n)])}})}}),vX=el(".v-x-scroll",{overflow:"auto",scrollbarWidth:"none"},[el("&::-webkit-scrollbar",{width:0,height:0})]),gX=je({name:"XScroll",props:{disabled:Boolean,onScroll:Function},setup(){const e=me(null);function t(n){!(n.currentTarget.offsetWidth<n.currentTarget.scrollWidth)||n.deltaY===0||(n.currentTarget.scrollLeft+=n.deltaY+n.deltaX,n.preventDefault())}const r=Xu();return vX.mount({id:"vueuc/x-scroll",head:!0,anchorMetaName:nw,ssr:r}),Object.assign({selfRef:e,handleWheel:t},{scrollTo(...n){var a;(a=e.value)===null||a===void 0||a.scrollTo(...n)}})},render(){return E("div",{ref:"selfRef",onScroll:this.onScroll,onWheel:this.disabled?void 0:this.handleWheel,class:"v-x-scroll"},this.$slots)}}),_l="v-hidden",yX=el("[v-hidden]",{display:"none!important"}),I2=je({name:"Overflow",props:{getCounter:Function,getTail:Function,updateCounter:Function,onUpdateCount:Function,onUpdateOverflow:Function},setup(e,{slots:t}){const r=me(null),i=me(null);function n(o){const{value:s}=r,{getCounter:l,getTail:c}=e;let u;if(l!==void 0?u=l():u=i.value,!s||!u)return;u.hasAttribute(_l)&&u.removeAttribute(_l);const{children:d}=s;if(o.showAllItemsBeforeCalculate)for(const b of d)b.hasAttribute(_l)&&b.removeAttribute(_l);const h=s.offsetWidth,f=[],p=t.tail?c==null?void 0:c():null;let v=p?p.offsetWidth:0,m=!1;const g=s.children.length-(t.tail?1:0);for(let b=0;b<g-1;++b){if(b<0)continue;const x=d[b];if(m){x.hasAttribute(_l)||x.setAttribute(_l,"");continue}else x.hasAttribute(_l)&&x.removeAttribute(_l);const S=x.offsetWidth;if(v+=S,f[b]=S,v>h){const{updateCounter:w}=e;for(let _=b;_>=0;--_){const C=g-1-_;w!==void 0?w(C):u.textContent=`${C}`;const A=u.offsetWidth;if(v-=f[_],v+A<=h||_===0){m=!0,b=_-1,p&&(b===-1?(p.style.maxWidth=`${h-A}px`,p.style.boxSizing="border-box"):p.style.maxWidth="");const{onUpdateCount:M}=e;M&&M(C);break}}}}const{onUpdateOverflow:y}=e;m?y!==void 0&&y(!0):(y!==void 0&&y(!1),u.setAttribute(_l,""))}const a=Xu();return yX.mount({id:"vueuc/overflow",head:!0,anchorMetaName:nw,ssr:a}),Or(()=>n({showAllItemsBeforeCalculate:!1})),{selfRef:r,counterRef:i,sync:n}},render(){const{$slots:e}=this;return aa(()=>this.sync({showAllItemsBeforeCalculate:!1})),E("div",{class:"v-overflow",ref:"selfRef"},[gs(e,"default"),e.counter?e.counter():E("span",{style:{display:"inline-block"},ref:"counterRef"}),e.tail?e.tail():null])}});function KN(e){return e instanceof HTMLElement}function QN(e){for(let t=0;t<e.childNodes.length;t++){const r=e.childNodes[t];if(KN(r)&&(JN(r)||QN(r)))return!0}return!1}function ZN(e){for(let t=e.childNodes.length-1;t>=0;t--){const r=e.childNodes[t];if(KN(r)&&(JN(r)||ZN(r)))return!0}return!1}function JN(e){if(!bX(e))return!1;try{e.focus({preventScroll:!0})}catch{}return document.activeElement===e}function bX(e){if(e.tabIndex>0||e.tabIndex===0&&e.getAttribute("tabIndex")!==null)return!0;if(e.getAttribute("disabled"))return!1;switch(e.nodeName){case"A":return!!e.href&&e.rel!=="ignore";case"INPUT":return e.type!=="hidden"&&e.type!=="file";case"BUTTON":case"SELECT":case"TEXTAREA":return!0;default:return!1}}let Em=[];const xX=je({name:"FocusTrap",props:{disabled:Boolean,active:Boolean,autoFocus:{type:Boolean,default:!0},onEsc:Function,initialFocusTo:String,finalFocusTo:String,returnFocusOnDeactivated:{type:Boolean,default:!0}},setup(e){const t=oh(),r=me(null),i=me(null);let n=!1,a=!1;const o=typeof document>"u"?null:document.activeElement;function s(){return Em[Em.length-1]===t}function l(m){var g;m.code==="Escape"&&s()&&((g=e.onEsc)===null||g===void 0||g.call(e,m))}Or(()=>{rr(()=>e.active,m=>{m?(d(),Ui("keydown",document,l)):(Si("keydown",document,l),n&&h())},{immediate:!0})}),la(()=>{Si("keydown",document,l),n&&h()});function c(m){if(!a&&s()){const g=u();if(g===null||g.contains(lc(m)))return;f("first")}}function u(){const m=r.value;if(m===null)return null;let g=m;for(;g=g.nextSibling,!(g===null||g instanceof Element&&g.tagName==="DIV"););return g}function d(){var m;if(!e.disabled){if(Em.push(t),e.autoFocus){const{initialFocusTo:g}=e;g===void 0?f("first"):(m=bO(g))===null||m===void 0||m.focus({preventScroll:!0})}n=!0,document.addEventListener("focus",c,!0)}}function h(){var m;if(e.disabled||(document.removeEventListener("focus",c,!0),Em=Em.filter(y=>y!==t),s()))return;const{finalFocusTo:g}=e;g!==void 0?(m=bO(g))===null||m===void 0||m.focus({preventScroll:!0}):e.returnFocusOnDeactivated&&o instanceof HTMLElement&&(a=!0,o.focus({preventScroll:!0}),a=!1)}function f(m){if(s()&&e.active){const g=r.value,y=i.value;if(g!==null&&y!==null){const b=u();if(b==null||b===y){a=!0,g.focus({preventScroll:!0}),a=!1;return}a=!0;const x=m==="first"?QN(b):ZN(b);a=!1,x||(a=!0,g.focus({preventScroll:!0}),a=!1)}}}function p(m){if(a)return;const g=u();g!==null&&(m.relatedTarget!==null&&g.contains(m.relatedTarget)?f("last"):f("first"))}function v(m){a||(m.relatedTarget!==null&&m.relatedTarget===r.value?f("last"):f("first"))}return{focusableStartRef:r,focusableEndRef:i,focusableStyle:"position: absolute; height: 0; width: 0;",handleStartFocus:p,handleEndFocus:v}},render(){const{default:e}=this.$slots;if(e===void 0)return null;if(this.disabled)return e();const{active:t,focusableStyle:r}=this;return E(mr,null,[E("div",{"aria-hidden":"true",tabindex:t?"0":"-1",ref:"focusableStartRef",style:r,onFocus:this.handleStartFocus}),e(),E("div",{"aria-hidden":"true",style:r,ref:"focusableEndRef",tabindex:t?"0":"-1",onFocus:this.handleEndFocus})])}});function eU(e,t){t&&(Or(()=>{const{value:r}=e;r&&dx.registerHandler(r,t)}),la(()=>{const{value:r}=e;r&&dx.unregisterHandler(r)}))}function BT(e){const t={isDeactivated:!1};let r=!1;return TT(()=>{if(t.isDeactivated=!1,!r){r=!0;return}e()}),PT(()=>{t.isDeactivated=!0,r||(r=!0)}),t}const hx="n-form-item";function gl(e,{defaultSize:t="medium",mergedSize:r,mergedDisabled:i}={}){const n=_t(hx,null);xr(hx,null);const a=re(r?()=>r(n):()=>{const{size:l}=e;if(l)return l;if(n){const{mergedSize:c}=n;if(c.value!==void 0)return c.value}return t}),o=re(i?()=>i(n):()=>{const{disabled:l}=e;return l!==void 0?l:n?n.disabled.value:!1}),s=re(()=>{const{status:l}=e;return l||(n==null?void 0:n.mergedValidationStatus.value)});return la(()=>{n&&n.restoreValidation()}),{mergedSizeRef:a,mergedDisabledRef:o,mergedStatusRef:s,nTriggerFormBlur(){n&&n.handleContentBlur()},nTriggerFormChange(){n&&n.handleContentChange()},nTriggerFormFocus(){n&&n.handleContentFocus()},nTriggerFormInput(){n&&n.handleContentInput()}}}var tU=typeof global=="object"&&global&&global.Object===Object&&global,wX=typeof self=="object"&&self&&self.Object===Object&&self,Cs=tU||wX||Function("return this")(),Iu=Cs.Symbol,rU=Object.prototype,SX=rU.hasOwnProperty,CX=rU.toString,Tm=Iu?Iu.toStringTag:void 0;function _X(e){var t=SX.call(e,Tm),r=e[Tm];try{e[Tm]=void 0;var i=!0}catch{}var n=CX.call(e);return i&&(t?e[Tm]=r:delete e[Tm]),n}var AX=Object.prototype,MX=AX.toString;function EX(e){return MX.call(e)}var TX="[object Null]",PX="[object Undefined]",IO=Iu?Iu.toStringTag:void 0;function _h(e){return e==null?e===void 0?PX:TX:IO&&IO in Object(e)?_X(e):EX(e)}function zu(e){return e!=null&&typeof e=="object"}var DX="[object Symbol]";function aw(e){return typeof e=="symbol"||zu(e)&&_h(e)==DX}function iU(e,t){for(var r=-1,i=e==null?0:e.length,n=Array(i);++r<i;)n[r]=t(e[r],r,e);return n}var Ho=Array.isArray,OX=1/0,zO=Iu?Iu.prototype:void 0,kO=zO?zO.toString:void 0;function nU(e){if(typeof e=="string")return e;if(Ho(e))return iU(e,nU)+"";if(aw(e))return kO?kO.call(e):"";var t=e+"";return t=="0"&&1/e==-OX?"-0":t}var RX=/\s/;function IX(e){for(var t=e.length;t--&&RX.test(e.charAt(t)););return t}var zX=/^\s+/;function kX(e){return e&&e.slice(0,IX(e)+1).replace(zX,"")}function Wo(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var LO=NaN,LX=/^[-+]0x[0-9a-f]+$/i,BX=/^0b[01]+$/i,FX=/^0o[0-7]+$/i,NX=parseInt;function BO(e){if(typeof e=="number")return e;if(aw(e))return LO;if(Wo(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=Wo(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=kX(e);var r=BX.test(e);return r||FX.test(e)?NX(e.slice(2),r?2:8):LX.test(e)?LO:+e}function FT(e){return e}var UX="[object AsyncFunction]",jX="[object Function]",VX="[object GeneratorFunction]",HX="[object Proxy]";function NT(e){if(!Wo(e))return!1;var t=_h(e);return t==jX||t==VX||t==UX||t==HX}var yS=Cs["__core-js_shared__"],FO=function(){var e=/[^.]+$/.exec(yS&&yS.keys&&yS.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function WX(e){return!!FO&&FO in e}var GX=Function.prototype,$X=GX.toString;function Ah(e){if(e!=null){try{return $X.call(e)}catch{}try{return e+""}catch{}}return""}var qX=/[\\^$.*+?()[\]{}|]/g,YX=/^\[object .+?Constructor\]$/,XX=Function.prototype,KX=Object.prototype,QX=XX.toString,ZX=KX.hasOwnProperty,JX=RegExp("^"+QX.call(ZX).replace(qX,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function eK(e){if(!Wo(e)||WX(e))return!1;var t=NT(e)?JX:YX;return t.test(Ah(e))}function tK(e,t){return e==null?void 0:e[t]}function Mh(e,t){var r=tK(e,t);return eK(r)?r:void 0}var z2=Mh(Cs,"WeakMap"),NO=Object.create,rK=function(){function e(){}return function(t){if(!Wo(t))return{};if(NO)return NO(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}();function iK(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}function nK(e,t){var r=-1,i=e.length;for(t||(t=Array(i));++r<i;)t[r]=e[r];return t}var aK=800,oK=16,sK=Date.now;function lK(e){var t=0,r=0;return function(){var i=sK(),n=oK-(i-r);if(r=i,n>0){if(++t>=aK)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}function cK(e){return function(){return e}}var fx=function(){try{var e=Mh(Object,"defineProperty");return e({},"",{}),e}catch{}}(),uK=fx?function(e,t){return fx(e,"toString",{configurable:!0,enumerable:!1,value:cK(t),writable:!0})}:FT,dK=lK(uK),hK=9007199254740991,fK=/^(?:0|[1-9]\d*)$/;function UT(e,t){var r=typeof e;return t=t??hK,!!t&&(r=="number"||r!="symbol"&&fK.test(e))&&e>-1&&e%1==0&&e<t}function jT(e,t,r){t=="__proto__"&&fx?fx(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}function t0(e,t){return e===t||e!==e&&t!==t}var pK=Object.prototype,mK=pK.hasOwnProperty;function vK(e,t,r){var i=e[t];(!(mK.call(e,t)&&t0(i,r))||r===void 0&&!(t in e))&&jT(e,t,r)}function gK(e,t,r,i){var n=!r;r||(r={});for(var a=-1,o=t.length;++a<o;){var s=t[a],l=void 0;l===void 0&&(l=e[s]),n?jT(r,s,l):vK(r,s,l)}return r}var UO=Math.max;function yK(e,t,r){return t=UO(t===void 0?e.length-1:t,0),function(){for(var i=arguments,n=-1,a=UO(i.length-t,0),o=Array(a);++n<a;)o[n]=i[t+n];n=-1;for(var s=Array(t+1);++n<t;)s[n]=i[n];return s[t]=r(o),iK(e,this,s)}}function bK(e,t){return dK(yK(e,t,FT),e+"")}var xK=9007199254740991;function VT(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=xK}function Zp(e){return e!=null&&VT(e.length)&&!NT(e)}function wK(e,t,r){if(!Wo(r))return!1;var i=typeof t;return(i=="number"?Zp(r)&&UT(t,r.length):i=="string"&&t in r)?t0(r[t],e):!1}function SK(e){return bK(function(t,r){var i=-1,n=r.length,a=n>1?r[n-1]:void 0,o=n>2?r[2]:void 0;for(a=e.length>3&&typeof a=="function"?(n--,a):void 0,o&&wK(r[0],r[1],o)&&(a=n<3?void 0:a,n=1),t=Object(t);++i<n;){var s=r[i];s&&e(t,s,i,a)}return t})}var CK=Object.prototype;function HT(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||CK;return e===r}function _K(e,t){for(var r=-1,i=Array(e);++r<e;)i[r]=t(r);return i}var AK="[object Arguments]";function jO(e){return zu(e)&&_h(e)==AK}var aU=Object.prototype,MK=aU.hasOwnProperty,EK=aU.propertyIsEnumerable,px=jO(function(){return arguments}())?jO:function(e){return zu(e)&&MK.call(e,"callee")&&!EK.call(e,"callee")};function TK(){return!1}var oU=typeof exports=="object"&&exports&&!exports.nodeType&&exports,VO=oU&&typeof module=="object"&&module&&!module.nodeType&&module,PK=VO&&VO.exports===oU,HO=PK?Cs.Buffer:void 0,DK=HO?HO.isBuffer:void 0,mx=DK||TK,OK="[object Arguments]",RK="[object Array]",IK="[object Boolean]",zK="[object Date]",kK="[object Error]",LK="[object Function]",BK="[object Map]",FK="[object Number]",NK="[object Object]",UK="[object RegExp]",jK="[object Set]",VK="[object String]",HK="[object WeakMap]",WK="[object ArrayBuffer]",GK="[object DataView]",$K="[object Float32Array]",qK="[object Float64Array]",YK="[object Int8Array]",XK="[object Int16Array]",KK="[object Int32Array]",QK="[object Uint8Array]",ZK="[object Uint8ClampedArray]",JK="[object Uint16Array]",eQ="[object Uint32Array]",bi={};bi[$K]=bi[qK]=bi[YK]=bi[XK]=bi[KK]=bi[QK]=bi[ZK]=bi[JK]=bi[eQ]=!0;bi[OK]=bi[RK]=bi[WK]=bi[IK]=bi[GK]=bi[zK]=bi[kK]=bi[LK]=bi[BK]=bi[FK]=bi[NK]=bi[UK]=bi[jK]=bi[VK]=bi[HK]=!1;function tQ(e){return zu(e)&&VT(e.length)&&!!bi[_h(e)]}function rQ(e){return function(t){return e(t)}}var sU=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Bv=sU&&typeof module=="object"&&module&&!module.nodeType&&module,iQ=Bv&&Bv.exports===sU,bS=iQ&&tU.process,WO=function(){try{var e=Bv&&Bv.require&&Bv.require("util").types;return e||bS&&bS.binding&&bS.binding("util")}catch{}}(),GO=WO&&WO.isTypedArray,WT=GO?rQ(GO):tQ,nQ=Object.prototype,aQ=nQ.hasOwnProperty;function lU(e,t){var r=Ho(e),i=!r&&px(e),n=!r&&!i&&mx(e),a=!r&&!i&&!n&&WT(e),o=r||i||n||a,s=o?_K(e.length,String):[],l=s.length;for(var c in e)(t||aQ.call(e,c))&&!(o&&(c=="length"||n&&(c=="offset"||c=="parent")||a&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||UT(c,l)))&&s.push(c);return s}function cU(e,t){return function(r){return e(t(r))}}var oQ=cU(Object.keys,Object),sQ=Object.prototype,lQ=sQ.hasOwnProperty;function cQ(e){if(!HT(e))return oQ(e);var t=[];for(var r in Object(e))lQ.call(e,r)&&r!="constructor"&&t.push(r);return t}function GT(e){return Zp(e)?lU(e):cQ(e)}function uQ(e){var t=[];if(e!=null)for(var r in Object(e))t.push(r);return t}var dQ=Object.prototype,hQ=dQ.hasOwnProperty;function fQ(e){if(!Wo(e))return uQ(e);var t=HT(e),r=[];for(var i in e)i=="constructor"&&(t||!hQ.call(e,i))||r.push(i);return r}function uU(e){return Zp(e)?lU(e,!0):fQ(e)}var pQ=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,mQ=/^\w*$/;function $T(e,t){if(Ho(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||aw(e)?!0:mQ.test(e)||!pQ.test(e)||t!=null&&e in Object(t)}var pg=Mh(Object,"create");function vQ(){this.__data__=pg?pg(null):{},this.size=0}function gQ(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var yQ="__lodash_hash_undefined__",bQ=Object.prototype,xQ=bQ.hasOwnProperty;function wQ(e){var t=this.__data__;if(pg){var r=t[e];return r===yQ?void 0:r}return xQ.call(t,e)?t[e]:void 0}var SQ=Object.prototype,CQ=SQ.hasOwnProperty;function _Q(e){var t=this.__data__;return pg?t[e]!==void 0:CQ.call(t,e)}var AQ="__lodash_hash_undefined__";function MQ(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=pg&&t===void 0?AQ:t,this}function lh(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}lh.prototype.clear=vQ;lh.prototype.delete=gQ;lh.prototype.get=wQ;lh.prototype.has=_Q;lh.prototype.set=MQ;function EQ(){this.__data__=[],this.size=0}function ow(e,t){for(var r=e.length;r--;)if(t0(e[r][0],t))return r;return-1}var TQ=Array.prototype,PQ=TQ.splice;function DQ(e){var t=this.__data__,r=ow(t,e);if(r<0)return!1;var i=t.length-1;return r==i?t.pop():PQ.call(t,r,1),--this.size,!0}function OQ(e){var t=this.__data__,r=ow(t,e);return r<0?void 0:t[r][1]}function RQ(e){return ow(this.__data__,e)>-1}function IQ(e,t){var r=this.__data__,i=ow(r,e);return i<0?(++this.size,r.push([e,t])):r[i][1]=t,this}function bc(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}bc.prototype.clear=EQ;bc.prototype.delete=DQ;bc.prototype.get=OQ;bc.prototype.has=RQ;bc.prototype.set=IQ;var mg=Mh(Cs,"Map");function zQ(){this.size=0,this.__data__={hash:new lh,map:new(mg||bc),string:new lh}}function kQ(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function sw(e,t){var r=e.__data__;return kQ(t)?r[typeof t=="string"?"string":"hash"]:r.map}function LQ(e){var t=sw(this,e).delete(e);return this.size-=t?1:0,t}function BQ(e){return sw(this,e).get(e)}function FQ(e){return sw(this,e).has(e)}function NQ(e,t){var r=sw(this,e),i=r.size;return r.set(e,t),this.size+=r.size==i?0:1,this}function xc(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}xc.prototype.clear=zQ;xc.prototype.delete=LQ;xc.prototype.get=BQ;xc.prototype.has=FQ;xc.prototype.set=NQ;var UQ="Expected a function";function qT(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(UQ);var r=function(){var i=arguments,n=t?t.apply(this,i):i[0],a=r.cache;if(a.has(n))return a.get(n);var o=e.apply(this,i);return r.cache=a.set(n,o)||a,o};return r.cache=new(qT.Cache||xc),r}qT.Cache=xc;var jQ=500;function VQ(e){var t=qT(e,function(i){return r.size===jQ&&r.clear(),i}),r=t.cache;return t}var HQ=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,WQ=/\\(\\)?/g,GQ=VQ(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(HQ,function(r,i,n,a){t.push(n?a.replace(WQ,"$1"):i||r)}),t});function dU(e){return e==null?"":nU(e)}function hU(e,t){return Ho(e)?e:$T(e,t)?[e]:GQ(dU(e))}var $Q=1/0;function lw(e){if(typeof e=="string"||aw(e))return e;var t=e+"";return t=="0"&&1/e==-$Q?"-0":t}function fU(e,t){t=hU(t,e);for(var r=0,i=t.length;e!=null&&r<i;)e=e[lw(t[r++])];return r&&r==i?e:void 0}function YT(e,t,r){var i=e==null?void 0:fU(e,t);return i===void 0?r:i}function qQ(e,t){for(var r=-1,i=t.length,n=e.length;++r<i;)e[n+r]=t[r];return e}var pU=cU(Object.getPrototypeOf,Object),YQ="[object Object]",XQ=Function.prototype,KQ=Object.prototype,mU=XQ.toString,QQ=KQ.hasOwnProperty,ZQ=mU.call(Object);function JQ(e){if(!zu(e)||_h(e)!=YQ)return!1;var t=pU(e);if(t===null)return!0;var r=QQ.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&mU.call(r)==ZQ}function eZ(e,t,r){var i=-1,n=e.length;t<0&&(t=-t>n?0:n+t),r=r>n?n:r,r<0&&(r+=n),n=t>r?0:r-t>>>0,t>>>=0;for(var a=Array(n);++i<n;)a[i]=e[i+t];return a}function tZ(e,t,r){var i=e.length;return r=r===void 0?i:r,!t&&r>=i?e:eZ(e,t,r)}var rZ="\\ud800-\\udfff",iZ="\\u0300-\\u036f",nZ="\\ufe20-\\ufe2f",aZ="\\u20d0-\\u20ff",oZ=iZ+nZ+aZ,sZ="\\ufe0e\\ufe0f",lZ="\\u200d",cZ=RegExp("["+lZ+rZ+oZ+sZ+"]");function vU(e){return cZ.test(e)}function uZ(e){return e.split("")}var gU="\\ud800-\\udfff",dZ="\\u0300-\\u036f",hZ="\\ufe20-\\ufe2f",fZ="\\u20d0-\\u20ff",pZ=dZ+hZ+fZ,mZ="\\ufe0e\\ufe0f",vZ="["+gU+"]",k2="["+pZ+"]",L2="\\ud83c[\\udffb-\\udfff]",gZ="(?:"+k2+"|"+L2+")",yU="[^"+gU+"]",bU="(?:\\ud83c[\\udde6-\\uddff]){2}",xU="[\\ud800-\\udbff][\\udc00-\\udfff]",yZ="\\u200d",wU=gZ+"?",SU="["+mZ+"]?",bZ="(?:"+yZ+"(?:"+[yU,bU,xU].join("|")+")"+SU+wU+")*",xZ=SU+wU+bZ,wZ="(?:"+[yU+k2+"?",k2,bU,xU,vZ].join("|")+")",SZ=RegExp(L2+"(?="+L2+")|"+wZ+xZ,"g");function CZ(e){return e.match(SZ)||[]}function _Z(e){return vU(e)?CZ(e):uZ(e)}function AZ(e){return function(t){t=dU(t);var r=vU(t)?_Z(t):void 0,i=r?r[0]:t.charAt(0),n=r?tZ(r,1).join(""):t.slice(1);return i[e]()+n}}var MZ=AZ("toUpperCase");function EZ(){this.__data__=new bc,this.size=0}function TZ(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}function PZ(e){return this.__data__.get(e)}function DZ(e){return this.__data__.has(e)}var OZ=200;function RZ(e,t){var r=this.__data__;if(r instanceof bc){var i=r.__data__;if(!mg||i.length<OZ-1)return i.push([e,t]),this.size=++r.size,this;r=this.__data__=new xc(i)}return r.set(e,t),this.size=r.size,this}function al(e){var t=this.__data__=new bc(e);this.size=t.size}al.prototype.clear=EZ;al.prototype.delete=TZ;al.prototype.get=PZ;al.prototype.has=DZ;al.prototype.set=RZ;var CU=typeof exports=="object"&&exports&&!exports.nodeType&&exports,$O=CU&&typeof module=="object"&&module&&!module.nodeType&&module,IZ=$O&&$O.exports===CU,qO=IZ?Cs.Buffer:void 0;qO&&qO.allocUnsafe;function zZ(e,t){return e.slice()}function kZ(e,t){for(var r=-1,i=e==null?0:e.length,n=0,a=[];++r<i;){var o=e[r];t(o,r,e)&&(a[n++]=o)}return a}function LZ(){return[]}var BZ=Object.prototype,FZ=BZ.propertyIsEnumerable,YO=Object.getOwnPropertySymbols,NZ=YO?function(e){return e==null?[]:(e=Object(e),kZ(YO(e),function(t){return FZ.call(e,t)}))}:LZ;function UZ(e,t,r){var i=t(e);return Ho(e)?i:qQ(i,r(e))}function XO(e){return UZ(e,GT,NZ)}var B2=Mh(Cs,"DataView"),F2=Mh(Cs,"Promise"),N2=Mh(Cs,"Set"),KO="[object Map]",jZ="[object Object]",QO="[object Promise]",ZO="[object Set]",JO="[object WeakMap]",eR="[object DataView]",VZ=Ah(B2),HZ=Ah(mg),WZ=Ah(F2),GZ=Ah(N2),$Z=Ah(z2),tu=_h;(B2&&tu(new B2(new ArrayBuffer(1)))!=eR||mg&&tu(new mg)!=KO||F2&&tu(F2.resolve())!=QO||N2&&tu(new N2)!=ZO||z2&&tu(new z2)!=JO)&&(tu=function(e){var t=_h(e),r=t==jZ?e.constructor:void 0,i=r?Ah(r):"";if(i)switch(i){case VZ:return eR;case HZ:return KO;case WZ:return QO;case GZ:return ZO;case $Z:return JO}return t});var vx=Cs.Uint8Array;function qZ(e){var t=new e.constructor(e.byteLength);return new vx(t).set(new vx(e)),t}function YZ(e,t){var r=qZ(e.buffer);return new e.constructor(r,e.byteOffset,e.length)}function XZ(e){return typeof e.constructor=="function"&&!HT(e)?rK(pU(e)):{}}var KZ="__lodash_hash_undefined__";function QZ(e){return this.__data__.set(e,KZ),this}function ZZ(e){return this.__data__.has(e)}function gx(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new xc;++t<r;)this.add(e[t])}gx.prototype.add=gx.prototype.push=QZ;gx.prototype.has=ZZ;function JZ(e,t){for(var r=-1,i=e==null?0:e.length;++r<i;)if(t(e[r],r,e))return!0;return!1}function eJ(e,t){return e.has(t)}var tJ=1,rJ=2;function _U(e,t,r,i,n,a){var o=r&tJ,s=e.length,l=t.length;if(s!=l&&!(o&&l>s))return!1;var c=a.get(e),u=a.get(t);if(c&&u)return c==t&&u==e;var d=-1,h=!0,f=r&rJ?new gx:void 0;for(a.set(e,t),a.set(t,e);++d<s;){var p=e[d],v=t[d];if(i)var m=o?i(v,p,d,t,e,a):i(p,v,d,e,t,a);if(m!==void 0){if(m)continue;h=!1;break}if(f){if(!JZ(t,function(g,y){if(!eJ(f,y)&&(p===g||n(p,g,r,i,a)))return f.push(y)})){h=!1;break}}else if(!(p===v||n(p,v,r,i,a))){h=!1;break}}return a.delete(e),a.delete(t),h}function iJ(e){var t=-1,r=Array(e.size);return e.forEach(function(i,n){r[++t]=[n,i]}),r}function nJ(e){var t=-1,r=Array(e.size);return e.forEach(function(i){r[++t]=i}),r}var aJ=1,oJ=2,sJ="[object Boolean]",lJ="[object Date]",cJ="[object Error]",uJ="[object Map]",dJ="[object Number]",hJ="[object RegExp]",fJ="[object Set]",pJ="[object String]",mJ="[object Symbol]",vJ="[object ArrayBuffer]",gJ="[object DataView]",tR=Iu?Iu.prototype:void 0,xS=tR?tR.valueOf:void 0;function yJ(e,t,r,i,n,a,o){switch(r){case gJ:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case vJ:return!(e.byteLength!=t.byteLength||!a(new vx(e),new vx(t)));case sJ:case lJ:case dJ:return t0(+e,+t);case cJ:return e.name==t.name&&e.message==t.message;case hJ:case pJ:return e==t+"";case uJ:var s=iJ;case fJ:var l=i&aJ;if(s||(s=nJ),e.size!=t.size&&!l)return!1;var c=o.get(e);if(c)return c==t;i|=oJ,o.set(e,t);var u=_U(s(e),s(t),i,n,a,o);return o.delete(e),u;case mJ:if(xS)return xS.call(e)==xS.call(t)}return!1}var bJ=1,xJ=Object.prototype,wJ=xJ.hasOwnProperty;function SJ(e,t,r,i,n,a){var o=r&bJ,s=XO(e),l=s.length,c=XO(t),u=c.length;if(l!=u&&!o)return!1;for(var d=l;d--;){var h=s[d];if(!(o?h in t:wJ.call(t,h)))return!1}var f=a.get(e),p=a.get(t);if(f&&p)return f==t&&p==e;var v=!0;a.set(e,t),a.set(t,e);for(var m=o;++d<l;){h=s[d];var g=e[h],y=t[h];if(i)var b=o?i(y,g,h,t,e,a):i(g,y,h,e,t,a);if(!(b===void 0?g===y||n(g,y,r,i,a):b)){v=!1;break}m||(m=h=="constructor")}if(v&&!m){var x=e.constructor,S=t.constructor;x!=S&&"constructor"in e&&"constructor"in t&&!(typeof x=="function"&&x instanceof x&&typeof S=="function"&&S instanceof S)&&(v=!1)}return a.delete(e),a.delete(t),v}var CJ=1,rR="[object Arguments]",iR="[object Array]",q0="[object Object]",_J=Object.prototype,nR=_J.hasOwnProperty;function AJ(e,t,r,i,n,a){var o=Ho(e),s=Ho(t),l=o?iR:tu(e),c=s?iR:tu(t);l=l==rR?q0:l,c=c==rR?q0:c;var u=l==q0,d=c==q0,h=l==c;if(h&&mx(e)){if(!mx(t))return!1;o=!0,u=!1}if(h&&!u)return a||(a=new al),o||WT(e)?_U(e,t,r,i,n,a):yJ(e,t,l,r,i,n,a);if(!(r&CJ)){var f=u&&nR.call(e,"__wrapped__"),p=d&&nR.call(t,"__wrapped__");if(f||p){var v=f?e.value():e,m=p?t.value():t;return a||(a=new al),n(v,m,r,i,a)}}return h?(a||(a=new al),SJ(e,t,r,i,n,a)):!1}function XT(e,t,r,i,n){return e===t?!0:e==null||t==null||!zu(e)&&!zu(t)?e!==e&&t!==t:AJ(e,t,r,i,XT,n)}var MJ=1,EJ=2;function TJ(e,t,r,i){var n=r.length,a=n;if(e==null)return!a;for(e=Object(e);n--;){var o=r[n];if(o[2]?o[1]!==e[o[0]]:!(o[0]in e))return!1}for(;++n<a;){o=r[n];var s=o[0],l=e[s],c=o[1];if(o[2]){if(l===void 0&&!(s in e))return!1}else{var u=new al,d;if(!(d===void 0?XT(c,l,MJ|EJ,i,u):d))return!1}}return!0}function AU(e){return e===e&&!Wo(e)}function PJ(e){for(var t=GT(e),r=t.length;r--;){var i=t[r],n=e[i];t[r]=[i,n,AU(n)]}return t}function MU(e,t){return function(r){return r==null?!1:r[e]===t&&(t!==void 0||e in Object(r))}}function DJ(e){var t=PJ(e);return t.length==1&&t[0][2]?MU(t[0][0],t[0][1]):function(r){return r===e||TJ(r,e,t)}}function OJ(e,t){return e!=null&&t in Object(e)}function RJ(e,t,r){t=hU(t,e);for(var i=-1,n=t.length,a=!1;++i<n;){var o=lw(t[i]);if(!(a=e!=null&&r(e,o)))break;e=e[o]}return a||++i!=n?a:(n=e==null?0:e.length,!!n&&VT(n)&&UT(o,n)&&(Ho(e)||px(e)))}function IJ(e,t){return e!=null&&RJ(e,t,OJ)}var zJ=1,kJ=2;function LJ(e,t){return $T(e)&&AU(t)?MU(lw(e),t):function(r){var i=YT(r,e);return i===void 0&&i===t?IJ(r,e):XT(t,i,zJ|kJ)}}function BJ(e){return function(t){return t==null?void 0:t[e]}}function FJ(e){return function(t){return fU(t,e)}}function NJ(e){return $T(e)?BJ(lw(e)):FJ(e)}function UJ(e){return typeof e=="function"?e:e==null?FT:typeof e=="object"?Ho(e)?LJ(e[0],e[1]):DJ(e):NJ(e)}function jJ(e){return function(t,r,i){for(var n=-1,a=Object(t),o=i(t),s=o.length;s--;){var l=o[++n];if(r(a[l],l,a)===!1)break}return t}}var EU=jJ();function VJ(e,t){return e&&EU(e,t,GT)}function HJ(e,t){return function(r,i){if(r==null)return r;if(!Zp(r))return e(r,i);for(var n=r.length,a=-1,o=Object(r);++a<n&&i(o[a],a,o)!==!1;);return r}}var WJ=HJ(VJ),wS=function(){return Cs.Date.now()},GJ="Expected a function",$J=Math.max,qJ=Math.min;function YJ(e,t,r){var i,n,a,o,s,l,c=0,u=!1,d=!1,h=!0;if(typeof e!="function")throw new TypeError(GJ);t=BO(t)||0,Wo(r)&&(u=!!r.leading,d="maxWait"in r,a=d?$J(BO(r.maxWait)||0,t):a,h="trailing"in r?!!r.trailing:h);function f(w){var _=i,C=n;return i=n=void 0,c=w,o=e.apply(C,_),o}function p(w){return c=w,s=setTimeout(g,t),u?f(w):o}function v(w){var _=w-l,C=w-c,A=t-_;return d?qJ(A,a-C):A}function m(w){var _=w-l,C=w-c;return l===void 0||_>=t||_<0||d&&C>=a}function g(){var w=wS();if(m(w))return y(w);s=setTimeout(g,v(w))}function y(w){return s=void 0,h&&i?f(w):(i=n=void 0,o)}function b(){s!==void 0&&clearTimeout(s),c=0,i=l=n=s=void 0}function x(){return s===void 0?o:y(wS())}function S(){var w=wS(),_=m(w);if(i=arguments,n=this,l=w,_){if(s===void 0)return p(l);if(d)return clearTimeout(s),s=setTimeout(g,t),f(l)}return s===void 0&&(s=setTimeout(g,t)),o}return S.cancel=b,S.flush=x,S}function U2(e,t,r){(r!==void 0&&!t0(e[t],r)||r===void 0&&!(t in e))&&jT(e,t,r)}function XJ(e){return zu(e)&&Zp(e)}function j2(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}function KJ(e){return gK(e,uU(e))}function QJ(e,t,r,i,n,a,o){var s=j2(e,r),l=j2(t,r),c=o.get(l);if(c){U2(e,r,c);return}var u=a?a(s,l,r+"",e,t,o):void 0,d=u===void 0;if(d){var h=Ho(l),f=!h&&mx(l),p=!h&&!f&&WT(l);u=l,h||f||p?Ho(s)?u=s:XJ(s)?u=nK(s):f?(d=!1,u=zZ(l)):p?(d=!1,u=YZ(l)):u=[]:JQ(l)||px(l)?(u=s,px(s)?u=KJ(s):(!Wo(s)||NT(s))&&(u=XZ(l))):d=!1}d&&(o.set(l,u),n(u,l,i,a,o),o.delete(l)),U2(e,r,u)}function TU(e,t,r,i,n){e!==t&&EU(t,function(a,o){if(n||(n=new al),Wo(a))QJ(e,t,o,r,TU,i,n);else{var s=i?i(j2(e,o),a,o+"",e,t,n):void 0;s===void 0&&(s=a),U2(e,o,s)}},uU)}function ZJ(e,t){var r=-1,i=Zp(e)?Array(e.length):[];return WJ(e,function(n,a,o){i[++r]=t(n,a,o)}),i}function JJ(e,t){var r=Ho(e)?iU:ZJ;return r(e,UJ(t))}var Y0=SK(function(e,t,r){TU(e,t,r)}),eee="Expected a function";function SS(e,t,r){var i=!0,n=!0;if(typeof e!="function")throw new TypeError(eee);return Wo(r)&&(i="leading"in r?!!r.leading:i,n="trailing"in r?!!r.trailing:n),YJ(e,t,{leading:i,maxWait:t,trailing:n})}const Ku={fontFamily:'v-sans, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',fontFamilyMono:"v-mono, SFMono-Regular, Menlo, Consolas, Courier, monospace",fontWeight:"400",fontWeightStrong:"500",cubicBezierEaseInOut:"cubic-bezier(.4, 0, .2, 1)",cubicBezierEaseOut:"cubic-bezier(0, 0, .2, 1)",cubicBezierEaseIn:"cubic-bezier(.4, 0, 1, 1)",borderRadius:"3px",borderRadiusSmall:"2px",fontSize:"14px",fontSizeMini:"12px",fontSizeTiny:"12px",fontSizeSmall:"14px",fontSizeMedium:"14px",fontSizeLarge:"15px",fontSizeHuge:"16px",lineHeight:"1.6",heightMini:"16px",heightTiny:"22px",heightSmall:"28px",heightMedium:"34px",heightLarge:"40px",heightHuge:"46px"},{fontSize:tee,fontFamily:ree,lineHeight:iee}=Ku,PU=ge("body",`
 margin: 0;
 font-size: ${tee};
 font-family: ${ree};
 line-height: ${iee};
 -webkit-text-size-adjust: 100%;
 -webkit-tap-highlight-color: transparent;
`,[ge("input",`
 font-family: inherit;
 font-size: inherit;
 `)]),Eh="n-config-provider",vg="naive-ui-style";function bt(e,t,r,i,n,a){const o=Xu(),s=_t(Eh,null);if(r){const c=()=>{const u=a==null?void 0:a.value;r.mount({id:u===void 0?t:u+t,head:!0,props:{bPrefix:u?`.${u}-`:void 0},anchorMetaName:vg,ssr:o}),s!=null&&s.preflightStyleDisabled||PU.mount({id:"n-global",head:!0,anchorMetaName:vg,ssr:o})};o?c():Kg(c)}return re(()=>{var c;const{theme:{common:u,self:d,peers:h={}}={},themeOverrides:f={},builtinThemeOverrides:p={}}=n,{common:v,peers:m}=f,{common:g=void 0,[e]:{common:y=void 0,self:b=void 0,peers:x={}}={}}=(s==null?void 0:s.mergedThemeRef.value)||{},{common:S=void 0,[e]:w={}}=(s==null?void 0:s.mergedThemeOverridesRef.value)||{},{common:_,peers:C={}}=w,A=Y0({},u||y||g||i.common,S,_,v),M=Y0((c=d||b||i.self)===null||c===void 0?void 0:c(A),p,w,f);return{common:A,self:M,peers:Y0({},i.peers,x,h),peerOverrides:Y0({},p.peers,C,m)}})}bt.props={theme:Object,themeOverrides:Object,builtinThemeOverrides:Object};const nee="n";function vr(e={},t={defaultBordered:!0}){const r=_t(Eh,null);return{inlineThemeDisabled:r==null?void 0:r.inlineThemeDisabled,mergedRtlRef:r==null?void 0:r.mergedRtlRef,mergedComponentPropsRef:r==null?void 0:r.mergedComponentPropsRef,mergedBreakpointsRef:r==null?void 0:r.mergedBreakpointsRef,mergedBorderedRef:re(()=>{var i,n;const{bordered:a}=e;return a!==void 0?a:(n=(i=r==null?void 0:r.mergedBorderedRef.value)!==null&&i!==void 0?i:t.defaultBordered)!==null&&n!==void 0?n:!0}),mergedClsPrefixRef:r?r.mergedClsPrefixRef:z5(nee),namespaceRef:re(()=>r==null?void 0:r.mergedNamespaceRef.value)}}const aee={name:"en-US",global:{undo:"Undo",redo:"Redo",confirm:"Confirm",clear:"Clear"},Popconfirm:{positiveText:"Confirm",negativeText:"Cancel"},Cascader:{placeholder:"Please Select",loading:"Loading",loadingRequiredMessage:e=>`Please load all ${e}'s descendants before checking it.`},Time:{dateFormat:"yyyy-MM-dd",dateTimeFormat:"yyyy-MM-dd HH:mm:ss"},DatePicker:{yearFormat:"yyyy",monthFormat:"MMM",dayFormat:"eeeeee",yearTypeFormat:"yyyy",monthTypeFormat:"yyyy-MM",dateFormat:"yyyy-MM-dd",dateTimeFormat:"yyyy-MM-dd HH:mm:ss",quarterFormat:"yyyy-qqq",weekFormat:"yyyy-w",clear:"Clear",now:"Now",confirm:"Confirm",selectTime:"Select Time",selectDate:"Select Date",datePlaceholder:"Select Date",datetimePlaceholder:"Select Date and Time",monthPlaceholder:"Select Month",yearPlaceholder:"Select Year",quarterPlaceholder:"Select Quarter",weekPlaceholder:"Select Week",startDatePlaceholder:"Start Date",endDatePlaceholder:"End Date",startDatetimePlaceholder:"Start Date and Time",endDatetimePlaceholder:"End Date and Time",startMonthPlaceholder:"Start Month",endMonthPlaceholder:"End Month",monthBeforeYear:!0,firstDayOfWeek:6,today:"Today"},DataTable:{checkTableAll:"Select all in the table",uncheckTableAll:"Unselect all in the table",confirm:"Confirm",clear:"Clear"},LegacyTransfer:{sourceTitle:"Source",targetTitle:"Target"},Transfer:{selectAll:"Select all",unselectAll:"Unselect all",clearAll:"Clear",total:e=>`Total ${e} items`,selected:e=>`${e} items selected`},Empty:{description:"No Data"},Select:{placeholder:"Please Select"},TimePicker:{placeholder:"Select Time",positiveText:"OK",negativeText:"Cancel",now:"Now",clear:"Clear"},Pagination:{goto:"Goto",selectionSuffix:"page"},DynamicTags:{add:"Add"},Log:{loading:"Loading"},Input:{placeholder:"Please Input"},InputNumber:{placeholder:"Please Input"},DynamicInput:{create:"Create"},ThemeEditor:{title:"Theme Editor",clearAllVars:"Clear All Variables",clearSearch:"Clear Search",filterCompName:"Filter Component Name",filterVarName:"Filter Variable Name",import:"Import",export:"Export",restore:"Reset to Default"},Image:{tipPrevious:"Previous picture ()",tipNext:"Next picture ()",tipCounterclockwise:"Counterclockwise",tipClockwise:"Clockwise",tipZoomOut:"Zoom out",tipZoomIn:"Zoom in",tipDownload:"Download",tipClose:"Close (Esc)",tipOriginalSize:"Zoom to original size"}};function CS(e){return function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.width?String(t.width):e.defaultWidth,i=e.formats[r]||e.formats[e.defaultWidth];return i}}function Ft(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}function fl(e){"@babel/helpers - typeof";return fl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fl(e)}function ir(e){Ft(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||fl(e)==="object"&&t==="[object Date]"?new Date(e.getTime()):typeof e=="number"||t==="[object Number]"?new Date(e):((typeof e=="string"||t==="[object String]")&&typeof console<"u"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(new Error().stack)),new Date(NaN))}function Yr(e){if(e===null||e===!0||e===!1)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}var oee={};function Th(){return oee}function ch(e,t){var r,i,n,a,o,s,l,c;Ft(1,arguments);var u=Th(),d=Yr((r=(i=(n=(a=t==null?void 0:t.weekStartsOn)!==null&&a!==void 0?a:t==null||(o=t.locale)===null||o===void 0||(s=o.options)===null||s===void 0?void 0:s.weekStartsOn)!==null&&n!==void 0?n:u.weekStartsOn)!==null&&i!==void 0?i:(l=u.locale)===null||l===void 0||(c=l.options)===null||c===void 0?void 0:c.weekStartsOn)!==null&&r!==void 0?r:0);if(!(d>=0&&d<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var h=ir(e),f=h.getUTCDay(),p=(f<d?7:0)+f-d;return h.setUTCDate(h.getUTCDate()-p),h.setUTCHours(0,0,0,0),h}function Pm(e){return function(t,r){var i=r!=null&&r.context?String(r.context):"standalone",n;if(i==="formatting"&&e.formattingValues){var a=e.defaultFormattingWidth||e.defaultWidth,o=r!=null&&r.width?String(r.width):a;n=e.formattingValues[o]||e.formattingValues[a]}else{var s=e.defaultWidth,l=r!=null&&r.width?String(r.width):e.defaultWidth;n=e.values[l]||e.values[s]}var c=e.argumentCallback?e.argumentCallback(t):t;return n[c]}}function Dm(e){return function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=r.width,n=i&&e.matchPatterns[i]||e.matchPatterns[e.defaultMatchWidth],a=t.match(n);if(!a)return null;var o=a[0],s=i&&e.parsePatterns[i]||e.parsePatterns[e.defaultParseWidth],l=Array.isArray(s)?lee(s,function(d){return d.test(o)}):see(s,function(d){return d.test(o)}),c;c=e.valueCallback?e.valueCallback(l):l,c=r.valueCallback?r.valueCallback(c):c;var u=t.slice(o.length);return{value:c,rest:u}}}function see(e,t){for(var r in e)if(e.hasOwnProperty(r)&&t(e[r]))return r}function lee(e,t){for(var r=0;r<e.length;r++)if(t(e[r]))return r}function cee(e){return function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=t.match(e.matchPattern);if(!i)return null;var n=i[0],a=t.match(e.parsePattern);if(!a)return null;var o=e.valueCallback?e.valueCallback(a[0]):a[0];o=r.valueCallback?r.valueCallback(o):o;var s=t.slice(n.length);return{value:o,rest:s}}}var uee={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},dee=function(t,r,i){var n,a=uee[t];return typeof a=="string"?n=a:r===1?n=a.one:n=a.other.replace("{{count}}",r.toString()),i!=null&&i.addSuffix?i.comparison&&i.comparison>0?"in "+n:n+" ago":n},hee={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},fee={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},pee={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},mee={date:CS({formats:hee,defaultWidth:"full"}),time:CS({formats:fee,defaultWidth:"full"}),dateTime:CS({formats:pee,defaultWidth:"full"})},vee={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},gee=function(t,r,i,n){return vee[t]},yee={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},bee={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},xee={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},wee={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},See={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Cee={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},_ee=function(t,r){var i=Number(t),n=i%100;if(n>20||n<10)switch(n%10){case 1:return i+"st";case 2:return i+"nd";case 3:return i+"rd"}return i+"th"},Aee={ordinalNumber:_ee,era:Pm({values:yee,defaultWidth:"wide"}),quarter:Pm({values:bee,defaultWidth:"wide",argumentCallback:function(t){return t-1}}),month:Pm({values:xee,defaultWidth:"wide"}),day:Pm({values:wee,defaultWidth:"wide"}),dayPeriod:Pm({values:See,defaultWidth:"wide",formattingValues:Cee,defaultFormattingWidth:"wide"})},Mee=/^(\d+)(th|st|nd|rd)?/i,Eee=/\d+/i,Tee={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Pee={any:[/^b/i,/^(a|c)/i]},Dee={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Oee={any:[/1/i,/2/i,/3/i,/4/i]},Ree={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Iee={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},zee={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},kee={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Lee={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Bee={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Fee={ordinalNumber:cee({matchPattern:Mee,parsePattern:Eee,valueCallback:function(t){return parseInt(t,10)}}),era:Dm({matchPatterns:Tee,defaultMatchWidth:"wide",parsePatterns:Pee,defaultParseWidth:"any"}),quarter:Dm({matchPatterns:Dee,defaultMatchWidth:"wide",parsePatterns:Oee,defaultParseWidth:"any",valueCallback:function(t){return t+1}}),month:Dm({matchPatterns:Ree,defaultMatchWidth:"wide",parsePatterns:Iee,defaultParseWidth:"any"}),day:Dm({matchPatterns:zee,defaultMatchWidth:"wide",parsePatterns:kee,defaultParseWidth:"any"}),dayPeriod:Dm({matchPatterns:Lee,defaultMatchWidth:"any",parsePatterns:Bee,defaultParseWidth:"any"})},KT={code:"en-US",formatDistance:dee,formatLong:mee,formatRelative:gee,localize:Aee,match:Fee,options:{weekStartsOn:0,firstWeekContainsDate:1}};const Nee={name:"en-US",locale:KT};function X0(e,t){Ft(2,arguments);var r=ir(e),i=Yr(t);return isNaN(i)?new Date(NaN):(i&&r.setDate(r.getDate()+i),r)}function Kn(e,t){Ft(2,arguments);var r=ir(e),i=Yr(t);if(isNaN(i))return new Date(NaN);if(!i)return r;var n=r.getDate(),a=new Date(r.getTime());a.setMonth(r.getMonth()+i+1,0);var o=a.getDate();return n>=o?a:(r.setFullYear(a.getFullYear(),a.getMonth(),n),r)}function Uee(e,t){Ft(2,arguments);var r=ir(e).getTime(),i=Yr(t);return new Date(r+i)}function V2(e,t){var r,i,n,a,o,s,l,c;Ft(1,arguments);var u=Th(),d=Yr((r=(i=(n=(a=t==null?void 0:t.weekStartsOn)!==null&&a!==void 0?a:t==null||(o=t.locale)===null||o===void 0||(s=o.options)===null||s===void 0?void 0:s.weekStartsOn)!==null&&n!==void 0?n:u.weekStartsOn)!==null&&i!==void 0?i:(l=u.locale)===null||l===void 0||(c=l.options)===null||c===void 0?void 0:c.weekStartsOn)!==null&&r!==void 0?r:0);if(!(d>=0&&d<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var h=ir(e),f=h.getDay(),p=(f<d?7:0)+f-d;return h.setDate(h.getDate()-p),h.setHours(0,0,0,0),h}function DU(e){var t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),e.getTime()-t.getTime()}function yx(e){Ft(1,arguments);var t=ir(e);return t.setHours(0,0,0,0),t}function jee(e,t){Ft(2,arguments);var r=Yr(t),i=r*3;return Kn(e,i)}function H2(e,t){Ft(2,arguments);var r=Yr(t);return Kn(e,r*12)}var Vee=6e4,Hee=36e5,Wee=1e3;function Gee(e,t){Ft(2,arguments);var r=yx(e),i=yx(t);return r.getTime()===i.getTime()}function $ee(e){return Ft(1,arguments),e instanceof Date||fl(e)==="object"&&Object.prototype.toString.call(e)==="[object Date]"}function ko(e){if(Ft(1,arguments),!$ee(e)&&typeof e!="number")return!1;var t=ir(e);return!isNaN(Number(t))}function qee(e){Ft(1,arguments);var t=ir(e),r=Math.floor(t.getMonth()/3)+1;return r}function Yee(e){Ft(1,arguments);var t=ir(e);return t.setSeconds(0,0),t}function gg(e){Ft(1,arguments);var t=ir(e),r=t.getMonth(),i=r-r%3;return t.setMonth(i,1),t.setHours(0,0,0,0),t}function Hl(e){Ft(1,arguments);var t=ir(e);return t.setDate(1),t.setHours(0,0,0,0),t}function QT(e){Ft(1,arguments);var t=ir(e),r=new Date(0);return r.setFullYear(t.getFullYear(),0,1),r.setHours(0,0,0,0),r}function OU(e,t){Ft(2,arguments);var r=Yr(t);return Uee(e,-r)}var Xee=864e5;function Kee(e){Ft(1,arguments);var t=ir(e),r=t.getTime();t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0);var i=t.getTime(),n=r-i;return Math.floor(n/Xee)+1}function Cp(e){Ft(1,arguments);var t=1,r=ir(e),i=r.getUTCDay(),n=(i<t?7:0)+i-t;return r.setUTCDate(r.getUTCDate()-n),r.setUTCHours(0,0,0,0),r}function RU(e){Ft(1,arguments);var t=ir(e),r=t.getUTCFullYear(),i=new Date(0);i.setUTCFullYear(r+1,0,4),i.setUTCHours(0,0,0,0);var n=Cp(i),a=new Date(0);a.setUTCFullYear(r,0,4),a.setUTCHours(0,0,0,0);var o=Cp(a);return t.getTime()>=n.getTime()?r+1:t.getTime()>=o.getTime()?r:r-1}function Qee(e){Ft(1,arguments);var t=RU(e),r=new Date(0);r.setUTCFullYear(t,0,4),r.setUTCHours(0,0,0,0);var i=Cp(r);return i}var Zee=6048e5;function IU(e){Ft(1,arguments);var t=ir(e),r=Cp(t).getTime()-Qee(t).getTime();return Math.round(r/Zee)+1}function ZT(e,t){var r,i,n,a,o,s,l,c;Ft(1,arguments);var u=ir(e),d=u.getUTCFullYear(),h=Th(),f=Yr((r=(i=(n=(a=t==null?void 0:t.firstWeekContainsDate)!==null&&a!==void 0?a:t==null||(o=t.locale)===null||o===void 0||(s=o.options)===null||s===void 0?void 0:s.firstWeekContainsDate)!==null&&n!==void 0?n:h.firstWeekContainsDate)!==null&&i!==void 0?i:(l=h.locale)===null||l===void 0||(c=l.options)===null||c===void 0?void 0:c.firstWeekContainsDate)!==null&&r!==void 0?r:1);if(!(f>=1&&f<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var p=new Date(0);p.setUTCFullYear(d+1,0,f),p.setUTCHours(0,0,0,0);var v=ch(p,t),m=new Date(0);m.setUTCFullYear(d,0,f),m.setUTCHours(0,0,0,0);var g=ch(m,t);return u.getTime()>=v.getTime()?d+1:u.getTime()>=g.getTime()?d:d-1}function Jee(e,t){var r,i,n,a,o,s,l,c;Ft(1,arguments);var u=Th(),d=Yr((r=(i=(n=(a=t==null?void 0:t.firstWeekContainsDate)!==null&&a!==void 0?a:t==null||(o=t.locale)===null||o===void 0||(s=o.options)===null||s===void 0?void 0:s.firstWeekContainsDate)!==null&&n!==void 0?n:u.firstWeekContainsDate)!==null&&i!==void 0?i:(l=u.locale)===null||l===void 0||(c=l.options)===null||c===void 0?void 0:c.firstWeekContainsDate)!==null&&r!==void 0?r:1),h=ZT(e,t),f=new Date(0);f.setUTCFullYear(h,0,d),f.setUTCHours(0,0,0,0);var p=ch(f,t);return p}var ete=6048e5;function zU(e,t){Ft(1,arguments);var r=ir(e),i=ch(r,t).getTime()-Jee(r,t).getTime();return Math.round(i/ete)+1}function Zr(e,t){for(var r=e<0?"-":"",i=Math.abs(e).toString();i.length<t;)i="0"+i;return r+i}var Oc={y:function(t,r){var i=t.getUTCFullYear(),n=i>0?i:1-i;return Zr(r==="yy"?n%100:n,r.length)},M:function(t,r){var i=t.getUTCMonth();return r==="M"?String(i+1):Zr(i+1,2)},d:function(t,r){return Zr(t.getUTCDate(),r.length)},a:function(t,r){var i=t.getUTCHours()/12>=1?"pm":"am";switch(r){case"a":case"aa":return i.toUpperCase();case"aaa":return i;case"aaaaa":return i[0];case"aaaa":default:return i==="am"?"a.m.":"p.m."}},h:function(t,r){return Zr(t.getUTCHours()%12||12,r.length)},H:function(t,r){return Zr(t.getUTCHours(),r.length)},m:function(t,r){return Zr(t.getUTCMinutes(),r.length)},s:function(t,r){return Zr(t.getUTCSeconds(),r.length)},S:function(t,r){var i=r.length,n=t.getUTCMilliseconds(),a=Math.floor(n*Math.pow(10,i-3));return Zr(a,r.length)}},Hh={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},tte={G:function(t,r,i){var n=t.getUTCFullYear()>0?1:0;switch(r){case"G":case"GG":case"GGG":return i.era(n,{width:"abbreviated"});case"GGGGG":return i.era(n,{width:"narrow"});case"GGGG":default:return i.era(n,{width:"wide"})}},y:function(t,r,i){if(r==="yo"){var n=t.getUTCFullYear(),a=n>0?n:1-n;return i.ordinalNumber(a,{unit:"year"})}return Oc.y(t,r)},Y:function(t,r,i,n){var a=ZT(t,n),o=a>0?a:1-a;if(r==="YY"){var s=o%100;return Zr(s,2)}return r==="Yo"?i.ordinalNumber(o,{unit:"year"}):Zr(o,r.length)},R:function(t,r){var i=RU(t);return Zr(i,r.length)},u:function(t,r){var i=t.getUTCFullYear();return Zr(i,r.length)},Q:function(t,r,i){var n=Math.ceil((t.getUTCMonth()+1)/3);switch(r){case"Q":return String(n);case"QQ":return Zr(n,2);case"Qo":return i.ordinalNumber(n,{unit:"quarter"});case"QQQ":return i.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return i.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return i.quarter(n,{width:"wide",context:"formatting"})}},q:function(t,r,i){var n=Math.ceil((t.getUTCMonth()+1)/3);switch(r){case"q":return String(n);case"qq":return Zr(n,2);case"qo":return i.ordinalNumber(n,{unit:"quarter"});case"qqq":return i.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return i.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return i.quarter(n,{width:"wide",context:"standalone"})}},M:function(t,r,i){var n=t.getUTCMonth();switch(r){case"M":case"MM":return Oc.M(t,r);case"Mo":return i.ordinalNumber(n+1,{unit:"month"});case"MMM":return i.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return i.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return i.month(n,{width:"wide",context:"formatting"})}},L:function(t,r,i){var n=t.getUTCMonth();switch(r){case"L":return String(n+1);case"LL":return Zr(n+1,2);case"Lo":return i.ordinalNumber(n+1,{unit:"month"});case"LLL":return i.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return i.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return i.month(n,{width:"wide",context:"standalone"})}},w:function(t,r,i,n){var a=zU(t,n);return r==="wo"?i.ordinalNumber(a,{unit:"week"}):Zr(a,r.length)},I:function(t,r,i){var n=IU(t);return r==="Io"?i.ordinalNumber(n,{unit:"week"}):Zr(n,r.length)},d:function(t,r,i){return r==="do"?i.ordinalNumber(t.getUTCDate(),{unit:"date"}):Oc.d(t,r)},D:function(t,r,i){var n=Kee(t);return r==="Do"?i.ordinalNumber(n,{unit:"dayOfYear"}):Zr(n,r.length)},E:function(t,r,i){var n=t.getUTCDay();switch(r){case"E":case"EE":case"EEE":return i.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return i.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return i.day(n,{width:"short",context:"formatting"});case"EEEE":default:return i.day(n,{width:"wide",context:"formatting"})}},e:function(t,r,i,n){var a=t.getUTCDay(),o=(a-n.weekStartsOn+8)%7||7;switch(r){case"e":return String(o);case"ee":return Zr(o,2);case"eo":return i.ordinalNumber(o,{unit:"day"});case"eee":return i.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return i.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return i.day(a,{width:"short",context:"formatting"});case"eeee":default:return i.day(a,{width:"wide",context:"formatting"})}},c:function(t,r,i,n){var a=t.getUTCDay(),o=(a-n.weekStartsOn+8)%7||7;switch(r){case"c":return String(o);case"cc":return Zr(o,r.length);case"co":return i.ordinalNumber(o,{unit:"day"});case"ccc":return i.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return i.day(a,{width:"narrow",context:"standalone"});case"cccccc":return i.day(a,{width:"short",context:"standalone"});case"cccc":default:return i.day(a,{width:"wide",context:"standalone"})}},i:function(t,r,i){var n=t.getUTCDay(),a=n===0?7:n;switch(r){case"i":return String(a);case"ii":return Zr(a,r.length);case"io":return i.ordinalNumber(a,{unit:"day"});case"iii":return i.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return i.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return i.day(n,{width:"short",context:"formatting"});case"iiii":default:return i.day(n,{width:"wide",context:"formatting"})}},a:function(t,r,i){var n=t.getUTCHours(),a=n/12>=1?"pm":"am";switch(r){case"a":case"aa":return i.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return i.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return i.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return i.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(t,r,i){var n=t.getUTCHours(),a;switch(n===12?a=Hh.noon:n===0?a=Hh.midnight:a=n/12>=1?"pm":"am",r){case"b":case"bb":return i.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return i.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return i.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return i.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(t,r,i){var n=t.getUTCHours(),a;switch(n>=17?a=Hh.evening:n>=12?a=Hh.afternoon:n>=4?a=Hh.morning:a=Hh.night,r){case"B":case"BB":case"BBB":return i.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return i.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return i.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(t,r,i){if(r==="ho"){var n=t.getUTCHours()%12;return n===0&&(n=12),i.ordinalNumber(n,{unit:"hour"})}return Oc.h(t,r)},H:function(t,r,i){return r==="Ho"?i.ordinalNumber(t.getUTCHours(),{unit:"hour"}):Oc.H(t,r)},K:function(t,r,i){var n=t.getUTCHours()%12;return r==="Ko"?i.ordinalNumber(n,{unit:"hour"}):Zr(n,r.length)},k:function(t,r,i){var n=t.getUTCHours();return n===0&&(n=24),r==="ko"?i.ordinalNumber(n,{unit:"hour"}):Zr(n,r.length)},m:function(t,r,i){return r==="mo"?i.ordinalNumber(t.getUTCMinutes(),{unit:"minute"}):Oc.m(t,r)},s:function(t,r,i){return r==="so"?i.ordinalNumber(t.getUTCSeconds(),{unit:"second"}):Oc.s(t,r)},S:function(t,r){return Oc.S(t,r)},X:function(t,r,i,n){var a=n._originalDate||t,o=a.getTimezoneOffset();if(o===0)return"Z";switch(r){case"X":return oR(o);case"XXXX":case"XX":return md(o);case"XXXXX":case"XXX":default:return md(o,":")}},x:function(t,r,i,n){var a=n._originalDate||t,o=a.getTimezoneOffset();switch(r){case"x":return oR(o);case"xxxx":case"xx":return md(o);case"xxxxx":case"xxx":default:return md(o,":")}},O:function(t,r,i,n){var a=n._originalDate||t,o=a.getTimezoneOffset();switch(r){case"O":case"OO":case"OOO":return"GMT"+aR(o,":");case"OOOO":default:return"GMT"+md(o,":")}},z:function(t,r,i,n){var a=n._originalDate||t,o=a.getTimezoneOffset();switch(r){case"z":case"zz":case"zzz":return"GMT"+aR(o,":");case"zzzz":default:return"GMT"+md(o,":")}},t:function(t,r,i,n){var a=n._originalDate||t,o=Math.floor(a.getTime()/1e3);return Zr(o,r.length)},T:function(t,r,i,n){var a=n._originalDate||t,o=a.getTime();return Zr(o,r.length)}};function aR(e,t){var r=e>0?"-":"+",i=Math.abs(e),n=Math.floor(i/60),a=i%60;if(a===0)return r+String(n);var o=t;return r+String(n)+o+Zr(a,2)}function oR(e,t){if(e%60===0){var r=e>0?"-":"+";return r+Zr(Math.abs(e)/60,2)}return md(e,t)}function md(e,t){var r=t||"",i=e>0?"-":"+",n=Math.abs(e),a=Zr(Math.floor(n/60),2),o=Zr(n%60,2);return i+a+r+o}var sR=function(t,r){switch(t){case"P":return r.date({width:"short"});case"PP":return r.date({width:"medium"});case"PPP":return r.date({width:"long"});case"PPPP":default:return r.date({width:"full"})}},kU=function(t,r){switch(t){case"p":return r.time({width:"short"});case"pp":return r.time({width:"medium"});case"ppp":return r.time({width:"long"});case"pppp":default:return r.time({width:"full"})}},rte=function(t,r){var i=t.match(/(P+)(p+)?/)||[],n=i[1],a=i[2];if(!a)return sR(t,r);var o;switch(n){case"P":o=r.dateTime({width:"short"});break;case"PP":o=r.dateTime({width:"medium"});break;case"PPP":o=r.dateTime({width:"long"});break;case"PPPP":default:o=r.dateTime({width:"full"});break}return o.replace("{{date}}",sR(n,r)).replace("{{time}}",kU(a,r))},W2={p:kU,P:rte},ite=["D","DD"],nte=["YY","YYYY"];function LU(e){return ite.indexOf(e)!==-1}function BU(e){return nte.indexOf(e)!==-1}function bx(e,t,r){if(e==="YYYY")throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(t,"`) for formatting years to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(e==="YY")throw new RangeError("Use `yy` instead of `YY` (in `".concat(t,"`) for formatting years to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(e==="D")throw new RangeError("Use `d` instead of `D` (in `".concat(t,"`) for formatting days of the month to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(e==="DD")throw new RangeError("Use `dd` instead of `DD` (in `".concat(t,"`) for formatting days of the month to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"))}var ate=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,ote=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,ste=/^'([^]*?)'?$/,lte=/''/g,cte=/[a-zA-Z]/;function oi(e,t,r){var i,n,a,o,s,l,c,u,d,h,f,p,v,m,g,y,b,x;Ft(2,arguments);var S=String(t),w=Th(),_=(i=(n=r==null?void 0:r.locale)!==null&&n!==void 0?n:w.locale)!==null&&i!==void 0?i:KT,C=Yr((a=(o=(s=(l=r==null?void 0:r.firstWeekContainsDate)!==null&&l!==void 0?l:r==null||(c=r.locale)===null||c===void 0||(u=c.options)===null||u===void 0?void 0:u.firstWeekContainsDate)!==null&&s!==void 0?s:w.firstWeekContainsDate)!==null&&o!==void 0?o:(d=w.locale)===null||d===void 0||(h=d.options)===null||h===void 0?void 0:h.firstWeekContainsDate)!==null&&a!==void 0?a:1);if(!(C>=1&&C<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var A=Yr((f=(p=(v=(m=r==null?void 0:r.weekStartsOn)!==null&&m!==void 0?m:r==null||(g=r.locale)===null||g===void 0||(y=g.options)===null||y===void 0?void 0:y.weekStartsOn)!==null&&v!==void 0?v:w.weekStartsOn)!==null&&p!==void 0?p:(b=w.locale)===null||b===void 0||(x=b.options)===null||x===void 0?void 0:x.weekStartsOn)!==null&&f!==void 0?f:0);if(!(A>=0&&A<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!_.localize)throw new RangeError("locale must contain localize property");if(!_.formatLong)throw new RangeError("locale must contain formatLong property");var M=ir(e);if(!ko(M))throw new RangeError("Invalid time value");var P=DU(M),T=OU(M,P),R={firstWeekContainsDate:C,weekStartsOn:A,locale:_,_originalDate:M},z=S.match(ote).map(function(F){var H=F[0];if(H==="p"||H==="P"){var N=W2[H];return N(F,_.formatLong)}return F}).join("").match(ate).map(function(F){if(F==="''")return"'";var H=F[0];if(H==="'")return ute(F);var N=tte[H];if(N)return!(r!=null&&r.useAdditionalWeekYearTokens)&&BU(F)&&bx(F,t,String(e)),!(r!=null&&r.useAdditionalDayOfYearTokens)&&LU(F)&&bx(F,t,String(e)),N(T,F,_.localize,R);if(H.match(cte))throw new RangeError("Format string contains an unescaped latin alphabet character `"+H+"`");return F}).join("");return z}function ute(e){var t=e.match(ste);return t?t[1].replace(lte,"'"):e}function dte(e,t){if(e==null)throw new TypeError("assign requires that input parameter not be null or undefined");for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}function To(e){Ft(1,arguments);var t=ir(e),r=t.getDate();return r}function hte(e){Ft(1,arguments);var t=ir(e),r=t.getDay();return r}function fte(e){Ft(1,arguments);var t=ir(e),r=t.getFullYear(),i=t.getMonth(),n=new Date(0);return n.setFullYear(r,i+1,0),n.setHours(0,0,0,0),n.getDate()}function ou(e){Ft(1,arguments);var t=ir(e),r=t.getHours();return r}function pte(e){Ft(1,arguments);var t=ir(e),r=t.getMilliseconds();return r}function xx(e){Ft(1,arguments);var t=ir(e),r=t.getMinutes();return r}function pi(e){Ft(1,arguments);var t=ir(e),r=t.getMonth();return r}function wx(e){Ft(1,arguments);var t=ir(e),r=t.getSeconds();return r}function gt(e){Ft(1,arguments);var t=ir(e),r=t.getTime();return r}function Ei(e){return Ft(1,arguments),ir(e).getFullYear()}function lR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}function mte(e,t){if(e){if(typeof e=="string")return lR(e,t);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?lR(e,t):void 0}}function cR(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=mte(e))||t){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(c){throw c},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var c=r.next();return o=c.done,c},e:function(c){s=!0,a=c},f:function(){try{o||r.return==null||r.return()}finally{if(s)throw a}}}}function Et(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function G2(e,t){return G2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},G2(e,t)}function Fr(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&G2(e,t)}function Sx(e){return Sx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Sx(e)}function FU(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(FU=function(){return!!e})()}function vte(e,t){if(t&&(fl(t)=="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Et(e)}function Nr(e){var t=FU();return function(){var r,i=Sx(e);if(t){var n=Sx(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return vte(this,r)}}function Rr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gte(e,t){if(fl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(fl(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function NU(e){var t=gte(e,"string");return fl(t)=="symbol"?t:t+""}function yte(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,NU(i.key),i)}}function Ir(e,t,r){return t&&yte(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Mt(e,t,r){return(t=NU(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var bte=10,UU=function(){function e(){Rr(this,e),Mt(this,"priority",void 0),Mt(this,"subPriority",0)}return Ir(e,[{key:"validate",value:function(r,i){return!0}}]),e}(),xte=function(e){Fr(r,e);var t=Nr(r);function r(i,n,a,o,s){var l;return Rr(this,r),l=t.call(this),l.value=i,l.validateValue=n,l.setValue=a,l.priority=o,s&&(l.subPriority=s),l}return Ir(r,[{key:"validate",value:function(n,a){return this.validateValue(n,this.value,a)}},{key:"set",value:function(n,a,o){return this.setValue(n,a,this.value,o)}}]),r}(UU),wte=function(e){Fr(r,e);var t=Nr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"priority",bte),Mt(Et(i),"subPriority",-1),i}return Ir(r,[{key:"set",value:function(n,a){if(a.timestampIsSet)return n;var o=new Date(0);return o.setFullYear(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate()),o.setHours(n.getUTCHours(),n.getUTCMinutes(),n.getUTCSeconds(),n.getUTCMilliseconds()),o}}]),r}(UU),Gr=function(){function e(){Rr(this,e),Mt(this,"incompatibleTokens",void 0),Mt(this,"priority",void 0),Mt(this,"subPriority",void 0)}return Ir(e,[{key:"run",value:function(r,i,n,a){var o=this.parse(r,i,n,a);return o?{setter:new xte(o.value,this.validate,this.set,this.priority,this.subPriority),rest:o.rest}:null}},{key:"validate",value:function(r,i,n){return!0}}]),e}(),Ste=function(e){Fr(r,e);var t=Nr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"priority",140),Mt(Et(i),"incompatibleTokens",["R","u","t","T"]),i}return Ir(r,[{key:"parse",value:function(n,a,o){switch(a){case"G":case"GG":case"GGG":return o.era(n,{width:"abbreviated"})||o.era(n,{width:"narrow"});case"GGGGG":return o.era(n,{width:"narrow"});case"GGGG":default:return o.era(n,{width:"wide"})||o.era(n,{width:"abbreviated"})||o.era(n,{width:"narrow"})}}},{key:"set",value:function(n,a,o){return a.era=o,n.setUTCFullYear(o,0,1),n.setUTCHours(0,0,0,0),n}}]),r}(Gr),Gi={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},Xs={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function $i(e,t){return e&&{value:t(e.value),rest:e.rest}}function Pi(e,t){var r=t.match(e);return r?{value:parseInt(r[0],10),rest:t.slice(r[0].length)}:null}function Ks(e,t){var r=t.match(e);if(!r)return null;if(r[0]==="Z")return{value:0,rest:t.slice(1)};var i=r[1]==="+"?1:-1,n=r[2]?parseInt(r[2],10):0,a=r[3]?parseInt(r[3],10):0,o=r[5]?parseInt(r[5],10):0;return{value:i*(n*Hee+a*Vee+o*Wee),rest:t.slice(r[0].length)}}function jU(e){return Pi(Gi.anyDigitsSigned,e)}function ji(e,t){switch(e){case 1:return Pi(Gi.singleDigit,t);case 2:return Pi(Gi.twoDigits,t);case 3:return Pi(Gi.threeDigits,t);case 4:return Pi(Gi.fourDigits,t);default:return Pi(new RegExp("^\\d{1,"+e+"}"),t)}}function Cx(e,t){switch(e){case 1:return Pi(Gi.singleDigitSigned,t);case 2:return Pi(Gi.twoDigitsSigned,t);case 3:return Pi(Gi.threeDigitsSigned,t);case 4:return Pi(Gi.fourDigitsSigned,t);default:return Pi(new RegExp("^-?\\d{1,"+e+"}"),t)}}function JT(e){switch(e){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function VU(e,t){var r=t>0,i=r?t:1-t,n;if(i<=50)n=e||100;else{var a=i+50,o=Math.floor(a/100)*100,s=e>=a%100;n=e+o-(s?100:0)}return r?n:1-n}function HU(e){return e%400===0||e%4===0&&e%100!==0}var Cte=function(e){Fr(r,e);var t=Nr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"priority",130),Mt(Et(i),"incompatibleTokens",["Y","R","u","w","I","i","e","c","t","T"]),i}return Ir(r,[{key:"parse",value:function(n,a,o){var s=function(c){return{year:c,isTwoDigitYear:a==="yy"}};switch(a){case"y":return $i(ji(4,n),s);case"yo":return $i(o.ordinalNumber(n,{unit:"year"}),s);default:return $i(ji(a.length,n),s)}}},{key:"validate",value:function(n,a){return a.isTwoDigitYear||a.year>0}},{key:"set",value:function(n,a,o){var s=n.getUTCFullYear();if(o.isTwoDigitYear){var l=VU(o.year,s);return n.setUTCFullYear(l,0,1),n.setUTCHours(0,0,0,0),n}var c=!("era"in a)||a.era===1?o.year:1-o.year;return n.setUTCFullYear(c,0,1),n.setUTCHours(0,0,0,0),n}}]),r}(Gr),_te=function(e){Fr(r,e);var t=Nr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"priority",130),Mt(Et(i),"incompatibleTokens",["y","R","u","Q","q","M","L","I","d","D","i","t","T"]),i}return Ir(r,[{key:"parse",value:function(n,a,o){var s=function(c){return{year:c,isTwoDigitYear:a==="YY"}};switch(a){case"Y":return $i(ji(4,n),s);case"Yo":return $i(o.ordinalNumber(n,{unit:"year"}),s);default:return $i(ji(a.length,n),s)}}},{key:"validate",value:function(n,a){return a.isTwoDigitYear||a.year>0}},{key:"set",value:function(n,a,o,s){var l=ZT(n,s);if(o.isTwoDigitYear){var c=VU(o.year,l);return n.setUTCFullYear(c,0,s.firstWeekContainsDate),n.setUTCHours(0,0,0,0),ch(n,s)}var u=!("era"in a)||a.era===1?o.year:1-o.year;return n.setUTCFullYear(u,0,s.firstWeekContainsDate),n.setUTCHours(0,0,0,0),ch(n,s)}}]),r}(Gr),Ate=function(e){Fr(r,e);var t=Nr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"priority",130),Mt(Et(i),"incompatibleTokens",["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]),i}return Ir(r,[{key:"parse",value:function(n,a){return Cx(a==="R"?4:a.length,n)}},{key:"set",value:function(n,a,o){var s=new Date(0);return s.setUTCFullYear(o,0,4),s.setUTCHours(0,0,0,0),Cp(s)}}]),r}(Gr),Mte=function(e){Fr(r,e);var t=Nr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"priority",130),Mt(Et(i),"incompatibleTokens",["G","y","Y","R","w","I","i","e","c","t","T"]),i}return Ir(r,[{key:"parse",value:function(n,a){return Cx(a==="u"?4:a.length,n)}},{key:"set",value:function(n,a,o){return n.setUTCFullYear(o,0,1),n.setUTCHours(0,0,0,0),n}}]),r}(Gr),Ete=function(e){Fr(r,e);var t=Nr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"priority",120),Mt(Et(i),"incompatibleTokens",["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]),i}return Ir(r,[{key:"parse",value:function(n,a,o){switch(a){case"Q":case"QQ":return ji(a.length,n);case"Qo":return o.ordinalNumber(n,{unit:"quarter"});case"QQQ":return o.quarter(n,{width:"abbreviated",context:"formatting"})||o.quarter(n,{width:"narrow",context:"formatting"});case"QQQQQ":return o.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return o.quarter(n,{width:"wide",context:"formatting"})||o.quarter(n,{width:"abbreviated",context:"formatting"})||o.quarter(n,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(n,a){return a>=1&&a<=4}},{key:"set",value:function(n,a,o){return n.setUTCMonth((o-1)*3,1),n.setUTCHours(0,0,0,0),n}}]),r}(Gr),Tte=function(e){Fr(r,e);var t=Nr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"priority",120),Mt(Et(i),"incompatibleTokens",["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]),i}return Ir(r,[{key:"parse",value:function(n,a,o){switch(a){case"q":case"qq":return ji(a.length,n);case"qo":return o.ordinalNumber(n,{unit:"quarter"});case"qqq":return o.quarter(n,{width:"abbreviated",context:"standalone"})||o.quarter(n,{width:"narrow",context:"standalone"});case"qqqqq":return o.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return o.quarter(n,{width:"wide",context:"standalone"})||o.quarter(n,{width:"abbreviated",context:"standalone"})||o.quarter(n,{width:"narrow",context:"standalone"})}}},{key:"validate",value:function(n,a){return a>=1&&a<=4}},{key:"set",value:function(n,a,o){return n.setUTCMonth((o-1)*3,1),n.setUTCHours(0,0,0,0),n}}]),r}(Gr),Pte=function(e){Fr(r,e);var t=Nr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"incompatibleTokens",["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]),Mt(Et(i),"priority",110),i}return Ir(r,[{key:"parse",value:function(n,a,o){var s=function(c){return c-1};switch(a){case"M":return $i(Pi(Gi.month,n),s);case"MM":return $i(ji(2,n),s);case"Mo":return $i(o.ordinalNumber(n,{unit:"month"}),s);case"MMM":return o.month(n,{width:"abbreviated",context:"formatting"})||o.month(n,{width:"narrow",context:"formatting"});case"MMMMM":return o.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return o.month(n,{width:"wide",context:"formatting"})||o.month(n,{width:"abbreviated",context:"formatting"})||o.month(n,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(n,a){return a>=0&&a<=11}},{key:"set",value:function(n,a,o){return n.setUTCMonth(o,1),n.setUTCHours(0,0,0,0),n}}]),r}(Gr),Dte=function(e){Fr(r,e);var t=Nr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"priority",110),Mt(Et(i),"incompatibleTokens",["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]),i}return Ir(r,[{key:"parse",value:function(n,a,o){var s=function(c){return c-1};switch(a){case"L":return $i(Pi(Gi.month,n),s);case"LL":return $i(ji(2,n),s);case"Lo":return $i(o.ordinalNumber(n,{unit:"month"}),s);case"LLL":return o.month(n,{width:"abbreviated",context:"standalone"})||o.month(n,{width:"narrow",context:"standalone"});case"LLLLL":return o.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return o.month(n,{width:"wide",context:"standalone"})||o.month(n,{width:"abbreviated",context:"standalone"})||o.month(n,{width:"narrow",context:"standalone"})}}},{key:"validate",value:function(n,a){return a>=0&&a<=11}},{key:"set",value:function(n,a,o){return n.setUTCMonth(o,1),n.setUTCHours(0,0,0,0),n}}]),r}(Gr);function Ote(e,t,r){Ft(2,arguments);var i=ir(e),n=Yr(t),a=zU(i,r)-n;return i.setUTCDate(i.getUTCDate()-a*7),i}var Rte=function(e){Fr(r,e);var t=Nr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"priority",100),Mt(Et(i),"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","i","t","T"]),i}return Ir(r,[{key:"parse",value:function(n,a,o){switch(a){case"w":return Pi(Gi.week,n);case"wo":return o.ordinalNumber(n,{unit:"week"});default:return ji(a.length,n)}}},{key:"validate",value:function(n,a){return a>=1&&a<=53}},{key:"set",value:function(n,a,o,s){return ch(Ote(n,o,s),s)}}]),r}(Gr);function Ite(e,t){Ft(2,arguments);var r=ir(e),i=Yr(t),n=IU(r)-i;return r.setUTCDate(r.getUTCDate()-n*7),r}var zte=function(e){Fr(r,e);var t=Nr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"priority",100),Mt(Et(i),"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]),i}return Ir(r,[{key:"parse",value:function(n,a,o){switch(a){case"I":return Pi(Gi.week,n);case"Io":return o.ordinalNumber(n,{unit:"week"});default:return ji(a.length,n)}}},{key:"validate",value:function(n,a){return a>=1&&a<=53}},{key:"set",value:function(n,a,o){return Cp(Ite(n,o))}}]),r}(Gr),kte=[31,28,31,30,31,30,31,31,30,31,30,31],Lte=[31,29,31,30,31,30,31,31,30,31,30,31],Bte=function(e){Fr(r,e);var t=Nr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"priority",90),Mt(Et(i),"subPriority",1),Mt(Et(i),"incompatibleTokens",["Y","R","q","Q","w","I","D","i","e","c","t","T"]),i}return Ir(r,[{key:"parse",value:function(n,a,o){switch(a){case"d":return Pi(Gi.date,n);case"do":return o.ordinalNumber(n,{unit:"date"});default:return ji(a.length,n)}}},{key:"validate",value:function(n,a){var o=n.getUTCFullYear(),s=HU(o),l=n.getUTCMonth();return s?a>=1&&a<=Lte[l]:a>=1&&a<=kte[l]}},{key:"set",value:function(n,a,o){return n.setUTCDate(o),n.setUTCHours(0,0,0,0),n}}]),r}(Gr),Fte=function(e){Fr(r,e);var t=Nr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"priority",90),Mt(Et(i),"subpriority",1),Mt(Et(i),"incompatibleTokens",["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]),i}return Ir(r,[{key:"parse",value:function(n,a,o){switch(a){case"D":case"DD":return Pi(Gi.dayOfYear,n);case"Do":return o.ordinalNumber(n,{unit:"date"});default:return ji(a.length,n)}}},{key:"validate",value:function(n,a){var o=n.getUTCFullYear(),s=HU(o);return s?a>=1&&a<=366:a>=1&&a<=365}},{key:"set",value:function(n,a,o){return n.setUTCMonth(0,o),n.setUTCHours(0,0,0,0),n}}]),r}(Gr);function eP(e,t,r){var i,n,a,o,s,l,c,u;Ft(2,arguments);var d=Th(),h=Yr((i=(n=(a=(o=r==null?void 0:r.weekStartsOn)!==null&&o!==void 0?o:r==null||(s=r.locale)===null||s===void 0||(l=s.options)===null||l===void 0?void 0:l.weekStartsOn)!==null&&a!==void 0?a:d.weekStartsOn)!==null&&n!==void 0?n:(c=d.locale)===null||c===void 0||(u=c.options)===null||u===void 0?void 0:u.weekStartsOn)!==null&&i!==void 0?i:0);if(!(h>=0&&h<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var f=ir(e),p=Yr(t),v=f.getUTCDay(),m=p%7,g=(m+7)%7,y=(g<h?7:0)+p-v;return f.setUTCDate(f.getUTCDate()+y),f}var Nte=function(e){Fr(r,e);var t=Nr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"priority",90),Mt(Et(i),"incompatibleTokens",["D","i","e","c","t","T"]),i}return Ir(r,[{key:"parse",value:function(n,a,o){switch(a){case"E":case"EE":case"EEE":return o.day(n,{width:"abbreviated",context:"formatting"})||o.day(n,{width:"short",context:"formatting"})||o.day(n,{width:"narrow",context:"formatting"});case"EEEEE":return o.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return o.day(n,{width:"short",context:"formatting"})||o.day(n,{width:"narrow",context:"formatting"});case"EEEE":default:return o.day(n,{width:"wide",context:"formatting"})||o.day(n,{width:"abbreviated",context:"formatting"})||o.day(n,{width:"short",context:"formatting"})||o.day(n,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(n,a){return a>=0&&a<=6}},{key:"set",value:function(n,a,o,s){return n=eP(n,o,s),n.setUTCHours(0,0,0,0),n}}]),r}(Gr),Ute=function(e){Fr(r,e);var t=Nr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"priority",90),Mt(Et(i),"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]),i}return Ir(r,[{key:"parse",value:function(n,a,o,s){var l=function(u){var d=Math.floor((u-1)/7)*7;return(u+s.weekStartsOn+6)%7+d};switch(a){case"e":case"ee":return $i(ji(a.length,n),l);case"eo":return $i(o.ordinalNumber(n,{unit:"day"}),l);case"eee":return o.day(n,{width:"abbreviated",context:"formatting"})||o.day(n,{width:"short",context:"formatting"})||o.day(n,{width:"narrow",context:"formatting"});case"eeeee":return o.day(n,{width:"narrow",context:"formatting"});case"eeeeee":return o.day(n,{width:"short",context:"formatting"})||o.day(n,{width:"narrow",context:"formatting"});case"eeee":default:return o.day(n,{width:"wide",context:"formatting"})||o.day(n,{width:"abbreviated",context:"formatting"})||o.day(n,{width:"short",context:"formatting"})||o.day(n,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(n,a){return a>=0&&a<=6}},{key:"set",value:function(n,a,o,s){return n=eP(n,o,s),n.setUTCHours(0,0,0,0),n}}]),r}(Gr),jte=function(e){Fr(r,e);var t=Nr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"priority",90),Mt(Et(i),"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]),i}return Ir(r,[{key:"parse",value:function(n,a,o,s){var l=function(u){var d=Math.floor((u-1)/7)*7;return(u+s.weekStartsOn+6)%7+d};switch(a){case"c":case"cc":return $i(ji(a.length,n),l);case"co":return $i(o.ordinalNumber(n,{unit:"day"}),l);case"ccc":return o.day(n,{width:"abbreviated",context:"standalone"})||o.day(n,{width:"short",context:"standalone"})||o.day(n,{width:"narrow",context:"standalone"});case"ccccc":return o.day(n,{width:"narrow",context:"standalone"});case"cccccc":return o.day(n,{width:"short",context:"standalone"})||o.day(n,{width:"narrow",context:"standalone"});case"cccc":default:return o.day(n,{width:"wide",context:"standalone"})||o.day(n,{width:"abbreviated",context:"standalone"})||o.day(n,{width:"short",context:"standalone"})||o.day(n,{width:"narrow",context:"standalone"})}}},{key:"validate",value:function(n,a){return a>=0&&a<=6}},{key:"set",value:function(n,a,o,s){return n=eP(n,o,s),n.setUTCHours(0,0,0,0),n}}]),r}(Gr);function Vte(e,t){Ft(2,arguments);var r=Yr(t);r%7===0&&(r=r-7);var i=1,n=ir(e),a=n.getUTCDay(),o=r%7,s=(o+7)%7,l=(s<i?7:0)+r-a;return n.setUTCDate(n.getUTCDate()+l),n}var Hte=function(e){Fr(r,e);var t=Nr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"priority",90),Mt(Et(i),"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]),i}return Ir(r,[{key:"parse",value:function(n,a,o){var s=function(c){return c===0?7:c};switch(a){case"i":case"ii":return ji(a.length,n);case"io":return o.ordinalNumber(n,{unit:"day"});case"iii":return $i(o.day(n,{width:"abbreviated",context:"formatting"})||o.day(n,{width:"short",context:"formatting"})||o.day(n,{width:"narrow",context:"formatting"}),s);case"iiiii":return $i(o.day(n,{width:"narrow",context:"formatting"}),s);case"iiiiii":return $i(o.day(n,{width:"short",context:"formatting"})||o.day(n,{width:"narrow",context:"formatting"}),s);case"iiii":default:return $i(o.day(n,{width:"wide",context:"formatting"})||o.day(n,{width:"abbreviated",context:"formatting"})||o.day(n,{width:"short",context:"formatting"})||o.day(n,{width:"narrow",context:"formatting"}),s)}}},{key:"validate",value:function(n,a){return a>=1&&a<=7}},{key:"set",value:function(n,a,o){return n=Vte(n,o),n.setUTCHours(0,0,0,0),n}}]),r}(Gr),Wte=function(e){Fr(r,e);var t=Nr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"priority",80),Mt(Et(i),"incompatibleTokens",["b","B","H","k","t","T"]),i}return Ir(r,[{key:"parse",value:function(n,a,o){switch(a){case"a":case"aa":case"aaa":return o.dayPeriod(n,{width:"abbreviated",context:"formatting"})||o.dayPeriod(n,{width:"narrow",context:"formatting"});case"aaaaa":return o.dayPeriod(n,{width:"narrow",context:"formatting"});case"aaaa":default:return o.dayPeriod(n,{width:"wide",context:"formatting"})||o.dayPeriod(n,{width:"abbreviated",context:"formatting"})||o.dayPeriod(n,{width:"narrow",context:"formatting"})}}},{key:"set",value:function(n,a,o){return n.setUTCHours(JT(o),0,0,0),n}}]),r}(Gr),Gte=function(e){Fr(r,e);var t=Nr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"priority",80),Mt(Et(i),"incompatibleTokens",["a","B","H","k","t","T"]),i}return Ir(r,[{key:"parse",value:function(n,a,o){switch(a){case"b":case"bb":case"bbb":return o.dayPeriod(n,{width:"abbreviated",context:"formatting"})||o.dayPeriod(n,{width:"narrow",context:"formatting"});case"bbbbb":return o.dayPeriod(n,{width:"narrow",context:"formatting"});case"bbbb":default:return o.dayPeriod(n,{width:"wide",context:"formatting"})||o.dayPeriod(n,{width:"abbreviated",context:"formatting"})||o.dayPeriod(n,{width:"narrow",context:"formatting"})}}},{key:"set",value:function(n,a,o){return n.setUTCHours(JT(o),0,0,0),n}}]),r}(Gr),$te=function(e){Fr(r,e);var t=Nr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"priority",80),Mt(Et(i),"incompatibleTokens",["a","b","t","T"]),i}return Ir(r,[{key:"parse",value:function(n,a,o){switch(a){case"B":case"BB":case"BBB":return o.dayPeriod(n,{width:"abbreviated",context:"formatting"})||o.dayPeriod(n,{width:"narrow",context:"formatting"});case"BBBBB":return o.dayPeriod(n,{width:"narrow",context:"formatting"});case"BBBB":default:return o.dayPeriod(n,{width:"wide",context:"formatting"})||o.dayPeriod(n,{width:"abbreviated",context:"formatting"})||o.dayPeriod(n,{width:"narrow",context:"formatting"})}}},{key:"set",value:function(n,a,o){return n.setUTCHours(JT(o),0,0,0),n}}]),r}(Gr),qte=function(e){Fr(r,e);var t=Nr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"priority",70),Mt(Et(i),"incompatibleTokens",["H","K","k","t","T"]),i}return Ir(r,[{key:"parse",value:function(n,a,o){switch(a){case"h":return Pi(Gi.hour12h,n);case"ho":return o.ordinalNumber(n,{unit:"hour"});default:return ji(a.length,n)}}},{key:"validate",value:function(n,a){return a>=1&&a<=12}},{key:"set",value:function(n,a,o){var s=n.getUTCHours()>=12;return s&&o<12?n.setUTCHours(o+12,0,0,0):!s&&o===12?n.setUTCHours(0,0,0,0):n.setUTCHours(o,0,0,0),n}}]),r}(Gr),Yte=function(e){Fr(r,e);var t=Nr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"priority",70),Mt(Et(i),"incompatibleTokens",["a","b","h","K","k","t","T"]),i}return Ir(r,[{key:"parse",value:function(n,a,o){switch(a){case"H":return Pi(Gi.hour23h,n);case"Ho":return o.ordinalNumber(n,{unit:"hour"});default:return ji(a.length,n)}}},{key:"validate",value:function(n,a){return a>=0&&a<=23}},{key:"set",value:function(n,a,o){return n.setUTCHours(o,0,0,0),n}}]),r}(Gr),Xte=function(e){Fr(r,e);var t=Nr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"priority",70),Mt(Et(i),"incompatibleTokens",["h","H","k","t","T"]),i}return Ir(r,[{key:"parse",value:function(n,a,o){switch(a){case"K":return Pi(Gi.hour11h,n);case"Ko":return o.ordinalNumber(n,{unit:"hour"});default:return ji(a.length,n)}}},{key:"validate",value:function(n,a){return a>=0&&a<=11}},{key:"set",value:function(n,a,o){var s=n.getUTCHours()>=12;return s&&o<12?n.setUTCHours(o+12,0,0,0):n.setUTCHours(o,0,0,0),n}}]),r}(Gr),Kte=function(e){Fr(r,e);var t=Nr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"priority",70),Mt(Et(i),"incompatibleTokens",["a","b","h","H","K","t","T"]),i}return Ir(r,[{key:"parse",value:function(n,a,o){switch(a){case"k":return Pi(Gi.hour24h,n);case"ko":return o.ordinalNumber(n,{unit:"hour"});default:return ji(a.length,n)}}},{key:"validate",value:function(n,a){return a>=1&&a<=24}},{key:"set",value:function(n,a,o){var s=o<=24?o%24:o;return n.setUTCHours(s,0,0,0),n}}]),r}(Gr),Qte=function(e){Fr(r,e);var t=Nr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"priority",60),Mt(Et(i),"incompatibleTokens",["t","T"]),i}return Ir(r,[{key:"parse",value:function(n,a,o){switch(a){case"m":return Pi(Gi.minute,n);case"mo":return o.ordinalNumber(n,{unit:"minute"});default:return ji(a.length,n)}}},{key:"validate",value:function(n,a){return a>=0&&a<=59}},{key:"set",value:function(n,a,o){return n.setUTCMinutes(o,0,0),n}}]),r}(Gr),Zte=function(e){Fr(r,e);var t=Nr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"priority",50),Mt(Et(i),"incompatibleTokens",["t","T"]),i}return Ir(r,[{key:"parse",value:function(n,a,o){switch(a){case"s":return Pi(Gi.second,n);case"so":return o.ordinalNumber(n,{unit:"second"});default:return ji(a.length,n)}}},{key:"validate",value:function(n,a){return a>=0&&a<=59}},{key:"set",value:function(n,a,o){return n.setUTCSeconds(o,0),n}}]),r}(Gr),Jte=function(e){Fr(r,e);var t=Nr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"priority",30),Mt(Et(i),"incompatibleTokens",["t","T"]),i}return Ir(r,[{key:"parse",value:function(n,a){var o=function(l){return Math.floor(l*Math.pow(10,-a.length+3))};return $i(ji(a.length,n),o)}},{key:"set",value:function(n,a,o){return n.setUTCMilliseconds(o),n}}]),r}(Gr),ere=function(e){Fr(r,e);var t=Nr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"priority",10),Mt(Et(i),"incompatibleTokens",["t","T","x"]),i}return Ir(r,[{key:"parse",value:function(n,a){switch(a){case"X":return Ks(Xs.basicOptionalMinutes,n);case"XX":return Ks(Xs.basic,n);case"XXXX":return Ks(Xs.basicOptionalSeconds,n);case"XXXXX":return Ks(Xs.extendedOptionalSeconds,n);case"XXX":default:return Ks(Xs.extended,n)}}},{key:"set",value:function(n,a,o){return a.timestampIsSet?n:new Date(n.getTime()-o)}}]),r}(Gr),tre=function(e){Fr(r,e);var t=Nr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"priority",10),Mt(Et(i),"incompatibleTokens",["t","T","X"]),i}return Ir(r,[{key:"parse",value:function(n,a){switch(a){case"x":return Ks(Xs.basicOptionalMinutes,n);case"xx":return Ks(Xs.basic,n);case"xxxx":return Ks(Xs.basicOptionalSeconds,n);case"xxxxx":return Ks(Xs.extendedOptionalSeconds,n);case"xxx":default:return Ks(Xs.extended,n)}}},{key:"set",value:function(n,a,o){return a.timestampIsSet?n:new Date(n.getTime()-o)}}]),r}(Gr),rre=function(e){Fr(r,e);var t=Nr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"priority",40),Mt(Et(i),"incompatibleTokens","*"),i}return Ir(r,[{key:"parse",value:function(n){return jU(n)}},{key:"set",value:function(n,a,o){return[new Date(o*1e3),{timestampIsSet:!0}]}}]),r}(Gr),ire=function(e){Fr(r,e);var t=Nr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"priority",20),Mt(Et(i),"incompatibleTokens","*"),i}return Ir(r,[{key:"parse",value:function(n){return jU(n)}},{key:"set",value:function(n,a,o){return[new Date(o),{timestampIsSet:!0}]}}]),r}(Gr),nre={G:new Ste,y:new Cte,Y:new _te,R:new Ate,u:new Mte,Q:new Ete,q:new Tte,M:new Pte,L:new Dte,w:new Rte,I:new zte,d:new Bte,D:new Fte,E:new Nte,e:new Ute,c:new jte,i:new Hte,a:new Wte,b:new Gte,B:new $te,h:new qte,H:new Yte,K:new Xte,k:new Kte,m:new Qte,s:new Zte,S:new Jte,X:new ere,x:new tre,t:new rre,T:new ire},are=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,ore=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,sre=/^'([^]*?)'?$/,lre=/''/g,cre=/\S/,ure=/[a-zA-Z]/;function dre(e,t,r,i){var n,a,o,s,l,c,u,d,h,f,p,v,m,g,y,b,x,S;Ft(3,arguments);var w=String(e),_=String(t),C=Th(),A=(n=(a=i==null?void 0:i.locale)!==null&&a!==void 0?a:C.locale)!==null&&n!==void 0?n:KT;if(!A.match)throw new RangeError("locale must contain match property");var M=Yr((o=(s=(l=(c=i==null?void 0:i.firstWeekContainsDate)!==null&&c!==void 0?c:i==null||(u=i.locale)===null||u===void 0||(d=u.options)===null||d===void 0?void 0:d.firstWeekContainsDate)!==null&&l!==void 0?l:C.firstWeekContainsDate)!==null&&s!==void 0?s:(h=C.locale)===null||h===void 0||(f=h.options)===null||f===void 0?void 0:f.firstWeekContainsDate)!==null&&o!==void 0?o:1);if(!(M>=1&&M<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var P=Yr((p=(v=(m=(g=i==null?void 0:i.weekStartsOn)!==null&&g!==void 0?g:i==null||(y=i.locale)===null||y===void 0||(b=y.options)===null||b===void 0?void 0:b.weekStartsOn)!==null&&m!==void 0?m:C.weekStartsOn)!==null&&v!==void 0?v:(x=C.locale)===null||x===void 0||(S=x.options)===null||S===void 0?void 0:S.weekStartsOn)!==null&&p!==void 0?p:0);if(!(P>=0&&P<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(_==="")return w===""?ir(r):new Date(NaN);var T={firstWeekContainsDate:M,weekStartsOn:P,locale:A},R=[new wte],z=_.match(ore).map(function(ne){var V=ne[0];if(V in W2){var ue=W2[V];return ue(ne,A.formatLong)}return ne}).join("").match(are),F=[],H=cR(z),N;try{var U=function(){var V=N.value;!(i!=null&&i.useAdditionalWeekYearTokens)&&BU(V)&&bx(V,_,e),!(i!=null&&i.useAdditionalDayOfYearTokens)&&LU(V)&&bx(V,_,e);var ue=V[0],ve=nre[ue];if(ve){var Ce=ve.incompatibleTokens;if(Array.isArray(Ce)){var G=F.find(function(de){return Ce.includes(de.token)||de.token===ue});if(G)throw new RangeError("The format string mustn't contain `".concat(G.fullToken,"` and `").concat(V,"` at the same time"))}else if(ve.incompatibleTokens==="*"&&F.length>0)throw new RangeError("The format string mustn't contain `".concat(V,"` and any other token at the same time"));F.push({token:ue,fullToken:V});var Z=ve.run(w,V,A.match,T);if(!Z)return{v:new Date(NaN)};R.push(Z.setter),w=Z.rest}else{if(ue.match(ure))throw new RangeError("Format string contains an unescaped latin alphabet character `"+ue+"`");if(V==="''"?V="'":ue==="'"&&(V=hre(V)),w.indexOf(V)===0)w=w.slice(V.length);else return{v:new Date(NaN)}}};for(H.s();!(N=H.n()).done;){var ie=U();if(fl(ie)==="object")return ie.v}}catch(ne){H.e(ne)}finally{H.f()}if(w.length>0&&cre.test(w))return new Date(NaN);var te=R.map(function(ne){return ne.priority}).sort(function(ne,V){return V-ne}).filter(function(ne,V,ue){return ue.indexOf(ne)===V}).map(function(ne){return R.filter(function(V){return V.priority===ne}).sort(function(V,ue){return ue.subPriority-V.subPriority})}).map(function(ne){return ne[0]}),X=ir(r);if(isNaN(X.getTime()))return new Date(NaN);var W=OU(X,DU(X)),q={},$=cR(te),le;try{for($.s();!(le=$.n()).done;){var ee=le.value;if(!ee.validate(W,T))return new Date(NaN);var Q=ee.set(W,q,T);Array.isArray(Q)?(W=Q[0],dte(q,Q[1])):W=Q}}catch(ne){$.e(ne)}finally{$.f()}return W}function hre(e){return e.match(sre)[1].replace(lre,"'")}function fre(e){Ft(1,arguments);var t=ir(e);return t.setMinutes(0,0,0),t}function pre(e,t,r){Ft(2,arguments);var i=V2(e,r),n=V2(t,r);return i.getTime()===n.getTime()}function r0(e,t){Ft(2,arguments);var r=ir(e),i=ir(t);return r.getFullYear()===i.getFullYear()&&r.getMonth()===i.getMonth()}function WU(e,t){Ft(2,arguments);var r=gg(e),i=gg(t);return r.getTime()===i.getTime()}function tP(e){Ft(1,arguments);var t=ir(e);return t.setMilliseconds(0),t}function GU(e,t){Ft(2,arguments);var r=ir(e),i=ir(t);return r.getFullYear()===i.getFullYear()}function rP(e,t){Ft(2,arguments);var r=ir(e),i=Yr(t),n=r.getFullYear(),a=r.getDate(),o=new Date(0);o.setFullYear(n,i,15),o.setHours(0,0,0,0);var s=fte(o);return r.setMonth(i,Math.min(a,s)),r}function Qn(e,t){if(Ft(2,arguments),fl(t)!=="object"||t===null)throw new RangeError("values parameter must be an object");var r=ir(e);return isNaN(r.getTime())?new Date(NaN):(t.year!=null&&r.setFullYear(t.year),t.month!=null&&(r=rP(r,t.month)),t.date!=null&&r.setDate(Yr(t.date)),t.hours!=null&&r.setHours(Yr(t.hours)),t.minutes!=null&&r.setMinutes(Yr(t.minutes)),t.seconds!=null&&r.setSeconds(Yr(t.seconds)),t.milliseconds!=null&&r.setMilliseconds(Yr(t.milliseconds)),r)}function id(e,t){Ft(2,arguments);var r=ir(e),i=Yr(t);return r.setHours(i),r}function _S(e,t){Ft(2,arguments);var r=ir(e),i=Yr(t);return r.setMinutes(i),r}function mre(e,t){Ft(2,arguments);var r=ir(e),i=Yr(t),n=Math.floor(r.getMonth()/3)+1,a=i-n;return rP(r,r.getMonth()+a*3)}function AS(e,t){Ft(2,arguments);var r=ir(e),i=Yr(t);return r.setSeconds(i),r}function uR(e,t){Ft(2,arguments);var r=ir(e),i=Yr(t);return isNaN(r.getTime())?new Date(NaN):(r.setFullYear(i),r)}function wc(e){const{mergedLocaleRef:t,mergedDateLocaleRef:r}=_t(Eh,null)||{},i=re(()=>{var a,o;return(o=(a=t==null?void 0:t.value)===null||a===void 0?void 0:a[e])!==null&&o!==void 0?o:aee[e]});return{dateLocaleRef:re(()=>{var a;return(a=r==null?void 0:r.value)!==null&&a!==void 0?a:Nee}),localeRef:i}}function Ph(e,t,r){if(!t)return;const i=Xu(),n=_t(Eh,null),a=()=>{const o=r.value;t.mount({id:o===void 0?e:o+e,head:!0,anchorMetaName:vg,props:{bPrefix:o?`.${o}-`:void 0},ssr:i}),n!=null&&n.preflightStyleDisabled||PU.mount({id:"n-global",head:!0,anchorMetaName:vg,ssr:i})};i?a():Kg(a)}function Dr(e,t,r,i){var n;r||tw("useThemeClass","cssVarsRef is not passed");const a=(n=_t(Eh,null))===null||n===void 0?void 0:n.mergedThemeHashRef,o=me(""),s=Xu();let l;const c=`__${e}`,u=()=>{let d=c;const h=t?t.value:void 0,f=a==null?void 0:a.value;f&&(d+="-"+f),h&&(d+="-"+h);const{themeOverrides:p,builtinThemeOverrides:v}=i;p&&(d+="-"+P2(JSON.stringify(p))),v&&(d+="-"+P2(JSON.stringify(v))),o.value=d,l=()=>{const m=r.value;let g="";for(const y in m)g+=`${y}: ${m[y]};`;ge(`.${d}`,g).mount({id:d,ssr:s}),l=void 0}};return no(()=>{u()}),{themeClass:o,onRender:()=>{l==null||l()}}}function oo(e,t,r){if(!t)return;const i=Xu(),n=re(()=>{const{value:o}=t;if(!o)return;const s=o[e];if(s)return s}),a=()=>{no(()=>{const{value:o}=r,s=`${o}${e}Rtl`;if(oY(s,i))return;const{value:l}=n;l&&l.style.mount({id:s,head:!0,anchorMetaName:vg,props:{bPrefix:o?`.${o}-`:void 0},ssr:i})})};return i?a():Kg(a),n}const $2=je({name:"Add",render(){return E("svg",{width:"512",height:"512",viewBox:"0 0 512 512",fill:"none",xmlns:"http://www.w3.org/2000/svg"},E("path",{d:"M256 112V400M400 256H112",stroke:"currentColor","stroke-width":"32","stroke-linecap":"round","stroke-linejoin":"round"}))}}),vre=je({name:"ArrowDown",render(){return E("svg",{viewBox:"0 0 28 28",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},E("g",{stroke:"none","stroke-width":"1","fill-rule":"evenodd"},E("g",{"fill-rule":"nonzero"},E("path",{d:"M23.7916,15.2664 C24.0788,14.9679 24.0696,14.4931 23.7711,14.206 C23.4726,13.9188 22.9978,13.928 22.7106,14.2265 L14.7511,22.5007 L14.7511,3.74792 C14.7511,3.33371 14.4153,2.99792 14.0011,2.99792 C13.5869,2.99792 13.2511,3.33371 13.2511,3.74793 L13.2511,22.4998 L5.29259,14.2265 C5.00543,13.928 4.53064,13.9188 4.23213,14.206 C3.93361,14.4931 3.9244,14.9679 4.21157,15.2664 L13.2809,24.6944 C13.6743,25.1034 14.3289,25.1034 14.7223,24.6944 L23.7916,15.2664 Z"}))))}}),gre=je({name:"ArrowUp",render(){return E("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},E("g",{fill:"none"},E("path",{d:"M3.13 9.163a.5.5 0 1 0 .74.674L9.5 3.67V17.5a.5.5 0 0 0 1 0V3.672l5.63 6.165a.5.5 0 0 0 .738-.674l-6.315-6.916a.746.746 0 0 0-.632-.24a.746.746 0 0 0-.476.24L3.131 9.163z",fill:"currentColor"})))}});function Sc(e,t){return je({name:MZ(e),setup(){var r;const i=(r=_t(Eh,null))===null||r===void 0?void 0:r.mergedIconsRef;return()=>{var n;const a=(n=i==null?void 0:i.value)===null||n===void 0?void 0:n[e];return a?a():t}}})}const _p=je({name:"Backward",render(){return E("svg",{viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},E("path",{d:"M12.2674 15.793C11.9675 16.0787 11.4927 16.0672 11.2071 15.7673L6.20572 10.5168C5.9298 10.2271 5.9298 9.7719 6.20572 9.48223L11.2071 4.23177C11.4927 3.93184 11.9675 3.92031 12.2674 4.206C12.5673 4.49169 12.5789 4.96642 12.2932 5.26634L7.78458 9.99952L12.2932 14.7327C12.5789 15.0326 12.5673 15.5074 12.2674 15.793Z",fill:"currentColor"}))}}),dR=Sc("date",E("svg",{width:"28px",height:"28px",viewBox:"0 0 28 28",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},E("g",{stroke:"none","stroke-width":"1","fill-rule":"evenodd"},E("g",{"fill-rule":"nonzero"},E("path",{d:"M21.75,3 C23.5449254,3 25,4.45507456 25,6.25 L25,21.75 C25,23.5449254 23.5449254,25 21.75,25 L6.25,25 C4.45507456,25 3,23.5449254 3,21.75 L3,6.25 C3,4.45507456 4.45507456,3 6.25,3 L21.75,3 Z M23.5,9.503 L4.5,9.503 L4.5,21.75 C4.5,22.7164983 5.28350169,23.5 6.25,23.5 L21.75,23.5 C22.7164983,23.5 23.5,22.7164983 23.5,21.75 L23.5,9.503 Z M21.75,4.5 L6.25,4.5 C5.28350169,4.5 4.5,5.28350169 4.5,6.25 L4.5,8.003 L23.5,8.003 L23.5,6.25 C23.5,5.28350169 22.7164983,4.5 21.75,4.5 Z"}))))),yre=je({name:"Checkmark",render(){return E("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16"},E("g",{fill:"none"},E("path",{d:"M14.046 3.486a.75.75 0 0 1-.032 1.06l-7.93 7.474a.85.85 0 0 1-1.188-.022l-2.68-2.72a.75.75 0 1 1 1.068-1.053l2.234 2.267l7.468-7.038a.75.75 0 0 1 1.06.032z",fill:"currentColor"})))}}),$U=je({name:"ChevronRight",render(){return E("svg",{viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},E("path",{d:"M5.64645 3.14645C5.45118 3.34171 5.45118 3.65829 5.64645 3.85355L9.79289 8L5.64645 12.1464C5.45118 12.3417 5.45118 12.6583 5.64645 12.8536C5.84171 13.0488 6.15829 13.0488 6.35355 12.8536L10.8536 8.35355C11.0488 8.15829 11.0488 7.84171 10.8536 7.64645L6.35355 3.14645C6.15829 2.95118 5.84171 2.95118 5.64645 3.14645Z",fill:"currentColor"}))}}),bre=Sc("close",E("svg",{viewBox:"0 0 12 12",version:"1.1",xmlns:"http://www.w3.org/2000/svg","aria-hidden":!0},E("g",{stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},E("g",{fill:"currentColor","fill-rule":"nonzero"},E("path",{d:"M2.08859116,2.2156945 L2.14644661,2.14644661 C2.32001296,1.97288026 2.58943736,1.95359511 2.7843055,2.08859116 L2.85355339,2.14644661 L6,5.293 L9.14644661,2.14644661 C9.34170876,1.95118446 9.65829124,1.95118446 9.85355339,2.14644661 C10.0488155,2.34170876 10.0488155,2.65829124 9.85355339,2.85355339 L6.707,6 L9.85355339,9.14644661 C10.0271197,9.32001296 10.0464049,9.58943736 9.91140884,9.7843055 L9.85355339,9.85355339 C9.67998704,10.0271197 9.41056264,10.0464049 9.2156945,9.91140884 L9.14644661,9.85355339 L6,6.707 L2.85355339,9.85355339 C2.65829124,10.0488155 2.34170876,10.0488155 2.14644661,9.85355339 C1.95118446,9.65829124 1.95118446,9.34170876 2.14644661,9.14644661 L5.293,6 L2.14644661,2.85355339 C1.97288026,2.67998704 1.95359511,2.41056264 2.08859116,2.2156945 L2.14644661,2.14644661 L2.08859116,2.2156945 Z"}))))),xre=je({name:"Eye",render(){return E("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},E("path",{d:"M255.66 112c-77.94 0-157.89 45.11-220.83 135.33a16 16 0 0 0-.27 17.77C82.92 340.8 161.8 400 255.66 400c92.84 0 173.34-59.38 221.79-135.25a16.14 16.14 0 0 0 0-17.47C428.89 172.28 347.8 112 255.66 112z",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"}),E("circle",{cx:"256",cy:"256",r:"80",fill:"none",stroke:"currentColor","stroke-miterlimit":"10","stroke-width":"32"}))}}),wre=je({name:"EyeOff",render(){return E("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},E("path",{d:"M432 448a15.92 15.92 0 0 1-11.31-4.69l-352-352a16 16 0 0 1 22.62-22.62l352 352A16 16 0 0 1 432 448z",fill:"currentColor"}),E("path",{d:"M255.66 384c-41.49 0-81.5-12.28-118.92-36.5c-34.07-22-64.74-53.51-88.7-91v-.08c19.94-28.57 41.78-52.73 65.24-72.21a2 2 0 0 0 .14-2.94L93.5 161.38a2 2 0 0 0-2.71-.12c-24.92 21-48.05 46.76-69.08 76.92a31.92 31.92 0 0 0-.64 35.54c26.41 41.33 60.4 76.14 98.28 100.65C162 402 207.9 416 255.66 416a239.13 239.13 0 0 0 75.8-12.58a2 2 0 0 0 .77-3.31l-21.58-21.58a4 4 0 0 0-3.83-1a204.8 204.8 0 0 1-51.16 6.47z",fill:"currentColor"}),E("path",{d:"M490.84 238.6c-26.46-40.92-60.79-75.68-99.27-100.53C349 110.55 302 96 255.66 96a227.34 227.34 0 0 0-74.89 12.83a2 2 0 0 0-.75 3.31l21.55 21.55a4 4 0 0 0 3.88 1a192.82 192.82 0 0 1 50.21-6.69c40.69 0 80.58 12.43 118.55 37c34.71 22.4 65.74 53.88 89.76 91a.13.13 0 0 1 0 .16a310.72 310.72 0 0 1-64.12 72.73a2 2 0 0 0-.15 2.95l19.9 19.89a2 2 0 0 0 2.7.13a343.49 343.49 0 0 0 68.64-78.48a32.2 32.2 0 0 0-.1-34.78z",fill:"currentColor"}),E("path",{d:"M256 160a95.88 95.88 0 0 0-21.37 2.4a2 2 0 0 0-1 3.38l112.59 112.56a2 2 0 0 0 3.38-1A96 96 0 0 0 256 160z",fill:"currentColor"}),E("path",{d:"M165.78 233.66a2 2 0 0 0-3.38 1a96 96 0 0 0 115 115a2 2 0 0 0 1-3.38z",fill:"currentColor"}))}}),Sre=je({name:"Empty",render(){return E("svg",{viewBox:"0 0 28 28",fill:"none",xmlns:"http://www.w3.org/2000/svg"},E("path",{d:"M26 7.5C26 11.0899 23.0899 14 19.5 14C15.9101 14 13 11.0899 13 7.5C13 3.91015 15.9101 1 19.5 1C23.0899 1 26 3.91015 26 7.5ZM16.8536 4.14645C16.6583 3.95118 16.3417 3.95118 16.1464 4.14645C15.9512 4.34171 15.9512 4.65829 16.1464 4.85355L18.7929 7.5L16.1464 10.1464C15.9512 10.3417 15.9512 10.6583 16.1464 10.8536C16.3417 11.0488 16.6583 11.0488 16.8536 10.8536L19.5 8.20711L22.1464 10.8536C22.3417 11.0488 22.6583 11.0488 22.8536 10.8536C23.0488 10.6583 23.0488 10.3417 22.8536 10.1464L20.2071 7.5L22.8536 4.85355C23.0488 4.65829 23.0488 4.34171 22.8536 4.14645C22.6583 3.95118 22.3417 3.95118 22.1464 4.14645L19.5 6.79289L16.8536 4.14645Z",fill:"currentColor"}),E("path",{d:"M25 22.75V12.5991C24.5572 13.0765 24.053 13.4961 23.5 13.8454V16H17.5L17.3982 16.0068C17.0322 16.0565 16.75 16.3703 16.75 16.75C16.75 18.2688 15.5188 19.5 14 19.5C12.4812 19.5 11.25 18.2688 11.25 16.75L11.2432 16.6482C11.1935 16.2822 10.8797 16 10.5 16H4.5V7.25C4.5 6.2835 5.2835 5.5 6.25 5.5H12.2696C12.4146 4.97463 12.6153 4.47237 12.865 4H6.25C4.45507 4 3 5.45507 3 7.25V22.75C3 24.5449 4.45507 26 6.25 26H21.75C23.5449 26 25 24.5449 25 22.75ZM4.5 22.75V17.5H9.81597L9.85751 17.7041C10.2905 19.5919 11.9808 21 14 21L14.215 20.9947C16.2095 20.8953 17.842 19.4209 18.184 17.5H23.5V22.75C23.5 23.7165 22.7165 24.5 21.75 24.5H6.25C5.2835 24.5 4.5 23.7165 4.5 22.75Z",fill:"currentColor"}))}}),Cre=Sc("error",E("svg",{viewBox:"0 0 48 48",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},E("g",{stroke:"none","stroke-width":"1","fill-rule":"evenodd"},E("g",{"fill-rule":"nonzero"},E("path",{d:"M24,4 C35.045695,4 44,12.954305 44,24 C44,35.045695 35.045695,44 24,44 C12.954305,44 4,35.045695 4,24 C4,12.954305 12.954305,4 24,4 Z M17.8838835,16.1161165 L17.7823881,16.0249942 C17.3266086,15.6583353 16.6733914,15.6583353 16.2176119,16.0249942 L16.1161165,16.1161165 L16.0249942,16.2176119 C15.6583353,16.6733914 15.6583353,17.3266086 16.0249942,17.7823881 L16.1161165,17.8838835 L22.233,24 L16.1161165,30.1161165 L16.0249942,30.2176119 C15.6583353,30.6733914 15.6583353,31.3266086 16.0249942,31.7823881 L16.1161165,31.8838835 L16.2176119,31.9750058 C16.6733914,32.3416647 17.3266086,32.3416647 17.7823881,31.9750058 L17.8838835,31.8838835 L24,25.767 L30.1161165,31.8838835 L30.2176119,31.9750058 C30.6733914,32.3416647 31.3266086,32.3416647 31.7823881,31.9750058 L31.8838835,31.8838835 L31.9750058,31.7823881 C32.3416647,31.3266086 32.3416647,30.6733914 31.9750058,30.2176119 L31.8838835,30.1161165 L25.767,24 L31.8838835,17.8838835 L31.9750058,17.7823881 C32.3416647,17.3266086 32.3416647,16.6733914 31.9750058,16.2176119 L31.8838835,16.1161165 L31.7823881,16.0249942 C31.3266086,15.6583353 30.6733914,15.6583353 30.2176119,16.0249942 L30.1161165,16.1161165 L24,22.233 L17.8838835,16.1161165 L17.7823881,16.0249942 L17.8838835,16.1161165 Z"}))))),Ap=je({name:"FastBackward",render(){return E("svg",{viewBox:"0 0 20 20",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},E("g",{stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},E("g",{fill:"currentColor","fill-rule":"nonzero"},E("path",{d:"M8.73171,16.7949 C9.03264,17.0795 9.50733,17.0663 9.79196,16.7654 C10.0766,16.4644 10.0634,15.9897 9.76243,15.7051 L4.52339,10.75 L17.2471,10.75 C17.6613,10.75 17.9971,10.4142 17.9971,10 C17.9971,9.58579 17.6613,9.25 17.2471,9.25 L4.52112,9.25 L9.76243,4.29275 C10.0634,4.00812 10.0766,3.53343 9.79196,3.2325 C9.50733,2.93156 9.03264,2.91834 8.73171,3.20297 L2.31449,9.27241 C2.14819,9.4297 2.04819,9.62981 2.01448,9.8386 C2.00308,9.89058 1.99707,9.94459 1.99707,10 C1.99707,10.0576 2.00356,10.1137 2.01585,10.1675 C2.05084,10.3733 2.15039,10.5702 2.31449,10.7254 L8.73171,16.7949 Z"}))))}}),Mp=je({name:"FastForward",render(){return E("svg",{viewBox:"0 0 20 20",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},E("g",{stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},E("g",{fill:"currentColor","fill-rule":"nonzero"},E("path",{d:"M11.2654,3.20511 C10.9644,2.92049 10.4897,2.93371 10.2051,3.23464 C9.92049,3.53558 9.93371,4.01027 10.2346,4.29489 L15.4737,9.25 L2.75,9.25 C2.33579,9.25 2,9.58579 2,10.0000012 C2,10.4142 2.33579,10.75 2.75,10.75 L15.476,10.75 L10.2346,15.7073 C9.93371,15.9919 9.92049,16.4666 10.2051,16.7675 C10.4897,17.0684 10.9644,17.0817 11.2654,16.797 L17.6826,10.7276 C17.8489,10.5703 17.9489,10.3702 17.9826,10.1614 C17.994,10.1094 18,10.0554 18,10.0000012 C18,9.94241 17.9935,9.88633 17.9812,9.83246 C17.9462,9.62667 17.8467,9.42976 17.6826,9.27455 L11.2654,3.20511 Z"}))))}}),Ep=je({name:"Forward",render(){return E("svg",{viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},E("path",{d:"M7.73271 4.20694C8.03263 3.92125 8.50737 3.93279 8.79306 4.23271L13.7944 9.48318C14.0703 9.77285 14.0703 10.2281 13.7944 10.5178L8.79306 15.7682C8.50737 16.0681 8.03263 16.0797 7.73271 15.794C7.43279 15.5083 7.42125 15.0336 7.70694 14.7336L12.2155 10.0005L7.70694 5.26729C7.42125 4.96737 7.43279 4.49264 7.73271 4.20694Z",fill:"currentColor"}))}}),_re=Sc("info",E("svg",{viewBox:"0 0 28 28",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},E("g",{stroke:"none","stroke-width":"1","fill-rule":"evenodd"},E("g",{"fill-rule":"nonzero"},E("path",{d:"M14,2 C20.6274,2 26,7.37258 26,14 C26,20.6274 20.6274,26 14,26 C7.37258,26 2,20.6274 2,14 C2,7.37258 7.37258,2 14,2 Z M14,11 C13.4477,11 13,11.4477 13,12 L13,12 L13,20 C13,20.5523 13.4477,21 14,21 C14.5523,21 15,20.5523 15,20 L15,20 L15,12 C15,11.4477 14.5523,11 14,11 Z M14,6.75 C13.3096,6.75 12.75,7.30964 12.75,8 C12.75,8.69036 13.3096,9.25 14,9.25 C14.6904,9.25 15.25,8.69036 15.25,8 C15.25,7.30964 14.6904,6.75 14,6.75 Z"}))))),Are=je({name:"Remove",render(){return E("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},E("line",{x1:"400",y1:"256",x2:"112",y2:"256",style:`
        fill: none;
        stroke: currentColor;
        stroke-linecap: round;
        stroke-linejoin: round;
        stroke-width: 32px;
      `}))}}),Mre=je({name:"Search",render(){return E("svg",{version:"1.1",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",style:"enable-background: new 0 0 512 512"},E("path",{d:`M443.5,420.2L336.7,312.4c20.9-26.2,33.5-59.4,33.5-95.5c0-84.5-68.5-153-153.1-153S64,132.5,64,217s68.5,153,153.1,153
  c36.6,0,70.1-12.8,96.5-34.2l106.1,107.1c3.2,3.4,7.6,5.1,11.9,5.1c4.1,0,8.2-1.5,11.3-4.5C449.5,437.2,449.7,426.8,443.5,420.2z
   M217.1,337.1c-32.1,0-62.3-12.5-85-35.2c-22.7-22.7-35.2-52.9-35.2-84.9c0-32.1,12.5-62.3,35.2-84.9c22.7-22.7,52.9-35.2,85-35.2
  c32.1,0,62.3,12.5,85,35.2c22.7,22.7,35.2,52.9,35.2,84.9c0,32.1-12.5,62.3-35.2,84.9C279.4,324.6,249.2,337.1,217.1,337.1z`}))}}),Ere=Sc("success",E("svg",{viewBox:"0 0 48 48",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},E("g",{stroke:"none","stroke-width":"1","fill-rule":"evenodd"},E("g",{"fill-rule":"nonzero"},E("path",{d:"M24,4 C35.045695,4 44,12.954305 44,24 C44,35.045695 35.045695,44 24,44 C12.954305,44 4,35.045695 4,24 C4,12.954305 12.954305,4 24,4 Z M32.6338835,17.6161165 C32.1782718,17.1605048 31.4584514,17.1301307 30.9676119,17.5249942 L30.8661165,17.6161165 L20.75,27.732233 L17.1338835,24.1161165 C16.6457281,23.6279612 15.8542719,23.6279612 15.3661165,24.1161165 C14.9105048,24.5717282 14.8801307,25.2915486 15.2749942,25.7823881 L15.3661165,25.8838835 L19.8661165,30.3838835 C20.3217282,30.8394952 21.0415486,30.8698693 21.5323881,30.4750058 L21.6338835,30.3838835 L32.6338835,19.3838835 C33.1220388,18.8957281 33.1220388,18.1042719 32.6338835,17.6161165 Z"}))))),Tre=Sc("time",E("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},E("path",{d:"M256,64C150,64,64,150,64,256s86,192,192,192,192-86,192-192S362,64,256,64Z",style:`
        fill: none;
        stroke: currentColor;
        stroke-miterlimit: 10;
        stroke-width: 32px;
      `}),E("polyline",{points:"256 128 256 272 352 272",style:`
        fill: none;
        stroke: currentColor;
        stroke-linecap: round;
        stroke-linejoin: round;
        stroke-width: 32px;
      `}))),Pre=Sc("warning",E("svg",{viewBox:"0 0 24 24",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},E("g",{stroke:"none","stroke-width":"1","fill-rule":"evenodd"},E("g",{"fill-rule":"nonzero"},E("path",{d:"M12,2 C17.523,2 22,6.478 22,12 C22,17.522 17.523,22 12,22 C6.477,22 2,17.522 2,12 C2,6.478 6.477,2 12,2 Z M12.0018002,15.0037242 C11.450254,15.0037242 11.0031376,15.4508407 11.0031376,16.0023869 C11.0031376,16.553933 11.450254,17.0010495 12.0018002,17.0010495 C12.5533463,17.0010495 13.0004628,16.553933 13.0004628,16.0023869 C13.0004628,15.4508407 12.5533463,15.0037242 12.0018002,15.0037242 Z M11.99964,7 C11.4868042,7.00018474 11.0642719,7.38637706 11.0066858,7.8837365 L11,8.00036004 L11.0018003,13.0012393 L11.00857,13.117858 C11.0665141,13.6151758 11.4893244,14.0010638 12.0021602,14.0008793 C12.514996,14.0006946 12.9375283,13.6145023 12.9951144,13.1171428 L13.0018002,13.0005193 L13,7.99964009 L12.9932303,7.8830214 C12.9352861,7.38570354 12.5124758,6.99981552 11.99964,7 Z"}))))),Dre=je({name:"ChevronDown",render(){return E("svg",{viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},E("path",{d:"M3.14645 5.64645C3.34171 5.45118 3.65829 5.45118 3.85355 5.64645L8 9.79289L12.1464 5.64645C12.3417 5.45118 12.6583 5.45118 12.8536 5.64645C13.0488 5.84171 13.0488 6.15829 12.8536 6.35355L8.35355 10.8536C8.15829 11.0488 7.84171 11.0488 7.64645 10.8536L3.14645 6.35355C2.95118 6.15829 2.95118 5.84171 3.14645 5.64645Z",fill:"currentColor"}))}}),Ore=Sc("clear",E("svg",{viewBox:"0 0 16 16",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},E("g",{stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},E("g",{fill:"currentColor","fill-rule":"nonzero"},E("path",{d:"M8,2 C11.3137085,2 14,4.6862915 14,8 C14,11.3137085 11.3137085,14 8,14 C4.6862915,14 2,11.3137085 2,8 C2,4.6862915 4.6862915,2 8,2 Z M6.5343055,5.83859116 C6.33943736,5.70359511 6.07001296,5.72288026 5.89644661,5.89644661 L5.89644661,5.89644661 L5.83859116,5.9656945 C5.70359511,6.16056264 5.72288026,6.42998704 5.89644661,6.60355339 L5.89644661,6.60355339 L7.293,8 L5.89644661,9.39644661 L5.83859116,9.4656945 C5.70359511,9.66056264 5.72288026,9.92998704 5.89644661,10.1035534 L5.89644661,10.1035534 L5.9656945,10.1614088 C6.16056264,10.2964049 6.42998704,10.2771197 6.60355339,10.1035534 L6.60355339,10.1035534 L8,8.707 L9.39644661,10.1035534 L9.4656945,10.1614088 C9.66056264,10.2964049 9.92998704,10.2771197 10.1035534,10.1035534 L10.1035534,10.1035534 L10.1614088,10.0343055 C10.2964049,9.83943736 10.2771197,9.57001296 10.1035534,9.39644661 L10.1035534,9.39644661 L8.707,8 L10.1035534,6.60355339 L10.1614088,6.5343055 C10.2964049,6.33943736 10.2771197,6.07001296 10.1035534,5.89644661 L10.1035534,5.89644661 L10.0343055,5.83859116 C9.83943736,5.70359511 9.57001296,5.72288026 9.39644661,5.89644661 L9.39644661,5.89644661 L8,7.293 L6.60355339,5.89644661 Z"}))))),Rre=je({name:"ChevronDownFilled",render(){return E("svg",{viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},E("path",{d:"M3.20041 5.73966C3.48226 5.43613 3.95681 5.41856 4.26034 5.70041L8 9.22652L11.7397 5.70041C12.0432 5.41856 12.5177 5.43613 12.7996 5.73966C13.0815 6.0432 13.0639 6.51775 12.7603 6.7996L8.51034 10.7996C8.22258 11.0668 7.77743 11.0668 7.48967 10.7996L3.23966 6.7996C2.93613 6.51775 2.91856 6.0432 3.20041 5.73966Z",fill:"currentColor"}))}}),Ire=Sc("to",E("svg",{viewBox:"0 0 20 20",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},E("g",{stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},E("g",{fill:"currentColor","fill-rule":"nonzero"},E("path",{d:"M11.2654,3.20511 C10.9644,2.92049 10.4897,2.93371 10.2051,3.23464 C9.92049,3.53558 9.93371,4.01027 10.2346,4.29489 L15.4737,9.25 L2.75,9.25 C2.33579,9.25 2,9.58579 2,10.0000012 C2,10.4142 2.33579,10.75 2.75,10.75 L15.476,10.75 L10.2346,15.7073 C9.93371,15.9919 9.92049,16.4666 10.2051,16.7675 C10.4897,17.0684 10.9644,17.0817 11.2654,16.797 L17.6826,10.7276 C17.8489,10.5703 17.9489,10.3702 17.9826,10.1614 C17.994,10.1094 18,10.0554 18,10.0000012 C18,9.94241 17.9935,9.88633 17.9812,9.83246 C17.9462,9.62667 17.8467,9.42976 17.6826,9.27455 L11.2654,3.20511 Z"}))))),zre=je({name:"ArrowBack",render(){return E("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},E("path",{d:"M0 0h24v24H0V0z",fill:"none"}),E("path",{d:"M19 11H7.83l4.88-4.88c.39-.39.39-1.03 0-1.42-.39-.39-1.02-.39-1.41 0l-6.59 6.59c-.39.39-.39 1.02 0 1.41l6.59 6.59c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41L7.83 13H19c.55 0 1-.45 1-1s-.45-1-1-1z"}))}}),Jp=je({name:"BaseIconSwitchTransition",setup(e,{slots:t}){const r=Yu();return()=>E(La,{name:"icon-switch-transition",appear:r.value},t)}}),iP=je({name:"FadeInExpandTransition",props:{appear:Boolean,group:Boolean,mode:String,onLeave:Function,onAfterLeave:Function,onAfterEnter:Function,width:Boolean,reverse:Boolean},setup(e,{slots:t}){function r(s){e.width?s.style.maxWidth=`${s.offsetWidth}px`:s.style.maxHeight=`${s.offsetHeight}px`,s.offsetWidth}function i(s){e.width?s.style.maxWidth="0":s.style.maxHeight="0",s.offsetWidth;const{onLeave:l}=e;l&&l()}function n(s){e.width?s.style.maxWidth="":s.style.maxHeight="";const{onAfterLeave:l}=e;l&&l()}function a(s){if(s.style.transition="none",e.width){const l=s.offsetWidth;s.style.maxWidth="0",s.offsetWidth,s.style.transition="",s.style.maxWidth=`${l}px`}else if(e.reverse)s.style.maxHeight=`${s.offsetHeight}px`,s.offsetHeight,s.style.transition="",s.style.maxHeight="0";else{const l=s.offsetHeight;s.style.maxHeight="0",s.offsetWidth,s.style.transition="",s.style.maxHeight=`${l}px`}s.offsetWidth}function o(s){var l;e.width?s.style.maxWidth="":e.reverse||(s.style.maxHeight=""),(l=e.onAfterEnter)===null||l===void 0||l.call(e)}return()=>{const{group:s,width:l,appear:c,mode:u}=e,d=s?CN:La,h={name:l?"fade-in-width-expand-transition":"fade-in-height-expand-transition",appear:c,onEnter:a,onAfterEnter:o,onBeforeLeave:r,onLeave:i,onAfterLeave:n};return s||(h.mode=u),E(d,h,t)}}}),kre=oe("base-icon",`
 height: 1em;
 width: 1em;
 line-height: 1em;
 text-align: center;
 display: inline-block;
 position: relative;
 fill: currentColor;
 transform: translateZ(0);
`,[ge("svg",`
 height: 1em;
 width: 1em;
 `)]),Bi=je({name:"BaseIcon",props:{role:String,ariaLabel:String,ariaDisabled:{type:Boolean,default:void 0},ariaHidden:{type:Boolean,default:void 0},clsPrefix:{type:String,required:!0},onClick:Function,onMousedown:Function,onMouseup:Function},setup(e){Ph("-base-icon",kre,pt(e,"clsPrefix"))},render(){return E("i",{class:`${this.clsPrefix}-base-icon`,onClick:this.onClick,onMousedown:this.onMousedown,onMouseup:this.onMouseup,role:this.role,"aria-label":this.ariaLabel,"aria-hidden":this.ariaHidden,"aria-disabled":this.ariaDisabled},this.$slots)}}),Lre=oe("base-close",`
 display: flex;
 align-items: center;
 justify-content: center;
 cursor: pointer;
 background-color: transparent;
 color: var(--n-close-icon-color);
 border-radius: var(--n-close-border-radius);
 height: var(--n-close-size);
 width: var(--n-close-size);
 font-size: var(--n-close-icon-size);
 outline: none;
 border: none;
 position: relative;
 padding: 0;
`,[xe("absolute",`
 height: var(--n-close-icon-size);
 width: var(--n-close-icon-size);
 `),ge("&::before",`
 content: "";
 position: absolute;
 width: var(--n-close-size);
 height: var(--n-close-size);
 left: 50%;
 top: 50%;
 transform: translateY(-50%) translateX(-50%);
 transition: inherit;
 border-radius: inherit;
 `),br("disabled",[ge("&:hover",`
 color: var(--n-close-icon-color-hover);
 `),ge("&:hover::before",`
 background-color: var(--n-close-color-hover);
 `),ge("&:focus::before",`
 background-color: var(--n-close-color-hover);
 `),ge("&:active",`
 color: var(--n-close-icon-color-pressed);
 `),ge("&:active::before",`
 background-color: var(--n-close-color-pressed);
 `)]),xe("disabled",`
 cursor: not-allowed;
 color: var(--n-close-icon-color-disabled);
 background-color: transparent;
 `),xe("round",[ge("&::before",`
 border-radius: 50%;
 `)])]),cw=je({name:"BaseClose",props:{isButtonTag:{type:Boolean,default:!0},clsPrefix:{type:String,required:!0},disabled:{type:Boolean,default:void 0},focusable:{type:Boolean,default:!0},round:Boolean,onClick:Function,absolute:Boolean},setup(e){return Ph("-base-close",Lre,pt(e,"clsPrefix")),()=>{const{clsPrefix:t,disabled:r,absolute:i,round:n,isButtonTag:a}=e;return E(a?"button":"div",{type:a?"button":void 0,tabindex:r||!e.focusable?-1:0,"aria-disabled":r,"aria-label":"close",role:a?void 0:"button",disabled:r,class:[`${t}-base-close`,i&&`${t}-base-close--absolute`,r&&`${t}-base-close--disabled`,n&&`${t}-base-close--round`],onMousedown:s=>{e.focusable||s.preventDefault()},onClick:e.onClick},E(Bi,{clsPrefix:t},{default:()=>E(bre,null)}))}}}),Qu=je({props:{onFocus:Function,onBlur:Function},setup(e){return()=>E("div",{style:"width: 0; height: 0",tabindex:0,onFocus:e.onFocus,onBlur:e.onBlur})}}),{cubicBezierEaseInOut:Bre}=Ku;function ku({originalTransform:e="",left:t=0,top:r=0,transition:i=`all .3s ${Bre} !important`}={}){return[ge("&.icon-switch-transition-enter-from, &.icon-switch-transition-leave-to",{transform:e+" scale(0.75)",left:t,top:r,opacity:0}),ge("&.icon-switch-transition-enter-to, &.icon-switch-transition-leave-from",{transform:`scale(1) ${e}`,left:t,top:r,opacity:1}),ge("&.icon-switch-transition-enter-active, &.icon-switch-transition-leave-active",{transformOrigin:"center",position:"absolute",left:t,top:r,transition:i})]}const Fre=ge([ge("@keyframes rotator",`
 0% {
 -webkit-transform: rotate(0deg);
 transform: rotate(0deg);
 }
 100% {
 -webkit-transform: rotate(360deg);
 transform: rotate(360deg);
 }`),oe("base-loading",`
 position: relative;
 line-height: 0;
 width: 1em;
 height: 1em;
 `,[he("transition-wrapper",`
 position: absolute;
 width: 100%;
 height: 100%;
 `,[ku()]),he("placeholder",`
 position: absolute;
 left: 50%;
 top: 50%;
 transform: translateX(-50%) translateY(-50%);
 `,[ku({left:"50%",top:"50%",originalTransform:"translateX(-50%) translateY(-50%)"})]),he("container",`
 animation: rotator 3s linear infinite both;
 `,[he("icon",`
 height: 1em;
 width: 1em;
 `)])])]),MS="1.6s",Nre={strokeWidth:{type:Number,default:28},stroke:{type:String,default:void 0}},i0=je({name:"BaseLoading",props:Object.assign({clsPrefix:{type:String,required:!0},show:{type:Boolean,default:!0},scale:{type:Number,default:1},radius:{type:Number,default:100}},Nre),setup(e){Ph("-base-loading",Fre,pt(e,"clsPrefix"))},render(){const{clsPrefix:e,radius:t,strokeWidth:r,stroke:i,scale:n}=this,a=t/n;return E("div",{class:`${e}-base-loading`,role:"img","aria-label":"loading"},E(Jp,null,{default:()=>this.show?E("div",{key:"icon",class:`${e}-base-loading__transition-wrapper`},E("div",{class:`${e}-base-loading__container`},E("svg",{class:`${e}-base-loading__icon`,viewBox:`0 0 ${2*a} ${2*a}`,xmlns:"http://www.w3.org/2000/svg",style:{color:i}},E("g",null,E("animateTransform",{attributeName:"transform",type:"rotate",values:`0 ${a} ${a};270 ${a} ${a}`,begin:"0s",dur:MS,fill:"freeze",repeatCount:"indefinite"}),E("circle",{class:`${e}-base-loading__icon`,fill:"none",stroke:"currentColor","stroke-width":r,"stroke-linecap":"round",cx:a,cy:a,r:t-r/2,"stroke-dasharray":5.67*t,"stroke-dashoffset":18.48*t},E("animateTransform",{attributeName:"transform",type:"rotate",values:`0 ${a} ${a};135 ${a} ${a};450 ${a} ${a}`,begin:"0s",dur:MS,fill:"freeze",repeatCount:"indefinite"}),E("animate",{attributeName:"stroke-dashoffset",values:`${5.67*t};${1.42*t};${5.67*t}`,begin:"0s",dur:MS,fill:"freeze",repeatCount:"indefinite"})))))):E("div",{key:"placeholder",class:`${e}-base-loading__placeholder`},this.$slots)}))}});function hR(e){return Array.isArray(e)?e:[e]}const q2={STOP:"STOP"};function qU(e,t){const r=t(e);e.children!==void 0&&r!==q2.STOP&&e.children.forEach(i=>qU(i,t))}function Ure(e,t={}){const{preserveGroup:r=!1}=t,i=[],n=r?o=>{o.isLeaf||(i.push(o.key),a(o.children))}:o=>{o.isLeaf||(o.isGroup||i.push(o.key),a(o.children))};function a(o){o.forEach(n)}return a(e),i}function jre(e,t){const{isLeaf:r}=e;return r!==void 0?r:!t(e)}function Vre(e){return e.children}function Hre(e){return e.key}function Wre(){return!1}function Gre(e,t){const{isLeaf:r}=e;return!(r===!1&&!Array.isArray(t(e)))}function $re(e){return e.disabled===!0}function qre(e,t){return e.isLeaf===!1&&!Array.isArray(t(e))}function ES(e){var t;return e==null?[]:Array.isArray(e)?e:(t=e.checkedKeys)!==null&&t!==void 0?t:[]}function TS(e){var t;return e==null||Array.isArray(e)?[]:(t=e.indeterminateKeys)!==null&&t!==void 0?t:[]}function Yre(e,t){const r=new Set(e);return t.forEach(i=>{r.has(i)||r.add(i)}),Array.from(r)}function Xre(e,t){const r=new Set(e);return t.forEach(i=>{r.has(i)&&r.delete(i)}),Array.from(r)}function Kre(e){return(e==null?void 0:e.type)==="group"}function Qre(e){const t=new Map;return e.forEach((r,i)=>{t.set(r.key,i)}),r=>{var i;return(i=t.get(r))!==null&&i!==void 0?i:null}}class Zre extends Error{constructor(){super(),this.message="SubtreeNotLoadedError: checking a subtree whose required nodes are not fully loaded."}}function Jre(e,t,r,i){return _x(t.concat(e),r,i,!1)}function eie(e,t){const r=new Set;return e.forEach(i=>{const n=t.treeNodeMap.get(i);if(n!==void 0){let a=n.parent;for(;a!==null&&!(a.disabled||r.has(a.key));)r.add(a.key),a=a.parent}}),r}function tie(e,t,r,i){const n=_x(t,r,i,!1),a=_x(e,r,i,!0),o=eie(e,r),s=[];return n.forEach(l=>{(a.has(l)||o.has(l))&&s.push(l)}),s.forEach(l=>n.delete(l)),n}function PS(e,t){const{checkedKeys:r,keysToCheck:i,keysToUncheck:n,indeterminateKeys:a,cascade:o,leafOnly:s,checkStrategy:l,allowNotLoaded:c}=e;if(!o)return i!==void 0?{checkedKeys:Yre(r,i),indeterminateKeys:Array.from(a)}:n!==void 0?{checkedKeys:Xre(r,n),indeterminateKeys:Array.from(a)}:{checkedKeys:Array.from(r),indeterminateKeys:Array.from(a)};const{levelTreeNodeMap:u}=t;let d;n!==void 0?d=tie(n,r,t,c):i!==void 0?d=Jre(i,r,t,c):d=_x(r,t,c,!1);const h=l==="parent",f=l==="child"||s,p=d,v=new Set,m=Math.max.apply(null,Array.from(u.keys()));for(let g=m;g>=0;g-=1){const y=g===0,b=u.get(g);for(const x of b){if(x.isLeaf)continue;const{key:S,shallowLoaded:w}=x;if(f&&w&&x.children.forEach(M=>{!M.disabled&&!M.isLeaf&&M.shallowLoaded&&p.has(M.key)&&p.delete(M.key)}),x.disabled||!w)continue;let _=!0,C=!1,A=!0;for(const M of x.children){const P=M.key;if(!M.disabled){if(A&&(A=!1),p.has(P))C=!0;else if(v.has(P)){C=!0,_=!1;break}else if(_=!1,C)break}}_&&!A?(h&&x.children.forEach(M=>{!M.disabled&&p.has(M.key)&&p.delete(M.key)}),p.add(S)):C&&v.add(S),y&&f&&p.has(S)&&p.delete(S)}}return{checkedKeys:Array.from(p),indeterminateKeys:Array.from(v)}}function _x(e,t,r,i){const{treeNodeMap:n,getChildren:a}=t,o=new Set,s=new Set(e);return e.forEach(l=>{const c=n.get(l);c!==void 0&&qU(c,u=>{if(u.disabled)return q2.STOP;const{key:d}=u;if(!o.has(d)&&(o.add(d),s.add(d),qre(u.rawNode,a))){if(i)return q2.STOP;if(!r)throw new Zre}})}),s}function rie(e,{includeGroup:t=!1,includeSelf:r=!0},i){var n;const a=i.treeNodeMap;let o=e==null?null:(n=a.get(e))!==null&&n!==void 0?n:null;const s={keyPath:[],treeNodePath:[],treeNode:o};if(o!=null&&o.ignored)return s.treeNode=null,s;for(;o;)!o.ignored&&(t||!o.isGroup)&&s.treeNodePath.push(o),o=o.parent;return s.treeNodePath.reverse(),r||s.treeNodePath.pop(),s.keyPath=s.treeNodePath.map(l=>l.key),s}function iie(e){if(e.length===0)return null;const t=e[0];return t.isGroup||t.ignored||t.disabled?t.getNext():t}function nie(e,t){const r=e.siblings,i=r.length,{index:n}=e;return t?r[(n+1)%i]:n===r.length-1?null:r[n+1]}function fR(e,t,{loop:r=!1,includeDisabled:i=!1}={}){const n=t==="prev"?aie:nie,a={reverse:t==="prev"};let o=!1,s=null;function l(c){if(c!==null){if(c===e){if(!o)o=!0;else if(!e.disabled&&!e.isGroup){s=e;return}}else if((!c.disabled||i)&&!c.ignored&&!c.isGroup){s=c;return}if(c.isGroup){const u=nP(c,a);u!==null?s=u:l(n(c,r))}else{const u=n(c,!1);if(u!==null)l(u);else{const d=oie(c);d!=null&&d.isGroup?l(n(d,r)):r&&l(n(c,!0))}}}}return l(e),s}function aie(e,t){const r=e.siblings,i=r.length,{index:n}=e;return t?r[(n-1+i)%i]:n===0?null:r[n-1]}function oie(e){return e.parent}function nP(e,t={}){const{reverse:r=!1}=t,{children:i}=e;if(i){const{length:n}=i,a=r?n-1:0,o=r?-1:n,s=r?-1:1;for(let l=a;l!==o;l+=s){const c=i[l];if(!c.disabled&&!c.ignored)if(c.isGroup){const u=nP(c,t);if(u!==null)return u}else return c}}return null}const sie={getChild(){return this.ignored?null:nP(this)},getParent(){const{parent:e}=this;return e!=null&&e.isGroup?e.getParent():e},getNext(e={}){return fR(this,"next",e)},getPrev(e={}){return fR(this,"prev",e)}};function lie(e,t){const r=t?new Set(t):void 0,i=[];function n(a){a.forEach(o=>{i.push(o),!(o.isLeaf||!o.children||o.ignored)&&(o.isGroup||r===void 0||r.has(o.key))&&n(o.children)})}return n(e),i}function cie(e,t){const r=e.key;for(;t;){if(t.key===r)return!0;t=t.parent}return!1}function YU(e,t,r,i,n,a=null,o=0){const s=[];return e.forEach((l,c)=>{var u;const d=Object.create(i);if(d.rawNode=l,d.siblings=s,d.level=o,d.index=c,d.isFirstChild=c===0,d.isLastChild=c+1===e.length,d.parent=a,!d.ignored){const h=n(l);Array.isArray(h)&&(d.children=YU(h,t,r,i,n,d,o+1))}s.push(d),t.set(d.key,d),r.has(o)||r.set(o,[]),(u=r.get(o))===null||u===void 0||u.push(d)}),s}function rp(e,t={}){var r;const i=new Map,n=new Map,{getDisabled:a=$re,getIgnored:o=Wre,getIsGroup:s=Kre,getKey:l=Hre}=t,c=(r=t.getChildren)!==null&&r!==void 0?r:Vre,u=t.ignoreEmptyChildren?x=>{const S=c(x);return Array.isArray(S)?S.length?S:null:S}:c,d=Object.assign({get key(){return l(this.rawNode)},get disabled(){return a(this.rawNode)},get isGroup(){return s(this.rawNode)},get isLeaf(){return jre(this.rawNode,u)},get shallowLoaded(){return Gre(this.rawNode,u)},get ignored(){return o(this.rawNode)},contains(x){return cie(this,x)}},sie),h=YU(e,i,n,d,u);function f(x){if(x==null)return null;const S=i.get(x);return S&&!S.isGroup&&!S.ignored?S:null}function p(x){if(x==null)return null;const S=i.get(x);return S&&!S.ignored?S:null}function v(x,S){const w=p(x);return w?w.getPrev(S):null}function m(x,S){const w=p(x);return w?w.getNext(S):null}function g(x){const S=p(x);return S?S.getParent():null}function y(x){const S=p(x);return S?S.getChild():null}const b={treeNodes:h,treeNodeMap:i,levelTreeNodeMap:n,maxLevel:Math.max(...n.keys()),getChildren:u,getFlattenedNodes(x){return lie(h,x)},getNode:f,getPrev:v,getNext:m,getParent:g,getChild:y,getFirstAvailableNode(){return iie(h)},getPath(x,S={}){return rie(x,S,b)},getCheckedKeys(x,S={}){const{cascade:w=!0,leafOnly:_=!1,checkStrategy:C="all",allowNotLoaded:A=!1}=S;return PS({checkedKeys:ES(x),indeterminateKeys:TS(x),cascade:w,leafOnly:_,checkStrategy:C,allowNotLoaded:A},b)},check(x,S,w={}){const{cascade:_=!0,leafOnly:C=!1,checkStrategy:A="all",allowNotLoaded:M=!1}=w;return PS({checkedKeys:ES(S),indeterminateKeys:TS(S),keysToCheck:x==null?[]:hR(x),cascade:_,leafOnly:C,checkStrategy:A,allowNotLoaded:M},b)},uncheck(x,S,w={}){const{cascade:_=!0,leafOnly:C=!1,checkStrategy:A="all",allowNotLoaded:M=!1}=w;return PS({checkedKeys:ES(S),indeterminateKeys:TS(S),keysToUncheck:x==null?[]:hR(x),cascade:_,leafOnly:C,checkStrategy:A,allowNotLoaded:M},b)},getNonLeafKeys(x={}){return Ure(h,x)}};return b}const Ht={neutralBase:"#FFF",neutralInvertBase:"#000",neutralTextBase:"#000",neutralPopover:"#fff",neutralCard:"#fff",neutralModal:"#fff",neutralBody:"#fff",alpha1:"0.82",alpha2:"0.72",alpha3:"0.38",alpha4:"0.24",alpha5:"0.18",alphaClose:"0.6",alphaDisabled:"0.5",alphaDisabledInput:"0.02",alphaPending:"0.05",alphaTablePending:"0.02",alphaPressed:"0.07",alphaAvatar:"0.2",alphaRail:"0.14",alphaProgressRail:".08",alphaBorder:"0.12",alphaDivider:"0.06",alphaInput:"0",alphaAction:"0.02",alphaTab:"0.04",alphaScrollbar:"0.25",alphaScrollbarHover:"0.4",alphaCode:"0.05",alphaTag:"0.02",primaryHover:"#36ad6a",primaryDefault:"#18a058",primaryActive:"#0c7a43",primarySuppl:"#36ad6a",infoHover:"#4098fc",infoDefault:"#2080f0",infoActive:"#1060c9",infoSuppl:"#4098fc",errorHover:"#de576d",errorDefault:"#d03050",errorActive:"#ab1f3f",errorSuppl:"#de576d",warningHover:"#fcb040",warningDefault:"#f0a020",warningActive:"#c97c10",warningSuppl:"#fcb040",successHover:"#36ad6a",successDefault:"#18a058",successActive:"#0c7a43",successSuppl:"#36ad6a"},uie=ah(Ht.neutralBase),XU=ah(Ht.neutralInvertBase),die="rgba("+XU.slice(0,3).join(", ")+", ";function pR(e){return die+String(e)+")"}function ua(e){const t=Array.from(XU);return t[3]=Number(e),il(uie,t)}const $r=Object.assign(Object.assign({name:"common"},Ku),{baseColor:Ht.neutralBase,primaryColor:Ht.primaryDefault,primaryColorHover:Ht.primaryHover,primaryColorPressed:Ht.primaryActive,primaryColorSuppl:Ht.primarySuppl,infoColor:Ht.infoDefault,infoColorHover:Ht.infoHover,infoColorPressed:Ht.infoActive,infoColorSuppl:Ht.infoSuppl,successColor:Ht.successDefault,successColorHover:Ht.successHover,successColorPressed:Ht.successActive,successColorSuppl:Ht.successSuppl,warningColor:Ht.warningDefault,warningColorHover:Ht.warningHover,warningColorPressed:Ht.warningActive,warningColorSuppl:Ht.warningSuppl,errorColor:Ht.errorDefault,errorColorHover:Ht.errorHover,errorColorPressed:Ht.errorActive,errorColorSuppl:Ht.errorSuppl,textColorBase:Ht.neutralTextBase,textColor1:"rgb(31, 34, 37)",textColor2:"rgb(51, 54, 57)",textColor3:"rgb(118, 124, 130)",textColorDisabled:ua(Ht.alpha4),placeholderColor:ua(Ht.alpha4),placeholderColorDisabled:ua(Ht.alpha5),iconColor:ua(Ht.alpha4),iconColorHover:N0(ua(Ht.alpha4),{lightness:.75}),iconColorPressed:N0(ua(Ht.alpha4),{lightness:.9}),iconColorDisabled:ua(Ht.alpha5),opacity1:Ht.alpha1,opacity2:Ht.alpha2,opacity3:Ht.alpha3,opacity4:Ht.alpha4,opacity5:Ht.alpha5,dividerColor:"rgb(239, 239, 245)",borderColor:"rgb(224, 224, 230)",closeIconColor:ua(Number(Ht.alphaClose)),closeIconColorHover:ua(Number(Ht.alphaClose)),closeIconColorPressed:ua(Number(Ht.alphaClose)),closeColorHover:"rgba(0, 0, 0, .09)",closeColorPressed:"rgba(0, 0, 0, .13)",clearColor:ua(Ht.alpha4),clearColorHover:N0(ua(Ht.alpha4),{lightness:.75}),clearColorPressed:N0(ua(Ht.alpha4),{lightness:.9}),scrollbarColor:pR(Ht.alphaScrollbar),scrollbarColorHover:pR(Ht.alphaScrollbarHover),scrollbarWidth:"5px",scrollbarHeight:"5px",scrollbarBorderRadius:"5px",progressRailColor:ua(Ht.alphaProgressRail),railColor:"rgb(219, 219, 223)",popoverColor:Ht.neutralPopover,tableColor:Ht.neutralCard,cardColor:Ht.neutralCard,modalColor:Ht.neutralModal,bodyColor:Ht.neutralBody,tagColor:"#eee",avatarColor:ua(Ht.alphaAvatar),invertedColor:"rgb(0, 20, 40)",inputColor:ua(Ht.alphaInput),codeColor:"rgb(244, 244, 248)",tabColor:"rgb(247, 247, 250)",actionColor:"rgb(250, 250, 252)",tableHeaderColor:"rgb(250, 250, 252)",hoverColor:"rgb(243, 243, 245)",tableColorHover:"rgba(0, 0, 100, 0.03)",tableColorStriped:"rgba(0, 0, 100, 0.02)",pressedColor:"rgb(237, 237, 239)",opacityDisabled:Ht.alphaDisabled,inputColorDisabled:"rgb(250, 250, 252)",buttonColor2:"rgba(46, 51, 56, .05)",buttonColor2Hover:"rgba(46, 51, 56, .09)",buttonColor2Pressed:"rgba(46, 51, 56, .13)",boxShadow1:"0 1px 2px -2px rgba(0, 0, 0, .08), 0 3px 6px 0 rgba(0, 0, 0, .06), 0 5px 12px 4px rgba(0, 0, 0, .04)",boxShadow2:"0 3px 6px -4px rgba(0, 0, 0, .12), 0 6px 16px 0 rgba(0, 0, 0, .08), 0 9px 28px 8px rgba(0, 0, 0, .05)",boxShadow3:"0 6px 16px -9px rgba(0, 0, 0, .08), 0 9px 28px 0 rgba(0, 0, 0, .05), 0 12px 48px 16px rgba(0, 0, 0, .03)"}),hie={iconSizeSmall:"34px",iconSizeMedium:"40px",iconSizeLarge:"46px",iconSizeHuge:"52px"},fie=e=>{const{textColorDisabled:t,iconColor:r,textColor2:i,fontSizeSmall:n,fontSizeMedium:a,fontSizeLarge:o,fontSizeHuge:s}=e;return Object.assign(Object.assign({},hie),{fontSizeSmall:n,fontSizeMedium:a,fontSizeLarge:o,fontSizeHuge:s,textColor:t,iconColor:r,extraTextColor:i})},aP={name:"Empty",common:$r,self:fie},pie=oe("empty",`
 display: flex;
 flex-direction: column;
 align-items: center;
 font-size: var(--n-font-size);
`,[he("icon",`
 width: var(--n-icon-size);
 height: var(--n-icon-size);
 font-size: var(--n-icon-size);
 line-height: var(--n-icon-size);
 color: var(--n-icon-color);
 transition:
 color .3s var(--n-bezier);
 `,[ge("+",[he("description",`
 margin-top: 8px;
 `)])]),he("description",`
 transition: color .3s var(--n-bezier);
 color: var(--n-text-color);
 `),he("extra",`
 text-align: center;
 transition: color .3s var(--n-bezier);
 margin-top: 12px;
 color: var(--n-extra-text-color);
 `)]),mie=Object.assign(Object.assign({},bt.props),{description:String,showDescription:{type:Boolean,default:!0},showIcon:{type:Boolean,default:!0},size:{type:String,default:"medium"},renderIcon:Function}),KU=je({name:"Empty",props:mie,setup(e){const{mergedClsPrefixRef:t,inlineThemeDisabled:r}=vr(e),i=bt("Empty","-empty",pie,aP,e,t),{localeRef:n}=wc("Empty"),a=_t(Eh,null),o=re(()=>{var u,d,h;return(u=e.description)!==null&&u!==void 0?u:(h=(d=a==null?void 0:a.mergedComponentPropsRef.value)===null||d===void 0?void 0:d.Empty)===null||h===void 0?void 0:h.description}),s=re(()=>{var u,d;return((d=(u=a==null?void 0:a.mergedComponentPropsRef.value)===null||u===void 0?void 0:u.Empty)===null||d===void 0?void 0:d.renderIcon)||(()=>E(Sre,null))}),l=re(()=>{const{size:u}=e,{common:{cubicBezierEaseInOut:d},self:{[Ze("iconSize",u)]:h,[Ze("fontSize",u)]:f,textColor:p,iconColor:v,extraTextColor:m}}=i.value;return{"--n-icon-size":h,"--n-font-size":f,"--n-bezier":d,"--n-text-color":p,"--n-icon-color":v,"--n-extra-text-color":m}}),c=r?Dr("empty",re(()=>{let u="";const{size:d}=e;return u+=d[0],u}),l,e):void 0;return{mergedClsPrefix:t,mergedRenderIcon:s,localizedDescription:re(()=>o.value||n.value.description),cssVars:r?void 0:l,themeClass:c==null?void 0:c.themeClass,onRender:c==null?void 0:c.onRender}},render(){const{$slots:e,mergedClsPrefix:t,onRender:r}=this;return r==null||r(),E("div",{class:[`${t}-empty`,this.themeClass],style:this.cssVars},this.showIcon?E("div",{class:`${t}-empty__icon`},e.icon?e.icon():E(Bi,{clsPrefix:t},{default:this.mergedRenderIcon})):null,this.showDescription?E("div",{class:`${t}-empty__description`},e.default?e.default():this.localizedDescription):null,e.extra?E("div",{class:`${t}-empty__extra`},e.extra()):null)}}),vie={railInsetHorizontal:"auto 2px 4px 2px",railInsetVertical:"2px 4px 2px auto",railColor:"transparent"},gie=e=>{const{scrollbarColor:t,scrollbarColorHover:r,scrollbarHeight:i,scrollbarWidth:n,scrollbarBorderRadius:a}=e;return Object.assign(Object.assign({},vie),{height:i,width:n,borderRadius:a,color:t,colorHover:r})},em={name:"Scrollbar",common:$r,self:gie},{cubicBezierEaseInOut:mR}=Ku;function yie({name:e="fade-in",enterDuration:t="0.2s",leaveDuration:r="0.2s",enterCubicBezier:i=mR,leaveCubicBezier:n=mR}={}){return[ge(`&.${e}-transition-enter-active`,{transition:`all ${t} ${i}!important`}),ge(`&.${e}-transition-leave-active`,{transition:`all ${r} ${n}!important`}),ge(`&.${e}-transition-enter-from, &.${e}-transition-leave-to`,{opacity:0}),ge(`&.${e}-transition-leave-from, &.${e}-transition-enter-to`,{opacity:1})]}const bie=oe("scrollbar",`
 overflow: hidden;
 position: relative;
 z-index: auto;
 height: 100%;
 width: 100%;
`,[ge(">",[oe("scrollbar-container",`
 width: 100%;
 overflow: scroll;
 height: 100%;
 min-height: inherit;
 max-height: inherit;
 scrollbar-width: none;
 `,[ge("&::-webkit-scrollbar, &::-webkit-scrollbar-track-piece, &::-webkit-scrollbar-thumb",`
 width: 0;
 height: 0;
 display: none;
 `),ge(">",[oe("scrollbar-content",`
 box-sizing: border-box;
 min-width: 100%;
 `)])])]),ge(">, +",[oe("scrollbar-rail",`
 position: absolute;
 pointer-events: none;
 user-select: none;
 background: var(--n-scrollbar-rail-color);
 -webkit-user-select: none;
 `,[xe("horizontal",`
 inset: var(--n-scrollbar-rail-inset-horizontal);
 height: var(--n-scrollbar-height);
 `,[ge(">",[he("scrollbar",`
 height: var(--n-scrollbar-height);
 border-radius: var(--n-scrollbar-border-radius);
 right: 0;
 `)])]),xe("vertical",`
 inset: var(--n-scrollbar-rail-inset-vertical);
 width: var(--n-scrollbar-width);
 `,[ge(">",[he("scrollbar",`
 width: var(--n-scrollbar-width);
 border-radius: var(--n-scrollbar-border-radius);
 bottom: 0;
 `)])]),xe("disabled",[ge(">",[he("scrollbar","pointer-events: none;")])]),ge(">",[he("scrollbar",`
 z-index: 1;
 position: absolute;
 cursor: pointer;
 pointer-events: all;
 background-color: var(--n-scrollbar-color);
 transition: background-color .2s var(--n-scrollbar-bezier);
 `,[yie(),ge("&:hover","background-color: var(--n-scrollbar-color-hover);")])])])])]),xie=Object.assign(Object.assign({},bt.props),{duration:{type:Number,default:0},scrollable:{type:Boolean,default:!0},xScrollable:Boolean,trigger:{type:String,default:"hover"},useUnifiedContainer:Boolean,triggerDisplayManually:Boolean,container:Function,content:Function,containerClass:String,containerStyle:[String,Object],contentClass:[String,Array],contentStyle:[String,Object],horizontalRailStyle:[String,Object],verticalRailStyle:[String,Object],onScroll:Function,onWheel:Function,onResize:Function,internalOnUpdateScrollLeft:Function,internalHoistYRail:Boolean}),Sn=je({name:"Scrollbar",props:xie,inheritAttrs:!1,setup(e){const{mergedClsPrefixRef:t,inlineThemeDisabled:r,mergedRtlRef:i}=vr(e),n=oo("Scrollbar",i,t),a=me(null),o=me(null),s=me(null),l=me(null),c=me(null),u=me(null),d=me(null),h=me(null),f=me(null),p=me(null),v=me(null),m=me(0),g=me(0),y=me(!1),b=me(!1);let x=!1,S=!1,w,_,C=0,A=0,M=0,P=0;const T=MY(),R=bt("Scrollbar","-scrollbar",bie,em,e,t),z=re(()=>{const{value:se}=h,{value:Be}=u,{value:Ye}=p;return se===null||Be===null||Ye===null?0:Math.min(se,Ye*se/Be+nn(R.value.self.width)*1.5)}),F=re(()=>`${z.value}px`),H=re(()=>{const{value:se}=f,{value:Be}=d,{value:Ye}=v;return se===null||Be===null||Ye===null?0:Ye*se/Be+nn(R.value.self.height)*1.5}),N=re(()=>`${H.value}px`),U=re(()=>{const{value:se}=h,{value:Be}=m,{value:Ye}=u,{value:pe}=p;if(se===null||Ye===null||pe===null)return 0;{const Te=Ye-se;return Te?Be/Te*(pe-z.value):0}}),ie=re(()=>`${U.value}px`),te=re(()=>{const{value:se}=f,{value:Be}=g,{value:Ye}=d,{value:pe}=v;if(se===null||Ye===null||pe===null)return 0;{const Te=Ye-se;return Te?Be/Te*(pe-H.value):0}}),X=re(()=>`${te.value}px`),W=re(()=>{const{value:se}=h,{value:Be}=u;return se!==null&&Be!==null&&Be>se}),q=re(()=>{const{value:se}=f,{value:Be}=d;return se!==null&&Be!==null&&Be>se}),$=re(()=>{const{trigger:se}=e;return se==="none"||y.value}),le=re(()=>{const{trigger:se}=e;return se==="none"||b.value}),ee=re(()=>{const{container:se}=e;return se?se():o.value}),Q=re(()=>{const{content:se}=e;return se?se():s.value}),ne=BT(()=>{e.container||ve({top:m.value,left:g.value})}),V=()=>{ne.isDeactivated||j()},ue=se=>{if(ne.isDeactivated)return;const{onResize:Be}=e;Be&&Be(se),j()},ve=(se,Be)=>{if(!e.scrollable)return;if(typeof se=="number"){G(se,Be??0,0,!1,"auto");return}const{left:Ye,top:pe,index:Te,elSize:ce,position:Re,behavior:$e,el:at,debounce:Yt=!0}=se;(Ye!==void 0||pe!==void 0)&&G(Ye??0,pe??0,0,!1,$e),at!==void 0?G(0,at.offsetTop,at.offsetHeight,Yt,$e):Te!==void 0&&ce!==void 0?G(0,Te*ce,ce,Yt,$e):Re==="bottom"?G(0,Number.MAX_SAFE_INTEGER,0,!1,$e):Re==="top"&&G(0,0,0,!1,$e)},Ce=(se,Be)=>{if(!e.scrollable)return;const{value:Ye}=ee;Ye&&(typeof se=="object"?Ye.scrollBy(se):Ye.scrollBy(se,Be||0))};function G(se,Be,Ye,pe,Te){const{value:ce}=ee;if(ce){if(pe){const{scrollTop:Re,offsetHeight:$e}=ce;if(Be>Re){Be+Ye<=Re+$e||ce.scrollTo({left:se,top:Be+Ye-$e,behavior:Te});return}}ce.scrollTo({left:se,top:Be,behavior:Te})}}function Z(){Ee(),fe(),j()}function de(){Se()}function Se(){we(),_e()}function we(){_!==void 0&&window.clearTimeout(_),_=window.setTimeout(()=>{b.value=!1},e.duration)}function _e(){w!==void 0&&window.clearTimeout(w),w=window.setTimeout(()=>{y.value=!1},e.duration)}function Ee(){w!==void 0&&window.clearTimeout(w),y.value=!0}function fe(){_!==void 0&&window.clearTimeout(_),b.value=!0}function B(se){const{onScroll:Be}=e;Be&&Be(se),D()}function D(){const{value:se}=ee;se&&(m.value=se.scrollTop,g.value=se.scrollLeft*(n!=null&&n.value?-1:1))}function I(){const{value:se}=Q;se&&(u.value=se.offsetHeight,d.value=se.offsetWidth);const{value:Be}=ee;Be&&(h.value=Be.offsetHeight,f.value=Be.offsetWidth);const{value:Ye}=c,{value:pe}=l;Ye&&(v.value=Ye.offsetWidth),pe&&(p.value=pe.offsetHeight)}function O(){const{value:se}=ee;se&&(m.value=se.scrollTop,g.value=se.scrollLeft*(n!=null&&n.value?-1:1),h.value=se.offsetHeight,f.value=se.offsetWidth,u.value=se.scrollHeight,d.value=se.scrollWidth);const{value:Be}=c,{value:Ye}=l;Be&&(v.value=Be.offsetWidth),Ye&&(p.value=Ye.offsetHeight)}function j(){e.scrollable&&(e.useUnifiedContainer?O():(I(),D()))}function L(se){var Be;return!(!((Be=a.value)===null||Be===void 0)&&Be.contains(lc(se)))}function Ae(se){se.preventDefault(),se.stopPropagation(),S=!0,Ui("mousemove",window,We,!0),Ui("mouseup",window,Ve,!0),A=g.value,M=n!=null&&n.value?window.innerWidth-se.clientX:se.clientX}function We(se){if(!S)return;w!==void 0&&window.clearTimeout(w),_!==void 0&&window.clearTimeout(_);const{value:Be}=f,{value:Ye}=d,{value:pe}=H;if(Be===null||Ye===null)return;const ce=(n!=null&&n.value?window.innerWidth-se.clientX-M:se.clientX-M)*(Ye-Be)/(Be-pe),Re=Ye-Be;let $e=A+ce;$e=Math.min(Re,$e),$e=Math.max($e,0);const{value:at}=ee;if(at){at.scrollLeft=$e*(n!=null&&n.value?-1:1);const{internalOnUpdateScrollLeft:Yt}=e;Yt&&Yt($e)}}function Ve(se){se.preventDefault(),se.stopPropagation(),Si("mousemove",window,We,!0),Si("mouseup",window,Ve,!0),S=!1,j(),L(se)&&Se()}function ke(se){se.preventDefault(),se.stopPropagation(),x=!0,Ui("mousemove",window,et,!0),Ui("mouseup",window,nt,!0),C=m.value,P=se.clientY}function et(se){if(!x)return;w!==void 0&&window.clearTimeout(w),_!==void 0&&window.clearTimeout(_);const{value:Be}=h,{value:Ye}=u,{value:pe}=z;if(Be===null||Ye===null)return;const ce=(se.clientY-P)*(Ye-Be)/(Be-pe),Re=Ye-Be;let $e=C+ce;$e=Math.min(Re,$e),$e=Math.max($e,0);const{value:at}=ee;at&&(at.scrollTop=$e)}function nt(se){se.preventDefault(),se.stopPropagation(),Si("mousemove",window,et,!0),Si("mouseup",window,nt,!0),x=!1,j(),L(se)&&Se()}no(()=>{const{value:se}=q,{value:Be}=W,{value:Ye}=t,{value:pe}=c,{value:Te}=l;pe&&(se?pe.classList.remove(`${Ye}-scrollbar-rail--disabled`):pe.classList.add(`${Ye}-scrollbar-rail--disabled`)),Te&&(Be?Te.classList.remove(`${Ye}-scrollbar-rail--disabled`):Te.classList.add(`${Ye}-scrollbar-rail--disabled`))}),Or(()=>{e.container||j()}),la(()=>{w!==void 0&&window.clearTimeout(w),_!==void 0&&window.clearTimeout(_),Si("mousemove",window,et,!0),Si("mouseup",window,nt,!0)});const lt=re(()=>{const{common:{cubicBezierEaseInOut:se},self:{color:Be,colorHover:Ye,height:pe,width:Te,borderRadius:ce,railInsetHorizontal:Re,railInsetVertical:$e,railColor:at}}=R.value;return{"--n-scrollbar-bezier":se,"--n-scrollbar-color":Be,"--n-scrollbar-color-hover":Ye,"--n-scrollbar-border-radius":ce,"--n-scrollbar-width":Te,"--n-scrollbar-height":pe,"--n-scrollbar-rail-inset-horizontal":Re,"--n-scrollbar-rail-inset-vertical":n!=null&&n.value?Hq($e):$e,"--n-scrollbar-rail-color":at}}),ut=r?Dr("scrollbar",void 0,lt,e):void 0;return Object.assign(Object.assign({},{scrollTo:ve,scrollBy:Ce,sync:j,syncUnifiedContainer:O,handleMouseEnterWrapper:Z,handleMouseLeaveWrapper:de}),{mergedClsPrefix:t,rtlEnabled:n,containerScrollTop:m,wrapperRef:a,containerRef:o,contentRef:s,yRailRef:l,xRailRef:c,needYBar:W,needXBar:q,yBarSizePx:F,xBarSizePx:N,yBarTopPx:ie,xBarLeftPx:X,isShowXBar:$,isShowYBar:le,isIos:T,handleScroll:B,handleContentResize:V,handleContainerResize:ue,handleYScrollMouseDown:ke,handleXScrollMouseDown:Ae,cssVars:r?void 0:lt,themeClass:ut==null?void 0:ut.themeClass,onRender:ut==null?void 0:ut.onRender})},render(){var e;const{$slots:t,mergedClsPrefix:r,triggerDisplayManually:i,rtlEnabled:n,internalHoistYRail:a}=this;if(!this.scrollable)return(e=t.default)===null||e===void 0?void 0:e.call(t);const o=this.trigger==="none",s=(u,d)=>E("div",{ref:"yRailRef",class:[`${r}-scrollbar-rail`,`${r}-scrollbar-rail--vertical`,u],"data-scrollbar-rail":!0,style:[d||"",this.verticalRailStyle],"aria-hidden":!0},E(o?E2:La,o?null:{name:"fade-in-transition"},{default:()=>this.needYBar&&this.isShowYBar&&!this.isIos?E("div",{class:`${r}-scrollbar-rail__scrollbar`,style:{height:this.yBarSizePx,top:this.yBarTopPx},onMousedown:this.handleYScrollMouseDown}):null})),l=()=>{var u,d;return(u=this.onRender)===null||u===void 0||u.call(this),E("div",$u(this.$attrs,{role:"none",ref:"wrapperRef",class:[`${r}-scrollbar`,this.themeClass,n&&`${r}-scrollbar--rtl`],style:this.cssVars,onMouseenter:i?void 0:this.handleMouseEnterWrapper,onMouseleave:i?void 0:this.handleMouseLeaveWrapper}),[this.container?(d=t.default)===null||d===void 0?void 0:d.call(t):E("div",{role:"none",ref:"containerRef",class:[`${r}-scrollbar-container`,this.containerClass],style:this.containerStyle,onScroll:this.handleScroll,onWheel:this.onWheel},E(nl,{onResize:this.handleContentResize},{default:()=>E("div",{ref:"contentRef",role:"none",style:[{width:this.xScrollable?"fit-content":null},this.contentStyle],class:[`${r}-scrollbar-content`,this.contentClass]},t)})),a?null:s(void 0,void 0),this.xScrollable&&E("div",{ref:"xRailRef",class:[`${r}-scrollbar-rail`,`${r}-scrollbar-rail--horizontal`],style:this.horizontalRailStyle,"data-scrollbar-rail":!0,"aria-hidden":!0},E(o?E2:La,o?null:{name:"fade-in-transition"},{default:()=>this.needXBar&&this.isShowXBar&&!this.isIos?E("div",{class:`${r}-scrollbar-rail__scrollbar`,style:{width:this.xBarSizePx,right:n?this.xBarLeftPx:void 0,left:n?void 0:this.xBarLeftPx},onMousedown:this.handleXScrollMouseDown}):null}))])},c=this.container?l():E(nl,{onResize:this.handleContainerResize},{default:l});return a?E(mr,null,c,s(this.themeClass,this.cssVars)):c}}),QU=Sn,wie={height:"calc(var(--n-option-height) * 7.6)",paddingSmall:"4px 0",paddingMedium:"4px 0",paddingLarge:"4px 0",paddingHuge:"4px 0",optionPaddingSmall:"0 12px",optionPaddingMedium:"0 12px",optionPaddingLarge:"0 12px",optionPaddingHuge:"0 12px",loadingSize:"18px"},Sie=e=>{const{borderRadius:t,popoverColor:r,textColor3:i,dividerColor:n,textColor2:a,primaryColorPressed:o,textColorDisabled:s,primaryColor:l,opacityDisabled:c,hoverColor:u,fontSizeSmall:d,fontSizeMedium:h,fontSizeLarge:f,fontSizeHuge:p,heightSmall:v,heightMedium:m,heightLarge:g,heightHuge:y}=e;return Object.assign(Object.assign({},wie),{optionFontSizeSmall:d,optionFontSizeMedium:h,optionFontSizeLarge:f,optionFontSizeHuge:p,optionHeightSmall:v,optionHeightMedium:m,optionHeightLarge:g,optionHeightHuge:y,borderRadius:t,color:r,groupHeaderTextColor:i,actionDividerColor:n,optionTextColor:a,optionTextColorPressed:o,optionTextColorDisabled:s,optionTextColorActive:l,optionOpacityDisabled:c,optionCheckColor:l,optionColorPending:u,optionColorActive:"rgba(0, 0, 0, 0)",optionColorActivePending:u,actionTextColor:a,loadingColor:l})},oP={name:"InternalSelectMenu",common:$r,peers:{Scrollbar:em,Empty:aP},self:Sie};function Cie(e,t){return E(La,{name:"fade-in-scale-up-transition"},{default:()=>e?E(Bi,{clsPrefix:t,class:`${t}-base-select-option__check`},{default:()=>E(yre)}):null})}const vR=je({name:"NBaseSelectOption",props:{clsPrefix:{type:String,required:!0},tmNode:{type:Object,required:!0}},setup(e){const{valueRef:t,pendingTmNodeRef:r,multipleRef:i,valueSetRef:n,renderLabelRef:a,renderOptionRef:o,labelFieldRef:s,valueFieldRef:l,showCheckmarkRef:c,nodePropsRef:u,handleOptionClick:d,handleOptionMouseEnter:h}=_t(IT),f=qi(()=>{const{value:g}=r;return g?e.tmNode.key===g.key:!1});function p(g){const{tmNode:y}=e;y.disabled||d(g,y)}function v(g){const{tmNode:y}=e;y.disabled||h(g,y)}function m(g){const{tmNode:y}=e,{value:b}=f;y.disabled||b||h(g,y)}return{multiple:i,isGrouped:qi(()=>{const{tmNode:g}=e,{parent:y}=g;return y&&y.rawNode.type==="group"}),showCheckmark:c,nodeProps:u,isPending:f,isSelected:qi(()=>{const{value:g}=t,{value:y}=i;if(g===null)return!1;const b=e.tmNode.rawNode[l.value];if(y){const{value:x}=n;return x.has(b)}else return g===b}),labelField:s,renderLabel:a,renderOption:o,handleMouseMove:m,handleMouseEnter:v,handleClick:p}},render(){const{clsPrefix:e,tmNode:{rawNode:t},isSelected:r,isPending:i,isGrouped:n,showCheckmark:a,nodeProps:o,renderOption:s,renderLabel:l,handleClick:c,handleMouseEnter:u,handleMouseMove:d}=this,h=Cie(r,e),f=l?[l(t,r),a&&h]:[Fn(t[this.labelField],t,r),a&&h],p=o==null?void 0:o(t),v=E("div",Object.assign({},p,{class:[`${e}-base-select-option`,t.class,p==null?void 0:p.class,{[`${e}-base-select-option--disabled`]:t.disabled,[`${e}-base-select-option--selected`]:r,[`${e}-base-select-option--grouped`]:n,[`${e}-base-select-option--pending`]:i,[`${e}-base-select-option--show-checkmark`]:a}],style:[(p==null?void 0:p.style)||"",t.style||""],onClick:uS([c,p==null?void 0:p.onClick]),onMouseenter:uS([u,p==null?void 0:p.onMouseenter]),onMousemove:uS([d,p==null?void 0:p.onMousemove])}),E("div",{class:`${e}-base-select-option__content`},f));return t.render?t.render({node:v,option:t,selected:r}):s?s({node:v,option:t,selected:r}):v}}),gR=je({name:"NBaseSelectGroupHeader",props:{clsPrefix:{type:String,required:!0},tmNode:{type:Object,required:!0}},setup(){const{renderLabelRef:e,renderOptionRef:t,labelFieldRef:r,nodePropsRef:i}=_t(IT);return{labelField:r,nodeProps:i,renderLabel:e,renderOption:t}},render(){const{clsPrefix:e,renderLabel:t,renderOption:r,nodeProps:i,tmNode:{rawNode:n}}=this,a=i==null?void 0:i(n),o=t?t(n,!1):Fn(n[this.labelField],n,!1),s=E("div",Object.assign({},a,{class:[`${e}-base-select-group-header`,a==null?void 0:a.class]}),o);return n.render?n.render({node:s,option:n}):r?r({node:s,option:n,selected:!1}):s}}),{cubicBezierEaseIn:yR,cubicBezierEaseOut:bR}=Ku;function tm({transformOrigin:e="inherit",duration:t=".2s",enterScale:r=".9",originalTransform:i="",originalTransition:n=""}={}){return[ge("&.fade-in-scale-up-transition-leave-active",{transformOrigin:e,transition:`opacity ${t} ${yR}, transform ${t} ${yR} ${n&&","+n}`}),ge("&.fade-in-scale-up-transition-enter-active",{transformOrigin:e,transition:`opacity ${t} ${bR}, transform ${t} ${bR} ${n&&","+n}`}),ge("&.fade-in-scale-up-transition-enter-from, &.fade-in-scale-up-transition-leave-to",{opacity:0,transform:`${i} scale(${r})`}),ge("&.fade-in-scale-up-transition-leave-from, &.fade-in-scale-up-transition-enter-to",{opacity:1,transform:`${i} scale(1)`})]}const _ie=oe("base-select-menu",`
 line-height: 1.5;
 outline: none;
 z-index: 0;
 position: relative;
 border-radius: var(--n-border-radius);
 transition:
 background-color .3s var(--n-bezier),
 box-shadow .3s var(--n-bezier);
 background-color: var(--n-color);
`,[oe("scrollbar",`
 max-height: var(--n-height);
 `),oe("virtual-list",`
 max-height: var(--n-height);
 `),oe("base-select-option",`
 min-height: var(--n-option-height);
 font-size: var(--n-option-font-size);
 display: flex;
 align-items: center;
 `,[he("content",`
 z-index: 1;
 white-space: nowrap;
 text-overflow: ellipsis;
 overflow: hidden;
 `)]),oe("base-select-group-header",`
 min-height: var(--n-option-height);
 font-size: .93em;
 display: flex;
 align-items: center;
 `),oe("base-select-menu-option-wrapper",`
 position: relative;
 width: 100%;
 `),he("loading, empty",`
 display: flex;
 padding: 12px 32px;
 flex: 1;
 justify-content: center;
 `),he("loading",`
 color: var(--n-loading-color);
 font-size: var(--n-loading-size);
 `),he("header",`
 padding: 8px var(--n-option-padding-left);
 font-size: var(--n-option-font-size);
 transition: 
 color .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 border-bottom: 1px solid var(--n-action-divider-color);
 color: var(--n-action-text-color);
 `),he("action",`
 padding: 8px var(--n-option-padding-left);
 font-size: var(--n-option-font-size);
 transition: 
 color .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 border-top: 1px solid var(--n-action-divider-color);
 color: var(--n-action-text-color);
 `),oe("base-select-group-header",`
 position: relative;
 cursor: default;
 padding: var(--n-option-padding);
 color: var(--n-group-header-text-color);
 `),oe("base-select-option",`
 cursor: pointer;
 position: relative;
 padding: var(--n-option-padding);
 transition:
 color .3s var(--n-bezier),
 opacity .3s var(--n-bezier);
 box-sizing: border-box;
 color: var(--n-option-text-color);
 opacity: 1;
 `,[xe("show-checkmark",`
 padding-right: calc(var(--n-option-padding-right) + 20px);
 `),ge("&::before",`
 content: "";
 position: absolute;
 left: 4px;
 right: 4px;
 top: 0;
 bottom: 0;
 border-radius: var(--n-border-radius);
 transition: background-color .3s var(--n-bezier);
 `),ge("&:active",`
 color: var(--n-option-text-color-pressed);
 `),xe("grouped",`
 padding-left: calc(var(--n-option-padding-left) * 1.5);
 `),xe("pending",[ge("&::before",`
 background-color: var(--n-option-color-pending);
 `)]),xe("selected",`
 color: var(--n-option-text-color-active);
 `,[ge("&::before",`
 background-color: var(--n-option-color-active);
 `),xe("pending",[ge("&::before",`
 background-color: var(--n-option-color-active-pending);
 `)])]),xe("disabled",`
 cursor: not-allowed;
 `,[br("selected",`
 color: var(--n-option-text-color-disabled);
 `),xe("selected",`
 opacity: var(--n-option-opacity-disabled);
 `)]),he("check",`
 font-size: 16px;
 position: absolute;
 right: calc(var(--n-option-padding-right) - 4px);
 top: calc(50% - 7px);
 color: var(--n-option-check-color);
 transition: color .3s var(--n-bezier);
 `,[tm({enterScale:"0.5"})])])]),ZU=je({name:"InternalSelectMenu",props:Object.assign(Object.assign({},bt.props),{clsPrefix:{type:String,required:!0},scrollable:{type:Boolean,default:!0},treeMate:{type:Object,required:!0},multiple:Boolean,size:{type:String,default:"medium"},value:{type:[String,Number,Array],default:null},autoPending:Boolean,virtualScroll:{type:Boolean,default:!0},show:{type:Boolean,default:!0},labelField:{type:String,default:"label"},valueField:{type:String,default:"value"},loading:Boolean,focusable:Boolean,renderLabel:Function,renderOption:Function,nodeProps:Function,showCheckmark:{type:Boolean,default:!0},onMousedown:Function,onScroll:Function,onFocus:Function,onBlur:Function,onKeyup:Function,onKeydown:Function,onTabOut:Function,onMouseenter:Function,onMouseleave:Function,onResize:Function,resetMenuOnOptionsChange:{type:Boolean,default:!0},inlineThemeDisabled:Boolean,onToggle:Function}),setup(e){const{mergedClsPrefixRef:t,mergedRtlRef:r}=vr(e),i=oo("InternalSelectMenu",r,t),n=bt("InternalSelectMenu","-internal-select-menu",_ie,oP,e,pt(e,"clsPrefix")),a=me(null),o=me(null),s=me(null),l=re(()=>e.treeMate.getFlattenedNodes()),c=re(()=>Qre(l.value)),u=me(null);function d(){const{treeMate:W}=e;let q=null;const{value:$}=e;$===null?q=W.getFirstAvailableNode():(e.multiple?q=W.getNode(($||[])[($||[]).length-1]):q=W.getNode($),(!q||q.disabled)&&(q=W.getFirstAvailableNode())),z(q||null)}function h(){const{value:W}=u;W&&!e.treeMate.getNode(W.key)&&(u.value=null)}let f;rr(()=>e.show,W=>{W?f=rr(()=>e.treeMate,()=>{e.resetMenuOnOptionsChange?(e.autoPending?d():h(),aa(F)):h()},{immediate:!0}):f==null||f()},{immediate:!0}),la(()=>{f==null||f()});const p=re(()=>nn(n.value.self[Ze("optionHeight",e.size)])),v=re(()=>zo(n.value.self[Ze("padding",e.size)])),m=re(()=>e.multiple&&Array.isArray(e.value)?new Set(e.value):new Set),g=re(()=>{const W=l.value;return W&&W.length===0});function y(W){const{onToggle:q}=e;q&&q(W)}function b(W){const{onScroll:q}=e;q&&q(W)}function x(W){var q;(q=s.value)===null||q===void 0||q.sync(),b(W)}function S(){var W;(W=s.value)===null||W===void 0||W.sync()}function w(){const{value:W}=u;return W||null}function _(W,q){q.disabled||z(q,!1)}function C(W,q){q.disabled||y(q)}function A(W){var q;Ou(W,"action")||(q=e.onKeyup)===null||q===void 0||q.call(e,W)}function M(W){var q;Ou(W,"action")||(q=e.onKeydown)===null||q===void 0||q.call(e,W)}function P(W){var q;(q=e.onMousedown)===null||q===void 0||q.call(e,W),!e.focusable&&W.preventDefault()}function T(){const{value:W}=u;W&&z(W.getNext({loop:!0}),!0)}function R(){const{value:W}=u;W&&z(W.getPrev({loop:!0}),!0)}function z(W,q=!1){u.value=W,q&&F()}function F(){var W,q;const $=u.value;if(!$)return;const le=c.value($.key);le!==null&&(e.virtualScroll?(W=o.value)===null||W===void 0||W.scrollTo({index:le}):(q=s.value)===null||q===void 0||q.scrollTo({index:le,elSize:p.value}))}function H(W){var q,$;!((q=a.value)===null||q===void 0)&&q.contains(W.target)&&(($=e.onFocus)===null||$===void 0||$.call(e,W))}function N(W){var q,$;!((q=a.value)===null||q===void 0)&&q.contains(W.relatedTarget)||($=e.onBlur)===null||$===void 0||$.call(e,W)}xr(IT,{handleOptionMouseEnter:_,handleOptionClick:C,valueSetRef:m,pendingTmNodeRef:u,nodePropsRef:pt(e,"nodeProps"),showCheckmarkRef:pt(e,"showCheckmark"),multipleRef:pt(e,"multiple"),valueRef:pt(e,"value"),renderLabelRef:pt(e,"renderLabel"),renderOptionRef:pt(e,"renderOption"),labelFieldRef:pt(e,"labelField"),valueFieldRef:pt(e,"valueField")}),xr(NN,a),Or(()=>{const{value:W}=s;W&&W.sync()});const U=re(()=>{const{size:W}=e,{common:{cubicBezierEaseInOut:q},self:{height:$,borderRadius:le,color:ee,groupHeaderTextColor:Q,actionDividerColor:ne,optionTextColorPressed:V,optionTextColor:ue,optionTextColorDisabled:ve,optionTextColorActive:Ce,optionOpacityDisabled:G,optionCheckColor:Z,actionTextColor:de,optionColorPending:Se,optionColorActive:we,loadingColor:_e,loadingSize:Ee,optionColorActivePending:fe,[Ze("optionFontSize",W)]:B,[Ze("optionHeight",W)]:D,[Ze("optionPadding",W)]:I}}=n.value;return{"--n-height":$,"--n-action-divider-color":ne,"--n-action-text-color":de,"--n-bezier":q,"--n-border-radius":le,"--n-color":ee,"--n-option-font-size":B,"--n-group-header-text-color":Q,"--n-option-check-color":Z,"--n-option-color-pending":Se,"--n-option-color-active":we,"--n-option-color-active-pending":fe,"--n-option-height":D,"--n-option-opacity-disabled":G,"--n-option-text-color":ue,"--n-option-text-color-active":Ce,"--n-option-text-color-disabled":ve,"--n-option-text-color-pressed":V,"--n-option-padding":I,"--n-option-padding-left":zo(I,"left"),"--n-option-padding-right":zo(I,"right"),"--n-loading-color":_e,"--n-loading-size":Ee}}),{inlineThemeDisabled:ie}=e,te=ie?Dr("internal-select-menu",re(()=>e.size[0]),U,e):void 0,X={selfRef:a,next:T,prev:R,getPendingTmNode:w};return eU(a,e.onResize),Object.assign({mergedTheme:n,mergedClsPrefix:t,rtlEnabled:i,virtualListRef:o,scrollbarRef:s,itemSize:p,padding:v,flattenedNodes:l,empty:g,virtualListContainer(){const{value:W}=o;return W==null?void 0:W.listElRef},virtualListContent(){const{value:W}=o;return W==null?void 0:W.itemsElRef},doScroll:b,handleFocusin:H,handleFocusout:N,handleKeyUp:A,handleKeyDown:M,handleMouseDown:P,handleVirtualListResize:S,handleVirtualListScroll:x,cssVars:ie?void 0:U,themeClass:te==null?void 0:te.themeClass,onRender:te==null?void 0:te.onRender},X)},render(){const{$slots:e,virtualScroll:t,clsPrefix:r,mergedTheme:i,themeClass:n,onRender:a}=this;return a==null||a(),E("div",{ref:"selfRef",tabindex:this.focusable?0:-1,class:[`${r}-base-select-menu`,this.rtlEnabled&&`${r}-base-select-menu--rtl`,n,this.multiple&&`${r}-base-select-menu--multiple`],style:this.cssVars,onFocusin:this.handleFocusin,onFocusout:this.handleFocusout,onKeyup:this.handleKeyUp,onKeydown:this.handleKeyDown,onMousedown:this.handleMouseDown,onMouseenter:this.onMouseenter,onMouseleave:this.onMouseleave},ti(e.header,o=>o&&E("div",{class:`${r}-base-select-menu__header`,"data-header":!0,key:"header"},o)),this.loading?E("div",{class:`${r}-base-select-menu__loading`},E(i0,{clsPrefix:r,strokeWidth:20})):this.empty?E("div",{class:`${r}-base-select-menu__empty`,"data-empty":!0},Cr(e.empty,()=>[E(KU,{theme:i.peers.Empty,themeOverrides:i.peerOverrides.Empty})])):E(Sn,{ref:"scrollbarRef",theme:i.peers.Scrollbar,themeOverrides:i.peerOverrides.Scrollbar,scrollable:this.scrollable,container:t?this.virtualListContainer:void 0,content:t?this.virtualListContent:void 0,onScroll:t?void 0:this.doScroll},{default:()=>t?E(fg,{ref:"virtualListRef",class:`${r}-virtual-list`,items:this.flattenedNodes,itemSize:this.itemSize,showScrollbar:!1,paddingTop:this.padding.top,paddingBottom:this.padding.bottom,onResize:this.handleVirtualListResize,onScroll:this.handleVirtualListScroll,itemResizable:!0},{default:({item:o})=>o.isGroup?E(gR,{key:o.key,clsPrefix:r,tmNode:o}):o.ignored?null:E(vR,{clsPrefix:r,key:o.key,tmNode:o})}):E("div",{class:`${r}-base-select-menu-option-wrapper`,style:{paddingTop:this.padding.top,paddingBottom:this.padding.bottom}},this.flattenedNodes.map(o=>o.isGroup?E(gR,{key:o.key,clsPrefix:r,tmNode:o}):E(vR,{clsPrefix:r,key:o.key,tmNode:o})))}),ti(e.action,o=>o&&[E("div",{class:`${r}-base-select-menu__action`,"data-action":!0,key:"action"},o),E(Qu,{onFocus:this.onTabOut,key:"focus-detector"})]))}}),Aie=oe("base-wave",`
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 border-radius: inherit;
`),Mie=je({name:"BaseWave",props:{clsPrefix:{type:String,required:!0}},setup(e){Ph("-base-wave",Aie,pt(e,"clsPrefix"));const t=me(null),r=me(!1);let i=null;return la(()=>{i!==null&&window.clearTimeout(i)}),{active:r,selfRef:t,play(){i!==null&&(window.clearTimeout(i),r.value=!1,i=null),aa(()=>{var n;(n=t.value)===null||n===void 0||n.offsetHeight,r.value=!0,i=window.setTimeout(()=>{r.value=!1,i=null},1e3)})}}},render(){const{clsPrefix:e}=this;return E("div",{ref:"selfRef","aria-hidden":!0,class:[`${e}-base-wave`,this.active&&`${e}-base-wave--active`]})}}),Eie={space:"6px",spaceArrow:"10px",arrowOffset:"10px",arrowOffsetVertical:"10px",arrowHeight:"6px",padding:"8px 14px"},Tie=e=>{const{boxShadow2:t,popoverColor:r,textColor2:i,borderRadius:n,fontSize:a,dividerColor:o}=e;return Object.assign(Object.assign({},Eie),{fontSize:a,borderRadius:n,color:r,dividerColor:o,textColor:i,boxShadow:t})},uw={name:"Popover",common:$r,self:Tie},DS={top:"bottom",bottom:"top",left:"right",right:"left"},hn="var(--n-arrow-height) * 1.414",Pie=ge([oe("popover",`
 transition:
 box-shadow .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
 position: relative;
 font-size: var(--n-font-size);
 color: var(--n-text-color);
 box-shadow: var(--n-box-shadow);
 word-break: break-word;
 `,[ge(">",[oe("scrollbar",`
 height: inherit;
 max-height: inherit;
 `)]),br("raw",`
 background-color: var(--n-color);
 border-radius: var(--n-border-radius);
 `,[br("scrollable",[br("show-header-or-footer","padding: var(--n-padding);")])]),he("header",`
 padding: var(--n-padding);
 border-bottom: 1px solid var(--n-divider-color);
 transition: border-color .3s var(--n-bezier);
 `),he("footer",`
 padding: var(--n-padding);
 border-top: 1px solid var(--n-divider-color);
 transition: border-color .3s var(--n-bezier);
 `),xe("scrollable, show-header-or-footer",[he("content",`
 padding: var(--n-padding);
 `)])]),oe("popover-shared",`
 transform-origin: inherit;
 `,[oe("popover-arrow-wrapper",`
 position: absolute;
 overflow: hidden;
 pointer-events: none;
 `,[oe("popover-arrow",`
 transition: background-color .3s var(--n-bezier);
 position: absolute;
 display: block;
 width: calc(${hn});
 height: calc(${hn});
 box-shadow: 0 0 8px 0 rgba(0, 0, 0, .12);
 transform: rotate(45deg);
 background-color: var(--n-color);
 pointer-events: all;
 `)]),ge("&.popover-transition-enter-from, &.popover-transition-leave-to",`
 opacity: 0;
 transform: scale(.85);
 `),ge("&.popover-transition-enter-to, &.popover-transition-leave-from",`
 transform: scale(1);
 opacity: 1;
 `),ge("&.popover-transition-enter-active",`
 transition:
 box-shadow .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier),
 opacity .15s var(--n-bezier-ease-out),
 transform .15s var(--n-bezier-ease-out);
 `),ge("&.popover-transition-leave-active",`
 transition:
 box-shadow .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier),
 opacity .15s var(--n-bezier-ease-in),
 transform .15s var(--n-bezier-ease-in);
 `)]),xo("top-start",`
 top: calc(${hn} / -2);
 left: calc(${Al("top-start")} - var(--v-offset-left));
 `),xo("top",`
 top: calc(${hn} / -2);
 transform: translateX(calc(${hn} / -2)) rotate(45deg);
 left: 50%;
 `),xo("top-end",`
 top: calc(${hn} / -2);
 right: calc(${Al("top-end")} + var(--v-offset-left));
 `),xo("bottom-start",`
 bottom: calc(${hn} / -2);
 left: calc(${Al("bottom-start")} - var(--v-offset-left));
 `),xo("bottom",`
 bottom: calc(${hn} / -2);
 transform: translateX(calc(${hn} / -2)) rotate(45deg);
 left: 50%;
 `),xo("bottom-end",`
 bottom: calc(${hn} / -2);
 right: calc(${Al("bottom-end")} + var(--v-offset-left));
 `),xo("left-start",`
 left: calc(${hn} / -2);
 top: calc(${Al("left-start")} - var(--v-offset-top));
 `),xo("left",`
 left: calc(${hn} / -2);
 transform: translateY(calc(${hn} / -2)) rotate(45deg);
 top: 50%;
 `),xo("left-end",`
 left: calc(${hn} / -2);
 bottom: calc(${Al("left-end")} + var(--v-offset-top));
 `),xo("right-start",`
 right: calc(${hn} / -2);
 top: calc(${Al("right-start")} - var(--v-offset-top));
 `),xo("right",`
 right: calc(${hn} / -2);
 transform: translateY(calc(${hn} / -2)) rotate(45deg);
 top: 50%;
 `),xo("right-end",`
 right: calc(${hn} / -2);
 bottom: calc(${Al("right-end")} + var(--v-offset-top));
 `),...JJ({top:["right-start","left-start"],right:["top-end","bottom-end"],bottom:["right-end","left-end"],left:["top-start","bottom-start"]},(e,t)=>{const r=["right","left"].includes(t),i=r?"width":"height";return e.map(n=>{const a=n.split("-")[1]==="end",s=`calc((${`var(--v-target-${i}, 0px)`} - ${hn}) / 2)`,l=Al(n);return ge(`[v-placement="${n}"] >`,[oe("popover-shared",[xe("center-arrow",[oe("popover-arrow",`${t}: calc(max(${s}, ${l}) ${a?"+":"-"} var(--v-offset-${r?"left":"top"}));`)])])])})})]);function Al(e){return["top","bottom"].includes(e.split("-")[0])?"var(--n-arrow-offset)":"var(--n-arrow-offset-vertical)"}function xo(e,t){const r=e.split("-")[0],i=["top","bottom"].includes(r)?"height: var(--n-space-arrow);":"width: var(--n-space-arrow);";return ge(`[v-placement="${e}"] >`,[oe("popover-shared",`
 margin-${DS[r]}: var(--n-space);
 `,[xe("show-arrow",`
 margin-${DS[r]}: var(--n-space-arrow);
 `),xe("overlap",`
 margin: 0;
 `),dY("popover-arrow-wrapper",`
 right: 0;
 left: 0;
 top: 0;
 bottom: 0;
 ${r}: 100%;
 ${DS[r]}: auto;
 ${i}
 `,[oe("popover-arrow",t)])])])}const JU=Object.assign(Object.assign({},bt.props),{to:Wn.propTo,show:Boolean,trigger:String,showArrow:Boolean,delay:Number,duration:Number,raw:Boolean,arrowPointToCenter:Boolean,arrowClass:String,arrowStyle:[String,Object],arrowWrapperClass:String,arrowWrapperStyle:[String,Object],displayDirective:String,x:Number,y:Number,flip:Boolean,overlap:Boolean,placement:String,width:[Number,String],keepAliveOnHover:Boolean,scrollable:Boolean,contentClass:String,contentStyle:[Object,String],headerClass:String,headerStyle:[Object,String],footerClass:String,footerStyle:[Object,String],internalDeactivateImmediately:Boolean,animated:Boolean,onClickoutside:Function,internalTrapFocus:Boolean,internalOnAfterLeave:Function,minWidth:Number,maxWidth:Number}),e6=({arrowClass:e,arrowStyle:t,arrowWrapperClass:r,arrowWrapperStyle:i,clsPrefix:n})=>E("div",{key:"__popover-arrow__",style:i,class:[`${n}-popover-arrow-wrapper`,r]},E("div",{class:[`${n}-popover-arrow`,e],style:t})),Die=je({name:"PopoverBody",inheritAttrs:!1,props:JU,setup(e,{slots:t,attrs:r}){const{namespaceRef:i,mergedClsPrefixRef:n,inlineThemeDisabled:a}=vr(e),o=bt("Popover","-popover",Pie,uw,e,n),s=me(null),l=_t("NPopover"),c=me(null),u=me(e.show),d=me(!1);no(()=>{const{show:_}=e;_&&!hY()&&!e.internalDeactivateImmediately&&(d.value=!0)});const h=re(()=>{const{trigger:_,onClickoutside:C}=e,A=[],{positionManuallyRef:{value:M}}=l;return M||(_==="click"&&!C&&A.push([Ru,x,void 0,{capture:!0}]),_==="hover"&&A.push([DY,b])),C&&A.push([Ru,x,void 0,{capture:!0}]),(e.displayDirective==="show"||e.animated&&d.value)&&A.push([nh,e.show]),A}),f=re(()=>{const _=e.width==="trigger"?void 0:fs(e.width),C=[];_&&C.push({width:_});const{maxWidth:A,minWidth:M}=e;return A&&C.push({maxWidth:fs(A)}),M&&C.push({maxWidth:fs(M)}),a||C.push(p.value),C}),p=re(()=>{const{common:{cubicBezierEaseInOut:_,cubicBezierEaseIn:C,cubicBezierEaseOut:A},self:{space:M,spaceArrow:P,padding:T,fontSize:R,textColor:z,dividerColor:F,color:H,boxShadow:N,borderRadius:U,arrowHeight:ie,arrowOffset:te,arrowOffsetVertical:X}}=o.value;return{"--n-box-shadow":N,"--n-bezier":_,"--n-bezier-ease-in":C,"--n-bezier-ease-out":A,"--n-font-size":R,"--n-text-color":z,"--n-color":H,"--n-divider-color":F,"--n-border-radius":U,"--n-arrow-height":ie,"--n-arrow-offset":te,"--n-arrow-offset-vertical":X,"--n-padding":T,"--n-space":M,"--n-space-arrow":P}}),v=a?Dr("popover",void 0,p,e):void 0;l.setBodyInstance({syncPosition:m}),la(()=>{l.setBodyInstance(null)}),rr(pt(e,"show"),_=>{e.animated||(_?u.value=!0:u.value=!1)});function m(){var _;(_=s.value)===null||_===void 0||_.syncPosition()}function g(_){e.trigger==="hover"&&e.keepAliveOnHover&&e.show&&l.handleMouseEnter(_)}function y(_){e.trigger==="hover"&&e.keepAliveOnHover&&l.handleMouseLeave(_)}function b(_){e.trigger==="hover"&&!S().contains(lc(_))&&l.handleMouseMoveOutside(_)}function x(_){(e.trigger==="click"&&!S().contains(lc(_))||e.onClickoutside)&&l.handleClickOutside(_)}function S(){return l.getTriggerElement()}xr(iw,c),xr(kT,null),xr(zT,null);function w(){if(v==null||v.onRender(),!(e.displayDirective==="show"||e.show||e.animated&&d.value))return null;let C;const A=l.internalRenderBodyRef.value,{value:M}=n;if(A)C=A([`${M}-popover-shared`,v==null?void 0:v.themeClass.value,e.overlap&&`${M}-popover-shared--overlap`,e.showArrow&&`${M}-popover-shared--show-arrow`,e.arrowPointToCenter&&`${M}-popover-shared--center-arrow`],c,f.value,g,y);else{const{value:P}=l.extraClassRef,{internalTrapFocus:T}=e,R=!Jf(t.header)||!Jf(t.footer),z=()=>{var F,H;const N=R?E(mr,null,ti(t.header,te=>te?E("div",{class:[`${M}-popover__header`,e.headerClass],style:e.headerStyle},te):null),ti(t.default,te=>te?E("div",{class:[`${M}-popover__content`,e.contentClass],style:e.contentStyle},t):null),ti(t.footer,te=>te?E("div",{class:[`${M}-popover__footer`,e.footerClass],style:e.footerStyle},te):null)):e.scrollable?(F=t.default)===null||F===void 0?void 0:F.call(t):E("div",{class:[`${M}-popover__content`,e.contentClass],style:e.contentStyle},t),U=e.scrollable?E(QU,{contentClass:R?void 0:`${M}-popover__content ${(H=e.contentClass)!==null&&H!==void 0?H:""}`,contentStyle:R?void 0:e.contentStyle},{default:()=>N}):N,ie=e.showArrow?e6({arrowClass:e.arrowClass,arrowStyle:e.arrowStyle,arrowWrapperClass:e.arrowWrapperClass,arrowWrapperStyle:e.arrowWrapperStyle,clsPrefix:M}):null;return[U,ie]};C=E("div",$u({class:[`${M}-popover`,`${M}-popover-shared`,v==null?void 0:v.themeClass.value,P.map(F=>`${M}-${F}`),{[`${M}-popover--scrollable`]:e.scrollable,[`${M}-popover--show-header-or-footer`]:R,[`${M}-popover--raw`]:e.raw,[`${M}-popover-shared--overlap`]:e.overlap,[`${M}-popover-shared--show-arrow`]:e.showArrow,[`${M}-popover-shared--center-arrow`]:e.arrowPointToCenter}],ref:c,style:f.value,onKeydown:l.handleKeydown,onMouseenter:g,onMouseleave:y},r),T?E(xX,{active:e.show,autoFocus:!0},{default:z}):z())}return io(C,h.value)}return{displayed:d,namespace:i,isMounted:l.isMountedRef,zIndex:l.zIndexRef,followerRef:s,adjustedTo:Wn(e),followerEnabled:u,renderContentNode:w}},render(){return E(Ch,{ref:"followerRef",zIndex:this.zIndex,show:this.show,enabled:this.followerEnabled,to:this.adjustedTo,x:this.x,y:this.y,flip:this.flip,placement:this.placement,containerClass:this.namespace,overlap:this.overlap,width:this.width==="trigger"?"target":void 0,teleportDisabled:this.adjustedTo===Wn.tdkey},{default:()=>this.animated?E(La,{name:"popover-transition",appear:this.isMounted,onEnter:()=>{this.followerEnabled=!0},onAfterLeave:()=>{var e;(e=this.internalOnAfterLeave)===null||e===void 0||e.call(this),this.followerEnabled=!1,this.displayed=!1}},{default:this.renderContentNode}):this.renderContentNode()})}}),Oie=Object.keys(JU),Rie={focus:["onFocus","onBlur"],click:["onClick"],hover:["onMouseenter","onMouseleave"],manual:[],nested:["onFocus","onBlur","onMouseenter","onMouseleave","onClick"]};function Iie(e,t,r){Rie[t].forEach(i=>{e.props?e.props=Object.assign({},e.props):e.props={};const n=e.props[i],a=r[i];n?e.props[i]=(...o)=>{n(...o),a(...o)}:e.props[i]=a})}const dw={show:{type:Boolean,default:void 0},defaultShow:Boolean,showArrow:{type:Boolean,default:!0},trigger:{type:String,default:"hover"},delay:{type:Number,default:100},duration:{type:Number,default:100},raw:Boolean,placement:{type:String,default:"top"},x:Number,y:Number,arrowPointToCenter:Boolean,disabled:Boolean,getDisabled:Function,displayDirective:{type:String,default:"if"},arrowClass:String,arrowStyle:[String,Object],arrowWrapperClass:String,arrowWrapperStyle:[String,Object],flip:{type:Boolean,default:!0},animated:{type:Boolean,default:!0},width:{type:[Number,String],default:void 0},overlap:Boolean,keepAliveOnHover:{type:Boolean,default:!0},zIndex:Number,to:Wn.propTo,scrollable:Boolean,contentClass:String,contentStyle:[Object,String],headerClass:String,headerStyle:[Object,String],footerClass:String,footerStyle:[Object,String],onClickoutside:Function,"onUpdate:show":[Function,Array],onUpdateShow:[Function,Array],internalDeactivateImmediately:Boolean,internalSyncTargetWithParent:Boolean,internalInheritedEventHandlers:{type:Array,default:()=>[]},internalTrapFocus:Boolean,internalExtraClass:{type:Array,default:()=>[]},onShow:[Function,Array],onHide:[Function,Array],arrow:{type:Boolean,default:void 0},minWidth:Number,maxWidth:Number},zie=Object.assign(Object.assign(Object.assign({},bt.props),dw),{internalOnAfterLeave:Function,internalRenderBody:Function}),sP=je({name:"Popover",inheritAttrs:!1,props:zie,__popover__:!0,setup(e){const t=Yu(),r=me(null),i=re(()=>e.show),n=me(e.defaultShow),a=Hn(i,n),o=qi(()=>e.disabled?!1:a.value),s=()=>{if(e.disabled)return!0;const{getDisabled:F}=e;return!!(F!=null&&F())},l=()=>s()?!1:a.value,c=Sp(e,["arrow","showArrow"]),u=re(()=>e.overlap?!1:c.value);let d=null;const h=me(null),f=me(null),p=qi(()=>e.x!==void 0&&e.y!==void 0);function v(F){const{"onUpdate:show":H,onUpdateShow:N,onShow:U,onHide:ie}=e;n.value=F,H&&ct(H,F),N&&ct(N,F),F&&U&&ct(U,!0),F&&ie&&ct(ie,!1)}function m(){d&&d.syncPosition()}function g(){const{value:F}=h;F&&(window.clearTimeout(F),h.value=null)}function y(){const{value:F}=f;F&&(window.clearTimeout(F),f.value=null)}function b(){const F=s();if(e.trigger==="focus"&&!F){if(l())return;v(!0)}}function x(){const F=s();if(e.trigger==="focus"&&!F){if(!l())return;v(!1)}}function S(){const F=s();if(e.trigger==="hover"&&!F){if(y(),h.value!==null||l())return;const H=()=>{v(!0),h.value=null},{delay:N}=e;N===0?H():h.value=window.setTimeout(H,N)}}function w(){const F=s();if(e.trigger==="hover"&&!F){if(g(),f.value!==null||!l())return;const H=()=>{v(!1),f.value=null},{duration:N}=e;N===0?H():f.value=window.setTimeout(H,N)}}function _(){w()}function C(F){var H;l()&&(e.trigger==="click"&&(g(),y(),v(!1)),(H=e.onClickoutside)===null||H===void 0||H.call(e,F))}function A(){if(e.trigger==="click"&&!s()){g(),y();const F=!l();v(F)}}function M(F){e.internalTrapFocus&&F.key==="Escape"&&(g(),y(),v(!1))}function P(F){n.value=F}function T(){var F;return(F=r.value)===null||F===void 0?void 0:F.targetRef}function R(F){d=F}return xr("NPopover",{getTriggerElement:T,handleKeydown:M,handleMouseEnter:S,handleMouseLeave:w,handleClickOutside:C,handleMouseMoveOutside:_,setBodyInstance:R,positionManuallyRef:p,isMountedRef:t,zIndexRef:pt(e,"zIndex"),extraClassRef:pt(e,"internalExtraClass"),internalRenderBodyRef:pt(e,"internalRenderBody")}),no(()=>{a.value&&s()&&v(!1)}),{binderInstRef:r,positionManually:p,mergedShowConsideringDisabledProp:o,uncontrolledShow:n,mergedShowArrow:u,getMergedShow:l,setShow:P,handleClick:A,handleMouseEnter:S,handleMouseLeave:w,handleFocus:b,handleBlur:x,syncPosition:m}},render(){var e;const{positionManually:t,$slots:r}=this;let i,n=!1;if(!t&&(r.activator?i=A2(r,"activator"):i=A2(r,"trigger"),i)){i=hl(i),i=i.type===Zg?E("span",[i]):i;const a={onClick:this.handleClick,onMouseenter:this.handleMouseEnter,onMouseleave:this.handleMouseLeave,onFocus:this.handleFocus,onBlur:this.handleBlur};if(!((e=i.type)===null||e===void 0)&&e.__popover__)n=!0,i.props||(i.props={internalSyncTargetWithParent:!0,internalInheritedEventHandlers:[]}),i.props.internalSyncTargetWithParent=!0,i.props.internalInheritedEventHandlers?i.props.internalInheritedEventHandlers=[a,...i.props.internalInheritedEventHandlers]:i.props.internalInheritedEventHandlers=[a];else{const{internalInheritedEventHandlers:o}=this,s=[a,...o],l={onBlur:c=>{s.forEach(u=>{u.onBlur(c)})},onFocus:c=>{s.forEach(u=>{u.onFocus(c)})},onClick:c=>{s.forEach(u=>{u.onClick(c)})},onMouseenter:c=>{s.forEach(u=>{u.onMouseenter(c)})},onMouseleave:c=>{s.forEach(u=>{u.onMouseleave(c)})}};Iie(i,o?"nested":t?"manual":this.trigger,l)}}return E(wh,{ref:"binderInstRef",syncTarget:!n,syncTargetWithParent:this.internalSyncTargetWithParent},{default:()=>{this.mergedShowConsideringDisabledProp;const a=this.getMergedShow();return[this.internalTrapFocus&&a?io(E("div",{style:{position:"fixed",inset:0}}),[[HN,{enabled:a,zIndex:this.zIndex}]]):null,t?null:E(Sh,null,{default:()=>i}),E(Die,zv(this.$props,Oie,Object.assign(Object.assign({},this.$attrs),{showArrow:this.mergedShowArrow,show:a})),{default:()=>{var o,s;return(s=(o=this.$slots).default)===null||s===void 0?void 0:s.call(o)},header:()=>{var o,s;return(s=(o=this.$slots).header)===null||s===void 0?void 0:s.call(o)},footer:()=>{var o,s;return(s=(o=this.$slots).footer)===null||s===void 0?void 0:s.call(o)}})]}})}}),kie={closeIconSizeTiny:"12px",closeIconSizeSmall:"12px",closeIconSizeMedium:"14px",closeIconSizeLarge:"14px",closeSizeTiny:"16px",closeSizeSmall:"16px",closeSizeMedium:"18px",closeSizeLarge:"18px",padding:"0 7px",closeMargin:"0 0 0 4px"},Lie=e=>{const{textColor2:t,primaryColorHover:r,primaryColorPressed:i,primaryColor:n,infoColor:a,successColor:o,warningColor:s,errorColor:l,baseColor:c,borderColor:u,opacityDisabled:d,tagColor:h,closeIconColor:f,closeIconColorHover:p,closeIconColorPressed:v,borderRadiusSmall:m,fontSizeMini:g,fontSizeTiny:y,fontSizeSmall:b,fontSizeMedium:x,heightMini:S,heightTiny:w,heightSmall:_,heightMedium:C,closeColorHover:A,closeColorPressed:M,buttonColor2Hover:P,buttonColor2Pressed:T,fontWeightStrong:R}=e;return Object.assign(Object.assign({},kie),{closeBorderRadius:m,heightTiny:S,heightSmall:w,heightMedium:_,heightLarge:C,borderRadius:m,opacityDisabled:d,fontSizeTiny:g,fontSizeSmall:y,fontSizeMedium:b,fontSizeLarge:x,fontWeightStrong:R,textColorCheckable:t,textColorHoverCheckable:t,textColorPressedCheckable:t,textColorChecked:c,colorCheckable:"#0000",colorHoverCheckable:P,colorPressedCheckable:T,colorChecked:n,colorCheckedHover:r,colorCheckedPressed:i,border:`1px solid ${u}`,textColor:t,color:h,colorBordered:"rgb(250, 250, 252)",closeIconColor:f,closeIconColorHover:p,closeIconColorPressed:v,closeColorHover:A,closeColorPressed:M,borderPrimary:`1px solid ${Xt(n,{alpha:.3})}`,textColorPrimary:n,colorPrimary:Xt(n,{alpha:.12}),colorBorderedPrimary:Xt(n,{alpha:.1}),closeIconColorPrimary:n,closeIconColorHoverPrimary:n,closeIconColorPressedPrimary:n,closeColorHoverPrimary:Xt(n,{alpha:.12}),closeColorPressedPrimary:Xt(n,{alpha:.18}),borderInfo:`1px solid ${Xt(a,{alpha:.3})}`,textColorInfo:a,colorInfo:Xt(a,{alpha:.12}),colorBorderedInfo:Xt(a,{alpha:.1}),closeIconColorInfo:a,closeIconColorHoverInfo:a,closeIconColorPressedInfo:a,closeColorHoverInfo:Xt(a,{alpha:.12}),closeColorPressedInfo:Xt(a,{alpha:.18}),borderSuccess:`1px solid ${Xt(o,{alpha:.3})}`,textColorSuccess:o,colorSuccess:Xt(o,{alpha:.12}),colorBorderedSuccess:Xt(o,{alpha:.1}),closeIconColorSuccess:o,closeIconColorHoverSuccess:o,closeIconColorPressedSuccess:o,closeColorHoverSuccess:Xt(o,{alpha:.12}),closeColorPressedSuccess:Xt(o,{alpha:.18}),borderWarning:`1px solid ${Xt(s,{alpha:.35})}`,textColorWarning:s,colorWarning:Xt(s,{alpha:.15}),colorBorderedWarning:Xt(s,{alpha:.12}),closeIconColorWarning:s,closeIconColorHoverWarning:s,closeIconColorPressedWarning:s,closeColorHoverWarning:Xt(s,{alpha:.12}),closeColorPressedWarning:Xt(s,{alpha:.18}),borderError:`1px solid ${Xt(l,{alpha:.23})}`,textColorError:l,colorError:Xt(l,{alpha:.1}),colorBorderedError:Xt(l,{alpha:.08}),closeIconColorError:l,closeIconColorHoverError:l,closeIconColorPressedError:l,closeColorHoverError:Xt(l,{alpha:.12}),closeColorPressedError:Xt(l,{alpha:.18})})},Bie={name:"Tag",common:$r,self:Lie},Fie={color:Object,type:{type:String,default:"default"},round:Boolean,size:{type:String,default:"medium"},closable:Boolean,disabled:{type:Boolean,default:void 0}},Nie=oe("tag",`
 --n-close-margin: var(--n-close-margin-top) var(--n-close-margin-right) var(--n-close-margin-bottom) var(--n-close-margin-left);
 white-space: nowrap;
 position: relative;
 box-sizing: border-box;
 cursor: default;
 display: inline-flex;
 align-items: center;
 flex-wrap: nowrap;
 padding: var(--n-padding);
 border-radius: var(--n-border-radius);
 color: var(--n-text-color);
 background-color: var(--n-color);
 transition: 
 border-color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier),
 box-shadow .3s var(--n-bezier),
 opacity .3s var(--n-bezier);
 line-height: 1;
 height: var(--n-height);
 font-size: var(--n-font-size);
`,[xe("strong",`
 font-weight: var(--n-font-weight-strong);
 `),he("border",`
 pointer-events: none;
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 border-radius: inherit;
 border: var(--n-border);
 transition: border-color .3s var(--n-bezier);
 `),he("icon",`
 display: flex;
 margin: 0 4px 0 0;
 color: var(--n-text-color);
 transition: color .3s var(--n-bezier);
 font-size: var(--n-avatar-size-override);
 `),he("avatar",`
 display: flex;
 margin: 0 6px 0 0;
 `),he("close",`
 margin: var(--n-close-margin);
 transition:
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
 `),xe("round",`
 padding: 0 calc(var(--n-height) / 3);
 border-radius: calc(var(--n-height) / 2);
 `,[he("icon",`
 margin: 0 4px 0 calc((var(--n-height) - 8px) / -2);
 `),he("avatar",`
 margin: 0 6px 0 calc((var(--n-height) - 8px) / -2);
 `),xe("closable",`
 padding: 0 calc(var(--n-height) / 4) 0 calc(var(--n-height) / 3);
 `)]),xe("icon, avatar",[xe("round",`
 padding: 0 calc(var(--n-height) / 3) 0 calc(var(--n-height) / 2);
 `)]),xe("disabled",`
 cursor: not-allowed !important;
 opacity: var(--n-opacity-disabled);
 `),xe("checkable",`
 cursor: pointer;
 box-shadow: none;
 color: var(--n-text-color-checkable);
 background-color: var(--n-color-checkable);
 `,[br("disabled",[ge("&:hover","background-color: var(--n-color-hover-checkable);",[br("checked","color: var(--n-text-color-hover-checkable);")]),ge("&:active","background-color: var(--n-color-pressed-checkable);",[br("checked","color: var(--n-text-color-pressed-checkable);")])]),xe("checked",`
 color: var(--n-text-color-checked);
 background-color: var(--n-color-checked);
 `,[br("disabled",[ge("&:hover","background-color: var(--n-color-checked-hover);"),ge("&:active","background-color: var(--n-color-checked-pressed);")])])])]),Uie=Object.assign(Object.assign(Object.assign({},bt.props),Fie),{bordered:{type:Boolean,default:void 0},checked:Boolean,checkable:Boolean,strong:Boolean,triggerClickOnClose:Boolean,onClose:[Array,Function],onMouseenter:Function,onMouseleave:Function,"onUpdate:checked":Function,onUpdateChecked:Function,internalCloseFocusable:{type:Boolean,default:!0},internalCloseIsButtonTag:{type:Boolean,default:!0},onCheckedChange:Function}),t6="n-tag",OS=je({name:"Tag",props:Uie,setup(e){const t=me(null),{mergedBorderedRef:r,mergedClsPrefixRef:i,inlineThemeDisabled:n,mergedRtlRef:a}=vr(e),o=bt("Tag","-tag",Nie,Bie,e,i);xr(t6,{roundRef:pt(e,"round")});function s(f){if(!e.disabled&&e.checkable){const{checked:p,onCheckedChange:v,onUpdateChecked:m,"onUpdate:checked":g}=e;m&&m(!p),g&&g(!p),v&&v(!p)}}function l(f){if(e.triggerClickOnClose||f.stopPropagation(),!e.disabled){const{onClose:p}=e;p&&ct(p,f)}}const c={setTextContent(f){const{value:p}=t;p&&(p.textContent=f)}},u=oo("Tag",a,i),d=re(()=>{const{type:f,size:p,color:{color:v,textColor:m}={}}=e,{common:{cubicBezierEaseInOut:g},self:{padding:y,closeMargin:b,borderRadius:x,opacityDisabled:S,textColorCheckable:w,textColorHoverCheckable:_,textColorPressedCheckable:C,textColorChecked:A,colorCheckable:M,colorHoverCheckable:P,colorPressedCheckable:T,colorChecked:R,colorCheckedHover:z,colorCheckedPressed:F,closeBorderRadius:H,fontWeightStrong:N,[Ze("colorBordered",f)]:U,[Ze("closeSize",p)]:ie,[Ze("closeIconSize",p)]:te,[Ze("fontSize",p)]:X,[Ze("height",p)]:W,[Ze("color",f)]:q,[Ze("textColor",f)]:$,[Ze("border",f)]:le,[Ze("closeIconColor",f)]:ee,[Ze("closeIconColorHover",f)]:Q,[Ze("closeIconColorPressed",f)]:ne,[Ze("closeColorHover",f)]:V,[Ze("closeColorPressed",f)]:ue}}=o.value,ve=zo(b);return{"--n-font-weight-strong":N,"--n-avatar-size-override":`calc(${W} - 8px)`,"--n-bezier":g,"--n-border-radius":x,"--n-border":le,"--n-close-icon-size":te,"--n-close-color-pressed":ue,"--n-close-color-hover":V,"--n-close-border-radius":H,"--n-close-icon-color":ee,"--n-close-icon-color-hover":Q,"--n-close-icon-color-pressed":ne,"--n-close-icon-color-disabled":ee,"--n-close-margin-top":ve.top,"--n-close-margin-right":ve.right,"--n-close-margin-bottom":ve.bottom,"--n-close-margin-left":ve.left,"--n-close-size":ie,"--n-color":v||(r.value?U:q),"--n-color-checkable":M,"--n-color-checked":R,"--n-color-checked-hover":z,"--n-color-checked-pressed":F,"--n-color-hover-checkable":P,"--n-color-pressed-checkable":T,"--n-font-size":X,"--n-height":W,"--n-opacity-disabled":S,"--n-padding":y,"--n-text-color":m||$,"--n-text-color-checkable":w,"--n-text-color-checked":A,"--n-text-color-hover-checkable":_,"--n-text-color-pressed-checkable":C}}),h=n?Dr("tag",re(()=>{let f="";const{type:p,size:v,color:{color:m,textColor:g}={}}=e;return f+=p[0],f+=v[0],m&&(f+=`a${ug(m)}`),g&&(f+=`b${ug(g)}`),r.value&&(f+="c"),f}),d,e):void 0;return Object.assign(Object.assign({},c),{rtlEnabled:u,mergedClsPrefix:i,contentRef:t,mergedBordered:r,handleClick:s,handleCloseClick:l,cssVars:n?void 0:d,themeClass:h==null?void 0:h.themeClass,onRender:h==null?void 0:h.onRender})},render(){var e,t;const{mergedClsPrefix:r,rtlEnabled:i,closable:n,color:{borderColor:a}={},round:o,onRender:s,$slots:l}=this;s==null||s();const c=ti(l.avatar,d=>d&&E("div",{class:`${r}-tag__avatar`},d)),u=ti(l.icon,d=>d&&E("div",{class:`${r}-tag__icon`},d));return E("div",{class:[`${r}-tag`,this.themeClass,{[`${r}-tag--rtl`]:i,[`${r}-tag--strong`]:this.strong,[`${r}-tag--disabled`]:this.disabled,[`${r}-tag--checkable`]:this.checkable,[`${r}-tag--checked`]:this.checkable&&this.checked,[`${r}-tag--round`]:o,[`${r}-tag--avatar`]:c,[`${r}-tag--icon`]:u,[`${r}-tag--closable`]:n}],style:this.cssVars,onClick:this.handleClick,onMouseenter:this.onMouseenter,onMouseleave:this.onMouseleave},u||c,E("span",{class:`${r}-tag__content`,ref:"contentRef"},(t=(e=this.$slots).default)===null||t===void 0?void 0:t.call(e)),!this.checkable&&n?E(cw,{clsPrefix:r,class:`${r}-tag__close`,disabled:this.disabled,onClick:this.handleCloseClick,focusable:this.internalCloseFocusable,round:o,isButtonTag:this.internalCloseIsButtonTag,absolute:!0}):null,!this.checkable&&this.mergedBordered?E("div",{class:`${r}-tag__border`,style:{borderColor:a}}):null)}}),jie=oe("base-clear",`
 flex-shrink: 0;
 height: 1em;
 width: 1em;
 position: relative;
`,[ge(">",[he("clear",`
 font-size: var(--n-clear-size);
 height: 1em;
 width: 1em;
 cursor: pointer;
 color: var(--n-clear-color);
 transition: color .3s var(--n-bezier);
 display: flex;
 `,[ge("&:hover",`
 color: var(--n-clear-color-hover)!important;
 `),ge("&:active",`
 color: var(--n-clear-color-pressed)!important;
 `)]),he("placeholder",`
 display: flex;
 `),he("clear, placeholder",`
 position: absolute;
 left: 50%;
 top: 50%;
 transform: translateX(-50%) translateY(-50%);
 `,[ku({originalTransform:"translateX(-50%) translateY(-50%)",left:"50%",top:"50%"})])])]),Y2=je({name:"BaseClear",props:{clsPrefix:{type:String,required:!0},show:Boolean,onClear:Function},setup(e){return Ph("-base-clear",jie,pt(e,"clsPrefix")),{handleMouseDown(t){t.preventDefault()}}},render(){const{clsPrefix:e}=this;return E("div",{class:`${e}-base-clear`},E(Jp,null,{default:()=>{var t,r;return this.show?E("div",{key:"dismiss",class:`${e}-base-clear__clear`,onClick:this.onClear,onMousedown:this.handleMouseDown,"data-clear":!0},Cr(this.$slots.icon,()=>[E(Bi,{clsPrefix:e},{default:()=>E(Ore,null)})])):E("div",{key:"icon",class:`${e}-base-clear__placeholder`},(r=(t=this.$slots).placeholder)===null||r===void 0?void 0:r.call(t))}}))}}),r6=je({name:"InternalSelectionSuffix",props:{clsPrefix:{type:String,required:!0},showArrow:{type:Boolean,default:void 0},showClear:{type:Boolean,default:void 0},loading:{type:Boolean,default:!1},onClear:Function},setup(e,{slots:t}){return()=>{const{clsPrefix:r}=e;return E(i0,{clsPrefix:r,class:`${r}-base-suffix`,strokeWidth:24,scale:.85,show:e.loading},{default:()=>e.showArrow?E(Y2,{clsPrefix:r,show:e.showClear,onClear:e.onClear},{placeholder:()=>E(Bi,{clsPrefix:r,class:`${r}-base-suffix__arrow`},{default:()=>Cr(t.default,()=>[E(Dre,null)])})}):null})}}}),Vie={paddingSingle:"0 26px 0 12px",paddingMultiple:"3px 26px 0 12px",clearSize:"16px",arrowSize:"16px"},Hie=e=>{const{borderRadius:t,textColor2:r,textColorDisabled:i,inputColor:n,inputColorDisabled:a,primaryColor:o,primaryColorHover:s,warningColor:l,warningColorHover:c,errorColor:u,errorColorHover:d,borderColor:h,iconColor:f,iconColorDisabled:p,clearColor:v,clearColorHover:m,clearColorPressed:g,placeholderColor:y,placeholderColorDisabled:b,fontSizeTiny:x,fontSizeSmall:S,fontSizeMedium:w,fontSizeLarge:_,heightTiny:C,heightSmall:A,heightMedium:M,heightLarge:P}=e;return Object.assign(Object.assign({},Vie),{fontSizeTiny:x,fontSizeSmall:S,fontSizeMedium:w,fontSizeLarge:_,heightTiny:C,heightSmall:A,heightMedium:M,heightLarge:P,borderRadius:t,textColor:r,textColorDisabled:i,placeholderColor:y,placeholderColorDisabled:b,color:n,colorDisabled:a,colorActive:n,border:`1px solid ${h}`,borderHover:`1px solid ${s}`,borderActive:`1px solid ${o}`,borderFocus:`1px solid ${s}`,boxShadowHover:"none",boxShadowActive:`0 0 0 2px ${Xt(o,{alpha:.2})}`,boxShadowFocus:`0 0 0 2px ${Xt(o,{alpha:.2})}`,caretColor:o,arrowColor:f,arrowColorDisabled:p,loadingColor:o,borderWarning:`1px solid ${l}`,borderHoverWarning:`1px solid ${c}`,borderActiveWarning:`1px solid ${l}`,borderFocusWarning:`1px solid ${c}`,boxShadowHoverWarning:"none",boxShadowActiveWarning:`0 0 0 2px ${Xt(l,{alpha:.2})}`,boxShadowFocusWarning:`0 0 0 2px ${Xt(l,{alpha:.2})}`,colorActiveWarning:n,caretColorWarning:l,borderError:`1px solid ${u}`,borderHoverError:`1px solid ${d}`,borderActiveError:`1px solid ${u}`,borderFocusError:`1px solid ${d}`,boxShadowHoverError:"none",boxShadowActiveError:`0 0 0 2px ${Xt(u,{alpha:.2})}`,boxShadowFocusError:`0 0 0 2px ${Xt(u,{alpha:.2})}`,colorActiveError:n,caretColorError:u,clearColor:v,clearColorHover:m,clearColorPressed:g})},i6={name:"InternalSelection",common:$r,peers:{Popover:uw},self:Hie},Wie=ge([oe("base-selection",`
 --n-padding-single: var(--n-padding-single-top) var(--n-padding-single-right) var(--n-padding-single-bottom) var(--n-padding-single-left);
 --n-padding-multiple: var(--n-padding-multiple-top) var(--n-padding-multiple-right) var(--n-padding-multiple-bottom) var(--n-padding-multiple-left);
 position: relative;
 z-index: auto;
 box-shadow: none;
 width: 100%;
 max-width: 100%;
 display: inline-block;
 vertical-align: bottom;
 border-radius: var(--n-border-radius);
 min-height: var(--n-height);
 line-height: 1.5;
 font-size: var(--n-font-size);
 `,[oe("base-loading",`
 color: var(--n-loading-color);
 `),oe("base-selection-tags","min-height: var(--n-height);"),he("border, state-border",`
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 pointer-events: none;
 border: var(--n-border);
 border-radius: inherit;
 transition:
 box-shadow .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 `),he("state-border",`
 z-index: 1;
 border-color: #0000;
 `),oe("base-suffix",`
 cursor: pointer;
 position: absolute;
 top: 50%;
 transform: translateY(-50%);
 right: 10px;
 `,[he("arrow",`
 font-size: var(--n-arrow-size);
 color: var(--n-arrow-color);
 transition: color .3s var(--n-bezier);
 `)]),oe("base-selection-overlay",`
 display: flex;
 align-items: center;
 white-space: nowrap;
 pointer-events: none;
 position: absolute;
 top: 0;
 right: 0;
 bottom: 0;
 left: 0;
 padding: var(--n-padding-single);
 transition: color .3s var(--n-bezier);
 `,[he("wrapper",`
 flex-basis: 0;
 flex-grow: 1;
 overflow: hidden;
 text-overflow: ellipsis;
 `)]),oe("base-selection-placeholder",`
 color: var(--n-placeholder-color);
 `,[he("inner",`
 max-width: 100%;
 overflow: hidden;
 `)]),oe("base-selection-tags",`
 cursor: pointer;
 outline: none;
 box-sizing: border-box;
 position: relative;
 z-index: auto;
 display: flex;
 padding: var(--n-padding-multiple);
 flex-wrap: wrap;
 align-items: center;
 width: 100%;
 vertical-align: bottom;
 background-color: var(--n-color);
 border-radius: inherit;
 transition:
 color .3s var(--n-bezier),
 box-shadow .3s var(--n-bezier),
 background-color .3s var(--n-bezier);
 `),oe("base-selection-label",`
 height: var(--n-height);
 display: inline-flex;
 width: 100%;
 vertical-align: bottom;
 cursor: pointer;
 outline: none;
 z-index: auto;
 box-sizing: border-box;
 position: relative;
 transition:
 color .3s var(--n-bezier),
 box-shadow .3s var(--n-bezier),
 background-color .3s var(--n-bezier);
 border-radius: inherit;
 background-color: var(--n-color);
 align-items: center;
 `,[oe("base-selection-input",`
 font-size: inherit;
 line-height: inherit;
 outline: none;
 cursor: pointer;
 box-sizing: border-box;
 border:none;
 width: 100%;
 padding: var(--n-padding-single);
 background-color: #0000;
 color: var(--n-text-color);
 transition: color .3s var(--n-bezier);
 caret-color: var(--n-caret-color);
 `,[he("content",`
 text-overflow: ellipsis;
 overflow: hidden;
 white-space: nowrap; 
 `)]),he("render-label",`
 color: var(--n-text-color);
 `)]),br("disabled",[ge("&:hover",[he("state-border",`
 box-shadow: var(--n-box-shadow-hover);
 border: var(--n-border-hover);
 `)]),xe("focus",[he("state-border",`
 box-shadow: var(--n-box-shadow-focus);
 border: var(--n-border-focus);
 `)]),xe("active",[he("state-border",`
 box-shadow: var(--n-box-shadow-active);
 border: var(--n-border-active);
 `),oe("base-selection-label","background-color: var(--n-color-active);"),oe("base-selection-tags","background-color: var(--n-color-active);")])]),xe("disabled","cursor: not-allowed;",[he("arrow",`
 color: var(--n-arrow-color-disabled);
 `),oe("base-selection-label",`
 cursor: not-allowed;
 background-color: var(--n-color-disabled);
 `,[oe("base-selection-input",`
 cursor: not-allowed;
 color: var(--n-text-color-disabled);
 `),he("render-label",`
 color: var(--n-text-color-disabled);
 `)]),oe("base-selection-tags",`
 cursor: not-allowed;
 background-color: var(--n-color-disabled);
 `),oe("base-selection-placeholder",`
 cursor: not-allowed;
 color: var(--n-placeholder-color-disabled);
 `)]),oe("base-selection-input-tag",`
 height: calc(var(--n-height) - 6px);
 line-height: calc(var(--n-height) - 6px);
 outline: none;
 display: none;
 position: relative;
 margin-bottom: 3px;
 max-width: 100%;
 vertical-align: bottom;
 `,[he("input",`
 font-size: inherit;
 font-family: inherit;
 min-width: 1px;
 padding: 0;
 background-color: #0000;
 outline: none;
 border: none;
 max-width: 100%;
 overflow: hidden;
 width: 1em;
 line-height: inherit;
 cursor: pointer;
 color: var(--n-text-color);
 caret-color: var(--n-caret-color);
 `),he("mirror",`
 position: absolute;
 left: 0;
 top: 0;
 white-space: pre;
 visibility: hidden;
 user-select: none;
 -webkit-user-select: none;
 opacity: 0;
 `)]),["warning","error"].map(e=>xe(`${e}-status`,[he("state-border",`border: var(--n-border-${e});`),br("disabled",[ge("&:hover",[he("state-border",`
 box-shadow: var(--n-box-shadow-hover-${e});
 border: var(--n-border-hover-${e});
 `)]),xe("active",[he("state-border",`
 box-shadow: var(--n-box-shadow-active-${e});
 border: var(--n-border-active-${e});
 `),oe("base-selection-label",`background-color: var(--n-color-active-${e});`),oe("base-selection-tags",`background-color: var(--n-color-active-${e});`)]),xe("focus",[he("state-border",`
 box-shadow: var(--n-box-shadow-focus-${e});
 border: var(--n-border-focus-${e});
 `)])])]))]),oe("base-selection-popover",`
 margin-bottom: -3px;
 display: flex;
 flex-wrap: wrap;
 margin-right: -8px;
 `),oe("base-selection-tag-wrapper",`
 max-width: 100%;
 display: inline-flex;
 padding: 0 7px 3px 0;
 `,[ge("&:last-child","padding-right: 0;"),oe("tag",`
 font-size: 14px;
 max-width: 100%;
 `,[he("content",`
 line-height: 1.25;
 text-overflow: ellipsis;
 overflow: hidden;
 `)])])]),Gie=je({name:"InternalSelection",props:Object.assign(Object.assign({},bt.props),{clsPrefix:{type:String,required:!0},bordered:{type:Boolean,default:void 0},active:Boolean,pattern:{type:String,default:""},placeholder:String,selectedOption:{type:Object,default:null},selectedOptions:{type:Array,default:null},labelField:{type:String,default:"label"},valueField:{type:String,default:"value"},multiple:Boolean,filterable:Boolean,clearable:Boolean,disabled:Boolean,size:{type:String,default:"medium"},loading:Boolean,autofocus:Boolean,showArrow:{type:Boolean,default:!0},inputProps:Object,focused:Boolean,renderTag:Function,onKeydown:Function,onClick:Function,onBlur:Function,onFocus:Function,onDeleteOption:Function,maxTagCount:[String,Number],ellipsisTagPopoverProps:Object,onClear:Function,onPatternInput:Function,onPatternFocus:Function,onPatternBlur:Function,renderLabel:Function,status:String,inlineThemeDisabled:Boolean,ignoreComposition:{type:Boolean,default:!0},onResize:Function}),setup(e){const{mergedClsPrefixRef:t,mergedRtlRef:r}=vr(e),i=oo("InternalSelection",r,t),n=me(null),a=me(null),o=me(null),s=me(null),l=me(null),c=me(null),u=me(null),d=me(null),h=me(null),f=me(null),p=me(!1),v=me(!1),m=me(!1),g=bt("InternalSelection","-internal-selection",Wie,i6,e,pt(e,"clsPrefix")),y=re(()=>e.clearable&&!e.disabled&&(m.value||e.active)),b=re(()=>e.selectedOption?e.renderTag?e.renderTag({option:e.selectedOption,handleClose:()=>{}}):e.renderLabel?e.renderLabel(e.selectedOption,!0):Fn(e.selectedOption[e.labelField],e.selectedOption,!0):e.placeholder),x=re(()=>{const O=e.selectedOption;if(O)return O[e.labelField]}),S=re(()=>e.multiple?!!(Array.isArray(e.selectedOptions)&&e.selectedOptions.length):e.selectedOption!==null);function w(){var O;const{value:j}=n;if(j){const{value:L}=a;L&&(L.style.width=`${j.offsetWidth}px`,e.maxTagCount!=="responsive"&&((O=h.value)===null||O===void 0||O.sync({showAllItemsBeforeCalculate:!1})))}}function _(){const{value:O}=f;O&&(O.style.display="none")}function C(){const{value:O}=f;O&&(O.style.display="inline-block")}rr(pt(e,"active"),O=>{O||_()}),rr(pt(e,"pattern"),()=>{e.multiple&&aa(w)});function A(O){const{onFocus:j}=e;j&&j(O)}function M(O){const{onBlur:j}=e;j&&j(O)}function P(O){const{onDeleteOption:j}=e;j&&j(O)}function T(O){const{onClear:j}=e;j&&j(O)}function R(O){const{onPatternInput:j}=e;j&&j(O)}function z(O){var j;(!O.relatedTarget||!(!((j=o.value)===null||j===void 0)&&j.contains(O.relatedTarget)))&&A(O)}function F(O){var j;!((j=o.value)===null||j===void 0)&&j.contains(O.relatedTarget)||M(O)}function H(O){T(O)}function N(){m.value=!0}function U(){m.value=!1}function ie(O){!e.active||!e.filterable||O.target!==a.value&&O.preventDefault()}function te(O){P(O)}function X(O){if(O.key==="Backspace"&&!W.value&&!e.pattern.length){const{selectedOptions:j}=e;j!=null&&j.length&&te(j[j.length-1])}}const W=me(!1);let q=null;function $(O){const{value:j}=n;if(j){const L=O.target.value;j.textContent=L,w()}e.ignoreComposition&&W.value?q=O:R(O)}function le(){W.value=!0}function ee(){W.value=!1,e.ignoreComposition&&R(q),q=null}function Q(O){var j;v.value=!0,(j=e.onPatternFocus)===null||j===void 0||j.call(e,O)}function ne(O){var j;v.value=!1,(j=e.onPatternBlur)===null||j===void 0||j.call(e,O)}function V(){var O,j;if(e.filterable)v.value=!1,(O=c.value)===null||O===void 0||O.blur(),(j=a.value)===null||j===void 0||j.blur();else if(e.multiple){const{value:L}=s;L==null||L.blur()}else{const{value:L}=l;L==null||L.blur()}}function ue(){var O,j,L;e.filterable?(v.value=!1,(O=c.value)===null||O===void 0||O.focus()):e.multiple?(j=s.value)===null||j===void 0||j.focus():(L=l.value)===null||L===void 0||L.focus()}function ve(){const{value:O}=a;O&&(C(),O.focus())}function Ce(){const{value:O}=a;O&&O.blur()}function G(O){const{value:j}=u;j&&j.setTextContent(`+${O}`)}function Z(){const{value:O}=d;return O}function de(){return a.value}let Se=null;function we(){Se!==null&&window.clearTimeout(Se)}function _e(){e.active||(we(),Se=window.setTimeout(()=>{S.value&&(p.value=!0)},100))}function Ee(){we()}function fe(O){O||(we(),p.value=!1)}rr(S,O=>{O||(p.value=!1)}),Or(()=>{no(()=>{const O=c.value;O&&(e.disabled?O.removeAttribute("tabindex"):O.tabIndex=v.value?-1:0)})}),eU(o,e.onResize);const{inlineThemeDisabled:B}=e,D=re(()=>{const{size:O}=e,{common:{cubicBezierEaseInOut:j},self:{borderRadius:L,color:Ae,placeholderColor:We,textColor:Ve,paddingSingle:ke,paddingMultiple:et,caretColor:nt,colorDisabled:lt,textColorDisabled:ut,placeholderColorDisabled:vt,colorActive:se,boxShadowFocus:Be,boxShadowActive:Ye,boxShadowHover:pe,border:Te,borderFocus:ce,borderHover:Re,borderActive:$e,arrowColor:at,arrowColorDisabled:Yt,loadingColor:nr,colorActiveWarning:Fe,boxShadowFocusWarning:Ke,boxShadowActiveWarning:dt,boxShadowHoverWarning:Nt,borderWarning:hi,borderFocusWarning:Mi,borderHoverWarning:Mr,borderActiveWarning:De,colorActiveError:K,boxShadowFocusError:Me,boxShadowActiveError:He,boxShadowHoverError:Oe,borderError:Ne,borderFocusError:wt,borderHoverError:Rt,borderActiveError:It,clearColor:Tt,clearColorHover:fr,clearColorPressed:Jt,clearSize:Pe,arrowSize:Qe,[Ze("height",O)]:xt,[Ze("fontSize",O)]:Er}}=g.value,ui=zo(ke),Ut=zo(et);return{"--n-bezier":j,"--n-border":Te,"--n-border-active":$e,"--n-border-focus":ce,"--n-border-hover":Re,"--n-border-radius":L,"--n-box-shadow-active":Ye,"--n-box-shadow-focus":Be,"--n-box-shadow-hover":pe,"--n-caret-color":nt,"--n-color":Ae,"--n-color-active":se,"--n-color-disabled":lt,"--n-font-size":Er,"--n-height":xt,"--n-padding-single-top":ui.top,"--n-padding-multiple-top":Ut.top,"--n-padding-single-right":ui.right,"--n-padding-multiple-right":Ut.right,"--n-padding-single-left":ui.left,"--n-padding-multiple-left":Ut.left,"--n-padding-single-bottom":ui.bottom,"--n-padding-multiple-bottom":Ut.bottom,"--n-placeholder-color":We,"--n-placeholder-color-disabled":vt,"--n-text-color":Ve,"--n-text-color-disabled":ut,"--n-arrow-color":at,"--n-arrow-color-disabled":Yt,"--n-loading-color":nr,"--n-color-active-warning":Fe,"--n-box-shadow-focus-warning":Ke,"--n-box-shadow-active-warning":dt,"--n-box-shadow-hover-warning":Nt,"--n-border-warning":hi,"--n-border-focus-warning":Mi,"--n-border-hover-warning":Mr,"--n-border-active-warning":De,"--n-color-active-error":K,"--n-box-shadow-focus-error":Me,"--n-box-shadow-active-error":He,"--n-box-shadow-hover-error":Oe,"--n-border-error":Ne,"--n-border-focus-error":wt,"--n-border-hover-error":Rt,"--n-border-active-error":It,"--n-clear-size":Pe,"--n-clear-color":Tt,"--n-clear-color-hover":fr,"--n-clear-color-pressed":Jt,"--n-arrow-size":Qe}}),I=B?Dr("internal-selection",re(()=>e.size[0]),D,e):void 0;return{mergedTheme:g,mergedClearable:y,mergedClsPrefix:t,rtlEnabled:i,patternInputFocused:v,filterablePlaceholder:b,label:x,selected:S,showTagsPanel:p,isComposing:W,counterRef:u,counterWrapperRef:d,patternInputMirrorRef:n,patternInputRef:a,selfRef:o,multipleElRef:s,singleElRef:l,patternInputWrapperRef:c,overflowRef:h,inputTagElRef:f,handleMouseDown:ie,handleFocusin:z,handleClear:H,handleMouseEnter:N,handleMouseLeave:U,handleDeleteOption:te,handlePatternKeyDown:X,handlePatternInputInput:$,handlePatternInputBlur:ne,handlePatternInputFocus:Q,handleMouseEnterCounter:_e,handleMouseLeaveCounter:Ee,handleFocusout:F,handleCompositionEnd:ee,handleCompositionStart:le,onPopoverUpdateShow:fe,focus:ue,focusInput:ve,blur:V,blurInput:Ce,updateCounter:G,getCounter:Z,getTail:de,renderLabel:e.renderLabel,cssVars:B?void 0:D,themeClass:I==null?void 0:I.themeClass,onRender:I==null?void 0:I.onRender}},render(){const{status:e,multiple:t,size:r,disabled:i,filterable:n,maxTagCount:a,bordered:o,clsPrefix:s,ellipsisTagPopoverProps:l,onRender:c,renderTag:u,renderLabel:d}=this;c==null||c();const h=a==="responsive",f=typeof a=="number",p=h||f,v=E(E2,null,{default:()=>E(r6,{clsPrefix:s,loading:this.loading,showArrow:this.showArrow,showClear:this.mergedClearable&&this.selected,onClear:this.handleClear},{default:()=>{var g,y;return(y=(g=this.$slots).arrow)===null||y===void 0?void 0:y.call(g)}})});let m;if(t){const{labelField:g}=this,y=R=>E("div",{class:`${s}-base-selection-tag-wrapper`,key:R.value},u?u({option:R,handleClose:()=>{this.handleDeleteOption(R)}}):E(OS,{size:r,closable:!R.disabled,disabled:i,onClose:()=>{this.handleDeleteOption(R)},internalCloseIsButtonTag:!1,internalCloseFocusable:!1},{default:()=>d?d(R,!0):Fn(R[g],R,!0)})),b=()=>(f?this.selectedOptions.slice(0,a):this.selectedOptions).map(y),x=n?E("div",{class:`${s}-base-selection-input-tag`,ref:"inputTagElRef",key:"__input-tag__"},E("input",Object.assign({},this.inputProps,{ref:"patternInputRef",tabindex:-1,disabled:i,value:this.pattern,autofocus:this.autofocus,class:`${s}-base-selection-input-tag__input`,onBlur:this.handlePatternInputBlur,onFocus:this.handlePatternInputFocus,onKeydown:this.handlePatternKeyDown,onInput:this.handlePatternInputInput,onCompositionstart:this.handleCompositionStart,onCompositionend:this.handleCompositionEnd})),E("span",{ref:"patternInputMirrorRef",class:`${s}-base-selection-input-tag__mirror`},this.pattern)):null,S=h?()=>E("div",{class:`${s}-base-selection-tag-wrapper`,ref:"counterWrapperRef"},E(OS,{size:r,ref:"counterRef",onMouseenter:this.handleMouseEnterCounter,onMouseleave:this.handleMouseLeaveCounter,disabled:i})):void 0;let w;if(f){const R=this.selectedOptions.length-a;R>0&&(w=E("div",{class:`${s}-base-selection-tag-wrapper`,key:"__counter__"},E(OS,{size:r,ref:"counterRef",onMouseenter:this.handleMouseEnterCounter,disabled:i},{default:()=>`+${R}`})))}const _=h?n?E(I2,{ref:"overflowRef",updateCounter:this.updateCounter,getCounter:this.getCounter,getTail:this.getTail,style:{width:"100%",display:"flex",overflow:"hidden"}},{default:b,counter:S,tail:()=>x}):E(I2,{ref:"overflowRef",updateCounter:this.updateCounter,getCounter:this.getCounter,style:{width:"100%",display:"flex",overflow:"hidden"}},{default:b,counter:S}):f&&w?b().concat(w):b(),C=p?()=>E("div",{class:`${s}-base-selection-popover`},h?b():this.selectedOptions.map(y)):void 0,A=p?Object.assign({show:this.showTagsPanel,trigger:"hover",overlap:!0,placement:"top",width:"trigger",onUpdateShow:this.onPopoverUpdateShow,theme:this.mergedTheme.peers.Popover,themeOverrides:this.mergedTheme.peerOverrides.Popover},l):null,P=(this.selected?!1:this.active?!this.pattern&&!this.isComposing:!0)?E("div",{class:`${s}-base-selection-placeholder ${s}-base-selection-overlay`},E("div",{class:`${s}-base-selection-placeholder__inner`},this.placeholder)):null,T=n?E("div",{ref:"patternInputWrapperRef",class:`${s}-base-selection-tags`},_,h?null:x,v):E("div",{ref:"multipleElRef",class:`${s}-base-selection-tags`,tabindex:i?void 0:0},_,v);m=E(mr,null,p?E(sP,Object.assign({},A,{scrollable:!0,style:"max-height: calc(var(--v-target-height) * 6.6);"}),{trigger:()=>T,default:C}):T,P)}else if(n){const g=this.pattern||this.isComposing,y=this.active?!g:!this.selected,b=this.active?!1:this.selected;m=E("div",{ref:"patternInputWrapperRef",class:`${s}-base-selection-label`,title:this.patternInputFocused?void 0:_2(this.label)},E("input",Object.assign({},this.inputProps,{ref:"patternInputRef",class:`${s}-base-selection-input`,value:this.active?this.pattern:"",placeholder:"",readonly:i,disabled:i,tabindex:-1,autofocus:this.autofocus,onFocus:this.handlePatternInputFocus,onBlur:this.handlePatternInputBlur,onInput:this.handlePatternInputInput,onCompositionstart:this.handleCompositionStart,onCompositionend:this.handleCompositionEnd})),b?E("div",{class:`${s}-base-selection-label__render-label ${s}-base-selection-overlay`,key:"input"},E("div",{class:`${s}-base-selection-overlay__wrapper`},u?u({option:this.selectedOption,handleClose:()=>{}}):d?d(this.selectedOption,!0):Fn(this.label,this.selectedOption,!0))):null,y?E("div",{class:`${s}-base-selection-placeholder ${s}-base-selection-overlay`,key:"placeholder"},E("div",{class:`${s}-base-selection-overlay__wrapper`},this.filterablePlaceholder)):null,v)}else m=E("div",{ref:"singleElRef",class:`${s}-base-selection-label`,tabindex:this.disabled?void 0:0},this.label!==void 0?E("div",{class:`${s}-base-selection-input`,title:_2(this.label),key:"input"},E("div",{class:`${s}-base-selection-input__content`},u?u({option:this.selectedOption,handleClose:()=>{}}):d?d(this.selectedOption,!0):Fn(this.label,this.selectedOption,!0))):E("div",{class:`${s}-base-selection-placeholder ${s}-base-selection-overlay`,key:"placeholder"},E("div",{class:`${s}-base-selection-placeholder__inner`},this.placeholder)),v);return E("div",{ref:"selfRef",class:[`${s}-base-selection`,this.rtlEnabled&&`${s}-base-selection--rtl`,this.themeClass,e&&`${s}-base-selection--${e}-status`,{[`${s}-base-selection--active`]:this.active,[`${s}-base-selection--selected`]:this.selected||this.active&&this.pattern,[`${s}-base-selection--disabled`]:this.disabled,[`${s}-base-selection--multiple`]:this.multiple,[`${s}-base-selection--focus`]:this.focused}],style:this.cssVars,onClick:this.onClick,onMouseenter:this.handleMouseEnter,onMouseleave:this.handleMouseLeave,onKeydown:this.onKeydown,onFocusin:this.handleFocusin,onFocusout:this.handleFocusout,onMousedown:this.handleMouseDown},m,o?E("div",{class:`${s}-base-selection__border`}):null,o?E("div",{class:`${s}-base-selection__state-border`}):null)}}),{cubicBezierEaseInOut:Rc}=Ku;function $ie({duration:e=".2s",delay:t=".1s"}={}){return[ge("&.fade-in-width-expand-transition-leave-from, &.fade-in-width-expand-transition-enter-to",{opacity:1}),ge("&.fade-in-width-expand-transition-leave-to, &.fade-in-width-expand-transition-enter-from",`
 opacity: 0!important;
 margin-left: 0!important;
 margin-right: 0!important;
 `),ge("&.fade-in-width-expand-transition-leave-active",`
 overflow: hidden;
 transition:
 opacity ${e} ${Rc},
 max-width ${e} ${Rc} ${t},
 margin-left ${e} ${Rc} ${t},
 margin-right ${e} ${Rc} ${t};
 `),ge("&.fade-in-width-expand-transition-enter-active",`
 overflow: hidden;
 transition:
 opacity ${e} ${Rc} ${t},
 max-width ${e} ${Rc},
 margin-left ${e} ${Rc},
 margin-right ${e} ${Rc};
 `)]}const{cubicBezierEaseInOut:Ds,cubicBezierEaseOut:qie,cubicBezierEaseIn:Yie}=Ku;function n6({overflow:e="hidden",duration:t=".3s",originalTransition:r="",leavingDelay:i="0s",foldPadding:n=!1,enterToProps:a=void 0,leaveToProps:o=void 0,reverse:s=!1}={}){const l=s?"leave":"enter",c=s?"enter":"leave";return[ge(`&.fade-in-height-expand-transition-${c}-from,
 &.fade-in-height-expand-transition-${l}-to`,Object.assign(Object.assign({},a),{opacity:1})),ge(`&.fade-in-height-expand-transition-${c}-to,
 &.fade-in-height-expand-transition-${l}-from`,Object.assign(Object.assign({},o),{opacity:0,marginTop:"0 !important",marginBottom:"0 !important",paddingTop:n?"0 !important":void 0,paddingBottom:n?"0 !important":void 0})),ge(`&.fade-in-height-expand-transition-${c}-active`,`
 overflow: ${e};
 transition:
 max-height ${t} ${Ds} ${i},
 opacity ${t} ${qie} ${i},
 margin-top ${t} ${Ds} ${i},
 margin-bottom ${t} ${Ds} ${i},
 padding-top ${t} ${Ds} ${i},
 padding-bottom ${t} ${Ds} ${i}
 ${r?","+r:""}
 `),ge(`&.fade-in-height-expand-transition-${l}-active`,`
 overflow: ${e};
 transition:
 max-height ${t} ${Ds},
 opacity ${t} ${Yie},
 margin-top ${t} ${Ds},
 margin-bottom ${t} ${Ds},
 padding-top ${t} ${Ds},
 padding-bottom ${t} ${Ds}
 ${r?","+r:""}
 `)]}function Ax(e){return e.type==="group"}function a6(e){return e.type==="ignored"}function RS(e,t){try{return!!(1+t.toString().toLowerCase().indexOf(e.trim().toLowerCase()))}catch{return!1}}function o6(e,t){return{getIsGroup:Ax,getIgnored:a6,getKey(i){return Ax(i)?i.name||i.key||"key-required":i[e]},getChildren(i){return i[t]}}}function Xie(e,t,r,i){if(!t)return e;function n(a){if(!Array.isArray(a))return[];const o=[];for(const s of a)if(Ax(s)){const l=n(s[i]);l.length&&o.push(Object.assign({},s,{[i]:l}))}else{if(a6(s))continue;t(r,s)&&o.push(s)}return o}return n(e)}function Kie(e,t,r){const i=new Map;return e.forEach(n=>{Ax(n)?n[r].forEach(a=>{i.set(a[t],a)}):i.set(n[t],n)}),i}const Qie=qu&&"chrome"in window;qu&&navigator.userAgent.includes("Firefox");const s6=qu&&navigator.userAgent.includes("Safari")&&!Qie,Zie={paddingTiny:"0 8px",paddingSmall:"0 10px",paddingMedium:"0 12px",paddingLarge:"0 14px",clearSize:"16px"},Jie=e=>{const{textColor2:t,textColor3:r,textColorDisabled:i,primaryColor:n,primaryColorHover:a,inputColor:o,inputColorDisabled:s,borderColor:l,warningColor:c,warningColorHover:u,errorColor:d,errorColorHover:h,borderRadius:f,lineHeight:p,fontSizeTiny:v,fontSizeSmall:m,fontSizeMedium:g,fontSizeLarge:y,heightTiny:b,heightSmall:x,heightMedium:S,heightLarge:w,actionColor:_,clearColor:C,clearColorHover:A,clearColorPressed:M,placeholderColor:P,placeholderColorDisabled:T,iconColor:R,iconColorDisabled:z,iconColorHover:F,iconColorPressed:H}=e;return Object.assign(Object.assign({},Zie),{countTextColorDisabled:i,countTextColor:r,heightTiny:b,heightSmall:x,heightMedium:S,heightLarge:w,fontSizeTiny:v,fontSizeSmall:m,fontSizeMedium:g,fontSizeLarge:y,lineHeight:p,lineHeightTextarea:p,borderRadius:f,iconSize:"16px",groupLabelColor:_,groupLabelTextColor:t,textColor:t,textColorDisabled:i,textDecorationColor:t,caretColor:n,placeholderColor:P,placeholderColorDisabled:T,color:o,colorDisabled:s,colorFocus:o,groupLabelBorder:`1px solid ${l}`,border:`1px solid ${l}`,borderHover:`1px solid ${a}`,borderDisabled:`1px solid ${l}`,borderFocus:`1px solid ${a}`,boxShadowFocus:`0 0 0 2px ${Xt(n,{alpha:.2})}`,loadingColor:n,loadingColorWarning:c,borderWarning:`1px solid ${c}`,borderHoverWarning:`1px solid ${u}`,colorFocusWarning:o,borderFocusWarning:`1px solid ${u}`,boxShadowFocusWarning:`0 0 0 2px ${Xt(c,{alpha:.2})}`,caretColorWarning:c,loadingColorError:d,borderError:`1px solid ${d}`,borderHoverError:`1px solid ${h}`,colorFocusError:o,borderFocusError:`1px solid ${h}`,boxShadowFocusError:`0 0 0 2px ${Xt(d,{alpha:.2})}`,caretColorError:d,clearColor:C,clearColorHover:A,clearColorPressed:M,iconColor:R,iconColorDisabled:z,iconColorHover:F,iconColorPressed:H,suffixTextColor:t})},rm={name:"Input",common:$r,self:Jie},l6="n-input";function ene(e){let t=0;for(const r of e)t++;return t}function K0(e){return e===""||e==null}function tne(e){const t=me(null);function r(){const{value:a}=e;if(!(a!=null&&a.focus)){n();return}const{selectionStart:o,selectionEnd:s,value:l}=a;if(o==null||s==null){n();return}t.value={start:o,end:s,beforeText:l.slice(0,o),afterText:l.slice(s)}}function i(){var a;const{value:o}=t,{value:s}=e;if(!o||!s)return;const{value:l}=s,{start:c,beforeText:u,afterText:d}=o;let h=l.length;if(l.endsWith(d))h=l.length-d.length;else if(l.startsWith(u))h=u.length;else{const f=u[c-1],p=l.indexOf(f,c-1);p!==-1&&(h=p+1)}(a=s.setSelectionRange)===null||a===void 0||a.call(s,h,h)}function n(){t.value=null}return rr(e,n),{recordCursor:r,restoreCursor:i}}const xR=je({name:"InputWordCount",setup(e,{slots:t}){const{mergedValueRef:r,maxlengthRef:i,mergedClsPrefixRef:n,countGraphemesRef:a}=_t(l6),o=re(()=>{const{value:s}=r;return s===null||Array.isArray(s)?0:(a.value||ene)(s)});return()=>{const{value:s}=i,{value:l}=r;return E("span",{class:`${n.value}-input-word-count`},M2(t.default,{value:l===null||Array.isArray(l)?"":l},()=>[s===void 0?o.value:`${o.value} / ${s}`]))}}}),rne=oe("input",`
 max-width: 100%;
 cursor: text;
 line-height: 1.5;
 z-index: auto;
 outline: none;
 box-sizing: border-box;
 position: relative;
 display: inline-flex;
 border-radius: var(--n-border-radius);
 background-color: var(--n-color);
 transition: background-color .3s var(--n-bezier);
 font-size: var(--n-font-size);
 --n-padding-vertical: calc((var(--n-height) - 1.5 * var(--n-font-size)) / 2);
`,[he("input, textarea",`
 overflow: hidden;
 flex-grow: 1;
 position: relative;
 `),he("input-el, textarea-el, input-mirror, textarea-mirror, separator, placeholder",`
 box-sizing: border-box;
 font-size: inherit;
 line-height: 1.5;
 font-family: inherit;
 border: none;
 outline: none;
 background-color: #0000;
 text-align: inherit;
 transition:
 -webkit-text-fill-color .3s var(--n-bezier),
 caret-color .3s var(--n-bezier),
 color .3s var(--n-bezier),
 text-decoration-color .3s var(--n-bezier);
 `),he("input-el, textarea-el",`
 -webkit-appearance: none;
 scrollbar-width: none;
 width: 100%;
 min-width: 0;
 text-decoration-color: var(--n-text-decoration-color);
 color: var(--n-text-color);
 caret-color: var(--n-caret-color);
 background-color: transparent;
 `,[ge("&::-webkit-scrollbar, &::-webkit-scrollbar-track-piece, &::-webkit-scrollbar-thumb",`
 width: 0;
 height: 0;
 display: none;
 `),ge("&::placeholder",`
 color: #0000;
 -webkit-text-fill-color: transparent !important;
 `),ge("&:-webkit-autofill ~",[he("placeholder","display: none;")])]),xe("round",[br("textarea","border-radius: calc(var(--n-height) / 2);")]),he("placeholder",`
 pointer-events: none;
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 overflow: hidden;
 color: var(--n-placeholder-color);
 `,[ge("span",`
 width: 100%;
 display: inline-block;
 `)]),xe("textarea",[he("placeholder","overflow: visible;")]),br("autosize","width: 100%;"),xe("autosize",[he("textarea-el, input-el",`
 position: absolute;
 top: 0;
 left: 0;
 height: 100%;
 `)]),oe("input-wrapper",`
 overflow: hidden;
 display: inline-flex;
 flex-grow: 1;
 position: relative;
 padding-left: var(--n-padding-left);
 padding-right: var(--n-padding-right);
 `),he("input-mirror",`
 padding: 0;
 height: var(--n-height);
 line-height: var(--n-height);
 overflow: hidden;
 visibility: hidden;
 position: static;
 white-space: pre;
 pointer-events: none;
 `),he("input-el",`
 padding: 0;
 height: var(--n-height);
 line-height: var(--n-height);
 `,[ge("&[type=password]::-ms-reveal","display: none;"),ge("+",[he("placeholder",`
 display: flex;
 align-items: center; 
 `)])]),br("textarea",[he("placeholder","white-space: nowrap;")]),he("eye",`
 display: flex;
 align-items: center;
 justify-content: center;
 transition: color .3s var(--n-bezier);
 `),xe("textarea","width: 100%;",[oe("input-word-count",`
 position: absolute;
 right: var(--n-padding-right);
 bottom: var(--n-padding-vertical);
 `),xe("resizable",[oe("input-wrapper",`
 resize: vertical;
 min-height: var(--n-height);
 `)]),he("textarea-el, textarea-mirror, placeholder",`
 height: 100%;
 padding-left: 0;
 padding-right: 0;
 padding-top: var(--n-padding-vertical);
 padding-bottom: var(--n-padding-vertical);
 word-break: break-word;
 display: inline-block;
 vertical-align: bottom;
 box-sizing: border-box;
 line-height: var(--n-line-height-textarea);
 margin: 0;
 resize: none;
 white-space: pre-wrap;
 scroll-padding-block-end: var(--n-padding-vertical);
 `),he("textarea-mirror",`
 width: 100%;
 pointer-events: none;
 overflow: hidden;
 visibility: hidden;
 position: static;
 white-space: pre-wrap;
 overflow-wrap: break-word;
 `)]),xe("pair",[he("input-el, placeholder","text-align: center;"),he("separator",`
 display: flex;
 align-items: center;
 transition: color .3s var(--n-bezier);
 color: var(--n-text-color);
 white-space: nowrap;
 `,[oe("icon",`
 color: var(--n-icon-color);
 `),oe("base-icon",`
 color: var(--n-icon-color);
 `)])]),xe("disabled",`
 cursor: not-allowed;
 background-color: var(--n-color-disabled);
 `,[he("border","border: var(--n-border-disabled);"),he("input-el, textarea-el",`
 cursor: not-allowed;
 color: var(--n-text-color-disabled);
 text-decoration-color: var(--n-text-color-disabled);
 `),he("placeholder","color: var(--n-placeholder-color-disabled);"),he("separator","color: var(--n-text-color-disabled);",[oe("icon",`
 color: var(--n-icon-color-disabled);
 `),oe("base-icon",`
 color: var(--n-icon-color-disabled);
 `)]),oe("input-word-count",`
 color: var(--n-count-text-color-disabled);
 `),he("suffix, prefix","color: var(--n-text-color-disabled);",[oe("icon",`
 color: var(--n-icon-color-disabled);
 `),oe("internal-icon",`
 color: var(--n-icon-color-disabled);
 `)])]),br("disabled",[he("eye",`
 color: var(--n-icon-color);
 cursor: pointer;
 `,[ge("&:hover",`
 color: var(--n-icon-color-hover);
 `),ge("&:active",`
 color: var(--n-icon-color-pressed);
 `)]),ge("&:hover",[he("state-border","border: var(--n-border-hover);")]),xe("focus","background-color: var(--n-color-focus);",[he("state-border",`
 border: var(--n-border-focus);
 box-shadow: var(--n-box-shadow-focus);
 `)])]),he("border, state-border",`
 box-sizing: border-box;
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 pointer-events: none;
 border-radius: inherit;
 border: var(--n-border);
 transition:
 box-shadow .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 `),he("state-border",`
 border-color: #0000;
 z-index: 1;
 `),he("prefix","margin-right: 4px;"),he("suffix",`
 margin-left: 4px;
 `),he("suffix, prefix",`
 transition: color .3s var(--n-bezier);
 flex-wrap: nowrap;
 flex-shrink: 0;
 line-height: var(--n-height);
 white-space: nowrap;
 display: inline-flex;
 align-items: center;
 justify-content: center;
 color: var(--n-suffix-text-color);
 `,[oe("base-loading",`
 font-size: var(--n-icon-size);
 margin: 0 2px;
 color: var(--n-loading-color);
 `),oe("base-clear",`
 font-size: var(--n-icon-size);
 `,[he("placeholder",[oe("base-icon",`
 transition: color .3s var(--n-bezier);
 color: var(--n-icon-color);
 font-size: var(--n-icon-size);
 `)])]),ge(">",[oe("icon",`
 transition: color .3s var(--n-bezier);
 color: var(--n-icon-color);
 font-size: var(--n-icon-size);
 `)]),oe("base-icon",`
 font-size: var(--n-icon-size);
 `)]),oe("input-word-count",`
 pointer-events: none;
 line-height: 1.5;
 font-size: .85em;
 color: var(--n-count-text-color);
 transition: color .3s var(--n-bezier);
 margin-left: 4px;
 font-variant: tabular-nums;
 `),["warning","error"].map(e=>xe(`${e}-status`,[br("disabled",[oe("base-loading",`
 color: var(--n-loading-color-${e})
 `),he("input-el, textarea-el",`
 caret-color: var(--n-caret-color-${e});
 `),he("state-border",`
 border: var(--n-border-${e});
 `),ge("&:hover",[he("state-border",`
 border: var(--n-border-hover-${e});
 `)]),ge("&:focus",`
 background-color: var(--n-color-focus-${e});
 `,[he("state-border",`
 box-shadow: var(--n-box-shadow-focus-${e});
 border: var(--n-border-focus-${e});
 `)]),xe("focus",`
 background-color: var(--n-color-focus-${e});
 `,[he("state-border",`
 box-shadow: var(--n-box-shadow-focus-${e});
 border: var(--n-border-focus-${e});
 `)])])]))]),ine=oe("input",[xe("disabled",[he("input-el, textarea-el",`
 -webkit-text-fill-color: var(--n-text-color-disabled);
 `)])]),nne=Object.assign(Object.assign({},bt.props),{bordered:{type:Boolean,default:void 0},type:{type:String,default:"text"},placeholder:[Array,String],defaultValue:{type:[String,Array],default:null},value:[String,Array],disabled:{type:Boolean,default:void 0},size:String,rows:{type:[Number,String],default:3},round:Boolean,minlength:[String,Number],maxlength:[String,Number],clearable:Boolean,autosize:{type:[Boolean,Object],default:!1},pair:Boolean,separator:String,readonly:{type:[String,Boolean],default:!1},passivelyActivated:Boolean,showPasswordOn:String,stateful:{type:Boolean,default:!0},autofocus:Boolean,inputProps:Object,resizable:{type:Boolean,default:!0},showCount:Boolean,loading:{type:Boolean,default:void 0},allowInput:Function,renderCount:Function,onMousedown:Function,onKeydown:Function,onKeyup:[Function,Array],onInput:[Function,Array],onFocus:[Function,Array],onBlur:[Function,Array],onClick:[Function,Array],onChange:[Function,Array],onClear:[Function,Array],countGraphemes:Function,status:String,"onUpdate:value":[Function,Array],onUpdateValue:[Function,Array],textDecoration:[String,Array],attrSize:{type:Number,default:20},onInputBlur:[Function,Array],onInputFocus:[Function,Array],onDeactivate:[Function,Array],onActivate:[Function,Array],onWrapperFocus:[Function,Array],onWrapperBlur:[Function,Array],internalDeactivateOnEnter:Boolean,internalForceFocus:Boolean,internalLoadingBeforeSuffix:{type:Boolean,default:!0},showPasswordToggle:Boolean}),ur=je({name:"Input",props:nne,setup(e){const{mergedClsPrefixRef:t,mergedBorderedRef:r,inlineThemeDisabled:i,mergedRtlRef:n}=vr(e),a=bt("Input","-input",rne,rm,e,t);s6&&Ph("-input-safari",ine,t);const o=me(null),s=me(null),l=me(null),c=me(null),u=me(null),d=me(null),h=me(null),f=tne(h),p=me(null),{localeRef:v}=wc("Input"),m=me(e.defaultValue),g=pt(e,"value"),y=Hn(g,m),b=gl(e),{mergedSizeRef:x,mergedDisabledRef:S,mergedStatusRef:w}=b,_=me(!1),C=me(!1),A=me(!1),M=me(!1);let P=null;const T=re(()=>{const{placeholder:De,pair:K}=e;return K?Array.isArray(De)?De:De===void 0?["",""]:[De,De]:De===void 0?[v.value.placeholder]:[De]}),R=re(()=>{const{value:De}=A,{value:K}=y,{value:Me}=T;return!De&&(K0(K)||Array.isArray(K)&&K0(K[0]))&&Me[0]}),z=re(()=>{const{value:De}=A,{value:K}=y,{value:Me}=T;return!De&&Me[1]&&(K0(K)||Array.isArray(K)&&K0(K[1]))}),F=qi(()=>e.internalForceFocus||_.value),H=qi(()=>{if(S.value||e.readonly||!e.clearable||!F.value&&!C.value)return!1;const{value:De}=y,{value:K}=F;return e.pair?!!(Array.isArray(De)&&(De[0]||De[1]))&&(C.value||K):!!De&&(C.value||K)}),N=re(()=>{const{showPasswordOn:De}=e;if(De)return De;if(e.showPasswordToggle)return"click"}),U=me(!1),ie=re(()=>{const{textDecoration:De}=e;return De?Array.isArray(De)?De.map(K=>({textDecoration:K})):[{textDecoration:De}]:["",""]}),te=me(void 0),X=()=>{var De,K;if(e.type==="textarea"){const{autosize:Me}=e;if(Me&&(te.value=(K=(De=p.value)===null||De===void 0?void 0:De.$el)===null||K===void 0?void 0:K.offsetWidth),!s.value||typeof Me=="boolean")return;const{paddingTop:He,paddingBottom:Oe,lineHeight:Ne}=window.getComputedStyle(s.value),wt=Number(He.slice(0,-2)),Rt=Number(Oe.slice(0,-2)),It=Number(Ne.slice(0,-2)),{value:Tt}=l;if(!Tt)return;if(Me.minRows){const fr=Math.max(Me.minRows,1),Jt=`${wt+Rt+It*fr}px`;Tt.style.minHeight=Jt}if(Me.maxRows){const fr=`${wt+Rt+It*Me.maxRows}px`;Tt.style.maxHeight=fr}}},W=re(()=>{const{maxlength:De}=e;return De===void 0?void 0:Number(De)});Or(()=>{const{value:De}=y;Array.isArray(De)||at(De)});const q=xh().proxy;function $(De,K){const{onUpdateValue:Me,"onUpdate:value":He,onInput:Oe}=e,{nTriggerFormInput:Ne}=b;Me&&ct(Me,De,K),He&&ct(He,De,K),Oe&&ct(Oe,De,K),m.value=De,Ne()}function le(De,K){const{onChange:Me}=e,{nTriggerFormChange:He}=b;Me&&ct(Me,De,K),m.value=De,He()}function ee(De){const{onBlur:K}=e,{nTriggerFormBlur:Me}=b;K&&ct(K,De),Me()}function Q(De){const{onFocus:K}=e,{nTriggerFormFocus:Me}=b;K&&ct(K,De),Me()}function ne(De){const{onClear:K}=e;K&&ct(K,De)}function V(De){const{onInputBlur:K}=e;K&&ct(K,De)}function ue(De){const{onInputFocus:K}=e;K&&ct(K,De)}function ve(){const{onDeactivate:De}=e;De&&ct(De)}function Ce(){const{onActivate:De}=e;De&&ct(De)}function G(De){const{onClick:K}=e;K&&ct(K,De)}function Z(De){const{onWrapperFocus:K}=e;K&&ct(K,De)}function de(De){const{onWrapperBlur:K}=e;K&&ct(K,De)}function Se(){A.value=!0}function we(De){A.value=!1,De.target===d.value?_e(De,1):_e(De,0)}function _e(De,K=0,Me="input"){const He=De.target.value;if(at(He),De instanceof InputEvent&&!De.isComposing&&(A.value=!1),e.type==="textarea"){const{value:Ne}=p;Ne&&Ne.syncUnifiedContainer()}if(P=He,A.value)return;f.recordCursor();const Oe=Ee(He);if(Oe)if(!e.pair)Me==="input"?$(He,{source:K}):le(He,{source:K});else{let{value:Ne}=y;Array.isArray(Ne)?Ne=[Ne[0],Ne[1]]:Ne=["",""],Ne[K]=He,Me==="input"?$(Ne,{source:K}):le(Ne,{source:K})}q.$forceUpdate(),Oe||aa(f.restoreCursor)}function Ee(De){const{countGraphemes:K,maxlength:Me,minlength:He}=e;if(K){let Ne;if(Me!==void 0&&(Ne===void 0&&(Ne=K(De)),Ne>Number(Me))||He!==void 0&&(Ne===void 0&&(Ne=K(De)),Ne<Number(Me)))return!1}const{allowInput:Oe}=e;return typeof Oe=="function"?Oe(De):!0}function fe(De){V(De),De.relatedTarget===o.value&&ve(),De.relatedTarget!==null&&(De.relatedTarget===u.value||De.relatedTarget===d.value||De.relatedTarget===s.value)||(M.value=!1),O(De,"blur"),h.value=null}function B(De,K){ue(De),_.value=!0,M.value=!0,Ce(),O(De,"focus"),K===0?h.value=u.value:K===1?h.value=d.value:K===2&&(h.value=s.value)}function D(De){e.passivelyActivated&&(de(De),O(De,"blur"))}function I(De){e.passivelyActivated&&(_.value=!0,Z(De),O(De,"focus"))}function O(De,K){De.relatedTarget!==null&&(De.relatedTarget===u.value||De.relatedTarget===d.value||De.relatedTarget===s.value||De.relatedTarget===o.value)||(K==="focus"?(Q(De),_.value=!0):K==="blur"&&(ee(De),_.value=!1))}function j(De,K){_e(De,K,"change")}function L(De){G(De)}function Ae(De){ne(De),We()}function We(){e.pair?($(["",""],{source:"clear"}),le(["",""],{source:"clear"})):($("",{source:"clear"}),le("",{source:"clear"}))}function Ve(De){const{onMousedown:K}=e;K&&K(De);const{tagName:Me}=De.target;if(Me!=="INPUT"&&Me!=="TEXTAREA"){if(e.resizable){const{value:He}=o;if(He){const{left:Oe,top:Ne,width:wt,height:Rt}=He.getBoundingClientRect(),It=14;if(Oe+wt-It<De.clientX&&De.clientX<Oe+wt&&Ne+Rt-It<De.clientY&&De.clientY<Ne+Rt)return}}De.preventDefault(),_.value||Ye()}}function ke(){var De;C.value=!0,e.type==="textarea"&&((De=p.value)===null||De===void 0||De.handleMouseEnterWrapper())}function et(){var De;C.value=!1,e.type==="textarea"&&((De=p.value)===null||De===void 0||De.handleMouseLeaveWrapper())}function nt(){S.value||N.value==="click"&&(U.value=!U.value)}function lt(De){if(S.value)return;De.preventDefault();const K=He=>{He.preventDefault(),Si("mouseup",document,K)};if(Ui("mouseup",document,K),N.value!=="mousedown")return;U.value=!0;const Me=()=>{U.value=!1,Si("mouseup",document,Me)};Ui("mouseup",document,Me)}function ut(De){e.onKeyup&&ct(e.onKeyup,De)}function vt(De){switch(e.onKeydown&&ct(e.onKeydown,De),De.key){case"Escape":Be();break;case"Enter":se(De);break}}function se(De){var K,Me;if(e.passivelyActivated){const{value:He}=M;if(He){e.internalDeactivateOnEnter&&Be();return}De.preventDefault(),e.type==="textarea"?(K=s.value)===null||K===void 0||K.focus():(Me=u.value)===null||Me===void 0||Me.focus()}}function Be(){e.passivelyActivated&&(M.value=!1,aa(()=>{var De;(De=o.value)===null||De===void 0||De.focus()}))}function Ye(){var De,K,Me;S.value||(e.passivelyActivated?(De=o.value)===null||De===void 0||De.focus():((K=s.value)===null||K===void 0||K.focus(),(Me=u.value)===null||Me===void 0||Me.focus()))}function pe(){var De;!((De=o.value)===null||De===void 0)&&De.contains(document.activeElement)&&document.activeElement.blur()}function Te(){var De,K;(De=s.value)===null||De===void 0||De.select(),(K=u.value)===null||K===void 0||K.select()}function ce(){S.value||(s.value?s.value.focus():u.value&&u.value.focus())}function Re(){const{value:De}=o;De!=null&&De.contains(document.activeElement)&&De!==document.activeElement&&Be()}function $e(De){if(e.type==="textarea"){const{value:K}=s;K==null||K.scrollTo(De)}else{const{value:K}=u;K==null||K.scrollTo(De)}}function at(De){const{type:K,pair:Me,autosize:He}=e;if(!Me&&He)if(K==="textarea"){const{value:Oe}=l;Oe&&(Oe.textContent=(De??"")+`\r
`)}else{const{value:Oe}=c;Oe&&(De?Oe.textContent=De:Oe.innerHTML="&nbsp;")}}function Yt(){X()}const nr=me({top:"0"});function Fe(De){var K;const{scrollTop:Me}=De.target;nr.value.top=`${-Me}px`,(K=p.value)===null||K===void 0||K.syncUnifiedContainer()}let Ke=null;no(()=>{const{autosize:De,type:K}=e;De&&K==="textarea"?Ke=rr(y,Me=>{!Array.isArray(Me)&&Me!==P&&at(Me)}):Ke==null||Ke()});let dt=null;no(()=>{e.type==="textarea"?dt=rr(y,De=>{var K;!Array.isArray(De)&&De!==P&&((K=p.value)===null||K===void 0||K.syncUnifiedContainer())}):dt==null||dt()}),xr(l6,{mergedValueRef:y,maxlengthRef:W,mergedClsPrefixRef:t,countGraphemesRef:pt(e,"countGraphemes")});const Nt={wrapperElRef:o,inputElRef:u,textareaElRef:s,isCompositing:A,clear:We,focus:Ye,blur:pe,select:Te,deactivate:Re,activate:ce,scrollTo:$e},hi=oo("Input",n,t),Mi=re(()=>{const{value:De}=x,{common:{cubicBezierEaseInOut:K},self:{color:Me,borderRadius:He,textColor:Oe,caretColor:Ne,caretColorError:wt,caretColorWarning:Rt,textDecorationColor:It,border:Tt,borderDisabled:fr,borderHover:Jt,borderFocus:Pe,placeholderColor:Qe,placeholderColorDisabled:xt,lineHeightTextarea:Er,colorDisabled:ui,colorFocus:Ut,textColorDisabled:ar,boxShadowFocus:En,iconSize:er,colorFocusWarning:co,boxShadowFocusWarning:qo,borderWarning:yo,borderFocusWarning:ja,borderHoverWarning:Y,colorFocusError:J,boxShadowFocusError:be,borderError:ae,borderFocusError:Ie,borderHoverError:ot,clearSize:Yo,clearColor:Sm,clearColorHover:Fh,clearColorPressed:Cm,iconColor:Nh,iconColorDisabled:_m,suffixTextColor:$7,countTextColor:q7,countTextColorDisabled:Y7,iconColorHover:X7,iconColorPressed:K7,loadingColor:Q7,loadingColorError:Z7,loadingColorWarning:J7,[Ze("padding",De)]:eG,[Ze("fontSize",De)]:tG,[Ze("height",De)]:rG}}=a.value,{left:iG,right:nG}=zo(eG);return{"--n-bezier":K,"--n-count-text-color":q7,"--n-count-text-color-disabled":Y7,"--n-color":Me,"--n-font-size":tG,"--n-border-radius":He,"--n-height":rG,"--n-padding-left":iG,"--n-padding-right":nG,"--n-text-color":Oe,"--n-caret-color":Ne,"--n-text-decoration-color":It,"--n-border":Tt,"--n-border-disabled":fr,"--n-border-hover":Jt,"--n-border-focus":Pe,"--n-placeholder-color":Qe,"--n-placeholder-color-disabled":xt,"--n-icon-size":er,"--n-line-height-textarea":Er,"--n-color-disabled":ui,"--n-color-focus":Ut,"--n-text-color-disabled":ar,"--n-box-shadow-focus":En,"--n-loading-color":Q7,"--n-caret-color-warning":Rt,"--n-color-focus-warning":co,"--n-box-shadow-focus-warning":qo,"--n-border-warning":yo,"--n-border-focus-warning":ja,"--n-border-hover-warning":Y,"--n-loading-color-warning":J7,"--n-caret-color-error":wt,"--n-color-focus-error":J,"--n-box-shadow-focus-error":be,"--n-border-error":ae,"--n-border-focus-error":Ie,"--n-border-hover-error":ot,"--n-loading-color-error":Z7,"--n-clear-color":Sm,"--n-clear-size":Yo,"--n-clear-color-hover":Fh,"--n-clear-color-pressed":Cm,"--n-icon-color":Nh,"--n-icon-color-hover":X7,"--n-icon-color-pressed":K7,"--n-icon-color-disabled":_m,"--n-suffix-text-color":$7}}),Mr=i?Dr("input",re(()=>{const{value:De}=x;return De[0]}),Mi,e):void 0;return Object.assign(Object.assign({},Nt),{wrapperElRef:o,inputElRef:u,inputMirrorElRef:c,inputEl2Ref:d,textareaElRef:s,textareaMirrorElRef:l,textareaScrollbarInstRef:p,rtlEnabled:hi,uncontrolledValue:m,mergedValue:y,passwordVisible:U,mergedPlaceholder:T,showPlaceholder1:R,showPlaceholder2:z,mergedFocus:F,isComposing:A,activated:M,showClearButton:H,mergedSize:x,mergedDisabled:S,textDecorationStyle:ie,mergedClsPrefix:t,mergedBordered:r,mergedShowPasswordOn:N,placeholderStyle:nr,mergedStatus:w,textAreaScrollContainerWidth:te,handleTextAreaScroll:Fe,handleCompositionStart:Se,handleCompositionEnd:we,handleInput:_e,handleInputBlur:fe,handleInputFocus:B,handleWrapperBlur:D,handleWrapperFocus:I,handleMouseEnter:ke,handleMouseLeave:et,handleMouseDown:Ve,handleChange:j,handleClick:L,handleClear:Ae,handlePasswordToggleClick:nt,handlePasswordToggleMousedown:lt,handleWrapperKeydown:vt,handleWrapperKeyup:ut,handleTextAreaMirrorResize:Yt,getTextareaScrollContainer:()=>s.value,mergedTheme:a,cssVars:i?void 0:Mi,themeClass:Mr==null?void 0:Mr.themeClass,onRender:Mr==null?void 0:Mr.onRender})},render(){var e,t;const{mergedClsPrefix:r,mergedStatus:i,themeClass:n,type:a,countGraphemes:o,onRender:s}=this,l=this.$slots;return s==null||s(),E("div",{ref:"wrapperElRef",class:[`${r}-input`,n,i&&`${r}-input--${i}-status`,{[`${r}-input--rtl`]:this.rtlEnabled,[`${r}-input--disabled`]:this.mergedDisabled,[`${r}-input--textarea`]:a==="textarea",[`${r}-input--resizable`]:this.resizable&&!this.autosize,[`${r}-input--autosize`]:this.autosize,[`${r}-input--round`]:this.round&&a!=="textarea",[`${r}-input--pair`]:this.pair,[`${r}-input--focus`]:this.mergedFocus,[`${r}-input--stateful`]:this.stateful}],style:this.cssVars,tabindex:!this.mergedDisabled&&this.passivelyActivated&&!this.activated?0:void 0,onFocus:this.handleWrapperFocus,onBlur:this.handleWrapperBlur,onClick:this.handleClick,onMousedown:this.handleMouseDown,onMouseenter:this.handleMouseEnter,onMouseleave:this.handleMouseLeave,onCompositionstart:this.handleCompositionStart,onCompositionend:this.handleCompositionEnd,onKeyup:this.handleWrapperKeyup,onKeydown:this.handleWrapperKeydown},E("div",{class:`${r}-input-wrapper`},ti(l.prefix,c=>c&&E("div",{class:`${r}-input__prefix`},c)),a==="textarea"?E(Sn,{ref:"textareaScrollbarInstRef",class:`${r}-input__textarea`,container:this.getTextareaScrollContainer,triggerDisplayManually:!0,useUnifiedContainer:!0,internalHoistYRail:!0},{default:()=>{var c,u;const{textAreaScrollContainerWidth:d}=this,h={width:this.autosize&&d&&`${d}px`};return E(mr,null,E("textarea",Object.assign({},this.inputProps,{ref:"textareaElRef",class:[`${r}-input__textarea-el`,(c=this.inputProps)===null||c===void 0?void 0:c.class],autofocus:this.autofocus,rows:Number(this.rows),placeholder:this.placeholder,value:this.mergedValue,disabled:this.mergedDisabled,maxlength:o?void 0:this.maxlength,minlength:o?void 0:this.minlength,readonly:this.readonly,tabindex:this.passivelyActivated&&!this.activated?-1:void 0,style:[this.textDecorationStyle[0],(u=this.inputProps)===null||u===void 0?void 0:u.style,h],onBlur:this.handleInputBlur,onFocus:f=>{this.handleInputFocus(f,2)},onInput:this.handleInput,onChange:this.handleChange,onScroll:this.handleTextAreaScroll})),this.showPlaceholder1?E("div",{class:`${r}-input__placeholder`,style:[this.placeholderStyle,h],key:"placeholder"},this.mergedPlaceholder[0]):null,this.autosize?E(nl,{onResize:this.handleTextAreaMirrorResize},{default:()=>E("div",{ref:"textareaMirrorElRef",class:`${r}-input__textarea-mirror`,key:"mirror"})}):null)}}):E("div",{class:`${r}-input__input`},E("input",Object.assign({type:a==="password"&&this.mergedShowPasswordOn&&this.passwordVisible?"text":a},this.inputProps,{ref:"inputElRef",class:[`${r}-input__input-el`,(e=this.inputProps)===null||e===void 0?void 0:e.class],style:[this.textDecorationStyle[0],(t=this.inputProps)===null||t===void 0?void 0:t.style],tabindex:this.passivelyActivated&&!this.activated?-1:void 0,placeholder:this.mergedPlaceholder[0],disabled:this.mergedDisabled,maxlength:o?void 0:this.maxlength,minlength:o?void 0:this.minlength,value:Array.isArray(this.mergedValue)?this.mergedValue[0]:this.mergedValue,readonly:this.readonly,autofocus:this.autofocus,size:this.attrSize,onBlur:this.handleInputBlur,onFocus:c=>{this.handleInputFocus(c,0)},onInput:c=>{this.handleInput(c,0)},onChange:c=>{this.handleChange(c,0)}})),this.showPlaceholder1?E("div",{class:`${r}-input__placeholder`},E("span",null,this.mergedPlaceholder[0])):null,this.autosize?E("div",{class:`${r}-input__input-mirror`,key:"mirror",ref:"inputMirrorElRef"},""):null),!this.pair&&ti(l.suffix,c=>c||this.clearable||this.showCount||this.mergedShowPasswordOn||this.loading!==void 0?E("div",{class:`${r}-input__suffix`},[ti(l["clear-icon-placeholder"],u=>(this.clearable||u)&&E(Y2,{clsPrefix:r,show:this.showClearButton,onClear:this.handleClear},{placeholder:()=>u,icon:()=>{var d,h;return(h=(d=this.$slots)["clear-icon"])===null||h===void 0?void 0:h.call(d)}})),this.internalLoadingBeforeSuffix?null:c,this.loading!==void 0?E(r6,{clsPrefix:r,loading:this.loading,showArrow:!1,showClear:!1,style:this.cssVars}):null,this.internalLoadingBeforeSuffix?c:null,this.showCount&&this.type!=="textarea"?E(xR,null,{default:u=>{var d;return(d=l.count)===null||d===void 0?void 0:d.call(l,u)}}):null,this.mergedShowPasswordOn&&this.type==="password"?E("div",{class:`${r}-input__eye`,onMousedown:this.handlePasswordToggleMousedown,onClick:this.handlePasswordToggleClick},this.passwordVisible?Cr(l["password-visible-icon"],()=>[E(Bi,{clsPrefix:r},{default:()=>E(xre,null)})]):Cr(l["password-invisible-icon"],()=>[E(Bi,{clsPrefix:r},{default:()=>E(wre,null)})])):null]):null)),this.pair?E("span",{class:`${r}-input__separator`},Cr(l.separator,()=>[this.separator])):null,this.pair?E("div",{class:`${r}-input-wrapper`},E("div",{class:`${r}-input__input`},E("input",{ref:"inputEl2Ref",type:this.type,class:`${r}-input__input-el`,tabindex:this.passivelyActivated&&!this.activated?-1:void 0,placeholder:this.mergedPlaceholder[1],disabled:this.mergedDisabled,maxlength:o?void 0:this.maxlength,minlength:o?void 0:this.minlength,value:Array.isArray(this.mergedValue)?this.mergedValue[1]:void 0,readonly:this.readonly,style:this.textDecorationStyle[1],onBlur:this.handleInputBlur,onFocus:c=>{this.handleInputFocus(c,1)},onInput:c=>{this.handleInput(c,1)},onChange:c=>{this.handleChange(c,1)}}),this.showPlaceholder2?E("div",{class:`${r}-input__placeholder`},E("span",null,this.mergedPlaceholder[1])):null),ti(l.suffix,c=>(this.clearable||c)&&E("div",{class:`${r}-input__suffix`},[this.clearable&&E(Y2,{clsPrefix:r,show:this.showClearButton,onClear:this.handleClear},{icon:()=>{var u;return(u=l["clear-icon"])===null||u===void 0?void 0:u.call(l)},placeholder:()=>{var u;return(u=l["clear-icon-placeholder"])===null||u===void 0?void 0:u.call(l)}}),c]))):null,this.mergedBordered?E("div",{class:`${r}-input__border`}):null,this.mergedBordered?E("div",{class:`${r}-input__state-border`}):null,this.showCount&&a==="textarea"?E(xR,null,{default:c=>{var u;const{renderCount:d}=this;return d?d(c):(u=l.count)===null||u===void 0?void 0:u.call(l,c)}}):null)}});function ane(e){const{boxShadow2:t}=e;return{menuBoxShadow:t}}const one={name:"AutoComplete",common:$r,peers:{InternalSelectMenu:oP,Input:rm},self:ane};function sne(e){return e.map(c6)}function c6(e){var t,r;return typeof e=="string"?{label:e,value:e}:e.type==="group"?{type:"group",label:(t=e.label)!==null&&t!==void 0?t:e.name,value:(r=e.value)!==null&&r!==void 0?r:e.name,key:e.key||e.name,children:e.children.map(n=>c6(n))}:e}const lne=ge([oe("auto-complete",`
 z-index: auto;
 position: relative;
 display: inline-flex;
 width: 100%;
 `),oe("auto-complete-menu",`
 margin: 4px 0;
 box-shadow: var(--n-menu-box-shadow);
 `,[tm({originalTransition:"background-color .3s var(--n-bezier), box-shadow .3s var(--n-bezier)"})])]),cne=Object.assign(Object.assign({},bt.props),{to:Wn.propTo,menuProps:Object,append:Boolean,bordered:{type:Boolean,default:void 0},clearable:{type:Boolean,default:void 0},defaultValue:{type:String,default:null},loading:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},placeholder:String,placement:{type:String,default:"bottom-start"},value:String,blurAfterSelect:Boolean,clearAfterSelect:Boolean,getShow:Function,showEmpty:Boolean,inputProps:Object,renderOption:Function,renderLabel:Function,size:String,options:{type:Array,default:()=>[]},zIndex:Number,status:String,"onUpdate:value":[Function,Array],onUpdateValue:[Function,Array],onSelect:[Function,Array],onBlur:[Function,Array],onFocus:[Function,Array],onInput:[Function,Array]}),Q0=je({name:"AutoComplete",props:cne,setup(e){const{mergedBorderedRef:t,namespaceRef:r,mergedClsPrefixRef:i,inlineThemeDisabled:n}=vr(e),a=gl(e),{mergedSizeRef:o,mergedDisabledRef:s,mergedStatusRef:l}=a,c=me(null),u=me(null),d=me(e.defaultValue),h=pt(e,"value"),f=Hn(h,d),p=me(!1),v=me(!1),m=bt("AutoComplete","-auto-complete",lne,one,e,i),g=re(()=>sne(e.options)),y=re(()=>{const{getShow:$}=e;return $?$(f.value||""):!!f.value}),b=re(()=>y.value&&p.value&&(e.showEmpty?!0:!!g.value.length)),x=re(()=>rp(g.value,o6("value","children")));function S($){const{"onUpdate:value":le,onUpdateValue:ee,onInput:Q}=e,{nTriggerFormInput:ne,nTriggerFormChange:V}=a;ee&&ct(ee,$),le&&ct(le,$),Q&&ct(Q,$),d.value=$,ne(),V()}function w($){const{onSelect:le}=e,{nTriggerFormInput:ee,nTriggerFormChange:Q}=a;le&&ct(le,$),ee(),Q()}function _($){const{onBlur:le}=e,{nTriggerFormBlur:ee}=a;le&&ct(le,$),ee()}function C($){const{onFocus:le}=e,{nTriggerFormFocus:ee}=a;le&&ct(le,$),ee()}function A(){v.value=!0}function M(){window.setTimeout(()=>{v.value=!1},0)}function P($){var le,ee,Q;switch($.key){case"Enter":if(!v.value){const ne=(le=u.value)===null||le===void 0?void 0:le.getPendingTmNode();ne&&(T(ne.rawNode),$.preventDefault())}break;case"ArrowDown":(ee=u.value)===null||ee===void 0||ee.next();break;case"ArrowUp":(Q=u.value)===null||Q===void 0||Q.prev();break}}function T($){($==null?void 0:$.value)!==void 0&&(w($.value),e.clearAfterSelect?S(null):$.label!==void 0&&S(e.append?`${f.value}${$.label}`:$.label),p.value=!1,e.blurAfterSelect&&ie())}function R(){S(null)}function z($){p.value=!0,C($)}function F($){p.value=!1,_($)}function H($){p.value=!0,S($)}function N($){T($.rawNode)}function U($){var le;!((le=c.value)===null||le===void 0)&&le.contains(lc($))||(p.value=!1)}function ie(){var $,le;!(($=c.value)===null||$===void 0)&&$.contains(document.activeElement)&&((le=document.activeElement)===null||le===void 0||le.blur())}const te=re(()=>{const{common:{cubicBezierEaseInOut:$},self:{menuBoxShadow:le}}=m.value;return{"--n-menu-box-shadow":le,"--n-bezier":$}}),X=n?Dr("auto-complete",void 0,te,e):void 0,W=me(null),q={focus:()=>{var $;($=W.value)===null||$===void 0||$.focus()},blur:()=>{var $;($=W.value)===null||$===void 0||$.blur()}};return{focus:q.focus,blur:q.blur,inputInstRef:W,uncontrolledValue:d,mergedValue:f,isMounted:Yu(),adjustedTo:Wn(e),menuInstRef:u,triggerElRef:c,treeMate:x,mergedSize:o,mergedDisabled:s,active:b,mergedStatus:l,handleClear:R,handleFocus:z,handleBlur:F,handleInput:H,handleToggle:N,handleClickOutsideMenu:U,handleCompositionStart:A,handleCompositionEnd:M,handleKeyDown:P,mergedTheme:m,cssVars:n?void 0:te,themeClass:X==null?void 0:X.themeClass,onRender:X==null?void 0:X.onRender,mergedBordered:t,namespace:r,mergedClsPrefix:i}},render(){const{mergedClsPrefix:e}=this;return E("div",{class:`${e}-auto-complete`,ref:"triggerElRef",onKeydown:this.handleKeyDown,onCompositionstart:this.handleCompositionStart,onCompositionend:this.handleCompositionEnd},E(wh,null,{default:()=>[E(Sh,null,{default:()=>{if(this.$slots.default)return A2(this.$slots,"default",{handleInput:this.handleInput,handleFocus:this.handleFocus,handleBlur:this.handleBlur,value:this.mergedValue});const{mergedTheme:r}=this;return E(ur,{ref:"inputInstRef",status:this.mergedStatus,theme:r.peers.Input,themeOverrides:r.peerOverrides.Input,bordered:this.mergedBordered,value:this.mergedValue,placeholder:this.placeholder,size:this.mergedSize,disabled:this.mergedDisabled,clearable:this.clearable,loading:this.loading,inputProps:this.inputProps,onClear:this.handleClear,onFocus:this.handleFocus,onUpdateValue:this.handleInput,onBlur:this.handleBlur},{suffix:()=>{var i,n;return(n=(i=this.$slots).suffix)===null||n===void 0?void 0:n.call(i)},prefix:()=>{var i,n;return(n=(i=this.$slots).prefix)===null||n===void 0?void 0:n.call(i)}})}}),E(Ch,{show:this.active,to:this.adjustedTo,containerClass:this.namespace,zIndex:this.zIndex,teleportDisabled:this.adjustedTo===Wn.tdkey,placement:this.placement,width:"target"},{default:()=>E(La,{name:"fade-in-scale-up-transition",appear:this.isMounted},{default:()=>{var t;if((t=this.onRender)===null||t===void 0||t.call(this),!this.active)return null;const{menuProps:r}=this;return io(E(ZU,Object.assign({},r,{clsPrefix:e,ref:"menuInstRef",theme:this.mergedTheme.peers.InternalSelectMenu,themeOverrides:this.mergedTheme.peerOverrides.InternalSelectMenu,"auto-pending":!0,class:[`${e}-auto-complete-menu`,this.themeClass,r==null?void 0:r.class],style:[r==null?void 0:r.style,this.cssVars],treeMate:this.treeMate,multiple:!1,renderLabel:this.renderLabel,renderOption:this.renderOption,size:"medium",onToggle:this.handleToggle}),{empty:()=>{var i,n;return(n=(i=this.$slots).empty)===null||n===void 0?void 0:n.call(i)}}),[[Ru,this.handleClickOutsideMenu,void 0,{capture:!0}]])}})})]}))}}),une=qu&&"loading"in document.createElement("img"),dne=(e={})=>{var t;const{root:r=null}=e;return{hash:`${e.rootMargin||"0px 0px 0px 0px"}-${Array.isArray(e.threshold)?e.threshold.join(","):(t=e.threshold)!==null&&t!==void 0?t:"0"}`,options:Object.assign(Object.assign({},e),{root:(typeof r=="string"?document.querySelector(r):r)||document.documentElement})}},IS=new WeakMap,zS=new WeakMap,kS=new WeakMap,hne=(e,t,r)=>{if(!e)return()=>{};const i=dne(t),{root:n}=i.options;let a;const o=IS.get(n);o?a=o:(a=new Map,IS.set(n,a));let s,l;a.has(i.hash)?(l=a.get(i.hash),l[1].has(e)||(s=l[0],l[1].add(e),s.observe(e))):(s=new IntersectionObserver(d=>{d.forEach(h=>{if(h.isIntersecting){const f=zS.get(h.target),p=kS.get(h.target);f&&f(),p&&(p.value=!0)}})},i.options),s.observe(e),l=[s,new Set([e])],a.set(i.hash,l));let c=!1;const u=()=>{c||(zS.delete(e),kS.delete(e),c=!0,l[1].has(e)&&(l[0].unobserve(e),l[1].delete(e)),l[1].size<=0&&a.delete(i.hash),a.size||IS.delete(n))};return zS.set(e,u),kS.set(e,r),u},fne=e=>{const{borderRadius:t,avatarColor:r,cardColor:i,fontSize:n,heightTiny:a,heightSmall:o,heightMedium:s,heightLarge:l,heightHuge:c,modalColor:u,popoverColor:d}=e;return{borderRadius:t,fontSize:n,border:`2px solid ${i}`,heightTiny:a,heightSmall:o,heightMedium:s,heightLarge:l,heightHuge:c,color:il(i,r),colorModal:il(u,r),colorPopover:il(d,r)}},pne={name:"Avatar",common:$r,self:fne},mne="n-avatar-group",vne=oe("avatar",`
 width: var(--n-merged-size);
 height: var(--n-merged-size);
 color: #FFF;
 font-size: var(--n-font-size);
 display: inline-flex;
 position: relative;
 overflow: hidden;
 text-align: center;
 border: var(--n-border);
 border-radius: var(--n-border-radius);
 --n-merged-color: var(--n-color);
 background-color: var(--n-merged-color);
 transition:
 border-color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
`,[kN(ge("&","--n-merged-color: var(--n-color-modal);")),LN(ge("&","--n-merged-color: var(--n-color-popover);")),ge("img",`
 width: 100%;
 height: 100%;
 `),he("text",`
 white-space: nowrap;
 display: inline-block;
 position: absolute;
 left: 50%;
 top: 50%;
 `),oe("icon",`
 vertical-align: bottom;
 font-size: calc(var(--n-merged-size) - 6px);
 `),he("text","line-height: 1.25")]),gne=Object.assign(Object.assign({},bt.props),{size:[String,Number],src:String,circle:{type:Boolean,default:void 0},objectFit:String,round:{type:Boolean,default:void 0},bordered:{type:Boolean,default:void 0},onError:Function,fallbackSrc:String,intersectionObserverOptions:Object,lazy:Boolean,onLoad:Function,renderPlaceholder:Function,renderFallback:Function,imgProps:Object,color:String}),lP=je({name:"Avatar",props:gne,setup(e){const{mergedClsPrefixRef:t,inlineThemeDisabled:r}=vr(e),i=me(!1);let n=null;const a=me(null),o=me(null),s=()=>{const{value:y}=a;if(y&&(n===null||n!==y.innerHTML)){n=y.innerHTML;const{value:b}=o;if(b){const{offsetWidth:x,offsetHeight:S}=b,{offsetWidth:w,offsetHeight:_}=y,C=.9,A=Math.min(x/w*C,S/_*C,1);y.style.transform=`translateX(-50%) translateY(-50%) scale(${A})`}}},l=_t(mne,null),c=re(()=>{const{size:y}=e;if(y)return y;const{size:b}=l||{};return b||"medium"}),u=bt("Avatar","-avatar",vne,pne,e,t),d=_t(t6,null),h=re(()=>{if(l)return!0;const{round:y,circle:b}=e;return y!==void 0||b!==void 0?y||b:d?d.roundRef.value:!1}),f=re(()=>l?!0:e.bordered||!1),p=re(()=>{const y=c.value,b=h.value,x=f.value,{color:S}=e,{self:{borderRadius:w,fontSize:_,color:C,border:A,colorModal:M,colorPopover:P},common:{cubicBezierEaseInOut:T}}=u.value;let R;return typeof y=="number"?R=`${y}px`:R=u.value.self[Ze("height",y)],{"--n-font-size":_,"--n-border":x?A:"none","--n-border-radius":b?"50%":w,"--n-color":S||C,"--n-color-modal":S||M,"--n-color-popover":S||P,"--n-bezier":T,"--n-merged-size":`var(--n-avatar-size-override, ${R})`}}),v=r?Dr("avatar",re(()=>{const y=c.value,b=h.value,x=f.value,{color:S}=e;let w="";return y&&(typeof y=="number"?w+=`a${y}`:w+=y[0]),b&&(w+="b"),x&&(w+="c"),S&&(w+=ug(S)),w}),p,e):void 0,m=me(!e.lazy);Or(()=>{if(e.lazy&&e.intersectionObserverOptions){let y;const b=no(()=>{y==null||y(),y=void 0,e.lazy&&(y=hne(o.value,e.intersectionObserverOptions,m))});la(()=>{b(),y==null||y()})}}),rr(()=>{var y;return e.src||((y=e.imgProps)===null||y===void 0?void 0:y.src)},()=>{i.value=!1});const g=me(!e.lazy);return{textRef:a,selfRef:o,mergedRoundRef:h,mergedClsPrefix:t,fitTextTransform:s,cssVars:r?void 0:p,themeClass:v==null?void 0:v.themeClass,onRender:v==null?void 0:v.onRender,hasLoadError:i,shouldStartLoading:m,loaded:g,mergedOnError:y=>{if(!m.value)return;i.value=!0;const{onError:b,imgProps:{onError:x}={}}=e;b==null||b(y),x==null||x(y)},mergedOnLoad:y=>{const{onLoad:b,imgProps:{onLoad:x}={}}=e;b==null||b(y),x==null||x(y),g.value=!0}}},render(){var e,t;const{$slots:r,src:i,mergedClsPrefix:n,lazy:a,onRender:o,loaded:s,hasLoadError:l,imgProps:c={}}=this;o==null||o();let u;const d=!s&&!l&&(this.renderPlaceholder?this.renderPlaceholder():(t=(e=this.$slots).placeholder)===null||t===void 0?void 0:t.call(e));return this.hasLoadError?u=this.renderFallback?this.renderFallback():Cr(r.fallback,()=>[E("img",{src:this.fallbackSrc,style:{objectFit:this.objectFit}})]):u=ti(r.default,h=>{if(h)return E(nl,{onResize:this.fitTextTransform},{default:()=>E("span",{ref:"textRef",class:`${n}-avatar__text`},h)});if(i||c.src){const f=this.src||c.src;return E("img",Object.assign(Object.assign({},c),{loading:une&&!this.intersectionObserverOptions&&a?"lazy":"eager",src:a&&this.intersectionObserverOptions?this.shouldStartLoading?f:void 0:f,"data-image-src":f,onLoad:this.mergedOnLoad,onError:this.mergedOnError,style:[c.style||"",{objectFit:this.objectFit},d?{height:"0",width:"0",visibility:"hidden",position:"absolute"}:""]}))}}),E("span",{ref:"selfRef",class:[`${n}-avatar`,this.themeClass],style:this.cssVars},u,a&&d)}}),yne={fontWeightActive:"400"},bne=e=>{const{fontSize:t,textColor3:r,textColor2:i,borderRadius:n,buttonColor2Hover:a,buttonColor2Pressed:o}=e;return Object.assign(Object.assign({},yne),{fontSize:t,itemLineHeight:"1.25",itemTextColor:r,itemTextColorHover:i,itemTextColorPressed:i,itemTextColorActive:i,itemBorderRadius:n,itemColorHover:a,itemColorPressed:o,separatorColor:r})},xne={name:"Breadcrumb",common:$r,self:bne},wne=oe("breadcrumb",`
 white-space: nowrap;
 cursor: default;
 line-height: var(--n-item-line-height);
`,[ge("ul",`
 list-style: none;
 padding: 0;
 margin: 0;
 `),ge("a",`
 color: inherit;
 text-decoration: inherit;
 `),oe("breadcrumb-item",`
 font-size: var(--n-font-size);
 transition: color .3s var(--n-bezier);
 display: inline-flex;
 align-items: center;
 `,[oe("icon",`
 font-size: 18px;
 vertical-align: -.2em;
 transition: color .3s var(--n-bezier);
 color: var(--n-item-text-color);
 `),ge("&:not(:last-child)",[xe("clickable",[he("link",`
 cursor: pointer;
 `,[ge("&:hover",`
 background-color: var(--n-item-color-hover);
 `),ge("&:active",`
 background-color: var(--n-item-color-pressed); 
 `)])])]),he("link",`
 padding: 4px;
 border-radius: var(--n-item-border-radius);
 transition:
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
 color: var(--n-item-text-color);
 position: relative;
 `,[ge("&:hover",`
 color: var(--n-item-text-color-hover);
 `,[oe("icon",`
 color: var(--n-item-text-color-hover);
 `)]),ge("&:active",`
 color: var(--n-item-text-color-pressed);
 `,[oe("icon",`
 color: var(--n-item-text-color-pressed);
 `)])]),he("separator",`
 margin: 0 8px;
 color: var(--n-separator-color);
 transition: color .3s var(--n-bezier);
 user-select: none;
 -webkit-user-select: none;
 `),ge("&:last-child",[he("link",`
 font-weight: var(--n-font-weight-active);
 cursor: unset;
 color: var(--n-item-text-color-active);
 `,[oe("icon",`
 color: var(--n-item-text-color-active);
 `)]),he("separator",`
 display: none;
 `)])])]),u6="n-breadcrumb",Sne=Object.assign(Object.assign({},bt.props),{separator:{type:String,default:"/"}}),Cne=je({name:"Breadcrumb",props:Sne,setup(e){const{mergedClsPrefixRef:t,inlineThemeDisabled:r}=vr(e),i=bt("Breadcrumb","-breadcrumb",wne,xne,e,t);xr(u6,{separatorRef:pt(e,"separator"),mergedClsPrefixRef:t});const n=re(()=>{const{common:{cubicBezierEaseInOut:o},self:{separatorColor:s,itemTextColor:l,itemTextColorHover:c,itemTextColorPressed:u,itemTextColorActive:d,fontSize:h,fontWeightActive:f,itemBorderRadius:p,itemColorHover:v,itemColorPressed:m,itemLineHeight:g}}=i.value;return{"--n-font-size":h,"--n-bezier":o,"--n-item-text-color":l,"--n-item-text-color-hover":c,"--n-item-text-color-pressed":u,"--n-item-text-color-active":d,"--n-separator-color":s,"--n-item-color-hover":v,"--n-item-color-pressed":m,"--n-item-border-radius":p,"--n-font-weight-active":f,"--n-item-line-height":g}}),a=r?Dr("breadcrumb",void 0,n,e):void 0;return{mergedClsPrefix:t,cssVars:r?void 0:n,themeClass:a==null?void 0:a.themeClass,onRender:a==null?void 0:a.onRender}},render(){var e;return(e=this.onRender)===null||e===void 0||e.call(this),E("nav",{class:[`${this.mergedClsPrefix}-breadcrumb`,this.themeClass],style:this.cssVars,"aria-label":"Breadcrumb"},E("ul",null,this.$slots))}}),_ne=(e=qu?window:null)=>{const t=()=>{const{hash:n,host:a,hostname:o,href:s,origin:l,pathname:c,port:u,protocol:d,search:h}=(e==null?void 0:e.location)||{};return{hash:n,host:a,hostname:o,href:s,origin:l,pathname:c,port:u,protocol:d,search:h}},r=()=>{i.value=t()},i=me(t());return Or(()=>{e&&(e.addEventListener("popstate",r),e.addEventListener("hashchange",r))}),Qg(()=>{e&&(e.removeEventListener("popstate",r),e.removeEventListener("hashchange",r))}),i},Ane={separator:String,href:String,clickable:{type:Boolean,default:!0},onClick:Function},Mne=je({name:"BreadcrumbItem",props:Ane,setup(e,{slots:t}){const r=_t(u6,null);if(!r)return()=>null;const{separatorRef:i,mergedClsPrefixRef:n}=r,a=_ne(),o=re(()=>e.href?"a":"span"),s=re(()=>a.value.href===e.href?"location":null);return()=>{const{value:l}=n;return E("li",{class:[`${l}-breadcrumb-item`,e.clickable&&`${l}-breadcrumb-item--clickable`]},E(o.value,{class:`${l}-breadcrumb-item__link`,"aria-current":s.value,href:e.href,onClick:e.onClick},t),E("span",{class:`${l}-breadcrumb-item__separator`,"aria-hidden":"true"},Cr(t.separator,()=>{var c;return[(c=e.separator)!==null&&c!==void 0?c:i.value]})))}}});function nd(e){return il(e,[255,255,255,.16])}function Z0(e){return il(e,[0,0,0,.12])}const d6="n-button-group",Ene={paddingTiny:"0 6px",paddingSmall:"0 10px",paddingMedium:"0 14px",paddingLarge:"0 18px",paddingRoundTiny:"0 10px",paddingRoundSmall:"0 14px",paddingRoundMedium:"0 18px",paddingRoundLarge:"0 22px",iconMarginTiny:"6px",iconMarginSmall:"6px",iconMarginMedium:"6px",iconMarginLarge:"6px",iconSizeTiny:"14px",iconSizeSmall:"18px",iconSizeMedium:"18px",iconSizeLarge:"20px",rippleDuration:".6s"},Tne=e=>{const{heightTiny:t,heightSmall:r,heightMedium:i,heightLarge:n,borderRadius:a,fontSizeTiny:o,fontSizeSmall:s,fontSizeMedium:l,fontSizeLarge:c,opacityDisabled:u,textColor2:d,textColor3:h,primaryColorHover:f,primaryColorPressed:p,borderColor:v,primaryColor:m,baseColor:g,infoColor:y,infoColorHover:b,infoColorPressed:x,successColor:S,successColorHover:w,successColorPressed:_,warningColor:C,warningColorHover:A,warningColorPressed:M,errorColor:P,errorColorHover:T,errorColorPressed:R,fontWeight:z,buttonColor2:F,buttonColor2Hover:H,buttonColor2Pressed:N,fontWeightStrong:U}=e;return Object.assign(Object.assign({},Ene),{heightTiny:t,heightSmall:r,heightMedium:i,heightLarge:n,borderRadiusTiny:a,borderRadiusSmall:a,borderRadiusMedium:a,borderRadiusLarge:a,fontSizeTiny:o,fontSizeSmall:s,fontSizeMedium:l,fontSizeLarge:c,opacityDisabled:u,colorOpacitySecondary:"0.16",colorOpacitySecondaryHover:"0.22",colorOpacitySecondaryPressed:"0.28",colorSecondary:F,colorSecondaryHover:H,colorSecondaryPressed:N,colorTertiary:F,colorTertiaryHover:H,colorTertiaryPressed:N,colorQuaternary:"#0000",colorQuaternaryHover:H,colorQuaternaryPressed:N,color:"#0000",colorHover:"#0000",colorPressed:"#0000",colorFocus:"#0000",colorDisabled:"#0000",textColor:d,textColorTertiary:h,textColorHover:f,textColorPressed:p,textColorFocus:f,textColorDisabled:d,textColorText:d,textColorTextHover:f,textColorTextPressed:p,textColorTextFocus:f,textColorTextDisabled:d,textColorGhost:d,textColorGhostHover:f,textColorGhostPressed:p,textColorGhostFocus:f,textColorGhostDisabled:d,border:`1px solid ${v}`,borderHover:`1px solid ${f}`,borderPressed:`1px solid ${p}`,borderFocus:`1px solid ${f}`,borderDisabled:`1px solid ${v}`,rippleColor:m,colorPrimary:m,colorHoverPrimary:f,colorPressedPrimary:p,colorFocusPrimary:f,colorDisabledPrimary:m,textColorPrimary:g,textColorHoverPrimary:g,textColorPressedPrimary:g,textColorFocusPrimary:g,textColorDisabledPrimary:g,textColorTextPrimary:m,textColorTextHoverPrimary:f,textColorTextPressedPrimary:p,textColorTextFocusPrimary:f,textColorTextDisabledPrimary:d,textColorGhostPrimary:m,textColorGhostHoverPrimary:f,textColorGhostPressedPrimary:p,textColorGhostFocusPrimary:f,textColorGhostDisabledPrimary:m,borderPrimary:`1px solid ${m}`,borderHoverPrimary:`1px solid ${f}`,borderPressedPrimary:`1px solid ${p}`,borderFocusPrimary:`1px solid ${f}`,borderDisabledPrimary:`1px solid ${m}`,rippleColorPrimary:m,colorInfo:y,colorHoverInfo:b,colorPressedInfo:x,colorFocusInfo:b,colorDisabledInfo:y,textColorInfo:g,textColorHoverInfo:g,textColorPressedInfo:g,textColorFocusInfo:g,textColorDisabledInfo:g,textColorTextInfo:y,textColorTextHoverInfo:b,textColorTextPressedInfo:x,textColorTextFocusInfo:b,textColorTextDisabledInfo:d,textColorGhostInfo:y,textColorGhostHoverInfo:b,textColorGhostPressedInfo:x,textColorGhostFocusInfo:b,textColorGhostDisabledInfo:y,borderInfo:`1px solid ${y}`,borderHoverInfo:`1px solid ${b}`,borderPressedInfo:`1px solid ${x}`,borderFocusInfo:`1px solid ${b}`,borderDisabledInfo:`1px solid ${y}`,rippleColorInfo:y,colorSuccess:S,colorHoverSuccess:w,colorPressedSuccess:_,colorFocusSuccess:w,colorDisabledSuccess:S,textColorSuccess:g,textColorHoverSuccess:g,textColorPressedSuccess:g,textColorFocusSuccess:g,textColorDisabledSuccess:g,textColorTextSuccess:S,textColorTextHoverSuccess:w,textColorTextPressedSuccess:_,textColorTextFocusSuccess:w,textColorTextDisabledSuccess:d,textColorGhostSuccess:S,textColorGhostHoverSuccess:w,textColorGhostPressedSuccess:_,textColorGhostFocusSuccess:w,textColorGhostDisabledSuccess:S,borderSuccess:`1px solid ${S}`,borderHoverSuccess:`1px solid ${w}`,borderPressedSuccess:`1px solid ${_}`,borderFocusSuccess:`1px solid ${w}`,borderDisabledSuccess:`1px solid ${S}`,rippleColorSuccess:S,colorWarning:C,colorHoverWarning:A,colorPressedWarning:M,colorFocusWarning:A,colorDisabledWarning:C,textColorWarning:g,textColorHoverWarning:g,textColorPressedWarning:g,textColorFocusWarning:g,textColorDisabledWarning:g,textColorTextWarning:C,textColorTextHoverWarning:A,textColorTextPressedWarning:M,textColorTextFocusWarning:A,textColorTextDisabledWarning:d,textColorGhostWarning:C,textColorGhostHoverWarning:A,textColorGhostPressedWarning:M,textColorGhostFocusWarning:A,textColorGhostDisabledWarning:C,borderWarning:`1px solid ${C}`,borderHoverWarning:`1px solid ${A}`,borderPressedWarning:`1px solid ${M}`,borderFocusWarning:`1px solid ${A}`,borderDisabledWarning:`1px solid ${C}`,rippleColorWarning:C,colorError:P,colorHoverError:T,colorPressedError:R,colorFocusError:T,colorDisabledError:P,textColorError:g,textColorHoverError:g,textColorPressedError:g,textColorFocusError:g,textColorDisabledError:g,textColorTextError:P,textColorTextHoverError:T,textColorTextPressedError:R,textColorTextFocusError:T,textColorTextDisabledError:d,textColorGhostError:P,textColorGhostHoverError:T,textColorGhostPressedError:R,textColorGhostFocusError:T,textColorGhostDisabledError:P,borderError:`1px solid ${P}`,borderHoverError:`1px solid ${T}`,borderPressedError:`1px solid ${R}`,borderFocusError:`1px solid ${T}`,borderDisabledError:`1px solid ${P}`,rippleColorError:P,waveOpacity:"0.6",fontWeight:z,fontWeightStrong:U})},n0={name:"Button",common:$r,self:Tne},Pne=ge([oe("button",`
 margin: 0;
 font-weight: var(--n-font-weight);
 line-height: 1;
 font-family: inherit;
 padding: var(--n-padding);
 height: var(--n-height);
 font-size: var(--n-font-size);
 border-radius: var(--n-border-radius);
 color: var(--n-text-color);
 background-color: var(--n-color);
 width: var(--n-width);
 white-space: nowrap;
 outline: none;
 position: relative;
 z-index: auto;
 border: none;
 display: inline-flex;
 flex-wrap: nowrap;
 flex-shrink: 0;
 align-items: center;
 justify-content: center;
 user-select: none;
 -webkit-user-select: none;
 text-align: center;
 cursor: pointer;
 text-decoration: none;
 transition:
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 opacity .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 `,[xe("color",[he("border",{borderColor:"var(--n-border-color)"}),xe("disabled",[he("border",{borderColor:"var(--n-border-color-disabled)"})]),br("disabled",[ge("&:focus",[he("state-border",{borderColor:"var(--n-border-color-focus)"})]),ge("&:hover",[he("state-border",{borderColor:"var(--n-border-color-hover)"})]),ge("&:active",[he("state-border",{borderColor:"var(--n-border-color-pressed)"})]),xe("pressed",[he("state-border",{borderColor:"var(--n-border-color-pressed)"})])])]),xe("disabled",{backgroundColor:"var(--n-color-disabled)",color:"var(--n-text-color-disabled)"},[he("border",{border:"var(--n-border-disabled)"})]),br("disabled",[ge("&:focus",{backgroundColor:"var(--n-color-focus)",color:"var(--n-text-color-focus)"},[he("state-border",{border:"var(--n-border-focus)"})]),ge("&:hover",{backgroundColor:"var(--n-color-hover)",color:"var(--n-text-color-hover)"},[he("state-border",{border:"var(--n-border-hover)"})]),ge("&:active",{backgroundColor:"var(--n-color-pressed)",color:"var(--n-text-color-pressed)"},[he("state-border",{border:"var(--n-border-pressed)"})]),xe("pressed",{backgroundColor:"var(--n-color-pressed)",color:"var(--n-text-color-pressed)"},[he("state-border",{border:"var(--n-border-pressed)"})])]),xe("loading","cursor: wait;"),oe("base-wave",`
 pointer-events: none;
 top: 0;
 right: 0;
 bottom: 0;
 left: 0;
 animation-iteration-count: 1;
 animation-duration: var(--n-ripple-duration);
 animation-timing-function: var(--n-bezier-ease-out), var(--n-bezier-ease-out);
 `,[xe("active",{zIndex:1,animationName:"button-wave-spread, button-wave-opacity"})]),qu&&"MozBoxSizing"in document.createElement("div").style?ge("&::moz-focus-inner",{border:0}):null,he("border, state-border",`
 position: absolute;
 left: 0;
 top: 0;
 right: 0;
 bottom: 0;
 border-radius: inherit;
 transition: border-color .3s var(--n-bezier);
 pointer-events: none;
 `),he("border",{border:"var(--n-border)"}),he("state-border",{border:"var(--n-border)",borderColor:"#0000",zIndex:1}),he("icon",`
 margin: var(--n-icon-margin);
 margin-left: 0;
 height: var(--n-icon-size);
 width: var(--n-icon-size);
 max-width: var(--n-icon-size);
 font-size: var(--n-icon-size);
 position: relative;
 flex-shrink: 0;
 `,[oe("icon-slot",`
 height: var(--n-icon-size);
 width: var(--n-icon-size);
 position: absolute;
 left: 0;
 top: 50%;
 transform: translateY(-50%);
 display: flex;
 align-items: center;
 justify-content: center;
 `,[ku({top:"50%",originalTransform:"translateY(-50%)"})]),$ie()]),he("content",`
 display: flex;
 align-items: center;
 flex-wrap: nowrap;
 min-width: 0;
 `,[ge("~",[he("icon",{margin:"var(--n-icon-margin)",marginRight:0})])]),xe("block",`
 display: flex;
 width: 100%;
 `),xe("dashed",[he("border, state-border",{borderStyle:"dashed !important"})]),xe("disabled",{cursor:"not-allowed",opacity:"var(--n-opacity-disabled)"})]),ge("@keyframes button-wave-spread",{from:{boxShadow:"0 0 0.5px 0 var(--n-ripple-color)"},to:{boxShadow:"0 0 0.5px 4.5px var(--n-ripple-color)"}}),ge("@keyframes button-wave-opacity",{from:{opacity:"var(--n-wave-opacity)"},to:{opacity:0}})]),Dne=Object.assign(Object.assign({},bt.props),{color:String,textColor:String,text:Boolean,block:Boolean,loading:Boolean,disabled:Boolean,circle:Boolean,size:String,ghost:Boolean,round:Boolean,secondary:Boolean,tertiary:Boolean,quaternary:Boolean,strong:Boolean,focusable:{type:Boolean,default:!0},keyboard:{type:Boolean,default:!0},tag:{type:String,default:"button"},type:{type:String,default:"default"},dashed:Boolean,renderIcon:Function,iconPlacement:{type:String,default:"left"},attrType:{type:String,default:"button"},bordered:{type:Boolean,default:!0},onClick:[Function,Array],nativeFocusBehavior:{type:Boolean,default:!s6}}),ci=je({name:"Button",props:Dne,setup(e){const t=me(null),r=me(null),i=me(!1),n=qi(()=>!e.quaternary&&!e.tertiary&&!e.secondary&&!e.text&&(!e.color||e.ghost||e.dashed)&&e.bordered),a=_t(d6,{}),{mergedSizeRef:o}=gl({},{defaultSize:"medium",mergedSize:x=>{const{size:S}=e;if(S)return S;const{size:w}=a;if(w)return w;const{mergedSize:_}=x||{};return _?_.value:"medium"}}),s=re(()=>e.focusable&&!e.disabled),l=x=>{var S;s.value||x.preventDefault(),!e.nativeFocusBehavior&&(x.preventDefault(),!e.disabled&&s.value&&((S=t.value)===null||S===void 0||S.focus({preventScroll:!0})))},c=x=>{var S;if(!e.disabled&&!e.loading){const{onClick:w}=e;w&&ct(w,x),e.text||(S=r.value)===null||S===void 0||S.play()}},u=x=>{switch(x.key){case"Enter":if(!e.keyboard)return;i.value=!1}},d=x=>{switch(x.key){case"Enter":if(!e.keyboard||e.loading){x.preventDefault();return}i.value=!0}},h=()=>{i.value=!1},{inlineThemeDisabled:f,mergedClsPrefixRef:p,mergedRtlRef:v}=vr(e),m=bt("Button","-button",Pne,n0,e,p),g=oo("Button",v,p),y=re(()=>{const x=m.value,{common:{cubicBezierEaseInOut:S,cubicBezierEaseOut:w},self:_}=x,{rippleDuration:C,opacityDisabled:A,fontWeight:M,fontWeightStrong:P}=_,T=o.value,{dashed:R,type:z,ghost:F,text:H,color:N,round:U,circle:ie,textColor:te,secondary:X,tertiary:W,quaternary:q,strong:$}=e,le={"font-weight":$?P:M};let ee={"--n-color":"initial","--n-color-hover":"initial","--n-color-pressed":"initial","--n-color-focus":"initial","--n-color-disabled":"initial","--n-ripple-color":"initial","--n-text-color":"initial","--n-text-color-hover":"initial","--n-text-color-pressed":"initial","--n-text-color-focus":"initial","--n-text-color-disabled":"initial"};const Q=z==="tertiary",ne=z==="default",V=Q?"default":z;if(H){const fe=te||N;ee={"--n-color":"#0000","--n-color-hover":"#0000","--n-color-pressed":"#0000","--n-color-focus":"#0000","--n-color-disabled":"#0000","--n-ripple-color":"#0000","--n-text-color":fe||_[Ze("textColorText",V)],"--n-text-color-hover":fe?nd(fe):_[Ze("textColorTextHover",V)],"--n-text-color-pressed":fe?Z0(fe):_[Ze("textColorTextPressed",V)],"--n-text-color-focus":fe?nd(fe):_[Ze("textColorTextHover",V)],"--n-text-color-disabled":fe||_[Ze("textColorTextDisabled",V)]}}else if(F||R){const fe=te||N;ee={"--n-color":"#0000","--n-color-hover":"#0000","--n-color-pressed":"#0000","--n-color-focus":"#0000","--n-color-disabled":"#0000","--n-ripple-color":N||_[Ze("rippleColor",V)],"--n-text-color":fe||_[Ze("textColorGhost",V)],"--n-text-color-hover":fe?nd(fe):_[Ze("textColorGhostHover",V)],"--n-text-color-pressed":fe?Z0(fe):_[Ze("textColorGhostPressed",V)],"--n-text-color-focus":fe?nd(fe):_[Ze("textColorGhostHover",V)],"--n-text-color-disabled":fe||_[Ze("textColorGhostDisabled",V)]}}else if(X){const fe=ne?_.textColor:Q?_.textColorTertiary:_[Ze("color",V)],B=N||fe,D=z!=="default"&&z!=="tertiary";ee={"--n-color":D?Xt(B,{alpha:Number(_.colorOpacitySecondary)}):_.colorSecondary,"--n-color-hover":D?Xt(B,{alpha:Number(_.colorOpacitySecondaryHover)}):_.colorSecondaryHover,"--n-color-pressed":D?Xt(B,{alpha:Number(_.colorOpacitySecondaryPressed)}):_.colorSecondaryPressed,"--n-color-focus":D?Xt(B,{alpha:Number(_.colorOpacitySecondaryHover)}):_.colorSecondaryHover,"--n-color-disabled":_.colorSecondary,"--n-ripple-color":"#0000","--n-text-color":B,"--n-text-color-hover":B,"--n-text-color-pressed":B,"--n-text-color-focus":B,"--n-text-color-disabled":B}}else if(W||q){const fe=ne?_.textColor:Q?_.textColorTertiary:_[Ze("color",V)],B=N||fe;W?(ee["--n-color"]=_.colorTertiary,ee["--n-color-hover"]=_.colorTertiaryHover,ee["--n-color-pressed"]=_.colorTertiaryPressed,ee["--n-color-focus"]=_.colorSecondaryHover,ee["--n-color-disabled"]=_.colorTertiary):(ee["--n-color"]=_.colorQuaternary,ee["--n-color-hover"]=_.colorQuaternaryHover,ee["--n-color-pressed"]=_.colorQuaternaryPressed,ee["--n-color-focus"]=_.colorQuaternaryHover,ee["--n-color-disabled"]=_.colorQuaternary),ee["--n-ripple-color"]="#0000",ee["--n-text-color"]=B,ee["--n-text-color-hover"]=B,ee["--n-text-color-pressed"]=B,ee["--n-text-color-focus"]=B,ee["--n-text-color-disabled"]=B}else ee={"--n-color":N||_[Ze("color",V)],"--n-color-hover":N?nd(N):_[Ze("colorHover",V)],"--n-color-pressed":N?Z0(N):_[Ze("colorPressed",V)],"--n-color-focus":N?nd(N):_[Ze("colorFocus",V)],"--n-color-disabled":N||_[Ze("colorDisabled",V)],"--n-ripple-color":N||_[Ze("rippleColor",V)],"--n-text-color":te||(N?_.textColorPrimary:Q?_.textColorTertiary:_[Ze("textColor",V)]),"--n-text-color-hover":te||(N?_.textColorHoverPrimary:_[Ze("textColorHover",V)]),"--n-text-color-pressed":te||(N?_.textColorPressedPrimary:_[Ze("textColorPressed",V)]),"--n-text-color-focus":te||(N?_.textColorFocusPrimary:_[Ze("textColorFocus",V)]),"--n-text-color-disabled":te||(N?_.textColorDisabledPrimary:_[Ze("textColorDisabled",V)])};let ue={"--n-border":"initial","--n-border-hover":"initial","--n-border-pressed":"initial","--n-border-focus":"initial","--n-border-disabled":"initial"};H?ue={"--n-border":"none","--n-border-hover":"none","--n-border-pressed":"none","--n-border-focus":"none","--n-border-disabled":"none"}:ue={"--n-border":_[Ze("border",V)],"--n-border-hover":_[Ze("borderHover",V)],"--n-border-pressed":_[Ze("borderPressed",V)],"--n-border-focus":_[Ze("borderFocus",V)],"--n-border-disabled":_[Ze("borderDisabled",V)]};const{[Ze("height",T)]:ve,[Ze("fontSize",T)]:Ce,[Ze("padding",T)]:G,[Ze("paddingRound",T)]:Z,[Ze("iconSize",T)]:de,[Ze("borderRadius",T)]:Se,[Ze("iconMargin",T)]:we,waveOpacity:_e}=_,Ee={"--n-width":ie&&!H?ve:"initial","--n-height":H?"initial":ve,"--n-font-size":Ce,"--n-padding":ie||H?"initial":U?Z:G,"--n-icon-size":de,"--n-icon-margin":we,"--n-border-radius":H?"initial":ie||U?ve:Se};return Object.assign(Object.assign(Object.assign(Object.assign({"--n-bezier":S,"--n-bezier-ease-out":w,"--n-ripple-duration":C,"--n-opacity-disabled":A,"--n-wave-opacity":_e},le),ee),ue),Ee)}),b=f?Dr("button",re(()=>{let x="";const{dashed:S,type:w,ghost:_,text:C,color:A,round:M,circle:P,textColor:T,secondary:R,tertiary:z,quaternary:F,strong:H}=e;S&&(x+="a"),_&&(x+="b"),C&&(x+="c"),M&&(x+="d"),P&&(x+="e"),R&&(x+="f"),z&&(x+="g"),F&&(x+="h"),H&&(x+="i"),A&&(x+="j"+ug(A)),T&&(x+="k"+ug(T));const{value:N}=o;return x+="l"+N[0],x+="m"+w[0],x}),y,e):void 0;return{selfElRef:t,waveElRef:r,mergedClsPrefix:p,mergedFocusable:s,mergedSize:o,showBorder:n,enterPressed:i,rtlEnabled:g,handleMousedown:l,handleKeydown:d,handleBlur:h,handleKeyup:u,handleClick:c,customColorCssVars:re(()=>{const{color:x}=e;if(!x)return null;const S=nd(x);return{"--n-border-color":x,"--n-border-color-hover":S,"--n-border-color-pressed":Z0(x),"--n-border-color-focus":S,"--n-border-color-disabled":x}}),cssVars:f?void 0:y,themeClass:b==null?void 0:b.themeClass,onRender:b==null?void 0:b.onRender}},render(){const{mergedClsPrefix:e,tag:t,onRender:r}=this;r==null||r();const i=ti(this.$slots.default,n=>n&&E("span",{class:`${e}-button__content`},n));return E(t,{ref:"selfElRef",class:[this.themeClass,`${e}-button`,`${e}-button--${this.type}-type`,`${e}-button--${this.mergedSize}-type`,this.rtlEnabled&&`${e}-button--rtl`,this.disabled&&`${e}-button--disabled`,this.block&&`${e}-button--block`,this.enterPressed&&`${e}-button--pressed`,!this.text&&this.dashed&&`${e}-button--dashed`,this.color&&`${e}-button--color`,this.secondary&&`${e}-button--secondary`,this.loading&&`${e}-button--loading`,this.ghost&&`${e}-button--ghost`],tabindex:this.mergedFocusable?0:-1,type:this.attrType,style:this.cssVars,disabled:this.disabled,onClick:this.handleClick,onBlur:this.handleBlur,onMousedown:this.handleMousedown,onKeyup:this.handleKeyup,onKeydown:this.handleKeydown},this.iconPlacement==="right"&&i,E(iP,{width:!0},{default:()=>ti(this.$slots.icon,n=>(this.loading||this.renderIcon||n)&&E("span",{class:`${e}-button__icon`,style:{margin:Jf(this.$slots.default)?"0":""}},E(Jp,null,{default:()=>this.loading?E(i0,{clsPrefix:e,key:"loading",class:`${e}-icon-slot`,strokeWidth:20}):E("div",{key:"icon",class:`${e}-icon-slot`,role:"none"},this.renderIcon?this.renderIcon():n)})))}),this.iconPlacement==="left"&&i,this.text?null:E(Mie,{ref:"waveElRef",clsPrefix:e}),this.showBorder?E("div",{"aria-hidden":!0,class:`${e}-button__border`,style:this.customColorCssVars}):null,this.showBorder?E("div",{"aria-hidden":!0,class:`${e}-button__state-border`,style:this.customColorCssVars}):null)}}),_u=ci,Ti="0!important",h6="-1px!important";function Wh(e){return xe(e+"-type",[ge("& +",[oe("button",{},[xe(e+"-type",[he("border",{borderLeftWidth:Ti}),he("state-border",{left:h6})])])])])}function Gh(e){return xe(e+"-type",[ge("& +",[oe("button",[xe(e+"-type",[he("border",{borderTopWidth:Ti}),he("state-border",{top:h6})])])])])}const One=oe("button-group",`
 flex-wrap: nowrap;
 display: inline-flex;
 position: relative;
`,[br("vertical",{flexDirection:"row"},[br("rtl",[oe("button",[ge("&:first-child:not(:last-child)",`
 margin-right: ${Ti};
 border-top-right-radius: ${Ti};
 border-bottom-right-radius: ${Ti};
 `),ge("&:last-child:not(:first-child)",`
 margin-left: ${Ti};
 border-top-left-radius: ${Ti};
 border-bottom-left-radius: ${Ti};
 `),ge("&:not(:first-child):not(:last-child)",`
 margin-left: ${Ti};
 margin-right: ${Ti};
 border-radius: ${Ti};
 `),Wh("default"),xe("ghost",[Wh("primary"),Wh("info"),Wh("success"),Wh("warning"),Wh("error")])])])]),xe("vertical",{flexDirection:"column"},[oe("button",[ge("&:first-child:not(:last-child)",`
 margin-bottom: ${Ti};
 margin-left: ${Ti};
 margin-right: ${Ti};
 border-bottom-left-radius: ${Ti};
 border-bottom-right-radius: ${Ti};
 `),ge("&:last-child:not(:first-child)",`
 margin-top: ${Ti};
 margin-left: ${Ti};
 margin-right: ${Ti};
 border-top-left-radius: ${Ti};
 border-top-right-radius: ${Ti};
 `),ge("&:not(:first-child):not(:last-child)",`
 margin: ${Ti};
 border-radius: ${Ti};
 `),Gh("default"),xe("ghost",[Gh("primary"),Gh("info"),Gh("success"),Gh("warning"),Gh("error")])])])]),Rne={size:{type:String,default:void 0},vertical:Boolean},Ine=je({name:"ButtonGroup",props:Rne,setup(e){const{mergedClsPrefixRef:t,mergedRtlRef:r}=vr(e);return Ph("-button-group",One,t),xr(d6,e),{rtlEnabled:oo("ButtonGroup",r,t),mergedClsPrefix:t}},render(){const{mergedClsPrefix:e}=this;return E("div",{class:[`${e}-button-group`,this.rtlEnabled&&`${e}-button-group--rtl`,this.vertical&&`${e}-button-group--vertical`],role:"group"},this.$slots)}}),Mx=1901,uh=40,zne={date:Gee,month:r0,year:GU,quarter:WU};function kne(e){return(t,r)=>{const i=(e+1)%7;return pre(t,r,{weekStartsOn:i})}}function Da(e,t,r,i=0){return(r==="week"?kne(i):zne[r])(e,t)}function LS(e,t,r,i,n,a){return n==="date"?Lne(e,t,r,i):Bne(e,t,r,i,a)}function Lne(e,t,r,i){let n=!1,a=!1,o=!1;Array.isArray(r)&&(r[0]<e&&e<r[1]&&(n=!0),Da(r[0],e,"date")&&(a=!0),Da(r[1],e,"date")&&(o=!0));const s=r!==null&&(Array.isArray(r)?Da(r[0],e,"date")||Da(r[1],e,"date"):Da(r,e,"date"));return{type:"date",dateObject:{date:To(e),month:pi(e),year:Ei(e)},inCurrentMonth:r0(e,t),isCurrentDate:Da(i,e,"date"),inSpan:n,inSelectedWeek:!1,startOfSpan:a,endOfSpan:o,selected:s,ts:gt(e)}}function f6(e,t,r){const i=new Date(2e3,e,1).getTime();return oi(i,t,{locale:r})}function p6(e,t,r){const i=new Date(e,1,1).getTime();return oi(i,t,{locale:r})}function m6(e,t,r){const i=new Date(2e3,e*3-2,1).getTime();return oi(i,t,{locale:r})}function Bne(e,t,r,i,n){let a=!1,o=!1,s=!1;Array.isArray(r)&&(r[0]<e&&e<r[1]&&(a=!0),Da(r[0],e,"week",n)&&(o=!0),Da(r[1],e,"week",n)&&(s=!0));const l=r!==null&&(Array.isArray(r)?Da(r[0],e,"week",n)||Da(r[1],e,"week",n):Da(r,e,"week",n));return{type:"date",dateObject:{date:To(e),month:pi(e),year:Ei(e)},inCurrentMonth:r0(e,t),isCurrentDate:Da(i,e,"date"),inSpan:a,startOfSpan:o,endOfSpan:s,selected:!1,inSelectedWeek:l,ts:gt(e)}}function Fne(e,t,r,{monthFormat:i}){return{type:"month",monthFormat:i,dateObject:{month:pi(e),year:Ei(e)},isCurrent:r0(r,e),selected:t!==null&&Da(t,e,"month"),ts:gt(e)}}function Nne(e,t,r,{yearFormat:i}){return{type:"year",yearFormat:i,dateObject:{year:Ei(e)},isCurrent:GU(r,e),selected:t!==null&&Da(t,e,"year"),ts:gt(e)}}function Une(e,t,r,{quarterFormat:i}){return{type:"quarter",quarterFormat:i,dateObject:{quarter:qee(e),year:Ei(e)},isCurrent:WU(r,e),selected:t!==null&&Da(t,e,"quarter"),ts:gt(e)}}function X2(e,t,r,i,n=!1,a=!1){const o=a?"week":"date",s=pi(e);let l=gt(Hl(e)),c=gt(X0(l,-1));const u=[];let d=!n;for(;hte(c)!==i||d;)u.unshift(LS(c,e,t,r,o,i)),c=gt(X0(c,-1)),d=!1;for(;pi(l)===s;)u.push(LS(l,e,t,r,o,i)),l=gt(X0(l,1));const h=n?u.length<=28?28:u.length<=35?35:42:42;for(;u.length<h;)u.push(LS(l,e,t,r,o,i)),l=gt(X0(l,1));return u}function K2(e,t,r,i){const n=[],a=QT(e);for(let o=0;o<12;o++)n.push(Fne(gt(Kn(a,o)),t,r,i));return n}function Q2(e,t,r,i){const n=[],a=QT(e);for(let o=0;o<4;o++)n.push(Une(gt(jee(a,o)),t,r,i));return n}function Z2(e,t,r){const i=[],n=new Date(Mx,0,1);for(let a=0;a<200;a++)i.push(Nne(gt(H2(n,a)),e,t,r));return i}function qa(e,t,r,i){const n=dre(e,t,r,i);return ko(n)?oi(n,t,i)===e?n:new Date(NaN):n}function zb(e){if(e===void 0)return;if(typeof e=="number")return e;const[t,r,i]=e.split(":");return{hours:Number(t),minutes:Number(r),seconds:Number(i)}}function $h(e,t){return Array.isArray(e)?e[t==="start"?0:1]:null}const jne={sizeSmall:"14px",sizeMedium:"16px",sizeLarge:"18px",labelPadding:"0 8px",labelFontWeight:"400"},Vne=e=>{const{baseColor:t,inputColorDisabled:r,cardColor:i,modalColor:n,popoverColor:a,textColorDisabled:o,borderColor:s,primaryColor:l,textColor2:c,fontSizeSmall:u,fontSizeMedium:d,fontSizeLarge:h,borderRadiusSmall:f,lineHeight:p}=e;return Object.assign(Object.assign({},jne),{labelLineHeight:p,fontSizeSmall:u,fontSizeMedium:d,fontSizeLarge:h,borderRadius:f,color:t,colorChecked:l,colorDisabled:r,colorDisabledChecked:r,colorTableHeader:i,colorTableHeaderModal:n,colorTableHeaderPopover:a,checkMarkColor:t,checkMarkColorDisabled:o,checkMarkColorDisabledChecked:o,border:`1px solid ${s}`,borderDisabled:`1px solid ${s}`,borderDisabledChecked:`1px solid ${s}`,borderChecked:`1px solid ${l}`,borderFocus:`1px solid ${l}`,boxShadowFocus:`0 0 0 2px ${Xt(l,{alpha:.3})}`,textColor:c,textColorDisabled:o})},v6={name:"Checkbox",common:$r,self:Vne},Hne=E("svg",{viewBox:"0 0 64 64",class:"check-icon"},E("path",{d:"M50.42,16.76L22.34,39.45l-8.1-11.46c-1.12-1.58-3.3-1.96-4.88-0.84c-1.58,1.12-1.95,3.3-0.84,4.88l10.26,14.51  c0.56,0.79,1.42,1.31,2.38,1.45c0.16,0.02,0.32,0.03,0.48,0.03c0.8,0,1.57-0.27,2.2-0.78l30.99-25.03c1.5-1.21,1.74-3.42,0.52-4.92  C54.13,15.78,51.93,15.55,50.42,16.76z"})),Wne=E("svg",{viewBox:"0 0 100 100",class:"line-icon"},E("path",{d:"M80.2,55.5H21.4c-2.8,0-5.1-2.5-5.1-5.5l0,0c0-3,2.3-5.5,5.1-5.5h58.7c2.8,0,5.1,2.5,5.1,5.5l0,0C85.2,53.1,82.9,55.5,80.2,55.5z"})),g6="n-checkbox-group",Gne={min:Number,max:Number,size:String,value:Array,defaultValue:{type:Array,default:null},disabled:{type:Boolean,default:void 0},"onUpdate:value":[Function,Array],onUpdateValue:[Function,Array],onChange:[Function,Array]},$ne=je({name:"CheckboxGroup",props:Gne,setup(e){const{mergedClsPrefixRef:t}=vr(e),r=gl(e),{mergedSizeRef:i,mergedDisabledRef:n}=r,a=me(e.defaultValue),o=re(()=>e.value),s=Hn(o,a),l=re(()=>{var d;return((d=s.value)===null||d===void 0?void 0:d.length)||0}),c=re(()=>Array.isArray(s.value)?new Set(s.value):new Set);function u(d,h){const{nTriggerFormInput:f,nTriggerFormChange:p}=r,{onChange:v,"onUpdate:value":m,onUpdateValue:g}=e;if(Array.isArray(s.value)){const y=Array.from(s.value),b=y.findIndex(x=>x===h);d?~b||(y.push(h),g&&ct(g,y,{actionType:"check",value:h}),m&&ct(m,y,{actionType:"check",value:h}),f(),p(),a.value=y,v&&ct(v,y)):~b&&(y.splice(b,1),g&&ct(g,y,{actionType:"uncheck",value:h}),m&&ct(m,y,{actionType:"uncheck",value:h}),v&&ct(v,y),a.value=y,f(),p())}else d?(g&&ct(g,[h],{actionType:"check",value:h}),m&&ct(m,[h],{actionType:"check",value:h}),v&&ct(v,[h]),a.value=[h],f(),p()):(g&&ct(g,[],{actionType:"uncheck",value:h}),m&&ct(m,[],{actionType:"uncheck",value:h}),v&&ct(v,[]),a.value=[],f(),p())}return xr(g6,{checkedCountRef:l,maxRef:pt(e,"max"),minRef:pt(e,"min"),valueSetRef:c,disabledRef:n,mergedSizeRef:i,toggleCheckbox:u}),{mergedClsPrefix:t}},render(){return E("div",{class:`${this.mergedClsPrefix}-checkbox-group`,role:"group"},this.$slots)}}),qne=ge([oe("checkbox",`
 font-size: var(--n-font-size);
 outline: none;
 cursor: pointer;
 display: inline-flex;
 flex-wrap: nowrap;
 align-items: flex-start;
 word-break: break-word;
 line-height: var(--n-size);
 --n-merged-color-table: var(--n-color-table);
 `,[xe("show-label","line-height: var(--n-label-line-height);"),ge("&:hover",[oe("checkbox-box",[he("border","border: var(--n-border-checked);")])]),ge("&:focus:not(:active)",[oe("checkbox-box",[he("border",`
 border: var(--n-border-focus);
 box-shadow: var(--n-box-shadow-focus);
 `)])]),xe("inside-table",[oe("checkbox-box",`
 background-color: var(--n-merged-color-table);
 `)]),xe("checked",[oe("checkbox-box",`
 background-color: var(--n-color-checked);
 `,[oe("checkbox-icon",[ge(".check-icon",`
 opacity: 1;
 transform: scale(1);
 `)])])]),xe("indeterminate",[oe("checkbox-box",[oe("checkbox-icon",[ge(".check-icon",`
 opacity: 0;
 transform: scale(.5);
 `),ge(".line-icon",`
 opacity: 1;
 transform: scale(1);
 `)])])]),xe("checked, indeterminate",[ge("&:focus:not(:active)",[oe("checkbox-box",[he("border",`
 border: var(--n-border-checked);
 box-shadow: var(--n-box-shadow-focus);
 `)])]),oe("checkbox-box",`
 background-color: var(--n-color-checked);
 border-left: 0;
 border-top: 0;
 `,[he("border",{border:"var(--n-border-checked)"})])]),xe("disabled",{cursor:"not-allowed"},[xe("checked",[oe("checkbox-box",`
 background-color: var(--n-color-disabled-checked);
 `,[he("border",{border:"var(--n-border-disabled-checked)"}),oe("checkbox-icon",[ge(".check-icon, .line-icon",{fill:"var(--n-check-mark-color-disabled-checked)"})])])]),oe("checkbox-box",`
 background-color: var(--n-color-disabled);
 `,[he("border",`
 border: var(--n-border-disabled);
 `),oe("checkbox-icon",[ge(".check-icon, .line-icon",`
 fill: var(--n-check-mark-color-disabled);
 `)])]),he("label",`
 color: var(--n-text-color-disabled);
 `)]),oe("checkbox-box-wrapper",`
 position: relative;
 width: var(--n-size);
 flex-shrink: 0;
 flex-grow: 0;
 user-select: none;
 -webkit-user-select: none;
 `),oe("checkbox-box",`
 position: absolute;
 left: 0;
 top: 50%;
 transform: translateY(-50%);
 height: var(--n-size);
 width: var(--n-size);
 display: inline-block;
 box-sizing: border-box;
 border-radius: var(--n-border-radius);
 background-color: var(--n-color);
 transition: background-color 0.3s var(--n-bezier);
 `,[he("border",`
 transition:
 border-color .3s var(--n-bezier),
 box-shadow .3s var(--n-bezier);
 border-radius: inherit;
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 border: var(--n-border);
 `),oe("checkbox-icon",`
 display: flex;
 align-items: center;
 justify-content: center;
 position: absolute;
 left: 1px;
 right: 1px;
 top: 1px;
 bottom: 1px;
 `,[ge(".check-icon, .line-icon",`
 width: 100%;
 fill: var(--n-check-mark-color);
 opacity: 0;
 transform: scale(0.5);
 transform-origin: center;
 transition:
 fill 0.3s var(--n-bezier),
 transform 0.3s var(--n-bezier),
 opacity 0.3s var(--n-bezier),
 border-color 0.3s var(--n-bezier);
 `),ku({left:"1px",top:"1px"})])]),he("label",`
 color: var(--n-text-color);
 transition: color .3s var(--n-bezier);
 user-select: none;
 -webkit-user-select: none;
 padding: var(--n-label-padding);
 font-weight: var(--n-label-font-weight);
 `,[ge("&:empty",{display:"none"})])]),kN(oe("checkbox",`
 --n-merged-color-table: var(--n-color-table-modal);
 `)),LN(oe("checkbox",`
 --n-merged-color-table: var(--n-color-table-popover);
 `))]),Yne=Object.assign(Object.assign({},bt.props),{size:String,checked:{type:[Boolean,String,Number],default:void 0},defaultChecked:{type:[Boolean,String,Number],default:!1},value:[String,Number],disabled:{type:Boolean,default:void 0},indeterminate:Boolean,label:String,focusable:{type:Boolean,default:!0},checkedValue:{type:[Boolean,String,Number],default:!0},uncheckedValue:{type:[Boolean,String,Number],default:!1},"onUpdate:checked":[Function,Array],onUpdateChecked:[Function,Array],privateInsideTable:Boolean,onChange:[Function,Array]}),y6=je({name:"Checkbox",props:Yne,setup(e){const t=me(null),{mergedClsPrefixRef:r,inlineThemeDisabled:i,mergedRtlRef:n}=vr(e),a=gl(e,{mergedSize(w){const{size:_}=e;if(_!==void 0)return _;if(l){const{value:C}=l.mergedSizeRef;if(C!==void 0)return C}if(w){const{mergedSize:C}=w;if(C!==void 0)return C.value}return"medium"},mergedDisabled(w){const{disabled:_}=e;if(_!==void 0)return _;if(l){if(l.disabledRef.value)return!0;const{maxRef:{value:C},checkedCountRef:A}=l;if(C!==void 0&&A.value>=C&&!h.value)return!0;const{minRef:{value:M}}=l;if(M!==void 0&&A.value<=M&&h.value)return!0}return w?w.disabled.value:!1}}),{mergedDisabledRef:o,mergedSizeRef:s}=a,l=_t(g6,null),c=me(e.defaultChecked),u=pt(e,"checked"),d=Hn(u,c),h=qi(()=>{if(l){const w=l.valueSetRef.value;return w&&e.value!==void 0?w.has(e.value):!1}else return d.value===e.checkedValue}),f=bt("Checkbox","-checkbox",qne,v6,e,r);function p(w){if(l&&e.value!==void 0)l.toggleCheckbox(!h.value,e.value);else{const{onChange:_,"onUpdate:checked":C,onUpdateChecked:A}=e,{nTriggerFormInput:M,nTriggerFormChange:P}=a,T=h.value?e.uncheckedValue:e.checkedValue;C&&ct(C,T,w),A&&ct(A,T,w),_&&ct(_,T,w),M(),P(),c.value=T}}function v(w){o.value||p(w)}function m(w){if(!o.value)switch(w.key){case" ":case"Enter":p(w)}}function g(w){switch(w.key){case" ":w.preventDefault()}}const y={focus:()=>{var w;(w=t.value)===null||w===void 0||w.focus()},blur:()=>{var w;(w=t.value)===null||w===void 0||w.blur()}},b=oo("Checkbox",n,r),x=re(()=>{const{value:w}=s,{common:{cubicBezierEaseInOut:_},self:{borderRadius:C,color:A,colorChecked:M,colorDisabled:P,colorTableHeader:T,colorTableHeaderModal:R,colorTableHeaderPopover:z,checkMarkColor:F,checkMarkColorDisabled:H,border:N,borderFocus:U,borderDisabled:ie,borderChecked:te,boxShadowFocus:X,textColor:W,textColorDisabled:q,checkMarkColorDisabledChecked:$,colorDisabledChecked:le,borderDisabledChecked:ee,labelPadding:Q,labelLineHeight:ne,labelFontWeight:V,[Ze("fontSize",w)]:ue,[Ze("size",w)]:ve}}=f.value;return{"--n-label-line-height":ne,"--n-label-font-weight":V,"--n-size":ve,"--n-bezier":_,"--n-border-radius":C,"--n-border":N,"--n-border-checked":te,"--n-border-focus":U,"--n-border-disabled":ie,"--n-border-disabled-checked":ee,"--n-box-shadow-focus":X,"--n-color":A,"--n-color-checked":M,"--n-color-table":T,"--n-color-table-modal":R,"--n-color-table-popover":z,"--n-color-disabled":P,"--n-color-disabled-checked":le,"--n-text-color":W,"--n-text-color-disabled":q,"--n-check-mark-color":F,"--n-check-mark-color-disabled":H,"--n-check-mark-color-disabled-checked":$,"--n-font-size":ue,"--n-label-padding":Q}}),S=i?Dr("checkbox",re(()=>s.value[0]),x,e):void 0;return Object.assign(a,y,{rtlEnabled:b,selfRef:t,mergedClsPrefix:r,mergedDisabled:o,renderedChecked:h,mergedTheme:f,labelId:oh(),handleClick:v,handleKeyUp:m,handleKeyDown:g,cssVars:i?void 0:x,themeClass:S==null?void 0:S.themeClass,onRender:S==null?void 0:S.onRender})},render(){var e;const{$slots:t,renderedChecked:r,mergedDisabled:i,indeterminate:n,privateInsideTable:a,cssVars:o,labelId:s,label:l,mergedClsPrefix:c,focusable:u,handleKeyUp:d,handleKeyDown:h,handleClick:f}=this;(e=this.onRender)===null||e===void 0||e.call(this);const p=ti(t.default,v=>l||v?E("span",{class:`${c}-checkbox__label`,id:s},l||v):null);return E("div",{ref:"selfRef",class:[`${c}-checkbox`,this.themeClass,this.rtlEnabled&&`${c}-checkbox--rtl`,r&&`${c}-checkbox--checked`,i&&`${c}-checkbox--disabled`,n&&`${c}-checkbox--indeterminate`,a&&`${c}-checkbox--inside-table`,p&&`${c}-checkbox--show-label`],tabindex:i||!u?void 0:0,role:"checkbox","aria-checked":n?"mixed":r,"aria-labelledby":s,style:o,onKeyup:d,onKeydown:h,onClick:f,onMousedown:()=>{Ui("selectstart",window,v=>{v.preventDefault()},{once:!0})}},E("div",{class:`${c}-checkbox-box-wrapper`},"",E("div",{class:`${c}-checkbox-box`},E(Jp,null,{default:()=>this.indeterminate?E("div",{key:"indeterminate",class:`${c}-checkbox-icon`},Wne):E("div",{key:"check",class:`${c}-checkbox-icon`},Hne)}),E("div",{class:`${c}-checkbox-box__border`}))),p)}});function Xne(e){const{boxShadow2:t}=e;return{menuBoxShadow:t}}const Kne={name:"Select",common:$r,peers:{InternalSelection:i6,InternalSelectMenu:oP},self:Xne},Qne=ge([oe("select",`
 z-index: auto;
 outline: none;
 width: 100%;
 position: relative;
 `),oe("select-menu",`
 margin: 4px 0;
 box-shadow: var(--n-menu-box-shadow);
 `,[tm({originalTransition:"background-color .3s var(--n-bezier), box-shadow .3s var(--n-bezier)"})])]),Zne=Object.assign(Object.assign({},bt.props),{to:Wn.propTo,bordered:{type:Boolean,default:void 0},clearable:Boolean,clearFilterAfterSelect:{type:Boolean,default:!0},options:{type:Array,default:()=>[]},defaultValue:{type:[String,Number,Array],default:null},keyboard:{type:Boolean,default:!0},value:[String,Number,Array],placeholder:String,menuProps:Object,multiple:Boolean,size:String,filterable:Boolean,disabled:{type:Boolean,default:void 0},remote:Boolean,loading:Boolean,filter:Function,placement:{type:String,default:"bottom-start"},widthMode:{type:String,default:"trigger"},tag:Boolean,onCreate:Function,fallbackOption:{type:[Function,Boolean],default:void 0},show:{type:Boolean,default:void 0},showArrow:{type:Boolean,default:!0},maxTagCount:[Number,String],ellipsisTagPopoverProps:Object,consistentMenuWidth:{type:Boolean,default:!0},virtualScroll:{type:Boolean,default:!0},labelField:{type:String,default:"label"},valueField:{type:String,default:"value"},childrenField:{type:String,default:"children"},renderLabel:Function,renderOption:Function,renderTag:Function,"onUpdate:value":[Function,Array],inputProps:Object,nodeProps:Function,ignoreComposition:{type:Boolean,default:!0},showOnFocus:Boolean,onUpdateValue:[Function,Array],onBlur:[Function,Array],onClear:[Function,Array],onFocus:[Function,Array],onScroll:[Function,Array],onSearch:[Function,Array],onUpdateShow:[Function,Array],"onUpdate:show":[Function,Array],displayDirective:{type:String,default:"show"},resetMenuOnOptionsChange:{type:Boolean,default:!0},status:String,showCheckmark:{type:Boolean,default:!0},onChange:[Function,Array],items:Array}),Jne=je({name:"Select",props:Zne,setup(e){const{mergedClsPrefixRef:t,mergedBorderedRef:r,namespaceRef:i,inlineThemeDisabled:n}=vr(e),a=bt("Select","-select",Qne,Kne,e,t),o=me(e.defaultValue),s=pt(e,"value"),l=Hn(s,o),c=me(!1),u=me(""),d=re(()=>{const{valueField:se,childrenField:Be}=e,Ye=o6(se,Be);return rp(T.value,Ye)}),h=re(()=>Kie(M.value,e.valueField,e.childrenField)),f=me(!1),p=Hn(pt(e,"show"),f),v=me(null),m=me(null),g=me(null),{localeRef:y}=wc("Select"),b=re(()=>{var se;return(se=e.placeholder)!==null&&se!==void 0?se:y.value.placeholder}),x=Sp(e,["items","options"]),S=[],w=me([]),_=me([]),C=me(new Map),A=re(()=>{const{fallbackOption:se}=e;if(se===void 0){const{labelField:Be,valueField:Ye}=e;return pe=>({[Be]:String(pe),[Ye]:pe})}return se===!1?!1:Be=>Object.assign(se(Be),{value:Be})}),M=re(()=>_.value.concat(w.value).concat(x.value)),P=re(()=>{const{filter:se}=e;if(se)return se;const{labelField:Be,valueField:Ye}=e;return(pe,Te)=>{if(!Te)return!1;const ce=Te[Be];if(typeof ce=="string")return RS(pe,ce);const Re=Te[Ye];return typeof Re=="string"?RS(pe,Re):typeof Re=="number"?RS(pe,String(Re)):!1}}),T=re(()=>{if(e.remote)return x.value;{const{value:se}=M,{value:Be}=u;return!Be.length||!e.filterable?se:Xie(se,P.value,Be,e.childrenField)}});function R(se){const Be=e.remote,{value:Ye}=C,{value:pe}=h,{value:Te}=A,ce=[];return se.forEach(Re=>{if(pe.has(Re))ce.push(pe.get(Re));else if(Be&&Ye.has(Re))ce.push(Ye.get(Re));else if(Te){const $e=Te(Re);$e&&ce.push($e)}}),ce}const z=re(()=>{if(e.multiple){const{value:se}=l;return Array.isArray(se)?R(se):[]}return null}),F=re(()=>{const{value:se}=l;return!e.multiple&&!Array.isArray(se)?se===null?null:R([se])[0]||null:null}),H=gl(e),{mergedSizeRef:N,mergedDisabledRef:U,mergedStatusRef:ie}=H;function te(se,Be){const{onChange:Ye,"onUpdate:value":pe,onUpdateValue:Te}=e,{nTriggerFormChange:ce,nTriggerFormInput:Re}=H;Ye&&ct(Ye,se,Be),Te&&ct(Te,se,Be),pe&&ct(pe,se,Be),o.value=se,ce(),Re()}function X(se){const{onBlur:Be}=e,{nTriggerFormBlur:Ye}=H;Be&&ct(Be,se),Ye()}function W(){const{onClear:se}=e;se&&ct(se)}function q(se){const{onFocus:Be,showOnFocus:Ye}=e,{nTriggerFormFocus:pe}=H;Be&&ct(Be,se),pe(),Ye&&ne()}function $(se){const{onSearch:Be}=e;Be&&ct(Be,se)}function le(se){const{onScroll:Be}=e;Be&&ct(Be,se)}function ee(){var se;const{remote:Be,multiple:Ye}=e;if(Be){const{value:pe}=C;if(Ye){const{valueField:Te}=e;(se=z.value)===null||se===void 0||se.forEach(ce=>{pe.set(ce[Te],ce)})}else{const Te=F.value;Te&&pe.set(Te[e.valueField],Te)}}}function Q(se){const{onUpdateShow:Be,"onUpdate:show":Ye}=e;Be&&ct(Be,se),Ye&&ct(Ye,se),f.value=se}function ne(){U.value||(Q(!0),f.value=!0,e.filterable&&et())}function V(){Q(!1)}function ue(){u.value="",_.value=S}const ve=me(!1);function Ce(){e.filterable&&(ve.value=!0)}function G(){e.filterable&&(ve.value=!1,p.value||ue())}function Z(){U.value||(p.value?e.filterable?et():V():ne())}function de(se){var Be,Ye;!((Ye=(Be=g.value)===null||Be===void 0?void 0:Be.selfRef)===null||Ye===void 0)&&Ye.contains(se.relatedTarget)||(c.value=!1,X(se),V())}function Se(se){q(se),c.value=!0}function we(se){c.value=!0}function _e(se){var Be;!((Be=v.value)===null||Be===void 0)&&Be.$el.contains(se.relatedTarget)||(c.value=!1,X(se),V())}function Ee(){var se;(se=v.value)===null||se===void 0||se.focus(),V()}function fe(se){var Be;p.value&&(!((Be=v.value)===null||Be===void 0)&&Be.$el.contains(lc(se))||V())}function B(se){if(!Array.isArray(se))return[];if(A.value)return Array.from(se);{const{remote:Be}=e,{value:Ye}=h;if(Be){const{value:pe}=C;return se.filter(Te=>Ye.has(Te)||pe.has(Te))}else return se.filter(pe=>Ye.has(pe))}}function D(se){I(se.rawNode)}function I(se){if(U.value)return;const{tag:Be,remote:Ye,clearFilterAfterSelect:pe,valueField:Te}=e;if(Be&&!Ye){const{value:ce}=_,Re=ce[0]||null;if(Re){const $e=w.value;$e.length?$e.push(Re):w.value=[Re],_.value=S}}if(Ye&&C.value.set(se[Te],se),e.multiple){const ce=B(l.value),Re=ce.findIndex($e=>$e===se[Te]);if(~Re){if(ce.splice(Re,1),Be&&!Ye){const $e=O(se[Te]);~$e&&(w.value.splice($e,1),pe&&(u.value=""))}}else ce.push(se[Te]),pe&&(u.value="");te(ce,R(ce))}else{if(Be&&!Ye){const ce=O(se[Te]);~ce?w.value=[w.value[ce]]:w.value=S}ke(),V(),te(se[Te],se)}}function O(se){return w.value.findIndex(Ye=>Ye[e.valueField]===se)}function j(se){p.value||ne();const{value:Be}=se.target;u.value=Be;const{tag:Ye,remote:pe}=e;if($(Be),Ye&&!pe){if(!Be){_.value=S;return}const{onCreate:Te}=e,ce=Te?Te(Be):{[e.labelField]:Be,[e.valueField]:Be},{valueField:Re,labelField:$e}=e;x.value.some(at=>at[Re]===ce[Re]||at[$e]===ce[$e])||w.value.some(at=>at[Re]===ce[Re]||at[$e]===ce[$e])?_.value=S:_.value=[ce]}}function L(se){se.stopPropagation();const{multiple:Be}=e;!Be&&e.filterable&&V(),W(),Be?te([],[]):te(null,null)}function Ae(se){!Ou(se,"action")&&!Ou(se,"empty")&&se.preventDefault()}function We(se){le(se)}function Ve(se){var Be,Ye,pe,Te,ce;if(!e.keyboard){se.preventDefault();return}switch(se.key){case" ":if(e.filterable)break;se.preventDefault();case"Enter":if(!(!((Be=v.value)===null||Be===void 0)&&Be.isComposing)){if(p.value){const Re=(Ye=g.value)===null||Ye===void 0?void 0:Ye.getPendingTmNode();Re?D(Re):e.filterable||(V(),ke())}else if(ne(),e.tag&&ve.value){const Re=_.value[0];if(Re){const $e=Re[e.valueField],{value:at}=l;e.multiple&&Array.isArray(at)&&at.some(Yt=>Yt===$e)||I(Re)}}}se.preventDefault();break;case"ArrowUp":if(se.preventDefault(),e.loading)return;p.value&&((pe=g.value)===null||pe===void 0||pe.prev());break;case"ArrowDown":if(se.preventDefault(),e.loading)return;p.value?(Te=g.value)===null||Te===void 0||Te.next():ne();break;case"Escape":p.value&&(dg(se),V()),(ce=v.value)===null||ce===void 0||ce.focus();break}}function ke(){var se;(se=v.value)===null||se===void 0||se.focus()}function et(){var se;(se=v.value)===null||se===void 0||se.focusInput()}function nt(){var se;p.value&&((se=m.value)===null||se===void 0||se.syncPosition())}ee(),rr(pt(e,"options"),ee);const lt={focus:()=>{var se;(se=v.value)===null||se===void 0||se.focus()},focusInput:()=>{var se;(se=v.value)===null||se===void 0||se.focusInput()},blur:()=>{var se;(se=v.value)===null||se===void 0||se.blur()},blurInput:()=>{var se;(se=v.value)===null||se===void 0||se.blurInput()}},ut=re(()=>{const{self:{menuBoxShadow:se}}=a.value;return{"--n-menu-box-shadow":se}}),vt=n?Dr("select",void 0,ut,e):void 0;return Object.assign(Object.assign({},lt),{mergedStatus:ie,mergedClsPrefix:t,mergedBordered:r,namespace:i,treeMate:d,isMounted:Yu(),triggerRef:v,menuRef:g,pattern:u,uncontrolledShow:f,mergedShow:p,adjustedTo:Wn(e),uncontrolledValue:o,mergedValue:l,followerRef:m,localizedPlaceholder:b,selectedOption:F,selectedOptions:z,mergedSize:N,mergedDisabled:U,focused:c,activeWithoutMenuOpen:ve,inlineThemeDisabled:n,onTriggerInputFocus:Ce,onTriggerInputBlur:G,handleTriggerOrMenuResize:nt,handleMenuFocus:we,handleMenuBlur:_e,handleMenuTabOut:Ee,handleTriggerClick:Z,handleToggle:D,handleDeleteOption:I,handlePatternInput:j,handleClear:L,handleTriggerBlur:de,handleTriggerFocus:Se,handleKeydown:Ve,handleMenuAfterLeave:ue,handleMenuClickOutside:fe,handleMenuScroll:We,handleMenuKeydown:Ve,handleMenuMousedown:Ae,mergedTheme:a,cssVars:n?void 0:ut,themeClass:vt==null?void 0:vt.themeClass,onRender:vt==null?void 0:vt.onRender})},render(){return E("div",{class:`${this.mergedClsPrefix}-select`},E(wh,null,{default:()=>[E(Sh,null,{default:()=>E(Gie,{ref:"triggerRef",inlineThemeDisabled:this.inlineThemeDisabled,status:this.mergedStatus,inputProps:this.inputProps,clsPrefix:this.mergedClsPrefix,showArrow:this.showArrow,maxTagCount:this.maxTagCount,ellipsisTagPopoverProps:this.ellipsisTagPopoverProps,bordered:this.mergedBordered,active:this.activeWithoutMenuOpen||this.mergedShow,pattern:this.pattern,placeholder:this.localizedPlaceholder,selectedOption:this.selectedOption,selectedOptions:this.selectedOptions,multiple:this.multiple,renderTag:this.renderTag,renderLabel:this.renderLabel,filterable:this.filterable,clearable:this.clearable,disabled:this.mergedDisabled,size:this.mergedSize,theme:this.mergedTheme.peers.InternalSelection,labelField:this.labelField,valueField:this.valueField,themeOverrides:this.mergedTheme.peerOverrides.InternalSelection,loading:this.loading,focused:this.focused,onClick:this.handleTriggerClick,onDeleteOption:this.handleDeleteOption,onPatternInput:this.handlePatternInput,onClear:this.handleClear,onBlur:this.handleTriggerBlur,onFocus:this.handleTriggerFocus,onKeydown:this.handleKeydown,onPatternBlur:this.onTriggerInputBlur,onPatternFocus:this.onTriggerInputFocus,onResize:this.handleTriggerOrMenuResize,ignoreComposition:this.ignoreComposition},{arrow:()=>{var e,t;return[(t=(e=this.$slots).arrow)===null||t===void 0?void 0:t.call(e)]}})}),E(Ch,{ref:"followerRef",show:this.mergedShow,to:this.adjustedTo,teleportDisabled:this.adjustedTo===Wn.tdkey,containerClass:this.namespace,width:this.consistentMenuWidth?"target":void 0,minWidth:"target",placement:this.placement},{default:()=>E(La,{name:"fade-in-scale-up-transition",appear:this.isMounted,onAfterLeave:this.handleMenuAfterLeave},{default:()=>{var e,t,r;return this.mergedShow||this.displayDirective==="show"?((e=this.onRender)===null||e===void 0||e.call(this),io(E(ZU,Object.assign({},this.menuProps,{ref:"menuRef",onResize:this.handleTriggerOrMenuResize,inlineThemeDisabled:this.inlineThemeDisabled,virtualScroll:this.consistentMenuWidth&&this.virtualScroll,class:[`${this.mergedClsPrefix}-select-menu`,this.themeClass,(t=this.menuProps)===null||t===void 0?void 0:t.class],clsPrefix:this.mergedClsPrefix,focusable:!0,labelField:this.labelField,valueField:this.valueField,autoPending:!0,nodeProps:this.nodeProps,theme:this.mergedTheme.peers.InternalSelectMenu,themeOverrides:this.mergedTheme.peerOverrides.InternalSelectMenu,treeMate:this.treeMate,multiple:this.multiple,size:"medium",renderOption:this.renderOption,renderLabel:this.renderLabel,value:this.mergedValue,style:[(r=this.menuProps)===null||r===void 0?void 0:r.style,this.cssVars],onToggle:this.handleToggle,onScroll:this.handleMenuScroll,onFocus:this.handleMenuFocus,onBlur:this.handleMenuBlur,onKeydown:this.handleMenuKeydown,onTabOut:this.handleMenuTabOut,onMousedown:this.handleMenuMousedown,show:this.mergedShow,showCheckmark:this.showCheckmark,resetMenuOnOptionsChange:this.resetMenuOnOptionsChange}),{empty:()=>{var i,n;return[(n=(i=this.$slots).empty)===null||n===void 0?void 0:n.call(i)]},header:()=>{var i,n;return[(n=(i=this.$slots).header)===null||n===void 0?void 0:n.call(i)]},action:()=>{var i,n;return[(n=(i=this.$slots).action)===null||n===void 0?void 0:n.call(i)]}}),this.displayDirective==="show"?[[nh,this.mergedShow],[Ru,this.handleMenuClickOutside,void 0,{capture:!0}]]:[[Ru,this.handleMenuClickOutside,void 0,{capture:!0}]])):null}})})]}))}}),eae={padding:"8px 14px"},tae=e=>{const{borderRadius:t,boxShadow2:r,baseColor:i}=e;return Object.assign(Object.assign({},eae),{borderRadius:t,boxShadow:r,color:il(i,"rgba(0, 0, 0, .85)"),textColor:i})},b6={name:"Tooltip",common:$r,peers:{Popover:uw},self:tae},rae={padding:"4px 0",optionIconSizeSmall:"14px",optionIconSizeMedium:"16px",optionIconSizeLarge:"16px",optionIconSizeHuge:"18px",optionSuffixWidthSmall:"14px",optionSuffixWidthMedium:"14px",optionSuffixWidthLarge:"16px",optionSuffixWidthHuge:"16px",optionIconSuffixWidthSmall:"32px",optionIconSuffixWidthMedium:"32px",optionIconSuffixWidthLarge:"36px",optionIconSuffixWidthHuge:"36px",optionPrefixWidthSmall:"14px",optionPrefixWidthMedium:"14px",optionPrefixWidthLarge:"16px",optionPrefixWidthHuge:"16px",optionIconPrefixWidthSmall:"36px",optionIconPrefixWidthMedium:"36px",optionIconPrefixWidthLarge:"40px",optionIconPrefixWidthHuge:"40px"},iae=e=>{const{primaryColor:t,textColor2:r,dividerColor:i,hoverColor:n,popoverColor:a,invertedColor:o,borderRadius:s,fontSizeSmall:l,fontSizeMedium:c,fontSizeLarge:u,fontSizeHuge:d,heightSmall:h,heightMedium:f,heightLarge:p,heightHuge:v,textColor3:m,opacityDisabled:g}=e;return Object.assign(Object.assign({},rae),{optionHeightSmall:h,optionHeightMedium:f,optionHeightLarge:p,optionHeightHuge:v,borderRadius:s,fontSizeSmall:l,fontSizeMedium:c,fontSizeLarge:u,fontSizeHuge:d,optionTextColor:r,optionTextColorHover:r,optionTextColorActive:t,optionTextColorChildActive:t,color:a,dividerColor:i,suffixColor:r,prefixColor:r,optionColorHover:n,optionColorActive:Xt(t,{alpha:.1}),groupHeaderTextColor:m,optionTextColorInverted:"#BBB",optionTextColorHoverInverted:"#FFF",optionTextColorActiveInverted:"#FFF",optionTextColorChildActiveInverted:"#FFF",colorInverted:o,dividerColorInverted:"#BBB",suffixColorInverted:"#BBB",prefixColorInverted:"#BBB",optionColorHoverInverted:t,optionColorActiveInverted:t,groupHeaderTextColorInverted:"#AAA",optionOpacityDisabled:g})},x6={name:"Dropdown",common:$r,peers:{Popover:uw},self:iae},nae=Object.assign(Object.assign({},dw),bt.props),aae=je({name:"Tooltip",props:nae,__popover__:!0,setup(e){const{mergedClsPrefixRef:t}=vr(e),r=bt("Tooltip","-tooltip",void 0,b6,e,t),i=me(null);return Object.assign(Object.assign({},{syncPosition(){i.value.syncPosition()},setShow(a){i.value.setShow(a)}}),{popoverRef:i,mergedTheme:r,popoverThemeOverrides:re(()=>r.value.self)})},render(){const{mergedTheme:e,internalExtraClass:t}=this;return E(sP,Object.assign(Object.assign({},this.$props),{theme:e.peers.Popover,themeOverrides:e.peerOverrides.Popover,builtinThemeOverrides:this.popoverThemeOverrides,internalExtraClass:t.concat("tooltip"),ref:"popoverRef"}),this.$slots)}}),w6=je({name:"DropdownDivider",props:{clsPrefix:{type:String,required:!0}},render(){return E("div",{class:`${this.clsPrefix}-dropdown-divider`})}}),oae=e=>{const{textColorBase:t,opacity1:r,opacity2:i,opacity3:n,opacity4:a,opacity5:o}=e;return{color:t,opacity1Depth:r,opacity2Depth:i,opacity3Depth:n,opacity4Depth:a,opacity5Depth:o}},sae={name:"Icon",common:$r,self:oae},lae=oe("icon",`
 height: 1em;
 width: 1em;
 line-height: 1em;
 text-align: center;
 display: inline-block;
 position: relative;
 fill: currentColor;
 transform: translateZ(0);
`,[xe("color-transition",{transition:"color .3s var(--n-bezier)"}),xe("depth",{color:"var(--n-color)"},[ge("svg",{opacity:"var(--n-opacity)",transition:"opacity .3s var(--n-bezier)"})]),ge("svg",{height:"1em",width:"1em"})]),cae=Object.assign(Object.assign({},bt.props),{depth:[String,Number],size:[Number,String],color:String,component:Object}),Tp=je({_n_icon__:!0,name:"Icon",inheritAttrs:!1,props:cae,setup(e){const{mergedClsPrefixRef:t,inlineThemeDisabled:r}=vr(e),i=bt("Icon","-icon",lae,sae,e,t),n=re(()=>{const{depth:o}=e,{common:{cubicBezierEaseInOut:s},self:l}=i.value;if(o!==void 0){const{color:c,[`opacity${o}Depth`]:u}=l;return{"--n-bezier":s,"--n-color":c,"--n-opacity":u}}return{"--n-bezier":s,"--n-color":"","--n-opacity":""}}),a=r?Dr("icon",re(()=>`${e.depth||"d"}`),n,e):void 0;return{mergedClsPrefix:t,mergedStyle:re(()=>{const{size:o,color:s}=e;return{fontSize:fs(o),color:s}}),cssVars:r?void 0:n,themeClass:a==null?void 0:a.themeClass,onRender:a==null?void 0:a.onRender}},render(){var e;const{$parent:t,depth:r,mergedClsPrefix:i,component:n,onRender:a,themeClass:o}=this;return!((e=t==null?void 0:t.$options)===null||e===void 0)&&e._n_icon__&&sh("icon","don't wrap `n-icon` inside `n-icon`"),a==null||a(),E("i",$u(this.$attrs,{role:"img",class:[`${i}-icon`,o,{[`${i}-icon--depth`]:r,[`${i}-icon--color-transition`]:r!==void 0}],style:[this.cssVars,this.mergedStyle]}),n?E(n):this.$slots)}}),cP="n-dropdown-menu",hw="n-dropdown",wR="n-dropdown-option";function J2(e,t){return e.type==="submenu"||e.type===void 0&&e[t]!==void 0}function uae(e){return e.type==="group"}function S6(e){return e.type==="divider"}function dae(e){return e.type==="render"}const C6=je({name:"DropdownOption",props:{clsPrefix:{type:String,required:!0},tmNode:{type:Object,required:!0},parentKey:{type:[String,Number],default:null},placement:{type:String,default:"right-start"},props:Object,scrollable:Boolean},setup(e){const t=_t(hw),{hoverKeyRef:r,keyboardKeyRef:i,lastToggledSubmenuKeyRef:n,pendingKeyPathRef:a,activeKeyPathRef:o,animatedRef:s,mergedShowRef:l,renderLabelRef:c,renderIconRef:u,labelFieldRef:d,childrenFieldRef:h,renderOptionRef:f,nodePropsRef:p,menuPropsRef:v}=t,m=_t(wR,null),g=_t(cP),y=_t(iw),b=re(()=>e.tmNode.rawNode),x=re(()=>{const{value:N}=h;return J2(e.tmNode.rawNode,N)}),S=re(()=>{const{disabled:N}=e.tmNode;return N}),w=re(()=>{if(!x.value)return!1;const{key:N,disabled:U}=e.tmNode;if(U)return!1;const{value:ie}=r,{value:te}=i,{value:X}=n,{value:W}=a;return ie!==null?W.includes(N):te!==null?W.includes(N)&&W[W.length-1]!==N:X!==null?W.includes(N):!1}),_=re(()=>i.value===null&&!s.value),C=mY(w,300,_),A=re(()=>!!(m!=null&&m.enteringSubmenuRef.value)),M=me(!1);xr(wR,{enteringSubmenuRef:M});function P(){M.value=!0}function T(){M.value=!1}function R(){const{parentKey:N,tmNode:U}=e;U.disabled||l.value&&(n.value=N,i.value=null,r.value=U.key)}function z(){const{tmNode:N}=e;N.disabled||l.value&&r.value!==N.key&&R()}function F(N){if(e.tmNode.disabled||!l.value)return;const{relatedTarget:U}=N;U&&!Ou({target:U},"dropdownOption")&&!Ou({target:U},"scrollbarRail")&&(r.value=null)}function H(){const{value:N}=x,{tmNode:U}=e;l.value&&!N&&!U.disabled&&(t.doSelect(U.key,U.rawNode),t.doUpdateShow(!1))}return{labelField:d,renderLabel:c,renderIcon:u,siblingHasIcon:g.showIconRef,siblingHasSubmenu:g.hasSubmenuRef,menuProps:v,popoverBody:y,animated:s,mergedShowSubmenu:re(()=>C.value&&!A.value),rawNode:b,hasSubmenu:x,pending:qi(()=>{const{value:N}=a,{key:U}=e.tmNode;return N.includes(U)}),childActive:qi(()=>{const{value:N}=o,{key:U}=e.tmNode,ie=N.findIndex(te=>U===te);return ie===-1?!1:ie<N.length-1}),active:qi(()=>{const{value:N}=o,{key:U}=e.tmNode,ie=N.findIndex(te=>U===te);return ie===-1?!1:ie===N.length-1}),mergedDisabled:S,renderOption:f,nodeProps:p,handleClick:H,handleMouseMove:z,handleMouseEnter:R,handleMouseLeave:F,handleSubmenuBeforeEnter:P,handleSubmenuAfterEnter:T}},render(){var e,t;const{animated:r,rawNode:i,mergedShowSubmenu:n,clsPrefix:a,siblingHasIcon:o,siblingHasSubmenu:s,renderLabel:l,renderIcon:c,renderOption:u,nodeProps:d,props:h,scrollable:f}=this;let p=null;if(n){const y=(e=this.menuProps)===null||e===void 0?void 0:e.call(this,i,i.children);p=E(_6,Object.assign({},y,{clsPrefix:a,scrollable:this.scrollable,tmNodes:this.tmNode.children,parentKey:this.tmNode.key}))}const v={class:[`${a}-dropdown-option-body`,this.pending&&`${a}-dropdown-option-body--pending`,this.active&&`${a}-dropdown-option-body--active`,this.childActive&&`${a}-dropdown-option-body--child-active`,this.mergedDisabled&&`${a}-dropdown-option-body--disabled`],onMousemove:this.handleMouseMove,onMouseenter:this.handleMouseEnter,onMouseleave:this.handleMouseLeave,onClick:this.handleClick},m=d==null?void 0:d(i),g=E("div",Object.assign({class:[`${a}-dropdown-option`,m==null?void 0:m.class],"data-dropdown-option":!0},m),E("div",$u(v,h),[E("div",{class:[`${a}-dropdown-option-body__prefix`,o&&`${a}-dropdown-option-body__prefix--show-icon`]},[c?c(i):Fn(i.icon)]),E("div",{"data-dropdown-option":!0,class:`${a}-dropdown-option-body__label`},l?l(i):Fn((t=i[this.labelField])!==null&&t!==void 0?t:i.title)),E("div",{"data-dropdown-option":!0,class:[`${a}-dropdown-option-body__suffix`,s&&`${a}-dropdown-option-body__suffix--has-submenu`]},this.hasSubmenu?E(Tp,null,{default:()=>E($U,null)}):null)]),this.hasSubmenu?E(wh,null,{default:()=>[E(Sh,null,{default:()=>E("div",{class:`${a}-dropdown-offset-container`},E(Ch,{show:this.mergedShowSubmenu,placement:this.placement,to:f&&this.popoverBody||void 0,teleportDisabled:!f},{default:()=>E("div",{class:`${a}-dropdown-menu-wrapper`},r?E(La,{onBeforeEnter:this.handleSubmenuBeforeEnter,onAfterEnter:this.handleSubmenuAfterEnter,name:"fade-in-scale-up-transition",appear:!0},{default:()=>p}):p)}))})]}):null);return u?u({node:g,option:i}):g}}),hae=je({name:"DropdownGroupHeader",props:{clsPrefix:{type:String,required:!0},tmNode:{type:Object,required:!0}},setup(){const{showIconRef:e,hasSubmenuRef:t}=_t(cP),{renderLabelRef:r,labelFieldRef:i,nodePropsRef:n,renderOptionRef:a}=_t(hw);return{labelField:i,showIcon:e,hasSubmenu:t,renderLabel:r,nodeProps:n,renderOption:a}},render(){var e;const{clsPrefix:t,hasSubmenu:r,showIcon:i,nodeProps:n,renderLabel:a,renderOption:o}=this,{rawNode:s}=this.tmNode,l=E("div",Object.assign({class:`${t}-dropdown-option`},n==null?void 0:n(s)),E("div",{class:`${t}-dropdown-option-body ${t}-dropdown-option-body--group`},E("div",{"data-dropdown-option":!0,class:[`${t}-dropdown-option-body__prefix`,i&&`${t}-dropdown-option-body__prefix--show-icon`]},Fn(s.icon)),E("div",{class:`${t}-dropdown-option-body__label`,"data-dropdown-option":!0},a?a(s):Fn((e=s.title)!==null&&e!==void 0?e:s[this.labelField])),E("div",{class:[`${t}-dropdown-option-body__suffix`,r&&`${t}-dropdown-option-body__suffix--has-submenu`],"data-dropdown-option":!0})));return o?o({node:l,option:s}):l}}),fae=je({name:"NDropdownGroup",props:{clsPrefix:{type:String,required:!0},tmNode:{type:Object,required:!0},parentKey:{type:[String,Number],default:null}},render(){const{tmNode:e,parentKey:t,clsPrefix:r}=this,{children:i}=e;return E(mr,null,E(hae,{clsPrefix:r,tmNode:e,key:e.key}),i==null?void 0:i.map(n=>{const{rawNode:a}=n;return a.show===!1?null:S6(a)?E(w6,{clsPrefix:r,key:n.key}):n.isGroup?(sh("dropdown","`group` node is not allowed to be put in `group` node."),null):E(C6,{clsPrefix:r,tmNode:n,parentKey:t,key:n.key})}))}}),pae=je({name:"DropdownRenderOption",props:{tmNode:{type:Object,required:!0}},render(){const{rawNode:{render:e,props:t}}=this.tmNode;return E("div",t,[e==null?void 0:e()])}}),_6=je({name:"DropdownMenu",props:{scrollable:Boolean,showArrow:Boolean,arrowStyle:[String,Object],clsPrefix:{type:String,required:!0},tmNodes:{type:Array,default:()=>[]},parentKey:{type:[String,Number],default:null}},setup(e){const{renderIconRef:t,childrenFieldRef:r}=_t(hw);xr(cP,{showIconRef:re(()=>{const n=t.value;return e.tmNodes.some(a=>{var o;if(a.isGroup)return(o=a.children)===null||o===void 0?void 0:o.some(({rawNode:l})=>n?n(l):l.icon);const{rawNode:s}=a;return n?n(s):s.icon})}),hasSubmenuRef:re(()=>{const{value:n}=r;return e.tmNodes.some(a=>{var o;if(a.isGroup)return(o=a.children)===null||o===void 0?void 0:o.some(({rawNode:l})=>J2(l,n));const{rawNode:s}=a;return J2(s,n)})})});const i=me(null);return xr(zT,null),xr(kT,null),xr(iw,i),{bodyRef:i}},render(){const{parentKey:e,clsPrefix:t,scrollable:r}=this,i=this.tmNodes.map(n=>{const{rawNode:a}=n;return a.show===!1?null:dae(a)?E(pae,{tmNode:n,key:n.key}):S6(a)?E(w6,{clsPrefix:t,key:n.key}):uae(a)?E(fae,{clsPrefix:t,tmNode:n,parentKey:e,key:n.key}):E(C6,{clsPrefix:t,tmNode:n,parentKey:e,key:n.key,props:a.props,scrollable:r})});return E("div",{class:[`${t}-dropdown-menu`,r&&`${t}-dropdown-menu--scrollable`],ref:"bodyRef"},r?E(QU,{contentClass:`${t}-dropdown-menu__content`},{default:()=>i}):i,this.showArrow?e6({clsPrefix:t,arrowStyle:this.arrowStyle,arrowClass:void 0,arrowWrapperClass:void 0,arrowWrapperStyle:void 0}):null)}}),mae=oe("dropdown-menu",`
 transform-origin: var(--v-transform-origin);
 background-color: var(--n-color);
 border-radius: var(--n-border-radius);
 box-shadow: var(--n-box-shadow);
 position: relative;
 transition:
 background-color .3s var(--n-bezier),
 box-shadow .3s var(--n-bezier);
`,[tm(),oe("dropdown-option",`
 position: relative;
 `,[ge("a",`
 text-decoration: none;
 color: inherit;
 outline: none;
 `,[ge("&::before",`
 content: "";
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 `)]),oe("dropdown-option-body",`
 display: flex;
 cursor: pointer;
 position: relative;
 height: var(--n-option-height);
 line-height: var(--n-option-height);
 font-size: var(--n-font-size);
 color: var(--n-option-text-color);
 transition: color .3s var(--n-bezier);
 `,[ge("&::before",`
 content: "";
 position: absolute;
 top: 0;
 bottom: 0;
 left: 4px;
 right: 4px;
 transition: background-color .3s var(--n-bezier);
 border-radius: var(--n-border-radius);
 `),br("disabled",[xe("pending",`
 color: var(--n-option-text-color-hover);
 `,[he("prefix, suffix",`
 color: var(--n-option-text-color-hover);
 `),ge("&::before","background-color: var(--n-option-color-hover);")]),xe("active",`
 color: var(--n-option-text-color-active);
 `,[he("prefix, suffix",`
 color: var(--n-option-text-color-active);
 `),ge("&::before","background-color: var(--n-option-color-active);")]),xe("child-active",`
 color: var(--n-option-text-color-child-active);
 `,[he("prefix, suffix",`
 color: var(--n-option-text-color-child-active);
 `)])]),xe("disabled",`
 cursor: not-allowed;
 opacity: var(--n-option-opacity-disabled);
 `),xe("group",`
 font-size: calc(var(--n-font-size) - 1px);
 color: var(--n-group-header-text-color);
 `,[he("prefix",`
 width: calc(var(--n-option-prefix-width) / 2);
 `,[xe("show-icon",`
 width: calc(var(--n-option-icon-prefix-width) / 2);
 `)])]),he("prefix",`
 width: var(--n-option-prefix-width);
 display: flex;
 justify-content: center;
 align-items: center;
 color: var(--n-prefix-color);
 transition: color .3s var(--n-bezier);
 z-index: 1;
 `,[xe("show-icon",`
 width: var(--n-option-icon-prefix-width);
 `),oe("icon",`
 font-size: var(--n-option-icon-size);
 `)]),he("label",`
 white-space: nowrap;
 flex: 1;
 z-index: 1;
 `),he("suffix",`
 box-sizing: border-box;
 flex-grow: 0;
 flex-shrink: 0;
 display: flex;
 justify-content: flex-end;
 align-items: center;
 min-width: var(--n-option-suffix-width);
 padding: 0 8px;
 transition: color .3s var(--n-bezier);
 color: var(--n-suffix-color);
 z-index: 1;
 `,[xe("has-submenu",`
 width: var(--n-option-icon-suffix-width);
 `),oe("icon",`
 font-size: var(--n-option-icon-size);
 `)]),oe("dropdown-menu","pointer-events: all;")]),oe("dropdown-offset-container",`
 pointer-events: none;
 position: absolute;
 left: 0;
 right: 0;
 top: -4px;
 bottom: -4px;
 `)]),oe("dropdown-divider",`
 transition: background-color .3s var(--n-bezier);
 background-color: var(--n-divider-color);
 height: 1px;
 margin: 4px 0;
 `),oe("dropdown-menu-wrapper",`
 transform-origin: var(--v-transform-origin);
 width: fit-content;
 `),ge(">",[oe("scrollbar",`
 height: inherit;
 max-height: inherit;
 `)]),br("scrollable",`
 padding: var(--n-padding);
 `),xe("scrollable",[he("content",`
 padding: var(--n-padding);
 `)])]),vae={animated:{type:Boolean,default:!0},keyboard:{type:Boolean,default:!0},size:{type:String,default:"medium"},inverted:Boolean,placement:{type:String,default:"bottom"},onSelect:[Function,Array],options:{type:Array,default:()=>[]},menuProps:Function,showArrow:Boolean,renderLabel:Function,renderIcon:Function,renderOption:Function,nodeProps:Function,labelField:{type:String,default:"label"},keyField:{type:String,default:"key"},childrenField:{type:String,default:"children"},value:[String,Number]},gae=Object.keys(dw),yae=Object.assign(Object.assign(Object.assign({},dw),vae),bt.props),bae=je({name:"Dropdown",inheritAttrs:!1,props:yae,setup(e){const t=me(!1),r=Hn(pt(e,"show"),t),i=re(()=>{const{keyField:T,childrenField:R}=e;return rp(e.options,{getKey(z){return z[T]},getDisabled(z){return z.disabled===!0},getIgnored(z){return z.type==="divider"||z.type==="render"},getChildren(z){return z[R]}})}),n=re(()=>i.value.treeNodes),a=me(null),o=me(null),s=me(null),l=re(()=>{var T,R,z;return(z=(R=(T=a.value)!==null&&T!==void 0?T:o.value)!==null&&R!==void 0?R:s.value)!==null&&z!==void 0?z:null}),c=re(()=>i.value.getPath(l.value).keyPath),u=re(()=>i.value.getPath(e.value).keyPath),d=qi(()=>e.keyboard&&r.value);RT({keydown:{ArrowUp:{prevent:!0,handler:S},ArrowRight:{prevent:!0,handler:x},ArrowDown:{prevent:!0,handler:w},ArrowLeft:{prevent:!0,handler:b},Enter:{prevent:!0,handler:_},Escape:y}},d);const{mergedClsPrefixRef:h,inlineThemeDisabled:f}=vr(e),p=bt("Dropdown","-dropdown",mae,x6,e,h);xr(hw,{labelFieldRef:pt(e,"labelField"),childrenFieldRef:pt(e,"childrenField"),renderLabelRef:pt(e,"renderLabel"),renderIconRef:pt(e,"renderIcon"),hoverKeyRef:a,keyboardKeyRef:o,lastToggledSubmenuKeyRef:s,pendingKeyPathRef:c,activeKeyPathRef:u,animatedRef:pt(e,"animated"),mergedShowRef:r,nodePropsRef:pt(e,"nodeProps"),renderOptionRef:pt(e,"renderOption"),menuPropsRef:pt(e,"menuProps"),doSelect:v,doUpdateShow:m}),rr(r,T=>{!e.animated&&!T&&g()});function v(T,R){const{onSelect:z}=e;z&&ct(z,T,R)}function m(T){const{"onUpdate:show":R,onUpdateShow:z}=e;R&&ct(R,T),z&&ct(z,T),t.value=T}function g(){a.value=null,o.value=null,s.value=null}function y(){m(!1)}function b(){A("left")}function x(){A("right")}function S(){A("up")}function w(){A("down")}function _(){const T=C();T!=null&&T.isLeaf&&r.value&&(v(T.key,T.rawNode),m(!1))}function C(){var T;const{value:R}=i,{value:z}=l;return!R||z===null?null:(T=R.getNode(z))!==null&&T!==void 0?T:null}function A(T){const{value:R}=l,{value:{getFirstAvailableNode:z}}=i;let F=null;if(R===null){const H=z();H!==null&&(F=H.key)}else{const H=C();if(H){let N;switch(T){case"down":N=H.getNext();break;case"up":N=H.getPrev();break;case"right":N=H.getChild();break;case"left":N=H.getParent();break}N&&(F=N.key)}}F!==null&&(a.value=null,o.value=F)}const M=re(()=>{const{size:T,inverted:R}=e,{common:{cubicBezierEaseInOut:z},self:F}=p.value,{padding:H,dividerColor:N,borderRadius:U,optionOpacityDisabled:ie,[Ze("optionIconSuffixWidth",T)]:te,[Ze("optionSuffixWidth",T)]:X,[Ze("optionIconPrefixWidth",T)]:W,[Ze("optionPrefixWidth",T)]:q,[Ze("fontSize",T)]:$,[Ze("optionHeight",T)]:le,[Ze("optionIconSize",T)]:ee}=F,Q={"--n-bezier":z,"--n-font-size":$,"--n-padding":H,"--n-border-radius":U,"--n-option-height":le,"--n-option-prefix-width":q,"--n-option-icon-prefix-width":W,"--n-option-suffix-width":X,"--n-option-icon-suffix-width":te,"--n-option-icon-size":ee,"--n-divider-color":N,"--n-option-opacity-disabled":ie};return R?(Q["--n-color"]=F.colorInverted,Q["--n-option-color-hover"]=F.optionColorHoverInverted,Q["--n-option-color-active"]=F.optionColorActiveInverted,Q["--n-option-text-color"]=F.optionTextColorInverted,Q["--n-option-text-color-hover"]=F.optionTextColorHoverInverted,Q["--n-option-text-color-active"]=F.optionTextColorActiveInverted,Q["--n-option-text-color-child-active"]=F.optionTextColorChildActiveInverted,Q["--n-prefix-color"]=F.prefixColorInverted,Q["--n-suffix-color"]=F.suffixColorInverted,Q["--n-group-header-text-color"]=F.groupHeaderTextColorInverted):(Q["--n-color"]=F.color,Q["--n-option-color-hover"]=F.optionColorHover,Q["--n-option-color-active"]=F.optionColorActive,Q["--n-option-text-color"]=F.optionTextColor,Q["--n-option-text-color-hover"]=F.optionTextColorHover,Q["--n-option-text-color-active"]=F.optionTextColorActive,Q["--n-option-text-color-child-active"]=F.optionTextColorChildActive,Q["--n-prefix-color"]=F.prefixColor,Q["--n-suffix-color"]=F.suffixColor,Q["--n-group-header-text-color"]=F.groupHeaderTextColor),Q}),P=f?Dr("dropdown",re(()=>`${e.size[0]}${e.inverted?"i":""}`),M,e):void 0;return{mergedClsPrefix:h,mergedTheme:p,tmNodes:n,mergedShow:r,handleAfterLeave:()=>{e.animated&&g()},doUpdateShow:m,cssVars:f?void 0:M,themeClass:P==null?void 0:P.themeClass,onRender:P==null?void 0:P.onRender}},render(){const e=(i,n,a,o,s)=>{var l;const{mergedClsPrefix:c,menuProps:u}=this;(l=this.onRender)===null||l===void 0||l.call(this);const d=(u==null?void 0:u(void 0,this.tmNodes.map(f=>f.rawNode)))||{},h={ref:jq(n),class:[i,`${c}-dropdown`,this.themeClass],clsPrefix:c,tmNodes:this.tmNodes,style:[...a,this.cssVars],showArrow:this.showArrow,arrowStyle:this.arrowStyle,scrollable:this.scrollable,onMouseenter:o,onMouseleave:s};return E(_6,$u(this.$attrs,h,d))},{mergedTheme:t}=this,r={show:this.mergedShow,theme:t.peers.Popover,themeOverrides:t.peerOverrides.Popover,internalOnAfterLeave:this.handleAfterLeave,internalRenderBody:e,onUpdateShow:this.doUpdateShow,"onUpdate:show":void 0};return E(sP,Object.assign({},zv(this.$props,gae),r),{trigger:()=>{var i,n;return(n=(i=this.$slots).default)===null||n===void 0?void 0:n.call(i)}})}}),xae={itemFontSize:"12px",itemHeight:"36px",itemWidth:"52px",panelActionPadding:"8px 0"},wae=e=>{const{popoverColor:t,textColor2:r,primaryColor:i,hoverColor:n,dividerColor:a,opacityDisabled:o,boxShadow2:s,borderRadius:l,iconColor:c,iconColorDisabled:u}=e;return Object.assign(Object.assign({},xae),{panelColor:t,panelBoxShadow:s,panelDividerColor:a,itemTextColor:r,itemTextColorActive:i,itemColorHover:n,itemOpacityDisabled:o,itemBorderRadius:l,borderRadius:l,iconColor:c,iconColorDisabled:u})},A6={name:"TimePicker",common:$r,peers:{Scrollbar:em,Button:n0,Input:rm},self:wae},Sae={itemSize:"24px",itemCellWidth:"38px",itemCellHeight:"32px",scrollItemWidth:"80px",scrollItemHeight:"40px",panelExtraFooterPadding:"8px 12px",panelActionPadding:"8px 12px",calendarTitlePadding:"0",calendarTitleHeight:"28px",arrowSize:"14px",panelHeaderPadding:"8px 12px",calendarDaysHeight:"32px",calendarTitleGridTempateColumns:"28px 28px 1fr 28px 28px",calendarLeftPaddingDate:"6px 12px 4px 12px",calendarLeftPaddingDatetime:"4px 12px",calendarLeftPaddingDaterange:"6px 12px 4px 12px",calendarLeftPaddingDatetimerange:"4px 12px",calendarLeftPaddingMonth:"0",calendarLeftPaddingYear:"0",calendarLeftPaddingQuarter:"0",calendarLeftPaddingMonthrange:"0",calendarLeftPaddingQuarterrange:"0",calendarLeftPaddingYearrange:"0",calendarLeftPaddingWeek:"6px 12px 4px 12px",calendarRightPaddingDate:"6px 12px 4px 12px",calendarRightPaddingDatetime:"4px 12px",calendarRightPaddingDaterange:"6px 12px 4px 12px",calendarRightPaddingDatetimerange:"4px 12px",calendarRightPaddingMonth:"0",calendarRightPaddingYear:"0",calendarRightPaddingQuarter:"0",calendarRightPaddingMonthrange:"0",calendarRightPaddingQuarterrange:"0",calendarRightPaddingYearrange:"0",calendarRightPaddingWeek:"0"},Cae=e=>{const{hoverColor:t,fontSize:r,textColor2:i,textColorDisabled:n,popoverColor:a,primaryColor:o,borderRadiusSmall:s,iconColor:l,iconColorDisabled:c,textColor1:u,dividerColor:d,boxShadow2:h,borderRadius:f,fontWeightStrong:p}=e;return Object.assign(Object.assign({},Sae),{itemFontSize:r,calendarDaysFontSize:r,calendarTitleFontSize:r,itemTextColor:i,itemTextColorDisabled:n,itemTextColorActive:a,itemTextColorCurrent:o,itemColorIncluded:Xt(o,{alpha:.1}),itemColorHover:t,itemColorDisabled:t,itemColorActive:o,itemBorderRadius:s,panelColor:a,panelTextColor:i,arrowColor:l,calendarTitleTextColor:u,calendarTitleColorHover:t,calendarDaysTextColor:i,panelHeaderDividerColor:d,calendarDaysDividerColor:d,calendarDividerColor:d,panelActionDividerColor:d,panelBoxShadow:h,panelBorderRadius:f,calendarTitleFontWeight:p,scrollItemBorderRadius:f,iconColor:l,iconColorDisabled:c})},_ae={name:"DatePicker",common:$r,peers:{Input:rm,Button:n0,TimePicker:A6,Scrollbar:em},self:Cae};function Aae(e,t){const r=re(()=>{const{isTimeDisabled:u}=e,{value:d}=t;if(!(d===null||Array.isArray(d)))return u==null?void 0:u(d)}),i=re(()=>{var u;return(u=r.value)===null||u===void 0?void 0:u.isHourDisabled}),n=re(()=>{var u;return(u=r.value)===null||u===void 0?void 0:u.isMinuteDisabled}),a=re(()=>{var u;return(u=r.value)===null||u===void 0?void 0:u.isSecondDisabled}),o=re(()=>{const{type:u,isDateDisabled:d}=e,{value:h}=t;return h===null||Array.isArray(h)||!["date","datetime"].includes(u)||!d?!1:d(h,{type:"input"})}),s=re(()=>{const{type:u}=e,{value:d}=t;if(d===null||u==="datetime"||Array.isArray(d))return!1;const h=new Date(d),f=h.getHours(),p=h.getMinutes(),v=h.getMinutes();return(i.value?i.value(f):!1)||(n.value?n.value(p,f):!1)||(a.value?a.value(v,p,f):!1)}),l=re(()=>o.value||s.value);return{isValueInvalidRef:re(()=>{const{type:u}=e;return u==="date"?o.value:u==="datetime"?l.value:!1}),isDateInvalidRef:o,isTimeInvalidRef:s,isDateTimeInvalidRef:l,isHourDisabledRef:i,isMinuteDisabledRef:n,isSecondDisabledRef:a}}function Mae(e,t){const r=re(()=>{const{isTimeDisabled:d}=e,{value:h}=t;return!Array.isArray(h)||!d?[void 0,void 0]:[d==null?void 0:d(h[0],"start",h),d==null?void 0:d(h[1],"end",h)]}),i={isStartHourDisabledRef:re(()=>{var d;return(d=r.value[0])===null||d===void 0?void 0:d.isHourDisabled}),isEndHourDisabledRef:re(()=>{var d;return(d=r.value[1])===null||d===void 0?void 0:d.isHourDisabled}),isStartMinuteDisabledRef:re(()=>{var d;return(d=r.value[0])===null||d===void 0?void 0:d.isMinuteDisabled}),isEndMinuteDisabledRef:re(()=>{var d;return(d=r.value[1])===null||d===void 0?void 0:d.isMinuteDisabled}),isStartSecondDisabledRef:re(()=>{var d;return(d=r.value[0])===null||d===void 0?void 0:d.isSecondDisabled}),isEndSecondDisabledRef:re(()=>{var d;return(d=r.value[1])===null||d===void 0?void 0:d.isSecondDisabled})},n=re(()=>{const{type:d,isDateDisabled:h}=e,{value:f}=t;return f===null||!Array.isArray(f)||!["daterange","datetimerange"].includes(d)||!h?!1:h(f[0],"start",f)}),a=re(()=>{const{type:d,isDateDisabled:h}=e,{value:f}=t;return f===null||!Array.isArray(f)||!["daterange","datetimerange"].includes(d)||!h?!1:h(f[1],"end",f)}),o=re(()=>{const{type:d}=e,{value:h}=t;if(h===null||!Array.isArray(h)||d!=="datetimerange")return!1;const f=ou(h[0]),p=xx(h[0]),v=wx(h[0]),{isStartHourDisabledRef:m,isStartMinuteDisabledRef:g,isStartSecondDisabledRef:y}=i;return(m.value?m.value(f):!1)||(g.value?g.value(p,f):!1)||(y.value?y.value(v,p,f):!1)}),s=re(()=>{const{type:d}=e,{value:h}=t;if(h===null||!Array.isArray(h)||d!=="datetimerange")return!1;const f=ou(h[1]),p=xx(h[1]),v=wx(h[1]),{isEndHourDisabledRef:m,isEndMinuteDisabledRef:g,isEndSecondDisabledRef:y}=i;return(m.value?m.value(f):!1)||(g.value?g.value(p,f):!1)||(y.value?y.value(v,p,f):!1)}),l=re(()=>n.value||o.value),c=re(()=>a.value||s.value),u=re(()=>l.value||c.value);return Object.assign(Object.assign({},i),{isStartDateInvalidRef:n,isEndDateInvalidRef:a,isStartTimeInvalidRef:o,isEndTimeInvalidRef:s,isStartValueInvalidRef:l,isEndValueInvalidRef:c,isRangeInvalidRef:u})}const fw="n-date-picker";var Eae=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function a0(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Tae(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function i(){return this instanceof i?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(i){var n=Object.getOwnPropertyDescriptor(e,i);Object.defineProperty(r,i,n.get?n:{enumerable:!0,get:function(){return e[i]}})}),r}var eA={exports:{}},M6={exports:{}};(function(e){function t(r){return r&&r.__esModule?r:{default:r}}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(M6);var Ii=M6.exports,tA={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;function r(i,n){if(i==null)throw new TypeError("assign requires that input parameter not be null or undefined");for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a]);return i}e.exports=t.default})(tA,tA.exports);var Pae=tA.exports;(function(e,t){var r=Ii.default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;var i=r(Pae);function n(a){return(0,i.default)({},a)}e.exports=t.default})(eA,eA.exports);var Dae=eA.exports;const Oae=a0(Dae);var rA={exports:{}},iA={exports:{}},nA={exports:{}},E6={exports:{}};(function(e){function t(r){"@babel/helpers - typeof";return e.exports=t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},e.exports.__esModule=!0,e.exports.default=e.exports,t(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(E6);var T6=E6.exports,aA={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;function r(i,n){if(n.length<i)throw new TypeError(i+" argument"+(i>1?"s":"")+" required, but only "+n.length+" present")}e.exports=t.default})(aA,aA.exports);var Na=aA.exports;(function(e,t){var r=Ii.default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var i=r(T6),n=r(Na);function a(o){return(0,n.default)(1,arguments),o instanceof Date||(0,i.default)(o)==="object"&&Object.prototype.toString.call(o)==="[object Date]"}e.exports=t.default})(nA,nA.exports);var Rae=nA.exports,oA={exports:{}};(function(e,t){var r=Ii.default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var i=r(T6),n=r(Na);function a(o){(0,n.default)(1,arguments);var s=Object.prototype.toString.call(o);return o instanceof Date||(0,i.default)(o)==="object"&&s==="[object Date]"?new Date(o.getTime()):typeof o=="number"||s==="[object Number]"?new Date(o):((typeof o=="string"||s==="[object String]")&&typeof console<"u"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(new Error().stack)),new Date(NaN))}e.exports=t.default})(oA,oA.exports);var yl=oA.exports;(function(e,t){var r=Ii.default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var i=r(Rae),n=r(yl),a=r(Na);function o(s){if((0,a.default)(1,arguments),!(0,i.default)(s)&&typeof s!="number")return!1;var l=(0,n.default)(s);return!isNaN(Number(l))}e.exports=t.default})(iA,iA.exports);var Iae=iA.exports,sA={exports:{}},lA={exports:{}},cA={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;function r(i){if(i===null||i===!0||i===!1)return NaN;var n=Number(i);return isNaN(n)?n:n<0?Math.ceil(n):Math.floor(n)}e.exports=t.default})(cA,cA.exports);var Dh=cA.exports;const zae=a0(Dh);(function(e,t){var r=Ii.default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var i=r(Dh),n=r(yl),a=r(Na);function o(s,l){(0,a.default)(2,arguments);var c=(0,n.default)(s).getTime(),u=(0,i.default)(l);return new Date(c+u)}e.exports=t.default})(lA,lA.exports);var kae=lA.exports;(function(e,t){var r=Ii.default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var i=r(kae),n=r(Na),a=r(Dh);function o(s,l){(0,n.default)(2,arguments);var c=(0,a.default)(l);return(0,i.default)(s,-c)}e.exports=t.default})(sA,sA.exports);var Lae=sA.exports,uA={exports:{}},dA={exports:{}};(function(e,t){var r=Ii.default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var i=r(yl),n=r(Na),a=864e5;function o(s){(0,n.default)(1,arguments);var l=(0,i.default)(s),c=l.getTime();l.setUTCMonth(0,1),l.setUTCHours(0,0,0,0);var u=l.getTime(),d=c-u;return Math.floor(d/a)+1}e.exports=t.default})(dA,dA.exports);var Bae=dA.exports,hA={exports:{}},fA={exports:{}};(function(e,t){var r=Ii.default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var i=r(yl),n=r(Na);function a(o){(0,n.default)(1,arguments);var s=1,l=(0,i.default)(o),c=l.getUTCDay(),u=(c<s?7:0)+c-s;return l.setUTCDate(l.getUTCDate()-u),l.setUTCHours(0,0,0,0),l}e.exports=t.default})(fA,fA.exports);var uP=fA.exports,pA={exports:{}},mA={exports:{}};(function(e,t){var r=Ii.default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var i=r(yl),n=r(Na),a=r(uP);function o(s){(0,n.default)(1,arguments);var l=(0,i.default)(s),c=l.getUTCFullYear(),u=new Date(0);u.setUTCFullYear(c+1,0,4),u.setUTCHours(0,0,0,0);var d=(0,a.default)(u),h=new Date(0);h.setUTCFullYear(c,0,4),h.setUTCHours(0,0,0,0);var f=(0,a.default)(h);return l.getTime()>=d.getTime()?c+1:l.getTime()>=f.getTime()?c:c-1}e.exports=t.default})(mA,mA.exports);var P6=mA.exports;(function(e,t){var r=Ii.default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var i=r(P6),n=r(uP),a=r(Na);function o(s){(0,a.default)(1,arguments);var l=(0,i.default)(s),c=new Date(0);c.setUTCFullYear(l,0,4),c.setUTCHours(0,0,0,0);var u=(0,n.default)(c);return u}e.exports=t.default})(pA,pA.exports);var Fae=pA.exports;(function(e,t){var r=Ii.default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=l;var i=r(yl),n=r(uP),a=r(Fae),o=r(Na),s=6048e5;function l(c){(0,o.default)(1,arguments);var u=(0,i.default)(c),d=(0,n.default)(u).getTime()-(0,a.default)(u).getTime();return Math.round(d/s)+1}e.exports=t.default})(hA,hA.exports);var Nae=hA.exports,vA={exports:{}},gA={exports:{}},Oh={};Object.defineProperty(Oh,"__esModule",{value:!0});Oh.getDefaultOptions=Uae;Oh.setDefaultOptions=jae;var D6={};function Uae(){return D6}function jae(e){D6=e}(function(e,t){var r=Ii.default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=s;var i=r(yl),n=r(Na),a=r(Dh),o=Oh;function s(l,c){var u,d,h,f,p,v,m,g;(0,n.default)(1,arguments);var y=(0,o.getDefaultOptions)(),b=(0,a.default)((u=(d=(h=(f=c==null?void 0:c.weekStartsOn)!==null&&f!==void 0?f:c==null||(p=c.locale)===null||p===void 0||(v=p.options)===null||v===void 0?void 0:v.weekStartsOn)!==null&&h!==void 0?h:y.weekStartsOn)!==null&&d!==void 0?d:(m=y.locale)===null||m===void 0||(g=m.options)===null||g===void 0?void 0:g.weekStartsOn)!==null&&u!==void 0?u:0);if(!(b>=0&&b<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var x=(0,i.default)(l),S=x.getUTCDay(),w=(S<b?7:0)+S-b;return x.setUTCDate(x.getUTCDate()-w),x.setUTCHours(0,0,0,0),x}e.exports=t.default})(gA,gA.exports);var dP=gA.exports,yA={exports:{}},bA={exports:{}};(function(e,t){var r=Ii.default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=l;var i=r(yl),n=r(Na),a=r(dP),o=r(Dh),s=Oh;function l(c,u){var d,h,f,p,v,m,g,y;(0,n.default)(1,arguments);var b=(0,i.default)(c),x=b.getUTCFullYear(),S=(0,s.getDefaultOptions)(),w=(0,o.default)((d=(h=(f=(p=u==null?void 0:u.firstWeekContainsDate)!==null&&p!==void 0?p:u==null||(v=u.locale)===null||v===void 0||(m=v.options)===null||m===void 0?void 0:m.firstWeekContainsDate)!==null&&f!==void 0?f:S.firstWeekContainsDate)!==null&&h!==void 0?h:(g=S.locale)===null||g===void 0||(y=g.options)===null||y===void 0?void 0:y.firstWeekContainsDate)!==null&&d!==void 0?d:1);if(!(w>=1&&w<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var _=new Date(0);_.setUTCFullYear(x+1,0,w),_.setUTCHours(0,0,0,0);var C=(0,a.default)(_,u),A=new Date(0);A.setUTCFullYear(x,0,w),A.setUTCHours(0,0,0,0);var M=(0,a.default)(A,u);return b.getTime()>=C.getTime()?x+1:b.getTime()>=M.getTime()?x:x-1}e.exports=t.default})(bA,bA.exports);var O6=bA.exports;(function(e,t){var r=Ii.default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=l;var i=r(O6),n=r(Na),a=r(dP),o=r(Dh),s=Oh;function l(c,u){var d,h,f,p,v,m,g,y;(0,n.default)(1,arguments);var b=(0,s.getDefaultOptions)(),x=(0,o.default)((d=(h=(f=(p=u==null?void 0:u.firstWeekContainsDate)!==null&&p!==void 0?p:u==null||(v=u.locale)===null||v===void 0||(m=v.options)===null||m===void 0?void 0:m.firstWeekContainsDate)!==null&&f!==void 0?f:b.firstWeekContainsDate)!==null&&h!==void 0?h:(g=b.locale)===null||g===void 0||(y=g.options)===null||y===void 0?void 0:y.firstWeekContainsDate)!==null&&d!==void 0?d:1),S=(0,i.default)(c,u),w=new Date(0);w.setUTCFullYear(S,0,x),w.setUTCHours(0,0,0,0);var _=(0,a.default)(w,u);return _}e.exports=t.default})(yA,yA.exports);var Vae=yA.exports;(function(e,t){var r=Ii.default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=l;var i=r(yl),n=r(dP),a=r(Vae),o=r(Na),s=6048e5;function l(c,u){(0,o.default)(1,arguments);var d=(0,i.default)(c),h=(0,n.default)(d,u).getTime()-(0,a.default)(d,u).getTime();return Math.round(h/s)+1}e.exports=t.default})(vA,vA.exports);var Hae=vA.exports,xA={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;function r(i,n){for(var a=i<0?"-":"",o=Math.abs(i).toString();o.length<n;)o="0"+o;return a+o}e.exports=t.default})(xA,xA.exports);var R6=xA.exports,wA={exports:{}};(function(e,t){var r=Ii.default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(R6),n={y:function(s,l){var c=s.getUTCFullYear(),u=c>0?c:1-c;return(0,i.default)(l==="yy"?u%100:u,l.length)},M:function(s,l){var c=s.getUTCMonth();return l==="M"?String(c+1):(0,i.default)(c+1,2)},d:function(s,l){return(0,i.default)(s.getUTCDate(),l.length)},a:function(s,l){var c=s.getUTCHours()/12>=1?"pm":"am";switch(l){case"a":case"aa":return c.toUpperCase();case"aaa":return c;case"aaaaa":return c[0];case"aaaa":default:return c==="am"?"a.m.":"p.m."}},h:function(s,l){return(0,i.default)(s.getUTCHours()%12||12,l.length)},H:function(s,l){return(0,i.default)(s.getUTCHours(),l.length)},m:function(s,l){return(0,i.default)(s.getUTCMinutes(),l.length)},s:function(s,l){return(0,i.default)(s.getUTCSeconds(),l.length)},S:function(s,l){var c=l.length,u=s.getUTCMilliseconds(),d=Math.floor(u*Math.pow(10,c-3));return(0,i.default)(d,l.length)}},a=n;t.default=a,e.exports=t.default})(wA,wA.exports);var Wae=wA.exports;(function(e,t){var r=Ii.default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(Bae),n=r(Nae),a=r(P6),o=r(Hae),s=r(O6),l=r(R6),c=r(Wae),u={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},d={G:function(g,y,b){var x=g.getUTCFullYear()>0?1:0;switch(y){case"G":case"GG":case"GGG":return b.era(x,{width:"abbreviated"});case"GGGGG":return b.era(x,{width:"narrow"});case"GGGG":default:return b.era(x,{width:"wide"})}},y:function(g,y,b){if(y==="yo"){var x=g.getUTCFullYear(),S=x>0?x:1-x;return b.ordinalNumber(S,{unit:"year"})}return c.default.y(g,y)},Y:function(g,y,b,x){var S=(0,s.default)(g,x),w=S>0?S:1-S;if(y==="YY"){var _=w%100;return(0,l.default)(_,2)}return y==="Yo"?b.ordinalNumber(w,{unit:"year"}):(0,l.default)(w,y.length)},R:function(g,y){var b=(0,a.default)(g);return(0,l.default)(b,y.length)},u:function(g,y){var b=g.getUTCFullYear();return(0,l.default)(b,y.length)},Q:function(g,y,b){var x=Math.ceil((g.getUTCMonth()+1)/3);switch(y){case"Q":return String(x);case"QQ":return(0,l.default)(x,2);case"Qo":return b.ordinalNumber(x,{unit:"quarter"});case"QQQ":return b.quarter(x,{width:"abbreviated",context:"formatting"});case"QQQQQ":return b.quarter(x,{width:"narrow",context:"formatting"});case"QQQQ":default:return b.quarter(x,{width:"wide",context:"formatting"})}},q:function(g,y,b){var x=Math.ceil((g.getUTCMonth()+1)/3);switch(y){case"q":return String(x);case"qq":return(0,l.default)(x,2);case"qo":return b.ordinalNumber(x,{unit:"quarter"});case"qqq":return b.quarter(x,{width:"abbreviated",context:"standalone"});case"qqqqq":return b.quarter(x,{width:"narrow",context:"standalone"});case"qqqq":default:return b.quarter(x,{width:"wide",context:"standalone"})}},M:function(g,y,b){var x=g.getUTCMonth();switch(y){case"M":case"MM":return c.default.M(g,y);case"Mo":return b.ordinalNumber(x+1,{unit:"month"});case"MMM":return b.month(x,{width:"abbreviated",context:"formatting"});case"MMMMM":return b.month(x,{width:"narrow",context:"formatting"});case"MMMM":default:return b.month(x,{width:"wide",context:"formatting"})}},L:function(g,y,b){var x=g.getUTCMonth();switch(y){case"L":return String(x+1);case"LL":return(0,l.default)(x+1,2);case"Lo":return b.ordinalNumber(x+1,{unit:"month"});case"LLL":return b.month(x,{width:"abbreviated",context:"standalone"});case"LLLLL":return b.month(x,{width:"narrow",context:"standalone"});case"LLLL":default:return b.month(x,{width:"wide",context:"standalone"})}},w:function(g,y,b,x){var S=(0,o.default)(g,x);return y==="wo"?b.ordinalNumber(S,{unit:"week"}):(0,l.default)(S,y.length)},I:function(g,y,b){var x=(0,n.default)(g);return y==="Io"?b.ordinalNumber(x,{unit:"week"}):(0,l.default)(x,y.length)},d:function(g,y,b){return y==="do"?b.ordinalNumber(g.getUTCDate(),{unit:"date"}):c.default.d(g,y)},D:function(g,y,b){var x=(0,i.default)(g);return y==="Do"?b.ordinalNumber(x,{unit:"dayOfYear"}):(0,l.default)(x,y.length)},E:function(g,y,b){var x=g.getUTCDay();switch(y){case"E":case"EE":case"EEE":return b.day(x,{width:"abbreviated",context:"formatting"});case"EEEEE":return b.day(x,{width:"narrow",context:"formatting"});case"EEEEEE":return b.day(x,{width:"short",context:"formatting"});case"EEEE":default:return b.day(x,{width:"wide",context:"formatting"})}},e:function(g,y,b,x){var S=g.getUTCDay(),w=(S-x.weekStartsOn+8)%7||7;switch(y){case"e":return String(w);case"ee":return(0,l.default)(w,2);case"eo":return b.ordinalNumber(w,{unit:"day"});case"eee":return b.day(S,{width:"abbreviated",context:"formatting"});case"eeeee":return b.day(S,{width:"narrow",context:"formatting"});case"eeeeee":return b.day(S,{width:"short",context:"formatting"});case"eeee":default:return b.day(S,{width:"wide",context:"formatting"})}},c:function(g,y,b,x){var S=g.getUTCDay(),w=(S-x.weekStartsOn+8)%7||7;switch(y){case"c":return String(w);case"cc":return(0,l.default)(w,y.length);case"co":return b.ordinalNumber(w,{unit:"day"});case"ccc":return b.day(S,{width:"abbreviated",context:"standalone"});case"ccccc":return b.day(S,{width:"narrow",context:"standalone"});case"cccccc":return b.day(S,{width:"short",context:"standalone"});case"cccc":default:return b.day(S,{width:"wide",context:"standalone"})}},i:function(g,y,b){var x=g.getUTCDay(),S=x===0?7:x;switch(y){case"i":return String(S);case"ii":return(0,l.default)(S,y.length);case"io":return b.ordinalNumber(S,{unit:"day"});case"iii":return b.day(x,{width:"abbreviated",context:"formatting"});case"iiiii":return b.day(x,{width:"narrow",context:"formatting"});case"iiiiii":return b.day(x,{width:"short",context:"formatting"});case"iiii":default:return b.day(x,{width:"wide",context:"formatting"})}},a:function(g,y,b){var x=g.getUTCHours(),S=x/12>=1?"pm":"am";switch(y){case"a":case"aa":return b.dayPeriod(S,{width:"abbreviated",context:"formatting"});case"aaa":return b.dayPeriod(S,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return b.dayPeriod(S,{width:"narrow",context:"formatting"});case"aaaa":default:return b.dayPeriod(S,{width:"wide",context:"formatting"})}},b:function(g,y,b){var x=g.getUTCHours(),S;switch(x===12?S=u.noon:x===0?S=u.midnight:S=x/12>=1?"pm":"am",y){case"b":case"bb":return b.dayPeriod(S,{width:"abbreviated",context:"formatting"});case"bbb":return b.dayPeriod(S,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return b.dayPeriod(S,{width:"narrow",context:"formatting"});case"bbbb":default:return b.dayPeriod(S,{width:"wide",context:"formatting"})}},B:function(g,y,b){var x=g.getUTCHours(),S;switch(x>=17?S=u.evening:x>=12?S=u.afternoon:x>=4?S=u.morning:S=u.night,y){case"B":case"BB":case"BBB":return b.dayPeriod(S,{width:"abbreviated",context:"formatting"});case"BBBBB":return b.dayPeriod(S,{width:"narrow",context:"formatting"});case"BBBB":default:return b.dayPeriod(S,{width:"wide",context:"formatting"})}},h:function(g,y,b){if(y==="ho"){var x=g.getUTCHours()%12;return x===0&&(x=12),b.ordinalNumber(x,{unit:"hour"})}return c.default.h(g,y)},H:function(g,y,b){return y==="Ho"?b.ordinalNumber(g.getUTCHours(),{unit:"hour"}):c.default.H(g,y)},K:function(g,y,b){var x=g.getUTCHours()%12;return y==="Ko"?b.ordinalNumber(x,{unit:"hour"}):(0,l.default)(x,y.length)},k:function(g,y,b){var x=g.getUTCHours();return x===0&&(x=24),y==="ko"?b.ordinalNumber(x,{unit:"hour"}):(0,l.default)(x,y.length)},m:function(g,y,b){return y==="mo"?b.ordinalNumber(g.getUTCMinutes(),{unit:"minute"}):c.default.m(g,y)},s:function(g,y,b){return y==="so"?b.ordinalNumber(g.getUTCSeconds(),{unit:"second"}):c.default.s(g,y)},S:function(g,y){return c.default.S(g,y)},X:function(g,y,b,x){var S=x._originalDate||g,w=S.getTimezoneOffset();if(w===0)return"Z";switch(y){case"X":return f(w);case"XXXX":case"XX":return p(w);case"XXXXX":case"XXX":default:return p(w,":")}},x:function(g,y,b,x){var S=x._originalDate||g,w=S.getTimezoneOffset();switch(y){case"x":return f(w);case"xxxx":case"xx":return p(w);case"xxxxx":case"xxx":default:return p(w,":")}},O:function(g,y,b,x){var S=x._originalDate||g,w=S.getTimezoneOffset();switch(y){case"O":case"OO":case"OOO":return"GMT"+h(w,":");case"OOOO":default:return"GMT"+p(w,":")}},z:function(g,y,b,x){var S=x._originalDate||g,w=S.getTimezoneOffset();switch(y){case"z":case"zz":case"zzz":return"GMT"+h(w,":");case"zzzz":default:return"GMT"+p(w,":")}},t:function(g,y,b,x){var S=x._originalDate||g,w=Math.floor(S.getTime()/1e3);return(0,l.default)(w,y.length)},T:function(g,y,b,x){var S=x._originalDate||g,w=S.getTime();return(0,l.default)(w,y.length)}};function h(m,g){var y=m>0?"-":"+",b=Math.abs(m),x=Math.floor(b/60),S=b%60;if(S===0)return y+String(x);var w=g;return y+String(x)+w+(0,l.default)(S,2)}function f(m,g){if(m%60===0){var y=m>0?"-":"+";return y+(0,l.default)(Math.abs(m)/60,2)}return p(m,g)}function p(m,g){var y=g||"",b=m>0?"-":"+",x=Math.abs(m),S=(0,l.default)(Math.floor(x/60),2),w=(0,l.default)(x%60,2);return b+S+y+w}var v=d;t.default=v,e.exports=t.default})(uA,uA.exports);var Gae=uA.exports,SA={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(l,c){switch(l){case"P":return c.date({width:"short"});case"PP":return c.date({width:"medium"});case"PPP":return c.date({width:"long"});case"PPPP":default:return c.date({width:"full"})}},i=function(l,c){switch(l){case"p":return c.time({width:"short"});case"pp":return c.time({width:"medium"});case"ppp":return c.time({width:"long"});case"pppp":default:return c.time({width:"full"})}},n=function(l,c){var u=l.match(/(P+)(p+)?/)||[],d=u[1],h=u[2];if(!h)return r(l,c);var f;switch(d){case"P":f=c.dateTime({width:"short"});break;case"PP":f=c.dateTime({width:"medium"});break;case"PPP":f=c.dateTime({width:"long"});break;case"PPPP":default:f=c.dateTime({width:"full"});break}return f.replace("{{date}}",r(d,c)).replace("{{time}}",i(h,c))},a={p:i,P:n},o=a;t.default=o,e.exports=t.default})(SA,SA.exports);var $ae=SA.exports,CA={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;function r(i){var n=new Date(Date.UTC(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),i.getSeconds(),i.getMilliseconds()));return n.setUTCFullYear(i.getFullYear()),i.getTime()-n.getTime()}e.exports=t.default})(CA,CA.exports);var I6=CA.exports;const SR=a0(I6);var o0={};Object.defineProperty(o0,"__esModule",{value:!0});o0.isProtectedDayOfYearToken=Xae;o0.isProtectedWeekYearToken=Kae;o0.throwProtectedError=Qae;var qae=["D","DD"],Yae=["YY","YYYY"];function Xae(e){return qae.indexOf(e)!==-1}function Kae(e){return Yae.indexOf(e)!==-1}function Qae(e,t,r){if(e==="YYYY")throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(t,"`) for formatting years to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(e==="YY")throw new RangeError("Use `yy` instead of `YY` (in `".concat(t,"`) for formatting years to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(e==="D")throw new RangeError("Use `d` instead of `D` (in `".concat(t,"`) for formatting days of the month to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(e==="DD")throw new RangeError("Use `dd` instead of `DD` (in `".concat(t,"`) for formatting days of the month to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"))}var _A={exports:{}},AA={exports:{}},MA={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},i=function(o,s,l){var c,u=r[o];return typeof u=="string"?c=u:s===1?c=u.one:c=u.other.replace("{{count}}",s.toString()),l!=null&&l.addSuffix?l.comparison&&l.comparison>0?"in "+c:c+" ago":c},n=i;t.default=n,e.exports=t.default})(MA,MA.exports);var Zae=MA.exports,EA={exports:{}},TA={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;function r(i){return function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=n.width?String(n.width):i.defaultWidth,o=i.formats[a]||i.formats[i.defaultWidth];return o}}e.exports=t.default})(TA,TA.exports);var Jae=TA.exports;(function(e,t){var r=Ii.default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(Jae),n={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},a={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},o={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},s={date:(0,i.default)({formats:n,defaultWidth:"full"}),time:(0,i.default)({formats:a,defaultWidth:"full"}),dateTime:(0,i.default)({formats:o,defaultWidth:"full"})},l=s;t.default=l,e.exports=t.default})(EA,EA.exports);var eoe=EA.exports,PA={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},i=function(o,s,l,c){return r[o]},n=i;t.default=n,e.exports=t.default})(PA,PA.exports);var toe=PA.exports,DA={exports:{}},OA={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;function r(i){return function(n,a){var o=a!=null&&a.context?String(a.context):"standalone",s;if(o==="formatting"&&i.formattingValues){var l=i.defaultFormattingWidth||i.defaultWidth,c=a!=null&&a.width?String(a.width):l;s=i.formattingValues[c]||i.formattingValues[l]}else{var u=i.defaultWidth,d=a!=null&&a.width?String(a.width):i.defaultWidth;s=i.values[d]||i.values[u]}var h=i.argumentCallback?i.argumentCallback(n):n;return s[h]}}e.exports=t.default})(OA,OA.exports);var roe=OA.exports;(function(e,t){var r=Ii.default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(roe),n={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},a={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},o={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},s={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},l={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},c={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},u=function(p,v){var m=Number(p),g=m%100;if(g>20||g<10)switch(g%10){case 1:return m+"st";case 2:return m+"nd";case 3:return m+"rd"}return m+"th"},d={ordinalNumber:u,era:(0,i.default)({values:n,defaultWidth:"wide"}),quarter:(0,i.default)({values:a,defaultWidth:"wide",argumentCallback:function(p){return p-1}}),month:(0,i.default)({values:o,defaultWidth:"wide"}),day:(0,i.default)({values:s,defaultWidth:"wide"}),dayPeriod:(0,i.default)({values:l,defaultWidth:"wide",formattingValues:c,defaultFormattingWidth:"wide"})},h=d;t.default=h,e.exports=t.default})(DA,DA.exports);var ioe=DA.exports,RA={exports:{}},IA={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;function r(a){return function(o){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},l=s.width,c=l&&a.matchPatterns[l]||a.matchPatterns[a.defaultMatchWidth],u=o.match(c);if(!u)return null;var d=u[0],h=l&&a.parsePatterns[l]||a.parsePatterns[a.defaultParseWidth],f=Array.isArray(h)?n(h,function(m){return m.test(d)}):i(h,function(m){return m.test(d)}),p;p=a.valueCallback?a.valueCallback(f):f,p=s.valueCallback?s.valueCallback(p):p;var v=o.slice(d.length);return{value:p,rest:v}}}function i(a,o){for(var s in a)if(a.hasOwnProperty(s)&&o(a[s]))return s}function n(a,o){for(var s=0;s<a.length;s++)if(o(a[s]))return s}e.exports=t.default})(IA,IA.exports);var noe=IA.exports,zA={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;function r(i){return function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=n.match(i.matchPattern);if(!o)return null;var s=o[0],l=n.match(i.parsePattern);if(!l)return null;var c=i.valueCallback?i.valueCallback(l[0]):l[0];c=a.valueCallback?a.valueCallback(c):c;var u=n.slice(s.length);return{value:c,rest:u}}}e.exports=t.default})(zA,zA.exports);var aoe=zA.exports;(function(e,t){var r=Ii.default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(noe),n=r(aoe),a=/^(\d+)(th|st|nd|rd)?/i,o=/\d+/i,s={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},l={any:[/^b/i,/^(a|c)/i]},c={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},u={any:[/1/i,/2/i,/3/i,/4/i]},d={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},h={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},f={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},p={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},v={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},m={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},g={ordinalNumber:(0,n.default)({matchPattern:a,parsePattern:o,valueCallback:function(x){return parseInt(x,10)}}),era:(0,i.default)({matchPatterns:s,defaultMatchWidth:"wide",parsePatterns:l,defaultParseWidth:"any"}),quarter:(0,i.default)({matchPatterns:c,defaultMatchWidth:"wide",parsePatterns:u,defaultParseWidth:"any",valueCallback:function(x){return x+1}}),month:(0,i.default)({matchPatterns:d,defaultMatchWidth:"wide",parsePatterns:h,defaultParseWidth:"any"}),day:(0,i.default)({matchPatterns:f,defaultMatchWidth:"wide",parsePatterns:p,defaultParseWidth:"any"}),dayPeriod:(0,i.default)({matchPatterns:v,defaultMatchWidth:"any",parsePatterns:m,defaultParseWidth:"any"})},y=g;t.default=y,e.exports=t.default})(RA,RA.exports);var ooe=RA.exports;(function(e,t){var r=Ii.default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(Zae),n=r(eoe),a=r(toe),o=r(ioe),s=r(ooe),l={code:"en-US",formatDistance:i.default,formatLong:n.default,formatRelative:a.default,localize:o.default,match:s.default,options:{weekStartsOn:0,firstWeekContainsDate:1}},c=l;t.default=c,e.exports=t.default})(AA,AA.exports);var soe=AA.exports;(function(e,t){var r=Ii.default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(soe),n=i.default;t.default=n,e.exports=t.default})(_A,_A.exports);var loe=_A.exports;(function(e,t){var r=Ii.default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=b;var i=r(Iae),n=r(Lae),a=r(yl),o=r(Gae),s=r($ae),l=r(I6),c=o0,u=r(Dh),d=r(Na),h=Oh,f=r(loe),p=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,v=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,m=/^'([^]*?)'?$/,g=/''/g,y=/[a-zA-Z]/;function b(S,w,_){var C,A,M,P,T,R,z,F,H,N,U,ie,te,X,W,q,$,le;(0,d.default)(2,arguments);var ee=String(w),Q=(0,h.getDefaultOptions)(),ne=(C=(A=_==null?void 0:_.locale)!==null&&A!==void 0?A:Q.locale)!==null&&C!==void 0?C:f.default,V=(0,u.default)((M=(P=(T=(R=_==null?void 0:_.firstWeekContainsDate)!==null&&R!==void 0?R:_==null||(z=_.locale)===null||z===void 0||(F=z.options)===null||F===void 0?void 0:F.firstWeekContainsDate)!==null&&T!==void 0?T:Q.firstWeekContainsDate)!==null&&P!==void 0?P:(H=Q.locale)===null||H===void 0||(N=H.options)===null||N===void 0?void 0:N.firstWeekContainsDate)!==null&&M!==void 0?M:1);if(!(V>=1&&V<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var ue=(0,u.default)((U=(ie=(te=(X=_==null?void 0:_.weekStartsOn)!==null&&X!==void 0?X:_==null||(W=_.locale)===null||W===void 0||(q=W.options)===null||q===void 0?void 0:q.weekStartsOn)!==null&&te!==void 0?te:Q.weekStartsOn)!==null&&ie!==void 0?ie:($=Q.locale)===null||$===void 0||(le=$.options)===null||le===void 0?void 0:le.weekStartsOn)!==null&&U!==void 0?U:0);if(!(ue>=0&&ue<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!ne.localize)throw new RangeError("locale must contain localize property");if(!ne.formatLong)throw new RangeError("locale must contain formatLong property");var ve=(0,a.default)(S);if(!(0,i.default)(ve))throw new RangeError("Invalid time value");var Ce=(0,l.default)(ve),G=(0,n.default)(ve,Ce),Z={firstWeekContainsDate:V,weekStartsOn:ue,locale:ne,_originalDate:ve},de=ee.match(v).map(function(Se){var we=Se[0];if(we==="p"||we==="P"){var _e=s.default[we];return _e(Se,ne.formatLong)}return Se}).join("").match(p).map(function(Se){if(Se==="''")return"'";var we=Se[0];if(we==="'")return x(Se);var _e=o.default[we];if(_e)return!(_!=null&&_.useAdditionalWeekYearTokens)&&(0,c.isProtectedWeekYearToken)(Se)&&(0,c.throwProtectedError)(Se,w,String(S)),!(_!=null&&_.useAdditionalDayOfYearTokens)&&(0,c.isProtectedDayOfYearToken)(Se)&&(0,c.throwProtectedError)(Se,w,String(S)),_e(G,Se,ne.localize,Z);if(we.match(y))throw new RangeError("Format string contains an unescaped latin alphabet character `"+we+"`");return Se}).join("");return de}function x(S){var w=S.match(m);return w?w[1].replace(g,"'"):S}e.exports=t.default})(rA,rA.exports);var coe=rA.exports;const uoe=a0(coe);function CR(e,t,r){var i=foe(e,r.timeZone,r.locale);return i.formatToParts?doe(i,t):hoe(i,t)}function doe(e,t){for(var r=e.formatToParts(t),i=r.length-1;i>=0;--i)if(r[i].type==="timeZoneName")return r[i].value}function hoe(e,t){var r=e.format(t).replace(/\u200E/g,""),i=/ [\w-+ ]+$/.exec(r);return i?i[0].substr(1):""}function foe(e,t,r){if(r&&!r.code)throw new Error("date-fns-tz error: Please set a language code on the locale object imported from date-fns, e.g. `locale.code = 'en-US'`");return new Intl.DateTimeFormat(r?[r.code,"en-US"]:void 0,{timeZone:t,timeZoneName:e})}function poe(e,t){var r=yoe(t);return r.formatToParts?voe(r,e):goe(r,e)}var moe={year:0,month:1,day:2,hour:3,minute:4,second:5};function voe(e,t){try{for(var r=e.formatToParts(t),i=[],n=0;n<r.length;n++){var a=moe[r[n].type];a>=0&&(i[a]=parseInt(r[n].value,10))}return i}catch(o){if(o instanceof RangeError)return[NaN];throw o}}function goe(e,t){var r=e.format(t),i=/(\d+)\/(\d+)\/(\d+),? (\d+):(\d+):(\d+)/.exec(r);return[i[3],i[1],i[2],i[4],i[5],i[6]]}var BS={};function yoe(e){if(!BS[e]){var t=new Intl.DateTimeFormat("en-US",{hourCycle:"h23",timeZone:"America/New_York",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(new Date("2014-06-25T04:00:00.123Z")),r=t==="06/25/2014, 00:00:00"||t==="06/25/2014 00:00:00";BS[e]=r?new Intl.DateTimeFormat("en-US",{hourCycle:"h23",timeZone:e,year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:e,year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}return BS[e]}function z6(e,t,r,i,n,a,o){var s=new Date(0);return s.setUTCFullYear(e,t,r),s.setUTCHours(i,n,a,o),s}var _R=36e5,boe=6e4,FS={timezone:/([Z+-].*)$/,timezoneZ:/^(Z)$/,timezoneHH:/^([+-]\d{2})$/,timezoneHHMM:/^([+-])(\d{2}):?(\d{2})$/};function hP(e,t,r){var i,n;if(!e||(i=FS.timezoneZ.exec(e),i))return 0;var a;if(i=FS.timezoneHH.exec(e),i)return a=parseInt(i[1],10),AR(a)?-(a*_R):NaN;if(i=FS.timezoneHHMM.exec(e),i){a=parseInt(i[2],10);var o=parseInt(i[3],10);return AR(a,o)?(n=Math.abs(a)*_R+o*boe,i[1]==="+"?-n:n):NaN}if(Soe(e)){t=new Date(t||Date.now());var s=r?t:xoe(t),l=kA(s,e),c=r?l:woe(t,l,e);return-c}return NaN}function xoe(e){return z6(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}function kA(e,t){var r=poe(e,t),i=z6(r[0],r[1]-1,r[2],r[3]%24,r[4],r[5],0).getTime(),n=e.getTime(),a=n%1e3;return n-=a>=0?a:1e3+a,i-n}function woe(e,t,r){var i=e.getTime(),n=i-t,a=kA(new Date(n),r);if(t===a)return t;n-=a-t;var o=kA(new Date(n),r);return a===o?a:Math.max(a,o)}function AR(e,t){return-23<=e&&e<=23&&(t==null||0<=t&&t<=59)}var MR={};function Soe(e){if(MR[e])return!0;try{return new Intl.DateTimeFormat(void 0,{timeZone:e}),MR[e]=!0,!0}catch{return!1}}var Coe=60*1e3,_oe={X:function(e,t,r,i){var n=NS(i.timeZone,e);if(n===0)return"Z";switch(t){case"X":return ER(n);case"XXXX":case"XX":return Pf(n);case"XXXXX":case"XXX":default:return Pf(n,":")}},x:function(e,t,r,i){var n=NS(i.timeZone,e);switch(t){case"x":return ER(n);case"xxxx":case"xx":return Pf(n);case"xxxxx":case"xxx":default:return Pf(n,":")}},O:function(e,t,r,i){var n=NS(i.timeZone,e);switch(t){case"O":case"OO":case"OOO":return"GMT"+Aoe(n,":");case"OOOO":default:return"GMT"+Pf(n,":")}},z:function(e,t,r,i){switch(t){case"z":case"zz":case"zzz":return CR("short",e,i);case"zzzz":default:return CR("long",e,i)}}};function NS(e,t){var r=e?hP(e,t,!0)/Coe:t.getTimezoneOffset();if(Number.isNaN(r))throw new RangeError("Invalid time zone specified: "+e);return r}function Ex(e,t){for(var r=e<0?"-":"",i=Math.abs(e).toString();i.length<t;)i="0"+i;return r+i}function Pf(e,t){var r=t||"",i=e>0?"-":"+",n=Math.abs(e),a=Ex(Math.floor(n/60),2),o=Ex(Math.floor(n%60),2);return i+a+r+o}function ER(e,t){if(e%60===0){var r=e>0?"-":"+";return r+Ex(Math.abs(e)/60,2)}return Pf(e,t)}function Aoe(e,t){var r=e>0?"-":"+",i=Math.abs(e),n=Math.floor(i/60),a=i%60;if(a===0)return r+String(n);var o=t;return r+String(n)+o+Ex(a,2)}var Moe=/(Z|[+-]\d{2}(?::?\d{2})?| UTC| [a-zA-Z]+\/[a-zA-Z_]+(?:\/[a-zA-Z_]+)?)$/,US=36e5,TR=6e4,Eoe=2,Oa={dateTimePattern:/^([0-9W+-]+)(T| )(.*)/,datePattern:/^([0-9W+-]+)(.*)/,plainTime:/:/,YY:/^(\d{2})$/,YYY:[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],YYYY:/^(\d{4})/,YYYYY:[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],MM:/^-(\d{2})$/,DDD:/^-?(\d{3})$/,MMDD:/^-?(\d{2})-?(\d{2})$/,Www:/^-?W(\d{2})$/,WwwD:/^-?W(\d{2})-?(\d{1})$/,HH:/^(\d{2}([.,]\d*)?)$/,HHMM:/^(\d{2}):?(\d{2}([.,]\d*)?)$/,HHMMSS:/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,timeZone:Moe};function k6(e,t){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");if(e===null)return new Date(NaN);var r=t||{},i=r.additionalDigits==null?Eoe:zae(r.additionalDigits);if(i!==2&&i!==1&&i!==0)throw new RangeError("additionalDigits must be 0, 1 or 2");if(e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]")return new Date(e.getTime());if(typeof e=="number"||Object.prototype.toString.call(e)==="[object Number]")return new Date(e);if(!(typeof e=="string"||Object.prototype.toString.call(e)==="[object String]"))return new Date(NaN);var n=Toe(e),a=Poe(n.date,i),o=a.year,s=a.restDateString,l=Doe(s,o);if(isNaN(l))return new Date(NaN);if(l){var c=l.getTime(),u=0,d;if(n.time&&(u=Ooe(n.time),isNaN(u)))return new Date(NaN);if(n.timeZone||r.timeZone){if(d=hP(n.timeZone||r.timeZone,new Date(c+u)),isNaN(d))return new Date(NaN)}else d=SR(new Date(c+u)),d=SR(new Date(c+u+d));return new Date(c+u+d)}else return new Date(NaN)}function Toe(e){var t={},r=Oa.dateTimePattern.exec(e),i;if(r?(t.date=r[1],i=r[3]):(r=Oa.datePattern.exec(e),r?(t.date=r[1],i=r[2]):(t.date=null,i=e)),i){var n=Oa.timeZone.exec(i);n?(t.time=i.replace(n[1],""),t.timeZone=n[1].trim()):t.time=i}return t}function Poe(e,t){var r=Oa.YYY[t],i=Oa.YYYYY[t],n;if(n=Oa.YYYY.exec(e)||i.exec(e),n){var a=n[1];return{year:parseInt(a,10),restDateString:e.slice(a.length)}}if(n=Oa.YY.exec(e)||r.exec(e),n){var o=n[1];return{year:parseInt(o,10)*100,restDateString:e.slice(o.length)}}return{year:null}}function Doe(e,t){if(t===null)return null;var r,i,n,a;if(e.length===0)return i=new Date(0),i.setUTCFullYear(t),i;if(r=Oa.MM.exec(e),r)return i=new Date(0),n=parseInt(r[1],10)-1,DR(t,n)?(i.setUTCFullYear(t,n),i):new Date(NaN);if(r=Oa.DDD.exec(e),r){i=new Date(0);var o=parseInt(r[1],10);return zoe(t,o)?(i.setUTCFullYear(t,0,o),i):new Date(NaN)}if(r=Oa.MMDD.exec(e),r){i=new Date(0),n=parseInt(r[1],10)-1;var s=parseInt(r[2],10);return DR(t,n,s)?(i.setUTCFullYear(t,n,s),i):new Date(NaN)}if(r=Oa.Www.exec(e),r)return a=parseInt(r[1],10)-1,OR(t,a)?PR(t,a):new Date(NaN);if(r=Oa.WwwD.exec(e),r){a=parseInt(r[1],10)-1;var l=parseInt(r[2],10)-1;return OR(t,a,l)?PR(t,a,l):new Date(NaN)}return null}function Ooe(e){var t,r,i;if(t=Oa.HH.exec(e),t)return r=parseFloat(t[1].replace(",",".")),jS(r)?r%24*US:NaN;if(t=Oa.HHMM.exec(e),t)return r=parseInt(t[1],10),i=parseFloat(t[2].replace(",",".")),jS(r,i)?r%24*US+i*TR:NaN;if(t=Oa.HHMMSS.exec(e),t){r=parseInt(t[1],10),i=parseInt(t[2],10);var n=parseFloat(t[3].replace(",","."));return jS(r,i,n)?r%24*US+i*TR+n*1e3:NaN}return null}function PR(e,t,r){t=t||0,r=r||0;var i=new Date(0);i.setUTCFullYear(e,0,4);var n=i.getUTCDay()||7,a=t*7+r+1-n;return i.setUTCDate(i.getUTCDate()+a),i}var Roe=[31,28,31,30,31,30,31,31,30,31,30,31],Ioe=[31,29,31,30,31,30,31,31,30,31,30,31];function L6(e){return e%400===0||e%4===0&&e%100!==0}function DR(e,t,r){if(t<0||t>11)return!1;if(r!=null){if(r<1)return!1;var i=L6(e);if(i&&r>Ioe[t]||!i&&r>Roe[t])return!1}return!0}function zoe(e,t){if(t<1)return!1;var r=L6(e);return!(r&&t>366||!r&&t>365)}function OR(e,t,r){return!(t<0||t>52||r!=null&&(r<0||r>6))}function jS(e,t,r){return!(e!=null&&(e<0||e>=25)||t!=null&&(t<0||t>=60)||r!=null&&(r<0||r>=60))}var koe=/([xXOz]+)|''|'(''|[^'])+('|$)/g;function Loe(e,t,r){var i=String(t),n=r||{},a=i.match(koe);if(a){var o=k6(n.originalDate||e,n);i=a.reduce(function(s,l){if(l[0]==="'")return s;var c=s.indexOf(l),u=s[c-1]==="'",d=s.replace(l,"'"+_oe[l[0]](o,l,null,n)+"'");return u?d.substring(0,c-1)+d.substring(c+1):d},i)}return uoe(e,i,n)}function Boe(e,t,r){var i=k6(e,r),n=hP(t,i,!0),a=new Date(i.getTime()-n),o=new Date(0);return o.setFullYear(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate()),o.setHours(a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds(),a.getUTCMilliseconds()),o}function Foe(e,t,r,i){var n=Oae(i);return n.timeZone=t,n.originalDate=e,Loe(Boe(e,t),r,n)}const fv={amHours:["00","01","02","03","04","05","06","07","08","09","10","11"],pmHours:["12","01","02","03","04","05","06","07","08","09","10","11"],hours:["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23"],minutes:["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59"],seconds:["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59"],period:["AM","PM"]};function VS(e){return`00${e}`.slice(-2)}function pv(e,t,r){return Array.isArray(t)?(r==="am"?t.filter(i=>i<12):r==="pm"?t.filter(i=>i>=12).map(i=>i===12?12:i-12):t).map(i=>VS(i)):typeof t=="number"?r==="am"?e.filter(i=>{const n=Number(i);return n<12&&n%t===0}):r==="pm"?e.filter(i=>{const n=Number(i);return n>=12&&n%t===0}).map(i=>{const n=Number(i);return VS(n===12?12:n-12)}):e.filter(i=>Number(i)%t===0):r==="am"?e.filter(i=>Number(i)<12):r==="pm"?e.map(i=>Number(i)).filter(i=>Number(i)>=12).map(i=>VS(i===12?12:i-12)):e}function J0(e,t,r){return r?typeof r=="number"?e%r===0:r.includes(e):!0}function Noe(e,t,r){const i=pv(fv[t],r).map(Number);let n,a;for(let o=0;o<i.length;++o){const s=i[o];if(s===e)return s;if(s>e){a=s;break}n=s}return n===void 0?(a||tw("time-picker","Please set 'hours' or 'minutes' or 'seconds' props"),a):a===void 0||a-e>e-n?n:a}function Uoe(e){return ou(e)<12?"am":"pm"}const B6="n-time-picker",ey=je({name:"TimePickerPanelCol",props:{clsPrefix:{type:String,required:!0},data:{type:Array,required:!0},activeValue:{type:Number,default:null},onItemClick:Function},render(){const{activeValue:e,onItemClick:t,clsPrefix:r}=this;return this.data.map(i=>{const{label:n,disabled:a,value:o}=i,s=e===o;return E("div",{key:n,"data-active":s?"":null,class:[`${r}-time-picker-col__item`,s&&`${r}-time-picker-col__item--active`,a&&`${r}-time-picker-col__item--disabled`],onClick:t&&!a?()=>{t(o)}:void 0},n)})}}),joe={actions:{type:Array,default:()=>["now","confirm"]},showHour:{type:Boolean,default:!0},showMinute:{type:Boolean,default:!0},showSecond:{type:Boolean,default:!0},showPeriod:{type:Boolean,default:!0},isHourInvalid:Boolean,isMinuteInvalid:Boolean,isSecondInvalid:Boolean,isAmPmInvalid:Boolean,isValueInvalid:Boolean,hourValue:{type:Number,default:null},minuteValue:{type:Number,default:null},secondValue:{type:Number,default:null},amPmValue:{type:String,default:null},isHourDisabled:Function,isMinuteDisabled:Function,isSecondDisabled:Function,onHourClick:{type:Function,required:!0},onMinuteClick:{type:Function,required:!0},onSecondClick:{type:Function,required:!0},onAmPmClick:{type:Function,required:!0},onNowClick:Function,clearText:String,nowText:String,confirmText:String,transitionDisabled:Boolean,onClearClick:Function,onConfirmClick:Function,onFocusin:Function,onFocusout:Function,onFocusDetectorFocus:Function,onKeydown:Function,hours:[Number,Array],minutes:[Number,Array],seconds:[Number,Array],use12Hours:Boolean},Voe=je({name:"TimePickerPanel",props:joe,setup(e){const{mergedThemeRef:t,mergedClsPrefixRef:r}=_t(B6),i=re(()=>{const{isHourDisabled:s,hours:l,use12Hours:c,amPmValue:u}=e;if(c){const d=u??Uoe(Date.now());return pv(fv.hours,l,d).map(h=>{const f=Number(h),p=d==="pm"&&f!==12?f+12:f;return{label:h,value:p,disabled:s?s(p):!1}})}else return pv(fv.hours,l).map(d=>({label:d,value:Number(d),disabled:s?s(Number(d)):!1}))}),n=re(()=>{const{isMinuteDisabled:s,minutes:l}=e;return pv(fv.minutes,l).map(c=>({label:c,value:Number(c),disabled:s?s(Number(c),e.hourValue):!1}))}),a=re(()=>{const{isSecondDisabled:s,seconds:l}=e;return pv(fv.seconds,l).map(c=>({label:c,value:Number(c),disabled:s?s(Number(c),e.minuteValue,e.hourValue):!1}))}),o=re(()=>{const{isHourDisabled:s}=e;let l=!0,c=!0;for(let u=0;u<12;++u)if(!(s!=null&&s(u))){l=!1;break}for(let u=12;u<24;++u)if(!(s!=null&&s(u))){c=!1;break}return[{label:"AM",value:"am",disabled:l},{label:"PM",value:"pm",disabled:c}]});return{mergedTheme:t,mergedClsPrefix:r,hours:i,minutes:n,seconds:a,amPm:o,hourScrollRef:me(null),minuteScrollRef:me(null),secondScrollRef:me(null),amPmScrollRef:me(null)}},render(){var e,t,r,i;const{mergedClsPrefix:n,mergedTheme:a}=this;return E("div",{tabindex:0,class:`${n}-time-picker-panel`,onFocusin:this.onFocusin,onFocusout:this.onFocusout,onKeydown:this.onKeydown},E("div",{class:`${n}-time-picker-cols`},this.showHour?E("div",{class:[`${n}-time-picker-col`,this.isHourInvalid&&`${n}-time-picker-col--invalid`,this.transitionDisabled&&`${n}-time-picker-col--transition-disabled`]},E(Sn,{ref:"hourScrollRef",theme:a.peers.Scrollbar,themeOverrides:a.peerOverrides.Scrollbar},{default:()=>[E(ey,{clsPrefix:n,data:this.hours,activeValue:this.hourValue,onItemClick:this.onHourClick}),E("div",{class:`${n}-time-picker-col__padding`})]})):null,this.showMinute?E("div",{class:[`${n}-time-picker-col`,this.transitionDisabled&&`${n}-time-picker-col--transition-disabled`,this.isMinuteInvalid&&`${n}-time-picker-col--invalid`]},E(Sn,{ref:"minuteScrollRef",theme:a.peers.Scrollbar,themeOverrides:a.peerOverrides.Scrollbar},{default:()=>[E(ey,{clsPrefix:n,data:this.minutes,activeValue:this.minuteValue,onItemClick:this.onMinuteClick}),E("div",{class:`${n}-time-picker-col__padding`})]})):null,this.showSecond?E("div",{class:[`${n}-time-picker-col`,this.isSecondInvalid&&`${n}-time-picker-col--invalid`,this.transitionDisabled&&`${n}-time-picker-col--transition-disabled`]},E(Sn,{ref:"secondScrollRef",theme:a.peers.Scrollbar,themeOverrides:a.peerOverrides.Scrollbar},{default:()=>[E(ey,{clsPrefix:n,data:this.seconds,activeValue:this.secondValue,onItemClick:this.onSecondClick}),E("div",{class:`${n}-time-picker-col__padding`})]})):null,this.use12Hours?E("div",{class:[`${n}-time-picker-col`,this.isAmPmInvalid&&`${n}-time-picker-col--invalid`,this.transitionDisabled&&`${n}-time-picker-col--transition-disabled`]},E(Sn,{ref:"amPmScrollRef",theme:a.peers.Scrollbar,themeOverrides:a.peerOverrides.Scrollbar},{default:()=>[E(ey,{clsPrefix:n,data:this.amPm,activeValue:this.amPmValue,onItemClick:this.onAmPmClick}),E("div",{class:`${n}-time-picker-col__padding`})]})):null),!((e=this.actions)===null||e===void 0)&&e.length?E("div",{class:`${n}-time-picker-actions`},!((t=this.actions)===null||t===void 0)&&t.includes("clear")?E(ci,{theme:a.peers.Button,themeOverrides:a.peerOverrides.Button,size:"tiny",onClick:this.onClearClick},{default:()=>this.clearText}):null,!((r=this.actions)===null||r===void 0)&&r.includes("now")?E(ci,{size:"tiny",theme:a.peers.Button,themeOverrides:a.peerOverrides.Button,onClick:this.onNowClick},{default:()=>this.nowText}):null,!((i=this.actions)===null||i===void 0)&&i.includes("confirm")?E(ci,{size:"tiny",type:"primary",class:`${n}-time-picker-actions__confirm`,theme:a.peers.Button,themeOverrides:a.peerOverrides.Button,disabled:this.isValueInvalid,onClick:this.onConfirmClick},{default:()=>this.confirmText}):null):null,E(Qu,{onFocus:this.onFocusDetectorFocus}))}}),Hoe=ge([oe("time-picker",`
 z-index: auto;
 position: relative;
 `,[oe("time-picker-icon",`
 color: var(--n-icon-color-override);
 transition: color .3s var(--n-bezier);
 `),xe("disabled",[oe("time-picker-icon",`
 color: var(--n-icon-color-disabled-override);
 `)])]),oe("time-picker-panel",`
 transition:
 box-shadow .3s var(--n-bezier),
 background-color .3s var(--n-bezier);
 outline: none;
 font-size: var(--n-item-font-size);
 border-radius: var(--n-border-radius);
 margin: 4px 0;
 min-width: 104px;
 overflow: hidden;
 background-color: var(--n-panel-color);
 box-shadow: var(--n-panel-box-shadow);
 `,[tm(),oe("time-picker-actions",`
 padding: var(--n-panel-action-padding);
 align-items: center;
 display: flex;
 justify-content: space-evenly;
 `),oe("time-picker-cols",`
 height: calc(var(--n-item-height) * 6);
 display: flex;
 position: relative;
 transition: border-color .3s var(--n-bezier);
 border-bottom: 1px solid var(--n-panel-divider-color);
 `),oe("time-picker-col",`
 flex-grow: 1;
 min-width: var(--n-item-width);
 height: calc(var(--n-item-height) * 6);
 flex-direction: column;
 transition: box-shadow .3s var(--n-bezier);
 `,[xe("transition-disabled",[he("item","transition: none;",[ge("&::before","transition: none;")])]),he("padding",`
 height: calc(var(--n-item-height) * 5);
 `),ge("&:first-child","min-width: calc(var(--n-item-width) + 4px);",[he("item",[ge("&::before","left: 4px;")])]),he("item",`
 cursor: pointer;
 height: var(--n-item-height);
 display: flex;
 align-items: center;
 justify-content: center;
 transition: 
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 opacity .3s var(--n-bezier),
 text-decoration-color .3s var(--n-bezier);
 background: #0000;
 text-decoration-color: #0000;
 color: var(--n-item-text-color);
 z-index: 0;
 box-sizing: border-box;
 padding-top: 4px;
 position: relative;
 `,[ge("&::before",`
 content: "";
 transition: background-color .3s var(--n-bezier);
 z-index: -1;
 position: absolute;
 left: 0;
 right: 4px;
 top: 4px;
 bottom: 0;
 border-radius: var(--n-item-border-radius);
 `),br("disabled",[ge("&:hover::before",`
 background-color: var(--n-item-color-hover);
 `)]),xe("active",`
 color: var(--n-item-text-color-active);
 `,[ge("&::before",`
 background-color: var(--n-item-color-hover);
 `)]),xe("disabled",`
 opacity: var(--n-item-opacity-disabled);
 cursor: not-allowed;
 `)]),xe("invalid",[he("item",[xe("active",`
 text-decoration: line-through;
 text-decoration-color: var(--n-item-text-color-active);
 `)])])])])]);function HS(e,t){return e===void 0?!0:Array.isArray(e)?e.every(r=>r>=0&&r<=t):e>=0&&e<=t}const Woe=Object.assign(Object.assign({},bt.props),{to:Wn.propTo,bordered:{type:Boolean,default:void 0},actions:Array,defaultValue:{type:Number,default:null},defaultFormattedValue:String,placeholder:String,placement:{type:String,default:"bottom-start"},value:Number,format:{type:String,default:"HH:mm:ss"},valueFormat:String,formattedValue:String,isHourDisabled:Function,size:String,isMinuteDisabled:Function,isSecondDisabled:Function,inputReadonly:Boolean,clearable:Boolean,status:String,"onUpdate:value":[Function,Array],onUpdateValue:[Function,Array],"onUpdate:show":[Function,Array],onUpdateShow:[Function,Array],onUpdateFormattedValue:[Function,Array],"onUpdate:formattedValue":[Function,Array],onBlur:[Function,Array],onConfirm:[Function,Array],onClear:Function,onFocus:[Function,Array],timeZone:String,showIcon:{type:Boolean,default:!0},disabled:{type:Boolean,default:void 0},show:{type:Boolean,default:void 0},hours:{type:[Number,Array],validator:e=>HS(e,23)},minutes:{type:[Number,Array],validator:e=>HS(e,59)},seconds:{type:[Number,Array],validator:e=>HS(e,59)},use12Hours:Boolean,stateful:{type:Boolean,default:!0},onChange:[Function,Array]}),LA=je({name:"TimePicker",props:Woe,setup(e){const{mergedBorderedRef:t,mergedClsPrefixRef:r,namespaceRef:i,inlineThemeDisabled:n}=vr(e),{localeRef:a,dateLocaleRef:o}=wc("TimePicker"),s=gl(e),{mergedSizeRef:l,mergedDisabledRef:c,mergedStatusRef:u}=s,d=bt("TimePicker","-time-picker",Hoe,A6,e,r),h=RT(),f=me(null),p=me(null),v=re(()=>({locale:o.value.locale}));function m(Fe){return Fe===null?null:qa(Fe,e.valueFormat||e.format,new Date,v.value).getTime()}const{defaultValue:g,defaultFormattedValue:y}=e,b=me(y!==void 0?m(y):g),x=re(()=>{const{formattedValue:Fe}=e;if(Fe!==void 0)return m(Fe);const{value:Ke}=e;return Ke!==void 0?Ke:b.value}),S=re(()=>{const{timeZone:Fe}=e;return Fe?(Ke,dt,Nt)=>Foe(Ke,Fe,dt,Nt):(Ke,dt,Nt)=>oi(Ke,dt,Nt)}),w=me("");rr(()=>e.timeZone,()=>{const Fe=x.value;w.value=Fe===null?"":S.value(Fe,e.format,v.value)},{immediate:!0});const _=me(!1),C=pt(e,"show"),A=Hn(C,_),M=me(x.value),P=me(!1),T=re(()=>a.value.clear),R=re(()=>a.value.now),z=re(()=>e.placeholder!==void 0?e.placeholder:a.value.placeholder),F=re(()=>a.value.negativeText),H=re(()=>a.value.positiveText),N=re(()=>/H|h|K|k/.test(e.format)),U=re(()=>e.format.includes("m")),ie=re(()=>e.format.includes("s")),te=re(()=>{const{isHourDisabled:Fe}=e;return ee.value===null?!1:J0(ee.value,"hours",e.hours)?Fe?Fe(ee.value):!1:!0}),X=re(()=>{const{value:Fe}=Q,{value:Ke}=ee;if(Fe===null||Ke===null)return!1;if(!J0(Fe,"minutes",e.minutes))return!0;const{isMinuteDisabled:dt}=e;return dt?dt(Fe,Ke):!1}),W=re(()=>{const{value:Fe}=Q,{value:Ke}=ee,{value:dt}=ne;if(dt===null||Fe===null||Ke===null)return!1;if(!J0(dt,"seconds",e.seconds))return!0;const{isSecondDisabled:Nt}=e;return Nt?Nt(dt,Fe,Ke):!1}),q=re(()=>te.value||X.value||W.value),$=re(()=>e.format.length+4),le=re(()=>{const{value:Fe}=x;return Fe===null?null:ou(Fe)<12?"am":"pm"}),ee=re(()=>{const{value:Fe}=x;return Fe===null?null:Number(S.value(Fe,"HH",v.value))}),Q=re(()=>{const{value:Fe}=x;return Fe===null?null:Number(S.value(Fe,"mm",v.value))}),ne=re(()=>{const{value:Fe}=x;return Fe===null?null:Number(S.value(Fe,"ss",v.value))});function V(Fe,Ke){const{onUpdateFormattedValue:dt,"onUpdate:formattedValue":Nt}=e;dt&&ct(dt,Fe,Ke),Nt&&ct(Nt,Fe,Ke)}function ue(Fe){return Fe===null?null:S.value(Fe,e.valueFormat||e.format)}function ve(Fe){const{onUpdateValue:Ke,"onUpdate:value":dt,onChange:Nt}=e,{nTriggerFormChange:hi,nTriggerFormInput:Mi}=s,Mr=ue(Fe);Ke&&ct(Ke,Fe,Mr),dt&&ct(dt,Fe,Mr),Nt&&ct(Nt,Fe,Mr),V(Mr,Fe),b.value=Fe,hi(),Mi()}function Ce(Fe){const{onFocus:Ke}=e,{nTriggerFormFocus:dt}=s;Ke&&ct(Ke,Fe),dt()}function G(Fe){const{onBlur:Ke}=e,{nTriggerFormBlur:dt}=s;Ke&&ct(Ke,Fe),dt()}function Z(){const{onConfirm:Fe}=e;Fe&&ct(Fe,x.value,ue(x.value))}function de(Fe){var Ke;Fe.stopPropagation(),ve(null),L(null),(Ke=e.onClear)===null||Ke===void 0||Ke.call(e)}function Se(){se({returnFocus:!0})}function we(){ve(null),L(null),se({returnFocus:!0})}function _e(Fe){Fe.key==="Escape"&&A.value&&dg(Fe)}function Ee(Fe){var Ke;switch(Fe.key){case"Escape":A.value&&(dg(Fe),se({returnFocus:!0}));break;case"Tab":h.shift&&Fe.target===((Ke=p.value)===null||Ke===void 0?void 0:Ke.$el)&&(Fe.preventDefault(),se({returnFocus:!0}));break}}function fe(){P.value=!0,aa(()=>{P.value=!1})}function B(Fe){c.value||Ou(Fe,"clear")||A.value||ut()}function D(Fe){typeof Fe!="string"&&(x.value===null?ve(gt(id(fre(new Date),Fe))):ve(gt(id(x.value,Fe))))}function I(Fe){typeof Fe!="string"&&(x.value===null?ve(gt(_S(Yee(new Date),Fe))):ve(gt(_S(x.value,Fe))))}function O(Fe){typeof Fe!="string"&&(x.value===null?ve(gt(AS(tP(new Date),Fe))):ve(gt(AS(x.value,Fe))))}function j(Fe){const{value:Ke}=x;if(Ke===null){const dt=new Date,Nt=ou(dt);Fe==="pm"&&Nt<12?ve(gt(id(dt,Nt+12))):Fe==="am"&&Nt>=12&&ve(gt(id(dt,Nt-12))),ve(gt(dt))}else{const dt=ou(Ke);Fe==="pm"&&dt<12?ve(gt(id(Ke,dt+12))):Fe==="am"&&dt>=12&&ve(gt(id(Ke,dt-12)))}}function L(Fe){Fe===void 0&&(Fe=x.value),Fe===null?w.value="":w.value=S.value(Fe,e.format,v.value)}function Ae(Fe){lt(Fe)||Ce(Fe)}function We(Fe){var Ke;if(!lt(Fe))if(A.value){const dt=(Ke=p.value)===null||Ke===void 0?void 0:Ke.$el;dt!=null&&dt.contains(Fe.relatedTarget)||(L(),G(Fe),se({returnFocus:!1}))}else L(),G(Fe)}function Ve(){c.value||A.value||ut()}function ke(){c.value||(L(),se({returnFocus:!1}))}function et(){if(!p.value)return;const{hourScrollRef:Fe,minuteScrollRef:Ke,secondScrollRef:dt,amPmScrollRef:Nt}=p.value;[Fe,Ke,dt,Nt].forEach(hi=>{var Mi;if(!hi)return;const Mr=(Mi=hi.contentRef)===null||Mi===void 0?void 0:Mi.querySelector("[data-active]");Mr&&hi.scrollTo({top:Mr.offsetTop})})}function nt(Fe){_.value=Fe;const{onUpdateShow:Ke,"onUpdate:show":dt}=e;Ke&&ct(Ke,Fe),dt&&ct(dt,Fe)}function lt(Fe){var Ke,dt,Nt;return!!(!((dt=(Ke=f.value)===null||Ke===void 0?void 0:Ke.wrapperElRef)===null||dt===void 0)&&dt.contains(Fe.relatedTarget)||!((Nt=p.value)===null||Nt===void 0)&&Nt.$el.contains(Fe.relatedTarget))}function ut(){M.value=x.value,nt(!0),aa(et)}function vt(Fe){var Ke,dt;A.value&&!(!((dt=(Ke=f.value)===null||Ke===void 0?void 0:Ke.wrapperElRef)===null||dt===void 0)&&dt.contains(lc(Fe)))&&se({returnFocus:!1})}function se({returnFocus:Fe}){var Ke;A.value&&(nt(!1),Fe&&((Ke=f.value)===null||Ke===void 0||Ke.focus()))}function Be(Fe){if(Fe===""){ve(null);return}const Ke=qa(Fe,e.format,new Date,v.value);if(w.value=Fe,ko(Ke)){const{value:dt}=x;if(dt!==null){const Nt=Qn(dt,{hours:ou(Ke),minutes:xx(Ke),seconds:wx(Ke),milliseconds:pte(Ke)});ve(gt(Nt))}else ve(gt(Ke))}}function Ye(){ve(M.value),nt(!1)}function pe(){const Fe=new Date,Ke={hours:ou,minutes:xx,seconds:wx},[dt,Nt,hi]=["hours","minutes","seconds"].map(Mr=>!e[Mr]||J0(Ke[Mr](Fe),Mr,e[Mr])?Ke[Mr](Fe):Noe(Ke[Mr](Fe),Mr,e[Mr])),Mi=AS(_S(id(x.value?x.value:gt(Fe),dt),Nt),hi);ve(gt(Mi))}function Te(){L(),Z(),se({returnFocus:!0})}function ce(Fe){lt(Fe)||(L(),G(Fe),se({returnFocus:!1}))}rr(x,Fe=>{L(Fe),fe(),aa(et)}),rr(A,()=>{q.value&&ve(M.value)}),xr(B6,{mergedThemeRef:d,mergedClsPrefixRef:r});const Re={focus:()=>{var Fe;(Fe=f.value)===null||Fe===void 0||Fe.focus()},blur:()=>{var Fe;(Fe=f.value)===null||Fe===void 0||Fe.blur()}},$e=re(()=>{const{common:{cubicBezierEaseInOut:Fe},self:{iconColor:Ke,iconColorDisabled:dt}}=d.value;return{"--n-icon-color-override":Ke,"--n-icon-color-disabled-override":dt,"--n-bezier":Fe}}),at=n?Dr("time-picker-trigger",void 0,$e,e):void 0,Yt=re(()=>{const{self:{panelColor:Fe,itemTextColor:Ke,itemTextColorActive:dt,itemColorHover:Nt,panelDividerColor:hi,panelBoxShadow:Mi,itemOpacityDisabled:Mr,borderRadius:De,itemFontSize:K,itemWidth:Me,itemHeight:He,panelActionPadding:Oe,itemBorderRadius:Ne},common:{cubicBezierEaseInOut:wt}}=d.value;return{"--n-bezier":wt,"--n-border-radius":De,"--n-item-color-hover":Nt,"--n-item-font-size":K,"--n-item-height":He,"--n-item-opacity-disabled":Mr,"--n-item-text-color":Ke,"--n-item-text-color-active":dt,"--n-item-width":Me,"--n-panel-action-padding":Oe,"--n-panel-box-shadow":Mi,"--n-panel-color":Fe,"--n-panel-divider-color":hi,"--n-item-border-radius":Ne}}),nr=n?Dr("time-picker",void 0,Yt,e):void 0;return{focus:Re.focus,blur:Re.blur,mergedStatus:u,mergedBordered:t,mergedClsPrefix:r,namespace:i,uncontrolledValue:b,mergedValue:x,isMounted:Yu(),inputInstRef:f,panelInstRef:p,adjustedTo:Wn(e),mergedShow:A,localizedClear:T,localizedNow:R,localizedPlaceholder:z,localizedNegativeText:F,localizedPositiveText:H,hourInFormat:N,minuteInFormat:U,secondInFormat:ie,mergedAttrSize:$,displayTimeString:w,mergedSize:l,mergedDisabled:c,isValueInvalid:q,isHourInvalid:te,isMinuteInvalid:X,isSecondInvalid:W,transitionDisabled:P,hourValue:ee,minuteValue:Q,secondValue:ne,amPmValue:le,handleInputKeydown:_e,handleTimeInputFocus:Ae,handleTimeInputBlur:We,handleNowClick:pe,handleConfirmClick:Te,handleTimeInputUpdateValue:Be,handleMenuFocusOut:ce,handleCancelClick:Ye,handleClickOutside:vt,handleTimeInputActivate:Ve,handleTimeInputDeactivate:ke,handleHourClick:D,handleMinuteClick:I,handleSecondClick:O,handleAmPmClick:j,handleTimeInputClear:de,handleFocusDetectorFocus:Se,handleMenuKeydown:Ee,handleTriggerClick:B,mergedTheme:d,triggerCssVars:n?void 0:$e,triggerThemeClass:at==null?void 0:at.themeClass,triggerOnRender:at==null?void 0:at.onRender,cssVars:n?void 0:Yt,themeClass:nr==null?void 0:nr.themeClass,onRender:nr==null?void 0:nr.onRender,clearSelectedValue:we}},render(){const{mergedClsPrefix:e,$slots:t,triggerOnRender:r}=this;return r==null||r(),E("div",{class:[`${e}-time-picker`,this.triggerThemeClass],style:this.triggerCssVars},E(wh,null,{default:()=>[E(Sh,null,{default:()=>E(ur,{ref:"inputInstRef",status:this.mergedStatus,value:this.displayTimeString,bordered:this.mergedBordered,passivelyActivated:!0,attrSize:this.mergedAttrSize,theme:this.mergedTheme.peers.Input,themeOverrides:this.mergedTheme.peerOverrides.Input,stateful:this.stateful,size:this.mergedSize,placeholder:this.localizedPlaceholder,clearable:this.clearable,disabled:this.mergedDisabled,textDecoration:this.isValueInvalid?"line-through":void 0,onFocus:this.handleTimeInputFocus,onBlur:this.handleTimeInputBlur,onActivate:this.handleTimeInputActivate,onDeactivate:this.handleTimeInputDeactivate,onUpdateValue:this.handleTimeInputUpdateValue,onClear:this.handleTimeInputClear,internalDeactivateOnEnter:!0,internalForceFocus:this.mergedShow,readonly:this.inputReadonly||this.mergedDisabled,onClick:this.handleTriggerClick,onKeydown:this.handleInputKeydown},this.showIcon?{[this.clearable?"clear-icon-placeholder":"suffix"]:()=>E(Bi,{clsPrefix:e,class:`${e}-time-picker-icon`},{default:()=>t.icon?t.icon():E(Tre,null)})}:null)}),E(Ch,{teleportDisabled:this.adjustedTo===Wn.tdkey,show:this.mergedShow,to:this.adjustedTo,containerClass:this.namespace,placement:this.placement},{default:()=>E(La,{name:"fade-in-scale-up-transition",appear:this.isMounted},{default:()=>{var i;return this.mergedShow?((i=this.onRender)===null||i===void 0||i.call(this),io(E(Voe,{ref:"panelInstRef",actions:this.actions,class:this.themeClass,style:this.cssVars,seconds:this.seconds,minutes:this.minutes,hours:this.hours,transitionDisabled:this.transitionDisabled,hourValue:this.hourValue,showHour:this.hourInFormat,isHourInvalid:this.isHourInvalid,isHourDisabled:this.isHourDisabled,minuteValue:this.minuteValue,showMinute:this.minuteInFormat,isMinuteInvalid:this.isMinuteInvalid,isMinuteDisabled:this.isMinuteDisabled,secondValue:this.secondValue,amPmValue:this.amPmValue,showSecond:this.secondInFormat,isSecondInvalid:this.isSecondInvalid,isSecondDisabled:this.isSecondDisabled,isValueInvalid:this.isValueInvalid,clearText:this.localizedClear,nowText:this.localizedNow,confirmText:this.localizedPositiveText,use12Hours:this.use12Hours,onFocusout:this.handleMenuFocusOut,onKeydown:this.handleMenuKeydown,onHourClick:this.handleHourClick,onMinuteClick:this.handleMinuteClick,onSecondClick:this.handleSecondClick,onAmPmClick:this.handleAmPmClick,onNowClick:this.handleNowClick,onConfirmClick:this.handleConfirmClick,onClearClick:this.clearSelectedValue,onFocusDetectorFocus:this.handleFocusDetectorFocus}),[[Ru,this.handleClickOutside,void 0,{capture:!0}]])):null}})})]}))}}),Goe="HH:mm:ss",F6={active:Boolean,dateFormat:String,timerPickerFormat:{type:String,value:Goe},value:{type:[Array,Number],default:null},shortcuts:Object,defaultTime:[Number,String,Array],onClear:Function,onConfirm:Function,onClose:Function,onTabOut:Function,onUpdateValue:{type:Function,required:!0},themeClass:String,onRender:Function,panel:Boolean,onNextMonth:Function,onPrevMonth:Function,onNextYear:Function,onPrevYear:Function};function N6(e){const{dateLocaleRef:t,timePickerSizeRef:r,timePickerPropsRef:i,localeRef:n,mergedClsPrefixRef:a,mergedThemeRef:o}=_t(fw),s=re(()=>({locale:t.value.locale})),l=me(null),c=RT();function u(){const{onClear:T}=e;T&&T()}function d(){const{onConfirm:T,value:R}=e;T&&T(R)}function h(T,R){const{onUpdateValue:z}=e;z(T,R)}function f(T=!1){const{onClose:R}=e;R&&R(T)}function p(){const{onTabOut:T}=e;T&&T()}function v(){h(null,!0),f(!0),u()}function m(){p()}function g(){(e.active||e.panel)&&aa(()=>{const{value:T}=l;if(!T)return;const R=T.querySelectorAll("[data-n-date]");R.forEach(z=>{z.classList.add("transition-disabled")}),T.offsetWidth,R.forEach(z=>{z.classList.remove("transition-disabled")})})}function y(T){T.key==="Tab"&&T.target===l.value&&c.shift&&(T.preventDefault(),p())}function b(T){const{value:R}=l;c.tab&&T.target===R&&(R!=null&&R.contains(T.relatedTarget))&&p()}let x=null,S=!1;function w(){x=e.value,S=!0}function _(){S=!1}function C(){S&&(h(x,!1),S=!1)}function A(T){return typeof T=="function"?T():T}const M=me(!1);function P(){M.value=!M.value}return{mergedTheme:o,mergedClsPrefix:a,dateFnsOptions:s,timePickerSize:r,timePickerProps:i,selfRef:l,locale:n,doConfirm:d,doClose:f,doUpdateValue:h,doTabOut:p,handleClearClick:v,handleFocusDetectorFocus:m,disableTransitionOneTick:g,handlePanelKeyDown:y,handlePanelFocus:b,cachePendingValue:w,clearPendingValue:_,restorePendingValue:C,getShortcutValue:A,handleShortcutMouseleave:C,showMonthYearPanel:M,handleOpenQuickSelectMonthPanel:P}}const fP=Object.assign(Object.assign({},F6),{defaultCalendarStartTime:Number,actions:{type:Array,default:()=>["now","clear","confirm"]}});function pP(e,t){var r;const i=N6(e),{isValueInvalidRef:n,isDateDisabledRef:a,isDateInvalidRef:o,isTimeInvalidRef:s,isDateTimeInvalidRef:l,isHourDisabledRef:c,isMinuteDisabledRef:u,isSecondDisabledRef:d,localeRef:h,firstDayOfWeekRef:f,datePickerSlots:p,yearFormatRef:v,monthFormatRef:m,quarterFormatRef:g}=_t(fw),y={isValueInvalid:n,isDateDisabled:a,isDateInvalid:o,isTimeInvalid:s,isDateTimeInvalid:l,isHourDisabled:c,isMinuteDisabled:u,isSecondDisabled:d},b=re(()=>e.dateFormat||h.value.dateFormat),x=me(e.value===null||Array.isArray(e.value)?"":oi(e.value,b.value)),S=me(e.value===null||Array.isArray(e.value)?(r=e.defaultCalendarStartTime)!==null&&r!==void 0?r:Date.now():e.value),w=me(null),_=me(null),C=me(null),A=me(Date.now()),M=re(()=>{var O;return X2(S.value,e.value,A.value,(O=f.value)!==null&&O!==void 0?O:h.value.firstDayOfWeek,!1,t==="week")}),P=re(()=>{const{value:O}=e;return K2(S.value,Array.isArray(O)?null:O,A.value,{monthFormat:m.value})}),T=re(()=>{const{value:O}=e;return Z2(Array.isArray(O)?null:O,A.value,{yearFormat:v.value})}),R=re(()=>{const{value:O}=e;return Q2(S.value,Array.isArray(O)?null:O,A.value,{quarterFormat:g.value})}),z=re(()=>M.value.slice(0,7).map(O=>{const{ts:j}=O;return oi(j,h.value.dayFormat,i.dateFnsOptions.value)})),F=re(()=>oi(S.value,h.value.monthFormat,i.dateFnsOptions.value)),H=re(()=>oi(S.value,h.value.yearFormat,i.dateFnsOptions.value));rr(S,(O,j)=>{(t==="date"||t==="datetime")&&(r0(O,j)||i.disableTransitionOneTick())}),rr(re(()=>e.value),O=>{O!==null&&!Array.isArray(O)?(x.value=oi(O,b.value,i.dateFnsOptions.value),S.value=O):x.value=""});function N(O){var j;if(t==="datetime")return gt(tP(O));if(t==="month")return gt(Hl(O));if(t==="year")return gt(QT(O));if(t==="quarter")return gt(gg(O));if(t==="week"){const L=(((j=f.value)!==null&&j!==void 0?j:h.value.firstDayOfWeek)+1)%7;return gt(V2(O,{weekStartsOn:L}))}return gt(yx(O))}function U(O,j){const{isDateDisabled:{value:L}}=y;return L?L(O,j):!1}function ie(O){const j=qa(O,b.value,new Date,i.dateFnsOptions.value);if(ko(j)){if(e.value===null)i.doUpdateValue(gt(N(Date.now())),e.panel);else if(!Array.isArray(e.value)){const L=Qn(e.value,{year:Ei(j),month:pi(j),date:To(j)});i.doUpdateValue(gt(N(gt(L))),e.panel)}}else x.value=O}function te(){const O=qa(x.value,b.value,new Date,i.dateFnsOptions.value);if(ko(O)){if(e.value===null)i.doUpdateValue(gt(N(Date.now())),!1);else if(!Array.isArray(e.value)){const j=Qn(e.value,{year:Ei(O),month:pi(O),date:To(O)});i.doUpdateValue(gt(N(gt(j))),!1)}}else V()}function X(){i.doUpdateValue(null,!0),x.value="",i.doClose(!0),i.handleClearClick()}function W(){i.doUpdateValue(gt(N(Date.now())),!0);const O=Date.now();S.value=O,i.doClose(!0),e.panel&&(t==="month"||t==="quarter"||t==="year")&&(i.disableTransitionOneTick(),D(O))}const q=me(null);function $(O){O.type==="date"&&t==="week"&&(q.value=N(gt(O.ts)))}function le(O){return O.type==="date"&&t==="week"?N(gt(O.ts))===q.value:!1}function ee(O){if(U(O.ts,O.type==="date"?{type:"date",year:O.dateObject.year,month:O.dateObject.month,date:O.dateObject.date}:O.type==="month"?{type:"month",year:O.dateObject.year,month:O.dateObject.month}:O.type==="year"?{type:"year",year:O.dateObject.year}:{type:"quarter",year:O.dateObject.year,quarter:O.dateObject.quarter}))return;let j;if(e.value!==null&&!Array.isArray(e.value)?j=e.value:j=Date.now(),t==="datetime"&&e.defaultTime!==null&&!Array.isArray(e.defaultTime)){const L=zb(e.defaultTime);L&&(j=gt(Qn(j,L)))}switch(j=gt(O.type==="quarter"&&O.dateObject.quarter?mre(uR(j,O.dateObject.year),O.dateObject.quarter):Qn(j,O.dateObject)),i.doUpdateValue(N(j),e.panel||t==="date"||t==="week"||t==="year"),t){case"date":case"week":i.doClose();break;case"year":e.panel&&i.disableTransitionOneTick(),i.doClose();break;case"month":i.disableTransitionOneTick(),D(j);break;case"quarter":i.disableTransitionOneTick(),D(j);break}}function Q(O,j){let L;e.value!==null&&!Array.isArray(e.value)?L=e.value:L=Date.now(),L=gt(O.type==="month"?rP(L,O.dateObject.month):uR(L,O.dateObject.year)),j(L),D(L)}function ne(O){S.value=O}function V(O){if(e.value===null||Array.isArray(e.value)){x.value="";return}O===void 0&&(O=e.value),x.value=oi(O,b.value,i.dateFnsOptions.value)}function ue(){y.isDateInvalid.value||y.isTimeInvalid.value||(i.doConfirm(),ve())}function ve(){e.active&&i.doClose()}function Ce(){var O;S.value=gt(H2(S.value,1)),(O=e.onNextYear)===null||O===void 0||O.call(e)}function G(){var O;S.value=gt(H2(S.value,-1)),(O=e.onPrevYear)===null||O===void 0||O.call(e)}function Z(){var O;S.value=gt(Kn(S.value,1)),(O=e.onNextMonth)===null||O===void 0||O.call(e)}function de(){var O;S.value=gt(Kn(S.value,-1)),(O=e.onPrevMonth)===null||O===void 0||O.call(e)}function Se(){const{value:O}=w;return(O==null?void 0:O.listElRef)||null}function we(){const{value:O}=w;return(O==null?void 0:O.itemsElRef)||null}function _e(O){var j;(j=_.value)===null||j===void 0||j.sync()}function Ee(O){O!==null&&i.doUpdateValue(O,e.panel)}function fe(O){i.cachePendingValue();const j=i.getShortcutValue(O);typeof j=="number"&&i.doUpdateValue(j,!1)}function B(O){const j=i.getShortcutValue(O);typeof j=="number"&&(i.doUpdateValue(j,e.panel),i.clearPendingValue(),ue())}function D(O){const{value:j}=e;if(C.value){const L=pi(O===void 0?j===null?Date.now():j:O);C.value.scrollTo({top:L*uh})}if(w.value){const L=Ei(O===void 0?j===null?Date.now():j:O)-Mx;w.value.scrollTo({top:L*uh})}}const I={monthScrollbarRef:C,yearScrollbarRef:_,yearVlRef:w};return Object.assign(Object.assign(Object.assign(Object.assign({dateArray:M,monthArray:P,yearArray:T,quarterArray:R,calendarYear:H,calendarMonth:F,weekdays:z,mergedIsDateDisabled:U,nextYear:Ce,prevYear:G,nextMonth:Z,prevMonth:de,handleNowClick:W,handleConfirmClick:ue,handleSingleShortcutMouseenter:fe,handleSingleShortcutClick:B},y),i),I),{handleDateClick:ee,handleDateInputBlur:te,handleDateInput:ie,handleDateMouseEnter:$,isWeekHovered:le,handleTimePickerChange:Ee,clearSelectedDateTime:X,virtualListContainer:Se,virtualListContent:we,handleVirtualListScroll:_e,timePickerSize:i.timePickerSize,dateInputValue:x,datePickerSlots:p,handleQuickMonthClick:Q,justifyColumnsScrollState:D,calendarValue:S,onUpdateCalendarValue:ne})}const U6=je({name:"MonthPanel",props:Object.assign(Object.assign({},fP),{type:{type:String,required:!0},useAsQuickJump:Boolean}),setup(e){const t=pP(e,e.type),{dateLocaleRef:r}=wc("DatePicker"),i=o=>{switch(o.type){case"year":return p6(o.dateObject.year,o.yearFormat,r.value.locale);case"month":return f6(o.dateObject.month,o.monthFormat,r.value.locale);case"quarter":return m6(o.dateObject.quarter,o.quarterFormat,r.value.locale)}},{useAsQuickJump:n}=e,a=(o,s,l)=>{const{mergedIsDateDisabled:c,handleDateClick:u,handleQuickMonthClick:d}=t;return E("div",{"data-n-date":!0,key:s,class:[`${l}-date-panel-month-calendar__picker-col-item`,o.isCurrent&&`${l}-date-panel-month-calendar__picker-col-item--current`,o.selected&&`${l}-date-panel-month-calendar__picker-col-item--selected`,!n&&c(o.ts,o.type==="year"?{type:"year",year:o.dateObject.year}:o.type==="month"?{type:"month",year:o.dateObject.year,month:o.dateObject.month}:o.type==="quarter"?{type:"month",year:o.dateObject.year,month:o.dateObject.quarter}:null)&&`${l}-date-panel-month-calendar__picker-col-item--disabled`],onClick:()=>{n?d(o,h=>{e.onUpdateValue(h,!1)}):u(o)}},i(o))};return Or(()=>{t.justifyColumnsScrollState()}),Object.assign(Object.assign({},t),{renderItem:a})},render(){const{mergedClsPrefix:e,mergedTheme:t,shortcuts:r,actions:i,renderItem:n,type:a,onRender:o}=this;return o==null||o(),E("div",{ref:"selfRef",tabindex:0,class:[`${e}-date-panel`,`${e}-date-panel--month`,!this.panel&&`${e}-date-panel--shadow`,this.themeClass],onFocus:this.handlePanelFocus,onKeydown:this.handlePanelKeyDown},E("div",{class:`${e}-date-panel-month-calendar`},E(Sn,{ref:"yearScrollbarRef",class:`${e}-date-panel-month-calendar__picker-col`,theme:t.peers.Scrollbar,themeOverrides:t.peerOverrides.Scrollbar,container:this.virtualListContainer,content:this.virtualListContent,horizontalRailStyle:{zIndex:1},verticalRailStyle:{zIndex:1}},{default:()=>E(fg,{ref:"yearVlRef",items:this.yearArray,itemSize:uh,showScrollbar:!1,keyField:"ts",onScroll:this.handleVirtualListScroll,paddingBottom:4},{default:({item:s,index:l})=>n(s,l,e)})}),a==="month"||a==="quarter"?E("div",{class:`${e}-date-panel-month-calendar__picker-col`},E(Sn,{ref:"monthScrollbarRef",theme:t.peers.Scrollbar,themeOverrides:t.peerOverrides.Scrollbar},{default:()=>[(a==="month"?this.monthArray:this.quarterArray).map((s,l)=>n(s,l,e)),E("div",{class:`${e}-date-panel-${a}-calendar__padding`})]})):null),this.datePickerSlots.footer?E("div",{class:`${e}-date-panel-footer`},{default:this.datePickerSlots.footer}):null,i!=null&&i.length||r?E("div",{class:`${e}-date-panel-actions`},E("div",{class:`${e}-date-panel-actions__prefix`},r&&Object.keys(r).map(s=>{const l=r[s];return Array.isArray(l)?null:E(_u,{size:"tiny",onMouseenter:()=>{this.handleSingleShortcutMouseenter(l)},onClick:()=>{this.handleSingleShortcutClick(l)},onMouseleave:()=>{this.handleShortcutMouseleave()}},{default:()=>s})})),E("div",{class:`${e}-date-panel-actions__suffix`},i!=null&&i.includes("clear")?E(ci,{theme:t.peers.Button,themeOverrides:t.peerOverrides.Button,size:"tiny",onClick:this.handleClearClick},{default:()=>this.locale.clear}):null,i!=null&&i.includes("now")?E(ci,{theme:t.peers.Button,themeOverrides:t.peerOverrides.Button,size:"tiny",onClick:this.handleNowClick},{default:()=>this.locale.now}):null,i!=null&&i.includes("confirm")?E(ci,{theme:t.peers.Button,themeOverrides:t.peerOverrides.Button,size:"tiny",type:"primary",disabled:this.isDateInvalid,onClick:this.handleConfirmClick},{default:()=>this.locale.confirm}):null)):null,E(Qu,{onFocus:this.handleFocusDetectorFocus}))}}),Pp=je({props:{mergedClsPrefix:{type:String,required:!0},value:Number,monthBeforeYear:{type:Boolean,required:!0},calendarMonth:{type:String,required:!0},calendarYear:{type:String,required:!0},onUpdateValue:{type:Function,required:!0}},setup(){const e=me(null),t=me(null),r=me(!1);function i(a){var o;r.value&&!(!((o=e.value)===null||o===void 0)&&o.contains(lc(a)))&&(r.value=!1)}function n(){r.value=!r.value}return{show:r,triggerRef:e,monthPanelRef:t,handleHeaderClick:n,handleClickOutside:i}},render(){const{handleClickOutside:e,mergedClsPrefix:t}=this;return E("div",{class:`${t}-date-panel-month__month-year`,ref:"triggerRef"},E(wh,null,{default:()=>[E(Sh,null,{default:()=>E("div",{class:[`${t}-date-panel-month__text`,this.show&&`${t}-date-panel-month__text--active`],onClick:this.handleHeaderClick},this.monthBeforeYear?[this.calendarMonth," ",this.calendarYear]:[this.calendarYear," ",this.calendarMonth])}),E(Ch,{show:this.show,teleportDisabled:!0},{default:()=>E(La,{name:"fade-in-scale-up-transition",appear:!0},{default:()=>this.show?io(E(U6,{ref:"monthPanelRef",onUpdateValue:this.onUpdateValue,actions:[],type:"month",key:"month",useAsQuickJump:!0,value:this.value}),[[Ru,e,void 0,{capture:!0}]]):null})})]}))}}),$oe=je({name:"DateTimePanel",props:fP,setup(e){return pP(e,"datetime")},render(){var e,t,r,i;const{mergedClsPrefix:n,mergedTheme:a,shortcuts:o,timePickerProps:s,onRender:l,$slots:c}=this;return l==null||l(),E("div",{ref:"selfRef",tabindex:0,class:[`${n}-date-panel`,`${n}-date-panel--datetime`,!this.panel&&`${n}-date-panel--shadow`,this.themeClass],onKeydown:this.handlePanelKeyDown,onFocus:this.handlePanelFocus},E("div",{class:`${n}-date-panel-header`},E(ur,{value:this.dateInputValue,theme:a.peers.Input,themeOverrides:a.peerOverrides.Input,stateful:!1,size:this.timePickerSize,class:`${n}-date-panel-date-input`,textDecoration:this.isDateInvalid?"line-through":"",placeholder:this.locale.selectDate,onBlur:this.handleDateInputBlur,onUpdateValue:this.handleDateInput}),E(LA,Object.assign({size:this.timePickerSize,placeholder:this.locale.selectTime,format:this.timerPickerFormat},Array.isArray(s)?void 0:s,{showIcon:!1,to:!1,theme:a.peers.TimePicker,themeOverrides:a.peerOverrides.TimePicker,value:Array.isArray(this.value)?null:this.value,isHourDisabled:this.isHourDisabled,isMinuteDisabled:this.isMinuteDisabled,isSecondDisabled:this.isSecondDisabled,onUpdateValue:this.handleTimePickerChange,stateful:!1}))),E("div",{class:`${n}-date-panel-calendar`},E("div",{class:`${n}-date-panel-month`},E("div",{class:`${n}-date-panel-month__fast-prev`,onClick:this.prevYear},Cr(c["prev-year"],()=>[E(Ap,null)])),E("div",{class:`${n}-date-panel-month__prev`,onClick:this.prevMonth},Cr(c["prev-month"],()=>[E(_p,null)])),E(Pp,{monthBeforeYear:this.locale.monthBeforeYear,value:this.calendarValue,onUpdateValue:this.onUpdateCalendarValue,mergedClsPrefix:n,calendarMonth:this.calendarMonth,calendarYear:this.calendarYear}),E("div",{class:`${n}-date-panel-month__next`,onClick:this.nextMonth},Cr(c["next-month"],()=>[E(Ep,null)])),E("div",{class:`${n}-date-panel-month__fast-next`,onClick:this.nextYear},Cr(c["next-year"],()=>[E(Mp,null)]))),E("div",{class:`${n}-date-panel-weekdays`},this.weekdays.map(u=>E("div",{key:u,class:`${n}-date-panel-weekdays__day`},u))),E("div",{class:`${n}-date-panel-dates`},this.dateArray.map((u,d)=>E("div",{"data-n-date":!0,key:d,class:[`${n}-date-panel-date`,{[`${n}-date-panel-date--current`]:u.isCurrentDate,[`${n}-date-panel-date--selected`]:u.selected,[`${n}-date-panel-date--excluded`]:!u.inCurrentMonth,[`${n}-date-panel-date--disabled`]:this.mergedIsDateDisabled(u.ts,{type:"date",year:u.dateObject.year,month:u.dateObject.month,date:u.dateObject.date})}],onClick:()=>{this.handleDateClick(u)}},E("div",{class:`${n}-date-panel-date__trigger`}),u.dateObject.date,u.isCurrentDate?E("div",{class:`${n}-date-panel-date__sup`}):null)))),this.datePickerSlots.footer?E("div",{class:`${n}-date-panel-footer`},this.datePickerSlots.footer()):null,!((e=this.actions)===null||e===void 0)&&e.length||o?E("div",{class:`${n}-date-panel-actions`},E("div",{class:`${n}-date-panel-actions__prefix`},o&&Object.keys(o).map(u=>{const d=o[u];return Array.isArray(d)?null:E(_u,{size:"tiny",onMouseenter:()=>{this.handleSingleShortcutMouseenter(d)},onClick:()=>{this.handleSingleShortcutClick(d)},onMouseleave:()=>{this.handleShortcutMouseleave()}},{default:()=>u})})),E("div",{class:`${n}-date-panel-actions__suffix`},!((t=this.actions)===null||t===void 0)&&t.includes("clear")?E(ci,{theme:a.peers.Button,themeOverrides:a.peerOverrides.Button,size:"tiny",onClick:this.clearSelectedDateTime},{default:()=>this.locale.clear}):null,!((r=this.actions)===null||r===void 0)&&r.includes("now")?E(ci,{theme:a.peers.Button,themeOverrides:a.peerOverrides.Button,size:"tiny",onClick:this.handleNowClick},{default:()=>this.locale.now}):null,!((i=this.actions)===null||i===void 0)&&i.includes("confirm")?E(ci,{theme:a.peers.Button,themeOverrides:a.peerOverrides.Button,size:"tiny",type:"primary",disabled:this.isDateInvalid,onClick:this.handleConfirmClick},{default:()=>this.locale.confirm}):null)):null,E(Qu,{onFocus:this.handleFocusDetectorFocus}))}}),mP=Object.assign(Object.assign({},F6),{defaultCalendarStartTime:Number,defaultCalendarEndTime:Number,bindCalendarMonths:Boolean,actions:{type:Array,default:()=>["clear","confirm"]}});function vP(e,t){var r,i;const{isDateDisabledRef:n,isStartHourDisabledRef:a,isEndHourDisabledRef:o,isStartMinuteDisabledRef:s,isEndMinuteDisabledRef:l,isStartSecondDisabledRef:c,isEndSecondDisabledRef:u,isStartDateInvalidRef:d,isEndDateInvalidRef:h,isStartTimeInvalidRef:f,isEndTimeInvalidRef:p,isStartValueInvalidRef:v,isEndValueInvalidRef:m,isRangeInvalidRef:g,localeRef:y,rangesRef:b,closeOnSelectRef:x,updateValueOnCloseRef:S,firstDayOfWeekRef:w,datePickerSlots:_,monthFormatRef:C,yearFormatRef:A,quarterFormatRef:M}=_t(fw),P={isDateDisabled:n,isStartHourDisabled:a,isEndHourDisabled:o,isStartMinuteDisabled:s,isEndMinuteDisabled:l,isStartSecondDisabled:c,isEndSecondDisabled:u,isStartDateInvalid:d,isEndDateInvalid:h,isStartTimeInvalid:f,isEndTimeInvalid:p,isStartValueInvalid:v,isEndValueInvalid:m,isRangeInvalid:g},T=N6(e),R=me(null),z=me(null),F=me(null),H=me(null),N=me(null),U=me(null),ie=me(null),te=me(null),{value:X}=e,W=(r=e.defaultCalendarStartTime)!==null&&r!==void 0?r:Array.isArray(X)&&typeof X[0]=="number"?X[0]:Date.now(),q=me(W),$=me((i=e.defaultCalendarEndTime)!==null&&i!==void 0?i:Array.isArray(X)&&typeof X[1]=="number"?X[1]:gt(Kn(W,1)));Ve(!0);const le=me(Date.now()),ee=me(!1),Q=me(0),ne=re(()=>e.dateFormat||y.value.dateFormat),V=me(Array.isArray(X)?oi(X[0],ne.value,T.dateFnsOptions.value):""),ue=me(Array.isArray(X)?oi(X[1],ne.value,T.dateFnsOptions.value):""),ve=re(()=>ee.value?"end":"start"),Ce=re(()=>{var Pe;return X2(q.value,e.value,le.value,(Pe=w.value)!==null&&Pe!==void 0?Pe:y.value.firstDayOfWeek)}),G=re(()=>{var Pe;return X2($.value,e.value,le.value,(Pe=w.value)!==null&&Pe!==void 0?Pe:y.value.firstDayOfWeek)}),Z=re(()=>Ce.value.slice(0,7).map(Pe=>{const{ts:Qe}=Pe;return oi(Qe,y.value.dayFormat,T.dateFnsOptions.value)})),de=re(()=>oi(q.value,y.value.monthFormat,T.dateFnsOptions.value)),Se=re(()=>oi($.value,y.value.monthFormat,T.dateFnsOptions.value)),we=re(()=>oi(q.value,y.value.yearFormat,T.dateFnsOptions.value)),_e=re(()=>oi($.value,y.value.yearFormat,T.dateFnsOptions.value)),Ee=re(()=>{const{value:Pe}=e;return Array.isArray(Pe)?Pe[0]:null}),fe=re(()=>{const{value:Pe}=e;return Array.isArray(Pe)?Pe[1]:null}),B=re(()=>{const{shortcuts:Pe}=e;return Pe||b.value}),D=re(()=>Z2($h(e.value,"start"),le.value,{yearFormat:A.value})),I=re(()=>Z2($h(e.value,"end"),le.value,{yearFormat:A.value})),O=re(()=>{const Pe=$h(e.value,"start");return Q2(Pe??Date.now(),Pe,le.value,{quarterFormat:M.value})}),j=re(()=>{const Pe=$h(e.value,"end");return Q2(Pe??Date.now(),Pe,le.value,{quarterFormat:M.value})}),L=re(()=>{const Pe=$h(e.value,"start");return K2(Pe??Date.now(),Pe,le.value,{monthFormat:C.value})}),Ae=re(()=>{const Pe=$h(e.value,"end");return K2(Pe??Date.now(),Pe,le.value,{monthFormat:C.value})});rr(re(()=>e.value),Pe=>{if(Pe!==null&&Array.isArray(Pe)){const[Qe,xt]=Pe;V.value=oi(Qe,ne.value,T.dateFnsOptions.value),ue.value=oi(xt,ne.value,T.dateFnsOptions.value),ee.value||ce(Pe)}else V.value="",ue.value=""});function We(Pe,Qe){(t==="daterange"||t==="datetimerange")&&(Ei(Pe)!==Ei(Qe)||pi(Pe)!==pi(Qe))&&T.disableTransitionOneTick()}rr(q,We),rr($,We);function Ve(Pe){const Qe=Hl(q.value),xt=Hl($.value);(e.bindCalendarMonths||Qe>=xt)&&(Pe?$.value=gt(Kn(Qe,1)):q.value=gt(Kn(xt,-1)))}function ke(){q.value=gt(Kn(q.value,12)),Ve(!0)}function et(){q.value=gt(Kn(q.value,-12)),Ve(!0)}function nt(){q.value=gt(Kn(q.value,1)),Ve(!0)}function lt(){q.value=gt(Kn(q.value,-1)),Ve(!0)}function ut(){$.value=gt(Kn($.value,12)),Ve(!1)}function vt(){$.value=gt(Kn($.value,-12)),Ve(!1)}function se(){$.value=gt(Kn($.value,1)),Ve(!1)}function Be(){$.value=gt(Kn($.value,-1)),Ve(!1)}function Ye(Pe){q.value=Pe,Ve(!0)}function pe(Pe){$.value=Pe,Ve(!1)}function Te(Pe){const Qe=n.value;if(!Qe)return!1;if(!Array.isArray(e.value)||ve.value==="start")return Qe(Pe,"start",null);{const{value:xt}=Q;return Pe<Q.value?Qe(Pe,"start",[xt,xt]):Qe(Pe,"end",[xt,xt])}}function ce(Pe){if(Pe===null)return;const[Qe,xt]=Pe;q.value=Qe,Hl(xt)<=Hl(Qe)?$.value=gt(Hl(Kn(Qe,1))):$.value=gt(Hl(xt))}function Re(Pe){if(!ee.value)ee.value=!0,Q.value=Pe.ts,Ke(Pe.ts,Pe.ts,"done");else{ee.value=!1;const{value:Qe}=e;e.panel&&Array.isArray(Qe)?Ke(Qe[0],Qe[1],"done"):x.value&&t==="daterange"&&(S.value?Yt():at())}}function $e(Pe){if(ee.value){if(Te(Pe.ts))return;Pe.ts>=Q.value?Ke(Q.value,Pe.ts,"wipPreview"):Ke(Pe.ts,Q.value,"wipPreview")}}function at(){g.value||(T.doConfirm(),Yt())}function Yt(){ee.value=!1,e.active&&T.doClose()}function nr(Pe){typeof Pe!="number"&&(Pe=gt(Pe)),e.value===null?T.doUpdateValue([Pe,Pe],e.panel):Array.isArray(e.value)&&T.doUpdateValue([Pe,Math.max(e.value[1],Pe)],e.panel)}function Fe(Pe){typeof Pe!="number"&&(Pe=gt(Pe)),e.value===null?T.doUpdateValue([Pe,Pe],e.panel):Array.isArray(e.value)&&T.doUpdateValue([Math.min(e.value[0],Pe),Pe],e.panel)}function Ke(Pe,Qe,xt){if(typeof Pe!="number"&&(Pe=gt(Pe)),xt!=="shortcutPreview"){let Er,ui;if(t==="datetimerange"){const{defaultTime:Ut}=e;Array.isArray(Ut)?(Er=zb(Ut[0]),ui=zb(Ut[1])):(Er=zb(Ut),ui=Er)}Er&&(Pe=gt(Qn(Pe,Er))),ui&&(Qe=gt(Qn(Qe,ui)))}T.doUpdateValue([Pe,Qe],e.panel&&xt==="done")}function dt(Pe){return gt(t==="datetimerange"?tP(Pe):t==="monthrange"?Hl(Pe):yx(Pe))}function Nt(Pe){const Qe=qa(Pe,ne.value,new Date,T.dateFnsOptions.value);if(ko(Qe))if(e.value){if(Array.isArray(e.value)){const xt=Qn(e.value[0],{year:Ei(Qe),month:pi(Qe),date:To(Qe)});nr(dt(gt(xt)))}}else{const xt=Qn(new Date,{year:Ei(Qe),month:pi(Qe),date:To(Qe)});nr(dt(gt(xt)))}else V.value=Pe}function hi(Pe){const Qe=qa(Pe,ne.value,new Date,T.dateFnsOptions.value);if(ko(Qe)){if(e.value===null){const xt=Qn(new Date,{year:Ei(Qe),month:pi(Qe),date:To(Qe)});Fe(dt(gt(xt)))}else if(Array.isArray(e.value)){const xt=Qn(e.value[1],{year:Ei(Qe),month:pi(Qe),date:To(Qe)});Fe(dt(gt(xt)))}}else ue.value=Pe}function Mi(){const Pe=qa(V.value,ne.value,new Date,T.dateFnsOptions.value),{value:Qe}=e;if(ko(Pe)){if(Qe===null){const xt=Qn(new Date,{year:Ei(Pe),month:pi(Pe),date:To(Pe)});nr(dt(gt(xt)))}else if(Array.isArray(Qe)){const xt=Qn(Qe[0],{year:Ei(Pe),month:pi(Pe),date:To(Pe)});nr(dt(gt(xt)))}}else De()}function Mr(){const Pe=qa(ue.value,ne.value,new Date,T.dateFnsOptions.value),{value:Qe}=e;if(ko(Pe)){if(Qe===null){const xt=Qn(new Date,{year:Ei(Pe),month:pi(Pe),date:To(Pe)});Fe(dt(gt(xt)))}else if(Array.isArray(Qe)){const xt=Qn(Qe[1],{year:Ei(Pe),month:pi(Pe),date:To(Pe)});Fe(dt(gt(xt)))}}else De()}function De(Pe){const{value:Qe}=e;if(Qe===null||!Array.isArray(Qe)){V.value="",ue.value="";return}Pe===void 0&&(Pe=Qe),V.value=oi(Pe[0],ne.value,T.dateFnsOptions.value),ue.value=oi(Pe[1],ne.value,T.dateFnsOptions.value)}function K(Pe){Pe!==null&&nr(Pe)}function Me(Pe){Pe!==null&&Fe(Pe)}function He(Pe){T.cachePendingValue();const Qe=T.getShortcutValue(Pe);Array.isArray(Qe)&&Ke(Qe[0],Qe[1],"shortcutPreview")}function Oe(Pe){const Qe=T.getShortcutValue(Pe);Array.isArray(Qe)&&(Ke(Qe[0],Qe[1],"done"),T.clearPendingValue(),at())}function Ne(Pe,Qe){const xt=Pe===void 0?e.value:Pe;if(Pe===void 0||Qe==="start"){if(ie.value){const Er=Array.isArray(xt)?pi(xt[0]):pi(Date.now());ie.value.scrollTo({debounce:!1,index:Er,elSize:uh})}if(N.value){const Er=(Array.isArray(xt)?Ei(xt[0]):Ei(Date.now()))-Mx;N.value.scrollTo({index:Er,debounce:!1})}}if(Pe===void 0||Qe==="end"){if(te.value){const Er=Array.isArray(xt)?pi(xt[1]):pi(Date.now());te.value.scrollTo({debounce:!1,index:Er,elSize:uh})}if(U.value){const Er=(Array.isArray(xt)?Ei(xt[1]):Ei(Date.now()))-Mx;U.value.scrollTo({index:Er,debounce:!1})}}}function wt(Pe,Qe){const{value:xt}=e,Er=!Array.isArray(xt),ui=Pe.type==="year"&&t!=="yearrange"?Er?Qn(Pe.ts,{month:pi(t==="quarterrange"?gg(new Date):new Date)}).valueOf():Qn(Pe.ts,{month:pi(t==="quarterrange"?gg(xt[Qe==="start"?0:1]):xt[Qe==="start"?0:1])}).valueOf():Pe.ts;if(Er){const En=dt(ui),er=[En,En];T.doUpdateValue(er,e.panel),Ne(er,"start"),Ne(er,"end"),T.disableTransitionOneTick();return}const Ut=[xt[0],xt[1]];let ar=!1;switch(Qe==="start"?(Ut[0]=dt(ui),Ut[0]>Ut[1]&&(Ut[1]=Ut[0],ar=!0)):(Ut[1]=dt(ui),Ut[0]>Ut[1]&&(Ut[0]=Ut[1],ar=!0)),T.doUpdateValue(Ut,e.panel),t){case"monthrange":case"quarterrange":T.disableTransitionOneTick(),ar?(Ne(Ut,"start"),Ne(Ut,"end")):Ne(Ut,Qe);break;case"yearrange":T.disableTransitionOneTick(),Ne(Ut,"start"),Ne(Ut,"end")}}function Rt(){var Pe;(Pe=F.value)===null||Pe===void 0||Pe.sync()}function It(){var Pe;(Pe=H.value)===null||Pe===void 0||Pe.sync()}function Tt(Pe){var Qe,xt;return Pe==="start"?((Qe=N.value)===null||Qe===void 0?void 0:Qe.listElRef)||null:((xt=U.value)===null||xt===void 0?void 0:xt.listElRef)||null}function fr(Pe){var Qe,xt;return Pe==="start"?((Qe=N.value)===null||Qe===void 0?void 0:Qe.itemsElRef)||null:((xt=U.value)===null||xt===void 0?void 0:xt.itemsElRef)||null}const Jt={startYearVlRef:N,endYearVlRef:U,startMonthScrollbarRef:ie,endMonthScrollbarRef:te,startYearScrollbarRef:F,endYearScrollbarRef:H};return Object.assign(Object.assign(Object.assign(Object.assign({startDatesElRef:R,endDatesElRef:z,handleDateClick:Re,handleColItemClick:wt,handleDateMouseEnter:$e,handleConfirmClick:at,startCalendarPrevYear:et,startCalendarPrevMonth:lt,startCalendarNextYear:ke,startCalendarNextMonth:nt,endCalendarPrevYear:vt,endCalendarPrevMonth:Be,endCalendarNextMonth:se,endCalendarNextYear:ut,mergedIsDateDisabled:Te,changeStartEndTime:Ke,ranges:b,startCalendarMonth:de,startCalendarYear:we,endCalendarMonth:Se,endCalendarYear:_e,weekdays:Z,startDateArray:Ce,endDateArray:G,startYearArray:D,startMonthArray:L,startQuarterArray:O,endYearArray:I,endMonthArray:Ae,endQuarterArray:j,isSelecting:ee,handleRangeShortcutMouseenter:He,handleRangeShortcutClick:Oe},T),P),Jt),{startDateDisplayString:V,endDateInput:ue,timePickerSize:T.timePickerSize,startTimeValue:Ee,endTimeValue:fe,datePickerSlots:_,shortcuts:B,startCalendarDateTime:q,endCalendarDateTime:$,justifyColumnsScrollState:Ne,handleFocusDetectorFocus:T.handleFocusDetectorFocus,handleStartTimePickerChange:K,handleEndTimePickerChange:Me,handleStartDateInput:Nt,handleStartDateInputBlur:Mi,handleEndDateInput:hi,handleEndDateInputBlur:Mr,handleStartYearVlScroll:Rt,handleEndYearVlScroll:It,virtualListContainer:Tt,virtualListContent:fr,onUpdateStartCalendarValue:Ye,onUpdateEndCalendarValue:pe})}const qoe=je({name:"DateTimeRangePanel",props:mP,setup(e){return vP(e,"datetimerange")},render(){var e,t,r;const{mergedClsPrefix:i,mergedTheme:n,shortcuts:a,timePickerProps:o,onRender:s,$slots:l}=this;return s==null||s(),E("div",{ref:"selfRef",tabindex:0,class:[`${i}-date-panel`,`${i}-date-panel--datetimerange`,!this.panel&&`${i}-date-panel--shadow`,this.themeClass],onKeydown:this.handlePanelKeyDown,onFocus:this.handlePanelFocus},E("div",{class:`${i}-date-panel-header`},E(ur,{value:this.startDateDisplayString,theme:n.peers.Input,themeOverrides:n.peerOverrides.Input,size:this.timePickerSize,stateful:!1,class:`${i}-date-panel-date-input`,textDecoration:this.isStartValueInvalid?"line-through":"",placeholder:this.locale.selectDate,onBlur:this.handleStartDateInputBlur,onUpdateValue:this.handleStartDateInput}),E(LA,Object.assign({placeholder:this.locale.selectTime,format:this.timerPickerFormat,size:this.timePickerSize},Array.isArray(o)?o[0]:o,{value:this.startTimeValue,to:!1,showIcon:!1,disabled:this.isSelecting,theme:n.peers.TimePicker,themeOverrides:n.peerOverrides.TimePicker,stateful:!1,isHourDisabled:this.isStartHourDisabled,isMinuteDisabled:this.isStartMinuteDisabled,isSecondDisabled:this.isStartSecondDisabled,onUpdateValue:this.handleStartTimePickerChange})),E(ur,{value:this.endDateInput,theme:n.peers.Input,themeOverrides:n.peerOverrides.Input,stateful:!1,size:this.timePickerSize,class:`${i}-date-panel-date-input`,textDecoration:this.isEndValueInvalid?"line-through":"",placeholder:this.locale.selectDate,onBlur:this.handleEndDateInputBlur,onUpdateValue:this.handleEndDateInput}),E(LA,Object.assign({placeholder:this.locale.selectTime,format:this.timerPickerFormat,size:this.timePickerSize},Array.isArray(o)?o[1]:o,{disabled:this.isSelecting,showIcon:!1,theme:n.peers.TimePicker,themeOverrides:n.peerOverrides.TimePicker,to:!1,stateful:!1,value:this.endTimeValue,isHourDisabled:this.isEndHourDisabled,isMinuteDisabled:this.isEndMinuteDisabled,isSecondDisabled:this.isEndSecondDisabled,onUpdateValue:this.handleEndTimePickerChange}))),E("div",{ref:"startDatesElRef",class:`${i}-date-panel-calendar ${i}-date-panel-calendar--start`},E("div",{class:`${i}-date-panel-month`},E("div",{class:`${i}-date-panel-month__fast-prev`,onClick:this.startCalendarPrevYear},Cr(l["prev-year"],()=>[E(Ap,null)])),E("div",{class:`${i}-date-panel-month__prev`,onClick:this.startCalendarPrevMonth},Cr(l["prev-month"],()=>[E(_p,null)])),E(Pp,{monthBeforeYear:this.locale.monthBeforeYear,value:this.startCalendarDateTime,onUpdateValue:this.onUpdateStartCalendarValue,mergedClsPrefix:i,calendarMonth:this.startCalendarMonth,calendarYear:this.startCalendarYear}),E("div",{class:`${i}-date-panel-month__next`,onClick:this.startCalendarNextMonth},Cr(l["next-month"],()=>[E(Ep,null)])),E("div",{class:`${i}-date-panel-month__fast-next`,onClick:this.startCalendarNextYear},Cr(l["next-year"],()=>[E(Mp,null)]))),E("div",{class:`${i}-date-panel-weekdays`},this.weekdays.map(c=>E("div",{key:c,class:`${i}-date-panel-weekdays__day`},c))),E("div",{class:`${i}-date-panel__divider`}),E("div",{class:`${i}-date-panel-dates`},this.startDateArray.map((c,u)=>{const d=this.mergedIsDateDisabled(c.ts);return E("div",{"data-n-date":!0,key:u,class:[`${i}-date-panel-date`,{[`${i}-date-panel-date--excluded`]:!c.inCurrentMonth,[`${i}-date-panel-date--current`]:c.isCurrentDate,[`${i}-date-panel-date--selected`]:c.selected,[`${i}-date-panel-date--covered`]:c.inSpan,[`${i}-date-panel-date--start`]:c.startOfSpan,[`${i}-date-panel-date--end`]:c.endOfSpan,[`${i}-date-panel-date--disabled`]:d}],onClick:d?void 0:()=>{this.handleDateClick(c)},onMouseenter:d?void 0:()=>{this.handleDateMouseEnter(c)}},E("div",{class:`${i}-date-panel-date__trigger`}),c.dateObject.date,c.isCurrentDate?E("div",{class:`${i}-date-panel-date__sup`}):null)}))),E("div",{class:`${i}-date-panel__vertical-divider`}),E("div",{ref:"endDatesElRef",class:`${i}-date-panel-calendar ${i}-date-panel-calendar--end`},E("div",{class:`${i}-date-panel-month`},E("div",{class:`${i}-date-panel-month__fast-prev`,onClick:this.endCalendarPrevYear},Cr(l["prev-year"],()=>[E(Ap,null)])),E("div",{class:`${i}-date-panel-month__prev`,onClick:this.endCalendarPrevMonth},Cr(l["prev-month"],()=>[E(_p,null)])),E(Pp,{monthBeforeYear:this.locale.monthBeforeYear,value:this.endCalendarDateTime,onUpdateValue:this.onUpdateEndCalendarValue,mergedClsPrefix:i,calendarMonth:this.endCalendarMonth,calendarYear:this.endCalendarYear}),E("div",{class:`${i}-date-panel-month__next`,onClick:this.endCalendarNextMonth},Cr(l["next-month"],()=>[E(Ep,null)])),E("div",{class:`${i}-date-panel-month__fast-next`,onClick:this.endCalendarNextYear},Cr(l["next-year"],()=>[E(Mp,null)]))),E("div",{class:`${i}-date-panel-weekdays`},this.weekdays.map(c=>E("div",{key:c,class:`${i}-date-panel-weekdays__day`},c))),E("div",{class:`${i}-date-panel__divider`}),E("div",{class:`${i}-date-panel-dates`},this.endDateArray.map((c,u)=>{const d=this.mergedIsDateDisabled(c.ts);return E("div",{"data-n-date":!0,key:u,class:[`${i}-date-panel-date`,{[`${i}-date-panel-date--excluded`]:!c.inCurrentMonth,[`${i}-date-panel-date--current`]:c.isCurrentDate,[`${i}-date-panel-date--selected`]:c.selected,[`${i}-date-panel-date--covered`]:c.inSpan,[`${i}-date-panel-date--start`]:c.startOfSpan,[`${i}-date-panel-date--end`]:c.endOfSpan,[`${i}-date-panel-date--disabled`]:d}],onClick:d?void 0:()=>{this.handleDateClick(c)},onMouseenter:d?void 0:()=>{this.handleDateMouseEnter(c)}},E("div",{class:`${i}-date-panel-date__trigger`}),c.dateObject.date,c.isCurrentDate?E("div",{class:`${i}-date-panel-date__sup`}):null)}))),this.datePickerSlots.footer?E("div",{class:`${i}-date-panel-footer`},this.datePickerSlots.footer()):null,!((e=this.actions)===null||e===void 0)&&e.length||a?E("div",{class:`${i}-date-panel-actions`},E("div",{class:`${i}-date-panel-actions__prefix`},a&&Object.keys(a).map(c=>{const u=a[c];return Array.isArray(u)||typeof u=="function"?E(_u,{size:"tiny",onMouseenter:()=>{this.handleRangeShortcutMouseenter(u)},onClick:()=>{this.handleRangeShortcutClick(u)},onMouseleave:()=>{this.handleShortcutMouseleave()}},{default:()=>c}):null})),E("div",{class:`${i}-date-panel-actions__suffix`},!((t=this.actions)===null||t===void 0)&&t.includes("clear")?E(ci,{theme:n.peers.Button,themeOverrides:n.peerOverrides.Button,size:"tiny",onClick:this.handleClearClick},{default:()=>this.locale.clear}):null,!((r=this.actions)===null||r===void 0)&&r.includes("confirm")?E(ci,{theme:n.peers.Button,themeOverrides:n.peerOverrides.Button,size:"tiny",type:"primary",disabled:this.isRangeInvalid||this.isSelecting,onClick:this.handleConfirmClick},{default:()=>this.locale.confirm}):null)):null,E(Qu,{onFocus:this.handleFocusDetectorFocus}))}}),Yoe=je({name:"DatePanel",props:Object.assign(Object.assign({},fP),{type:{type:String,required:!0}}),setup(e){return pP(e,e.type)},render(){var e,t,r;const{mergedClsPrefix:i,mergedTheme:n,shortcuts:a,onRender:o,$slots:s,type:l}=this;return o==null||o(),E("div",{ref:"selfRef",tabindex:0,class:[`${i}-date-panel`,`${i}-date-panel--${l}`,!this.panel&&`${i}-date-panel--shadow`,this.themeClass],onFocus:this.handlePanelFocus,onKeydown:this.handlePanelKeyDown},E("div",{class:`${i}-date-panel-calendar`},E("div",{class:`${i}-date-panel-month`},E("div",{class:`${i}-date-panel-month__fast-prev`,onClick:this.prevYear},Cr(s["prev-year"],()=>[E(Ap,null)])),E("div",{class:`${i}-date-panel-month__prev`,onClick:this.prevMonth},Cr(s["prev-month"],()=>[E(_p,null)])),E(Pp,{monthBeforeYear:this.locale.monthBeforeYear,value:this.calendarValue,onUpdateValue:this.onUpdateCalendarValue,mergedClsPrefix:i,calendarMonth:this.calendarMonth,calendarYear:this.calendarYear}),E("div",{class:`${i}-date-panel-month__next`,onClick:this.nextMonth},Cr(s["next-month"],()=>[E(Ep,null)])),E("div",{class:`${i}-date-panel-month__fast-next`,onClick:this.nextYear},Cr(s["next-year"],()=>[E(Mp,null)]))),E("div",{class:`${i}-date-panel-weekdays`},this.weekdays.map(c=>E("div",{key:c,class:`${i}-date-panel-weekdays__day`},c))),E("div",{class:`${i}-date-panel-dates`},this.dateArray.map((c,u)=>E("div",{"data-n-date":!0,key:u,class:[`${i}-date-panel-date`,{[`${i}-date-panel-date--current`]:c.isCurrentDate,[`${i}-date-panel-date--selected`]:c.selected,[`${i}-date-panel-date--excluded`]:!c.inCurrentMonth,[`${i}-date-panel-date--disabled`]:this.mergedIsDateDisabled(c.ts,{type:"date",year:c.dateObject.year,month:c.dateObject.month,date:c.dateObject.date}),[`${i}-date-panel-date--week-hovered`]:this.isWeekHovered(c),[`${i}-date-panel-date--week-selected`]:c.inSelectedWeek}],onClick:()=>{this.handleDateClick(c)},onMouseenter:()=>{this.handleDateMouseEnter(c)}},E("div",{class:`${i}-date-panel-date__trigger`}),c.dateObject.date,c.isCurrentDate?E("div",{class:`${i}-date-panel-date__sup`}):null)))),this.datePickerSlots.footer?E("div",{class:`${i}-date-panel-footer`},this.datePickerSlots.footer()):null,!((e=this.actions)===null||e===void 0)&&e.length||a?E("div",{class:`${i}-date-panel-actions`},E("div",{class:`${i}-date-panel-actions__prefix`},a&&Object.keys(a).map(c=>{const u=a[c];return Array.isArray(u)?null:E(_u,{size:"tiny",onMouseenter:()=>{this.handleSingleShortcutMouseenter(u)},onClick:()=>{this.handleSingleShortcutClick(u)},onMouseleave:()=>{this.handleShortcutMouseleave()}},{default:()=>c})})),E("div",{class:`${i}-date-panel-actions__suffix`},!((t=this.actions)===null||t===void 0)&&t.includes("clear")?E(ci,{theme:n.peers.Button,themeOverrides:n.peerOverrides.Button,size:"tiny",onClick:this.handleClearClick},{default:()=>this.locale.clear}):null,!((r=this.actions)===null||r===void 0)&&r.includes("now")?E(ci,{theme:n.peers.Button,themeOverrides:n.peerOverrides.Button,size:"tiny",onClick:this.handleNowClick},{default:()=>this.locale.now}):null)):null,E(Qu,{onFocus:this.handleFocusDetectorFocus}))}}),Xoe=je({name:"DateRangePanel",props:mP,setup(e){return vP(e,"daterange")},render(){var e,t,r;const{mergedClsPrefix:i,mergedTheme:n,shortcuts:a,onRender:o,$slots:s}=this;return o==null||o(),E("div",{ref:"selfRef",tabindex:0,class:[`${i}-date-panel`,`${i}-date-panel--daterange`,!this.panel&&`${i}-date-panel--shadow`,this.themeClass],onKeydown:this.handlePanelKeyDown,onFocus:this.handlePanelFocus},E("div",{ref:"startDatesElRef",class:`${i}-date-panel-calendar ${i}-date-panel-calendar--start`},E("div",{class:`${i}-date-panel-month`},E("div",{class:`${i}-date-panel-month__fast-prev`,onClick:this.startCalendarPrevYear},Cr(s["prev-year"],()=>[E(Ap,null)])),E("div",{class:`${i}-date-panel-month__prev`,onClick:this.startCalendarPrevMonth},Cr(s["prev-month"],()=>[E(_p,null)])),E(Pp,{monthBeforeYear:this.locale.monthBeforeYear,value:this.startCalendarDateTime,onUpdateValue:this.onUpdateStartCalendarValue,mergedClsPrefix:i,calendarMonth:this.startCalendarMonth,calendarYear:this.startCalendarYear}),E("div",{class:`${i}-date-panel-month__next`,onClick:this.startCalendarNextMonth},Cr(s["next-month"],()=>[E(Ep,null)])),E("div",{class:`${i}-date-panel-month__fast-next`,onClick:this.startCalendarNextYear},Cr(s["next-year"],()=>[E(Mp,null)]))),E("div",{class:`${i}-date-panel-weekdays`},this.weekdays.map(l=>E("div",{key:l,class:`${i}-date-panel-weekdays__day`},l))),E("div",{class:`${i}-date-panel__divider`}),E("div",{class:`${i}-date-panel-dates`},this.startDateArray.map((l,c)=>E("div",{"data-n-date":!0,key:c,class:[`${i}-date-panel-date`,{[`${i}-date-panel-date--excluded`]:!l.inCurrentMonth,[`${i}-date-panel-date--current`]:l.isCurrentDate,[`${i}-date-panel-date--selected`]:l.selected,[`${i}-date-panel-date--covered`]:l.inSpan,[`${i}-date-panel-date--start`]:l.startOfSpan,[`${i}-date-panel-date--end`]:l.endOfSpan,[`${i}-date-panel-date--disabled`]:this.mergedIsDateDisabled(l.ts)}],onClick:()=>{this.handleDateClick(l)},onMouseenter:()=>{this.handleDateMouseEnter(l)}},E("div",{class:`${i}-date-panel-date__trigger`}),l.dateObject.date,l.isCurrentDate?E("div",{class:`${i}-date-panel-date__sup`}):null)))),E("div",{class:`${i}-date-panel__vertical-divider`}),E("div",{ref:"endDatesElRef",class:`${i}-date-panel-calendar ${i}-date-panel-calendar--end`},E("div",{class:`${i}-date-panel-month`},E("div",{class:`${i}-date-panel-month__fast-prev`,onClick:this.endCalendarPrevYear},Cr(s["prev-year"],()=>[E(Ap,null)])),E("div",{class:`${i}-date-panel-month__prev`,onClick:this.endCalendarPrevMonth},Cr(s["prev-month"],()=>[E(_p,null)])),E(Pp,{monthBeforeYear:this.locale.monthBeforeYear,value:this.endCalendarDateTime,onUpdateValue:this.onUpdateEndCalendarValue,mergedClsPrefix:i,calendarMonth:this.endCalendarMonth,calendarYear:this.endCalendarYear}),E("div",{class:`${i}-date-panel-month__next`,onClick:this.endCalendarNextMonth},Cr(s["next-month"],()=>[E(Ep,null)])),E("div",{class:`${i}-date-panel-month__fast-next`,onClick:this.endCalendarNextYear},Cr(s["next-year"],()=>[E(Mp,null)]))),E("div",{class:`${i}-date-panel-weekdays`},this.weekdays.map(l=>E("div",{key:l,class:`${i}-date-panel-weekdays__day`},l))),E("div",{class:`${i}-date-panel__divider`}),E("div",{class:`${i}-date-panel-dates`},this.endDateArray.map((l,c)=>E("div",{"data-n-date":!0,key:c,class:[`${i}-date-panel-date`,{[`${i}-date-panel-date--excluded`]:!l.inCurrentMonth,[`${i}-date-panel-date--current`]:l.isCurrentDate,[`${i}-date-panel-date--selected`]:l.selected,[`${i}-date-panel-date--covered`]:l.inSpan,[`${i}-date-panel-date--start`]:l.startOfSpan,[`${i}-date-panel-date--end`]:l.endOfSpan,[`${i}-date-panel-date--disabled`]:this.mergedIsDateDisabled(l.ts)}],onClick:()=>{this.handleDateClick(l)},onMouseenter:()=>{this.handleDateMouseEnter(l)}},E("div",{class:`${i}-date-panel-date__trigger`}),l.dateObject.date,l.isCurrentDate?E("div",{class:`${i}-date-panel-date__sup`}):null)))),this.datePickerSlots.footer?E("div",{class:`${i}-date-panel-footer`},this.datePickerSlots.footer()):null,!((e=this.actions)===null||e===void 0)&&e.length||a?E("div",{class:`${i}-date-panel-actions`},E("div",{class:`${i}-date-panel-actions__prefix`},a&&Object.keys(a).map(l=>{const c=a[l];return Array.isArray(c)||typeof c=="function"?E(_u,{size:"tiny",onMouseenter:()=>{this.handleRangeShortcutMouseenter(c)},onClick:()=>{this.handleRangeShortcutClick(c)},onMouseleave:()=>{this.handleShortcutMouseleave()}},{default:()=>l}):null})),E("div",{class:`${i}-date-panel-actions__suffix`},!((t=this.actions)===null||t===void 0)&&t.includes("clear")?E(ci,{theme:n.peers.Button,themeOverrides:n.peerOverrides.Button,size:"tiny",onClick:this.handleClearClick},{default:()=>this.locale.clear}):null,!((r=this.actions)===null||r===void 0)&&r.includes("confirm")?E(ci,{theme:n.peers.Button,themeOverrides:n.peerOverrides.Button,size:"tiny",type:"primary",disabled:this.isRangeInvalid||this.isSelecting,onClick:this.handleConfirmClick},{default:()=>this.locale.confirm}):null)):null,E(Qu,{onFocus:this.handleFocusDetectorFocus}))}}),Koe=je({name:"MonthRangePanel",props:Object.assign(Object.assign({},mP),{type:{type:String,required:!0}}),setup(e){const t=vP(e,e.type),{dateLocaleRef:r}=wc("DatePicker"),i=(n,a,o,s)=>{const{handleColItemClick:l}=t;return E("div",{"data-n-date":!0,key:a,class:[`${o}-date-panel-month-calendar__picker-col-item`,n.isCurrent&&`${o}-date-panel-month-calendar__picker-col-item--current`,n.selected&&`${o}-date-panel-month-calendar__picker-col-item--selected`,!1],onClick:()=>{l(n,s)}},n.type==="month"?f6(n.dateObject.month,n.monthFormat,r.value.locale):n.type==="quarter"?m6(n.dateObject.quarter,n.quarterFormat,r.value.locale):p6(n.dateObject.year,n.yearFormat,r.value.locale))};return Or(()=>{t.justifyColumnsScrollState()}),Object.assign(Object.assign({},t),{renderItem:i})},render(){var e,t,r;const{mergedClsPrefix:i,mergedTheme:n,shortcuts:a,type:o,renderItem:s,onRender:l}=this;return l==null||l(),E("div",{ref:"selfRef",tabindex:0,class:[`${i}-date-panel`,`${i}-date-panel--daterange`,!this.panel&&`${i}-date-panel--shadow`,this.themeClass],onKeydown:this.handlePanelKeyDown,onFocus:this.handlePanelFocus},E("div",{ref:"startDatesElRef",class:`${i}-date-panel-calendar ${i}-date-panel-calendar--start`},E("div",{class:`${i}-date-panel-month-calendar`},E(Sn,{ref:"startYearScrollbarRef",class:`${i}-date-panel-month-calendar__picker-col`,theme:n.peers.Scrollbar,themeOverrides:n.peerOverrides.Scrollbar,container:()=>this.virtualListContainer("start"),content:()=>this.virtualListContent("start"),horizontalRailStyle:{zIndex:1},verticalRailStyle:{zIndex:1}},{default:()=>E(fg,{ref:"startYearVlRef",items:this.startYearArray,itemSize:uh,showScrollbar:!1,keyField:"ts",onScroll:this.handleStartYearVlScroll,paddingBottom:4},{default:({item:c,index:u})=>s(c,u,i,"start")})}),o==="monthrange"||o==="quarterrange"?E("div",{class:`${i}-date-panel-month-calendar__picker-col`},E(Sn,{ref:"startMonthScrollbarRef",theme:n.peers.Scrollbar,themeOverrides:n.peerOverrides.Scrollbar},{default:()=>[(o==="monthrange"?this.startMonthArray:this.startQuarterArray).map((c,u)=>s(c,u,i,"start")),o==="monthrange"&&E("div",{class:`${i}-date-panel-month-calendar__padding`})]})):null)),E("div",{class:`${i}-date-panel__vertical-divider`}),E("div",{ref:"endDatesElRef",class:`${i}-date-panel-calendar ${i}-date-panel-calendar--end`},E("div",{class:`${i}-date-panel-month-calendar`},E(Sn,{ref:"endYearScrollbarRef",class:`${i}-date-panel-month-calendar__picker-col`,theme:n.peers.Scrollbar,themeOverrides:n.peerOverrides.Scrollbar,container:()=>this.virtualListContainer("end"),content:()=>this.virtualListContent("end"),horizontalRailStyle:{zIndex:1},verticalRailStyle:{zIndex:1}},{default:()=>E(fg,{ref:"endYearVlRef",items:this.endYearArray,itemSize:uh,showScrollbar:!1,keyField:"ts",onScroll:this.handleEndYearVlScroll,paddingBottom:4},{default:({item:c,index:u})=>s(c,u,i,"end")})}),o==="monthrange"||o==="quarterrange"?E("div",{class:`${i}-date-panel-month-calendar__picker-col`},E(Sn,{ref:"endMonthScrollbarRef",theme:n.peers.Scrollbar,themeOverrides:n.peerOverrides.Scrollbar},{default:()=>[(o==="monthrange"?this.endMonthArray:this.endQuarterArray).map((c,u)=>s(c,u,i,"end")),o==="monthrange"&&E("div",{class:`${i}-date-panel-month-calendar__padding`})]})):null)),this.datePickerSlots.footer?E("div",{class:`${i}-date-panel-footer`},gs(this.datePickerSlots,"footer")):null,!((e=this.actions)===null||e===void 0)&&e.length||a?E("div",{class:`${i}-date-panel-actions`},E("div",{class:`${i}-date-panel-actions__prefix`},a&&Object.keys(a).map(c=>{const u=a[c];return Array.isArray(u)||typeof u=="function"?E(_u,{size:"tiny",onMouseenter:()=>{this.handleRangeShortcutMouseenter(u)},onClick:()=>{this.handleRangeShortcutClick(u)},onMouseleave:()=>{this.handleShortcutMouseleave()}},{default:()=>c}):null})),E("div",{class:`${i}-date-panel-actions__suffix`},!((t=this.actions)===null||t===void 0)&&t.includes("clear")?E(_u,{theme:n.peers.Button,themeOverrides:n.peerOverrides.Button,size:"tiny",onClick:this.handleClearClick},{default:()=>this.locale.clear}):null,!((r=this.actions)===null||r===void 0)&&r.includes("confirm")?E(_u,{theme:n.peers.Button,themeOverrides:n.peerOverrides.Button,size:"tiny",type:"primary",disabled:this.isRangeInvalid,onClick:this.handleConfirmClick},{default:()=>this.locale.confirm}):null)):null,E(Qu,{onFocus:this.handleFocusDetectorFocus}))}}),Qoe=ge([oe("date-picker",`
 position: relative;
 z-index: auto;
 `,[oe("date-picker-icon",`
 color: var(--n-icon-color-override);
 transition: color .3s var(--n-bezier);
 `),oe("icon",`
 color: var(--n-icon-color-override);
 transition: color .3s var(--n-bezier);
 `),xe("disabled",[oe("date-picker-icon",`
 color: var(--n-icon-color-disabled-override);
 `),oe("icon",`
 color: var(--n-icon-color-disabled-override);
 `)])]),oe("date-panel",`
 width: fit-content;
 outline: none;
 margin: 4px 0;
 display: grid;
 grid-template-columns: 0fr;
 border-radius: var(--n-panel-border-radius);
 background-color: var(--n-panel-color);
 color: var(--n-panel-text-color);
 user-select: none;
 `,[tm(),xe("shadow",`
 box-shadow: var(--n-panel-box-shadow);
 `),oe("date-panel-calendar",{padding:"var(--n-calendar-left-padding)",display:"grid",gridTemplateColumns:"1fr",gridArea:"left-calendar"},[xe("end",{padding:"var(--n-calendar-right-padding)",gridArea:"right-calendar"})]),oe("date-panel-month-calendar",{display:"flex",gridArea:"left-calendar"},[he("picker-col",`
 min-width: var(--n-scroll-item-width);
 height: calc(var(--n-scroll-item-height) * 6);
 user-select: none;
 -webkit-user-select: none;
 `,[ge("&:first-child",`
 min-width: calc(var(--n-scroll-item-width) + 4px);
 `,[he("picker-col-item",[ge("&::before","left: 4px;")])]),he("padding",`
 height: calc(var(--n-scroll-item-height) * 5)
 `)]),he("picker-col-item",`
 z-index: 0;
 cursor: pointer;
 height: var(--n-scroll-item-height);
 box-sizing: border-box;
 padding-top: 4px;
 display: flex;
 align-items: center;
 justify-content: center;
 position: relative;
 transition: 
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier);
 background: #0000;
 color: var(--n-item-text-color);
 `,[ge("&::before",`
 z-index: -1;
 content: "";
 position: absolute;
 left: 0;
 right: 4px;
 top: 4px;
 bottom: 0;
 border-radius: var(--n-scroll-item-border-radius);
 transition: 
 background-color .3s var(--n-bezier);
 `),br("disabled",[ge("&:hover::before",`
 background-color: var(--n-item-color-hover);
 `),xe("selected",`
 color: var(--n-item-color-active);
 `,[ge("&::before","background-color: var(--n-item-color-hover);")])]),xe("disabled",`
 color: var(--n-item-text-color-disabled);
 cursor: not-allowed;
 `,[xe("selected",[ge("&::before",`
 background-color: var(--n-item-color-disabled);
 `)])])])]),xe("date",{gridTemplateAreas:`
 "left-calendar"
 "footer"
 "action"
 `}),xe("week",{gridTemplateAreas:`
 "left-calendar"
 "footer"
 "action"
 `}),xe("daterange",{gridTemplateAreas:`
 "left-calendar divider right-calendar"
 "footer footer footer"
 "action action action"
 `}),xe("datetime",{gridTemplateAreas:`
 "header"
 "left-calendar"
 "footer"
 "action"
 `}),xe("datetimerange",{gridTemplateAreas:`
 "header header header"
 "left-calendar divider right-calendar"
 "footer footer footer"
 "action action action"
 `}),xe("month",{gridTemplateAreas:`
 "left-calendar"
 "footer"
 "action"
 `}),oe("date-panel-footer",{gridArea:"footer"}),oe("date-panel-actions",{gridArea:"action"}),oe("date-panel-header",{gridArea:"header"}),oe("date-panel-header",`
 box-sizing: border-box;
 width: 100%;
 align-items: center;
 padding: var(--n-panel-header-padding);
 display: flex;
 justify-content: space-between;
 border-bottom: 1px solid var(--n-panel-header-divider-color);
 `,[ge(">",[ge("*:not(:last-child)",{marginRight:"10px"}),ge("*",{flex:1,width:0}),oe("time-picker",{zIndex:1})])]),oe("date-panel-month",`
 box-sizing: border-box;
 display: grid;
 grid-template-columns: var(--n-calendar-title-grid-template-columns);
 align-items: center;
 justify-items: center;
 padding: var(--n-calendar-title-padding);
 height: var(--n-calendar-title-height);
 `,[he("prev, next, fast-prev, fast-next",`
 line-height: 0;
 cursor: pointer;
 width: var(--n-arrow-size);
 height: var(--n-arrow-size);
 color: var(--n-arrow-color);
 `),he("month-year",`
 user-select: none;
 -webkit-user-select: none;
 flex-grow: 1;
 position: relative;
 `,[he("text",`
 font-size: var(--n-calendar-title-font-size);
 line-height: var(--n-calendar-title-font-size);
 font-weight: var(--n-calendar-title-font-weight);
 padding: 6px 8px;
 text-align: center;
 color: var(--n-calendar-title-text-color);
 cursor: pointer;
 transition: background-color .3s var(--n-bezier);
 border-radius: var(--n-panel-border-radius);
 `,[xe("active",`
 background-color: var(--n-calendar-title-color-hover);
 `),ge("&:hover",`
 background-color: var(--n-calendar-title-color-hover);
 `)])])]),oe("date-panel-weekdays",`
 display: grid;
 margin: auto;
 grid-template-columns: repeat(7, var(--n-item-cell-width));
 grid-template-rows: repeat(1, var(--n-item-cell-height));
 align-items: center;
 justify-items: center;
 margin-bottom: 4px;
 border-bottom: 1px solid var(--n-calendar-days-divider-color);
 `,[he("day",`
 user-select: none;
 -webkit-user-select: none;
 line-height: 15px;
 width: var(--n-item-size);
 text-align: center;
 font-size: var(--n-calendar-days-font-size);
 color: var(--n-item-text-color);
 `)]),oe("date-panel-dates",`
 margin: auto;
 display: grid;
 grid-template-columns: repeat(7, var(--n-item-cell-width));
 grid-template-rows: repeat(6, var(--n-item-cell-height));
 align-items: center;
 justify-items: center;
 flex-wrap: wrap;
 `,[oe("date-panel-date",`
 user-select: none;
 -webkit-user-select: none;
 position: relative;
 width: var(--n-item-size);
 height: var(--n-item-size);
 line-height: var(--n-item-size);
 text-align: center;
 font-size: var(--n-item-font-size);
 border-radius: var(--n-item-border-radius);
 z-index: 0;
 cursor: pointer;
 transition:
 background-color .2s var(--n-bezier),
 color .2s var(--n-bezier);
 `,[he("trigger",`
 position: absolute;
 left: calc(var(--n-item-size) / 2 - var(--n-item-cell-width) / 2);
 top: calc(var(--n-item-size) / 2 - var(--n-item-cell-height) / 2);
 width: var(--n-item-cell-width);
 height: var(--n-item-cell-height);
 `),xe("current",[he("sup",`
 position: absolute;
 top: 2px;
 right: 2px;
 content: "";
 height: 4px;
 width: 4px;
 border-radius: 2px;
 background-color: var(--n-item-color-active);
 transition:
 background-color .2s var(--n-bezier);
 `)]),ge("&::after",`
 content: "";
 z-index: -1;
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 border-radius: inherit;
 transition: background-color .3s var(--n-bezier);
 `),xe("covered, start, end",[br("excluded",[ge("&::before",`
 content: "";
 z-index: -2;
 position: absolute;
 left: calc((var(--n-item-size) - var(--n-item-cell-width)) / 2);
 right: calc((var(--n-item-size) - var(--n-item-cell-width)) / 2);
 top: 0;
 bottom: 0;
 background-color: var(--n-item-color-included);
 `),ge("&:nth-child(7n + 1)::before",{borderTopLeftRadius:"var(--n-item-border-radius)",borderBottomLeftRadius:"var(--n-item-border-radius)"}),ge("&:nth-child(7n + 7)::before",{borderTopRightRadius:"var(--n-item-border-radius)",borderBottomRightRadius:"var(--n-item-border-radius)"})])]),xe("selected",{color:"var(--n-item-text-color-active)"},[ge("&::after",{backgroundColor:"var(--n-item-color-active)"}),xe("start",[ge("&::before",{left:"50%"})]),xe("end",[ge("&::before",{right:"50%"})]),he("sup",{backgroundColor:"var(--n-panel-color)"})]),xe("excluded",{color:"var(--n-item-text-color-disabled)"},[xe("selected",[ge("&::after",{backgroundColor:"var(--n-item-color-disabled)"})])]),xe("disabled",{cursor:"not-allowed",color:"var(--n-item-text-color-disabled)"},[xe("covered",[ge("&::before",{backgroundColor:"var(--n-item-color-disabled)"})]),xe("selected",[ge("&::before",{backgroundColor:"var(--n-item-color-disabled)"}),ge("&::after",{backgroundColor:"var(--n-item-color-disabled)"})])]),xe("week-hovered",[ge("&::before",`
 background-color: var(--n-item-color-included);
 `),ge("&:nth-child(7n + 1)::before",`
 border-top-left-radius: var(--n-item-border-radius);
 border-bottom-left-radius: var(--n-item-border-radius);
 `),ge("&:nth-child(7n + 7)::before",`
 border-top-right-radius: var(--n-item-border-radius);
 border-bottom-right-radius: var(--n-item-border-radius);
 `)]),xe("week-selected",`
 color: var(--n-item-text-color-active)
 `,[ge("&::before",`
 background-color: var(--n-item-color-active);
 `),ge("&:nth-child(7n + 1)::before",`
 border-top-left-radius: var(--n-item-border-radius);
 border-bottom-left-radius: var(--n-item-border-radius);
 `),ge("&:nth-child(7n + 7)::before",`
 border-top-right-radius: var(--n-item-border-radius);
 border-bottom-right-radius: var(--n-item-border-radius);
 `)])])]),br("week",[oe("date-panel-dates",[oe("date-panel-date",[br("disabled",[br("selected",[ge("&:hover",`
 background-color: var(--n-item-color-hover);
 `)])])])])]),xe("week",[oe("date-panel-dates",[oe("date-panel-date",[ge("&::before",`
 content: "";
 z-index: -2;
 position: absolute;
 left: calc((var(--n-item-size) - var(--n-item-cell-width)) / 2);
 right: calc((var(--n-item-size) - var(--n-item-cell-width)) / 2);
 top: 0;
 bottom: 0;
 transition: background-color .3s var(--n-bezier);
 `)])])]),he("vertical-divider",`
 grid-area: divider;
 height: 100%;
 width: 1px;
 background-color: var(--n-calendar-divider-color);
 `),oe("date-panel-footer",`
 border-top: 1px solid var(--n-panel-action-divider-color);
 padding: var(--n-panel-extra-footer-padding);
 `),oe("date-panel-actions",`
 flex: 1;
 padding: var(--n-panel-action-padding);
 display: flex;
 align-items: center;
 justify-content: space-between;
 border-top: 1px solid var(--n-panel-action-divider-color);
 `,[he("prefix, suffix",`
 display: flex;
 margin-bottom: -8px;
 `),he("suffix",`
 align-self: flex-end;
 `),he("prefix",`
 flex-wrap: wrap;
 `),oe("button",`
 margin-bottom: 8px;
 `,[ge("&:not(:last-child)",`
 margin-right: 8px;
 `)])])]),ge("[data-n-date].transition-disabled",{transition:"none !important"},[ge("&::before, &::after",{transition:"none !important"})])]),Zoe=Object.assign(Object.assign({},bt.props),{to:Wn.propTo,bordered:{type:Boolean,default:void 0},clearable:Boolean,updateValueOnClose:Boolean,defaultValue:[Number,Array],defaultFormattedValue:[String,Array],defaultTime:[Number,String,Array],disabled:{type:Boolean,default:void 0},placement:{type:String,default:"bottom-start"},value:[Number,Array],formattedValue:[String,Array],size:String,type:{type:String,default:"date"},valueFormat:String,separator:String,placeholder:String,startPlaceholder:String,endPlaceholder:String,format:String,dateFormat:String,timerPickerFormat:String,actions:Array,shortcuts:Object,isDateDisabled:Function,isTimeDisabled:Function,show:{type:Boolean,default:void 0},panel:Boolean,ranges:Object,firstDayOfWeek:Number,inputReadonly:Boolean,closeOnSelect:Boolean,status:String,timePickerProps:[Object,Array],onClear:Function,onConfirm:Function,defaultCalendarStartTime:Number,defaultCalendarEndTime:Number,bindCalendarMonths:Boolean,monthFormat:{type:String,default:"M"},yearFormat:{type:String,default:"y"},quarterFormat:{type:String,default:"'Q'Q"},"onUpdate:show":[Function,Array],onUpdateShow:[Function,Array],"onUpdate:formattedValue":[Function,Array],onUpdateFormattedValue:[Function,Array],"onUpdate:value":[Function,Array],onUpdateValue:[Function,Array],onFocus:[Function,Array],onBlur:[Function,Array],onNextMonth:Function,onPrevMonth:Function,onNextYear:Function,onPrevYear:Function,onChange:[Function,Array]}),WS=je({name:"DatePicker",props:Zoe,setup(e,{slots:t}){var r;const{localeRef:i,dateLocaleRef:n}=wc("DatePicker"),a=gl(e),{mergedSizeRef:o,mergedDisabledRef:s,mergedStatusRef:l}=a,{mergedComponentPropsRef:c,mergedClsPrefixRef:u,mergedBorderedRef:d,namespaceRef:h,inlineThemeDisabled:f}=vr(e),p=me(null),v=me(null),m=me(null),g=me(!1),y=pt(e,"show"),b=Hn(y,g),x=re(()=>({locale:n.value.locale})),S=re(()=>{const{format:ce}=e;if(ce)return ce;switch(e.type){case"date":case"daterange":return i.value.dateFormat;case"datetime":case"datetimerange":return i.value.dateTimeFormat;case"year":case"yearrange":return i.value.yearTypeFormat;case"month":case"monthrange":return i.value.monthTypeFormat;case"quarter":case"quarterrange":return i.value.quarterFormat;case"week":return i.value.weekFormat}}),w=re(()=>{var ce;return(ce=e.valueFormat)!==null&&ce!==void 0?ce:S.value});function _(ce){if(ce===null)return null;const{value:Re}=w,{value:$e}=x;return Array.isArray(ce)?[qa(ce[0],Re,new Date,$e).getTime(),qa(ce[1],Re,new Date,$e).getTime()]:qa(ce,Re,new Date,$e).getTime()}const{defaultFormattedValue:C,defaultValue:A}=e,M=me((r=C!==void 0?_(C):A)!==null&&r!==void 0?r:null),P=re(()=>{const{formattedValue:ce}=e;return ce!==void 0?_(ce):e.value}),T=Hn(P,M),R=me(null);no(()=>{R.value=T.value});const z=me(""),F=me(""),H=me(""),N=bt("DatePicker","-date-picker",Qoe,_ae,e,u),U=re(()=>{var ce,Re;return((Re=(ce=c==null?void 0:c.value)===null||ce===void 0?void 0:ce.DatePicker)===null||Re===void 0?void 0:Re.timePickerSize)||"small"}),ie=re(()=>["daterange","datetimerange","monthrange","quarterrange","yearrange"].includes(e.type)),te=re(()=>{const{placeholder:ce}=e;if(ce===void 0){const{type:Re}=e;switch(Re){case"date":return i.value.datePlaceholder;case"datetime":return i.value.datetimePlaceholder;case"month":return i.value.monthPlaceholder;case"year":return i.value.yearPlaceholder;case"quarter":return i.value.quarterPlaceholder;case"week":return i.value.weekPlaceholder;default:return""}}else return ce}),X=re(()=>e.startPlaceholder===void 0?e.type==="daterange"?i.value.startDatePlaceholder:e.type==="datetimerange"?i.value.startDatetimePlaceholder:e.type==="monthrange"?i.value.startMonthPlaceholder:"":e.startPlaceholder),W=re(()=>e.endPlaceholder===void 0?e.type==="daterange"?i.value.endDatePlaceholder:e.type==="datetimerange"?i.value.endDatetimePlaceholder:e.type==="monthrange"?i.value.endMonthPlaceholder:"":e.endPlaceholder),q=re(()=>{const{actions:ce,type:Re,clearable:$e}=e;if(ce===null)return[];if(ce!==void 0)return ce;const at=$e?["clear"]:[];switch(Re){case"date":case"week":return at.push("now"),at;case"datetime":return at.push("now","confirm"),at;case"daterange":return at.push("confirm"),at;case"datetimerange":return at.push("confirm"),at;case"month":return at.push("now","confirm"),at;case"year":return at.push("now"),at;case"quarter":return at.push("now","confirm"),at;case"monthrange":case"yearrange":case"quarterrange":return at.push("confirm"),at;default:{sh("date-picker","The type is wrong, n-date-picker's type only supports `date`, `datetime`, `daterange` and `datetimerange`.");break}}});function $(ce){if(ce===null)return null;if(Array.isArray(ce)){const{value:Re}=w,{value:$e}=x;return[oi(ce[0],Re,$e),oi(ce[1],Re,x.value)]}else return oi(ce,w.value,x.value)}function le(ce){R.value=ce}function ee(ce,Re){const{"onUpdate:formattedValue":$e,onUpdateFormattedValue:at}=e;$e&&ct($e,ce,Re),at&&ct(at,ce,Re)}function Q(ce,Re){const{"onUpdate:value":$e,onUpdateValue:at,onChange:Yt}=e,{nTriggerFormChange:nr,nTriggerFormInput:Fe}=a,Ke=$(ce);Re.doConfirm&&V(ce,Ke),at&&ct(at,ce,Ke),$e&&ct($e,ce,Ke),Yt&&ct(Yt,ce,Ke),M.value=ce,ee(Ke,ce),nr(),Fe()}function ne(){const{onClear:ce}=e;ce==null||ce()}function V(ce,Re){const{onConfirm:$e}=e;$e&&$e(ce,Re)}function ue(ce){const{onFocus:Re}=e,{nTriggerFormFocus:$e}=a;Re&&ct(Re,ce),$e()}function ve(ce){const{onBlur:Re}=e,{nTriggerFormBlur:$e}=a;Re&&ct(Re,ce),$e()}function Ce(ce){const{"onUpdate:show":Re,onUpdateShow:$e}=e;Re&&ct(Re,ce),$e&&ct($e,ce),g.value=ce}function G(ce){ce.key==="Escape"&&b.value&&(dg(ce),lt({returnFocus:!0}))}function Z(ce){ce.key==="Escape"&&b.value&&dg(ce)}function de(){var ce;Ce(!1),(ce=m.value)===null||ce===void 0||ce.deactivate(),ne()}function Se(){var ce;(ce=m.value)===null||ce===void 0||ce.deactivate(),ne()}function we(){lt({returnFocus:!0})}function _e(ce){var Re;b.value&&!(!((Re=v.value)===null||Re===void 0)&&Re.contains(lc(ce)))&&lt({returnFocus:!1})}function Ee(ce){lt({returnFocus:!0,disableUpdateOnClose:ce})}function fe(ce,Re){Re?Q(ce,{doConfirm:!1}):le(ce)}function B(){const ce=R.value;Q(Array.isArray(ce)?[ce[0],ce[1]]:ce,{doConfirm:!0})}function D(){const{value:ce}=R;ie.value?(Array.isArray(ce)||ce===null)&&O(ce):Array.isArray(ce)||I(ce)}function I(ce){ce===null?z.value="":z.value=oi(ce,S.value,x.value)}function O(ce){if(ce===null)F.value="",H.value="";else{const Re=x.value;F.value=oi(ce[0],S.value,Re),H.value=oi(ce[1],S.value,Re)}}function j(){b.value||nt()}function L(ce){var Re;!((Re=p.value)===null||Re===void 0)&&Re.$el.contains(ce.relatedTarget)||(ve(ce),D(),lt({returnFocus:!1}))}function Ae(){s.value||(D(),lt({returnFocus:!1}))}function We(ce){if(ce===""){Q(null,{doConfirm:!1}),R.value=null,z.value="";return}const Re=qa(ce,S.value,new Date,x.value);ko(Re)?(Q(gt(Re),{doConfirm:!1}),D()):z.value=ce}function Ve(ce,{source:Re}){if(ce[0]===""&&ce[1]===""){Q(null,{doConfirm:!1}),R.value=null,F.value="",H.value="";return}const[$e,at]=ce,Yt=qa($e,S.value,new Date,x.value),nr=qa(at,S.value,new Date,x.value);if(ko(Yt)&&ko(nr)){let Fe=gt(Yt),Ke=gt(nr);nr<Yt&&(Re===0?Ke=Fe:Fe=Ke),Q([Fe,Ke],{doConfirm:!1}),D()}else[F.value,H.value]=ce}function ke(ce){s.value||Ou(ce,"clear")||b.value||nt()}function et(ce){s.value||ue(ce)}function nt(){s.value||b.value||Ce(!0)}function lt({returnFocus:ce,disableUpdateOnClose:Re}){var $e;b.value&&(Ce(!1),e.type!=="date"&&e.updateValueOnClose&&!Re&&B(),ce&&(($e=m.value)===null||$e===void 0||$e.focus()))}rr(R,()=>{D()}),D(),rr(b,ce=>{ce||(R.value=T.value)});const ut=Aae(e,R),vt=Mae(e,R);xr(fw,Object.assign(Object.assign(Object.assign({mergedClsPrefixRef:u,mergedThemeRef:N,timePickerSizeRef:U,localeRef:i,dateLocaleRef:n,firstDayOfWeekRef:pt(e,"firstDayOfWeek"),isDateDisabledRef:pt(e,"isDateDisabled"),rangesRef:pt(e,"ranges"),timePickerPropsRef:pt(e,"timePickerProps"),closeOnSelectRef:pt(e,"closeOnSelect"),updateValueOnCloseRef:pt(e,"updateValueOnClose"),monthFormatRef:pt(e,"monthFormat"),yearFormatRef:pt(e,"yearFormat"),quarterFormatRef:pt(e,"quarterFormat")},ut),vt),{datePickerSlots:t}));const se={focus:()=>{var ce;(ce=m.value)===null||ce===void 0||ce.focus()},blur:()=>{var ce;(ce=m.value)===null||ce===void 0||ce.blur()}},Be=re(()=>{const{common:{cubicBezierEaseInOut:ce},self:{iconColor:Re,iconColorDisabled:$e}}=N.value;return{"--n-bezier":ce,"--n-icon-color-override":Re,"--n-icon-color-disabled-override":$e}}),Ye=f?Dr("date-picker-trigger",void 0,Be,e):void 0,pe=re(()=>{const{type:ce}=e,{common:{cubicBezierEaseInOut:Re},self:{calendarTitleFontSize:$e,calendarDaysFontSize:at,itemFontSize:Yt,itemTextColor:nr,itemColorDisabled:Fe,itemColorIncluded:Ke,itemColorHover:dt,itemColorActive:Nt,itemBorderRadius:hi,itemTextColorDisabled:Mi,itemTextColorActive:Mr,panelColor:De,panelTextColor:K,arrowColor:Me,calendarTitleTextColor:He,panelActionDividerColor:Oe,panelHeaderDividerColor:Ne,calendarDaysDividerColor:wt,panelBoxShadow:Rt,panelBorderRadius:It,calendarTitleFontWeight:Tt,panelExtraFooterPadding:fr,panelActionPadding:Jt,itemSize:Pe,itemCellWidth:Qe,itemCellHeight:xt,scrollItemWidth:Er,scrollItemHeight:ui,calendarTitlePadding:Ut,calendarTitleHeight:ar,calendarDaysHeight:En,calendarDaysTextColor:er,arrowSize:co,panelHeaderPadding:qo,calendarDividerColor:yo,calendarTitleGridTempateColumns:ja,iconColor:Y,iconColorDisabled:J,scrollItemBorderRadius:be,calendarTitleColorHover:ae,[Ze("calendarLeftPadding",ce)]:Ie,[Ze("calendarRightPadding",ce)]:ot}}=N.value;return{"--n-bezier":Re,"--n-panel-border-radius":It,"--n-panel-color":De,"--n-panel-box-shadow":Rt,"--n-panel-text-color":K,"--n-panel-header-padding":qo,"--n-panel-header-divider-color":Ne,"--n-calendar-left-padding":Ie,"--n-calendar-right-padding":ot,"--n-calendar-title-color-hover":ae,"--n-calendar-title-height":ar,"--n-calendar-title-padding":Ut,"--n-calendar-title-font-size":$e,"--n-calendar-title-font-weight":Tt,"--n-calendar-title-text-color":He,"--n-calendar-title-grid-template-columns":ja,"--n-calendar-days-height":En,"--n-calendar-days-divider-color":wt,"--n-calendar-days-font-size":at,"--n-calendar-days-text-color":er,"--n-calendar-divider-color":yo,"--n-panel-action-padding":Jt,"--n-panel-extra-footer-padding":fr,"--n-panel-action-divider-color":Oe,"--n-item-font-size":Yt,"--n-item-border-radius":hi,"--n-item-size":Pe,"--n-item-cell-width":Qe,"--n-item-cell-height":xt,"--n-item-text-color":nr,"--n-item-color-included":Ke,"--n-item-color-disabled":Fe,"--n-item-color-hover":dt,"--n-item-color-active":Nt,"--n-item-text-color-disabled":Mi,"--n-item-text-color-active":Mr,"--n-scroll-item-width":Er,"--n-scroll-item-height":ui,"--n-scroll-item-border-radius":be,"--n-arrow-size":co,"--n-arrow-color":Me,"--n-icon-color":Y,"--n-icon-color-disabled":J}}),Te=f?Dr("date-picker",re(()=>e.type),pe,e):void 0;return Object.assign(Object.assign({},se),{mergedStatus:l,mergedClsPrefix:u,mergedBordered:d,namespace:h,uncontrolledValue:M,pendingValue:R,panelInstRef:p,triggerElRef:v,inputInstRef:m,isMounted:Yu(),displayTime:z,displayStartTime:F,displayEndTime:H,mergedShow:b,adjustedTo:Wn(e),isRange:ie,localizedStartPlaceholder:X,localizedEndPlaceholder:W,mergedSize:o,mergedDisabled:s,localizedPlacehoder:te,isValueInvalid:ut.isValueInvalidRef,isStartValueInvalid:vt.isStartValueInvalidRef,isEndValueInvalid:vt.isEndValueInvalidRef,handleInputKeydown:Z,handleClickOutside:_e,handleKeydown:G,handleClear:de,handlePanelClear:Se,handleTriggerClick:ke,handleInputActivate:j,handleInputDeactivate:Ae,handleInputFocus:et,handleInputBlur:L,handlePanelTabOut:we,handlePanelClose:Ee,handleRangeUpdateValue:Ve,handleSingleUpdateValue:We,handlePanelUpdateValue:fe,handlePanelConfirm:B,mergedTheme:N,actions:q,triggerCssVars:f?void 0:Be,triggerThemeClass:Ye==null?void 0:Ye.themeClass,triggerOnRender:Ye==null?void 0:Ye.onRender,cssVars:f?void 0:pe,themeClass:Te==null?void 0:Te.themeClass,onRender:Te==null?void 0:Te.onRender,onNextMonth:e.onNextMonth,onPrevMonth:e.onPrevMonth,onNextYear:e.onNextYear,onPrevYear:e.onPrevYear})},render(){const{clearable:e,triggerOnRender:t,mergedClsPrefix:r,$slots:i}=this,n={onUpdateValue:this.handlePanelUpdateValue,onTabOut:this.handlePanelTabOut,onClose:this.handlePanelClose,onClear:this.handlePanelClear,onKeydown:this.handleKeydown,onConfirm:this.handlePanelConfirm,ref:"panelInstRef",value:this.pendingValue,active:this.mergedShow,actions:this.actions,shortcuts:this.shortcuts,style:this.cssVars,defaultTime:this.defaultTime,themeClass:this.themeClass,panel:this.panel,onRender:this.onRender,onNextMonth:this.onNextMonth,onPrevMonth:this.onPrevMonth,onNextYear:this.onNextYear,onPrevYear:this.onPrevYear,timerPickerFormat:this.timerPickerFormat},a=()=>{const{type:s}=this;return s==="datetime"?E($oe,Object.assign({},n,{defaultCalendarStartTime:this.defaultCalendarStartTime}),i):s==="daterange"?E(Xoe,Object.assign({},n,{defaultCalendarStartTime:this.defaultCalendarStartTime,defaultCalendarEndTime:this.defaultCalendarEndTime,bindCalendarMonths:this.bindCalendarMonths}),i):s==="datetimerange"?E(qoe,Object.assign({},n,{defaultCalendarStartTime:this.defaultCalendarStartTime,defaultCalendarEndTime:this.defaultCalendarEndTime,bindCalendarMonths:this.bindCalendarMonths}),i):s==="month"||s==="year"||s==="quarter"?E(U6,Object.assign({},n,{type:s,key:s})):s==="monthrange"||s==="yearrange"||s==="quarterrange"?E(Koe,Object.assign({},n,{type:s})):E(Yoe,Object.assign({},n,{type:s,defaultCalendarStartTime:this.defaultCalendarStartTime}),i)};if(this.panel)return a();t==null||t();const o={bordered:this.mergedBordered,size:this.mergedSize,passivelyActivated:!0,disabled:this.mergedDisabled,readonly:this.inputReadonly||this.mergedDisabled,clearable:e,onClear:this.handleClear,onClick:this.handleTriggerClick,onKeydown:this.handleInputKeydown,onActivate:this.handleInputActivate,onDeactivate:this.handleInputDeactivate,onFocus:this.handleInputFocus,onBlur:this.handleInputBlur};return E("div",{ref:"triggerElRef",class:[`${r}-date-picker`,this.mergedDisabled&&`${r}-date-picker--disabled`,this.isRange&&`${r}-date-picker--range`,this.triggerThemeClass],style:this.triggerCssVars,onKeydown:this.handleKeydown},E(wh,null,{default:()=>[E(Sh,null,{default:()=>this.isRange?E(ur,Object.assign({ref:"inputInstRef",status:this.mergedStatus,value:[this.displayStartTime,this.displayEndTime],placeholder:[this.localizedStartPlaceholder,this.localizedEndPlaceholder],textDecoration:[this.isStartValueInvalid?"line-through":"",this.isEndValueInvalid?"line-through":""],pair:!0,onUpdateValue:this.handleRangeUpdateValue,theme:this.mergedTheme.peers.Input,themeOverrides:this.mergedTheme.peerOverrides.Input,internalForceFocus:this.mergedShow,internalDeactivateOnEnter:!0},o),{separator:()=>this.separator===void 0?Cr(i.separator,()=>[E(Bi,{clsPrefix:r,class:`${r}-date-picker-icon`},{default:()=>E(Ire,null)})]):this.separator,[e?"clear-icon-placeholder":"suffix"]:()=>Cr(i["date-icon"],()=>[E(Bi,{clsPrefix:r,class:`${r}-date-picker-icon`},{default:()=>E(dR,null)})])}):E(ur,Object.assign({ref:"inputInstRef",status:this.mergedStatus,value:this.displayTime,placeholder:this.localizedPlacehoder,textDecoration:this.isValueInvalid&&!this.isRange?"line-through":"",onUpdateValue:this.handleSingleUpdateValue,theme:this.mergedTheme.peers.Input,themeOverrides:this.mergedTheme.peerOverrides.Input,internalForceFocus:this.mergedShow,internalDeactivateOnEnter:!0},o),{[e?"clear-icon-placeholder":"suffix"]:()=>E(Bi,{clsPrefix:r,class:`${r}-date-picker-icon`},{default:()=>Cr(i["date-icon"],()=>[E(dR,null)])})})}),E(Ch,{show:this.mergedShow,containerClass:this.namespace,to:this.adjustedTo,teleportDisabled:this.adjustedTo===Wn.tdkey,placement:this.placement},{default:()=>E(La,{name:"fade-in-scale-up-transition",appear:this.isMounted},{default:()=>this.mergedShow?io(a(),[[Ru,this.handleClickOutside,void 0,{capture:!0}]]):null})})]}))}}),Joe=e=>{const{textColor1:t,dividerColor:r,fontWeightStrong:i}=e;return{textColor:t,color:r,fontWeight:i}},ese={name:"Divider",common:$r,self:Joe},tse=oe("divider",`
 position: relative;
 display: flex;
 width: 100%;
 box-sizing: border-box;
 font-size: 16px;
 color: var(--n-text-color);
 transition:
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier);
`,[br("vertical",`
 margin-top: 24px;
 margin-bottom: 24px;
 `,[br("no-title",`
 display: flex;
 align-items: center;
 `)]),he("title",`
 display: flex;
 align-items: center;
 margin-left: 12px;
 margin-right: 12px;
 white-space: nowrap;
 font-weight: var(--n-font-weight);
 `),xe("title-position-left",[he("line",[xe("left",{width:"28px"})])]),xe("title-position-right",[he("line",[xe("right",{width:"28px"})])]),xe("dashed",[he("line",`
 background-color: #0000;
 height: 0px;
 width: 100%;
 border-style: dashed;
 border-width: 1px 0 0;
 `)]),xe("vertical",`
 display: inline-block;
 height: 1em;
 margin: 0 8px;
 vertical-align: middle;
 width: 1px;
 `),he("line",`
 border: none;
 transition: background-color .3s var(--n-bezier), border-color .3s var(--n-bezier);
 height: 1px;
 width: 100%;
 margin: 0;
 `),br("dashed",[he("line",{backgroundColor:"var(--n-color)"})]),xe("dashed",[he("line",{borderColor:"var(--n-color)"})]),xe("vertical",{backgroundColor:"var(--n-color)"})]),rse=Object.assign(Object.assign({},bt.props),{titlePlacement:{type:String,default:"center"},dashed:Boolean,vertical:Boolean}),RR=je({name:"Divider",props:rse,setup(e){const{mergedClsPrefixRef:t,inlineThemeDisabled:r}=vr(e),i=bt("Divider","-divider",tse,ese,e,t),n=re(()=>{const{common:{cubicBezierEaseInOut:o},self:{color:s,textColor:l,fontWeight:c}}=i.value;return{"--n-bezier":o,"--n-color":s,"--n-text-color":l,"--n-font-weight":c}}),a=r?Dr("divider",void 0,n,e):void 0;return{mergedClsPrefix:t,cssVars:r?void 0:n,themeClass:a==null?void 0:a.themeClass,onRender:a==null?void 0:a.onRender}},render(){var e;const{$slots:t,titlePlacement:r,vertical:i,dashed:n,cssVars:a,mergedClsPrefix:o}=this;return(e=this.onRender)===null||e===void 0||e.call(this),E("div",{role:"separator",class:[`${o}-divider`,this.themeClass,{[`${o}-divider--vertical`]:i,[`${o}-divider--no-title`]:!t.default,[`${o}-divider--dashed`]:n,[`${o}-divider--title-position-${r}`]:t.default&&r}],style:a},i?null:E("div",{class:`${o}-divider__line ${o}-divider__line--left`}),!i&&t.default?E(mr,null,E("div",{class:`${o}-divider__title`},this.$slots),E("div",{class:`${o}-divider__line ${o}-divider__line--right`})):null)}}),ise={actionMargin:"0 0 0 20px",actionMarginRtl:"0 20px 0 0"},nse=()=>ise,ase={name:"DynamicInput",common:$r,peers:{Input:rm,Button:n0},self:nse},gP="n-dynamic-input",ose=je({name:"DynamicInputInputPreset",props:{clsPrefix:{type:String,required:!0},value:{type:String,default:""},disabled:Boolean,parentPath:String,path:String,onUpdateValue:{type:Function,required:!0}},setup(){const{mergedThemeRef:e,placeholderRef:t}=_t(gP);return{mergedTheme:e,placeholder:t}},render(){const{mergedTheme:e,placeholder:t,value:r,clsPrefix:i,onUpdateValue:n,disabled:a}=this;return E("div",{class:`${i}-dynamic-input-preset-input`},E(ur,{theme:e.peers.Input,"theme-overrides":e.peerOverrides.Input,value:r,placeholder:t,onUpdateValue:n,disabled:a}))}}),sse=je({name:"DynamicInputPairPreset",props:{clsPrefix:{type:String,required:!0},value:{type:Object,default:()=>({key:"",value:""})},disabled:Boolean,parentPath:String,path:String,onUpdateValue:{type:Function,required:!0}},setup(e){const{mergedThemeRef:t,keyPlaceholderRef:r,valuePlaceholderRef:i}=_t(gP);return{mergedTheme:t,keyPlaceholder:r,valuePlaceholder:i,handleKeyInput(n){e.onUpdateValue({key:n,value:e.value.value})},handleValueInput(n){e.onUpdateValue({key:e.value.key,value:n})}}},render(){const{mergedTheme:e,keyPlaceholder:t,valuePlaceholder:r,value:i,clsPrefix:n,disabled:a}=this;return E("div",{class:`${n}-dynamic-input-preset-pair`},E(ur,{theme:e.peers.Input,"theme-overrides":e.peerOverrides.Input,value:i.key,class:`${n}-dynamic-input-pair-input`,placeholder:t,onUpdateValue:this.handleKeyInput,disabled:a}),E(ur,{theme:e.peers.Input,"theme-overrides":e.peerOverrides.Input,value:i.value,class:`${n}-dynamic-input-pair-input`,placeholder:r,onUpdateValue:this.handleValueInput,disabled:a}))}}),lse=oe("dynamic-input",{width:"100%"},[oe("dynamic-input-item",`
 margin-bottom: 10px;
 display: flex;
 flex-wrap: nowrap;
 `,[oe("dynamic-input-preset-input",{flex:1,alignItems:"center"}),oe("dynamic-input-preset-pair",`
 flex: 1;
 display: flex;
 align-items: center;
 `,[oe("dynamic-input-pair-input",[ge("&:first-child",{"margin-right":"12px"})])]),he("action",`
 align-self: flex-start;
 display: flex;
 justify-content: flex-end;
 flex-shrink: 0;
 flex-grow: 0;
 margin: var(--action-margin);
 `,[xe("icon",{cursor:"pointer"})]),ge("&:last-child",{marginBottom:0})]),oe("form-item",`
 padding-top: 0 !important;
 margin-right: 0 !important;
 `,[oe("form-item-blank",{paddingTop:"0 !important"})])]),ty=new WeakMap,cse=Object.assign(Object.assign({},bt.props),{max:Number,min:{type:Number,default:0},value:Array,defaultValue:{type:Array,default:()=>[]},preset:{type:String,default:"input"},keyField:String,itemClass:String,itemStyle:[String,Object],keyPlaceholder:{type:String,default:""},valuePlaceholder:{type:String,default:""},placeholder:{type:String,default:""},disabled:Boolean,showSortButton:Boolean,createButtonProps:Object,onCreate:Function,onRemove:Function,"onUpdate:value":[Function,Array],onUpdateValue:[Function,Array],onClear:Function,onInput:[Function,Array]}),use=je({name:"DynamicInput",props:cse,setup(e,{slots:t}){const{mergedComponentPropsRef:r,mergedClsPrefixRef:i,mergedRtlRef:n,inlineThemeDisabled:a}=vr(),o=_t(hx,null),s=me(e.defaultValue),l=pt(e,"value"),c=Hn(l,s),u=bt("DynamicInput","-dynamic-input",lse,ase,e,i),d=re(()=>{const{value:A}=c;if(Array.isArray(A)){const{max:M}=e;return M!==void 0&&A.length>=M}return!1}),h=re(()=>{const{value:A}=c;return Array.isArray(A)?A.length<=e.min:!0}),f=re(()=>{var A,M;return(M=(A=r==null?void 0:r.value)===null||A===void 0?void 0:A.DynamicInput)===null||M===void 0?void 0:M.buttonSize});function p(A){const{onInput:M,"onUpdate:value":P,onUpdateValue:T}=e;M&&ct(M,A),P&&ct(P,A),T&&ct(T,A),s.value=A}function v(A,M){if(A==null||typeof A!="object")return M;const P=Tv(A)?Sr(A):A;let T=ty.get(P);return T===void 0&&ty.set(P,T=oh()),T}function m(A,M){const{value:P}=c,T=Array.from(P??[]),R=T[A];if(T[A]=M,R&&M&&typeof R=="object"&&typeof M=="object"){const z=Tv(R)?Sr(R):R,F=Tv(M)?Sr(M):M,H=ty.get(z);H!==void 0&&ty.set(F,H)}p(T)}function g(){y(-1)}function y(A){const{value:M}=c,{onCreate:P}=e,T=Array.from(M??[]);if(P)T.splice(A+1,0,P(A+1)),p(T);else if(t.default)T.splice(A+1,0,null),p(T);else switch(e.preset){case"input":T.splice(A+1,0,""),p(T);break;case"pair":T.splice(A+1,0,{key:"",value:""}),p(T);break}}function b(A){const{value:M}=c;if(!Array.isArray(M))return;const{min:P}=e;if(M.length<=P)return;const{onRemove:T}=e;T&&T(A);const R=Array.from(M);R.splice(A,1),p(R)}function x(A,M,P){if(M<0||P<0||M>=A.length||P>=A.length||M===P)return;const T=A[M];A[M]=A[P],A[P]=T}function S(A,M){const{value:P}=c;if(!Array.isArray(P))return;const T=Array.from(P);A==="up"&&x(T,M,M-1),A==="down"&&x(T,M,M+1),p(T)}xr(gP,{mergedThemeRef:u,keyPlaceholderRef:pt(e,"keyPlaceholder"),valuePlaceholderRef:pt(e,"valuePlaceholder"),placeholderRef:pt(e,"placeholder")});const w=oo("DynamicInput",n,i),_=re(()=>{const{self:{actionMargin:A,actionMarginRtl:M}}=u.value;return{"--action-margin":A,"--action-margin-rtl":M}}),C=a?Dr("dynamic-input",void 0,_,e):void 0;return{locale:wc("DynamicInput").localeRef,rtlEnabled:w,buttonSize:f,mergedClsPrefix:i,NFormItem:o,uncontrolledValue:s,mergedValue:c,insertionDisabled:d,removeDisabled:h,handleCreateClick:g,ensureKey:v,handleValueChange:m,remove:b,move:S,createItem:y,mergedTheme:u,cssVars:a?void 0:_,themeClass:C==null?void 0:C.themeClass,onRender:C==null?void 0:C.onRender}},render(){const{$slots:e,itemClass:t,buttonSize:r,mergedClsPrefix:i,mergedValue:n,locale:a,mergedTheme:o,keyField:s,itemStyle:l,preset:c,showSortButton:u,NFormItem:d,ensureKey:h,handleValueChange:f,remove:p,createItem:v,move:m,onRender:g,disabled:y}=this;return g==null||g(),E("div",{class:[`${i}-dynamic-input`,this.rtlEnabled&&`${i}-dynamic-input--rtl`,this.themeClass],style:this.cssVars},!Array.isArray(n)||n.length===0?E(ci,Object.assign({block:!0,ghost:!0,dashed:!0,size:r},this.createButtonProps,{disabled:this.insertionDisabled||y,theme:o.peers.Button,themeOverrides:o.peerOverrides.Button,onClick:this.handleCreateClick}),{default:()=>Cr(e["create-button-default"],()=>[a.create]),icon:()=>Cr(e["create-button-icon"],()=>[E(Bi,{clsPrefix:i},{default:()=>E($2,null)})])}):n.map((b,x)=>E("div",{key:s?b[s]:h(b,x),"data-key":s?b[s]:h(b,x),class:[`${i}-dynamic-input-item`,t],style:l},M2(e.default,{value:n[x],index:x},()=>[c==="input"?E(ose,{disabled:y,clsPrefix:i,value:n[x],parentPath:d?d.path.value:void 0,path:d!=null&&d.path.value?`${d.path.value}[${x}]`:void 0,onUpdateValue:S=>{f(x,S)}}):c==="pair"?E(sse,{disabled:y,clsPrefix:i,value:n[x],parentPath:d?d.path.value:void 0,path:d!=null&&d.path.value?`${d.path.value}[${x}]`:void 0,onUpdateValue:S=>{f(x,S)}}):null]),M2(e.action,{value:n[x],index:x,create:v,remove:p,move:m},()=>[E("div",{class:`${i}-dynamic-input-item__action`},E(Ine,{size:r},{default:()=>[E(ci,{disabled:this.removeDisabled||y,theme:o.peers.Button,themeOverrides:o.peerOverrides.Button,circle:!0,onClick:()=>{p(x)}},{icon:()=>E(Bi,{clsPrefix:i},{default:()=>E(Are,null)})}),E(ci,{disabled:this.insertionDisabled||y,circle:!0,theme:o.peers.Button,themeOverrides:o.peerOverrides.Button,onClick:()=>{v(x)}},{icon:()=>E(Bi,{clsPrefix:i},{default:()=>E($2,null)})}),u?E(ci,{disabled:x===0||y,circle:!0,theme:o.peers.Button,themeOverrides:o.peerOverrides.Button,onClick:()=>{m("up",x)}},{icon:()=>E(Bi,{clsPrefix:i},{default:()=>E(gre,null)})}):null,u?E(ci,{disabled:x===n.length-1||y,circle:!0,theme:o.peers.Button,themeOverrides:o.peerOverrides.Button,onClick:()=>{m("down",x)}},{icon:()=>E(Bi,{clsPrefix:i},{default:()=>E(vre,null)})}):null]}))]))))}}),dse={gapSmall:"4px 8px",gapMedium:"8px 12px",gapLarge:"12px 16px"},hse=()=>dse,fse={name:"Space",self:hse};let GS;const pse=()=>{if(!qu)return!0;if(GS===void 0){const e=document.createElement("div");e.style.display="flex",e.style.flexDirection="column",e.style.rowGap="1px",e.appendChild(document.createElement("div")),e.appendChild(document.createElement("div")),document.body.appendChild(e);const t=e.scrollHeight===1;return document.body.removeChild(e),GS=t}return GS},mse=Object.assign(Object.assign({},bt.props),{align:String,justify:{type:String,default:"start"},inline:Boolean,vertical:Boolean,reverse:Boolean,size:{type:[String,Number,Array],default:"medium"},wrapItem:{type:Boolean,default:!0},itemClass:String,itemStyle:[String,Object],wrap:{type:Boolean,default:!0},internalUseGap:{type:Boolean,default:void 0}}),vse=je({name:"Space",props:mse,setup(e){const{mergedClsPrefixRef:t,mergedRtlRef:r}=vr(e),i=bt("Space","-space",void 0,fse,e,t),n=oo("Space",r,t);return{useGap:pse(),rtlEnabled:n,mergedClsPrefix:t,margin:re(()=>{const{size:a}=e;if(Array.isArray(a))return{horizontal:a[0],vertical:a[1]};if(typeof a=="number")return{horizontal:a,vertical:a};const{self:{[Ze("gap",a)]:o}}=i.value,{row:s,col:l}=MN(o);return{horizontal:nn(l),vertical:nn(s)}})}},render(){const{vertical:e,reverse:t,align:r,inline:i,justify:n,itemClass:a,itemStyle:o,margin:s,wrap:l,mergedClsPrefix:c,rtlEnabled:u,useGap:d,wrapItem:h,internalUseGap:f}=this,p=Cu(EN(this),!1);if(!p.length)return null;const v=`${s.horizontal}px`,m=`${s.horizontal/2}px`,g=`${s.vertical}px`,y=`${s.vertical/2}px`,b=p.length-1,x=n.startsWith("space-");return E("div",{role:"none",class:[`${c}-space`,u&&`${c}-space--rtl`],style:{display:i?"inline-flex":"flex",flexDirection:e&&!t?"column":e&&t?"column-reverse":!e&&t?"row-reverse":"row",justifyContent:["start","end"].includes(n)?"flex-"+n:n,flexWrap:!l||e?"nowrap":"wrap",marginTop:d||e?"":`-${y}`,marginBottom:d||e?"":`-${y}`,alignItems:r,gap:d?`${s.vertical}px ${s.horizontal}px`:""}},!h&&(d||f)?p:p.map((S,w)=>S.type===zn?S:E("div",{role:"none",class:a,style:[o,{maxWidth:"100%"},d?"":e?{marginBottom:w!==b?g:""}:u?{marginLeft:x?n==="space-between"&&w===b?"":m:w!==b?v:"",marginRight:x?n==="space-between"&&w===0?"":m:"",paddingTop:y,paddingBottom:y}:{marginRight:x?n==="space-between"&&w===b?"":m:w!==b?v:"",marginLeft:x?n==="space-between"&&w===0?"":m:"",paddingTop:y,paddingBottom:y}]},S)))}}),gse={gapSmall:"4px 8px",gapMedium:"8px 12px",gapLarge:"12px 16px"},yse=()=>gse,bse={name:"Flex",self:yse},xse=Object.assign(Object.assign({},bt.props),{align:String,justify:{type:String,default:"start"},inline:Boolean,vertical:Boolean,reverse:Boolean,size:{type:[String,Number,Array],default:"medium"},wrap:{type:Boolean,default:!0}}),Yd=je({name:"Flex",props:xse,setup(e){const{mergedClsPrefixRef:t,mergedRtlRef:r}=vr(e),i=bt("Flex","-flex",void 0,bse,e,t);return{rtlEnabled:oo("Flex",r,t),mergedClsPrefix:t,margin:re(()=>{const{size:a}=e;if(Array.isArray(a))return{horizontal:a[0],vertical:a[1]};if(typeof a=="number")return{horizontal:a,vertical:a};const{self:{[Ze("gap",a)]:o}}=i.value,{row:s,col:l}=MN(o);return{horizontal:nn(l),vertical:nn(s)}})}},render(){const{vertical:e,reverse:t,align:r,inline:i,justify:n,margin:a,wrap:o,mergedClsPrefix:s,rtlEnabled:l}=this,c=Cu(EN(this),!1);return c.length?E("div",{role:"none",class:[`${s}-flex`,l&&`${s}-flex--rtl`],style:{display:i?"inline-flex":"flex",flexDirection:e&&!t?"column":e&&t?"column-reverse":!e&&t?"row-reverse":"row",justifyContent:n,flexWrap:!o||e?"nowrap":"wrap",alignItems:r,gap:`${a.vertical}px ${a.horizontal}px`}},c):null}}),wse={feedbackPadding:"4px 0 0 2px",feedbackHeightSmall:"24px",feedbackHeightMedium:"24px",feedbackHeightLarge:"26px",feedbackFontSizeSmall:"13px",feedbackFontSizeMedium:"14px",feedbackFontSizeLarge:"14px",labelFontSizeLeftSmall:"14px",labelFontSizeLeftMedium:"14px",labelFontSizeLeftLarge:"15px",labelFontSizeTopSmall:"13px",labelFontSizeTopMedium:"14px",labelFontSizeTopLarge:"14px",labelHeightSmall:"24px",labelHeightMedium:"26px",labelHeightLarge:"28px",labelPaddingVertical:"0 0 6px 2px",labelPaddingHorizontal:"0 12px 0 0",labelTextAlignVertical:"left",labelTextAlignHorizontal:"right",labelFontWeight:"400"},Sse=e=>{const{heightSmall:t,heightMedium:r,heightLarge:i,textColor1:n,errorColor:a,warningColor:o,lineHeight:s,textColor3:l}=e;return Object.assign(Object.assign({},wse),{blankHeightSmall:t,blankHeightMedium:r,blankHeightLarge:i,lineHeight:s,labelTextColor:n,asteriskColor:a,feedbackTextColorError:a,feedbackTextColorWarning:o,feedbackTextColor:l})},j6={name:"Form",common:$r,self:Sse},Cse=oe("form",[xe("inline",`
 width: 100%;
 display: inline-flex;
 align-items: flex-start;
 align-content: space-around;
 `,[oe("form-item",{width:"auto",marginRight:"18px"},[ge("&:last-child",{marginRight:0})])])]),s0="n-form",V6="n-form-item-insts";var _se=function(e,t,r,i){function n(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function s(u){try{c(i.next(u))}catch(d){o(d)}}function l(u){try{c(i.throw(u))}catch(d){o(d)}}function c(u){u.done?a(u.value):n(u.value).then(s,l)}c((i=i.apply(e,t||[])).next())})};const Ase=Object.assign(Object.assign({},bt.props),{inline:Boolean,labelWidth:[Number,String],labelAlign:String,labelPlacement:{type:String,default:"top"},model:{type:Object,default:()=>{}},rules:Object,disabled:Boolean,size:String,showRequireMark:{type:Boolean,default:void 0},requireMarkPlacement:String,showFeedback:{type:Boolean,default:!0},onSubmit:{type:Function,default:e=>{e.preventDefault()}},showLabel:{type:Boolean,default:void 0},validateMessages:Object}),Mse=je({name:"Form",props:Ase,setup(e){const{mergedClsPrefixRef:t}=vr(e);bt("Form","-form",Cse,j6,e,t);const r={},i=me(void 0),n=l=>{const c=i.value;(c===void 0||l>=c)&&(i.value=l)};function a(l){return _se(this,arguments,void 0,function*(c,u=()=>!0){return yield new Promise((d,h)=>{const f=[];for(const p of cg(r)){const v=r[p];for(const m of v)m.path&&f.push(m.internalValidate(null,u))}Promise.all(f).then(p=>{const v=p.some(y=>!y.valid),m=[],g=[];p.forEach(y=>{var b,x;!((b=y.errors)===null||b===void 0)&&b.length&&m.push(y.errors),!((x=y.warnings)===null||x===void 0)&&x.length&&g.push(y.warnings)}),c&&c(m.length?m:void 0,{warnings:g.length?g:void 0}),v?h(m.length?m:void 0):d({warnings:g.length?g:void 0})})})})}function o(){for(const l of cg(r)){const c=r[l];for(const u of c)u.restoreValidation()}}return xr(s0,{props:e,maxChildLabelWidthRef:i,deriveMaxChildLabelWidth:n}),xr(V6,{formItems:r}),Object.assign({validate:a,restoreValidation:o},{mergedClsPrefix:t})},render(){const{mergedClsPrefix:e}=this;return E("form",{class:[`${e}-form`,this.inline&&`${e}-form--inline`],onSubmit:this.onSubmit},this.$slots)}});function Id(){return Id=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},Id.apply(this,arguments)}function Ese(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,yg(e,t)}function BA(e){return BA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},BA(e)}function yg(e,t){return yg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,n){return i.__proto__=n,i},yg(e,t)}function Tse(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function kb(e,t,r){return Tse()?kb=Reflect.construct.bind():kb=function(n,a,o){var s=[null];s.push.apply(s,a);var l=Function.bind.apply(n,s),c=new l;return o&&yg(c,o.prototype),c},kb.apply(null,arguments)}function Pse(e){return Function.toString.call(e).indexOf("[native code]")!==-1}function FA(e){var t=typeof Map=="function"?new Map:void 0;return FA=function(i){if(i===null||!Pse(i))return i;if(typeof i!="function")throw new TypeError("Super expression must either be null or a function");if(typeof t<"u"){if(t.has(i))return t.get(i);t.set(i,n)}function n(){return kb(i,arguments,BA(this).constructor)}return n.prototype=Object.create(i.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),yg(n,i)},FA(e)}var Dse=/%[sdj%]/g,Ose=function(){};function NA(e){if(!e||!e.length)return null;var t={};return e.forEach(function(r){var i=r.field;t[i]=t[i]||[],t[i].push(r)}),t}function mo(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];var n=0,a=r.length;if(typeof e=="function")return e.apply(null,r);if(typeof e=="string"){var o=e.replace(Dse,function(s){if(s==="%%")return"%";if(n>=a)return s;switch(s){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch{return"[Circular]"}break;default:return s}});return o}return e}function Rse(e){return e==="string"||e==="url"||e==="hex"||e==="email"||e==="date"||e==="pattern"}function Cn(e,t){return!!(e==null||t==="array"&&Array.isArray(e)&&!e.length||Rse(t)&&typeof e=="string"&&!e)}function Ise(e,t,r){var i=[],n=0,a=e.length;function o(s){i.push.apply(i,s||[]),n++,n===a&&r(i)}e.forEach(function(s){t(s,o)})}function IR(e,t,r){var i=0,n=e.length;function a(o){if(o&&o.length){r(o);return}var s=i;i=i+1,s<n?t(e[s],a):r([])}a([])}function zse(e){var t=[];return Object.keys(e).forEach(function(r){t.push.apply(t,e[r]||[])}),t}var zR=function(e){Ese(t,e);function t(r,i){var n;return n=e.call(this,"Async Validation Error")||this,n.errors=r,n.fields=i,n}return t}(FA(Error));function kse(e,t,r,i,n){if(t.first){var a=new Promise(function(h,f){var p=function(g){return i(g),g.length?f(new zR(g,NA(g))):h(n)},v=zse(e);IR(v,r,p)});return a.catch(function(h){return h}),a}var o=t.firstFields===!0?Object.keys(e):t.firstFields||[],s=Object.keys(e),l=s.length,c=0,u=[],d=new Promise(function(h,f){var p=function(m){if(u.push.apply(u,m),c++,c===l)return i(u),u.length?f(new zR(u,NA(u))):h(n)};s.length||(i(u),h(n)),s.forEach(function(v){var m=e[v];o.indexOf(v)!==-1?IR(m,r,p):Ise(m,r,p)})});return d.catch(function(h){return h}),d}function Lse(e){return!!(e&&e.message!==void 0)}function Bse(e,t){for(var r=e,i=0;i<t.length;i++){if(r==null)return r;r=r[t[i]]}return r}function kR(e,t){return function(r){var i;return e.fullFields?i=Bse(t,e.fullFields):i=t[r.field||e.fullField],Lse(r)?(r.field=r.field||e.fullField,r.fieldValue=i,r):{message:typeof r=="function"?r():r,fieldValue:i,field:r.field||e.fullField}}}function LR(e,t){if(t){for(var r in t)if(t.hasOwnProperty(r)){var i=t[r];typeof i=="object"&&typeof e[r]=="object"?e[r]=Id({},e[r],i):e[r]=i}}return e}var H6=function(t,r,i,n,a,o){t.required&&(!i.hasOwnProperty(t.field)||Cn(r,o||t.type))&&n.push(mo(a.messages.required,t.fullField))},Fse=function(t,r,i,n,a){(/^\s+$/.test(r)||r==="")&&n.push(mo(a.messages.whitespace,t.fullField))},ry,Nse=function(){if(ry)return ry;var e="[a-fA-F\\d:]",t=function(x){return x&&x.includeBoundaries?"(?:(?<=\\s|^)(?="+e+")|(?<="+e+")(?=\\s|$))":""},r="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",i="[a-fA-F\\d]{1,4}",n=(`
(?:
(?:`+i+":){7}(?:"+i+`|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:`+i+":){6}(?:"+r+"|:"+i+`|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:`+i+":){5}(?::"+r+"|(?::"+i+`){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:`+i+":){4}(?:(?::"+i+"){0,1}:"+r+"|(?::"+i+`){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:`+i+":){3}(?:(?::"+i+"){0,2}:"+r+"|(?::"+i+`){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:`+i+":){2}(?:(?::"+i+"){0,3}:"+r+"|(?::"+i+`){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:`+i+":){1}(?:(?::"+i+"){0,4}:"+r+"|(?::"+i+`){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::`+i+"){0,5}:"+r+"|(?::"+i+`){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`).replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),a=new RegExp("(?:^"+r+"$)|(?:^"+n+"$)"),o=new RegExp("^"+r+"$"),s=new RegExp("^"+n+"$"),l=function(x){return x&&x.exact?a:new RegExp("(?:"+t(x)+r+t(x)+")|(?:"+t(x)+n+t(x)+")","g")};l.v4=function(b){return b&&b.exact?o:new RegExp(""+t(b)+r+t(b),"g")},l.v6=function(b){return b&&b.exact?s:new RegExp(""+t(b)+n+t(b),"g")};var c="(?:(?:[a-z]+:)?//)",u="(?:\\S+(?::\\S*)?@)?",d=l.v4().source,h=l.v6().source,f="(?:(?:[a-z\\u00a1-\\uffff0-9][-_]*)*[a-z\\u00a1-\\uffff0-9]+)",p="(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*",v="(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))",m="(?::\\d{2,5})?",g='(?:[/?#][^\\s"]*)?',y="(?:"+c+"|www\\.)"+u+"(?:localhost|"+d+"|"+h+"|"+f+p+v+")"+m+g;return ry=new RegExp("(?:^"+y+"$)","i"),ry},BR={email:/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+\.)+[a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]{2,}))$/,hex:/^#?([a-f0-9]{6}|[a-f0-9]{3})$/i},mv={integer:function(t){return mv.number(t)&&parseInt(t,10)===t},float:function(t){return mv.number(t)&&!mv.integer(t)},array:function(t){return Array.isArray(t)},regexp:function(t){if(t instanceof RegExp)return!0;try{return!!new RegExp(t)}catch{return!1}},date:function(t){return typeof t.getTime=="function"&&typeof t.getMonth=="function"&&typeof t.getYear=="function"&&!isNaN(t.getTime())},number:function(t){return isNaN(t)?!1:typeof t=="number"},object:function(t){return typeof t=="object"&&!mv.array(t)},method:function(t){return typeof t=="function"},email:function(t){return typeof t=="string"&&t.length<=320&&!!t.match(BR.email)},url:function(t){return typeof t=="string"&&t.length<=2048&&!!t.match(Nse())},hex:function(t){return typeof t=="string"&&!!t.match(BR.hex)}},Use=function(t,r,i,n,a){if(t.required&&r===void 0){H6(t,r,i,n,a);return}var o=["integer","float","array","regexp","object","method","email","number","date","url","hex"],s=t.type;o.indexOf(s)>-1?mv[s](r)||n.push(mo(a.messages.types[s],t.fullField,t.type)):s&&typeof r!==t.type&&n.push(mo(a.messages.types[s],t.fullField,t.type))},jse=function(t,r,i,n,a){var o=typeof t.len=="number",s=typeof t.min=="number",l=typeof t.max=="number",c=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,u=r,d=null,h=typeof r=="number",f=typeof r=="string",p=Array.isArray(r);if(h?d="number":f?d="string":p&&(d="array"),!d)return!1;p&&(u=r.length),f&&(u=r.replace(c,"_").length),o?u!==t.len&&n.push(mo(a.messages[d].len,t.fullField,t.len)):s&&!l&&u<t.min?n.push(mo(a.messages[d].min,t.fullField,t.min)):l&&!s&&u>t.max?n.push(mo(a.messages[d].max,t.fullField,t.max)):s&&l&&(u<t.min||u>t.max)&&n.push(mo(a.messages[d].range,t.fullField,t.min,t.max))},qh="enum",Vse=function(t,r,i,n,a){t[qh]=Array.isArray(t[qh])?t[qh]:[],t[qh].indexOf(r)===-1&&n.push(mo(a.messages[qh],t.fullField,t[qh].join(", ")))},Hse=function(t,r,i,n,a){if(t.pattern){if(t.pattern instanceof RegExp)t.pattern.lastIndex=0,t.pattern.test(r)||n.push(mo(a.messages.pattern.mismatch,t.fullField,r,t.pattern));else if(typeof t.pattern=="string"){var o=new RegExp(t.pattern);o.test(r)||n.push(mo(a.messages.pattern.mismatch,t.fullField,r,t.pattern))}}},Ar={required:H6,whitespace:Fse,type:Use,range:jse,enum:Vse,pattern:Hse},Wse=function(t,r,i,n,a){var o=[],s=t.required||!t.required&&n.hasOwnProperty(t.field);if(s){if(Cn(r,"string")&&!t.required)return i();Ar.required(t,r,n,o,a,"string"),Cn(r,"string")||(Ar.type(t,r,n,o,a),Ar.range(t,r,n,o,a),Ar.pattern(t,r,n,o,a),t.whitespace===!0&&Ar.whitespace(t,r,n,o,a))}i(o)},Gse=function(t,r,i,n,a){var o=[],s=t.required||!t.required&&n.hasOwnProperty(t.field);if(s){if(Cn(r)&&!t.required)return i();Ar.required(t,r,n,o,a),r!==void 0&&Ar.type(t,r,n,o,a)}i(o)},$se=function(t,r,i,n,a){var o=[],s=t.required||!t.required&&n.hasOwnProperty(t.field);if(s){if(r===""&&(r=void 0),Cn(r)&&!t.required)return i();Ar.required(t,r,n,o,a),r!==void 0&&(Ar.type(t,r,n,o,a),Ar.range(t,r,n,o,a))}i(o)},qse=function(t,r,i,n,a){var o=[],s=t.required||!t.required&&n.hasOwnProperty(t.field);if(s){if(Cn(r)&&!t.required)return i();Ar.required(t,r,n,o,a),r!==void 0&&Ar.type(t,r,n,o,a)}i(o)},Yse=function(t,r,i,n,a){var o=[],s=t.required||!t.required&&n.hasOwnProperty(t.field);if(s){if(Cn(r)&&!t.required)return i();Ar.required(t,r,n,o,a),Cn(r)||Ar.type(t,r,n,o,a)}i(o)},Xse=function(t,r,i,n,a){var o=[],s=t.required||!t.required&&n.hasOwnProperty(t.field);if(s){if(Cn(r)&&!t.required)return i();Ar.required(t,r,n,o,a),r!==void 0&&(Ar.type(t,r,n,o,a),Ar.range(t,r,n,o,a))}i(o)},Kse=function(t,r,i,n,a){var o=[],s=t.required||!t.required&&n.hasOwnProperty(t.field);if(s){if(Cn(r)&&!t.required)return i();Ar.required(t,r,n,o,a),r!==void 0&&(Ar.type(t,r,n,o,a),Ar.range(t,r,n,o,a))}i(o)},Qse=function(t,r,i,n,a){var o=[],s=t.required||!t.required&&n.hasOwnProperty(t.field);if(s){if(r==null&&!t.required)return i();Ar.required(t,r,n,o,a,"array"),r!=null&&(Ar.type(t,r,n,o,a),Ar.range(t,r,n,o,a))}i(o)},Zse=function(t,r,i,n,a){var o=[],s=t.required||!t.required&&n.hasOwnProperty(t.field);if(s){if(Cn(r)&&!t.required)return i();Ar.required(t,r,n,o,a),r!==void 0&&Ar.type(t,r,n,o,a)}i(o)},Jse="enum",ele=function(t,r,i,n,a){var o=[],s=t.required||!t.required&&n.hasOwnProperty(t.field);if(s){if(Cn(r)&&!t.required)return i();Ar.required(t,r,n,o,a),r!==void 0&&Ar[Jse](t,r,n,o,a)}i(o)},tle=function(t,r,i,n,a){var o=[],s=t.required||!t.required&&n.hasOwnProperty(t.field);if(s){if(Cn(r,"string")&&!t.required)return i();Ar.required(t,r,n,o,a),Cn(r,"string")||Ar.pattern(t,r,n,o,a)}i(o)},rle=function(t,r,i,n,a){var o=[],s=t.required||!t.required&&n.hasOwnProperty(t.field);if(s){if(Cn(r,"date")&&!t.required)return i();if(Ar.required(t,r,n,o,a),!Cn(r,"date")){var l;r instanceof Date?l=r:l=new Date(r),Ar.type(t,l,n,o,a),l&&Ar.range(t,l.getTime(),n,o,a)}}i(o)},ile=function(t,r,i,n,a){var o=[],s=Array.isArray(r)?"array":typeof r;Ar.required(t,r,n,o,a,s),i(o)},$S=function(t,r,i,n,a){var o=t.type,s=[],l=t.required||!t.required&&n.hasOwnProperty(t.field);if(l){if(Cn(r,o)&&!t.required)return i();Ar.required(t,r,n,s,a,o),Cn(r,o)||Ar.type(t,r,n,s,a)}i(s)},nle=function(t,r,i,n,a){var o=[],s=t.required||!t.required&&n.hasOwnProperty(t.field);if(s){if(Cn(r)&&!t.required)return i();Ar.required(t,r,n,o,a)}i(o)},Fv={string:Wse,method:Gse,number:$se,boolean:qse,regexp:Yse,integer:Xse,float:Kse,array:Qse,object:Zse,enum:ele,pattern:tle,date:rle,url:$S,hex:$S,email:$S,required:ile,any:nle};function UA(){return{default:"Validation error on field %s",required:"%s is required",enum:"%s must be one of %s",whitespace:"%s cannot be empty",date:{format:"%s date %s is invalid for format %s",parse:"%s date could not be parsed, %s is invalid ",invalid:"%s date %s is invalid"},types:{string:"%s is not a %s",method:"%s is not a %s (function)",array:"%s is not an %s",object:"%s is not an %s",number:"%s is not a %s",date:"%s is not a %s",boolean:"%s is not a %s",integer:"%s is not an %s",float:"%s is not a %s",regexp:"%s is not a valid %s",email:"%s is not a valid %s",url:"%s is not a valid %s",hex:"%s is not a valid %s"},string:{len:"%s must be exactly %s characters",min:"%s must be at least %s characters",max:"%s cannot be longer than %s characters",range:"%s must be between %s and %s characters"},number:{len:"%s must equal %s",min:"%s cannot be less than %s",max:"%s cannot be greater than %s",range:"%s must be between %s and %s"},array:{len:"%s must be exactly %s in length",min:"%s cannot be less than %s in length",max:"%s cannot be greater than %s in length",range:"%s must be between %s and %s in length"},pattern:{mismatch:"%s value %s does not match pattern %s"},clone:function(){var t=JSON.parse(JSON.stringify(this));return t.clone=this.clone,t}}}var jA=UA(),Dp=function(){function e(r){this.rules=null,this._messages=jA,this.define(r)}var t=e.prototype;return t.define=function(i){var n=this;if(!i)throw new Error("Cannot configure a schema with no rules");if(typeof i!="object"||Array.isArray(i))throw new Error("Rules must be an object");this.rules={},Object.keys(i).forEach(function(a){var o=i[a];n.rules[a]=Array.isArray(o)?o:[o]})},t.messages=function(i){return i&&(this._messages=LR(UA(),i)),this._messages},t.validate=function(i,n,a){var o=this;n===void 0&&(n={}),a===void 0&&(a=function(){});var s=i,l=n,c=a;if(typeof l=="function"&&(c=l,l={}),!this.rules||Object.keys(this.rules).length===0)return c&&c(null,s),Promise.resolve(s);function u(v){var m=[],g={};function y(x){if(Array.isArray(x)){var S;m=(S=m).concat.apply(S,x)}else m.push(x)}for(var b=0;b<v.length;b++)y(v[b]);m.length?(g=NA(m),c(m,g)):c(null,s)}if(l.messages){var d=this.messages();d===jA&&(d=UA()),LR(d,l.messages),l.messages=d}else l.messages=this.messages();var h={},f=l.keys||Object.keys(this.rules);f.forEach(function(v){var m=o.rules[v],g=s[v];m.forEach(function(y){var b=y;typeof b.transform=="function"&&(s===i&&(s=Id({},s)),g=s[v]=b.transform(g)),typeof b=="function"?b={validator:b}:b=Id({},b),b.validator=o.getValidationMethod(b),b.validator&&(b.field=v,b.fullField=b.fullField||v,b.type=o.getType(b),h[v]=h[v]||[],h[v].push({rule:b,value:g,source:s,field:v}))})});var p={};return kse(h,l,function(v,m){var g=v.rule,y=(g.type==="object"||g.type==="array")&&(typeof g.fields=="object"||typeof g.defaultField=="object");y=y&&(g.required||!g.required&&v.value),g.field=v.field;function b(w,_){return Id({},_,{fullField:g.fullField+"."+w,fullFields:g.fullFields?[].concat(g.fullFields,[w]):[w]})}function x(w){w===void 0&&(w=[]);var _=Array.isArray(w)?w:[w];!l.suppressWarning&&_.length&&e.warning("async-validator:",_),_.length&&g.message!==void 0&&(_=[].concat(g.message));var C=_.map(kR(g,s));if(l.first&&C.length)return p[g.field]=1,m(C);if(!y)m(C);else{if(g.required&&!v.value)return g.message!==void 0?C=[].concat(g.message).map(kR(g,s)):l.error&&(C=[l.error(g,mo(l.messages.required,g.field))]),m(C);var A={};g.defaultField&&Object.keys(v.value).map(function(T){A[T]=g.defaultField}),A=Id({},A,v.rule.fields);var M={};Object.keys(A).forEach(function(T){var R=A[T],z=Array.isArray(R)?R:[R];M[T]=z.map(b.bind(null,T))});var P=new e(M);P.messages(l.messages),v.rule.options&&(v.rule.options.messages=l.messages,v.rule.options.error=l.error),P.validate(v.value,v.rule.options||l,function(T){var R=[];C&&C.length&&R.push.apply(R,C),T&&T.length&&R.push.apply(R,T),m(R.length?R:null)})}}var S;if(g.asyncValidator)S=g.asyncValidator(g,v.value,x,v.source,l);else if(g.validator){try{S=g.validator(g,v.value,x,v.source,l)}catch(w){console.error==null||console.error(w),l.suppressValidatorError||setTimeout(function(){throw w},0),x(w.message)}S===!0?x():S===!1?x(typeof g.message=="function"?g.message(g.fullField||g.field):g.message||(g.fullField||g.field)+" fails"):S instanceof Array?x(S):S instanceof Error&&x(S.message)}S&&S.then&&S.then(function(){return x()},function(w){return x(w)})},function(v){u(v)},s)},t.getType=function(i){if(i.type===void 0&&i.pattern instanceof RegExp&&(i.type="pattern"),typeof i.validator!="function"&&i.type&&!Fv.hasOwnProperty(i.type))throw new Error(mo("Unknown rule type %s",i.type));return i.type||"string"},t.getValidationMethod=function(i){if(typeof i.validator=="function")return i.validator;var n=Object.keys(i),a=n.indexOf("message");return a!==-1&&n.splice(a,1),n.length===1&&n[0]==="required"?Fv.required:Fv[this.getType(i)]||void 0},e}();Dp.register=function(t,r){if(typeof r!="function")throw new Error("Cannot register a validator by type, validator is not a function");Fv[t]=r};Dp.warning=Ose;Dp.messages=jA;Dp.validators=Fv;function ale(e){const t=_t(s0,null);return{mergedSize:re(()=>e.size!==void 0?e.size:(t==null?void 0:t.props.size)!==void 0?t.props.size:"medium")}}function ole(e){const t=_t(s0,null),r=re(()=>{const{labelPlacement:p}=e;return p!==void 0?p:t!=null&&t.props.labelPlacement?t.props.labelPlacement:"top"}),i=re(()=>r.value==="left"&&(e.labelWidth==="auto"||(t==null?void 0:t.props.labelWidth)==="auto")),n=re(()=>{if(r.value==="top")return;const{labelWidth:p}=e;if(p!==void 0&&p!=="auto")return fs(p);if(i.value){const v=t==null?void 0:t.maxChildLabelWidthRef.value;return v!==void 0?fs(v):void 0}if((t==null?void 0:t.props.labelWidth)!==void 0)return fs(t.props.labelWidth)}),a=re(()=>{const{labelAlign:p}=e;if(p)return p;if(t!=null&&t.props.labelAlign)return t.props.labelAlign}),o=re(()=>{var p;return[(p=e.labelProps)===null||p===void 0?void 0:p.style,e.labelStyle,{width:n.value}]}),s=re(()=>{const{showRequireMark:p}=e;return p!==void 0?p:t==null?void 0:t.props.showRequireMark}),l=re(()=>{const{requireMarkPlacement:p}=e;return p!==void 0?p:(t==null?void 0:t.props.requireMarkPlacement)||"right"}),c=me(!1),u=me(!1),d=re(()=>{const{validationStatus:p}=e;if(p!==void 0)return p;if(c.value)return"error";if(u.value)return"warning"}),h=re(()=>{const{showFeedback:p}=e;return p!==void 0?p:(t==null?void 0:t.props.showFeedback)!==void 0?t.props.showFeedback:!0}),f=re(()=>{const{showLabel:p}=e;return p!==void 0?p:(t==null?void 0:t.props.showLabel)!==void 0?t.props.showLabel:!0});return{validationErrored:c,validationWarned:u,mergedLabelStyle:o,mergedLabelPlacement:r,mergedLabelAlign:a,mergedShowRequireMark:s,mergedRequireMarkPlacement:l,mergedValidationStatus:d,mergedShowFeedback:h,mergedShowLabel:f,isAutoLabelWidth:i}}function sle(e){const t=_t(s0,null),r=re(()=>{const{rulePath:o}=e;if(o!==void 0)return o;const{path:s}=e;if(s!==void 0)return s}),i=re(()=>{const o=[],{rule:s}=e;if(s!==void 0&&(Array.isArray(s)?o.push(...s):o.push(s)),t){const{rules:l}=t.props,{value:c}=r;if(l!==void 0&&c!==void 0){const u=YT(l,c);u!==void 0&&(Array.isArray(u)?o.push(...u):o.push(u))}}return o}),n=re(()=>i.value.some(o=>o.required)),a=re(()=>n.value||e.required);return{mergedRules:i,mergedRequired:a}}const{cubicBezierEaseInOut:FR}=Ku;function lle({name:e="fade-down",fromOffset:t="-4px",enterDuration:r=".3s",leaveDuration:i=".3s",enterCubicBezier:n=FR,leaveCubicBezier:a=FR}={}){return[ge(`&.${e}-transition-enter-from, &.${e}-transition-leave-to`,{opacity:0,transform:`translateY(${t})`}),ge(`&.${e}-transition-enter-to, &.${e}-transition-leave-from`,{opacity:1,transform:"translateY(0)"}),ge(`&.${e}-transition-leave-active`,{transition:`opacity ${i} ${a}, transform ${i} ${a}`}),ge(`&.${e}-transition-enter-active`,{transition:`opacity ${r} ${n}, transform ${r} ${n}`})]}const cle=oe("form-item",`
 display: grid;
 line-height: var(--n-line-height);
`,[oe("form-item-label",`
 grid-area: label;
 align-items: center;
 line-height: 1.25;
 text-align: var(--n-label-text-align);
 font-size: var(--n-label-font-size);
 min-height: var(--n-label-height);
 padding: var(--n-label-padding);
 color: var(--n-label-text-color);
 transition: color .3s var(--n-bezier);
 box-sizing: border-box;
 font-weight: var(--n-label-font-weight);
 `,[he("asterisk",`
 white-space: nowrap;
 user-select: none;
 -webkit-user-select: none;
 color: var(--n-asterisk-color);
 transition: color .3s var(--n-bezier);
 `),he("asterisk-placeholder",`
 grid-area: mark;
 user-select: none;
 -webkit-user-select: none;
 visibility: hidden; 
 `)]),oe("form-item-blank",`
 grid-area: blank;
 min-height: var(--n-blank-height);
 `),xe("auto-label-width",[oe("form-item-label","white-space: nowrap;")]),xe("left-labelled",`
 grid-template-areas:
 "label blank"
 "label feedback";
 grid-template-columns: auto minmax(0, 1fr);
 grid-template-rows: auto 1fr;
 align-items: flex-start;
 `,[oe("form-item-label",`
 display: grid;
 grid-template-columns: 1fr auto;
 min-height: var(--n-blank-height);
 height: auto;
 box-sizing: border-box;
 flex-shrink: 0;
 flex-grow: 0;
 `,[xe("reverse-columns-space",`
 grid-template-columns: auto 1fr;
 `),xe("left-mark",`
 grid-template-areas:
 "mark text"
 ". text";
 `),xe("right-mark",`
 grid-template-areas: 
 "text mark"
 "text .";
 `),xe("right-hanging-mark",`
 grid-template-areas: 
 "text mark"
 "text .";
 `),he("text",`
 grid-area: text; 
 `),he("asterisk",`
 grid-area: mark; 
 align-self: end;
 `)])]),xe("top-labelled",`
 grid-template-areas:
 "label"
 "blank"
 "feedback";
 grid-template-rows: minmax(var(--n-label-height), auto) 1fr;
 grid-template-columns: minmax(0, 100%);
 `,[xe("no-label",`
 grid-template-areas:
 "blank"
 "feedback";
 grid-template-rows: 1fr;
 `),oe("form-item-label",`
 display: flex;
 align-items: flex-start;
 justify-content: var(--n-label-text-align);
 `)]),oe("form-item-blank",`
 box-sizing: border-box;
 display: flex;
 align-items: center;
 position: relative;
 `),oe("form-item-feedback-wrapper",`
 grid-area: feedback;
 box-sizing: border-box;
 min-height: var(--n-feedback-height);
 font-size: var(--n-feedback-font-size);
 line-height: 1.25;
 transform-origin: top left;
 `,[ge("&:not(:empty)",`
 padding: var(--n-feedback-padding);
 `),oe("form-item-feedback",{transition:"color .3s var(--n-bezier)",color:"var(--n-feedback-text-color)"},[xe("warning",{color:"var(--n-feedback-text-color-warning)"}),xe("error",{color:"var(--n-feedback-text-color-error)"}),lle({fromOffset:"-3px",enterDuration:".3s",leaveDuration:".2s"})])])]);var NR=function(e,t,r,i){function n(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function s(u){try{c(i.next(u))}catch(d){o(d)}}function l(u){try{c(i.throw(u))}catch(d){o(d)}}function c(u){u.done?a(u.value):n(u.value).then(s,l)}c((i=i.apply(e,t||[])).next())})};const ule=Object.assign(Object.assign({},bt.props),{label:String,labelWidth:[Number,String],labelStyle:[String,Object],labelAlign:String,labelPlacement:String,path:String,first:Boolean,rulePath:String,required:Boolean,showRequireMark:{type:Boolean,default:void 0},requireMarkPlacement:String,showFeedback:{type:Boolean,default:void 0},rule:[Object,Array],size:String,ignorePathChange:Boolean,validationStatus:String,feedback:String,feedbackClass:String,feedbackStyle:[String,Object],showLabel:{type:Boolean,default:void 0},labelProps:Object});function UR(e,t){return(...r)=>{try{const i=e(...r);return!t&&(typeof i=="boolean"||i instanceof Error||Array.isArray(i))||i!=null&&i.then?i:(i===void 0||sh("form-item/validate",`You return a ${typeof i} typed value in the validator method, which is not recommended. Please use `+(t?"`Promise`":"`boolean`, `Error` or `Promise`")+" typed value instead."),!0)}catch(i){sh("form-item/validate","An error is catched in the validation, so the validation won't be done. Your callback in `validate` method of `n-form` or `n-form-item` won't be called in this validation."),console.error(i);return}}}const gr=je({name:"FormItem",props:ule,setup(e){pY(V6,"formItems",pt(e,"path"));const{mergedClsPrefixRef:t,inlineThemeDisabled:r}=vr(e),i=_t(s0,null),n=ale(e),a=ole(e),{validationErrored:o,validationWarned:s}=a,{mergedRequired:l,mergedRules:c}=sle(e),{mergedSize:u}=n,{mergedLabelPlacement:d,mergedLabelAlign:h,mergedRequireMarkPlacement:f}=a,p=me([]),v=me(oh()),m=i?pt(i.props,"disabled"):me(!1),g=bt("Form","-form-item",cle,j6,e,t);rr(pt(e,"path"),()=>{e.ignorePathChange||y()});function y(){p.value=[],o.value=!1,s.value=!1,e.feedback&&(v.value=oh())}function b(){C("blur")}function x(){C("change")}function S(){C("focus")}function w(){C("input")}function _(z,F){return NR(this,void 0,void 0,function*(){let H,N,U,ie;return typeof z=="string"?(H=z,N=F):z!==null&&typeof z=="object"&&(H=z.trigger,N=z.callback,U=z.shouldRuleBeApplied,ie=z.options),yield new Promise((te,X)=>{C(H,U,ie).then(({valid:W,errors:q,warnings:$})=>{W?(N&&N(void 0,{warnings:$}),te({warnings:$})):(N&&N(q,{warnings:$}),X(q))})})})}const C=(...z)=>NR(this,[...z],void 0,function*(F=null,H=()=>!0,N={suppressWarning:!0}){const{path:U}=e;N?N.first||(N.first=e.first):N={};const{value:ie}=c,te=i?YT(i.props.model,U||""):void 0,X={},W={},q=(F?ie.filter(Ce=>Array.isArray(Ce.trigger)?Ce.trigger.includes(F):Ce.trigger===F):ie).filter(H).map((Ce,G)=>{const Z=Object.assign({},Ce);if(Z.validator&&(Z.validator=UR(Z.validator,!1)),Z.asyncValidator&&(Z.asyncValidator=UR(Z.asyncValidator,!0)),Z.renderMessage){const de=`__renderMessage__${G}`;W[de]=Z.message,Z.message=de,X[de]=Z.renderMessage}return Z}),$=q.filter(Ce=>Ce.level!=="warning"),le=q.filter(Ce=>Ce.level==="warning"),ee=U??"__n_no_path__",Q=new Dp({[ee]:$}),ne=new Dp({[ee]:le}),{validateMessages:V}=(i==null?void 0:i.props)||{};V&&(Q.messages(V),ne.messages(V));const ue=Ce=>{p.value=Ce.map(G=>{const Z=(G==null?void 0:G.message)||"";return{key:Z,render:()=>Z.startsWith("__renderMessage__")?X[Z]():Z}}),Ce.forEach(G=>{var Z;!((Z=G.message)===null||Z===void 0)&&Z.startsWith("__renderMessage__")&&(G.message=W[G.message])})},ve={valid:!0,errors:void 0,warnings:void 0};if($.length){const Ce=yield new Promise(G=>{Q.validate({[ee]:te},N,G)});Ce!=null&&Ce.length&&(o.value=!0,ve.valid=!1,ve.errors=Ce,ue(Ce))}if(le.length&&!ve.errors){const Ce=yield new Promise(G=>{ne.validate({[ee]:te},N,G)});Ce!=null&&Ce.length&&(ue(Ce),s.value=!0,ve.warnings=Ce)}return $.length+le.length>0&&!ve.errors&&!ve.warnings&&y(),ve});xr(hx,{path:pt(e,"path"),disabled:m,mergedSize:n.mergedSize,mergedValidationStatus:a.mergedValidationStatus,restoreValidation:y,handleContentBlur:b,handleContentChange:x,handleContentFocus:S,handleContentInput:w});const A={validate:_,restoreValidation:y,internalValidate:C},M=me(null);Or(()=>{if(!a.isAutoLabelWidth.value)return;const z=M.value;if(z!==null){const F=z.style.whiteSpace;z.style.whiteSpace="nowrap",z.style.width="",i==null||i.deriveMaxChildLabelWidth(Number(getComputedStyle(z).width.slice(0,-2))),z.style.whiteSpace=F}});const P=re(()=>{var z;const{value:F}=u,{value:H}=d,N=H==="top"?"vertical":"horizontal",{common:{cubicBezierEaseInOut:U},self:{labelTextColor:ie,asteriskColor:te,lineHeight:X,feedbackTextColor:W,feedbackTextColorWarning:q,feedbackTextColorError:$,feedbackPadding:le,labelFontWeight:ee,[Ze("labelHeight",F)]:Q,[Ze("blankHeight",F)]:ne,[Ze("feedbackFontSize",F)]:V,[Ze("feedbackHeight",F)]:ue,[Ze("labelPadding",N)]:ve,[Ze("labelTextAlign",N)]:Ce,[Ze(Ze("labelFontSize",H),F)]:G}}=g.value;let Z=(z=h.value)!==null&&z!==void 0?z:Ce;return H==="top"&&(Z=Z==="right"?"flex-end":"flex-start"),{"--n-bezier":U,"--n-line-height":X,"--n-blank-height":ne,"--n-label-font-size":G,"--n-label-text-align":Z,"--n-label-height":Q,"--n-label-padding":ve,"--n-label-font-weight":ee,"--n-asterisk-color":te,"--n-label-text-color":ie,"--n-feedback-padding":le,"--n-feedback-font-size":V,"--n-feedback-height":ue,"--n-feedback-text-color":W,"--n-feedback-text-color-warning":q,"--n-feedback-text-color-error":$}}),T=r?Dr("form-item",re(()=>{var z;return`${u.value[0]}${d.value[0]}${((z=h.value)===null||z===void 0?void 0:z[0])||""}`}),P,e):void 0,R=re(()=>d.value==="left"&&f.value==="left"&&h.value==="left");return Object.assign(Object.assign(Object.assign(Object.assign({labelElementRef:M,mergedClsPrefix:t,mergedRequired:l,feedbackId:v,renderExplains:p,reverseColSpace:R},a),n),A),{cssVars:r?void 0:P,themeClass:T==null?void 0:T.themeClass,onRender:T==null?void 0:T.onRender})},render(){const{$slots:e,mergedClsPrefix:t,mergedShowLabel:r,mergedShowRequireMark:i,mergedRequireMarkPlacement:n,onRender:a}=this,o=i!==void 0?i:this.mergedRequired;a==null||a();const s=()=>{const l=this.$slots.label?this.$slots.label():this.label;if(!l)return null;const c=E("span",{class:`${t}-form-item-label__text`},l),u=o?E("span",{class:`${t}-form-item-label__asterisk`},n!=="left"?"*":"*"):n==="right-hanging"&&E("span",{class:`${t}-form-item-label__asterisk-placeholder`},"*"),{labelProps:d}=this;return E("label",Object.assign({},d,{class:[d==null?void 0:d.class,`${t}-form-item-label`,`${t}-form-item-label--${n}-mark`,this.reverseColSpace&&`${t}-form-item-label--reverse-columns-space`],style:this.mergedLabelStyle,ref:"labelElementRef"}),n==="left"?[u,c]:[c,u])};return E("div",{class:[`${t}-form-item`,this.themeClass,`${t}-form-item--${this.mergedSize}-size`,`${t}-form-item--${this.mergedLabelPlacement}-labelled`,this.isAutoLabelWidth&&`${t}-form-item--auto-label-width`,!r&&`${t}-form-item--no-label`],style:this.cssVars},r&&s(),E("div",{class:[`${t}-form-item-blank`,this.mergedValidationStatus&&`${t}-form-item-blank--${this.mergedValidationStatus}`]},e),this.mergedShowFeedback?E("div",{key:this.feedbackId,style:this.feedbackStyle,class:[`${t}-form-item-feedback-wrapper`,this.feedbackClass]},E(La,{name:"fade-down-transition",mode:"out-in"},{default:()=>{const{mergedValidationStatus:l}=this;return ti(e.feedback,c=>{var u;const{feedback:d}=this,h=c||d?E("div",{key:"__feedback__",class:`${t}-form-item-feedback__line`},c||d):this.renderExplains.length?(u=this.renderExplains)===null||u===void 0?void 0:u.map(({key:f,render:p})=>E("div",{key:f,class:`${t}-form-item-feedback__line`},p())):null;return h?l==="warning"?E("div",{key:"controlled-warning",class:`${t}-form-item-feedback ${t}-form-item-feedback--warning`},h):l==="error"?E("div",{key:"controlled-error",class:`${t}-form-item-feedback ${t}-form-item-feedback--error`},h):l==="success"?E("div",{key:"controlled-success",class:`${t}-form-item-feedback ${t}-form-item-feedback--success`},h):E("div",{key:"controlled-default",class:`${t}-form-item-feedback`},h):null})}})):null)}}),dle={margin:"0 0 8px 0",padding:"10px 20px",maxWidth:"720px",minWidth:"420px",iconMargin:"0 10px 0 0",closeMargin:"0 0 0 10px",closeSize:"20px",closeIconSize:"16px",iconSize:"20px",fontSize:"14px"},hle=e=>{const{textColor2:t,closeIconColor:r,closeIconColorHover:i,closeIconColorPressed:n,infoColor:a,successColor:o,errorColor:s,warningColor:l,popoverColor:c,boxShadow2:u,primaryColor:d,lineHeight:h,borderRadius:f,closeColorHover:p,closeColorPressed:v}=e;return Object.assign(Object.assign({},dle),{closeBorderRadius:f,textColor:t,textColorInfo:t,textColorSuccess:t,textColorError:t,textColorWarning:t,textColorLoading:t,color:c,colorInfo:c,colorSuccess:c,colorError:c,colorWarning:c,colorLoading:c,boxShadow:u,boxShadowInfo:u,boxShadowSuccess:u,boxShadowError:u,boxShadowWarning:u,boxShadowLoading:u,iconColor:t,iconColorInfo:a,iconColorSuccess:o,iconColorWarning:l,iconColorError:s,iconColorLoading:d,closeColorHover:p,closeColorPressed:v,closeIconColor:r,closeIconColorHover:i,closeIconColorPressed:n,closeColorHoverInfo:p,closeColorPressedInfo:v,closeIconColorInfo:r,closeIconColorHoverInfo:i,closeIconColorPressedInfo:n,closeColorHoverSuccess:p,closeColorPressedSuccess:v,closeIconColorSuccess:r,closeIconColorHoverSuccess:i,closeIconColorPressedSuccess:n,closeColorHoverError:p,closeColorPressedError:v,closeIconColorError:r,closeIconColorHoverError:i,closeIconColorPressedError:n,closeColorHoverWarning:p,closeColorPressedWarning:v,closeIconColorWarning:r,closeIconColorHoverWarning:i,closeIconColorPressedWarning:n,closeColorHoverLoading:p,closeColorPressedLoading:v,closeIconColorLoading:r,closeIconColorHoverLoading:i,closeIconColorPressedLoading:n,loadingColor:d,lineHeight:h,borderRadius:f})},fle={name:"Message",common:$r,self:hle},ple=e=>{const{primaryColor:t,successColor:r,warningColor:i,errorColor:n,infoColor:a,fontWeightStrong:o}=e;return{fontWeight:o,rotate:"252deg",colorStartPrimary:Xt(t,{alpha:.6}),colorEndPrimary:t,colorStartInfo:Xt(a,{alpha:.6}),colorEndInfo:a,colorStartWarning:Xt(i,{alpha:.6}),colorEndWarning:i,colorStartError:Xt(n,{alpha:.6}),colorEndError:n,colorStartSuccess:Xt(r,{alpha:.6}),colorEndSuccess:r}},mle={name:"GradientText",common:$r,self:ple},vle=e=>{const{baseColor:t,textColor2:r,bodyColor:i,cardColor:n,dividerColor:a,actionColor:o,scrollbarColor:s,scrollbarColorHover:l,invertedColor:c}=e;return{textColor:r,textColorInverted:"#FFF",color:i,colorEmbedded:o,headerColor:n,headerColorInverted:c,footerColor:o,footerColorInverted:c,headerBorderColor:a,headerBorderColorInverted:c,footerBorderColor:a,footerBorderColorInverted:c,siderBorderColor:a,siderBorderColorInverted:c,siderColor:n,siderColorInverted:c,siderToggleButtonBorder:`1px solid ${a}`,siderToggleButtonColor:t,siderToggleButtonIconColor:r,siderToggleButtonIconColorInverted:r,siderToggleBarColor:il(i,s),siderToggleBarColorHover:il(i,l),__invertScrollbar:"true"}},pw={name:"Layout",common:$r,peers:{Scrollbar:em},self:vle};function gle(e,t,r,i){return{itemColorHoverInverted:"#0000",itemColorActiveInverted:t,itemColorActiveHoverInverted:t,itemColorActiveCollapsedInverted:t,itemTextColorInverted:e,itemTextColorHoverInverted:r,itemTextColorChildActiveInverted:r,itemTextColorChildActiveHoverInverted:r,itemTextColorActiveInverted:r,itemTextColorActiveHoverInverted:r,itemTextColorHorizontalInverted:e,itemTextColorHoverHorizontalInverted:r,itemTextColorChildActiveHorizontalInverted:r,itemTextColorChildActiveHoverHorizontalInverted:r,itemTextColorActiveHorizontalInverted:r,itemTextColorActiveHoverHorizontalInverted:r,itemIconColorInverted:e,itemIconColorHoverInverted:r,itemIconColorActiveInverted:r,itemIconColorActiveHoverInverted:r,itemIconColorChildActiveInverted:r,itemIconColorChildActiveHoverInverted:r,itemIconColorCollapsedInverted:e,itemIconColorHorizontalInverted:e,itemIconColorHoverHorizontalInverted:r,itemIconColorActiveHorizontalInverted:r,itemIconColorActiveHoverHorizontalInverted:r,itemIconColorChildActiveHorizontalInverted:r,itemIconColorChildActiveHoverHorizontalInverted:r,arrowColorInverted:e,arrowColorHoverInverted:r,arrowColorActiveInverted:r,arrowColorActiveHoverInverted:r,arrowColorChildActiveInverted:r,arrowColorChildActiveHoverInverted:r,groupTextColorInverted:i}}const yle=e=>{const{borderRadius:t,textColor3:r,primaryColor:i,textColor2:n,textColor1:a,fontSize:o,dividerColor:s,hoverColor:l,primaryColorHover:c}=e;return Object.assign({borderRadius:t,color:"#0000",groupTextColor:r,itemColorHover:l,itemColorActive:Xt(i,{alpha:.1}),itemColorActiveHover:Xt(i,{alpha:.1}),itemColorActiveCollapsed:Xt(i,{alpha:.1}),itemTextColor:n,itemTextColorHover:n,itemTextColorActive:i,itemTextColorActiveHover:i,itemTextColorChildActive:i,itemTextColorChildActiveHover:i,itemTextColorHorizontal:n,itemTextColorHoverHorizontal:c,itemTextColorActiveHorizontal:i,itemTextColorActiveHoverHorizontal:i,itemTextColorChildActiveHorizontal:i,itemTextColorChildActiveHoverHorizontal:i,itemIconColor:a,itemIconColorHover:a,itemIconColorActive:i,itemIconColorActiveHover:i,itemIconColorChildActive:i,itemIconColorChildActiveHover:i,itemIconColorCollapsed:a,itemIconColorHorizontal:a,itemIconColorHoverHorizontal:c,itemIconColorActiveHorizontal:i,itemIconColorActiveHoverHorizontal:i,itemIconColorChildActiveHorizontal:i,itemIconColorChildActiveHoverHorizontal:i,itemHeight:"42px",arrowColor:n,arrowColorHover:n,arrowColorActive:i,arrowColorActiveHover:i,arrowColorChildActive:i,arrowColorChildActiveHover:i,colorInverted:"#0000",borderColorHorizontal:"#0000",fontSize:o,dividerColor:s},gle("#BBB",i,"#FFF","#AAA"))},ble={name:"Menu",common:$r,peers:{Tooltip:b6,Dropdown:x6},self:yle},xle={titleFontSize:"18px",backSize:"22px"};function wle(e){const{textColor1:t,textColor2:r,textColor3:i,fontSize:n,fontWeightStrong:a,primaryColorHover:o,primaryColorPressed:s}=e;return Object.assign(Object.assign({},xle),{titleFontWeight:a,fontSize:n,titleTextColor:t,backColor:r,backColorHover:o,backColorPressed:s,subtitleTextColor:i})}const Sle={name:"PageHeader",common:$r,self:wle},Cle=e=>{const{textColor2:t,textColor3:r,fontSize:i,fontWeight:n}=e;return{labelFontSize:i,labelFontWeight:n,valueFontWeight:n,valueFontSize:"24px",labelTextColor:r,valuePrefixTextColor:t,valueSuffixTextColor:t,valueTextColor:t}},_le={name:"Statistic",common:$r,self:Cle},Ale={buttonHeightSmall:"14px",buttonHeightMedium:"18px",buttonHeightLarge:"22px",buttonWidthSmall:"14px",buttonWidthMedium:"18px",buttonWidthLarge:"22px",buttonWidthPressedSmall:"20px",buttonWidthPressedMedium:"24px",buttonWidthPressedLarge:"28px",railHeightSmall:"18px",railHeightMedium:"22px",railHeightLarge:"26px",railWidthSmall:"32px",railWidthMedium:"40px",railWidthLarge:"48px"},Mle=e=>{const{primaryColor:t,opacityDisabled:r,borderRadius:i,textColor3:n}=e;return Object.assign(Object.assign({},Ale),{iconColor:n,textColor:"white",loadingColor:t,opacityDisabled:r,railColor:"rgba(0, 0, 0, .14)",railColorActive:t,buttonBoxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.3), inset 0 0 1px 0 rgba(0, 0, 0, 0.05)",buttonColor:"#FFF",railBorderRadiusSmall:i,railBorderRadiusMedium:i,railBorderRadiusLarge:i,buttonBorderRadiusSmall:i,buttonBorderRadiusMedium:i,buttonBorderRadiusLarge:i,boxShadowFocus:`0 0 0 2px ${Xt(t,{alpha:.2})}`})},Ele={name:"Switch",common:$r,self:Mle},Tle={tabFontSizeSmall:"14px",tabFontSizeMedium:"14px",tabFontSizeLarge:"16px",tabGapSmallLine:"36px",tabGapMediumLine:"36px",tabGapLargeLine:"36px",tabGapSmallLineVertical:"8px",tabGapMediumLineVertical:"8px",tabGapLargeLineVertical:"8px",tabPaddingSmallLine:"6px 0",tabPaddingMediumLine:"10px 0",tabPaddingLargeLine:"14px 0",tabPaddingVerticalSmallLine:"6px 12px",tabPaddingVerticalMediumLine:"8px 16px",tabPaddingVerticalLargeLine:"10px 20px",tabGapSmallBar:"36px",tabGapMediumBar:"36px",tabGapLargeBar:"36px",tabGapSmallBarVertical:"8px",tabGapMediumBarVertical:"8px",tabGapLargeBarVertical:"8px",tabPaddingSmallBar:"4px 0",tabPaddingMediumBar:"6px 0",tabPaddingLargeBar:"10px 0",tabPaddingVerticalSmallBar:"6px 12px",tabPaddingVerticalMediumBar:"8px 16px",tabPaddingVerticalLargeBar:"10px 20px",tabGapSmallCard:"4px",tabGapMediumCard:"4px",tabGapLargeCard:"4px",tabGapSmallCardVertical:"4px",tabGapMediumCardVertical:"4px",tabGapLargeCardVertical:"4px",tabPaddingSmallCard:"8px 16px",tabPaddingMediumCard:"10px 20px",tabPaddingLargeCard:"12px 24px",tabPaddingSmallSegment:"4px 0",tabPaddingMediumSegment:"6px 0",tabPaddingLargeSegment:"8px 0",tabPaddingVerticalLargeSegment:"0 8px",tabPaddingVerticalSmallCard:"8px 12px",tabPaddingVerticalMediumCard:"10px 16px",tabPaddingVerticalLargeCard:"12px 20px",tabPaddingVerticalSmallSegment:"0 4px",tabPaddingVerticalMediumSegment:"0 6px",tabGapSmallSegment:"0",tabGapMediumSegment:"0",tabGapLargeSegment:"0",tabGapSmallSegmentVertical:"0",tabGapMediumSegmentVertical:"0",tabGapLargeSegmentVertical:"0",panePaddingSmall:"8px 0 0 0",panePaddingMedium:"12px 0 0 0",panePaddingLarge:"16px 0 0 0",closeSize:"18px",closeIconSize:"14px"},Ple=e=>{const{textColor2:t,primaryColor:r,textColorDisabled:i,closeIconColor:n,closeIconColorHover:a,closeIconColorPressed:o,closeColorHover:s,closeColorPressed:l,tabColor:c,baseColor:u,dividerColor:d,fontWeight:h,textColor1:f,borderRadius:p,fontSize:v,fontWeightStrong:m}=e;return Object.assign(Object.assign({},Tle),{colorSegment:c,tabFontSizeCard:v,tabTextColorLine:f,tabTextColorActiveLine:r,tabTextColorHoverLine:r,tabTextColorDisabledLine:i,tabTextColorSegment:f,tabTextColorActiveSegment:t,tabTextColorHoverSegment:t,tabTextColorDisabledSegment:i,tabTextColorBar:f,tabTextColorActiveBar:r,tabTextColorHoverBar:r,tabTextColorDisabledBar:i,tabTextColorCard:f,tabTextColorHoverCard:f,tabTextColorActiveCard:r,tabTextColorDisabledCard:i,barColor:r,closeIconColor:n,closeIconColorHover:a,closeIconColorPressed:o,closeColorHover:s,closeColorPressed:l,closeBorderRadius:p,tabColor:c,tabColorSegment:u,tabBorderColor:d,tabFontWeightActive:h,tabFontWeight:h,tabBorderRadius:p,paneTextColor:t,fontWeightStrong:m})},Dle={name:"Tabs",common:$r,self:Ple},Ole={extraFontSizeSmall:"12px",extraFontSizeMedium:"12px",extraFontSizeLarge:"14px",titleFontSizeSmall:"14px",titleFontSizeMedium:"16px",titleFontSizeLarge:"16px",closeSize:"20px",closeIconSize:"16px",headerHeightSmall:"44px",headerHeightMedium:"44px",headerHeightLarge:"50px"},Rle=e=>{const{fontWeight:t,fontSizeLarge:r,fontSizeMedium:i,fontSizeSmall:n,heightLarge:a,heightMedium:o,borderRadius:s,cardColor:l,tableHeaderColor:c,textColor1:u,textColorDisabled:d,textColor2:h,textColor3:f,borderColor:p,hoverColor:v,closeColorHover:m,closeColorPressed:g,closeIconColor:y,closeIconColorHover:b,closeIconColorPressed:x}=e;return Object.assign(Object.assign({},Ole),{itemHeightSmall:o,itemHeightMedium:o,itemHeightLarge:a,fontSizeSmall:n,fontSizeMedium:i,fontSizeLarge:r,borderRadius:s,dividerColor:p,borderColor:p,listColor:l,headerColor:il(l,c),titleTextColor:u,titleTextColorDisabled:d,extraTextColor:f,extraTextColorDisabled:d,itemTextColor:h,itemTextColorDisabled:d,itemColorPending:v,titleFontWeight:t,closeColorHover:m,closeColorPressed:g,closeIconColor:y,closeIconColorHover:b,closeIconColorPressed:x})},Ile={name:"Transfer",common:$r,peers:{Checkbox:v6,Scrollbar:em,Input:rm,Empty:aP,Button:n0},self:Rle},zle={headerFontSize1:"30px",headerFontSize2:"22px",headerFontSize3:"18px",headerFontSize4:"16px",headerFontSize5:"16px",headerFontSize6:"16px",headerMargin1:"28px 0 20px 0",headerMargin2:"28px 0 20px 0",headerMargin3:"28px 0 20px 0",headerMargin4:"28px 0 18px 0",headerMargin5:"28px 0 18px 0",headerMargin6:"28px 0 18px 0",headerPrefixWidth1:"16px",headerPrefixWidth2:"16px",headerPrefixWidth3:"12px",headerPrefixWidth4:"12px",headerPrefixWidth5:"12px",headerPrefixWidth6:"12px",headerBarWidth1:"4px",headerBarWidth2:"4px",headerBarWidth3:"3px",headerBarWidth4:"3px",headerBarWidth5:"3px",headerBarWidth6:"3px",pMargin:"16px 0 16px 0",liMargin:".25em 0 0 0",olPadding:"0 0 0 2em",ulPadding:"0 0 0 2em"},kle=e=>{const{primaryColor:t,textColor2:r,borderColor:i,lineHeight:n,fontSize:a,borderRadiusSmall:o,dividerColor:s,fontWeightStrong:l,textColor1:c,textColor3:u,infoColor:d,warningColor:h,errorColor:f,successColor:p,codeColor:v}=e;return Object.assign(Object.assign({},zle),{aTextColor:t,blockquoteTextColor:r,blockquotePrefixColor:i,blockquoteLineHeight:n,blockquoteFontSize:a,codeBorderRadius:o,liTextColor:r,liLineHeight:n,liFontSize:a,hrColor:s,headerFontWeight:l,headerTextColor:c,pTextColor:r,pTextColor1Depth:c,pTextColor2Depth:r,pTextColor3Depth:u,pLineHeight:n,pFontSize:a,headerBarColor:t,headerBarColorPrimary:t,headerBarColorInfo:d,headerBarColorError:f,headerBarColorWarning:h,headerBarColorSuccess:p,textColor:r,textColor1Depth:c,textColor2Depth:r,textColor3Depth:u,textColorPrimary:t,textColorInfo:d,textColorSuccess:p,textColorWarning:h,textColorError:f,codeTextColor:r,codeColor:v,codeBorder:"1px solid #0000"})},W6={name:"Typography",common:$r,self:kle},Lle=oe("gradient-text",`
 display: inline-block;
 font-weight: var(--n-font-weight);
 -webkit-background-clip: text;
 background-clip: text;
 color: #0000;
 white-space: nowrap;
 background-image: linear-gradient(var(--n-rotate), var(--n-color-start) 0%, var(--n-color-end) 100%);
 transition:
 --n-color-start .3s var(--n-bezier),
 --n-color-end .3s var(--n-bezier);
`),Ble=Object.assign(Object.assign({},bt.props),{size:[String,Number],fontSize:[String,Number],type:{type:String,default:"primary"},color:[Object,String],gradient:[Object,String]}),Fle=je({name:"GradientText",props:Ble,setup(e){EY();const{mergedClsPrefixRef:t,inlineThemeDisabled:r}=vr(e),i=re(()=>{const{type:c}=e;return c==="danger"?"error":c}),n=re(()=>{let c=e.size||e.fontSize;return c&&(c=fs(c)),c||void 0}),a=re(()=>{const c=e.color||e.gradient;if(typeof c=="string")return c;if(c){const u=c.deg||0,d=c.from,h=c.to;return`linear-gradient(${u}deg, ${d} 0%, ${h} 100%)`}}),o=bt("GradientText","-gradient-text",Lle,mle,e,t),s=re(()=>{const{value:c}=i,{common:{cubicBezierEaseInOut:u},self:{rotate:d,[Ze("colorStart",c)]:h,[Ze("colorEnd",c)]:f,fontWeight:p}}=o.value;return{"--n-bezier":u,"--n-rotate":d,"--n-color-start":h,"--n-color-end":f,"--n-font-weight":p}}),l=r?Dr("gradient-text",re(()=>i.value[0]),s,e):void 0;return{mergedClsPrefix:t,compatibleType:i,styleFontSize:n,styleBgImage:a,cssVars:r?void 0:s,themeClass:l==null?void 0:l.themeClass,onRender:l==null?void 0:l.onRender}},render(){const{mergedClsPrefix:e,onRender:t}=this;return t==null||t(),E("span",{class:[`${e}-gradient-text`,`${e}-gradient-text--${this.compatibleType}-type`,this.themeClass],style:[{fontSize:this.styleFontSize,backgroundImage:this.styleBgImage},this.cssVars]},this.$slots)}}),G6="n-layout-sider",mw={type:String,default:"static"},Nle=oe("layout",`
 color: var(--n-text-color);
 background-color: var(--n-color);
 box-sizing: border-box;
 position: relative;
 z-index: auto;
 flex: auto;
 overflow: hidden;
 transition:
 box-shadow .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
`,[oe("layout-scroll-container",`
 overflow-x: hidden;
 box-sizing: border-box;
 height: 100%;
 `),xe("absolute-positioned",`
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 `)]),Ule={embedded:Boolean,position:mw,nativeScrollbar:{type:Boolean,default:!0},scrollbarProps:Object,onScroll:Function,contentClass:String,contentStyle:{type:[String,Object],default:""},hasSider:Boolean,siderPlacement:{type:String,default:"left"}},$6="n-layout";function jle(e){return je({name:"Layout",props:Object.assign(Object.assign({},bt.props),Ule),setup(t){const r=me(null),i=me(null),{mergedClsPrefixRef:n,inlineThemeDisabled:a}=vr(t),o=bt("Layout","-layout",Nle,pw,t,n);function s(v,m){if(t.nativeScrollbar){const{value:g}=r;g&&(m===void 0?g.scrollTo(v):g.scrollTo(v,m))}else{const{value:g}=i;g&&g.scrollTo(v,m)}}xr($6,t);let l=0,c=0;const u=v=>{var m;const g=v.target;l=g.scrollLeft,c=g.scrollTop,(m=t.onScroll)===null||m===void 0||m.call(t,v)};BT(()=>{if(t.nativeScrollbar){const v=r.value;v&&(v.scrollTop=c,v.scrollLeft=l)}});const d={display:"flex",flexWrap:"nowrap",width:"100%",flexDirection:"row"},h={scrollTo:s},f=re(()=>{const{common:{cubicBezierEaseInOut:v},self:m}=o.value;return{"--n-bezier":v,"--n-color":t.embedded?m.colorEmbedded:m.color,"--n-text-color":m.textColor}}),p=a?Dr("layout",re(()=>t.embedded?"e":""),f,t):void 0;return Object.assign({mergedClsPrefix:n,scrollableElRef:r,scrollbarInstRef:i,hasSiderStyle:d,mergedTheme:o,handleNativeElScroll:u,cssVars:a?void 0:f,themeClass:p==null?void 0:p.themeClass,onRender:p==null?void 0:p.onRender},h)},render(){var t;const{mergedClsPrefix:r,hasSider:i}=this;(t=this.onRender)===null||t===void 0||t.call(this);const n=i?this.hasSiderStyle:void 0,a=[this.themeClass,e,`${r}-layout`,`${r}-layout--${this.position}-positioned`];return E("div",{class:a,style:this.cssVars},this.nativeScrollbar?E("div",{ref:"scrollableElRef",class:[`${r}-layout-scroll-container`,this.contentClass],style:[this.contentStyle,n],onScroll:this.handleNativeElScroll},this.$slots):E(Sn,Object.assign({},this.scrollbarProps,{onScroll:this.onScroll,ref:"scrollbarInstRef",theme:this.mergedTheme.peers.Scrollbar,themeOverrides:this.mergedTheme.peerOverrides.Scrollbar,contentClass:this.contentClass,contentStyle:[this.contentStyle,n]}),this.$slots))}})}const ip=jle(!1),Vle=oe("layout-header",`
 transition:
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 box-shadow .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 box-sizing: border-box;
 width: 100%;
 background-color: var(--n-color);
 color: var(--n-text-color);
`,[xe("absolute-positioned",`
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 `),xe("bordered",`
 border-bottom: solid 1px var(--n-border-color);
 `)]),Hle={position:mw,inverted:Boolean,bordered:{type:Boolean,default:!1}},q6=je({name:"LayoutHeader",props:Object.assign(Object.assign({},bt.props),Hle),setup(e){const{mergedClsPrefixRef:t,inlineThemeDisabled:r}=vr(e),i=bt("Layout","-layout-header",Vle,pw,e,t),n=re(()=>{const{common:{cubicBezierEaseInOut:o},self:s}=i.value,l={"--n-bezier":o};return e.inverted?(l["--n-color"]=s.headerColorInverted,l["--n-text-color"]=s.textColorInverted,l["--n-border-color"]=s.headerBorderColorInverted):(l["--n-color"]=s.headerColor,l["--n-text-color"]=s.textColor,l["--n-border-color"]=s.headerBorderColor),l}),a=r?Dr("layout-header",re(()=>e.inverted?"a":"b"),n,e):void 0;return{mergedClsPrefix:t,cssVars:r?void 0:n,themeClass:a==null?void 0:a.themeClass,onRender:a==null?void 0:a.onRender}},render(){var e;const{mergedClsPrefix:t}=this;return(e=this.onRender)===null||e===void 0||e.call(this),E("div",{class:[`${t}-layout-header`,this.themeClass,this.position&&`${t}-layout-header--${this.position}-positioned`,this.bordered&&`${t}-layout-header--bordered`],style:this.cssVars},this.$slots)}}),Wle=oe("layout-footer",`
 transition:
 box-shadow .3s var(--n-bezier),
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 color: var(--n-text-color);
 background-color: var(--n-color);
 box-sizing: border-box;
`,[xe("absolute-positioned",`
 position: absolute;
 left: 0;
 right: 0;
 bottom: 0;
 `),xe("bordered",`
 border-top: solid 1px var(--n-border-color);
 `)]),Gle=Object.assign(Object.assign({},bt.props),{inverted:Boolean,position:mw,bordered:Boolean}),Y6=je({name:"LayoutFooter",props:Gle,setup(e){const{mergedClsPrefixRef:t,inlineThemeDisabled:r}=vr(e),i=bt("Layout","-layout-footer",Wle,pw,e,t),n=re(()=>{const{common:{cubicBezierEaseInOut:o},self:s}=i.value,l={"--n-bezier":o};return e.inverted?(l["--n-color"]=s.footerColorInverted,l["--n-text-color"]=s.textColorInverted,l["--n-border-color"]=s.footerBorderColorInverted):(l["--n-color"]=s.footerColor,l["--n-text-color"]=s.textColor,l["--n-border-color"]=s.footerBorderColor),l}),a=r?Dr("layout-footer",re(()=>e.inverted?"a":"b"),n,e):void 0;return{mergedClsPrefix:t,cssVars:r?void 0:n,themeClass:a==null?void 0:a.themeClass,onRender:a==null?void 0:a.onRender}},render(){var e;const{mergedClsPrefix:t}=this;return(e=this.onRender)===null||e===void 0||e.call(this),E("div",{class:[`${t}-layout-footer`,this.themeClass,this.position&&`${t}-layout-footer--${this.position}-positioned`,this.bordered&&`${t}-layout-footer--bordered`],style:this.cssVars},this.$slots)}}),$le=oe("layout-sider",`
 flex-shrink: 0;
 box-sizing: border-box;
 position: relative;
 z-index: 1;
 color: var(--n-text-color);
 transition:
 color .3s var(--n-bezier),
 border-color .3s var(--n-bezier),
 min-width .3s var(--n-bezier),
 max-width .3s var(--n-bezier),
 transform .3s var(--n-bezier),
 background-color .3s var(--n-bezier);
 background-color: var(--n-color);
 display: flex;
 justify-content: flex-end;
`,[xe("bordered",[he("border",`
 content: "";
 position: absolute;
 top: 0;
 bottom: 0;
 width: 1px;
 background-color: var(--n-border-color);
 transition: background-color .3s var(--n-bezier);
 `)]),he("left-placement",[xe("bordered",[he("border",`
 right: 0;
 `)])]),xe("right-placement",`
 justify-content: flex-start;
 `,[xe("bordered",[he("border",`
 left: 0;
 `)]),xe("collapsed",[oe("layout-toggle-button",[oe("base-icon",`
 transform: rotate(180deg);
 `)]),oe("layout-toggle-bar",[ge("&:hover",[he("top",{transform:"rotate(-12deg) scale(1.15) translateY(-2px)"}),he("bottom",{transform:"rotate(12deg) scale(1.15) translateY(2px)"})])])]),oe("layout-toggle-button",`
 left: 0;
 transform: translateX(-50%) translateY(-50%);
 `,[oe("base-icon",`
 transform: rotate(0);
 `)]),oe("layout-toggle-bar",`
 left: -28px;
 transform: rotate(180deg);
 `,[ge("&:hover",[he("top",{transform:"rotate(12deg) scale(1.15) translateY(-2px)"}),he("bottom",{transform:"rotate(-12deg) scale(1.15) translateY(2px)"})])])]),xe("collapsed",[oe("layout-toggle-bar",[ge("&:hover",[he("top",{transform:"rotate(-12deg) scale(1.15) translateY(-2px)"}),he("bottom",{transform:"rotate(12deg) scale(1.15) translateY(2px)"})])]),oe("layout-toggle-button",[oe("base-icon",`
 transform: rotate(0);
 `)])]),oe("layout-toggle-button",`
 transition:
 color .3s var(--n-bezier),
 right .3s var(--n-bezier),
 left .3s var(--n-bezier),
 border-color .3s var(--n-bezier),
 background-color .3s var(--n-bezier);
 cursor: pointer;
 width: 24px;
 height: 24px;
 position: absolute;
 top: 50%;
 right: 0;
 border-radius: 50%;
 display: flex;
 align-items: center;
 justify-content: center;
 font-size: 18px;
 color: var(--n-toggle-button-icon-color);
 border: var(--n-toggle-button-border);
 background-color: var(--n-toggle-button-color);
 box-shadow: 0 2px 4px 0px rgba(0, 0, 0, .06);
 transform: translateX(50%) translateY(-50%);
 z-index: 1;
 `,[oe("base-icon",`
 transition: transform .3s var(--n-bezier);
 transform: rotate(180deg);
 `)]),oe("layout-toggle-bar",`
 cursor: pointer;
 height: 72px;
 width: 32px;
 position: absolute;
 top: calc(50% - 36px);
 right: -28px;
 `,[he("top, bottom",`
 position: absolute;
 width: 4px;
 border-radius: 2px;
 height: 38px;
 left: 14px;
 transition: 
 background-color .3s var(--n-bezier),
 transform .3s var(--n-bezier);
 `),he("bottom",`
 position: absolute;
 top: 34px;
 `),ge("&:hover",[he("top",{transform:"rotate(12deg) scale(1.15) translateY(-2px)"}),he("bottom",{transform:"rotate(-12deg) scale(1.15) translateY(2px)"})]),he("top, bottom",{backgroundColor:"var(--n-toggle-bar-color)"}),ge("&:hover",[he("top, bottom",{backgroundColor:"var(--n-toggle-bar-color-hover)"})])]),he("border",`
 position: absolute;
 top: 0;
 right: 0;
 bottom: 0;
 width: 1px;
 transition: background-color .3s var(--n-bezier);
 `),oe("layout-sider-scroll-container",`
 flex-grow: 1;
 flex-shrink: 0;
 box-sizing: border-box;
 height: 100%;
 opacity: 0;
 transition: opacity .3s var(--n-bezier);
 max-width: 100%;
 `),xe("show-content",[oe("layout-sider-scroll-container",{opacity:1})]),xe("absolute-positioned",`
 position: absolute;
 left: 0;
 top: 0;
 bottom: 0;
 `)]),qle=je({name:"LayoutToggleButton",props:{clsPrefix:{type:String,required:!0},onClick:Function},render(){const{clsPrefix:e}=this;return E("div",{class:`${e}-layout-toggle-button`,onClick:this.onClick},E(Bi,{clsPrefix:e},{default:()=>E($U,null)}))}}),Yle=je({props:{clsPrefix:{type:String,required:!0},onClick:Function},render(){const{clsPrefix:e}=this;return E("div",{onClick:this.onClick,class:`${e}-layout-toggle-bar`},E("div",{class:`${e}-layout-toggle-bar__top`}),E("div",{class:`${e}-layout-toggle-bar__bottom`}))}}),Xle={position:mw,bordered:Boolean,collapsedWidth:{type:Number,default:48},width:{type:[Number,String],default:272},contentClass:String,contentStyle:{type:[String,Object],default:""},collapseMode:{type:String,default:"transform"},collapsed:{type:Boolean,default:void 0},defaultCollapsed:Boolean,showCollapsedContent:{type:Boolean,default:!0},showTrigger:{type:[Boolean,String],default:!1},nativeScrollbar:{type:Boolean,default:!0},inverted:Boolean,scrollbarProps:Object,triggerClass:String,triggerStyle:[String,Object],collapsedTriggerClass:String,collapsedTriggerStyle:[String,Object],"onUpdate:collapsed":[Function,Array],onUpdateCollapsed:[Function,Array],onAfterEnter:Function,onAfterLeave:Function,onExpand:[Function,Array],onCollapse:[Function,Array],onScroll:Function},Kle=je({name:"LayoutSider",props:Object.assign(Object.assign({},bt.props),Xle),setup(e){const t=_t($6),r=me(null),i=me(null),n=re(()=>fs(l.value?e.collapsedWidth:e.width)),a=re(()=>e.collapseMode!=="transform"?{}:{minWidth:fs(e.width)}),o=re(()=>t?t.siderPlacement:"left"),s=me(e.defaultCollapsed),l=Hn(pt(e,"collapsed"),s);function c(S,w){if(e.nativeScrollbar){const{value:_}=r;_&&(w===void 0?_.scrollTo(S):_.scrollTo(S,w))}else{const{value:_}=i;_&&_.scrollTo(S,w)}}function u(){const{"onUpdate:collapsed":S,onUpdateCollapsed:w,onExpand:_,onCollapse:C}=e,{value:A}=l;w&&ct(w,!A),S&&ct(S,!A),s.value=!A,A?_&&ct(_):C&&ct(C)}let d=0,h=0;const f=S=>{var w;const _=S.target;d=_.scrollLeft,h=_.scrollTop,(w=e.onScroll)===null||w===void 0||w.call(e,S)};BT(()=>{if(e.nativeScrollbar){const S=r.value;S&&(S.scrollTop=h,S.scrollLeft=d)}}),xr(G6,{collapsedRef:l,collapseModeRef:pt(e,"collapseMode")});const{mergedClsPrefixRef:p,inlineThemeDisabled:v}=vr(e),m=bt("Layout","-layout-sider",$le,pw,e,p);function g(S){var w,_;S.propertyName==="max-width"&&(l.value?(w=e.onAfterLeave)===null||w===void 0||w.call(e):(_=e.onAfterEnter)===null||_===void 0||_.call(e))}const y={scrollTo:c},b=re(()=>{const{common:{cubicBezierEaseInOut:S},self:w}=m.value,{siderToggleButtonColor:_,siderToggleButtonBorder:C,siderToggleBarColor:A,siderToggleBarColorHover:M}=w,P={"--n-bezier":S,"--n-toggle-button-color":_,"--n-toggle-button-border":C,"--n-toggle-bar-color":A,"--n-toggle-bar-color-hover":M};return e.inverted?(P["--n-color"]=w.siderColorInverted,P["--n-text-color"]=w.textColorInverted,P["--n-border-color"]=w.siderBorderColorInverted,P["--n-toggle-button-icon-color"]=w.siderToggleButtonIconColorInverted,P.__invertScrollbar=w.__invertScrollbar):(P["--n-color"]=w.siderColor,P["--n-text-color"]=w.textColor,P["--n-border-color"]=w.siderBorderColor,P["--n-toggle-button-icon-color"]=w.siderToggleButtonIconColor),P}),x=v?Dr("layout-sider",re(()=>e.inverted?"a":"b"),b,e):void 0;return Object.assign({scrollableElRef:r,scrollbarInstRef:i,mergedClsPrefix:p,mergedTheme:m,styleMaxWidth:n,mergedCollapsed:l,scrollContainerStyle:a,siderPlacement:o,handleNativeElScroll:f,handleTransitionend:g,handleTriggerClick:u,inlineThemeDisabled:v,cssVars:b,themeClass:x==null?void 0:x.themeClass,onRender:x==null?void 0:x.onRender},y)},render(){var e;const{mergedClsPrefix:t,mergedCollapsed:r,showTrigger:i}=this;return(e=this.onRender)===null||e===void 0||e.call(this),E("aside",{class:[`${t}-layout-sider`,this.themeClass,`${t}-layout-sider--${this.position}-positioned`,`${t}-layout-sider--${this.siderPlacement}-placement`,this.bordered&&`${t}-layout-sider--bordered`,r&&`${t}-layout-sider--collapsed`,(!r||this.showCollapsedContent)&&`${t}-layout-sider--show-content`],onTransitionend:this.handleTransitionend,style:[this.inlineThemeDisabled?void 0:this.cssVars,{maxWidth:this.styleMaxWidth,width:fs(this.width)}]},this.nativeScrollbar?E("div",{class:[`${t}-layout-sider-scroll-container`,this.contentClass],onScroll:this.handleNativeElScroll,style:[this.scrollContainerStyle,{overflow:"auto"},this.contentStyle],ref:"scrollableElRef"},this.$slots):E(Sn,Object.assign({},this.scrollbarProps,{onScroll:this.onScroll,ref:"scrollbarInstRef",style:this.scrollContainerStyle,contentStyle:this.contentStyle,contentClass:this.contentClass,theme:this.mergedTheme.peers.Scrollbar,themeOverrides:this.mergedTheme.peerOverrides.Scrollbar,builtinThemeOverrides:this.inverted&&this.cssVars.__invertScrollbar==="true"?{colorHover:"rgba(255, 255, 255, .4)",color:"rgba(255, 255, 255, .3)"}:void 0}),this.$slots),i?i==="bar"?E(Yle,{clsPrefix:t,class:r?this.collapsedTriggerClass:this.triggerClass,style:r?this.collapsedTriggerStyle:this.triggerStyle,onClick:this.handleTriggerClick}):E(qle,{clsPrefix:t,class:r?this.collapsedTriggerClass:this.triggerClass,style:r?this.collapsedTriggerStyle:this.triggerStyle,onClick:this.handleTriggerClick}):null,this.bordered?E("div",{class:`${t}-layout-sider__border`}):null)}}),l0="n-menu",yP="n-submenu",bP="n-menu-item-group",iy=8;function xP(e){const t=_t(l0),{props:r,mergedCollapsedRef:i}=t,n=_t(yP,null),a=_t(bP,null),o=re(()=>r.mode==="horizontal"),s=re(()=>o.value?r.dropdownPlacement:"tmNodes"in e?"right-start":"right"),l=re(()=>{var h;return Math.max((h=r.collapsedIconSize)!==null&&h!==void 0?h:r.iconSize,r.iconSize)}),c=re(()=>{var h;return!o.value&&e.root&&i.value&&(h=r.collapsedIconSize)!==null&&h!==void 0?h:r.iconSize}),u=re(()=>{if(o.value)return;const{collapsedWidth:h,indent:f,rootIndent:p}=r,{root:v,isGroup:m}=e,g=p===void 0?f:p;return v?i.value?h/2-l.value/2:g:a&&typeof a.paddingLeftRef.value=="number"?f/2+a.paddingLeftRef.value:n&&typeof n.paddingLeftRef.value=="number"?(m?f/2:f)+n.paddingLeftRef.value:0}),d=re(()=>{const{collapsedWidth:h,indent:f,rootIndent:p}=r,{value:v}=l,{root:m}=e;return o.value||!m||!i.value?iy:(p===void 0?f:p)+v+iy-(h+v)/2});return{dropdownPlacement:s,activeIconSize:c,maxIconSize:l,paddingLeft:u,iconMarginRight:d,NMenu:t,NSubmenu:n}}const wP={internalKey:{type:[String,Number],required:!0},root:Boolean,isGroup:Boolean,level:{type:Number,required:!0},title:[String,Function],extra:[String,Function]},X6=Object.assign(Object.assign({},wP),{tmNode:{type:Object,required:!0},tmNodes:{type:Array,required:!0}}),Qle=je({name:"MenuOptionGroup",props:X6,setup(e){xr(yP,null);const t=xP(e);xr(bP,{paddingLeftRef:t.paddingLeft});const{mergedClsPrefixRef:r,props:i}=_t(l0);return function(){const{value:n}=r,a=t.paddingLeft.value,{nodeProps:o}=i,s=o==null?void 0:o(e.tmNode.rawNode);return E("div",{class:`${n}-menu-item-group`,role:"group"},E("div",Object.assign({},s,{class:[`${n}-menu-item-group-title`,s==null?void 0:s.class],style:[(s==null?void 0:s.style)||"",a!==void 0?`padding-left: ${a}px;`:""]}),Fn(e.title),e.extra?E(mr,null," ",Fn(e.extra)):null),E("div",null,e.tmNodes.map(l=>SP(l,i))))}}}),K6=je({name:"MenuOptionContent",props:{collapsed:Boolean,disabled:Boolean,title:[String,Function],icon:Function,extra:[String,Function],showArrow:Boolean,childActive:Boolean,hover:Boolean,paddingLeft:Number,selected:Boolean,maxIconSize:{type:Number,required:!0},activeIconSize:{type:Number,required:!0},iconMarginRight:{type:Number,required:!0},clsPrefix:{type:String,required:!0},onClick:Function,tmNode:{type:Object,required:!0},isEllipsisPlaceholder:Boolean},setup(e){const{props:t}=_t(l0);return{menuProps:t,style:re(()=>{const{paddingLeft:r}=e;return{paddingLeft:r&&`${r}px`}}),iconStyle:re(()=>{const{maxIconSize:r,activeIconSize:i,iconMarginRight:n}=e;return{width:`${r}px`,height:`${r}px`,fontSize:`${i}px`,marginRight:`${n}px`}})}},render(){const{clsPrefix:e,tmNode:t,menuProps:{renderIcon:r,renderLabel:i,renderExtra:n,expandIcon:a}}=this,o=r?r(t.rawNode):Fn(this.icon);return E("div",{onClick:s=>{var l;(l=this.onClick)===null||l===void 0||l.call(this,s)},role:"none",class:[`${e}-menu-item-content`,{[`${e}-menu-item-content--selected`]:this.selected,[`${e}-menu-item-content--collapsed`]:this.collapsed,[`${e}-menu-item-content--child-active`]:this.childActive,[`${e}-menu-item-content--disabled`]:this.disabled,[`${e}-menu-item-content--hover`]:this.hover}],style:this.style},o&&E("div",{class:`${e}-menu-item-content__icon`,style:this.iconStyle,role:"none"},[o]),E("div",{class:`${e}-menu-item-content-header`,role:"none"},this.isEllipsisPlaceholder?this.title:i?i(t.rawNode):Fn(this.title),this.extra||n?E("span",{class:`${e}-menu-item-content-header__extra`}," ",n?n(t.rawNode):Fn(this.extra)):null),this.showArrow?E(Bi,{ariaHidden:!0,class:`${e}-menu-item-content__arrow`,clsPrefix:e},{default:()=>a?a(t.rawNode):E(Rre,null)}):null)}}),Q6=Object.assign(Object.assign({},wP),{rawNodes:{type:Array,default:()=>[]},tmNodes:{type:Array,default:()=>[]},tmNode:{type:Object,required:!0},disabled:Boolean,icon:Function,onClick:Function,domId:String,virtualChildActive:{type:Boolean,default:void 0},isEllipsisPlaceholder:Boolean}),VA=je({name:"Submenu",props:Q6,setup(e){const t=xP(e),{NMenu:r,NSubmenu:i}=t,{props:n,mergedCollapsedRef:a,mergedThemeRef:o}=r,s=re(()=>{const{disabled:h}=e;return i!=null&&i.mergedDisabledRef.value||n.disabled?!0:h}),l=me(!1);xr(yP,{paddingLeftRef:t.paddingLeft,mergedDisabledRef:s}),xr(bP,null);function c(){const{onClick:h}=e;h&&h()}function u(){s.value||(a.value||r.toggleExpand(e.internalKey),c())}function d(h){l.value=h}return{menuProps:n,mergedTheme:o,doSelect:r.doSelect,inverted:r.invertedRef,isHorizontal:r.isHorizontalRef,mergedClsPrefix:r.mergedClsPrefixRef,maxIconSize:t.maxIconSize,activeIconSize:t.activeIconSize,iconMarginRight:t.iconMarginRight,dropdownPlacement:t.dropdownPlacement,dropdownShow:l,paddingLeft:t.paddingLeft,mergedDisabled:s,mergedValue:r.mergedValueRef,childActive:qi(()=>{var h;return(h=e.virtualChildActive)!==null&&h!==void 0?h:r.activePathRef.value.includes(e.internalKey)}),collapsed:re(()=>n.mode==="horizontal"?!1:a.value?!0:!r.mergedExpandedKeysRef.value.includes(e.internalKey)),dropdownEnabled:re(()=>!s.value&&(n.mode==="horizontal"||a.value)),handlePopoverShowChange:d,handleClick:u}},render(){var e;const{mergedClsPrefix:t,menuProps:{renderIcon:r,renderLabel:i}}=this,n=()=>{const{isHorizontal:o,paddingLeft:s,collapsed:l,mergedDisabled:c,maxIconSize:u,activeIconSize:d,title:h,childActive:f,icon:p,handleClick:v,menuProps:{nodeProps:m},dropdownShow:g,iconMarginRight:y,tmNode:b,mergedClsPrefix:x,isEllipsisPlaceholder:S,extra:w}=this,_=m==null?void 0:m(b.rawNode);return E("div",Object.assign({},_,{class:[`${x}-menu-item`,_==null?void 0:_.class],role:"menuitem"}),E(K6,{tmNode:b,paddingLeft:s,collapsed:l,disabled:c,iconMarginRight:y,maxIconSize:u,activeIconSize:d,title:h,extra:w,showArrow:!o,childActive:f,clsPrefix:x,icon:p,hover:g,onClick:v,isEllipsisPlaceholder:S}))},a=()=>E(iP,null,{default:()=>{const{tmNodes:o,collapsed:s}=this;return s?null:E("div",{class:`${t}-submenu-children`,role:"menu"},o.map(l=>SP(l,this.menuProps)))}});return this.root?E(bae,Object.assign({size:"large",trigger:"hover"},(e=this.menuProps)===null||e===void 0?void 0:e.dropdownProps,{themeOverrides:this.mergedTheme.peerOverrides.Dropdown,theme:this.mergedTheme.peers.Dropdown,builtinThemeOverrides:{fontSizeLarge:"14px",optionIconSizeLarge:"18px"},value:this.mergedValue,disabled:!this.dropdownEnabled,placement:this.dropdownPlacement,keyField:this.menuProps.keyField,labelField:this.menuProps.labelField,childrenField:this.menuProps.childrenField,onUpdateShow:this.handlePopoverShowChange,options:this.rawNodes,onSelect:this.doSelect,inverted:this.inverted,renderIcon:r,renderLabel:i}),{default:()=>E("div",{class:`${t}-submenu`,role:"menu","aria-expanded":!this.collapsed,id:this.domId},n(),this.isHorizontal?null:a())}):E("div",{class:`${t}-submenu`,role:"menu","aria-expanded":!this.collapsed,id:this.domId},n(),a())}}),Z6=Object.assign(Object.assign({},wP),{tmNode:{type:Object,required:!0},disabled:Boolean,icon:Function,onClick:Function}),Zle=je({name:"MenuOption",props:Z6,setup(e){const t=xP(e),{NSubmenu:r,NMenu:i}=t,{props:n,mergedClsPrefixRef:a,mergedCollapsedRef:o}=i,s=r?r.mergedDisabledRef:{value:!1},l=re(()=>s.value||e.disabled);function c(d){const{onClick:h}=e;h&&h(d)}function u(d){l.value||(i.doSelect(e.internalKey,e.tmNode.rawNode),c(d))}return{mergedClsPrefix:a,dropdownPlacement:t.dropdownPlacement,paddingLeft:t.paddingLeft,iconMarginRight:t.iconMarginRight,maxIconSize:t.maxIconSize,activeIconSize:t.activeIconSize,mergedTheme:i.mergedThemeRef,menuProps:n,dropdownEnabled:qi(()=>e.root&&o.value&&n.mode!=="horizontal"&&!l.value),selected:qi(()=>i.mergedValueRef.value===e.internalKey),mergedDisabled:l,handleClick:u}},render(){const{mergedClsPrefix:e,mergedTheme:t,tmNode:r,menuProps:{renderLabel:i,nodeProps:n}}=this,a=n==null?void 0:n(r.rawNode);return E("div",Object.assign({},a,{role:"menuitem",class:[`${e}-menu-item`,a==null?void 0:a.class]}),E(aae,{theme:t.peers.Tooltip,themeOverrides:t.peerOverrides.Tooltip,trigger:"hover",placement:this.dropdownPlacement,disabled:!this.dropdownEnabled||this.title===void 0,internalExtraClass:["menu-tooltip"]},{default:()=>i?i(r.rawNode):Fn(this.title),trigger:()=>E(K6,{tmNode:r,clsPrefix:e,paddingLeft:this.paddingLeft,iconMarginRight:this.iconMarginRight,maxIconSize:this.maxIconSize,activeIconSize:this.activeIconSize,selected:this.selected,title:this.title,extra:this.extra,disabled:this.mergedDisabled,icon:this.icon,onClick:this.handleClick})}))}}),Jle=je({name:"MenuDivider",setup(){const e=_t(l0),{mergedClsPrefixRef:t,isHorizontalRef:r}=e;return()=>r.value?null:E("div",{class:`${t.value}-menu-divider`})}}),ece=cg(X6),tce=cg(Z6),rce=cg(Q6);function HA(e){return e.type==="divider"||e.type==="render"}function ice(e){return e.type==="divider"}function SP(e,t){const{rawNode:r}=e,{show:i}=r;if(i===!1)return null;if(HA(r))return ice(r)?E(Jle,Object.assign({key:e.key},r.props)):null;const{labelField:n}=t,{key:a,level:o,isGroup:s}=e,l=Object.assign(Object.assign({},r),{title:r.title||r[n],extra:r.titleExtra||r.extra,key:a,internalKey:a,level:o,root:o===0,isGroup:s});return e.children?e.isGroup?E(Qle,zv(l,ece,{tmNode:e,tmNodes:e.children,key:a})):E(VA,zv(l,rce,{key:a,rawNodes:r[t.childrenField],tmNodes:e.children,tmNode:e})):E(Zle,zv(l,tce,{key:a,tmNode:e}))}const jR=[ge("&::before","background-color: var(--n-item-color-hover);"),he("arrow",`
 color: var(--n-arrow-color-hover);
 `),he("icon",`
 color: var(--n-item-icon-color-hover);
 `),oe("menu-item-content-header",`
 color: var(--n-item-text-color-hover);
 `,[ge("a",`
 color: var(--n-item-text-color-hover);
 `),he("extra",`
 color: var(--n-item-text-color-hover);
 `)])],VR=[he("icon",`
 color: var(--n-item-icon-color-hover-horizontal);
 `),oe("menu-item-content-header",`
 color: var(--n-item-text-color-hover-horizontal);
 `,[ge("a",`
 color: var(--n-item-text-color-hover-horizontal);
 `),he("extra",`
 color: var(--n-item-text-color-hover-horizontal);
 `)])],nce=ge([oe("menu",`
 background-color: var(--n-color);
 color: var(--n-item-text-color);
 overflow: hidden;
 transition: background-color .3s var(--n-bezier);
 box-sizing: border-box;
 font-size: var(--n-font-size);
 padding-bottom: 6px;
 `,[xe("horizontal",`
 max-width: 100%;
 width: 100%;
 display: flex;
 overflow: hidden;
 padding-bottom: 0;
 `,[oe("submenu","margin: 0;"),oe("menu-item","margin: 0;"),oe("menu-item-content",`
 padding: 0 20px;
 border-bottom: 2px solid #0000;
 `,[ge("&::before","display: none;"),xe("selected","border-bottom: 2px solid var(--n-border-color-horizontal)")]),oe("menu-item-content",[xe("selected",[he("icon","color: var(--n-item-icon-color-active-horizontal);"),oe("menu-item-content-header",`
 color: var(--n-item-text-color-active-horizontal);
 `,[ge("a","color: var(--n-item-text-color-active-horizontal);"),he("extra","color: var(--n-item-text-color-active-horizontal);")])]),xe("child-active",`
 border-bottom: 2px solid var(--n-border-color-horizontal);
 `,[oe("menu-item-content-header",`
 color: var(--n-item-text-color-child-active-horizontal);
 `,[ge("a",`
 color: var(--n-item-text-color-child-active-horizontal);
 `),he("extra",`
 color: var(--n-item-text-color-child-active-horizontal);
 `)]),he("icon",`
 color: var(--n-item-icon-color-child-active-horizontal);
 `)]),br("disabled",[br("selected, child-active",[ge("&:focus-within",VR)]),xe("selected",[ad(null,[he("icon","color: var(--n-item-icon-color-active-hover-horizontal);"),oe("menu-item-content-header",`
 color: var(--n-item-text-color-active-hover-horizontal);
 `,[ge("a","color: var(--n-item-text-color-active-hover-horizontal);"),he("extra","color: var(--n-item-text-color-active-hover-horizontal);")])])]),xe("child-active",[ad(null,[he("icon","color: var(--n-item-icon-color-child-active-hover-horizontal);"),oe("menu-item-content-header",`
 color: var(--n-item-text-color-child-active-hover-horizontal);
 `,[ge("a","color: var(--n-item-text-color-child-active-hover-horizontal);"),he("extra","color: var(--n-item-text-color-child-active-hover-horizontal);")])])]),ad("border-bottom: 2px solid var(--n-border-color-horizontal);",VR)]),oe("menu-item-content-header",[ge("a","color: var(--n-item-text-color-horizontal);")])])]),br("responsive",[oe("menu-item-content-header",`
 overflow: hidden;
 text-overflow: ellipsis;
 `)]),xe("collapsed",[oe("menu-item-content",[xe("selected",[ge("&::before",`
 background-color: var(--n-item-color-active-collapsed) !important;
 `)]),oe("menu-item-content-header","opacity: 0;"),he("arrow","opacity: 0;"),he("icon","color: var(--n-item-icon-color-collapsed);")])]),oe("menu-item",`
 height: var(--n-item-height);
 margin-top: 6px;
 position: relative;
 `),oe("menu-item-content",`
 box-sizing: border-box;
 line-height: 1.75;
 height: 100%;
 display: grid;
 grid-template-areas: "icon content arrow";
 grid-template-columns: auto 1fr auto;
 align-items: center;
 cursor: pointer;
 position: relative;
 padding-right: 18px;
 transition:
 background-color .3s var(--n-bezier),
 padding-left .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 `,[ge("> *","z-index: 1;"),ge("&::before",`
 z-index: auto;
 content: "";
 background-color: #0000;
 position: absolute;
 left: 8px;
 right: 8px;
 top: 0;
 bottom: 0;
 pointer-events: none;
 border-radius: var(--n-border-radius);
 transition: background-color .3s var(--n-bezier);
 `),xe("disabled",`
 opacity: .45;
 cursor: not-allowed;
 `),xe("collapsed",[he("arrow","transform: rotate(0);")]),xe("selected",[ge("&::before","background-color: var(--n-item-color-active);"),he("arrow","color: var(--n-arrow-color-active);"),he("icon","color: var(--n-item-icon-color-active);"),oe("menu-item-content-header",`
 color: var(--n-item-text-color-active);
 `,[ge("a","color: var(--n-item-text-color-active);"),he("extra","color: var(--n-item-text-color-active);")])]),xe("child-active",[oe("menu-item-content-header",`
 color: var(--n-item-text-color-child-active);
 `,[ge("a",`
 color: var(--n-item-text-color-child-active);
 `),he("extra",`
 color: var(--n-item-text-color-child-active);
 `)]),he("arrow",`
 color: var(--n-arrow-color-child-active);
 `),he("icon",`
 color: var(--n-item-icon-color-child-active);
 `)]),br("disabled",[br("selected, child-active",[ge("&:focus-within",jR)]),xe("selected",[ad(null,[he("arrow","color: var(--n-arrow-color-active-hover);"),he("icon","color: var(--n-item-icon-color-active-hover);"),oe("menu-item-content-header",`
 color: var(--n-item-text-color-active-hover);
 `,[ge("a","color: var(--n-item-text-color-active-hover);"),he("extra","color: var(--n-item-text-color-active-hover);")])])]),xe("child-active",[ad(null,[he("arrow","color: var(--n-arrow-color-child-active-hover);"),he("icon","color: var(--n-item-icon-color-child-active-hover);"),oe("menu-item-content-header",`
 color: var(--n-item-text-color-child-active-hover);
 `,[ge("a","color: var(--n-item-text-color-child-active-hover);"),he("extra","color: var(--n-item-text-color-child-active-hover);")])])]),xe("selected",[ad(null,[ge("&::before","background-color: var(--n-item-color-active-hover);")])]),ad(null,jR)]),he("icon",`
 grid-area: icon;
 color: var(--n-item-icon-color);
 transition:
 color .3s var(--n-bezier),
 font-size .3s var(--n-bezier),
 margin-right .3s var(--n-bezier);
 box-sizing: content-box;
 display: inline-flex;
 align-items: center;
 justify-content: center;
 `),he("arrow",`
 grid-area: arrow;
 font-size: 16px;
 color: var(--n-arrow-color);
 transform: rotate(180deg);
 opacity: 1;
 transition:
 color .3s var(--n-bezier),
 transform 0.2s var(--n-bezier),
 opacity 0.2s var(--n-bezier);
 `),oe("menu-item-content-header",`
 grid-area: content;
 transition:
 color .3s var(--n-bezier),
 opacity .3s var(--n-bezier);
 opacity: 1;
 white-space: nowrap;
 color: var(--n-item-text-color);
 `,[ge("a",`
 outline: none;
 text-decoration: none;
 transition: color .3s var(--n-bezier);
 color: var(--n-item-text-color);
 `,[ge("&::before",`
 content: "";
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 `)]),he("extra",`
 font-size: .93em;
 color: var(--n-group-text-color);
 transition: color .3s var(--n-bezier);
 `)])]),oe("submenu",`
 cursor: pointer;
 position: relative;
 margin-top: 6px;
 `,[oe("menu-item-content",`
 height: var(--n-item-height);
 `),oe("submenu-children",`
 overflow: hidden;
 padding: 0;
 `,[n6({duration:".2s"})])]),oe("menu-item-group",[oe("menu-item-group-title",`
 margin-top: 6px;
 color: var(--n-group-text-color);
 cursor: default;
 font-size: .93em;
 height: 36px;
 display: flex;
 align-items: center;
 transition:
 padding-left .3s var(--n-bezier),
 color .3s var(--n-bezier);
 `)])]),oe("menu-tooltip",[ge("a",`
 color: inherit;
 text-decoration: none;
 `)]),oe("menu-divider",`
 transition: background-color .3s var(--n-bezier);
 background-color: var(--n-divider-color);
 height: 1px;
 margin: 6px 18px;
 `)]);function ad(e,t){return[xe("hover",e,t),ge("&:hover",e,t)]}const ace=Object.assign(Object.assign({},bt.props),{options:{type:Array,default:()=>[]},collapsed:{type:Boolean,default:void 0},collapsedWidth:{type:Number,default:48},iconSize:{type:Number,default:20},collapsedIconSize:{type:Number,default:24},rootIndent:Number,indent:{type:Number,default:32},labelField:{type:String,default:"label"},keyField:{type:String,default:"key"},childrenField:{type:String,default:"children"},disabledField:{type:String,default:"disabled"},defaultExpandAll:Boolean,defaultExpandedKeys:Array,expandedKeys:Array,value:[String,Number],defaultValue:{type:[String,Number],default:null},mode:{type:String,default:"vertical"},watchProps:{type:Array,default:void 0},disabled:Boolean,show:{type:Boolean,default:!0},inverted:Boolean,"onUpdate:expandedKeys":[Function,Array],onUpdateExpandedKeys:[Function,Array],onUpdateValue:[Function,Array],"onUpdate:value":[Function,Array],expandIcon:Function,renderIcon:Function,renderLabel:Function,renderExtra:Function,dropdownProps:Object,accordion:Boolean,nodeProps:Function,dropdownPlacement:{type:String,default:"bottom"},responsive:Boolean,items:Array,onOpenNamesChange:[Function,Array],onSelect:[Function,Array],onExpandedNamesChange:[Function,Array],expandedNames:Array,defaultExpandedNames:Array}),oce=je({name:"Menu",props:ace,setup(e){const{mergedClsPrefixRef:t,inlineThemeDisabled:r}=vr(e),i=bt("Menu","-menu",nce,ble,e,t),n=_t(G6,null),a=re(()=>{var X;const{collapsed:W}=e;if(W!==void 0)return W;if(n){const{collapseModeRef:q,collapsedRef:$}=n;if(q.value==="width")return(X=$.value)!==null&&X!==void 0?X:!1}return!1}),o=re(()=>{const{keyField:X,childrenField:W,disabledField:q}=e;return rp(e.items||e.options,{getIgnored($){return HA($)},getChildren($){return $[W]},getDisabled($){return $[q]},getKey($){var le;return(le=$[X])!==null&&le!==void 0?le:$.name}})}),s=re(()=>new Set(o.value.treeNodes.map(X=>X.key))),{watchProps:l}=e,c=me(null);l!=null&&l.includes("defaultValue")?no(()=>{c.value=e.defaultValue}):c.value=e.defaultValue;const u=pt(e,"value"),d=Hn(u,c),h=me([]),f=()=>{h.value=e.defaultExpandAll?o.value.getNonLeafKeys():e.defaultExpandedNames||e.defaultExpandedKeys||o.value.getPath(d.value,{includeSelf:!1}).keyPath};l!=null&&l.includes("defaultExpandedKeys")?no(f):f();const p=Sp(e,["expandedNames","expandedKeys"]),v=Hn(p,h),m=re(()=>o.value.treeNodes),g=re(()=>o.value.getPath(d.value).keyPath);xr(l0,{props:e,mergedCollapsedRef:a,mergedThemeRef:i,mergedValueRef:d,mergedExpandedKeysRef:v,activePathRef:g,mergedClsPrefixRef:t,isHorizontalRef:re(()=>e.mode==="horizontal"),invertedRef:pt(e,"inverted"),doSelect:y,toggleExpand:x});function y(X,W){const{"onUpdate:value":q,onUpdateValue:$,onSelect:le}=e;$&&ct($,X,W),q&&ct(q,X,W),le&&ct(le,X,W),c.value=X}function b(X){const{"onUpdate:expandedKeys":W,onUpdateExpandedKeys:q,onExpandedNamesChange:$,onOpenNamesChange:le}=e;W&&ct(W,X),q&&ct(q,X),$&&ct($,X),le&&ct(le,X),h.value=X}function x(X){const W=Array.from(v.value),q=W.findIndex($=>$===X);if(~q)W.splice(q,1);else{if(e.accordion&&s.value.has(X)){const $=W.findIndex(le=>s.value.has(le));$>-1&&W.splice($,1)}W.push(X)}b(W)}const S=X=>{const W=o.value.getPath(X??d.value,{includeSelf:!1}).keyPath;if(!W.length)return;const q=Array.from(v.value),$=new Set([...q,...W]);e.accordion&&s.value.forEach(le=>{$.has(le)&&!W.includes(le)&&$.delete(le)}),b(Array.from($))},w=re(()=>{const{inverted:X}=e,{common:{cubicBezierEaseInOut:W},self:q}=i.value,{borderRadius:$,borderColorHorizontal:le,fontSize:ee,itemHeight:Q,dividerColor:ne}=q,V={"--n-divider-color":ne,"--n-bezier":W,"--n-font-size":ee,"--n-border-color-horizontal":le,"--n-border-radius":$,"--n-item-height":Q};return X?(V["--n-group-text-color"]=q.groupTextColorInverted,V["--n-color"]=q.colorInverted,V["--n-item-text-color"]=q.itemTextColorInverted,V["--n-item-text-color-hover"]=q.itemTextColorHoverInverted,V["--n-item-text-color-active"]=q.itemTextColorActiveInverted,V["--n-item-text-color-child-active"]=q.itemTextColorChildActiveInverted,V["--n-item-text-color-child-active-hover"]=q.itemTextColorChildActiveInverted,V["--n-item-text-color-active-hover"]=q.itemTextColorActiveHoverInverted,V["--n-item-icon-color"]=q.itemIconColorInverted,V["--n-item-icon-color-hover"]=q.itemIconColorHoverInverted,V["--n-item-icon-color-active"]=q.itemIconColorActiveInverted,V["--n-item-icon-color-active-hover"]=q.itemIconColorActiveHoverInverted,V["--n-item-icon-color-child-active"]=q.itemIconColorChildActiveInverted,V["--n-item-icon-color-child-active-hover"]=q.itemIconColorChildActiveHoverInverted,V["--n-item-icon-color-collapsed"]=q.itemIconColorCollapsedInverted,V["--n-item-text-color-horizontal"]=q.itemTextColorHorizontalInverted,V["--n-item-text-color-hover-horizontal"]=q.itemTextColorHoverHorizontalInverted,V["--n-item-text-color-active-horizontal"]=q.itemTextColorActiveHorizontalInverted,V["--n-item-text-color-child-active-horizontal"]=q.itemTextColorChildActiveHorizontalInverted,V["--n-item-text-color-child-active-hover-horizontal"]=q.itemTextColorChildActiveHoverHorizontalInverted,V["--n-item-text-color-active-hover-horizontal"]=q.itemTextColorActiveHoverHorizontalInverted,V["--n-item-icon-color-horizontal"]=q.itemIconColorHorizontalInverted,V["--n-item-icon-color-hover-horizontal"]=q.itemIconColorHoverHorizontalInverted,V["--n-item-icon-color-active-horizontal"]=q.itemIconColorActiveHorizontalInverted,V["--n-item-icon-color-active-hover-horizontal"]=q.itemIconColorActiveHoverHorizontalInverted,V["--n-item-icon-color-child-active-horizontal"]=q.itemIconColorChildActiveHorizontalInverted,V["--n-item-icon-color-child-active-hover-horizontal"]=q.itemIconColorChildActiveHoverHorizontalInverted,V["--n-arrow-color"]=q.arrowColorInverted,V["--n-arrow-color-hover"]=q.arrowColorHoverInverted,V["--n-arrow-color-active"]=q.arrowColorActiveInverted,V["--n-arrow-color-active-hover"]=q.arrowColorActiveHoverInverted,V["--n-arrow-color-child-active"]=q.arrowColorChildActiveInverted,V["--n-arrow-color-child-active-hover"]=q.arrowColorChildActiveHoverInverted,V["--n-item-color-hover"]=q.itemColorHoverInverted,V["--n-item-color-active"]=q.itemColorActiveInverted,V["--n-item-color-active-hover"]=q.itemColorActiveHoverInverted,V["--n-item-color-active-collapsed"]=q.itemColorActiveCollapsedInverted):(V["--n-group-text-color"]=q.groupTextColor,V["--n-color"]=q.color,V["--n-item-text-color"]=q.itemTextColor,V["--n-item-text-color-hover"]=q.itemTextColorHover,V["--n-item-text-color-active"]=q.itemTextColorActive,V["--n-item-text-color-child-active"]=q.itemTextColorChildActive,V["--n-item-text-color-child-active-hover"]=q.itemTextColorChildActiveHover,V["--n-item-text-color-active-hover"]=q.itemTextColorActiveHover,V["--n-item-icon-color"]=q.itemIconColor,V["--n-item-icon-color-hover"]=q.itemIconColorHover,V["--n-item-icon-color-active"]=q.itemIconColorActive,V["--n-item-icon-color-active-hover"]=q.itemIconColorActiveHover,V["--n-item-icon-color-child-active"]=q.itemIconColorChildActive,V["--n-item-icon-color-child-active-hover"]=q.itemIconColorChildActiveHover,V["--n-item-icon-color-collapsed"]=q.itemIconColorCollapsed,V["--n-item-text-color-horizontal"]=q.itemTextColorHorizontal,V["--n-item-text-color-hover-horizontal"]=q.itemTextColorHoverHorizontal,V["--n-item-text-color-active-horizontal"]=q.itemTextColorActiveHorizontal,V["--n-item-text-color-child-active-horizontal"]=q.itemTextColorChildActiveHorizontal,V["--n-item-text-color-child-active-hover-horizontal"]=q.itemTextColorChildActiveHoverHorizontal,V["--n-item-text-color-active-hover-horizontal"]=q.itemTextColorActiveHoverHorizontal,V["--n-item-icon-color-horizontal"]=q.itemIconColorHorizontal,V["--n-item-icon-color-hover-horizontal"]=q.itemIconColorHoverHorizontal,V["--n-item-icon-color-active-horizontal"]=q.itemIconColorActiveHorizontal,V["--n-item-icon-color-active-hover-horizontal"]=q.itemIconColorActiveHoverHorizontal,V["--n-item-icon-color-child-active-horizontal"]=q.itemIconColorChildActiveHorizontal,V["--n-item-icon-color-child-active-hover-horizontal"]=q.itemIconColorChildActiveHoverHorizontal,V["--n-arrow-color"]=q.arrowColor,V["--n-arrow-color-hover"]=q.arrowColorHover,V["--n-arrow-color-active"]=q.arrowColorActive,V["--n-arrow-color-active-hover"]=q.arrowColorActiveHover,V["--n-arrow-color-child-active"]=q.arrowColorChildActive,V["--n-arrow-color-child-active-hover"]=q.arrowColorChildActiveHover,V["--n-item-color-hover"]=q.itemColorHover,V["--n-item-color-active"]=q.itemColorActive,V["--n-item-color-active-hover"]=q.itemColorActiveHover,V["--n-item-color-active-collapsed"]=q.itemColorActiveCollapsed),V}),_=r?Dr("menu",re(()=>e.inverted?"a":"b"),w,e):void 0,C=oh(),A=me(null),M=me(null);let P=!0;const T=()=>{var X;P?P=!1:(X=A.value)===null||X===void 0||X.sync({showAllItemsBeforeCalculate:!0})};function R(){return document.getElementById(C)}const z=me(-1);function F(X){z.value=e.options.length-X}function H(X){X||(z.value=-1)}const N=re(()=>{const X=z.value;return{children:X===-1?[]:e.options.slice(X)}}),U=re(()=>{const{childrenField:X,disabledField:W,keyField:q}=e;return rp([N.value],{getIgnored($){return HA($)},getChildren($){return $[X]},getDisabled($){return $[W]},getKey($){var le;return(le=$[q])!==null&&le!==void 0?le:$.name}})}),ie=re(()=>rp([{}]).treeNodes[0]);function te(){var X;if(z.value===-1)return E(VA,{root:!0,level:0,key:"__ellpisisGroupPlaceholder__",internalKey:"__ellpisisGroupPlaceholder__",title:"",tmNode:ie.value,domId:C,isEllipsisPlaceholder:!0});const W=U.value.treeNodes[0],q=g.value,$=!!(!((X=W.children)===null||X===void 0)&&X.some(le=>q.includes(le.key)));return E(VA,{level:0,root:!0,key:"__ellpisisGroup__",internalKey:"__ellpisisGroup__",title:"",virtualChildActive:$,tmNode:W,domId:C,rawNodes:W.rawNode.children||[],tmNodes:W.children||[],isEllipsisPlaceholder:!0})}return{mergedClsPrefix:t,controlledExpandedKeys:p,uncontrolledExpanededKeys:h,mergedExpandedKeys:v,uncontrolledValue:c,mergedValue:d,activePath:g,tmNodes:m,mergedTheme:i,mergedCollapsed:a,cssVars:r?void 0:w,themeClass:_==null?void 0:_.themeClass,overflowRef:A,counterRef:M,updateCounter:()=>{},onResize:T,onUpdateOverflow:H,onUpdateCount:F,renderCounter:te,getCounter:R,onRender:_==null?void 0:_.onRender,showOption:S,deriveResponsiveState:T}},render(){const{mergedClsPrefix:e,mode:t,themeClass:r,onRender:i}=this;i==null||i();const n=()=>this.tmNodes.map(l=>SP(l,this.$props)),o=t==="horizontal"&&this.responsive,s=()=>E("div",{role:t==="horizontal"?"menubar":"menu",class:[`${e}-menu`,r,`${e}-menu--${t}`,o&&`${e}-menu--responsive`,this.mergedCollapsed&&`${e}-menu--collapsed`],style:this.cssVars},o?E(I2,{ref:"overflowRef",onUpdateOverflow:this.onUpdateOverflow,getCounter:this.getCounter,onUpdateCount:this.onUpdateCount,updateCounter:this.updateCounter,style:{width:"100%",display:"flex",overflow:"hidden"}},{default:n,counter:this.renderCounter}):n());return o?E(nl,{onResize:this.onResize},{default:s}):s()}}),J6={icon:Function,type:{type:String,default:"info"},content:[String,Number,Function],showIcon:{type:Boolean,default:!0},closable:Boolean,keepAliveOnHover:Boolean,onClose:Function,onMouseenter:Function,onMouseleave:Function},ej="n-message-api",tj="n-message-provider",sce=ge([oe("message-wrapper",`
 margin: var(--n-margin);
 z-index: 0;
 transform-origin: top center;
 display: flex;
 `,[n6({overflow:"visible",originalTransition:"transform .3s var(--n-bezier)",enterToProps:{transform:"scale(1)"},leaveToProps:{transform:"scale(0.85)"}})]),oe("message",`
 box-sizing: border-box;
 display: flex;
 align-items: center;
 transition:
 color .3s var(--n-bezier),
 box-shadow .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 opacity .3s var(--n-bezier),
 transform .3s var(--n-bezier),
 margin-bottom .3s var(--n-bezier);
 padding: var(--n-padding);
 border-radius: var(--n-border-radius);
 flex-wrap: nowrap;
 overflow: hidden;
 max-width: var(--n-max-width);
 color: var(--n-text-color);
 background-color: var(--n-color);
 box-shadow: var(--n-box-shadow);
 `,[he("content",`
 display: inline-block;
 line-height: var(--n-line-height);
 font-size: var(--n-font-size);
 `),he("icon",`
 position: relative;
 margin: var(--n-icon-margin);
 height: var(--n-icon-size);
 width: var(--n-icon-size);
 font-size: var(--n-icon-size);
 flex-shrink: 0;
 `,[["default","info","success","warning","error","loading"].map(e=>xe(`${e}-type`,[ge("> *",`
 color: var(--n-icon-color-${e});
 transition: color .3s var(--n-bezier);
 `)])),ge("> *",`
 position: absolute;
 left: 0;
 top: 0;
 right: 0;
 bottom: 0;
 `,[ku()])]),he("close",`
 margin: var(--n-close-margin);
 transition:
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
 flex-shrink: 0;
 `,[ge("&:hover",`
 color: var(--n-close-icon-color-hover);
 `),ge("&:active",`
 color: var(--n-close-icon-color-pressed);
 `)])]),oe("message-container",`
 z-index: 6000;
 position: fixed;
 height: 0;
 overflow: visible;
 display: flex;
 flex-direction: column;
 align-items: center;
 `,[xe("top",`
 top: 12px;
 left: 0;
 right: 0;
 `),xe("top-left",`
 top: 12px;
 left: 12px;
 right: 0;
 align-items: flex-start;
 `),xe("top-right",`
 top: 12px;
 left: 0;
 right: 12px;
 align-items: flex-end;
 `),xe("bottom",`
 bottom: 4px;
 left: 0;
 right: 0;
 justify-content: flex-end;
 `),xe("bottom-left",`
 bottom: 4px;
 left: 12px;
 right: 0;
 justify-content: flex-end;
 align-items: flex-start;
 `),xe("bottom-right",`
 bottom: 4px;
 left: 0;
 right: 12px;
 justify-content: flex-end;
 align-items: flex-end;
 `)])]),lce={info:()=>E(_re,null),success:()=>E(Ere,null),warning:()=>E(Pre,null),error:()=>E(Cre,null),default:()=>null},cce=je({name:"Message",props:Object.assign(Object.assign({},J6),{render:Function}),setup(e){const{inlineThemeDisabled:t,mergedRtlRef:r}=vr(e),{props:i,mergedClsPrefixRef:n}=_t(tj),a=oo("Message",r,n),o=bt("Message","-message",sce,fle,i,n),s=re(()=>{const{type:c}=e,{common:{cubicBezierEaseInOut:u},self:{padding:d,margin:h,maxWidth:f,iconMargin:p,closeMargin:v,closeSize:m,iconSize:g,fontSize:y,lineHeight:b,borderRadius:x,iconColorInfo:S,iconColorSuccess:w,iconColorWarning:_,iconColorError:C,iconColorLoading:A,closeIconSize:M,closeBorderRadius:P,[Ze("textColor",c)]:T,[Ze("boxShadow",c)]:R,[Ze("color",c)]:z,[Ze("closeColorHover",c)]:F,[Ze("closeColorPressed",c)]:H,[Ze("closeIconColor",c)]:N,[Ze("closeIconColorPressed",c)]:U,[Ze("closeIconColorHover",c)]:ie}}=o.value;return{"--n-bezier":u,"--n-margin":h,"--n-padding":d,"--n-max-width":f,"--n-font-size":y,"--n-icon-margin":p,"--n-icon-size":g,"--n-close-icon-size":M,"--n-close-border-radius":P,"--n-close-size":m,"--n-close-margin":v,"--n-text-color":T,"--n-color":z,"--n-box-shadow":R,"--n-icon-color-info":S,"--n-icon-color-success":w,"--n-icon-color-warning":_,"--n-icon-color-error":C,"--n-icon-color-loading":A,"--n-close-color-hover":F,"--n-close-color-pressed":H,"--n-close-icon-color":N,"--n-close-icon-color-pressed":U,"--n-close-icon-color-hover":ie,"--n-line-height":b,"--n-border-radius":x}}),l=t?Dr("message",re(()=>e.type[0]),s,{}):void 0;return{mergedClsPrefix:n,rtlEnabled:a,messageProviderProps:i,handleClose(){var c;(c=e.onClose)===null||c===void 0||c.call(e)},cssVars:t?void 0:s,themeClass:l==null?void 0:l.themeClass,onRender:l==null?void 0:l.onRender,placement:i.placement}},render(){const{render:e,type:t,closable:r,content:i,mergedClsPrefix:n,cssVars:a,themeClass:o,onRender:s,icon:l,handleClose:c,showIcon:u}=this;s==null||s();let d;return E("div",{class:[`${n}-message-wrapper`,o],onMouseenter:this.onMouseenter,onMouseleave:this.onMouseleave,style:[{alignItems:this.placement.startsWith("top")?"flex-start":"flex-end"},a]},e?e(this.$props):E("div",{class:[`${n}-message ${n}-message--${t}-type`,this.rtlEnabled&&`${n}-message--rtl`]},(d=uce(l,t,n))&&u?E("div",{class:`${n}-message__icon ${n}-message__icon--${t}-type`},E(Jp,null,{default:()=>d})):null,E("div",{class:`${n}-message__content`},Fn(i)),r?E(cw,{clsPrefix:n,class:`${n}-message__close`,onClick:c,absolute:!0}):null))}});function uce(e,t,r){if(typeof e=="function")return e();{const i=t==="loading"?E(i0,{clsPrefix:r,strokeWidth:24,scale:.85}):lce[t]();return i?E(Bi,{clsPrefix:r,key:t},{default:()=>i}):null}}const dce=je({name:"MessageEnvironment",props:Object.assign(Object.assign({},J6),{duration:{type:Number,default:3e3},onAfterLeave:Function,onLeave:Function,internalKey:{type:String,required:!0},onInternalAfterLeave:Function,onHide:Function,onAfterHide:Function}),setup(e){let t=null;const r=me(!0);Or(()=>{i()});function i(){const{duration:u}=e;u&&(t=window.setTimeout(o,u))}function n(u){u.currentTarget===u.target&&t!==null&&(window.clearTimeout(t),t=null)}function a(u){u.currentTarget===u.target&&i()}function o(){const{onHide:u}=e;r.value=!1,t&&(window.clearTimeout(t),t=null),u&&u()}function s(){const{onClose:u}=e;u&&u(),o()}function l(){const{onAfterLeave:u,onInternalAfterLeave:d,onAfterHide:h,internalKey:f}=e;u&&u(),d&&d(f),h&&h()}function c(){o()}return{show:r,hide:o,handleClose:s,handleAfterLeave:l,handleMouseleave:a,handleMouseenter:n,deactivate:c}},render(){return E(iP,{appear:!0,onAfterLeave:this.handleAfterLeave,onLeave:this.onLeave},{default:()=>[this.show?E(cce,{content:this.content,type:this.type,icon:this.icon,showIcon:this.showIcon,closable:this.closable,onClose:this.handleClose,onMouseenter:this.keepAliveOnHover?this.handleMouseenter:void 0,onMouseleave:this.keepAliveOnHover?this.handleMouseleave:void 0}):null]})}}),hce=Object.assign(Object.assign({},bt.props),{to:[String,Object],duration:{type:Number,default:3e3},keepAliveOnHover:Boolean,max:Number,placement:{type:String,default:"top"},closable:Boolean,containerClass:String,containerStyle:[String,Object]}),fce=je({name:"MessageProvider",props:hce,setup(e){const{mergedClsPrefixRef:t}=vr(e),r=me([]),i=me({}),n={create(l,c){return a(l,Object.assign({type:"default"},c))},info(l,c){return a(l,Object.assign(Object.assign({},c),{type:"info"}))},success(l,c){return a(l,Object.assign(Object.assign({},c),{type:"success"}))},warning(l,c){return a(l,Object.assign(Object.assign({},c),{type:"warning"}))},error(l,c){return a(l,Object.assign(Object.assign({},c),{type:"error"}))},loading(l,c){return a(l,Object.assign(Object.assign({},c),{type:"loading"}))},destroyAll:s};xr(tj,{props:e,mergedClsPrefixRef:t}),xr(ej,n);function a(l,c){const u=oh(),d=Wu(Object.assign(Object.assign({},c),{content:l,key:u,destroy:()=>{var f;(f=i.value[u])===null||f===void 0||f.hide()}})),{max:h}=e;return h&&r.value.length>=h&&r.value.shift(),r.value.push(d),d}function o(l){r.value.splice(r.value.findIndex(c=>c.key===l),1),delete i.value[l]}function s(){Object.values(i.value).forEach(l=>{l.hide()})}return Object.assign({mergedClsPrefix:t,messageRefs:i,messageList:r,handleAfterLeave:o},n)},render(){var e,t,r;return E(mr,null,(t=(e=this.$slots).default)===null||t===void 0?void 0:t.call(e),this.messageList.length?E(cN,{to:(r=this.to)!==null&&r!==void 0?r:"body"},E("div",{class:[`${this.mergedClsPrefix}-message-container`,`${this.mergedClsPrefix}-message-container--${this.placement}`,this.containerClass],key:"message-container",style:this.containerStyle},this.messageList.map(i=>E(dce,Object.assign({ref:n=>{n&&(this.messageRefs[i.key]=n)},internalKey:i.key,onInternalAfterLeave:this.handleAfterLeave},TN(i,["destroy"],void 0),{duration:i.duration===void 0?this.duration:i.duration,keepAliveOnHover:i.keepAliveOnHover===void 0?this.keepAliveOnHover:i.keepAliveOnHover,closable:i.closable===void 0?this.closable:i.closable}))))):null)}});function CP(){const e=_t(ej,null);return e===null&&tw("use-message","No outer <n-message-provider /> founded. See prerequisite in https://www.naiveui.com/en-US/os-theme/components/message for more details. If you want to use `useMessage` outside setup, please check https://www.naiveui.com/zh-CN/os-theme/components/message#Q-&-A."),e}const pce=ge([oe("page-header-header",`
 margin-bottom: 20px;
 `),oe("page-header",`
 display: flex;
 align-items: center;
 justify-content: space-between;
 line-height: 1.5;
 font-size: var(--n-font-size);
 `,[he("main",`
 display: flex;
 flex-wrap: nowrap;
 align-items: center;
 `),he("back",`
 display: flex;
 margin-right: 16px;
 font-size: var(--n-back-size);
 cursor: pointer;
 color: var(--n-back-color);
 transition: color .3s var(--n-bezier);
 `,[ge("&:hover","color: var(--n-back-color-hover);"),ge("&:active","color: var(--n-back-color-pressed);")]),he("avatar",`
 display: flex;
 margin-right: 12px
 `),he("title",`
 margin-right: 16px;
 transition: color .3s var(--n-bezier);
 font-size: var(--n-title-font-size);
 font-weight: var(--n-title-font-weight);
 color: var(--n-title-text-color);
 `),he("subtitle",`
 font-size: 14px;
 transition: color .3s var(--n-bezier);
 color: var(--n-subtitle-text-color);
 `)]),oe("page-header-content",`
 font-size: var(--n-font-size);
 `,[ge("&:not(:first-child)","margin-top: 20px;")]),oe("page-header-footer",`
 font-size: var(--n-font-size);
 `,[ge("&:not(:first-child)","margin-top: 20px;")])]),mce=Object.assign(Object.assign({},bt.props),{title:String,subtitle:String,extra:String,onBack:Function}),vce=je({name:"PageHeader",props:mce,setup(e){const{mergedClsPrefixRef:t,mergedRtlRef:r,inlineThemeDisabled:i}=vr(e),n=bt("PageHeader","-page-header",pce,Sle,e,t),a=oo("PageHeader",r,t),o=re(()=>{const{self:{titleTextColor:l,subtitleTextColor:c,backColor:u,fontSize:d,titleFontSize:h,backSize:f,titleFontWeight:p,backColorHover:v,backColorPressed:m},common:{cubicBezierEaseInOut:g}}=n.value;return{"--n-title-text-color":l,"--n-title-font-size":h,"--n-title-font-weight":p,"--n-font-size":d,"--n-back-size":f,"--n-subtitle-text-color":c,"--n-back-color":u,"--n-back-color-hover":v,"--n-back-color-pressed":m,"--n-bezier":g}}),s=i?Dr("page-header",void 0,o,e):void 0;return{rtlEnabled:a,mergedClsPrefix:t,cssVars:i?void 0:o,themeClass:s==null?void 0:s.themeClass,onRender:s==null?void 0:s.onRender}},render(){var e;const{onBack:t,title:r,subtitle:i,extra:n,mergedClsPrefix:a,cssVars:o,$slots:s}=this;(e=this.onRender)===null||e===void 0||e.call(this);const{title:l,subtitle:c,extra:u,default:d,header:h,avatar:f,footer:p,back:v}=s,m=t,g=r||l,y=i||c,b=n||u;return E("div",{style:o,class:[`${a}-page-header-wrapper`,this.themeClass,this.rtlEnabled&&`${a}-page-header-wrapper--rtl`]},h?E("div",{class:`${a}-page-header-header`,key:"breadcrumb"},h()):null,(m||f||g||y||b)&&E("div",{class:`${a}-page-header`,key:"header"},E("div",{class:`${a}-page-header__main`,key:"back"},m?E("div",{class:`${a}-page-header__back`,onClick:t},v?v():E(Bi,{clsPrefix:a},{default:()=>E(zre,null)})):null,f?E("div",{class:`${a}-page-header__avatar`},f()):null,g?E("div",{class:`${a}-page-header__title`,key:"title"},r||l()):null,y?E("div",{class:`${a}-page-header__subtitle`,key:"subtitle"},i||c()):null),b?E("div",{class:`${a}-page-header__extra`},n||u()):null),d?E("div",{class:`${a}-page-header-content`,key:"content"},d()):null,p?E("div",{class:`${a}-page-header-footer`,key:"footer"},p()):null)}}),gce=Object.assign(Object.assign({},bt.props),{trigger:String,xScrollable:Boolean,onScroll:Function,contentClass:String,contentStyle:[Object,String],size:Number}),yce=je({name:"Scrollbar",props:gce,setup(){const e=me(null);return Object.assign(Object.assign({},{scrollTo:(...r)=>{var i;(i=e.value)===null||i===void 0||i.scrollTo(r[0],r[1])},scrollBy:(...r)=>{var i;(i=e.value)===null||i===void 0||i.scrollBy(r[0],r[1])}}),{scrollbarInstRef:e})},render(){return E(Sn,Object.assign({ref:"scrollbarInstRef"},this.$props),this.$slots)}}),bce=oe("statistic",[he("label",`
 font-weight: var(--n-label-font-weight);
 transition: .3s color var(--n-bezier);
 font-size: var(--n-label-font-size);
 color: var(--n-label-text-color);
 `),oe("statistic-value",`
 margin-top: 4px;
 font-weight: var(--n-value-font-weight);
 `,[he("prefix",`
 margin: 0 4px 0 0;
 font-size: var(--n-value-font-size);
 transition: .3s color var(--n-bezier);
 color: var(--n-value-prefix-text-color);
 `,[oe("icon",{verticalAlign:"-0.125em"})]),he("content",`
 font-size: var(--n-value-font-size);
 transition: .3s color var(--n-bezier);
 color: var(--n-value-text-color);
 `),he("suffix",`
 margin: 0 0 0 4px;
 font-size: var(--n-value-font-size);
 transition: .3s color var(--n-bezier);
 color: var(--n-value-suffix-text-color);
 `,[oe("icon",{verticalAlign:"-0.125em"})])])]),xce=Object.assign(Object.assign({},bt.props),{tabularNums:Boolean,label:String,value:[String,Number]}),np=je({name:"Statistic",props:xce,setup(e){const{mergedClsPrefixRef:t,inlineThemeDisabled:r,mergedRtlRef:i}=vr(e),n=bt("Statistic","-statistic",bce,_le,e,t),a=oo("Statistic",i,t),o=re(()=>{const{self:{labelFontWeight:l,valueFontSize:c,valueFontWeight:u,valuePrefixTextColor:d,labelTextColor:h,valueSuffixTextColor:f,valueTextColor:p,labelFontSize:v},common:{cubicBezierEaseInOut:m}}=n.value;return{"--n-bezier":m,"--n-label-font-size":v,"--n-label-font-weight":l,"--n-label-text-color":h,"--n-value-font-weight":u,"--n-value-font-size":c,"--n-value-prefix-text-color":d,"--n-value-suffix-text-color":f,"--n-value-text-color":p}}),s=r?Dr("statistic",void 0,o,e):void 0;return{rtlEnabled:a,mergedClsPrefix:t,cssVars:r?void 0:o,themeClass:s==null?void 0:s.themeClass,onRender:s==null?void 0:s.onRender}},render(){var e;const{mergedClsPrefix:t,$slots:{default:r,label:i,prefix:n,suffix:a}}=this;return(e=this.onRender)===null||e===void 0||e.call(this),E("div",{class:[`${t}-statistic`,this.themeClass,this.rtlEnabled&&`${t}-statistic--rtl`],style:this.cssVars},ti(i,o=>E("div",{class:`${t}-statistic__label`},this.label||o)),E("div",{class:`${t}-statistic-value`,style:{fontVariantNumeric:this.tabularNums?"tabular-nums":""}},ti(n,o=>o&&E("span",{class:`${t}-statistic-value__prefix`},o)),this.value!==void 0?E("span",{class:`${t}-statistic-value__content`},this.value):ti(r,o=>o&&E("span",{class:`${t}-statistic-value__content`},o)),ti(a,o=>o&&E("span",{class:`${t}-statistic-value__suffix`},o))))}}),wce=oe("switch",`
 height: var(--n-height);
 min-width: var(--n-width);
 vertical-align: middle;
 user-select: none;
 -webkit-user-select: none;
 display: inline-flex;
 outline: none;
 justify-content: center;
 align-items: center;
`,[he("children-placeholder",`
 height: var(--n-rail-height);
 display: flex;
 flex-direction: column;
 overflow: hidden;
 pointer-events: none;
 visibility: hidden;
 `),he("rail-placeholder",`
 display: flex;
 flex-wrap: none;
 `),he("button-placeholder",`
 width: calc(1.75 * var(--n-rail-height));
 height: var(--n-rail-height);
 `),oe("base-loading",`
 position: absolute;
 top: 50%;
 left: 50%;
 transform: translateX(-50%) translateY(-50%);
 font-size: calc(var(--n-button-width) - 4px);
 color: var(--n-loading-color);
 transition: color .3s var(--n-bezier);
 `,[ku({left:"50%",top:"50%",originalTransform:"translateX(-50%) translateY(-50%)"})]),he("checked, unchecked",`
 transition: color .3s var(--n-bezier);
 color: var(--n-text-color);
 box-sizing: border-box;
 position: absolute;
 white-space: nowrap;
 top: 0;
 bottom: 0;
 display: flex;
 align-items: center;
 line-height: 1;
 `),he("checked",`
 right: 0;
 padding-right: calc(1.25 * var(--n-rail-height) - var(--n-offset));
 `),he("unchecked",`
 left: 0;
 justify-content: flex-end;
 padding-left: calc(1.25 * var(--n-rail-height) - var(--n-offset));
 `),ge("&:focus",[he("rail",`
 box-shadow: var(--n-box-shadow-focus);
 `)]),xe("round",[he("rail","border-radius: calc(var(--n-rail-height) / 2);",[he("button","border-radius: calc(var(--n-button-height) / 2);")])]),br("disabled",[br("icon",[xe("rubber-band",[xe("pressed",[he("rail",[he("button","max-width: var(--n-button-width-pressed);")])]),he("rail",[ge("&:active",[he("button","max-width: var(--n-button-width-pressed);")])]),xe("active",[xe("pressed",[he("rail",[he("button","left: calc(100% - var(--n-offset) - var(--n-button-width-pressed));")])]),he("rail",[ge("&:active",[he("button","left: calc(100% - var(--n-offset) - var(--n-button-width-pressed));")])])])])])]),xe("active",[he("rail",[he("button","left: calc(100% - var(--n-button-width) - var(--n-offset))")])]),he("rail",`
 overflow: hidden;
 height: var(--n-rail-height);
 min-width: var(--n-rail-width);
 border-radius: var(--n-rail-border-radius);
 cursor: pointer;
 position: relative;
 transition:
 opacity .3s var(--n-bezier),
 background .3s var(--n-bezier),
 box-shadow .3s var(--n-bezier);
 background-color: var(--n-rail-color);
 `,[he("button-icon",`
 color: var(--n-icon-color);
 transition: color .3s var(--n-bezier);
 font-size: calc(var(--n-button-height) - 4px);
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 display: flex;
 justify-content: center;
 align-items: center;
 line-height: 1;
 `,[ku()]),he("button",`
 align-items: center; 
 top: var(--n-offset);
 left: var(--n-offset);
 height: var(--n-button-height);
 width: var(--n-button-width-pressed);
 max-width: var(--n-button-width);
 border-radius: var(--n-button-border-radius);
 background-color: var(--n-button-color);
 box-shadow: var(--n-button-box-shadow);
 box-sizing: border-box;
 cursor: inherit;
 content: "";
 position: absolute;
 transition:
 background-color .3s var(--n-bezier),
 left .3s var(--n-bezier),
 opacity .3s var(--n-bezier),
 max-width .3s var(--n-bezier),
 box-shadow .3s var(--n-bezier);
 `)]),xe("active",[he("rail","background-color: var(--n-rail-color-active);")]),xe("loading",[he("rail",`
 cursor: wait;
 `)]),xe("disabled",[he("rail",`
 cursor: not-allowed;
 opacity: .5;
 `)])]),Sce=Object.assign(Object.assign({},bt.props),{size:{type:String,default:"medium"},value:{type:[String,Number,Boolean],default:void 0},loading:Boolean,defaultValue:{type:[String,Number,Boolean],default:!1},disabled:{type:Boolean,default:void 0},round:{type:Boolean,default:!0},"onUpdate:value":[Function,Array],onUpdateValue:[Function,Array],checkedValue:{type:[String,Number,Boolean],default:!0},uncheckedValue:{type:[String,Number,Boolean],default:!1},railStyle:Function,rubberBand:{type:Boolean,default:!0},onChange:[Function,Array]});let Om;const HR=je({name:"Switch",props:Sce,setup(e){Om===void 0&&(typeof CSS<"u"?typeof CSS.supports<"u"?Om=CSS.supports("width","max(1px)"):Om=!1:Om=!0);const{mergedClsPrefixRef:t,inlineThemeDisabled:r}=vr(e),i=bt("Switch","-switch",wce,Ele,e,t),n=gl(e),{mergedSizeRef:a,mergedDisabledRef:o}=n,s=me(e.defaultValue),l=pt(e,"value"),c=Hn(l,s),u=re(()=>c.value===e.checkedValue),d=me(!1),h=me(!1),f=re(()=>{const{railStyle:C}=e;if(C)return C({focused:h.value,checked:u.value})});function p(C){const{"onUpdate:value":A,onChange:M,onUpdateValue:P}=e,{nTriggerFormInput:T,nTriggerFormChange:R}=n;A&&ct(A,C),P&&ct(P,C),M&&ct(M,C),s.value=C,T(),R()}function v(){const{nTriggerFormFocus:C}=n;C()}function m(){const{nTriggerFormBlur:C}=n;C()}function g(){e.loading||o.value||(c.value!==e.checkedValue?p(e.checkedValue):p(e.uncheckedValue))}function y(){h.value=!0,v()}function b(){h.value=!1,m(),d.value=!1}function x(C){e.loading||o.value||C.key===" "&&(c.value!==e.checkedValue?p(e.checkedValue):p(e.uncheckedValue),d.value=!1)}function S(C){e.loading||o.value||C.key===" "&&(C.preventDefault(),d.value=!0)}const w=re(()=>{const{value:C}=a,{self:{opacityDisabled:A,railColor:M,railColorActive:P,buttonBoxShadow:T,buttonColor:R,boxShadowFocus:z,loadingColor:F,textColor:H,iconColor:N,[Ze("buttonHeight",C)]:U,[Ze("buttonWidth",C)]:ie,[Ze("buttonWidthPressed",C)]:te,[Ze("railHeight",C)]:X,[Ze("railWidth",C)]:W,[Ze("railBorderRadius",C)]:q,[Ze("buttonBorderRadius",C)]:$},common:{cubicBezierEaseInOut:le}}=i.value;let ee,Q,ne;return Om?(ee=`calc((${X} - ${U}) / 2)`,Q=`max(${X}, ${U})`,ne=`max(${W}, calc(${W} + ${U} - ${X}))`):(ee=Pd((nn(X)-nn(U))/2),Q=Pd(Math.max(nn(X),nn(U))),ne=nn(X)>nn(U)?W:Pd(nn(W)+nn(U)-nn(X))),{"--n-bezier":le,"--n-button-border-radius":$,"--n-button-box-shadow":T,"--n-button-color":R,"--n-button-width":ie,"--n-button-width-pressed":te,"--n-button-height":U,"--n-height":Q,"--n-offset":ee,"--n-opacity-disabled":A,"--n-rail-border-radius":q,"--n-rail-color":M,"--n-rail-color-active":P,"--n-rail-height":X,"--n-rail-width":W,"--n-width":ne,"--n-box-shadow-focus":z,"--n-loading-color":F,"--n-text-color":H,"--n-icon-color":N}}),_=r?Dr("switch",re(()=>a.value[0]),w,e):void 0;return{handleClick:g,handleBlur:b,handleFocus:y,handleKeyup:x,handleKeydown:S,mergedRailStyle:f,pressed:d,mergedClsPrefix:t,mergedValue:c,checked:u,mergedDisabled:o,cssVars:r?void 0:w,themeClass:_==null?void 0:_.themeClass,onRender:_==null?void 0:_.onRender}},render(){const{mergedClsPrefix:e,mergedDisabled:t,checked:r,mergedRailStyle:i,onRender:n,$slots:a}=this;n==null||n();const{checked:o,unchecked:s,icon:l,"checked-icon":c,"unchecked-icon":u}=a,d=!(Jf(l)&&Jf(c)&&Jf(u));return E("div",{role:"switch","aria-checked":r,class:[`${e}-switch`,this.themeClass,d&&`${e}-switch--icon`,r&&`${e}-switch--active`,t&&`${e}-switch--disabled`,this.round&&`${e}-switch--round`,this.loading&&`${e}-switch--loading`,this.pressed&&`${e}-switch--pressed`,this.rubberBand&&`${e}-switch--rubber-band`],tabindex:this.mergedDisabled?void 0:0,style:this.cssVars,onClick:this.handleClick,onFocus:this.handleFocus,onBlur:this.handleBlur,onKeyup:this.handleKeyup,onKeydown:this.handleKeydown},E("div",{class:`${e}-switch__rail`,"aria-hidden":"true",style:i},ti(o,h=>ti(s,f=>h||f?E("div",{"aria-hidden":!0,class:`${e}-switch__children-placeholder`},E("div",{class:`${e}-switch__rail-placeholder`},E("div",{class:`${e}-switch__button-placeholder`}),h),E("div",{class:`${e}-switch__rail-placeholder`},E("div",{class:`${e}-switch__button-placeholder`}),f)):null)),E("div",{class:`${e}-switch__button`},ti(l,h=>ti(c,f=>ti(u,p=>E(Jp,null,{default:()=>this.loading?E(i0,{key:"loading",clsPrefix:e,strokeWidth:20}):this.checked&&(f||h)?E("div",{class:`${e}-switch__button-icon`,key:f?"checked-icon":"icon"},f||h):!this.checked&&(p||h)?E("div",{class:`${e}-switch__button-icon`,key:p?"unchecked-icon":"icon"},p||h):null})))),ti(o,h=>h&&E("div",{key:"checked",class:`${e}-switch__checked`},h)),ti(s,h=>h&&E("div",{key:"unchecked",class:`${e}-switch__unchecked`},h)))))}}),_P="n-tabs",rj={tab:[String,Number,Object,Function],name:{type:[String,Number],required:!0},disabled:Boolean,displayDirective:{type:String,default:"if"},closable:{type:Boolean,default:void 0},tabProps:Object,label:[String,Number,Object,Function]},Tx=je({__TAB_PANE__:!0,name:"TabPane",alias:["TabPanel"],props:rj,setup(e){const t=_t(_P,null);return t||tw("tab-pane","`n-tab-pane` must be placed inside `n-tabs`."),{style:t.paneStyleRef,class:t.paneClassRef,mergedClsPrefix:t.mergedClsPrefixRef}},render(){return E("div",{class:[`${this.mergedClsPrefix}-tab-pane`,this.class],style:this.style},this.$slots)}}),Cce=Object.assign({internalLeftPadded:Boolean,internalAddable:Boolean,internalCreatedByPane:Boolean},TN(rj,["displayDirective"])),WA=je({__TAB__:!0,inheritAttrs:!1,name:"Tab",props:Cce,setup(e){const{mergedClsPrefixRef:t,valueRef:r,typeRef:i,closableRef:n,tabStyleRef:a,addTabStyleRef:o,tabClassRef:s,addTabClassRef:l,tabChangeIdRef:c,onBeforeLeaveRef:u,triggerRef:d,handleAdd:h,activateTab:f,handleClose:p}=_t(_P);return{trigger:d,mergedClosable:re(()=>{if(e.internalAddable)return!1;const{closable:v}=e;return v===void 0?n.value:v}),style:a,addStyle:o,tabClass:s,addTabClass:l,clsPrefix:t,value:r,type:i,handleClose(v){v.stopPropagation(),!e.disabled&&p(e.name)},activateTab(){if(e.disabled)return;if(e.internalAddable){h();return}const{name:v}=e,m=++c.id;if(v!==r.value){const{value:g}=u;g?Promise.resolve(g(e.name,r.value)).then(y=>{y&&c.id===m&&f(v)}):f(v)}}}},render(){const{internalAddable:e,clsPrefix:t,name:r,disabled:i,label:n,tab:a,value:o,mergedClosable:s,trigger:l,$slots:{default:c}}=this,u=n??a;return E("div",{class:`${t}-tabs-tab-wrapper`},this.internalLeftPadded?E("div",{class:`${t}-tabs-tab-pad`}):null,E("div",Object.assign({key:r,"data-name":r,"data-disabled":i?!0:void 0},$u({class:[`${t}-tabs-tab`,o===r&&`${t}-tabs-tab--active`,i&&`${t}-tabs-tab--disabled`,s&&`${t}-tabs-tab--closable`,e&&`${t}-tabs-tab--addable`,e?this.addTabClass:this.tabClass],onClick:l==="click"?this.activateTab:void 0,onMouseenter:l==="hover"?this.activateTab:void 0,style:e?this.addStyle:this.style},this.internalCreatedByPane?this.tabProps||{}:this.$attrs)),E("span",{class:`${t}-tabs-tab__label`},e?E(mr,null,E("div",{class:`${t}-tabs-tab__height-placeholder`},""),E(Bi,{clsPrefix:t},{default:()=>E($2,null)})):c?c():typeof u=="object"?u:Fn(u??r)),s&&this.type==="card"?E(cw,{clsPrefix:t,class:`${t}-tabs-tab__close`,onClick:this.handleClose,disabled:i}):null))}}),_ce=oe("tabs",`
 box-sizing: border-box;
 width: 100%;
 display: flex;
 flex-direction: column;
 transition:
 background-color .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
`,[xe("segment-type",[oe("tabs-rail",[ge("&.transition-disabled",[oe("tabs-capsule",`
 transition: none;
 `)])])]),xe("top",[oe("tab-pane",`
 padding: var(--n-pane-padding-top) var(--n-pane-padding-right) var(--n-pane-padding-bottom) var(--n-pane-padding-left);
 `)]),xe("left",[oe("tab-pane",`
 padding: var(--n-pane-padding-right) var(--n-pane-padding-bottom) var(--n-pane-padding-left) var(--n-pane-padding-top);
 `)]),xe("left, right",`
 flex-direction: row;
 `,[oe("tabs-bar",`
 width: 2px;
 right: 0;
 transition:
 top .2s var(--n-bezier),
 max-height .2s var(--n-bezier),
 background-color .3s var(--n-bezier);
 `),oe("tabs-tab",`
 padding: var(--n-tab-padding-vertical); 
 `)]),xe("right",`
 flex-direction: row-reverse;
 `,[oe("tab-pane",`
 padding: var(--n-pane-padding-left) var(--n-pane-padding-top) var(--n-pane-padding-right) var(--n-pane-padding-bottom);
 `),oe("tabs-bar",`
 left: 0;
 `)]),xe("bottom",`
 flex-direction: column-reverse;
 justify-content: flex-end;
 `,[oe("tab-pane",`
 padding: var(--n-pane-padding-bottom) var(--n-pane-padding-right) var(--n-pane-padding-top) var(--n-pane-padding-left);
 `),oe("tabs-bar",`
 top: 0;
 `)]),oe("tabs-rail",`
 position: relative;
 padding: 3px;
 border-radius: var(--n-tab-border-radius);
 width: 100%;
 background-color: var(--n-color-segment);
 transition: background-color .3s var(--n-bezier);
 display: flex;
 align-items: center;
 `,[oe("tabs-capsule",`
 border-radius: var(--n-tab-border-radius);
 position: absolute;
 pointer-events: none;
 background-color: var(--n-tab-color-segment);
 box-shadow: 0 1px 3px 0 rgba(0, 0, 0, .08);
 transition: transform 0.3s var(--n-bezier);
 `),oe("tabs-tab-wrapper",`
 flex-basis: 0;
 flex-grow: 1;
 display: flex;
 align-items: center;
 justify-content: center;
 `,[oe("tabs-tab",`
 overflow: hidden;
 border-radius: var(--n-tab-border-radius);
 width: 100%;
 display: flex;
 align-items: center;
 justify-content: center;
 `,[xe("active",`
 font-weight: var(--n-font-weight-strong);
 color: var(--n-tab-text-color-active);
 `),ge("&:hover",`
 color: var(--n-tab-text-color-hover);
 `)])])]),xe("flex",[oe("tabs-nav",`
 width: 100%;
 position: relative;
 `,[oe("tabs-wrapper",`
 width: 100%;
 `,[oe("tabs-tab",`
 margin-right: 0;
 `)])])]),oe("tabs-nav",`
 box-sizing: border-box;
 line-height: 1.5;
 display: flex;
 transition: border-color .3s var(--n-bezier);
 `,[he("prefix, suffix",`
 display: flex;
 align-items: center;
 `),he("prefix","padding-right: 16px;"),he("suffix","padding-left: 16px;")]),xe("top, bottom",[oe("tabs-nav-scroll-wrapper",[ge("&::before",`
 top: 0;
 bottom: 0;
 left: 0;
 width: 20px;
 `),ge("&::after",`
 top: 0;
 bottom: 0;
 right: 0;
 width: 20px;
 `),xe("shadow-start",[ge("&::before",`
 box-shadow: inset 10px 0 8px -8px rgba(0, 0, 0, .12);
 `)]),xe("shadow-end",[ge("&::after",`
 box-shadow: inset -10px 0 8px -8px rgba(0, 0, 0, .12);
 `)])])]),xe("left, right",[oe("tabs-nav-scroll-content",`
 flex-direction: column;
 `),oe("tabs-nav-scroll-wrapper",[ge("&::before",`
 top: 0;
 left: 0;
 right: 0;
 height: 20px;
 `),ge("&::after",`
 bottom: 0;
 left: 0;
 right: 0;
 height: 20px;
 `),xe("shadow-start",[ge("&::before",`
 box-shadow: inset 0 10px 8px -8px rgba(0, 0, 0, .12);
 `)]),xe("shadow-end",[ge("&::after",`
 box-shadow: inset 0 -10px 8px -8px rgba(0, 0, 0, .12);
 `)])])]),oe("tabs-nav-scroll-wrapper",`
 flex: 1;
 position: relative;
 overflow: hidden;
 `,[oe("tabs-nav-y-scroll",`
 height: 100%;
 width: 100%;
 overflow-y: auto; 
 scrollbar-width: none;
 `,[ge("&::-webkit-scrollbar",`
 width: 0;
 height: 0;
 `)]),ge("&::before, &::after",`
 transition: box-shadow .3s var(--n-bezier);
 pointer-events: none;
 content: "";
 position: absolute;
 z-index: 1;
 `)]),oe("tabs-nav-scroll-content",`
 display: flex;
 position: relative;
 min-width: 100%;
 min-height: 100%;
 width: fit-content;
 box-sizing: border-box;
 `),oe("tabs-wrapper",`
 display: inline-flex;
 flex-wrap: nowrap;
 position: relative;
 `),oe("tabs-tab-wrapper",`
 display: flex;
 flex-wrap: nowrap;
 flex-shrink: 0;
 flex-grow: 0;
 `),oe("tabs-tab",`
 cursor: pointer;
 white-space: nowrap;
 flex-wrap: nowrap;
 display: inline-flex;
 align-items: center;
 color: var(--n-tab-text-color);
 font-size: var(--n-tab-font-size);
 background-clip: padding-box;
 padding: var(--n-tab-padding);
 transition:
 box-shadow .3s var(--n-bezier),
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 `,[xe("disabled",{cursor:"not-allowed"}),he("close",`
 margin-left: 6px;
 transition:
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
 `),he("label",`
 display: flex;
 align-items: center;
 z-index: 1;
 `)]),oe("tabs-bar",`
 position: absolute;
 bottom: 0;
 height: 2px;
 border-radius: 1px;
 background-color: var(--n-bar-color);
 transition:
 left .2s var(--n-bezier),
 max-width .2s var(--n-bezier),
 opacity .3s var(--n-bezier),
 background-color .3s var(--n-bezier);
 `,[ge("&.transition-disabled",`
 transition: none;
 `),xe("disabled",`
 background-color: var(--n-tab-text-color-disabled)
 `)]),oe("tabs-pane-wrapper",`
 position: relative;
 overflow: hidden;
 transition: max-height .2s var(--n-bezier);
 `),oe("tab-pane",`
 color: var(--n-pane-text-color);
 width: 100%;
 transition:
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 opacity .2s var(--n-bezier);
 left: 0;
 right: 0;
 top: 0;
 `,[ge("&.next-transition-leave-active, &.prev-transition-leave-active, &.next-transition-enter-active, &.prev-transition-enter-active",`
 transition:
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 transform .2s var(--n-bezier),
 opacity .2s var(--n-bezier);
 `),ge("&.next-transition-leave-active, &.prev-transition-leave-active",`
 position: absolute;
 `),ge("&.next-transition-enter-from, &.prev-transition-leave-to",`
 transform: translateX(32px);
 opacity: 0;
 `),ge("&.next-transition-leave-to, &.prev-transition-enter-from",`
 transform: translateX(-32px);
 opacity: 0;
 `),ge("&.next-transition-leave-from, &.next-transition-enter-to, &.prev-transition-leave-from, &.prev-transition-enter-to",`
 transform: translateX(0);
 opacity: 1;
 `)]),oe("tabs-tab-pad",`
 box-sizing: border-box;
 width: var(--n-tab-gap);
 flex-grow: 0;
 flex-shrink: 0;
 `),xe("line-type, bar-type",[oe("tabs-tab",`
 font-weight: var(--n-tab-font-weight);
 box-sizing: border-box;
 vertical-align: bottom;
 `,[ge("&:hover",{color:"var(--n-tab-text-color-hover)"}),xe("active",`
 color: var(--n-tab-text-color-active);
 font-weight: var(--n-tab-font-weight-active);
 `),xe("disabled",{color:"var(--n-tab-text-color-disabled)"})])]),oe("tabs-nav",[xe("line-type",[xe("top",[he("prefix, suffix",`
 border-bottom: 1px solid var(--n-tab-border-color);
 `),oe("tabs-nav-scroll-content",`
 border-bottom: 1px solid var(--n-tab-border-color);
 `),oe("tabs-bar",`
 bottom: -1px;
 `)]),xe("left",[he("prefix, suffix",`
 border-right: 1px solid var(--n-tab-border-color);
 `),oe("tabs-nav-scroll-content",`
 border-right: 1px solid var(--n-tab-border-color);
 `),oe("tabs-bar",`
 right: -1px;
 `)]),xe("right",[he("prefix, suffix",`
 border-left: 1px solid var(--n-tab-border-color);
 `),oe("tabs-nav-scroll-content",`
 border-left: 1px solid var(--n-tab-border-color);
 `),oe("tabs-bar",`
 left: -1px;
 `)]),xe("bottom",[he("prefix, suffix",`
 border-top: 1px solid var(--n-tab-border-color);
 `),oe("tabs-nav-scroll-content",`
 border-top: 1px solid var(--n-tab-border-color);
 `),oe("tabs-bar",`
 top: -1px;
 `)]),he("prefix, suffix",`
 transition: border-color .3s var(--n-bezier);
 `),oe("tabs-nav-scroll-content",`
 transition: border-color .3s var(--n-bezier);
 `),oe("tabs-bar",`
 border-radius: 0;
 `)]),xe("card-type",[he("prefix, suffix",`
 transition: border-color .3s var(--n-bezier);
 border-bottom: 1px solid var(--n-tab-border-color);
 `),oe("tabs-pad",`
 flex-grow: 1;
 transition: border-color .3s var(--n-bezier);
 `),oe("tabs-tab-pad",`
 transition: border-color .3s var(--n-bezier);
 `),oe("tabs-tab",`
 font-weight: var(--n-tab-font-weight);
 border: 1px solid var(--n-tab-border-color);
 background-color: var(--n-tab-color);
 box-sizing: border-box;
 position: relative;
 vertical-align: bottom;
 display: flex;
 justify-content: space-between;
 font-size: var(--n-tab-font-size);
 color: var(--n-tab-text-color);
 `,[xe("addable",`
 padding-left: 8px;
 padding-right: 8px;
 font-size: 16px;
 `,[he("height-placeholder",`
 width: 0;
 font-size: var(--n-tab-font-size);
 `),br("disabled",[ge("&:hover",`
 color: var(--n-tab-text-color-hover);
 `)])]),xe("closable","padding-right: 8px;"),xe("active",`
 background-color: #0000;
 font-weight: var(--n-tab-font-weight-active);
 color: var(--n-tab-text-color-active);
 `),xe("disabled","color: var(--n-tab-text-color-disabled);")]),oe("tabs-scroll-padding","border-bottom: 1px solid var(--n-tab-border-color);")]),xe("left, right",[oe("tabs-wrapper",`
 flex-direction: column;
 `,[oe("tabs-tab-wrapper",`
 flex-direction: column;
 `,[oe("tabs-tab-pad",`
 height: var(--n-tab-gap-vertical);
 width: 100%;
 `)])])]),xe("top",[xe("card-type",[oe("tabs-tab",`
 border-top-left-radius: var(--n-tab-border-radius);
 border-top-right-radius: var(--n-tab-border-radius);
 `,[xe("active",`
 border-bottom: 1px solid #0000;
 `)]),oe("tabs-tab-pad",`
 border-bottom: 1px solid var(--n-tab-border-color);
 `),oe("tabs-pad",`
 border-bottom: 1px solid var(--n-tab-border-color);
 `)])]),xe("left",[xe("card-type",[oe("tabs-tab",`
 border-top-left-radius: var(--n-tab-border-radius);
 border-bottom-left-radius: var(--n-tab-border-radius);
 `,[xe("active",`
 border-right: 1px solid #0000;
 `)]),oe("tabs-tab-pad",`
 border-right: 1px solid var(--n-tab-border-color);
 `),oe("tabs-pad",`
 border-right: 1px solid var(--n-tab-border-color);
 `)])]),xe("right",[xe("card-type",[oe("tabs-tab",`
 border-top-right-radius: var(--n-tab-border-radius);
 border-bottom-right-radius: var(--n-tab-border-radius);
 `,[xe("active",`
 border-left: 1px solid #0000;
 `)]),oe("tabs-tab-pad",`
 border-left: 1px solid var(--n-tab-border-color);
 `),oe("tabs-pad",`
 border-left: 1px solid var(--n-tab-border-color);
 `)])]),xe("bottom",[xe("card-type",[oe("tabs-tab",`
 border-bottom-left-radius: var(--n-tab-border-radius);
 border-bottom-right-radius: var(--n-tab-border-radius);
 `,[xe("active",`
 border-top: 1px solid #0000;
 `)]),oe("tabs-tab-pad",`
 border-top: 1px solid var(--n-tab-border-color);
 `),oe("tabs-pad",`
 border-top: 1px solid var(--n-tab-border-color);
 `)])])])]),Ace=Object.assign(Object.assign({},bt.props),{value:[String,Number],defaultValue:[String,Number],trigger:{type:String,default:"click"},type:{type:String,default:"bar"},closable:Boolean,justifyContent:String,size:{type:String,default:"medium"},placement:{type:String,default:"top"},tabStyle:[String,Object],tabClass:String,addTabStyle:[String,Object],addTabClass:String,barWidth:Number,paneClass:String,paneStyle:[String,Object],paneWrapperClass:String,paneWrapperStyle:[String,Object],addable:[Boolean,Object],tabsPadding:{type:Number,default:0},animated:Boolean,onBeforeLeave:Function,onAdd:Function,"onUpdate:value":[Function,Array],onUpdateValue:[Function,Array],onClose:[Function,Array],labelSize:String,activeName:[String,Number],onActiveNameChange:[Function,Array]}),ij=je({name:"Tabs",props:Ace,setup(e,{slots:t}){var r,i,n,a;const{mergedClsPrefixRef:o,inlineThemeDisabled:s}=vr(e),l=bt("Tabs","-tabs",_ce,Dle,e,o),c=me(null),u=me(null),d=me(null),h=me(null),f=me(null),p=me(null),v=me(!0),m=me(!0),g=Sp(e,["labelSize","size"]),y=Sp(e,["activeName","value"]),b=me((i=(r=y.value)!==null&&r!==void 0?r:e.defaultValue)!==null&&i!==void 0?i:t.default?(a=(n=Cu(t.default())[0])===null||n===void 0?void 0:n.props)===null||a===void 0?void 0:a.name:null),x=Hn(y,b),S={id:0},w=re(()=>{if(!(!e.justifyContent||e.type==="card"))return{display:"flex",justifyContent:e.justifyContent}});rr(x,()=>{S.id=0,P(),T()});function _(){var fe;const{value:B}=x;return B===null?null:(fe=c.value)===null||fe===void 0?void 0:fe.querySelector(`[data-name="${B}"]`)}function C(fe){if(e.type==="card")return;const{value:B}=u;if(!B)return;const D=B.style.opacity==="0";if(fe){const I=`${o.value}-tabs-bar--disabled`,{barWidth:O,placement:j}=e;if(fe.dataset.disabled==="true"?B.classList.add(I):B.classList.remove(I),["top","bottom"].includes(j)){if(M(["top","maxHeight","height"]),typeof O=="number"&&fe.offsetWidth>=O){const L=Math.floor((fe.offsetWidth-O)/2)+fe.offsetLeft;B.style.left=`${L}px`,B.style.maxWidth=`${O}px`}else B.style.left=`${fe.offsetLeft}px`,B.style.maxWidth=`${fe.offsetWidth}px`;B.style.width="8192px",D&&(B.style.transition="none"),B.offsetWidth,D&&(B.style.transition="",B.style.opacity="1")}else{if(M(["left","maxWidth","width"]),typeof O=="number"&&fe.offsetHeight>=O){const L=Math.floor((fe.offsetHeight-O)/2)+fe.offsetTop;B.style.top=`${L}px`,B.style.maxHeight=`${O}px`}else B.style.top=`${fe.offsetTop}px`,B.style.maxHeight=`${fe.offsetHeight}px`;B.style.height="8192px",D&&(B.style.transition="none"),B.offsetHeight,D&&(B.style.transition="",B.style.opacity="1")}}}function A(){if(e.type==="card")return;const{value:fe}=u;fe&&(fe.style.opacity="0")}function M(fe){const{value:B}=u;if(B)for(const D of fe)B.style[D]=""}function P(){if(e.type==="card")return;const fe=_();fe?C(fe):A()}function T(fe){var B;const D=(B=f.value)===null||B===void 0?void 0:B.$el;if(!D)return;const I=_();if(!I)return;const{scrollLeft:O,offsetWidth:j}=D,{offsetLeft:L,offsetWidth:Ae}=I;O>L?D.scrollTo({top:0,left:L,behavior:"smooth"}):L+Ae>O+j&&D.scrollTo({top:0,left:L+Ae-j,behavior:"smooth"})}const R=me(null);let z=0,F=null;function H(fe){const B=R.value;if(B){z=fe.getBoundingClientRect().height;const D=`${z}px`,I=()=>{B.style.height=D,B.style.maxHeight=D};F?(I(),F(),F=null):F=I}}function N(fe){const B=R.value;if(B){const D=fe.getBoundingClientRect().height,I=()=>{document.body.offsetHeight,B.style.maxHeight=`${D}px`,B.style.height=`${Math.max(z,D)}px`};F?(F(),F=null,I()):F=I}}function U(){const fe=R.value;if(fe){fe.style.maxHeight="",fe.style.height="";const{paneWrapperStyle:B}=e;if(typeof B=="string")fe.style.cssText=B;else if(B){const{maxHeight:D,height:I}=B;D!==void 0&&(fe.style.maxHeight=D),I!==void 0&&(fe.style.height=I)}}}const ie={value:[]},te=me("next");function X(fe){const B=x.value;let D="next";for(const I of ie.value){if(I===B)break;if(I===fe){D="prev";break}}te.value=D,W(fe)}function W(fe){const{onActiveNameChange:B,onUpdateValue:D,"onUpdate:value":I}=e;B&&ct(B,fe),D&&ct(D,fe),I&&ct(I,fe),b.value=fe}function q(fe){const{onClose:B}=e;B&&ct(B,fe)}function $(){const{value:fe}=u;if(!fe)return;const B="transition-disabled";fe.classList.add(B),P(),fe.classList.remove(B)}const le=me(null);function ee({transitionDisabled:fe}){const B=c.value;if(!B)return;fe&&B.classList.add("transition-disabled");const D=_();D&&le.value&&(le.value.style.width=`${D.offsetWidth}px`,le.value.style.height=`${D.offsetHeight}px`,le.value.style.transform=`translateX(${D.offsetLeft-nn(getComputedStyle(B).paddingLeft)}px)`,fe&&le.value.offsetWidth),fe&&B.classList.remove("transition-disabled")}rr([x],()=>{e.type==="segment"&&aa(()=>{ee({transitionDisabled:!1})})}),Or(()=>{e.type==="segment"&&ee({transitionDisabled:!0})});let Q=0;function ne(fe){var B;if(fe.contentRect.width===0&&fe.contentRect.height===0||Q===fe.contentRect.width)return;Q=fe.contentRect.width;const{type:D}=e;if((D==="line"||D==="bar")&&$(),D!=="segment"){const{placement:I}=e;Z((I==="top"||I==="bottom"?(B=f.value)===null||B===void 0?void 0:B.$el:p.value)||null)}}const V=SS(ne,64);rr([()=>e.justifyContent,()=>e.size],()=>{aa(()=>{const{type:fe}=e;(fe==="line"||fe==="bar")&&$()})});const ue=me(!1);function ve(fe){var B;const{target:D,contentRect:{width:I}}=fe,O=D.parentElement.offsetWidth;if(!ue.value)O<I&&(ue.value=!0);else{const{value:j}=h;if(!j)return;O-I>j.$el.offsetWidth&&(ue.value=!1)}Z(((B=f.value)===null||B===void 0?void 0:B.$el)||null)}const Ce=SS(ve,64);function G(){const{onAdd:fe}=e;fe&&fe(),aa(()=>{const B=_(),{value:D}=f;!B||!D||D.scrollTo({left:B.offsetLeft,top:0,behavior:"smooth"})})}function Z(fe){if(!fe)return;const{placement:B}=e;if(B==="top"||B==="bottom"){const{scrollLeft:D,scrollWidth:I,offsetWidth:O}=fe;v.value=D<=0,m.value=D+O>=I}else{const{scrollTop:D,scrollHeight:I,offsetHeight:O}=fe;v.value=D<=0,m.value=D+O>=I}}const de=SS(fe=>{Z(fe.target)},64);xr(_P,{triggerRef:pt(e,"trigger"),tabStyleRef:pt(e,"tabStyle"),tabClassRef:pt(e,"tabClass"),addTabStyleRef:pt(e,"addTabStyle"),addTabClassRef:pt(e,"addTabClass"),paneClassRef:pt(e,"paneClass"),paneStyleRef:pt(e,"paneStyle"),mergedClsPrefixRef:o,typeRef:pt(e,"type"),closableRef:pt(e,"closable"),valueRef:x,tabChangeIdRef:S,onBeforeLeaveRef:pt(e,"onBeforeLeave"),activateTab:X,handleClose:q,handleAdd:G}),BN(()=>{P(),T()}),no(()=>{const{value:fe}=d;if(!fe)return;const{value:B}=o,D=`${B}-tabs-nav-scroll-wrapper--shadow-start`,I=`${B}-tabs-nav-scroll-wrapper--shadow-end`;v.value?fe.classList.remove(D):fe.classList.add(D),m.value?fe.classList.remove(I):fe.classList.add(I)});const Se={syncBarPosition:()=>{P()}},we=()=>{ee({transitionDisabled:!0})},_e=re(()=>{const{value:fe}=g,{type:B}=e,D={card:"Card",bar:"Bar",line:"Line",segment:"Segment"}[B],I=`${fe}${D}`,{self:{barColor:O,closeIconColor:j,closeIconColorHover:L,closeIconColorPressed:Ae,tabColor:We,tabBorderColor:Ve,paneTextColor:ke,tabFontWeight:et,tabBorderRadius:nt,tabFontWeightActive:lt,colorSegment:ut,fontWeightStrong:vt,tabColorSegment:se,closeSize:Be,closeIconSize:Ye,closeColorHover:pe,closeColorPressed:Te,closeBorderRadius:ce,[Ze("panePadding",fe)]:Re,[Ze("tabPadding",I)]:$e,[Ze("tabPaddingVertical",I)]:at,[Ze("tabGap",I)]:Yt,[Ze("tabGap",`${I}Vertical`)]:nr,[Ze("tabTextColor",B)]:Fe,[Ze("tabTextColorActive",B)]:Ke,[Ze("tabTextColorHover",B)]:dt,[Ze("tabTextColorDisabled",B)]:Nt,[Ze("tabFontSize",fe)]:hi},common:{cubicBezierEaseInOut:Mi}}=l.value;return{"--n-bezier":Mi,"--n-color-segment":ut,"--n-bar-color":O,"--n-tab-font-size":hi,"--n-tab-text-color":Fe,"--n-tab-text-color-active":Ke,"--n-tab-text-color-disabled":Nt,"--n-tab-text-color-hover":dt,"--n-pane-text-color":ke,"--n-tab-border-color":Ve,"--n-tab-border-radius":nt,"--n-close-size":Be,"--n-close-icon-size":Ye,"--n-close-color-hover":pe,"--n-close-color-pressed":Te,"--n-close-border-radius":ce,"--n-close-icon-color":j,"--n-close-icon-color-hover":L,"--n-close-icon-color-pressed":Ae,"--n-tab-color":We,"--n-tab-font-weight":et,"--n-tab-font-weight-active":lt,"--n-tab-padding":$e,"--n-tab-padding-vertical":at,"--n-tab-gap":Yt,"--n-tab-gap-vertical":nr,"--n-pane-padding-left":zo(Re,"left"),"--n-pane-padding-right":zo(Re,"right"),"--n-pane-padding-top":zo(Re,"top"),"--n-pane-padding-bottom":zo(Re,"bottom"),"--n-font-weight-strong":vt,"--n-tab-color-segment":se}}),Ee=s?Dr("tabs",re(()=>`${g.value[0]}${e.type[0]}`),_e,e):void 0;return Object.assign({mergedClsPrefix:o,mergedValue:x,renderedNames:new Set,segmentCapsuleElRef:le,tabsPaneWrapperRef:R,tabsElRef:c,barElRef:u,addTabInstRef:h,xScrollInstRef:f,scrollWrapperElRef:d,addTabFixed:ue,tabWrapperStyle:w,handleNavResize:V,mergedSize:g,handleScroll:de,handleTabsResize:Ce,cssVars:s?void 0:_e,themeClass:Ee==null?void 0:Ee.themeClass,animationDirection:te,renderNameListRef:ie,yScrollElRef:p,handleSegmentResize:we,onAnimationBeforeLeave:H,onAnimationEnter:N,onAnimationAfterEnter:U,onRender:Ee==null?void 0:Ee.onRender},Se)},render(){const{mergedClsPrefix:e,type:t,placement:r,addTabFixed:i,addable:n,mergedSize:a,renderNameListRef:o,onRender:s,paneWrapperClass:l,paneWrapperStyle:c,$slots:{default:u,prefix:d,suffix:h}}=this;s==null||s();const f=u?Cu(u()).filter(S=>S.type.__TAB_PANE__===!0):[],p=u?Cu(u()).filter(S=>S.type.__TAB__===!0):[],v=!p.length,m=t==="card",g=t==="segment",y=!m&&!g&&this.justifyContent;o.value=[];const b=()=>{const S=E("div",{style:this.tabWrapperStyle,class:[`${e}-tabs-wrapper`]},y?null:E("div",{class:`${e}-tabs-scroll-padding`,style:{width:`${this.tabsPadding}px`}}),v?f.map((w,_)=>(o.value.push(w.props.name),qS(E(WA,Object.assign({},w.props,{internalCreatedByPane:!0,internalLeftPadded:_!==0&&(!y||y==="center"||y==="start"||y==="end")}),w.children?{default:w.children.tab}:void 0)))):p.map((w,_)=>(o.value.push(w.props.name),qS(_!==0&&!y?$R(w):w))),!i&&n&&m?GR(n,(v?f.length:p.length)!==0):null,y?null:E("div",{class:`${e}-tabs-scroll-padding`,style:{width:`${this.tabsPadding}px`}}));return E("div",{ref:"tabsElRef",class:`${e}-tabs-nav-scroll-content`},m&&n?E(nl,{onResize:this.handleTabsResize},{default:()=>S}):S,m?E("div",{class:`${e}-tabs-pad`}):null,m?null:E("div",{ref:"barElRef",class:`${e}-tabs-bar`}))},x=g?"top":r;return E("div",{class:[`${e}-tabs`,this.themeClass,`${e}-tabs--${t}-type`,`${e}-tabs--${a}-size`,y&&`${e}-tabs--flex`,`${e}-tabs--${x}`],style:this.cssVars},E("div",{class:[`${e}-tabs-nav--${t}-type`,`${e}-tabs-nav--${x}`,`${e}-tabs-nav`]},ti(d,S=>S&&E("div",{class:`${e}-tabs-nav__prefix`},S)),g?E(nl,{onResize:this.handleSegmentResize},{default:()=>E("div",{class:`${e}-tabs-rail`,ref:"tabsElRef"},E("div",{class:`${e}-tabs-capsule`,ref:"segmentCapsuleElRef"},E("div",{class:`${e}-tabs-wrapper`},E("div",{class:`${e}-tabs-tab`}))),v?f.map((S,w)=>(o.value.push(S.props.name),E(WA,Object.assign({},S.props,{internalCreatedByPane:!0,internalLeftPadded:w!==0}),S.children?{default:S.children.tab}:void 0))):p.map((S,w)=>(o.value.push(S.props.name),w===0?S:$R(S))))}):E(nl,{onResize:this.handleNavResize},{default:()=>E("div",{class:`${e}-tabs-nav-scroll-wrapper`,ref:"scrollWrapperElRef"},["top","bottom"].includes(x)?E(gX,{ref:"xScrollInstRef",onScroll:this.handleScroll},{default:b}):E("div",{class:`${e}-tabs-nav-y-scroll`,onScroll:this.handleScroll,ref:"yScrollElRef"},b()))}),i&&n&&m?GR(n,!0):null,ti(h,S=>S&&E("div",{class:`${e}-tabs-nav__suffix`},S))),v&&(this.animated&&(x==="top"||x==="bottom")?E("div",{ref:"tabsPaneWrapperRef",style:c,class:[`${e}-tabs-pane-wrapper`,l]},WR(f,this.mergedValue,this.renderedNames,this.onAnimationBeforeLeave,this.onAnimationEnter,this.onAnimationAfterEnter,this.animationDirection)):WR(f,this.mergedValue,this.renderedNames)))}});function WR(e,t,r,i,n,a,o){const s=[];return e.forEach(l=>{const{name:c,displayDirective:u,"display-directive":d}=l.props,h=p=>u===p||d===p,f=t===c;if(l.key!==void 0&&(l.key=c),f||h("show")||h("show:lazy")&&r.has(c)){r.has(c)||r.add(c);const p=!h("if");s.push(p?io(l,[[nh,f]]):l)}}),o?E(CN,{name:`${o}-transition`,onBeforeLeave:i,onEnter:n,onAfterEnter:a},{default:()=>s}):s}function GR(e,t){return E(WA,{ref:"addTabInstRef",key:"__addable",name:"__addable",internalCreatedByPane:!0,internalAddable:!0,internalLeftPadded:t,disabled:typeof e=="object"&&e.disabled})}function $R(e){const t=hl(e);return t.props?t.props.internalLeftPadded=!0:t.props={internalLeftPadded:!0},t}function qS(e){return Array.isArray(e.dynamicProps)?e.dynamicProps.includes("internalLeftPadded")||e.dynamicProps.push("internalLeftPadded"):e.dynamicProps=["internalLeftPadded"],e}const c0="n-transfer",qR=je({name:"TransferHeader",props:{size:{type:String,required:!0},selectAllText:String,clearText:String,source:Boolean,onCheckedAll:Function,onClearAll:Function,title:String},setup(e){const{targetOptionsRef:t,canNotSelectAnythingRef:r,canBeClearedRef:i,allCheckedRef:n,mergedThemeRef:a,disabledRef:o,mergedClsPrefixRef:s,srcOptionsLengthRef:l}=_t(c0),{localeRef:c}=wc("Transfer");return()=>{const{source:u,onClearAll:d,onCheckedAll:h,selectAllText:f,clearText:p}=e,{value:v}=a,{value:m}=s,{value:g}=c,y=e.size==="large"?"small":"tiny",{title:b}=e;return E("div",{class:`${m}-transfer-list-header`},b&&E("div",{class:`${m}-transfer-list-header__title`},b),u&&E(ci,{class:`${m}-transfer-list-header__button`,theme:v.peers.Button,themeOverrides:v.peerOverrides.Button,size:y,tertiary:!0,onClick:n.value?d:h,disabled:r.value||o.value},{default:()=>n.value?p||g.unselectAll:f||g.selectAll}),!u&&i.value&&E(ci,{class:`${m}-transfer-list-header__button`,theme:v.peers.Button,themeOverrides:v.peerOverrides.Button,size:y,tertiary:!0,onClick:d,disabled:o.value},{default:()=>g.clearAll}),E("div",{class:`${m}-transfer-list-header__extra`},u?g.total(l.value):g.selected(t.value.length)))}}}),YR=je({name:"NTransferListItem",props:{source:Boolean,label:{type:String,required:!0},value:{type:[String,Number],required:!0},disabled:Boolean,option:{type:Object,required:!0}},setup(e){const{targetValueSetRef:t,mergedClsPrefixRef:r,mergedThemeRef:i,handleItemCheck:n,renderSourceLabelRef:a,renderTargetLabelRef:o,showSelectedRef:s}=_t(c0),l=qi(()=>t.value.has(e.value));function c(){e.disabled||n(!l.value,e.value)}return{mergedClsPrefix:r,mergedTheme:i,checked:l,showSelected:s,renderSourceLabel:a,renderTargetLabel:o,handleClick:c}},render(){const{disabled:e,mergedTheme:t,mergedClsPrefix:r,label:i,checked:n,source:a,renderSourceLabel:o,renderTargetLabel:s}=this;return E("div",{class:[`${r}-transfer-list-item`,e&&`${r}-transfer-list-item--disabled`,a?`${r}-transfer-list-item--source`:`${r}-transfer-list-item--target`],onClick:a?this.handleClick:void 0},E("div",{class:`${r}-transfer-list-item__background`}),a&&this.showSelected&&E("div",{class:`${r}-transfer-list-item__checkbox`},E(y6,{theme:t.peers.Checkbox,themeOverrides:t.peerOverrides.Checkbox,disabled:e,checked:n})),E("div",{class:`${r}-transfer-list-item__label`,title:_2(i)},a?o?o({option:this.option}):i:s?s({option:this.option}):i),!a&&!e&&E(cw,{focusable:!1,class:`${r}-transfer-list-item__close`,clsPrefix:r,onClick:this.handleClick}))}}),XR=je({name:"TransferList",props:{virtualScroll:{type:Boolean,required:!0},itemSize:{type:Number,required:!0},options:{type:Array,required:!0},disabled:{type:Boolean,required:!0},source:Boolean},setup(){const{mergedThemeRef:e,mergedClsPrefixRef:t}=_t(c0),r=me(null),i=me(null);function n(){var s;(s=r.value)===null||s===void 0||s.sync()}function a(){const{value:s}=i;if(!s)return null;const{listElRef:l}=s;return l}function o(){const{value:s}=i;if(!s)return null;const{itemsElRef:l}=s;return l}return{mergedTheme:e,mergedClsPrefix:t,scrollerInstRef:r,vlInstRef:i,syncVLScroller:n,scrollContainer:a,scrollContent:o}},render(){const{mergedTheme:e,options:t}=this;if(t.length===0)return E(KU,{theme:e.peers.Empty,themeOverrides:e.peerOverrides.Empty});const{mergedClsPrefix:r,virtualScroll:i,source:n,disabled:a,syncVLScroller:o}=this;return E(Sn,{ref:"scrollerInstRef",theme:e.peers.Scrollbar,themeOverrides:e.peerOverrides.Scrollbar,container:i?this.scrollContainer:void 0,content:i?this.scrollContent:void 0},{default:()=>i?E(fg,{ref:"vlInstRef",style:{height:"100%"},class:`${r}-transfer-list-content`,items:this.options,itemSize:this.itemSize,showScrollbar:!1,onResize:o,onScroll:o,keyField:"value"},{default:({item:s})=>{const{source:l,disabled:c}=this;return E(YR,{source:l,key:s.value,value:s.value,disabled:s.disabled||c,label:s.label,option:s})}}):E("div",{class:`${r}-transfer-list-content`},t.map(s=>E(YR,{source:n,key:s.value,value:s.value,disabled:s.disabled||a,label:s.label,option:s})))})}}),KR=je({name:"TransferFilter",props:{value:String,placeholder:String,disabled:Boolean,onUpdateValue:{type:Function,required:!0}},setup(){const{mergedThemeRef:e,mergedClsPrefixRef:t}=_t(c0);return{mergedClsPrefix:t,mergedTheme:e}},render(){const{mergedTheme:e,mergedClsPrefix:t}=this;return E("div",{class:`${t}-transfer-filter`},E(ur,{value:this.value,onUpdateValue:this.onUpdateValue,disabled:this.disabled,placeholder:this.placeholder,theme:e.peers.Input,themeOverrides:e.peerOverrides.Input,clearable:!0,size:"small"},{"clear-icon-placeholder":()=>E(Bi,{clsPrefix:t},{default:()=>E(Mre,null)})}))}});function Mce(e){const t=me(e.defaultValue),r=Hn(pt(e,"value"),t),i=re(()=>{const x=new Map;return(e.options||[]).forEach(S=>x.set(S.value,S)),x}),n=re(()=>new Set(r.value||[])),a=re(()=>{const x=i.value,S=[];return(r.value||[]).forEach(w=>{const _=x.get(w);_&&S.push(_)}),S}),o=me(""),s=me(""),l=re(()=>e.sourceFilterable||!!e.filterable),c=re(()=>{const{showSelected:x,options:S,filter:w}=e;return l.value?S.filter(_=>w(o.value,_,"source")&&(x||!n.value.has(_.value))):x?S:S.filter(_=>!n.value.has(_.value))}),u=re(()=>{if(!e.targetFilterable)return a.value;const{filter:x}=e;return a.value.filter(S=>x(s.value,S,"target"))}),d=re(()=>{const{value:x}=r;return x===null?new Set:new Set(x)}),h=re(()=>{const x=new Set(d.value);return c.value.forEach(S=>{!S.disabled&&!x.has(S.value)&&x.add(S.value)}),x}),f=re(()=>{const x=new Set(d.value);return c.value.forEach(S=>{!S.disabled&&x.has(S.value)&&x.delete(S.value)}),x}),p=re(()=>{const x=new Set(d.value);return u.value.forEach(S=>{S.disabled||x.delete(S.value)}),x}),v=re(()=>c.value.every(x=>x.disabled)),m=re(()=>{if(!c.value.length)return!1;const x=d.value;return c.value.every(S=>S.disabled||x.has(S.value))}),g=re(()=>u.value.some(x=>!x.disabled));function y(x){o.value=x??""}function b(x){s.value=x??""}return{uncontrolledValueRef:t,mergedValueRef:r,targetValueSetRef:n,valueSetForCheckAllRef:h,valueSetForUncheckAllRef:f,valueSetForClearRef:p,filteredTgtOptionsRef:u,filteredSrcOptionsRef:c,targetOptionsRef:a,canNotSelectAnythingRef:v,canBeClearedRef:g,allCheckedRef:m,srcPatternRef:o,tgtPatternRef:s,mergedSrcFilterableRef:l,handleSrcFilterUpdateValue:y,handleTgtFilterUpdateValue:b}}const Ece=oe("transfer",`
 width: 100%;
 font-size: var(--n-font-size);
 height: 300px;
 display: flex;
 flex-wrap: nowrap;
 word-break: break-word;
`,[xe("disabled",[oe("transfer-list",[oe("transfer-list-header",[he("title",`
 color: var(--n-header-text-color-disabled);
 `),he("extra",`
 color: var(--n-header-extra-text-color-disabled);
 `)])])]),oe("transfer-list",`
 flex: 1;
 min-width: 0;
 height: inherit;
 display: flex;
 flex-direction: column;
 background-clip: padding-box;
 position: relative;
 transition: background-color .3s var(--n-bezier);
 background-color: var(--n-list-color);
 `,[xe("source",`
 border-top-left-radius: var(--n-border-radius);
 border-bottom-left-radius: var(--n-border-radius);
 `,[he("border","border-right: 1px solid var(--n-divider-color);")]),xe("target",`
 border-top-right-radius: var(--n-border-radius);
 border-bottom-right-radius: var(--n-border-radius);
 `,[he("border","border-left: none;")]),he("border",`
 padding: 0 12px;
 border: 1px solid var(--n-border-color);
 transition: border-color .3s var(--n-bezier);
 pointer-events: none;
 border-radius: inherit;
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 `),oe("transfer-list-header",`
 min-height: var(--n-header-height);
 box-sizing: border-box;
 display: flex;
 padding: 12px 12px 10px 12px;
 align-items: center;
 background-clip: padding-box;
 border-radius: inherit;
 border-bottom-left-radius: 0;
 border-bottom-right-radius: 0;
 line-height: 1.5;
 transition:
 border-color .3s var(--n-bezier),
 background-color .3s var(--n-bezier);
 `,[ge("> *:not(:first-child)",`
 margin-left: 8px;
 `),he("title",`
 flex: 1;
 min-width: 0;
 line-height: 1.5;
 font-size: var(--n-header-font-size);
 font-weight: var(--n-header-font-weight);
 transition: color .3s var(--n-bezier);
 color: var(--n-header-text-color);
 `),he("button",`
 position: relative;
 `),he("extra",`
 transition: color .3s var(--n-bezier);
 font-size: var(--n-extra-font-size);
 margin-right: 0;
 white-space: nowrap;
 color: var(--n-header-extra-text-color);
 `)]),oe("transfer-list-body",`
 flex-basis: 0;
 flex-grow: 1;
 box-sizing: border-box;
 position: relative;
 display: flex;
 flex-direction: column;
 border-radius: inherit;
 border-top-left-radius: 0;
 border-top-right-radius: 0;
 `,[oe("transfer-filter",`
 padding: 4px 12px 8px 12px;
 box-sizing: border-box;
 transition:
 border-color .3s var(--n-bezier),
 background-color .3s var(--n-bezier);
 `),oe("transfer-list-flex-container",`
 flex: 1;
 position: relative;
 `,[oe("scrollbar",`
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 height: unset;
 `),oe("empty",`
 position: absolute;
 left: 50%;
 top: 50%;
 transform: translateY(-50%) translateX(-50%);
 `),oe("transfer-list-content",`
 padding: 0;
 margin: 0;
 position: relative;
 `,[oe("transfer-list-item",`
 padding: 0 12px;
 min-height: var(--n-item-height);
 display: flex;
 align-items: center;
 color: var(--n-item-text-color);
 position: relative;
 transition: color .3s var(--n-bezier);
 `,[he("background",`
 position: absolute;
 left: 4px;
 right: 4px;
 top: 0;
 bottom: 0;
 border-radius: var(--n-border-radius);
 transition: background-color .3s var(--n-bezier);
 `),he("checkbox",`
 position: relative;
 margin-right: 8px;
 `),he("close",`
 opacity: 0;
 pointer-events: none;
 position: relative;
 transition:
 opacity .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
 `),he("label",`
 position: relative;
 min-width: 0;
 flex-grow: 1;
 `),xe("source","cursor: pointer;"),xe("disabled",`
 cursor: not-allowed;
 color: var(--n-item-text-color-disabled);
 `),br("disabled",[ge("&:hover",[he("background","background-color: var(--n-item-color-pending);"),he("close",`
 opacity: 1;
 pointer-events: all;
 `)])])])])])])])]),Tce=Object.assign(Object.assign({},bt.props),{value:Array,defaultValue:{type:Array,default:null},options:{type:Array,default:()=>[]},disabled:{type:Boolean,default:void 0},virtualScroll:Boolean,sourceTitle:String,selectAllText:String,clearText:String,targetTitle:String,filterable:{type:Boolean,default:void 0},sourceFilterable:Boolean,targetFilterable:Boolean,showSelected:{type:Boolean,default:!0},sourceFilterPlaceholder:String,targetFilterPlaceholder:String,filter:{type:Function,default:(e,t)=>e?~(""+t.label).toLowerCase().indexOf((""+e).toLowerCase()):!0},size:String,renderSourceLabel:Function,renderTargetLabel:Function,renderSourceList:Function,renderTargetList:Function,"onUpdate:value":[Function,Array],onUpdateValue:[Function,Array],onChange:[Function,Array]}),Pce=je({name:"Transfer",props:Tce,setup(e){const{mergedClsPrefixRef:t}=vr(e),r=bt("Transfer","-transfer",Ece,Ile,e,t),i=gl(e),{mergedSizeRef:n,mergedDisabledRef:a}=i,o=re(()=>{const{value:z}=n,{self:{[Ze("itemHeight",z)]:F}}=r.value;return nn(F)}),{uncontrolledValueRef:s,mergedValueRef:l,targetValueSetRef:c,valueSetForCheckAllRef:u,valueSetForUncheckAllRef:d,valueSetForClearRef:h,filteredTgtOptionsRef:f,filteredSrcOptionsRef:p,targetOptionsRef:v,canNotSelectAnythingRef:m,canBeClearedRef:g,allCheckedRef:y,srcPatternRef:b,tgtPatternRef:x,mergedSrcFilterableRef:S,handleSrcFilterUpdateValue:w,handleTgtFilterUpdateValue:_}=Mce(e);function C(z){const{onUpdateValue:F,"onUpdate:value":H,onChange:N}=e,{nTriggerFormInput:U,nTriggerFormChange:ie}=i;F&&ct(F,z),H&&ct(H,z),N&&ct(N,z),s.value=z,U(),ie()}function A(){C([...u.value])}function M(){C([...d.value])}function P(){C([...h.value])}function T(z,F){C(z?(l.value||[]).concat(F):(l.value||[]).filter(H=>H!==F))}function R(z){C(z)}return xr(c0,{targetValueSetRef:c,mergedClsPrefixRef:t,disabledRef:a,mergedThemeRef:r,targetOptionsRef:v,canNotSelectAnythingRef:m,canBeClearedRef:g,allCheckedRef:y,srcOptionsLengthRef:re(()=>e.options.length),handleItemCheck:T,renderSourceLabelRef:pt(e,"renderSourceLabel"),renderTargetLabelRef:pt(e,"renderTargetLabel"),showSelectedRef:pt(e,"showSelected")}),{mergedClsPrefix:t,mergedDisabled:a,itemSize:o,isMounted:Yu(),mergedTheme:r,filteredSrcOpts:p,filteredTgtOpts:f,srcPattern:b,tgtPattern:x,mergedSize:n,mergedSrcFilterable:S,handleSrcFilterUpdateValue:w,handleTgtFilterUpdateValue:_,handleSourceCheckAll:A,handleSourceUncheckAll:M,handleTargetClearAll:P,handleItemCheck:T,handleChecked:R,cssVars:re(()=>{const{value:z}=n,{common:{cubicBezierEaseInOut:F},self:{borderRadius:H,borderColor:N,listColor:U,titleTextColor:ie,titleTextColorDisabled:te,extraTextColor:X,itemTextColor:W,itemColorPending:q,itemTextColorDisabled:$,titleFontWeight:le,closeColorHover:ee,closeColorPressed:Q,closeIconColor:ne,closeIconColorHover:V,closeIconColorPressed:ue,closeIconSize:ve,closeSize:Ce,dividerColor:G,extraTextColorDisabled:Z,[Ze("extraFontSize",z)]:de,[Ze("fontSize",z)]:Se,[Ze("titleFontSize",z)]:we,[Ze("itemHeight",z)]:_e,[Ze("headerHeight",z)]:Ee}}=r.value;return{"--n-bezier":F,"--n-border-color":N,"--n-border-radius":H,"--n-extra-font-size":de,"--n-font-size":Se,"--n-header-font-size":we,"--n-header-extra-text-color":X,"--n-header-extra-text-color-disabled":Z,"--n-header-font-weight":le,"--n-header-text-color":ie,"--n-header-text-color-disabled":te,"--n-item-color-pending":q,"--n-item-height":_e,"--n-item-text-color":W,"--n-item-text-color-disabled":$,"--n-list-color":U,"--n-header-height":Ee,"--n-close-size":Ce,"--n-close-icon-size":ve,"--n-close-color-hover":ee,"--n-close-color-pressed":Q,"--n-close-icon-color":ne,"--n-close-icon-color-hover":V,"--n-close-icon-color-pressed":ue,"--n-divider-color":G}})}},render(){const{mergedClsPrefix:e,renderSourceList:t,renderTargetList:r,mergedTheme:i,mergedSrcFilterable:n,targetFilterable:a}=this;return E("div",{class:[`${e}-transfer`,this.mergedDisabled&&`${e}-transfer--disabled`],style:this.cssVars},E("div",{class:`${e}-transfer-list ${e}-transfer-list--source`},E(qR,{source:!0,selectAllText:this.selectAllText,clearText:this.clearText,title:this.sourceTitle,onCheckedAll:this.handleSourceCheckAll,onClearAll:this.handleSourceUncheckAll,size:this.mergedSize}),E("div",{class:`${e}-transfer-list-body`},n?E(KR,{onUpdateValue:this.handleSrcFilterUpdateValue,value:this.srcPattern,disabled:this.mergedDisabled,placeholder:this.sourceFilterPlaceholder}):null,E("div",{class:`${e}-transfer-list-flex-container`},t?E(Sn,{theme:i.peers.Scrollbar,themeOverrides:i.peerOverrides.Scrollbar},{default:()=>t({onCheck:this.handleChecked,checkedOptions:this.filteredTgtOpts,pattern:this.srcPattern})}):E(XR,{source:!0,options:this.filteredSrcOpts,disabled:this.mergedDisabled,virtualScroll:this.virtualScroll,itemSize:this.itemSize}))),E("div",{class:`${e}-transfer-list__border`})),E("div",{class:`${e}-transfer-list ${e}-transfer-list--target`},E(qR,{onClearAll:this.handleTargetClearAll,size:this.mergedSize,title:this.targetTitle}),E("div",{class:`${e}-transfer-list-body`},a?E(KR,{onUpdateValue:this.handleTgtFilterUpdateValue,value:this.tgtPattern,disabled:this.mergedDisabled,placeholder:this.sourceFilterPlaceholder}):null,E("div",{class:`${e}-transfer-list-flex-container`},r?E(Sn,{theme:i.peers.Scrollbar,themeOverrides:i.peerOverrides.Scrollbar},{default:()=>r({onCheck:this.handleChecked,checkedOptions:this.filteredTgtOpts,pattern:this.tgtPattern})}):E(XR,{options:this.filteredTgtOpts,disabled:this.mergedDisabled,virtualScroll:this.virtualScroll,itemSize:this.itemSize}))),E("div",{class:`${e}-transfer-list__border`})))}}),Dce=oe("h",`
 font-size: var(--n-font-size);
 font-weight: var(--n-font-weight);
 margin: var(--n-margin);
 transition: color .3s var(--n-bezier);
 color: var(--n-text-color);
`,[ge("&:first-child",{marginTop:0}),xe("prefix-bar",{position:"relative",paddingLeft:"var(--n-prefix-width)"},[xe("align-text",{paddingLeft:0},[ge("&::before",{left:"calc(-1 * var(--n-prefix-width))"})]),ge("&::before",`
 content: "";
 width: var(--n-bar-width);
 border-radius: calc(var(--n-bar-width) / 2);
 transition: background-color .3s var(--n-bezier);
 left: 0;
 top: 0;
 bottom: 0;
 position: absolute;
 `),ge("&::before",{backgroundColor:"var(--n-bar-color)"})])]),Oce=Object.assign(Object.assign({},bt.props),{type:{type:String,default:"default"},prefix:String,alignText:Boolean}),nj=e=>je({name:`H${e}`,props:Oce,setup(t){const{mergedClsPrefixRef:r,inlineThemeDisabled:i}=vr(t),n=bt("Typography","-h",Dce,W6,t,r),a=re(()=>{const{type:s}=t,{common:{cubicBezierEaseInOut:l},self:{headerFontWeight:c,headerTextColor:u,[Ze("headerPrefixWidth",e)]:d,[Ze("headerFontSize",e)]:h,[Ze("headerMargin",e)]:f,[Ze("headerBarWidth",e)]:p,[Ze("headerBarColor",s)]:v}}=n.value;return{"--n-bezier":l,"--n-font-size":h,"--n-margin":f,"--n-bar-color":v,"--n-bar-width":p,"--n-font-weight":c,"--n-text-color":u,"--n-prefix-width":d}}),o=i?Dr(`h${e}`,re(()=>t.type[0]),a,t):void 0;return{mergedClsPrefix:r,cssVars:i?void 0:a,themeClass:o==null?void 0:o.themeClass,onRender:o==null?void 0:o.onRender}},render(){var t;const{prefix:r,alignText:i,mergedClsPrefix:n,cssVars:a,$slots:o}=this;return(t=this.onRender)===null||t===void 0||t.call(this),E(`h${e}`,{class:[`${n}-h`,`${n}-h${e}`,this.themeClass,{[`${n}-h--prefix-bar`]:r,[`${n}-h--align-text`]:i}],style:a},o)}}),QR=nj("3"),GA=nj("6"),Rce=oe("text",`
 transition: color .3s var(--n-bezier);
 color: var(--n-text-color);
`,[xe("strong",`
 font-weight: var(--n-font-weight-strong);
 `),xe("italic",{fontStyle:"italic"}),xe("underline",{textDecoration:"underline"}),xe("code",`
 line-height: 1.4;
 display: inline-block;
 font-family: var(--n-font-famliy-mono);
 transition: 
 color .3s var(--n-bezier),
 border-color .3s var(--n-bezier),
 background-color .3s var(--n-bezier);
 box-sizing: border-box;
 padding: .05em .35em 0 .35em;
 border-radius: var(--n-code-border-radius);
 font-size: .9em;
 color: var(--n-code-text-color);
 background-color: var(--n-code-color);
 border: var(--n-code-border);
 `)]),Ice=Object.assign(Object.assign({},bt.props),{code:Boolean,type:{type:String,default:"default"},delete:Boolean,strong:Boolean,italic:Boolean,underline:Boolean,depth:[String,Number],tag:String,as:{type:String,validator:()=>!0,default:void 0}}),Cd=je({name:"Text",props:Ice,setup(e){const{mergedClsPrefixRef:t,inlineThemeDisabled:r}=vr(e),i=bt("Typography","-text",Rce,W6,e,t),n=re(()=>{const{depth:o,type:s}=e,l=s==="default"?o===void 0?"textColor":`textColor${o}Depth`:Ze("textColor",s),{common:{fontWeightStrong:c,fontFamilyMono:u,cubicBezierEaseInOut:d},self:{codeTextColor:h,codeBorderRadius:f,codeColor:p,codeBorder:v,[l]:m}}=i.value;return{"--n-bezier":d,"--n-text-color":m,"--n-font-weight-strong":c,"--n-font-famliy-mono":u,"--n-code-border-radius":f,"--n-code-text-color":h,"--n-code-color":p,"--n-code-border":v}}),a=r?Dr("text",re(()=>`${e.type[0]}${e.depth||""}`),n,e):void 0;return{mergedClsPrefix:t,compitableTag:Sp(e,["as","tag"]),cssVars:r?void 0:n,themeClass:a==null?void 0:a.themeClass,onRender:a==null?void 0:a.onRender}},render(){var e,t,r;const{mergedClsPrefix:i}=this;(e=this.onRender)===null||e===void 0||e.call(this);const n=[`${i}-text`,this.themeClass,{[`${i}-text--code`]:this.code,[`${i}-text--delete`]:this.delete,[`${i}-text--strong`]:this.strong,[`${i}-text--italic`]:this.italic,[`${i}-text--underline`]:this.underline}],a=(r=(t=this.$slots).default)===null||r===void 0?void 0:r.call(t);return this.code?E("code",{class:n,style:this.cssVars},this.delete?E("del",null,a):a):this.delete?E("del",{class:n,style:this.cssVars},a):E(this.compitableTag||"span",{class:n,style:this.cssVars},a)}}),zce=je({__name:"App",setup(e){return(t,r)=>{const i=Gu("RouterView");return ht(),Ci(ze(fce),null,{default:Je(()=>[Le(i)]),_:1})}}});var kce=!1;/*!
 * pinia v2.1.7
 * (c) 2023 Eduardo San Martin Morote
 * @license MIT
 */let aj;const vw=e=>aj=e,oj=Symbol();function $A(e){return e&&typeof e=="object"&&Object.prototype.toString.call(e)==="[object Object]"&&typeof e.toJSON!="function"}var Nv;(function(e){e.direct="direct",e.patchObject="patch object",e.patchFunction="patch function"})(Nv||(Nv={}));function Lce(){const e=y5(!0),t=e.run(()=>me({}));let r=[],i=[];const n=xT({install(a){vw(n),n._a=a,a.provide(oj,n),a.config.globalProperties.$pinia=n,i.forEach(o=>r.push(o)),i=[]},use(a){return!this._a&&!kce?i.push(a):r.push(a),this},_p:r,_a:null,_e:e,_s:new Map,state:t});return n}const sj=()=>{};function ZR(e,t,r,i=sj){e.push(t);const n=()=>{const a=e.indexOf(t);a>-1&&(e.splice(a,1),i())};return!r&&b5()&&bG(n),n}function Yh(e,...t){e.slice().forEach(r=>{r(...t)})}const Bce=e=>e();function qA(e,t){e instanceof Map&&t instanceof Map&&t.forEach((r,i)=>e.set(i,r)),e instanceof Set&&t instanceof Set&&t.forEach(e.add,e);for(const r in t){if(!t.hasOwnProperty(r))continue;const i=t[r],n=e[r];$A(n)&&$A(i)&&e.hasOwnProperty(r)&&!Zi(i)&&!wu(i)?e[r]=qA(n,i):e[r]=i}return e}const Fce=Symbol();function Nce(e){return!$A(e)||!e.hasOwnProperty(Fce)}const{assign:Qc}=Object;function Uce(e){return!!(Zi(e)&&e.effect)}function jce(e,t,r,i){const{state:n,actions:a,getters:o}=t,s=r.state.value[e];let l;function c(){s||(r.state.value[e]=n?n():{});const u=B5(r.state.value[e]);return Qc(u,a,Object.keys(o||{}).reduce((d,h)=>(d[h]=xT(re(()=>{vw(r);const f=r._s.get(e);return o[h].call(f,f)})),d),{}))}return l=lj(e,c,t,r,i,!0),l}function lj(e,t,r={},i,n,a){let o;const s=Qc({actions:{}},r),l={deep:!0};let c,u,d=[],h=[],f;const p=i.state.value[e];!a&&!p&&(i.state.value[e]={}),me({});let v;function m(C){let A;c=u=!1,typeof C=="function"?(C(i.state.value[e]),A={type:Nv.patchFunction,storeId:e,events:f}):(qA(i.state.value[e],C),A={type:Nv.patchObject,payload:C,storeId:e,events:f});const M=v=Symbol();aa().then(()=>{v===M&&(c=!0)}),u=!0,Yh(d,A,i.state.value[e])}const g=a?function(){const{state:A}=r,M=A?A():{};this.$patch(P=>{Qc(P,M)})}:sj;function y(){o.stop(),d=[],h=[],i._s.delete(e)}function b(C,A){return function(){vw(i);const M=Array.from(arguments),P=[],T=[];function R(H){P.push(H)}function z(H){T.push(H)}Yh(h,{args:M,name:C,store:S,after:R,onError:z});let F;try{F=A.apply(this&&this.$id===e?this:S,M)}catch(H){throw Yh(T,H),H}return F instanceof Promise?F.then(H=>(Yh(P,H),H)).catch(H=>(Yh(T,H),Promise.reject(H))):(Yh(P,F),F)}}const x={_p:i,$id:e,$onAction:ZR.bind(null,h),$patch:m,$reset:g,$subscribe(C,A={}){const M=ZR(d,C,A.detached,()=>P()),P=o.run(()=>rr(()=>i.state.value[e],T=>{(A.flush==="sync"?u:c)&&C({storeId:e,type:Nv.direct,events:f},T)},Qc({},l,A)));return M},$dispose:y},S=Wu(x);i._s.set(e,S);const _=(i._a&&i._a.runWithContext||Bce)(()=>i._e.run(()=>(o=y5()).run(t)));for(const C in _){const A=_[C];if(Zi(A)&&!Uce(A)||wu(A))a||(p&&Nce(A)&&(Zi(A)?A.value=p[C]:qA(A,p[C])),i.state.value[e][C]=A);else if(typeof A=="function"){const M=b(C,A);_[C]=M,s.actions[C]=A}}return Qc(S,_),Qc(Sr(S),_),Object.defineProperty(S,"$state",{get:()=>i.state.value[e],set:C=>{m(A=>{Qc(A,C)})}}),i._p.forEach(C=>{Qc(S,o.run(()=>C({store:S,app:i._a,pinia:i,options:s})))}),p&&a&&r.hydrate&&r.hydrate(S.$state,p),c=!0,u=!0,S}function cj(e,t,r){let i,n;const a=typeof t=="function";typeof e=="string"?(i=e,n=a?r:t):(n=e,i=e.id);function o(s,l){const c=x$();return s=s||(c?_t(oj,null):null),s&&vw(s),s=aj,s._s.has(i)||(a?lj(i,t,n,s):jce(i,n,s)),s._s.get(i)}return o.$id=i,o}function bl(e){{e=Sr(e);const t={};for(const r in e){const i=e[r];(Zi(i)||wu(i))&&(t[r]=pt(e,r))}return t}}const Vce=Lce(),Hce="modulepreload",Wce=function(e){return"/DigitalTWINonFHIRFrontend/"+e},JR={},Cc=function(t,r,i){let n=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));n=Promise.all(r.map(s=>{if(s=Wce(s),s in JR)return;JR[s]=!0;const l=s.endsWith(".css"),c=l?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${s}"]${c}`))return;const u=document.createElement("link");if(u.rel=l?"stylesheet":Hce,l||(u.as="script",u.crossOrigin=""),u.href=s,o&&u.setAttribute("nonce",o),document.head.appendChild(u),l)return new Promise((d,h)=>{u.addEventListener("load",d),u.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${s}`)))})}))}return n.then(()=>t()).catch(a=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a})};/*!
  * vue-router v4.4.0
  * (c) 2024 Eduardo San Martin Morote
  * @license MIT
  */const Df=typeof document<"u";function Gce(e){return e.__esModule||e[Symbol.toStringTag]==="Module"}const ei=Object.assign;function YS(e,t){const r={};for(const i in t){const n=t[i];r[i]=ys(n)?n.map(e):e(n)}return r}const Uv=()=>{},ys=Array.isArray,uj=/#/g,$ce=/&/g,qce=/\//g,Yce=/=/g,Xce=/\?/g,dj=/\+/g,Kce=/%5B/g,Qce=/%5D/g,hj=/%5E/g,Zce=/%60/g,fj=/%7B/g,Jce=/%7C/g,pj=/%7D/g,eue=/%20/g;function AP(e){return encodeURI(""+e).replace(Jce,"|").replace(Kce,"[").replace(Qce,"]")}function tue(e){return AP(e).replace(fj,"{").replace(pj,"}").replace(hj,"^")}function YA(e){return AP(e).replace(dj,"%2B").replace(eue,"+").replace(uj,"%23").replace($ce,"%26").replace(Zce,"`").replace(fj,"{").replace(pj,"}").replace(hj,"^")}function rue(e){return YA(e).replace(Yce,"%3D")}function iue(e){return AP(e).replace(uj,"%23").replace(Xce,"%3F")}function nue(e){return e==null?"":iue(e).replace(qce,"%2F")}function bg(e){try{return decodeURIComponent(""+e)}catch{}return""+e}const aue=/\/$/,oue=e=>e.replace(aue,"");function XS(e,t,r="/"){let i,n={},a="",o="";const s=t.indexOf("#");let l=t.indexOf("?");return s<l&&s>=0&&(l=-1),l>-1&&(i=t.slice(0,l),a=t.slice(l+1,s>-1?s:t.length),n=e(a)),s>-1&&(i=i||t.slice(0,s),o=t.slice(s,t.length)),i=uue(i??t,r),{fullPath:i+(a&&"?")+a+o,path:i,query:n,hash:bg(o)}}function sue(e,t){const r=t.query?e(t.query):"";return t.path+(r&&"?")+r+(t.hash||"")}function eI(e,t){return!t||!e.toLowerCase().startsWith(t.toLowerCase())?e:e.slice(t.length)||"/"}function lue(e,t,r){const i=t.matched.length-1,n=r.matched.length-1;return i>-1&&i===n&&Op(t.matched[i],r.matched[n])&&mj(t.params,r.params)&&e(t.query)===e(r.query)&&t.hash===r.hash}function Op(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function mj(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(!cue(e[r],t[r]))return!1;return!0}function cue(e,t){return ys(e)?tI(e,t):ys(t)?tI(t,e):e===t}function tI(e,t){return ys(t)?e.length===t.length&&e.every((r,i)=>r===t[i]):e.length===1&&e[0]===t}function uue(e,t){if(e.startsWith("/"))return e;if(!e)return t;const r=t.split("/"),i=e.split("/"),n=i[i.length-1];(n===".."||n===".")&&i.push("");let a=r.length-1,o,s;for(o=0;o<i.length;o++)if(s=i[o],s!==".")if(s==="..")a>1&&a--;else break;return r.slice(0,a).join("/")+"/"+i.slice(o).join("/")}const Ic={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var xg;(function(e){e.pop="pop",e.push="push"})(xg||(xg={}));var jv;(function(e){e.back="back",e.forward="forward",e.unknown=""})(jv||(jv={}));function due(e){if(!e)if(Df){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),oue(e)}const hue=/^[^#]+#/;function fue(e,t){return e.replace(hue,"#")+t}function pue(e,t){const r=document.documentElement.getBoundingClientRect(),i=e.getBoundingClientRect();return{behavior:t.behavior,left:i.left-r.left-(t.left||0),top:i.top-r.top-(t.top||0)}}const gw=()=>({left:window.scrollX,top:window.scrollY});function mue(e){let t;if("el"in e){const r=e.el,i=typeof r=="string"&&r.startsWith("#"),n=typeof r=="string"?i?document.getElementById(r.slice(1)):document.querySelector(r):r;if(!n)return;t=pue(n,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.scrollX,t.top!=null?t.top:window.scrollY)}function rI(e,t){return(history.state?history.state.position-t:-1)+e}const XA=new Map;function vue(e,t){XA.set(e,t)}function gue(e){const t=XA.get(e);return XA.delete(e),t}let yue=()=>location.protocol+"//"+location.host;function vj(e,t){const{pathname:r,search:i,hash:n}=t,a=e.indexOf("#");if(a>-1){let s=n.includes(e.slice(a))?e.slice(a).length:1,l=n.slice(s);return l[0]!=="/"&&(l="/"+l),eI(l,"")}return eI(r,e)+i+n}function bue(e,t,r,i){let n=[],a=[],o=null;const s=({state:h})=>{const f=vj(e,location),p=r.value,v=t.value;let m=0;if(h){if(r.value=f,t.value=h,o&&o===p){o=null;return}m=v?h.position-v.position:0}else i(f);n.forEach(g=>{g(r.value,p,{delta:m,type:xg.pop,direction:m?m>0?jv.forward:jv.back:jv.unknown})})};function l(){o=r.value}function c(h){n.push(h);const f=()=>{const p=n.indexOf(h);p>-1&&n.splice(p,1)};return a.push(f),f}function u(){const{history:h}=window;h.state&&h.replaceState(ei({},h.state,{scroll:gw()}),"")}function d(){for(const h of a)h();a=[],window.removeEventListener("popstate",s),window.removeEventListener("beforeunload",u)}return window.addEventListener("popstate",s),window.addEventListener("beforeunload",u,{passive:!0}),{pauseListeners:l,listen:c,destroy:d}}function iI(e,t,r,i=!1,n=!1){return{back:e,current:t,forward:r,replaced:i,position:window.history.length,scroll:n?gw():null}}function xue(e){const{history:t,location:r}=window,i={value:vj(e,r)},n={value:t.state};n.value||a(i.value,{back:null,current:i.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function a(l,c,u){const d=e.indexOf("#"),h=d>-1?(r.host&&document.querySelector("base")?e:e.slice(d))+l:yue()+e+l;try{t[u?"replaceState":"pushState"](c,"",h),n.value=c}catch(f){console.error(f),r[u?"replace":"assign"](h)}}function o(l,c){const u=ei({},t.state,iI(n.value.back,l,n.value.forward,!0),c,{position:n.value.position});a(l,u,!0),i.value=l}function s(l,c){const u=ei({},n.value,t.state,{forward:l,scroll:gw()});a(u.current,u,!0);const d=ei({},iI(i.value,l,null),{position:u.position+1},c);a(l,d,!1),i.value=l}return{location:i,state:n,push:s,replace:o}}function wue(e){e=due(e);const t=xue(e),r=bue(e,t.state,t.location,t.replace);function i(a,o=!0){o||r.pauseListeners(),history.go(a)}const n=ei({location:"",base:e,go:i,createHref:fue.bind(null,e)},t,r);return Object.defineProperty(n,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(n,"state",{enumerable:!0,get:()=>t.state.value}),n}function Sue(e){return typeof e=="string"||e&&typeof e=="object"}function gj(e){return typeof e=="string"||typeof e=="symbol"}const yj=Symbol("");var nI;(function(e){e[e.aborted=4]="aborted",e[e.cancelled=8]="cancelled",e[e.duplicated=16]="duplicated"})(nI||(nI={}));function Rp(e,t){return ei(new Error,{type:e,[yj]:!0},t)}function Ml(e,t){return e instanceof Error&&yj in e&&(t==null||!!(e.type&t))}const aI="[^/]+?",Cue={sensitive:!1,strict:!1,start:!0,end:!0},_ue=/[.+*?^${}()[\]/\\]/g;function Aue(e,t){const r=ei({},Cue,t),i=[];let n=r.start?"^":"";const a=[];for(const c of e){const u=c.length?[]:[90];r.strict&&!c.length&&(n+="/");for(let d=0;d<c.length;d++){const h=c[d];let f=40+(r.sensitive?.25:0);if(h.type===0)d||(n+="/"),n+=h.value.replace(_ue,"\\$&"),f+=40;else if(h.type===1){const{value:p,repeatable:v,optional:m,regexp:g}=h;a.push({name:p,repeatable:v,optional:m});const y=g||aI;if(y!==aI){f+=10;try{new RegExp(`(${y})`)}catch(x){throw new Error(`Invalid custom RegExp for param "${p}" (${y}): `+x.message)}}let b=v?`((?:${y})(?:/(?:${y}))*)`:`(${y})`;d||(b=m&&c.length<2?`(?:/${b})`:"/"+b),m&&(b+="?"),n+=b,f+=20,m&&(f+=-8),v&&(f+=-20),y===".*"&&(f+=-50)}u.push(f)}i.push(u)}if(r.strict&&r.end){const c=i.length-1;i[c][i[c].length-1]+=.7000000000000001}r.strict||(n+="/?"),r.end?n+="$":r.strict&&(n+="(?:/|$)");const o=new RegExp(n,r.sensitive?"":"i");function s(c){const u=c.match(o),d={};if(!u)return null;for(let h=1;h<u.length;h++){const f=u[h]||"",p=a[h-1];d[p.name]=f&&p.repeatable?f.split("/"):f}return d}function l(c){let u="",d=!1;for(const h of e){(!d||!u.endsWith("/"))&&(u+="/"),d=!1;for(const f of h)if(f.type===0)u+=f.value;else if(f.type===1){const{value:p,repeatable:v,optional:m}=f,g=p in c?c[p]:"";if(ys(g)&&!v)throw new Error(`Provided param "${p}" is an array but it is not repeatable (* or + modifiers)`);const y=ys(g)?g.join("/"):g;if(!y)if(m)h.length<2&&(u.endsWith("/")?u=u.slice(0,-1):d=!0);else throw new Error(`Missing required param "${p}"`);u+=y}}return u||"/"}return{re:o,score:i,keys:a,parse:s,stringify:l}}function Mue(e,t){let r=0;for(;r<e.length&&r<t.length;){const i=t[r]-e[r];if(i)return i;r++}return e.length<t.length?e.length===1&&e[0]===80?-1:1:e.length>t.length?t.length===1&&t[0]===80?1:-1:0}function bj(e,t){let r=0;const i=e.score,n=t.score;for(;r<i.length&&r<n.length;){const a=Mue(i[r],n[r]);if(a)return a;r++}if(Math.abs(n.length-i.length)===1){if(oI(i))return 1;if(oI(n))return-1}return n.length-i.length}function oI(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const Eue={type:0,value:""},Tue=/[a-zA-Z0-9_]/;function Pue(e){if(!e)return[[]];if(e==="/")return[[Eue]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(f){throw new Error(`ERR (${r})/"${c}": ${f}`)}let r=0,i=r;const n=[];let a;function o(){a&&n.push(a),a=[]}let s=0,l,c="",u="";function d(){c&&(r===0?a.push({type:0,value:c}):r===1||r===2||r===3?(a.length>1&&(l==="*"||l==="+")&&t(`A repeatable param (${c}) must be alone in its segment. eg: '/:ids+.`),a.push({type:1,value:c,regexp:u,repeatable:l==="*"||l==="+",optional:l==="*"||l==="?"})):t("Invalid state to consume buffer"),c="")}function h(){c+=l}for(;s<e.length;){if(l=e[s++],l==="\\"&&r!==2){i=r,r=4;continue}switch(r){case 0:l==="/"?(c&&d(),o()):l===":"?(d(),r=1):h();break;case 4:h(),r=i;break;case 1:l==="("?r=2:Tue.test(l)?h():(d(),r=0,l!=="*"&&l!=="?"&&l!=="+"&&s--);break;case 2:l===")"?u[u.length-1]=="\\"?u=u.slice(0,-1)+l:r=3:u+=l;break;case 3:d(),r=0,l!=="*"&&l!=="?"&&l!=="+"&&s--,u="";break;default:t("Unknown state");break}}return r===2&&t(`Unfinished custom RegExp for param "${c}"`),d(),o(),n}function Due(e,t,r){const i=Aue(Pue(e.path),r),n=ei(i,{record:e,parent:t,children:[],alias:[]});return t&&!n.record.aliasOf==!t.record.aliasOf&&t.children.push(n),n}function Oue(e,t){const r=[],i=new Map;t=cI({strict:!1,end:!0,sensitive:!1},t);function n(d){return i.get(d)}function a(d,h,f){const p=!f,v=Rue(d);v.aliasOf=f&&f.record;const m=cI(t,d),g=[v];if("alias"in d){const x=typeof d.alias=="string"?[d.alias]:d.alias;for(const S of x)g.push(ei({},v,{components:f?f.record.components:v.components,path:S,aliasOf:f?f.record:v}))}let y,b;for(const x of g){const{path:S}=x;if(h&&S[0]!=="/"){const w=h.record.path,_=w[w.length-1]==="/"?"":"/";x.path=h.record.path+(S&&_+S)}if(y=Due(x,h,m),f?f.alias.push(y):(b=b||y,b!==y&&b.alias.push(y),p&&d.name&&!lI(y)&&o(d.name)),xj(y)&&l(y),v.children){const w=v.children;for(let _=0;_<w.length;_++)a(w[_],y,f&&f.children[_])}f=f||y}return b?()=>{o(b)}:Uv}function o(d){if(gj(d)){const h=i.get(d);h&&(i.delete(d),r.splice(r.indexOf(h),1),h.children.forEach(o),h.alias.forEach(o))}else{const h=r.indexOf(d);h>-1&&(r.splice(h,1),d.record.name&&i.delete(d.record.name),d.children.forEach(o),d.alias.forEach(o))}}function s(){return r}function l(d){const h=kue(d,r);r.splice(h,0,d),d.record.name&&!lI(d)&&i.set(d.record.name,d)}function c(d,h){let f,p={},v,m;if("name"in d&&d.name){if(f=i.get(d.name),!f)throw Rp(1,{location:d});m=f.record.name,p=ei(sI(h.params,f.keys.filter(b=>!b.optional).concat(f.parent?f.parent.keys.filter(b=>b.optional):[]).map(b=>b.name)),d.params&&sI(d.params,f.keys.map(b=>b.name))),v=f.stringify(p)}else if(d.path!=null)v=d.path,f=r.find(b=>b.re.test(v)),f&&(p=f.parse(v),m=f.record.name);else{if(f=h.name?i.get(h.name):r.find(b=>b.re.test(h.path)),!f)throw Rp(1,{location:d,currentLocation:h});m=f.record.name,p=ei({},h.params,d.params),v=f.stringify(p)}const g=[];let y=f;for(;y;)g.unshift(y.record),y=y.parent;return{name:m,path:v,params:p,matched:g,meta:zue(g)}}e.forEach(d=>a(d));function u(){r.length=0,i.clear()}return{addRoute:a,resolve:c,removeRoute:o,clearRoutes:u,getRoutes:s,getRecordMatcher:n}}function sI(e,t){const r={};for(const i of t)i in e&&(r[i]=e[i]);return r}function Rue(e){return{path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:void 0,beforeEnter:e.beforeEnter,props:Iue(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}}}function Iue(e){const t={},r=e.props||!1;if("component"in e)t.default=r;else for(const i in e.components)t[i]=typeof r=="object"?r[i]:r;return t}function lI(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function zue(e){return e.reduce((t,r)=>ei(t,r.meta),{})}function cI(e,t){const r={};for(const i in e)r[i]=i in t?t[i]:e[i];return r}function kue(e,t){let r=0,i=t.length;for(;r!==i;){const a=r+i>>1;bj(e,t[a])<0?i=a:r=a+1}const n=Lue(e);return n&&(i=t.lastIndexOf(n,i-1)),i}function Lue(e){let t=e;for(;t=t.parent;)if(xj(t)&&bj(e,t)===0)return t}function xj({record:e}){return!!(e.name||e.components&&Object.keys(e.components).length||e.redirect)}function Bue(e){const t={};if(e===""||e==="?")return t;const i=(e[0]==="?"?e.slice(1):e).split("&");for(let n=0;n<i.length;++n){const a=i[n].replace(dj," "),o=a.indexOf("="),s=bg(o<0?a:a.slice(0,o)),l=o<0?null:bg(a.slice(o+1));if(s in t){let c=t[s];ys(c)||(c=t[s]=[c]),c.push(l)}else t[s]=l}return t}function uI(e){let t="";for(let r in e){const i=e[r];if(r=rue(r),i==null){i!==void 0&&(t+=(t.length?"&":"")+r);continue}(ys(i)?i.map(a=>a&&YA(a)):[i&&YA(i)]).forEach(a=>{a!==void 0&&(t+=(t.length?"&":"")+r,a!=null&&(t+="="+a))})}return t}function Fue(e){const t={};for(const r in e){const i=e[r];i!==void 0&&(t[r]=ys(i)?i.map(n=>n==null?null:""+n):i==null?i:""+i)}return t}const Nue=Symbol(""),dI=Symbol(""),yw=Symbol(""),MP=Symbol(""),KA=Symbol("");function Rm(){let e=[];function t(i){return e.push(i),()=>{const n=e.indexOf(i);n>-1&&e.splice(n,1)}}function r(){e=[]}return{add:t,list:()=>e.slice(),reset:r}}function ru(e,t,r,i,n,a=o=>o()){const o=i&&(i.enterCallbacks[n]=i.enterCallbacks[n]||[]);return()=>new Promise((s,l)=>{const c=h=>{h===!1?l(Rp(4,{from:r,to:t})):h instanceof Error?l(h):Sue(h)?l(Rp(2,{from:t,to:h})):(o&&i.enterCallbacks[n]===o&&typeof h=="function"&&o.push(h),s())},u=a(()=>e.call(i&&i.instances[n],t,r,c));let d=Promise.resolve(u);e.length<3&&(d=d.then(c)),d.catch(h=>l(h))})}function KS(e,t,r,i,n=a=>a()){const a=[];for(const o of e)for(const s in o.components){let l=o.components[s];if(!(t!=="beforeRouteEnter"&&!o.instances[s]))if(Uue(l)){const u=(l.__vccOpts||l)[t];u&&a.push(ru(u,r,i,o,s,n))}else{let c=l();a.push(()=>c.then(u=>{if(!u)return Promise.reject(new Error(`Couldn't resolve component "${s}" at "${o.path}"`));const d=Gce(u)?u.default:u;o.components[s]=d;const f=(d.__vccOpts||d)[t];return f&&ru(f,r,i,o,s,n)()}))}}return a}function Uue(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function hI(e){const t=_t(yw),r=_t(MP),i=re(()=>{const l=ze(e.to);return t.resolve(l)}),n=re(()=>{const{matched:l}=i.value,{length:c}=l,u=l[c-1],d=r.matched;if(!u||!d.length)return-1;const h=d.findIndex(Op.bind(null,u));if(h>-1)return h;const f=fI(l[c-2]);return c>1&&fI(u)===f&&d[d.length-1].path!==f?d.findIndex(Op.bind(null,l[c-2])):h}),a=re(()=>n.value>-1&&Hue(r.params,i.value.params)),o=re(()=>n.value>-1&&n.value===r.matched.length-1&&mj(r.params,i.value.params));function s(l={}){return Vue(l)?t[ze(e.replace)?"replace":"push"](ze(e.to)).catch(Uv):Promise.resolve()}return{route:i,href:re(()=>i.value.href),isActive:a,isExactActive:o,navigate:s}}const jue=je({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:hI,setup(e,{slots:t}){const r=Wu(hI(e)),{options:i}=_t(yw),n=re(()=>({[pI(e.activeClass,i.linkActiveClass,"router-link-active")]:r.isActive,[pI(e.exactActiveClass,i.linkExactActiveClass,"router-link-exact-active")]:r.isExactActive}));return()=>{const a=t.default&&t.default(r);return e.custom?a:E("a",{"aria-current":r.isExactActive?e.ariaCurrentValue:null,href:r.href,onClick:r.navigate,class:n.value},a)}}}),wj=jue;function Vue(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function Hue(e,t){for(const r in t){const i=t[r],n=e[r];if(typeof i=="string"){if(i!==n)return!1}else if(!ys(n)||n.length!==i.length||i.some((a,o)=>a!==n[o]))return!1}return!0}function fI(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const pI=(e,t,r)=>e??t??r,Wue=je({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:r}){const i=_t(KA),n=re(()=>e.route||i.value),a=_t(dI,0),o=re(()=>{let c=ze(a);const{matched:u}=n.value;let d;for(;(d=u[c])&&!d.components;)c++;return c}),s=re(()=>n.value.matched[o.value]);xr(dI,re(()=>o.value+1)),xr(Nue,s),xr(KA,n);const l=me();return rr(()=>[l.value,s.value,e.name],([c,u,d],[h,f,p])=>{u&&(u.instances[d]=c,f&&f!==u&&c&&c===h&&(u.leaveGuards.size||(u.leaveGuards=f.leaveGuards),u.updateGuards.size||(u.updateGuards=f.updateGuards))),c&&u&&(!f||!Op(u,f)||!h)&&(u.enterCallbacks[d]||[]).forEach(v=>v(c))},{flush:"post"}),()=>{const c=n.value,u=e.name,d=s.value,h=d&&d.components[u];if(!h)return mI(r.default,{Component:h,route:c});const f=d.props[u],p=f?f===!0?c.params:typeof f=="function"?f(c):f:null,m=E(h,ei({},p,t,{onVnodeUnmounted:g=>{g.component.isUnmounted&&(d.instances[u]=null)},ref:l}));return mI(r.default,{Component:m,route:c})||m}}});function mI(e,t){if(!e)return null;const r=e(t);return r.length===1?r[0]:r}const Gue=Wue;function $ue(e){const t=Oue(e.routes,e),r=e.parseQuery||Bue,i=e.stringifyQuery||uI,n=e.history,a=Rm(),o=Rm(),s=Rm(),l=z5(Ic);let c=Ic;Df&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const u=YS.bind(null,Q=>""+Q),d=YS.bind(null,nue),h=YS.bind(null,bg);function f(Q,ne){let V,ue;return gj(Q)?(V=t.getRecordMatcher(Q),ue=ne):ue=Q,t.addRoute(ue,V)}function p(Q){const ne=t.getRecordMatcher(Q);ne&&t.removeRoute(ne)}function v(){return t.getRoutes().map(Q=>Q.record)}function m(Q){return!!t.getRecordMatcher(Q)}function g(Q,ne){if(ne=ei({},ne||l.value),typeof Q=="string"){const Z=XS(r,Q,ne.path),de=t.resolve({path:Z.path},ne),Se=n.createHref(Z.fullPath);return ei(Z,de,{params:h(de.params),hash:bg(Z.hash),redirectedFrom:void 0,href:Se})}let V;if(Q.path!=null)V=ei({},Q,{path:XS(r,Q.path,ne.path).path});else{const Z=ei({},Q.params);for(const de in Z)Z[de]==null&&delete Z[de];V=ei({},Q,{params:d(Z)}),ne.params=d(ne.params)}const ue=t.resolve(V,ne),ve=Q.hash||"";ue.params=u(h(ue.params));const Ce=sue(i,ei({},Q,{hash:tue(ve),path:ue.path})),G=n.createHref(Ce);return ei({fullPath:Ce,hash:ve,query:i===uI?Fue(Q.query):Q.query||{}},ue,{redirectedFrom:void 0,href:G})}function y(Q){return typeof Q=="string"?XS(r,Q,l.value.path):ei({},Q)}function b(Q,ne){if(c!==Q)return Rp(8,{from:ne,to:Q})}function x(Q){return _(Q)}function S(Q){return x(ei(y(Q),{replace:!0}))}function w(Q){const ne=Q.matched[Q.matched.length-1];if(ne&&ne.redirect){const{redirect:V}=ne;let ue=typeof V=="function"?V(Q):V;return typeof ue=="string"&&(ue=ue.includes("?")||ue.includes("#")?ue=y(ue):{path:ue},ue.params={}),ei({query:Q.query,hash:Q.hash,params:ue.path!=null?{}:Q.params},ue)}}function _(Q,ne){const V=c=g(Q),ue=l.value,ve=Q.state,Ce=Q.force,G=Q.replace===!0,Z=w(V);if(Z)return _(ei(y(Z),{state:typeof Z=="object"?ei({},ve,Z.state):ve,force:Ce,replace:G}),ne||V);const de=V;de.redirectedFrom=ne;let Se;return!Ce&&lue(i,ue,V)&&(Se=Rp(16,{to:de,from:ue}),X(ue,ue,!0,!1)),(Se?Promise.resolve(Se):M(de,ue)).catch(we=>Ml(we)?Ml(we,2)?we:te(we):U(we,de,ue)).then(we=>{if(we){if(Ml(we,2))return _(ei({replace:G},y(we.to),{state:typeof we.to=="object"?ei({},ve,we.to.state):ve,force:Ce}),ne||de)}else we=T(de,ue,!0,G,ve);return P(de,ue,we),we})}function C(Q,ne){const V=b(Q,ne);return V?Promise.reject(V):Promise.resolve()}function A(Q){const ne=$.values().next().value;return ne&&typeof ne.runWithContext=="function"?ne.runWithContext(Q):Q()}function M(Q,ne){let V;const[ue,ve,Ce]=que(Q,ne);V=KS(ue.reverse(),"beforeRouteLeave",Q,ne);for(const Z of ue)Z.leaveGuards.forEach(de=>{V.push(ru(de,Q,ne))});const G=C.bind(null,Q,ne);return V.push(G),ee(V).then(()=>{V=[];for(const Z of a.list())V.push(ru(Z,Q,ne));return V.push(G),ee(V)}).then(()=>{V=KS(ve,"beforeRouteUpdate",Q,ne);for(const Z of ve)Z.updateGuards.forEach(de=>{V.push(ru(de,Q,ne))});return V.push(G),ee(V)}).then(()=>{V=[];for(const Z of Ce)if(Z.beforeEnter)if(ys(Z.beforeEnter))for(const de of Z.beforeEnter)V.push(ru(de,Q,ne));else V.push(ru(Z.beforeEnter,Q,ne));return V.push(G),ee(V)}).then(()=>(Q.matched.forEach(Z=>Z.enterCallbacks={}),V=KS(Ce,"beforeRouteEnter",Q,ne,A),V.push(G),ee(V))).then(()=>{V=[];for(const Z of o.list())V.push(ru(Z,Q,ne));return V.push(G),ee(V)}).catch(Z=>Ml(Z,8)?Z:Promise.reject(Z))}function P(Q,ne,V){s.list().forEach(ue=>A(()=>ue(Q,ne,V)))}function T(Q,ne,V,ue,ve){const Ce=b(Q,ne);if(Ce)return Ce;const G=ne===Ic,Z=Df?history.state:{};V&&(ue||G?n.replace(Q.fullPath,ei({scroll:G&&Z&&Z.scroll},ve)):n.push(Q.fullPath,ve)),l.value=Q,X(Q,ne,V,G),te()}let R;function z(){R||(R=n.listen((Q,ne,V)=>{if(!le.listening)return;const ue=g(Q),ve=w(ue);if(ve){_(ei(ve,{replace:!0}),ue).catch(Uv);return}c=ue;const Ce=l.value;Df&&vue(rI(Ce.fullPath,V.delta),gw()),M(ue,Ce).catch(G=>Ml(G,12)?G:Ml(G,2)?(_(G.to,ue).then(Z=>{Ml(Z,20)&&!V.delta&&V.type===xg.pop&&n.go(-1,!1)}).catch(Uv),Promise.reject()):(V.delta&&n.go(-V.delta,!1),U(G,ue,Ce))).then(G=>{G=G||T(ue,Ce,!1),G&&(V.delta&&!Ml(G,8)?n.go(-V.delta,!1):V.type===xg.pop&&Ml(G,20)&&n.go(-1,!1)),P(ue,Ce,G)}).catch(Uv)}))}let F=Rm(),H=Rm(),N;function U(Q,ne,V){te(Q);const ue=H.list();return ue.length?ue.forEach(ve=>ve(Q,ne,V)):console.error(Q),Promise.reject(Q)}function ie(){return N&&l.value!==Ic?Promise.resolve():new Promise((Q,ne)=>{F.add([Q,ne])})}function te(Q){return N||(N=!Q,z(),F.list().forEach(([ne,V])=>Q?V(Q):ne()),F.reset()),Q}function X(Q,ne,V,ue){const{scrollBehavior:ve}=e;if(!Df||!ve)return Promise.resolve();const Ce=!V&&gue(rI(Q.fullPath,0))||(ue||!V)&&history.state&&history.state.scroll||null;return aa().then(()=>ve(Q,ne,Ce)).then(G=>G&&mue(G)).catch(G=>U(G,Q,ne))}const W=Q=>n.go(Q);let q;const $=new Set,le={currentRoute:l,listening:!0,addRoute:f,removeRoute:p,clearRoutes:t.clearRoutes,hasRoute:m,getRoutes:v,resolve:g,options:e,push:x,replace:S,go:W,back:()=>W(-1),forward:()=>W(1),beforeEach:a.add,beforeResolve:o.add,afterEach:s.add,onError:H.add,isReady:ie,install(Q){const ne=this;Q.component("RouterLink",wj),Q.component("RouterView",Gue),Q.config.globalProperties.$router=ne,Object.defineProperty(Q.config.globalProperties,"$route",{enumerable:!0,get:()=>ze(l)}),Df&&!q&&l.value===Ic&&(q=!0,x(n.location).catch(ve=>{}));const V={};for(const ve in Ic)Object.defineProperty(V,ve,{get:()=>l.value[ve],enumerable:!0});Q.provide(yw,ne),Q.provide(MP,O5(V)),Q.provide(KA,l);const ue=Q.unmount;$.add(Q),Q.unmount=function(){$.delete(Q),$.size<1&&(c=Ic,R&&R(),R=null,l.value=Ic,q=!1,N=!1),ue()}}};function ee(Q){return Q.reduce((ne,V)=>ne.then(()=>A(V)),Promise.resolve())}return le}function que(e,t){const r=[],i=[],n=[],a=Math.max(t.matched.length,e.matched.length);for(let o=0;o<a;o++){const s=t.matched[o];s&&(e.matched.find(c=>Op(c,s))?i.push(s):r.push(s));const l=e.matched[o];l&&(t.matched.find(c=>Op(c,l))||n.push(l))}return[r,i,n]}function Yue(){return _t(yw)}function u0(e){return _t(MP)}const cc=cj("folderPicker",()=>{const{root:e,folderPicker:t,folderDrop:r}=Xue();return{root:e,folderPicker:t,folderDrop:r}});function Xue(){const e=me(),t=async n=>{if(n.kind==="file")return n;n.children=[];const a=n.entries();for await(const o of a)n.children.push(await t(o[1]));return n};return{root:e,folderPicker:async n=>{try{if(!window.showDirectoryPicker){alert("Your browser is not support showDirectoryPicker");return}const a=await window.showDirectoryPicker();e.value=await t(a),e.value.category=n}catch(a){console.log(a)}},folderDrop:async(n,a)=>{try{if(n.kind==="file"){const o=await n.getAsFileSystemHandle();e.value=await t(o),e.value.category=a}}catch(o){console.log(o)}}}}const Kue={class:"text-3xl font-bold underline"},Que=je({__name:"FHIRView",setup(e){const{root:t}=bl(cc());return console.log("test",t),(r,i)=>(ht(),Pt("div",Kue," sda "))}}),Zue="/DigitalTWINonFHIRFrontend/assets/logo-CcfZXeu8.png",Jue=e=>(Y1("data-v-1c3669eb"),e=e(),X1(),e),ede=Jue(()=>st("h1",{class:"select-none heading"}," DigitalTWINs on FHIR ",-1)),tde=["src"],rde=je({__name:"AppLayoutHeader",setup(e){const t=me(window.innerWidth),r=()=>{t.value=window.innerWidth};return Or(()=>{window.addEventListener("resize",r)}),Qg(()=>{window.removeEventListener("resize",r)}),(i,n)=>{const a=Gu("RouterLink");return ht(),Ci(ze(Yd),{justify:"space-between",align:"center",style:{height:"100%",padding:"2px 20px"}},{default:Je(()=>[Le(a,{to:"/"},{default:Je(()=>[Le(ze(Yd),{class:"cursor-pointer flex flex-row items-center"},{default:Je(()=>[Le(ze(lP),{size:"medium",src:"4.png"}),ede]),_:1})]),_:1}),io(Le(ze(Yd),null,{default:Je(()=>[st("img",{class:"logo",src:ze(Zue),alt:""},null,8,tde)]),_:1},512),[[nh,t.value>699]])]),_:1})}}}),xl=(e,t)=>{const r=e.__vccOpts||e;for(const[i,n]of t)r[i]=n;return r},bw=xl(rde,[["__scopeId","data-v-1c3669eb"]]),ide={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},nde=st("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M256 112v288"},null,-1),ade=st("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M400 256H112"},null,-1),ode=[nde,ade],sde=je({name:"AddOutline",render:function(t,r){return ht(),Pt("svg",ide,ode)}}),lde={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},cde=st("path",{d:"M256 160c16-63.16 76.43-95.41 208-96a15.94 15.94 0 0 1 16 16v288a16 16 0 0 1-16 16c-128 0-177.45 25.81-208 64c-30.37-38-80-64-208-64c-9.88 0-16-8.05-16-17.93V80a15.94 15.94 0 0 1 16-16c131.57.59 192 32.84 208 96z",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),ude=st("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M256 160v288"},null,-1),dde=[cde,ude],hde=je({name:"BookOutline",render:function(t,r){return ht(),Pt("svg",lde,dde)}}),fde={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},pde=st("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"48",d:"M328 112L184 256l144 144"},null,-1),mde=[pde],vde=je({name:"ChevronBackOutline",render:function(t,r){return ht(),Pt("svg",fde,mde)}}),gde={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},yde=st("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"48",d:"M184 112l144 144l-144 144"},null,-1),bde=[yde],xde=je({name:"ChevronForwardOutline",render:function(t,r){return ht(),Pt("svg",gde,bde)}}),wde={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Sde=st("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M368 368L144 144"},null,-1),Cde=st("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M368 144L144 368"},null,-1),_de=[Sde,Cde],Ade=je({name:"CloseOutline",render:function(t,r){return ht(),Pt("svg",wde,_de)}}),Mde={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Ede=st("path",{d:"M456.7 242.27l-26.08-4.2a8 8 0 0 1-6.6-6.82c-.5-3.2-1-6.41-1.7-9.51a8.08 8.08 0 0 1 3.9-8.62l23.09-12.82a8.05 8.05 0 0 0 3.9-9.92l-4-11a7.94 7.94 0 0 0-9.4-5l-25.89 5a8 8 0 0 1-8.59-4.11q-2.25-4.2-4.8-8.41a8.16 8.16 0 0 1 .7-9.52l17.29-19.94a8 8 0 0 0 .3-10.62l-7.49-9a7.88 7.88 0 0 0-10.5-1.51l-22.69 13.63a8 8 0 0 1-9.39-.9c-2.4-2.11-4.9-4.21-7.4-6.22a8 8 0 0 1-2.5-9.11l9.4-24.75A8 8 0 0 0 365 78.77l-10.2-5.91a8 8 0 0 0-10.39 2.21l-16.64 20.84a7.15 7.15 0 0 1-8.5 2.5s-5.6-2.3-9.8-3.71A8 8 0 0 1 304 87l.4-26.45a8.07 8.07 0 0 0-6.6-8.42l-11.59-2a8.07 8.07 0 0 0-9.1 5.61l-8.6 25.05a8 8 0 0 1-7.79 5.41h-9.8a8.07 8.07 0 0 1-7.79-5.41l-8.6-25.05a8.07 8.07 0 0 0-9.1-5.61l-11.59 2a8.07 8.07 0 0 0-6.6 8.42l.4 26.45a8 8 0 0 1-5.49 7.71c-2.3.9-7.3 2.81-9.7 3.71c-2.8 1-6.1.2-8.8-2.91l-16.51-20.34A8 8 0 0 0 156.75 73l-10.2 5.91a7.94 7.94 0 0 0-3.3 10.09l9.4 24.75a8.06 8.06 0 0 1-2.5 9.11c-2.5 2-5 4.11-7.4 6.22a8 8 0 0 1-9.39.9L111 116.14a8 8 0 0 0-10.5 1.51l-7.49 9a8 8 0 0 0 .3 10.62l17.29 19.94a8 8 0 0 1 .7 9.52q-2.55 4-4.8 8.41a8.11 8.11 0 0 1-8.59 4.11l-25.89-5a8 8 0 0 0-9.4 5l-4 11a8.05 8.05 0 0 0 3.9 9.92L85.58 213a7.94 7.94 0 0 1 3.9 8.62c-.6 3.2-1.2 6.31-1.7 9.51a8.08 8.08 0 0 1-6.6 6.82l-26.08 4.2a8.09 8.09 0 0 0-7.1 7.92v11.72a7.86 7.86 0 0 0 7.1 7.92l26.08 4.2a8 8 0 0 1 6.6 6.82c.5 3.2 1 6.41 1.7 9.51a8.08 8.08 0 0 1-3.9 8.62L62.49 311.7a8.05 8.05 0 0 0-3.9 9.92l4 11a7.94 7.94 0 0 0 9.4 5l25.89-5a8 8 0 0 1 8.59 4.11q2.25 4.2 4.8 8.41a8.16 8.16 0 0 1-.7 9.52l-17.29 19.96a8 8 0 0 0-.3 10.62l7.49 9a7.88 7.88 0 0 0 10.5 1.51l22.69-13.63a8 8 0 0 1 9.39.9c2.4 2.11 4.9 4.21 7.4 6.22a8 8 0 0 1 2.5 9.11l-9.4 24.75a8 8 0 0 0 3.3 10.12l10.2 5.91a8 8 0 0 0 10.39-2.21l16.79-20.64c2.1-2.6 5.5-3.7 8.2-2.6c3.4 1.4 5.7 2.2 9.9 3.61a8 8 0 0 1 5.49 7.71l-.4 26.45a8.07 8.07 0 0 0 6.6 8.42l11.59 2a8.07 8.07 0 0 0 9.1-5.61l8.6-25a8 8 0 0 1 7.79-5.41h9.8a8.07 8.07 0 0 1 7.79 5.41l8.6 25a8.07 8.07 0 0 0 9.1 5.61l11.59-2a8.07 8.07 0 0 0 6.6-8.42l-.4-26.45a8 8 0 0 1 5.49-7.71c4.2-1.41 7-2.51 9.6-3.51s5.8-1 8.3 2.1l17 20.94A8 8 0 0 0 355 439l10.2-5.91a7.93 7.93 0 0 0 3.3-10.12l-9.4-24.75a8.08 8.08 0 0 1 2.5-9.12c2.5-2 5-4.1 7.4-6.21a8 8 0 0 1 9.39-.9L401 395.66a8 8 0 0 0 10.5-1.51l7.49-9a8 8 0 0 0-.3-10.62l-17.29-19.94a8 8 0 0 1-.7-9.52q2.55-4.05 4.8-8.41a8.11 8.11 0 0 1 8.59-4.11l25.89 5a8 8 0 0 0 9.4-5l4-11a8.05 8.05 0 0 0-3.9-9.92l-23.09-12.82a7.94 7.94 0 0 1-3.9-8.62c.6-3.2 1.2-6.31 1.7-9.51a8.08 8.08 0 0 1 6.6-6.82l26.08-4.2a8.09 8.09 0 0 0 7.1-7.92V250a8.25 8.25 0 0 0-7.27-7.73zM256 112a143.82 143.82 0 0 1 139.38 108.12A16 16 0 0 1 379.85 240H274.61a16 16 0 0 1-13.91-8.09l-52.1-91.71a16 16 0 0 1 9.85-23.39A146.94 146.94 0 0 1 256 112zM112 256a144 144 0 0 1 43.65-103.41a16 16 0 0 1 25.17 3.47L233.06 248a16 16 0 0 1 0 15.87l-52.67 91.7a16 16 0 0 1-25.18 3.36A143.94 143.94 0 0 1 112 256zm144 144a146.9 146.9 0 0 1-38.19-4.95a16 16 0 0 1-9.76-23.44l52.58-91.55a16 16 0 0 1 13.88-8H379.9a16 16 0 0 1 15.52 19.88A143.84 143.84 0 0 1 256 400z",fill:"currentColor"},null,-1),Tde=[Ede],Pde=je({name:"CogOutline",render:function(t,r){return ht(),Pt("svg",Mde,Tde)}}),Dde={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Ode=st("path",{d:"M416 221.25V416a48 48 0 0 1-48 48H144a48 48 0 0 1-48-48V96a48 48 0 0 1 48-48h98.75a32 32 0 0 1 22.62 9.37l141.26 141.26a32 32 0 0 1 9.37 22.62z",fill:"none",stroke:"currentColor","stroke-linejoin":"round","stroke-width":"32"},null,-1),Rde=st("path",{d:"M256 56v120a32 32 0 0 0 32 32h120",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),Ide=[Ode,Rde],zde=je({name:"DocumentOutline",render:function(t,r){return ht(),Pt("svg",Dde,Ide)}}),kde={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Lde=Z1('<path d="M464 256c0-114.87-93.13-208-208-208S48 141.13 48 256s93.13 208 208 208s208-93.13 208-208z" fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="32"></path><path d="M445.57 172.14c-16.06.1-14.48 29.73-34.49 15.75c-7.43-5.18-12-12.71-21.33-15c-8.15-2-16.5.08-24.55 1.47c-9.15 1.58-20 2.29-26.94 9.22c-6.71 6.67-10.26 15.62-17.4 22.33c-13.81 13-19.64 27.19-10.7 45.57c8.6 17.67 26.59 27.26 46 26c19.07-1.27 38.88-12.33 38.33 15.38c-.2 9.8 1.85 16.6 4.86 25.71c2.79 8.4 2.6 16.54 3.24 25.21c1.18 16.2 4.16 34.36 12.2 48.67l15-21.16c1.85-2.62 5.72-6.29 6.64-9.38c1.63-5.47-1.58-14.87-1.95-21s-.19-12.34-1.13-18.47c-1.32-8.59-6.4-16.64-7.1-25.13c-1.29-15.81 1.6-28.43-10.58-41.65c-11.76-12.75-29-15.81-45.47-13.22c-8.3 1.3-41.71 6.64-28.3-12.33c2.65-3.73 7.28-6.79 10.26-10.34c2.59-3.09 4.84-8.77 7.88-11.18s17-5.18 21-3.95s8.17 7 11.64 9.56a49.89 49.89 0 0 0 21.81 9.36c13.66 2 42.22-5.94 42-23.46c-.04-8.4-7.84-20.1-10.92-27.96z" fill="currentColor"></path><path d="M287.45 316.3c-5.33-22.44-35.82-29.94-52.26-42.11c-9.45-7-17.86-17.81-30.27-18.69c-5.72-.41-10.51.83-16.18-.64c-5.2-1.34-9.28-4.14-14.82-3.41c-10.35 1.36-16.88 12.42-28 10.92c-10.55-1.42-21.42-13.76-23.82-23.81c-3.08-12.92 7.14-17.11 18.09-18.26c4.57-.48 9.7-1 14.09.67c5.78 2.15 8.51 7.81 13.7 10.67c9.73 5.33 11.7-3.19 10.21-11.83c-2.23-12.94-4.83-18.22 6.71-27.12c8-6.14 14.84-10.58 13.56-21.61c-.76-6.48-4.31-9.41-1-15.86c2.51-4.91 9.4-9.34 13.89-12.27c11.59-7.56 49.65-7 34.1-28.16c-4.57-6.21-13-17.31-21-18.83c-10-1.89-14.44 9.27-21.41 14.19c-7.2 5.09-21.22 10.87-28.43 3c-9.7-10.59 6.43-14.07 10-21.46s-8.27-21.36-14.61-24.9l-29.81 33.43a41.52 41.52 0 0 0 8.34 31.86c5.93 7.63 15.37 10.08 15.8 20.5c.42 10-1.14 15.12-7.68 22.15c-2.83 3-4.83 7.26-7.71 10.07c-3.53 3.43-2.22 2.38-7.73 3.32c-10.36 1.75-19.18 4.45-29.19 7.21C95.34 199.94 93.8 172.69 86.2 162l-25 20.19c-.27 3.31 4.1 9.4 5.29 13c6.83 20.57 20.61 36.48 29.51 56.16c9.37 20.84 34.53 15.06 45.64 33.32c9.86 16.2-.67 36.71 6.71 53.67c5.36 12.31 18 15 26.72 24c8.91 9.09 8.72 21.53 10.08 33.36a305.22 305.22 0 0 0 7.45 41.28c1.21 4.69 2.32 10.89 5.53 14.76c2.2 2.66 9.75 4.95 6.7 5.83c4.26.7 11.85 4.68 15.4 1.76c4.68-3.84 3.43-15.66 4.24-21c2.43-15.9 10.39-31.45 21.13-43.35c10.61-11.74 25.15-19.69 34.11-33c8.73-12.98 11.36-30.49 7.74-45.68zm-33.39 26.32c-6 10.71-19.36 17.88-27.95 26.39c-2.33 2.31-7.29 10.31-10.21 8.58c-2.09-1.24-2.8-11.62-3.57-14a61.17 61.17 0 0 0-21.71-29.95c-3.13-2.37-10.89-5.45-12.68-8.7c-2-3.53-.2-11.86-.13-15.7c.11-5.6-2.44-14.91-1.06-20c1.6-5.87-1.48-2.33 3.77-3.49c2.77-.62 14.21 1.39 17.66 2.11c5.48 1.14 8.5 4.55 12.82 8c11.36 9.11 23.87 16.16 36.6 23.14c9.86 5.46 12.76 12.37 6.46 23.62z" fill="currentColor"></path><path d="M184.46 67.09c4.74 4.63 9.2 10.11 16.27 10.57c6.69.45 13-3.17 18.84 1.38c6.48 5 11.15 11.33 19.75 12.89c8.32 1.51 17.13-3.35 19.19-11.86c2-8.11-2.31-16.93-2.57-25.07c0-1.13.61-6.15-.17-7c-.58-.64-5.42.08-6.16.1q-8.13.24-16.22 1.12a207.1 207.1 0 0 0-57.18 14.65c2.43 1.68 5.48 2.35 8.25 3.22z" fill="currentColor"></path><path d="M356.4 123.27c8.49 0 17.11-3.8 14.37-13.62c-2.3-8.23-6.22-17.16-15.76-12.72c-6.07 2.82-14.67 10-15.38 17.12c-.81 8.08 11.11 9.22 16.77 9.22z" fill="currentColor"></path><path d="M349.62 166.24c8.67 5.19 21.53 2.75 28.07-4.66c5.11-5.8 8.12-15.87 17.31-15.86a15.4 15.4 0 0 1 10.82 4.41c3.8 3.93 3.05 7.62 3.86 12.54c1.81 11.05 13.66.63 16.75-3.65c2-2.79 4.71-6.93 3.8-10.56c-.84-3.39-4.8-7-6.56-10.11c-5.14-9-9.37-19.47-17.07-26.74c-7.41-7-16.52-6.19-23.55 1.08c-5.76 6-12.45 10.75-16.39 18.05c-2.78 5.13-5.91 7.58-11.54 8.91c-3.1.73-6.64 1-9.24 3.08c-7.24 5.7-3.12 19.39 3.74 23.51z" fill="currentColor"></path>',6),Bde=[Lde],Fde=je({name:"EarthOutline",render:function(t,r){return ht(),Pt("svg",kde,Bde)}}),Nde={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Ude=st("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M413.66 246.1H386a2 2 0 0 1-2-2v-77.24A38.86 38.86 0 0 0 345.14 128H267.9a2 2 0 0 1-2-2V98.34c0-27.14-21.5-49.86-48.64-50.33a49.53 49.53 0 0 0-50.4 49.51V126a2 2 0 0 1-2 2H87.62A39.74 39.74 0 0 0 48 167.62V238a2 2 0 0 0 2 2h26.91c29.37 0 53.68 25.48 54.09 54.85c.42 29.87-23.51 57.15-53.29 57.15H50a2 2 0 0 0-2 2v70.38A39.74 39.74 0 0 0 87.62 464H158a2 2 0 0 0 2-2v-20.93c0-30.28 24.75-56.35 55-57.06c30.1-.7 57 20.31 57 50.28V462a2 2 0 0 0 2 2h71.14A38.86 38.86 0 0 0 384 425.14v-78a2 2 0 0 1 2-2h28.48c27.63 0 49.52-22.67 49.52-50.4s-23.2-48.64-50.34-48.64z"},null,-1),jde=[Ude],Vde=je({name:"ExtensionPuzzleOutline",render:function(t,r){return ht(),Pt("svg",Nde,jde)}}),Hde={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Wde=st("path",{d:"M64 192v-72a40 40 0 0 1 40-40h75.89a40 40 0 0 1 22.19 6.72l27.84 18.56a40 40 0 0 0 22.19 6.72H408a40 40 0 0 1 40 40v40",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),Gde=st("path",{d:"M479.9 226.55L463.68 392a40 40 0 0 1-39.93 40H88.25a40 40 0 0 1-39.93-40L32.1 226.55A32 32 0 0 1 64 192h384.1a32 32 0 0 1 31.8 34.55z",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),$de=[Wde,Gde],qde=je({name:"FolderOpenOutline",render:function(t,r){return ht(),Pt("svg",Hde,$de)}}),Yde={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Xde=st("path",{d:"M440 432H72a40 40 0 0 1-40-40V120a40 40 0 0 1 40-40h75.89a40 40 0 0 1 22.19 6.72l27.84 18.56a40 40 0 0 0 22.19 6.72H440a40 40 0 0 1 40 40v240a40 40 0 0 1-40 40z",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),Kde=st("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M32 192h448"},null,-1),Qde=[Xde,Kde],Zde=je({name:"FolderOutline",render:function(t,r){return ht(),Pt("svg",Yde,Qde)}}),Jde={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},ehe=Z1('<path d="M467.51 248.83c-18.4-83.18-45.69-136.24-89.43-149.17A91.5 91.5 0 0 0 352 96c-26.89 0-48.11 16-96 16s-69.15-16-96-16a99.09 99.09 0 0 0-27.2 3.66C89 112.59 61.94 165.7 43.33 248.83c-19 84.91-15.56 152 21.58 164.88c26 9 49.25-9.61 71.27-37c25-31.2 55.79-40.8 119.82-40.8s93.62 9.6 118.66 40.8c22 27.41 46.11 45.79 71.42 37.16c41.02-14.01 40.44-79.13 21.43-165.04z" fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="32"></path><circle cx="292" cy="224" r="20" fill="currentColor"></circle><path d="M336 288a20 20 0 1 1 20-19.95A20 20 0 0 1 336 288z" fill="currentColor"></path><circle cx="336" cy="180" r="20" fill="currentColor"></circle><circle cx="380" cy="224" r="20" fill="currentColor"></circle><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M160 176v96"></path><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M208 224h-96"></path>',7),the=[ehe],rhe=je({name:"GameControllerOutline",render:function(t,r){return ht(),Pt("svg",Jde,the)}}),ihe={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},nhe=st("rect",{x:"48",y:"48",width:"176",height:"176",rx:"20",ry:"20",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),ahe=st("rect",{x:"288",y:"48",width:"176",height:"176",rx:"20",ry:"20",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),ohe=st("rect",{x:"48",y:"288",width:"176",height:"176",rx:"20",ry:"20",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),she=st("rect",{x:"288",y:"288",width:"176",height:"176",rx:"20",ry:"20",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),lhe=[nhe,ahe,ohe,she],che=je({name:"GridOutline",render:function(t,r){return ht(),Pt("svg",ihe,lhe)}}),uhe={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},dhe=st("rect",{x:"48",y:"96",width:"416",height:"304",rx:"32.14",ry:"32.14",fill:"none",stroke:"currentColor","stroke-linejoin":"round","stroke-width":"32"},null,-1),hhe=st("path",{stroke:"currentColor","stroke-linecap":"round","stroke-miterlimit":"10","stroke-width":"32",d:"M16 416h480",fill:"currentColor"},null,-1),fhe=[dhe,hhe],phe=je({name:"LaptopOutline",render:function(t,r){return ht(),Pt("svg",uhe,fhe)}}),mhe={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},vhe=Z1('<rect x="32" y="96" width="64" height="368" rx="16" ry="16" fill="none" stroke="currentColor" stroke-linejoin="round" stroke-width="32"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M112 224h128"></path><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M112 400h128"></path><rect x="112" y="160" width="128" height="304" rx="16" ry="16" fill="none" stroke="currentColor" stroke-linejoin="round" stroke-width="32"></rect><rect x="256" y="48" width="96" height="416" rx="16" ry="16" fill="none" stroke="currentColor" stroke-linejoin="round" stroke-width="32"></rect><path d="M422.46 96.11l-40.4 4.25c-11.12 1.17-19.18 11.57-17.93 23.1l34.92 321.59c1.26 11.53 11.37 20 22.49 18.84l40.4-4.25c11.12-1.17 19.18-11.57 17.93-23.1L445 115c-1.31-11.58-11.42-20.06-22.54-18.89z" fill="none" stroke="currentColor" stroke-linejoin="round" stroke-width="32"></path>',6),ghe=[vhe],yhe=je({name:"LibraryOutline",render:function(t,r){return ht(),Pt("svg",mhe,ghe)}}),bhe={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},xhe=st("path",{d:"M344 144c-3.92 52.87-44 96-88 96s-84.15-43.12-88-96c-4-55 35-96 88-96s92 42 88 96z",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),whe=st("path",{d:"M256 304c-87 0-175.3 48-191.64 138.6C62.39 453.52 68.57 464 80 464h352c11.44 0 17.62-10.48 15.65-21.4C431.3 352 343 304 256 304z",fill:"none",stroke:"currentColor","stroke-miterlimit":"10","stroke-width":"32"},null,-1),She=[xhe,whe],Che=je({name:"PersonOutline",render:function(t,r){return ht(),Pt("svg",bhe,She)}}),_he={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Ahe=st("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M400 256H112"},null,-1),Mhe=[Ahe],Ehe=je({name:"RemoveOutline",render:function(t,r){return ht(),Pt("svg",_he,Mhe)}}),The={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Phe=st("path",{d:"M461.81 53.81a4.4 4.4 0 0 0-3.3-3.39c-54.38-13.3-180 34.09-248.13 102.17a294.9 294.9 0 0 0-33.09 39.08c-21-1.9-42-.3-59.88 7.5c-50.49 22.2-65.18 80.18-69.28 105.07a9 9 0 0 0 9.8 10.4l81.07-8.9a180.29 180.29 0 0 0 1.1 18.3a18.15 18.15 0 0 0 5.3 11.09l31.39 31.39a18.15 18.15 0 0 0 11.1 5.3a179.91 179.91 0 0 0 18.19 1.1l-8.89 81a9 9 0 0 0 10.39 9.79c24.9-4 83-18.69 105.07-69.17c7.8-17.9 9.4-38.79 7.6-59.69a293.91 293.91 0 0 0 39.19-33.09c68.38-68 115.47-190.86 102.37-247.95zM298.66 213.67a42.7 42.7 0 1 1 60.38 0a42.65 42.65 0 0 1-60.38 0z",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),Dhe=st("path",{d:"M109.64 352a45.06 45.06 0 0 0-26.35 12.84C65.67 382.52 64 448 64 448s65.52-1.67 83.15-19.31A44.73 44.73 0 0 0 160 402.32",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),Ohe=[Phe,Dhe],Rhe=je({name:"RocketOutline",render:function(t,r){return ht(),Pt("svg",The,Ohe)}}),Ihe={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},zhe=st("path",{d:"M398.57 80H113.43v16S87.51 272 256 272S398.57 96 398.57 96z",fill:"none",stroke:"currentColor","stroke-linejoin":"round","stroke-width":"32"},null,-1),khe=st("path",{fill:"none",stroke:"currentColor","stroke-linejoin":"round","stroke-width":"32",d:"M256 272v160"},null,-1),Lhe=st("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M352 432H160"},null,-1),Bhe=st("path",{fill:"none",stroke:"currentColor","stroke-linejoin":"round","stroke-width":"32",d:"M112 160h288"},null,-1),Fhe=[zhe,khe,Lhe,Bhe],Nhe=je({name:"WineOutline",render:function(t,r){return ht(),Pt("svg",Ihe,Fhe)}});function d0(){return{BookIcon:hde,PersonIcon:Che,WineIcon:Nhe,EarthIcon:Fde,CogIcon:Pde,RocketIcon:Rhe,LaptopIcon:phe,LibraryIcon:yhe,GameControllerIcon:rhe,ExtensionPuzzleIcon:Vde,FolderIcon:Zde,FolderOpenIcon:qde,DocumentIcon:zde,GridIcon:che,AddIcon:sde,CloseIcon:Ade,RemoveIcon:Ehe,ChevronBackIcon:vde,ChevronForwardIcon:xde}}const Sj=je({__name:"AppLayoutFooter",setup(e){const{EarthIcon:t}=d0();return(r,i)=>(ht(),Ci(ze(Yd),{justify:"center",align:"center",style:{height:"100%",padding:"5px 0px"}},{default:Je(()=>[Le(ze(Tp),{size:"20"},{default:Je(()=>[Le(ze(t))]),_:1}),Le(ze(Fle),{type:"error"},{default:Je(()=>[Lr(" Auckland Bioengineering Institute ")]),_:1})]),_:1}))}}),Cj=je({__name:"AppLayoutSider",props:{width:{default:240},menuOptions:{default:()=>[]}},setup(e){const r=Wu(e),{menuOptions:i,width:n}=B5(r);return(a,o)=>(ht(),Ci(ze(Kle),{"collapse-mode":"width","collapsed-width":60,width:ze(n),"native-scrollbar":!1,bordered:"","show-trigger":"bar",class:"bg-transparent shadow-sm"},{default:Je(()=>[Le(ze(oce),{"collapsed-width":64,"collapsed-icon-size":22,options:ze(i)},null,8,["options"])]),_:1},8,["width"]))}});function _j(){return{renderIcon:r=>()=>E(Tp,null,{default:()=>E(r)}),generateRouterLabel:(r,i,n,a)=>E(wj,{to:{name:r,params:n||{},query:a||{}}},{default:()=>i})}}const Uhe=je({__name:"AppLayoutFHIR",setup(e){const{renderIcon:t,generateRouterLabel:r}=_j(),{CogIcon:i,LaptopIcon:n,GameControllerIcon:a,RocketIcon:o,LibraryIcon:s}=d0(),l=[{label:()=>r("index-annotator","Go Annotator"),key:"overall",icon:t(n)},{label:()=>r("fhir-measurements","Measurements"),key:"primary-measurements",disabled:!1,icon:t(s),children:[{label:()=>r("fhir-patients","Patients"),key:"patients",icon:t(i)}]},{label:"Workflow",key:"Workflow",icon:t(o),children:[{label:"Workflow Tools",key:"tools",icon:t(i)},{label:"Workflow process",key:"process",icon:t(a)}]}];return(c,u)=>{const d=Gu("router-view");return ht(),Ci(ze(ip),{style:{height:"100vh"}},{default:Je(()=>[Le(ze(q6),{bordered:"",style:{height:"8vh"}},{default:Je(()=>[Le(bw)]),_:1}),Le(ze(ip),{position:"absolute",style:{top:"8vh",bottom:"5vh"},"has-sider":"",onDragover:u[0]||(u[0]=Nf(()=>{},["prevent"])),onDrop:u[1]||(u[1]=h=>h.preventDefault())},{default:Je(()=>[Le(Cj,{"menu-options":l}),Le(ze(ip),{"content-style":"padding: 10px 50px;","native-scrollbar":!1},{default:Je(()=>[Le(d)]),_:1})]),_:1}),Le(ze(Y6),{position:"absolute",style:{height:"5vh"},bordered:""},{default:Je(()=>[Le(Sj)]),_:1})]),_:1})}}});function Aj(e,t){return function(){return e.apply(t,arguments)}}const{toString:jhe}=Object.prototype,{getPrototypeOf:EP}=Object,xw=(e=>t=>{const r=jhe.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),_s=e=>(e=e.toLowerCase(),t=>xw(t)===e),ww=e=>t=>typeof t===e,{isArray:im}=Array,wg=ww("undefined");function Vhe(e){return e!==null&&!wg(e)&&e.constructor!==null&&!wg(e.constructor)&&No(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Mj=_s("ArrayBuffer");function Hhe(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&Mj(e.buffer),t}const Whe=ww("string"),No=ww("function"),Ej=ww("number"),Sw=e=>e!==null&&typeof e=="object",Ghe=e=>e===!0||e===!1,Lb=e=>{if(xw(e)!=="object")return!1;const t=EP(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},$he=_s("Date"),qhe=_s("File"),Yhe=_s("Blob"),Xhe=_s("FileList"),Khe=e=>Sw(e)&&No(e.pipe),Qhe=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||No(e.append)&&((t=xw(e))==="formdata"||t==="object"&&No(e.toString)&&e.toString()==="[object FormData]"))},Zhe=_s("URLSearchParams"),[Jhe,efe,tfe,rfe]=["ReadableStream","Request","Response","Headers"].map(_s),ife=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function h0(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let i,n;if(typeof e!="object"&&(e=[e]),im(e))for(i=0,n=e.length;i<n;i++)t.call(null,e[i],i,e);else{const a=r?Object.getOwnPropertyNames(e):Object.keys(e),o=a.length;let s;for(i=0;i<o;i++)s=a[i],t.call(null,e[s],s,e)}}function Tj(e,t){t=t.toLowerCase();const r=Object.keys(e);let i=r.length,n;for(;i-- >0;)if(n=r[i],t===n.toLowerCase())return n;return null}const Pj=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Dj=e=>!wg(e)&&e!==Pj;function QA(){const{caseless:e}=Dj(this)&&this||{},t={},r=(i,n)=>{const a=e&&Tj(t,n)||n;Lb(t[a])&&Lb(i)?t[a]=QA(t[a],i):Lb(i)?t[a]=QA({},i):im(i)?t[a]=i.slice():t[a]=i};for(let i=0,n=arguments.length;i<n;i++)arguments[i]&&h0(arguments[i],r);return t}const nfe=(e,t,r,{allOwnKeys:i}={})=>(h0(t,(n,a)=>{r&&No(n)?e[a]=Aj(n,r):e[a]=n},{allOwnKeys:i}),e),afe=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),ofe=(e,t,r,i)=>{e.prototype=Object.create(t.prototype,i),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},sfe=(e,t,r,i)=>{let n,a,o;const s={};if(t=t||{},e==null)return t;do{for(n=Object.getOwnPropertyNames(e),a=n.length;a-- >0;)o=n[a],(!i||i(o,e,t))&&!s[o]&&(t[o]=e[o],s[o]=!0);e=r!==!1&&EP(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},lfe=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const i=e.indexOf(t,r);return i!==-1&&i===r},cfe=e=>{if(!e)return null;if(im(e))return e;let t=e.length;if(!Ej(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},ufe=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&EP(Uint8Array)),dfe=(e,t)=>{const i=(e&&e[Symbol.iterator]).call(e);let n;for(;(n=i.next())&&!n.done;){const a=n.value;t.call(e,a[0],a[1])}},hfe=(e,t)=>{let r;const i=[];for(;(r=e.exec(t))!==null;)i.push(r);return i},ffe=_s("HTMLFormElement"),pfe=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,i,n){return i.toUpperCase()+n}),vI=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),mfe=_s("RegExp"),Oj=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),i={};h0(r,(n,a)=>{let o;(o=t(n,a,e))!==!1&&(i[a]=o||n)}),Object.defineProperties(e,i)},vfe=e=>{Oj(e,(t,r)=>{if(No(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const i=e[r];if(No(i)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},gfe=(e,t)=>{const r={},i=n=>{n.forEach(a=>{r[a]=!0})};return im(e)?i(e):i(String(e).split(t)),r},yfe=()=>{},bfe=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t,QS="abcdefghijklmnopqrstuvwxyz",gI="0123456789",Rj={DIGIT:gI,ALPHA:QS,ALPHA_DIGIT:QS+QS.toUpperCase()+gI},xfe=(e=16,t=Rj.ALPHA_DIGIT)=>{let r="";const{length:i}=t;for(;e--;)r+=t[Math.random()*i|0];return r};function wfe(e){return!!(e&&No(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const Sfe=e=>{const t=new Array(10),r=(i,n)=>{if(Sw(i)){if(t.indexOf(i)>=0)return;if(!("toJSON"in i)){t[n]=i;const a=im(i)?[]:{};return h0(i,(o,s)=>{const l=r(o,n+1);!wg(l)&&(a[s]=l)}),t[n]=void 0,a}}return i};return r(e,0)},Cfe=_s("AsyncFunction"),_fe=e=>e&&(Sw(e)||No(e))&&No(e.then)&&No(e.catch),Xe={isArray:im,isArrayBuffer:Mj,isBuffer:Vhe,isFormData:Qhe,isArrayBufferView:Hhe,isString:Whe,isNumber:Ej,isBoolean:Ghe,isObject:Sw,isPlainObject:Lb,isReadableStream:Jhe,isRequest:efe,isResponse:tfe,isHeaders:rfe,isUndefined:wg,isDate:$he,isFile:qhe,isBlob:Yhe,isRegExp:mfe,isFunction:No,isStream:Khe,isURLSearchParams:Zhe,isTypedArray:ufe,isFileList:Xhe,forEach:h0,merge:QA,extend:nfe,trim:ife,stripBOM:afe,inherits:ofe,toFlatObject:sfe,kindOf:xw,kindOfTest:_s,endsWith:lfe,toArray:cfe,forEachEntry:dfe,matchAll:hfe,isHTMLForm:ffe,hasOwnProperty:vI,hasOwnProp:vI,reduceDescriptors:Oj,freezeMethods:vfe,toObjectSet:gfe,toCamelCase:pfe,noop:yfe,toFiniteNumber:bfe,findKey:Tj,global:Pj,isContextDefined:Dj,ALPHABET:Rj,generateString:xfe,isSpecCompliantForm:wfe,toJSONObject:Sfe,isAsyncFn:Cfe,isThenable:_fe};function pr(e,t,r,i,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),i&&(this.request=i),n&&(this.response=n)}Xe.inherits(pr,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Xe.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const Ij=pr.prototype,zj={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{zj[e]={value:e}});Object.defineProperties(pr,zj);Object.defineProperty(Ij,"isAxiosError",{value:!0});pr.from=(e,t,r,i,n,a)=>{const o=Object.create(Ij);return Xe.toFlatObject(e,o,function(l){return l!==Error.prototype},s=>s!=="isAxiosError"),pr.call(o,e.message,t,r,i,n),o.cause=e,o.name=e.name,a&&Object.assign(o,a),o};const Afe=null;function ZA(e){return Xe.isPlainObject(e)||Xe.isArray(e)}function kj(e){return Xe.endsWith(e,"[]")?e.slice(0,-2):e}function yI(e,t,r){return e?e.concat(t).map(function(n,a){return n=kj(n),!r&&a?"["+n+"]":n}).join(r?".":""):t}function Mfe(e){return Xe.isArray(e)&&!e.some(ZA)}const Efe=Xe.toFlatObject(Xe,{},null,function(t){return/^is[A-Z]/.test(t)});function Cw(e,t,r){if(!Xe.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=Xe.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(v,m){return!Xe.isUndefined(m[v])});const i=r.metaTokens,n=r.visitor||u,a=r.dots,o=r.indexes,l=(r.Blob||typeof Blob<"u"&&Blob)&&Xe.isSpecCompliantForm(t);if(!Xe.isFunction(n))throw new TypeError("visitor must be a function");function c(p){if(p===null)return"";if(Xe.isDate(p))return p.toISOString();if(!l&&Xe.isBlob(p))throw new pr("Blob is not supported. Use a Buffer instead.");return Xe.isArrayBuffer(p)||Xe.isTypedArray(p)?l&&typeof Blob=="function"?new Blob([p]):Buffer.from(p):p}function u(p,v,m){let g=p;if(p&&!m&&typeof p=="object"){if(Xe.endsWith(v,"{}"))v=i?v:v.slice(0,-2),p=JSON.stringify(p);else if(Xe.isArray(p)&&Mfe(p)||(Xe.isFileList(p)||Xe.endsWith(v,"[]"))&&(g=Xe.toArray(p)))return v=kj(v),g.forEach(function(b,x){!(Xe.isUndefined(b)||b===null)&&t.append(o===!0?yI([v],x,a):o===null?v:v+"[]",c(b))}),!1}return ZA(p)?!0:(t.append(yI(m,v,a),c(p)),!1)}const d=[],h=Object.assign(Efe,{defaultVisitor:u,convertValue:c,isVisitable:ZA});function f(p,v){if(!Xe.isUndefined(p)){if(d.indexOf(p)!==-1)throw Error("Circular reference detected in "+v.join("."));d.push(p),Xe.forEach(p,function(g,y){(!(Xe.isUndefined(g)||g===null)&&n.call(t,g,Xe.isString(y)?y.trim():y,v,h))===!0&&f(g,v?v.concat(y):[y])}),d.pop()}}if(!Xe.isObject(e))throw new TypeError("data must be an object");return f(e),t}function bI(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(i){return t[i]})}function TP(e,t){this._pairs=[],e&&Cw(e,this,t)}const Lj=TP.prototype;Lj.append=function(t,r){this._pairs.push([t,r])};Lj.toString=function(t){const r=t?function(i){return t.call(this,i,bI)}:bI;return this._pairs.map(function(n){return r(n[0])+"="+r(n[1])},"").join("&")};function Tfe(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Bj(e,t,r){if(!t)return e;const i=r&&r.encode||Tfe,n=r&&r.serialize;let a;if(n?a=n(t,r):a=Xe.isURLSearchParams(t)?t.toString():new TP(t,r).toString(i),a){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+a}return e}class xI{constructor(){this.handlers=[]}use(t,r,i){return this.handlers.push({fulfilled:t,rejected:r,synchronous:i?i.synchronous:!1,runWhen:i?i.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){Xe.forEach(this.handlers,function(i){i!==null&&t(i)})}}const Fj={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Pfe=typeof URLSearchParams<"u"?URLSearchParams:TP,Dfe=typeof FormData<"u"?FormData:null,Ofe=typeof Blob<"u"?Blob:null,Rfe={isBrowser:!0,classes:{URLSearchParams:Pfe,FormData:Dfe,Blob:Ofe},protocols:["http","https","file","blob","url","data"]},PP=typeof window<"u"&&typeof document<"u",Ife=(e=>PP&&["ReactNative","NativeScript","NS"].indexOf(e)<0)(typeof navigator<"u"&&navigator.product),zfe=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",kfe=PP&&window.location.href||"http://localhost",Lfe=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:PP,hasStandardBrowserEnv:Ife,hasStandardBrowserWebWorkerEnv:zfe,origin:kfe},Symbol.toStringTag,{value:"Module"})),ps={...Lfe,...Rfe};function Bfe(e,t){return Cw(e,new ps.classes.URLSearchParams,Object.assign({visitor:function(r,i,n,a){return ps.isNode&&Xe.isBuffer(r)?(this.append(i,r.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)}},t))}function Ffe(e){return Xe.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function Nfe(e){const t={},r=Object.keys(e);let i;const n=r.length;let a;for(i=0;i<n;i++)a=r[i],t[a]=e[a];return t}function Nj(e){function t(r,i,n,a){let o=r[a++];if(o==="__proto__")return!0;const s=Number.isFinite(+o),l=a>=r.length;return o=!o&&Xe.isArray(n)?n.length:o,l?(Xe.hasOwnProp(n,o)?n[o]=[n[o],i]:n[o]=i,!s):((!n[o]||!Xe.isObject(n[o]))&&(n[o]=[]),t(r,i,n[o],a)&&Xe.isArray(n[o])&&(n[o]=Nfe(n[o])),!s)}if(Xe.isFormData(e)&&Xe.isFunction(e.entries)){const r={};return Xe.forEachEntry(e,(i,n)=>{t(Ffe(i),n,r,0)}),r}return null}function Ufe(e,t,r){if(Xe.isString(e))try{return(t||JSON.parse)(e),Xe.trim(e)}catch(i){if(i.name!=="SyntaxError")throw i}return(r||JSON.stringify)(e)}const f0={transitional:Fj,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const i=r.getContentType()||"",n=i.indexOf("application/json")>-1,a=Xe.isObject(t);if(a&&Xe.isHTMLForm(t)&&(t=new FormData(t)),Xe.isFormData(t))return n?JSON.stringify(Nj(t)):t;if(Xe.isArrayBuffer(t)||Xe.isBuffer(t)||Xe.isStream(t)||Xe.isFile(t)||Xe.isBlob(t)||Xe.isReadableStream(t))return t;if(Xe.isArrayBufferView(t))return t.buffer;if(Xe.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let s;if(a){if(i.indexOf("application/x-www-form-urlencoded")>-1)return Bfe(t,this.formSerializer).toString();if((s=Xe.isFileList(t))||i.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return Cw(s?{"files[]":t}:t,l&&new l,this.formSerializer)}}return a||n?(r.setContentType("application/json",!1),Ufe(t)):t}],transformResponse:[function(t){const r=this.transitional||f0.transitional,i=r&&r.forcedJSONParsing,n=this.responseType==="json";if(Xe.isResponse(t)||Xe.isReadableStream(t))return t;if(t&&Xe.isString(t)&&(i&&!this.responseType||n)){const o=!(r&&r.silentJSONParsing)&&n;try{return JSON.parse(t)}catch(s){if(o)throw s.name==="SyntaxError"?pr.from(s,pr.ERR_BAD_RESPONSE,this,null,this.response):s}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ps.classes.FormData,Blob:ps.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Xe.forEach(["delete","get","head","post","put","patch"],e=>{f0.headers[e]={}});const jfe=Xe.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Vfe=e=>{const t={};let r,i,n;return e&&e.split(`
`).forEach(function(o){n=o.indexOf(":"),r=o.substring(0,n).trim().toLowerCase(),i=o.substring(n+1).trim(),!(!r||t[r]&&jfe[r])&&(r==="set-cookie"?t[r]?t[r].push(i):t[r]=[i]:t[r]=t[r]?t[r]+", "+i:i)}),t},wI=Symbol("internals");function Im(e){return e&&String(e).trim().toLowerCase()}function Bb(e){return e===!1||e==null?e:Xe.isArray(e)?e.map(Bb):String(e)}function Hfe(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;for(;i=r.exec(e);)t[i[1]]=i[2];return t}const Wfe=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function ZS(e,t,r,i,n){if(Xe.isFunction(i))return i.call(this,t,r);if(n&&(t=r),!!Xe.isString(t)){if(Xe.isString(i))return t.indexOf(i)!==-1;if(Xe.isRegExp(i))return i.test(t)}}function Gfe(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,i)=>r.toUpperCase()+i)}function $fe(e,t){const r=Xe.toCamelCase(" "+t);["get","set","has"].forEach(i=>{Object.defineProperty(e,i+r,{value:function(n,a,o){return this[i].call(this,t,n,a,o)},configurable:!0})})}class to{constructor(t){t&&this.set(t)}set(t,r,i){const n=this;function a(s,l,c){const u=Im(l);if(!u)throw new Error("header name must be a non-empty string");const d=Xe.findKey(n,u);(!d||n[d]===void 0||c===!0||c===void 0&&n[d]!==!1)&&(n[d||l]=Bb(s))}const o=(s,l)=>Xe.forEach(s,(c,u)=>a(c,u,l));if(Xe.isPlainObject(t)||t instanceof this.constructor)o(t,r);else if(Xe.isString(t)&&(t=t.trim())&&!Wfe(t))o(Vfe(t),r);else if(Xe.isHeaders(t))for(const[s,l]of t.entries())a(l,s,i);else t!=null&&a(r,t,i);return this}get(t,r){if(t=Im(t),t){const i=Xe.findKey(this,t);if(i){const n=this[i];if(!r)return n;if(r===!0)return Hfe(n);if(Xe.isFunction(r))return r.call(this,n,i);if(Xe.isRegExp(r))return r.exec(n);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=Im(t),t){const i=Xe.findKey(this,t);return!!(i&&this[i]!==void 0&&(!r||ZS(this,this[i],i,r)))}return!1}delete(t,r){const i=this;let n=!1;function a(o){if(o=Im(o),o){const s=Xe.findKey(i,o);s&&(!r||ZS(i,i[s],s,r))&&(delete i[s],n=!0)}}return Xe.isArray(t)?t.forEach(a):a(t),n}clear(t){const r=Object.keys(this);let i=r.length,n=!1;for(;i--;){const a=r[i];(!t||ZS(this,this[a],a,t,!0))&&(delete this[a],n=!0)}return n}normalize(t){const r=this,i={};return Xe.forEach(this,(n,a)=>{const o=Xe.findKey(i,a);if(o){r[o]=Bb(n),delete r[a];return}const s=t?Gfe(a):String(a).trim();s!==a&&delete r[a],r[s]=Bb(n),i[s]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return Xe.forEach(this,(i,n)=>{i!=null&&i!==!1&&(r[n]=t&&Xe.isArray(i)?i.join(", "):i)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const i=new this(t);return r.forEach(n=>i.set(n)),i}static accessor(t){const i=(this[wI]=this[wI]={accessors:{}}).accessors,n=this.prototype;function a(o){const s=Im(o);i[s]||($fe(n,o),i[s]=!0)}return Xe.isArray(t)?t.forEach(a):a(t),this}}to.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Xe.reduceDescriptors(to.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(i){this[r]=i}}});Xe.freezeMethods(to);function JS(e,t){const r=this||f0,i=t||r,n=to.from(i.headers);let a=i.data;return Xe.forEach(e,function(s){a=s.call(r,a,n.normalize(),t?t.status:void 0)}),n.normalize(),a}function Uj(e){return!!(e&&e.__CANCEL__)}function nm(e,t,r){pr.call(this,e??"canceled",pr.ERR_CANCELED,t,r),this.name="CanceledError"}Xe.inherits(nm,pr,{__CANCEL__:!0});function jj(e,t,r){const i=r.config.validateStatus;!r.status||!i||i(r.status)?e(r):t(new pr("Request failed with status code "+r.status,[pr.ERR_BAD_REQUEST,pr.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function qfe(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function Yfe(e,t){e=e||10;const r=new Array(e),i=new Array(e);let n=0,a=0,o;return t=t!==void 0?t:1e3,function(l){const c=Date.now(),u=i[a];o||(o=c),r[n]=l,i[n]=c;let d=a,h=0;for(;d!==n;)h+=r[d++],d=d%e;if(n=(n+1)%e,n===a&&(a=(a+1)%e),c-o<t)return;const f=u&&c-u;return f?Math.round(h*1e3/f):void 0}}function Xfe(e,t){let r=0;const i=1e3/t;let n=null;return function(){const o=this===!0,s=Date.now();if(o||s-r>i)return n&&(clearTimeout(n),n=null),r=s,e.apply(null,arguments);n||(n=setTimeout(()=>(n=null,r=Date.now(),e.apply(null,arguments)),i-(s-r)))}}const Px=(e,t,r=3)=>{let i=0;const n=Yfe(50,250);return Xfe(a=>{const o=a.loaded,s=a.lengthComputable?a.total:void 0,l=o-i,c=n(l),u=o<=s;i=o;const d={loaded:o,total:s,progress:s?o/s:void 0,bytes:l,rate:c||void 0,estimated:c&&s&&u?(s-o)/c:void 0,event:a,lengthComputable:s!=null};d[t?"download":"upload"]=!0,e(d)},r)},Kfe=ps.hasStandardBrowserEnv?function(){const t=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a");let i;function n(a){let o=a;return t&&(r.setAttribute("href",o),o=r.href),r.setAttribute("href",o),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:r.pathname.charAt(0)==="/"?r.pathname:"/"+r.pathname}}return i=n(window.location.href),function(o){const s=Xe.isString(o)?n(o):o;return s.protocol===i.protocol&&s.host===i.host}}():function(){return function(){return!0}}(),Qfe=ps.hasStandardBrowserEnv?{write(e,t,r,i,n,a){const o=[e+"="+encodeURIComponent(t)];Xe.isNumber(r)&&o.push("expires="+new Date(r).toGMTString()),Xe.isString(i)&&o.push("path="+i),Xe.isString(n)&&o.push("domain="+n),a===!0&&o.push("secure"),document.cookie=o.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Zfe(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function Jfe(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function Vj(e,t){return e&&!Zfe(t)?Jfe(e,t):t}const SI=e=>e instanceof to?{...e}:e;function dh(e,t){t=t||{};const r={};function i(c,u,d){return Xe.isPlainObject(c)&&Xe.isPlainObject(u)?Xe.merge.call({caseless:d},c,u):Xe.isPlainObject(u)?Xe.merge({},u):Xe.isArray(u)?u.slice():u}function n(c,u,d){if(Xe.isUndefined(u)){if(!Xe.isUndefined(c))return i(void 0,c,d)}else return i(c,u,d)}function a(c,u){if(!Xe.isUndefined(u))return i(void 0,u)}function o(c,u){if(Xe.isUndefined(u)){if(!Xe.isUndefined(c))return i(void 0,c)}else return i(void 0,u)}function s(c,u,d){if(d in t)return i(c,u);if(d in e)return i(void 0,c)}const l={url:a,method:a,data:a,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:s,headers:(c,u)=>n(SI(c),SI(u),!0)};return Xe.forEach(Object.keys(Object.assign({},e,t)),function(u){const d=l[u]||n,h=d(e[u],t[u],u);Xe.isUndefined(h)&&d!==s||(r[u]=h)}),r}const Hj=e=>{const t=dh({},e);let{data:r,withXSRFToken:i,xsrfHeaderName:n,xsrfCookieName:a,headers:o,auth:s}=t;t.headers=o=to.from(o),t.url=Bj(Vj(t.baseURL,t.url),e.params,e.paramsSerializer),s&&o.set("Authorization","Basic "+btoa((s.username||"")+":"+(s.password?unescape(encodeURIComponent(s.password)):"")));let l;if(Xe.isFormData(r)){if(ps.hasStandardBrowserEnv||ps.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((l=o.getContentType())!==!1){const[c,...u]=l?l.split(";").map(d=>d.trim()).filter(Boolean):[];o.setContentType([c||"multipart/form-data",...u].join("; "))}}if(ps.hasStandardBrowserEnv&&(i&&Xe.isFunction(i)&&(i=i(t)),i||i!==!1&&Kfe(t.url))){const c=n&&a&&Qfe.read(a);c&&o.set(n,c)}return t},epe=typeof XMLHttpRequest<"u",tpe=epe&&function(e){return new Promise(function(r,i){const n=Hj(e);let a=n.data;const o=to.from(n.headers).normalize();let{responseType:s}=n,l;function c(){n.cancelToken&&n.cancelToken.unsubscribe(l),n.signal&&n.signal.removeEventListener("abort",l)}let u=new XMLHttpRequest;u.open(n.method.toUpperCase(),n.url,!0),u.timeout=n.timeout;function d(){if(!u)return;const f=to.from("getAllResponseHeaders"in u&&u.getAllResponseHeaders()),v={data:!s||s==="text"||s==="json"?u.responseText:u.response,status:u.status,statusText:u.statusText,headers:f,config:e,request:u};jj(function(g){r(g),c()},function(g){i(g),c()},v),u=null}"onloadend"in u?u.onloadend=d:u.onreadystatechange=function(){!u||u.readyState!==4||u.status===0&&!(u.responseURL&&u.responseURL.indexOf("file:")===0)||setTimeout(d)},u.onabort=function(){u&&(i(new pr("Request aborted",pr.ECONNABORTED,n,u)),u=null)},u.onerror=function(){i(new pr("Network Error",pr.ERR_NETWORK,n,u)),u=null},u.ontimeout=function(){let p=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded";const v=n.transitional||Fj;n.timeoutErrorMessage&&(p=n.timeoutErrorMessage),i(new pr(p,v.clarifyTimeoutError?pr.ETIMEDOUT:pr.ECONNABORTED,n,u)),u=null},a===void 0&&o.setContentType(null),"setRequestHeader"in u&&Xe.forEach(o.toJSON(),function(p,v){u.setRequestHeader(v,p)}),Xe.isUndefined(n.withCredentials)||(u.withCredentials=!!n.withCredentials),s&&s!=="json"&&(u.responseType=n.responseType),typeof n.onDownloadProgress=="function"&&u.addEventListener("progress",Px(n.onDownloadProgress,!0)),typeof n.onUploadProgress=="function"&&u.upload&&u.upload.addEventListener("progress",Px(n.onUploadProgress)),(n.cancelToken||n.signal)&&(l=f=>{u&&(i(!f||f.type?new nm(null,e,u):f),u.abort(),u=null)},n.cancelToken&&n.cancelToken.subscribe(l),n.signal&&(n.signal.aborted?l():n.signal.addEventListener("abort",l)));const h=qfe(n.url);if(h&&ps.protocols.indexOf(h)===-1){i(new pr("Unsupported protocol "+h+":",pr.ERR_BAD_REQUEST,e));return}u.send(a||null)})},rpe=(e,t)=>{let r=new AbortController,i;const n=function(l){if(!i){i=!0,o();const c=l instanceof Error?l:this.reason;r.abort(c instanceof pr?c:new nm(c instanceof Error?c.message:c))}};let a=t&&setTimeout(()=>{n(new pr(`timeout ${t} of ms exceeded`,pr.ETIMEDOUT))},t);const o=()=>{e&&(a&&clearTimeout(a),a=null,e.forEach(l=>{l&&(l.removeEventListener?l.removeEventListener("abort",n):l.unsubscribe(n))}),e=null)};e.forEach(l=>l&&l.addEventListener&&l.addEventListener("abort",n));const{signal:s}=r;return s.unsubscribe=o,[s,()=>{a&&clearTimeout(a),a=null}]},ipe=function*(e,t){let r=e.byteLength;if(!t||r<t){yield e;return}let i=0,n;for(;i<r;)n=i+t,yield e.slice(i,n),i=n},npe=async function*(e,t,r){for await(const i of e)yield*ipe(ArrayBuffer.isView(i)?i:await r(String(i)),t)},CI=(e,t,r,i,n)=>{const a=npe(e,t,n);let o=0;return new ReadableStream({type:"bytes",async pull(s){const{done:l,value:c}=await a.next();if(l){s.close(),i();return}let u=c.byteLength;r&&r(o+=u),s.enqueue(new Uint8Array(c))},cancel(s){return i(s),a.return()}},{highWaterMark:2})},_I=(e,t)=>{const r=e!=null;return i=>setTimeout(()=>t({lengthComputable:r,total:e,loaded:i}))},_w=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",Wj=_w&&typeof ReadableStream=="function",JA=_w&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),ape=Wj&&(()=>{let e=!1;const t=new Request(ps.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t})(),AI=64*1024,eM=Wj&&!!(()=>{try{return Xe.isReadableStream(new Response("").body)}catch{}})(),Dx={stream:eM&&(e=>e.body)};_w&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!Dx[t]&&(Dx[t]=Xe.isFunction(e[t])?r=>r[t]():(r,i)=>{throw new pr(`Response type '${t}' is not supported`,pr.ERR_NOT_SUPPORT,i)})})})(new Response);const ope=async e=>{if(e==null)return 0;if(Xe.isBlob(e))return e.size;if(Xe.isSpecCompliantForm(e))return(await new Request(e).arrayBuffer()).byteLength;if(Xe.isArrayBufferView(e))return e.byteLength;if(Xe.isURLSearchParams(e)&&(e=e+""),Xe.isString(e))return(await JA(e)).byteLength},spe=async(e,t)=>{const r=Xe.toFiniteNumber(e.getContentLength());return r??ope(t)},lpe=_w&&(async e=>{let{url:t,method:r,data:i,signal:n,cancelToken:a,timeout:o,onDownloadProgress:s,onUploadProgress:l,responseType:c,headers:u,withCredentials:d="same-origin",fetchOptions:h}=Hj(e);c=c?(c+"").toLowerCase():"text";let[f,p]=n||a||o?rpe([n,a],o):[],v,m;const g=()=>{!v&&setTimeout(()=>{f&&f.unsubscribe()}),v=!0};let y;try{if(l&&ape&&r!=="get"&&r!=="head"&&(y=await spe(u,i))!==0){let w=new Request(t,{method:"POST",body:i,duplex:"half"}),_;Xe.isFormData(i)&&(_=w.headers.get("content-type"))&&u.setContentType(_),w.body&&(i=CI(w.body,AI,_I(y,Px(l)),null,JA))}Xe.isString(d)||(d=d?"cors":"omit"),m=new Request(t,{...h,signal:f,method:r.toUpperCase(),headers:u.normalize().toJSON(),body:i,duplex:"half",withCredentials:d});let b=await fetch(m);const x=eM&&(c==="stream"||c==="response");if(eM&&(s||x)){const w={};["status","statusText","headers"].forEach(C=>{w[C]=b[C]});const _=Xe.toFiniteNumber(b.headers.get("content-length"));b=new Response(CI(b.body,AI,s&&_I(_,Px(s,!0)),x&&g,JA),w)}c=c||"text";let S=await Dx[Xe.findKey(Dx,c)||"text"](b,e);return!x&&g(),p&&p(),await new Promise((w,_)=>{jj(w,_,{data:S,headers:to.from(b.headers),status:b.status,statusText:b.statusText,config:e,request:m})})}catch(b){throw g(),b&&b.name==="TypeError"&&/fetch/i.test(b.message)?Object.assign(new pr("Network Error",pr.ERR_NETWORK,e,m),{cause:b.cause||b}):pr.from(b,b&&b.code,e,m)}}),tM={http:Afe,xhr:tpe,fetch:lpe};Xe.forEach(tM,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const MI=e=>`- ${e}`,cpe=e=>Xe.isFunction(e)||e===null||e===!1,Gj={getAdapter:e=>{e=Xe.isArray(e)?e:[e];const{length:t}=e;let r,i;const n={};for(let a=0;a<t;a++){r=e[a];let o;if(i=r,!cpe(r)&&(i=tM[(o=String(r)).toLowerCase()],i===void 0))throw new pr(`Unknown adapter '${o}'`);if(i)break;n[o||"#"+a]=i}if(!i){const a=Object.entries(n).map(([s,l])=>`adapter ${s} `+(l===!1?"is not supported by the environment":"is not available in the build"));let o=t?a.length>1?`since :
`+a.map(MI).join(`
`):" "+MI(a[0]):"as no adapter specified";throw new pr("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return i},adapters:tM};function eC(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new nm(null,e)}function EI(e){return eC(e),e.headers=to.from(e.headers),e.data=JS.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),Gj.getAdapter(e.adapter||f0.adapter)(e).then(function(i){return eC(e),i.data=JS.call(e,e.transformResponse,i),i.headers=to.from(i.headers),i},function(i){return Uj(i)||(eC(e),i&&i.response&&(i.response.data=JS.call(e,e.transformResponse,i.response),i.response.headers=to.from(i.response.headers))),Promise.reject(i)})}const $j="1.7.2",DP={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{DP[e]=function(i){return typeof i===e||"a"+(t<1?"n ":" ")+e}});const TI={};DP.transitional=function(t,r,i){function n(a,o){return"[Axios v"+$j+"] Transitional option '"+a+"'"+o+(i?". "+i:"")}return(a,o,s)=>{if(t===!1)throw new pr(n(o," has been removed"+(r?" in "+r:"")),pr.ERR_DEPRECATED);return r&&!TI[o]&&(TI[o]=!0,console.warn(n(o," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(a,o,s):!0}};function upe(e,t,r){if(typeof e!="object")throw new pr("options must be an object",pr.ERR_BAD_OPTION_VALUE);const i=Object.keys(e);let n=i.length;for(;n-- >0;){const a=i[n],o=t[a];if(o){const s=e[a],l=s===void 0||o(s,a,e);if(l!==!0)throw new pr("option "+a+" must be "+l,pr.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new pr("Unknown option "+a,pr.ERR_BAD_OPTION)}}const rM={assertOptions:upe,validators:DP},zc=rM.validators;class Xd{constructor(t){this.defaults=t,this.interceptors={request:new xI,response:new xI}}async request(t,r){try{return await this._request(t,r)}catch(i){if(i instanceof Error){let n;Error.captureStackTrace?Error.captureStackTrace(n={}):n=new Error;const a=n.stack?n.stack.replace(/^.+\n/,""):"";try{i.stack?a&&!String(i.stack).endsWith(a.replace(/^.+\n.+\n/,""))&&(i.stack+=`
`+a):i.stack=a}catch{}}throw i}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=dh(this.defaults,r);const{transitional:i,paramsSerializer:n,headers:a}=r;i!==void 0&&rM.assertOptions(i,{silentJSONParsing:zc.transitional(zc.boolean),forcedJSONParsing:zc.transitional(zc.boolean),clarifyTimeoutError:zc.transitional(zc.boolean)},!1),n!=null&&(Xe.isFunction(n)?r.paramsSerializer={serialize:n}:rM.assertOptions(n,{encode:zc.function,serialize:zc.function},!0)),r.method=(r.method||this.defaults.method||"get").toLowerCase();let o=a&&Xe.merge(a.common,a[r.method]);a&&Xe.forEach(["delete","get","head","post","put","patch","common"],p=>{delete a[p]}),r.headers=to.concat(o,a);const s=[];let l=!0;this.interceptors.request.forEach(function(v){typeof v.runWhen=="function"&&v.runWhen(r)===!1||(l=l&&v.synchronous,s.unshift(v.fulfilled,v.rejected))});const c=[];this.interceptors.response.forEach(function(v){c.push(v.fulfilled,v.rejected)});let u,d=0,h;if(!l){const p=[EI.bind(this),void 0];for(p.unshift.apply(p,s),p.push.apply(p,c),h=p.length,u=Promise.resolve(r);d<h;)u=u.then(p[d++],p[d++]);return u}h=s.length;let f=r;for(d=0;d<h;){const p=s[d++],v=s[d++];try{f=p(f)}catch(m){v.call(this,m);break}}try{u=EI.call(this,f)}catch(p){return Promise.reject(p)}for(d=0,h=c.length;d<h;)u=u.then(c[d++],c[d++]);return u}getUri(t){t=dh(this.defaults,t);const r=Vj(t.baseURL,t.url);return Bj(r,t.params,t.paramsSerializer)}}Xe.forEach(["delete","get","head","options"],function(t){Xd.prototype[t]=function(r,i){return this.request(dh(i||{},{method:t,url:r,data:(i||{}).data}))}});Xe.forEach(["post","put","patch"],function(t){function r(i){return function(a,o,s){return this.request(dh(s||{},{method:t,headers:i?{"Content-Type":"multipart/form-data"}:{},url:a,data:o}))}}Xd.prototype[t]=r(),Xd.prototype[t+"Form"]=r(!0)});class OP{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(a){r=a});const i=this;this.promise.then(n=>{if(!i._listeners)return;let a=i._listeners.length;for(;a-- >0;)i._listeners[a](n);i._listeners=null}),this.promise.then=n=>{let a;const o=new Promise(s=>{i.subscribe(s),a=s}).then(n);return o.cancel=function(){i.unsubscribe(a)},o},t(function(a,o,s){i.reason||(i.reason=new nm(a,o,s),r(i.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}static source(){let t;return{token:new OP(function(n){t=n}),cancel:t}}}function dpe(e){return function(r){return e.apply(null,r)}}function hpe(e){return Xe.isObject(e)&&e.isAxiosError===!0}const iM={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(iM).forEach(([e,t])=>{iM[t]=e});function qj(e){const t=new Xd(e),r=Aj(Xd.prototype.request,t);return Xe.extend(r,Xd.prototype,t,{allOwnKeys:!0}),Xe.extend(r,t,null,{allOwnKeys:!0}),r.create=function(n){return qj(dh(e,n))},r}const Ai=qj(f0);Ai.Axios=Xd;Ai.CanceledError=nm;Ai.CancelToken=OP;Ai.isCancel=Uj;Ai.VERSION=$j;Ai.toFormData=Cw;Ai.AxiosError=pr;Ai.Cancel=Ai.CanceledError;Ai.all=function(t){return Promise.all(t)};Ai.spread=dpe;Ai.isAxiosError=hpe;Ai.mergeConfig=dh;Ai.AxiosHeaders=to;Ai.formToJSON=e=>Nj(Xe.isHTMLForm(e)?new FormData(e):e);Ai.getAdapter=Gj.getAdapter;Ai.HttpStatusCode=iM;Ai.default=Ai;const fpe="http://127.0.0.1:5535";Ai.defaults.baseURL=fpe;Ai.interceptors.request.use(e=>e);Ai.interceptors.response.use(e=>e,e=>Promise.reject(e));const ppe={get(e,t){return new Promise((r,i)=>{Ai.get(e,{params:t}).then(n=>{r(n.data)}).catch(n=>{i(n)})})},getBlob(e,t){return new Promise((r,i)=>{Ai.get(e,{params:t,responseType:"blob"}).then(n=>{r(n.data)}).catch(n=>{i(n)})})},post(e,t){return new Promise((r,i)=>{Ai.post(e,t).then(n=>{r(n.data)}).catch(n=>{i(n)})})}};async function mpe(){return ppe.get("/patients")}const nM=cj("patientsInfo",()=>{const e=me();return{patients:e,getPatients:async()=>{e.value=await mpe()}}}),vpe={class:"c_card_container"},gpe=Z1('<input type="radio" name="select" id="c_card_slide_1" checked hidden><input type="radio" name="select" id="c_card_slide_2" hidden><input type="radio" name="select" id="c_card_slide_3" hidden><div class="c_card_slider"><label for="c_card_slide_1" class="c_card_slide c_card_slide-1"></label><label for="c_card_slide_2" class="c_card_slide c_card_slide-2"></label><label for="c_card_slide_3" class="c_card_slide c_card_slide-3"></label></div>',4),ype={class:"c_card_img"},bpe=["src"],xpe={class:"c_card_content"},wpe={class:"c_card_title"},Spe={class:"c_card_text"},Cpe=je({__name:"Card",props:{data:{}},setup(e){const t=e;return(r,i)=>(ht(),Pt("div",vpe,[gpe,(ht(!0),Pt(mr,null,vs(t.data,(n,a)=>(ht(),Ci(ze(Yd),{align:"center",class:Bo(["c_card_detail","c_card_detail-"+(a+1)]),key:a},{default:Je(()=>[st("div",ype,[st("img",{src:n.icon,alt:"none"},null,8,bpe)]),st("div",xpe,[st("div",wpe,vi(n.title),1),st("div",Spe,[Le(ze(yce),{class:"","content-class":"c_card_scrollbar"},{default:Je(()=>[gs(r.$slots,"card-slot-"+a)]),_:2},1024)])])]),_:2},1032,["class"]))),128))]))}}),_pe="/DigitalTWINonFHIRFrontend/assets/1-D_sLrbLA.png",Yj="/DigitalTWINonFHIRFrontend/assets/2-B5wpaswG.png",Xj="/DigitalTWINonFHIRFrontend/assets/3-3UDdDhFK.png",Ape=e=>(Y1("data-v-981ba0bf"),e=e(),X1(),e),Mpe={class:"m-card"},Epe=Ape(()=>st("br",null,null,-1)),Tpe=je({__name:"MeasurementsView",setup(e){const{patients:t}=bl(nM()),r=me([{title:"Patients",icon:_pe,text:"  ."},{title:"Observations",icon:Yj,text:"8 "},{title:"ImagingStudy",icon:Xj,text:" 36600  "}]);return Or(async()=>{console.log("Measurements: ",t.value)}),(i,n)=>{const a=Gu("router-view");return ht(),Pt(mr,null,[st("div",Mpe,[Le(Cpe,{data:r.value},d$({_:2},[vs(ze(t),(o,s)=>({name:`card-slot-${s}`,fn:Je(()=>[st("div",null,'"Resource Type: " '+vi(o.resourceType),1),st("div",null,'"Id: " '+vi(o.id),1),st("div",null,'"uuid: " '+vi(o.identifier[0].value),1),st("div",null,'"GP: " '+vi(o.generalPractitioner[0].display),1),st("div",null,'"Name: " '+vi(o.name?o.name[0].text:"none"),1),Epe])}))]),1032,["data"])]),Le(a)],64)}}}),Ppe=xl(Tpe,[["__scopeId","data-v-981ba0bf"]]),Dpe=e=>(Y1("data-v-5a36638d"),e=e(),X1(),e),Ope=Dpe(()=>st("br",null,null,-1)),Rpe=je({__name:"Patients",setup(e){const{patients:t}=bl(nM()),{getPatients:r}=nM();return Or(async()=>{await r()}),(i,n)=>(ht(),Pt(mr,null,[(ht(!0),Pt(mr,null,vs(ze(t),(a,o)=>(ht(),Pt("div",{key:o},[st("div",null,'"Resource Type: " '+vi(a.resourceType),1),st("div",null,'"Id: " '+vi(a.id),1),st("div",null,'"uuid: " '+vi(a.identifier[0].value),1),st("div",null,'"GP: " '+vi(a.generalPractitioner[0].display),1),st("div",null,'"Name: " '+vi(a.name?a.name[0].text:"none"),1),Ope]))),128)),Le(ze(Yd),{class:"container"},{default:Je(()=>[Le(ze(ci),null,{default:Je(()=>[Lr("Oops!")]),_:1}),Le(ze(ci),null,{default:Je(()=>[Lr("Oops!")]),_:1}),Le(ze(ci),null,{default:Je(()=>[Lr("Oops!")]),_:1}),Le(ze(Yd),null,{default:Je(()=>[Lr("Long! Long! Cross the line!sadcsacsacsadcascacdsacsacsadcsadcdascda")]),_:1})]),_:1})],64))}}),Ipe=xl(Rpe,[["__scopeId","data-v-5a36638d"]]),zpe=je({__name:"AppLayoutAnnotator",setup(e){const{renderIcon:t,generateRouterLabel:r}=_j(),{FolderIcon:i,FolderOpenIcon:n,DocumentIcon:a,GridIcon:o}=d0(),s=u0(),{root:l}=bl(cc()),c=me([{label:()=>r("home-fhir","Home")}]);Or(()=>{var v;if(l&&((v=l.value)!=null&&v.children)){const m=s.query.category;console.log("query",m),console.log("root",l.value.category),p(l.value)}});const u=v=>{var m,g;switch(v){case"primary":if(((m=l.value)==null?void 0:m.category)==="Measurements")return()=>r("measurements",v,void 0,{name:v});if(((g=l.value)==null?void 0:g.category)==="Workflow")return()=>r("workflow",v,void 0,{name:v});break;default:return v}},d=(v,m=null)=>m?{label:u(v),key:v,icon:t(i),children:[...f(m)]}:{label:u(v),key:v,icon:t(i),children:[]},h=v=>({label:v,key:v,icon:t(a)}),f=v=>{const m=v.filter(b=>b.kind==="directory"),g=v.filter(b=>b.kind==="file"),y=[];for(let b of m){const x=d(b.name,b.children);y.push(x)}return g.forEach(b=>{const x=h(b.name);y.push(x)}),y},p=v=>{c.value=[{label:()=>r("home-annotator",v.name,void 0,{category:v.category}),key:v.name,icon:t(o)},...f(v.children)]};return rr(l,()=>{var v;l&&((v=l.value)!=null&&v.children)&&p(l.value)}),(v,m)=>{const g=Gu("router-view");return ht(),Ci(ze(ip),{class:"flex flex-col bg-fancy-gradient h-screen"},{default:Je(()=>[Le(ze(q6),{class:"bg-transparent h-[8vh] mt-auto shadow-sm"},{default:Je(()=>[Le(bw)]),_:1}),Le(ze(ip),{class:"flex-1 h-[87vh] bg-transparent","has-sider":"",onDragover:m[0]||(m[0]=Nf(()=>{},["prevent"])),onDrop:m[1]||(m[1]=y=>y.preventDefault())},{default:Je(()=>[ze(l)?(ht(),Ci(Cj,{key:0,"menu-options":c.value,width:320},null,8,["menu-options"])):Ga("",!0),Le(ze(ip),{"native-scrollbar":!1,class:"bg-transparent"},{default:Je(()=>[Le(g)]),_:1})]),_:1}),Le(ze(Y6),{class:"h-[5vh] mt-auto bg-transparent footer"},{default:Je(()=>[Le(Sj)]),_:1})]),_:1})}}}),kpe=xl(zpe,[["__scopeId","data-v-c372059e"]]),Lpe="data:image/svg+xml,%3csvg%20width='40'%20height='40'%20viewBox='0%200%2040%2040'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3crect%20width='40'%20height='40'%20rx='20'%20fill='%23daf2e9'/%3e%3cpath%20d='M16.6665%2023.3333L19.9998%2020M19.9998%2020L23.3332%2023.3333M19.9998%2020V27.5M26.6665%2023.9524C27.6844%2023.1117%2028.3332%2021.8399%2028.3332%2020.4167C28.3332%2017.8854%2026.2811%2015.8333%2023.7498%2015.8333C23.5677%2015.8333%2023.3974%2015.7383%2023.3049%2015.5814C22.2182%2013.7374%2020.2119%2012.5%2017.9165%2012.5C14.4647%2012.5%2011.6665%2015.2982%2011.6665%2018.75C11.6665%2020.4718%2012.3627%2022.0309%2013.489%2023.1613'%20stroke='%2324AE7C'%20stroke-width='1.66667'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",Bpe=e=>(Y1("data-v-3bf125bc"),e=e(),X1(),e),Fpe={className:"file-upload_label"},Npe=Bpe(()=>st("p",{className:"text-14-regular"},[st("span",{className:"text-orange-500"}," Click to upload "),Lr(" or drag and drop ")],-1)),Upe={class:"font-bold"},jpe=je({__name:"DropZone",props:{category:{}},emits:["onChange"],setup(e,{emit:t}){const r=e,i=me(!1),{root:n}=bl(cc()),{folderPicker:a,folderDrop:o}=cc(),s=t,l=async(h,f)=>{f==="drop"?await c(h):f==="click"&&await u();try{s("onChange",n.value)}catch(p){console.log(p)}};Or(()=>{});const c=async h=>{d();const f=h.dataTransfer.items[0];await o(f,r.category)},u=async()=>{await a(r.category)},d=()=>{i.value=!i.value};return(h,f)=>(ht(),Pt("div",{onDragenter:Nf(d,["prevent"]),onDragleave:Nf(d,["prevent"]),onDragover:f[0]||(f[0]=Nf(()=>{},["prevent"])),onDrop:f[1]||(f[1]=Nf(p=>l(p,"drop"),["prevent"])),onClick:f[2]||(f[2]=p=>l(p,"click")),class:Bo([{"active-dropzone":i.value},"w-3/5 h-2/5 md:h-80 file-upload ease-in-out duration-300"])},[Le(ze(lP),{round:"",class:"animate-bounce",size:40,src:ze(Lpe)},null,8,["src"]),st("div",Fpe,[Npe,st("p",Upe," SPARC "+vi(!!r.category&&r.category)+" SDS dataset ",1)])],34))}}),Vpe=xl(jpe,[["__scopeId","data-v-3bf125bc"]]),Hpe={class:"w-full h-[87vh] flex flex-col justify-center items-center"},Wpe=je({__name:"AnnotatorView",setup(e){const r=u0().query.category,i=Array.isArray(r)?r[0]:r,n=i&&["Measurements","Workflow","Workflow tool","Workflow tool process"].includes(i)?i:void 0,a=me(),o=s=>{a.value=s};return(s,l)=>(ht(),Pt("div",Hpe,[Le(Vpe,{category:ze(n),onOnChange:o},null,8,["category"])]))}}),Gpe="/DigitalTWINonFHIRFrontend/assets/img5-CfE9Ca4b.png",$pe="/DigitalTWINonFHIRFrontend/assets/img6-DORjbCPq.png",qpe="/DigitalTWINonFHIRFrontend/assets/img7-DwEbhF3y.png",Ype="/DigitalTWINonFHIRFrontend/assets/img10-BmtVM-LO.svg",Xpe={class:"bg-box"},Kpe={class:"carousel main"},Qpe={class:"item custom-drop-shadow"},Zpe=["src"],Jpe={class:"item custom-drop-shadow"},eme=["src"],tme={class:"item custom-drop-shadow"},rme=["src"],ime={class:"item custom-drop-shadow"},nme=["src"],ame={class:"box-info"},ome={class:"navigation"},sme=je({__name:"Carousel",setup(e){const{ChevronBackIcon:t,ChevronForwardIcon:r,AddIcon:i}=d0(),n=me([{title:"Primary Measurements Annotator",description:"A SPARC SDS primary measurements dataset will be required. A SPARC SDS primary measurements dataset will be required. This dataset may contain MRI images and other EHR measurements for each patient. You can use the annotator to annotate the Observation and ImagingStudy for EHR data.",link:{name:"home-annotator",query:{category:"Measurements"}}},{title:"Workflow Annotator",description:"A SPARC SDS workflow dataset will be required. This dataset may contain a workflow .cwl file for cohort patients. You can use the annotator to add the Workflow's title, description, inputs, outputs, workflow tools and steps.",link:{name:"home-annotator",query:{category:"Workflow"}}},{title:"Workflow Tool Annotator",description:"A SPARC SDS workflow tool dataset will be required. This dataset may contain a workflow tool .cwl file for cohort patients. You can use the annotator to add the Workflow tool's title, description, models and softwares.",link:{name:"home-annotator",query:{category:"Workflow tool"}}},{title:"Workflow Tool Process Annotator",description:"A SPARC SDS workflow tool process dataset will be required. This dataset may contain a workflow tool process data executing by a workflow tool for patients. You can use the annotator to add the Workflow tool process's EHR inputs and outputs for patients.",link:{name:"home-annotator",query:{category:"Workflow tool process"}}}]),a=me(0),o=me(document.querySelectorAll(".bg")),s=()=>{a.value<3?a.value+=1:a.value=0},l=()=>{a.value>0?a.value-=1:a.value=3};return no(()=>{o.value.forEach((c,u)=>{c.classList.toggle("active",u===a.value)})}),(c,u)=>{const d=Gu("router-link");return ht(),Pt(mr,null,[st("div",Xpe,[(ht(),Pt(mr,null,vs([1,2,3,4],(h,f)=>st("div",{key:f,class:Bo([{active:f===a.value},"bg"])},null,2)),64))]),st("div",Kpe,[st("div",{class:"list-img",style:yp({transform:`translateY(${a.value*-100}%)`})},[st("div",Qpe,[st("img",{src:ze(Gpe),alt:""},null,8,Zpe)]),st("div",Jpe,[st("img",{src:ze($pe),alt:""},null,8,eme)]),st("div",tme,[st("img",{src:ze(qpe),alt:""},null,8,rme)]),st("div",ime,[st("img",{src:ze(Ype),alt:""},null,8,nme)])],4),st("div",ame,[st("div",{class:"list-info",style:yp({transform:`translateY(${a.value*-25}%)`})},[(ht(!0),Pt(mr,null,vs(n.value,(h,f)=>(ht(),Pt("div",{key:f,class:"info"},[st("h2",null,vi(h.title),1),st("p",null,vi(h.description),1),Le(d,{class:"btn",to:h.link},{default:Je(()=>[Lr("Let's go Annotating")]),_:2},1032,["to"])]))),128))],4)]),st("div",ome,[st("span",{class:"prev-btn",onClick:l},[Le(ze(Tp),null,{default:Je(()=>[Le(ze(t))]),_:1})]),st("span",{class:"next-btn",onClick:s},[Le(ze(Tp),null,{default:Je(()=>[Le(ze(r))]),_:1})])])])],64)}}}),lme=xl(sme,[["__scopeId","data-v-8762d8fb"]]),cme={class:"fixed top-0 left-0 right-0 h-[8vh] pt-3 px-3 shadow-sm z-50"},ume=je({__name:"index",setup(e){const{root:t}=bl(cc());return Or(()=>{t&&(t.value=void 0)}),(r,i)=>(ht(),Pt("div",null,[st("div",cme,[Le(bw)]),Le(lme)]))}}),dme={class:"flex flex-row justify-around"},hme={key:1},fme={className:"justify-items-end text-dark-600 xl:text-left"},pme=je({__name:"PageSummary",props:{breadcrumbs:Array,avatar:String,title:String,subtitle:String,footer:String},setup(e){return CP(),(t,r)=>{const i=Gu("RouterLink");return ht(),Ci(ze(vce),{subtitle:e.subtitle,class:"page-header-bg"},{avatar:Je(()=>[Le(ze(lP),{src:e.avatar},null,8,["src"])]),title:Je(()=>[st("span",null,vi(e.title),1)]),header:Je(()=>[Le(ze(Cne),null,{default:Je(()=>[(ht(!0),Pt(mr,null,vs(e.breadcrumbs,(n,a)=>(ht(),Ci(ze(Mne),{key:a},{default:Je(()=>[n!=="primary"?(ht(),Ci(i,{key:0,to:"/primary/test"},{default:Je(()=>[Lr(vi(n),1)]),_:2},1024)):(ht(),Pt("span",hme,vi(n),1))]),_:2},1024))),128))]),_:1})]),extra:Je(()=>[gs(t.$slots,"extra",{},void 0,!0)]),footer:Je(()=>[st("p",fme,vi(e.footer),1)]),default:Je(()=>[st("div",dme,[gs(t.$slots,"default",{},void 0,!0)])]),_:3},8,["subtitle"])}}}),mme=xl(pme,[["__scopeId","data-v-6f639b76"]]),Kj=je({__name:"AnnotatorPageSummary",props:{avatar:{},subtitle:{},title:{},annotator:{}},setup(e,{emit:t}){var c;const{root:r}=bl(cc()),i=u0(),n=me(i.query.name),a=e,o=t,s=[(c=r.value)==null?void 0:c.name,n.value],l=()=>{o("updateAnnotator",a.annotator)};return(u,d)=>(ht(),Ci(mme,{breadcrumbs:s,avatar:u.avatar,title:u.title,subtitle:u.subtitle,footer:" 2024 Clinic Description Annotator"},{extra:Je(()=>[Le(ze(vse),null,{default:Je(()=>[Le(ze(ci),{strong:"",ghost:"",class:"w-[100px]",color:u.annotator==="Annotate"?"#ff69b4":"#22c55e",onClick:l},{default:Je(()=>[Lr(vi(u.annotator),1)]),_:1},8,["color"])]),_:1})]),default:Je(()=>[gs(u.$slots,"default")]),_:3},8,["avatar","title","subtitle"]))}}),vme=je({__name:"FormTab",setup(e){return(t,r)=>(ht(),Ci(ze(ij),{type:"segment",animated:""},{default:Je(()=>[Le(ze(Tx),{name:"Observation",tab:"Observation"},{default:Je(()=>[gs(t.$slots,"observation")]),_:3}),Le(ze(Tx),{name:"ImagingStudy",tab:"ImagingStudy"},{default:Je(()=>[gs(t.$slots,"imagingstudy")]),_:3})]),_:3}))}});var Qj={exports:{}};const gme={},yme=Object.freeze(Object.defineProperty({__proto__:null,default:gme},Symbol.toStringTag,{value:"Module"})),bme=Tae(yme);/*! dicom-parser - 1.8.12 - 2023-02-20 | (c) 2017 Chris Hafey | https://github.com/cornerstonejs/dicomParser */(function(e,t){(function(r,i){e.exports=i(bme)})(Eae,function(r){return n=[function(o,s){o.exports=r},function(o,s,l){l.r(s),l.d(s,"isStringVr",function(){return u}),l.d(s,"isPrivateTag",function(){return d}),l.d(s,"parsePN",function(){return h}),l.d(s,"parseTM",function(){return f}),l.d(s,"parseDA",function(){return v}),l.d(s,"explicitElementToString",function(){return m}),l.d(s,"explicitDataSetToJS",function(){return g}),l.d(s,"createJPEGBasicOffsetTable",function(){return x}),l.d(s,"parseDicomDataSetExplicit",function(){return W}),l.d(s,"parseDicomDataSetImplicit",function(){return q}),l.d(s,"readFixedString",function(){return C}),l.d(s,"alloc",function(){return $}),l.d(s,"version",function(){return le}),l.d(s,"bigEndianByteArrayParser",function(){return ee}),l.d(s,"ByteStream",function(){return V}),l.d(s,"sharedCopy",function(){return Q}),l.d(s,"DataSet",function(){return P}),l.d(s,"findAndSetUNElementLength",function(){return _}),l.d(s,"findEndOfEncapsulatedElement",function(){return w}),l.d(s,"findItemDelimitationItemAndSetElementLength",function(){return T}),l.d(s,"littleEndianByteArrayParser",function(){return ue}),l.d(s,"parseDicom",function(){return G}),l.d(s,"readDicomElementExplicit",function(){return X}),l.d(s,"readDicomElementImplicit",function(){return z}),l.d(s,"readEncapsulatedImageFrame",function(){return _e}),l.d(s,"readEncapsulatedPixelData",function(){return fe}),l.d(s,"readEncapsulatedPixelDataFromFragments",function(){return de}),l.d(s,"readPart10Header",function(){return ve}),l.d(s,"readSequenceItemsExplicit",function(){return ie}),l.d(s,"readSequenceItemsImplicit",function(){return N}),l.d(s,"readSequenceItem",function(){return F}),l.d(s,"readTag",function(){return S});var c={AE:!0,AS:!0,AT:!1,CS:!0,DA:!0,DS:!0,DT:!0,FL:!1,FD:!1,IS:!0,LO:!0,LT:!0,OB:!1,OD:!1,OF:!1,OW:!1,PN:!0,SH:!0,SL:!1,SQ:!1,SS:!1,ST:!0,TM:!0,UI:!0,UL:!1,UN:void 0,UR:!0,US:!1,UT:!0},u=function(B){return c[B]},d=function(B){if(B=parseInt(B[4],16),isNaN(B))throw"dicomParser.isPrivateTag: cannot parse last character of group";return B%2==1},h=function(B){if(B!==void 0)return B=B.split("^"),{familyName:B[0],givenName:B[1],middleName:B[2],prefix:B[3],suffix:B[4]}};function f(B,D){if(2<=B.length){var I=parseInt(B.substring(0,2),10),O=4<=B.length?parseInt(B.substring(2,4),10):void 0,j=6<=B.length?parseInt(B.substring(4,6),10):void 0,L=8<=B.length?B.substring(7,13):void 0,L=L?parseInt(L,10)*Math.pow(10,6-L.length):void 0;if(D&&(isNaN(I)||O!==void 0&&isNaN(O)||j!==void 0&&isNaN(j)||L!==void 0&&isNaN(L)||I<0||23<I||O&&(O<0||59<O)||j&&(j<0||59<j)||L&&(L<0||999999<L)))throw"invalid TM '".concat(B,"'");return{hours:I,minutes:O,seconds:j,fractionalSeconds:L}}if(D)throw"invalid TM '".concat(B,"'")}function p(B,D,I){return!isNaN(I)&&0<D&&D<=12&&0<B&&B<=function(O,j){switch(O){case 2:return j%4==0&&j%100||j%400==0?29:28;case 9:case 4:case 6:case 11:return 30;default:return 31}}(D,I)}function v(B,D){if(B&&B.length===8){var I=parseInt(B.substring(0,4),10),O=parseInt(B.substring(4,6),10),j=parseInt(B.substring(6,8),10);if(D&&p(j,O,I)!==!0)throw"invalid DA '".concat(B,"'");return{year:I,month:O,day:j}}if(D)throw"invalid DA '".concat(B,"'")}function m(B,D){if(B===void 0||D===void 0)throw"dicomParser.explicitElementToString: missing required parameters";if(D.vr===void 0)throw"dicomParser.explicitElementToString: cannot convert implicit element to string";var I,O=D.vr,j=D.tag;function L(We,Ve){for(var ke="",et=0;et<We;et++)et!==0&&(ke+="/"),ke+=Ve.call(B,j,et).toString();return ke}if(u(O)===!0)I=B.string(j);else{if(O==="AT"){var Ae=B.uint32(j);return Ae===void 0?void 0:"x".concat((Ae=Ae<0?4294967295+Ae+1:Ae).toString(16).toUpperCase())}O==="US"?I=L(D.length/2,B.uint16):O==="SS"?I=L(D.length/2,B.int16):O==="UL"?I=L(D.length/4,B.uint32):O==="SL"?I=L(D.length/4,B.int32):O==="FD"?I=L(D.length/8,B.double):O==="FL"&&(I=L(D.length/4,B.float))}return I}function g(B,D){if(B===void 0)throw"dicomParser.explicitDataSetToJS: missing required parameter dataSet";D=D||{omitPrivateAttibutes:!0,maxElementLength:128};var I,O={};for(I in B.elements){var j=B.elements[I];if(D.omitPrivateAttibutes!==!0||!d(I))if(j.items){for(var L=[],Ae=0;Ae<j.items.length;Ae++)L.push(g(j.items[Ae].dataSet,D));O[I]=L}else{var We=void 0;j.length<D.maxElementLength&&(We=m(B,j)),O[I]=We!==void 0?We:{dataOffset:j.dataOffset,length:j.length}}}return O}function y(B,D){return B.byteArray[D]===255&&B.byteArray[D+1]===217}function b(B,D,I){for(var O,j,L=I;L<D.fragments.length;L++)if(O=B,j=L,j=D.fragments[j],!(!y(O,j.position+j.length-2)&&!y(O,j.position+j.length-3)))return L}function x(B,D,I){if(B===void 0)throw"dicomParser.createJPEGBasicOffsetTable: missing required parameter dataSet";if(D===void 0)throw"dicomParser.createJPEGBasicOffsetTable: missing required parameter pixelDataElement";if(D.tag!=="x7fe00010")throw"dicomParser.createJPEGBasicOffsetTable: parameter 'pixelDataElement' refers to non pixel data tag (expected tag = x7fe00010'";if(D.encapsulatedPixelData!==!0||D.hadUndefinedLength!==!0||D.basicOffsetTable===void 0||D.fragments===void 0||D.fragments.length<=0)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(I&&I.length<=0)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'fragments' must not be zero length";I=I||D.fragments;for(var O=[],j=0;;){O.push(D.fragments[j].offset);var L=b(B,D,j);if(L===void 0||L===D.fragments.length-1)return O;j=L+1}}function S(I){if(I===void 0)throw"dicomParser.readTag: missing required parameter 'byteStream'";var D=256*I.readUint16()*256,I=I.readUint16();return"x".concat("00000000".concat((D+I).toString(16)).substr(-8))}function w(B,D,I){if(B===void 0)throw"dicomParser.findEndOfEncapsulatedElement: missing required parameter 'byteStream'";if(D===void 0)throw"dicomParser.findEndOfEncapsulatedElement: missing required parameter 'element'";if(D.encapsulatedPixelData=!0,D.basicOffsetTable=[],D.fragments=[],S(B)!=="xfffee000")throw"dicomParser.findEndOfEncapsulatedElement: basic offset table not found";for(var O=B.readUint32()/4,j=0;j<O;j++){var L=B.readUint32();D.basicOffsetTable.push(L)}for(var Ae=B.position;B.position<B.byteArray.length;){var We=S(B),Ve=B.readUint32();if(We==="xfffee0dd")return B.seek(Ve),void(D.length=B.position-D.dataOffset);if(We!=="xfffee000")return I&&I.push("unexpected tag ".concat(We," while searching for end of pixel data element with undefined length")),Ve>B.byteArray.length-B.position&&(Ve=B.byteArray.length-B.position),D.fragments.push({offset:B.position-Ae-8,position:B.position,length:Ve}),B.seek(Ve),void(D.length=B.position-D.dataOffset);D.fragments.push({offset:B.position-Ae-8,position:B.position,length:Ve}),B.seek(Ve)}I&&I.push("pixel data element ".concat(D.tag," missing sequence delimiter tag xfffee0dd"))}function _(B,D){if(B===void 0)throw"dicomParser.findAndSetUNElementLength: missing required parameter 'byteStream'";for(var I=B.byteArray.length-8;B.position<=I;)if(B.readUint16()===65534){var O=B.readUint16();if(O===57565)return B.readUint32()!==0&&B.warnings("encountered non zero length following item delimiter at position ".concat(B.position-4," while reading element of undefined length with tag ").concat(D.tag)),void(D.length=B.position-D.dataOffset)}D.length=B.byteArray.length-D.dataOffset,B.seek(B.byteArray.length-B.position)}function C(B,D,I){if(I<0)throw"dicomParser.readFixedString - length cannot be less than 0";if(D+I>B.length)throw"dicomParser.readFixedString: attempt to read past end of buffer";for(var O,j="",L=0;L<I;L++){if((O=B[D+L])===0)return D+=I,j;j+=String.fromCharCode(O)}return j}function A(B,D){for(var I=0;I<D.length;I++){var O=D[I];O.enumerable=O.enumerable||!1,O.configurable=!0,"value"in O&&(O.writable=!0),Object.defineProperty(B,O.key,O)}}function M(B,D){return B.parser!==void 0?B.parser:D}var P=function(){function B(O,j,L){(function(Ae,We){if(!(Ae instanceof We))throw new TypeError("Cannot call a class as a function")})(this,B),this.byteArrayParser=O,this.byteArray=j,this.elements=L}var D,I;return D=B,(I=[{key:"uint16",value:function(O,j){if(O=this.elements[O],j=j!==void 0?j:0,O&&O.length!==0)return M(O,this.byteArrayParser).readUint16(this.byteArray,O.dataOffset+2*j)}},{key:"int16",value:function(O,j){if(O=this.elements[O],j=j!==void 0?j:0,O&&O.length!==0)return M(O,this.byteArrayParser).readInt16(this.byteArray,O.dataOffset+2*j)}},{key:"uint32",value:function(O,j){if(O=this.elements[O],j=j!==void 0?j:0,O&&O.length!==0)return M(O,this.byteArrayParser).readUint32(this.byteArray,O.dataOffset+4*j)}},{key:"int32",value:function(O,j){if(O=this.elements[O],j=j!==void 0?j:0,O&&O.length!==0)return M(O,this.byteArrayParser).readInt32(this.byteArray,O.dataOffset+4*j)}},{key:"float",value:function(O,j){if(O=this.elements[O],j=j!==void 0?j:0,O&&O.length!==0)return M(O,this.byteArrayParser).readFloat(this.byteArray,O.dataOffset+4*j)}},{key:"double",value:function(O,j){if(O=this.elements[O],j=j!==void 0?j:0,O&&O.length!==0)return M(O,this.byteArrayParser).readDouble(this.byteArray,O.dataOffset+8*j)}},{key:"numStringValues",value:function(O){if(O=this.elements[O],O&&0<O.length)return O=C(this.byteArray,O.dataOffset,O.length).match(/\\/g),O===null?1:O.length+1}},{key:"string",value:function(O,j){if(O=this.elements[O],O&&O.Value)return O.Value;if(O&&0<O.length)return O=C(this.byteArray,O.dataOffset,O.length),0<=j?O.split("\\")[j].trim():O.trim()}},{key:"text",value:function(O,j){if(O=this.elements[O],O&&0<O.length)return O=C(this.byteArray,O.dataOffset,O.length),0<=j?O.split("\\")[j].replace(/ +$/,""):O.replace(/ +$/,"")}},{key:"floatString",value:function(O,j){var L=this.elements[O];if(L&&0<L.length&&(j=this.string(O,j=j!==void 0?j:0),j!==void 0))return parseFloat(j)}},{key:"intString",value:function(O,j){var L=this.elements[O];if(L&&0<L.length&&(j=this.string(O,j=j!==void 0?j:0),j!==void 0))return parseInt(j)}},{key:"attributeTag",value:function(O){var j=this.elements[O];if(j&&j.length===4){var L=M(j,this.byteArrayParser).readUint16,O=this.byteArray,j=j.dataOffset;return"x".concat("00000000".concat((256*L(O,j)*256+L(O,j+2)).toString(16)).substr(-8))}}}])&&A(D.prototype,I),Object.defineProperty(D,"prototype",{writable:!1}),B}();function T(B,D){if(B===void 0)throw"dicomParser.readDicomElementImplicit: missing required parameter 'byteStream'";for(var I=B.byteArray.length-8;B.position<=I;)if(B.readUint16()===65534){var O=B.readUint16();if(O===57357)return B.readUint32()!==0&&B.warnings("encountered non zero length following item delimiter at position ".concat(B.position-4," while reading element of undefined length with tag ").concat(D.tag)),void(D.length=B.position-D.dataOffset)}D.length=B.byteArray.length-D.dataOffset,B.seek(B.byteArray.length-B.position)}var R=function(B,D){return B.vr!==void 0?B.vr==="SQ":D.position+4<=D.byteArray.length?(B=S(D),D.seek(-4),B==="xfffee000"||B==="xfffee0dd"):(D.warnings.push("eof encountered before finding sequence item tag or sequence delimiter tag in peeking to determine VR"),!1)};function z(B,D,I){if(B===void 0)throw"dicomParser.readDicomElementImplicit: missing required parameter 'byteStream'";var O=S(B),O={tag:O,vr:I!==void 0?I(O):void 0,length:B.readUint32(),dataOffset:B.position};return O.length===4294967295&&(O.hadUndefinedLength=!0),O.tag===D||(!R(O,B)||d(O.tag)&&!O.hadUndefinedLength?O.hadUndefinedLength?T(B,O):B.seek(O.length):(N(B,O,I),d(O.tag)&&(O.items=void 0))),O}function F(B){if(B===void 0)throw"dicomParser.readSequenceItem: missing required parameter 'byteStream'";var D={tag:S(B),length:B.readUint32(),dataOffset:B.position};if(D.tag!=="xfffee000")throw"dicomParser.readSequenceItem: item tag (FFFE,E000) not found at offset ".concat(B.position);return D}function H(B,D){var I=F(B);return I.length===4294967295?(I.hadUndefinedLength=!0,I.dataSet=function(O,j){for(var L={};O.position<O.byteArray.length;){var Ae=z(O,void 0,j);if((L[Ae.tag]=Ae).tag==="xfffee00d")return new P(O.byteArrayParser,O.byteArray,L)}return O.warnings.push("eof encountered before finding sequence item delimiter in sequence item of undefined length"),new P(O.byteArrayParser,O.byteArray,L)}(B,D),I.length=B.position-I.dataOffset):(I.dataSet=new P(B.byteArrayParser,B.byteArray,{}),q(I.dataSet,B,B.position+I.length,{vrCallback:D})),I}function N(B,D,I){if(B===void 0)throw"dicomParser.readSequenceItemsImplicit: missing required parameter 'byteStream'";if(D===void 0)throw"dicomParser.readSequenceItemsImplicit: missing required parameter 'element'";D.items=[],(D.length===4294967295?function(O,j,L){for(;O.position+4<=O.byteArray.length;){var Ae=S(O);if(O.seek(-4),Ae==="xfffee0dd")return j.length=O.position-j.dataOffset,O.seek(8);Ae=H(O,L),j.items.push(Ae)}O.warnings.push("eof encountered before finding sequence delimiter in sequence of undefined length"),j.length=O.byteArray.length-j.dataOffset}:function(O,j,L){for(var Ae=j.dataOffset+j.length;O.position<Ae;){var We=H(O,L);j.items.push(We)}})(B,D,I)}function U(B,D){var I=F(B);return I.length===4294967295?(I.hadUndefinedLength=!0,I.dataSet=function(O,j){for(var L={};O.position<O.byteArray.length;){var Ae=X(O,j);if((L[Ae.tag]=Ae).tag==="xfffee00d")return new P(O.byteArrayParser,O.byteArray,L)}return j.push("eof encountered before finding item delimiter tag while reading sequence item of undefined length"),new P(O.byteArrayParser,O.byteArray,L)}(B,D),I.length=B.position-I.dataOffset):(I.dataSet=new P(B.byteArrayParser,B.byteArray,{}),W(I.dataSet,B,B.position+I.length)),I}function ie(B,D,I){if(B===void 0)throw"dicomParser.readSequenceItemsExplicit: missing required parameter 'byteStream'";if(D===void 0)throw"dicomParser.readSequenceItemsExplicit: missing required parameter 'element'";D.items=[],(D.length===4294967295?function(O,j,L){for(;O.position+4<=O.byteArray.length;){var Ae=S(O);if(O.seek(-4),Ae==="xfffee0dd")return j.length=O.position-j.dataOffset,O.seek(8);Ae=U(O,L),j.items.push(Ae)}L.push("eof encountered before finding sequence delimitation tag while reading sequence of undefined length"),j.length=O.position-j.dataOffset}:function(O,j,L){for(var Ae=j.dataOffset+j.length;O.position<Ae;){var We=U(O,L);j.items.push(We)}})(B,D,I)}var te=function(B){return B==="OB"||B==="OD"||B==="OL"||B==="OW"||B==="SQ"||B==="OF"||B==="UC"||B==="UR"||B==="UT"||B==="UN"?4:2};function X(B,D,I){if(B===void 0)throw"dicomParser.readDicomElementExplicit: missing required parameter 'byteStream'";var O={tag:S(B),vr:B.readFixedString(2)};return te(O.vr)===2?O.length=B.readUint16():(B.seek(2),O.length=B.readUint32()),O.dataOffset=B.position,O.length===4294967295&&(O.hadUndefinedLength=!0),O.tag===I||(O.vr==="SQ"?ie(B,O,D):O.length===4294967295?O.tag==="x7fe00010"?w(B,O,D):(O.vr==="UN"?N:T)(B,O):B.seek(O.length)),O}function W(B,D,I){var O=3<arguments.length&&arguments[3]!==void 0?arguments[3]:{};if(I=I===void 0?D.byteArray.length:I,D===void 0)throw"dicomParser.parseDicomDataSetExplicit: missing required parameter 'byteStream'";if(I<D.position||I>D.byteArray.length)throw"dicomParser.parseDicomDataSetExplicit: invalid value for parameter 'maxP osition'";for(var j=B.elements;D.position<I;){var L=X(D,B.warnings,O.untilTag);if((j[L.tag]=L).tag===O.untilTag)return}if(D.position>I)throw"dicomParser:parseDicomDataSetExplicit: buffer overrun"}function q(B,D,I){var O=3<arguments.length&&arguments[3]!==void 0?arguments[3]:{};if(I=I===void 0?B.byteArray.length:I,D===void 0)throw"dicomParser.parseDicomDataSetImplicit: missing required parameter 'byteStream'";if(I<D.position||I>D.byteArray.length)throw"dicomParser.parseDicomDataSetImplicit: invalid value for parameter 'maxPosition'";for(var j=B.elements;D.position<I;){var L=z(D,O.untilTag,O.vrCallback);if((j[L.tag]=L).tag===O.untilTag)return}}function $(B,D){if(typeof Buffer<"u"&&B instanceof Buffer)return Buffer.alloc(D);if(B instanceof Uint8Array)return new Uint8Array(D);throw"dicomParser.alloc: unknown type for byteArray"}var le="1.8.12",ee={readUint16:function(B,D){if(D<0)throw"bigEndianByteArrayParser.readUint16: position cannot be less than 0";if(D+2>B.length)throw"bigEndianByteArrayParser.readUint16: attempt to read past end of buffer";return(B[D]<<8)+B[D+1]},readInt16:function(B,D){if(D<0)throw"bigEndianByteArrayParser.readInt16: position cannot be less than 0";if(D+2>B.length)throw"bigEndianByteArrayParser.readInt16: attempt to read past end of buffer";return D=(B[D]<<8)+B[D+1],D=32768&D?D-65535-1:D},readUint32:function(B,D){if(D<0)throw"bigEndianByteArrayParser.readUint32: position cannot be less than 0";if(D+4>B.length)throw"bigEndianByteArrayParser.readUint32: attempt to read past end of buffer";return 256*(256*(256*B[D]+B[D+1])+B[D+2])+B[D+3]},readInt32:function(B,D){if(D<0)throw"bigEndianByteArrayParser.readInt32: position cannot be less than 0";if(D+4>B.length)throw"bigEndianByteArrayParser.readInt32: attempt to read past end of buffer";return(B[D]<<24)+(B[D+1]<<16)+(B[D+2]<<8)+B[D+3]},readFloat:function(B,D){if(D<0)throw"bigEndianByteArrayParser.readFloat: position cannot be less than 0";if(D+4>B.length)throw"bigEndianByteArrayParser.readFloat: attempt to read past end of buffer";var I=new Uint8Array(4);return I[3]=B[D],I[2]=B[D+1],I[1]=B[D+2],I[0]=B[D+3],new Float32Array(I.buffer)[0]},readDouble:function(B,D){if(D<0)throw"bigEndianByteArrayParser.readDouble: position cannot be less than 0";if(D+8>B.length)throw"bigEndianByteArrayParser.readDouble: attempt to read past end of buffer";var I=new Uint8Array(8);return I[7]=B[D],I[6]=B[D+1],I[5]=B[D+2],I[4]=B[D+3],I[3]=B[D+4],I[2]=B[D+5],I[1]=B[D+6],I[0]=B[D+7],new Float64Array(I.buffer)[0]}};function Q(B,D,I){if(typeof Buffer<"u"&&B instanceof Buffer)return B.slice(D,D+I);if(B instanceof Uint8Array)return new Uint8Array(B.buffer,B.byteOffset+D,I);throw"dicomParser.from: unknown type for byteArray"}function ne(B,D){for(var I=0;I<D.length;I++){var O=D[I];O.enumerable=O.enumerable||!1,O.configurable=!0,"value"in O&&(O.writable=!0),Object.defineProperty(B,O.key,O)}}var V=function(){function B(O,j,L){if(function(Ae,We){if(!(Ae instanceof We))throw new TypeError("Cannot call a class as a function")}(this,B),O===void 0)throw"dicomParser.ByteStream: missing required parameter 'byteArrayParser'";if(j===void 0)throw"dicomParser.ByteStream: missing required parameter 'byteArray'";if(!(j instanceof Uint8Array)&&(typeof Buffer>"u"||!(j instanceof Buffer)))throw"dicomParser.ByteStream: parameter byteArray is not of type Uint8Array or Buffer";if(L<0)throw"dicomParser.ByteStream: parameter 'position' cannot be less than 0";if(L>=j.length)throw"dicomParser.ByteStream: parameter 'position' cannot be greater than or equal to 'byteArray' length";this.byteArrayParser=O,this.byteArray=j,this.position=L||0,this.warnings=[]}var D,I;return D=B,(I=[{key:"seek",value:function(O){if(this.position+O<0)throw"dicomParser.ByteStream.prototype.seek: cannot seek to position < 0";this.position+=O}},{key:"readByteStream",value:function(O){if(this.position+O>this.byteArray.length)throw"dicomParser.ByteStream.prototype.readByteStream: readByteStream - buffer overread";var j=Q(this.byteArray,this.position,O);return this.position+=O,new B(this.byteArrayParser,j)}},{key:"getSize",value:function(){return this.byteArray.length}},{key:"readUint16",value:function(){var O=this.byteArrayParser.readUint16(this.byteArray,this.position);return this.position+=2,O}},{key:"readUint32",value:function(){var O=this.byteArrayParser.readUint32(this.byteArray,this.position);return this.position+=4,O}},{key:"readFixedString",value:function(O){var j=C(this.byteArray,this.position,O);return this.position+=O,j}}])&&ne(D.prototype,I),Object.defineProperty(D,"prototype",{writable:!1}),B}(),ue={readUint16:function(B,D){if(D<0)throw"littleEndianByteArrayParser.readUint16: position cannot be less than 0";if(D+2>B.length)throw"littleEndianByteArrayParser.readUint16: attempt to read past end of buffer";return B[D]+256*B[D+1]},readInt16:function(B,D){if(D<0)throw"littleEndianByteArrayParser.readInt16: position cannot be less than 0";if(D+2>B.length)throw"littleEndianByteArrayParser.readInt16: attempt to read past end of buffer";return D=B[D]+(B[D+1]<<8),D=32768&D?D-65535-1:D},readUint32:function(B,D){if(D<0)throw"littleEndianByteArrayParser.readUint32: position cannot be less than 0";if(D+4>B.length)throw"littleEndianByteArrayParser.readUint32: attempt to read past end of buffer";return B[D]+256*B[D+1]+256*B[D+2]*256+256*B[D+3]*256*256},readInt32:function(B,D){if(D<0)throw"littleEndianByteArrayParser.readInt32: position cannot be less than 0";if(D+4>B.length)throw"littleEndianByteArrayParser.readInt32: attempt to read past end of buffer";return B[D]+(B[D+1]<<8)+(B[D+2]<<16)+(B[D+3]<<24)},readFloat:function(B,D){if(D<0)throw"littleEndianByteArrayParser.readFloat: position cannot be less than 0";if(D+4>B.length)throw"littleEndianByteArrayParser.readFloat: attempt to read past end of buffer";var I=new Uint8Array(4);return I[0]=B[D],I[1]=B[D+1],I[2]=B[D+2],I[3]=B[D+3],new Float32Array(I.buffer)[0]},readDouble:function(B,D){if(D<0)throw"littleEndianByteArrayParser.readDouble: position cannot be less than 0";if(D+8>B.length)throw"littleEndianByteArrayParser.readDouble: attempt to read past end of buffer";var I=new Uint8Array(8);return I[0]=B[D],I[1]=B[D+1],I[2]=B[D+2],I[3]=B[D+3],I[4]=B[D+4],I[5]=B[D+5],I[6]=B[D+6],I[7]=B[D+7],new Float64Array(I.buffer)[0]}};function ve(B){var D=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};if(B===void 0)throw"dicomParser.readPart10Header: missing required parameter 'byteArray'";var I=D.TransferSyntaxUID,O=new V(ue,B);return function(){var j=function(){if(O.getSize()<=132&&I)return!1;if(O.seek(128),O.readFixedString(4)==="DICM")return!0;if(!(D||{}).TransferSyntaxUID)throw"dicomParser.readPart10Header: DICM prefix not found at location 132 - this is not a valid DICOM P10 file.";return O.seek(0),!1}(),L=[],Ae={};if(!j)return O.position=0,{elements:{x00020010:{tag:"x00020010",vr:"UI",Value:I}},warnings:L};for(;O.position<O.byteArray.length;){var We=O.position,Ve=X(O,L);if("x0002ffff"<Ve.tag){O.position=We;break}Ve.parser=ue,Ae[Ve.tag]=Ve}return(j=new P(O.byteArrayParser,O.byteArray,Ae)).warnings=O.warnings,j.position=O.position,j}()}var Ce="1.2.840.10008.1.2.2";function G(B){var D=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};if(B===void 0)throw new Error("dicomParser.parseDicom: missing required parameter 'byteArray'");var I,O=function(L){if(L.elements.x00020010===void 0)throw new Error("dicomParser.parseDicom: missing required meta header attribute 0002,0010");return L=L.elements.x00020010,L&&L.Value||C(B,L.dataOffset,L.length)};function j(Ve){var We=O(Ve),Ae=We!=="1.2.840.10008.1.2",We=function(ke,et){var nt=Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]";if(ke!=="1.2.840.10008.1.2.1.99")return new V(ke===Ce?ee:ue,B,et);if(D&&D.inflater)return ke=D.inflater(B,et),new V(ue,ke,0);if(nt==!0){var lt=l(0),ut=Q(B,et,B.length-et),lt=lt.inflateRawSync(ut),ut=$(B,lt.length+et);return B.copy(ut,0,0,et),lt.copy(ut,et),new V(ue,ut,0)}if(typeof pako>"u")throw"dicomParser.parseDicom: no inflater available to handle deflate transfer syntax";return lt=B.slice(et),ut=pako.inflateRaw(lt),(lt=$(B,ut.length+et)).set(B.slice(0,et),0),lt.set(ut,et),new V(ue,lt,0)}(We,Ve.position),Ve=new P(We.byteArrayParser,We.byteArray,{});Ve.warnings=We.warnings;try{(Ae?W:q)(Ve,We,We.byteArray.length,D)}catch(ke){throw{exception:ke,dataSet:Ve}}return Ve}return function(L,Ae){for(var We in L.elements)L.elements.hasOwnProperty(We)&&(Ae.elements[We]=L.elements[We]);return L.warnings!==void 0&&(Ae.warnings=L.warnings.concat(Ae.warnings)),Ae}(I=ve(B,D),j(I))}var Z=function(B,D,I){for(var O=0,j=D;j<D+I;j++)O+=B[j].length;return O};function de(B,Ae,I,O,j){if(j=j||Ae.fragments,B===void 0)throw"dicomParser.readEncapsulatedPixelDataFromFragments: missing required parameter 'dataSet'";if(Ae===void 0)throw"dicomParser.readEncapsulatedPixelDataFromFragments: missing required parameter 'pixelDataElement'";if(I===void 0)throw"dicomParser.readEncapsulatedPixelDataFromFragments: missing required parameter 'startFragmentIndex'";if((O=O||1)===void 0)throw"dicomParser.readEncapsulatedPixelDataFromFragments: missing required parameter 'numFragments'";if(Ae.tag!=="x7fe00010")throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'pixelDataElement' refers to non pixel data tag (expected tag = x7fe00010";if(Ae.encapsulatedPixelData!==!0||Ae.hadUndefinedLength!==!0||Ae.basicOffsetTable===void 0||Ae.fragments===void 0||Ae.fragments.length<=0)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(I<0)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'startFragmentIndex' must be >= 0";if(I>=Ae.fragments.length)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'startFragmentIndex' must be < number of fragments";if(O<1)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'numFragments' must be > 0";if(I+O>Ae.fragments.length)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'startFragment' + 'numFragments' < number of fragments";var L=new V(B.byteArrayParser,B.byteArray,Ae.dataOffset),Ae=F(L);if(Ae.tag!=="xfffee000")throw"dicomParser.readEncapsulatedPixelData: missing basic offset table xfffee000";L.seek(Ae.length);var We=L.position;if(O===1)return Q(L.byteArray,We+j[I].offset+8,j[I].length);for(var Ae=Z(j,I,O),Ve=$(L.byteArray,Ae),ke=0,et=I;et<I+O;et++)for(var nt=We+j[et].offset+8,lt=0;lt<j[et].length;lt++)Ve[ke++]=L.byteArray[nt++];return Ve}var Se=function(B,D){for(var I=0;I<B.length;I++)if(B[I].offset===D)return I},we=function(B,D,I,O){if(B===D.length-1)return I.length-O;for(var j=D[B+1],L=O+1;L<I.length;L++)if(I[L].offset===j)return L-O;throw"dicomParser.calculateNumberOfFragmentsForFrame: could not find fragment with offset matching basic offset table"};function _e(B,D,I,O,j){if(O=O||D.basicOffsetTable,j=j||D.fragments,B===void 0)throw"dicomParser.readEncapsulatedImageFrame: missing required parameter 'dataSet'";if(D===void 0)throw"dicomParser.readEncapsulatedImageFrame: missing required parameter 'pixelDataElement'";if(I===void 0)throw"dicomParser.readEncapsulatedImageFrame: missing required parameter 'frameIndex'";if(O===void 0)throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' does not have basicOffsetTable";if(D.tag!=="x7fe00010")throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' refers to non pixel data tag (expected tag = x7fe00010)";if(D.encapsulatedPixelData!==!0)throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(D.hadUndefinedLength!==!0)throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' refers to pixel data element that does not have undefined length";if(D.fragments===void 0)throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' refers to pixel data element that does not have fragments";if(O.length===0)throw"dicomParser.readEncapsulatedImageFrame: basicOffsetTable has zero entries";if(I<0)throw"dicomParser.readEncapsulatedImageFrame: parameter 'frameIndex' must be >= 0";if(I>=O.length)throw"dicomParser.readEncapsulatedImageFrame: parameter 'frameIndex' must be < basicOffsetTable.length";var L=O[I],L=Se(j,L);if(L===void 0)throw"dicomParser.readEncapsulatedImageFrame: unable to find fragment that matches basic offset table entry";return de(B,D,L,we(I,O,j,L),j)}var Ee=!1;function fe(B,D,I){if(Ee||(Ee=!0,console&&console.log&&console.log("WARNING: dicomParser.readEncapsulatedPixelData() has been deprecated")),B===void 0)throw"dicomParser.readEncapsulatedPixelData: missing required parameter 'dataSet'";if(D===void 0)throw"dicomParser.readEncapsulatedPixelData: missing required parameter 'element'";if(I===void 0)throw"dicomParser.readEncapsulatedPixelData: missing required parameter 'frame'";if(D.tag!=="x7fe00010")throw"dicomParser.readEncapsulatedPixelData: parameter 'element' refers to non pixel data tag (expected tag = x7fe00010)";if(D.encapsulatedPixelData!==!0||D.hadUndefinedLength!==!0||D.basicOffsetTable===void 0||D.fragments===void 0)throw"dicomParser.readEncapsulatedPixelData: parameter 'element' refers to pixel data element that does not have encapsulated pixel data";if(I<0)throw"dicomParser.readEncapsulatedPixelData: parameter 'frame' must be >= 0";return D.basicOffsetTable.length!==0?_e(B,D,I):de(B,D,0,D.fragments.length)}s.default={isStringVr:u,isPrivateTag:d,parsePN:h,parseTM:f,parseDA:v,explicitElementToString:m,explicitDataSetToJS:g,createJPEGBasicOffsetTable:x,parseDicomDataSetExplicit:W,parseDicomDataSetImplicit:q,readFixedString:C,alloc:$,version:le,bigEndianByteArrayParser:ee,ByteStream:V,sharedCopy:Q,DataSet:P,findAndSetUNElementLength:_,findEndOfEncapsulatedElement:w,findItemDelimitationItemAndSetElementLength:T,littleEndianByteArrayParser:ue,parseDicom:G,readDicomElementExplicit:X,readDicomElementImplicit:z,readEncapsulatedImageFrame:_e,readEncapsulatedPixelData:fe,readEncapsulatedPixelDataFromFragments:de,readPart10Header:ve,readSequenceItemsExplicit:ie,readSequenceItemsImplicit:N,readSequenceItem:F,readTag:S,LEI:"1.2.840.10008.1.2",LEE:"1.2.840.10008.1.2.1"}}],a={},i.m=n,i.c=a,i.d=function(o,s,l){i.o(o,s)||Object.defineProperty(o,s,{enumerable:!0,get:l})},i.r=function(o){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})},i.t=function(o,s){if(1&s&&(o=i(o)),8&s||4&s&&typeof o=="object"&&o&&o.__esModule)return o;var l=Object.create(null);if(i.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:o}),2&s&&typeof o!="string")for(var c in o)i.d(l,c,(function(u){return o[u]}).bind(null,c));return l},i.n=function(o){var s=o&&o.__esModule?function(){return o.default}:function(){return o};return i.d(s,"a",s),s},i.o=function(o,s){return Object.prototype.hasOwnProperty.call(o,s)},i.p="",i(i.s=1);function i(o){if(a[o])return a[o].exports;var s=a[o]={i:o,l:!1,exports:{}};return n[o].call(s.exports,s,s.exports,i),s.l=!0,s.exports}var n,a})})(Qj);var xme=Qj.exports;const wme=a0(xme);function As(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function hh(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}const Zj=6048e5,Sme=864e5;let Cme={};function Aw(){return Cme}function Sg(e,t){var s,l,c,u;const r=Aw(),i=(t==null?void 0:t.weekStartsOn)??((l=(s=t==null?void 0:t.locale)==null?void 0:s.options)==null?void 0:l.weekStartsOn)??r.weekStartsOn??((u=(c=r.locale)==null?void 0:c.options)==null?void 0:u.weekStartsOn)??0,n=As(e),a=n.getDay(),o=(a<i?7:0)+a-i;return n.setDate(n.getDate()-o),n.setHours(0,0,0,0),n}function Ox(e){return Sg(e,{weekStartsOn:1})}function Jj(e){const t=As(e),r=t.getFullYear(),i=hh(e,0);i.setFullYear(r+1,0,4),i.setHours(0,0,0,0);const n=Ox(i),a=hh(e,0);a.setFullYear(r,0,4),a.setHours(0,0,0,0);const o=Ox(a);return t.getTime()>=n.getTime()?r+1:t.getTime()>=o.getTime()?r:r-1}function PI(e){const t=As(e);return t.setHours(0,0,0,0),t}function DI(e){const t=As(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function _me(e,t){const r=PI(e),i=PI(t),n=+r-DI(r),a=+i-DI(i);return Math.round((n-a)/Sme)}function Ame(e){const t=Jj(e),r=hh(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),Ox(r)}function Mme(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function Eme(e){if(!Mme(e)&&typeof e!="number")return!1;const t=As(e);return!isNaN(Number(t))}function Tme(e){const t=As(e),r=hh(e,0);return r.setFullYear(t.getFullYear(),0,1),r.setHours(0,0,0,0),r}const Pme={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Dme=(e,t,r)=>{let i;const n=Pme[e];return typeof n=="string"?i=n:t===1?i=n.one:i=n.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+i:i+" ago":i};function tC(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const Ome={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Rme={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Ime={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},zme={date:tC({formats:Ome,defaultWidth:"full"}),time:tC({formats:Rme,defaultWidth:"full"}),dateTime:tC({formats:Ime,defaultWidth:"full"})},kme={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Lme=(e,t,r,i)=>kme[e];function zm(e){return(t,r)=>{const i=r!=null&&r.context?String(r.context):"standalone";let n;if(i==="formatting"&&e.formattingValues){const o=e.defaultFormattingWidth||e.defaultWidth,s=r!=null&&r.width?String(r.width):o;n=e.formattingValues[s]||e.formattingValues[o]}else{const o=e.defaultWidth,s=r!=null&&r.width?String(r.width):e.defaultWidth;n=e.values[s]||e.values[o]}const a=e.argumentCallback?e.argumentCallback(t):t;return n[a]}}const Bme={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Fme={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Nme={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Ume={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},jme={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Vme={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},Hme=(e,t)=>{const r=Number(e),i=r%100;if(i>20||i<10)switch(i%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},Wme={ordinalNumber:Hme,era:zm({values:Bme,defaultWidth:"wide"}),quarter:zm({values:Fme,defaultWidth:"wide",argumentCallback:e=>e-1}),month:zm({values:Nme,defaultWidth:"wide"}),day:zm({values:Ume,defaultWidth:"wide"}),dayPeriod:zm({values:jme,defaultWidth:"wide",formattingValues:Vme,defaultFormattingWidth:"wide"})};function km(e){return(t,r={})=>{const i=r.width,n=i&&e.matchPatterns[i]||e.matchPatterns[e.defaultMatchWidth],a=t.match(n);if(!a)return null;const o=a[0],s=i&&e.parsePatterns[i]||e.parsePatterns[e.defaultParseWidth],l=Array.isArray(s)?$me(s,d=>d.test(o)):Gme(s,d=>d.test(o));let c;c=e.valueCallback?e.valueCallback(l):l,c=r.valueCallback?r.valueCallback(c):c;const u=t.slice(o.length);return{value:c,rest:u}}}function Gme(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function $me(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function qme(e){return(t,r={})=>{const i=t.match(e.matchPattern);if(!i)return null;const n=i[0],a=t.match(e.parsePattern);if(!a)return null;let o=e.valueCallback?e.valueCallback(a[0]):a[0];o=r.valueCallback?r.valueCallback(o):o;const s=t.slice(n.length);return{value:o,rest:s}}}const Yme=/^(\d+)(th|st|nd|rd)?/i,Xme=/\d+/i,Kme={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Qme={any:[/^b/i,/^(a|c)/i]},Zme={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Jme={any:[/1/i,/2/i,/3/i,/4/i]},eve={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},tve={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},rve={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},ive={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},nve={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},ave={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},ove={ordinalNumber:qme({matchPattern:Yme,parsePattern:Xme,valueCallback:e=>parseInt(e,10)}),era:km({matchPatterns:Kme,defaultMatchWidth:"wide",parsePatterns:Qme,defaultParseWidth:"any"}),quarter:km({matchPatterns:Zme,defaultMatchWidth:"wide",parsePatterns:Jme,defaultParseWidth:"any",valueCallback:e=>e+1}),month:km({matchPatterns:eve,defaultMatchWidth:"wide",parsePatterns:tve,defaultParseWidth:"any"}),day:km({matchPatterns:rve,defaultMatchWidth:"wide",parsePatterns:ive,defaultParseWidth:"any"}),dayPeriod:km({matchPatterns:nve,defaultMatchWidth:"any",parsePatterns:ave,defaultParseWidth:"any"})},sve={code:"en-US",formatDistance:Dme,formatLong:zme,formatRelative:Lme,localize:Wme,match:ove,options:{weekStartsOn:0,firstWeekContainsDate:1}};function lve(e){const t=As(e);return _me(t,Tme(t))+1}function cve(e){const t=As(e),r=+Ox(t)-+Ame(t);return Math.round(r/Zj)+1}function eV(e,t){var u,d,h,f;const r=As(e),i=r.getFullYear(),n=Aw(),a=(t==null?void 0:t.firstWeekContainsDate)??((d=(u=t==null?void 0:t.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??n.firstWeekContainsDate??((f=(h=n.locale)==null?void 0:h.options)==null?void 0:f.firstWeekContainsDate)??1,o=hh(e,0);o.setFullYear(i+1,0,a),o.setHours(0,0,0,0);const s=Sg(o,t),l=hh(e,0);l.setFullYear(i,0,a),l.setHours(0,0,0,0);const c=Sg(l,t);return r.getTime()>=s.getTime()?i+1:r.getTime()>=c.getTime()?i:i-1}function uve(e,t){var s,l,c,u;const r=Aw(),i=(t==null?void 0:t.firstWeekContainsDate)??((l=(s=t==null?void 0:t.locale)==null?void 0:s.options)==null?void 0:l.firstWeekContainsDate)??r.firstWeekContainsDate??((u=(c=r.locale)==null?void 0:c.options)==null?void 0:u.firstWeekContainsDate)??1,n=eV(e,t),a=hh(e,0);return a.setFullYear(n,0,i),a.setHours(0,0,0,0),Sg(a,t)}function dve(e,t){const r=As(e),i=+Sg(r,t)-+uve(r,t);return Math.round(i/Zj)+1}function Jr(e,t){const r=e<0?"-":"",i=Math.abs(e).toString().padStart(t,"0");return r+i}const kc={y(e,t){const r=e.getFullYear(),i=r>0?r:1-r;return Jr(t==="yy"?i%100:i,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):Jr(r+1,2)},d(e,t){return Jr(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return Jr(e.getHours()%12||12,t.length)},H(e,t){return Jr(e.getHours(),t.length)},m(e,t){return Jr(e.getMinutes(),t.length)},s(e,t){return Jr(e.getSeconds(),t.length)},S(e,t){const r=t.length,i=e.getMilliseconds(),n=Math.trunc(i*Math.pow(10,r-3));return Jr(n,t.length)}},Xh={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},OI={G:function(e,t,r){const i=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(i,{width:"abbreviated"});case"GGGGG":return r.era(i,{width:"narrow"});case"GGGG":default:return r.era(i,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const i=e.getFullYear(),n=i>0?i:1-i;return r.ordinalNumber(n,{unit:"year"})}return kc.y(e,t)},Y:function(e,t,r,i){const n=eV(e,i),a=n>0?n:1-n;if(t==="YY"){const o=a%100;return Jr(o,2)}return t==="Yo"?r.ordinalNumber(a,{unit:"year"}):Jr(a,t.length)},R:function(e,t){const r=Jj(e);return Jr(r,t.length)},u:function(e,t){const r=e.getFullYear();return Jr(r,t.length)},Q:function(e,t,r){const i=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(i);case"QQ":return Jr(i,2);case"Qo":return r.ordinalNumber(i,{unit:"quarter"});case"QQQ":return r.quarter(i,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(i,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(i,{width:"wide",context:"formatting"})}},q:function(e,t,r){const i=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(i);case"qq":return Jr(i,2);case"qo":return r.ordinalNumber(i,{unit:"quarter"});case"qqq":return r.quarter(i,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(i,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(i,{width:"wide",context:"standalone"})}},M:function(e,t,r){const i=e.getMonth();switch(t){case"M":case"MM":return kc.M(e,t);case"Mo":return r.ordinalNumber(i+1,{unit:"month"});case"MMM":return r.month(i,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(i,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(i,{width:"wide",context:"formatting"})}},L:function(e,t,r){const i=e.getMonth();switch(t){case"L":return String(i+1);case"LL":return Jr(i+1,2);case"Lo":return r.ordinalNumber(i+1,{unit:"month"});case"LLL":return r.month(i,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(i,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(i,{width:"wide",context:"standalone"})}},w:function(e,t,r,i){const n=dve(e,i);return t==="wo"?r.ordinalNumber(n,{unit:"week"}):Jr(n,t.length)},I:function(e,t,r){const i=cve(e);return t==="Io"?r.ordinalNumber(i,{unit:"week"}):Jr(i,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):kc.d(e,t)},D:function(e,t,r){const i=lve(e);return t==="Do"?r.ordinalNumber(i,{unit:"dayOfYear"}):Jr(i,t.length)},E:function(e,t,r){const i=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(i,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(i,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(i,{width:"short",context:"formatting"});case"EEEE":default:return r.day(i,{width:"wide",context:"formatting"})}},e:function(e,t,r,i){const n=e.getDay(),a=(n-i.weekStartsOn+8)%7||7;switch(t){case"e":return String(a);case"ee":return Jr(a,2);case"eo":return r.ordinalNumber(a,{unit:"day"});case"eee":return r.day(n,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(n,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(n,{width:"short",context:"formatting"});case"eeee":default:return r.day(n,{width:"wide",context:"formatting"})}},c:function(e,t,r,i){const n=e.getDay(),a=(n-i.weekStartsOn+8)%7||7;switch(t){case"c":return String(a);case"cc":return Jr(a,t.length);case"co":return r.ordinalNumber(a,{unit:"day"});case"ccc":return r.day(n,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(n,{width:"narrow",context:"standalone"});case"cccccc":return r.day(n,{width:"short",context:"standalone"});case"cccc":default:return r.day(n,{width:"wide",context:"standalone"})}},i:function(e,t,r){const i=e.getDay(),n=i===0?7:i;switch(t){case"i":return String(n);case"ii":return Jr(n,t.length);case"io":return r.ordinalNumber(n,{unit:"day"});case"iii":return r.day(i,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(i,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(i,{width:"short",context:"formatting"});case"iiii":default:return r.day(i,{width:"wide",context:"formatting"})}},a:function(e,t,r){const n=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})}},b:function(e,t,r){const i=e.getHours();let n;switch(i===12?n=Xh.noon:i===0?n=Xh.midnight:n=i/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})}},B:function(e,t,r){const i=e.getHours();let n;switch(i>=17?n=Xh.evening:i>=12?n=Xh.afternoon:i>=4?n=Xh.morning:n=Xh.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let i=e.getHours()%12;return i===0&&(i=12),r.ordinalNumber(i,{unit:"hour"})}return kc.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):kc.H(e,t)},K:function(e,t,r){const i=e.getHours()%12;return t==="Ko"?r.ordinalNumber(i,{unit:"hour"}):Jr(i,t.length)},k:function(e,t,r){let i=e.getHours();return i===0&&(i=24),t==="ko"?r.ordinalNumber(i,{unit:"hour"}):Jr(i,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):kc.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):kc.s(e,t)},S:function(e,t){return kc.S(e,t)},X:function(e,t,r){const i=e.getTimezoneOffset();if(i===0)return"Z";switch(t){case"X":return II(i);case"XXXX":case"XX":return vd(i);case"XXXXX":case"XXX":default:return vd(i,":")}},x:function(e,t,r){const i=e.getTimezoneOffset();switch(t){case"x":return II(i);case"xxxx":case"xx":return vd(i);case"xxxxx":case"xxx":default:return vd(i,":")}},O:function(e,t,r){const i=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+RI(i,":");case"OOOO":default:return"GMT"+vd(i,":")}},z:function(e,t,r){const i=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+RI(i,":");case"zzzz":default:return"GMT"+vd(i,":")}},t:function(e,t,r){const i=Math.trunc(e.getTime()/1e3);return Jr(i,t.length)},T:function(e,t,r){const i=e.getTime();return Jr(i,t.length)}};function RI(e,t=""){const r=e>0?"-":"+",i=Math.abs(e),n=Math.trunc(i/60),a=i%60;return a===0?r+String(n):r+String(n)+t+Jr(a,2)}function II(e,t){return e%60===0?(e>0?"-":"+")+Jr(Math.abs(e)/60,2):vd(e,t)}function vd(e,t=""){const r=e>0?"-":"+",i=Math.abs(e),n=Jr(Math.trunc(i/60),2),a=Jr(i%60,2);return r+n+t+a}const zI=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},tV=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},hve=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],i=r[1],n=r[2];if(!n)return zI(e,t);let a;switch(i){case"P":a=t.dateTime({width:"short"});break;case"PP":a=t.dateTime({width:"medium"});break;case"PPP":a=t.dateTime({width:"long"});break;case"PPPP":default:a=t.dateTime({width:"full"});break}return a.replace("{{date}}",zI(i,t)).replace("{{time}}",tV(n,t))},fve={p:tV,P:hve},pve=/^D+$/,mve=/^Y+$/,vve=["D","DD","YY","YYYY"];function gve(e){return pve.test(e)}function yve(e){return mve.test(e)}function bve(e,t,r){const i=xve(e,t,r);if(console.warn(i),vve.includes(e))throw new RangeError(i)}function xve(e,t,r){const i=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${i} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const wve=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Sve=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Cve=/^'([^]*?)'?$/,_ve=/''/g,Ave=/[a-zA-Z]/;function Vv(e,t,r){var u,d,h,f;const i=Aw(),n=i.locale??sve,a=i.firstWeekContainsDate??((d=(u=i.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??1,o=i.weekStartsOn??((f=(h=i.locale)==null?void 0:h.options)==null?void 0:f.weekStartsOn)??0,s=As(e);if(!Eme(s))throw new RangeError("Invalid time value");let l=t.match(Sve).map(p=>{const v=p[0];if(v==="p"||v==="P"){const m=fve[v];return m(p,n.formatLong)}return p}).join("").match(wve).map(p=>{if(p==="''")return{isToken:!1,value:"'"};const v=p[0];if(v==="'")return{isToken:!1,value:Mve(p)};if(OI[v])return{isToken:!0,value:p};if(v.match(Ave))throw new RangeError("Format string contains an unescaped latin alphabet character `"+v+"`");return{isToken:!1,value:p}});n.localize.preprocessor&&(l=n.localize.preprocessor(s,l));const c={firstWeekContainsDate:a,weekStartsOn:o,locale:n};return l.map(p=>{if(!p.isToken)return p.value;const v=p.value;(yve(v)||gve(v))&&bve(v,t,String(e));const m=OI[v[0]];return m(s,v,n.localize,c)}).join("")}function Mve(e){const t=e.match(Cve);return t?t[1].replace(_ve,"'"):e}/*! js-yaml 4.1.0 https://github.com/nodeca/js-yaml @license MIT */function rV(e){return typeof e>"u"||e===null}function Eve(e){return typeof e=="object"&&e!==null}function Tve(e){return Array.isArray(e)?e:rV(e)?[]:[e]}function Pve(e,t){var r,i,n,a;if(t)for(a=Object.keys(t),r=0,i=a.length;r<i;r+=1)n=a[r],e[n]=t[n];return e}function Dve(e,t){var r="",i;for(i=0;i<t;i+=1)r+=e;return r}function Ove(e){return e===0&&Number.NEGATIVE_INFINITY===1/e}var Rve=rV,Ive=Eve,zve=Tve,kve=Dve,Lve=Ove,Bve=Pve,yn={isNothing:Rve,isObject:Ive,toArray:zve,repeat:kve,isNegativeZero:Lve,extend:Bve};function iV(e,t){var r="",i=e.reason||"(unknown reason)";return e.mark?(e.mark.name&&(r+='in "'+e.mark.name+'" '),r+="("+(e.mark.line+1)+":"+(e.mark.column+1)+")",!t&&e.mark.snippet&&(r+=`

`+e.mark.snippet),i+" "+r):i}function Cg(e,t){Error.call(this),this.name="YAMLException",this.reason=e,this.mark=t,this.message=iV(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||""}Cg.prototype=Object.create(Error.prototype);Cg.prototype.constructor=Cg;Cg.prototype.toString=function(t){return this.name+": "+iV(this,t)};var Ra=Cg;function rC(e,t,r,i,n){var a="",o="",s=Math.floor(n/2)-1;return i-t>s&&(a=" ... ",t=i-s+a.length),r-i>s&&(o=" ...",r=i+s-o.length),{str:a+e.slice(t,r).replace(/\t/g,"")+o,pos:i-t+a.length}}function iC(e,t){return yn.repeat(" ",t-e.length)+e}function Fve(e,t){if(t=Object.create(t||null),!e.buffer)return null;t.maxLength||(t.maxLength=79),typeof t.indent!="number"&&(t.indent=1),typeof t.linesBefore!="number"&&(t.linesBefore=3),typeof t.linesAfter!="number"&&(t.linesAfter=2);for(var r=/\r?\n|\r|\0/g,i=[0],n=[],a,o=-1;a=r.exec(e.buffer);)n.push(a.index),i.push(a.index+a[0].length),e.position<=a.index&&o<0&&(o=i.length-2);o<0&&(o=i.length-1);var s="",l,c,u=Math.min(e.line+t.linesAfter,n.length).toString().length,d=t.maxLength-(t.indent+u+3);for(l=1;l<=t.linesBefore&&!(o-l<0);l++)c=rC(e.buffer,i[o-l],n[o-l],e.position-(i[o]-i[o-l]),d),s=yn.repeat(" ",t.indent)+iC((e.line-l+1).toString(),u)+" | "+c.str+`
`+s;for(c=rC(e.buffer,i[o],n[o],e.position,d),s+=yn.repeat(" ",t.indent)+iC((e.line+1).toString(),u)+" | "+c.str+`
`,s+=yn.repeat("-",t.indent+u+3+c.pos)+`^
`,l=1;l<=t.linesAfter&&!(o+l>=n.length);l++)c=rC(e.buffer,i[o+l],n[o+l],e.position-(i[o]-i[o+l]),d),s+=yn.repeat(" ",t.indent)+iC((e.line+l+1).toString(),u)+" | "+c.str+`
`;return s.replace(/\n$/,"")}var Nve=Fve,Uve=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],jve=["scalar","sequence","mapping"];function Vve(e){var t={};return e!==null&&Object.keys(e).forEach(function(r){e[r].forEach(function(i){t[String(i)]=r})}),t}function Hve(e,t){if(t=t||{},Object.keys(t).forEach(function(r){if(Uve.indexOf(r)===-1)throw new Ra('Unknown option "'+r+'" is met in definition of "'+e+'" YAML type.')}),this.options=t,this.tag=e,this.kind=t.kind||null,this.resolve=t.resolve||function(){return!0},this.construct=t.construct||function(r){return r},this.instanceOf=t.instanceOf||null,this.predicate=t.predicate||null,this.represent=t.represent||null,this.representName=t.representName||null,this.defaultStyle=t.defaultStyle||null,this.multi=t.multi||!1,this.styleAliases=Vve(t.styleAliases||null),jve.indexOf(this.kind)===-1)throw new Ra('Unknown kind "'+this.kind+'" is specified for "'+e+'" YAML type.')}var oa=Hve;function kI(e,t){var r=[];return e[t].forEach(function(i){var n=r.length;r.forEach(function(a,o){a.tag===i.tag&&a.kind===i.kind&&a.multi===i.multi&&(n=o)}),r[n]=i}),r}function Wve(){var e={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}},t,r;function i(n){n.multi?(e.multi[n.kind].push(n),e.multi.fallback.push(n)):e[n.kind][n.tag]=e.fallback[n.tag]=n}for(t=0,r=arguments.length;t<r;t+=1)arguments[t].forEach(i);return e}function aM(e){return this.extend(e)}aM.prototype.extend=function(t){var r=[],i=[];if(t instanceof oa)i.push(t);else if(Array.isArray(t))i=i.concat(t);else if(t&&(Array.isArray(t.implicit)||Array.isArray(t.explicit)))t.implicit&&(r=r.concat(t.implicit)),t.explicit&&(i=i.concat(t.explicit));else throw new Ra("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");r.forEach(function(a){if(!(a instanceof oa))throw new Ra("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(a.loadKind&&a.loadKind!=="scalar")throw new Ra("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(a.multi)throw new Ra("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),i.forEach(function(a){if(!(a instanceof oa))throw new Ra("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var n=Object.create(aM.prototype);return n.implicit=(this.implicit||[]).concat(r),n.explicit=(this.explicit||[]).concat(i),n.compiledImplicit=kI(n,"implicit"),n.compiledExplicit=kI(n,"explicit"),n.compiledTypeMap=Wve(n.compiledImplicit,n.compiledExplicit),n};var nV=aM,aV=new oa("tag:yaml.org,2002:str",{kind:"scalar",construct:function(e){return e!==null?e:""}}),oV=new oa("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(e){return e!==null?e:[]}}),sV=new oa("tag:yaml.org,2002:map",{kind:"mapping",construct:function(e){return e!==null?e:{}}}),lV=new nV({explicit:[aV,oV,sV]});function Gve(e){if(e===null)return!0;var t=e.length;return t===1&&e==="~"||t===4&&(e==="null"||e==="Null"||e==="NULL")}function $ve(){return null}function qve(e){return e===null}var cV=new oa("tag:yaml.org,2002:null",{kind:"scalar",resolve:Gve,construct:$ve,predicate:qve,represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"});function Yve(e){if(e===null)return!1;var t=e.length;return t===4&&(e==="true"||e==="True"||e==="TRUE")||t===5&&(e==="false"||e==="False"||e==="FALSE")}function Xve(e){return e==="true"||e==="True"||e==="TRUE"}function Kve(e){return Object.prototype.toString.call(e)==="[object Boolean]"}var uV=new oa("tag:yaml.org,2002:bool",{kind:"scalar",resolve:Yve,construct:Xve,predicate:Kve,represent:{lowercase:function(e){return e?"true":"false"},uppercase:function(e){return e?"TRUE":"FALSE"},camelcase:function(e){return e?"True":"False"}},defaultStyle:"lowercase"});function Qve(e){return 48<=e&&e<=57||65<=e&&e<=70||97<=e&&e<=102}function Zve(e){return 48<=e&&e<=55}function Jve(e){return 48<=e&&e<=57}function ege(e){if(e===null)return!1;var t=e.length,r=0,i=!1,n;if(!t)return!1;if(n=e[r],(n==="-"||n==="+")&&(n=e[++r]),n==="0"){if(r+1===t)return!0;if(n=e[++r],n==="b"){for(r++;r<t;r++)if(n=e[r],n!=="_"){if(n!=="0"&&n!=="1")return!1;i=!0}return i&&n!=="_"}if(n==="x"){for(r++;r<t;r++)if(n=e[r],n!=="_"){if(!Qve(e.charCodeAt(r)))return!1;i=!0}return i&&n!=="_"}if(n==="o"){for(r++;r<t;r++)if(n=e[r],n!=="_"){if(!Zve(e.charCodeAt(r)))return!1;i=!0}return i&&n!=="_"}}if(n==="_")return!1;for(;r<t;r++)if(n=e[r],n!=="_"){if(!Jve(e.charCodeAt(r)))return!1;i=!0}return!(!i||n==="_")}function tge(e){var t=e,r=1,i;if(t.indexOf("_")!==-1&&(t=t.replace(/_/g,"")),i=t[0],(i==="-"||i==="+")&&(i==="-"&&(r=-1),t=t.slice(1),i=t[0]),t==="0")return 0;if(i==="0"){if(t[1]==="b")return r*parseInt(t.slice(2),2);if(t[1]==="x")return r*parseInt(t.slice(2),16);if(t[1]==="o")return r*parseInt(t.slice(2),8)}return r*parseInt(t,10)}function rge(e){return Object.prototype.toString.call(e)==="[object Number]"&&e%1===0&&!yn.isNegativeZero(e)}var dV=new oa("tag:yaml.org,2002:int",{kind:"scalar",resolve:ege,construct:tge,predicate:rge,represent:{binary:function(e){return e>=0?"0b"+e.toString(2):"-0b"+e.toString(2).slice(1)},octal:function(e){return e>=0?"0o"+e.toString(8):"-0o"+e.toString(8).slice(1)},decimal:function(e){return e.toString(10)},hexadecimal:function(e){return e>=0?"0x"+e.toString(16).toUpperCase():"-0x"+e.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),ige=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");function nge(e){return!(e===null||!ige.test(e)||e[e.length-1]==="_")}function age(e){var t,r;return t=e.replace(/_/g,"").toLowerCase(),r=t[0]==="-"?-1:1,"+-".indexOf(t[0])>=0&&(t=t.slice(1)),t===".inf"?r===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:t===".nan"?NaN:r*parseFloat(t,10)}var oge=/^[-+]?[0-9]+e/;function sge(e,t){var r;if(isNaN(e))switch(t){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===e)switch(t){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===e)switch(t){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(yn.isNegativeZero(e))return"-0.0";return r=e.toString(10),oge.test(r)?r.replace("e",".e"):r}function lge(e){return Object.prototype.toString.call(e)==="[object Number]"&&(e%1!==0||yn.isNegativeZero(e))}var hV=new oa("tag:yaml.org,2002:float",{kind:"scalar",resolve:nge,construct:age,predicate:lge,represent:sge,defaultStyle:"lowercase"}),fV=lV.extend({implicit:[cV,uV,dV,hV]}),pV=fV,mV=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),vV=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");function cge(e){return e===null?!1:mV.exec(e)!==null||vV.exec(e)!==null}function uge(e){var t,r,i,n,a,o,s,l=0,c=null,u,d,h;if(t=mV.exec(e),t===null&&(t=vV.exec(e)),t===null)throw new Error("Date resolve error");if(r=+t[1],i=+t[2]-1,n=+t[3],!t[4])return new Date(Date.UTC(r,i,n));if(a=+t[4],o=+t[5],s=+t[6],t[7]){for(l=t[7].slice(0,3);l.length<3;)l+="0";l=+l}return t[9]&&(u=+t[10],d=+(t[11]||0),c=(u*60+d)*6e4,t[9]==="-"&&(c=-c)),h=new Date(Date.UTC(r,i,n,a,o,s,l)),c&&h.setTime(h.getTime()-c),h}function dge(e){return e.toISOString()}var gV=new oa("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:cge,construct:uge,instanceOf:Date,represent:dge});function hge(e){return e==="<<"||e===null}var yV=new oa("tag:yaml.org,2002:merge",{kind:"scalar",resolve:hge}),RP=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
\r`;function fge(e){if(e===null)return!1;var t,r,i=0,n=e.length,a=RP;for(r=0;r<n;r++)if(t=a.indexOf(e.charAt(r)),!(t>64)){if(t<0)return!1;i+=6}return i%8===0}function pge(e){var t,r,i=e.replace(/[\r\n=]/g,""),n=i.length,a=RP,o=0,s=[];for(t=0;t<n;t++)t%4===0&&t&&(s.push(o>>16&255),s.push(o>>8&255),s.push(o&255)),o=o<<6|a.indexOf(i.charAt(t));return r=n%4*6,r===0?(s.push(o>>16&255),s.push(o>>8&255),s.push(o&255)):r===18?(s.push(o>>10&255),s.push(o>>2&255)):r===12&&s.push(o>>4&255),new Uint8Array(s)}function mge(e){var t="",r=0,i,n,a=e.length,o=RP;for(i=0;i<a;i++)i%3===0&&i&&(t+=o[r>>18&63],t+=o[r>>12&63],t+=o[r>>6&63],t+=o[r&63]),r=(r<<8)+e[i];return n=a%3,n===0?(t+=o[r>>18&63],t+=o[r>>12&63],t+=o[r>>6&63],t+=o[r&63]):n===2?(t+=o[r>>10&63],t+=o[r>>4&63],t+=o[r<<2&63],t+=o[64]):n===1&&(t+=o[r>>2&63],t+=o[r<<4&63],t+=o[64],t+=o[64]),t}function vge(e){return Object.prototype.toString.call(e)==="[object Uint8Array]"}var bV=new oa("tag:yaml.org,2002:binary",{kind:"scalar",resolve:fge,construct:pge,predicate:vge,represent:mge}),gge=Object.prototype.hasOwnProperty,yge=Object.prototype.toString;function bge(e){if(e===null)return!0;var t=[],r,i,n,a,o,s=e;for(r=0,i=s.length;r<i;r+=1){if(n=s[r],o=!1,yge.call(n)!=="[object Object]")return!1;for(a in n)if(gge.call(n,a))if(!o)o=!0;else return!1;if(!o)return!1;if(t.indexOf(a)===-1)t.push(a);else return!1}return!0}function xge(e){return e!==null?e:[]}var xV=new oa("tag:yaml.org,2002:omap",{kind:"sequence",resolve:bge,construct:xge}),wge=Object.prototype.toString;function Sge(e){if(e===null)return!0;var t,r,i,n,a,o=e;for(a=new Array(o.length),t=0,r=o.length;t<r;t+=1){if(i=o[t],wge.call(i)!=="[object Object]"||(n=Object.keys(i),n.length!==1))return!1;a[t]=[n[0],i[n[0]]]}return!0}function Cge(e){if(e===null)return[];var t,r,i,n,a,o=e;for(a=new Array(o.length),t=0,r=o.length;t<r;t+=1)i=o[t],n=Object.keys(i),a[t]=[n[0],i[n[0]]];return a}var wV=new oa("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:Sge,construct:Cge}),_ge=Object.prototype.hasOwnProperty;function Age(e){if(e===null)return!0;var t,r=e;for(t in r)if(_ge.call(r,t)&&r[t]!==null)return!1;return!0}function Mge(e){return e!==null?e:{}}var SV=new oa("tag:yaml.org,2002:set",{kind:"mapping",resolve:Age,construct:Mge}),IP=pV.extend({implicit:[gV,yV],explicit:[bV,xV,wV,SV]}),Lu=Object.prototype.hasOwnProperty,Rx=1,CV=2,_V=3,Ix=4,nC=1,Ege=2,LI=3,Tge=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,Pge=/[\x85\u2028\u2029]/,Dge=/[,\[\]\{\}]/,AV=/^(?:!|!!|![a-z\-]+!)$/i,MV=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function BI(e){return Object.prototype.toString.call(e)}function ol(e){return e===10||e===13}function Kd(e){return e===9||e===32}function Za(e){return e===9||e===32||e===10||e===13}function Uf(e){return e===44||e===91||e===93||e===123||e===125}function Oge(e){var t;return 48<=e&&e<=57?e-48:(t=e|32,97<=t&&t<=102?t-97+10:-1)}function Rge(e){return e===120?2:e===117?4:e===85?8:0}function Ige(e){return 48<=e&&e<=57?e-48:-1}function FI(e){return e===48?"\0":e===97?"\x07":e===98?"\b":e===116||e===9?"	":e===110?`
`:e===118?"\v":e===102?"\f":e===114?"\r":e===101?"\x1B":e===32?" ":e===34?'"':e===47?"/":e===92?"\\":e===78?"":e===95?"":e===76?"\u2028":e===80?"\u2029":""}function zge(e){return e<=65535?String.fromCharCode(e):String.fromCharCode((e-65536>>10)+55296,(e-65536&1023)+56320)}var EV=new Array(256),TV=new Array(256);for(var Kh=0;Kh<256;Kh++)EV[Kh]=FI(Kh)?1:0,TV[Kh]=FI(Kh);function kge(e,t){this.input=e,this.filename=t.filename||null,this.schema=t.schema||IP,this.onWarning=t.onWarning||null,this.legacy=t.legacy||!1,this.json=t.json||!1,this.listener=t.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=e.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function PV(e,t){var r={name:e.filename,buffer:e.input.slice(0,-1),position:e.position,line:e.line,column:e.position-e.lineStart};return r.snippet=Nve(r),new Ra(t,r)}function kt(e,t){throw PV(e,t)}function zx(e,t){e.onWarning&&e.onWarning.call(null,PV(e,t))}var NI={YAML:function(t,r,i){var n,a,o;t.version!==null&&kt(t,"duplication of %YAML directive"),i.length!==1&&kt(t,"YAML directive accepts exactly one argument"),n=/^([0-9]+)\.([0-9]+)$/.exec(i[0]),n===null&&kt(t,"ill-formed argument of the YAML directive"),a=parseInt(n[1],10),o=parseInt(n[2],10),a!==1&&kt(t,"unacceptable YAML version of the document"),t.version=i[0],t.checkLineBreaks=o<2,o!==1&&o!==2&&zx(t,"unsupported YAML version of the document")},TAG:function(t,r,i){var n,a;i.length!==2&&kt(t,"TAG directive accepts exactly two arguments"),n=i[0],a=i[1],AV.test(n)||kt(t,"ill-formed tag handle (first argument) of the TAG directive"),Lu.call(t.tagMap,n)&&kt(t,'there is a previously declared suffix for "'+n+'" tag handle'),MV.test(a)||kt(t,"ill-formed tag prefix (second argument) of the TAG directive");try{a=decodeURIComponent(a)}catch{kt(t,"tag prefix is malformed: "+a)}t.tagMap[n]=a}};function Au(e,t,r,i){var n,a,o,s;if(t<r){if(s=e.input.slice(t,r),i)for(n=0,a=s.length;n<a;n+=1)o=s.charCodeAt(n),o===9||32<=o&&o<=1114111||kt(e,"expected valid JSON character");else Tge.test(s)&&kt(e,"the stream contains non-printable characters");e.result+=s}}function UI(e,t,r,i){var n,a,o,s;for(yn.isObject(r)||kt(e,"cannot merge mappings; the provided source object is unacceptable"),n=Object.keys(r),o=0,s=n.length;o<s;o+=1)a=n[o],Lu.call(t,a)||(t[a]=r[a],i[a]=!0)}function jf(e,t,r,i,n,a,o,s,l){var c,u;if(Array.isArray(n))for(n=Array.prototype.slice.call(n),c=0,u=n.length;c<u;c+=1)Array.isArray(n[c])&&kt(e,"nested arrays are not supported inside keys"),typeof n=="object"&&BI(n[c])==="[object Object]"&&(n[c]="[object Object]");if(typeof n=="object"&&BI(n)==="[object Object]"&&(n="[object Object]"),n=String(n),t===null&&(t={}),i==="tag:yaml.org,2002:merge")if(Array.isArray(a))for(c=0,u=a.length;c<u;c+=1)UI(e,t,a[c],r);else UI(e,t,a,r);else!e.json&&!Lu.call(r,n)&&Lu.call(t,n)&&(e.line=o||e.line,e.lineStart=s||e.lineStart,e.position=l||e.position,kt(e,"duplicated mapping key")),n==="__proto__"?Object.defineProperty(t,n,{configurable:!0,enumerable:!0,writable:!0,value:a}):t[n]=a,delete r[n];return t}function zP(e){var t;t=e.input.charCodeAt(e.position),t===10?e.position++:t===13?(e.position++,e.input.charCodeAt(e.position)===10&&e.position++):kt(e,"a line break is expected"),e.line+=1,e.lineStart=e.position,e.firstTabInLine=-1}function on(e,t,r){for(var i=0,n=e.input.charCodeAt(e.position);n!==0;){for(;Kd(n);)n===9&&e.firstTabInLine===-1&&(e.firstTabInLine=e.position),n=e.input.charCodeAt(++e.position);if(t&&n===35)do n=e.input.charCodeAt(++e.position);while(n!==10&&n!==13&&n!==0);if(ol(n))for(zP(e),n=e.input.charCodeAt(e.position),i++,e.lineIndent=0;n===32;)e.lineIndent++,n=e.input.charCodeAt(++e.position);else break}return r!==-1&&i!==0&&e.lineIndent<r&&zx(e,"deficient indentation"),i}function Mw(e){var t=e.position,r;return r=e.input.charCodeAt(t),!!((r===45||r===46)&&r===e.input.charCodeAt(t+1)&&r===e.input.charCodeAt(t+2)&&(t+=3,r=e.input.charCodeAt(t),r===0||Za(r)))}function kP(e,t){t===1?e.result+=" ":t>1&&(e.result+=yn.repeat(`
`,t-1))}function Lge(e,t,r){var i,n,a,o,s,l,c,u,d=e.kind,h=e.result,f;if(f=e.input.charCodeAt(e.position),Za(f)||Uf(f)||f===35||f===38||f===42||f===33||f===124||f===62||f===39||f===34||f===37||f===64||f===96||(f===63||f===45)&&(n=e.input.charCodeAt(e.position+1),Za(n)||r&&Uf(n)))return!1;for(e.kind="scalar",e.result="",a=o=e.position,s=!1;f!==0;){if(f===58){if(n=e.input.charCodeAt(e.position+1),Za(n)||r&&Uf(n))break}else if(f===35){if(i=e.input.charCodeAt(e.position-1),Za(i))break}else{if(e.position===e.lineStart&&Mw(e)||r&&Uf(f))break;if(ol(f))if(l=e.line,c=e.lineStart,u=e.lineIndent,on(e,!1,-1),e.lineIndent>=t){s=!0,f=e.input.charCodeAt(e.position);continue}else{e.position=o,e.line=l,e.lineStart=c,e.lineIndent=u;break}}s&&(Au(e,a,o,!1),kP(e,e.line-l),a=o=e.position,s=!1),Kd(f)||(o=e.position+1),f=e.input.charCodeAt(++e.position)}return Au(e,a,o,!1),e.result?!0:(e.kind=d,e.result=h,!1)}function Bge(e,t){var r,i,n;if(r=e.input.charCodeAt(e.position),r!==39)return!1;for(e.kind="scalar",e.result="",e.position++,i=n=e.position;(r=e.input.charCodeAt(e.position))!==0;)if(r===39)if(Au(e,i,e.position,!0),r=e.input.charCodeAt(++e.position),r===39)i=e.position,e.position++,n=e.position;else return!0;else ol(r)?(Au(e,i,n,!0),kP(e,on(e,!1,t)),i=n=e.position):e.position===e.lineStart&&Mw(e)?kt(e,"unexpected end of the document within a single quoted scalar"):(e.position++,n=e.position);kt(e,"unexpected end of the stream within a single quoted scalar")}function Fge(e,t){var r,i,n,a,o,s;if(s=e.input.charCodeAt(e.position),s!==34)return!1;for(e.kind="scalar",e.result="",e.position++,r=i=e.position;(s=e.input.charCodeAt(e.position))!==0;){if(s===34)return Au(e,r,e.position,!0),e.position++,!0;if(s===92){if(Au(e,r,e.position,!0),s=e.input.charCodeAt(++e.position),ol(s))on(e,!1,t);else if(s<256&&EV[s])e.result+=TV[s],e.position++;else if((o=Rge(s))>0){for(n=o,a=0;n>0;n--)s=e.input.charCodeAt(++e.position),(o=Oge(s))>=0?a=(a<<4)+o:kt(e,"expected hexadecimal character");e.result+=zge(a),e.position++}else kt(e,"unknown escape sequence");r=i=e.position}else ol(s)?(Au(e,r,i,!0),kP(e,on(e,!1,t)),r=i=e.position):e.position===e.lineStart&&Mw(e)?kt(e,"unexpected end of the document within a double quoted scalar"):(e.position++,i=e.position)}kt(e,"unexpected end of the stream within a double quoted scalar")}function Nge(e,t){var r=!0,i,n,a,o=e.tag,s,l=e.anchor,c,u,d,h,f,p=Object.create(null),v,m,g,y;if(y=e.input.charCodeAt(e.position),y===91)u=93,f=!1,s=[];else if(y===123)u=125,f=!0,s={};else return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=s),y=e.input.charCodeAt(++e.position);y!==0;){if(on(e,!0,t),y=e.input.charCodeAt(e.position),y===u)return e.position++,e.tag=o,e.anchor=l,e.kind=f?"mapping":"sequence",e.result=s,!0;r?y===44&&kt(e,"expected the node content, but found ','"):kt(e,"missed comma between flow collection entries"),m=v=g=null,d=h=!1,y===63&&(c=e.input.charCodeAt(e.position+1),Za(c)&&(d=h=!0,e.position++,on(e,!0,t))),i=e.line,n=e.lineStart,a=e.position,Ip(e,t,Rx,!1,!0),m=e.tag,v=e.result,on(e,!0,t),y=e.input.charCodeAt(e.position),(h||e.line===i)&&y===58&&(d=!0,y=e.input.charCodeAt(++e.position),on(e,!0,t),Ip(e,t,Rx,!1,!0),g=e.result),f?jf(e,s,p,m,v,g,i,n,a):d?s.push(jf(e,null,p,m,v,g,i,n,a)):s.push(v),on(e,!0,t),y=e.input.charCodeAt(e.position),y===44?(r=!0,y=e.input.charCodeAt(++e.position)):r=!1}kt(e,"unexpected end of the stream within a flow collection")}function Uge(e,t){var r,i,n=nC,a=!1,o=!1,s=t,l=0,c=!1,u,d;if(d=e.input.charCodeAt(e.position),d===124)i=!1;else if(d===62)i=!0;else return!1;for(e.kind="scalar",e.result="";d!==0;)if(d=e.input.charCodeAt(++e.position),d===43||d===45)nC===n?n=d===43?LI:Ege:kt(e,"repeat of a chomping mode identifier");else if((u=Ige(d))>=0)u===0?kt(e,"bad explicit indentation width of a block scalar; it cannot be less than one"):o?kt(e,"repeat of an indentation width identifier"):(s=t+u-1,o=!0);else break;if(Kd(d)){do d=e.input.charCodeAt(++e.position);while(Kd(d));if(d===35)do d=e.input.charCodeAt(++e.position);while(!ol(d)&&d!==0)}for(;d!==0;){for(zP(e),e.lineIndent=0,d=e.input.charCodeAt(e.position);(!o||e.lineIndent<s)&&d===32;)e.lineIndent++,d=e.input.charCodeAt(++e.position);if(!o&&e.lineIndent>s&&(s=e.lineIndent),ol(d)){l++;continue}if(e.lineIndent<s){n===LI?e.result+=yn.repeat(`
`,a?1+l:l):n===nC&&a&&(e.result+=`
`);break}for(i?Kd(d)?(c=!0,e.result+=yn.repeat(`
`,a?1+l:l)):c?(c=!1,e.result+=yn.repeat(`
`,l+1)):l===0?a&&(e.result+=" "):e.result+=yn.repeat(`
`,l):e.result+=yn.repeat(`
`,a?1+l:l),a=!0,o=!0,l=0,r=e.position;!ol(d)&&d!==0;)d=e.input.charCodeAt(++e.position);Au(e,r,e.position,!1)}return!0}function jI(e,t){var r,i=e.tag,n=e.anchor,a=[],o,s=!1,l;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=a),l=e.input.charCodeAt(e.position);l!==0&&(e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,kt(e,"tab characters must not be used in indentation")),!(l!==45||(o=e.input.charCodeAt(e.position+1),!Za(o))));){if(s=!0,e.position++,on(e,!0,-1)&&e.lineIndent<=t){a.push(null),l=e.input.charCodeAt(e.position);continue}if(r=e.line,Ip(e,t,_V,!1,!0),a.push(e.result),on(e,!0,-1),l=e.input.charCodeAt(e.position),(e.line===r||e.lineIndent>t)&&l!==0)kt(e,"bad indentation of a sequence entry");else if(e.lineIndent<t)break}return s?(e.tag=i,e.anchor=n,e.kind="sequence",e.result=a,!0):!1}function jge(e,t,r){var i,n,a,o,s,l,c=e.tag,u=e.anchor,d={},h=Object.create(null),f=null,p=null,v=null,m=!1,g=!1,y;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=d),y=e.input.charCodeAt(e.position);y!==0;){if(!m&&e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,kt(e,"tab characters must not be used in indentation")),i=e.input.charCodeAt(e.position+1),a=e.line,(y===63||y===58)&&Za(i))y===63?(m&&(jf(e,d,h,f,p,null,o,s,l),f=p=v=null),g=!0,m=!0,n=!0):m?(m=!1,n=!0):kt(e,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),e.position+=1,y=i;else{if(o=e.line,s=e.lineStart,l=e.position,!Ip(e,r,CV,!1,!0))break;if(e.line===a){for(y=e.input.charCodeAt(e.position);Kd(y);)y=e.input.charCodeAt(++e.position);if(y===58)y=e.input.charCodeAt(++e.position),Za(y)||kt(e,"a whitespace character is expected after the key-value separator within a block mapping"),m&&(jf(e,d,h,f,p,null,o,s,l),f=p=v=null),g=!0,m=!1,n=!1,f=e.tag,p=e.result;else if(g)kt(e,"can not read an implicit mapping pair; a colon is missed");else return e.tag=c,e.anchor=u,!0}else if(g)kt(e,"can not read a block mapping entry; a multiline key may not be an implicit key");else return e.tag=c,e.anchor=u,!0}if((e.line===a||e.lineIndent>t)&&(m&&(o=e.line,s=e.lineStart,l=e.position),Ip(e,t,Ix,!0,n)&&(m?p=e.result:v=e.result),m||(jf(e,d,h,f,p,v,o,s,l),f=p=v=null),on(e,!0,-1),y=e.input.charCodeAt(e.position)),(e.line===a||e.lineIndent>t)&&y!==0)kt(e,"bad indentation of a mapping entry");else if(e.lineIndent<t)break}return m&&jf(e,d,h,f,p,null,o,s,l),g&&(e.tag=c,e.anchor=u,e.kind="mapping",e.result=d),g}function Vge(e){var t,r=!1,i=!1,n,a,o;if(o=e.input.charCodeAt(e.position),o!==33)return!1;if(e.tag!==null&&kt(e,"duplication of a tag property"),o=e.input.charCodeAt(++e.position),o===60?(r=!0,o=e.input.charCodeAt(++e.position)):o===33?(i=!0,n="!!",o=e.input.charCodeAt(++e.position)):n="!",t=e.position,r){do o=e.input.charCodeAt(++e.position);while(o!==0&&o!==62);e.position<e.length?(a=e.input.slice(t,e.position),o=e.input.charCodeAt(++e.position)):kt(e,"unexpected end of the stream within a verbatim tag")}else{for(;o!==0&&!Za(o);)o===33&&(i?kt(e,"tag suffix cannot contain exclamation marks"):(n=e.input.slice(t-1,e.position+1),AV.test(n)||kt(e,"named tag handle cannot contain such characters"),i=!0,t=e.position+1)),o=e.input.charCodeAt(++e.position);a=e.input.slice(t,e.position),Dge.test(a)&&kt(e,"tag suffix cannot contain flow indicator characters")}a&&!MV.test(a)&&kt(e,"tag name cannot contain such characters: "+a);try{a=decodeURIComponent(a)}catch{kt(e,"tag name is malformed: "+a)}return r?e.tag=a:Lu.call(e.tagMap,n)?e.tag=e.tagMap[n]+a:n==="!"?e.tag="!"+a:n==="!!"?e.tag="tag:yaml.org,2002:"+a:kt(e,'undeclared tag handle "'+n+'"'),!0}function Hge(e){var t,r;if(r=e.input.charCodeAt(e.position),r!==38)return!1;for(e.anchor!==null&&kt(e,"duplication of an anchor property"),r=e.input.charCodeAt(++e.position),t=e.position;r!==0&&!Za(r)&&!Uf(r);)r=e.input.charCodeAt(++e.position);return e.position===t&&kt(e,"name of an anchor node must contain at least one character"),e.anchor=e.input.slice(t,e.position),!0}function Wge(e){var t,r,i;if(i=e.input.charCodeAt(e.position),i!==42)return!1;for(i=e.input.charCodeAt(++e.position),t=e.position;i!==0&&!Za(i)&&!Uf(i);)i=e.input.charCodeAt(++e.position);return e.position===t&&kt(e,"name of an alias node must contain at least one character"),r=e.input.slice(t,e.position),Lu.call(e.anchorMap,r)||kt(e,'unidentified alias "'+r+'"'),e.result=e.anchorMap[r],on(e,!0,-1),!0}function Ip(e,t,r,i,n){var a,o,s,l=1,c=!1,u=!1,d,h,f,p,v,m;if(e.listener!==null&&e.listener("open",e),e.tag=null,e.anchor=null,e.kind=null,e.result=null,a=o=s=Ix===r||_V===r,i&&on(e,!0,-1)&&(c=!0,e.lineIndent>t?l=1:e.lineIndent===t?l=0:e.lineIndent<t&&(l=-1)),l===1)for(;Vge(e)||Hge(e);)on(e,!0,-1)?(c=!0,s=a,e.lineIndent>t?l=1:e.lineIndent===t?l=0:e.lineIndent<t&&(l=-1)):s=!1;if(s&&(s=c||n),(l===1||Ix===r)&&(Rx===r||CV===r?v=t:v=t+1,m=e.position-e.lineStart,l===1?s&&(jI(e,m)||jge(e,m,v))||Nge(e,v)?u=!0:(o&&Uge(e,v)||Bge(e,v)||Fge(e,v)?u=!0:Wge(e)?(u=!0,(e.tag!==null||e.anchor!==null)&&kt(e,"alias node should not have any properties")):Lge(e,v,Rx===r)&&(u=!0,e.tag===null&&(e.tag="?")),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):l===0&&(u=s&&jI(e,m))),e.tag===null)e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);else if(e.tag==="?"){for(e.result!==null&&e.kind!=="scalar"&&kt(e,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+e.kind+'"'),d=0,h=e.implicitTypes.length;d<h;d+=1)if(p=e.implicitTypes[d],p.resolve(e.result)){e.result=p.construct(e.result),e.tag=p.tag,e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);break}}else if(e.tag!=="!"){if(Lu.call(e.typeMap[e.kind||"fallback"],e.tag))p=e.typeMap[e.kind||"fallback"][e.tag];else for(p=null,f=e.typeMap.multi[e.kind||"fallback"],d=0,h=f.length;d<h;d+=1)if(e.tag.slice(0,f[d].tag.length)===f[d].tag){p=f[d];break}p||kt(e,"unknown tag !<"+e.tag+">"),e.result!==null&&p.kind!==e.kind&&kt(e,"unacceptable node kind for !<"+e.tag+'> tag; it should be "'+p.kind+'", not "'+e.kind+'"'),p.resolve(e.result,e.tag)?(e.result=p.construct(e.result,e.tag),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):kt(e,"cannot resolve a node with !<"+e.tag+"> explicit tag")}return e.listener!==null&&e.listener("close",e),e.tag!==null||e.anchor!==null||u}function Gge(e){var t=e.position,r,i,n,a=!1,o;for(e.version=null,e.checkLineBreaks=e.legacy,e.tagMap=Object.create(null),e.anchorMap=Object.create(null);(o=e.input.charCodeAt(e.position))!==0&&(on(e,!0,-1),o=e.input.charCodeAt(e.position),!(e.lineIndent>0||o!==37));){for(a=!0,o=e.input.charCodeAt(++e.position),r=e.position;o!==0&&!Za(o);)o=e.input.charCodeAt(++e.position);for(i=e.input.slice(r,e.position),n=[],i.length<1&&kt(e,"directive name must not be less than one character in length");o!==0;){for(;Kd(o);)o=e.input.charCodeAt(++e.position);if(o===35){do o=e.input.charCodeAt(++e.position);while(o!==0&&!ol(o));break}if(ol(o))break;for(r=e.position;o!==0&&!Za(o);)o=e.input.charCodeAt(++e.position);n.push(e.input.slice(r,e.position))}o!==0&&zP(e),Lu.call(NI,i)?NI[i](e,i,n):zx(e,'unknown document directive "'+i+'"')}if(on(e,!0,-1),e.lineIndent===0&&e.input.charCodeAt(e.position)===45&&e.input.charCodeAt(e.position+1)===45&&e.input.charCodeAt(e.position+2)===45?(e.position+=3,on(e,!0,-1)):a&&kt(e,"directives end mark is expected"),Ip(e,e.lineIndent-1,Ix,!1,!0),on(e,!0,-1),e.checkLineBreaks&&Pge.test(e.input.slice(t,e.position))&&zx(e,"non-ASCII line breaks are interpreted as content"),e.documents.push(e.result),e.position===e.lineStart&&Mw(e)){e.input.charCodeAt(e.position)===46&&(e.position+=3,on(e,!0,-1));return}if(e.position<e.length-1)kt(e,"end of the stream or a document separator is expected");else return}function DV(e,t){e=String(e),t=t||{},e.length!==0&&(e.charCodeAt(e.length-1)!==10&&e.charCodeAt(e.length-1)!==13&&(e+=`
`),e.charCodeAt(0)===65279&&(e=e.slice(1)));var r=new kge(e,t),i=e.indexOf("\0");for(i!==-1&&(r.position=i,kt(r,"null byte is not allowed in input")),r.input+="\0";r.input.charCodeAt(r.position)===32;)r.lineIndent+=1,r.position+=1;for(;r.position<r.length-1;)Gge(r);return r.documents}function $ge(e,t,r){t!==null&&typeof t=="object"&&typeof r>"u"&&(r=t,t=null);var i=DV(e,r);if(typeof t!="function")return i;for(var n=0,a=i.length;n<a;n+=1)t(i[n])}function qge(e,t){var r=DV(e,t);if(r.length!==0){if(r.length===1)return r[0];throw new Ra("expected a single document in the stream, but found more")}}var Yge=$ge,Xge=qge,OV={loadAll:Yge,load:Xge},RV=Object.prototype.toString,IV=Object.prototype.hasOwnProperty,LP=65279,Kge=9,_g=10,Qge=13,Zge=32,Jge=33,e0e=34,oM=35,t0e=37,r0e=38,i0e=39,n0e=42,zV=44,a0e=45,kx=58,o0e=61,s0e=62,l0e=63,c0e=64,kV=91,LV=93,u0e=96,BV=123,d0e=124,FV=125,Sa={};Sa[0]="\\0";Sa[7]="\\a";Sa[8]="\\b";Sa[9]="\\t";Sa[10]="\\n";Sa[11]="\\v";Sa[12]="\\f";Sa[13]="\\r";Sa[27]="\\e";Sa[34]='\\"';Sa[92]="\\\\";Sa[133]="\\N";Sa[160]="\\_";Sa[8232]="\\L";Sa[8233]="\\P";var h0e=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],f0e=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function p0e(e,t){var r,i,n,a,o,s,l;if(t===null)return{};for(r={},i=Object.keys(t),n=0,a=i.length;n<a;n+=1)o=i[n],s=String(t[o]),o.slice(0,2)==="!!"&&(o="tag:yaml.org,2002:"+o.slice(2)),l=e.compiledTypeMap.fallback[o],l&&IV.call(l.styleAliases,s)&&(s=l.styleAliases[s]),r[o]=s;return r}function m0e(e){var t,r,i;if(t=e.toString(16).toUpperCase(),e<=255)r="x",i=2;else if(e<=65535)r="u",i=4;else if(e<=4294967295)r="U",i=8;else throw new Ra("code point within a string may not be greater than 0xFFFFFFFF");return"\\"+r+yn.repeat("0",i-t.length)+t}var v0e=1,Ag=2;function g0e(e){this.schema=e.schema||IP,this.indent=Math.max(1,e.indent||2),this.noArrayIndent=e.noArrayIndent||!1,this.skipInvalid=e.skipInvalid||!1,this.flowLevel=yn.isNothing(e.flowLevel)?-1:e.flowLevel,this.styleMap=p0e(this.schema,e.styles||null),this.sortKeys=e.sortKeys||!1,this.lineWidth=e.lineWidth||80,this.noRefs=e.noRefs||!1,this.noCompatMode=e.noCompatMode||!1,this.condenseFlow=e.condenseFlow||!1,this.quotingType=e.quotingType==='"'?Ag:v0e,this.forceQuotes=e.forceQuotes||!1,this.replacer=typeof e.replacer=="function"?e.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function VI(e,t){for(var r=yn.repeat(" ",t),i=0,n=-1,a="",o,s=e.length;i<s;)n=e.indexOf(`
`,i),n===-1?(o=e.slice(i),i=s):(o=e.slice(i,n+1),i=n+1),o.length&&o!==`
`&&(a+=r),a+=o;return a}function sM(e,t){return`
`+yn.repeat(" ",e.indent*t)}function y0e(e,t){var r,i,n;for(r=0,i=e.implicitTypes.length;r<i;r+=1)if(n=e.implicitTypes[r],n.resolve(t))return!0;return!1}function Lx(e){return e===Zge||e===Kge}function Mg(e){return 32<=e&&e<=126||161<=e&&e<=55295&&e!==8232&&e!==8233||57344<=e&&e<=65533&&e!==LP||65536<=e&&e<=1114111}function HI(e){return Mg(e)&&e!==LP&&e!==Qge&&e!==_g}function WI(e,t,r){var i=HI(e),n=i&&!Lx(e);return(r?i:i&&e!==zV&&e!==kV&&e!==LV&&e!==BV&&e!==FV)&&e!==oM&&!(t===kx&&!n)||HI(t)&&!Lx(t)&&e===oM||t===kx&&n}function b0e(e){return Mg(e)&&e!==LP&&!Lx(e)&&e!==a0e&&e!==l0e&&e!==kx&&e!==zV&&e!==kV&&e!==LV&&e!==BV&&e!==FV&&e!==oM&&e!==r0e&&e!==n0e&&e!==Jge&&e!==d0e&&e!==o0e&&e!==s0e&&e!==i0e&&e!==e0e&&e!==t0e&&e!==c0e&&e!==u0e}function x0e(e){return!Lx(e)&&e!==kx}function vv(e,t){var r=e.charCodeAt(t),i;return r>=55296&&r<=56319&&t+1<e.length&&(i=e.charCodeAt(t+1),i>=56320&&i<=57343)?(r-55296)*1024+i-56320+65536:r}function NV(e){var t=/^\n* /;return t.test(e)}var UV=1,lM=2,jV=3,VV=4,Of=5;function w0e(e,t,r,i,n,a,o,s){var l,c=0,u=null,d=!1,h=!1,f=i!==-1,p=-1,v=b0e(vv(e,0))&&x0e(vv(e,e.length-1));if(t||o)for(l=0;l<e.length;c>=65536?l+=2:l++){if(c=vv(e,l),!Mg(c))return Of;v=v&&WI(c,u,s),u=c}else{for(l=0;l<e.length;c>=65536?l+=2:l++){if(c=vv(e,l),c===_g)d=!0,f&&(h=h||l-p-1>i&&e[p+1]!==" ",p=l);else if(!Mg(c))return Of;v=v&&WI(c,u,s),u=c}h=h||f&&l-p-1>i&&e[p+1]!==" "}return!d&&!h?v&&!o&&!n(e)?UV:a===Ag?Of:lM:r>9&&NV(e)?Of:o?a===Ag?Of:lM:h?VV:jV}function S0e(e,t,r,i,n){e.dump=function(){if(t.length===0)return e.quotingType===Ag?'""':"''";if(!e.noCompatMode&&(h0e.indexOf(t)!==-1||f0e.test(t)))return e.quotingType===Ag?'"'+t+'"':"'"+t+"'";var a=e.indent*Math.max(1,r),o=e.lineWidth===-1?-1:Math.max(Math.min(e.lineWidth,40),e.lineWidth-a),s=i||e.flowLevel>-1&&r>=e.flowLevel;function l(c){return y0e(e,c)}switch(w0e(t,s,e.indent,o,l,e.quotingType,e.forceQuotes&&!i,n)){case UV:return t;case lM:return"'"+t.replace(/'/g,"''")+"'";case jV:return"|"+GI(t,e.indent)+$I(VI(t,a));case VV:return">"+GI(t,e.indent)+$I(VI(C0e(t,o),a));case Of:return'"'+_0e(t)+'"';default:throw new Ra("impossible error: invalid scalar style")}}()}function GI(e,t){var r=NV(e)?String(t):"",i=e[e.length-1]===`
`,n=i&&(e[e.length-2]===`
`||e===`
`),a=n?"+":i?"":"-";return r+a+`
`}function $I(e){return e[e.length-1]===`
`?e.slice(0,-1):e}function C0e(e,t){for(var r=/(\n+)([^\n]*)/g,i=function(){var c=e.indexOf(`
`);return c=c!==-1?c:e.length,r.lastIndex=c,qI(e.slice(0,c),t)}(),n=e[0]===`
`||e[0]===" ",a,o;o=r.exec(e);){var s=o[1],l=o[2];a=l[0]===" ",i+=s+(!n&&!a&&l!==""?`
`:"")+qI(l,t),n=a}return i}function qI(e,t){if(e===""||e[0]===" ")return e;for(var r=/ [^ ]/g,i,n=0,a,o=0,s=0,l="";i=r.exec(e);)s=i.index,s-n>t&&(a=o>n?o:s,l+=`
`+e.slice(n,a),n=a+1),o=s;return l+=`
`,e.length-n>t&&o>n?l+=e.slice(n,o)+`
`+e.slice(o+1):l+=e.slice(n),l.slice(1)}function _0e(e){for(var t="",r=0,i,n=0;n<e.length;r>=65536?n+=2:n++)r=vv(e,n),i=Sa[r],!i&&Mg(r)?(t+=e[n],r>=65536&&(t+=e[n+1])):t+=i||m0e(r);return t}function A0e(e,t,r){var i="",n=e.tag,a,o,s;for(a=0,o=r.length;a<o;a+=1)s=r[a],e.replacer&&(s=e.replacer.call(r,String(a),s)),(uc(e,t,s,!1,!1)||typeof s>"u"&&uc(e,t,null,!1,!1))&&(i!==""&&(i+=","+(e.condenseFlow?"":" ")),i+=e.dump);e.tag=n,e.dump="["+i+"]"}function YI(e,t,r,i){var n="",a=e.tag,o,s,l;for(o=0,s=r.length;o<s;o+=1)l=r[o],e.replacer&&(l=e.replacer.call(r,String(o),l)),(uc(e,t+1,l,!0,!0,!1,!0)||typeof l>"u"&&uc(e,t+1,null,!0,!0,!1,!0))&&((!i||n!=="")&&(n+=sM(e,t)),e.dump&&_g===e.dump.charCodeAt(0)?n+="-":n+="- ",n+=e.dump);e.tag=a,e.dump=n||"[]"}function M0e(e,t,r){var i="",n=e.tag,a=Object.keys(r),o,s,l,c,u;for(o=0,s=a.length;o<s;o+=1)u="",i!==""&&(u+=", "),e.condenseFlow&&(u+='"'),l=a[o],c=r[l],e.replacer&&(c=e.replacer.call(r,l,c)),uc(e,t,l,!1,!1)&&(e.dump.length>1024&&(u+="? "),u+=e.dump+(e.condenseFlow?'"':"")+":"+(e.condenseFlow?"":" "),uc(e,t,c,!1,!1)&&(u+=e.dump,i+=u));e.tag=n,e.dump="{"+i+"}"}function E0e(e,t,r,i){var n="",a=e.tag,o=Object.keys(r),s,l,c,u,d,h;if(e.sortKeys===!0)o.sort();else if(typeof e.sortKeys=="function")o.sort(e.sortKeys);else if(e.sortKeys)throw new Ra("sortKeys must be a boolean or a function");for(s=0,l=o.length;s<l;s+=1)h="",(!i||n!=="")&&(h+=sM(e,t)),c=o[s],u=r[c],e.replacer&&(u=e.replacer.call(r,c,u)),uc(e,t+1,c,!0,!0,!0)&&(d=e.tag!==null&&e.tag!=="?"||e.dump&&e.dump.length>1024,d&&(e.dump&&_g===e.dump.charCodeAt(0)?h+="?":h+="? "),h+=e.dump,d&&(h+=sM(e,t)),uc(e,t+1,u,!0,d)&&(e.dump&&_g===e.dump.charCodeAt(0)?h+=":":h+=": ",h+=e.dump,n+=h));e.tag=a,e.dump=n||"{}"}function XI(e,t,r){var i,n,a,o,s,l;for(n=r?e.explicitTypes:e.implicitTypes,a=0,o=n.length;a<o;a+=1)if(s=n[a],(s.instanceOf||s.predicate)&&(!s.instanceOf||typeof t=="object"&&t instanceof s.instanceOf)&&(!s.predicate||s.predicate(t))){if(r?s.multi&&s.representName?e.tag=s.representName(t):e.tag=s.tag:e.tag="?",s.represent){if(l=e.styleMap[s.tag]||s.defaultStyle,RV.call(s.represent)==="[object Function]")i=s.represent(t,l);else if(IV.call(s.represent,l))i=s.represent[l](t,l);else throw new Ra("!<"+s.tag+'> tag resolver accepts not "'+l+'" style');e.dump=i}return!0}return!1}function uc(e,t,r,i,n,a,o){e.tag=null,e.dump=r,XI(e,r,!1)||XI(e,r,!0);var s=RV.call(e.dump),l=i,c;i&&(i=e.flowLevel<0||e.flowLevel>t);var u=s==="[object Object]"||s==="[object Array]",d,h;if(u&&(d=e.duplicates.indexOf(r),h=d!==-1),(e.tag!==null&&e.tag!=="?"||h||e.indent!==2&&t>0)&&(n=!1),h&&e.usedDuplicates[d])e.dump="*ref_"+d;else{if(u&&h&&!e.usedDuplicates[d]&&(e.usedDuplicates[d]=!0),s==="[object Object]")i&&Object.keys(e.dump).length!==0?(E0e(e,t,e.dump,n),h&&(e.dump="&ref_"+d+e.dump)):(M0e(e,t,e.dump),h&&(e.dump="&ref_"+d+" "+e.dump));else if(s==="[object Array]")i&&e.dump.length!==0?(e.noArrayIndent&&!o&&t>0?YI(e,t-1,e.dump,n):YI(e,t,e.dump,n),h&&(e.dump="&ref_"+d+e.dump)):(A0e(e,t,e.dump),h&&(e.dump="&ref_"+d+" "+e.dump));else if(s==="[object String]")e.tag!=="?"&&S0e(e,e.dump,t,a,l);else{if(s==="[object Undefined]")return!1;if(e.skipInvalid)return!1;throw new Ra("unacceptable kind of an object to dump "+s)}e.tag!==null&&e.tag!=="?"&&(c=encodeURI(e.tag[0]==="!"?e.tag.slice(1):e.tag).replace(/!/g,"%21"),e.tag[0]==="!"?c="!"+c:c.slice(0,18)==="tag:yaml.org,2002:"?c="!!"+c.slice(18):c="!<"+c+">",e.dump=c+" "+e.dump)}return!0}function T0e(e,t){var r=[],i=[],n,a;for(cM(e,r,i),n=0,a=i.length;n<a;n+=1)t.duplicates.push(r[i[n]]);t.usedDuplicates=new Array(a)}function cM(e,t,r){var i,n,a;if(e!==null&&typeof e=="object")if(n=t.indexOf(e),n!==-1)r.indexOf(n)===-1&&r.push(n);else if(t.push(e),Array.isArray(e))for(n=0,a=e.length;n<a;n+=1)cM(e[n],t,r);else for(i=Object.keys(e),n=0,a=i.length;n<a;n+=1)cM(e[i[n]],t,r)}function P0e(e,t){t=t||{};var r=new g0e(t);r.noRefs||T0e(e,r);var i=e;return r.replacer&&(i=r.replacer.call({"":i},"",i)),uc(r,0,i,!0,!0)?r.dump+`
`:""}var D0e=P0e,O0e={dump:D0e};function BP(e,t){return function(){throw new Error("Function yaml."+e+" is removed in js-yaml 4. Use yaml."+t+" instead, which is now safe by default.")}}var R0e=oa,I0e=nV,z0e=lV,k0e=fV,L0e=pV,B0e=IP,F0e=OV.load,N0e=OV.loadAll,U0e=O0e.dump,j0e=Ra,V0e={binary:bV,float:hV,map:sV,null:cV,pairs:wV,set:SV,timestamp:gV,bool:uV,int:dV,merge:yV,omap:xV,seq:oV,str:aV},H0e=BP("safeLoad","load"),W0e=BP("safeLoadAll","loadAll"),G0e=BP("safeDump","dump"),$0e={Type:R0e,Schema:I0e,FAILSAFE_SCHEMA:z0e,JSON_SCHEMA:k0e,CORE_SCHEMA:L0e,DEFAULT_SCHEMA:B0e,load:F0e,loadAll:N0e,dump:U0e,YAMLException:j0e,types:V0e,safeLoad:H0e,safeLoadAll:W0e,safeDump:G0e};const KI=e=>new Promise(async(t,r)=>{try{const n=await(await e.getFile()).arrayBuffer(),a=new Uint8Array(n),o=wme.parseDicom(a);t(o)}catch(i){throw r(`Error reading DICOM file: ${i}`),new Error(`Error reading DICOM file: ${i}`)}}),q0e=e=>new Promise(async(t,r)=>{try{let i;const a=await(await e.getFile()).text();try{i=JSON.parse(a)}catch{try{i=$0e.load(a)}catch(s){throw new Error("Error parsing YAML file: "+s)}}t(i)}catch(i){throw r(`Error reading CWL file: ${i}`),new Error(`Error reading CWL file: ${i}`)}}),Y0e={BREAST:{system:"http://snomed.info/sct",code:"76752008",display:"Breast"}},X0e={"1.2.840.10008.5.1.4.1.1.1":"Computed Radiography Image Storage","1.2.840.10008.5.1.4.1.1.2":"CT Image Storage","1.2.840.10008.5.1.4.1.1.3.1":"Ultrasound Multi-frame Image Storage","1.2.840.10008.5.1.4.1.1.4":"MR Image Storage"},QI=e=>{const t=new Date,r=Vv(t,"yyyy-MM-dd HH:mm:ss");Vv(t,"HH:mm:ss");const i=Vv(t,"yyyy-MM-dd");let n={};switch(e){case"valueQuantity":n={valueQuantity:{value:"",comparator:"",unit:"",system:"http://unitsofmeasure.org",code:""}};break;case"valueCodeableConcept":n={valueCodeableConcept:{coding:[{system:"",code:"",display:""}],text:""}};break;case"valueString":n={valueString:""};break;case"valueBoolean":n={valueBoolean:""};break;case"valueInteger":n={valueInteger:""};break;case"valueRange":n={valueRange:{low:"",high:""}};break;case"valueRatio":n={valueRatio:{numerator:{value:"",comparator:"",unit:"",system:"http://unitsofmeasure.org",code:""},denominator:{value:"",comparator:"",unit:"",system:"http://unitsofmeasure.org",code:""}}};break;case"valueSampledData":n={valueSampledData:{origin:"",period:"",factor:"",lowerLimit:"",upperLimit:"",dimensions:"",data:""}};break;case"valueTime":n={valueTime:i};break;case"valueDateTime":n={valueDateTime:r};break;case"valuePeriod":n={valuePeriod:{start:"",end:""}};break;default:n={valueQuantity:{value:"",comparator:"",unit:"",system:"http://unitsofmeasure.org",code:""}};break}return n},K0e=[{label:"valueQuantity",value:"valueQuantity"},{label:"valueCodeableConcept",value:"valueCodeableConcept"},{label:"valueString",value:"valueString"},{label:"valueBoolean",value:"valueBoolean"},{label:"valueInteger",value:"valueInteger"},{label:"valueRange",value:"valueRange"},{label:"valueRatio",value:"valueRatio"},{label:"valueSampledData",value:"valueSampledData"},{label:"valueTime",value:"valueTime"},{label:"valueDateTime",value:"valueDateTime"},{label:"valuePeriod",value:"valuePeriod"}],aC={value:{required:!0,validator(e,t){return Number.isNaN(Number(t))?new Error("Value is required Number"):!0},trigger:"blur"},unit:{required:!0,message:"Please input the unit for the value",trigger:["input","blur"]},system:{required:!0,validator(e,t){return t?!0:new Error("Unit system is required")},trigger:"blur"},code:{required:!0,validator(e,t){return t?!0:new Error("Unit code is required")},trigger:"blur"},comparator:{required:!1,validator(e,t){return t&&t!=="<"&&t!=="<="&&t!==">="&&t!==">"?new Error("Comparator must be <, <=, >=, or >"):!0},trigger:"blur"}},Q0e={valueQuantity:aC,valueString:{required:!0,validator(e,t){return t?!0:new Error("Value is required String")},trigger:"blur"},valueBoolean:{required:!0,validator(e,t){return t!=="true"&&t!=="false"?new Error("Value is required Boolean"):!0},trigger:"blur"},valueRange:{low:{required:!1,validator(e,t){return Number.isNaN(Number(t))?new Error("Low is required Number"):!0},trigger:"blur"},high:{required:!1,validator(e,t){return Number.isNaN(Number(t))?new Error("High is required Number"):!0},trigger:"blur"}},valueRatio:{numerator:aC,denominator:aC},valueSampledData:{origin:{required:!0,validator(e,t){return t?!0:new Error("Origin is required")},trigger:"blur"},period:{required:!0,validator(e,t){return Number.isNaN(Number(t))?new Error("Period is required Number"):!0},trigger:"blur"},factor:{required:!1,validator(e,t){return Number.isNaN(Number(t))?new Error("Factor is required Number"):!0},trigger:"blur"},lowerLimit:{required:!1,validator(e,t){return Number.isNaN(Number(t))?new Error("Lower Limit is required Number"):!0},trigger:"blur"},upperLimit:{required:!1,validator(e,t){return Number.isNaN(Number(t))?new Error("Upper Limit is required Number"):!0},trigger:"blur"},dimensions:{required:!0,validator(e,t){return Number.isNaN(Number(t))?new Error("Dimensions is required Number"):!0},trigger:"blur"},data:{required:!1,validator(e,t){return typeof t!="string"?new Error("Data is required String"):!0},trigger:"blur"}}},Z0e={observation:{value:Q0e,code:{required:!0,validator(e,t){return t?!0:new Error("Observation Code is required")},trigger:"blur"},codeSystem:{required:!0,validator(e,t){return t?!0:new Error("Observation codeSystem is required")},trigger:"blur"}}};var Yn=[];for(var oC=0;oC<256;++oC)Yn.push((oC+256).toString(16).slice(1));function J0e(e,t=0){return(Yn[e[t+0]]+Yn[e[t+1]]+Yn[e[t+2]]+Yn[e[t+3]]+"-"+Yn[e[t+4]]+Yn[e[t+5]]+"-"+Yn[e[t+6]]+Yn[e[t+7]]+"-"+Yn[e[t+8]]+Yn[e[t+9]]+"-"+Yn[e[t+10]]+Yn[e[t+11]]+Yn[e[t+12]]+Yn[e[t+13]]+Yn[e[t+14]]+Yn[e[t+15]]).toLowerCase()}var ny,eye=new Uint8Array(16);function tye(){if(!ny&&(ny=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!ny))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ny(eye)}var rye=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const ZI={randomUUID:rye};function HV(e,t,r){if(ZI.randomUUID&&!t&&!e)return ZI.randomUUID();e=e||{};var i=e.random||(e.rng||tye)();if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,t){r=r||0;for(var n=0;n<16;++n)t[r+n]=i[n];return t}return J0e(i)}const iye={class:"flex flex-col md:flex-row px-11 pb-2 pt-1 shadow-md m-2 shadow-zinc-400 rounded-md bg-gradient-to-r from-zinc-300 via-gray-200 to-stone-400"},nye={key:0,class:"observation-form-item"},aye={key:1,class:"observation-form-item"},oye={style:{display:"flex","align-items":"center",width:"100%"}},sye={key:2,class:"observation-form-item"},lye={key:3,class:"observation-form-item"},cye={key:4,class:"observation-form-item"},uye={key:5,class:"observation-form-item"},dye={key:6,class:"observation-form-item w-full"},hye={key:7,class:"observation-form-item"},fye={key:8,class:"observation-form-item"},pye={key:9,class:"observation-form-item"},mye={key:10,class:"observation-form-item"},vye={class:"observation-form-item"},JI=je({__name:"FormObservation",props:{disabled:Boolean,selectedObservationValueType:String,filledData:Object,belongTo:{type:Array,default:()=>[]}},setup(e,{emit:t}){const r=e;rr(()=>r.belongTo,w=>{o.value||(d.value.belongTo=w)});const i=t,{AddIcon:n,CloseIcon:a}=d0(),o=me(!1),s=me("#10b981"),l=me(!1),c=me(),u=CP(),d=me({operation:"add",belongTo:r.belongTo,observationValueType:r.selectedObservationValueType?r.selectedObservationValueType:"valueQuantity",observation:{value:r.selectedObservationValueType?QI(r.selectedObservationValueType):{valueQuantity:{value:"",comparator:"",unit:"",system:"http://unitsofmeasure.org",code:""}},code:"",display:"",codeSystem:""}}),h=()=>{u.success("Successfully picked a period!")},f=w=>{d.value.observation.value.valuePeriod.start=Vv(w[0],"yyyy-MM-dd HH:mm:ss"),d.value.observation.value.valuePeriod.end=Vv(w[1],"yyyy-MM-dd HH:mm:ss")},p=()=>(d.value.observation.value.valueCodeableConcept.coding.push({code:"",system:"",display:""}),d.value.observation.value.valueCodeableConcept.coding[d.value.observation.value.valueCodeableConcept.coding.length-1]),v=w=>{d.value.observation.value=QI(w)};Or(()=>{r.filledData&&m()});const m=()=>{o.value=r.disabled,s.value="#f43f5e",d.value.observation=r.filledData,d.value.observationValueType==="valueCodeableConcept"?l.value=!0:l.value=!1,d.value.observationValueType==="valuePeriod"&&(c.value=[new Date(d.value.observation.value.valuePeriod.start),new Date(d.value.observation.value.valuePeriod.end)])},g=["http://loinc.org","http://snomed.info/sct","http://dicom.nema.org/resources/ontology/DCM"].map(w=>({label:w,value:w})),y=["http://unitsofmeasure.org"].map(w=>({label:w,value:w})),b=me("large"),x=me(null),S=w=>{var _;if(w.preventDefault(),o.value){d.value.operation="remove",i("updateObservation",d.value);return}(_=x.value)==null||_.validate(C=>{C?(console.log(C),u.error("Invalid")):(u.success("Valid"),d.value.operation="add",d.value.observationValueType==="valueCodeableConcept"&&(d.value.observation.value.valueCodeableConcept.coding=d.value.observation.value.valueCodeableConcept.coding.filter(A=>A.code!==""&&A.system!=="")),i("updateObservation",d.value),d.value={operation:"add",belongTo:r.belongTo,observationValueType:"valueQuantity",observation:{value:{valueQuantity:{value:"",comparator:"",unit:"",system:"http://unitsofmeasure.org",code:""}},code:"",display:"",codeSystem:""}})})};return(w,_)=>(ht(),Pt("div",iye,[Le(ze(Mse),{ref_key:"formRef",ref:x,inline:"","label-width":520,model:d.value,rules:ze(Z0e),size:b.value,disabled:o.value,class:"flex flex-col flex-wrap mt-2 mr-auto ob-align-content-start"},{default:Je(()=>[Le(ze(gr),{label:"ValueType",class:"border shadow-fancy-2 border-zinc-300 rounded-lg px-3"},{default:Je(()=>[Le(ze(Jne),{value:d.value.observationValueType,"onUpdate:value":[_[0]||(_[0]=C=>d.value.observationValueType=C),v],options:ze(K0e),class:"w-full md:w-96"},null,8,["value","options"])]),_:1}),d.value.observationValueType==="valueQuantity"?(ht(),Pt("div",nye,[Le(ze(gr),{label:"Value",path:"observation.value.valueQuantity.value"},{default:Je(()=>[Le(ze(ur),{value:d.value.observation.value.valueQuantity.value,"onUpdate:value":_[1]||(_[1]=C=>d.value.observation.value.valueQuantity.value=C),placeholder:"Numerical value (with implicit precision)"},null,8,["value"])]),_:1}),Le(ze(gr),{label:"Unit",path:"observation.value.valueQuantity.unit"},{default:Je(()=>[Le(ze(ur),{value:d.value.observation.value.valueQuantity.unit,"onUpdate:value":_[2]||(_[2]=C=>d.value.observation.value.valueQuantity.unit=C),placeholder:"Unit representation"},null,8,["value"])]),_:1}),Le(ze(gr),{label:"Unit Code",path:"observation.value.valueQuantity.code"},{default:Je(()=>[Le(ze(ur),{value:d.value.observation.value.valueQuantity.code,"onUpdate:value":_[3]||(_[3]=C=>d.value.observation.value.valueQuantity.code=C),placeholder:"Coded form of the unit"},null,8,["value"])]),_:1}),Le(ze(gr),{label:"Unit System",path:"observation.value.valueQuantity.system"},{default:Je(()=>[Le(ze(Q0),{value:d.value.observation.value.valueQuantity.system,"onUpdate:value":_[4]||(_[4]=C=>d.value.observation.value.valueQuantity.system=C),placeholder:"System that defines coded unit form",options:ze(y),append:!1},null,8,["value","options"])]),_:1}),Le(ze(gr),{label:"Comparator (Optional)",path:"observation.value.valueQuantity.comparator"},{default:Je(()=>[Le(ze(ur),{value:d.value.observation.value.valueQuantity.comparator,"onUpdate:value":_[5]||(_[5]=C=>d.value.observation.value.valueQuantity.comparator=C),placeholder:"< | <= | >= | >"},null,8,["value"])]),_:1})])):Ga("",!0),d.value.observationValueType==="valueCodeableConcept"&&!r.filledData?(ht(),Pt("div",aye,[Le(ze(use),{value:d.value.observation.value.valueCodeableConcept.coding,"onUpdate:value":_[6]||(_[6]=C=>d.value.observation.value.valueCodeableConcept.coding=C),"on-create":p},{"create-button-default":Je(()=>[Lr(" Add whatever you want ")]),default:Je(({value:C})=>[st("div",oye,[Le(ze(gr),{label:"Code"},{default:Je(()=>[Le(ze(ur),{value:C.code,"onUpdate:value":A=>C.code=A,type:"text",placeholder:"code"},null,8,["value","onUpdate:value"])]),_:2},1024),Le(ze(gr),{label:"System",class:"ml-2"},{default:Je(()=>[Le(ze(ur),{value:C.system,"onUpdate:value":A=>C.system=A,type:"text",placeholder:"system for code"},null,8,["value","onUpdate:value"])]),_:2},1024),Le(ze(gr),{label:"Display (Optional)",class:"ml-2"},{default:Je(()=>[Le(ze(ur),{value:C.display,"onUpdate:value":A=>C.display=A,type:"text",placeholder:"discription"},null,8,["value","onUpdate:value"])]),_:2},1024)])]),_:1},8,["value"]),Le(ze(gr),{label:"Text"},{default:Je(()=>[Le(ze(ur),{value:d.value.observation.value.valueCodeableConcept.text,"onUpdate:value":_[7]||(_[7]=C=>d.value.observation.value.valueCodeableConcept.text=C),type:"text"},null,8,["value"])]),_:1})])):Ga("",!0),d.value.observationValueType==="valueCodeableConcept"&&r.filledData&&l.value?(ht(),Pt("div",sye,[(ht(!0),Pt(mr,null,vs(d.value.observation.value.valueCodeableConcept.coding,C=>(ht(),Pt("div",{style:{display:"flex","align-items":"center",width:"100%"},key:ze(HV)()},[Le(ze(gr),{label:"Code"},{default:Je(()=>[Le(ze(ur),{value:C.code,"onUpdate:value":A=>C.code=A,type:"text"},null,8,["value","onUpdate:value"])]),_:2},1024),Le(ze(gr),{label:"System",class:"ml-2"},{default:Je(()=>[Le(ze(ur),{value:C.system,"onUpdate:value":A=>C.system=A,type:"text"},null,8,["value","onUpdate:value"])]),_:2},1024),Le(ze(gr),{label:"Display (Optional)",class:"ml-2"},{default:Je(()=>[Le(ze(ur),{value:C.display,"onUpdate:value":A=>C.display=A,type:"text"},null,8,["value","onUpdate:value"])]),_:2},1024)]))),128)),Le(ze(gr),{label:"Text"},{default:Je(()=>[Le(ze(ur),{value:d.value.observation.value.valueCodeableConcept.text,"onUpdate:value":_[8]||(_[8]=C=>d.value.observation.value.valueCodeableConcept.text=C),type:"text"},null,8,["value"])]),_:1})])):Ga("",!0),d.value.observationValueType==="valueString"?(ht(),Pt("div",lye,[Le(ze(gr),{label:"Value",path:"observation.value.valueString"},{default:Je(()=>[Le(ze(ur),{value:d.value.observation.value.valueString,"onUpdate:value":_[9]||(_[9]=C=>d.value.observation.value.valueString=C),placeholder:"String value",type:"text"},null,8,["value"])]),_:1})])):Ga("",!0),d.value.observationValueType==="valueBoolean"?(ht(),Pt("div",cye,[Le(ze(gr),{label:"Value",path:"observation.value.valueBoolean"},{default:Je(()=>[Le(ze(ur),{value:d.value.observation.value.valueBoolean,"onUpdate:value":_[10]||(_[10]=C=>d.value.observation.value.valueBoolean=C),placeholder:"Boolean value"},null,8,["value"])]),_:1})])):Ga("",!0),d.value.observationValueType==="valueRange"?(ht(),Pt("div",uye,[Le(ze(gr),{label:"Low Value",path:"observation.value.valueRange.low"},{default:Je(()=>[Le(ze(ur),{value:d.value.observation.value.valueRange.low,"onUpdate:value":_[11]||(_[11]=C=>d.value.observation.value.valueRange.low=C),placeholder:"Number value"},null,8,["value"])]),_:1}),Le(ze(gr),{label:"High Value",path:"observation.value.valueRange.high"},{default:Je(()=>[Le(ze(ur),{value:d.value.observation.value.valueRange.high,"onUpdate:value":_[12]||(_[12]=C=>d.value.observation.value.valueRange.high=C),placeholder:"Number value"},null,8,["value"])]),_:1})])):Ga("",!0),d.value.observationValueType==="valueRatio"?(ht(),Pt("div",dye,[Le(ze(ij),{"default-value":"numerator",size:"large","justify-content":"space-evenly"},{default:Je(()=>[Le(ze(Tx),{name:"numerator",tab:"Ratio numerator"},{default:Je(()=>[Le(ze(gr),{label:"Value",path:"observation.value.valueRatio.numerator.value"},{default:Je(()=>[Le(ze(ur),{value:d.value.observation.value.valueRatio.numerator.value,"onUpdate:value":_[13]||(_[13]=C=>d.value.observation.value.valueRatio.numerator.value=C),placeholder:"Numerical value (with implicit precision)"},null,8,["value"])]),_:1}),Le(ze(gr),{label:"Unit",path:"observation.value.valueRatio.numerator.unit"},{default:Je(()=>[Le(ze(ur),{value:d.value.observation.value.valueRatio.numerator.unit,"onUpdate:value":_[14]||(_[14]=C=>d.value.observation.value.valueRatio.numerator.unit=C),placeholder:"Unit representation"},null,8,["value"])]),_:1}),Le(ze(gr),{label:"Unit Code",path:"observation.value.valueRatio.numerator.code"},{default:Je(()=>[Le(ze(ur),{value:d.value.observation.value.valueRatio.numerator.code,"onUpdate:value":_[15]||(_[15]=C=>d.value.observation.value.valueRatio.numerator.code=C),placeholder:"Coded form of the unit"},null,8,["value"])]),_:1}),Le(ze(gr),{label:"Unit System",path:"observation.value.valueRatio.numerator.system"},{default:Je(()=>[Le(ze(Q0),{value:d.value.observation.value.valueRatio.numerator.system,"onUpdate:value":_[16]||(_[16]=C=>d.value.observation.value.valueRatio.numerator.system=C),placeholder:"System that defines coded unit form",options:ze(y),append:!1},null,8,["value","options"])]),_:1}),Le(ze(gr),{label:"Comparator (Optional)",path:"observation.value.valueRatio.numerator.comparator"},{default:Je(()=>[Le(ze(ur),{value:d.value.observation.value.valueRatio.numerator.comparator,"onUpdate:value":_[17]||(_[17]=C=>d.value.observation.value.valueRatio.numerator.comparator=C),placeholder:"< | <= | >= | >"},null,8,["value"])]),_:1})]),_:1}),Le(ze(Tx),{name:"denominator",tab:"Ratio denominator"},{default:Je(()=>[Le(ze(gr),{label:"Value",path:"observation.value.valueRatio.denominator.value"},{default:Je(()=>[Le(ze(ur),{value:d.value.observation.value.valueRatio.denominator.value,"onUpdate:value":_[18]||(_[18]=C=>d.value.observation.value.valueRatio.denominator.value=C),placeholder:"Numerical value (with implicit precision)"},null,8,["value"])]),_:1}),Le(ze(gr),{label:"Unit",path:"observation.value.valueRatio.denominator.unit"},{default:Je(()=>[Le(ze(ur),{value:d.value.observation.value.valueRatio.denominator.unit,"onUpdate:value":_[19]||(_[19]=C=>d.value.observation.value.valueRatio.denominator.unit=C),placeholder:"Unit representation"},null,8,["value"])]),_:1}),Le(ze(gr),{label:"Unit Code",path:"observation.value.valueRatio.denominator.code"},{default:Je(()=>[Le(ze(ur),{value:d.value.observation.value.valueRatio.denominator.code,"onUpdate:value":_[20]||(_[20]=C=>d.value.observation.value.valueRatio.denominator.code=C),placeholder:"Coded form of the unit"},null,8,["value"])]),_:1}),Le(ze(gr),{label:"Unit System",path:"observation.value.valueRatio.denominator.system"},{default:Je(()=>[Le(ze(Q0),{value:d.value.observation.value.valueRatio.denominator.system,"onUpdate:value":_[21]||(_[21]=C=>d.value.observation.value.valueRatio.denominator.system=C),placeholder:"System that defines coded unit form",options:ze(y),append:!1},null,8,["value","options"])]),_:1}),Le(ze(gr),{label:"Comparator (Optional)",path:"observation.value.valueQuantity.comparator"},{default:Je(()=>[Le(ze(ur),{value:d.value.observation.value.valueRatio.denominator.comparator,"onUpdate:value":_[22]||(_[22]=C=>d.value.observation.value.valueRatio.denominator.comparator=C),placeholder:"< | <= | >= | >"},null,8,["value"])]),_:1})]),_:1})]),_:1})])):Ga("",!0),d.value.observationValueType==="valueSampledData"?(ht(),Pt("div",hye,[Le(ze(gr),{label:"Origin",path:"observation.value.valueSampledData.origin"},{default:Je(()=>[Le(ze(ur),{value:d.value.observation.value.valueSampledData.origin,"onUpdate:value":_[23]||(_[23]=C=>d.value.observation.value.valueSampledData.origin=C),placeholder:"Zero value and units"},null,8,["value"])]),_:1}),Le(ze(gr),{label:"Period",path:"observation.value.valueSampledData.period"},{default:Je(()=>[Le(ze(ur),{value:d.value.observation.value.valueSampledData.period,"onUpdate:value":_[24]||(_[24]=C=>d.value.observation.value.valueSampledData.period=C),placeholder:"Number of milliseconds between samples"},null,8,["value"])]),_:1}),Le(ze(gr),{label:"Factor (Optional)",path:"observation.value.valueSampledData.factor"},{default:Je(()=>[Le(ze(ur),{value:d.value.observation.value.valueSampledData.factor,"onUpdate:value":_[25]||(_[25]=C=>d.value.observation.value.valueSampledData.factor=C),placeholder:"Multiply data by this before adding to origin"},null,8,["value"])]),_:1}),Le(ze(gr),{label:"Lower Limit (Optional)",path:"observation.value.valueSampledData.lowerLimit"},{default:Je(()=>[Le(ze(ur),{value:d.value.observation.value.valueSampledData.lowerLimit,"onUpdate:value":_[26]||(_[26]=C=>d.value.observation.value.valueSampledData.lowerLimit=C),placeholder:"Lower limit of detection"},null,8,["value"])]),_:1}),Le(ze(gr),{label:"Upper Limit (Optional)",path:"observation.value.valueSampledData.upperLimit"},{default:Je(()=>[Le(ze(ur),{value:d.value.observation.value.valueSampledData.upperLimit,"onUpdate:value":_[27]||(_[27]=C=>d.value.observation.value.valueSampledData.upperLimit=C),placeholder:"Upper limit of detection"},null,8,["value"])]),_:1}),Le(ze(gr),{label:"Dimensions",path:"observation.value.valueSampledData.dimensions"},{default:Je(()=>[Le(ze(ur),{value:d.value.observation.value.valueSampledData.dimensions,"onUpdate:value":_[28]||(_[28]=C=>d.value.observation.value.valueSampledData.dimensions=C),placeholder:"Number of sample points at each time point"},null,8,["value"])]),_:1}),Le(ze(gr),{label:"Data (Optional)",path:"observation.value.valueSampledData.data"},{default:Je(()=>[Le(ze(ur),{value:d.value.observation.value.valueSampledData.data,"onUpdate:value":_[29]||(_[29]=C=>d.value.observation.value.valueSampledData.data=C),placeholder:"Decimal values with spaces, or `E` | `U` | `L`"},null,8,["value"])]),_:1})])):Ga("",!0),d.value.observationValueType==="valueTime"?(ht(),Pt("div",fye,[Le(ze(gr),{label:"Date",path:"observation.value.valueTime"},{default:Je(()=>[Le(ze(WS),{"formatted-value":d.value.observation.value.valueTime,"onUpdate:formattedValue":_[30]||(_[30]=C=>d.value.observation.value.valueTime=C),"value-format":"yyyy-MM-dd",type:"date",clearable:""},null,8,["formatted-value"])]),_:1})])):Ga("",!0),d.value.observationValueType==="valueDateTime"?(ht(),Pt("div",pye,[Le(ze(gr),{label:"DateTime",path:"observation.value.valueDateTime"},{default:Je(()=>[Le(ze(WS),{"formatted-value":d.value.observation.value.valueDateTime,"onUpdate:formattedValue":_[31]||(_[31]=C=>d.value.observation.value.valueDateTime=C),"value-format":"yyyy-MM-dd HH:mm:ss",type:"datetime",clearable:""},null,8,["formatted-value"])]),_:1})])):Ga("",!0),d.value.observationValueType==="valuePeriod"?(ht(),Pt("div",mye,[Le(ze(WS),{value:c.value,"onUpdate:value":_[32]||(_[32]=C=>c.value=C),disabled:e.disabled,type:"datetimerange",onBlur:h,onConfirm:f},null,8,["value","disabled"])])):Ga("",!0),st("div",vye,[Le(ze(gr),{label:"Observation Code",path:"observation.code"},{default:Je(()=>[Le(ze(ur),{value:d.value.observation.code,"onUpdate:value":_[33]||(_[33]=C=>d.value.observation.code=C),placeholder:"code for observation"},null,8,["value"])]),_:1}),Le(ze(gr),{label:"Display",path:"observation.display"},{default:Je(()=>[Le(ze(ur),{value:d.value.observation.display,"onUpdate:value":_[34]||(_[34]=C=>d.value.observation.display=C),placeholder:"display for observation code"},null,8,["value"])]),_:1}),Le(ze(gr),{label:"Observation Code System",path:"observation.codeSystem"},{default:Je(()=>[Le(ze(Q0),{value:d.value.observation.codeSystem,"onUpdate:value":_[35]||(_[35]=C=>d.value.observation.codeSystem=C),placeholder:"Input code system",options:ze(g),append:!1},null,8,["value","options"])]),_:1})])]),_:1},8,["model","rules","size","disabled"]),Le(ze(ci),{onClick:S,class:Bo(["md:my-auto md:ml-10 my-3 rounded-md",o.value?"shadow-fancy-3":"shadow-fancy-4"]),strong:"",color:s.value},{icon:Je(()=>[Le(ze(Tp),null,{default:Je(()=>[o.value?(ht(),Ci(ze(a),{key:1})):(ht(),Ci(ze(n),{key:0}))]),_:1})]),_:1},8,["class","color"])]))}}),gye=je({__name:"Observation",props:{formDescription:Object,patients:{type:Array,default:()=>[]}},setup(e,{emit:t}){const r=e,i=t,n=me(!0),a=me([]),o=re(()=>[...new Set(a.value)]);rr(()=>r.patients,c=>{c.length>0&&l()}),Or(()=>{r.formDescription&&l()});const s=c=>{c.operation==="add"?c.belongTo.forEach(u=>{const d=r.formDescription.patients.findIndex(h=>h.name===u);r.formDescription.patients[d].observations.push(c)}):c.operation==="remove"&&c.belongTo.forEach(u=>{const d=r.formDescription.patients.findIndex(h=>h.name===u);r.formDescription.patients[d].observations=r.formDescription.patients[d].observations.filter(h=>JSON.stringify(h.observation)!==JSON.stringify(c.observation))}),l(),i("updateObservation",r.formDescription)},l=()=>{if(n.value=!1,a.value=[],r.patients.length===1)r.formDescription.patients.forEach(c=>{r.patients.includes(c.name)&&c.observations.forEach(u=>{a.value.push(JSON.stringify(Object.assign(u.observation,{observationValueType:u.observationValueType})))})});else if(r.patients.length>1){let c=[];r.formDescription.patients.forEach(u=>{r.patients.includes(u.name)&&c.push(u.observations)}),a.value=c.reduce((u,d)=>u.filter(h=>d.map(f=>JSON.stringify(f.observation)).includes(JSON.stringify(h.observation)))).map(u=>JSON.stringify(Object.assign(u.observation,{observationValueType:u.observationValueType})))}else a.value=[];n.value=!0};return(c,u)=>(ht(),Pt("div",null,[Le(JI,{belongTo:e.patients,onUpdateObservation:s},null,8,["belongTo"]),n.value?(ht(!0),Pt(mr,{key:0},vs(o.value,d=>(ht(),Ci(JI,{key:ze(HV)(),belongTo:e.patients,selectedObservationValueType:JSON.parse(d).observationValueType,filledData:JSON.parse(d),disabled:"",onUpdateObservation:s},null,8,["belongTo","selectedObservationValueType","filledData"]))),128)):Ga("",!0)]))}}),yye={class:"my-2 py-1 bg-stone-50 rounded-md border-solid border-2 border-zinc-300 shadow-md"},bye={class:"flex flex-row justify-start px-2 pb-2"},xye=je({__name:"ImagingStudySeries",props:{patient:String,patientDirectoryHandle:Object,selectedSamples:{type:Array,default:()=>[]},selectedPatientsSamples:{type:Object,required:!0}},emits:["update:selectedPatientsSamples"],setup(e,{emit:t}){const r=e,i=me([]),n=me([]),a=t;Or(()=>{n.value=r.patientDirectoryHandle?r.patientDirectoryHandle.children.map(c=>({label:c.name,value:c.name})):[],i.value=[...r.selectedSamples],i.value.length===0&&s()});const o=c=>{r.selectedPatientsSamples[r.patient]=c.map(u=>u.toString()),a("update:selectedPatientsSamples",r.selectedPatientsSamples)},s=()=>{var c;(c=r.patientDirectoryHandle)==null||c.children.forEach(async u=>{if(u.kind==="directory"){for(const d of u.children)if(d.kind==="file"){l(d).then(h=>{h&&(i.value.push(u.name),o(i.value))});return}}})};async function l(c){const u=await c.getFile(),d=new FileReader;return new Promise((h,f)=>{d.onloadend=()=>{const p=new DataView(d.result),v=p.getUint8(128)===68&&p.getUint8(129)===73&&p.getUint8(130)===67&&p.getUint8(131)===77;h(v)},d.onerror=f,d.readAsArrayBuffer(u.slice(0,132))})}return(c,u)=>(ht(),Pt("div",yye,[Le(ze(GA),{prefix:"bar","align-text":"",type:"success"},{default:Je(()=>[Le(ze(Cd),{type:"info",class:"pl-3"},{default:Je(()=>[Lr(" Please select MRI samples for the patient: "),Le(ze(Cd),{class:"pl-3",type:"error"},{default:Je(()=>[Lr(vi(r.patient),1)]),_:1})]),_:1})]),_:1}),st("div",bye,[Le(ze(Pce),{value:i.value,"onUpdate:value":[u[0]||(u[0]=d=>i.value=d),o],"virtual-scroll":"",options:n.value,"source-filterable":"","target-filterable":""},null,8,["value","options"])])]))}}),wye={},Sye={class:"generate my-5"};function Cye(e,t){return ht(),Pt("button",Sye,[gs(e.$slots,"default",{},void 0,!0)])}const _ye=xl(wye,[["render",Cye],["__scopeId","data-v-89ca8621"]]),Aye={class:"flex flex-col pb-5"},Mye=je({__name:"ImagingStudy",props:{formDescription:Object,patientsDirectoryHandle:Object,patients:{type:Array,default:()=>[]}},setup(e,{emit:t}){const r=e,i=t,n=CP(),a=me({});Or(()=>{r.patients.forEach(f=>{u(f)})}),rr(()=>r.patients,f=>{f.forEach(p=>{u(p)})});const o=re(()=>r.patients.length<=3?r.patients:r.patients.slice(0,3)),s=()=>{var f;for(let p in a.value){const v=(f=r.formDescription)==null?void 0:f.patients.findIndex(m=>m.name===p);if(v!==void 0){r.formDescription.patients[v].imagingStudy.series=[];for(let m of a.value[p])l(p,m).then(g=>{r.formDescription.patients[v].imagingStudy.series.push(g),i("updateImagingStudy",r.formDescription)}).catch(g=>{n.error(`The folder ${m} includes non-dcm files. Errors: `+g)})}}i("updateImagingStudy",r.formDescription)},l=(f,p)=>new Promise((v,m)=>{var b,x,S,w,_;const g=(w=(S=(x=(b=r.patientsDirectoryHandle)==null?void 0:b.children)==null?void 0:x.find(C=>C.name===f))==null?void 0:S.children)==null?void 0:w.find(C=>C.name===p),y=(_=g==null?void 0:g.children)==null?void 0:_.find(C=>C.name.endsWith(".dcm"));KI(y).then(C=>{var T;const A=C.string("x0020000e"),M=C.string("x00180015"),P={uid:A,name:p,endpointUrl:"",numberOfInstances:(T=g==null?void 0:g.children)==null?void 0:T.length,instances:[]};if(M){const R=Y0e[M];R&&(P.bodySite=R)}c(g).then(R=>{P.instances=R,v(P)}).catch(R=>{m(R)})}).catch(C=>{m(C)})}),c=f=>new Promise((p,v)=>{const g=f.children.map(y=>KI(y));Promise.all(g).then(y=>{const b=y.map(x=>({uid:x.string("x00080018"),sopClassUid:x.string("x00080016"),sopClassName:X0e[x.string("x00080016")],number:x.string("x00200013")}));p(b)}).catch(y=>{v(y)})}),u=f=>{var v,m,g;const p=(v=r.formDescription)==null?void 0:v.patients.findIndex(y=>y.name===f);p!==void 0&&!((m=r.formDescription)!=null&&m.patients[p].imagingStudy)&&(r.formDescription.patients[p].imagingStudy={endpointUrl:"",path:(g=r.formDescription)==null?void 0:g.patients[p].path,series:[]}),a.value[f]||(a.value[f]=d(f))},d=f=>{if(r.formDescription){const p=r.formDescription.patients.findIndex(v=>v.name===f);if(r.formDescription.patients[p].imagingStudy.series.length>=1)return r.formDescription.patients[p].imagingStudy.series.map(v=>v.name)}return[]},h=f=>{var p;return(p=r.patientsDirectoryHandle)!=null&&p.children?Array.from(r.patientsDirectoryHandle.children).find(v=>v.name===f):void 0};return(f,p)=>(ht(),Pt("div",Aye,[(ht(!0),Pt(mr,null,vs(e.patients,v=>(ht(),Ci(xye,{key:v,patient:v,"patient-directory-handle":h(v),"selected-samples":a.value[v],"selected-patients-samples":a.value,"onUpdate:selectedPatientsSamples":p[0]||(p[0]=m=>a.value=m)},null,8,["patient","patient-directory-handle","selected-samples","selected-patients-samples"]))),128)),Le(_ye,{onClick:s},{default:Je(()=>[Le(ze(Cd),{class:"p-1 text-lg subpixel-antialiased font-semibold text-zinc-900"},{default:Je(()=>[Lr(" Generate "),e.patients.length>1?(ht(),Ci(ze(Cd),{key:0,class:"text-zinc-900"},{default:Je(()=>[Lr("ImagingStudies")]),_:1})):(ht(),Ci(ze(Cd),{key:1,class:"text-zinc-900"},{default:Je(()=>[Lr("ImagingStudy")]),_:1})),Lr(" for selecting patients: "),(ht(!0),Pt(mr,null,vs(o.value,(v,m)=>(ht(),Ci(ze(Cd),{key:m,class:"mx-1 text-gray-500"},{default:Je(()=>[Lr(vi(v),1)]),_:2},1024))),128)),e.patients.length>3?(ht(),Ci(ze(Cd),{key:2,class:"mx-1 text-gray-500"},{default:Je(()=>[Lr("...")]),_:1})):Ga("",!0)]),_:1})]),_:1})]))}}),Eye={class:"p-3 m-3"},Tye={class:"p-3 m-3"},Pye={class:"p-3 m-3"},Dye={class:"my-1 p-2 rounded-md shadow-fancy-inner"},Oye=je({__name:"PrimaryView",setup(e){var w,_;const{root:t}=bl(cc()),r=u0(),i=Yue(),n=me(r.query.name),a=me(),o=me(0),s=me(0),l=me("Annotate"),c=me([]),u=me(!1),d=me(!1),h=me({dataset:{id:"",uuid:"",name:(w=t.value)==null?void 0:w.name,path:"/"},patients:[]}),f=me({dataset:{id:"",uuid:"",name:(_=t.value)==null?void 0:_.name,path:"/"},patients:[]}),p=me(!1),v=({focused:C,checked:A})=>{const M={};return A?(M.background="#a1a1aa",C&&(M.boxShadow="0 0 0 2px #a1a1aa40")):(M.background="#38bdf8",C&&(M.boxShadow="0 0 0 2px #38bdf840")),M},m=C=>{l.value==="Annotate"?l.value="Submit":l.value="Annotate"},g=C=>{d.value=!0,setTimeout(()=>{u.value=C,d.value=!1},1e3)};rr(u,C=>{x("imagingstudy")}),Or(()=>{var C;a.value=(C=t.value)==null?void 0:C.children.filter(A=>A.name===n.value)[0],!a.value||!a.value.children?i.push("/"):a.value.children.forEach(A=>{var M,P;A.kind==="directory"&&(o.value+=A.children.length,f.value.patients.push({id:"",uuid:"",name:A.name,path:((M=t.value)==null?void 0:M.name)+"/"+A.name,observations:[],imagingStudy:null}),h.value.patients.push({id:"",uuid:"",name:A.name,path:((P=t.value)==null?void 0:P.name)+"/"+A.name,observations:[],imagingStudy:null}),A.children.forEach(T=>{T.kind==="directory"&&T.children.forEach(R=>{R.kind==="file"&&R.name.endsWith(".dcm")&&(s.value+=1)})}))})}),rr(c,C=>{C.length>0?C.length===h.value.patients.length&&(p.value=!0):p.value=!1});const y=C=>{x("observation")},b=C=>{x("imagingstudy")},x=C=>{f.value.patients.forEach(A=>{var P;const M=h.value.patients.findIndex(T=>T.name===A.name);C==="observation"&&(A.observations=[],h.value.patients[M].observations.forEach(T=>{A.observations.push(T.observation)})),C==="imagingstudy"&&(u.value?A.imagingStudy=h.value.patients[M].imagingStudy:A.imagingStudy={...h.value.patients[M].imagingStudy,series:(P=h.value.patients[M].imagingStudy)==null?void 0:P.series.map(T=>({...T,instances:[]}))})})},S=C=>{C?c.value=h.value.patients.map(A=>A.name):c.value=[]};return(C,A)=>(ht(),Pt(mr,null,[Le(Kj,{title:"Measurements Annotator",avatar:ze(Xj),annotator:l.value,subtitle:"Add clinic descriptions for patients",onUpdateAnnotator:m},{default:Je(()=>{var M;return[Le(ze(np),{label:"Number of patients",value:(M=a.value)==null?void 0:M.children.length},null,8,["value"]),Le(ze(np),{label:"Number of samples",value:o.value},null,8,["value"]),Le(ze(np),{label:"Number of dicoms",value:s.value},null,8,["value"])]}),_:1},8,["avatar","annotator"]),io(st("div",null,[st("div",Eye,[Le(ze(QR),null,{default:Je(()=>[Lr("Select Patients:")]),_:1}),Le(ze(HR),{value:p.value,"onUpdate:value":[A[0]||(A[0]=M=>p.value=M),S]},{checked:Je(()=>[Lr(" Selected All Patients ")]),unchecked:Je(()=>[Lr(" Deselected All Patients ")]),_:1},8,["value"]),Le(ze($ne),{value:c.value,"onUpdate:value":A[1]||(A[1]=M=>c.value=M),class:"flex flex-row flex-wrap justify-start w-full"},{default:Je(()=>{var M;return[(ht(!0),Pt(mr,null,vs((M=a.value)==null?void 0:M.children,(P,T)=>(ht(),Ci(ze(y6),{key:T,value:P.name,label:P.name,size:"large",class:"checkbox-item"},null,8,["value","label"]))),128))]}),_:1},8,["value"]),Le(ze(RR))])],512),[[nh,l.value!=="Annotate"]]),io(st("div",null,[st("div",Tye,[Le(vme,null,{observation:Je(()=>[Le(ze(GA),null,{default:Je(()=>[Lr("Add Observations for selected patients:")]),_:1}),Le(gye,{patients:c.value,formDescription:h.value,onUpdateObservation:y},null,8,["patients","formDescription"])]),imagingstudy:Je(()=>[Le(ze(GA),null,{default:Je(()=>[Lr("Generating ImagingStudy for selected patients:")]),_:1}),Le(Mye,{patients:c.value,formDescription:h.value,patientsDirectoryHandle:a.value,onUpdateImagingStudy:b},null,8,["patients","formDescription","patientsDirectoryHandle"])]),_:1}),Le(ze(RR))])],512),[[nh,c.value.length>0&&l.value!=="Annotate"]]),st("div",null,[st("div",Pye,[Le(ze(QR),null,{default:Je(()=>[Lr("Measurements:")]),_:1}),Le(ze(HR),{"rubber-band":!1,"rail-style":v,value:u.value,loading:d.value,"onUpdate:value":g},{checked:Je(()=>[Lr(" Back to normal Measurements ")]),unchecked:Je(()=>[Lr(" Show Measurements Details ")]),_:1},8,["value","loading"]),st("pre",Dye,vi(JSON.stringify(f.value,null,2)),1)])])],64))}}),Rye=xl(Oye,[["__scopeId","data-v-2284eece"]]),Iye=je({__name:"testaaa",setup(e){const{root:t}=bl(cc());return console.log("test",t),(r,i)=>(ht(),Pt("div",null," test "+vi(ze(t)),1))}});var zye=Object.create,Ew=Object.defineProperty,kye=Object.getOwnPropertyDescriptor,Lye=Object.getOwnPropertyNames,Bye=Object.getPrototypeOf,Fye=Object.prototype.hasOwnProperty,Nye=(e,t,r)=>t in e?Ew(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,_c=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Uye=(e,t)=>{for(var r in t)Ew(e,r,{get:t[r],enumerable:!0})},jye=(e,t,r,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of Lye(t))!Fye.call(e,n)&&n!==r&&Ew(e,n,{get:()=>t[n],enumerable:!(i=kye(t,n))||i.enumerable});return e},Ac=(e,t,r)=>(r=e!=null?zye(Bye(e)):{},jye(t||!e||!e.__esModule?Ew(r,"default",{value:e,enumerable:!0}):r,e)),gv=(e,t,r)=>(Nye(e,typeof t!="symbol"?t+"":t,r),r),Vye=_c((e,t)=>{(function(r,i){typeof e=="object"?t.exports=i():typeof define=="function"&&define.amd?define(i):r.Alea=i()})(e,function(){return r.importState=function(n){var a=new r;return a.importState(n),a},r;function r(){return function(n){var a=0,o=0,s=0,l=1;n.length==0&&(n=[+new Date]);var c=i();a=c(" "),o=c(" "),s=c(" ");for(var u=0;u<n.length;u++)a-=c(n[u]),a<0&&(a+=1),o-=c(n[u]),o<0&&(o+=1),s-=c(n[u]),s<0&&(s+=1);c=null;var d=function(){var h=2091639*a+l*23283064365386963e-26;return a=o,o=s,s=h-(l=h|0)};return d.next=d,d.uint32=function(){return d()*4294967296},d.fract53=function(){return d()+(d()*2097152|0)*11102230246251565e-32},d.version="Alea 0.9",d.args=n,d.exportState=function(){return[a,o,s,l]},d.importState=function(h){a=+h[0]||0,o=+h[1]||0,s=+h[2]||0,l=+h[3]||0},d}(Array.prototype.slice.call(arguments))}function i(){var n=4022871197,a=function(o){o=o.toString();for(var s=0;s<o.length;s++){n+=o.charCodeAt(s);var l=.02519603282416938*n;n=l>>>0,l-=n,l*=n,n=l>>>0,l-=n,n+=l*4294967296}return(n>>>0)*23283064365386963e-26};return a.version="Mash 0.9",a}})}),WV=_c((e,t)=>{(function(r,i){typeof e=="object"&&typeof t<"u"?i(e):typeof define=="function"&&define.amd?define(["exports"],i):i((r=typeof globalThis<"u"?globalThis:r||self).SVDJS={})})(e,function(r){r.SVD=function(i,n,a,o,s){if(n=n===void 0||n,a=a===void 0||a,s=1e-64/(o=o||Math.pow(2,-52)),!i)throw new TypeError("Matrix a is not defined");var l,c,u,d,h,f,p,v,m,g,y,b,x=i[0].length,S=i.length;if(S<x)throw new TypeError("Invalid matrix: m < n");for(var w=[],_=[],C=[],A=n==="f"?S:x,M=g=p=0;M<S;M++)_[M]=new Array(A).fill(0);for(M=0;M<x;M++)C[M]=new Array(x).fill(0);var P,T=new Array(x).fill(0);for(M=0;M<S;M++)for(l=0;l<x;l++)_[M][l]=i[M][l];for(M=0;M<x;M++){for(w[M]=p,m=0,u=M+1,l=M;l<S;l++)m+=Math.pow(_[l][M],2);if(m<s)p=0;else for(v=(f=_[M][M])*(p=f<0?Math.sqrt(m):-Math.sqrt(m))-m,_[M][M]=f-p,l=u;l<x;l++){for(m=0,c=M;c<S;c++)m+=_[c][M]*_[c][l];for(f=m/v,c=M;c<S;c++)_[c][l]=_[c][l]+f*_[c][M]}for(T[M]=p,m=0,l=u;l<x;l++)m+=Math.pow(_[M][l],2);if(m<s)p=0;else{for(v=(f=_[M][M+1])*(p=f<0?Math.sqrt(m):-Math.sqrt(m))-m,_[M][M+1]=f-p,l=u;l<x;l++)w[l]=_[M][l]/v;for(l=u;l<S;l++){for(m=0,c=u;c<x;c++)m+=_[l][c]*_[M][c];for(c=u;c<x;c++)_[l][c]=_[l][c]+m*w[c]}}g<(y=Math.abs(T[M])+Math.abs(w[M]))&&(g=y)}if(a)for(M=x-1;0<=M;M--){if(p!==0){for(v=_[M][M+1]*p,l=u;l<x;l++)C[l][M]=_[M][l]/v;for(l=u;l<x;l++){for(m=0,c=u;c<x;c++)m+=_[M][c]*C[c][l];for(c=u;c<x;c++)C[c][l]=C[c][l]+m*C[c][M]}}for(l=u;l<x;l++)C[M][l]=0,C[l][M]=0;C[M][M]=1,p=w[M],u=M}if(n){if(n==="f")for(M=x;M<S;M++){for(l=x;l<S;l++)_[M][l]=0;_[M][M]=1}for(M=x-1;0<=M;M--){for(u=M+1,p=T[M],l=u;l<A;l++)_[M][l]=0;if(p!==0){for(v=_[M][M]*p,l=u;l<A;l++){for(m=0,c=u;c<S;c++)m+=_[c][M]*_[c][l];for(f=m/v,c=M;c<S;c++)_[c][l]=_[c][l]+f*_[c][M]}for(l=M;l<S;l++)_[l][M]=_[l][M]/p}else for(l=M;l<S;l++)_[l][M]=0;_[M][M]=_[M][M]+1}}for(o*=g,c=x-1;0<=c;c--)for(var R=0;R<50;R++){for(P=!1,u=c;0<=u;u--){if(Math.abs(w[u])<=o){P=!0;break}if(Math.abs(T[u-1])<=o)break}if(!P){for(h=0,d=u-(m=1),M=u;M<c+1&&(f=m*w[M],w[M]=h*w[M],!(Math.abs(f)<=o));M++)if(p=T[M],T[M]=Math.sqrt(f*f+p*p),h=p/(v=T[M]),m=-f/v,n)for(l=0;l<S;l++)y=_[l][d],b=_[l][M],_[l][d]=y*h+b*m,_[l][M]=-y*m+b*h}if(b=T[c],u===c){if(b<0&&(T[c]=-b,a))for(l=0;l<x;l++)C[l][c]=-C[l][c];break}for(g=T[u],f=(((y=T[c-1])-b)*(y+b)+((p=w[c-1])-(v=w[c]))*(p+v))/(2*v*y),p=Math.sqrt(f*f+1),f=((g-b)*(g+b)+v*(y/(f<0?f-p:f+p)-v))/g,M=u+(m=h=1);M<c+1;M++){if(p=w[M],y=T[M],v=m*p,p*=h,b=Math.sqrt(f*f+v*v),f=g*(h=f/(w[M-1]=b))+p*(m=v/b),p=-g*m+p*h,v=y*m,y*=h,a)for(l=0;l<x;l++)g=C[l][M-1],b=C[l][M],C[l][M-1]=g*h+b*m,C[l][M]=-g*m+b*h;if(b=Math.sqrt(f*f+v*v),f=(h=f/(T[M-1]=b))*p+(m=v/b)*y,g=-m*p+h*y,n)for(l=0;l<S;l++)y=_[l][M-1],b=_[l][M],_[l][M-1]=y*h+b*m,_[l][M]=-y*m+b*h}w[u]=0,w[c]=f,T[c]=g}for(M=0;M<x;M++)T[M]<o&&(T[M]=0);return{u:_,q:T,v:C}},r.VERSION="1.1.1",Object.defineProperty(r,"__esModule",{value:!0})})}),Hye=_c((e,t)=>{(function(r,i){typeof e=="object"&&typeof t<"u"?t.exports=i():typeof define=="function"&&define.amd?define(i):(r=r||self,r.TinyQueue=i())})(e,function(){var r=function(n,a){if(n===void 0&&(n=[]),a===void 0&&(a=i),this.data=n,this.length=this.data.length,this.compare=a,this.length>0)for(var o=(this.length>>1)-1;o>=0;o--)this._down(o)};r.prototype.push=function(n){this.data.push(n),this.length++,this._up(this.length-1)},r.prototype.pop=function(){if(this.length!==0){var n=this.data[0],a=this.data.pop();return this.length--,this.length>0&&(this.data[0]=a,this._down(0)),n}},r.prototype.peek=function(){return this.data[0]},r.prototype._up=function(n){for(var a=this,o=a.data,s=a.compare,l=o[n];n>0;){var c=n-1>>1,u=o[c];if(s(l,u)>=0)break;o[n]=u,n=c}o[n]=l},r.prototype._down=function(n){for(var a=this,o=a.data,s=a.compare,l=this.length>>1,c=o[n];n<l;){var u=(n<<1)+1,d=o[u],h=u+1;if(h<this.length&&s(o[h],d)<0&&(u=h,d=o[h]),s(d,c)>=0)break;o[n]=d,n=u}o[n]=c};function i(n,a){return n<a?-1:n>a?1:0}return r})}),Wye=_c((e,t)=>{var r=Hye();r.default&&(r=r.default),t.exports=i,t.exports.default=i;function i(c,u,d){u=u||1;for(var h,f,p,v,m=0;m<c[0].length;m++){var g=c[0][m];(!m||g[0]<h)&&(h=g[0]),(!m||g[1]<f)&&(f=g[1]),(!m||g[0]>p)&&(p=g[0]),(!m||g[1]>v)&&(v=g[1])}var y=p-h,b=v-f,x=Math.min(y,b),S=x/2;if(x===0){var w=[h,f];return w.distance=0,w}for(var _=new r(void 0,n),C=h;C<p;C+=x)for(var A=f;A<v;A+=x)_.push(new a(C+S,A+S,S,c));var M=s(c),P=new a(h+y/2,f+b/2,0,c);P.d>M.d&&(M=P);for(var T=_.length;_.length;){var R=_.pop();R.d>M.d&&(M=R,d&&console.log("found best %d after %d probes",Math.round(1e4*R.d)/1e4,T)),!(R.max-M.d<=u)&&(S=R.h/2,_.push(new a(R.x-S,R.y-S,S,c)),_.push(new a(R.x+S,R.y-S,S,c)),_.push(new a(R.x-S,R.y+S,S,c)),_.push(new a(R.x+S,R.y+S,S,c)),T+=4)}d&&(console.log("num probes: "+T),console.log("best distance: "+M.d));var z=[M.x,M.y];return z.distance=M.d,z}function n(c,u){return u.max-c.max}function a(c,u,d,h){this.x=c,this.y=u,this.h=d,this.d=o(c,u,h),this.max=this.d+this.h*Math.SQRT2}function o(c,u,d){for(var h=!1,f=1/0,p=0;p<d.length;p++)for(var v=d[p],m=0,g=v.length,y=g-1;m<g;y=m++){var b=v[m],x=v[y];b[1]>u!=x[1]>u&&c<(x[0]-b[0])*(u-b[1])/(x[1]-b[1])+b[0]&&(h=!h),f=Math.min(f,l(c,u,b,x))}return f===0?0:(h?1:-1)*Math.sqrt(f)}function s(c){for(var u=0,d=0,h=0,f=c[0],p=0,v=f.length,m=v-1;p<v;m=p++){var g=f[p],y=f[m],b=g[0]*y[1]-y[0]*g[1];d+=(g[0]+y[0])*b,h+=(g[1]+y[1])*b,u+=b*3}return u===0?new a(f[0][0],f[0][1],0,c):new a(d/u,h/u,0,c)}function l(c,u,d,h){var f=d[0],p=d[1],v=h[0]-f,m=h[1]-p;if(v!==0||m!==0){var g=((c-f)*v+(u-p)*m)/(v*v+m*m);g>1?(f=h[0],p=h[1]):g>0&&(f+=v*g,p+=m*g)}return v=c-f,m=u-p,v*v+m*m}}),Gye=_c((e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=r;function r(i){if(i===null||i===!0||i===!1)return NaN;var n=Number(i);return isNaN(n)?n:n<0?Math.ceil(n):Math.floor(n)}t.exports=e.default}),$ye=_c((e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=r;function r(i){var n=new Date(Date.UTC(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),i.getSeconds(),i.getMilliseconds()));return n.setUTCFullYear(i.getFullYear()),i.getTime()-n.getTime()}t.exports=e.default}),qye=_c((e,t)=>{function r(a,o){function s(){this.constructor=a}s.prototype=o.prototype,a.prototype=new s}function i(a,o,s,l){this.message=a,this.expected=o,this.found=s,this.location=l,this.name="SyntaxError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,i)}r(i,Error),i.buildMessage=function(a,o){var s={literal:function(p){return'"'+c(p.text)+'"'},class:function(p){var v="",m;for(m=0;m<p.parts.length;m++)v+=p.parts[m]instanceof Array?u(p.parts[m][0])+"-"+u(p.parts[m][1]):u(p.parts[m]);return"["+(p.inverted?"^":"")+v+"]"},any:function(p){return"any character"},end:function(p){return"end of input"},other:function(p){return p.description}};function l(p){return p.charCodeAt(0).toString(16).toUpperCase()}function c(p){return p.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(v){return"\\x0"+l(v)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(v){return"\\x"+l(v)})}function u(p){return p.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(v){return"\\x0"+l(v)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(v){return"\\x"+l(v)})}function d(p){return s[p.type](p)}function h(p){var v=new Array(p.length),m,g;for(m=0;m<p.length;m++)v[m]=d(p[m]);if(v.sort(),v.length>0){for(m=1,g=1;m<v.length;m++)v[m-1]!==v[m]&&(v[g]=v[m],g++);v.length=g}switch(v.length){case 1:return v[0];case 2:return v[0]+" or "+v[1];default:return v.slice(0,-1).join(", ")+", or "+v[v.length-1]}}function f(p){return p?'"'+c(p)+'"':"end of input"}return"Expected "+h(a)+" but "+f(o)+" found."};function n(a,o){o=o!==void 0?o:{};var s={},l={svg_path:Ye},c=Ye,u=function(Y){if(!Y)return[];for(var J=[],be=0;be<Y.length;be++)J=J.concat.apply(J,Y[be]);var ae=J[0];return ae&&ae.code=="m"&&(delete ae.relative,ae.code="M"),J},d=function(Y,J){return co(Y,J)},h=/^[Mm]/,f=nt(["M","m"],!1,!1),p=function(Y,J,be){var ae=ja(Y,[J]);return be&&(ae=ae.concat(ja(Y=="M"?"L":"l",be[1]))),ae},v=/^[Zz]/,m=nt(["Z","z"],!1,!1),g=function(){return ja("Z")},y=/^[Ll]/,b=nt(["L","l"],!1,!1),x=function(Y,J){return ja(Y,J)},S=/^[Hh]/,w=nt(["H","h"],!1,!1),_=function(Y,J){return ja(Y,J.map(function(be){return{x:be}}))},C=/^[Vv]/,A=nt(["V","v"],!1,!1),M=function(Y,J){return ja(Y,J.map(function(be){return{y:be}}))},P=/^[Cc]/,T=nt(["C","c"],!1,!1),R=function(Y,J,be){return{x1:Y.x,y1:Y.y,x2:J.x,y2:J.y,x:be.x,y:be.y}},z=/^[Ss]/,F=nt(["S","s"],!1,!1),H=function(Y,J){return{x2:Y.x,y2:Y.y,x:J.x,y:J.y}},N=/^[Qq]/,U=nt(["Q","q"],!1,!1),ie=function(Y,J){return{x1:Y.x,y1:Y.y,x:J.x,y:J.y}},te=/^[Tt]/,X=nt(["T","t"],!1,!1),W=/^[Aa]/,q=nt(["A","a"],!1,!1),$=function(Y,J,be,ae,Ie,ot){return{rx:Y,ry:J,xAxisRotation:be,largeArc:ae,sweep:Ie,x:ot.x,y:ot.y}},le=function(Y,J){return{x:Y,y:J}},ee=function(Y){return Y*1},Q=function(Y){return Y.join("")*1},ne=/^[01]/,V=nt(["0","1"],!1,!1),ue=function(Y){return Y=="1"},ve=function(){return""},Ce=",",G=et(",",!1),Z=function(Y){return Y.join("")},de=".",Se=et(".",!1),we=/^[eE]/,_e=nt(["e","E"],!1,!1),Ee=/^[+\-]/,fe=nt(["+","-"],!1,!1),B=/^[0-9]/,D=nt([["0","9"]],!1,!1),I=function(Y){return Y.join("")},O=/^[ \t\n\r]/,j=nt([" ","	",`
`,"\r"],!1,!1),L=0,Ae=[{line:1,column:1}],We=0,Ve=[],ke;if("startRule"in o){if(!(o.startRule in l))throw new Error(`Can't start parsing from rule "`+o.startRule+'".');c=l[o.startRule]}function et(Y,J){return{type:"literal",text:Y,ignoreCase:J}}function nt(Y,J,be){return{type:"class",parts:Y,inverted:J,ignoreCase:be}}function lt(){return{type:"end"}}function ut(Y){var J=Ae[Y],be;if(J)return J;for(be=Y-1;!Ae[be];)be--;for(J=Ae[be],J={line:J.line,column:J.column};be<Y;)a.charCodeAt(be)===10?(J.line++,J.column=1):J.column++,be++;return Ae[Y]=J,J}function vt(Y,J){var be=ut(Y),ae=ut(J);return{start:{offset:Y,line:be.line,column:be.column},end:{offset:J,line:ae.line,column:ae.column}}}function se(Y){L<We||(L>We&&(We=L,Ve=[]),Ve.push(Y))}function Be(Y,J,be){return new i(i.buildMessage(Y,J),Y,J,be)}function Ye(){var Y,J,be,ae,Ie;for(Y=L,J=[],be=er();be!==s;)J.push(be),be=er();if(J!==s)if(be=pe(),be===s&&(be=null),be!==s){for(ae=[],Ie=er();Ie!==s;)ae.push(Ie),Ie=er();ae!==s?(J=u(be),Y=J):(L=Y,Y=s)}else L=Y,Y=s;else L=Y,Y=s;return Y}function pe(){var Y,J,be,ae,Ie,ot;if(Y=L,J=Te(),J!==s){for(be=[],ae=L,Ie=[],ot=er();ot!==s;)Ie.push(ot),ot=er();for(Ie!==s?(ot=Te(),ot!==s?(Ie=[Ie,ot],ae=Ie):(L=ae,ae=s)):(L=ae,ae=s);ae!==s;){for(be.push(ae),ae=L,Ie=[],ot=er();ot!==s;)Ie.push(ot),ot=er();Ie!==s?(ot=Te(),ot!==s?(Ie=[Ie,ot],ae=Ie):(L=ae,ae=s)):(L=ae,ae=s)}be!==s?(J=d(J,be),Y=J):(L=Y,Y=s)}else L=Y,Y=s;return Y}function Te(){var Y,J,be,ae,Ie,ot;if(Y=L,J=Re(),J!==s){for(be=[],ae=L,Ie=[],ot=er();ot!==s;)Ie.push(ot),ot=er();for(Ie!==s?(ot=ce(),ot!==s?(Ie=[Ie,ot],ae=Ie):(L=ae,ae=s)):(L=ae,ae=s);ae!==s;){for(be.push(ae),ae=L,Ie=[],ot=er();ot!==s;)Ie.push(ot),ot=er();Ie!==s?(ot=ce(),ot!==s?(Ie=[Ie,ot],ae=Ie):(L=ae,ae=s)):(L=ae,ae=s)}be!==s?(J=d(J,be),Y=J):(L=Y,Y=s)}else L=Y,Y=s;return Y}function ce(){var Y;return Y=$e(),Y===s&&(Y=at(),Y===s&&(Y=nr(),Y===s&&(Y=Ke(),Y===s&&(Y=dt(),Y===s&&(Y=Mi(),Y===s&&(Y=K(),Y===s&&(Y=Oe(),Y===s&&(Y=wt())))))))),Y}function Re(){var Y,J,be,ae,Ie,ot,Yo;if(Y=L,h.test(a.charAt(L))?(J=a.charAt(L),L++):(J=s,se(f)),J!==s){for(be=[],ae=er();ae!==s;)be.push(ae),ae=er();be!==s?(ae=Tt(),ae!==s?(Ie=L,ot=Qe(),ot===s&&(ot=null),ot!==s?(Yo=Yt(),Yo!==s?(ot=[ot,Yo],Ie=ot):(L=Ie,Ie=s)):(L=Ie,Ie=s),Ie===s&&(Ie=null),Ie!==s?(J=p(J,ae,Ie),Y=J):(L=Y,Y=s)):(L=Y,Y=s)):(L=Y,Y=s)}else L=Y,Y=s;return Y}function $e(){var Y,J;return Y=L,v.test(a.charAt(L))?(J=a.charAt(L),L++):(J=s,se(m)),J!==s&&(J=g()),Y=J,Y}function at(){var Y,J,be,ae;if(Y=L,y.test(a.charAt(L))?(J=a.charAt(L),L++):(J=s,se(b)),J!==s){for(be=[],ae=er();ae!==s;)be.push(ae),ae=er();be!==s?(ae=Yt(),ae!==s?(J=x(J,ae),Y=J):(L=Y,Y=s)):(L=Y,Y=s)}else L=Y,Y=s;return Y}function Yt(){var Y,J,be,ae,Ie,ot;if(Y=L,J=Tt(),J!==s){for(be=[],ae=L,Ie=Qe(),Ie===s&&(Ie=null),Ie!==s?(ot=Tt(),ot!==s?(Ie=[Ie,ot],ae=Ie):(L=ae,ae=s)):(L=ae,ae=s);ae!==s;)be.push(ae),ae=L,Ie=Qe(),Ie===s&&(Ie=null),Ie!==s?(ot=Tt(),ot!==s?(Ie=[Ie,ot],ae=Ie):(L=ae,ae=s)):(L=ae,ae=s);be!==s?(J=d(J,be),Y=J):(L=Y,Y=s)}else L=Y,Y=s;return Y}function nr(){var Y,J,be,ae;if(Y=L,S.test(a.charAt(L))?(J=a.charAt(L),L++):(J=s,se(w)),J!==s){for(be=[],ae=er();ae!==s;)be.push(ae),ae=er();be!==s?(ae=Fe(),ae!==s?(J=_(J,ae),Y=J):(L=Y,Y=s)):(L=Y,Y=s)}else L=Y,Y=s;return Y}function Fe(){var Y,J,be,ae,Ie,ot;if(Y=L,J=Jt(),J!==s){for(be=[],ae=L,Ie=Qe(),Ie===s&&(Ie=null),Ie!==s?(ot=Jt(),ot!==s?(Ie=[Ie,ot],ae=Ie):(L=ae,ae=s)):(L=ae,ae=s);ae!==s;)be.push(ae),ae=L,Ie=Qe(),Ie===s&&(Ie=null),Ie!==s?(ot=Jt(),ot!==s?(Ie=[Ie,ot],ae=Ie):(L=ae,ae=s)):(L=ae,ae=s);be!==s?(J=d(J,be),Y=J):(L=Y,Y=s)}else L=Y,Y=s;return Y}function Ke(){var Y,J,be,ae;if(Y=L,C.test(a.charAt(L))?(J=a.charAt(L),L++):(J=s,se(A)),J!==s){for(be=[],ae=er();ae!==s;)be.push(ae),ae=er();be!==s?(ae=Fe(),ae!==s?(J=M(J,ae),Y=J):(L=Y,Y=s)):(L=Y,Y=s)}else L=Y,Y=s;return Y}function dt(){var Y,J,be,ae;if(Y=L,P.test(a.charAt(L))?(J=a.charAt(L),L++):(J=s,se(T)),J!==s){for(be=[],ae=er();ae!==s;)be.push(ae),ae=er();be!==s?(ae=Nt(),ae!==s?(J=x(J,ae),Y=J):(L=Y,Y=s)):(L=Y,Y=s)}else L=Y,Y=s;return Y}function Nt(){var Y,J,be,ae,Ie,ot;if(Y=L,J=hi(),J!==s){for(be=[],ae=L,Ie=Qe(),Ie===s&&(Ie=null),Ie!==s?(ot=hi(),ot!==s?(Ie=[Ie,ot],ae=Ie):(L=ae,ae=s)):(L=ae,ae=s);ae!==s;)be.push(ae),ae=L,Ie=Qe(),Ie===s&&(Ie=null),Ie!==s?(ot=hi(),ot!==s?(Ie=[Ie,ot],ae=Ie):(L=ae,ae=s)):(L=ae,ae=s);be!==s?(J=d(J,be),Y=J):(L=Y,Y=s)}else L=Y,Y=s;return Y}function hi(){var Y,J,be,ae,Ie,ot;return Y=L,J=Tt(),J!==s?(be=Qe(),be===s&&(be=null),be!==s?(ae=Tt(),ae!==s?(Ie=Qe(),Ie===s&&(Ie=null),Ie!==s?(ot=Tt(),ot!==s?(J=R(J,ae,ot),Y=J):(L=Y,Y=s)):(L=Y,Y=s)):(L=Y,Y=s)):(L=Y,Y=s)):(L=Y,Y=s),Y}function Mi(){var Y,J,be,ae;if(Y=L,z.test(a.charAt(L))?(J=a.charAt(L),L++):(J=s,se(F)),J!==s){for(be=[],ae=er();ae!==s;)be.push(ae),ae=er();be!==s?(ae=Mr(),ae!==s?(J=x(J,ae),Y=J):(L=Y,Y=s)):(L=Y,Y=s)}else L=Y,Y=s;return Y}function Mr(){var Y,J,be,ae,Ie,ot;if(Y=L,J=De(),J!==s){for(be=[],ae=L,Ie=Qe(),Ie===s&&(Ie=null),Ie!==s?(ot=De(),ot!==s?(Ie=[Ie,ot],ae=Ie):(L=ae,ae=s)):(L=ae,ae=s);ae!==s;)be.push(ae),ae=L,Ie=Qe(),Ie===s&&(Ie=null),Ie!==s?(ot=De(),ot!==s?(Ie=[Ie,ot],ae=Ie):(L=ae,ae=s)):(L=ae,ae=s);be!==s?(J=d(J,be),Y=J):(L=Y,Y=s)}else L=Y,Y=s;return Y}function De(){var Y,J,be,ae;return Y=L,J=Tt(),J!==s?(be=Qe(),be===s&&(be=null),be!==s?(ae=Tt(),ae!==s?(J=H(J,ae),Y=J):(L=Y,Y=s)):(L=Y,Y=s)):(L=Y,Y=s),Y}function K(){var Y,J,be,ae;if(Y=L,N.test(a.charAt(L))?(J=a.charAt(L),L++):(J=s,se(U)),J!==s){for(be=[],ae=er();ae!==s;)be.push(ae),ae=er();be!==s?(ae=Me(),ae!==s?(J=x(J,ae),Y=J):(L=Y,Y=s)):(L=Y,Y=s)}else L=Y,Y=s;return Y}function Me(){var Y,J,be,ae,Ie,ot;if(Y=L,J=He(),J!==s){for(be=[],ae=L,Ie=Qe(),Ie===s&&(Ie=null),Ie!==s?(ot=He(),ot!==s?(Ie=[Ie,ot],ae=Ie):(L=ae,ae=s)):(L=ae,ae=s);ae!==s;)be.push(ae),ae=L,Ie=Qe(),Ie===s&&(Ie=null),Ie!==s?(ot=He(),ot!==s?(Ie=[Ie,ot],ae=Ie):(L=ae,ae=s)):(L=ae,ae=s);be!==s?(J=d(J,be),Y=J):(L=Y,Y=s)}else L=Y,Y=s;return Y}function He(){var Y,J,be,ae;return Y=L,J=Tt(),J!==s?(be=Qe(),be===s&&(be=null),be!==s?(ae=Tt(),ae!==s?(J=ie(J,ae),Y=J):(L=Y,Y=s)):(L=Y,Y=s)):(L=Y,Y=s),Y}function Oe(){var Y,J,be,ae;if(Y=L,te.test(a.charAt(L))?(J=a.charAt(L),L++):(J=s,se(X)),J!==s){for(be=[],ae=er();ae!==s;)be.push(ae),ae=er();be!==s?(ae=Ne(),ae!==s?(J=x(J,ae),Y=J):(L=Y,Y=s)):(L=Y,Y=s)}else L=Y,Y=s;return Y}function Ne(){var Y,J,be,ae,Ie,ot;if(Y=L,J=Tt(),J!==s){for(be=[],ae=L,Ie=Qe(),Ie===s&&(Ie=null),Ie!==s?(ot=Tt(),ot!==s?(Ie=[Ie,ot],ae=Ie):(L=ae,ae=s)):(L=ae,ae=s);ae!==s;)be.push(ae),ae=L,Ie=Qe(),Ie===s&&(Ie=null),Ie!==s?(ot=Tt(),ot!==s?(Ie=[Ie,ot],ae=Ie):(L=ae,ae=s)):(L=ae,ae=s);be!==s?(J=d(J,be),Y=J):(L=Y,Y=s)}else L=Y,Y=s;return Y}function wt(){var Y,J,be,ae;if(Y=L,W.test(a.charAt(L))?(J=a.charAt(L),L++):(J=s,se(q)),J!==s){for(be=[],ae=er();ae!==s;)be.push(ae),ae=er();be!==s?(ae=Rt(),ae!==s?(J=x(J,ae),Y=J):(L=Y,Y=s)):(L=Y,Y=s)}else L=Y,Y=s;return Y}function Rt(){var Y,J,be,ae,Ie,ot;if(Y=L,J=It(),J!==s){for(be=[],ae=L,Ie=Qe(),Ie===s&&(Ie=null),Ie!==s?(ot=It(),ot!==s?(Ie=[Ie,ot],ae=Ie):(L=ae,ae=s)):(L=ae,ae=s);ae!==s;)be.push(ae),ae=L,Ie=Qe(),Ie===s&&(Ie=null),Ie!==s?(ot=It(),ot!==s?(Ie=[Ie,ot],ae=Ie):(L=ae,ae=s)):(L=ae,ae=s);be!==s?(J=d(J,be),Y=J):(L=Y,Y=s)}else L=Y,Y=s;return Y}function It(){var Y,J,be,ae,Ie,ot,Yo,Sm,Fh,Cm,Nh,_m;return Y=L,J=fr(),J!==s?(be=Qe(),be===s&&(be=null),be!==s?(ae=fr(),ae!==s?(Ie=Qe(),Ie===s&&(Ie=null),Ie!==s?(ot=Jt(),ot!==s?(Yo=Qe(),Yo!==s?(Sm=Pe(),Sm!==s?(Fh=Qe(),Fh===s&&(Fh=null),Fh!==s?(Cm=Pe(),Cm!==s?(Nh=Qe(),Nh===s&&(Nh=null),Nh!==s?(_m=Tt(),_m!==s?(J=$(J,ae,ot,Sm,Cm,_m),Y=J):(L=Y,Y=s)):(L=Y,Y=s)):(L=Y,Y=s)):(L=Y,Y=s)):(L=Y,Y=s)):(L=Y,Y=s)):(L=Y,Y=s)):(L=Y,Y=s)):(L=Y,Y=s)):(L=Y,Y=s)):(L=Y,Y=s),Y}function Tt(){var Y,J,be,ae;return Y=L,J=Jt(),J!==s?(be=Qe(),be===s&&(be=null),be!==s?(ae=Jt(),ae!==s?(J=le(J,ae),Y=J):(L=Y,Y=s)):(L=Y,Y=s)):(L=Y,Y=s),Y}function fr(){var Y,J;return Y=L,J=Er(),J===s&&(J=En()),J!==s&&(J=ee(J)),Y=J,Y}function Jt(){var Y,J,be,ae;return Y=L,J=L,be=ar(),be===s&&(be=null),be!==s?(ae=Er(),ae!==s?(be=[be,ae],J=be):(L=J,J=s)):(L=J,J=s),J===s&&(J=L,be=ar(),be===s&&(be=null),be!==s?(ae=En(),ae!==s?(be=[be,ae],J=be):(L=J,J=s)):(L=J,J=s)),J!==s&&(J=Q(J)),Y=J,Y}function Pe(){var Y,J;return Y=L,ne.test(a.charAt(L))?(J=a.charAt(L),L++):(J=s,se(V)),J!==s&&(J=ue(J)),Y=J,Y}function Qe(){var Y,J,be,ae,Ie;if(Y=L,J=[],be=er(),be!==s)for(;be!==s;)J.push(be),be=er();else J=s;if(J!==s)if(be=xt(),be===s&&(be=null),be!==s){for(ae=[],Ie=er();Ie!==s;)ae.push(Ie),Ie=er();ae!==s?(J=[J,be,ae],Y=J):(L=Y,Y=s)}else L=Y,Y=s;else L=Y,Y=s;if(Y===s){if(Y=L,J=L,be=xt(),be!==s){for(ae=[],Ie=er();Ie!==s;)ae.push(Ie),Ie=er();ae!==s?(be=[be,ae],J=be):(L=J,J=s)}else L=J,J=s;J!==s&&(J=ve()),Y=J}return Y}function xt(){var Y;return a.charCodeAt(L)===44?(Y=Ce,L++):(Y=s,se(G)),Y}function Er(){var Y,J,be,ae;return Y=L,J=L,be=ui(),be!==s?(ae=Ut(),ae===s&&(ae=null),ae!==s?(be=[be,ae],J=be):(L=J,J=s)):(L=J,J=s),J===s&&(J=L,be=En(),be!==s?(ae=Ut(),ae!==s?(be=[be,ae],J=be):(L=J,J=s)):(L=J,J=s)),J!==s&&(J=Z(J)),Y=J,Y}function ui(){var Y,J,be,ae,Ie;return Y=L,J=L,be=En(),be===s&&(be=null),be!==s?(a.charCodeAt(L)===46?(ae=de,L++):(ae=s,se(Se)),ae!==s?(Ie=En(),Ie!==s?(be=[be,ae,Ie],J=be):(L=J,J=s)):(L=J,J=s)):(L=J,J=s),J===s&&(J=L,be=En(),be!==s?(a.charCodeAt(L)===46?(ae=de,L++):(ae=s,se(Se)),ae!==s?(be=[be,ae],J=be):(L=J,J=s)):(L=J,J=s)),J!==s&&(J=Z(J)),Y=J,Y}function Ut(){var Y,J,be,ae,Ie;return Y=L,J=L,we.test(a.charAt(L))?(be=a.charAt(L),L++):(be=s,se(_e)),be!==s?(ae=ar(),ae===s&&(ae=null),ae!==s?(Ie=En(),Ie!==s?(be=[be,ae,Ie],J=be):(L=J,J=s)):(L=J,J=s)):(L=J,J=s),J!==s&&(J=Z(J)),Y=J,Y}function ar(){var Y;return Ee.test(a.charAt(L))?(Y=a.charAt(L),L++):(Y=s,se(fe)),Y}function En(){var Y,J,be;if(Y=L,J=[],B.test(a.charAt(L))?(be=a.charAt(L),L++):(be=s,se(D)),be!==s)for(;be!==s;)J.push(be),B.test(a.charAt(L))?(be=a.charAt(L),L++):(be=s,se(D));else J=s;return J!==s&&(J=I(J)),Y=J,Y}function er(){var Y,J;return Y=L,O.test(a.charAt(L))?(J=a.charAt(L),L++):(J=s,se(j)),J!==s&&(J=ve()),Y=J,Y}function co(Y,J){if(!J)return[Y];for(var be=[Y],ae=0,Ie=J.length;ae<Ie;ae++)be[ae+1]=J[ae][1];return be}var qo={m:"moveto",l:"lineto",h:"horizontal lineto",v:"vertical lineto",c:"curveto",s:"smooth curveto",q:"quadratic curveto",t:"smooth quadratic curveto",a:"elliptical arc",z:"closepath"};for(var yo in qo)qo[yo.toUpperCase()]=qo[yo];function ja(Y,J){J||(J=[{}]);for(var be=J.length;be--;){var ae={code:Y,command:qo[Y]};Y==Y.toLowerCase()&&(ae.relative=!0);for(var Ie in J[be])ae[Ie]=J[be][Ie];J[be]=ae}return J}if(ke=c(),ke!==s&&L===a.length)return ke;throw ke!==s&&L<a.length&&se(lt()),Be(Ve,We<a.length?a.charAt(We):null,We<a.length?vt(We,We+1):vt(We,We))}t.exports={SyntaxError:i,parse:n}}),GV=_c((e,t)=>{var r=qye().parse;r.parseSVG=r,r.makeAbsolute=i,t.exports=r;function i(n){var a,o={x:0,y:0},s={x:"x0",y:"y0",x1:"x0",y1:"y0",x2:"x0",y2:"y0"};return n.forEach(function(l){l.command==="moveto"&&(a=l),l.x0=o.x,l.y0=o.y;for(var c in s)c in l&&(l[c]+=l.relative?l[s[c]]:0);"x"in l||(l.x=o.x),"y"in l||(l.y=o.y),l.relative=!1,l.code=l.code.toUpperCase(),l.command=="closepath"&&(l.x=a.x,l.y=a.y),o=l}),n}}),Yye=_c((e,t)=>{t.exports=function(r,i){for(var n=r.split("."),a=i.split("."),o=0;o<3;o++){var s=Number(n[o]),l=Number(a[o]);if(s>l)return 1;if(l>s)return-1;if(!isNaN(s)&&isNaN(l))return 1;if(isNaN(s)&&!isNaN(l))return-1}return 0}}),am="149",wo={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},Xye=0,ez=1,Kye=2,FP=1,Qye=2,yv=3,bs=0,Nn=1,ga=2,un=0,Qd=1,tz=2,rz=3,iz=4,Zye=5,Rf=100,Jye=101,ebe=102,nz=103,az=104,tbe=200,rbe=201,ibe=202,nbe=203,$V=204,qV=205,abe=206,obe=207,sbe=208,lbe=209,cbe=210,ube=0,dbe=1,hbe=2,uM=3,fbe=4,pbe=5,mbe=6,vbe=7,YV=0,gbe=1,ybe=2,sl=0,bbe=1,xbe=2,wbe=3,Sbe=4,Cbe=5,XV=300,fh=301,ph=302,dM=303,hM=304,p0=306,Zl=1e3,_i=1001,fM=1002,Wr=1003,oz=1004,sC=1005,hr=1006,_be=1007,zp=1008,wa=1009,Abe=1010,Mbe=1011,KV=1012,Ebe=1013,Jl=1014,ln=1015,dc=1016,Tbe=1017,Pbe=1018,Zd=1020,Dbe=1021,Ln=1023,Obe=1024,Rbe=1025,Jd=1026,mh=1027,Ibe=1028,zbe=1029,Bx=1030,kbe=1031,QV=1033,lC=33776,cC=33777,uC=33778,dC=33779,sz=35840,lz=35841,cz=35842,uz=35843,Lbe=36196,dz=37492,hz=37496,fz=37808,pz=37809,mz=37810,vz=37811,gz=37812,yz=37813,bz=37814,xz=37815,wz=37816,Sz=37817,Cz=37818,_z=37819,Az=37820,Mz=37821,hC=36492,Bbe=36283,Ez=36284,Tz=36285,Pz=36286,ZV=2200,JV=2201,NP=2202,Fx=2300,Nx=2301,fC=2302,Vf=2400,Hf=2401,Ux=2402,UP=2500,Fbe=2501,xs=3e3,lr=3001,Mc=3200,e8=3201,Nbe=0,Ube=1,Hs="srgb",jx="srgb-linear",pC=7680,jbe=519,pM=35044,Vbe=35048,Dz="300 es",mM=1035,ca=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});let r=this._listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(t)===-1&&r[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;let r=this._listeners;return r[e]!==void 0&&r[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;let r=this._listeners[e];if(r!==void 0){let i=r.indexOf(t);i!==-1&&r.splice(i,1)}}dispatchEvent(e){if(this._listeners===void 0)return;let t=this._listeners[e.type];if(t!==void 0){e.target=this;let r=t.slice(0);for(let i=0,n=r.length;i<n;i++)r[i].call(this,e);e.target=null}}},da=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],Oz=1234567,Hv=Math.PI/180,Eg=180/Math.PI;function Uo(){let e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,r=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(da[e&255]+da[e>>8&255]+da[e>>16&255]+da[e>>24&255]+"-"+da[t&255]+da[t>>8&255]+"-"+da[t>>16&15|64]+da[t>>24&255]+"-"+da[r&63|128]+da[r>>8&255]+"-"+da[r>>16&255]+da[r>>24&255]+da[i&255]+da[i>>8&255]+da[i>>16&255]+da[i>>24&255]).toLowerCase()}function an(e,t,r){return Math.max(t,Math.min(r,e))}function jP(e,t){return(e%t+t)%t}function Hbe(e,t,r,i,n){return i+(e-t)*(n-i)/(r-t)}function Wbe(e,t,r){return e!==t?(r-e)/(t-e):0}function Wv(e,t,r){return(1-r)*e+r*t}function Gbe(e,t,r,i){return Wv(e,t,1-Math.exp(-r*i))}function $be(e,t=1){return t-Math.abs(jP(e,t*2)-t)}function qbe(e,t,r){return e<=t?0:e>=r?1:(e=(e-t)/(r-t),e*e*(3-2*e))}function Ybe(e,t,r){return e<=t?0:e>=r?1:(e=(e-t)/(r-t),e*e*e*(e*(e*6-15)+10))}function Xbe(e,t){return e+Math.floor(Math.random()*(t-e+1))}function Kbe(e,t){return e+Math.random()*(t-e)}function Qbe(e){return e*(.5-Math.random())}function Zbe(e){e!==void 0&&(Oz=e);let t=Oz+=1831565813;return t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61),((t^t>>>14)>>>0)/4294967296}function Jbe(e){return e*Hv}function exe(e){return e*Eg}function vM(e){return(e&e-1)===0&&e!==0}function t8(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))}function Vx(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}function txe(e,t,r,i,n){let a=Math.cos,o=Math.sin,s=a(r/2),l=o(r/2),c=a((t+i)/2),u=o((t+i)/2),d=a((t-i)/2),h=o((t-i)/2),f=a((i-t)/2),p=o((i-t)/2);switch(n){case"XYX":e.set(s*u,l*d,l*h,s*c);break;case"YZY":e.set(l*h,s*u,l*d,s*c);break;case"ZXZ":e.set(l*d,l*h,s*u,s*c);break;case"XZX":e.set(s*u,l*p,l*f,s*c);break;case"YXY":e.set(l*f,s*u,l*p,s*c);break;case"ZYZ":e.set(l*p,l*f,s*u,s*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+n)}}function ec(e,t){switch(t.constructor){case Float32Array:return e;case Uint16Array:return e/65535;case Uint8Array:return e/255;case Int16Array:return Math.max(e/32767,-1);case Int8Array:return Math.max(e/127,-1);default:throw new Error("Invalid component type.")}}function di(e,t){switch(t.constructor){case Float32Array:return e;case Uint16Array:return Math.round(e*65535);case Uint8Array:return Math.round(e*255);case Int16Array:return Math.round(e*32767);case Int8Array:return Math.round(e*127);default:throw new Error("Invalid component type.")}}var St=Object.freeze({__proto__:null,DEG2RAD:Hv,RAD2DEG:Eg,ceilPowerOfTwo:t8,clamp:an,damp:Gbe,degToRad:Jbe,denormalize:ec,euclideanModulo:jP,floorPowerOfTwo:Vx,generateUUID:Uo,inverseLerp:Wbe,isPowerOfTwo:vM,lerp:Wv,mapLinear:Hbe,normalize:di,pingpong:$be,radToDeg:exe,randFloat:Kbe,randFloatSpread:Qbe,randInt:Xbe,seededRandom:Zbe,setQuaternionFromProperEuler:txe,smootherstep:Ybe,smoothstep:qbe}),ye=class{constructor(e=0,t=0){ye.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){let t=this.x,r=this.y,i=e.elements;return this.x=i[0]*t+i[3]*r+i[6],this.y=i[1]*t+i[4]*r+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){let r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,r=this.y-e.y;return t*t+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){let r=Math.cos(t),i=Math.sin(t),n=this.x-e.x,a=this.y-e.y;return this.x=n*r-a*i+e.x,this.y=n*i+a*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}},cn=class{constructor(){cn.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(e,t,r,i,n,a,o,s,l){let c=this.elements;return c[0]=e,c[1]=i,c[2]=o,c[3]=t,c[4]=n,c[5]=s,c[6]=r,c[7]=a,c[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){let t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],this}extractBasis(e,t,r){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){let t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let r=e.elements,i=t.elements,n=this.elements,a=r[0],o=r[3],s=r[6],l=r[1],c=r[4],u=r[7],d=r[2],h=r[5],f=r[8],p=i[0],v=i[3],m=i[6],g=i[1],y=i[4],b=i[7],x=i[2],S=i[5],w=i[8];return n[0]=a*p+o*g+s*x,n[3]=a*v+o*y+s*S,n[6]=a*m+o*b+s*w,n[1]=l*p+c*g+u*x,n[4]=l*v+c*y+u*S,n[7]=l*m+c*b+u*w,n[2]=d*p+h*g+f*x,n[5]=d*v+h*y+f*S,n[8]=d*m+h*b+f*w,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){let e=this.elements,t=e[0],r=e[1],i=e[2],n=e[3],a=e[4],o=e[5],s=e[6],l=e[7],c=e[8];return t*a*c-t*o*l-r*n*c+r*o*s+i*n*l-i*a*s}invert(){let e=this.elements,t=e[0],r=e[1],i=e[2],n=e[3],a=e[4],o=e[5],s=e[6],l=e[7],c=e[8],u=c*a-o*l,d=o*s-c*n,h=l*n-a*s,f=t*u+r*d+i*h;if(f===0)return this.set(0,0,0,0,0,0,0,0,0);let p=1/f;return e[0]=u*p,e[1]=(i*l-c*r)*p,e[2]=(o*r-i*a)*p,e[3]=d*p,e[4]=(c*t-i*s)*p,e[5]=(i*n-o*t)*p,e[6]=h*p,e[7]=(r*s-l*t)*p,e[8]=(a*t-r*n)*p,this}transpose(){let e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){let t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,r,i,n,a,o){let s=Math.cos(n),l=Math.sin(n);return this.set(r*s,r*l,-r*(s*a+l*o)+a+e,-i*l,i*s,-i*(-l*a+s*o)+o+t,0,0,1),this}scale(e,t){return this.premultiply(mC.makeScale(e,t)),this}rotate(e){return this.premultiply(mC.makeRotation(-e)),this}translate(e,t){return this.premultiply(mC.makeTranslation(e,t)),this}makeTranslation(e,t){return this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){let t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,r,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){let t=this.elements,r=e.elements;for(let i=0;i<9;i++)if(t[i]!==r[i])return!1;return!0}fromArray(e,t=0){for(let r=0;r<9;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){let r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}clone(){return new this.constructor().fromArray(this.elements)}},mC=new cn;function r8(e){for(let t=e.length-1;t>=0;--t)if(e[t]>=65535)return!0;return!1}var rxe={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function ay(e,t){return new rxe[e](t)}function Tg(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}function eh(e){return e<.04045?e*.0773993808:Math.pow(e*.9478672986+.0521327014,2.4)}function Fb(e){return e<.0031308?e*12.92:1.055*Math.pow(e,.41666)-.055}var vC={[Hs]:{[jx]:eh},[jx]:{[Hs]:Fb}},Ca={legacyMode:!0,get workingColorSpace(){return jx},set workingColorSpace(e){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(e,t,r){if(this.legacyMode||t===r||!t||!r)return e;if(vC[t]&&vC[t][r]!==void 0){let i=vC[t][r];return e.r=i(e.r),e.g=i(e.g),e.b=i(e.b),e}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(e,t){return this.convert(e,this.workingColorSpace,t)},toWorkingColorSpace:function(e,t){return this.convert(e,t,this.workingColorSpace)}},i8={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},fn={r:0,g:0,b:0},Xo={h:0,s:0,l:0},oy={h:0,s:0,l:0};function gC(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*6*r:r<1/2?t:r<2/3?e+(t-e)*6*(2/3-r):e}function sy(e,t){return t.r=e.r,t.g=e.g,t.b=e.b,t}var Bt=class{constructor(e,t,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,t===void 0&&r===void 0?this.set(e):this.setRGB(e,t,r)}set(e){return e&&e.isColor?this.copy(e):typeof e=="number"?this.setHex(e):typeof e=="string"&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Hs){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Ca.toWorkingColorSpace(this,t),this}setRGB(e,t,r,i=Ca.workingColorSpace){return this.r=e,this.g=t,this.b=r,Ca.toWorkingColorSpace(this,i),this}setHSL(e,t,r,i=Ca.workingColorSpace){if(e=jP(e,1),t=an(t,0,1),r=an(r,0,1),t===0)this.r=this.g=this.b=r;else{let n=r<=.5?r*(1+t):r+t-r*t,a=2*r-n;this.r=gC(a,n,e+1/3),this.g=gC(a,n,e),this.b=gC(a,n,e-1/3)}return Ca.toWorkingColorSpace(this,i),this}setStyle(e,t=Hs){function r(n){n!==void 0&&parseFloat(n)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let i;if(i=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){let n,a=i[1],o=i[2];switch(a){case"rgb":case"rgba":if(n=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return this.r=Math.min(255,parseInt(n[1],10))/255,this.g=Math.min(255,parseInt(n[2],10))/255,this.b=Math.min(255,parseInt(n[3],10))/255,Ca.toWorkingColorSpace(this,t),r(n[4]),this;if(n=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return this.r=Math.min(100,parseInt(n[1],10))/100,this.g=Math.min(100,parseInt(n[2],10))/100,this.b=Math.min(100,parseInt(n[3],10))/100,Ca.toWorkingColorSpace(this,t),r(n[4]),this;break;case"hsl":case"hsla":if(n=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o)){let s=parseFloat(n[1])/360,l=parseFloat(n[2])/100,c=parseFloat(n[3])/100;return r(n[4]),this.setHSL(s,l,c,t)}break}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(e)){let n=i[1],a=n.length;if(a===3)return this.r=parseInt(n.charAt(0)+n.charAt(0),16)/255,this.g=parseInt(n.charAt(1)+n.charAt(1),16)/255,this.b=parseInt(n.charAt(2)+n.charAt(2),16)/255,Ca.toWorkingColorSpace(this,t),this;if(a===6)return this.r=parseInt(n.charAt(0)+n.charAt(1),16)/255,this.g=parseInt(n.charAt(2)+n.charAt(3),16)/255,this.b=parseInt(n.charAt(4)+n.charAt(5),16)/255,Ca.toWorkingColorSpace(this,t),this}return e&&e.length>0?this.setColorName(e,t):this}setColorName(e,t=Hs){let r=i8[e.toLowerCase()];return r!==void 0?this.setHex(r,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=eh(e.r),this.g=eh(e.g),this.b=eh(e.b),this}copyLinearToSRGB(e){return this.r=Fb(e.r),this.g=Fb(e.g),this.b=Fb(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Hs){return Ca.fromWorkingColorSpace(sy(this,fn),e),an(fn.r*255,0,255)<<16^an(fn.g*255,0,255)<<8^an(fn.b*255,0,255)<<0}getHexString(e=Hs){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Ca.workingColorSpace){Ca.fromWorkingColorSpace(sy(this,fn),t);let r=fn.r,i=fn.g,n=fn.b,a=Math.max(r,i,n),o=Math.min(r,i,n),s,l,c=(o+a)/2;if(o===a)s=0,l=0;else{let u=a-o;switch(l=c<=.5?u/(a+o):u/(2-a-o),a){case r:s=(i-n)/u+(i<n?6:0);break;case i:s=(n-r)/u+2;break;case n:s=(r-i)/u+4;break}s/=6}return e.h=s,e.s=l,e.l=c,e}getRGB(e,t=Ca.workingColorSpace){return Ca.fromWorkingColorSpace(sy(this,fn),t),e.r=fn.r,e.g=fn.g,e.b=fn.b,e}getStyle(e=Hs){return Ca.fromWorkingColorSpace(sy(this,fn),e),e!==Hs?`color(${e} ${fn.r} ${fn.g} ${fn.b})`:`rgb(${fn.r*255|0},${fn.g*255|0},${fn.b*255|0})`}offsetHSL(e,t,r){return this.getHSL(Xo),Xo.h+=e,Xo.s+=t,Xo.l+=r,this.setHSL(Xo.h,Xo.s,Xo.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,r){return this.r=e.r+(t.r-e.r)*r,this.g=e.g+(t.g-e.g)*r,this.b=e.b+(t.b-e.b)*r,this}lerpHSL(e,t){this.getHSL(Xo),e.getHSL(oy);let r=Wv(Xo.h,oy.h,t),i=Wv(Xo.s,oy.s,t),n=Wv(Xo.l,oy.l,t);return this.setHSL(r,i,n),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};Bt.NAMES=i8;var Qh,n8=class{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{Qh===void 0&&(Qh=Tg("canvas")),Qh.width=e.width,Qh.height=e.height;let r=Qh.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),t=Qh}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){let t=Tg("canvas");t.width=e.width,t.height=e.height;let r=t.getContext("2d");r.drawImage(e,0,0,e.width,e.height);let i=r.getImageData(0,0,e.width,e.height),n=i.data;for(let a=0;a<n.length;a++)n[a]=eh(n[a]/255)*255;return r.putImageData(i,0,0),t}else if(e.data){let t=e.data.slice(0);for(let r=0;r<t.length;r++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[r]=Math.floor(eh(t[r]/255)*255):t[r]=eh(t[r]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}},a8=class{constructor(e=null){this.isSource=!0,this.uuid=Uo(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){let t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];let r={uuid:this.uuid,url:""},i=this.data;if(i!==null){let n;if(Array.isArray(i)){n=[];for(let a=0,o=i.length;a<o;a++)i[a].isDataTexture?n.push(yC(i[a].image)):n.push(yC(i[a]))}else n=yC(i);r.url=n}return t||(e.images[this.uuid]=r),r}};function yC(e){return typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap?n8.getDataURL(e):e.data?{data:Array.from(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}var ixe=0,Ri=class extends ca{constructor(e=Ri.DEFAULT_IMAGE,t=Ri.DEFAULT_MAPPING,r=_i,i=_i,n=hr,a=zp,o=Ln,s=wa,l=Ri.DEFAULT_ANISOTROPY,c=xs){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:ixe++}),this.uuid=Uo(),this.name="",this.source=new a8(e),this.mipmaps=[],this.mapping=t,this.wrapS=r,this.wrapT=i,this.magFilter=n,this.minFilter=a,this.anisotropy=l,this.format=o,this.internalFormat=null,this.type=s,this.offset=new ye(0,0),this.repeat=new ye(1,1),this.center=new ye(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new cn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=c,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){let t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];let r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),t||(e.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==XV)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Zl:e.x=e.x-Math.floor(e.x);break;case _i:e.x=e.x<0?0:1;break;case fM:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Zl:e.y=e.y-Math.floor(e.y);break;case _i:e.y=e.y<0?0:1;break;case fM:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}};Ri.DEFAULT_IMAGE=null;Ri.DEFAULT_MAPPING=XV;Ri.DEFAULT_ANISOTROPY=1;var Qt=class{constructor(e=0,t=0,r=0,i=1){Qt.prototype.isVector4=!0,this.x=e,this.y=t,this.z=r,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,r,i){return this.x=e,this.y=t,this.z=r,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){let t=this.x,r=this.y,i=this.z,n=this.w,a=e.elements;return this.x=a[0]*t+a[4]*r+a[8]*i+a[12]*n,this.y=a[1]*t+a[5]*r+a[9]*i+a[13]*n,this.z=a[2]*t+a[6]*r+a[10]*i+a[14]*n,this.w=a[3]*t+a[7]*r+a[11]*i+a[15]*n,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);let t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,r,i,n,a=e.elements,o=a[0],s=a[4],l=a[8],c=a[1],u=a[5],d=a[9],h=a[2],f=a[6],p=a[10];if(Math.abs(s-c)<.01&&Math.abs(l-h)<.01&&Math.abs(d-f)<.01){if(Math.abs(s+c)<.1&&Math.abs(l+h)<.1&&Math.abs(d+f)<.1&&Math.abs(o+u+p-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;let m=(o+1)/2,g=(u+1)/2,y=(p+1)/2,b=(s+c)/4,x=(l+h)/4,S=(d+f)/4;return m>g&&m>y?m<.01?(r=0,i=.707106781,n=.707106781):(r=Math.sqrt(m),i=b/r,n=x/r):g>y?g<.01?(r=.707106781,i=0,n=.707106781):(i=Math.sqrt(g),r=b/i,n=S/i):y<.01?(r=.707106781,i=.707106781,n=0):(n=Math.sqrt(y),r=x/n,i=S/n),this.set(r,i,n,t),this}let v=Math.sqrt((f-d)*(f-d)+(l-h)*(l-h)+(c-s)*(c-s));return Math.abs(v)<.001&&(v=1),this.x=(f-d)/v,this.y=(l-h)/v,this.z=(c-s)/v,this.w=Math.acos((o+u+p-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){let r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this.w=e.w+(t.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}},jr=class extends ca{constructor(e=1,t=1,r={}){super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Qt(0,0,e,t),this.scissorTest=!1,this.viewport=new Qt(0,0,e,t);let i={width:e,height:t,depth:1};this.texture=new Ri(i,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=r.generateMipmaps!==void 0?r.generateMipmaps:!1,this.texture.internalFormat=r.internalFormat!==void 0?r.internalFormat:null,this.texture.minFilter=r.minFilter!==void 0?r.minFilter:hr,this.depthBuffer=r.depthBuffer!==void 0?r.depthBuffer:!0,this.stencilBuffer=r.stencilBuffer!==void 0?r.stencilBuffer:!1,this.depthTexture=r.depthTexture!==void 0?r.depthTexture:null,this.samples=r.samples!==void 0?r.samples:0}setSize(e,t,r=1){(this.width!==e||this.height!==t||this.depth!==r)&&(this.width=e,this.height=t,this.depth=r,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=r,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;let t=Object.assign({},e.texture.image);return this.texture.source=new a8(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}},o8=class extends Ri{constructor(e=null,t=1,r=1,i=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:r,depth:i},this.magFilter=Wr,this.minFilter=Wr,this.wrapR=_i,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},nxe=class extends Ri{constructor(e=null,t=1,r=1,i=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:r,depth:i},this.magFilter=Wr,this.minFilter=Wr,this.wrapR=_i,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},axe=class extends jr{constructor(e=1,t=1,r=1,i={}){super(e,t,i),this.isWebGLMultipleRenderTargets=!0;let n=this.texture;this.texture=[];for(let a=0;a<r;a++)this.texture[a]=n.clone(),this.texture[a].isRenderTargetTexture=!0}setSize(e,t,r=1){if(this.width!==e||this.height!==t||this.depth!==r){this.width=e,this.height=t,this.depth=r;for(let i=0,n=this.texture.length;i<n;i++)this.texture[i].image.width=e,this.texture[i].image.height=t,this.texture[i].image.depth=r;this.dispose()}return this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t),this}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.texture.length=0;for(let t=0,r=e.texture.length;t<r;t++)this.texture[t]=e.texture[t].clone(),this.texture[t].isRenderTargetTexture=!0;return this}},Kt=class{constructor(e=0,t=0,r=0,i=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=r,this._w=i}static slerpFlat(e,t,r,i,n,a,o){let s=r[i+0],l=r[i+1],c=r[i+2],u=r[i+3],d=n[a+0],h=n[a+1],f=n[a+2],p=n[a+3];if(o===0){e[t+0]=s,e[t+1]=l,e[t+2]=c,e[t+3]=u;return}if(o===1){e[t+0]=d,e[t+1]=h,e[t+2]=f,e[t+3]=p;return}if(u!==p||s!==d||l!==h||c!==f){let v=1-o,m=s*d+l*h+c*f+u*p,g=m>=0?1:-1,y=1-m*m;if(y>Number.EPSILON){let x=Math.sqrt(y),S=Math.atan2(x,m*g);v=Math.sin(v*S)/x,o=Math.sin(o*S)/x}let b=o*g;if(s=s*v+d*b,l=l*v+h*b,c=c*v+f*b,u=u*v+p*b,v===1-o){let x=1/Math.sqrt(s*s+l*l+c*c+u*u);s*=x,l*=x,c*=x,u*=x}}e[t]=s,e[t+1]=l,e[t+2]=c,e[t+3]=u}static multiplyQuaternionsFlat(e,t,r,i,n,a){let o=r[i],s=r[i+1],l=r[i+2],c=r[i+3],u=n[a],d=n[a+1],h=n[a+2],f=n[a+3];return e[t]=o*f+c*u+s*h-l*d,e[t+1]=s*f+c*d+l*u-o*h,e[t+2]=l*f+c*h+o*d-s*u,e[t+3]=c*f-o*u-s*d-l*h,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,r,i){return this._x=e,this._y=t,this._z=r,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){let r=e._x,i=e._y,n=e._z,a=e._order,o=Math.cos,s=Math.sin,l=o(r/2),c=o(i/2),u=o(n/2),d=s(r/2),h=s(i/2),f=s(n/2);switch(a){case"XYZ":this._x=d*c*u+l*h*f,this._y=l*h*u-d*c*f,this._z=l*c*f+d*h*u,this._w=l*c*u-d*h*f;break;case"YXZ":this._x=d*c*u+l*h*f,this._y=l*h*u-d*c*f,this._z=l*c*f-d*h*u,this._w=l*c*u+d*h*f;break;case"ZXY":this._x=d*c*u-l*h*f,this._y=l*h*u+d*c*f,this._z=l*c*f+d*h*u,this._w=l*c*u-d*h*f;break;case"ZYX":this._x=d*c*u-l*h*f,this._y=l*h*u+d*c*f,this._z=l*c*f-d*h*u,this._w=l*c*u+d*h*f;break;case"YZX":this._x=d*c*u+l*h*f,this._y=l*h*u+d*c*f,this._z=l*c*f-d*h*u,this._w=l*c*u-d*h*f;break;case"XZY":this._x=d*c*u-l*h*f,this._y=l*h*u-d*c*f,this._z=l*c*f+d*h*u,this._w=l*c*u+d*h*f;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return t!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,t){let r=t/2,i=Math.sin(r);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){let t=e.elements,r=t[0],i=t[4],n=t[8],a=t[1],o=t[5],s=t[9],l=t[2],c=t[6],u=t[10],d=r+o+u;if(d>0){let h=.5/Math.sqrt(d+1);this._w=.25/h,this._x=(c-s)*h,this._y=(n-l)*h,this._z=(a-i)*h}else if(r>o&&r>u){let h=2*Math.sqrt(1+r-o-u);this._w=(c-s)/h,this._x=.25*h,this._y=(i+a)/h,this._z=(n+l)/h}else if(o>u){let h=2*Math.sqrt(1+o-r-u);this._w=(n-l)/h,this._x=(i+a)/h,this._y=.25*h,this._z=(s+c)/h}else{let h=2*Math.sqrt(1+u-r-o);this._w=(a-i)/h,this._x=(n+l)/h,this._y=(s+c)/h,this._z=.25*h}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let r=e.dot(t)+1;return r<Number.EPSILON?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(an(this.dot(e),-1,1)))}rotateTowards(e,t){let r=this.angleTo(e);if(r===0)return this;let i=Math.min(1,t/r);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){let r=e._x,i=e._y,n=e._z,a=e._w,o=t._x,s=t._y,l=t._z,c=t._w;return this._x=r*c+a*o+i*l-n*s,this._y=i*c+a*s+n*o-r*l,this._z=n*c+a*l+r*s-i*o,this._w=a*c-r*o-i*s-n*l,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);let r=this._x,i=this._y,n=this._z,a=this._w,o=a*e._w+r*e._x+i*e._y+n*e._z;if(o<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),o>=1)return this._w=a,this._x=r,this._y=i,this._z=n,this;let s=1-o*o;if(s<=Number.EPSILON){let h=1-t;return this._w=h*a+t*this._w,this._x=h*r+t*this._x,this._y=h*i+t*this._y,this._z=h*n+t*this._z,this.normalize(),this._onChangeCallback(),this}let l=Math.sqrt(s),c=Math.atan2(l,o),u=Math.sin((1-t)*c)/l,d=Math.sin(t*c)/l;return this._w=a*u+this._w*d,this._x=r*u+this._x*d,this._y=i*u+this._y*d,this._z=n*u+this._z*d,this._onChangeCallback(),this}slerpQuaternions(e,t,r){return this.copy(e).slerp(t,r)}random(){let e=Math.random(),t=Math.sqrt(1-e),r=Math.sqrt(e),i=2*Math.PI*Math.random(),n=2*Math.PI*Math.random();return this.set(t*Math.cos(i),r*Math.sin(n),r*Math.cos(n),t*Math.sin(i))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}},k=class{constructor(e=0,t=0,r=0){k.prototype.isVector3=!0,this.x=e,this.y=t,this.z=r}set(e,t,r){return r===void 0&&(r=this.z),this.x=e,this.y=t,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(Rz.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(Rz.setFromAxisAngle(e,t))}applyMatrix3(e){let t=this.x,r=this.y,i=this.z,n=e.elements;return this.x=n[0]*t+n[3]*r+n[6]*i,this.y=n[1]*t+n[4]*r+n[7]*i,this.z=n[2]*t+n[5]*r+n[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){let t=this.x,r=this.y,i=this.z,n=e.elements,a=1/(n[3]*t+n[7]*r+n[11]*i+n[15]);return this.x=(n[0]*t+n[4]*r+n[8]*i+n[12])*a,this.y=(n[1]*t+n[5]*r+n[9]*i+n[13])*a,this.z=(n[2]*t+n[6]*r+n[10]*i+n[14])*a,this}applyQuaternion(e){let t=this.x,r=this.y,i=this.z,n=e.x,a=e.y,o=e.z,s=e.w,l=s*t+a*i-o*r,c=s*r+o*t-n*i,u=s*i+n*r-a*t,d=-n*t-a*r-o*i;return this.x=l*s+d*-n+c*-o-u*-a,this.y=c*s+d*-a+u*-n-l*-o,this.z=u*s+d*-o+l*-a-c*-n,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){let t=this.x,r=this.y,i=this.z,n=e.elements;return this.x=n[0]*t+n[4]*r+n[8]*i,this.y=n[1]*t+n[5]*r+n[9]*i,this.z=n[2]*t+n[6]*r+n[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){let r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){let r=e.x,i=e.y,n=e.z,a=t.x,o=t.y,s=t.z;return this.x=i*s-n*o,this.y=n*a-r*s,this.z=r*o-i*a,this}projectOnVector(e){let t=e.lengthSq();if(t===0)return this.set(0,0,0);let r=e.dot(this)/t;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return bC.copy(this).projectOnVector(e),this.sub(bC)}reflect(e){return this.sub(bC.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){let t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;let r=this.dot(e)/t;return Math.acos(an(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,r=this.y-e.y,i=this.z-e.z;return t*t+r*r+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,r){let i=Math.sin(t)*e;return this.x=i*Math.sin(r),this.y=Math.cos(t)*e,this.z=i*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,r){return this.x=e*Math.sin(t),this.y=r,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){let t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){let t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=r,this.z=i,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){let e=(Math.random()-.5)*2,t=Math.random()*Math.PI*2,r=Math.sqrt(1-e**2);return this.x=r*Math.cos(t),this.y=r*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}},bC=new k,Rz=new Kt,Ji=class{constructor(e=new k(1/0,1/0,1/0),t=new k(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,r=1/0,i=1/0,n=-1/0,a=-1/0,o=-1/0;for(let s=0,l=e.length;s<l;s+=3){let c=e[s],u=e[s+1],d=e[s+2];c<t&&(t=c),u<r&&(r=u),d<i&&(i=d),c>n&&(n=c),u>a&&(a=u),d>o&&(o=d)}return this.min.set(t,r,i),this.max.set(n,a,o),this}setFromBufferAttribute(e){let t=1/0,r=1/0,i=1/0,n=-1/0,a=-1/0,o=-1/0;for(let s=0,l=e.count;s<l;s++){let c=e.getX(s),u=e.getY(s),d=e.getZ(s);c<t&&(t=c),u<r&&(r=u),d<i&&(i=d),c>n&&(n=c),u>a&&(a=u),d>o&&(o=d)}return this.min.set(t,r,i),this.max.set(n,a,o),this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let r=od.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);let r=e.geometry;if(r!==void 0)if(t&&r.attributes!=null&&r.attributes.position!==void 0){let n=r.attributes.position;for(let a=0,o=n.count;a<o;a++)od.fromBufferAttribute(n,a).applyMatrix4(e.matrixWorld),this.expandByPoint(od)}else r.boundingBox===null&&r.computeBoundingBox(),xC.copy(r.boundingBox),xC.applyMatrix4(e.matrixWorld),this.union(xC);let i=e.children;for(let n=0,a=i.length;n<a;n++)this.expandByObject(i[n],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,od),od.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,r;return e.normal.x>0?(t=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),t<=-e.constant&&r>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Lm),ly.subVectors(this.max,Lm),Zh.subVectors(e.a,Lm),Jh.subVectors(e.b,Lm),ef.subVectors(e.c,Lm),Lc.subVectors(Jh,Zh),Bc.subVectors(ef,Jh),sd.subVectors(Zh,ef);let t=[0,-Lc.z,Lc.y,0,-Bc.z,Bc.y,0,-sd.z,sd.y,Lc.z,0,-Lc.x,Bc.z,0,-Bc.x,sd.z,0,-sd.x,-Lc.y,Lc.x,0,-Bc.y,Bc.x,0,-sd.y,sd.x,0];return!wC(t,Zh,Jh,ef,ly)||(t=[1,0,0,0,1,0,0,0,1],!wC(t,Zh,Jh,ef,ly))?!1:(cy.crossVectors(Lc,Bc),t=[cy.x,cy.y,cy.z],wC(t,Zh,Jh,ef,ly))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return od.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=this.getSize(od).length()*.5,e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(El[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),El[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),El[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),El[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),El[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),El[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),El[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),El[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(El),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}},El=[new k,new k,new k,new k,new k,new k,new k,new k],od=new k,xC=new Ji,Zh=new k,Jh=new k,ef=new k,Lc=new k,Bc=new k,sd=new k,Lm=new k,ly=new k,cy=new k,ld=new k;function wC(e,t,r,i,n){for(let a=0,o=e.length-3;a<=o;a+=3){ld.fromArray(e,a);let s=n.x*Math.abs(ld.x)+n.y*Math.abs(ld.y)+n.z*Math.abs(ld.z),l=t.dot(ld),c=r.dot(ld),u=i.dot(ld);if(Math.max(-Math.max(l,c,u),Math.min(l,c,u))>s)return!1}return!0}var oxe=new Ji,Bm=new k,SC=new k,ao=class{constructor(e=new k,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){let r=this.center;t!==void 0?r.copy(t):oxe.setFromPoints(e).getCenter(r);let i=0;for(let n=0,a=e.length;n<a;n++)i=Math.max(i,r.distanceToSquared(e[n]));return this.radius=Math.sqrt(i),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){let t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){let r=this.center.distanceToSquared(e);return t.copy(e),r>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Bm.subVectors(e,this.center);let t=Bm.lengthSq();if(t>this.radius*this.radius){let r=Math.sqrt(t),i=(r-this.radius)*.5;this.center.addScaledVector(Bm,i/r),this.radius+=i}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(SC.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Bm.copy(e.center).add(SC)),this.expandByPoint(Bm.copy(e.center).sub(SC))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}},Tl=new k,CC=new k,uy=new k,Fc=new k,_C=new k,dy=new k,AC=new k,om=class{constructor(e=new k,t=new k(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Tl)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);let r=t.dot(this.direction);return r<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(r).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){let t=Tl.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Tl.copy(this.direction).multiplyScalar(t).add(this.origin),Tl.distanceToSquared(e))}distanceSqToSegment(e,t,r,i){CC.copy(e).add(t).multiplyScalar(.5),uy.copy(t).sub(e).normalize(),Fc.copy(this.origin).sub(CC);let n=e.distanceTo(t)*.5,a=-this.direction.dot(uy),o=Fc.dot(this.direction),s=-Fc.dot(uy),l=Fc.lengthSq(),c=Math.abs(1-a*a),u,d,h,f;if(c>0)if(u=a*s-o,d=a*o-s,f=n*c,u>=0)if(d>=-f)if(d<=f){let p=1/c;u*=p,d*=p,h=u*(u+a*d+2*o)+d*(a*u+d+2*s)+l}else d=n,u=Math.max(0,-(a*d+o)),h=-u*u+d*(d+2*s)+l;else d=-n,u=Math.max(0,-(a*d+o)),h=-u*u+d*(d+2*s)+l;else d<=-f?(u=Math.max(0,-(-a*n+o)),d=u>0?-n:Math.min(Math.max(-n,-s),n),h=-u*u+d*(d+2*s)+l):d<=f?(u=0,d=Math.min(Math.max(-n,-s),n),h=d*(d+2*s)+l):(u=Math.max(0,-(a*n+o)),d=u>0?n:Math.min(Math.max(-n,-s),n),h=-u*u+d*(d+2*s)+l);else d=a>0?-n:n,u=Math.max(0,-(a*d+o)),h=-u*u+d*(d+2*s)+l;return r&&r.copy(this.direction).multiplyScalar(u).add(this.origin),i&&i.copy(uy).multiplyScalar(d).add(CC),h}intersectSphere(e,t){Tl.subVectors(e.center,this.origin);let r=Tl.dot(this.direction),i=Tl.dot(Tl)-r*r,n=e.radius*e.radius;if(i>n)return null;let a=Math.sqrt(n-i),o=r-a,s=r+a;return o<0&&s<0?null:o<0?this.at(s,t):this.at(o,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){let t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;let r=-(this.origin.dot(e.normal)+e.constant)/t;return r>=0?r:null}intersectPlane(e,t){let r=this.distanceToPlane(e);return r===null?null:this.at(r,t)}intersectsPlane(e){let t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let r,i,n,a,o,s,l=1/this.direction.x,c=1/this.direction.y,u=1/this.direction.z,d=this.origin;return l>=0?(r=(e.min.x-d.x)*l,i=(e.max.x-d.x)*l):(r=(e.max.x-d.x)*l,i=(e.min.x-d.x)*l),c>=0?(n=(e.min.y-d.y)*c,a=(e.max.y-d.y)*c):(n=(e.max.y-d.y)*c,a=(e.min.y-d.y)*c),r>a||n>i||((n>r||isNaN(r))&&(r=n),(a<i||isNaN(i))&&(i=a),u>=0?(o=(e.min.z-d.z)*u,s=(e.max.z-d.z)*u):(o=(e.max.z-d.z)*u,s=(e.min.z-d.z)*u),r>s||o>i)||((o>r||r!==r)&&(r=o),(s<i||i!==i)&&(i=s),i<0)?null:this.at(r>=0?r:i,t)}intersectsBox(e){return this.intersectBox(e,Tl)!==null}intersectTriangle(e,t,r,i,n){_C.subVectors(t,e),dy.subVectors(r,e),AC.crossVectors(_C,dy);let a=this.direction.dot(AC),o;if(a>0){if(i)return null;o=1}else if(a<0)o=-1,a=-a;else return null;Fc.subVectors(this.origin,e);let s=o*this.direction.dot(dy.crossVectors(Fc,dy));if(s<0)return null;let l=o*this.direction.dot(_C.cross(Fc));if(l<0||s+l>a)return null;let c=-o*Fc.dot(AC);return c<0?null:this.at(c/a,n)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}},it=class{constructor(){it.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(e,t,r,i,n,a,o,s,l,c,u,d,h,f,p,v){let m=this.elements;return m[0]=e,m[4]=t,m[8]=r,m[12]=i,m[1]=n,m[5]=a,m[9]=o,m[13]=s,m[2]=l,m[6]=c,m[10]=u,m[14]=d,m[3]=h,m[7]=f,m[11]=p,m[15]=v,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new it().fromArray(this.elements)}copy(e){let t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],this}copyPosition(e){let t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this}setFromMatrix3(e){let t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,r){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this}extractRotation(e){let t=this.elements,r=e.elements,i=1/tf.setFromMatrixColumn(e,0).length(),n=1/tf.setFromMatrixColumn(e,1).length(),a=1/tf.setFromMatrixColumn(e,2).length();return t[0]=r[0]*i,t[1]=r[1]*i,t[2]=r[2]*i,t[3]=0,t[4]=r[4]*n,t[5]=r[5]*n,t[6]=r[6]*n,t[7]=0,t[8]=r[8]*a,t[9]=r[9]*a,t[10]=r[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){let t=this.elements,r=e.x,i=e.y,n=e.z,a=Math.cos(r),o=Math.sin(r),s=Math.cos(i),l=Math.sin(i),c=Math.cos(n),u=Math.sin(n);if(e.order==="XYZ"){let d=a*c,h=a*u,f=o*c,p=o*u;t[0]=s*c,t[4]=-s*u,t[8]=l,t[1]=h+f*l,t[5]=d-p*l,t[9]=-o*s,t[2]=p-d*l,t[6]=f+h*l,t[10]=a*s}else if(e.order==="YXZ"){let d=s*c,h=s*u,f=l*c,p=l*u;t[0]=d+p*o,t[4]=f*o-h,t[8]=a*l,t[1]=a*u,t[5]=a*c,t[9]=-o,t[2]=h*o-f,t[6]=p+d*o,t[10]=a*s}else if(e.order==="ZXY"){let d=s*c,h=s*u,f=l*c,p=l*u;t[0]=d-p*o,t[4]=-a*u,t[8]=f+h*o,t[1]=h+f*o,t[5]=a*c,t[9]=p-d*o,t[2]=-a*l,t[6]=o,t[10]=a*s}else if(e.order==="ZYX"){let d=a*c,h=a*u,f=o*c,p=o*u;t[0]=s*c,t[4]=f*l-h,t[8]=d*l+p,t[1]=s*u,t[5]=p*l+d,t[9]=h*l-f,t[2]=-l,t[6]=o*s,t[10]=a*s}else if(e.order==="YZX"){let d=a*s,h=a*l,f=o*s,p=o*l;t[0]=s*c,t[4]=p-d*u,t[8]=f*u+h,t[1]=u,t[5]=a*c,t[9]=-o*c,t[2]=-l*c,t[6]=h*u+f,t[10]=d-p*u}else if(e.order==="XZY"){let d=a*s,h=a*l,f=o*s,p=o*l;t[0]=s*c,t[4]=-u,t[8]=l*c,t[1]=d*u+p,t[5]=a*c,t[9]=h*u-f,t[2]=f*u-h,t[6]=o*c,t[10]=p*u+d}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(sxe,e,lxe)}lookAt(e,t,r){let i=this.elements;return uo.subVectors(e,t),uo.lengthSq()===0&&(uo.z=1),uo.normalize(),Nc.crossVectors(r,uo),Nc.lengthSq()===0&&(Math.abs(r.z)===1?uo.x+=1e-4:uo.z+=1e-4,uo.normalize(),Nc.crossVectors(r,uo)),Nc.normalize(),hy.crossVectors(uo,Nc),i[0]=Nc.x,i[4]=hy.x,i[8]=uo.x,i[1]=Nc.y,i[5]=hy.y,i[9]=uo.y,i[2]=Nc.z,i[6]=hy.z,i[10]=uo.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let r=e.elements,i=t.elements,n=this.elements,a=r[0],o=r[4],s=r[8],l=r[12],c=r[1],u=r[5],d=r[9],h=r[13],f=r[2],p=r[6],v=r[10],m=r[14],g=r[3],y=r[7],b=r[11],x=r[15],S=i[0],w=i[4],_=i[8],C=i[12],A=i[1],M=i[5],P=i[9],T=i[13],R=i[2],z=i[6],F=i[10],H=i[14],N=i[3],U=i[7],ie=i[11],te=i[15];return n[0]=a*S+o*A+s*R+l*N,n[4]=a*w+o*M+s*z+l*U,n[8]=a*_+o*P+s*F+l*ie,n[12]=a*C+o*T+s*H+l*te,n[1]=c*S+u*A+d*R+h*N,n[5]=c*w+u*M+d*z+h*U,n[9]=c*_+u*P+d*F+h*ie,n[13]=c*C+u*T+d*H+h*te,n[2]=f*S+p*A+v*R+m*N,n[6]=f*w+p*M+v*z+m*U,n[10]=f*_+p*P+v*F+m*ie,n[14]=f*C+p*T+v*H+m*te,n[3]=g*S+y*A+b*R+x*N,n[7]=g*w+y*M+b*z+x*U,n[11]=g*_+y*P+b*F+x*ie,n[15]=g*C+y*T+b*H+x*te,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){let e=this.elements,t=e[0],r=e[4],i=e[8],n=e[12],a=e[1],o=e[5],s=e[9],l=e[13],c=e[2],u=e[6],d=e[10],h=e[14],f=e[3],p=e[7],v=e[11],m=e[15];return f*(+n*s*u-i*l*u-n*o*d+r*l*d+i*o*h-r*s*h)+p*(+t*s*h-t*l*d+n*a*d-i*a*h+i*l*c-n*s*c)+v*(+t*l*u-t*o*h-n*a*u+r*a*h+n*o*c-r*l*c)+m*(-i*o*c-t*s*u+t*o*d+i*a*u-r*a*d+r*s*c)}transpose(){let e=this.elements,t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,r){let i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=t,i[14]=r),this}invert(){let e=this.elements,t=e[0],r=e[1],i=e[2],n=e[3],a=e[4],o=e[5],s=e[6],l=e[7],c=e[8],u=e[9],d=e[10],h=e[11],f=e[12],p=e[13],v=e[14],m=e[15],g=u*v*l-p*d*l+p*s*h-o*v*h-u*s*m+o*d*m,y=f*d*l-c*v*l-f*s*h+a*v*h+c*s*m-a*d*m,b=c*p*l-f*u*l+f*o*h-a*p*h-c*o*m+a*u*m,x=f*u*s-c*p*s-f*o*d+a*p*d+c*o*v-a*u*v,S=t*g+r*y+i*b+n*x;if(S===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let w=1/S;return e[0]=g*w,e[1]=(p*d*n-u*v*n-p*i*h+r*v*h+u*i*m-r*d*m)*w,e[2]=(o*v*n-p*s*n+p*i*l-r*v*l-o*i*m+r*s*m)*w,e[3]=(u*s*n-o*d*n-u*i*l+r*d*l+o*i*h-r*s*h)*w,e[4]=y*w,e[5]=(c*v*n-f*d*n+f*i*h-t*v*h-c*i*m+t*d*m)*w,e[6]=(f*s*n-a*v*n-f*i*l+t*v*l+a*i*m-t*s*m)*w,e[7]=(a*d*n-c*s*n+c*i*l-t*d*l-a*i*h+t*s*h)*w,e[8]=b*w,e[9]=(f*u*n-c*p*n-f*r*h+t*p*h+c*r*m-t*u*m)*w,e[10]=(a*p*n-f*o*n+f*r*l-t*p*l-a*r*m+t*o*m)*w,e[11]=(c*o*n-a*u*n-c*r*l+t*u*l+a*r*h-t*o*h)*w,e[12]=x*w,e[13]=(c*p*i-f*u*i+f*r*d-t*p*d-c*r*v+t*u*v)*w,e[14]=(f*o*i-a*p*i-f*r*s+t*p*s+a*r*v-t*o*v)*w,e[15]=(a*u*i-c*o*i+c*r*s-t*u*s-a*r*d+t*o*d)*w,this}scale(e){let t=this.elements,r=e.x,i=e.y,n=e.z;return t[0]*=r,t[4]*=i,t[8]*=n,t[1]*=r,t[5]*=i,t[9]*=n,t[2]*=r,t[6]*=i,t[10]*=n,t[3]*=r,t[7]*=i,t[11]*=n,this}getMaxScaleOnAxis(){let e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,r,i))}makeTranslation(e,t,r){return this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this}makeRotationX(e){let t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this}makeRotationY(e){let t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this}makeRotationZ(e){let t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){let r=Math.cos(t),i=Math.sin(t),n=1-r,a=e.x,o=e.y,s=e.z,l=n*a,c=n*o;return this.set(l*a+r,l*o-i*s,l*s+i*o,0,l*o+i*s,c*o+r,c*s-i*a,0,l*s-i*o,c*s+i*a,n*s*s+r,0,0,0,0,1),this}makeScale(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,t,r,i,n,a){return this.set(1,r,n,0,e,1,a,0,t,i,1,0,0,0,0,1),this}compose(e,t,r){let i=this.elements,n=t._x,a=t._y,o=t._z,s=t._w,l=n+n,c=a+a,u=o+o,d=n*l,h=n*c,f=n*u,p=a*c,v=a*u,m=o*u,g=s*l,y=s*c,b=s*u,x=r.x,S=r.y,w=r.z;return i[0]=(1-(p+m))*x,i[1]=(h+b)*x,i[2]=(f-y)*x,i[3]=0,i[4]=(h-b)*S,i[5]=(1-(d+m))*S,i[6]=(v+g)*S,i[7]=0,i[8]=(f+y)*w,i[9]=(v-g)*w,i[10]=(1-(d+p))*w,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}decompose(e,t,r){let i=this.elements,n=tf.set(i[0],i[1],i[2]).length(),a=tf.set(i[4],i[5],i[6]).length(),o=tf.set(i[8],i[9],i[10]).length();this.determinant()<0&&(n=-n),e.x=i[12],e.y=i[13],e.z=i[14],Ko.copy(this);let s=1/n,l=1/a,c=1/o;return Ko.elements[0]*=s,Ko.elements[1]*=s,Ko.elements[2]*=s,Ko.elements[4]*=l,Ko.elements[5]*=l,Ko.elements[6]*=l,Ko.elements[8]*=c,Ko.elements[9]*=c,Ko.elements[10]*=c,t.setFromRotationMatrix(Ko),r.x=n,r.y=a,r.z=o,this}makePerspective(e,t,r,i,n,a){let o=this.elements,s=2*n/(t-e),l=2*n/(r-i),c=(t+e)/(t-e),u=(r+i)/(r-i),d=-(a+n)/(a-n),h=-2*a*n/(a-n);return o[0]=s,o[4]=0,o[8]=c,o[12]=0,o[1]=0,o[5]=l,o[9]=u,o[13]=0,o[2]=0,o[6]=0,o[10]=d,o[14]=h,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this}makeOrthographic(e,t,r,i,n,a){let o=this.elements,s=1/(t-e),l=1/(r-i),c=1/(a-n),u=(t+e)*s,d=(r+i)*l,h=(a+n)*c;return o[0]=2*s,o[4]=0,o[8]=0,o[12]=-u,o[1]=0,o[5]=2*l,o[9]=0,o[13]=-d,o[2]=0,o[6]=0,o[10]=-2*c,o[14]=-h,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this}equals(e){let t=this.elements,r=e.elements;for(let i=0;i<16;i++)if(t[i]!==r[i])return!1;return!0}fromArray(e,t=0){for(let r=0;r<16;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){let r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e}},tf=new k,Ko=new it,sxe=new k(0,0,0),lxe=new k(1,1,1),Nc=new k,hy=new k,uo=new k,Iz=new it,zz=new Kt,bn=class{constructor(e=0,t=0,r=0,i=bn.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=r,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,r,i=this._order){return this._x=e,this._y=t,this._z=r,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,r=!0){let i=e.elements,n=i[0],a=i[4],o=i[8],s=i[1],l=i[5],c=i[9],u=i[2],d=i[6],h=i[10];switch(t){case"XYZ":this._y=Math.asin(an(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-c,h),this._z=Math.atan2(-a,n)):(this._x=Math.atan2(d,l),this._z=0);break;case"YXZ":this._x=Math.asin(-an(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(o,h),this._z=Math.atan2(s,l)):(this._y=Math.atan2(-u,n),this._z=0);break;case"ZXY":this._x=Math.asin(an(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-u,h),this._z=Math.atan2(-a,l)):(this._y=0,this._z=Math.atan2(s,n));break;case"ZYX":this._y=Math.asin(-an(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(d,h),this._z=Math.atan2(s,n)):(this._x=0,this._z=Math.atan2(-a,l));break;case"YZX":this._z=Math.asin(an(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-u,n)):(this._x=0,this._y=Math.atan2(o,h));break;case"XZY":this._z=Math.asin(-an(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(d,l),this._y=Math.atan2(o,n)):(this._x=Math.atan2(-c,h),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,r===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,r){return Iz.makeRotationFromQuaternion(e),this.setFromRotationMatrix(Iz,t,r)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return zz.setFromEuler(this),this.setFromQuaternion(zz,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}};bn.DEFAULT_ORDER="XYZ";var VP=class{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}},cxe=0,kz=new k,rf=new Kt,Pl=new it,fy=new k,Fm=new k,uxe=new k,dxe=new Kt,Lz=new k(1,0,0),Bz=new k(0,1,0),Fz=new k(0,0,1),hxe={type:"added"},Nz={type:"removed"},Xr=class extends ca{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:cxe++}),this.uuid=Uo(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Xr.DEFAULT_UP.clone();let e=new k,t=new bn,r=new Kt,i=new k(1,1,1);function n(){r.setFromEuler(t,!1)}function a(){t.setFromQuaternion(r,void 0,!1)}t._onChange(n),r._onChange(a),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new it},normalMatrix:{value:new cn}}),this.matrix=new it,this.matrixWorld=new it,this.matrixAutoUpdate=Xr.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=Xr.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new VP,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return rf.setFromAxisAngle(e,t),this.quaternion.multiply(rf),this}rotateOnWorldAxis(e,t){return rf.setFromAxisAngle(e,t),this.quaternion.premultiply(rf),this}rotateX(e){return this.rotateOnAxis(Lz,e)}rotateY(e){return this.rotateOnAxis(Bz,e)}rotateZ(e){return this.rotateOnAxis(Fz,e)}translateOnAxis(e,t){return kz.copy(e).applyQuaternion(this.quaternion),this.position.add(kz.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(Lz,e)}translateY(e){return this.translateOnAxis(Bz,e)}translateZ(e){return this.translateOnAxis(Fz,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Pl.copy(this.matrixWorld).invert())}lookAt(e,t,r){e.isVector3?fy.copy(e):fy.set(e,t,r);let i=this.parent;this.updateWorldMatrix(!0,!1),Fm.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Pl.lookAt(Fm,fy,this.up):Pl.lookAt(fy,Fm,this.up),this.quaternion.setFromRotationMatrix(Pl),i&&(Pl.extractRotation(i.matrixWorld),rf.setFromRotationMatrix(Pl),this.quaternion.premultiply(rf.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(hxe)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}let t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(Nz)),this}removeFromParent(){let e=this.parent;return e!==null&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){let t=this.children[e];t.parent=null,t.dispatchEvent(Nz)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),Pl.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Pl.multiply(e.parent.matrixWorld)),e.applyMatrix4(Pl),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let r=0,i=this.children.length;r<i;r++){let n=this.children[r].getObjectByProperty(e,t);if(n!==void 0)return n}}getObjectsByProperty(e,t){let r=[];this[e]===t&&r.push(this);for(let i=0,n=this.children.length;i<n;i++){let a=this.children[i].getObjectsByProperty(e,t);a.length>0&&(r=r.concat(a))}return r}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Fm,e,uxe),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Fm,dxe,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);let t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);let t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);let t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].traverseVisible(e)}traverseAncestors(e){let t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);let t=this.children;for(let r=0,i=t.length;r<i;r++){let n=t[r];(n.matrixWorldAutoUpdate===!0||e===!0)&&n.updateMatrixWorld(e)}}updateWorldMatrix(e,t){let r=this.parent;if(e===!0&&r!==null&&r.matrixWorldAutoUpdate===!0&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){let i=this.children;for(let n=0,a=i.length;n<a;n++){let o=i[n];o.matrixWorldAutoUpdate===!0&&o.updateWorldMatrix(!1,!0)}}}toJSON(e){let t=e===void 0||typeof e=="string",r={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});let i={};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.castShadow===!0&&(i.castShadow=!0),this.receiveShadow===!0&&(i.receiveShadow=!0),this.visible===!1&&(i.visible=!1),this.frustumCulled===!1&&(i.frustumCulled=!1),this.renderOrder!==0&&(i.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(i.instanceColor=this.instanceColor.toJSON()));function n(o,s){return o[s.uuid]===void 0&&(o[s.uuid]=s.toJSON(e)),s.uuid}if(this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(i.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=n(e.geometries,this.geometry);let o=this.geometry.parameters;if(o!==void 0&&o.shapes!==void 0){let s=o.shapes;if(Array.isArray(s))for(let l=0,c=s.length;l<c;l++){let u=s[l];n(e.shapes,u)}else n(e.shapes,s)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(n(e.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){let o=[];for(let s=0,l=this.material.length;s<l;s++)o.push(n(e.materials,this.material[s]));i.material=o}else i.material=n(e.materials,this.material);if(this.children.length>0){i.children=[];for(let o=0;o<this.children.length;o++)i.children.push(this.children[o].toJSON(e).object)}if(this.animations.length>0){i.animations=[];for(let o=0;o<this.animations.length;o++){let s=this.animations[o];i.animations.push(n(e.animations,s))}}if(t){let o=a(e.geometries),s=a(e.materials),l=a(e.textures),c=a(e.images),u=a(e.shapes),d=a(e.skeletons),h=a(e.animations),f=a(e.nodes);o.length>0&&(r.geometries=o),s.length>0&&(r.materials=s),l.length>0&&(r.textures=l),c.length>0&&(r.images=c),u.length>0&&(r.shapes=u),d.length>0&&(r.skeletons=d),h.length>0&&(r.animations=h),f.length>0&&(r.nodes=f)}return r.object=i,r;function a(o){let s=[];for(let l in o){let c=o[l];delete c.metadata,s.push(c)}return s}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let r=0;r<e.children.length;r++){let i=e.children[r];this.add(i.clone())}return this}};Xr.DEFAULT_UP=new k(0,1,0);Xr.DEFAULT_MATRIX_AUTO_UPDATE=!0;Xr.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;var Qo=new k,Dl=new k,MC=new k,Ol=new k,nf=new k,af=new k,Uz=new k,EC=new k,TC=new k,PC=new k,ta=class{constructor(e=new k,t=new k,r=new k){this.a=e,this.b=t,this.c=r}static getNormal(e,t,r,i){i.subVectors(r,t),Qo.subVectors(e,t),i.cross(Qo);let n=i.lengthSq();return n>0?i.multiplyScalar(1/Math.sqrt(n)):i.set(0,0,0)}static getBarycoord(e,t,r,i,n){Qo.subVectors(i,t),Dl.subVectors(r,t),MC.subVectors(e,t);let a=Qo.dot(Qo),o=Qo.dot(Dl),s=Qo.dot(MC),l=Dl.dot(Dl),c=Dl.dot(MC),u=a*l-o*o;if(u===0)return n.set(-2,-1,-1);let d=1/u,h=(l*s-o*c)*d,f=(a*c-o*s)*d;return n.set(1-h-f,f,h)}static containsPoint(e,t,r,i){return this.getBarycoord(e,t,r,i,Ol),Ol.x>=0&&Ol.y>=0&&Ol.x+Ol.y<=1}static getUV(e,t,r,i,n,a,o,s){return this.getBarycoord(e,t,r,i,Ol),s.set(0,0),s.addScaledVector(n,Ol.x),s.addScaledVector(a,Ol.y),s.addScaledVector(o,Ol.z),s}static isFrontFacing(e,t,r,i){return Qo.subVectors(r,t),Dl.subVectors(e,t),Qo.cross(Dl).dot(i)<0}set(e,t,r){return this.a.copy(e),this.b.copy(t),this.c.copy(r),this}setFromPointsAndIndices(e,t,r,i){return this.a.copy(e[t]),this.b.copy(e[r]),this.c.copy(e[i]),this}setFromAttributeAndIndices(e,t,r,i){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,r),this.c.fromBufferAttribute(e,i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Qo.subVectors(this.c,this.b),Dl.subVectors(this.a,this.b),Qo.cross(Dl).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return ta.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return ta.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,r,i,n){return ta.getUV(e,this.a,this.b,this.c,t,r,i,n)}containsPoint(e){return ta.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return ta.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){let r=this.a,i=this.b,n=this.c,a,o;nf.subVectors(i,r),af.subVectors(n,r),EC.subVectors(e,r);let s=nf.dot(EC),l=af.dot(EC);if(s<=0&&l<=0)return t.copy(r);TC.subVectors(e,i);let c=nf.dot(TC),u=af.dot(TC);if(c>=0&&u<=c)return t.copy(i);let d=s*u-c*l;if(d<=0&&s>=0&&c<=0)return a=s/(s-c),t.copy(r).addScaledVector(nf,a);PC.subVectors(e,n);let h=nf.dot(PC),f=af.dot(PC);if(f>=0&&h<=f)return t.copy(n);let p=h*l-s*f;if(p<=0&&l>=0&&f<=0)return o=l/(l-f),t.copy(r).addScaledVector(af,o);let v=c*f-h*u;if(v<=0&&u-c>=0&&h-f>=0)return Uz.subVectors(n,i),o=(u-c)/(u-c+(h-f)),t.copy(i).addScaledVector(Uz,o);let m=1/(v+p+d);return a=p*m,o=d*m,t.copy(r).addScaledVector(nf,a).addScaledVector(af,o)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}},fxe=0,m0=class extends ca{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:fxe++}),this.uuid=Uo(),this.name="",this.type="Material",this.blending=Qd,this.side=bs,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=$V,this.blendDst=qV,this.blendEquation=Rf,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=uM,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=jbe,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=pC,this.stencilZFail=pC,this.stencilZPass=pC,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(let t in e){let r=e[t];if(r===void 0){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}let i=this[t];if(i===void 0){console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.");continue}i&&i.isColor?i.set(r):i&&i.isVector3&&r&&r.isVector3?i.copy(r):this[t]=r}}toJSON(e){let t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});let r={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),this.roughness!==void 0&&(r.roughness=this.roughness),this.metalness!==void 0&&(r.metalness=this.metalness),this.sheen!==void 0&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(r.shininess=this.shininess),this.clearcoat!==void 0&&(r.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(r.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(r.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(r.combine=this.combine)),this.envMapIntensity!==void 0&&(r.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(r.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(r.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(r.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(r.size=this.size),this.shadowSide!==null&&(r.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==Qd&&(r.blending=this.blending),this.side!==bs&&(r.side=this.side),this.vertexColors&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),this.transparent===!0&&(r.transparent=this.transparent),r.depthFunc=this.depthFunc,r.depthTest=this.depthTest,r.depthWrite=this.depthWrite,r.colorWrite=this.colorWrite,r.stencilWrite=this.stencilWrite,r.stencilWriteMask=this.stencilWriteMask,r.stencilFunc=this.stencilFunc,r.stencilRef=this.stencilRef,r.stencilFuncMask=this.stencilFuncMask,r.stencilFail=this.stencilFail,r.stencilZFail=this.stencilZFail,r.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(r.rotation=this.rotation),this.polygonOffset===!0&&(r.polygonOffset=!0),this.polygonOffsetFactor!==0&&(r.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(r.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(r.linewidth=this.linewidth),this.dashSize!==void 0&&(r.dashSize=this.dashSize),this.gapSize!==void 0&&(r.gapSize=this.gapSize),this.scale!==void 0&&(r.scale=this.scale),this.dithering===!0&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(r.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(r.premultipliedAlpha=this.premultipliedAlpha),this.forceSinglePass===!0&&(r.forceSinglePass=this.forceSinglePass),this.wireframe===!0&&(r.wireframe=this.wireframe),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(r.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(r.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(r.flatShading=this.flatShading),this.visible===!1&&(r.visible=!1),this.toneMapped===!1&&(r.toneMapped=!1),this.fog===!1&&(r.fog=!1),Object.keys(this.userData).length>0&&(r.userData=this.userData);function i(n){let a=[];for(let o in n){let s=n[o];delete s.metadata,a.push(s)}return a}if(t){let n=i(e.textures),a=i(e.images);n.length>0&&(r.textures=n),a.length>0&&(r.images=a)}return r}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;let t=e.clippingPlanes,r=null;if(t!==null){let i=t.length;r=new Array(i);for(let n=0;n!==i;++n)r[n]=t[n].clone()}return this.clippingPlanes=r,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}},hc=class extends m0{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Bt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=YV,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}},tn=new k,py=new ye,qt=class{constructor(e,t,r=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=r,this.usage=pM,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,r){e*=this.itemSize,r*=t.itemSize;for(let i=0,n=this.itemSize;i<n;i++)this.array[e+i]=t.array[r+i];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,r=this.count;t<r;t++)py.fromBufferAttribute(this,t),py.applyMatrix3(e),this.setXY(t,py.x,py.y);else if(this.itemSize===3)for(let t=0,r=this.count;t<r;t++)tn.fromBufferAttribute(this,t),tn.applyMatrix3(e),this.setXYZ(t,tn.x,tn.y,tn.z);return this}applyMatrix4(e){for(let t=0,r=this.count;t<r;t++)tn.fromBufferAttribute(this,t),tn.applyMatrix4(e),this.setXYZ(t,tn.x,tn.y,tn.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)tn.fromBufferAttribute(this,t),tn.applyNormalMatrix(e),this.setXYZ(t,tn.x,tn.y,tn.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)tn.fromBufferAttribute(this,t),tn.transformDirection(e),this.setXYZ(t,tn.x,tn.y,tn.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=ec(t,this.array)),t}setX(e,t){return this.normalized&&(t=di(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=ec(t,this.array)),t}setY(e,t){return this.normalized&&(t=di(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=ec(t,this.array)),t}setZ(e,t){return this.normalized&&(t=di(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=ec(t,this.array)),t}setW(e,t){return this.normalized&&(t=di(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,r){return e*=this.itemSize,this.normalized&&(t=di(t,this.array),r=di(r,this.array)),this.array[e+0]=t,this.array[e+1]=r,this}setXYZ(e,t,r,i){return e*=this.itemSize,this.normalized&&(t=di(t,this.array),r=di(r,this.array),i=di(i,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=i,this}setXYZW(e,t,r,i,n){return e*=this.itemSize,this.normalized&&(t=di(t,this.array),r=di(r,this.array),i=di(i,this.array),n=di(n,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=i,this.array[e+3]=n,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){let e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==pM&&(e.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(e.updateRange=this.updateRange),e}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}},s8=class extends qt{constructor(e,t,r){super(new Uint16Array(e),t,r)}},ap=class extends qt{constructor(e,t,r){super(new Uint32Array(e),t,r)}},yt=class extends qt{constructor(e,t,r){super(new Float32Array(e),t,r)}},pxe=0,So=new it,DC=new Xr,of=new k,ho=new Ji,Nm=new Ji,Tn=new k,Ot=class extends ca{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:pxe++}),this.uuid=Uo(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(r8(e)?ap:s8)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,r=0){this.groups.push({start:e,count:t,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){let t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);let r=this.attributes.normal;if(r!==void 0){let n=new cn().getNormalMatrix(e);r.applyNormalMatrix(n),r.needsUpdate=!0}let i=this.attributes.tangent;return i!==void 0&&(i.transformDirection(e),i.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return So.makeRotationFromQuaternion(e),this.applyMatrix4(So),this}rotateX(e){return So.makeRotationX(e),this.applyMatrix4(So),this}rotateY(e){return So.makeRotationY(e),this.applyMatrix4(So),this}rotateZ(e){return So.makeRotationZ(e),this.applyMatrix4(So),this}translate(e,t,r){return So.makeTranslation(e,t,r),this.applyMatrix4(So),this}scale(e,t,r){return So.makeScale(e,t,r),this.applyMatrix4(So),this}lookAt(e){return DC.lookAt(e),DC.updateMatrix(),this.applyMatrix4(DC.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(of).negate(),this.translate(of.x,of.y,of.z),this}setFromPoints(e){let t=[];for(let r=0,i=e.length;r<i;r++){let n=e[r];t.push(n.x,n.y,n.z||0)}return this.setAttribute("position",new yt(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Ji);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new k(-1/0,-1/0,-1/0),new k(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let r=0,i=t.length;r<i;r++){let n=t[r];ho.setFromBufferAttribute(n),this.morphTargetsRelative?(Tn.addVectors(this.boundingBox.min,ho.min),this.boundingBox.expandByPoint(Tn),Tn.addVectors(this.boundingBox.max,ho.max),this.boundingBox.expandByPoint(Tn)):(this.boundingBox.expandByPoint(ho.min),this.boundingBox.expandByPoint(ho.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new ao);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new k,1/0);return}if(e){let r=this.boundingSphere.center;if(ho.setFromBufferAttribute(e),t)for(let n=0,a=t.length;n<a;n++){let o=t[n];Nm.setFromBufferAttribute(o),this.morphTargetsRelative?(Tn.addVectors(ho.min,Nm.min),ho.expandByPoint(Tn),Tn.addVectors(ho.max,Nm.max),ho.expandByPoint(Tn)):(ho.expandByPoint(Nm.min),ho.expandByPoint(Nm.max))}ho.getCenter(r);let i=0;for(let n=0,a=e.count;n<a;n++)Tn.fromBufferAttribute(e,n),i=Math.max(i,r.distanceToSquared(Tn));if(t)for(let n=0,a=t.length;n<a;n++){let o=t[n],s=this.morphTargetsRelative;for(let l=0,c=o.count;l<c;l++)Tn.fromBufferAttribute(o,l),s&&(of.fromBufferAttribute(e,l),Tn.add(of)),i=Math.max(i,r.distanceToSquared(Tn))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){let e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}let r=e.array,i=t.position.array,n=t.normal.array,a=t.uv.array,o=i.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new qt(new Float32Array(4*o),4));let s=this.getAttribute("tangent").array,l=[],c=[];for(let A=0;A<o;A++)l[A]=new k,c[A]=new k;let u=new k,d=new k,h=new k,f=new ye,p=new ye,v=new ye,m=new k,g=new k;function y(A,M,P){u.fromArray(i,A*3),d.fromArray(i,M*3),h.fromArray(i,P*3),f.fromArray(a,A*2),p.fromArray(a,M*2),v.fromArray(a,P*2),d.sub(u),h.sub(u),p.sub(f),v.sub(f);let T=1/(p.x*v.y-v.x*p.y);!isFinite(T)||(m.copy(d).multiplyScalar(v.y).addScaledVector(h,-p.y).multiplyScalar(T),g.copy(h).multiplyScalar(p.x).addScaledVector(d,-v.x).multiplyScalar(T),l[A].add(m),l[M].add(m),l[P].add(m),c[A].add(g),c[M].add(g),c[P].add(g))}let b=this.groups;b.length===0&&(b=[{start:0,count:r.length}]);for(let A=0,M=b.length;A<M;++A){let P=b[A],T=P.start,R=P.count;for(let z=T,F=T+R;z<F;z+=3)y(r[z+0],r[z+1],r[z+2])}let x=new k,S=new k,w=new k,_=new k;function C(A){w.fromArray(n,A*3),_.copy(w);let M=l[A];x.copy(M),x.sub(w.multiplyScalar(w.dot(M))).normalize(),S.crossVectors(_,M);let P=S.dot(c[A])<0?-1:1;s[A*4]=x.x,s[A*4+1]=x.y,s[A*4+2]=x.z,s[A*4+3]=P}for(let A=0,M=b.length;A<M;++A){let P=b[A],T=P.start,R=P.count;for(let z=T,F=T+R;z<F;z+=3)C(r[z+0]),C(r[z+1]),C(r[z+2])}}computeVertexNormals(){let e=this.index,t=this.getAttribute("position");if(t!==void 0){let r=this.getAttribute("normal");if(r===void 0)r=new qt(new Float32Array(t.count*3),3),this.setAttribute("normal",r);else for(let d=0,h=r.count;d<h;d++)r.setXYZ(d,0,0,0);let i=new k,n=new k,a=new k,o=new k,s=new k,l=new k,c=new k,u=new k;if(e)for(let d=0,h=e.count;d<h;d+=3){let f=e.getX(d+0),p=e.getX(d+1),v=e.getX(d+2);i.fromBufferAttribute(t,f),n.fromBufferAttribute(t,p),a.fromBufferAttribute(t,v),c.subVectors(a,n),u.subVectors(i,n),c.cross(u),o.fromBufferAttribute(r,f),s.fromBufferAttribute(r,p),l.fromBufferAttribute(r,v),o.add(c),s.add(c),l.add(c),r.setXYZ(f,o.x,o.y,o.z),r.setXYZ(p,s.x,s.y,s.z),r.setXYZ(v,l.x,l.y,l.z)}else for(let d=0,h=t.count;d<h;d+=3)i.fromBufferAttribute(t,d+0),n.fromBufferAttribute(t,d+1),a.fromBufferAttribute(t,d+2),c.subVectors(a,n),u.subVectors(i,n),c.cross(u),r.setXYZ(d+0,c.x,c.y,c.z),r.setXYZ(d+1,c.x,c.y,c.z),r.setXYZ(d+2,c.x,c.y,c.z);this.normalizeNormals(),r.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeBufferGeometries() instead."),this}normalizeNormals(){let e=this.attributes.normal;for(let t=0,r=e.count;t<r;t++)Tn.fromBufferAttribute(e,t),Tn.normalize(),e.setXYZ(t,Tn.x,Tn.y,Tn.z)}toNonIndexed(){function e(o,s){let l=o.array,c=o.itemSize,u=o.normalized,d=new l.constructor(s.length*c),h=0,f=0;for(let p=0,v=s.length;p<v;p++){o.isInterleavedBufferAttribute?h=s[p]*o.data.stride+o.offset:h=s[p]*c;for(let m=0;m<c;m++)d[f++]=l[h++]}return new qt(d,c,u)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;let t=new Ot,r=this.index.array,i=this.attributes;for(let o in i){let s=i[o],l=e(s,r);t.setAttribute(o,l)}let n=this.morphAttributes;for(let o in n){let s=[],l=n[o];for(let c=0,u=l.length;c<u;c++){let d=l[c],h=e(d,r);s.push(h)}t.morphAttributes[o]=s}t.morphTargetsRelative=this.morphTargetsRelative;let a=this.groups;for(let o=0,s=a.length;o<s;o++){let l=a[o];t.addGroup(l.start,l.count,l.materialIndex)}return t}toJSON(){let e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){let s=this.parameters;for(let l in s)s[l]!==void 0&&(e[l]=s[l]);return e}e.data={attributes:{}};let t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});let r=this.attributes;for(let s in r){let l=r[s];e.data.attributes[s]=l.toJSON(e.data)}let i={},n=!1;for(let s in this.morphAttributes){let l=this.morphAttributes[s],c=[];for(let u=0,d=l.length;u<d;u++){let h=l[u];c.push(h.toJSON(e.data))}c.length>0&&(i[s]=c,n=!0)}n&&(e.data.morphAttributes=i,e.data.morphTargetsRelative=this.morphTargetsRelative);let a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));let o=this.boundingSphere;return o!==null&&(e.data.boundingSphere={center:o.center.toArray(),radius:o.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;let t={};this.name=e.name;let r=e.index;r!==null&&this.setIndex(r.clone(t));let i=e.attributes;for(let l in i){let c=i[l];this.setAttribute(l,c.clone(t))}let n=e.morphAttributes;for(let l in n){let c=[],u=n[l];for(let d=0,h=u.length;d<h;d++)c.push(u[d].clone(t));this.morphAttributes[l]=c}this.morphTargetsRelative=e.morphTargetsRelative;let a=e.groups;for(let l=0,c=a.length;l<c;l++){let u=a[l];this.addGroup(u.start,u.count,u.materialIndex)}let o=e.boundingBox;o!==null&&(this.boundingBox=o.clone());let s=e.boundingSphere;return s!==null&&(this.boundingSphere=s.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,e.parameters!==void 0&&(this.parameters=Object.assign({},e.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}},jz=new it,sf=new om,OC=new ao,Um=new k,jm=new k,Vm=new k,RC=new k,my=new k,vy=new ye,gy=new ye,yy=new ye,IC=new k,by=new k,Oi=class extends Xr{constructor(e=new Ot,t=new hc){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){let e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){let r=e[t[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let i=0,n=r.length;i<n;i++){let a=r[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=i}}}}getVertexPosition(e,t){let r=this.geometry,i=r.attributes.position,n=r.morphAttributes.position,a=r.morphTargetsRelative;t.fromBufferAttribute(i,e);let o=this.morphTargetInfluences;if(n&&o){my.set(0,0,0);for(let s=0,l=n.length;s<l;s++){let c=o[s],u=n[s];c!==0&&(RC.fromBufferAttribute(u,e),a?my.addScaledVector(RC,c):my.addScaledVector(RC.sub(t),c))}t.add(my)}return this.isSkinnedMesh&&this.boneTransform(e,t),t}raycast(e,t){let r=this.geometry,i=this.material,n=this.matrixWorld;if(i===void 0||(r.boundingSphere===null&&r.computeBoundingSphere(),OC.copy(r.boundingSphere),OC.applyMatrix4(n),e.ray.intersectsSphere(OC)===!1)||(jz.copy(n).invert(),sf.copy(e.ray).applyMatrix4(jz),r.boundingBox!==null&&sf.intersectsBox(r.boundingBox)===!1))return;let a,o=r.index,s=r.attributes.position,l=r.attributes.uv,c=r.attributes.uv2,u=r.groups,d=r.drawRange;if(o!==null)if(Array.isArray(i))for(let h=0,f=u.length;h<f;h++){let p=u[h],v=i[p.materialIndex],m=Math.max(p.start,d.start),g=Math.min(o.count,Math.min(p.start+p.count,d.start+d.count));for(let y=m,b=g;y<b;y+=3){let x=o.getX(y),S=o.getX(y+1),w=o.getX(y+2);a=xy(this,v,e,sf,l,c,x,S,w),a&&(a.faceIndex=Math.floor(y/3),a.face.materialIndex=p.materialIndex,t.push(a))}}else{let h=Math.max(0,d.start),f=Math.min(o.count,d.start+d.count);for(let p=h,v=f;p<v;p+=3){let m=o.getX(p),g=o.getX(p+1),y=o.getX(p+2);a=xy(this,i,e,sf,l,c,m,g,y),a&&(a.faceIndex=Math.floor(p/3),t.push(a))}}else if(s!==void 0)if(Array.isArray(i))for(let h=0,f=u.length;h<f;h++){let p=u[h],v=i[p.materialIndex],m=Math.max(p.start,d.start),g=Math.min(s.count,Math.min(p.start+p.count,d.start+d.count));for(let y=m,b=g;y<b;y+=3){let x=y,S=y+1,w=y+2;a=xy(this,v,e,sf,l,c,x,S,w),a&&(a.faceIndex=Math.floor(y/3),a.face.materialIndex=p.materialIndex,t.push(a))}}else{let h=Math.max(0,d.start),f=Math.min(s.count,d.start+d.count);for(let p=h,v=f;p<v;p+=3){let m=p,g=p+1,y=p+2;a=xy(this,i,e,sf,l,c,m,g,y),a&&(a.faceIndex=Math.floor(p/3),t.push(a))}}}};function mxe(e,t,r,i,n,a,o,s){let l;if(t.side===Nn?l=i.intersectTriangle(o,a,n,!0,s):l=i.intersectTriangle(n,a,o,t.side===bs,s),l===null)return null;by.copy(s),by.applyMatrix4(e.matrixWorld);let c=r.ray.origin.distanceTo(by);return c<r.near||c>r.far?null:{distance:c,point:by.clone(),object:e}}function xy(e,t,r,i,n,a,o,s,l){e.getVertexPosition(o,Um),e.getVertexPosition(s,jm),e.getVertexPosition(l,Vm);let c=mxe(e,t,r,i,Um,jm,Vm,IC);if(c){n&&(vy.fromBufferAttribute(n,o),gy.fromBufferAttribute(n,s),yy.fromBufferAttribute(n,l),c.uv=ta.getUV(IC,Um,jm,Vm,vy,gy,yy,new ye)),a&&(vy.fromBufferAttribute(a,o),gy.fromBufferAttribute(a,s),yy.fromBufferAttribute(a,l),c.uv2=ta.getUV(IC,Um,jm,Vm,vy,gy,yy,new ye));let u={a:o,b:s,c:l,normal:new k,materialIndex:0};ta.getNormal(Um,jm,Vm,u.normal),c.face=u}return c}var ws=class extends Ot{constructor(e=1,t=1,r=1,i=1,n=1,a=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:i,heightSegments:n,depthSegments:a};let o=this;i=Math.floor(i),n=Math.floor(n),a=Math.floor(a);let s=[],l=[],c=[],u=[],d=0,h=0;f("z","y","x",-1,-1,r,t,e,a,n,0),f("z","y","x",1,-1,r,t,-e,a,n,1),f("x","z","y",1,1,e,r,t,i,a,2),f("x","z","y",1,-1,e,r,-t,i,a,3),f("x","y","z",1,-1,e,t,r,i,n,4),f("x","y","z",-1,-1,e,t,-r,i,n,5),this.setIndex(s),this.setAttribute("position",new yt(l,3)),this.setAttribute("normal",new yt(c,3)),this.setAttribute("uv",new yt(u,2));function f(p,v,m,g,y,b,x,S,w,_,C){let A=b/w,M=x/_,P=b/2,T=x/2,R=S/2,z=w+1,F=_+1,H=0,N=0,U=new k;for(let ie=0;ie<F;ie++){let te=ie*M-T;for(let X=0;X<z;X++){let W=X*A-P;U[p]=W*g,U[v]=te*y,U[m]=R,l.push(U.x,U.y,U.z),U[p]=0,U[v]=0,U[m]=S>0?1:-1,c.push(U.x,U.y,U.z),u.push(X/w),u.push(1-ie/_),H+=1}}for(let ie=0;ie<_;ie++)for(let te=0;te<w;te++){let X=d+te+z*ie,W=d+te+z*(ie+1),q=d+(te+1)+z*(ie+1),$=d+(te+1)+z*ie;s.push(X,W,$),s.push(W,q,$),N+=6}o.addGroup(h,N,C),h+=N,d+=H}}static fromJSON(e){return new ws(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}};function kp(e){let t={};for(let r in e){t[r]={};for(let i in e[r]){let n=e[r][i];n&&(n.isColor||n.isMatrix3||n.isMatrix4||n.isVector2||n.isVector3||n.isVector4||n.isTexture||n.isQuaternion)?t[r][i]=n.clone():Array.isArray(n)?t[r][i]=n.slice():t[r][i]=n}}return t}function Ta(e){let t={};for(let r=0;r<e.length;r++){let i=kp(e[r]);for(let n in i)t[n]=i[n]}return t}function vxe(e){let t=[];for(let r=0;r<e.length;r++)t.push(e[r].clone());return t}function l8(e){return e.getRenderTarget()===null&&e.outputEncoding===lr?Hs:jx}var sm={clone:kp,merge:Ta},gxe=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,yxe=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,Vr=class extends m0{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=gxe,this.fragmentShader=yxe,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=kp(e.uniforms),this.uniformsGroups=vxe(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){let t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(let i in this.uniforms){let n=this.uniforms[i].value;n&&n.isTexture?t.uniforms[i]={type:"t",value:n.toJSON(e).uuid}:n&&n.isColor?t.uniforms[i]={type:"c",value:n.getHex()}:n&&n.isVector2?t.uniforms[i]={type:"v2",value:n.toArray()}:n&&n.isVector3?t.uniforms[i]={type:"v3",value:n.toArray()}:n&&n.isVector4?t.uniforms[i]={type:"v4",value:n.toArray()}:n&&n.isMatrix3?t.uniforms[i]={type:"m3",value:n.toArray()}:n&&n.isMatrix4?t.uniforms[i]={type:"m4",value:n.toArray()}:t.uniforms[i]={value:n}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;let r={};for(let i in this.extensions)this.extensions[i]===!0&&(r[i]=!0);return Object.keys(r).length>0&&(t.extensions=r),t}},Rh=class extends Xr{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new it,this.projectionMatrix=new it,this.projectionMatrixInverse=new it}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);let t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}},pa=class extends Rh{constructor(e=50,t=1,r=.1,i=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=r,this.far=i,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){let t=.5*this.getFilmHeight()/e;this.fov=Eg*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){let e=Math.tan(Hv*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return Eg*2*Math.atan(Math.tan(Hv*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,r,i,n,a){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=i,this.view.width=n,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=this.near,t=e*Math.tan(Hv*.5*this.fov)/this.zoom,r=2*t,i=this.aspect*r,n=-.5*i,a=this.view;if(this.view!==null&&this.view.enabled){let s=a.fullWidth,l=a.fullHeight;n+=a.offsetX*i/s,t-=a.offsetY*r/l,i*=a.width/s,r*=a.height/l}let o=this.filmOffset;o!==0&&(n+=e*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(n,n+i,t,t-r,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}},lf=-90,cf=1,bxe=class extends Xr{constructor(e,t,r){super(),this.type="CubeCamera",this.renderTarget=r;let i=new pa(lf,cf,e,t);i.layers=this.layers,i.up.set(0,1,0),i.lookAt(1,0,0),this.add(i);let n=new pa(lf,cf,e,t);n.layers=this.layers,n.up.set(0,1,0),n.lookAt(-1,0,0),this.add(n);let a=new pa(lf,cf,e,t);a.layers=this.layers,a.up.set(0,0,-1),a.lookAt(0,1,0),this.add(a);let o=new pa(lf,cf,e,t);o.layers=this.layers,o.up.set(0,0,1),o.lookAt(0,-1,0),this.add(o);let s=new pa(lf,cf,e,t);s.layers=this.layers,s.up.set(0,1,0),s.lookAt(0,0,1),this.add(s);let l=new pa(lf,cf,e,t);l.layers=this.layers,l.up.set(0,1,0),l.lookAt(0,0,-1),this.add(l)}update(e,t){this.parent===null&&this.updateMatrixWorld();let r=this.renderTarget,[i,n,a,o,s,l]=this.children,c=e.getRenderTarget(),u=e.toneMapping,d=e.xr.enabled;e.toneMapping=sl,e.xr.enabled=!1;let h=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0),e.render(t,i),e.setRenderTarget(r,1),e.render(t,n),e.setRenderTarget(r,2),e.render(t,a),e.setRenderTarget(r,3),e.render(t,o),e.setRenderTarget(r,4),e.render(t,s),r.texture.generateMipmaps=h,e.setRenderTarget(r,5),e.render(t,l),e.setRenderTarget(c),e.toneMapping=u,e.xr.enabled=d,r.texture.needsPMREMUpdate=!0}},HP=class extends Ri{constructor(e,t,r,i,n,a,o,s,l,c){e=e!==void 0?e:[],t=t!==void 0?t:fh,super(e,t,r,i,n,a,o,s,l,c),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}},xxe=class extends jr{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;let r={width:e,height:e,depth:1},i=[r,r,r,r,r,r];this.texture=new HP(i,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:hr}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;let r={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},i=new ws(5,5,5),n=new Vr({name:"CubemapFromEquirect",uniforms:kp(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:Nn,blending:un});n.uniforms.tEquirect.value=t;let a=new Oi(i,n),o=t.minFilter;return t.minFilter===zp&&(t.minFilter=hr),new bxe(1,10,this).update(e,a),t.minFilter=o,a.geometry.dispose(),a.material.dispose(),this}clear(e,t,r,i){let n=e.getRenderTarget();for(let a=0;a<6;a++)e.setRenderTarget(this,a),e.clear(t,r,i);e.setRenderTarget(n)}},zC=new k,wxe=new k,Sxe=new cn,Ya=class{constructor(e=new k(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,r,i){return this.normal.set(e,t,r),this.constant=i,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,r){let i=zC.subVectors(r,t).cross(wxe.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){let e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){let r=e.delta(zC),i=this.normal.dot(r);if(i===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;let n=-(e.start.dot(this.normal)+this.constant)/i;return n<0||n>1?null:t.copy(r).multiplyScalar(n).add(e.start)}intersectsLine(e){let t=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return t<0&&r>0||r<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){let r=t||Sxe.getNormalMatrix(e),i=this.coplanarPoint(zC).applyMatrix4(e),n=this.normal.applyMatrix3(r).normalize();return this.constant=-i.dot(n),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}},uf=new ao,wy=new k,WP=class{constructor(e=new Ya,t=new Ya,r=new Ya,i=new Ya,n=new Ya,a=new Ya){this.planes=[e,t,r,i,n,a]}set(e,t,r,i,n,a){let o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(r),o[3].copy(i),o[4].copy(n),o[5].copy(a),this}copy(e){let t=this.planes;for(let r=0;r<6;r++)t[r].copy(e.planes[r]);return this}setFromProjectionMatrix(e){let t=this.planes,r=e.elements,i=r[0],n=r[1],a=r[2],o=r[3],s=r[4],l=r[5],c=r[6],u=r[7],d=r[8],h=r[9],f=r[10],p=r[11],v=r[12],m=r[13],g=r[14],y=r[15];return t[0].setComponents(o-i,u-s,p-d,y-v).normalize(),t[1].setComponents(o+i,u+s,p+d,y+v).normalize(),t[2].setComponents(o+n,u+l,p+h,y+m).normalize(),t[3].setComponents(o-n,u-l,p-h,y-m).normalize(),t[4].setComponents(o-a,u-c,p-f,y-g).normalize(),t[5].setComponents(o+a,u+c,p+f,y+g).normalize(),this}intersectsObject(e){let t=e.geometry;return t.boundingSphere===null&&t.computeBoundingSphere(),uf.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(uf)}intersectsSprite(e){return uf.center.set(0,0,0),uf.radius=.7071067811865476,uf.applyMatrix4(e.matrixWorld),this.intersectsSphere(uf)}intersectsSphere(e){let t=this.planes,r=e.center,i=-e.radius;for(let n=0;n<6;n++)if(t[n].distanceToPoint(r)<i)return!1;return!0}intersectsBox(e){let t=this.planes;for(let r=0;r<6;r++){let i=t[r];if(wy.x=i.normal.x>0?e.max.x:e.min.x,wy.y=i.normal.y>0?e.max.y:e.min.y,wy.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(wy)<0)return!1}return!0}containsPoint(e){let t=this.planes;for(let r=0;r<6;r++)if(t[r].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}};function c8(){let e=null,t=!1,r=null,i=null;function n(a,o){r(a,o),i=e.requestAnimationFrame(n)}return{start:function(){t!==!0&&r!==null&&(i=e.requestAnimationFrame(n),t=!0)},stop:function(){e.cancelAnimationFrame(i),t=!1},setAnimationLoop:function(a){r=a},setContext:function(a){e=a}}}function Cxe(e,t){let r=t.isWebGL2,i=new WeakMap;function n(c,u){let d=c.array,h=c.usage,f=e.createBuffer();e.bindBuffer(u,f),e.bufferData(u,d,h),c.onUploadCallback();let p;if(d instanceof Float32Array)p=5126;else if(d instanceof Uint16Array)if(c.isFloat16BufferAttribute)if(r)p=5131;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else p=5123;else if(d instanceof Int16Array)p=5122;else if(d instanceof Uint32Array)p=5125;else if(d instanceof Int32Array)p=5124;else if(d instanceof Int8Array)p=5120;else if(d instanceof Uint8Array)p=5121;else if(d instanceof Uint8ClampedArray)p=5121;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+d);return{buffer:f,type:p,bytesPerElement:d.BYTES_PER_ELEMENT,version:c.version}}function a(c,u,d){let h=u.array,f=u.updateRange;e.bindBuffer(d,c),f.count===-1?e.bufferSubData(d,0,h):(r?e.bufferSubData(d,f.offset*h.BYTES_PER_ELEMENT,h,f.offset,f.count):e.bufferSubData(d,f.offset*h.BYTES_PER_ELEMENT,h.subarray(f.offset,f.offset+f.count)),f.count=-1),u.onUploadCallback()}function o(c){return c.isInterleavedBufferAttribute&&(c=c.data),i.get(c)}function s(c){c.isInterleavedBufferAttribute&&(c=c.data);let u=i.get(c);u&&(e.deleteBuffer(u.buffer),i.delete(c))}function l(c,u){if(c.isGLBufferAttribute){let h=i.get(c);(!h||h.version<c.version)&&i.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version});return}c.isInterleavedBufferAttribute&&(c=c.data);let d=i.get(c);d===void 0?i.set(c,n(c,u)):d.version<c.version&&(a(d.buffer,c,u),d.version=c.version)}return{get:o,remove:s,update:l}}var fc=class extends Ot{constructor(e=1,t=1,r=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:i};let n=e/2,a=t/2,o=Math.floor(r),s=Math.floor(i),l=o+1,c=s+1,u=e/o,d=t/s,h=[],f=[],p=[],v=[];for(let m=0;m<c;m++){let g=m*d-a;for(let y=0;y<l;y++){let b=y*u-n;f.push(b,-g,0),p.push(0,0,1),v.push(y/o),v.push(1-m/s)}}for(let m=0;m<s;m++)for(let g=0;g<o;g++){let y=g+l*m,b=g+l*(m+1),x=g+1+l*(m+1),S=g+1+l*m;h.push(y,b,S),h.push(b,x,S)}this.setIndex(h),this.setAttribute("position",new yt(f,3)),this.setAttribute("normal",new yt(p,3)),this.setAttribute("uv",new yt(v,2))}static fromJSON(e){return new fc(e.width,e.height,e.widthSegments,e.heightSegments)}},_xe=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,Axe=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Mxe=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,Exe=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,Txe=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,Pxe=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,Dxe="vec3 transformed = vec3( position );",Oxe=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,Rxe=`vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( V * D );
}
#ifdef USE_IRIDESCENCE
	vec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = mix( F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif`,Ixe=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			 return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float R21 = R12;
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,zxe=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = dFdx( surf_pos.xyz );
		vec3 vSigmaY = dFdy( surf_pos.xyz );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,kxe=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,Lxe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,Bxe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,Fxe=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,Nxe=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,Uxe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,jxe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,Vxe=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,Hxe=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,Wxe=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_v0 0.339
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_v1 0.276
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_v4 0.046
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_v5 0.016
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_v6 0.0038
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,Gxe=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,$xe=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,qxe=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,Yxe=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,Xxe=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,Kxe="gl_FragColor = linearToOutputTexel( gl_FragColor );",Qxe=`vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,Zxe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,Jxe=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,e1e=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,t1e=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,r1e=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,i1e=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,n1e=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,a1e=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,o1e=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,s1e=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,l1e=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vUv2 );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,c1e=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,u1e=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,d1e=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,h1e=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( PHYSICALLY_CORRECT_LIGHTS )
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#else
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,f1e=`#if defined( USE_ENVMAP )
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
#endif`,p1e=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,m1e=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,v1e=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,g1e=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,y1e=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULARINTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;
		#endif
		#ifdef USE_SPECULARCOLORMAP
			specularColorFactor *= texture2D( specularColorMap, vUv ).rgb;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEENCOLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEENROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;
	#endif
#endif`,b1e=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
	#endif
	#ifdef USE_IRIDESCENCE
		reflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );
	#else
		reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,x1e=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometry.viewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,w1e=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry.normal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,S1e=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,C1e=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,_1e=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,A1e=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,M1e=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,E1e=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,T1e=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,P1e=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,D1e=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,O1e=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,R1e=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,I1e=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,z1e=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,k1e=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,L1e=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,B1e=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,F1e=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,N1e=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,U1e=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,j1e=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,V1e=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );
		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );
	}
#endif`,H1e=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,W1e=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );
	#endif
#endif`,G1e=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,$1e=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,q1e=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha + 0.1;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,Y1e=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,X1e=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,K1e=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,Q1e=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,Z1e=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,J1e=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,ewe=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,twe=`#if NUM_SPOT_LIGHT_COORDS > 0
  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
  uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,rwe=`#if NUM_SPOT_LIGHT_COORDS > 0
  uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,iwe=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,nwe=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,awe=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,owe=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;
	mat4 getBoneMatrix( const in float i ) {
		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );
		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );
		y = dy * ( y + 0.5 );
		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
		mat4 bone = mat4( v1, v2, v3, v4 );
		return bone;
	}
#endif`,swe=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,lwe=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,cwe=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,uwe=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,dwe=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,hwe=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,fwe=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmission = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );
#endif`,pwe=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		#ifdef texture2DLodEXT
			return texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#else
			return texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#endif
	}
	vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return radiance;
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance * radiance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );
	}
#endif`,mwe=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,vwe=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,gwe=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,ywe=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,bwe=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,xwe=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,wwe=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,Swe=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,Cwe=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,_we=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Awe=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,Mwe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Ewe=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,Twe=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,Pwe=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,Dwe=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,Owe=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,Rwe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,Iwe=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,zwe=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,kwe=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Lwe=`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,Bwe=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Fwe=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Nwe=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Uwe=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,jwe=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Vwe=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,Hwe=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,Wwe=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Gwe=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,$we=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,qwe=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULARINTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
	#ifdef USE_SPECULARCOLORMAP
		uniform sampler2D specularColorMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEENCOLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEENROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;
	#endif
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Ywe=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Xwe=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Kwe=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,Qwe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Zwe=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Jwe=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,eSe=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,tSe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,cr={alphamap_fragment:_xe,alphamap_pars_fragment:Axe,alphatest_fragment:Mxe,alphatest_pars_fragment:Exe,aomap_fragment:Txe,aomap_pars_fragment:Pxe,begin_vertex:Dxe,beginnormal_vertex:Oxe,bsdfs:Rxe,iridescence_fragment:Ixe,bumpmap_pars_fragment:zxe,clipping_planes_fragment:kxe,clipping_planes_pars_fragment:Lxe,clipping_planes_pars_vertex:Bxe,clipping_planes_vertex:Fxe,color_fragment:Nxe,color_pars_fragment:Uxe,color_pars_vertex:jxe,color_vertex:Vxe,common:Hxe,cube_uv_reflection_fragment:Wxe,defaultnormal_vertex:Gxe,displacementmap_pars_vertex:$xe,displacementmap_vertex:qxe,emissivemap_fragment:Yxe,emissivemap_pars_fragment:Xxe,encodings_fragment:Kxe,encodings_pars_fragment:Qxe,envmap_fragment:Zxe,envmap_common_pars_fragment:Jxe,envmap_pars_fragment:e1e,envmap_pars_vertex:t1e,envmap_physical_pars_fragment:f1e,envmap_vertex:r1e,fog_vertex:i1e,fog_pars_vertex:n1e,fog_fragment:a1e,fog_pars_fragment:o1e,gradientmap_pars_fragment:s1e,lightmap_fragment:l1e,lightmap_pars_fragment:c1e,lights_lambert_fragment:u1e,lights_lambert_pars_fragment:d1e,lights_pars_begin:h1e,lights_toon_fragment:p1e,lights_toon_pars_fragment:m1e,lights_phong_fragment:v1e,lights_phong_pars_fragment:g1e,lights_physical_fragment:y1e,lights_physical_pars_fragment:b1e,lights_fragment_begin:x1e,lights_fragment_maps:w1e,lights_fragment_end:S1e,logdepthbuf_fragment:C1e,logdepthbuf_pars_fragment:_1e,logdepthbuf_pars_vertex:A1e,logdepthbuf_vertex:M1e,map_fragment:E1e,map_pars_fragment:T1e,map_particle_fragment:P1e,map_particle_pars_fragment:D1e,metalnessmap_fragment:O1e,metalnessmap_pars_fragment:R1e,morphcolor_vertex:I1e,morphnormal_vertex:z1e,morphtarget_pars_vertex:k1e,morphtarget_vertex:L1e,normal_fragment_begin:B1e,normal_fragment_maps:F1e,normal_pars_fragment:N1e,normal_pars_vertex:U1e,normal_vertex:j1e,normalmap_pars_fragment:V1e,clearcoat_normal_fragment_begin:H1e,clearcoat_normal_fragment_maps:W1e,clearcoat_pars_fragment:G1e,iridescence_pars_fragment:$1e,output_fragment:q1e,packing:Y1e,premultiplied_alpha_fragment:X1e,project_vertex:K1e,dithering_fragment:Q1e,dithering_pars_fragment:Z1e,roughnessmap_fragment:J1e,roughnessmap_pars_fragment:ewe,shadowmap_pars_fragment:twe,shadowmap_pars_vertex:rwe,shadowmap_vertex:iwe,shadowmask_pars_fragment:nwe,skinbase_vertex:awe,skinning_pars_vertex:owe,skinning_vertex:swe,skinnormal_vertex:lwe,specularmap_fragment:cwe,specularmap_pars_fragment:uwe,tonemapping_fragment:dwe,tonemapping_pars_fragment:hwe,transmission_fragment:fwe,transmission_pars_fragment:pwe,uv_pars_fragment:mwe,uv_pars_vertex:vwe,uv_vertex:gwe,uv2_pars_fragment:ywe,uv2_pars_vertex:bwe,uv2_vertex:xwe,worldpos_vertex:wwe,background_vert:Swe,background_frag:Cwe,backgroundCube_vert:_we,backgroundCube_frag:Awe,cube_vert:Mwe,cube_frag:Ewe,depth_vert:Twe,depth_frag:Pwe,distanceRGBA_vert:Dwe,distanceRGBA_frag:Owe,equirect_vert:Rwe,equirect_frag:Iwe,linedashed_vert:zwe,linedashed_frag:kwe,meshbasic_vert:Lwe,meshbasic_frag:Bwe,meshlambert_vert:Fwe,meshlambert_frag:Nwe,meshmatcap_vert:Uwe,meshmatcap_frag:jwe,meshnormal_vert:Vwe,meshnormal_frag:Hwe,meshphong_vert:Wwe,meshphong_frag:Gwe,meshphysical_vert:$we,meshphysical_frag:qwe,meshtoon_vert:Ywe,meshtoon_frag:Xwe,points_vert:Kwe,points_frag:Qwe,shadow_vert:Zwe,shadow_frag:Jwe,sprite_vert:eSe,sprite_frag:tSe},ft={common:{diffuse:{value:new Bt(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new cn},uv2Transform:{value:new cn},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new ye(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Bt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Bt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new cn}},sprite:{diffuse:{value:new Bt(16777215)},opacity:{value:1},center:{value:new ye(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new cn}}},$s={basic:{uniforms:Ta([ft.common,ft.specularmap,ft.envmap,ft.aomap,ft.lightmap,ft.fog]),vertexShader:cr.meshbasic_vert,fragmentShader:cr.meshbasic_frag},lambert:{uniforms:Ta([ft.common,ft.specularmap,ft.envmap,ft.aomap,ft.lightmap,ft.emissivemap,ft.bumpmap,ft.normalmap,ft.displacementmap,ft.fog,ft.lights,{emissive:{value:new Bt(0)}}]),vertexShader:cr.meshlambert_vert,fragmentShader:cr.meshlambert_frag},phong:{uniforms:Ta([ft.common,ft.specularmap,ft.envmap,ft.aomap,ft.lightmap,ft.emissivemap,ft.bumpmap,ft.normalmap,ft.displacementmap,ft.fog,ft.lights,{emissive:{value:new Bt(0)},specular:{value:new Bt(1118481)},shininess:{value:30}}]),vertexShader:cr.meshphong_vert,fragmentShader:cr.meshphong_frag},standard:{uniforms:Ta([ft.common,ft.envmap,ft.aomap,ft.lightmap,ft.emissivemap,ft.bumpmap,ft.normalmap,ft.displacementmap,ft.roughnessmap,ft.metalnessmap,ft.fog,ft.lights,{emissive:{value:new Bt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:cr.meshphysical_vert,fragmentShader:cr.meshphysical_frag},toon:{uniforms:Ta([ft.common,ft.aomap,ft.lightmap,ft.emissivemap,ft.bumpmap,ft.normalmap,ft.displacementmap,ft.gradientmap,ft.fog,ft.lights,{emissive:{value:new Bt(0)}}]),vertexShader:cr.meshtoon_vert,fragmentShader:cr.meshtoon_frag},matcap:{uniforms:Ta([ft.common,ft.bumpmap,ft.normalmap,ft.displacementmap,ft.fog,{matcap:{value:null}}]),vertexShader:cr.meshmatcap_vert,fragmentShader:cr.meshmatcap_frag},points:{uniforms:Ta([ft.points,ft.fog]),vertexShader:cr.points_vert,fragmentShader:cr.points_frag},dashed:{uniforms:Ta([ft.common,ft.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:cr.linedashed_vert,fragmentShader:cr.linedashed_frag},depth:{uniforms:Ta([ft.common,ft.displacementmap]),vertexShader:cr.depth_vert,fragmentShader:cr.depth_frag},normal:{uniforms:Ta([ft.common,ft.bumpmap,ft.normalmap,ft.displacementmap,{opacity:{value:1}}]),vertexShader:cr.meshnormal_vert,fragmentShader:cr.meshnormal_frag},sprite:{uniforms:Ta([ft.sprite,ft.fog]),vertexShader:cr.sprite_vert,fragmentShader:cr.sprite_frag},background:{uniforms:{uvTransform:{value:new cn},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:cr.background_vert,fragmentShader:cr.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:cr.backgroundCube_vert,fragmentShader:cr.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:cr.cube_vert,fragmentShader:cr.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:cr.equirect_vert,fragmentShader:cr.equirect_frag},distanceRGBA:{uniforms:Ta([ft.common,ft.displacementmap,{referencePosition:{value:new k},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:cr.distanceRGBA_vert,fragmentShader:cr.distanceRGBA_frag},shadow:{uniforms:Ta([ft.lights,ft.fog,{color:{value:new Bt(0)},opacity:{value:1}}]),vertexShader:cr.shadow_vert,fragmentShader:cr.shadow_frag}};$s.physical={uniforms:Ta([$s.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new ye(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new Bt(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new ye},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new Bt(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new Bt(1,1,1)},specularColorMap:{value:null}}]),vertexShader:cr.meshphysical_vert,fragmentShader:cr.meshphysical_frag};var Sy={r:0,b:0,g:0};function rSe(e,t,r,i,n,a,o){let s=new Bt(0),l=a===!0?0:1,c,u,d=null,h=0,f=null;function p(m,g){let y=!1,b=g.isScene===!0?g.background:null;b&&b.isTexture&&(b=(g.backgroundBlurriness>0?r:t).get(b));let x=e.xr,S=x.getSession&&x.getSession();S&&S.environmentBlendMode==="additive"&&(b=null),b===null?v(s,l):b&&b.isColor&&(v(b,1),y=!0),(e.autoClear||y)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),b&&(b.isCubeTexture||b.mapping===p0)?(u===void 0&&(u=new Oi(new ws(1,1,1),new Vr({name:"BackgroundCubeMaterial",uniforms:kp($s.backgroundCube.uniforms),vertexShader:$s.backgroundCube.vertexShader,fragmentShader:$s.backgroundCube.fragmentShader,side:Nn,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),u.geometry.deleteAttribute("uv"),u.onBeforeRender=function(w,_,C){this.matrixWorld.copyPosition(C.matrixWorld)},Object.defineProperty(u.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),n.update(u)),u.material.uniforms.envMap.value=b,u.material.uniforms.flipEnvMap.value=b.isCubeTexture&&b.isRenderTargetTexture===!1?-1:1,u.material.uniforms.backgroundBlurriness.value=g.backgroundBlurriness,u.material.uniforms.backgroundIntensity.value=g.backgroundIntensity,u.material.toneMapped=b.encoding!==lr,(d!==b||h!==b.version||f!==e.toneMapping)&&(u.material.needsUpdate=!0,d=b,h=b.version,f=e.toneMapping),u.layers.enableAll(),m.unshift(u,u.geometry,u.material,0,0,null)):b&&b.isTexture&&(c===void 0&&(c=new Oi(new fc(2,2),new Vr({name:"BackgroundMaterial",uniforms:kp($s.background.uniforms),vertexShader:$s.background.vertexShader,fragmentShader:$s.background.fragmentShader,side:bs,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),n.update(c)),c.material.uniforms.t2D.value=b,c.material.uniforms.backgroundIntensity.value=g.backgroundIntensity,c.material.toneMapped=b.encoding!==lr,b.matrixAutoUpdate===!0&&b.updateMatrix(),c.material.uniforms.uvTransform.value.copy(b.matrix),(d!==b||h!==b.version||f!==e.toneMapping)&&(c.material.needsUpdate=!0,d=b,h=b.version,f=e.toneMapping),c.layers.enableAll(),m.unshift(c,c.geometry,c.material,0,0,null))}function v(m,g){m.getRGB(Sy,l8(e)),i.buffers.color.setClear(Sy.r,Sy.g,Sy.b,g,o)}return{getClearColor:function(){return s},setClearColor:function(m,g=1){s.set(m),l=g,v(s,l)},getClearAlpha:function(){return l},setClearAlpha:function(m){l=m,v(s,l)},render:p}}function iSe(e,t,r,i){let n=e.getParameter(34921),a=i.isWebGL2?null:t.get("OES_vertex_array_object"),o=i.isWebGL2||a!==null,s={},l=m(null),c=l,u=!1;function d(z,F,H,N,U){let ie=!1;if(o){let te=v(N,H,F);c!==te&&(c=te,f(c.object)),ie=g(z,N,H,U),ie&&y(z,N,H,U)}else{let te=F.wireframe===!0;(c.geometry!==N.id||c.program!==H.id||c.wireframe!==te)&&(c.geometry=N.id,c.program=H.id,c.wireframe=te,ie=!0)}U!==null&&r.update(U,34963),(ie||u)&&(u=!1,C(z,F,H,N),U!==null&&e.bindBuffer(34963,r.get(U).buffer))}function h(){return i.isWebGL2?e.createVertexArray():a.createVertexArrayOES()}function f(z){return i.isWebGL2?e.bindVertexArray(z):a.bindVertexArrayOES(z)}function p(z){return i.isWebGL2?e.deleteVertexArray(z):a.deleteVertexArrayOES(z)}function v(z,F,H){let N=H.wireframe===!0,U=s[z.id];U===void 0&&(U={},s[z.id]=U);let ie=U[F.id];ie===void 0&&(ie={},U[F.id]=ie);let te=ie[N];return te===void 0&&(te=m(h()),ie[N]=te),te}function m(z){let F=[],H=[],N=[];for(let U=0;U<n;U++)F[U]=0,H[U]=0,N[U]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:F,enabledAttributes:H,attributeDivisors:N,object:z,attributes:{},index:null}}function g(z,F,H,N){let U=c.attributes,ie=F.attributes,te=0,X=H.getAttributes();for(let W in X)if(X[W].location>=0){let q=U[W],$=ie[W];if($===void 0&&(W==="instanceMatrix"&&z.instanceMatrix&&($=z.instanceMatrix),W==="instanceColor"&&z.instanceColor&&($=z.instanceColor)),q===void 0||q.attribute!==$||$&&q.data!==$.data)return!0;te++}return c.attributesNum!==te||c.index!==N}function y(z,F,H,N){let U={},ie=F.attributes,te=0,X=H.getAttributes();for(let W in X)if(X[W].location>=0){let q=ie[W];q===void 0&&(W==="instanceMatrix"&&z.instanceMatrix&&(q=z.instanceMatrix),W==="instanceColor"&&z.instanceColor&&(q=z.instanceColor));let $={};$.attribute=q,q&&q.data&&($.data=q.data),U[W]=$,te++}c.attributes=U,c.attributesNum=te,c.index=N}function b(){let z=c.newAttributes;for(let F=0,H=z.length;F<H;F++)z[F]=0}function x(z){S(z,0)}function S(z,F){let H=c.newAttributes,N=c.enabledAttributes,U=c.attributeDivisors;H[z]=1,N[z]===0&&(e.enableVertexAttribArray(z),N[z]=1),U[z]!==F&&((i.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](z,F),U[z]=F)}function w(){let z=c.newAttributes,F=c.enabledAttributes;for(let H=0,N=F.length;H<N;H++)F[H]!==z[H]&&(e.disableVertexAttribArray(H),F[H]=0)}function _(z,F,H,N,U,ie){i.isWebGL2===!0&&(H===5124||H===5125)?e.vertexAttribIPointer(z,F,H,U,ie):e.vertexAttribPointer(z,F,H,N,U,ie)}function C(z,F,H,N){if(i.isWebGL2===!1&&(z.isInstancedMesh||N.isInstancedBufferGeometry)&&t.get("ANGLE_instanced_arrays")===null)return;b();let U=N.attributes,ie=H.getAttributes(),te=F.defaultAttributeValues;for(let X in ie){let W=ie[X];if(W.location>=0){let q=U[X];if(q===void 0&&(X==="instanceMatrix"&&z.instanceMatrix&&(q=z.instanceMatrix),X==="instanceColor"&&z.instanceColor&&(q=z.instanceColor)),q!==void 0){let $=q.normalized,le=q.itemSize,ee=r.get(q);if(ee===void 0)continue;let Q=ee.buffer,ne=ee.type,V=ee.bytesPerElement;if(q.isInterleavedBufferAttribute){let ue=q.data,ve=ue.stride,Ce=q.offset;if(ue.isInstancedInterleavedBuffer){for(let G=0;G<W.locationSize;G++)S(W.location+G,ue.meshPerAttribute);z.isInstancedMesh!==!0&&N._maxInstanceCount===void 0&&(N._maxInstanceCount=ue.meshPerAttribute*ue.count)}else for(let G=0;G<W.locationSize;G++)x(W.location+G);e.bindBuffer(34962,Q);for(let G=0;G<W.locationSize;G++)_(W.location+G,le/W.locationSize,ne,$,ve*V,(Ce+le/W.locationSize*G)*V)}else{if(q.isInstancedBufferAttribute){for(let ue=0;ue<W.locationSize;ue++)S(W.location+ue,q.meshPerAttribute);z.isInstancedMesh!==!0&&N._maxInstanceCount===void 0&&(N._maxInstanceCount=q.meshPerAttribute*q.count)}else for(let ue=0;ue<W.locationSize;ue++)x(W.location+ue);e.bindBuffer(34962,Q);for(let ue=0;ue<W.locationSize;ue++)_(W.location+ue,le/W.locationSize,ne,$,le*V,le/W.locationSize*ue*V)}}else if(te!==void 0){let $=te[X];if($!==void 0)switch($.length){case 2:e.vertexAttrib2fv(W.location,$);break;case 3:e.vertexAttrib3fv(W.location,$);break;case 4:e.vertexAttrib4fv(W.location,$);break;default:e.vertexAttrib1fv(W.location,$)}}}}w()}function A(){T();for(let z in s){let F=s[z];for(let H in F){let N=F[H];for(let U in N)p(N[U].object),delete N[U];delete F[H]}delete s[z]}}function M(z){if(s[z.id]===void 0)return;let F=s[z.id];for(let H in F){let N=F[H];for(let U in N)p(N[U].object),delete N[U];delete F[H]}delete s[z.id]}function P(z){for(let F in s){let H=s[F];if(H[z.id]===void 0)continue;let N=H[z.id];for(let U in N)p(N[U].object),delete N[U];delete H[z.id]}}function T(){R(),u=!0,c!==l&&(c=l,f(c.object))}function R(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:d,reset:T,resetDefaultState:R,dispose:A,releaseStatesOfGeometry:M,releaseStatesOfProgram:P,initAttributes:b,enableAttribute:x,disableUnusedAttributes:w}}function nSe(e,t,r,i){let n=i.isWebGL2,a;function o(c){a=c}function s(c,u){e.drawArrays(a,c,u),r.update(u,a,1)}function l(c,u,d){if(d===0)return;let h,f;if(n)h=e,f="drawArraysInstanced";else if(h=t.get("ANGLE_instanced_arrays"),f="drawArraysInstancedANGLE",h===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}h[f](a,c,u,d),r.update(u,a,d)}this.setMode=o,this.render=s,this.renderInstances=l}function aSe(e,t,r){let i;function n(){if(i!==void 0)return i;if(t.has("EXT_texture_filter_anisotropic")===!0){let _=t.get("EXT_texture_filter_anisotropic");i=e.getParameter(_.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i}function a(_){if(_==="highp"){if(e.getShaderPrecisionFormat(35633,36338).precision>0&&e.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";_="mediump"}return _==="mediump"&&e.getShaderPrecisionFormat(35633,36337).precision>0&&e.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}let o=typeof WebGL2RenderingContext<"u"&&e instanceof WebGL2RenderingContext,s=r.precision!==void 0?r.precision:"highp",l=a(s);l!==s&&(console.warn("THREE.WebGLRenderer:",s,"not supported, using",l,"instead."),s=l);let c=o||t.has("WEBGL_draw_buffers"),u=r.logarithmicDepthBuffer===!0,d=e.getParameter(34930),h=e.getParameter(35660),f=e.getParameter(3379),p=e.getParameter(34076),v=e.getParameter(34921),m=e.getParameter(36347),g=e.getParameter(36348),y=e.getParameter(36349),b=h>0,x=o||t.has("OES_texture_float"),S=b&&x,w=o?e.getParameter(36183):0;return{isWebGL2:o,drawBuffers:c,getMaxAnisotropy:n,getMaxPrecision:a,precision:s,logarithmicDepthBuffer:u,maxTextures:d,maxVertexTextures:h,maxTextureSize:f,maxCubemapSize:p,maxAttributes:v,maxVertexUniforms:m,maxVaryings:g,maxFragmentUniforms:y,vertexTextures:b,floatFragmentTextures:x,floatVertexTextures:S,maxSamples:w}}function oSe(e){let t=this,r=null,i=0,n=!1,a=!1,o=new Ya,s=new cn,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(d,h){let f=d.length!==0||h||i!==0||n;return n=h,i=d.length,f},this.beginShadows=function(){a=!0,u(null)},this.endShadows=function(){a=!1},this.setGlobalState=function(d,h){r=u(d,h,0)},this.setState=function(d,h,f){let p=d.clippingPlanes,v=d.clipIntersection,m=d.clipShadows,g=e.get(d);if(!n||p===null||p.length===0||a&&!m)a?u(null):c();else{let y=a?0:i,b=y*4,x=g.clippingState||null;l.value=x,x=u(p,h,b,f);for(let S=0;S!==b;++S)x[S]=r[S];g.clippingState=x,this.numIntersection=v?this.numPlanes:0,this.numPlanes+=y}};function c(){l.value!==r&&(l.value=r,l.needsUpdate=i>0),t.numPlanes=i,t.numIntersection=0}function u(d,h,f,p){let v=d!==null?d.length:0,m=null;if(v!==0){if(m=l.value,p!==!0||m===null){let g=f+v*4,y=h.matrixWorldInverse;s.getNormalMatrix(y),(m===null||m.length<g)&&(m=new Float32Array(g));for(let b=0,x=f;b!==v;++b,x+=4)o.copy(d[b]).applyMatrix4(y,s),o.normal.toArray(m,x),m[x+3]=o.constant}l.value=m,l.needsUpdate=!0}return t.numPlanes=v,t.numIntersection=0,m}}function sSe(e){let t=new WeakMap;function r(o,s){return s===dM?o.mapping=fh:s===hM&&(o.mapping=ph),o}function i(o){if(o&&o.isTexture&&o.isRenderTargetTexture===!1){let s=o.mapping;if(s===dM||s===hM)if(t.has(o)){let l=t.get(o).texture;return r(l,o.mapping)}else{let l=o.image;if(l&&l.height>0){let c=new xxe(l.height/2);return c.fromEquirectangularTexture(e,o),t.set(o,c),o.addEventListener("dispose",n),r(c.texture,o.mapping)}else return null}}return o}function n(o){let s=o.target;s.removeEventListener("dispose",n);let l=t.get(s);l!==void 0&&(t.delete(s),l.dispose())}function a(){t=new WeakMap}return{get:i,dispose:a}}var Tw=class extends Rh{constructor(e=-1,t=1,r=1,i=-1,n=.1,a=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=r,this.bottom=i,this.near=n,this.far=a,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,r,i,n,a){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=i,this.view.width=n,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,i=(this.top+this.bottom)/2,n=r-e,a=r+e,o=i+t,s=i-t;if(this.view!==null&&this.view.enabled){let l=(this.right-this.left)/this.view.fullWidth/this.zoom,c=(this.top-this.bottom)/this.view.fullHeight/this.zoom;n+=l*this.view.offsetX,a=n+l*this.view.width,o-=c*this.view.offsetY,s=o-c*this.view.height}this.projectionMatrix.makeOrthographic(n,a,o,s,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}},Wf=4,Vz=[.125,.215,.35,.446,.526,.582],_d=20,kC=new Tw,Hz=new Bt,LC=null,gd=(1+Math.sqrt(5))/2,df=1/gd,Wz=[new k(1,1,1),new k(-1,1,1),new k(1,1,-1),new k(-1,1,-1),new k(0,gd,df),new k(0,gd,-df),new k(df,0,gd),new k(-df,0,gd),new k(gd,df,0),new k(-gd,df,0)],Gz=class{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,r=.1,i=100){LC=this._renderer.getRenderTarget(),this._setSize(256);let n=this._allocateTargets();return n.depthBuffer=!0,this._sceneToCubeUV(e,r,i,n),t>0&&this._blur(n,0,0,t),this._applyPMREM(n),this._cleanup(n),n}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=Yz(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=qz(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(LC),e.scissorTest=!1,Cy(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===fh||e.mapping===ph?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),LC=this._renderer.getRenderTarget();let r=t||this._allocateTargets();return this._textureToCubeUV(e,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(){let e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,r={magFilter:hr,minFilter:hr,generateMipmaps:!1,type:dc,format:Ln,encoding:xs,depthBuffer:!1},i=$z(e,t,r);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=$z(e,t,r);let{_lodMax:n}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=lSe(n)),this._blurMaterial=cSe(n,e,t)}return i}_compileMaterial(e){let t=new Oi(this._lodPlanes[0],e);this._renderer.compile(t,kC)}_sceneToCubeUV(e,t,r,i){let n=new pa(90,1,t,r),a=[1,-1,1,1,1,1],o=[1,1,1,-1,-1,-1],s=this._renderer,l=s.autoClear,c=s.toneMapping;s.getClearColor(Hz),s.toneMapping=sl,s.autoClear=!1;let u=new hc({name:"PMREM.Background",side:Nn,depthWrite:!1,depthTest:!1}),d=new Oi(new ws,u),h=!1,f=e.background;f?f.isColor&&(u.color.copy(f),e.background=null,h=!0):(u.color.copy(Hz),h=!0);for(let p=0;p<6;p++){let v=p%3;v===0?(n.up.set(0,a[p],0),n.lookAt(o[p],0,0)):v===1?(n.up.set(0,0,a[p]),n.lookAt(0,o[p],0)):(n.up.set(0,a[p],0),n.lookAt(0,0,o[p]));let m=this._cubeSize;Cy(i,v*m,p>2?m:0,m,m),s.setRenderTarget(i),h&&s.render(d,n),s.render(e,n)}d.geometry.dispose(),d.material.dispose(),s.toneMapping=c,s.autoClear=l,e.background=f}_textureToCubeUV(e,t){let r=this._renderer,i=e.mapping===fh||e.mapping===ph;i?(this._cubemapMaterial===null&&(this._cubemapMaterial=Yz()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=qz());let n=i?this._cubemapMaterial:this._equirectMaterial,a=new Oi(this._lodPlanes[0],n),o=n.uniforms;o.envMap.value=e;let s=this._cubeSize;Cy(t,0,0,3*s,2*s),r.setRenderTarget(t),r.render(a,kC)}_applyPMREM(e){let t=this._renderer,r=t.autoClear;t.autoClear=!1;for(let i=1;i<this._lodPlanes.length;i++){let n=Math.sqrt(this._sigmas[i]*this._sigmas[i]-this._sigmas[i-1]*this._sigmas[i-1]),a=Wz[(i-1)%Wz.length];this._blur(e,i-1,i,n,a)}t.autoClear=r}_blur(e,t,r,i,n){let a=this._pingPongRenderTarget;this._halfBlur(e,a,t,r,i,"latitudinal",n),this._halfBlur(a,e,r,r,i,"longitudinal",n)}_halfBlur(e,t,r,i,n,a,o){let s=this._renderer,l=this._blurMaterial;a!=="latitudinal"&&a!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");let c=3,u=new Oi(this._lodPlanes[i],l),d=l.uniforms,h=this._sizeLods[r]-1,f=isFinite(n)?Math.PI/(2*h):2*Math.PI/(2*_d-1),p=n/f,v=isFinite(n)?1+Math.floor(c*p):_d;v>_d&&console.warn(`sigmaRadians, ${n}, is too large and will clip, as it requested ${v} samples when the maximum is set to ${_d}`);let m=[],g=0;for(let w=0;w<_d;++w){let _=w/p,C=Math.exp(-_*_/2);m.push(C),w===0?g+=C:w<v&&(g+=2*C)}for(let w=0;w<m.length;w++)m[w]=m[w]/g;d.envMap.value=e.texture,d.samples.value=v,d.weights.value=m,d.latitudinal.value=a==="latitudinal",o&&(d.poleAxis.value=o);let{_lodMax:y}=this;d.dTheta.value=f,d.mipInt.value=y-r;let b=this._sizeLods[i],x=3*b*(i>y-Wf?i-y+Wf:0),S=4*(this._cubeSize-b);Cy(t,x,S,3*b,2*b),s.setRenderTarget(t),s.render(u,kC)}};function lSe(e){let t=[],r=[],i=[],n=e,a=e-Wf+1+Vz.length;for(let o=0;o<a;o++){let s=Math.pow(2,n);r.push(s);let l=1/s;o>e-Wf?l=Vz[o-e+Wf-1]:o===0&&(l=0),i.push(l);let c=1/(s-2),u=-c,d=1+c,h=[u,u,d,u,d,d,u,u,d,d,u,d],f=6,p=6,v=3,m=2,g=1,y=new Float32Array(v*p*f),b=new Float32Array(m*p*f),x=new Float32Array(g*p*f);for(let w=0;w<f;w++){let _=w%3*2/3-1,C=w>2?0:-1,A=[_,C,0,_+2/3,C,0,_+2/3,C+1,0,_,C,0,_+2/3,C+1,0,_,C+1,0];y.set(A,v*p*w),b.set(h,m*p*w);let M=[w,w,w,w,w,w];x.set(M,g*p*w)}let S=new Ot;S.setAttribute("position",new qt(y,v)),S.setAttribute("uv",new qt(b,m)),S.setAttribute("faceIndex",new qt(x,g)),t.push(S),n>Wf&&n--}return{lodPlanes:t,sizeLods:r,sigmas:i}}function $z(e,t,r){let i=new jr(e,t,r);return i.texture.mapping=p0,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function Cy(e,t,r,i,n){e.viewport.set(t,r,i,n),e.scissor.set(t,r,i,n)}function cSe(e,t,r){let i=new Float32Array(_d),n=new k(0,1,0);return new Vr({name:"SphericalGaussianBlur",defines:{n:_d,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/r,CUBEUV_MAX_MIP:`${e}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:n}},vertexShader:GP(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:un,depthTest:!1,depthWrite:!1})}function qz(){return new Vr({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:GP(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:un,depthTest:!1,depthWrite:!1})}function Yz(){return new Vr({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:GP(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:un,depthTest:!1,depthWrite:!1})}function GP(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function uSe(e){let t=new WeakMap,r=null;function i(s){if(s&&s.isTexture){let l=s.mapping,c=l===dM||l===hM,u=l===fh||l===ph;if(c||u)if(s.isRenderTargetTexture&&s.needsPMREMUpdate===!0){s.needsPMREMUpdate=!1;let d=t.get(s);return r===null&&(r=new Gz(e)),d=c?r.fromEquirectangular(s,d):r.fromCubemap(s,d),t.set(s,d),d.texture}else{if(t.has(s))return t.get(s).texture;{let d=s.image;if(c&&d&&d.height>0||u&&d&&n(d)){r===null&&(r=new Gz(e));let h=c?r.fromEquirectangular(s):r.fromCubemap(s);return t.set(s,h),s.addEventListener("dispose",a),h.texture}else return null}}}return s}function n(s){let l=0,c=6;for(let u=0;u<c;u++)s[u]!==void 0&&l++;return l===c}function a(s){let l=s.target;l.removeEventListener("dispose",a);let c=t.get(l);c!==void 0&&(t.delete(l),c.dispose())}function o(){t=new WeakMap,r!==null&&(r.dispose(),r=null)}return{get:i,dispose:o}}function dSe(e){let t={};function r(i){if(t[i]!==void 0)return t[i];let n;switch(i){case"WEBGL_depth_texture":n=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":n=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:n=e.getExtension(i)}return t[i]=n,n}return{has:function(i){return r(i)!==null},init:function(i){i.isWebGL2?r("EXT_color_buffer_float"):(r("WEBGL_depth_texture"),r("OES_texture_float"),r("OES_texture_half_float"),r("OES_texture_half_float_linear"),r("OES_standard_derivatives"),r("OES_element_index_uint"),r("OES_vertex_array_object"),r("ANGLE_instanced_arrays")),r("OES_texture_float_linear"),r("EXT_color_buffer_half_float"),r("WEBGL_multisampled_render_to_texture")},get:function(i){let n=r(i);return n===null&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),n}}}function hSe(e,t,r,i){let n={},a=new WeakMap;function o(d){let h=d.target;h.index!==null&&t.remove(h.index);for(let p in h.attributes)t.remove(h.attributes[p]);h.removeEventListener("dispose",o),delete n[h.id];let f=a.get(h);f&&(t.remove(f),a.delete(h)),i.releaseStatesOfGeometry(h),h.isInstancedBufferGeometry===!0&&delete h._maxInstanceCount,r.memory.geometries--}function s(d,h){return n[h.id]===!0||(h.addEventListener("dispose",o),n[h.id]=!0,r.memory.geometries++),h}function l(d){let h=d.attributes;for(let p in h)t.update(h[p],34962);let f=d.morphAttributes;for(let p in f){let v=f[p];for(let m=0,g=v.length;m<g;m++)t.update(v[m],34962)}}function c(d){let h=[],f=d.index,p=d.attributes.position,v=0;if(f!==null){let y=f.array;v=f.version;for(let b=0,x=y.length;b<x;b+=3){let S=y[b+0],w=y[b+1],_=y[b+2];h.push(S,w,w,_,_,S)}}else{let y=p.array;v=p.version;for(let b=0,x=y.length/3-1;b<x;b+=3){let S=b+0,w=b+1,_=b+2;h.push(S,w,w,_,_,S)}}let m=new(r8(h)?ap:s8)(h,1);m.version=v;let g=a.get(d);g&&t.remove(g),a.set(d,m)}function u(d){let h=a.get(d);if(h){let f=d.index;f!==null&&h.version<f.version&&c(d)}else c(d);return a.get(d)}return{get:s,update:l,getWireframeAttribute:u}}function fSe(e,t,r,i){let n=i.isWebGL2,a;function o(h){a=h}let s,l;function c(h){s=h.type,l=h.bytesPerElement}function u(h,f){e.drawElements(a,f,s,h*l),r.update(f,a,1)}function d(h,f,p){if(p===0)return;let v,m;if(n)v=e,m="drawElementsInstanced";else if(v=t.get("ANGLE_instanced_arrays"),m="drawElementsInstancedANGLE",v===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}v[m](a,f,s,h*l,p),r.update(f,a,p)}this.setMode=o,this.setIndex=c,this.render=u,this.renderInstances=d}function pSe(e){let t={geometries:0,textures:0},r={frame:0,calls:0,triangles:0,points:0,lines:0};function i(a,o,s){switch(r.calls++,o){case 4:r.triangles+=s*(a/3);break;case 1:r.lines+=s*(a/2);break;case 3:r.lines+=s*(a-1);break;case 2:r.lines+=s*a;break;case 0:r.points+=s*a;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function n(){r.frame++,r.calls=0,r.triangles=0,r.points=0,r.lines=0}return{memory:t,render:r,programs:null,autoReset:!0,reset:n,update:i}}function mSe(e,t){return e[0]-t[0]}function vSe(e,t){return Math.abs(t[1])-Math.abs(e[1])}function gSe(e,t,r){let i={},n=new Float32Array(8),a=new WeakMap,o=new Qt,s=[];for(let c=0;c<8;c++)s[c]=[c,0];function l(c,u,d,h){let f=c.morphTargetInfluences;if(t.isWebGL2===!0){let p=u.morphAttributes.position||u.morphAttributes.normal||u.morphAttributes.color,v=p!==void 0?p.length:0,m=a.get(u);if(m===void 0||m.count!==v){let b=function(){z.dispose(),a.delete(u),u.removeEventListener("dispose",b)};m!==void 0&&m.texture.dispose();let x=u.morphAttributes.position!==void 0,S=u.morphAttributes.normal!==void 0,w=u.morphAttributes.color!==void 0,_=u.morphAttributes.position||[],C=u.morphAttributes.normal||[],A=u.morphAttributes.color||[],M=0;x===!0&&(M=1),S===!0&&(M=2),w===!0&&(M=3);let P=u.attributes.position.count*M,T=1;P>t.maxTextureSize&&(T=Math.ceil(P/t.maxTextureSize),P=t.maxTextureSize);let R=new Float32Array(P*T*4*v),z=new o8(R,P,T,v);z.type=ln,z.needsUpdate=!0;let F=M*4;for(let H=0;H<v;H++){let N=_[H],U=C[H],ie=A[H],te=P*T*4*H;for(let X=0;X<N.count;X++){let W=X*F;x===!0&&(o.fromBufferAttribute(N,X),R[te+W+0]=o.x,R[te+W+1]=o.y,R[te+W+2]=o.z,R[te+W+3]=0),S===!0&&(o.fromBufferAttribute(U,X),R[te+W+4]=o.x,R[te+W+5]=o.y,R[te+W+6]=o.z,R[te+W+7]=0),w===!0&&(o.fromBufferAttribute(ie,X),R[te+W+8]=o.x,R[te+W+9]=o.y,R[te+W+10]=o.z,R[te+W+11]=ie.itemSize===4?o.w:1)}}m={count:v,texture:z,size:new ye(P,T)},a.set(u,m),u.addEventListener("dispose",b)}let g=0;for(let b=0;b<f.length;b++)g+=f[b];let y=u.morphTargetsRelative?1:1-g;h.getUniforms().setValue(e,"morphTargetBaseInfluence",y),h.getUniforms().setValue(e,"morphTargetInfluences",f),h.getUniforms().setValue(e,"morphTargetsTexture",m.texture,r),h.getUniforms().setValue(e,"morphTargetsTextureSize",m.size)}else{let p=f===void 0?0:f.length,v=i[u.id];if(v===void 0||v.length!==p){v=[];for(let x=0;x<p;x++)v[x]=[x,0];i[u.id]=v}for(let x=0;x<p;x++){let S=v[x];S[0]=x,S[1]=f[x]}v.sort(vSe);for(let x=0;x<8;x++)x<p&&v[x][1]?(s[x][0]=v[x][0],s[x][1]=v[x][1]):(s[x][0]=Number.MAX_SAFE_INTEGER,s[x][1]=0);s.sort(mSe);let m=u.morphAttributes.position,g=u.morphAttributes.normal,y=0;for(let x=0;x<8;x++){let S=s[x],w=S[0],_=S[1];w!==Number.MAX_SAFE_INTEGER&&_?(m&&u.getAttribute("morphTarget"+x)!==m[w]&&u.setAttribute("morphTarget"+x,m[w]),g&&u.getAttribute("morphNormal"+x)!==g[w]&&u.setAttribute("morphNormal"+x,g[w]),n[x]=_,y+=_):(m&&u.hasAttribute("morphTarget"+x)===!0&&u.deleteAttribute("morphTarget"+x),g&&u.hasAttribute("morphNormal"+x)===!0&&u.deleteAttribute("morphNormal"+x),n[x]=0)}let b=u.morphTargetsRelative?1:1-y;h.getUniforms().setValue(e,"morphTargetBaseInfluence",b),h.getUniforms().setValue(e,"morphTargetInfluences",n)}}return{update:l}}function ySe(e,t,r,i){let n=new WeakMap;function a(l){let c=i.render.frame,u=l.geometry,d=t.get(l,u);return n.get(d)!==c&&(t.update(d),n.set(d,c)),l.isInstancedMesh&&(l.hasEventListener("dispose",s)===!1&&l.addEventListener("dispose",s),r.update(l.instanceMatrix,34962),l.instanceColor!==null&&r.update(l.instanceColor,34962)),d}function o(){n=new WeakMap}function s(l){let c=l.target;c.removeEventListener("dispose",s),r.remove(c.instanceMatrix),c.instanceColor!==null&&r.remove(c.instanceColor)}return{update:a,dispose:o}}var u8=new Ri,d8=new o8,h8=new nxe,f8=new HP,Xz=[],Kz=[],Qz=new Float32Array(16),Zz=new Float32Array(9),Jz=new Float32Array(4);function lm(e,t,r){let i=e[0];if(i<=0||i>0)return e;let n=t*r,a=Xz[n];if(a===void 0&&(a=new Float32Array(n),Xz[n]=a),t!==0){i.toArray(a,0);for(let o=1,s=0;o!==t;++o)s+=r,e[o].toArray(a,s)}return a}function _n(e,t){if(e.length!==t.length)return!1;for(let r=0,i=e.length;r<i;r++)if(e[r]!==t[r])return!1;return!0}function An(e,t){for(let r=0,i=t.length;r<i;r++)e[r]=t[r]}function Pw(e,t){let r=Kz[t];r===void 0&&(r=new Int32Array(t),Kz[t]=r);for(let i=0;i!==t;++i)r[i]=e.allocateTextureUnit();return r}function bSe(e,t){let r=this.cache;r[0]!==t&&(e.uniform1f(this.addr,t),r[0]=t)}function xSe(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y)&&(e.uniform2f(this.addr,t.x,t.y),r[0]=t.x,r[1]=t.y);else{if(_n(r,t))return;e.uniform2fv(this.addr,t),An(r,t)}}function wSe(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z)&&(e.uniform3f(this.addr,t.x,t.y,t.z),r[0]=t.x,r[1]=t.y,r[2]=t.z);else if(t.r!==void 0)(r[0]!==t.r||r[1]!==t.g||r[2]!==t.b)&&(e.uniform3f(this.addr,t.r,t.g,t.b),r[0]=t.r,r[1]=t.g,r[2]=t.b);else{if(_n(r,t))return;e.uniform3fv(this.addr,t),An(r,t)}}function SSe(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z||r[3]!==t.w)&&(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=t.w);else{if(_n(r,t))return;e.uniform4fv(this.addr,t),An(r,t)}}function CSe(e,t){let r=this.cache,i=t.elements;if(i===void 0){if(_n(r,t))return;e.uniformMatrix2fv(this.addr,!1,t),An(r,t)}else{if(_n(r,i))return;Jz.set(i),e.uniformMatrix2fv(this.addr,!1,Jz),An(r,i)}}function _Se(e,t){let r=this.cache,i=t.elements;if(i===void 0){if(_n(r,t))return;e.uniformMatrix3fv(this.addr,!1,t),An(r,t)}else{if(_n(r,i))return;Zz.set(i),e.uniformMatrix3fv(this.addr,!1,Zz),An(r,i)}}function ASe(e,t){let r=this.cache,i=t.elements;if(i===void 0){if(_n(r,t))return;e.uniformMatrix4fv(this.addr,!1,t),An(r,t)}else{if(_n(r,i))return;Qz.set(i),e.uniformMatrix4fv(this.addr,!1,Qz),An(r,i)}}function MSe(e,t){let r=this.cache;r[0]!==t&&(e.uniform1i(this.addr,t),r[0]=t)}function ESe(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y)&&(e.uniform2i(this.addr,t.x,t.y),r[0]=t.x,r[1]=t.y);else{if(_n(r,t))return;e.uniform2iv(this.addr,t),An(r,t)}}function TSe(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z)&&(e.uniform3i(this.addr,t.x,t.y,t.z),r[0]=t.x,r[1]=t.y,r[2]=t.z);else{if(_n(r,t))return;e.uniform3iv(this.addr,t),An(r,t)}}function PSe(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z||r[3]!==t.w)&&(e.uniform4i(this.addr,t.x,t.y,t.z,t.w),r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=t.w);else{if(_n(r,t))return;e.uniform4iv(this.addr,t),An(r,t)}}function DSe(e,t){let r=this.cache;r[0]!==t&&(e.uniform1ui(this.addr,t),r[0]=t)}function OSe(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y)&&(e.uniform2ui(this.addr,t.x,t.y),r[0]=t.x,r[1]=t.y);else{if(_n(r,t))return;e.uniform2uiv(this.addr,t),An(r,t)}}function RSe(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z)&&(e.uniform3ui(this.addr,t.x,t.y,t.z),r[0]=t.x,r[1]=t.y,r[2]=t.z);else{if(_n(r,t))return;e.uniform3uiv(this.addr,t),An(r,t)}}function ISe(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z||r[3]!==t.w)&&(e.uniform4ui(this.addr,t.x,t.y,t.z,t.w),r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=t.w);else{if(_n(r,t))return;e.uniform4uiv(this.addr,t),An(r,t)}}function zSe(e,t,r){let i=this.cache,n=r.allocateTextureUnit();i[0]!==n&&(e.uniform1i(this.addr,n),i[0]=n),r.setTexture2D(t||u8,n)}function kSe(e,t,r){let i=this.cache,n=r.allocateTextureUnit();i[0]!==n&&(e.uniform1i(this.addr,n),i[0]=n),r.setTexture3D(t||h8,n)}function LSe(e,t,r){let i=this.cache,n=r.allocateTextureUnit();i[0]!==n&&(e.uniform1i(this.addr,n),i[0]=n),r.setTextureCube(t||f8,n)}function BSe(e,t,r){let i=this.cache,n=r.allocateTextureUnit();i[0]!==n&&(e.uniform1i(this.addr,n),i[0]=n),r.setTexture2DArray(t||d8,n)}function FSe(e){switch(e){case 5126:return bSe;case 35664:return xSe;case 35665:return wSe;case 35666:return SSe;case 35674:return CSe;case 35675:return _Se;case 35676:return ASe;case 5124:case 35670:return MSe;case 35667:case 35671:return ESe;case 35668:case 35672:return TSe;case 35669:case 35673:return PSe;case 5125:return DSe;case 36294:return OSe;case 36295:return RSe;case 36296:return ISe;case 35678:case 36198:case 36298:case 36306:case 35682:return zSe;case 35679:case 36299:case 36307:return kSe;case 35680:case 36300:case 36308:case 36293:return LSe;case 36289:case 36303:case 36311:case 36292:return BSe}}function NSe(e,t){e.uniform1fv(this.addr,t)}function USe(e,t){let r=lm(t,this.size,2);e.uniform2fv(this.addr,r)}function jSe(e,t){let r=lm(t,this.size,3);e.uniform3fv(this.addr,r)}function VSe(e,t){let r=lm(t,this.size,4);e.uniform4fv(this.addr,r)}function HSe(e,t){let r=lm(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,r)}function WSe(e,t){let r=lm(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,r)}function GSe(e,t){let r=lm(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,r)}function $Se(e,t){e.uniform1iv(this.addr,t)}function qSe(e,t){e.uniform2iv(this.addr,t)}function YSe(e,t){e.uniform3iv(this.addr,t)}function XSe(e,t){e.uniform4iv(this.addr,t)}function KSe(e,t){e.uniform1uiv(this.addr,t)}function QSe(e,t){e.uniform2uiv(this.addr,t)}function ZSe(e,t){e.uniform3uiv(this.addr,t)}function JSe(e,t){e.uniform4uiv(this.addr,t)}function eCe(e,t,r){let i=this.cache,n=t.length,a=Pw(r,n);_n(i,a)||(e.uniform1iv(this.addr,a),An(i,a));for(let o=0;o!==n;++o)r.setTexture2D(t[o]||u8,a[o])}function tCe(e,t,r){let i=this.cache,n=t.length,a=Pw(r,n);_n(i,a)||(e.uniform1iv(this.addr,a),An(i,a));for(let o=0;o!==n;++o)r.setTexture3D(t[o]||h8,a[o])}function rCe(e,t,r){let i=this.cache,n=t.length,a=Pw(r,n);_n(i,a)||(e.uniform1iv(this.addr,a),An(i,a));for(let o=0;o!==n;++o)r.setTextureCube(t[o]||f8,a[o])}function iCe(e,t,r){let i=this.cache,n=t.length,a=Pw(r,n);_n(i,a)||(e.uniform1iv(this.addr,a),An(i,a));for(let o=0;o!==n;++o)r.setTexture2DArray(t[o]||d8,a[o])}function nCe(e){switch(e){case 5126:return NSe;case 35664:return USe;case 35665:return jSe;case 35666:return VSe;case 35674:return HSe;case 35675:return WSe;case 35676:return GSe;case 5124:case 35670:return $Se;case 35667:case 35671:return qSe;case 35668:case 35672:return YSe;case 35669:case 35673:return XSe;case 5125:return KSe;case 36294:return QSe;case 36295:return ZSe;case 36296:return JSe;case 35678:case 36198:case 36298:case 36306:case 35682:return eCe;case 35679:case 36299:case 36307:return tCe;case 35680:case 36300:case 36308:case 36293:return rCe;case 36289:case 36303:case 36311:case 36292:return iCe}}var aCe=class{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.setValue=FSe(t.type)}},oCe=class{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.size=t.size,this.setValue=nCe(t.type)}},sCe=class{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,r){let i=this.seq;for(let n=0,a=i.length;n!==a;++n){let o=i[n];o.setValue(e,t[o.id],r)}}},BC=/(\w+)(\])?(\[|\.)?/g;function ek(e,t){e.seq.push(t),e.map[t.id]=t}function lCe(e,t,r){let i=e.name,n=i.length;for(BC.lastIndex=0;;){let a=BC.exec(i),o=BC.lastIndex,s=a[1],l=a[2]==="]",c=a[3];if(l&&(s=s|0),c===void 0||c==="["&&o+2===n){ek(r,c===void 0?new aCe(s,e,t):new oCe(s,e,t));break}else{let u=r.map[s];u===void 0&&(u=new sCe(s),ek(r,u)),r=u}}}var Nb=class{constructor(e,t){this.seq=[],this.map={};let r=e.getProgramParameter(t,35718);for(let i=0;i<r;++i){let n=e.getActiveUniform(t,i),a=e.getUniformLocation(t,n.name);lCe(n,a,this)}}setValue(e,t,r,i){let n=this.map[t];n!==void 0&&n.setValue(e,r,i)}setOptional(e,t,r){let i=t[r];i!==void 0&&this.setValue(e,r,i)}static upload(e,t,r,i){for(let n=0,a=t.length;n!==a;++n){let o=t[n],s=r[o.id];s.needsUpdate!==!1&&o.setValue(e,s.value,i)}}static seqWithValue(e,t){let r=[];for(let i=0,n=e.length;i!==n;++i){let a=e[i];a.id in t&&r.push(a)}return r}};function tk(e,t,r){let i=e.createShader(t);return e.shaderSource(i,r),e.compileShader(i),i}var cCe=0;function uCe(e,t){let r=e.split(`
`),i=[],n=Math.max(t-6,0),a=Math.min(t+6,r.length);for(let o=n;o<a;o++){let s=o+1;i.push(`${s===t?">":" "} ${s}: ${r[o]}`)}return i.join(`
`)}function dCe(e){switch(e){case xs:return["Linear","( value )"];case lr:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",e),["Linear","( value )"]}}function rk(e,t,r){let i=e.getShaderParameter(t,35713),n=e.getShaderInfoLog(t).trim();if(i&&n==="")return"";let a=/ERROR: 0:(\d+)/.exec(n);if(a){let o=parseInt(a[1]);return r.toUpperCase()+`

`+n+`

`+uCe(e.getShaderSource(t),o)}else return n}function hCe(e,t){let r=dCe(t);return"vec4 "+e+"( vec4 value ) { return LinearTo"+r[0]+r[1]+"; }"}function fCe(e,t){let r;switch(t){case bbe:r="Linear";break;case xbe:r="Reinhard";break;case wbe:r="OptimizedCineon";break;case Sbe:r="ACESFilmic";break;case Cbe:r="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),r="Linear"}return"vec3 "+e+"( vec3 color ) { return "+r+"ToneMapping( color ); }"}function pCe(e){return[e.extensionDerivatives||e.envMapCubeUVHeight||e.bumpMap||e.tangentSpaceNormalMap||e.clearcoatNormalMap||e.flatShading||e.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(e.extensionFragDepth||e.logarithmicDepthBuffer)&&e.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",e.extensionDrawBuffers&&e.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(e.extensionShaderTextureLOD||e.envMap||e.transmission)&&e.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(bv).join(`
`)}function mCe(e){let t=[];for(let r in e){let i=e[r];i!==!1&&t.push("#define "+r+" "+i)}return t.join(`
`)}function vCe(e,t){let r={},i=e.getProgramParameter(t,35721);for(let n=0;n<i;n++){let a=e.getActiveAttrib(t,n),o=a.name,s=1;a.type===35674&&(s=2),a.type===35675&&(s=3),a.type===35676&&(s=4),r[o]={type:a.type,location:e.getAttribLocation(t,o),locationSize:s}}return r}function bv(e){return e!==""}function ik(e,t){let r=t.numSpotLightShadows+t.numSpotLightMaps-t.numSpotLightShadowsWithMaps;return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,t.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,r).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,t.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function nk(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}var gCe=/^[ \t]*#include +<([\w\d./]+)>/gm;function gM(e){return e.replace(gCe,yCe)}function yCe(e,t){let r=cr[t];if(r===void 0)throw new Error("Can not resolve #include <"+t+">");return gM(r)}var bCe=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function ak(e){return e.replace(bCe,xCe)}function xCe(e,t,r,i){let n="";for(let a=parseInt(t);a<parseInt(r);a++)n+=i.replace(/\[\s*i\s*\]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a);return n}function ok(e){let t="precision "+e.precision+` float;
precision `+e.precision+" int;";return e.precision==="highp"?t+=`
#define HIGH_PRECISION`:e.precision==="mediump"?t+=`
#define MEDIUM_PRECISION`:e.precision==="lowp"&&(t+=`
#define LOW_PRECISION`),t}function wCe(e){let t="SHADOWMAP_TYPE_BASIC";return e.shadowMapType===FP?t="SHADOWMAP_TYPE_PCF":e.shadowMapType===Qye?t="SHADOWMAP_TYPE_PCF_SOFT":e.shadowMapType===yv&&(t="SHADOWMAP_TYPE_VSM"),t}function SCe(e){let t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case fh:case ph:t="ENVMAP_TYPE_CUBE";break;case p0:t="ENVMAP_TYPE_CUBE_UV";break}return t}function CCe(e){let t="ENVMAP_MODE_REFLECTION";if(e.envMap)switch(e.envMapMode){case ph:t="ENVMAP_MODE_REFRACTION";break}return t}function _Ce(e){let t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case YV:t="ENVMAP_BLENDING_MULTIPLY";break;case gbe:t="ENVMAP_BLENDING_MIX";break;case ybe:t="ENVMAP_BLENDING_ADD";break}return t}function ACe(e){let t=e.envMapCubeUVHeight;if(t===null)return null;let r=Math.log2(t)-2,i=1/t;return{texelWidth:1/(3*Math.max(Math.pow(2,r),7*16)),texelHeight:i,maxMip:r}}function MCe(e,t,r,i){let n=e.getContext(),a=r.defines,o=r.vertexShader,s=r.fragmentShader,l=wCe(r),c=SCe(r),u=CCe(r),d=_Ce(r),h=ACe(r),f=r.isWebGL2?"":pCe(r),p=mCe(a),v=n.createProgram(),m,g,y=r.glslVersion?"#version "+r.glslVersion+`
`:"";r.isRawShaderMaterial?(m=[p].filter(bv).join(`
`),m.length>0&&(m+=`
`),g=[f,p].filter(bv).join(`
`),g.length>0&&(g+=`
`)):(m=[ok(r),"#define SHADER_NAME "+r.shaderName,p,r.instancing?"#define USE_INSTANCING":"",r.instancingColor?"#define USE_INSTANCING_COLOR":"",r.supportsVertexTextures?"#define VERTEX_TEXTURES":"",r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+u:"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMap&&r.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",r.normalMap&&r.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",r.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",r.displacementMap&&r.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",r.specularColorMap?"#define USE_SPECULARCOLORMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.transmission?"#define USE_TRANSMISSION":"",r.transmissionMap?"#define USE_TRANSMISSIONMAP":"",r.thicknessMap?"#define USE_THICKNESSMAP":"",r.sheenColorMap?"#define USE_SHEENCOLORMAP":"",r.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",r.vertexTangents?"#define USE_TANGENT":"",r.vertexColors?"#define USE_COLOR":"",r.vertexAlphas?"#define USE_COLOR_ALPHA":"",r.vertexUvs?"#define USE_UV":"",r.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",r.flatShading?"#define FLAT_SHADED":"",r.skinning?"#define USE_SKINNING":"",r.morphTargets?"#define USE_MORPHTARGETS":"",r.morphNormals&&r.flatShading===!1?"#define USE_MORPHNORMALS":"",r.morphColors&&r.isWebGL2?"#define USE_MORPHCOLORS":"",r.morphTargetsCount>0&&r.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",r.morphTargetsCount>0&&r.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+r.morphTextureStride:"",r.morphTargetsCount>0&&r.isWebGL2?"#define MORPHTARGETS_COUNT "+r.morphTargetsCount:"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+l:"",r.sizeAttenuation?"#define USE_SIZEATTENUATION":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.logarithmicDepthBuffer&&r.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(bv).join(`
`),g=[f,ok(r),"#define SHADER_NAME "+r.shaderName,p,r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.matcap?"#define USE_MATCAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+c:"",r.envMap?"#define "+u:"",r.envMap?"#define "+d:"",h?"#define CUBEUV_TEXEL_WIDTH "+h.texelWidth:"",h?"#define CUBEUV_TEXEL_HEIGHT "+h.texelHeight:"",h?"#define CUBEUV_MAX_MIP "+h.maxMip+".0":"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMap&&r.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",r.normalMap&&r.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",r.clearcoat?"#define USE_CLEARCOAT":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.iridescence?"#define USE_IRIDESCENCE":"",r.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",r.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",r.specularColorMap?"#define USE_SPECULARCOLORMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.alphaTest?"#define USE_ALPHATEST":"",r.sheen?"#define USE_SHEEN":"",r.sheenColorMap?"#define USE_SHEENCOLORMAP":"",r.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",r.transmission?"#define USE_TRANSMISSION":"",r.transmissionMap?"#define USE_TRANSMISSIONMAP":"",r.thicknessMap?"#define USE_THICKNESSMAP":"",r.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",r.vertexTangents?"#define USE_TANGENT":"",r.vertexColors||r.instancingColor?"#define USE_COLOR":"",r.vertexAlphas?"#define USE_COLOR_ALPHA":"",r.vertexUvs?"#define USE_UV":"",r.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",r.gradientMap?"#define USE_GRADIENTMAP":"",r.flatShading?"#define FLAT_SHADED":"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+l:"",r.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",r.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.logarithmicDepthBuffer&&r.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",r.toneMapping!==sl?"#define TONE_MAPPING":"",r.toneMapping!==sl?cr.tonemapping_pars_fragment:"",r.toneMapping!==sl?fCe("toneMapping",r.toneMapping):"",r.dithering?"#define DITHERING":"",r.opaque?"#define OPAQUE":"",cr.encodings_pars_fragment,hCe("linearToOutputTexel",r.outputEncoding),r.useDepthPacking?"#define DEPTH_PACKING "+r.depthPacking:"",`
`].filter(bv).join(`
`)),o=gM(o),o=ik(o,r),o=nk(o,r),s=gM(s),s=ik(s,r),s=nk(s,r),o=ak(o),s=ak(s),r.isWebGL2&&r.isRawShaderMaterial!==!0&&(y=`#version 300 es
`,m=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+m,g=["#define varying in",r.glslVersion===Dz?"":"layout(location = 0) out highp vec4 pc_fragColor;",r.glslVersion===Dz?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+g);let b=y+m+o,x=y+g+s,S=tk(n,35633,b),w=tk(n,35632,x);if(n.attachShader(v,S),n.attachShader(v,w),r.index0AttributeName!==void 0?n.bindAttribLocation(v,0,r.index0AttributeName):r.morphTargets===!0&&n.bindAttribLocation(v,0,"position"),n.linkProgram(v),e.debug.checkShaderErrors){let A=n.getProgramInfoLog(v).trim(),M=n.getShaderInfoLog(S).trim(),P=n.getShaderInfoLog(w).trim(),T=!0,R=!0;if(n.getProgramParameter(v,35714)===!1){T=!1;let z=rk(n,S,"vertex"),F=rk(n,w,"fragment");console.error("THREE.WebGLProgram: Shader Error "+n.getError()+" - VALIDATE_STATUS "+n.getProgramParameter(v,35715)+`

Program Info Log: `+A+`
`+z+`
`+F)}else A!==""?console.warn("THREE.WebGLProgram: Program Info Log:",A):(M===""||P==="")&&(R=!1);R&&(this.diagnostics={runnable:T,programLog:A,vertexShader:{log:M,prefix:m},fragmentShader:{log:P,prefix:g}})}n.deleteShader(S),n.deleteShader(w);let _;this.getUniforms=function(){return _===void 0&&(_=new Nb(n,v)),_};let C;return this.getAttributes=function(){return C===void 0&&(C=vCe(n,v)),C},this.destroy=function(){i.releaseStatesOfProgram(this),n.deleteProgram(v),this.program=void 0},this.name=r.shaderName,this.id=cCe++,this.cacheKey=t,this.usedTimes=1,this.program=v,this.vertexShader=S,this.fragmentShader=w,this}var ECe=0,TCe=class{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){let t=e.vertexShader,r=e.fragmentShader,i=this._getShaderStage(t),n=this._getShaderStage(r),a=this._getShaderCacheForMaterial(e);return a.has(i)===!1&&(a.add(i),i.usedTimes++),a.has(n)===!1&&(a.add(n),n.usedTimes++),this}remove(e){let t=this.materialCache.get(e);for(let r of t)r.usedTimes--,r.usedTimes===0&&this.shaderCache.delete(r.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){let t=this.materialCache,r=t.get(e);return r===void 0&&(r=new Set,t.set(e,r)),r}_getShaderStage(e){let t=this.shaderCache,r=t.get(e);return r===void 0&&(r=new PCe(e),t.set(e,r)),r}},PCe=class{constructor(e){this.id=ECe++,this.code=e,this.usedTimes=0}};function DCe(e,t,r,i,n,a,o){let s=new VP,l=new TCe,c=[],u=n.isWebGL2,d=n.logarithmicDepthBuffer,h=n.vertexTextures,f=n.precision,p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function v(C,A,M,P,T){let R=P.fog,z=T.geometry,F=C.isMeshStandardMaterial?P.environment:null,H=(C.isMeshStandardMaterial?r:t).get(C.envMap||F),N=H&&H.mapping===p0?H.image.height:null,U=p[C.type];C.precision!==null&&(f=n.getMaxPrecision(C.precision),f!==C.precision&&console.warn("THREE.WebGLProgram.getParameters:",C.precision,"not supported, using",f,"instead."));let ie=z.morphAttributes.position||z.morphAttributes.normal||z.morphAttributes.color,te=ie!==void 0?ie.length:0,X=0;z.morphAttributes.position!==void 0&&(X=1),z.morphAttributes.normal!==void 0&&(X=2),z.morphAttributes.color!==void 0&&(X=3);let W,q,$,le;if(U){let ue=$s[U];W=ue.vertexShader,q=ue.fragmentShader}else W=C.vertexShader,q=C.fragmentShader,l.update(C),$=l.getVertexShaderID(C),le=l.getFragmentShaderID(C);let ee=e.getRenderTarget(),Q=C.alphaTest>0,ne=C.clearcoat>0,V=C.iridescence>0;return{isWebGL2:u,shaderID:U,shaderName:C.type,vertexShader:W,fragmentShader:q,defines:C.defines,customVertexShaderID:$,customFragmentShaderID:le,isRawShaderMaterial:C.isRawShaderMaterial===!0,glslVersion:C.glslVersion,precision:f,instancing:T.isInstancedMesh===!0,instancingColor:T.isInstancedMesh===!0&&T.instanceColor!==null,supportsVertexTextures:h,outputEncoding:ee===null?e.outputEncoding:ee.isXRRenderTarget===!0?ee.texture.encoding:xs,map:!!C.map,matcap:!!C.matcap,envMap:!!H,envMapMode:H&&H.mapping,envMapCubeUVHeight:N,lightMap:!!C.lightMap,aoMap:!!C.aoMap,emissiveMap:!!C.emissiveMap,bumpMap:!!C.bumpMap,normalMap:!!C.normalMap,objectSpaceNormalMap:C.normalMapType===Ube,tangentSpaceNormalMap:C.normalMapType===Nbe,decodeVideoTexture:!!C.map&&C.map.isVideoTexture===!0&&C.map.encoding===lr,clearcoat:ne,clearcoatMap:ne&&!!C.clearcoatMap,clearcoatRoughnessMap:ne&&!!C.clearcoatRoughnessMap,clearcoatNormalMap:ne&&!!C.clearcoatNormalMap,iridescence:V,iridescenceMap:V&&!!C.iridescenceMap,iridescenceThicknessMap:V&&!!C.iridescenceThicknessMap,displacementMap:!!C.displacementMap,roughnessMap:!!C.roughnessMap,metalnessMap:!!C.metalnessMap,specularMap:!!C.specularMap,specularIntensityMap:!!C.specularIntensityMap,specularColorMap:!!C.specularColorMap,opaque:C.transparent===!1&&C.blending===Qd,alphaMap:!!C.alphaMap,alphaTest:Q,gradientMap:!!C.gradientMap,sheen:C.sheen>0,sheenColorMap:!!C.sheenColorMap,sheenRoughnessMap:!!C.sheenRoughnessMap,transmission:C.transmission>0,transmissionMap:!!C.transmissionMap,thicknessMap:!!C.thicknessMap,combine:C.combine,vertexTangents:!!C.normalMap&&!!z.attributes.tangent,vertexColors:C.vertexColors,vertexAlphas:C.vertexColors===!0&&!!z.attributes.color&&z.attributes.color.itemSize===4,vertexUvs:!!C.map||!!C.bumpMap||!!C.normalMap||!!C.specularMap||!!C.alphaMap||!!C.emissiveMap||!!C.roughnessMap||!!C.metalnessMap||!!C.clearcoatMap||!!C.clearcoatRoughnessMap||!!C.clearcoatNormalMap||!!C.iridescenceMap||!!C.iridescenceThicknessMap||!!C.displacementMap||!!C.transmissionMap||!!C.thicknessMap||!!C.specularIntensityMap||!!C.specularColorMap||!!C.sheenColorMap||!!C.sheenRoughnessMap,uvsVertexOnly:!(C.map||C.bumpMap||C.normalMap||C.specularMap||C.alphaMap||C.emissiveMap||C.roughnessMap||C.metalnessMap||C.clearcoatNormalMap||C.iridescenceMap||C.iridescenceThicknessMap||C.transmission>0||C.transmissionMap||C.thicknessMap||C.specularIntensityMap||C.specularColorMap||C.sheen>0||C.sheenColorMap||C.sheenRoughnessMap)&&!!C.displacementMap,fog:!!R,useFog:C.fog===!0,fogExp2:R&&R.isFogExp2,flatShading:!!C.flatShading,sizeAttenuation:C.sizeAttenuation,logarithmicDepthBuffer:d,skinning:T.isSkinnedMesh===!0,morphTargets:z.morphAttributes.position!==void 0,morphNormals:z.morphAttributes.normal!==void 0,morphColors:z.morphAttributes.color!==void 0,morphTargetsCount:te,morphTextureStride:X,numDirLights:A.directional.length,numPointLights:A.point.length,numSpotLights:A.spot.length,numSpotLightMaps:A.spotLightMap.length,numRectAreaLights:A.rectArea.length,numHemiLights:A.hemi.length,numDirLightShadows:A.directionalShadowMap.length,numPointLightShadows:A.pointShadowMap.length,numSpotLightShadows:A.spotShadowMap.length,numSpotLightShadowsWithMaps:A.numSpotLightShadowsWithMaps,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:C.dithering,shadowMapEnabled:e.shadowMap.enabled&&M.length>0,shadowMapType:e.shadowMap.type,toneMapping:C.toneMapped?e.toneMapping:sl,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:C.premultipliedAlpha,doubleSided:C.side===ga,flipSided:C.side===Nn,useDepthPacking:!!C.depthPacking,depthPacking:C.depthPacking||0,index0AttributeName:C.index0AttributeName,extensionDerivatives:C.extensions&&C.extensions.derivatives,extensionFragDepth:C.extensions&&C.extensions.fragDepth,extensionDrawBuffers:C.extensions&&C.extensions.drawBuffers,extensionShaderTextureLOD:C.extensions&&C.extensions.shaderTextureLOD,rendererExtensionFragDepth:u||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:u||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:u||i.has("EXT_shader_texture_lod"),customProgramCacheKey:C.customProgramCacheKey()}}function m(C){let A=[];if(C.shaderID?A.push(C.shaderID):(A.push(C.customVertexShaderID),A.push(C.customFragmentShaderID)),C.defines!==void 0)for(let M in C.defines)A.push(M),A.push(C.defines[M]);return C.isRawShaderMaterial===!1&&(g(A,C),y(A,C),A.push(e.outputEncoding)),A.push(C.customProgramCacheKey),A.join()}function g(C,A){C.push(A.precision),C.push(A.outputEncoding),C.push(A.envMapMode),C.push(A.envMapCubeUVHeight),C.push(A.combine),C.push(A.vertexUvs),C.push(A.fogExp2),C.push(A.sizeAttenuation),C.push(A.morphTargetsCount),C.push(A.morphAttributeCount),C.push(A.numDirLights),C.push(A.numPointLights),C.push(A.numSpotLights),C.push(A.numSpotLightMaps),C.push(A.numHemiLights),C.push(A.numRectAreaLights),C.push(A.numDirLightShadows),C.push(A.numPointLightShadows),C.push(A.numSpotLightShadows),C.push(A.numSpotLightShadowsWithMaps),C.push(A.shadowMapType),C.push(A.toneMapping),C.push(A.numClippingPlanes),C.push(A.numClipIntersection),C.push(A.depthPacking)}function y(C,A){s.disableAll(),A.isWebGL2&&s.enable(0),A.supportsVertexTextures&&s.enable(1),A.instancing&&s.enable(2),A.instancingColor&&s.enable(3),A.map&&s.enable(4),A.matcap&&s.enable(5),A.envMap&&s.enable(6),A.lightMap&&s.enable(7),A.aoMap&&s.enable(8),A.emissiveMap&&s.enable(9),A.bumpMap&&s.enable(10),A.normalMap&&s.enable(11),A.objectSpaceNormalMap&&s.enable(12),A.tangentSpaceNormalMap&&s.enable(13),A.clearcoat&&s.enable(14),A.clearcoatMap&&s.enable(15),A.clearcoatRoughnessMap&&s.enable(16),A.clearcoatNormalMap&&s.enable(17),A.iridescence&&s.enable(18),A.iridescenceMap&&s.enable(19),A.iridescenceThicknessMap&&s.enable(20),A.displacementMap&&s.enable(21),A.specularMap&&s.enable(22),A.roughnessMap&&s.enable(23),A.metalnessMap&&s.enable(24),A.gradientMap&&s.enable(25),A.alphaMap&&s.enable(26),A.alphaTest&&s.enable(27),A.vertexColors&&s.enable(28),A.vertexAlphas&&s.enable(29),A.vertexUvs&&s.enable(30),A.vertexTangents&&s.enable(31),A.uvsVertexOnly&&s.enable(32),C.push(s.mask),s.disableAll(),A.fog&&s.enable(0),A.useFog&&s.enable(1),A.flatShading&&s.enable(2),A.logarithmicDepthBuffer&&s.enable(3),A.skinning&&s.enable(4),A.morphTargets&&s.enable(5),A.morphNormals&&s.enable(6),A.morphColors&&s.enable(7),A.premultipliedAlpha&&s.enable(8),A.shadowMapEnabled&&s.enable(9),A.physicallyCorrectLights&&s.enable(10),A.doubleSided&&s.enable(11),A.flipSided&&s.enable(12),A.useDepthPacking&&s.enable(13),A.dithering&&s.enable(14),A.specularIntensityMap&&s.enable(15),A.specularColorMap&&s.enable(16),A.transmission&&s.enable(17),A.transmissionMap&&s.enable(18),A.thicknessMap&&s.enable(19),A.sheen&&s.enable(20),A.sheenColorMap&&s.enable(21),A.sheenRoughnessMap&&s.enable(22),A.decodeVideoTexture&&s.enable(23),A.opaque&&s.enable(24),C.push(s.mask)}function b(C){let A=p[C.type],M;if(A){let P=$s[A];M=sm.clone(P.uniforms)}else M=C.uniforms;return M}function x(C,A){let M;for(let P=0,T=c.length;P<T;P++){let R=c[P];if(R.cacheKey===A){M=R,++M.usedTimes;break}}return M===void 0&&(M=new MCe(e,A,C,a),c.push(M)),M}function S(C){if(--C.usedTimes===0){let A=c.indexOf(C);c[A]=c[c.length-1],c.pop(),C.destroy()}}function w(C){l.remove(C)}function _(){l.dispose()}return{getParameters:v,getProgramCacheKey:m,getUniforms:b,acquireProgram:x,releaseProgram:S,releaseShaderCache:w,programs:c,dispose:_}}function OCe(){let e=new WeakMap;function t(a){let o=e.get(a);return o===void 0&&(o={},e.set(a,o)),o}function r(a){e.delete(a)}function i(a,o,s){e.get(a)[o]=s}function n(){e=new WeakMap}return{get:t,remove:r,update:i,dispose:n}}function RCe(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function sk(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function lk(){let e=[],t=0,r=[],i=[],n=[];function a(){t=0,r.length=0,i.length=0,n.length=0}function o(d,h,f,p,v,m){let g=e[t];return g===void 0?(g={id:d.id,object:d,geometry:h,material:f,groupOrder:p,renderOrder:d.renderOrder,z:v,group:m},e[t]=g):(g.id=d.id,g.object=d,g.geometry=h,g.material=f,g.groupOrder=p,g.renderOrder=d.renderOrder,g.z=v,g.group=m),t++,g}function s(d,h,f,p,v,m){let g=o(d,h,f,p,v,m);f.transmission>0?i.push(g):f.transparent===!0?n.push(g):r.push(g)}function l(d,h,f,p,v,m){let g=o(d,h,f,p,v,m);f.transmission>0?i.unshift(g):f.transparent===!0?n.unshift(g):r.unshift(g)}function c(d,h){r.length>1&&r.sort(d||RCe),i.length>1&&i.sort(h||sk),n.length>1&&n.sort(h||sk)}function u(){for(let d=t,h=e.length;d<h;d++){let f=e[d];if(f.id===null)break;f.id=null,f.object=null,f.geometry=null,f.material=null,f.group=null}}return{opaque:r,transmissive:i,transparent:n,init:a,push:s,unshift:l,finish:u,sort:c}}function ICe(){let e=new WeakMap;function t(i,n){let a=e.get(i),o;return a===void 0?(o=new lk,e.set(i,[o])):n>=a.length?(o=new lk,a.push(o)):o=a[n],o}function r(){e=new WeakMap}return{get:t,dispose:r}}function zCe(){let e={};return{get:function(t){if(e[t.id]!==void 0)return e[t.id];let r;switch(t.type){case"DirectionalLight":r={direction:new k,color:new Bt};break;case"SpotLight":r={position:new k,direction:new k,color:new Bt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":r={position:new k,color:new Bt,distance:0,decay:0};break;case"HemisphereLight":r={direction:new k,skyColor:new Bt,groundColor:new Bt};break;case"RectAreaLight":r={color:new Bt,position:new k,halfWidth:new k,halfHeight:new k};break}return e[t.id]=r,r}}}function kCe(){let e={};return{get:function(t){if(e[t.id]!==void 0)return e[t.id];let r;switch(t.type){case"DirectionalLight":r={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ye};break;case"SpotLight":r={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ye};break;case"PointLight":r={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ye,shadowCameraNear:1,shadowCameraFar:1e3};break}return e[t.id]=r,r}}}var LCe=0;function BCe(e,t){return(t.castShadow?2:0)-(e.castShadow?2:0)+(t.map?1:0)-(e.map?1:0)}function FCe(e,t){let r=new zCe,i=kCe(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let u=0;u<9;u++)n.probe.push(new k);let a=new k,o=new it,s=new it;function l(u,d){let h=0,f=0,p=0;for(let P=0;P<9;P++)n.probe[P].set(0,0,0);let v=0,m=0,g=0,y=0,b=0,x=0,S=0,w=0,_=0,C=0;u.sort(BCe);let A=d!==!0?Math.PI:1;for(let P=0,T=u.length;P<T;P++){let R=u[P],z=R.color,F=R.intensity,H=R.distance,N=R.shadow&&R.shadow.map?R.shadow.map.texture:null;if(R.isAmbientLight)h+=z.r*F*A,f+=z.g*F*A,p+=z.b*F*A;else if(R.isLightProbe)for(let U=0;U<9;U++)n.probe[U].addScaledVector(R.sh.coefficients[U],F);else if(R.isDirectionalLight){let U=r.get(R);if(U.color.copy(R.color).multiplyScalar(R.intensity*A),R.castShadow){let ie=R.shadow,te=i.get(R);te.shadowBias=ie.bias,te.shadowNormalBias=ie.normalBias,te.shadowRadius=ie.radius,te.shadowMapSize=ie.mapSize,n.directionalShadow[v]=te,n.directionalShadowMap[v]=N,n.directionalShadowMatrix[v]=R.shadow.matrix,x++}n.directional[v]=U,v++}else if(R.isSpotLight){let U=r.get(R);U.position.setFromMatrixPosition(R.matrixWorld),U.color.copy(z).multiplyScalar(F*A),U.distance=H,U.coneCos=Math.cos(R.angle),U.penumbraCos=Math.cos(R.angle*(1-R.penumbra)),U.decay=R.decay,n.spot[g]=U;let ie=R.shadow;if(R.map&&(n.spotLightMap[_]=R.map,_++,ie.updateMatrices(R),R.castShadow&&C++),n.spotLightMatrix[g]=ie.matrix,R.castShadow){let te=i.get(R);te.shadowBias=ie.bias,te.shadowNormalBias=ie.normalBias,te.shadowRadius=ie.radius,te.shadowMapSize=ie.mapSize,n.spotShadow[g]=te,n.spotShadowMap[g]=N,w++}g++}else if(R.isRectAreaLight){let U=r.get(R);U.color.copy(z).multiplyScalar(F),U.halfWidth.set(R.width*.5,0,0),U.halfHeight.set(0,R.height*.5,0),n.rectArea[y]=U,y++}else if(R.isPointLight){let U=r.get(R);if(U.color.copy(R.color).multiplyScalar(R.intensity*A),U.distance=R.distance,U.decay=R.decay,R.castShadow){let ie=R.shadow,te=i.get(R);te.shadowBias=ie.bias,te.shadowNormalBias=ie.normalBias,te.shadowRadius=ie.radius,te.shadowMapSize=ie.mapSize,te.shadowCameraNear=ie.camera.near,te.shadowCameraFar=ie.camera.far,n.pointShadow[m]=te,n.pointShadowMap[m]=N,n.pointShadowMatrix[m]=R.shadow.matrix,S++}n.point[m]=U,m++}else if(R.isHemisphereLight){let U=r.get(R);U.skyColor.copy(R.color).multiplyScalar(F*A),U.groundColor.copy(R.groundColor).multiplyScalar(F*A),n.hemi[b]=U,b++}}y>0&&(t.isWebGL2||e.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=ft.LTC_FLOAT_1,n.rectAreaLTC2=ft.LTC_FLOAT_2):e.has("OES_texture_half_float_linear")===!0?(n.rectAreaLTC1=ft.LTC_HALF_1,n.rectAreaLTC2=ft.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),n.ambient[0]=h,n.ambient[1]=f,n.ambient[2]=p;let M=n.hash;(M.directionalLength!==v||M.pointLength!==m||M.spotLength!==g||M.rectAreaLength!==y||M.hemiLength!==b||M.numDirectionalShadows!==x||M.numPointShadows!==S||M.numSpotShadows!==w||M.numSpotMaps!==_)&&(n.directional.length=v,n.spot.length=g,n.rectArea.length=y,n.point.length=m,n.hemi.length=b,n.directionalShadow.length=x,n.directionalShadowMap.length=x,n.pointShadow.length=S,n.pointShadowMap.length=S,n.spotShadow.length=w,n.spotShadowMap.length=w,n.directionalShadowMatrix.length=x,n.pointShadowMatrix.length=S,n.spotLightMatrix.length=w+_-C,n.spotLightMap.length=_,n.numSpotLightShadowsWithMaps=C,M.directionalLength=v,M.pointLength=m,M.spotLength=g,M.rectAreaLength=y,M.hemiLength=b,M.numDirectionalShadows=x,M.numPointShadows=S,M.numSpotShadows=w,M.numSpotMaps=_,n.version=LCe++)}function c(u,d){let h=0,f=0,p=0,v=0,m=0,g=d.matrixWorldInverse;for(let y=0,b=u.length;y<b;y++){let x=u[y];if(x.isDirectionalLight){let S=n.directional[h];S.direction.setFromMatrixPosition(x.matrixWorld),a.setFromMatrixPosition(x.target.matrixWorld),S.direction.sub(a),S.direction.transformDirection(g),h++}else if(x.isSpotLight){let S=n.spot[p];S.position.setFromMatrixPosition(x.matrixWorld),S.position.applyMatrix4(g),S.direction.setFromMatrixPosition(x.matrixWorld),a.setFromMatrixPosition(x.target.matrixWorld),S.direction.sub(a),S.direction.transformDirection(g),p++}else if(x.isRectAreaLight){let S=n.rectArea[v];S.position.setFromMatrixPosition(x.matrixWorld),S.position.applyMatrix4(g),s.identity(),o.copy(x.matrixWorld),o.premultiply(g),s.extractRotation(o),S.halfWidth.set(x.width*.5,0,0),S.halfHeight.set(0,x.height*.5,0),S.halfWidth.applyMatrix4(s),S.halfHeight.applyMatrix4(s),v++}else if(x.isPointLight){let S=n.point[f];S.position.setFromMatrixPosition(x.matrixWorld),S.position.applyMatrix4(g),f++}else if(x.isHemisphereLight){let S=n.hemi[m];S.direction.setFromMatrixPosition(x.matrixWorld),S.direction.transformDirection(g),m++}}}return{setup:l,setupView:c,state:n}}function ck(e,t){let r=new FCe(e,t),i=[],n=[];function a(){i.length=0,n.length=0}function o(u){i.push(u)}function s(u){n.push(u)}function l(u){r.setup(i,u)}function c(u){r.setupView(i,u)}return{init:a,state:{lightsArray:i,shadowsArray:n,lights:r},setupLights:l,setupLightsView:c,pushLight:o,pushShadow:s}}function NCe(e,t){let r=new WeakMap;function i(a,o=0){let s=r.get(a),l;return s===void 0?(l=new ck(e,t),r.set(a,[l])):o>=s.length?(l=new ck(e,t),s.push(l)):l=s[o],l}function n(){r=new WeakMap}return{get:i,dispose:n}}var p8=class extends m0{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=Mc,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}},UCe=class extends m0{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new k,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}},jCe=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,VCe=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function HCe(e,t,r){let i=new WP,n=new ye,a=new ye,o=new Qt,s=new p8({depthPacking:e8}),l=new UCe,c={},u=r.maxTextureSize,d={[bs]:Nn,[Nn]:bs,[ga]:ga},h=new Vr({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new ye},radius:{value:4}},vertexShader:jCe,fragmentShader:VCe}),f=h.clone();f.defines.HORIZONTAL_PASS=1;let p=new Ot;p.setAttribute("position",new qt(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));let v=new Oi(p,h),m=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=FP,this.render=function(x,S,w){if(m.enabled===!1||m.autoUpdate===!1&&m.needsUpdate===!1||x.length===0)return;let _=e.getRenderTarget(),C=e.getActiveCubeFace(),A=e.getActiveMipmapLevel(),M=e.state;M.setBlending(un),M.buffers.color.setClear(1,1,1,1),M.buffers.depth.setTest(!0),M.setScissorTest(!1);for(let P=0,T=x.length;P<T;P++){let R=x[P],z=R.shadow;if(z===void 0){console.warn("THREE.WebGLShadowMap:",R,"has no shadow.");continue}if(z.autoUpdate===!1&&z.needsUpdate===!1)continue;n.copy(z.mapSize);let F=z.getFrameExtents();if(n.multiply(F),a.copy(z.mapSize),(n.x>u||n.y>u)&&(n.x>u&&(a.x=Math.floor(u/F.x),n.x=a.x*F.x,z.mapSize.x=a.x),n.y>u&&(a.y=Math.floor(u/F.y),n.y=a.y*F.y,z.mapSize.y=a.y)),z.map===null){let N=this.type!==yv?{minFilter:Wr,magFilter:Wr}:{};z.map=new jr(n.x,n.y,N),z.map.texture.name=R.name+".shadowMap",z.camera.updateProjectionMatrix()}e.setRenderTarget(z.map),e.clear();let H=z.getViewportCount();for(let N=0;N<H;N++){let U=z.getViewport(N);o.set(a.x*U.x,a.y*U.y,a.x*U.z,a.y*U.w),M.viewport(o),z.updateMatrices(R,N),i=z.getFrustum(),b(S,w,z.camera,R,this.type)}z.isPointLightShadow!==!0&&this.type===yv&&g(z,w),z.needsUpdate=!1}m.needsUpdate=!1,e.setRenderTarget(_,C,A)};function g(x,S){let w=t.update(v);h.defines.VSM_SAMPLES!==x.blurSamples&&(h.defines.VSM_SAMPLES=x.blurSamples,f.defines.VSM_SAMPLES=x.blurSamples,h.needsUpdate=!0,f.needsUpdate=!0),x.mapPass===null&&(x.mapPass=new jr(n.x,n.y)),h.uniforms.shadow_pass.value=x.map.texture,h.uniforms.resolution.value=x.mapSize,h.uniforms.radius.value=x.radius,e.setRenderTarget(x.mapPass),e.clear(),e.renderBufferDirect(S,null,w,h,v,null),f.uniforms.shadow_pass.value=x.mapPass.texture,f.uniforms.resolution.value=x.mapSize,f.uniforms.radius.value=x.radius,e.setRenderTarget(x.map),e.clear(),e.renderBufferDirect(S,null,w,f,v,null)}function y(x,S,w,_,C,A){let M=null,P=w.isPointLight===!0?x.customDistanceMaterial:x.customDepthMaterial;if(P!==void 0)M=P;else if(M=w.isPointLight===!0?l:s,e.localClippingEnabled&&S.clipShadows===!0&&Array.isArray(S.clippingPlanes)&&S.clippingPlanes.length!==0||S.displacementMap&&S.displacementScale!==0||S.alphaMap&&S.alphaTest>0||S.map&&S.alphaTest>0){let T=M.uuid,R=S.uuid,z=c[T];z===void 0&&(z={},c[T]=z);let F=z[R];F===void 0&&(F=M.clone(),z[R]=F),M=F}return M.visible=S.visible,M.wireframe=S.wireframe,A===yv?M.side=S.shadowSide!==null?S.shadowSide:S.side:M.side=S.shadowSide!==null?S.shadowSide:d[S.side],M.alphaMap=S.alphaMap,M.alphaTest=S.alphaTest,M.map=S.map,M.clipShadows=S.clipShadows,M.clippingPlanes=S.clippingPlanes,M.clipIntersection=S.clipIntersection,M.displacementMap=S.displacementMap,M.displacementScale=S.displacementScale,M.displacementBias=S.displacementBias,M.wireframeLinewidth=S.wireframeLinewidth,M.linewidth=S.linewidth,w.isPointLight===!0&&M.isMeshDistanceMaterial===!0&&(M.referencePosition.setFromMatrixPosition(w.matrixWorld),M.nearDistance=_,M.farDistance=C),M}function b(x,S,w,_,C){if(x.visible===!1)return;if(x.layers.test(S.layers)&&(x.isMesh||x.isLine||x.isPoints)&&(x.castShadow||x.receiveShadow&&C===yv)&&(!x.frustumCulled||i.intersectsObject(x))){x.modelViewMatrix.multiplyMatrices(w.matrixWorldInverse,x.matrixWorld);let M=t.update(x),P=x.material;if(Array.isArray(P)){let T=M.groups;for(let R=0,z=T.length;R<z;R++){let F=T[R],H=P[F.materialIndex];if(H&&H.visible){let N=y(x,H,_,w.near,w.far,C);e.renderBufferDirect(w,null,M,N,x,F)}}}else if(P.visible){let T=y(x,P,_,w.near,w.far,C);e.renderBufferDirect(w,null,M,T,x,null)}}let A=x.children;for(let M=0,P=A.length;M<P;M++)b(A[M],S,w,_,C)}}function WCe(e,t,r){let i=r.isWebGL2;function n(){let pe=!1,Te=new Qt,ce=null,Re=new Qt(0,0,0,0);return{setMask:function($e){ce!==$e&&!pe&&(e.colorMask($e,$e,$e,$e),ce=$e)},setLocked:function($e){pe=$e},setClear:function($e,at,Yt,nr,Fe){Fe===!0&&($e*=nr,at*=nr,Yt*=nr),Te.set($e,at,Yt,nr),Re.equals(Te)===!1&&(e.clearColor($e,at,Yt,nr),Re.copy(Te))},reset:function(){pe=!1,ce=null,Re.set(-1,0,0,0)}}}function a(){let pe=!1,Te=null,ce=null,Re=null;return{setTest:function($e){$e?Q(2929):ne(2929)},setMask:function($e){Te!==$e&&!pe&&(e.depthMask($e),Te=$e)},setFunc:function($e){if(ce!==$e){switch($e){case ube:e.depthFunc(512);break;case dbe:e.depthFunc(519);break;case hbe:e.depthFunc(513);break;case uM:e.depthFunc(515);break;case fbe:e.depthFunc(514);break;case pbe:e.depthFunc(518);break;case mbe:e.depthFunc(516);break;case vbe:e.depthFunc(517);break;default:e.depthFunc(515)}ce=$e}},setLocked:function($e){pe=$e},setClear:function($e){Re!==$e&&(e.clearDepth($e),Re=$e)},reset:function(){pe=!1,Te=null,ce=null,Re=null}}}function o(){let pe=!1,Te=null,ce=null,Re=null,$e=null,at=null,Yt=null,nr=null,Fe=null;return{setTest:function(Ke){pe||(Ke?Q(2960):ne(2960))},setMask:function(Ke){Te!==Ke&&!pe&&(e.stencilMask(Ke),Te=Ke)},setFunc:function(Ke,dt,Nt){(ce!==Ke||Re!==dt||$e!==Nt)&&(e.stencilFunc(Ke,dt,Nt),ce=Ke,Re=dt,$e=Nt)},setOp:function(Ke,dt,Nt){(at!==Ke||Yt!==dt||nr!==Nt)&&(e.stencilOp(Ke,dt,Nt),at=Ke,Yt=dt,nr=Nt)},setLocked:function(Ke){pe=Ke},setClear:function(Ke){Fe!==Ke&&(e.clearStencil(Ke),Fe=Ke)},reset:function(){pe=!1,Te=null,ce=null,Re=null,$e=null,at=null,Yt=null,nr=null,Fe=null}}}let s=new n,l=new a,c=new o,u=new WeakMap,d=new WeakMap,h={},f={},p=new WeakMap,v=[],m=null,g=!1,y=null,b=null,x=null,S=null,w=null,_=null,C=null,A=!1,M=null,P=null,T=null,R=null,z=null,F=e.getParameter(35661),H=!1,N=0,U=e.getParameter(7938);U.indexOf("WebGL")!==-1?(N=parseFloat(/^WebGL (\d)/.exec(U)[1]),H=N>=1):U.indexOf("OpenGL ES")!==-1&&(N=parseFloat(/^OpenGL ES (\d)/.exec(U)[1]),H=N>=2);let ie=null,te={},X=e.getParameter(3088),W=e.getParameter(2978),q=new Qt().fromArray(X),$=new Qt().fromArray(W);function le(pe,Te,ce){let Re=new Uint8Array(4),$e=e.createTexture();e.bindTexture(pe,$e),e.texParameteri(pe,10241,9728),e.texParameteri(pe,10240,9728);for(let at=0;at<ce;at++)e.texImage2D(Te+at,0,6408,1,1,0,6408,5121,Re);return $e}let ee={};ee[3553]=le(3553,3553,1),ee[34067]=le(34067,34069,6),s.setClear(0,0,0,1),l.setClear(1),c.setClear(0),Q(2929),l.setFunc(uM),Se(!1),we(ez),Q(2884),Z(un);function Q(pe){h[pe]!==!0&&(e.enable(pe),h[pe]=!0)}function ne(pe){h[pe]!==!1&&(e.disable(pe),h[pe]=!1)}function V(pe,Te){return f[pe]!==Te?(e.bindFramebuffer(pe,Te),f[pe]=Te,i&&(pe===36009&&(f[36160]=Te),pe===36160&&(f[36009]=Te)),!0):!1}function ue(pe,Te){let ce=v,Re=!1;if(pe)if(ce=p.get(Te),ce===void 0&&(ce=[],p.set(Te,ce)),pe.isWebGLMultipleRenderTargets){let $e=pe.texture;if(ce.length!==$e.length||ce[0]!==36064){for(let at=0,Yt=$e.length;at<Yt;at++)ce[at]=36064+at;ce.length=$e.length,Re=!0}}else ce[0]!==36064&&(ce[0]=36064,Re=!0);else ce[0]!==1029&&(ce[0]=1029,Re=!0);Re&&(r.isWebGL2?e.drawBuffers(ce):t.get("WEBGL_draw_buffers").drawBuffersWEBGL(ce))}function ve(pe){return m!==pe?(e.useProgram(pe),m=pe,!0):!1}let Ce={[Rf]:32774,[Jye]:32778,[ebe]:32779};if(i)Ce[nz]=32775,Ce[az]=32776;else{let pe=t.get("EXT_blend_minmax");pe!==null&&(Ce[nz]=pe.MIN_EXT,Ce[az]=pe.MAX_EXT)}let G={[tbe]:0,[rbe]:1,[ibe]:768,[$V]:770,[cbe]:776,[sbe]:774,[abe]:772,[nbe]:769,[qV]:771,[lbe]:775,[obe]:773};function Z(pe,Te,ce,Re,$e,at,Yt,nr){if(pe===un){g===!0&&(ne(3042),g=!1);return}if(g===!1&&(Q(3042),g=!0),pe!==Zye){if(pe!==y||nr!==A){if((b!==Rf||w!==Rf)&&(e.blendEquation(32774),b=Rf,w=Rf),nr)switch(pe){case Qd:e.blendFuncSeparate(1,771,1,771);break;case tz:e.blendFunc(1,1);break;case rz:e.blendFuncSeparate(0,769,0,1);break;case iz:e.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",pe);break}else switch(pe){case Qd:e.blendFuncSeparate(770,771,1,771);break;case tz:e.blendFunc(770,1);break;case rz:e.blendFuncSeparate(0,769,0,1);break;case iz:e.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",pe);break}x=null,S=null,_=null,C=null,y=pe,A=nr}return}$e=$e||Te,at=at||ce,Yt=Yt||Re,(Te!==b||$e!==w)&&(e.blendEquationSeparate(Ce[Te],Ce[$e]),b=Te,w=$e),(ce!==x||Re!==S||at!==_||Yt!==C)&&(e.blendFuncSeparate(G[ce],G[Re],G[at],G[Yt]),x=ce,S=Re,_=at,C=Yt),y=pe,A=!1}function de(pe,Te){pe.side===ga?ne(2884):Q(2884);let ce=pe.side===Nn;Te&&(ce=!ce),Se(ce),pe.blending===Qd&&pe.transparent===!1?Z(un):Z(pe.blending,pe.blendEquation,pe.blendSrc,pe.blendDst,pe.blendEquationAlpha,pe.blendSrcAlpha,pe.blendDstAlpha,pe.premultipliedAlpha),l.setFunc(pe.depthFunc),l.setTest(pe.depthTest),l.setMask(pe.depthWrite),s.setMask(pe.colorWrite);let Re=pe.stencilWrite;c.setTest(Re),Re&&(c.setMask(pe.stencilWriteMask),c.setFunc(pe.stencilFunc,pe.stencilRef,pe.stencilFuncMask),c.setOp(pe.stencilFail,pe.stencilZFail,pe.stencilZPass)),Ee(pe.polygonOffset,pe.polygonOffsetFactor,pe.polygonOffsetUnits),pe.alphaToCoverage===!0?Q(32926):ne(32926)}function Se(pe){M!==pe&&(pe?e.frontFace(2304):e.frontFace(2305),M=pe)}function we(pe){pe!==Xye?(Q(2884),pe!==P&&(pe===ez?e.cullFace(1029):pe===Kye?e.cullFace(1028):e.cullFace(1032))):ne(2884),P=pe}function _e(pe){pe!==T&&(H&&e.lineWidth(pe),T=pe)}function Ee(pe,Te,ce){pe?(Q(32823),(R!==Te||z!==ce)&&(e.polygonOffset(Te,ce),R=Te,z=ce)):ne(32823)}function fe(pe){pe?Q(3089):ne(3089)}function B(pe){pe===void 0&&(pe=33984+F-1),ie!==pe&&(e.activeTexture(pe),ie=pe)}function D(pe,Te,ce){ce===void 0&&(ie===null?ce=33984+F-1:ce=ie);let Re=te[ce];Re===void 0&&(Re={type:void 0,texture:void 0},te[ce]=Re),(Re.type!==pe||Re.texture!==Te)&&(ie!==ce&&(e.activeTexture(ce),ie=ce),e.bindTexture(pe,Te||ee[pe]),Re.type=pe,Re.texture=Te)}function I(){let pe=te[ie];pe!==void 0&&pe.type!==void 0&&(e.bindTexture(pe.type,null),pe.type=void 0,pe.texture=void 0)}function O(){try{e.compressedTexImage2D.apply(e,arguments)}catch(pe){console.error("THREE.WebGLState:",pe)}}function j(){try{e.compressedTexImage3D.apply(e,arguments)}catch(pe){console.error("THREE.WebGLState:",pe)}}function L(){try{e.texSubImage2D.apply(e,arguments)}catch(pe){console.error("THREE.WebGLState:",pe)}}function Ae(){try{e.texSubImage3D.apply(e,arguments)}catch(pe){console.error("THREE.WebGLState:",pe)}}function We(){try{e.compressedTexSubImage2D.apply(e,arguments)}catch(pe){console.error("THREE.WebGLState:",pe)}}function Ve(){try{e.compressedTexSubImage3D.apply(e,arguments)}catch(pe){console.error("THREE.WebGLState:",pe)}}function ke(){try{e.texStorage2D.apply(e,arguments)}catch(pe){console.error("THREE.WebGLState:",pe)}}function et(){try{e.texStorage3D.apply(e,arguments)}catch(pe){console.error("THREE.WebGLState:",pe)}}function nt(){try{e.texImage2D.apply(e,arguments)}catch(pe){console.error("THREE.WebGLState:",pe)}}function lt(){try{e.texImage3D.apply(e,arguments)}catch(pe){console.error("THREE.WebGLState:",pe)}}function ut(pe){q.equals(pe)===!1&&(e.scissor(pe.x,pe.y,pe.z,pe.w),q.copy(pe))}function vt(pe){$.equals(pe)===!1&&(e.viewport(pe.x,pe.y,pe.z,pe.w),$.copy(pe))}function se(pe,Te){let ce=d.get(Te);ce===void 0&&(ce=new WeakMap,d.set(Te,ce));let Re=ce.get(pe);Re===void 0&&(Re=e.getUniformBlockIndex(Te,pe.name),ce.set(pe,Re))}function Be(pe,Te){let ce=d.get(Te).get(pe);u.get(Te)!==ce&&(e.uniformBlockBinding(Te,ce,pe.__bindingPointIndex),u.set(Te,ce))}function Ye(){e.disable(3042),e.disable(2884),e.disable(2929),e.disable(32823),e.disable(3089),e.disable(2960),e.disable(32926),e.blendEquation(32774),e.blendFunc(1,0),e.blendFuncSeparate(1,0,1,0),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(513),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(519,0,4294967295),e.stencilOp(7680,7680,7680),e.clearStencil(0),e.cullFace(1029),e.frontFace(2305),e.polygonOffset(0,0),e.activeTexture(33984),e.bindFramebuffer(36160,null),i===!0&&(e.bindFramebuffer(36009,null),e.bindFramebuffer(36008,null)),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),h={},ie=null,te={},f={},p=new WeakMap,v=[],m=null,g=!1,y=null,b=null,x=null,S=null,w=null,_=null,C=null,A=!1,M=null,P=null,T=null,R=null,z=null,q.set(0,0,e.canvas.width,e.canvas.height),$.set(0,0,e.canvas.width,e.canvas.height),s.reset(),l.reset(),c.reset()}return{buffers:{color:s,depth:l,stencil:c},enable:Q,disable:ne,bindFramebuffer:V,drawBuffers:ue,useProgram:ve,setBlending:Z,setMaterial:de,setFlipSided:Se,setCullFace:we,setLineWidth:_e,setPolygonOffset:Ee,setScissorTest:fe,activeTexture:B,bindTexture:D,unbindTexture:I,compressedTexImage2D:O,compressedTexImage3D:j,texImage2D:nt,texImage3D:lt,updateUBOMapping:se,uniformBlockBinding:Be,texStorage2D:ke,texStorage3D:et,texSubImage2D:L,texSubImage3D:Ae,compressedTexSubImage2D:We,compressedTexSubImage3D:Ve,scissor:ut,viewport:vt,reset:Ye}}function GCe(e,t,r,i,n,a,o){let s=n.isWebGL2,l=n.maxTextures,c=n.maxCubemapSize,u=n.maxTextureSize,d=n.maxSamples,h=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):null,f=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),p=new WeakMap,v,m=new WeakMap,g=!1;try{g=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function y(D,I){return g?new OffscreenCanvas(D,I):Tg("canvas")}function b(D,I,O,j){let L=1;if((D.width>j||D.height>j)&&(L=j/Math.max(D.width,D.height)),L<1||I===!0)if(typeof HTMLImageElement<"u"&&D instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&D instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&D instanceof ImageBitmap){let Ae=I?Vx:Math.floor,We=Ae(L*D.width),Ve=Ae(L*D.height);v===void 0&&(v=y(We,Ve));let ke=O?y(We,Ve):v;return ke.width=We,ke.height=Ve,ke.getContext("2d").drawImage(D,0,0,We,Ve),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+D.width+"x"+D.height+") to ("+We+"x"+Ve+")."),ke}else return"data"in D&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+D.width+"x"+D.height+")."),D;return D}function x(D){return vM(D.width)&&vM(D.height)}function S(D){return s?!1:D.wrapS!==_i||D.wrapT!==_i||D.minFilter!==Wr&&D.minFilter!==hr}function w(D,I){return D.generateMipmaps&&I&&D.minFilter!==Wr&&D.minFilter!==hr}function _(D){e.generateMipmap(D)}function C(D,I,O,j,L=!1){if(s===!1)return I;if(D!==null){if(e[D]!==void 0)return e[D];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+D+"'")}let Ae=I;return I===6403&&(O===5126&&(Ae=33326),O===5131&&(Ae=33325),O===5121&&(Ae=33321)),I===33319&&(O===5126&&(Ae=33328),O===5131&&(Ae=33327),O===5121&&(Ae=33323)),I===6408&&(O===5126&&(Ae=34836),O===5131&&(Ae=34842),O===5121&&(Ae=j===lr&&L===!1?35907:32856),O===32819&&(Ae=32854),O===32820&&(Ae=32855)),(Ae===33325||Ae===33326||Ae===33327||Ae===33328||Ae===34842||Ae===34836)&&t.get("EXT_color_buffer_float"),Ae}function A(D,I,O){return w(D,O)===!0||D.isFramebufferTexture&&D.minFilter!==Wr&&D.minFilter!==hr?Math.log2(Math.max(I.width,I.height))+1:D.mipmaps!==void 0&&D.mipmaps.length>0?D.mipmaps.length:D.isCompressedTexture&&Array.isArray(D.image)?I.mipmaps.length:1}function M(D){return D===Wr||D===oz||D===sC?9728:9729}function P(D){let I=D.target;I.removeEventListener("dispose",P),R(I),I.isVideoTexture&&p.delete(I)}function T(D){let I=D.target;I.removeEventListener("dispose",T),F(I)}function R(D){let I=i.get(D);if(I.__webglInit===void 0)return;let O=D.source,j=m.get(O);if(j){let L=j[I.__cacheKey];L.usedTimes--,L.usedTimes===0&&z(D),Object.keys(j).length===0&&m.delete(O)}i.remove(D)}function z(D){let I=i.get(D);e.deleteTexture(I.__webglTexture);let O=D.source,j=m.get(O);delete j[I.__cacheKey],o.memory.textures--}function F(D){let I=D.texture,O=i.get(D),j=i.get(I);if(j.__webglTexture!==void 0&&(e.deleteTexture(j.__webglTexture),o.memory.textures--),D.depthTexture&&D.depthTexture.dispose(),D.isWebGLCubeRenderTarget)for(let L=0;L<6;L++)e.deleteFramebuffer(O.__webglFramebuffer[L]),O.__webglDepthbuffer&&e.deleteRenderbuffer(O.__webglDepthbuffer[L]);else{if(e.deleteFramebuffer(O.__webglFramebuffer),O.__webglDepthbuffer&&e.deleteRenderbuffer(O.__webglDepthbuffer),O.__webglMultisampledFramebuffer&&e.deleteFramebuffer(O.__webglMultisampledFramebuffer),O.__webglColorRenderbuffer)for(let L=0;L<O.__webglColorRenderbuffer.length;L++)O.__webglColorRenderbuffer[L]&&e.deleteRenderbuffer(O.__webglColorRenderbuffer[L]);O.__webglDepthRenderbuffer&&e.deleteRenderbuffer(O.__webglDepthRenderbuffer)}if(D.isWebGLMultipleRenderTargets)for(let L=0,Ae=I.length;L<Ae;L++){let We=i.get(I[L]);We.__webglTexture&&(e.deleteTexture(We.__webglTexture),o.memory.textures--),i.remove(I[L])}i.remove(I),i.remove(D)}let H=0;function N(){H=0}function U(){let D=H;return D>=l&&console.warn("THREE.WebGLTextures: Trying to use "+D+" texture units while this GPU supports only "+l),H+=1,D}function ie(D){let I=[];return I.push(D.wrapS),I.push(D.wrapT),I.push(D.wrapR||0),I.push(D.magFilter),I.push(D.minFilter),I.push(D.anisotropy),I.push(D.internalFormat),I.push(D.format),I.push(D.type),I.push(D.generateMipmaps),I.push(D.premultiplyAlpha),I.push(D.flipY),I.push(D.unpackAlignment),I.push(D.encoding),I.join()}function te(D,I){let O=i.get(D);if(D.isVideoTexture&&fe(D),D.isRenderTargetTexture===!1&&D.version>0&&O.__version!==D.version){let j=D.image;if(j===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(j.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{ne(O,D,I);return}}r.bindTexture(3553,O.__webglTexture,33984+I)}function X(D,I){let O=i.get(D);if(D.version>0&&O.__version!==D.version){ne(O,D,I);return}r.bindTexture(35866,O.__webglTexture,33984+I)}function W(D,I){let O=i.get(D);if(D.version>0&&O.__version!==D.version){ne(O,D,I);return}r.bindTexture(32879,O.__webglTexture,33984+I)}function q(D,I){let O=i.get(D);if(D.version>0&&O.__version!==D.version){V(O,D,I);return}r.bindTexture(34067,O.__webglTexture,33984+I)}let $={[Zl]:10497,[_i]:33071,[fM]:33648},le={[Wr]:9728,[oz]:9984,[sC]:9986,[hr]:9729,[_be]:9985,[zp]:9987};function ee(D,I,O){if(O?(e.texParameteri(D,10242,$[I.wrapS]),e.texParameteri(D,10243,$[I.wrapT]),(D===32879||D===35866)&&e.texParameteri(D,32882,$[I.wrapR]),e.texParameteri(D,10240,le[I.magFilter]),e.texParameteri(D,10241,le[I.minFilter])):(e.texParameteri(D,10242,33071),e.texParameteri(D,10243,33071),(D===32879||D===35866)&&e.texParameteri(D,32882,33071),(I.wrapS!==_i||I.wrapT!==_i)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(D,10240,M(I.magFilter)),e.texParameteri(D,10241,M(I.minFilter)),I.minFilter!==Wr&&I.minFilter!==hr&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),t.has("EXT_texture_filter_anisotropic")===!0){let j=t.get("EXT_texture_filter_anisotropic");if(I.magFilter===Wr||I.minFilter!==sC&&I.minFilter!==zp||I.type===ln&&t.has("OES_texture_float_linear")===!1||s===!1&&I.type===dc&&t.has("OES_texture_half_float_linear")===!1)return;(I.anisotropy>1||i.get(I).__currentAnisotropy)&&(e.texParameterf(D,j.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(I.anisotropy,n.getMaxAnisotropy())),i.get(I).__currentAnisotropy=I.anisotropy)}}function Q(D,I){let O=!1;D.__webglInit===void 0&&(D.__webglInit=!0,I.addEventListener("dispose",P));let j=I.source,L=m.get(j);L===void 0&&(L={},m.set(j,L));let Ae=ie(I);if(Ae!==D.__cacheKey){L[Ae]===void 0&&(L[Ae]={texture:e.createTexture(),usedTimes:0},o.memory.textures++,O=!0),L[Ae].usedTimes++;let We=L[D.__cacheKey];We!==void 0&&(L[D.__cacheKey].usedTimes--,We.usedTimes===0&&z(I)),D.__cacheKey=Ae,D.__webglTexture=L[Ae].texture}return O}function ne(D,I,O){let j=3553;(I.isDataArrayTexture||I.isCompressedArrayTexture)&&(j=35866),I.isData3DTexture&&(j=32879);let L=Q(D,I),Ae=I.source;r.bindTexture(j,D.__webglTexture,33984+O);let We=i.get(Ae);if(Ae.version!==We.__version||L===!0){r.activeTexture(33984+O),e.pixelStorei(37440,I.flipY),e.pixelStorei(37441,I.premultiplyAlpha),e.pixelStorei(3317,I.unpackAlignment),e.pixelStorei(37443,0);let Ve=S(I)&&x(I.image)===!1,ke=b(I.image,Ve,!1,u);ke=B(I,ke);let et=x(ke)||s,nt=a.convert(I.format,I.encoding),lt=a.convert(I.type),ut=C(I.internalFormat,nt,lt,I.encoding,I.isVideoTexture);ee(j,I,et);let vt,se=I.mipmaps,Be=s&&I.isVideoTexture!==!0,Ye=We.__version===void 0||L===!0,pe=A(I,ke,et);if(I.isDepthTexture)ut=6402,s?I.type===ln?ut=36012:I.type===Jl?ut=33190:I.type===Zd?ut=35056:ut=33189:I.type===ln&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),I.format===Jd&&ut===6402&&I.type!==KV&&I.type!==Jl&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),I.type=Jl,lt=a.convert(I.type)),I.format===mh&&ut===6402&&(ut=34041,I.type!==Zd&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),I.type=Zd,lt=a.convert(I.type))),Ye&&(Be?r.texStorage2D(3553,1,ut,ke.width,ke.height):r.texImage2D(3553,0,ut,ke.width,ke.height,0,nt,lt,null));else if(I.isDataTexture)if(se.length>0&&et){Be&&Ye&&r.texStorage2D(3553,pe,ut,se[0].width,se[0].height);for(let Te=0,ce=se.length;Te<ce;Te++)vt=se[Te],Be?r.texSubImage2D(3553,Te,0,0,vt.width,vt.height,nt,lt,vt.data):r.texImage2D(3553,Te,ut,vt.width,vt.height,0,nt,lt,vt.data);I.generateMipmaps=!1}else Be?(Ye&&r.texStorage2D(3553,pe,ut,ke.width,ke.height),r.texSubImage2D(3553,0,0,0,ke.width,ke.height,nt,lt,ke.data)):r.texImage2D(3553,0,ut,ke.width,ke.height,0,nt,lt,ke.data);else if(I.isCompressedTexture)if(I.isCompressedArrayTexture){Be&&Ye&&r.texStorage3D(35866,pe,ut,se[0].width,se[0].height,ke.depth);for(let Te=0,ce=se.length;Te<ce;Te++)vt=se[Te],I.format!==Ln?nt!==null?Be?r.compressedTexSubImage3D(35866,Te,0,0,0,vt.width,vt.height,ke.depth,nt,vt.data,0,0):r.compressedTexImage3D(35866,Te,ut,vt.width,vt.height,ke.depth,0,vt.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Be?r.texSubImage3D(35866,Te,0,0,0,vt.width,vt.height,ke.depth,nt,lt,vt.data):r.texImage3D(35866,Te,ut,vt.width,vt.height,ke.depth,0,nt,lt,vt.data)}else{Be&&Ye&&r.texStorage2D(3553,pe,ut,se[0].width,se[0].height);for(let Te=0,ce=se.length;Te<ce;Te++)vt=se[Te],I.format!==Ln?nt!==null?Be?r.compressedTexSubImage2D(3553,Te,0,0,vt.width,vt.height,nt,vt.data):r.compressedTexImage2D(3553,Te,ut,vt.width,vt.height,0,vt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Be?r.texSubImage2D(3553,Te,0,0,vt.width,vt.height,nt,lt,vt.data):r.texImage2D(3553,Te,ut,vt.width,vt.height,0,nt,lt,vt.data)}else if(I.isDataArrayTexture)Be?(Ye&&r.texStorage3D(35866,pe,ut,ke.width,ke.height,ke.depth),r.texSubImage3D(35866,0,0,0,0,ke.width,ke.height,ke.depth,nt,lt,ke.data)):r.texImage3D(35866,0,ut,ke.width,ke.height,ke.depth,0,nt,lt,ke.data);else if(I.isData3DTexture)Be?(Ye&&r.texStorage3D(32879,pe,ut,ke.width,ke.height,ke.depth),r.texSubImage3D(32879,0,0,0,0,ke.width,ke.height,ke.depth,nt,lt,ke.data)):r.texImage3D(32879,0,ut,ke.width,ke.height,ke.depth,0,nt,lt,ke.data);else if(I.isFramebufferTexture){if(Ye)if(Be)r.texStorage2D(3553,pe,ut,ke.width,ke.height);else{let Te=ke.width,ce=ke.height;for(let Re=0;Re<pe;Re++)r.texImage2D(3553,Re,ut,Te,ce,0,nt,lt,null),Te>>=1,ce>>=1}}else if(se.length>0&&et){Be&&Ye&&r.texStorage2D(3553,pe,ut,se[0].width,se[0].height);for(let Te=0,ce=se.length;Te<ce;Te++)vt=se[Te],Be?r.texSubImage2D(3553,Te,0,0,nt,lt,vt):r.texImage2D(3553,Te,ut,nt,lt,vt);I.generateMipmaps=!1}else Be?(Ye&&r.texStorage2D(3553,pe,ut,ke.width,ke.height),r.texSubImage2D(3553,0,0,0,nt,lt,ke)):r.texImage2D(3553,0,ut,nt,lt,ke);w(I,et)&&_(j),We.__version=Ae.version,I.onUpdate&&I.onUpdate(I)}D.__version=I.version}function V(D,I,O){if(I.image.length!==6)return;let j=Q(D,I),L=I.source;r.bindTexture(34067,D.__webglTexture,33984+O);let Ae=i.get(L);if(L.version!==Ae.__version||j===!0){r.activeTexture(33984+O),e.pixelStorei(37440,I.flipY),e.pixelStorei(37441,I.premultiplyAlpha),e.pixelStorei(3317,I.unpackAlignment),e.pixelStorei(37443,0);let We=I.isCompressedTexture||I.image[0].isCompressedTexture,Ve=I.image[0]&&I.image[0].isDataTexture,ke=[];for(let Te=0;Te<6;Te++)!We&&!Ve?ke[Te]=b(I.image[Te],!1,!0,c):ke[Te]=Ve?I.image[Te].image:I.image[Te],ke[Te]=B(I,ke[Te]);let et=ke[0],nt=x(et)||s,lt=a.convert(I.format,I.encoding),ut=a.convert(I.type),vt=C(I.internalFormat,lt,ut,I.encoding),se=s&&I.isVideoTexture!==!0,Be=Ae.__version===void 0||j===!0,Ye=A(I,et,nt);ee(34067,I,nt);let pe;if(We){se&&Be&&r.texStorage2D(34067,Ye,vt,et.width,et.height);for(let Te=0;Te<6;Te++){pe=ke[Te].mipmaps;for(let ce=0;ce<pe.length;ce++){let Re=pe[ce];I.format!==Ln?lt!==null?se?r.compressedTexSubImage2D(34069+Te,ce,0,0,Re.width,Re.height,lt,Re.data):r.compressedTexImage2D(34069+Te,ce,vt,Re.width,Re.height,0,Re.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):se?r.texSubImage2D(34069+Te,ce,0,0,Re.width,Re.height,lt,ut,Re.data):r.texImage2D(34069+Te,ce,vt,Re.width,Re.height,0,lt,ut,Re.data)}}}else{pe=I.mipmaps,se&&Be&&(pe.length>0&&Ye++,r.texStorage2D(34067,Ye,vt,ke[0].width,ke[0].height));for(let Te=0;Te<6;Te++)if(Ve){se?r.texSubImage2D(34069+Te,0,0,0,ke[Te].width,ke[Te].height,lt,ut,ke[Te].data):r.texImage2D(34069+Te,0,vt,ke[Te].width,ke[Te].height,0,lt,ut,ke[Te].data);for(let ce=0;ce<pe.length;ce++){let Re=pe[ce].image[Te].image;se?r.texSubImage2D(34069+Te,ce+1,0,0,Re.width,Re.height,lt,ut,Re.data):r.texImage2D(34069+Te,ce+1,vt,Re.width,Re.height,0,lt,ut,Re.data)}}else{se?r.texSubImage2D(34069+Te,0,0,0,lt,ut,ke[Te]):r.texImage2D(34069+Te,0,vt,lt,ut,ke[Te]);for(let ce=0;ce<pe.length;ce++){let Re=pe[ce];se?r.texSubImage2D(34069+Te,ce+1,0,0,lt,ut,Re.image[Te]):r.texImage2D(34069+Te,ce+1,vt,lt,ut,Re.image[Te])}}}w(I,nt)&&_(34067),Ae.__version=L.version,I.onUpdate&&I.onUpdate(I)}D.__version=I.version}function ue(D,I,O,j,L){let Ae=a.convert(O.format,O.encoding),We=a.convert(O.type),Ve=C(O.internalFormat,Ae,We,O.encoding);i.get(I).__hasExternalTextures||(L===32879||L===35866?r.texImage3D(L,0,Ve,I.width,I.height,I.depth,0,Ae,We,null):r.texImage2D(L,0,Ve,I.width,I.height,0,Ae,We,null)),r.bindFramebuffer(36160,D),Ee(I)?h.framebufferTexture2DMultisampleEXT(36160,j,L,i.get(O).__webglTexture,0,_e(I)):(L===3553||L>=34069&&L<=34074)&&e.framebufferTexture2D(36160,j,L,i.get(O).__webglTexture,0),r.bindFramebuffer(36160,null)}function ve(D,I,O){if(e.bindRenderbuffer(36161,D),I.depthBuffer&&!I.stencilBuffer){let j=33189;if(O||Ee(I)){let L=I.depthTexture;L&&L.isDepthTexture&&(L.type===ln?j=36012:L.type===Jl&&(j=33190));let Ae=_e(I);Ee(I)?h.renderbufferStorageMultisampleEXT(36161,Ae,j,I.width,I.height):e.renderbufferStorageMultisample(36161,Ae,j,I.width,I.height)}else e.renderbufferStorage(36161,j,I.width,I.height);e.framebufferRenderbuffer(36160,36096,36161,D)}else if(I.depthBuffer&&I.stencilBuffer){let j=_e(I);O&&Ee(I)===!1?e.renderbufferStorageMultisample(36161,j,35056,I.width,I.height):Ee(I)?h.renderbufferStorageMultisampleEXT(36161,j,35056,I.width,I.height):e.renderbufferStorage(36161,34041,I.width,I.height),e.framebufferRenderbuffer(36160,33306,36161,D)}else{let j=I.isWebGLMultipleRenderTargets===!0?I.texture:[I.texture];for(let L=0;L<j.length;L++){let Ae=j[L],We=a.convert(Ae.format,Ae.encoding),Ve=a.convert(Ae.type),ke=C(Ae.internalFormat,We,Ve,Ae.encoding),et=_e(I);O&&Ee(I)===!1?e.renderbufferStorageMultisample(36161,et,ke,I.width,I.height):Ee(I)?h.renderbufferStorageMultisampleEXT(36161,et,ke,I.width,I.height):e.renderbufferStorage(36161,ke,I.width,I.height)}}e.bindRenderbuffer(36161,null)}function Ce(D,I){if(I&&I.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(r.bindFramebuffer(36160,D),!(I.depthTexture&&I.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(I.depthTexture).__webglTexture||I.depthTexture.image.width!==I.width||I.depthTexture.image.height!==I.height)&&(I.depthTexture.image.width=I.width,I.depthTexture.image.height=I.height,I.depthTexture.needsUpdate=!0),te(I.depthTexture,0);let O=i.get(I.depthTexture).__webglTexture,j=_e(I);if(I.depthTexture.format===Jd)Ee(I)?h.framebufferTexture2DMultisampleEXT(36160,36096,3553,O,0,j):e.framebufferTexture2D(36160,36096,3553,O,0);else if(I.depthTexture.format===mh)Ee(I)?h.framebufferTexture2DMultisampleEXT(36160,33306,3553,O,0,j):e.framebufferTexture2D(36160,33306,3553,O,0);else throw new Error("Unknown depthTexture format")}function G(D){let I=i.get(D),O=D.isWebGLCubeRenderTarget===!0;if(D.depthTexture&&!I.__autoAllocateDepthBuffer){if(O)throw new Error("target.depthTexture not supported in Cube render targets");Ce(I.__webglFramebuffer,D)}else if(O){I.__webglDepthbuffer=[];for(let j=0;j<6;j++)r.bindFramebuffer(36160,I.__webglFramebuffer[j]),I.__webglDepthbuffer[j]=e.createRenderbuffer(),ve(I.__webglDepthbuffer[j],D,!1)}else r.bindFramebuffer(36160,I.__webglFramebuffer),I.__webglDepthbuffer=e.createRenderbuffer(),ve(I.__webglDepthbuffer,D,!1);r.bindFramebuffer(36160,null)}function Z(D,I,O){let j=i.get(D);I!==void 0&&ue(j.__webglFramebuffer,D,D.texture,36064,3553),O!==void 0&&G(D)}function de(D){let I=D.texture,O=i.get(D),j=i.get(I);D.addEventListener("dispose",T),D.isWebGLMultipleRenderTargets!==!0&&(j.__webglTexture===void 0&&(j.__webglTexture=e.createTexture()),j.__version=I.version,o.memory.textures++);let L=D.isWebGLCubeRenderTarget===!0,Ae=D.isWebGLMultipleRenderTargets===!0,We=x(D)||s;if(L){O.__webglFramebuffer=[];for(let Ve=0;Ve<6;Ve++)O.__webglFramebuffer[Ve]=e.createFramebuffer()}else{if(O.__webglFramebuffer=e.createFramebuffer(),Ae)if(n.drawBuffers){let Ve=D.texture;for(let ke=0,et=Ve.length;ke<et;ke++){let nt=i.get(Ve[ke]);nt.__webglTexture===void 0&&(nt.__webglTexture=e.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(s&&D.samples>0&&Ee(D)===!1){let Ve=Ae?I:[I];O.__webglMultisampledFramebuffer=e.createFramebuffer(),O.__webglColorRenderbuffer=[],r.bindFramebuffer(36160,O.__webglMultisampledFramebuffer);for(let ke=0;ke<Ve.length;ke++){let et=Ve[ke];O.__webglColorRenderbuffer[ke]=e.createRenderbuffer(),e.bindRenderbuffer(36161,O.__webglColorRenderbuffer[ke]);let nt=a.convert(et.format,et.encoding),lt=a.convert(et.type),ut=C(et.internalFormat,nt,lt,et.encoding,D.isXRRenderTarget===!0),vt=_e(D);e.renderbufferStorageMultisample(36161,vt,ut,D.width,D.height),e.framebufferRenderbuffer(36160,36064+ke,36161,O.__webglColorRenderbuffer[ke])}e.bindRenderbuffer(36161,null),D.depthBuffer&&(O.__webglDepthRenderbuffer=e.createRenderbuffer(),ve(O.__webglDepthRenderbuffer,D,!0)),r.bindFramebuffer(36160,null)}}if(L){r.bindTexture(34067,j.__webglTexture),ee(34067,I,We);for(let Ve=0;Ve<6;Ve++)ue(O.__webglFramebuffer[Ve],D,I,36064,34069+Ve);w(I,We)&&_(34067),r.unbindTexture()}else if(Ae){let Ve=D.texture;for(let ke=0,et=Ve.length;ke<et;ke++){let nt=Ve[ke],lt=i.get(nt);r.bindTexture(3553,lt.__webglTexture),ee(3553,nt,We),ue(O.__webglFramebuffer,D,nt,36064+ke,3553),w(nt,We)&&_(3553)}r.unbindTexture()}else{let Ve=3553;(D.isWebGL3DRenderTarget||D.isWebGLArrayRenderTarget)&&(s?Ve=D.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),r.bindTexture(Ve,j.__webglTexture),ee(Ve,I,We),ue(O.__webglFramebuffer,D,I,36064,Ve),w(I,We)&&_(Ve),r.unbindTexture()}D.depthBuffer&&G(D)}function Se(D){let I=x(D)||s,O=D.isWebGLMultipleRenderTargets===!0?D.texture:[D.texture];for(let j=0,L=O.length;j<L;j++){let Ae=O[j];if(w(Ae,I)){let We=D.isWebGLCubeRenderTarget?34067:3553,Ve=i.get(Ae).__webglTexture;r.bindTexture(We,Ve),_(We),r.unbindTexture()}}}function we(D){if(s&&D.samples>0&&Ee(D)===!1){let I=D.isWebGLMultipleRenderTargets?D.texture:[D.texture],O=D.width,j=D.height,L=16384,Ae=[],We=D.stencilBuffer?33306:36096,Ve=i.get(D),ke=D.isWebGLMultipleRenderTargets===!0;if(ke)for(let et=0;et<I.length;et++)r.bindFramebuffer(36160,Ve.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064+et,36161,null),r.bindFramebuffer(36160,Ve.__webglFramebuffer),e.framebufferTexture2D(36009,36064+et,3553,null,0);r.bindFramebuffer(36008,Ve.__webglMultisampledFramebuffer),r.bindFramebuffer(36009,Ve.__webglFramebuffer);for(let et=0;et<I.length;et++){Ae.push(36064+et),D.depthBuffer&&Ae.push(We);let nt=Ve.__ignoreDepthValues!==void 0?Ve.__ignoreDepthValues:!1;if(nt===!1&&(D.depthBuffer&&(L|=256),D.stencilBuffer&&(L|=1024)),ke&&e.framebufferRenderbuffer(36008,36064,36161,Ve.__webglColorRenderbuffer[et]),nt===!0&&(e.invalidateFramebuffer(36008,[We]),e.invalidateFramebuffer(36009,[We])),ke){let lt=i.get(I[et]).__webglTexture;e.framebufferTexture2D(36009,36064,3553,lt,0)}e.blitFramebuffer(0,0,O,j,0,0,O,j,L,9728),f&&e.invalidateFramebuffer(36008,Ae)}if(r.bindFramebuffer(36008,null),r.bindFramebuffer(36009,null),ke)for(let et=0;et<I.length;et++){r.bindFramebuffer(36160,Ve.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064+et,36161,Ve.__webglColorRenderbuffer[et]);let nt=i.get(I[et]).__webglTexture;r.bindFramebuffer(36160,Ve.__webglFramebuffer),e.framebufferTexture2D(36009,36064+et,3553,nt,0)}r.bindFramebuffer(36009,Ve.__webglMultisampledFramebuffer)}}function _e(D){return Math.min(d,D.samples)}function Ee(D){let I=i.get(D);return s&&D.samples>0&&t.has("WEBGL_multisampled_render_to_texture")===!0&&I.__useRenderToTexture!==!1}function fe(D){let I=o.render.frame;p.get(D)!==I&&(p.set(D,I),D.update())}function B(D,I){let O=D.encoding,j=D.format,L=D.type;return D.isCompressedTexture===!0||D.isVideoTexture===!0||D.format===mM||O!==xs&&(O===lr?s===!1?t.has("EXT_sRGB")===!0&&j===Ln?(D.format=mM,D.minFilter=hr,D.generateMipmaps=!1):I=n8.sRGBToLinear(I):(j!==Ln||L!==wa)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",O)),I}this.allocateTextureUnit=U,this.resetTextureUnits=N,this.setTexture2D=te,this.setTexture2DArray=X,this.setTexture3D=W,this.setTextureCube=q,this.rebindTextures=Z,this.setupRenderTarget=de,this.updateRenderTargetMipmap=Se,this.updateMultisampleRenderTarget=we,this.setupDepthRenderbuffer=G,this.setupFrameBufferTexture=ue,this.useMultisampledRTT=Ee}function $Ce(e,t,r){let i=r.isWebGL2;function n(a,o=null){let s;if(a===wa)return 5121;if(a===Tbe)return 32819;if(a===Pbe)return 32820;if(a===Abe)return 5120;if(a===Mbe)return 5122;if(a===KV)return 5123;if(a===Ebe)return 5124;if(a===Jl)return 5125;if(a===ln)return 5126;if(a===dc)return i?5131:(s=t.get("OES_texture_half_float"),s!==null?s.HALF_FLOAT_OES:null);if(a===Dbe)return 6406;if(a===Ln)return 6408;if(a===Obe)return 6409;if(a===Rbe)return 6410;if(a===Jd)return 6402;if(a===mh)return 34041;if(a===mM)return s=t.get("EXT_sRGB"),s!==null?s.SRGB_ALPHA_EXT:null;if(a===Ibe)return 6403;if(a===zbe)return 36244;if(a===Bx)return 33319;if(a===kbe)return 33320;if(a===QV)return 36249;if(a===lC||a===cC||a===uC||a===dC)if(o===lr)if(s=t.get("WEBGL_compressed_texture_s3tc_srgb"),s!==null){if(a===lC)return s.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(a===cC)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(a===uC)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(a===dC)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(s=t.get("WEBGL_compressed_texture_s3tc"),s!==null){if(a===lC)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(a===cC)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(a===uC)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(a===dC)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(a===sz||a===lz||a===cz||a===uz)if(s=t.get("WEBGL_compressed_texture_pvrtc"),s!==null){if(a===sz)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(a===lz)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(a===cz)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(a===uz)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(a===Lbe)return s=t.get("WEBGL_compressed_texture_etc1"),s!==null?s.COMPRESSED_RGB_ETC1_WEBGL:null;if(a===dz||a===hz)if(s=t.get("WEBGL_compressed_texture_etc"),s!==null){if(a===dz)return o===lr?s.COMPRESSED_SRGB8_ETC2:s.COMPRESSED_RGB8_ETC2;if(a===hz)return o===lr?s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:s.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(a===fz||a===pz||a===mz||a===vz||a===gz||a===yz||a===bz||a===xz||a===wz||a===Sz||a===Cz||a===_z||a===Az||a===Mz)if(s=t.get("WEBGL_compressed_texture_astc"),s!==null){if(a===fz)return o===lr?s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:s.COMPRESSED_RGBA_ASTC_4x4_KHR;if(a===pz)return o===lr?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s.COMPRESSED_RGBA_ASTC_5x4_KHR;if(a===mz)return o===lr?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:s.COMPRESSED_RGBA_ASTC_5x5_KHR;if(a===vz)return o===lr?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s.COMPRESSED_RGBA_ASTC_6x5_KHR;if(a===gz)return o===lr?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:s.COMPRESSED_RGBA_ASTC_6x6_KHR;if(a===yz)return o===lr?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:s.COMPRESSED_RGBA_ASTC_8x5_KHR;if(a===bz)return o===lr?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s.COMPRESSED_RGBA_ASTC_8x6_KHR;if(a===xz)return o===lr?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:s.COMPRESSED_RGBA_ASTC_8x8_KHR;if(a===wz)return o===lr?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:s.COMPRESSED_RGBA_ASTC_10x5_KHR;if(a===Sz)return o===lr?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:s.COMPRESSED_RGBA_ASTC_10x6_KHR;if(a===Cz)return o===lr?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:s.COMPRESSED_RGBA_ASTC_10x8_KHR;if(a===_z)return o===lr?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(a===Az)return o===lr?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(a===Mz)return o===lr?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:s.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(a===hC)if(s=t.get("EXT_texture_compression_bptc"),s!==null){if(a===hC)return o===lr?s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:s.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(a===Bbe||a===Ez||a===Tz||a===Pz)if(s=t.get("EXT_texture_compression_rgtc"),s!==null){if(a===hC)return s.COMPRESSED_RED_RGTC1_EXT;if(a===Ez)return s.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(a===Tz)return s.COMPRESSED_RED_GREEN_RGTC2_EXT;if(a===Pz)return s.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return a===Zd?i?34042:(s=t.get("WEBGL_depth_texture"),s!==null?s.UNSIGNED_INT_24_8_WEBGL:null):e[a]!==void 0?e[a]:null}return{convert:n}}var qCe=class extends pa{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}},tc=class extends Xr{constructor(){super(),this.isGroup=!0,this.type="Group"}},YCe={type:"move"},FC=class{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new tc,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new tc,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new k,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new k),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new tc,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new k,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new k),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){let t=this._hand;if(t)for(let r of e.hand.values())this._getHandJoint(t,r)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,r){let i=null,n=null,a=null,o=this._targetRay,s=this._grip,l=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(l&&e.hand){a=!0;for(let p of e.hand.values()){let v=t.getJointPose(p,r),m=this._getHandJoint(l,p);v!==null&&(m.matrix.fromArray(v.transform.matrix),m.matrix.decompose(m.position,m.rotation,m.scale),m.jointRadius=v.radius),m.visible=v!==null}let c=l.joints["index-finger-tip"],u=l.joints["thumb-tip"],d=c.position.distanceTo(u.position),h=.02,f=.005;l.inputState.pinching&&d>h+f?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&d<=h-f&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else s!==null&&e.gripSpace&&(n=t.getPose(e.gripSpace,r),n!==null&&(s.matrix.fromArray(n.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale),n.linearVelocity?(s.hasLinearVelocity=!0,s.linearVelocity.copy(n.linearVelocity)):s.hasLinearVelocity=!1,n.angularVelocity?(s.hasAngularVelocity=!0,s.angularVelocity.copy(n.angularVelocity)):s.hasAngularVelocity=!1));o!==null&&(i=t.getPose(e.targetRaySpace,r),i===null&&n!==null&&(i=n),i!==null&&(o.matrix.fromArray(i.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),i.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(i.linearVelocity)):o.hasLinearVelocity=!1,i.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(i.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent(YCe)))}return o!==null&&(o.visible=i!==null),s!==null&&(s.visible=n!==null),l!==null&&(l.visible=a!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){let r=new tc;r.matrixAutoUpdate=!1,r.visible=!1,e.joints[t.jointName]=r,e.add(r)}return e.joints[t.jointName]}},Lp=class extends Ri{constructor(e,t,r,i,n,a,o,s,l,c){if(c=c!==void 0?c:Jd,c!==Jd&&c!==mh)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");r===void 0&&c===Jd&&(r=Jl),r===void 0&&c===mh&&(r=Zd),super(null,i,n,a,o,s,c,r,l),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=o!==void 0?o:Wr,this.minFilter=s!==void 0?s:Wr,this.flipY=!1,this.generateMipmaps=!1}},XCe=class extends ca{constructor(e,t){super();let r=this,i=null,n=1,a=null,o="local-floor",s=1,l=null,c=null,u=null,d=null,h=null,f=null,p=t.getContextAttributes(),v=null,m=null,g=[],y=[],b=new Set,x=new Map,S=new pa;S.layers.enable(1),S.viewport=new Qt;let w=new pa;w.layers.enable(2),w.viewport=new Qt;let _=[S,w],C=new qCe;C.layers.enable(1),C.layers.enable(2);let A=null,M=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(X){let W=g[X];return W===void 0&&(W=new FC,g[X]=W),W.getTargetRaySpace()},this.getControllerGrip=function(X){let W=g[X];return W===void 0&&(W=new FC,g[X]=W),W.getGripSpace()},this.getHand=function(X){let W=g[X];return W===void 0&&(W=new FC,g[X]=W),W.getHandSpace()};function P(X){let W=y.indexOf(X.inputSource);if(W===-1)return;let q=g[W];q!==void 0&&q.dispatchEvent({type:X.type,data:X.inputSource})}function T(){i.removeEventListener("select",P),i.removeEventListener("selectstart",P),i.removeEventListener("selectend",P),i.removeEventListener("squeeze",P),i.removeEventListener("squeezestart",P),i.removeEventListener("squeezeend",P),i.removeEventListener("end",T),i.removeEventListener("inputsourceschange",R);for(let X=0;X<g.length;X++){let W=y[X];W!==null&&(y[X]=null,g[X].disconnect(W))}A=null,M=null,e.setRenderTarget(v),h=null,d=null,u=null,i=null,m=null,te.stop(),r.isPresenting=!1,r.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(X){n=X,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(X){o=X,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l||a},this.setReferenceSpace=function(X){l=X},this.getBaseLayer=function(){return d!==null?d:h},this.getBinding=function(){return u},this.getFrame=function(){return f},this.getSession=function(){return i},this.setSession=async function(X){if(i=X,i!==null){if(v=e.getRenderTarget(),i.addEventListener("select",P),i.addEventListener("selectstart",P),i.addEventListener("selectend",P),i.addEventListener("squeeze",P),i.addEventListener("squeezestart",P),i.addEventListener("squeezeend",P),i.addEventListener("end",T),i.addEventListener("inputsourceschange",R),p.xrCompatible!==!0&&await t.makeXRCompatible(),i.renderState.layers===void 0||e.capabilities.isWebGL2===!1){let W={antialias:i.renderState.layers===void 0?p.antialias:!0,alpha:p.alpha,depth:p.depth,stencil:p.stencil,framebufferScaleFactor:n};h=new XRWebGLLayer(i,t,W),i.updateRenderState({baseLayer:h}),m=new jr(h.framebufferWidth,h.framebufferHeight,{format:Ln,type:wa,encoding:e.outputEncoding,stencilBuffer:p.stencil})}else{let W=null,q=null,$=null;p.depth&&($=p.stencil?35056:33190,W=p.stencil?mh:Jd,q=p.stencil?Zd:Jl);let le={colorFormat:32856,depthFormat:$,scaleFactor:n};u=new XRWebGLBinding(i,t),d=u.createProjectionLayer(le),i.updateRenderState({layers:[d]}),m=new jr(d.textureWidth,d.textureHeight,{format:Ln,type:wa,depthTexture:new Lp(d.textureWidth,d.textureHeight,q,void 0,void 0,void 0,void 0,void 0,void 0,W),stencilBuffer:p.stencil,encoding:e.outputEncoding,samples:p.antialias?4:0});let ee=e.properties.get(m);ee.__ignoreDepthValues=d.ignoreDepthValues}m.isXRRenderTarget=!0,this.setFoveation(s),l=null,a=await i.requestReferenceSpace(o),te.setContext(i),te.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}};function R(X){for(let W=0;W<X.removed.length;W++){let q=X.removed[W],$=y.indexOf(q);$>=0&&(y[$]=null,g[$].disconnect(q))}for(let W=0;W<X.added.length;W++){let q=X.added[W],$=y.indexOf(q);if($===-1){for(let ee=0;ee<g.length;ee++)if(ee>=y.length){y.push(q),$=ee;break}else if(y[ee]===null){y[ee]=q,$=ee;break}if($===-1)break}let le=g[$];le&&le.connect(q)}}let z=new k,F=new k;function H(X,W,q){z.setFromMatrixPosition(W.matrixWorld),F.setFromMatrixPosition(q.matrixWorld);let $=z.distanceTo(F),le=W.projectionMatrix.elements,ee=q.projectionMatrix.elements,Q=le[14]/(le[10]-1),ne=le[14]/(le[10]+1),V=(le[9]+1)/le[5],ue=(le[9]-1)/le[5],ve=(le[8]-1)/le[0],Ce=(ee[8]+1)/ee[0],G=Q*ve,Z=Q*Ce,de=$/(-ve+Ce),Se=de*-ve;W.matrixWorld.decompose(X.position,X.quaternion,X.scale),X.translateX(Se),X.translateZ(de),X.matrixWorld.compose(X.position,X.quaternion,X.scale),X.matrixWorldInverse.copy(X.matrixWorld).invert();let we=Q+de,_e=ne+de,Ee=G-Se,fe=Z+($-Se),B=V*ne/_e*we,D=ue*ne/_e*we;X.projectionMatrix.makePerspective(Ee,fe,B,D,we,_e)}function N(X,W){W===null?X.matrixWorld.copy(X.matrix):X.matrixWorld.multiplyMatrices(W.matrixWorld,X.matrix),X.matrixWorldInverse.copy(X.matrixWorld).invert()}this.updateCamera=function(X){if(i===null)return;C.near=w.near=S.near=X.near,C.far=w.far=S.far=X.far,(A!==C.near||M!==C.far)&&(i.updateRenderState({depthNear:C.near,depthFar:C.far}),A=C.near,M=C.far);let W=X.parent,q=C.cameras;N(C,W);for(let le=0;le<q.length;le++)N(q[le],W);C.matrixWorld.decompose(C.position,C.quaternion,C.scale),X.matrix.copy(C.matrix),X.matrix.decompose(X.position,X.quaternion,X.scale);let $=X.children;for(let le=0,ee=$.length;le<ee;le++)$[le].updateMatrixWorld(!0);q.length===2?H(C,S,w):C.projectionMatrix.copy(S.projectionMatrix)},this.getCamera=function(){return C},this.getFoveation=function(){if(!(d===null&&h===null))return s},this.setFoveation=function(X){s=X,d!==null&&(d.fixedFoveation=X),h!==null&&h.fixedFoveation!==void 0&&(h.fixedFoveation=X)},this.getPlanes=function(){return b};let U=null;function ie(X,W){if(c=W.getViewerPose(l||a),f=W,c!==null){let q=c.views;h!==null&&(e.setRenderTargetFramebuffer(m,h.framebuffer),e.setRenderTarget(m));let $=!1;q.length!==C.cameras.length&&(C.cameras.length=0,$=!0);for(let le=0;le<q.length;le++){let ee=q[le],Q=null;if(h!==null)Q=h.getViewport(ee);else{let V=u.getViewSubImage(d,ee);Q=V.viewport,le===0&&(e.setRenderTargetTextures(m,V.colorTexture,d.ignoreDepthValues?void 0:V.depthStencilTexture),e.setRenderTarget(m))}let ne=_[le];ne===void 0&&(ne=new pa,ne.layers.enable(le),ne.viewport=new Qt,_[le]=ne),ne.matrix.fromArray(ee.transform.matrix),ne.projectionMatrix.fromArray(ee.projectionMatrix),ne.viewport.set(Q.x,Q.y,Q.width,Q.height),le===0&&C.matrix.copy(ne.matrix),$===!0&&C.cameras.push(ne)}}for(let q=0;q<g.length;q++){let $=y[q],le=g[q];$!==null&&le!==void 0&&le.update($,W,l||a)}if(U&&U(X,W),W.detectedPlanes){r.dispatchEvent({type:"planesdetected",data:W.detectedPlanes});let q=null;for(let $ of b)W.detectedPlanes.has($)||(q===null&&(q=[]),q.push($));if(q!==null)for(let $ of q)b.delete($),x.delete($),r.dispatchEvent({type:"planeremoved",data:$});for(let $ of W.detectedPlanes)if(!b.has($))b.add($),x.set($,W.lastChangedTime),r.dispatchEvent({type:"planeadded",data:$});else{let le=x.get($);$.lastChangedTime>le&&(x.set($,$.lastChangedTime),r.dispatchEvent({type:"planechanged",data:$}))}}f=null}let te=new c8;te.setAnimationLoop(ie),this.setAnimationLoop=function(X){U=X},this.dispose=function(){}}};function KCe(e,t){function r(v,m){m.color.getRGB(v.fogColor.value,l8(e)),m.isFog?(v.fogNear.value=m.near,v.fogFar.value=m.far):m.isFogExp2&&(v.fogDensity.value=m.density)}function i(v,m,g,y,b){m.isMeshBasicMaterial||m.isMeshLambertMaterial?n(v,m):m.isMeshToonMaterial?(n(v,m),u(v,m)):m.isMeshPhongMaterial?(n(v,m),c(v,m)):m.isMeshStandardMaterial?(n(v,m),d(v,m),m.isMeshPhysicalMaterial&&h(v,m,b)):m.isMeshMatcapMaterial?(n(v,m),f(v,m)):m.isMeshDepthMaterial?n(v,m):m.isMeshDistanceMaterial?(n(v,m),p(v,m)):m.isMeshNormalMaterial?n(v,m):m.isLineBasicMaterial?(a(v,m),m.isLineDashedMaterial&&o(v,m)):m.isPointsMaterial?s(v,m,g,y):m.isSpriteMaterial?l(v,m):m.isShadowMaterial?(v.color.value.copy(m.color),v.opacity.value=m.opacity):m.isShaderMaterial&&(m.uniformsNeedUpdate=!1)}function n(v,m){v.opacity.value=m.opacity,m.color&&v.diffuse.value.copy(m.color),m.emissive&&v.emissive.value.copy(m.emissive).multiplyScalar(m.emissiveIntensity),m.map&&(v.map.value=m.map),m.alphaMap&&(v.alphaMap.value=m.alphaMap),m.bumpMap&&(v.bumpMap.value=m.bumpMap,v.bumpScale.value=m.bumpScale,m.side===Nn&&(v.bumpScale.value*=-1)),m.displacementMap&&(v.displacementMap.value=m.displacementMap,v.displacementScale.value=m.displacementScale,v.displacementBias.value=m.displacementBias),m.emissiveMap&&(v.emissiveMap.value=m.emissiveMap),m.normalMap&&(v.normalMap.value=m.normalMap,v.normalScale.value.copy(m.normalScale),m.side===Nn&&v.normalScale.value.negate()),m.specularMap&&(v.specularMap.value=m.specularMap),m.alphaTest>0&&(v.alphaTest.value=m.alphaTest);let g=t.get(m).envMap;if(g&&(v.envMap.value=g,v.flipEnvMap.value=g.isCubeTexture&&g.isRenderTargetTexture===!1?-1:1,v.reflectivity.value=m.reflectivity,v.ior.value=m.ior,v.refractionRatio.value=m.refractionRatio),m.lightMap){v.lightMap.value=m.lightMap;let x=e.physicallyCorrectLights!==!0?Math.PI:1;v.lightMapIntensity.value=m.lightMapIntensity*x}m.aoMap&&(v.aoMap.value=m.aoMap,v.aoMapIntensity.value=m.aoMapIntensity);let y;m.map?y=m.map:m.specularMap?y=m.specularMap:m.displacementMap?y=m.displacementMap:m.normalMap?y=m.normalMap:m.bumpMap?y=m.bumpMap:m.roughnessMap?y=m.roughnessMap:m.metalnessMap?y=m.metalnessMap:m.alphaMap?y=m.alphaMap:m.emissiveMap?y=m.emissiveMap:m.clearcoatMap?y=m.clearcoatMap:m.clearcoatNormalMap?y=m.clearcoatNormalMap:m.clearcoatRoughnessMap?y=m.clearcoatRoughnessMap:m.iridescenceMap?y=m.iridescenceMap:m.iridescenceThicknessMap?y=m.iridescenceThicknessMap:m.specularIntensityMap?y=m.specularIntensityMap:m.specularColorMap?y=m.specularColorMap:m.transmissionMap?y=m.transmissionMap:m.thicknessMap?y=m.thicknessMap:m.sheenColorMap?y=m.sheenColorMap:m.sheenRoughnessMap&&(y=m.sheenRoughnessMap),y!==void 0&&(y.isWebGLRenderTarget&&(y=y.texture),y.matrixAutoUpdate===!0&&y.updateMatrix(),v.uvTransform.value.copy(y.matrix));let b;m.aoMap?b=m.aoMap:m.lightMap&&(b=m.lightMap),b!==void 0&&(b.isWebGLRenderTarget&&(b=b.texture),b.matrixAutoUpdate===!0&&b.updateMatrix(),v.uv2Transform.value.copy(b.matrix))}function a(v,m){v.diffuse.value.copy(m.color),v.opacity.value=m.opacity}function o(v,m){v.dashSize.value=m.dashSize,v.totalSize.value=m.dashSize+m.gapSize,v.scale.value=m.scale}function s(v,m,g,y){v.diffuse.value.copy(m.color),v.opacity.value=m.opacity,v.size.value=m.size*g,v.scale.value=y*.5,m.map&&(v.map.value=m.map),m.alphaMap&&(v.alphaMap.value=m.alphaMap),m.alphaTest>0&&(v.alphaTest.value=m.alphaTest);let b;m.map?b=m.map:m.alphaMap&&(b=m.alphaMap),b!==void 0&&(b.matrixAutoUpdate===!0&&b.updateMatrix(),v.uvTransform.value.copy(b.matrix))}function l(v,m){v.diffuse.value.copy(m.color),v.opacity.value=m.opacity,v.rotation.value=m.rotation,m.map&&(v.map.value=m.map),m.alphaMap&&(v.alphaMap.value=m.alphaMap),m.alphaTest>0&&(v.alphaTest.value=m.alphaTest);let g;m.map?g=m.map:m.alphaMap&&(g=m.alphaMap),g!==void 0&&(g.matrixAutoUpdate===!0&&g.updateMatrix(),v.uvTransform.value.copy(g.matrix))}function c(v,m){v.specular.value.copy(m.specular),v.shininess.value=Math.max(m.shininess,1e-4)}function u(v,m){m.gradientMap&&(v.gradientMap.value=m.gradientMap)}function d(v,m){v.roughness.value=m.roughness,v.metalness.value=m.metalness,m.roughnessMap&&(v.roughnessMap.value=m.roughnessMap),m.metalnessMap&&(v.metalnessMap.value=m.metalnessMap),t.get(m).envMap&&(v.envMapIntensity.value=m.envMapIntensity)}function h(v,m,g){v.ior.value=m.ior,m.sheen>0&&(v.sheenColor.value.copy(m.sheenColor).multiplyScalar(m.sheen),v.sheenRoughness.value=m.sheenRoughness,m.sheenColorMap&&(v.sheenColorMap.value=m.sheenColorMap),m.sheenRoughnessMap&&(v.sheenRoughnessMap.value=m.sheenRoughnessMap)),m.clearcoat>0&&(v.clearcoat.value=m.clearcoat,v.clearcoatRoughness.value=m.clearcoatRoughness,m.clearcoatMap&&(v.clearcoatMap.value=m.clearcoatMap),m.clearcoatRoughnessMap&&(v.clearcoatRoughnessMap.value=m.clearcoatRoughnessMap),m.clearcoatNormalMap&&(v.clearcoatNormalScale.value.copy(m.clearcoatNormalScale),v.clearcoatNormalMap.value=m.clearcoatNormalMap,m.side===Nn&&v.clearcoatNormalScale.value.negate())),m.iridescence>0&&(v.iridescence.value=m.iridescence,v.iridescenceIOR.value=m.iridescenceIOR,v.iridescenceThicknessMinimum.value=m.iridescenceThicknessRange[0],v.iridescenceThicknessMaximum.value=m.iridescenceThicknessRange[1],m.iridescenceMap&&(v.iridescenceMap.value=m.iridescenceMap),m.iridescenceThicknessMap&&(v.iridescenceThicknessMap.value=m.iridescenceThicknessMap)),m.transmission>0&&(v.transmission.value=m.transmission,v.transmissionSamplerMap.value=g.texture,v.transmissionSamplerSize.value.set(g.width,g.height),m.transmissionMap&&(v.transmissionMap.value=m.transmissionMap),v.thickness.value=m.thickness,m.thicknessMap&&(v.thicknessMap.value=m.thicknessMap),v.attenuationDistance.value=m.attenuationDistance,v.attenuationColor.value.copy(m.attenuationColor)),v.specularIntensity.value=m.specularIntensity,v.specularColor.value.copy(m.specularColor),m.specularIntensityMap&&(v.specularIntensityMap.value=m.specularIntensityMap),m.specularColorMap&&(v.specularColorMap.value=m.specularColorMap)}function f(v,m){m.matcap&&(v.matcap.value=m.matcap)}function p(v,m){v.referencePosition.value.copy(m.referencePosition),v.nearDistance.value=m.nearDistance,v.farDistance.value=m.farDistance}return{refreshFogUniforms:r,refreshMaterialUniforms:i}}function QCe(e,t,r,i){let n={},a={},o=[],s=r.isWebGL2?e.getParameter(35375):0;function l(y,b){let x=b.program;i.uniformBlockBinding(y,x)}function c(y,b){let x=n[y.id];x===void 0&&(p(y),x=u(y),n[y.id]=x,y.addEventListener("dispose",m));let S=b.program;i.updateUBOMapping(y,S);let w=t.render.frame;a[y.id]!==w&&(h(y),a[y.id]=w)}function u(y){let b=d();y.__bindingPointIndex=b;let x=e.createBuffer(),S=y.__size,w=y.usage;return e.bindBuffer(35345,x),e.bufferData(35345,S,w),e.bindBuffer(35345,null),e.bindBufferBase(35345,b,x),x}function d(){for(let y=0;y<s;y++)if(o.indexOf(y)===-1)return o.push(y),y;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function h(y){let b=n[y.id],x=y.uniforms,S=y.__cache;e.bindBuffer(35345,b);for(let w=0,_=x.length;w<_;w++){let C=x[w];if(f(C,w,S)===!0){let A=C.__offset,M=Array.isArray(C.value)?C.value:[C.value],P=0;for(let T=0;T<M.length;T++){let R=M[T],z=v(R);typeof R=="number"?(C.__data[0]=R,e.bufferSubData(35345,A+P,C.__data)):R.isMatrix3?(C.__data[0]=R.elements[0],C.__data[1]=R.elements[1],C.__data[2]=R.elements[2],C.__data[3]=R.elements[0],C.__data[4]=R.elements[3],C.__data[5]=R.elements[4],C.__data[6]=R.elements[5],C.__data[7]=R.elements[0],C.__data[8]=R.elements[6],C.__data[9]=R.elements[7],C.__data[10]=R.elements[8],C.__data[11]=R.elements[0]):(R.toArray(C.__data,P),P+=z.storage/Float32Array.BYTES_PER_ELEMENT)}e.bufferSubData(35345,A,C.__data)}}e.bindBuffer(35345,null)}function f(y,b,x){let S=y.value;if(x[b]===void 0){if(typeof S=="number")x[b]=S;else{let w=Array.isArray(S)?S:[S],_=[];for(let C=0;C<w.length;C++)_.push(w[C].clone());x[b]=_}return!0}else if(typeof S=="number"){if(x[b]!==S)return x[b]=S,!0}else{let w=Array.isArray(x[b])?x[b]:[x[b]],_=Array.isArray(S)?S:[S];for(let C=0;C<w.length;C++){let A=w[C];if(A.equals(_[C])===!1)return A.copy(_[C]),!0}}return!1}function p(y){let b=y.uniforms,x=0,S=16,w=0;for(let _=0,C=b.length;_<C;_++){let A=b[_],M={boundary:0,storage:0},P=Array.isArray(A.value)?A.value:[A.value];for(let T=0,R=P.length;T<R;T++){let z=P[T],F=v(z);M.boundary+=F.boundary,M.storage+=F.storage}if(A.__data=new Float32Array(M.storage/Float32Array.BYTES_PER_ELEMENT),A.__offset=x,_>0){w=x%S;let T=S-w;w!==0&&T-M.boundary<0&&(x+=S-w,A.__offset=x)}x+=M.storage}return w=x%S,w>0&&(x+=S-w),y.__size=x,y.__cache={},this}function v(y){let b={boundary:0,storage:0};return typeof y=="number"?(b.boundary=4,b.storage=4):y.isVector2?(b.boundary=8,b.storage=8):y.isVector3||y.isColor?(b.boundary=16,b.storage=12):y.isVector4?(b.boundary=16,b.storage=16):y.isMatrix3?(b.boundary=48,b.storage=48):y.isMatrix4?(b.boundary=64,b.storage=64):y.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",y),b}function m(y){let b=y.target;b.removeEventListener("dispose",m);let x=o.indexOf(b.__bindingPointIndex);o.splice(x,1),e.deleteBuffer(n[b.id]),delete n[b.id],delete a[b.id]}function g(){for(let y in n)e.deleteBuffer(n[y]);o=[],n={},a={}}return{bind:l,update:c,dispose:g}}function ZCe(){let e=Tg("canvas");return e.style.display="block",e}function m8(e={}){this.isWebGLRenderer=!0;let t=e.canvas!==void 0?e.canvas:ZCe(),r=e.context!==void 0?e.context:null,i=e.depth!==void 0?e.depth:!0,n=e.stencil!==void 0?e.stencil:!0,a=e.antialias!==void 0?e.antialias:!1,o=e.premultipliedAlpha!==void 0?e.premultipliedAlpha:!0,s=e.preserveDrawingBuffer!==void 0?e.preserveDrawingBuffer:!1,l=e.powerPreference!==void 0?e.powerPreference:"default",c=e.failIfMajorPerformanceCaveat!==void 0?e.failIfMajorPerformanceCaveat:!1,u;r!==null?u=r.getContextAttributes().alpha:u=e.alpha!==void 0?e.alpha:!1;let d=null,h=null,f=[],p=[];this.domElement=t,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=xs,this.physicallyCorrectLights=!1,this.toneMapping=sl,this.toneMappingExposure=1;let v=this,m=!1,g=0,y=0,b=null,x=-1,S=null,w=new Qt,_=new Qt,C=null,A=t.width,M=t.height,P=1,T=null,R=null,z=new Qt(0,0,A,M),F=new Qt(0,0,A,M),H=!1,N=new WP,U=!1,ie=!1,te=null,X=new it,W=new ye,q=new k,$={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function le(){return b===null?P:1}let ee=r;function Q(K,Me){for(let He=0;He<K.length;He++){let Oe=K[He],Ne=t.getContext(Oe,Me);if(Ne!==null)return Ne}return null}try{let K={alpha:!0,depth:i,stencil:n,antialias:a,premultipliedAlpha:o,preserveDrawingBuffer:s,powerPreference:l,failIfMajorPerformanceCaveat:c};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${am}`),t.addEventListener("webglcontextlost",ut,!1),t.addEventListener("webglcontextrestored",vt,!1),t.addEventListener("webglcontextcreationerror",se,!1),ee===null){let Me=["webgl2","webgl","experimental-webgl"];if(v.isWebGL1Renderer===!0&&Me.shift(),ee=Q(Me,K),ee===null)throw Q(Me)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}ee.getShaderPrecisionFormat===void 0&&(ee.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(K){throw console.error("THREE.WebGLRenderer: "+K.message),K}let ne,V,ue,ve,Ce,G,Z,de,Se,we,_e,Ee,fe,B,D,I,O,j,L,Ae,We,Ve,ke,et;function nt(){ne=new dSe(ee),V=new aSe(ee,ne,e),ne.init(V),Ve=new $Ce(ee,ne,V),ue=new WCe(ee,ne,V),ve=new pSe,Ce=new OCe,G=new GCe(ee,ne,ue,Ce,V,Ve,ve),Z=new sSe(v),de=new uSe(v),Se=new Cxe(ee,V),ke=new iSe(ee,ne,Se,V),we=new hSe(ee,Se,ve,ke),_e=new ySe(ee,we,Se,ve),L=new gSe(ee,V,G),I=new oSe(Ce),Ee=new DCe(v,Z,de,ne,V,ke,I),fe=new KCe(v,Ce),B=new ICe,D=new NCe(ne,V),j=new rSe(v,Z,de,ue,_e,u,o),O=new HCe(v,_e,V),et=new QCe(ee,ve,V,ue),Ae=new nSe(ee,ne,ve,V),We=new fSe(ee,ne,ve,V),ve.programs=Ee.programs,v.capabilities=V,v.extensions=ne,v.properties=Ce,v.renderLists=B,v.shadowMap=O,v.state=ue,v.info=ve}nt();let lt=new XCe(v,ee);this.xr=lt,this.getContext=function(){return ee},this.getContextAttributes=function(){return ee.getContextAttributes()},this.forceContextLoss=function(){let K=ne.get("WEBGL_lose_context");K&&K.loseContext()},this.forceContextRestore=function(){let K=ne.get("WEBGL_lose_context");K&&K.restoreContext()},this.getPixelRatio=function(){return P},this.setPixelRatio=function(K){K!==void 0&&(P=K,this.setSize(A,M,!1))},this.getSize=function(K){return K.set(A,M)},this.setSize=function(K,Me,He){if(lt.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}A=K,M=Me,t.width=Math.floor(K*P),t.height=Math.floor(Me*P),He!==!1&&(t.style.width=K+"px",t.style.height=Me+"px"),this.setViewport(0,0,K,Me)},this.getDrawingBufferSize=function(K){return K.set(A*P,M*P).floor()},this.setDrawingBufferSize=function(K,Me,He){A=K,M=Me,P=He,t.width=Math.floor(K*He),t.height=Math.floor(Me*He),this.setViewport(0,0,K,Me)},this.getCurrentViewport=function(K){return K.copy(w)},this.getViewport=function(K){return K.copy(z)},this.setViewport=function(K,Me,He,Oe){K.isVector4?z.set(K.x,K.y,K.z,K.w):z.set(K,Me,He,Oe),ue.viewport(w.copy(z).multiplyScalar(P).floor())},this.getScissor=function(K){return K.copy(F)},this.setScissor=function(K,Me,He,Oe){K.isVector4?F.set(K.x,K.y,K.z,K.w):F.set(K,Me,He,Oe),ue.scissor(_.copy(F).multiplyScalar(P).floor())},this.getScissorTest=function(){return H},this.setScissorTest=function(K){ue.setScissorTest(H=K)},this.setOpaqueSort=function(K){T=K},this.setTransparentSort=function(K){R=K},this.getClearColor=function(K){return K.copy(j.getClearColor())},this.setClearColor=function(){j.setClearColor.apply(j,arguments)},this.getClearAlpha=function(){return j.getClearAlpha()},this.setClearAlpha=function(){j.setClearAlpha.apply(j,arguments)},this.clear=function(K=!0,Me=!0,He=!0){let Oe=0;K&&(Oe|=16384),Me&&(Oe|=256),He&&(Oe|=1024),ee.clear(Oe)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",ut,!1),t.removeEventListener("webglcontextrestored",vt,!1),t.removeEventListener("webglcontextcreationerror",se,!1),B.dispose(),D.dispose(),Ce.dispose(),Z.dispose(),de.dispose(),_e.dispose(),ke.dispose(),et.dispose(),Ee.dispose(),lt.dispose(),lt.removeEventListener("sessionstart",Re),lt.removeEventListener("sessionend",$e),te&&(te.dispose(),te=null),at.stop()};function ut(K){K.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),m=!0}function vt(){console.log("THREE.WebGLRenderer: Context Restored."),m=!1;let K=ve.autoReset,Me=O.enabled,He=O.autoUpdate,Oe=O.needsUpdate,Ne=O.type;nt(),ve.autoReset=K,O.enabled=Me,O.autoUpdate=He,O.needsUpdate=Oe,O.type=Ne}function se(K){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",K.statusMessage)}function Be(K){let Me=K.target;Me.removeEventListener("dispose",Be),Ye(Me)}function Ye(K){pe(K),Ce.remove(K)}function pe(K){let Me=Ce.get(K).programs;Me!==void 0&&(Me.forEach(function(He){Ee.releaseProgram(He)}),K.isShaderMaterial&&Ee.releaseShaderCache(K))}this.renderBufferDirect=function(K,Me,He,Oe,Ne,wt){Me===null&&(Me=$);let Rt=Ne.isMesh&&Ne.matrixWorld.determinant()<0,It=Mi(K,Me,He,Oe,Ne);ue.setMaterial(Oe,Rt);let Tt=He.index,fr=1;Oe.wireframe===!0&&(Tt=we.getWireframeAttribute(He),fr=2);let Jt=He.drawRange,Pe=He.attributes.position,Qe=Jt.start*fr,xt=(Jt.start+Jt.count)*fr;wt!==null&&(Qe=Math.max(Qe,wt.start*fr),xt=Math.min(xt,(wt.start+wt.count)*fr)),Tt!==null?(Qe=Math.max(Qe,0),xt=Math.min(xt,Tt.count)):Pe!=null&&(Qe=Math.max(Qe,0),xt=Math.min(xt,Pe.count));let Er=xt-Qe;if(Er<0||Er===1/0)return;ke.setup(Ne,Oe,It,He,Tt);let ui,Ut=Ae;if(Tt!==null&&(ui=Se.get(Tt),Ut=We,Ut.setIndex(ui)),Ne.isMesh)Oe.wireframe===!0?(ue.setLineWidth(Oe.wireframeLinewidth*le()),Ut.setMode(1)):Ut.setMode(4);else if(Ne.isLine){let ar=Oe.linewidth;ar===void 0&&(ar=1),ue.setLineWidth(ar*le()),Ne.isLineSegments?Ut.setMode(1):Ne.isLineLoop?Ut.setMode(2):Ut.setMode(3)}else Ne.isPoints?Ut.setMode(0):Ne.isSprite&&Ut.setMode(4);if(Ne.isInstancedMesh)Ut.renderInstances(Qe,Er,Ne.count);else if(He.isInstancedBufferGeometry){let ar=He._maxInstanceCount!==void 0?He._maxInstanceCount:1/0,En=Math.min(He.instanceCount,ar);Ut.renderInstances(Qe,Er,En)}else Ut.render(Qe,Er)},this.compile=function(K,Me){function He(Oe,Ne,wt){Oe.transparent===!0&&Oe.side===ga&&Oe.forceSinglePass===!1?(Oe.side=Nn,Oe.needsUpdate=!0,Nt(Oe,Ne,wt),Oe.side=bs,Oe.needsUpdate=!0,Nt(Oe,Ne,wt),Oe.side=ga):Nt(Oe,Ne,wt)}h=D.get(K),h.init(),p.push(h),K.traverseVisible(function(Oe){Oe.isLight&&Oe.layers.test(Me.layers)&&(h.pushLight(Oe),Oe.castShadow&&h.pushShadow(Oe))}),h.setupLights(v.physicallyCorrectLights),K.traverse(function(Oe){let Ne=Oe.material;if(Ne)if(Array.isArray(Ne))for(let wt=0;wt<Ne.length;wt++){let Rt=Ne[wt];He(Rt,K,Oe)}else He(Ne,K,Oe)}),p.pop(),h=null};let Te=null;function ce(K){Te&&Te(K)}function Re(){at.stop()}function $e(){at.start()}let at=new c8;at.setAnimationLoop(ce),typeof self<"u"&&at.setContext(self),this.setAnimationLoop=function(K){Te=K,lt.setAnimationLoop(K),K===null?at.stop():at.start()},lt.addEventListener("sessionstart",Re),lt.addEventListener("sessionend",$e),this.render=function(K,Me){if(Me!==void 0&&Me.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(m===!0)return;K.matrixWorldAutoUpdate===!0&&K.updateMatrixWorld(),Me.parent===null&&Me.matrixWorldAutoUpdate===!0&&Me.updateMatrixWorld(),lt.enabled===!0&&lt.isPresenting===!0&&(lt.cameraAutoUpdate===!0&&lt.updateCamera(Me),Me=lt.getCamera()),K.isScene===!0&&K.onBeforeRender(v,K,Me,b),h=D.get(K,p.length),h.init(),p.push(h),X.multiplyMatrices(Me.projectionMatrix,Me.matrixWorldInverse),N.setFromProjectionMatrix(X),ie=this.localClippingEnabled,U=I.init(this.clippingPlanes,ie),d=B.get(K,f.length),d.init(),f.push(d),Yt(K,Me,0,v.sortObjects),d.finish(),v.sortObjects===!0&&d.sort(T,R),U===!0&&I.beginShadows();let He=h.state.shadowsArray;if(O.render(He,K,Me),U===!0&&I.endShadows(),this.info.autoReset===!0&&this.info.reset(),j.render(d,K),h.setupLights(v.physicallyCorrectLights),Me.isArrayCamera){let Oe=Me.cameras;for(let Ne=0,wt=Oe.length;Ne<wt;Ne++){let Rt=Oe[Ne];nr(d,K,Rt,Rt.viewport)}}else nr(d,K,Me);b!==null&&(G.updateMultisampleRenderTarget(b),G.updateRenderTargetMipmap(b)),K.isScene===!0&&K.onAfterRender(v,K,Me),ke.resetDefaultState(),x=-1,S=null,p.pop(),p.length>0?h=p[p.length-1]:h=null,f.pop(),f.length>0?d=f[f.length-1]:d=null};function Yt(K,Me,He,Oe){if(K.visible===!1)return;if(K.layers.test(Me.layers)){if(K.isGroup)He=K.renderOrder;else if(K.isLOD)K.autoUpdate===!0&&K.update(Me);else if(K.isLight)h.pushLight(K),K.castShadow&&h.pushShadow(K);else if(K.isSprite){if(!K.frustumCulled||N.intersectsSprite(K)){Oe&&q.setFromMatrixPosition(K.matrixWorld).applyMatrix4(X);let wt=_e.update(K),Rt=K.material;Rt.visible&&d.push(K,wt,Rt,He,q.z,null)}}else if((K.isMesh||K.isLine||K.isPoints)&&(K.isSkinnedMesh&&K.skeleton.frame!==ve.render.frame&&(K.skeleton.update(),K.skeleton.frame=ve.render.frame),!K.frustumCulled||N.intersectsObject(K))){Oe&&q.setFromMatrixPosition(K.matrixWorld).applyMatrix4(X);let wt=_e.update(K),Rt=K.material;if(Array.isArray(Rt)){let It=wt.groups;for(let Tt=0,fr=It.length;Tt<fr;Tt++){let Jt=It[Tt],Pe=Rt[Jt.materialIndex];Pe&&Pe.visible&&d.push(K,wt,Pe,He,q.z,Jt)}}else Rt.visible&&d.push(K,wt,Rt,He,q.z,null)}}let Ne=K.children;for(let wt=0,Rt=Ne.length;wt<Rt;wt++)Yt(Ne[wt],Me,He,Oe)}function nr(K,Me,He,Oe){let Ne=K.opaque,wt=K.transmissive,Rt=K.transparent;h.setupLightsView(He),U===!0&&I.setGlobalState(v.clippingPlanes,He),wt.length>0&&Fe(Ne,Me,He),Oe&&ue.viewport(w.copy(Oe)),Ne.length>0&&Ke(Ne,Me,He),wt.length>0&&Ke(wt,Me,He),Rt.length>0&&Ke(Rt,Me,He),ue.buffers.depth.setTest(!0),ue.buffers.depth.setMask(!0),ue.buffers.color.setMask(!0),ue.setPolygonOffset(!1)}function Fe(K,Me,He){let Oe=V.isWebGL2;te===null&&(te=new jr(1,1,{generateMipmaps:!0,type:ne.has("EXT_color_buffer_half_float")?dc:wa,minFilter:zp,samples:Oe&&a===!0?4:0})),v.getDrawingBufferSize(W),Oe?te.setSize(W.x,W.y):te.setSize(Vx(W.x),Vx(W.y));let Ne=v.getRenderTarget();v.setRenderTarget(te),v.clear();let wt=v.toneMapping;v.toneMapping=sl,Ke(K,Me,He),v.toneMapping=wt,G.updateMultisampleRenderTarget(te),G.updateRenderTargetMipmap(te),v.setRenderTarget(Ne)}function Ke(K,Me,He){let Oe=Me.isScene===!0?Me.overrideMaterial:null;for(let Ne=0,wt=K.length;Ne<wt;Ne++){let Rt=K[Ne],It=Rt.object,Tt=Rt.geometry,fr=Oe===null?Rt.material:Oe,Jt=Rt.group;It.layers.test(He.layers)&&dt(It,Me,He,Tt,fr,Jt)}}function dt(K,Me,He,Oe,Ne,wt){K.onBeforeRender(v,Me,He,Oe,Ne,wt),K.modelViewMatrix.multiplyMatrices(He.matrixWorldInverse,K.matrixWorld),K.normalMatrix.getNormalMatrix(K.modelViewMatrix),Ne.onBeforeRender(v,Me,He,Oe,K,wt),Ne.transparent===!0&&Ne.side===ga&&Ne.forceSinglePass===!1?(Ne.side=Nn,Ne.needsUpdate=!0,v.renderBufferDirect(He,Me,Oe,Ne,K,wt),Ne.side=bs,Ne.needsUpdate=!0,v.renderBufferDirect(He,Me,Oe,Ne,K,wt),Ne.side=ga):v.renderBufferDirect(He,Me,Oe,Ne,K,wt),K.onAfterRender(v,Me,He,Oe,Ne,wt)}function Nt(K,Me,He){Me.isScene!==!0&&(Me=$);let Oe=Ce.get(K),Ne=h.state.lights,wt=h.state.shadowsArray,Rt=Ne.state.version,It=Ee.getParameters(K,Ne.state,wt,Me,He),Tt=Ee.getProgramCacheKey(It),fr=Oe.programs;Oe.environment=K.isMeshStandardMaterial?Me.environment:null,Oe.fog=Me.fog,Oe.envMap=(K.isMeshStandardMaterial?de:Z).get(K.envMap||Oe.environment),fr===void 0&&(K.addEventListener("dispose",Be),fr=new Map,Oe.programs=fr);let Jt=fr.get(Tt);if(Jt!==void 0){if(Oe.currentProgram===Jt&&Oe.lightsStateVersion===Rt)return hi(K,It),Jt}else It.uniforms=Ee.getUniforms(K),K.onBuild(He,It,v),K.onBeforeCompile(It,v),Jt=Ee.acquireProgram(It,Tt),fr.set(Tt,Jt),Oe.uniforms=It.uniforms;let Pe=Oe.uniforms;(!K.isShaderMaterial&&!K.isRawShaderMaterial||K.clipping===!0)&&(Pe.clippingPlanes=I.uniform),hi(K,It),Oe.needsLights=De(K),Oe.lightsStateVersion=Rt,Oe.needsLights&&(Pe.ambientLightColor.value=Ne.state.ambient,Pe.lightProbe.value=Ne.state.probe,Pe.directionalLights.value=Ne.state.directional,Pe.directionalLightShadows.value=Ne.state.directionalShadow,Pe.spotLights.value=Ne.state.spot,Pe.spotLightShadows.value=Ne.state.spotShadow,Pe.rectAreaLights.value=Ne.state.rectArea,Pe.ltc_1.value=Ne.state.rectAreaLTC1,Pe.ltc_2.value=Ne.state.rectAreaLTC2,Pe.pointLights.value=Ne.state.point,Pe.pointLightShadows.value=Ne.state.pointShadow,Pe.hemisphereLights.value=Ne.state.hemi,Pe.directionalShadowMap.value=Ne.state.directionalShadowMap,Pe.directionalShadowMatrix.value=Ne.state.directionalShadowMatrix,Pe.spotShadowMap.value=Ne.state.spotShadowMap,Pe.spotLightMatrix.value=Ne.state.spotLightMatrix,Pe.spotLightMap.value=Ne.state.spotLightMap,Pe.pointShadowMap.value=Ne.state.pointShadowMap,Pe.pointShadowMatrix.value=Ne.state.pointShadowMatrix);let Qe=Jt.getUniforms(),xt=Nb.seqWithValue(Qe.seq,Pe);return Oe.currentProgram=Jt,Oe.uniformsList=xt,Jt}function hi(K,Me){let He=Ce.get(K);He.outputEncoding=Me.outputEncoding,He.instancing=Me.instancing,He.skinning=Me.skinning,He.morphTargets=Me.morphTargets,He.morphNormals=Me.morphNormals,He.morphColors=Me.morphColors,He.morphTargetsCount=Me.morphTargetsCount,He.numClippingPlanes=Me.numClippingPlanes,He.numIntersection=Me.numClipIntersection,He.vertexAlphas=Me.vertexAlphas,He.vertexTangents=Me.vertexTangents,He.toneMapping=Me.toneMapping}function Mi(K,Me,He,Oe,Ne){Me.isScene!==!0&&(Me=$),G.resetTextureUnits();let wt=Me.fog,Rt=Oe.isMeshStandardMaterial?Me.environment:null,It=b===null?v.outputEncoding:b.isXRRenderTarget===!0?b.texture.encoding:xs,Tt=(Oe.isMeshStandardMaterial?de:Z).get(Oe.envMap||Rt),fr=Oe.vertexColors===!0&&!!He.attributes.color&&He.attributes.color.itemSize===4,Jt=!!Oe.normalMap&&!!He.attributes.tangent,Pe=!!He.morphAttributes.position,Qe=!!He.morphAttributes.normal,xt=!!He.morphAttributes.color,Er=Oe.toneMapped?v.toneMapping:sl,ui=He.morphAttributes.position||He.morphAttributes.normal||He.morphAttributes.color,Ut=ui!==void 0?ui.length:0,ar=Ce.get(Oe),En=h.state.lights;if(U===!0&&(ie===!0||K!==S)){let ae=K===S&&Oe.id===x;I.setState(Oe,K,ae)}let er=!1;Oe.version===ar.__version?(ar.needsLights&&ar.lightsStateVersion!==En.state.version||ar.outputEncoding!==It||Ne.isInstancedMesh&&ar.instancing===!1||!Ne.isInstancedMesh&&ar.instancing===!0||Ne.isSkinnedMesh&&ar.skinning===!1||!Ne.isSkinnedMesh&&ar.skinning===!0||ar.envMap!==Tt||Oe.fog===!0&&ar.fog!==wt||ar.numClippingPlanes!==void 0&&(ar.numClippingPlanes!==I.numPlanes||ar.numIntersection!==I.numIntersection)||ar.vertexAlphas!==fr||ar.vertexTangents!==Jt||ar.morphTargets!==Pe||ar.morphNormals!==Qe||ar.morphColors!==xt||ar.toneMapping!==Er||V.isWebGL2===!0&&ar.morphTargetsCount!==Ut)&&(er=!0):(er=!0,ar.__version=Oe.version);let co=ar.currentProgram;er===!0&&(co=Nt(Oe,Me,Ne));let qo=!1,yo=!1,ja=!1,Y=co.getUniforms(),J=ar.uniforms;if(ue.useProgram(co.program)&&(qo=!0,yo=!0,ja=!0),Oe.id!==x&&(x=Oe.id,yo=!0),qo||S!==K){if(Y.setValue(ee,"projectionMatrix",K.projectionMatrix),V.logarithmicDepthBuffer&&Y.setValue(ee,"logDepthBufFC",2/(Math.log(K.far+1)/Math.LN2)),S!==K&&(S=K,yo=!0,ja=!0),Oe.isShaderMaterial||Oe.isMeshPhongMaterial||Oe.isMeshToonMaterial||Oe.isMeshStandardMaterial||Oe.envMap){let ae=Y.map.cameraPosition;ae!==void 0&&ae.setValue(ee,q.setFromMatrixPosition(K.matrixWorld))}(Oe.isMeshPhongMaterial||Oe.isMeshToonMaterial||Oe.isMeshLambertMaterial||Oe.isMeshBasicMaterial||Oe.isMeshStandardMaterial||Oe.isShaderMaterial)&&Y.setValue(ee,"isOrthographic",K.isOrthographicCamera===!0),(Oe.isMeshPhongMaterial||Oe.isMeshToonMaterial||Oe.isMeshLambertMaterial||Oe.isMeshBasicMaterial||Oe.isMeshStandardMaterial||Oe.isShaderMaterial||Oe.isShadowMaterial||Ne.isSkinnedMesh)&&Y.setValue(ee,"viewMatrix",K.matrixWorldInverse)}if(Ne.isSkinnedMesh){Y.setOptional(ee,Ne,"bindMatrix"),Y.setOptional(ee,Ne,"bindMatrixInverse");let ae=Ne.skeleton;ae&&(V.floatVertexTextures?(ae.boneTexture===null&&ae.computeBoneTexture(),Y.setValue(ee,"boneTexture",ae.boneTexture,G),Y.setValue(ee,"boneTextureSize",ae.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}let be=He.morphAttributes;if((be.position!==void 0||be.normal!==void 0||be.color!==void 0&&V.isWebGL2===!0)&&L.update(Ne,He,Oe,co),(yo||ar.receiveShadow!==Ne.receiveShadow)&&(ar.receiveShadow=Ne.receiveShadow,Y.setValue(ee,"receiveShadow",Ne.receiveShadow)),Oe.isMeshGouraudMaterial&&Oe.envMap!==null&&(J.envMap.value=Tt,J.flipEnvMap.value=Tt.isCubeTexture&&Tt.isRenderTargetTexture===!1?-1:1),yo&&(Y.setValue(ee,"toneMappingExposure",v.toneMappingExposure),ar.needsLights&&Mr(J,ja),wt&&Oe.fog===!0&&fe.refreshFogUniforms(J,wt),fe.refreshMaterialUniforms(J,Oe,P,M,te),Nb.upload(ee,ar.uniformsList,J,G)),Oe.isShaderMaterial&&Oe.uniformsNeedUpdate===!0&&(Nb.upload(ee,ar.uniformsList,J,G),Oe.uniformsNeedUpdate=!1),Oe.isSpriteMaterial&&Y.setValue(ee,"center",Ne.center),Y.setValue(ee,"modelViewMatrix",Ne.modelViewMatrix),Y.setValue(ee,"normalMatrix",Ne.normalMatrix),Y.setValue(ee,"modelMatrix",Ne.matrixWorld),Ne.previousModelViewMatrix&&Y.setValue(ee,"previousModelViewMatrix",Ne.previousModelViewMatrix),K.previousProjectionMatrix&&Y.setValue(ee,"previousProjectionMatrix",K.previousProjectionMatrix),Oe.isShaderMaterial||Oe.isRawShaderMaterial){let ae=Oe.uniformsGroups;for(let Ie=0,ot=ae.length;Ie<ot;Ie++)if(V.isWebGL2){let Yo=ae[Ie];et.update(Yo,co),et.bind(Yo,co)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return co}function Mr(K,Me){K.ambientLightColor.needsUpdate=Me,K.lightProbe.needsUpdate=Me,K.directionalLights.needsUpdate=Me,K.directionalLightShadows.needsUpdate=Me,K.pointLights.needsUpdate=Me,K.pointLightShadows.needsUpdate=Me,K.spotLights.needsUpdate=Me,K.spotLightShadows.needsUpdate=Me,K.rectAreaLights.needsUpdate=Me,K.hemisphereLights.needsUpdate=Me}function De(K){return K.isMeshLambertMaterial||K.isMeshToonMaterial||K.isMeshPhongMaterial||K.isMeshStandardMaterial||K.isShadowMaterial||K.isShaderMaterial&&K.lights===!0}this.getActiveCubeFace=function(){return g},this.getActiveMipmapLevel=function(){return y},this.getRenderTarget=function(){return b},this.setRenderTargetTextures=function(K,Me,He){Ce.get(K.texture).__webglTexture=Me,Ce.get(K.depthTexture).__webglTexture=He;let Oe=Ce.get(K);Oe.__hasExternalTextures=!0,Oe.__hasExternalTextures&&(Oe.__autoAllocateDepthBuffer=He===void 0,Oe.__autoAllocateDepthBuffer||ne.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),Oe.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(K,Me){let He=Ce.get(K);He.__webglFramebuffer=Me,He.__useDefaultFramebuffer=Me===void 0},this.setRenderTarget=function(K,Me=0,He=0){b=K,g=Me,y=He;let Oe=!0,Ne=null,wt=!1,Rt=!1;if(K){let It=Ce.get(K);It.__useDefaultFramebuffer!==void 0?(ue.bindFramebuffer(36160,null),Oe=!1):It.__webglFramebuffer===void 0?G.setupRenderTarget(K):It.__hasExternalTextures&&G.rebindTextures(K,Ce.get(K.texture).__webglTexture,Ce.get(K.depthTexture).__webglTexture);let Tt=K.texture;(Tt.isData3DTexture||Tt.isDataArrayTexture||Tt.isCompressedArrayTexture)&&(Rt=!0);let fr=Ce.get(K).__webglFramebuffer;K.isWebGLCubeRenderTarget?(Ne=fr[Me],wt=!0):V.isWebGL2&&K.samples>0&&G.useMultisampledRTT(K)===!1?Ne=Ce.get(K).__webglMultisampledFramebuffer:Ne=fr,w.copy(K.viewport),_.copy(K.scissor),C=K.scissorTest}else w.copy(z).multiplyScalar(P).floor(),_.copy(F).multiplyScalar(P).floor(),C=H;if(ue.bindFramebuffer(36160,Ne)&&V.drawBuffers&&Oe&&ue.drawBuffers(K,Ne),ue.viewport(w),ue.scissor(_),ue.setScissorTest(C),wt){let It=Ce.get(K.texture);ee.framebufferTexture2D(36160,36064,34069+Me,It.__webglTexture,He)}else if(Rt){let It=Ce.get(K.texture),Tt=Me||0;ee.framebufferTextureLayer(36160,36064,It.__webglTexture,He||0,Tt)}x=-1},this.readRenderTargetPixels=function(K,Me,He,Oe,Ne,wt,Rt){if(!(K&&K.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let It=Ce.get(K).__webglFramebuffer;if(K.isWebGLCubeRenderTarget&&Rt!==void 0&&(It=It[Rt]),It){ue.bindFramebuffer(36160,It);try{let Tt=K.texture,fr=Tt.format,Jt=Tt.type;if(fr!==Ln&&Ve.convert(fr)!==ee.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}let Pe=Jt===dc&&(ne.has("EXT_color_buffer_half_float")||V.isWebGL2&&ne.has("EXT_color_buffer_float"));if(Jt!==wa&&Ve.convert(Jt)!==ee.getParameter(35738)&&!(Jt===ln&&(V.isWebGL2||ne.has("OES_texture_float")||ne.has("WEBGL_color_buffer_float")))&&!Pe){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}Me>=0&&Me<=K.width-Oe&&He>=0&&He<=K.height-Ne&&ee.readPixels(Me,He,Oe,Ne,Ve.convert(fr),Ve.convert(Jt),wt)}finally{let Tt=b!==null?Ce.get(b).__webglFramebuffer:null;ue.bindFramebuffer(36160,Tt)}}},this.copyFramebufferToTexture=function(K,Me,He=0){let Oe=Math.pow(2,-He),Ne=Math.floor(Me.image.width*Oe),wt=Math.floor(Me.image.height*Oe);G.setTexture2D(Me,0),ee.copyTexSubImage2D(3553,He,0,0,K.x,K.y,Ne,wt),ue.unbindTexture()},this.copyTextureToTexture=function(K,Me,He,Oe=0){let Ne=Me.image.width,wt=Me.image.height,Rt=Ve.convert(He.format),It=Ve.convert(He.type);G.setTexture2D(He,0),ee.pixelStorei(37440,He.flipY),ee.pixelStorei(37441,He.premultiplyAlpha),ee.pixelStorei(3317,He.unpackAlignment),Me.isDataTexture?ee.texSubImage2D(3553,Oe,K.x,K.y,Ne,wt,Rt,It,Me.image.data):Me.isCompressedTexture?ee.compressedTexSubImage2D(3553,Oe,K.x,K.y,Me.mipmaps[0].width,Me.mipmaps[0].height,Rt,Me.mipmaps[0].data):ee.texSubImage2D(3553,Oe,K.x,K.y,Rt,It,Me.image),Oe===0&&He.generateMipmaps&&ee.generateMipmap(3553),ue.unbindTexture()},this.copyTextureToTexture3D=function(K,Me,He,Oe,Ne=0){if(v.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}let wt=K.max.x-K.min.x+1,Rt=K.max.y-K.min.y+1,It=K.max.z-K.min.z+1,Tt=Ve.convert(Oe.format),fr=Ve.convert(Oe.type),Jt;if(Oe.isData3DTexture)G.setTexture3D(Oe,0),Jt=32879;else if(Oe.isDataArrayTexture)G.setTexture2DArray(Oe,0),Jt=35866;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}ee.pixelStorei(37440,Oe.flipY),ee.pixelStorei(37441,Oe.premultiplyAlpha),ee.pixelStorei(3317,Oe.unpackAlignment);let Pe=ee.getParameter(3314),Qe=ee.getParameter(32878),xt=ee.getParameter(3316),Er=ee.getParameter(3315),ui=ee.getParameter(32877),Ut=He.isCompressedTexture?He.mipmaps[0]:He.image;ee.pixelStorei(3314,Ut.width),ee.pixelStorei(32878,Ut.height),ee.pixelStorei(3316,K.min.x),ee.pixelStorei(3315,K.min.y),ee.pixelStorei(32877,K.min.z),He.isDataTexture||He.isData3DTexture?ee.texSubImage3D(Jt,Ne,Me.x,Me.y,Me.z,wt,Rt,It,Tt,fr,Ut.data):He.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),ee.compressedTexSubImage3D(Jt,Ne,Me.x,Me.y,Me.z,wt,Rt,It,Tt,Ut.data)):ee.texSubImage3D(Jt,Ne,Me.x,Me.y,Me.z,wt,Rt,It,Tt,fr,Ut),ee.pixelStorei(3314,Pe),ee.pixelStorei(32878,Qe),ee.pixelStorei(3316,xt),ee.pixelStorei(3315,Er),ee.pixelStorei(32877,ui),Ne===0&&Oe.generateMipmaps&&ee.generateMipmap(Jt),ue.unbindTexture()},this.initTexture=function(K){K.isCubeTexture?G.setTextureCube(K,0):K.isData3DTexture?G.setTexture3D(K,0):K.isDataArrayTexture||K.isCompressedArrayTexture?G.setTexture2DArray(K,0):G.setTexture2D(K,0),ue.unbindTexture()},this.resetState=function(){g=0,y=0,b=null,ue.reset(),ke.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}var JCe=class extends m8{};JCe.prototype.isWebGL1Renderer=!0;var v8=class{constructor(e,t=1,r=1e3){this.isFog=!0,this.name="",this.color=new Bt(e),this.near=t,this.far=r}clone(){return new v8(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}},ll=class extends Xr{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){let t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t}get autoUpdate(){return console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate}set autoUpdate(e){console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate=e}},e_e=class{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=pM,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Uo()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,r){e*=this.stride,r*=t.stride;for(let i=0,n=this.stride;i<n;i++)this.array[e+i]=t.array[r+i];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Uo()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);let t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),r=new this.constructor(t,this.stride);return r.setUsage(this.usage),r}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Uo()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}},_a=new k,yM=class{constructor(e,t,r,i=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=r,this.normalized=i}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,r=this.data.count;t<r;t++)_a.fromBufferAttribute(this,t),_a.applyMatrix4(e),this.setXYZ(t,_a.x,_a.y,_a.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)_a.fromBufferAttribute(this,t),_a.applyNormalMatrix(e),this.setXYZ(t,_a.x,_a.y,_a.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)_a.fromBufferAttribute(this,t),_a.transformDirection(e),this.setXYZ(t,_a.x,_a.y,_a.z);return this}setX(e,t){return this.normalized&&(t=di(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=di(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=di(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=di(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=ec(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=ec(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=ec(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=ec(t,this.array)),t}setXY(e,t,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=di(t,this.array),r=di(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this}setXYZ(e,t,r,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=di(t,this.array),r=di(r,this.array),i=di(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=i,this}setXYZW(e,t,r,i,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=di(t,this.array),r=di(r,this.array),i=di(i,this.array),n=di(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=i,this.data.array[e+3]=n,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");let t=[];for(let r=0;r<this.count;r++){let i=r*this.data.stride+this.offset;for(let n=0;n<this.itemSize;n++)t.push(this.data.array[i+n])}return new qt(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new yM(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");let t=[];for(let r=0;r<this.count;r++){let i=r*this.data.stride+this.offset;for(let n=0;n<this.itemSize;n++)t.push(this.data.array[i+n])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}},g8=class extends Xr{constructor(){super(),this.isBone=!0,this.type="Bone"}},Lo=class extends Ri{constructor(e=null,t=1,r=1,i,n,a,o,s,l=Wr,c=Wr,u,d){super(null,a,o,s,l,c,i,n,u,d),this.isDataTexture=!0,this.image={data:e,width:t,height:r},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},uk=new it,t_e=new it,$P=class{constructor(e=[],t=[]){this.uuid=Uo(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){let e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let r=0,i=this.bones.length;r<i;r++)this.boneInverses.push(new it)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){let r=new it;this.bones[e]&&r.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(r)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){let r=this.bones[e];r&&r.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){let r=this.bones[e];r&&(r.parent&&r.parent.isBone?(r.matrix.copy(r.parent.matrixWorld).invert(),r.matrix.multiply(r.matrixWorld)):r.matrix.copy(r.matrixWorld),r.matrix.decompose(r.position,r.quaternion,r.scale))}}update(){let e=this.bones,t=this.boneInverses,r=this.boneMatrices,i=this.boneTexture;for(let n=0,a=e.length;n<a;n++){let o=e[n]?e[n].matrixWorld:t_e;uk.multiplyMatrices(o,t[n]),uk.toArray(r,n*16)}i!==null&&(i.needsUpdate=!0)}clone(){return new $P(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=t8(e),e=Math.max(e,4);let t=new Float32Array(e*e*4);t.set(this.boneMatrices);let r=new Lo(t,e,e,Ln,ln);return r.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=r,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,r=this.bones.length;t<r;t++){let i=this.bones[t];if(i.name===e)return i}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let r=0,i=e.bones.length;r<i;r++){let n=e.bones[r],a=t[n];a===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",n),a=new g8),this.bones.push(a),this.boneInverses.push(new it().fromArray(e.boneInverses[r]))}return this.init(),this}toJSON(){let e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;let t=this.bones,r=this.boneInverses;for(let i=0,n=t.length;i<n;i++){let a=t[i];e.bones.push(a.uuid);let o=r[i];e.boneInverses.push(o.toArray())}return e}},Pg=class extends qt{constructor(e,t,r,i=1){super(e,t,r),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){let e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}},dk=new it,hk=new it,_y=[],r_e=new it,Hm=new Oi,i_e=class extends Oi{constructor(e,t,r){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new Pg(new Float32Array(r*16),16),this.instanceColor=null,this.count=r,this.frustumCulled=!1;for(let i=0;i<r;i++)this.setMatrixAt(i,r_e)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}raycast(e,t){let r=this.matrixWorld,i=this.count;if(Hm.geometry=this.geometry,Hm.material=this.material,Hm.material!==void 0)for(let n=0;n<i;n++){this.getMatrixAt(n,dk),hk.multiplyMatrices(r,dk),Hm.matrixWorld=hk,Hm.raycast(e,_y);for(let a=0,o=_y.length;a<o;a++){let s=_y[a];s.instanceId=n,s.object=this,t.push(s)}_y.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new Pg(new Float32Array(this.instanceMatrix.count*3),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}},Zu=class extends m0{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Bt(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}},fk=new k,pk=new k,mk=new it,NC=new om,Ay=new ao,Hx=class extends Xr{constructor(e=new Ot,t=new Zu){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){let e=this.geometry;if(e.index===null){let t=e.attributes.position,r=[0];for(let i=1,n=t.count;i<n;i++)fk.fromBufferAttribute(t,i-1),pk.fromBufferAttribute(t,i),r[i]=r[i-1],r[i]+=fk.distanceTo(pk);e.setAttribute("lineDistance",new yt(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){let r=this.geometry,i=this.matrixWorld,n=e.params.Line.threshold,a=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),Ay.copy(r.boundingSphere),Ay.applyMatrix4(i),Ay.radius+=n,e.ray.intersectsSphere(Ay)===!1)return;mk.copy(i).invert(),NC.copy(e.ray).applyMatrix4(mk);let o=n/((this.scale.x+this.scale.y+this.scale.z)/3),s=o*o,l=new k,c=new k,u=new k,d=new k,h=this.isLineSegments?2:1,f=r.index,p=r.attributes.position;if(f!==null){let v=Math.max(0,a.start),m=Math.min(f.count,a.start+a.count);for(let g=v,y=m-1;g<y;g+=h){let b=f.getX(g),x=f.getX(g+1);if(l.fromBufferAttribute(p,b),c.fromBufferAttribute(p,x),NC.distanceSqToSegment(l,c,d,u)>s)continue;d.applyMatrix4(this.matrixWorld);let S=e.ray.origin.distanceTo(d);S<e.near||S>e.far||t.push({distance:S,point:u.clone().applyMatrix4(this.matrixWorld),index:g,face:null,faceIndex:null,object:this})}}else{let v=Math.max(0,a.start),m=Math.min(p.count,a.start+a.count);for(let g=v,y=m-1;g<y;g+=h){if(l.fromBufferAttribute(p,g),c.fromBufferAttribute(p,g+1),NC.distanceSqToSegment(l,c,d,u)>s)continue;d.applyMatrix4(this.matrixWorld);let b=e.ray.origin.distanceTo(d);b<e.near||b>e.far||t.push({distance:b,point:u.clone().applyMatrix4(this.matrixWorld),index:g,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){let e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){let r=e[t[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let i=0,n=r.length;i<n;i++){let a=r[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=i}}}}},vk=new k,gk=new k,v0=class extends Hx{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){let e=this.geometry;if(e.index===null){let t=e.attributes.position,r=[];for(let i=0,n=t.count;i<n;i+=2)vk.fromBufferAttribute(t,i),gk.fromBufferAttribute(t,i+1),r[i]=i===0?0:r[i-1],r[i+1]=r[i]+vk.distanceTo(gk);e.setAttribute("lineDistance",new yt(r,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}},n_e=class extends Ri{constructor(e,t,r,i,n,a,o,s,l){super(e,t,r,i,n,a,o,s,l),this.isVideoTexture=!0,this.minFilter=a!==void 0?a:hr,this.magFilter=n!==void 0?n:hr,this.generateMipmaps=!1;let c=this;function u(){c.needsUpdate=!0,e.requestVideoFrameCallback(u)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(u)}clone(){return new this.constructor(this.image).copy(this)}update(){let e=this.image;!("requestVideoFrameCallback"in e)&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}},a_e=class extends Ri{constructor(e,t,r,i,n,a,o,s,l){super(e,t,r,i,n,a,o,s,l),this.isCanvasTexture=!0,this.needsUpdate=!0}},wl=class{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){let r=this.getUtoTmapping(e);return this.getPoint(r,t)}getPoints(e=5){let t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return t}getSpacedPoints(e=5){let t=[];for(let r=0;r<=e;r++)t.push(this.getPointAt(r/e));return t}getLength(){let e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;let t=[],r,i=this.getPoint(0),n=0;t.push(0);for(let a=1;a<=e;a++)r=this.getPoint(a/e),n+=r.distanceTo(i),t.push(n),i=r;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){let r=this.getLengths(),i=0,n=r.length,a;t?a=t:a=e*r[n-1];let o=0,s=n-1,l;for(;o<=s;)if(i=Math.floor(o+(s-o)/2),l=r[i]-a,l<0)o=i+1;else if(l>0)s=i-1;else{s=i;break}if(i=s,r[i]===a)return i/(n-1);let c=r[i],u=r[i+1]-c,d=(a-c)/u;return(i+d)/(n-1)}getTangent(e,t){let r=e-1e-4,i=e+1e-4;r<0&&(r=0),i>1&&(i=1);let n=this.getPoint(r),a=this.getPoint(i),o=t||(n.isVector2?new ye:new k);return o.copy(a).sub(n).normalize(),o}getTangentAt(e,t){let r=this.getUtoTmapping(e);return this.getTangent(r,t)}computeFrenetFrames(e,t){let r=new k,i=[],n=[],a=[],o=new k,s=new it;for(let h=0;h<=e;h++){let f=h/e;i[h]=this.getTangentAt(f,new k)}n[0]=new k,a[0]=new k;let l=Number.MAX_VALUE,c=Math.abs(i[0].x),u=Math.abs(i[0].y),d=Math.abs(i[0].z);c<=l&&(l=c,r.set(1,0,0)),u<=l&&(l=u,r.set(0,1,0)),d<=l&&r.set(0,0,1),o.crossVectors(i[0],r).normalize(),n[0].crossVectors(i[0],o),a[0].crossVectors(i[0],n[0]);for(let h=1;h<=e;h++){if(n[h]=n[h-1].clone(),a[h]=a[h-1].clone(),o.crossVectors(i[h-1],i[h]),o.length()>Number.EPSILON){o.normalize();let f=Math.acos(an(i[h-1].dot(i[h]),-1,1));n[h].applyMatrix4(s.makeRotationAxis(o,f))}a[h].crossVectors(i[h],n[h])}if(t===!0){let h=Math.acos(an(n[0].dot(n[e]),-1,1));h/=e,i[0].dot(o.crossVectors(n[0],n[e]))>0&&(h=-h);for(let f=1;f<=e;f++)n[f].applyMatrix4(s.makeRotationAxis(i[f],h*f)),a[f].crossVectors(i[f],n[f])}return{tangents:i,normals:n,binormals:a}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){let e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}},Dw=class extends wl{constructor(e=0,t=0,r=1,i=1,n=0,a=Math.PI*2,o=!1,s=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=r,this.yRadius=i,this.aStartAngle=n,this.aEndAngle=a,this.aClockwise=o,this.aRotation=s}getPoint(e,t){let r=t||new ye,i=Math.PI*2,n=this.aEndAngle-this.aStartAngle,a=Math.abs(n)<Number.EPSILON;for(;n<0;)n+=i;for(;n>i;)n-=i;n<Number.EPSILON&&(a?n=0:n=i),this.aClockwise===!0&&!a&&(n===i?n=-i:n=n-i);let o=this.aStartAngle+e*n,s=this.aX+this.xRadius*Math.cos(o),l=this.aY+this.yRadius*Math.sin(o);if(this.aRotation!==0){let c=Math.cos(this.aRotation),u=Math.sin(this.aRotation),d=s-this.aX,h=l-this.aY;s=d*c-h*u+this.aX,l=d*u+h*c+this.aY}return r.set(s,l)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){let e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}},o_e=class extends Dw{constructor(e,t,r,i,n,a){super(e,t,r,r,i,n,a),this.isArcCurve=!0,this.type="ArcCurve"}};function qP(){let e=0,t=0,r=0,i=0;function n(a,o,s,l){e=a,t=s,r=-3*a+3*o-2*s-l,i=2*a-2*o+s+l}return{initCatmullRom:function(a,o,s,l,c){n(o,s,c*(s-a),c*(l-o))},initNonuniformCatmullRom:function(a,o,s,l,c,u,d){let h=(o-a)/c-(s-a)/(c+u)+(s-o)/u,f=(s-o)/u-(l-o)/(u+d)+(l-s)/d;h*=u,f*=u,n(o,s,h,f)},calc:function(a){let o=a*a,s=o*a;return e+t*a+r*o+i*s}}}var My=new k,UC=new qP,jC=new qP,VC=new qP,s_e=class extends wl{constructor(e=[],t=!1,r="centripetal",i=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=r,this.tension=i}getPoint(e,t=new k){let r=t,i=this.points,n=i.length,a=(n-(this.closed?0:1))*e,o=Math.floor(a),s=a-o;this.closed?o+=o>0?0:(Math.floor(Math.abs(o)/n)+1)*n:s===0&&o===n-1&&(o=n-2,s=1);let l,c;this.closed||o>0?l=i[(o-1)%n]:(My.subVectors(i[0],i[1]).add(i[0]),l=My);let u=i[o%n],d=i[(o+1)%n];if(this.closed||o+2<n?c=i[(o+2)%n]:(My.subVectors(i[n-1],i[n-2]).add(i[n-1]),c=My),this.curveType==="centripetal"||this.curveType==="chordal"){let h=this.curveType==="chordal"?.5:.25,f=Math.pow(l.distanceToSquared(u),h),p=Math.pow(u.distanceToSquared(d),h),v=Math.pow(d.distanceToSquared(c),h);p<1e-4&&(p=1),f<1e-4&&(f=p),v<1e-4&&(v=p),UC.initNonuniformCatmullRom(l.x,u.x,d.x,c.x,f,p,v),jC.initNonuniformCatmullRom(l.y,u.y,d.y,c.y,f,p,v),VC.initNonuniformCatmullRom(l.z,u.z,d.z,c.z,f,p,v)}else this.curveType==="catmullrom"&&(UC.initCatmullRom(l.x,u.x,d.x,c.x,this.tension),jC.initCatmullRom(l.y,u.y,d.y,c.y,this.tension),VC.initCatmullRom(l.z,u.z,d.z,c.z,this.tension));return r.set(UC.calc(s),jC.calc(s),VC.calc(s)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let i=e.points[t];this.points.push(i.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){let i=this.points[t];e.points.push(i.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let i=e.points[t];this.points.push(new k().fromArray(i))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}};function yk(e,t,r,i,n){let a=(i-t)*.5,o=(n-r)*.5,s=e*e,l=e*s;return(2*r-2*i+a+o)*l+(-3*r+3*i-2*a-o)*s+a*e+r}function l_e(e,t){let r=1-e;return r*r*t}function c_e(e,t){return 2*(1-e)*e*t}function u_e(e,t){return e*e*t}function Gv(e,t,r,i){return l_e(e,t)+c_e(e,r)+u_e(e,i)}function d_e(e,t){let r=1-e;return r*r*r*t}function h_e(e,t){let r=1-e;return 3*r*r*e*t}function f_e(e,t){return 3*(1-e)*e*e*t}function p_e(e,t){return e*e*e*t}function $v(e,t,r,i,n){return d_e(e,t)+h_e(e,r)+f_e(e,i)+p_e(e,n)}var cs=class extends wl{constructor(e=new ye,t=new ye,r=new ye,i=new ye){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=r,this.v3=i}getPoint(e,t=new ye){let r=t,i=this.v0,n=this.v1,a=this.v2,o=this.v3;return r.set($v(e,i.x,n.x,a.x,o.x),$v(e,i.y,n.y,a.y,o.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}},Ub=class extends wl{constructor(e=new k,t=new k,r=new k,i=new k){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=r,this.v3=i}getPoint(e,t=new k){let r=t,i=this.v0,n=this.v1,a=this.v2,o=this.v3;return r.set($v(e,i.x,n.x,a.x,o.x),$v(e,i.y,n.y,a.y,o.y),$v(e,i.z,n.z,a.z,o.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}},ms=class extends wl{constructor(e=new ye,t=new ye){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new ye){let r=t;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t){let r=t||new ye;return r.copy(this.v2).sub(this.v1).normalize(),r}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},y8=class extends wl{constructor(e=new k,t=new k){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new k){let r=t;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},Bu=class extends wl{constructor(e=new ye,t=new ye,r=new ye){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new ye){let r=t,i=this.v0,n=this.v1,a=this.v2;return r.set(Gv(e,i.x,n.x,a.x),Gv(e,i.y,n.y,a.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},m_e=class extends wl{constructor(e=new k,t=new k,r=new k){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new k){let r=t,i=this.v0,n=this.v1,a=this.v2;return r.set(Gv(e,i.x,n.x,a.x),Gv(e,i.y,n.y,a.y),Gv(e,i.z,n.z,a.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},YP=class extends wl{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new ye){let r=t,i=this.points,n=(i.length-1)*e,a=Math.floor(n),o=n-a,s=i[a===0?a:a-1],l=i[a],c=i[a>i.length-2?i.length-1:a+1],u=i[a>i.length-3?i.length-1:a+2];return r.set(yk(o,s.x,l.x,c.x,u.x),yk(o,s.y,l.y,c.y,u.y)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let i=e.points[t];this.points.push(i.clone())}return this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){let i=this.points[t];e.points.push(i.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let i=e.points[t];this.points.push(new ye().fromArray(i))}return this}},v_e=Object.freeze({__proto__:null,ArcCurve:o_e,CatmullRomCurve3:s_e,CubicBezierCurve:cs,CubicBezierCurve3:Ub,EllipseCurve:Dw,LineCurve:ms,LineCurve3:y8,QuadraticBezierCurve:Bu,QuadraticBezierCurve3:m_e,SplineCurve:YP}),b8=class extends wl{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){let e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new ms(t,e))}getPoint(e,t){let r=e*this.getLength(),i=this.getCurveLengths(),n=0;for(;n<i.length;){if(i[n]>=r){let a=i[n]-r,o=this.curves[n],s=o.getLength(),l=s===0?0:1-a/s;return o.getPointAt(l,t)}n++}return null}getLength(){let e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;let e=[],t=0;for(let r=0,i=this.curves.length;r<i;r++)t+=this.curves[r].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){let t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){let t=[],r;for(let i=0,n=this.curves;i<n.length;i++){let a=n[i],o=a.isEllipseCurve?e*2:a.isLineCurve||a.isLineCurve3?1:a.isSplineCurve?e*a.points.length:e,s=a.getPoints(o);for(let l=0;l<s.length;l++){let c=s[l];r&&r.equals(c)||(t.push(c),r=c)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){let i=e.curves[t];this.curves.push(i.clone())}return this.autoClose=e.autoClose,this}toJSON(){let e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,r=this.curves.length;t<r;t++){let i=this.curves[t];e.curves.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){let i=e.curves[t];this.curves.push(new v_e[i.type]().fromJSON(i))}return this}},Wx=class extends b8{constructor(e){super(),this.type="Path",this.currentPoint=new ye,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,r=e.length;t<r;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){let r=new ms(this.currentPoint.clone(),new ye(e,t));return this.curves.push(r),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,r,i){let n=new Bu(this.currentPoint.clone(),new ye(e,t),new ye(r,i));return this.curves.push(n),this.currentPoint.set(r,i),this}bezierCurveTo(e,t,r,i,n,a){let o=new cs(this.currentPoint.clone(),new ye(e,t),new ye(r,i),new ye(n,a));return this.curves.push(o),this.currentPoint.set(n,a),this}splineThru(e){let t=[this.currentPoint.clone()].concat(e),r=new YP(t);return this.curves.push(r),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,r,i,n,a){let o=this.currentPoint.x,s=this.currentPoint.y;return this.absarc(e+o,t+s,r,i,n,a),this}absarc(e,t,r,i,n,a){return this.absellipse(e,t,r,r,i,n,a),this}ellipse(e,t,r,i,n,a,o,s){let l=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(e+l,t+c,r,i,n,a,o,s),this}absellipse(e,t,r,i,n,a,o,s){let l=new Dw(e,t,r,i,n,a,o,s);if(this.curves.length>0){let u=l.getPoint(0);u.equals(this.currentPoint)||this.lineTo(u.x,u.y)}this.curves.push(l);let c=l.getPoint(1);return this.currentPoint.copy(c),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){let e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}},x8=class extends Ot{constructor(e=[new ye(0,-.5),new ye(.5,0),new ye(0,.5)],t=12,r=0,i=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:r,phiLength:i},t=Math.floor(t),i=an(i,0,Math.PI*2);let n=[],a=[],o=[],s=[],l=[],c=1/t,u=new k,d=new ye,h=new k,f=new k,p=new k,v=0,m=0;for(let g=0;g<=e.length-1;g++)switch(g){case 0:v=e[g+1].x-e[g].x,m=e[g+1].y-e[g].y,h.x=m*1,h.y=-v,h.z=m*0,p.copy(h),h.normalize(),s.push(h.x,h.y,h.z);break;case e.length-1:s.push(p.x,p.y,p.z);break;default:v=e[g+1].x-e[g].x,m=e[g+1].y-e[g].y,h.x=m*1,h.y=-v,h.z=m*0,f.copy(h),h.x+=p.x,h.y+=p.y,h.z+=p.z,h.normalize(),s.push(h.x,h.y,h.z),p.copy(f)}for(let g=0;g<=t;g++){let y=r+g*c*i,b=Math.sin(y),x=Math.cos(y);for(let S=0;S<=e.length-1;S++){u.x=e[S].x*b,u.y=e[S].y,u.z=e[S].x*x,a.push(u.x,u.y,u.z),d.x=g/t,d.y=S/(e.length-1),o.push(d.x,d.y);let w=s[3*S+0]*b,_=s[3*S+1],C=s[3*S+0]*x;l.push(w,_,C)}}for(let g=0;g<t;g++)for(let y=0;y<e.length-1;y++){let b=y+g*e.length,x=b,S=b+e.length,w=b+e.length+1,_=b+1;n.push(x,S,_),n.push(w,_,S)}this.setIndex(n),this.setAttribute("position",new yt(a,3)),this.setAttribute("uv",new yt(o,2)),this.setAttribute("normal",new yt(l,3))}static fromJSON(e){return new x8(e.points,e.segments,e.phiStart,e.phiLength)}},XP=class extends Ot{constructor(e=1,t=1,r=1,i=32,n=1,a=!1,o=0,s=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:r,radialSegments:i,heightSegments:n,openEnded:a,thetaStart:o,thetaLength:s};let l=this;i=Math.floor(i),n=Math.floor(n);let c=[],u=[],d=[],h=[],f=0,p=[],v=r/2,m=0;g(),a===!1&&(e>0&&y(!0),t>0&&y(!1)),this.setIndex(c),this.setAttribute("position",new yt(u,3)),this.setAttribute("normal",new yt(d,3)),this.setAttribute("uv",new yt(h,2));function g(){let b=new k,x=new k,S=0,w=(t-e)/r;for(let _=0;_<=n;_++){let C=[],A=_/n,M=A*(t-e)+e;for(let P=0;P<=i;P++){let T=P/i,R=T*s+o,z=Math.sin(R),F=Math.cos(R);x.x=M*z,x.y=-A*r+v,x.z=M*F,u.push(x.x,x.y,x.z),b.set(z,w,F).normalize(),d.push(b.x,b.y,b.z),h.push(T,1-A),C.push(f++)}p.push(C)}for(let _=0;_<i;_++)for(let C=0;C<n;C++){let A=p[C][_],M=p[C+1][_],P=p[C+1][_+1],T=p[C][_+1];c.push(A,M,T),c.push(M,P,T),S+=6}l.addGroup(m,S,0),m+=S}function y(b){let x=f,S=new ye,w=new k,_=0,C=b===!0?e:t,A=b===!0?1:-1;for(let P=1;P<=i;P++)u.push(0,v*A,0),d.push(0,A,0),h.push(.5,.5),f++;let M=f;for(let P=0;P<=i;P++){let T=P/i*s+o,R=Math.cos(T),z=Math.sin(T);w.x=C*z,w.y=v*A,w.z=C*R,u.push(w.x,w.y,w.z),d.push(0,A,0),S.x=R*.5+.5,S.y=z*.5*A+.5,h.push(S.x,S.y),f++}for(let P=0;P<i;P++){let T=x+P,R=M+P;b===!0?c.push(R,R+1,T):c.push(R+1,R,T),_+=3}l.addGroup(m,_,b===!0?1:2),m+=_}}static fromJSON(e){return new XP(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}},KP=class extends XP{constructor(e=1,t=1,r=32,i=1,n=!1,a=0,o=Math.PI*2){super(0,e,t,r,i,n,a,o),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:r,heightSegments:i,openEnded:n,thetaStart:a,thetaLength:o}}static fromJSON(e){return new KP(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}},QP=class extends Ot{constructor(e=[],t=[],r=1,i=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:r,detail:i};let n=[],a=[];o(i),l(r),c(),this.setAttribute("position",new yt(n,3)),this.setAttribute("normal",new yt(n.slice(),3)),this.setAttribute("uv",new yt(a,2)),i===0?this.computeVertexNormals():this.normalizeNormals();function o(g){let y=new k,b=new k,x=new k;for(let S=0;S<t.length;S+=3)h(t[S+0],y),h(t[S+1],b),h(t[S+2],x),s(y,b,x,g)}function s(g,y,b,x){let S=x+1,w=[];for(let _=0;_<=S;_++){w[_]=[];let C=g.clone().lerp(b,_/S),A=y.clone().lerp(b,_/S),M=S-_;for(let P=0;P<=M;P++)P===0&&_===S?w[_][P]=C:w[_][P]=C.clone().lerp(A,P/M)}for(let _=0;_<S;_++)for(let C=0;C<2*(S-_)-1;C++){let A=Math.floor(C/2);C%2===0?(d(w[_][A+1]),d(w[_+1][A]),d(w[_][A])):(d(w[_][A+1]),d(w[_+1][A+1]),d(w[_+1][A]))}}function l(g){let y=new k;for(let b=0;b<n.length;b+=3)y.x=n[b+0],y.y=n[b+1],y.z=n[b+2],y.normalize().multiplyScalar(g),n[b+0]=y.x,n[b+1]=y.y,n[b+2]=y.z}function c(){let g=new k;for(let y=0;y<n.length;y+=3){g.x=n[y+0],g.y=n[y+1],g.z=n[y+2];let b=v(g)/2/Math.PI+.5,x=m(g)/Math.PI+.5;a.push(b,1-x)}f(),u()}function u(){for(let g=0;g<a.length;g+=6){let y=a[g+0],b=a[g+2],x=a[g+4],S=Math.max(y,b,x),w=Math.min(y,b,x);S>.9&&w<.1&&(y<.2&&(a[g+0]+=1),b<.2&&(a[g+2]+=1),x<.2&&(a[g+4]+=1))}}function d(g){n.push(g.x,g.y,g.z)}function h(g,y){let b=g*3;y.x=e[b+0],y.y=e[b+1],y.z=e[b+2]}function f(){let g=new k,y=new k,b=new k,x=new k,S=new ye,w=new ye,_=new ye;for(let C=0,A=0;C<n.length;C+=9,A+=6){g.set(n[C+0],n[C+1],n[C+2]),y.set(n[C+3],n[C+4],n[C+5]),b.set(n[C+6],n[C+7],n[C+8]),S.set(a[A+0],a[A+1]),w.set(a[A+2],a[A+3]),_.set(a[A+4],a[A+5]),x.copy(g).add(y).add(b).divideScalar(3);let M=v(x);p(S,A+0,g,M),p(w,A+2,y,M),p(_,A+4,b,M)}}function p(g,y,b,x){x<0&&g.x===1&&(a[y]=g.x-1),b.x===0&&b.z===0&&(a[y]=x/2/Math.PI+.5)}function v(g){return Math.atan2(g.z,-g.x)}function m(g){return Math.atan2(-g.y,Math.sqrt(g.x*g.x+g.z*g.z))}}static fromJSON(e){return new QP(e.vertices,e.indices,e.radius,e.details)}},w8=class extends QP{constructor(e=1,t=0){let r=(1+Math.sqrt(5))/2,i=1/r,n=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-r,0,-i,r,0,i,-r,0,i,r,-i,-r,0,-i,r,0,i,-r,0,i,r,0,-r,0,-i,r,0,-i,-r,0,i,r,0,i],a=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(n,a,e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new w8(e.radius,e.detail)}},Gx=class extends Wx{constructor(e){super(e),this.uuid=Uo(),this.type="Shape",this.holes=[]}getPointsHoles(e){let t=[];for(let r=0,i=this.holes.length;r<i;r++)t[r]=this.holes[r].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){let i=e.holes[t];this.holes.push(i.clone())}return this}toJSON(){let e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,r=this.holes.length;t<r;t++){let i=this.holes[t];e.holes.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){let i=e.holes[t];this.holes.push(new Wx().fromJSON(i))}return this}},g_e={triangulate:function(e,t,r=2){let i=t&&t.length,n=i?t[0]*r:e.length,a=S8(e,0,n,r,!0),o=[];if(!a||a.next===a.prev)return o;let s,l,c,u,d,h,f;if(i&&(a=S_e(e,t,a,r)),e.length>80*r){s=c=e[0],l=u=e[1];for(let p=r;p<n;p+=r)d=e[p],h=e[p+1],d<s&&(s=d),h<l&&(l=h),d>c&&(c=d),h>u&&(u=h);f=Math.max(c-s,u-l),f=f!==0?32767/f:0}return Dg(a,o,r,s,l,f,0),o}};function S8(e,t,r,i,n){let a,o;if(n===I_e(e,t,r,i)>0)for(a=t;a<r;a+=i)o=bk(a,e[a],e[a+1],o);else for(a=r-i;a>=t;a-=i)o=bk(a,e[a],e[a+1],o);return o&&Ow(o,o.next)&&(Rg(o),o=o.next),o}function vh(e,t){if(!e)return e;t||(t=e);let r=e,i;do if(i=!1,!r.steiner&&(Ow(r,r.next)||Di(r.prev,r,r.next)===0)){if(Rg(r),r=t=r.prev,r===r.next)break;i=!0}else r=r.next;while(i||r!==t);return t}function Dg(e,t,r,i,n,a,o){if(!e)return;!o&&a&&E_e(e,i,n,a);let s=e,l,c;for(;e.prev!==e.next;){if(l=e.prev,c=e.next,a?b_e(e,i,n,a):y_e(e)){t.push(l.i/r|0),t.push(e.i/r|0),t.push(c.i/r|0),Rg(e),e=c.next,s=c.next;continue}if(e=c,e===s){o?o===1?(e=x_e(vh(e),t,r),Dg(e,t,r,i,n,a,2)):o===2&&w_e(e,t,r,i,n,a):Dg(vh(e),t,r,i,n,a,1);break}}}function y_e(e){let t=e.prev,r=e,i=e.next;if(Di(t,r,i)>=0)return!1;let n=t.x,a=r.x,o=i.x,s=t.y,l=r.y,c=i.y,u=n<a?n<o?n:o:a<o?a:o,d=s<l?s<c?s:c:l<c?l:c,h=n>a?n>o?n:o:a>o?a:o,f=s>l?s>c?s:c:l>c?l:c,p=i.next;for(;p!==t;){if(p.x>=u&&p.x<=h&&p.y>=d&&p.y<=f&&Gf(n,s,a,l,o,c,p.x,p.y)&&Di(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function b_e(e,t,r,i){let n=e.prev,a=e,o=e.next;if(Di(n,a,o)>=0)return!1;let s=n.x,l=a.x,c=o.x,u=n.y,d=a.y,h=o.y,f=s<l?s<c?s:c:l<c?l:c,p=u<d?u<h?u:h:d<h?d:h,v=s>l?s>c?s:c:l>c?l:c,m=u>d?u>h?u:h:d>h?d:h,g=bM(f,p,t,r,i),y=bM(v,m,t,r,i),b=e.prevZ,x=e.nextZ;for(;b&&b.z>=g&&x&&x.z<=y;){if(b.x>=f&&b.x<=v&&b.y>=p&&b.y<=m&&b!==n&&b!==o&&Gf(s,u,l,d,c,h,b.x,b.y)&&Di(b.prev,b,b.next)>=0||(b=b.prevZ,x.x>=f&&x.x<=v&&x.y>=p&&x.y<=m&&x!==n&&x!==o&&Gf(s,u,l,d,c,h,x.x,x.y)&&Di(x.prev,x,x.next)>=0))return!1;x=x.nextZ}for(;b&&b.z>=g;){if(b.x>=f&&b.x<=v&&b.y>=p&&b.y<=m&&b!==n&&b!==o&&Gf(s,u,l,d,c,h,b.x,b.y)&&Di(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;x&&x.z<=y;){if(x.x>=f&&x.x<=v&&x.y>=p&&x.y<=m&&x!==n&&x!==o&&Gf(s,u,l,d,c,h,x.x,x.y)&&Di(x.prev,x,x.next)>=0)return!1;x=x.nextZ}return!0}function x_e(e,t,r){let i=e;do{let n=i.prev,a=i.next.next;!Ow(n,a)&&C8(n,i,i.next,a)&&Og(n,a)&&Og(a,n)&&(t.push(n.i/r|0),t.push(i.i/r|0),t.push(a.i/r|0),Rg(i),Rg(i.next),i=e=a),i=i.next}while(i!==e);return vh(i)}function w_e(e,t,r,i,n,a){let o=e;do{let s=o.next.next;for(;s!==o.prev;){if(o.i!==s.i&&D_e(o,s)){let l=_8(o,s);o=vh(o,o.next),l=vh(l,l.next),Dg(o,t,r,i,n,a,0),Dg(l,t,r,i,n,a,0);return}s=s.next}o=o.next}while(o!==e)}function S_e(e,t,r,i){let n=[],a,o,s,l,c;for(a=0,o=t.length;a<o;a++)s=t[a]*i,l=a<o-1?t[a+1]*i:e.length,c=S8(e,s,l,i,!1),c===c.next&&(c.steiner=!0),n.push(P_e(c));for(n.sort(C_e),a=0;a<n.length;a++)r=__e(n[a],r);return r}function C_e(e,t){return e.x-t.x}function __e(e,t){let r=A_e(e,t);if(!r)return t;let i=_8(r,e);return vh(i,i.next),vh(r,r.next)}function A_e(e,t){let r=t,i=-1/0,n,a=e.x,o=e.y;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){let h=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(h<=a&&h>i&&(i=h,n=r.x<r.next.x?r:r.next,h===a))return n}r=r.next}while(r!==t);if(!n)return null;let s=n,l=n.x,c=n.y,u=1/0,d;r=n;do a>=r.x&&r.x>=l&&a!==r.x&&Gf(o<c?a:i,o,l,c,o<c?i:a,o,r.x,r.y)&&(d=Math.abs(o-r.y)/(a-r.x),Og(r,e)&&(d<u||d===u&&(r.x>n.x||r.x===n.x&&M_e(n,r)))&&(n=r,u=d)),r=r.next;while(r!==s);return n}function M_e(e,t){return Di(e.prev,e,t.prev)<0&&Di(t.next,e,e.next)<0}function E_e(e,t,r,i){let n=e;do n.z===0&&(n.z=bM(n.x,n.y,t,r,i)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next;while(n!==e);n.prevZ.nextZ=null,n.prevZ=null,T_e(n)}function T_e(e){let t,r,i,n,a,o,s,l,c=1;do{for(r=e,e=null,a=null,o=0;r;){for(o++,i=r,s=0,t=0;t<c&&(s++,i=i.nextZ,!!i);t++);for(l=c;s>0||l>0&&i;)s!==0&&(l===0||!i||r.z<=i.z)?(n=r,r=r.nextZ,s--):(n=i,i=i.nextZ,l--),a?a.nextZ=n:e=n,n.prevZ=a,a=n;r=i}a.nextZ=null,c*=2}while(o>1);return e}function bM(e,t,r,i,n){return e=(e-r)*n|0,t=(t-i)*n|0,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e|t<<1}function P_e(e){let t=e,r=e;do(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;while(t!==e);return r}function Gf(e,t,r,i,n,a,o,s){return(n-o)*(t-s)>=(e-o)*(a-s)&&(e-o)*(i-s)>=(r-o)*(t-s)&&(r-o)*(a-s)>=(n-o)*(i-s)}function D_e(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!O_e(e,t)&&(Og(e,t)&&Og(t,e)&&R_e(e,t)&&(Di(e.prev,e,t.prev)||Di(e,t.prev,t))||Ow(e,t)&&Di(e.prev,e,e.next)>0&&Di(t.prev,t,t.next)>0)}function Di(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function Ow(e,t){return e.x===t.x&&e.y===t.y}function C8(e,t,r,i){let n=Ty(Di(e,t,r)),a=Ty(Di(e,t,i)),o=Ty(Di(r,i,e)),s=Ty(Di(r,i,t));return!!(n!==a&&o!==s||n===0&&Ey(e,r,t)||a===0&&Ey(e,i,t)||o===0&&Ey(r,e,i)||s===0&&Ey(r,t,i))}function Ey(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function Ty(e){return e>0?1:e<0?-1:0}function O_e(e,t){let r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&C8(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}function Og(e,t){return Di(e.prev,e,e.next)<0?Di(e,t,e.next)>=0&&Di(e,e.prev,t)>=0:Di(e,t,e.prev)<0||Di(e,e.next,t)<0}function R_e(e,t){let r=e,i=!1,n=(e.x+t.x)/2,a=(e.y+t.y)/2;do r.y>a!=r.next.y>a&&r.next.y!==r.y&&n<(r.next.x-r.x)*(a-r.y)/(r.next.y-r.y)+r.x&&(i=!i),r=r.next;while(r!==e);return i}function _8(e,t){let r=new xM(e.i,e.x,e.y),i=new xM(t.i,t.x,t.y),n=e.next,a=t.prev;return e.next=t,t.prev=e,r.next=n,n.prev=r,i.next=r,r.prev=i,a.next=i,i.prev=a,i}function bk(e,t,r,i){let n=new xM(e,t,r);return i?(n.next=i.next,n.prev=i,i.next.prev=n,i.next=n):(n.prev=n,n.next=n),n}function Rg(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function xM(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function I_e(e,t,r,i){let n=0;for(let a=t,o=r-i;a<r;a+=i)n+=(e[o]-e[a])*(e[a+1]+e[o+1]),o=a;return n}var A8=class{static area(e){let t=e.length,r=0;for(let i=t-1,n=0;n<t;i=n++)r+=e[i].x*e[n].y-e[n].x*e[i].y;return r*.5}static isClockWise(e){return A8.area(e)<0}static triangulateShape(e,t){let r=[],i=[],n=[];xk(e),wk(r,e);let a=e.length;t.forEach(xk);for(let s=0;s<t.length;s++)i.push(a),a+=t[s].length,wk(r,t[s]);let o=g_e.triangulate(r,i);for(let s=0;s<o.length;s+=3)n.push(o.slice(s,s+3));return n}};function xk(e){let t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function wk(e,t){for(let r=0;r<t.length;r++)e.push(t[r].x),e.push(t[r].y)}var M8=class extends QP{constructor(e=1,t=0){let r=(1+Math.sqrt(5))/2,i=[-1,r,0,1,r,0,-1,-r,0,1,-r,0,0,-1,r,0,1,r,0,-1,-r,0,1,-r,r,0,-1,r,0,1,-r,0,-1,-r,0,1],n=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(i,n,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new M8(e.radius,e.detail)}},op=class extends Ot{constructor(e=1,t=32,r=16,i=0,n=Math.PI*2,a=0,o=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:r,phiStart:i,phiLength:n,thetaStart:a,thetaLength:o},t=Math.max(3,Math.floor(t)),r=Math.max(2,Math.floor(r));let s=Math.min(a+o,Math.PI),l=0,c=[],u=new k,d=new k,h=[],f=[],p=[],v=[];for(let m=0;m<=r;m++){let g=[],y=m/r,b=0;m==0&&a==0?b=.5/t:m==r&&s==Math.PI&&(b=-.5/t);for(let x=0;x<=t;x++){let S=x/t;u.x=-e*Math.cos(i+S*n)*Math.sin(a+y*o),u.y=e*Math.cos(a+y*o),u.z=e*Math.sin(i+S*n)*Math.sin(a+y*o),f.push(u.x,u.y,u.z),d.copy(u).normalize(),p.push(d.x,d.y,d.z),v.push(S+b,1-y),g.push(l++)}c.push(g)}for(let m=0;m<r;m++)for(let g=0;g<t;g++){let y=c[m][g+1],b=c[m][g],x=c[m+1][g],S=c[m+1][g+1];(m!==0||a>0)&&h.push(y,b,S),(m!==r-1||s<Math.PI)&&h.push(b,x,S)}this.setIndex(h),this.setAttribute("position",new yt(f,3)),this.setAttribute("normal",new yt(p,3)),this.setAttribute("uv",new yt(v,2))}static fromJSON(e){return new op(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}},E8=class extends Ot{constructor(e=1,t=.4,r=12,i=48,n=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:r,tubularSegments:i,arc:n},r=Math.floor(r),i=Math.floor(i);let a=[],o=[],s=[],l=[],c=new k,u=new k,d=new k;for(let h=0;h<=r;h++)for(let f=0;f<=i;f++){let p=f/i*n,v=h/r*Math.PI*2;u.x=(e+t*Math.cos(v))*Math.cos(p),u.y=(e+t*Math.cos(v))*Math.sin(p),u.z=t*Math.sin(v),o.push(u.x,u.y,u.z),c.x=e*Math.cos(p),c.y=e*Math.sin(p),d.subVectors(u,c).normalize(),s.push(d.x,d.y,d.z),l.push(f/i),l.push(h/r)}for(let h=1;h<=r;h++)for(let f=1;f<=i;f++){let p=(i+1)*h+f-1,v=(i+1)*(h-1)+f-1,m=(i+1)*(h-1)+f,g=(i+1)*h+f;a.push(p,v,g),a.push(v,m,g)}this.setIndex(a),this.setAttribute("position",new yt(o,3)),this.setAttribute("normal",new yt(s,3)),this.setAttribute("uv",new yt(l,2))}static fromJSON(e){return new E8(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}},T8=class extends Ot{constructor(e=1,t=.4,r=64,i=8,n=2,a=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:r,radialSegments:i,p:n,q:a},r=Math.floor(r),i=Math.floor(i);let o=[],s=[],l=[],c=[],u=new k,d=new k,h=new k,f=new k,p=new k,v=new k,m=new k;for(let y=0;y<=r;++y){let b=y/r*n*Math.PI*2;g(b,n,a,e,h),g(b+.01,n,a,e,f),v.subVectors(f,h),m.addVectors(f,h),p.crossVectors(v,m),m.crossVectors(p,v),p.normalize(),m.normalize();for(let x=0;x<=i;++x){let S=x/i*Math.PI*2,w=-t*Math.cos(S),_=t*Math.sin(S);u.x=h.x+(w*m.x+_*p.x),u.y=h.y+(w*m.y+_*p.y),u.z=h.z+(w*m.z+_*p.z),s.push(u.x,u.y,u.z),d.subVectors(u,h).normalize(),l.push(d.x,d.y,d.z),c.push(y/r),c.push(x/i)}}for(let y=1;y<=r;y++)for(let b=1;b<=i;b++){let x=(i+1)*(y-1)+(b-1),S=(i+1)*y+(b-1),w=(i+1)*y+b,_=(i+1)*(y-1)+b;o.push(x,S,_),o.push(S,w,_)}this.setIndex(o),this.setAttribute("position",new yt(s,3)),this.setAttribute("normal",new yt(l,3)),this.setAttribute("uv",new yt(c,2));function g(y,b,x,S,w){let _=Math.cos(y),C=Math.sin(y),A=x/b*y,M=Math.cos(A);w.x=S*(2+M)*.5*_,w.y=S*(2+M)*C*.5,w.z=S*Math.sin(A)*.5}}static fromJSON(e){return new T8(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}};function Uc(e,t,r){return P8(e)?new e.constructor(e.subarray(t,r!==void 0?r:e.length)):e.slice(t,r)}function Py(e,t,r){return!e||e.constructor===t?e:typeof t.BYTES_PER_ELEMENT=="number"?new t(e):Array.prototype.slice.call(e)}function P8(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function z_e(e){function t(n,a){return e[n]-e[a]}let r=e.length,i=new Array(r);for(let n=0;n!==r;++n)i[n]=n;return i.sort(t),i}function Sk(e,t,r){let i=e.length,n=new e.constructor(i);for(let a=0,o=0;o!==i;++a){let s=r[a]*t;for(let l=0;l!==t;++l)n[o++]=e[s+l]}return n}function D8(e,t,r,i){let n=1,a=e[0];for(;a!==void 0&&a[i]===void 0;)a=e[n++];if(a===void 0)return;let o=a[i];if(o!==void 0)if(Array.isArray(o))do o=a[i],o!==void 0&&(t.push(a.time),r.push.apply(r,o)),a=e[n++];while(a!==void 0);else if(o.toArray!==void 0)do o=a[i],o!==void 0&&(t.push(a.time),o.toArray(r,r.length)),a=e[n++];while(a!==void 0);else do o=a[i],o!==void 0&&(t.push(a.time),r.push(o)),a=e[n++];while(a!==void 0)}var Rw=class{constructor(e,t,r,i){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=i!==void 0?i:new t.constructor(r),this.sampleValues=t,this.valueSize=r,this.settings=null,this.DefaultSettings_={}}evaluate(e){let t=this.parameterPositions,r=this._cachedIndex,i=t[r],n=t[r-1];e:{t:{let a;r:{i:if(!(e<i)){for(let o=r+2;;){if(i===void 0){if(e<n)break i;return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}if(r===o)break;if(n=i,i=t[++r],e<i)break t}a=t.length;break r}if(!(e>=n)){let o=t[1];e<o&&(r=2,n=o);for(let s=r-2;;){if(n===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===s)break;if(i=n,n=t[--r-1],e>=n)break t}a=r,r=0;break r}break e}for(;r<a;){let o=r+a>>>1;e<t[o]?a=o:r=o+1}if(i=t[r],n=t[r-1],n===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===void 0)return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}this._cachedIndex=r,this.intervalChanged_(r,n,i)}return this.interpolate_(r,n,e,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){let t=this.resultBuffer,r=this.sampleValues,i=this.valueSize,n=e*i;for(let a=0;a!==i;++a)t[a]=r[n+a];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}},k_e=class extends Rw{constructor(e,t,r,i){super(e,t,r,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Vf,endingEnd:Vf}}intervalChanged_(e,t,r){let i=this.parameterPositions,n=e-2,a=e+1,o=i[n],s=i[a];if(o===void 0)switch(this.getSettings_().endingStart){case Hf:n=e,o=2*t-r;break;case Ux:n=i.length-2,o=t+i[n]-i[n+1];break;default:n=e,o=r}if(s===void 0)switch(this.getSettings_().endingEnd){case Hf:a=e,s=2*r-t;break;case Ux:a=1,s=r+i[1]-i[0];break;default:a=e-1,s=t}let l=(r-t)*.5,c=this.valueSize;this._weightPrev=l/(t-o),this._weightNext=l/(s-r),this._offsetPrev=n*c,this._offsetNext=a*c}interpolate_(e,t,r,i){let n=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,l=s-o,c=this._offsetPrev,u=this._offsetNext,d=this._weightPrev,h=this._weightNext,f=(r-t)/(i-t),p=f*f,v=p*f,m=-d*v+2*d*p-d*f,g=(1+d)*v+(-1.5-2*d)*p+(-.5+d)*f+1,y=(-1-h)*v+(1.5+h)*p+.5*f,b=h*v-h*p;for(let x=0;x!==o;++x)n[x]=m*a[c+x]+g*a[l+x]+y*a[s+x]+b*a[u+x];return n}},O8=class extends Rw{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e,t,r,i){let n=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,l=s-o,c=(r-t)/(i-t),u=1-c;for(let d=0;d!==o;++d)n[d]=a[l+d]*u+a[s+d]*c;return n}},L_e=class extends Rw{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e){return this.copySampleValue_(e-1)}},Sl=class{constructor(e,t,r,i){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Py(t,this.TimeBufferType),this.values=Py(r,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(e){let t=e.constructor,r;if(t.toJSON!==this.toJSON)r=t.toJSON(e);else{r={name:e.name,times:Py(e.times,Array),values:Py(e.values,Array)};let i=e.getInterpolation();i!==e.DefaultInterpolation&&(r.interpolation=i)}return r.type=e.ValueTypeName,r}InterpolantFactoryMethodDiscrete(e){return new L_e(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new O8(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new k_e(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Fx:t=this.InterpolantFactoryMethodDiscrete;break;case Nx:t=this.InterpolantFactoryMethodLinear;break;case fC:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){let r="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(r);return console.warn("THREE.KeyframeTrack:",r),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Fx;case this.InterpolantFactoryMethodLinear:return Nx;case this.InterpolantFactoryMethodSmooth:return fC}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){let t=this.times;for(let r=0,i=t.length;r!==i;++r)t[r]+=e}return this}scale(e){if(e!==1){let t=this.times;for(let r=0,i=t.length;r!==i;++r)t[r]*=e}return this}trim(e,t){let r=this.times,i=r.length,n=0,a=i-1;for(;n!==i&&r[n]<e;)++n;for(;a!==-1&&r[a]>t;)--a;if(++a,n!==0||a!==i){n>=a&&(a=Math.max(a,1),n=a-1);let o=this.getValueSize();this.times=Uc(r,n,a),this.values=Uc(this.values,n*o,a*o)}return this}validate(){let e=!0,t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);let r=this.times,i=this.values,n=r.length;n===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let a=null;for(let o=0;o!==n;o++){let s=r[o];if(typeof s=="number"&&isNaN(s)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,s),e=!1;break}if(a!==null&&a>s){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,s,a),e=!1;break}a=s}if(i!==void 0&&P8(i))for(let o=0,s=i.length;o!==s;++o){let l=i[o];if(isNaN(l)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,o,l),e=!1;break}}return e}optimize(){let e=Uc(this.times),t=Uc(this.values),r=this.getValueSize(),i=this.getInterpolation()===fC,n=e.length-1,a=1;for(let o=1;o<n;++o){let s=!1,l=e[o],c=e[o+1];if(l!==c&&(o!==1||l!==e[0]))if(i)s=!0;else{let u=o*r,d=u-r,h=u+r;for(let f=0;f!==r;++f){let p=t[u+f];if(p!==t[d+f]||p!==t[h+f]){s=!0;break}}}if(s){if(o!==a){e[a]=e[o];let u=o*r,d=a*r;for(let h=0;h!==r;++h)t[d+h]=t[u+h]}++a}}if(n>0){e[a]=e[n];for(let o=n*r,s=a*r,l=0;l!==r;++l)t[s+l]=t[o+l];++a}return a!==e.length?(this.times=Uc(e,0,a),this.values=Uc(t,0,a*r)):(this.times=e,this.values=t),this}clone(){let e=Uc(this.times,0),t=Uc(this.values,0),r=this.constructor,i=new r(this.name,e,t);return i.createInterpolant=this.createInterpolant,i}};Sl.prototype.TimeBufferType=Float32Array;Sl.prototype.ValueBufferType=Float32Array;Sl.prototype.DefaultInterpolation=Nx;var cm=class extends Sl{};cm.prototype.ValueTypeName="bool";cm.prototype.ValueBufferType=Array;cm.prototype.DefaultInterpolation=Fx;cm.prototype.InterpolantFactoryMethodLinear=void 0;cm.prototype.InterpolantFactoryMethodSmooth=void 0;var R8=class extends Sl{};R8.prototype.ValueTypeName="color";var $x=class extends Sl{};$x.prototype.ValueTypeName="number";var B_e=class extends Rw{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e,t,r,i){let n=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=(r-t)/(i-t),l=e*o;for(let c=l+o;l!==c;l+=4)Kt.slerpFlat(n,0,a,l-o,a,l,s);return n}},g0=class extends Sl{InterpolantFactoryMethodLinear(e){return new B_e(this.times,this.values,this.getValueSize(),e)}};g0.prototype.ValueTypeName="quaternion";g0.prototype.DefaultInterpolation=Nx;g0.prototype.InterpolantFactoryMethodSmooth=void 0;var um=class extends Sl{};um.prototype.ValueTypeName="string";um.prototype.ValueBufferType=Array;um.prototype.DefaultInterpolation=Fx;um.prototype.InterpolantFactoryMethodLinear=void 0;um.prototype.InterpolantFactoryMethodSmooth=void 0;var qx=class extends Sl{};qx.prototype.ValueTypeName="vector";var wM=class{constructor(e,t=-1,r,i=UP){this.name=e,this.tracks=r,this.duration=t,this.blendMode=i,this.uuid=Uo(),this.duration<0&&this.resetDuration()}static parse(e){let t=[],r=e.tracks,i=1/(e.fps||1);for(let a=0,o=r.length;a!==o;++a)t.push(N_e(r[a]).scale(i));let n=new this(e.name,e.duration,t,e.blendMode);return n.uuid=e.uuid,n}static toJSON(e){let t=[],r=e.tracks,i={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let n=0,a=r.length;n!==a;++n)t.push(Sl.toJSON(r[n]));return i}static CreateFromMorphTargetSequence(e,t,r,i){let n=t.length,a=[];for(let o=0;o<n;o++){let s=[],l=[];s.push((o+n-1)%n,o,(o+1)%n),l.push(0,1,0);let c=z_e(s);s=Sk(s,1,c),l=Sk(l,1,c),!i&&s[0]===0&&(s.push(n),l.push(l[0])),a.push(new $x(".morphTargetInfluences["+t[o].name+"]",s,l).scale(1/r))}return new this(e,-1,a)}static findByName(e,t){let r=e;if(!Array.isArray(e)){let i=e;r=i.geometry&&i.geometry.animations||i.animations}for(let i=0;i<r.length;i++)if(r[i].name===t)return r[i];return null}static CreateClipsFromMorphTargetSequences(e,t,r){let i={},n=/^([\w-]*?)([\d]+)$/;for(let o=0,s=e.length;o<s;o++){let l=e[o],c=l.name.match(n);if(c&&c.length>1){let u=c[1],d=i[u];d||(i[u]=d=[]),d.push(l)}}let a=[];for(let o in i)a.push(this.CreateFromMorphTargetSequence(o,i[o],t,r));return a}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;let r=function(c,u,d,h,f){if(d.length!==0){let p=[],v=[];D8(d,p,v,h),p.length!==0&&f.push(new c(u,p,v))}},i=[],n=e.name||"default",a=e.fps||30,o=e.blendMode,s=e.length||-1,l=e.hierarchy||[];for(let c=0;c<l.length;c++){let u=l[c].keys;if(!(!u||u.length===0))if(u[0].morphTargets){let d={},h;for(h=0;h<u.length;h++)if(u[h].morphTargets)for(let f=0;f<u[h].morphTargets.length;f++)d[u[h].morphTargets[f]]=-1;for(let f in d){let p=[],v=[];for(let m=0;m!==u[h].morphTargets.length;++m){let g=u[h];p.push(g.time),v.push(g.morphTarget===f?1:0)}i.push(new $x(".morphTargetInfluence["+f+"]",p,v))}s=d.length*a}else{let d=".bones["+t[c].name+"]";r(qx,d+".position",u,"pos",i),r(g0,d+".quaternion",u,"rot",i),r(qx,d+".scale",u,"scl",i)}}return i.length===0?null:new this(n,s,i,o)}resetDuration(){let e=this.tracks,t=0;for(let r=0,i=e.length;r!==i;++r){let n=this.tracks[r];t=Math.max(t,n.times[n.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){let e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}};function F_e(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return $x;case"vector":case"vector2":case"vector3":case"vector4":return qx;case"color":return R8;case"quaternion":return g0;case"bool":case"boolean":return cm;case"string":return um}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}function N_e(e){if(e.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");let t=F_e(e.type);if(e.times===void 0){let r=[],i=[];D8(e.keys,r,i,"value"),e.times=r,e.values=i}return t.parse!==void 0?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}var Yx={enabled:!1,files:{},add:function(e,t){this.enabled!==!1&&(this.files[e]=t)},get:function(e){if(this.enabled!==!1)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}},I8=class{constructor(e,t,r){let i=this,n=!1,a=0,o=0,s,l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=r,this.itemStart=function(c){o++,n===!1&&i.onStart!==void 0&&i.onStart(c,a,o),n=!0},this.itemEnd=function(c){a++,i.onProgress!==void 0&&i.onProgress(c,a,o),a===o&&(n=!1,i.onLoad!==void 0&&i.onLoad())},this.itemError=function(c){i.onError!==void 0&&i.onError(c)},this.resolveURL=function(c){return s?s(c):c},this.setURLModifier=function(c){return s=c,this},this.addHandler=function(c,u){return l.push(c,u),this},this.removeHandler=function(c){let u=l.indexOf(c);return u!==-1&&l.splice(u,2),this},this.getHandler=function(c){for(let u=0,d=l.length;u<d;u+=2){let h=l[u],f=l[u+1];if(h.global&&(h.lastIndex=0),h.test(c))return f}return null}}},U_e=new I8,y0=class{constructor(e){this.manager=e!==void 0?e:U_e,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){let r=this;return new Promise(function(i,n){r.load(e,i,t,n)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}},Rl={},j_e=class extends Error{constructor(e,t){super(e),this.response=t}},SM=class extends y0{constructor(e){super(e)}load(e,t,r,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let n=Yx.get(e);if(n!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(n),this.manager.itemEnd(e)},0),n;if(Rl[e]!==void 0){Rl[e].push({onLoad:t,onProgress:r,onError:i});return}Rl[e]=[],Rl[e].push({onLoad:t,onProgress:r,onError:i});let a=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),o=this.mimeType,s=this.responseType;fetch(a).then(l=>{if(l.status===200||l.status===0){if(l.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||l.body===void 0||l.body.getReader===void 0)return l;let c=Rl[e],u=l.body.getReader(),d=l.headers.get("Content-Length")||l.headers.get("X-File-Size"),h=d?parseInt(d):0,f=h!==0,p=0,v=new ReadableStream({start(m){g();function g(){u.read().then(({done:y,value:b})=>{if(y)m.close();else{p+=b.byteLength;let x=new ProgressEvent("progress",{lengthComputable:f,loaded:p,total:h});for(let S=0,w=c.length;S<w;S++){let _=c[S];_.onProgress&&_.onProgress(x)}m.enqueue(b),g()}})}}});return new Response(v)}else throw new j_e(`fetch for "${l.url}" responded with ${l.status}: ${l.statusText}`,l)}).then(l=>{switch(s){case"arraybuffer":return l.arrayBuffer();case"blob":return l.blob();case"document":return l.text().then(c=>new DOMParser().parseFromString(c,o));case"json":return l.json();default:if(o===void 0)return l.text();{let c=/charset="?([^;"\s]*)"?/i.exec(o),u=c&&c[1]?c[1].toLowerCase():void 0,d=new TextDecoder(u);return l.arrayBuffer().then(h=>d.decode(h))}}}).then(l=>{Yx.add(e,l);let c=Rl[e];delete Rl[e];for(let u=0,d=c.length;u<d;u++){let h=c[u];h.onLoad&&h.onLoad(l)}}).catch(l=>{let c=Rl[e];if(c===void 0)throw this.manager.itemError(e),l;delete Rl[e];for(let u=0,d=c.length;u<d;u++){let h=c[u];h.onError&&h.onError(l)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}},V_e=class extends y0{constructor(e){super(e)}load(e,t,r,i){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let n=this,a=Yx.get(e);if(a!==void 0)return n.manager.itemStart(e),setTimeout(function(){t&&t(a),n.manager.itemEnd(e)},0),a;let o=Tg("img");function s(){c(),Yx.add(e,this),t&&t(this),n.manager.itemEnd(e)}function l(u){c(),i&&i(u),n.manager.itemError(e),n.manager.itemEnd(e)}function c(){o.removeEventListener("load",s,!1),o.removeEventListener("error",l,!1)}return o.addEventListener("load",s,!1),o.addEventListener("error",l,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(o.crossOrigin=this.crossOrigin),n.manager.itemStart(e),o.src=e,o}},H_e=class extends y0{constructor(e){super(e)}load(e,t,r,i){let n=new Ri,a=new V_e(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,function(o){n.image=o,n.needsUpdate=!0,t!==void 0&&t(n)},r,i),n}},b0=class extends Xr{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Bt(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){let t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}},W_e=class extends b0{constructor(e,t,r){super(e,r),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Xr.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Bt(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}},HC=new it,Ck=new k,_k=new k,ZP=class{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new ye(512,512),this.map=null,this.mapPass=null,this.matrix=new it,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new WP,this._frameExtents=new ye(1,1),this._viewportCount=1,this._viewports=[new Qt(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){let t=this.camera,r=this.matrix;Ck.setFromMatrixPosition(e.matrixWorld),t.position.copy(Ck),_k.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(_k),t.updateMatrixWorld(),HC.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(HC),r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(HC)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){let e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}},G_e=class extends ZP{constructor(){super(new pa(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){let t=this.camera,r=Eg*2*e.angle*this.focus,i=this.mapSize.width/this.mapSize.height,n=e.distance||t.far;(r!==t.fov||i!==t.aspect||n!==t.far)&&(t.fov=r,t.aspect=i,t.far=n,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}},$_e=class extends b0{constructor(e,t,r=0,i=Math.PI/3,n=0,a=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Xr.DEFAULT_UP),this.updateMatrix(),this.target=new Xr,this.distance=r,this.angle=i,this.penumbra=n,this.decay=a,this.map=null,this.shadow=new G_e}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}},Ak=new it,Wm=new k,WC=new k,q_e=class extends ZP{constructor(){super(new pa(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new ye(4,2),this._viewportCount=6,this._viewports=[new Qt(2,1,1,1),new Qt(0,1,1,1),new Qt(3,1,1,1),new Qt(1,1,1,1),new Qt(3,0,1,1),new Qt(1,0,1,1)],this._cubeDirections=[new k(1,0,0),new k(-1,0,0),new k(0,0,1),new k(0,0,-1),new k(0,1,0),new k(0,-1,0)],this._cubeUps=[new k(0,1,0),new k(0,1,0),new k(0,1,0),new k(0,1,0),new k(0,0,1),new k(0,0,-1)]}updateMatrices(e,t=0){let r=this.camera,i=this.matrix,n=e.distance||r.far;n!==r.far&&(r.far=n,r.updateProjectionMatrix()),Wm.setFromMatrixPosition(e.matrixWorld),r.position.copy(Wm),WC.copy(r.position),WC.add(this._cubeDirections[t]),r.up.copy(this._cubeUps[t]),r.lookAt(WC),r.updateMatrixWorld(),i.makeTranslation(-Wm.x,-Wm.y,-Wm.z),Ak.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Ak)}},Y_e=class extends b0{constructor(e,t,r=0,i=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=r,this.decay=i,this.shadow=new q_e}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}},X_e=class extends ZP{constructor(){super(new Tw(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}},K_e=class extends b0{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Xr.DEFAULT_UP),this.updateMatrix(),this.target=new Xr,this.shadow=new X_e}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}},z8=class extends Ot{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){let e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}},k8=class extends y0{constructor(e){super(e)}load(e,t,r,i){let n=this,a=new SM(n.manager);a.setPath(n.path),a.setRequestHeader(n.requestHeader),a.setWithCredentials(n.withCredentials),a.load(e,function(o){try{t(n.parse(JSON.parse(o)))}catch(s){i?i(s):console.error(s),n.manager.itemError(e)}},r,i)}parse(e){let t={},r={};function i(d,h){if(t[h]!==void 0)return t[h];let f=d.interleavedBuffers[h],p=n(d,f.buffer),v=ay(f.type,p),m=new e_e(v,f.stride);return m.uuid=f.uuid,t[h]=m,m}function n(d,h){if(r[h]!==void 0)return r[h];let f=d.arrayBuffers[h],p=new Uint32Array(f).buffer;return r[h]=p,p}let a=e.isInstancedBufferGeometry?new z8:new Ot,o=e.data.index;if(o!==void 0){let d=ay(o.type,o.array);a.setIndex(new qt(d,1))}let s=e.data.attributes;for(let d in s){let h=s[d],f;if(h.isInterleavedBufferAttribute){let p=i(e.data,h.data);f=new yM(p,h.itemSize,h.offset,h.normalized)}else{let p=ay(h.type,h.array),v=h.isInstancedBufferAttribute?Pg:qt;f=new v(p,h.itemSize,h.normalized)}h.name!==void 0&&(f.name=h.name),h.usage!==void 0&&f.setUsage(h.usage),h.updateRange!==void 0&&(f.updateRange.offset=h.updateRange.offset,f.updateRange.count=h.updateRange.count),a.setAttribute(d,f)}let l=e.data.morphAttributes;if(l)for(let d in l){let h=l[d],f=[];for(let p=0,v=h.length;p<v;p++){let m=h[p],g;if(m.isInterleavedBufferAttribute){let y=i(e.data,m.data);g=new yM(y,m.itemSize,m.offset,m.normalized)}else{let y=ay(m.type,m.array);g=new qt(y,m.itemSize,m.normalized)}m.name!==void 0&&(g.name=m.name),f.push(g)}a.morphAttributes[d]=f}e.data.morphTargetsRelative&&(a.morphTargetsRelative=!0);let c=e.data.groups||e.data.drawcalls||e.data.offsets;if(c!==void 0)for(let d=0,h=c.length;d!==h;++d){let f=c[d];a.addGroup(f.start,f.count,f.materialIndex)}let u=e.data.boundingSphere;if(u!==void 0){let d=new k;u.center!==void 0&&d.fromArray(u.center),a.boundingSphere=new ao(d,u.radius)}return e.name&&(a.name=e.name),e.userData&&(a.userData=e.userData),a}},Q_e=class{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=Mk(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){let t=Mk();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}};function Mk(){return(typeof performance>"u"?Date:performance).now()}var Z_e=class{constructor(e,t,r){this.binding=e,this.valueSize=r;let i,n,a;switch(t){case"quaternion":i=this._slerp,n=this._slerpAdditive,a=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(r*6),this._workIndex=5;break;case"string":case"bool":i=this._select,n=this._select,a=this._setAdditiveIdentityOther,this.buffer=new Array(r*5);break;default:i=this._lerp,n=this._lerpAdditive,a=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(r*5)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=n,this._setIdentity=a,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){let r=this.buffer,i=this.valueSize,n=e*i+i,a=this.cumulativeWeight;if(a===0){for(let o=0;o!==i;++o)r[n+o]=r[o];a=t}else{a+=t;let o=t/a;this._mixBufferRegion(r,n,0,o,i)}this.cumulativeWeight=a}accumulateAdditive(e){let t=this.buffer,r=this.valueSize,i=r*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,i,0,e,r),this.cumulativeWeightAdditive+=e}apply(e){let t=this.valueSize,r=this.buffer,i=e*t+t,n=this.cumulativeWeight,a=this.cumulativeWeightAdditive,o=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,n<1){let s=t*this._origIndex;this._mixBufferRegion(r,i,s,1-n,t)}a>0&&this._mixBufferRegionAdditive(r,i,this._addIndex*t,1,t);for(let s=t,l=t+t;s!==l;++s)if(r[s]!==r[s+t]){o.setValue(r,i);break}}saveOriginalState(){let e=this.binding,t=this.buffer,r=this.valueSize,i=r*this._origIndex;e.getValue(t,i);for(let n=r,a=i;n!==a;++n)t[n]=t[i+n%r];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){let e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){let e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let r=e;r<t;r++)this.buffer[r]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){let e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let r=0;r<this.valueSize;r++)this.buffer[t+r]=this.buffer[e+r]}_select(e,t,r,i,n){if(i>=.5)for(let a=0;a!==n;++a)e[t+a]=e[r+a]}_slerp(e,t,r,i){Kt.slerpFlat(e,t,e,t,e,r,i)}_slerpAdditive(e,t,r,i,n){let a=this._workIndex*n;Kt.multiplyQuaternionsFlat(e,a,e,t,e,r),Kt.slerpFlat(e,t,e,t,e,a,i)}_lerp(e,t,r,i,n){let a=1-i;for(let o=0;o!==n;++o){let s=t+o;e[s]=e[s]*a+e[r+o]*i}}_lerpAdditive(e,t,r,i,n){for(let a=0;a!==n;++a){let o=t+a;e[o]=e[o]+e[r+a]*i}}},JP="\\[\\]\\.:\\/",J_e=new RegExp("["+JP+"]","g"),eD="[^"+JP+"]",e2e="[^"+JP.replace("\\.","")+"]",t2e=/((?:WC+[\/:])*)/.source.replace("WC",eD),r2e=/(WCOD+)?/.source.replace("WCOD",e2e),i2e=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",eD),n2e=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",eD),a2e=new RegExp("^"+t2e+r2e+i2e+n2e+"$"),o2e=["material","materials","bones","map"],s2e=class{constructor(e,t,r){let i=r||ai.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,i)}getValue(e,t){this.bind();let r=this._targetGroup.nCachedObjects_,i=this._bindings[r];i!==void 0&&i.getValue(e,t)}setValue(e,t){let r=this._bindings;for(let i=this._targetGroup.nCachedObjects_,n=r.length;i!==n;++i)r[i].setValue(e,t)}bind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].bind()}unbind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].unbind()}},ai=class{constructor(e,t,r){this.path=t,this.parsedPath=r||ai.parseTrackName(t),this.node=ai.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,r){return e&&e.isAnimationObjectGroup?new ai.Composite(e,t,r):new ai(e,t,r)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(J_e,"")}static parseTrackName(e){let t=a2e.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);let r={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},i=r.nodeName&&r.nodeName.lastIndexOf(".");if(i!==void 0&&i!==-1){let n=r.nodeName.substring(i+1);o2e.indexOf(n)!==-1&&(r.nodeName=r.nodeName.substring(0,i),r.objectName=n)}if(r.propertyName===null||r.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return r}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){let r=e.skeleton.getBoneByName(t);if(r!==void 0)return r}if(e.children){let r=function(n){for(let a=0;a<n.length;a++){let o=n[a];if(o.name===t||o.uuid===t)return o;let s=r(o.children);if(s)return s}return null},i=r(e.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){let r=this.resolvedProperty;for(let i=0,n=r.length;i!==n;++i)e[t++]=r[i]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){let r=this.resolvedProperty;for(let i=0,n=r.length;i!==n;++i)r[i]=e[t++]}_setValue_array_setNeedsUpdate(e,t){let r=this.resolvedProperty;for(let i=0,n=r.length;i!==n;++i)r[i]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){let r=this.resolvedProperty;for(let i=0,n=r.length;i!==n;++i)r[i]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node,t=this.parsedPath,r=t.objectName,i=t.propertyName,n=t.propertyIndex;if(e||(e=ai.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(r){let l=t.objectIndex;switch(r){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let c=0;c<e.length;c++)if(e[c].name===l){l=c;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[r]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[r]}if(l!==void 0){if(e[l]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[l]}}let a=e[i];if(a===void 0){let l=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+l+"."+i+" but it wasn't found.",e);return}let o=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?o=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(o=this.Versioning.MatrixWorldNeedsUpdate);let s=this.BindingType.Direct;if(n!==void 0){if(i==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[n]!==void 0&&(n=e.morphTargetDictionary[n])}s=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=n}else a.fromArray!==void 0&&a.toArray!==void 0?(s=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(s=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=i;this.getValue=this.GetterByBindingType[s],this.setValue=this.SetterByBindingTypeAndVersioning[s][o]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}};ai.Composite=s2e;ai.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};ai.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};ai.prototype.GetterByBindingType=[ai.prototype._getValue_direct,ai.prototype._getValue_array,ai.prototype._getValue_arrayElement,ai.prototype._getValue_toArray];ai.prototype.SetterByBindingTypeAndVersioning=[[ai.prototype._setValue_direct,ai.prototype._setValue_direct_setNeedsUpdate,ai.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[ai.prototype._setValue_array,ai.prototype._setValue_array_setNeedsUpdate,ai.prototype._setValue_array_setMatrixWorldNeedsUpdate],[ai.prototype._setValue_arrayElement,ai.prototype._setValue_arrayElement_setNeedsUpdate,ai.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[ai.prototype._setValue_fromArray,ai.prototype._setValue_fromArray_setNeedsUpdate,ai.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];var l2e=class{constructor(e,t,r=null,i=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=r,this.blendMode=i;let n=t.tracks,a=n.length,o=new Array(a),s={endingStart:Vf,endingEnd:Vf};for(let l=0;l!==a;++l){let c=n[l].createInterpolant(null);o[l]=c,c.settings=s}this._interpolantSettings=s,this._interpolants=o,this._propertyBindings=new Array(a),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=JV,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,r){if(e.fadeOut(t),this.fadeIn(t),r){let i=this._clip.duration,n=e._clip.duration,a=n/i,o=i/n;e.warp(1,a,t),this.warp(o,1,t)}return this}crossFadeTo(e,t,r){return e.crossFadeFrom(this,t,r)}stopFading(){let e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,r){let i=this._mixer,n=i.time,a=this.timeScale,o=this._timeScaleInterpolant;o===null&&(o=i._lendControlInterpolant(),this._timeScaleInterpolant=o);let s=o.parameterPositions,l=o.sampleValues;return s[0]=n,s[1]=n+r,l[0]=e/a,l[1]=t/a,this}stopWarping(){let e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,r,i){if(!this.enabled){this._updateWeight(e);return}let n=this._startTime;if(n!==null){let s=(e-n)*r;s<0||r===0?t=0:(this._startTime=null,t=r*s)}t*=this._updateTimeScale(e);let a=this._updateTime(t),o=this._updateWeight(e);if(o>0){let s=this._interpolants,l=this._propertyBindings;switch(this.blendMode){case Fbe:for(let c=0,u=s.length;c!==u;++c)s[c].evaluate(a),l[c].accumulateAdditive(o);break;case UP:default:for(let c=0,u=s.length;c!==u;++c)s[c].evaluate(a),l[c].accumulate(i,o)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;let r=this._weightInterpolant;if(r!==null){let i=r.evaluate(e)[0];t*=i,e>r.parameterPositions[1]&&(this.stopFading(),i===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;let r=this._timeScaleInterpolant;if(r!==null){let i=r.evaluate(e)[0];t*=i,e>r.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){let t=this._clip.duration,r=this.loop,i=this.time+e,n=this._loopCount,a=r===NP;if(e===0)return n===-1?i:a&&(n&1)===1?t-i:i;if(r===ZV){n===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(i>=t)i=t;else if(i<0)i=0;else{this.time=i;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(n===-1&&(e>=0?(n=0,this._setEndings(!0,this.repetitions===0,a)):this._setEndings(this.repetitions===0,!0,a)),i>=t||i<0){let o=Math.floor(i/t);i-=t*o,n+=Math.abs(o);let s=this.repetitions-n;if(s<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,i=e>0?t:0,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(s===1){let l=e<0;this._setEndings(l,!l,a)}else this._setEndings(!1,!1,a);this._loopCount=n,this.time=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o})}}else this.time=i;if(a&&(n&1)===1)return t-i}return i}_setEndings(e,t,r){let i=this._interpolantSettings;r?(i.endingStart=Hf,i.endingEnd=Hf):(e?i.endingStart=this.zeroSlopeAtStart?Hf:Vf:i.endingStart=Ux,t?i.endingEnd=this.zeroSlopeAtEnd?Hf:Vf:i.endingEnd=Ux)}_scheduleFading(e,t,r){let i=this._mixer,n=i.time,a=this._weightInterpolant;a===null&&(a=i._lendControlInterpolant(),this._weightInterpolant=a);let o=a.parameterPositions,s=a.sampleValues;return o[0]=n,s[0]=t,o[1]=n+e,s[1]=r,this}},c2e=new Float32Array(1),u2e=class extends ca{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){let r=e._localRoot||this._root,i=e._clip.tracks,n=i.length,a=e._propertyBindings,o=e._interpolants,s=r.uuid,l=this._bindingsByRootAndName,c=l[s];c===void 0&&(c={},l[s]=c);for(let u=0;u!==n;++u){let d=i[u],h=d.name,f=c[h];if(f!==void 0)++f.referenceCount,a[u]=f;else{if(f=a[u],f!==void 0){f._cacheIndex===null&&(++f.referenceCount,this._addInactiveBinding(f,s,h));continue}let p=t&&t._propertyBindings[u].binding.parsedPath;f=new Z_e(ai.create(r,h,p),d.ValueTypeName,d.getValueSize()),++f.referenceCount,this._addInactiveBinding(f,s,h),a[u]=f}o[u].resultBuffer=f.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){let r=(e._localRoot||this._root).uuid,i=e._clip.uuid,n=this._actionsByClip[i];this._bindAction(e,n&&n.knownActions[0]),this._addInactiveAction(e,i,r)}let t=e._propertyBindings;for(let r=0,i=t.length;r!==i;++r){let n=t[r];n.useCount++===0&&(this._lendBinding(n),n.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){let t=e._propertyBindings;for(let r=0,i=t.length;r!==i;++r){let n=t[r];--n.useCount===0&&(n.restoreOriginalState(),this._takeBackBinding(n))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;let e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){let t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,r){let i=this._actions,n=this._actionsByClip,a=n[t];if(a===void 0)a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,n[t]=a;else{let o=a.knownActions;e._byClipCacheIndex=o.length,o.push(e)}e._cacheIndex=i.length,i.push(e),a.actionByRoot[r]=e}_removeInactiveAction(e){let t=this._actions,r=t[t.length-1],i=e._cacheIndex;r._cacheIndex=i,t[i]=r,t.pop(),e._cacheIndex=null;let n=e._clip.uuid,a=this._actionsByClip,o=a[n],s=o.knownActions,l=s[s.length-1],c=e._byClipCacheIndex;l._byClipCacheIndex=c,s[c]=l,s.pop(),e._byClipCacheIndex=null;let u=o.actionByRoot,d=(e._localRoot||this._root).uuid;delete u[d],s.length===0&&delete a[n],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){let t=e._propertyBindings;for(let r=0,i=t.length;r!==i;++r){let n=t[r];--n.referenceCount===0&&this._removeInactiveBinding(n)}}_lendAction(e){let t=this._actions,r=e._cacheIndex,i=this._nActiveActions++,n=t[i];e._cacheIndex=i,t[i]=e,n._cacheIndex=r,t[r]=n}_takeBackAction(e){let t=this._actions,r=e._cacheIndex,i=--this._nActiveActions,n=t[i];e._cacheIndex=i,t[i]=e,n._cacheIndex=r,t[r]=n}_addInactiveBinding(e,t,r){let i=this._bindingsByRootAndName,n=this._bindings,a=i[t];a===void 0&&(a={},i[t]=a),a[r]=e,e._cacheIndex=n.length,n.push(e)}_removeInactiveBinding(e){let t=this._bindings,r=e.binding,i=r.rootNode.uuid,n=r.path,a=this._bindingsByRootAndName,o=a[i],s=t[t.length-1],l=e._cacheIndex;s._cacheIndex=l,t[l]=s,t.pop(),delete o[n],Object.keys(o).length===0&&delete a[i]}_lendBinding(e){let t=this._bindings,r=e._cacheIndex,i=this._nActiveBindings++,n=t[i];e._cacheIndex=i,t[i]=e,n._cacheIndex=r,t[r]=n}_takeBackBinding(e){let t=this._bindings,r=e._cacheIndex,i=--this._nActiveBindings,n=t[i];e._cacheIndex=i,t[i]=e,n._cacheIndex=r,t[r]=n}_lendControlInterpolant(){let e=this._controlInterpolants,t=this._nActiveControlInterpolants++,r=e[t];return r===void 0&&(r=new O8(new Float32Array(2),new Float32Array(2),1,c2e),r.__cacheIndex=t,e[t]=r),r}_takeBackControlInterpolant(e){let t=this._controlInterpolants,r=e.__cacheIndex,i=--this._nActiveControlInterpolants,n=t[i];e.__cacheIndex=i,t[i]=e,n.__cacheIndex=r,t[r]=n}clipAction(e,t,r){let i=t||this._root,n=i.uuid,a=typeof e=="string"?wM.findByName(i,e):e,o=a!==null?a.uuid:e,s=this._actionsByClip[o],l=null;if(r===void 0&&(a!==null?r=a.blendMode:r=UP),s!==void 0){let u=s.actionByRoot[n];if(u!==void 0&&u.blendMode===r)return u;l=s.knownActions[0],a===null&&(a=l._clip)}if(a===null)return null;let c=new l2e(this,a,t,r);return this._bindAction(c,l),this._addInactiveAction(c,o,n),c}existingAction(e,t){let r=t||this._root,i=r.uuid,n=typeof e=="string"?wM.findByName(r,e):e,a=n?n.uuid:e,o=this._actionsByClip[a];return o!==void 0&&o.actionByRoot[i]||null}stopAllAction(){let e=this._actions,t=this._nActiveActions;for(let r=t-1;r>=0;--r)e[r].stop();return this}update(e){e*=this.timeScale;let t=this._actions,r=this._nActiveActions,i=this.time+=e,n=Math.sign(e),a=this._accuIndex^=1;for(let l=0;l!==r;++l)t[l]._update(i,e,n,a);let o=this._bindings,s=this._nActiveBindings;for(let l=0;l!==s;++l)o[l].apply(a);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){let t=this._actions,r=e.uuid,i=this._actionsByClip,n=i[r];if(n!==void 0){let a=n.knownActions;for(let o=0,s=a.length;o!==s;++o){let l=a[o];this._deactivateAction(l);let c=l._cacheIndex,u=t[t.length-1];l._cacheIndex=null,l._byClipCacheIndex=null,u._cacheIndex=c,t[c]=u,t.pop(),this._removeInactiveBindingsForAction(l)}delete i[r]}}uncacheRoot(e){let t=e.uuid,r=this._actionsByClip;for(let a in r){let o=r[a].actionByRoot,s=o[t];s!==void 0&&(this._deactivateAction(s),this._removeInactiveAction(s))}let i=this._bindingsByRootAndName,n=i[t];if(n!==void 0)for(let a in n){let o=n[a];o.restoreOriginalState(),this._removeInactiveBinding(o)}}uncacheAction(e,t){let r=this.existingAction(e,t);r!==null&&(this._deactivateAction(r),this._removeInactiveAction(r))}},rt=class{constructor(e){this.value=e}clone(){return new rt(this.value.clone===void 0?this.value:this.value.clone())}},L8=class{constructor(e,t,r=0,i=1/0){this.ray=new om(e,t),this.near=r,this.far=i,this.camera=null,this.layers=new VP,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,r=[]){return CM(e,this,r,t),r.sort(Ek),r}intersectObjects(e,t=!0,r=[]){for(let i=0,n=e.length;i<n;i++)CM(e[i],this,r,t);return r.sort(Ek),r}};function Ek(e,t){return e.distance-t.distance}function CM(e,t,r,i){if(e.layers.test(t.layers)&&e.raycast(t,r),i===!0){let n=e.children;for(let a=0,o=n.length;a<o;a++)CM(n[a],t,r,!0)}}var Tk=class{constructor(e=1,t=0,r=0){return this.radius=e,this.phi=t,this.theta=r,this}set(e,t,r){return this.radius=e,this.phi=t,this.theta=r,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,r){return this.radius=Math.sqrt(e*e+t*t+r*r),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,r),this.phi=Math.acos(an(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}},Pk=new ye,B8=class{constructor(e=new ye(1/0,1/0),t=new ye(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let r=Pk.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return Pk.copy(e).clamp(this.min,this.max).sub(e).length()}intersect(e){return this.min.max(e.min),this.max.min(e.max),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}},Dk=new k,Dy=new k,jo=class{constructor(e=new k,t=new k){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){Dk.subVectors(e,this.start),Dy.subVectors(this.end,this.start);let r=Dy.dot(Dy),i=Dy.dot(Dk)/r;return t&&(i=an(i,0,1)),i}closestPointToPoint(e,t,r){let i=this.closestPointToPointParameter(e,t);return this.delta(r).multiplyScalar(i).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}},Ok=new k,d2e=class extends Xr{constructor(e,t){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";let r=new Ot,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let a=0,o=1,s=32;a<s;a++,o++){let l=a/s*Math.PI*2,c=o/s*Math.PI*2;i.push(Math.cos(l),Math.sin(l),1,Math.cos(c),Math.sin(c),1)}r.setAttribute("position",new yt(i,3));let n=new Zu({fog:!1,toneMapped:!1});this.cone=new v0(r,n),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);let e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),Ok.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(Ok),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}},h2e=class extends Oi{constructor(e,t,r){let i=new op(t,4,2),n=new hc({wireframe:!0,fog:!1,toneMapped:!1});super(i,n),this.light=e,this.color=r,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}},Rk=new k,Oy=new k,Ik=new k,f2e=class extends Xr{constructor(e,t,r){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,this.type="DirectionalLightHelper",t===void 0&&(t=1);let i=new Ot;i.setAttribute("position",new yt([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));let n=new Zu({fog:!1,toneMapped:!1});this.lightPlane=new Hx(i,n),this.add(this.lightPlane),i=new Ot,i.setAttribute("position",new yt([0,0,0,0,0,1],3)),this.targetLine=new Hx(i,n),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),Rk.setFromMatrixPosition(this.light.matrixWorld),Oy.setFromMatrixPosition(this.light.target.matrixWorld),Ik.subVectors(Oy,Rk),this.lightPlane.lookAt(Oy),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Oy),this.targetLine.scale.z=Ik.length()}},Ry=new k,zi=new Rh,Xx=class extends v0{constructor(e){let t=new Ot,r=new Zu({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],n=[],a={};o("n1","n2"),o("n2","n4"),o("n4","n3"),o("n3","n1"),o("f1","f2"),o("f2","f4"),o("f4","f3"),o("f3","f1"),o("n1","f1"),o("n2","f2"),o("n3","f3"),o("n4","f4"),o("p","n1"),o("p","n2"),o("p","n3"),o("p","n4"),o("u1","u2"),o("u2","u3"),o("u3","u1"),o("c","t"),o("p","c"),o("cn1","cn2"),o("cn3","cn4"),o("cf1","cf2"),o("cf3","cf4");function o(f,p){s(f),s(p)}function s(f){i.push(0,0,0),n.push(0,0,0),a[f]===void 0&&(a[f]=[]),a[f].push(i.length/3-1)}t.setAttribute("position",new yt(i,3)),t.setAttribute("color",new yt(n,3)),super(t,r),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update();let l=new Bt(16755200),c=new Bt(16711680),u=new Bt(43775),d=new Bt(16777215),h=new Bt(3355443);this.setColors(l,c,u,d,h)}setColors(e,t,r,i,n){let a=this.geometry.getAttribute("color");a.setXYZ(0,e.r,e.g,e.b),a.setXYZ(1,e.r,e.g,e.b),a.setXYZ(2,e.r,e.g,e.b),a.setXYZ(3,e.r,e.g,e.b),a.setXYZ(4,e.r,e.g,e.b),a.setXYZ(5,e.r,e.g,e.b),a.setXYZ(6,e.r,e.g,e.b),a.setXYZ(7,e.r,e.g,e.b),a.setXYZ(8,e.r,e.g,e.b),a.setXYZ(9,e.r,e.g,e.b),a.setXYZ(10,e.r,e.g,e.b),a.setXYZ(11,e.r,e.g,e.b),a.setXYZ(12,e.r,e.g,e.b),a.setXYZ(13,e.r,e.g,e.b),a.setXYZ(14,e.r,e.g,e.b),a.setXYZ(15,e.r,e.g,e.b),a.setXYZ(16,e.r,e.g,e.b),a.setXYZ(17,e.r,e.g,e.b),a.setXYZ(18,e.r,e.g,e.b),a.setXYZ(19,e.r,e.g,e.b),a.setXYZ(20,e.r,e.g,e.b),a.setXYZ(21,e.r,e.g,e.b),a.setXYZ(22,e.r,e.g,e.b),a.setXYZ(23,e.r,e.g,e.b),a.setXYZ(24,t.r,t.g,t.b),a.setXYZ(25,t.r,t.g,t.b),a.setXYZ(26,t.r,t.g,t.b),a.setXYZ(27,t.r,t.g,t.b),a.setXYZ(28,t.r,t.g,t.b),a.setXYZ(29,t.r,t.g,t.b),a.setXYZ(30,t.r,t.g,t.b),a.setXYZ(31,t.r,t.g,t.b),a.setXYZ(32,r.r,r.g,r.b),a.setXYZ(33,r.r,r.g,r.b),a.setXYZ(34,r.r,r.g,r.b),a.setXYZ(35,r.r,r.g,r.b),a.setXYZ(36,r.r,r.g,r.b),a.setXYZ(37,r.r,r.g,r.b),a.setXYZ(38,i.r,i.g,i.b),a.setXYZ(39,i.r,i.g,i.b),a.setXYZ(40,n.r,n.g,n.b),a.setXYZ(41,n.r,n.g,n.b),a.setXYZ(42,n.r,n.g,n.b),a.setXYZ(43,n.r,n.g,n.b),a.setXYZ(44,n.r,n.g,n.b),a.setXYZ(45,n.r,n.g,n.b),a.setXYZ(46,n.r,n.g,n.b),a.setXYZ(47,n.r,n.g,n.b),a.setXYZ(48,n.r,n.g,n.b),a.setXYZ(49,n.r,n.g,n.b),a.needsUpdate=!0}update(){let e=this.geometry,t=this.pointMap,r=1,i=1;zi.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Vi("c",t,e,zi,0,0,-1),Vi("t",t,e,zi,0,0,1),Vi("n1",t,e,zi,-r,-i,-1),Vi("n2",t,e,zi,r,-i,-1),Vi("n3",t,e,zi,-r,i,-1),Vi("n4",t,e,zi,r,i,-1),Vi("f1",t,e,zi,-r,-i,1),Vi("f2",t,e,zi,r,-i,1),Vi("f3",t,e,zi,-r,i,1),Vi("f4",t,e,zi,r,i,1),Vi("u1",t,e,zi,r*.7,i*1.1,-1),Vi("u2",t,e,zi,-r*.7,i*1.1,-1),Vi("u3",t,e,zi,0,i*2,-1),Vi("cf1",t,e,zi,-r,0,1),Vi("cf2",t,e,zi,r,0,1),Vi("cf3",t,e,zi,0,-i,1),Vi("cf4",t,e,zi,0,i,1),Vi("cn1",t,e,zi,-r,0,-1),Vi("cn2",t,e,zi,r,0,-1),Vi("cn3",t,e,zi,0,-i,-1),Vi("cn4",t,e,zi,0,i,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}};function Vi(e,t,r,i,n,a,o){Ry.set(n,a,o).unproject(i);let s=t[e];if(s!==void 0){let l=r.getAttribute("position");for(let c=0,u=s.length;c<u;c++)l.setXYZ(s[c],Ry.x,Ry.y,Ry.z)}}var Kx=class extends v0{constructor(e,t=16776960){let r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],n=new Ot;n.setIndex(new qt(r,1)),n.setAttribute("position",new yt(i,3)),super(n,new Zu({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){let t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}},p2e=class extends v0{constructor(e=1){let t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],r=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],i=new Ot;i.setAttribute("position",new yt(t,3)),i.setAttribute("color",new yt(r,3));let n=new Zu({vertexColors:!0,toneMapped:!1});super(i,n),this.type="AxesHelper"}setColors(e,t,r){let i=new Bt,n=this.geometry.attributes.color.array;return i.set(e),i.toArray(n,0),i.toArray(n,3),i.set(t),i.toArray(n,6),i.toArray(n,9),i.set(r),i.toArray(n,12),i.toArray(n,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}},Kl=m2e();function m2e(){let e=new ArrayBuffer(4),t=new Float32Array(e),r=new Uint32Array(e),i=new Uint32Array(512),n=new Uint32Array(512);for(let l=0;l<256;++l){let c=l-127;c<-27?(i[l]=0,i[l|256]=32768,n[l]=24,n[l|256]=24):c<-14?(i[l]=1024>>-c-14,i[l|256]=1024>>-c-14|32768,n[l]=-c-1,n[l|256]=-c-1):c<=15?(i[l]=c+15<<10,i[l|256]=c+15<<10|32768,n[l]=13,n[l|256]=13):c<128?(i[l]=31744,i[l|256]=64512,n[l]=24,n[l|256]=24):(i[l]=31744,i[l|256]=64512,n[l]=13,n[l|256]=13)}let a=new Uint32Array(2048),o=new Uint32Array(64),s=new Uint32Array(64);for(let l=1;l<1024;++l){let c=l<<13,u=0;for(;!(c&8388608);)c<<=1,u-=8388608;c&=-8388609,u+=947912704,a[l]=c|u}for(let l=1024;l<2048;++l)a[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)o[l]=l<<23;o[31]=1199570944,o[32]=2147483648;for(let l=33;l<63;++l)o[l]=2147483648+(l-32<<23);o[63]=3347054592;for(let l=1;l<64;++l)l!==32&&(s[l]=1024);return{floatView:t,uint32View:r,baseTable:i,shiftTable:n,mantissaTable:a,exponentTable:o,offsetTable:s}}function v2e(e){Math.abs(e)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),e=an(e,-65504,65504),Kl.floatView[0]=e;let t=Kl.uint32View[0],r=t>>23&511;return Kl.baseTable[r]+((t&8388607)>>Kl.shiftTable[r])}function g2e(e){let t=e>>10;return Kl.uint32View[0]=Kl.mantissaTable[Kl.offsetTable[t]+(e&1023)]+Kl.exponentTable[t],Kl.floatView[0]}var y2e=Object.freeze({__proto__:null,fromHalfFloat:g2e,toHalfFloat:v2e});typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:am}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=am);var Gm=".",tD=Symbol("target"),F8=Symbol("unsubscribe");function _M(e){return e instanceof Date||e instanceof Set||e instanceof Map||e instanceof WeakSet||e instanceof WeakMap||ArrayBuffer.isView(e)}function b2e(e){return(typeof e=="object"?e===null:typeof e!="function")||e instanceof RegExp}var Qs=Array.isArray;function rD(e){return typeof e=="symbol"}var x2e={after:(e,t)=>Qs(e)?e.slice(t.length):t===""?e:e.slice(t.length+1),concat:(e,t)=>Qs(e)?(e=[...e],t&&e.push(t),e):t&&t.toString!==void 0?(e!==""&&(e+=Gm),rD(t)?e+t.toString():e+t):e,initial:e=>{if(Qs(e))return e.slice(0,-1);if(e==="")return e;let t=e.lastIndexOf(Gm);return t===-1?"":e.slice(0,t)},last:e=>{if(Qs(e))return e[e.length-1]||"";if(e==="")return e;let t=e.lastIndexOf(Gm);return t===-1?e:e.slice(t+1)},walk:(e,t)=>{if(Qs(e))for(let r of e)t(r);else if(e!==""){let r=0,i=e.indexOf(Gm);if(i===-1)t(e);else for(;r<e.length;)i===-1&&(i=e.length),t(e.slice(r,i)),r=i+1,i=e.indexOf(Gm,r)}},get(e,t){return this.walk(t,r=>{e&&(e=e[r])}),e}},Po=x2e;function w2e(e){return typeof e=="object"&&typeof e.next=="function"}function S2e(e,t,r,i,n){let a=e.next;if(t.name==="entries")e.next=function(){let o=a.call(this);return o.done===!1&&(o.value[0]=n(o.value[0],t,o.value[0],i),o.value[1]=n(o.value[1],t,o.value[0],i)),o};else if(t.name==="values"){let o=r[tD].keys();e.next=function(){let s=a.call(this);return s.done===!1&&(s.value=n(s.value,t,o.next().value,i)),s}}else e.next=function(){let o=a.call(this);return o.done===!1&&(o.value=n(o.value,t,o.value,i)),o};return e}function zk(e,t,r){return e.isUnsubscribed||t.ignoreSymbols&&rD(r)||t.ignoreUnderscores&&r.charAt(0)==="_"||"ignoreKeys"in t&&t.ignoreKeys.includes(r)}var C2e=class{constructor(e){this._equals=e,this._proxyCache=new WeakMap,this._pathCache=new WeakMap,this.isUnsubscribed=!1}_getDescriptorCache(){return this._descriptorCache===void 0&&(this._descriptorCache=new WeakMap),this._descriptorCache}_getProperties(e){let t=this._getDescriptorCache(),r=t.get(e);return r===void 0&&(r={},t.set(e,r)),r}_getOwnPropertyDescriptor(e,t){if(this.isUnsubscribed)return Reflect.getOwnPropertyDescriptor(e,t);let r=this._getProperties(e),i=r[t];return i===void 0&&(i=Reflect.getOwnPropertyDescriptor(e,t),r[t]=i),i}getProxy(e,t,r,i){if(this.isUnsubscribed)return e;let n=e[i],a=n||e;this._pathCache.set(a,t);let o=this._proxyCache.get(a);return o===void 0&&(o=n===void 0?new Proxy(e,r):e,this._proxyCache.set(a,o)),o}getPath(e){return this.isUnsubscribed?void 0:this._pathCache.get(e)}isDetached(e,t){return!Object.is(e,Po.get(t,this.getPath(e)))}defineProperty(e,t,r){return Reflect.defineProperty(e,t,r)?(this.isUnsubscribed||(this._getProperties(e)[t]=r),!0):!1}setProperty(e,t,r,i,n){if(!this._equals(n,r)||!(t in e)){let a=this._getOwnPropertyDescriptor(e,t);return a!==void 0&&"set"in a?Reflect.set(e,t,r,i):Reflect.set(e,t,r)}return!0}deleteProperty(e,t,r){if(Reflect.deleteProperty(e,t)){if(!this.isUnsubscribed){let i=this._getDescriptorCache().get(e);i&&(delete i[t],this._pathCache.delete(r))}return!0}return!1}isSameDescriptor(e,t,r){let i=this._getOwnPropertyDescriptor(t,r);return e!==void 0&&i!==void 0&&Object.is(e.value,i.value)&&(e.writable||!1)===(i.writable||!1)&&(e.enumerable||!1)===(i.enumerable||!1)&&(e.configurable||!1)===(i.configurable||!1)&&e.get===i.get&&e.set===i.set}isGetInvariant(e,t){let r=this._getOwnPropertyDescriptor(e,t);return r!==void 0&&r.configurable!==!0&&r.writable!==!0}unsubscribe(){this._descriptorCache=null,this._pathCache=null,this._proxyCache=null,this.isUnsubscribed=!0}};function AM(e){return toString.call(e)==="[object Object]"}function Iy(){return!0}function hf(e,t){return e.length!==t.length||e.some((r,i)=>t[i]!==r)}var N8=new Set(["hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),_2e=new Set(["concat","includes","indexOf","join","keys","lastIndexOf"]),U8={push:Iy,pop:Iy,shift:Iy,unshift:Iy,copyWithin:hf,reverse:hf,sort:hf,splice:hf,flat:hf,fill:hf},A2e=new Set([...N8,..._2e,...Object.keys(U8)]);function zy(e,t){if(e.size!==t.size)return!0;for(let r of e)if(!t.has(r))return!0;return!1}var j8=["keys","values","entries"],V8=new Set(["has","toString"]),H8={add:zy,clear:zy,delete:zy,forEach:zy},M2e=new Set([...V8,...Object.keys(H8),...j8]);function ky(e,t){if(e.size!==t.size)return!0;let r;for(let[i,n]of e)if(r=t.get(i),r!==n||r===void 0&&!t.has(i))return!0;return!1}var E2e=new Set([...V8,"get"]),W8={set:ky,clear:ky,delete:ky,forEach:ky},T2e=new Set([...E2e,...Object.keys(W8),...j8]),Fu=class{constructor(e,t,r,i){this._path=t,this._isChanged=!1,this._clonedCache=new Set,this._hasOnValidate=i,this._changes=i?[]:null,this.clone=t===void 0?e:this._shallowClone(e)}static isHandledMethod(e){return N8.has(e)}_shallowClone(e){let t=e;if(AM(e))t={...e};else if(Qs(e))t=[...e];else if(e instanceof Date)t=new Date(e);else if(e instanceof Set)t=new Set([...e].map(r=>this._shallowClone(r)));else if(e instanceof Map){t=new Map;for(let[r,i]of e.entries())t.set(r,this._shallowClone(i))}return this._clonedCache.add(t),t}preferredThisArg(e,t,r,i){return e?(Qs(i)?this._onIsChanged=U8[t]:i instanceof Set?this._onIsChanged=H8[t]:i instanceof Map&&(this._onIsChanged=W8[t]),i):r}update(e,t,r){let i=Po.after(e,this._path);if(t!=="length"){let n=this.clone;Po.walk(i,a=>{n&&n[a]&&(this._clonedCache.has(n[a])||(n[a]=this._shallowClone(n[a])),n=n[a])}),this._hasOnValidate&&this._changes.push({path:i,property:t,previous:r}),n&&n[t]&&(n[t]=r)}this._isChanged=!0}undo(e){let t;for(let r=this._changes.length-1;r!==-1;r--)t=this._changes[r],Po.get(e,t.path)[t.property]=t.previous}isChanged(e){return this._onIsChanged===void 0?this._isChanged:this._onIsChanged(this.clone,e)}},kk=class extends Fu{static isHandledMethod(e){return A2e.has(e)}},P2e=class extends Fu{undo(e){e.setTime(this.clone.getTime())}isChanged(e,t){return!t(this.clone.valueOf(),e.valueOf())}},Lk=class extends Fu{static isHandledMethod(e){return M2e.has(e)}undo(e){for(let t of this.clone)e.add(t);for(let t of e)this.clone.has(t)||e.delete(t)}},Bk=class extends Fu{static isHandledMethod(e){return T2e.has(e)}undo(e){for(let[t,r]of this.clone.entries())e.set(t,r);for(let t of e.keys())this.clone.has(t)||e.delete(t)}},D2e=class extends Fu{constructor(e,t,r,i){super(void 0,t,r,i),this._arg1=r[0],this._weakValue=e.has(this._arg1)}isChanged(e){return this._weakValue!==e.has(this._arg1)}undo(e){this._weakValue&&!e.has(this._arg1)?e.add(this._arg1):e.delete(this._arg1)}},O2e=class extends Fu{constructor(e,t,r,i){super(void 0,t,r,i),this._weakKey=r[0],this._weakHas=e.has(this._weakKey),this._weakValue=e.get(this._weakKey)}isChanged(e){return this._weakValue!==e.get(this._weakKey)}undo(e){let t=e.has(this._weakKey);this._weakHas&&!t?e.set(this._weakKey,this._weakValue):!this._weakHas&&t?e.delete(this._weakKey):this._weakValue!==e.get(this._weakKey)&&e.set(this._weakKey,this._weakValue)}},If=class{constructor(e){this._stack=[],this._hasOnValidate=e}static isHandledType(e){return AM(e)||Qs(e)||_M(e)}static isHandledMethod(e,t){return AM(e)?Fu.isHandledMethod(t):Qs(e)?kk.isHandledMethod(t):e instanceof Set?Lk.isHandledMethod(t):e instanceof Map?Bk.isHandledMethod(t):_M(e)}get isCloning(){return this._stack.length>0}start(e,t,r){let i=Fu;Qs(e)?i=kk:e instanceof Date?i=P2e:e instanceof Set?i=Lk:e instanceof Map?i=Bk:e instanceof WeakSet?i=D2e:e instanceof WeakMap&&(i=O2e),this._stack.push(new i(e,t,r,this._hasOnValidate))}update(e,t,r){this._stack[this._stack.length-1].update(e,t,r)}preferredThisArg(e,t,r){let{name:i}=e,n=If.isHandledMethod(r,i);return this._stack[this._stack.length-1].preferredThisArg(n,i,t,r)}isChanged(e,t,r){return this._stack[this._stack.length-1].isChanged(e,t,r)}undo(e){this._previousClone!==void 0&&this._previousClone.undo(e)}stop(){return this._previousClone=this._stack.pop(),this._previousClone.clone}},R2e={equals:Object.is,isShallow:!1,pathAsArray:!1,ignoreSymbols:!1,ignoreUnderscores:!1,ignoreDetached:!1,details:!1},iD=(e,t,r={})=>{r={...R2e,...r};let i=Symbol("ProxyTarget"),{equals:n,isShallow:a,ignoreDetached:o,details:s}=r,l=new C2e(n),c=typeof r.onValidate=="function",u=new If(c),d=(y,b,x,S,w)=>!c||u.isCloning||r.onValidate(Po.concat(l.getPath(y),b),x,S,w)===!0,h=(y,b,x,S)=>{!zk(l,r,b)&&!(o&&l.isDetached(y,e))&&f(l.getPath(y),b,x,S)},f=(y,b,x,S,w)=>{u.isCloning?u.update(y,b,S):t(Po.concat(y,b),x,S,w)},p=y=>y&&(y[i]||y),v=(y,b,x,S)=>b2e(y)||x==="constructor"||a&&!If.isHandledMethod(b,x)||zk(l,r,x)||l.isGetInvariant(b,x)||o&&l.isDetached(b,e)?y:(S===void 0&&(S=l.getPath(b)),l.getProxy(y,Po.concat(S,x),m,i)),m={get(y,b,x){if(rD(b)){if(b===i||b===tD)return y;if(b===F8&&!l.isUnsubscribed&&l.getPath(y).length===0)return l.unsubscribe(),y}let S=_M(y)?Reflect.get(y,b):Reflect.get(y,b,x);return v(S,y,b)},set(y,b,x,S){x=p(x);let w=y[i]||y,_=w[b];if(n(_,x)&&b in y)return!0;let C=d(y,b,x,_);return C&&l.setProperty(w,b,x,S,_)?(h(y,b,y[b],_),!0):!C},defineProperty(y,b,x){if(!l.isSameDescriptor(x,y,b)){let S=y[b];d(y,b,x.value,S)&&l.defineProperty(y,b,x,S)&&h(y,b,x.value,S)}return!0},deleteProperty(y,b){if(!Reflect.has(y,b))return!0;let x=Reflect.get(y,b),S=d(y,b,void 0,x);return S&&l.deleteProperty(y,b,x)?(h(y,b,void 0,x),!0):!S},apply(y,b,x){let S=b[i]||b;if(l.isUnsubscribed)return Reflect.apply(y,S,x);if((s===!1||s!==!0&&!s.includes(y.name))&&If.isHandledType(S)){let w=Po.initial(l.getPath(y)),_=If.isHandledMethod(S,y.name);u.start(S,w,x);let C=Reflect.apply(y,u.preferredThisArg(y,b,S),_?x.map(P=>p(P)):x),A=u.isChanged(S,n),M=u.stop();if(If.isHandledType(C)&&_&&(b instanceof Map&&y.name==="get"&&(w=Po.concat(w,x[0])),C=l.getProxy(C,w,m)),A){let P={name:y.name,args:x,result:C},T=u.isCloning?Po.initial(w):w,R=u.isCloning?Po.last(w):"";d(Po.get(e,T),R,S,M,P)?f(T,R,S,M,P):u.undo(S)}return(b instanceof Map||b instanceof Set)&&w2e(C)?S2e(C,y,b,w,v):C}return Reflect.apply(y,b,x)}},g=l.getProxy(e,r.pathAsArray?[]:"",m);return t=t.bind(g),c&&(r.onValidate=r.onValidate.bind(g)),g};iD.target=e=>e&&e[tD]||e;iD.unsubscribe=e=>e[F8]||e;var Fk=iD,I2e=typeof global=="object"&&global&&global.Object===Object&&global,G8=I2e,z2e=typeof self=="object"&&self&&self.Object===Object&&self,k2e=G8||z2e||Function("return this")(),Ms=k2e,L2e=Ms.Symbol,Go=L2e,$8=Object.prototype,B2e=$8.hasOwnProperty,F2e=$8.toString,$m=Go?Go.toStringTag:void 0;function N2e(e){var t=B2e.call(e,$m),r=e[$m];try{e[$m]=void 0;var i=!0}catch{}var n=F2e.call(e);return i&&(t?e[$m]=r:delete e[$m]),n}var U2e=N2e,j2e=Object.prototype,V2e=j2e.toString;function H2e(e){return V2e.call(e)}var W2e=H2e,G2e="[object Null]",$2e="[object Undefined]",Nk=Go?Go.toStringTag:void 0;function q2e(e){return e==null?e===void 0?$2e:G2e:Nk&&Nk in Object(e)?U2e(e):W2e(e)}var Ih=q2e;function Y2e(e){return e!=null&&typeof e=="object"}var pc=Y2e,X2e="[object Symbol]";function K2e(e){return typeof e=="symbol"||pc(e)&&Ih(e)==X2e}var x0=K2e;function Q2e(e,t){for(var r=-1,i=e==null?0:e.length,n=Array(i);++r<i;)n[r]=t(e[r],r,e);return n}var q8=Q2e,Z2e=Array.isArray,pl=Z2e,J2e=1/0,Uk=Go?Go.prototype:void 0,jk=Uk?Uk.toString:void 0;function Y8(e){if(typeof e=="string")return e;if(pl(e))return q8(e,Y8)+"";if(x0(e))return jk?jk.call(e):"";var t=e+"";return t=="0"&&1/e==-J2e?"-0":t}var eAe=Y8,tAe=/\s/;function rAe(e){for(var t=e.length;t--&&tAe.test(e.charAt(t)););return t}var iAe=rAe,nAe=/^\s+/;function aAe(e){return e&&e.slice(0,iAe(e)+1).replace(nAe,"")}var oAe=aAe;function sAe(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Ss=sAe,Vk=NaN,lAe=/^[-+]0x[0-9a-f]+$/i,cAe=/^0b[01]+$/i,uAe=/^0o[0-7]+$/i,dAe=parseInt;function hAe(e){if(typeof e=="number")return e;if(x0(e))return Vk;if(Ss(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=Ss(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=oAe(e);var r=cAe.test(e);return r||uAe.test(e)?dAe(e.slice(2),r?2:8):lAe.test(e)?Vk:+e}var Hk=hAe;function fAe(e){return e}var X8=fAe,pAe="[object AsyncFunction]",mAe="[object Function]",vAe="[object GeneratorFunction]",gAe="[object Proxy]";function yAe(e){if(!Ss(e))return!1;var t=Ih(e);return t==mAe||t==vAe||t==pAe||t==gAe}var K8=yAe,bAe=Ms["__core-js_shared__"],GC=bAe,Wk=function(){var e=/[^.]+$/.exec(GC&&GC.keys&&GC.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function xAe(e){return!!Wk&&Wk in e}var wAe=xAe,SAe=Function.prototype,CAe=SAe.toString;function _Ae(e){if(e!=null){try{return CAe.call(e)}catch{}try{return e+""}catch{}}return""}var zh=_Ae,AAe=/[\\^$.*+?()[\]{}|]/g,MAe=/^\[object .+?Constructor\]$/,EAe=Function.prototype,TAe=Object.prototype,PAe=EAe.toString,DAe=TAe.hasOwnProperty,OAe=RegExp("^"+PAe.call(DAe).replace(AAe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function RAe(e){if(!Ss(e)||wAe(e))return!1;var t=K8(e)?OAe:MAe;return t.test(zh(e))}var IAe=RAe;function zAe(e,t){return e==null?void 0:e[t]}var kAe=zAe;function LAe(e,t){var r=kAe(e,t);return IAe(r)?r:void 0}var kh=LAe,BAe=kh(Ms,"WeakMap"),MM=BAe,Gk=Object.create,FAe=function(){function e(){}return function(t){if(!Ss(t))return{};if(Gk)return Gk(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}(),NAe=FAe;function UAe(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var jAe=UAe;function VAe(e,t){var r=-1,i=e.length;for(t||(t=Array(i));++r<i;)t[r]=e[r];return t}var HAe=VAe,WAe=800,GAe=16,$Ae=Date.now;function qAe(e){var t=0,r=0;return function(){var i=$Ae(),n=GAe-(i-r);if(r=i,n>0){if(++t>=WAe)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var YAe=qAe;function XAe(e){return function(){return e}}var KAe=XAe,QAe=function(){try{var e=kh(Object,"defineProperty");return e({},"",{}),e}catch{}}(),Qx=QAe,ZAe=Qx?function(e,t){return Qx(e,"toString",{configurable:!0,enumerable:!1,value:KAe(t),writable:!0})}:X8,JAe=ZAe,eMe=YAe(JAe),tMe=eMe;function rMe(e,t){for(var r=-1,i=e==null?0:e.length;++r<i&&t(e[r],r,e)!==!1;);return e}var iMe=rMe,nMe=9007199254740991,aMe=/^(?:0|[1-9]\d*)$/;function oMe(e,t){var r=typeof e;return t=t??nMe,!!t&&(r=="number"||r!="symbol"&&aMe.test(e))&&e>-1&&e%1==0&&e<t}var nD=oMe;function sMe(e,t,r){t=="__proto__"&&Qx?Qx(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var Q8=sMe;function lMe(e,t){return e===t||e!==e&&t!==t}var aD=lMe,cMe=Object.prototype,uMe=cMe.hasOwnProperty;function dMe(e,t,r){var i=e[t];(!(uMe.call(e,t)&&aD(i,r))||r===void 0&&!(t in e))&&Q8(e,t,r)}var oD=dMe;function hMe(e,t,r,i){var n=!r;r||(r={});for(var a=-1,o=t.length;++a<o;){var s=t[a],l=i?i(r[s],e[s],s,r,e):void 0;l===void 0&&(l=e[s]),n?Q8(r,s,l):oD(r,s,l)}return r}var w0=hMe,$k=Math.max;function fMe(e,t,r){return t=$k(t===void 0?e.length-1:t,0),function(){for(var i=arguments,n=-1,a=$k(i.length-t,0),o=Array(a);++n<a;)o[n]=i[t+n];n=-1;for(var s=Array(t+1);++n<t;)s[n]=i[n];return s[t]=r(o),jAe(e,this,s)}}var pMe=fMe,mMe=9007199254740991;function vMe(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=mMe}var sD=vMe;function gMe(e){return e!=null&&sD(e.length)&&!K8(e)}var Z8=gMe,yMe=Object.prototype;function bMe(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||yMe;return e===r}var lD=bMe;function xMe(e,t){for(var r=-1,i=Array(e);++r<e;)i[r]=t(r);return i}var wMe=xMe,SMe="[object Arguments]";function CMe(e){return pc(e)&&Ih(e)==SMe}var qk=CMe,J8=Object.prototype,_Me=J8.hasOwnProperty,AMe=J8.propertyIsEnumerable,MMe=qk(function(){return arguments}())?qk:function(e){return pc(e)&&_Me.call(e,"callee")&&!AMe.call(e,"callee")},cD=MMe;function EMe(){return!1}var TMe=EMe,eH=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Yk=eH&&typeof module=="object"&&module&&!module.nodeType&&module,PMe=Yk&&Yk.exports===eH,Xk=PMe?Ms.Buffer:void 0,DMe=Xk?Xk.isBuffer:void 0,OMe=DMe||TMe,Zx=OMe,RMe="[object Arguments]",IMe="[object Array]",zMe="[object Boolean]",kMe="[object Date]",LMe="[object Error]",BMe="[object Function]",FMe="[object Map]",NMe="[object Number]",UMe="[object Object]",jMe="[object RegExp]",VMe="[object Set]",HMe="[object String]",WMe="[object WeakMap]",GMe="[object ArrayBuffer]",$Me="[object DataView]",qMe="[object Float32Array]",YMe="[object Float64Array]",XMe="[object Int8Array]",KMe="[object Int16Array]",QMe="[object Int32Array]",ZMe="[object Uint8Array]",JMe="[object Uint8ClampedArray]",eEe="[object Uint16Array]",tEe="[object Uint32Array]",xi={};xi[qMe]=xi[YMe]=xi[XMe]=xi[KMe]=xi[QMe]=xi[ZMe]=xi[JMe]=xi[eEe]=xi[tEe]=!0;xi[RMe]=xi[IMe]=xi[GMe]=xi[zMe]=xi[$Me]=xi[kMe]=xi[LMe]=xi[BMe]=xi[FMe]=xi[NMe]=xi[UMe]=xi[jMe]=xi[VMe]=xi[HMe]=xi[WMe]=!1;function rEe(e){return pc(e)&&sD(e.length)&&!!xi[Ih(e)]}var iEe=rEe;function nEe(e){return function(t){return e(t)}}var uD=nEe,tH=typeof exports=="object"&&exports&&!exports.nodeType&&exports,qv=tH&&typeof module=="object"&&module&&!module.nodeType&&module,aEe=qv&&qv.exports===tH,$C=aEe&&G8.process,oEe=function(){try{var e=qv&&qv.require&&qv.require("util").types;return e||$C&&$C.binding&&$C.binding("util")}catch{}}(),Bp=oEe,Kk=Bp&&Bp.isTypedArray,sEe=Kk?uD(Kk):iEe,rH=sEe,lEe=Object.prototype,cEe=lEe.hasOwnProperty;function uEe(e,t){var r=pl(e),i=!r&&cD(e),n=!r&&!i&&Zx(e),a=!r&&!i&&!n&&rH(e),o=r||i||n||a,s=o?wMe(e.length,String):[],l=s.length;for(var c in e)(t||cEe.call(e,c))&&!(o&&(c=="length"||n&&(c=="offset"||c=="parent")||a&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||nD(c,l)))&&s.push(c);return s}var iH=uEe;function dEe(e,t){return function(r){return e(t(r))}}var nH=dEe,hEe=nH(Object.keys,Object),fEe=hEe,pEe=Object.prototype,mEe=pEe.hasOwnProperty;function vEe(e){if(!lD(e))return fEe(e);var t=[];for(var r in Object(e))mEe.call(e,r)&&r!="constructor"&&t.push(r);return t}var gEe=vEe;function yEe(e){return Z8(e)?iH(e):gEe(e)}var dD=yEe;function bEe(e){var t=[];if(e!=null)for(var r in Object(e))t.push(r);return t}var xEe=bEe,wEe=Object.prototype,SEe=wEe.hasOwnProperty;function CEe(e){if(!Ss(e))return xEe(e);var t=lD(e),r=[];for(var i in e)i=="constructor"&&(t||!SEe.call(e,i))||r.push(i);return r}var _Ee=CEe;function AEe(e){return Z8(e)?iH(e,!0):_Ee(e)}var zd=AEe,MEe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,EEe=/^\w*$/;function TEe(e,t){if(pl(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||x0(e)?!0:EEe.test(e)||!MEe.test(e)||t!=null&&e in Object(t)}var PEe=TEe,DEe=kh(Object,"create"),Ig=DEe;function OEe(){this.__data__=Ig?Ig(null):{},this.size=0}var REe=OEe;function IEe(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var zEe=IEe,kEe="__lodash_hash_undefined__",LEe=Object.prototype,BEe=LEe.hasOwnProperty;function FEe(e){var t=this.__data__;if(Ig){var r=t[e];return r===kEe?void 0:r}return BEe.call(t,e)?t[e]:void 0}var NEe=FEe,UEe=Object.prototype,jEe=UEe.hasOwnProperty;function VEe(e){var t=this.__data__;return Ig?t[e]!==void 0:jEe.call(t,e)}var HEe=VEe,WEe="__lodash_hash_undefined__";function GEe(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=Ig&&t===void 0?WEe:t,this}var $Ee=GEe;function dm(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}dm.prototype.clear=REe;dm.prototype.delete=zEe;dm.prototype.get=NEe;dm.prototype.has=HEe;dm.prototype.set=$Ee;var Qk=dm;function qEe(){this.__data__=[],this.size=0}var YEe=qEe;function XEe(e,t){for(var r=e.length;r--;)if(aD(e[r][0],t))return r;return-1}var Iw=XEe,KEe=Array.prototype,QEe=KEe.splice;function ZEe(e){var t=this.__data__,r=Iw(t,e);if(r<0)return!1;var i=t.length-1;return r==i?t.pop():QEe.call(t,r,1),--this.size,!0}var JEe=ZEe;function eTe(e){var t=this.__data__,r=Iw(t,e);return r<0?void 0:t[r][1]}var tTe=eTe;function rTe(e){return Iw(this.__data__,e)>-1}var iTe=rTe;function nTe(e,t){var r=this.__data__,i=Iw(r,e);return i<0?(++this.size,r.push([e,t])):r[i][1]=t,this}var aTe=nTe;function hm(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}hm.prototype.clear=YEe;hm.prototype.delete=JEe;hm.prototype.get=tTe;hm.prototype.has=iTe;hm.prototype.set=aTe;var zw=hm,oTe=kh(Ms,"Map"),zg=oTe;function sTe(){this.size=0,this.__data__={hash:new Qk,map:new(zg||zw),string:new Qk}}var lTe=sTe;function cTe(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var uTe=cTe;function dTe(e,t){var r=e.__data__;return uTe(t)?r[typeof t=="string"?"string":"hash"]:r.map}var kw=dTe;function hTe(e){var t=kw(this,e).delete(e);return this.size-=t?1:0,t}var fTe=hTe;function pTe(e){return kw(this,e).get(e)}var mTe=pTe;function vTe(e){return kw(this,e).has(e)}var gTe=vTe;function yTe(e,t){var r=kw(this,e),i=r.size;return r.set(e,t),this.size+=r.size==i?0:1,this}var bTe=yTe;function fm(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}fm.prototype.clear=lTe;fm.prototype.delete=fTe;fm.prototype.get=mTe;fm.prototype.has=gTe;fm.prototype.set=bTe;var Lw=fm,xTe="Expected a function";function hD(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(xTe);var r=function(){var i=arguments,n=t?t.apply(this,i):i[0],a=r.cache;if(a.has(n))return a.get(n);var o=e.apply(this,i);return r.cache=a.set(n,o)||a,o};return r.cache=new(hD.Cache||Lw),r}hD.Cache=Lw;var wTe=hD,STe=500;function CTe(e){var t=wTe(e,function(i){return r.size===STe&&r.clear(),i}),r=t.cache;return t}var _Te=CTe,ATe=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,MTe=/\\(\\)?/g,ETe=_Te(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(ATe,function(r,i,n,a){t.push(n?a.replace(MTe,"$1"):i||r)}),t}),TTe=ETe;function PTe(e){return e==null?"":eAe(e)}var DTe=PTe;function OTe(e,t){return pl(e)?e:PEe(e,t)?[e]:TTe(DTe(e))}var pm=OTe,RTe=1/0;function ITe(e){if(typeof e=="string"||x0(e))return e;var t=e+"";return t=="0"&&1/e==-RTe?"-0":t}var Bw=ITe;function zTe(e,t){t=pm(t,e);for(var r=0,i=t.length;e!=null&&r<i;)e=e[Bw(t[r++])];return r&&r==i?e:void 0}var aH=zTe;function kTe(e,t){for(var r=-1,i=t.length,n=e.length;++r<i;)e[n+r]=t[r];return e}var fD=kTe,Zk=Go?Go.isConcatSpreadable:void 0;function LTe(e){return pl(e)||cD(e)||!!(Zk&&e&&e[Zk])}var BTe=LTe;function oH(e,t,r,i,n){var a=-1,o=e.length;for(r||(r=BTe),n||(n=[]);++a<o;){var s=e[a];t>0&&r(s)?t>1?oH(s,t-1,r,i,n):fD(n,s):i||(n[n.length]=s)}return n}var FTe=oH;function NTe(e){var t=e==null?0:e.length;return t?FTe(e,1):[]}var UTe=NTe;function jTe(e){return tMe(pMe(e,void 0,UTe),e+"")}var sH=jTe,VTe=nH(Object.getPrototypeOf,Object),pD=VTe,HTe="[object Object]",WTe=Function.prototype,GTe=Object.prototype,lH=WTe.toString,$Te=GTe.hasOwnProperty,qTe=lH.call(Object);function YTe(e){if(!pc(e)||Ih(e)!=HTe)return!1;var t=pD(e);if(t===null)return!0;var r=$Te.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&lH.call(r)==qTe}var XTe=YTe;function KTe(e,t,r){var i=-1,n=e.length;t<0&&(t=-t>n?0:n+t),r=r>n?n:r,r<0&&(r+=n),n=t>r?0:r-t>>>0,t>>>=0;for(var a=Array(n);++i<n;)a[i]=e[i+t];return a}var QTe=KTe;function ZTe(){this.__data__=new zw,this.size=0}var JTe=ZTe;function ePe(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var tPe=ePe;function rPe(e){return this.__data__.get(e)}var iPe=rPe;function nPe(e){return this.__data__.has(e)}var aPe=nPe,oPe=200;function sPe(e,t){var r=this.__data__;if(r instanceof zw){var i=r.__data__;if(!zg||i.length<oPe-1)return i.push([e,t]),this.size=++r.size,this;r=this.__data__=new Lw(i)}return r.set(e,t),this.size=r.size,this}var lPe=sPe;function mm(e){var t=this.__data__=new zw(e);this.size=t.size}mm.prototype.clear=JTe;mm.prototype.delete=tPe;mm.prototype.get=iPe;mm.prototype.has=aPe;mm.prototype.set=lPe;var jb=mm;function cPe(e,t){return e&&w0(t,dD(t),e)}var uPe=cPe;function dPe(e,t){return e&&w0(t,zd(t),e)}var hPe=dPe,cH=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Jk=cH&&typeof module=="object"&&module&&!module.nodeType&&module,fPe=Jk&&Jk.exports===cH,eL=fPe?Ms.Buffer:void 0,tL=eL?eL.allocUnsafe:void 0;function pPe(e,t){if(t)return e.slice();var r=e.length,i=tL?tL(r):new e.constructor(r);return e.copy(i),i}var mPe=pPe;function vPe(e,t){for(var r=-1,i=e==null?0:e.length,n=0,a=[];++r<i;){var o=e[r];t(o,r,e)&&(a[n++]=o)}return a}var gPe=vPe;function yPe(){return[]}var uH=yPe,bPe=Object.prototype,xPe=bPe.propertyIsEnumerable,rL=Object.getOwnPropertySymbols,wPe=rL?function(e){return e==null?[]:(e=Object(e),gPe(rL(e),function(t){return xPe.call(e,t)}))}:uH,mD=wPe;function SPe(e,t){return w0(e,mD(e),t)}var CPe=SPe,_Pe=Object.getOwnPropertySymbols,APe=_Pe?function(e){for(var t=[];e;)fD(t,mD(e)),e=pD(e);return t}:uH,dH=APe;function MPe(e,t){return w0(e,dH(e),t)}var EPe=MPe;function TPe(e,t,r){var i=t(e);return pl(e)?i:fD(i,r(e))}var hH=TPe;function PPe(e){return hH(e,dD,mD)}var EM=PPe;function DPe(e){return hH(e,zd,dH)}var fH=DPe,OPe=kh(Ms,"DataView"),TM=OPe,RPe=kh(Ms,"Promise"),PM=RPe,IPe=kh(Ms,"Set"),DM=IPe,iL="[object Map]",zPe="[object Object]",nL="[object Promise]",aL="[object Set]",oL="[object WeakMap]",sL="[object DataView]",kPe=zh(TM),LPe=zh(zg),BPe=zh(PM),FPe=zh(DM),NPe=zh(MM),yd=Ih;(TM&&yd(new TM(new ArrayBuffer(1)))!=sL||zg&&yd(new zg)!=iL||PM&&yd(PM.resolve())!=nL||DM&&yd(new DM)!=aL||MM&&yd(new MM)!=oL)&&(yd=function(e){var t=Ih(e),r=t==zPe?e.constructor:void 0,i=r?zh(r):"";if(i)switch(i){case kPe:return sL;case LPe:return iL;case BPe:return nL;case FPe:return aL;case NPe:return oL}return t});var kg=yd,UPe=Object.prototype,jPe=UPe.hasOwnProperty;function VPe(e){var t=e.length,r=new e.constructor(t);return t&&typeof e[0]=="string"&&jPe.call(e,"index")&&(r.index=e.index,r.input=e.input),r}var HPe=VPe,WPe=Ms.Uint8Array,Jx=WPe;function GPe(e){var t=new e.constructor(e.byteLength);return new Jx(t).set(new Jx(e)),t}var vD=GPe;function $Pe(e,t){var r=t?vD(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}var qPe=$Pe,YPe=/\w*$/;function XPe(e){var t=new e.constructor(e.source,YPe.exec(e));return t.lastIndex=e.lastIndex,t}var KPe=XPe,lL=Go?Go.prototype:void 0,cL=lL?lL.valueOf:void 0;function QPe(e){return cL?Object(cL.call(e)):{}}var ZPe=QPe;function JPe(e,t){var r=t?vD(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}var eDe=JPe,tDe="[object Boolean]",rDe="[object Date]",iDe="[object Map]",nDe="[object Number]",aDe="[object RegExp]",oDe="[object Set]",sDe="[object String]",lDe="[object Symbol]",cDe="[object ArrayBuffer]",uDe="[object DataView]",dDe="[object Float32Array]",hDe="[object Float64Array]",fDe="[object Int8Array]",pDe="[object Int16Array]",mDe="[object Int32Array]",vDe="[object Uint8Array]",gDe="[object Uint8ClampedArray]",yDe="[object Uint16Array]",bDe="[object Uint32Array]";function xDe(e,t,r){var i=e.constructor;switch(t){case cDe:return vD(e);case tDe:case rDe:return new i(+e);case uDe:return qPe(e,r);case dDe:case hDe:case fDe:case pDe:case mDe:case vDe:case gDe:case yDe:case bDe:return eDe(e,r);case iDe:return new i;case nDe:case sDe:return new i(e);case aDe:return KPe(e);case oDe:return new i;case lDe:return ZPe(e)}}var wDe=xDe;function SDe(e){return typeof e.constructor=="function"&&!lD(e)?NAe(pD(e)):{}}var CDe=SDe,_De="[object Map]";function ADe(e){return pc(e)&&kg(e)==_De}var MDe=ADe,uL=Bp&&Bp.isMap,EDe=uL?uD(uL):MDe,TDe=EDe,PDe="[object Set]";function DDe(e){return pc(e)&&kg(e)==PDe}var ODe=DDe,dL=Bp&&Bp.isSet,RDe=dL?uD(dL):ODe,IDe=RDe,zDe=1,kDe=2,LDe=4,pH="[object Arguments]",BDe="[object Array]",FDe="[object Boolean]",NDe="[object Date]",UDe="[object Error]",mH="[object Function]",jDe="[object GeneratorFunction]",VDe="[object Map]",HDe="[object Number]",vH="[object Object]",WDe="[object RegExp]",GDe="[object Set]",$De="[object String]",qDe="[object Symbol]",YDe="[object WeakMap]",XDe="[object ArrayBuffer]",KDe="[object DataView]",QDe="[object Float32Array]",ZDe="[object Float64Array]",JDe="[object Int8Array]",e3e="[object Int16Array]",t3e="[object Int32Array]",r3e="[object Uint8Array]",i3e="[object Uint8ClampedArray]",n3e="[object Uint16Array]",a3e="[object Uint32Array]",fi={};fi[pH]=fi[BDe]=fi[XDe]=fi[KDe]=fi[FDe]=fi[NDe]=fi[QDe]=fi[ZDe]=fi[JDe]=fi[e3e]=fi[t3e]=fi[VDe]=fi[HDe]=fi[vH]=fi[WDe]=fi[GDe]=fi[$De]=fi[qDe]=fi[r3e]=fi[i3e]=fi[n3e]=fi[a3e]=!0;fi[UDe]=fi[mH]=fi[YDe]=!1;function Vb(e,t,r,i,n,a){var o,s=t&zDe,l=t&kDe,c=t&LDe;if(r&&(o=n?r(e,i,n,a):r(e)),o!==void 0)return o;if(!Ss(e))return e;var u=pl(e);if(u){if(o=HPe(e),!s)return HAe(e,o)}else{var d=kg(e),h=d==mH||d==jDe;if(Zx(e))return mPe(e,s);if(d==vH||d==pH||h&&!n){if(o=l||h?{}:CDe(e),!s)return l?EPe(e,hPe(o,e)):CPe(e,uPe(o,e))}else{if(!fi[d])return n?e:{};o=wDe(e,d,s)}}a||(a=new jb);var f=a.get(e);if(f)return f;a.set(e,o),IDe(e)?e.forEach(function(m){o.add(Vb(m,t,r,m,e,a))}):TDe(e)&&e.forEach(function(m,g){o.set(g,Vb(m,t,r,g,e,a))});var p=c?l?fH:EM:l?zd:dD,v=u?void 0:p(e);return iMe(v||e,function(m,g){v&&(g=m,m=e[g]),oD(o,g,Vb(m,t,r,g,e,a))}),o}var gH=Vb,o3e=1,s3e=4;function l3e(e){return gH(e,o3e|s3e)}var Fw=l3e,c3e="__lodash_hash_undefined__";function u3e(e){return this.__data__.set(e,c3e),this}var d3e=u3e;function h3e(e){return this.__data__.has(e)}var f3e=h3e;function e1(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new Lw;++t<r;)this.add(e[t])}e1.prototype.add=e1.prototype.push=d3e;e1.prototype.has=f3e;var p3e=e1;function m3e(e,t){for(var r=-1,i=e==null?0:e.length;++r<i;)if(t(e[r],r,e))return!0;return!1}var v3e=m3e;function g3e(e,t){return e.has(t)}var y3e=g3e,b3e=1,x3e=2;function w3e(e,t,r,i,n,a){var o=r&b3e,s=e.length,l=t.length;if(s!=l&&!(o&&l>s))return!1;var c=a.get(e),u=a.get(t);if(c&&u)return c==t&&u==e;var d=-1,h=!0,f=r&x3e?new p3e:void 0;for(a.set(e,t),a.set(t,e);++d<s;){var p=e[d],v=t[d];if(i)var m=o?i(v,p,d,t,e,a):i(p,v,d,e,t,a);if(m!==void 0){if(m)continue;h=!1;break}if(f){if(!v3e(t,function(g,y){if(!y3e(f,y)&&(p===g||n(p,g,r,i,a)))return f.push(y)})){h=!1;break}}else if(!(p===v||n(p,v,r,i,a))){h=!1;break}}return a.delete(e),a.delete(t),h}var yH=w3e;function S3e(e){var t=-1,r=Array(e.size);return e.forEach(function(i,n){r[++t]=[n,i]}),r}var C3e=S3e;function _3e(e){var t=-1,r=Array(e.size);return e.forEach(function(i){r[++t]=i}),r}var A3e=_3e,M3e=1,E3e=2,T3e="[object Boolean]",P3e="[object Date]",D3e="[object Error]",O3e="[object Map]",R3e="[object Number]",I3e="[object RegExp]",z3e="[object Set]",k3e="[object String]",L3e="[object Symbol]",B3e="[object ArrayBuffer]",F3e="[object DataView]",hL=Go?Go.prototype:void 0,qC=hL?hL.valueOf:void 0;function N3e(e,t,r,i,n,a,o){switch(r){case F3e:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case B3e:return!(e.byteLength!=t.byteLength||!a(new Jx(e),new Jx(t)));case T3e:case P3e:case R3e:return aD(+e,+t);case D3e:return e.name==t.name&&e.message==t.message;case I3e:case k3e:return e==t+"";case O3e:var s=C3e;case z3e:var l=i&M3e;if(s||(s=A3e),e.size!=t.size&&!l)return!1;var c=o.get(e);if(c)return c==t;i|=E3e,o.set(e,t);var u=yH(s(e),s(t),i,n,a,o);return o.delete(e),u;case L3e:if(qC)return qC.call(e)==qC.call(t)}return!1}var U3e=N3e,j3e=1,V3e=Object.prototype,H3e=V3e.hasOwnProperty;function W3e(e,t,r,i,n,a){var o=r&j3e,s=EM(e),l=s.length,c=EM(t),u=c.length;if(l!=u&&!o)return!1;for(var d=l;d--;){var h=s[d];if(!(o?h in t:H3e.call(t,h)))return!1}var f=a.get(e),p=a.get(t);if(f&&p)return f==t&&p==e;var v=!0;a.set(e,t),a.set(t,e);for(var m=o;++d<l;){h=s[d];var g=e[h],y=t[h];if(i)var b=o?i(y,g,h,t,e,a):i(g,y,h,e,t,a);if(!(b===void 0?g===y||n(g,y,r,i,a):b)){v=!1;break}m||(m=h=="constructor")}if(v&&!m){var x=e.constructor,S=t.constructor;x!=S&&"constructor"in e&&"constructor"in t&&!(typeof x=="function"&&x instanceof x&&typeof S=="function"&&S instanceof S)&&(v=!1)}return a.delete(e),a.delete(t),v}var G3e=W3e,$3e=1,fL="[object Arguments]",pL="[object Array]",Ly="[object Object]",q3e=Object.prototype,mL=q3e.hasOwnProperty;function Y3e(e,t,r,i,n,a){var o=pl(e),s=pl(t),l=o?pL:kg(e),c=s?pL:kg(t);l=l==fL?Ly:l,c=c==fL?Ly:c;var u=l==Ly,d=c==Ly,h=l==c;if(h&&Zx(e)){if(!Zx(t))return!1;o=!0,u=!1}if(h&&!u)return a||(a=new jb),o||rH(e)?yH(e,t,r,i,n,a):U3e(e,t,l,r,i,n,a);if(!(r&$3e)){var f=u&&mL.call(e,"__wrapped__"),p=d&&mL.call(t,"__wrapped__");if(f||p){var v=f?e.value():e,m=p?t.value():t;return a||(a=new jb),n(v,m,r,i,a)}}return h?(a||(a=new jb),G3e(e,t,r,i,n,a)):!1}var X3e=Y3e;function bH(e,t,r,i,n){return e===t?!0:e==null||t==null||!pc(e)&&!pc(t)?e!==e&&t!==t:X3e(e,t,r,i,bH,n)}var K3e=bH;function Q3e(e,t){return e!=null&&t in Object(e)}var Z3e=Q3e;function J3e(e,t,r){t=pm(t,e);for(var i=-1,n=t.length,a=!1;++i<n;){var o=Bw(t[i]);if(!(a=e!=null&&r(e,o)))break;e=e[o]}return a||++i!=n?a:(n=e==null?0:e.length,!!n&&sD(n)&&nD(o,n)&&(pl(e)||cD(e)))}var eOe=J3e;function tOe(e,t){return e!=null&&eOe(e,t,Z3e)}var rOe=tOe,iOe=function(){return Ms.Date.now()},YC=iOe,nOe="Expected a function",aOe=Math.max,oOe=Math.min;function sOe(e,t,r){var i,n,a,o,s,l,c=0,u=!1,d=!1,h=!0;if(typeof e!="function")throw new TypeError(nOe);t=Hk(t)||0,Ss(r)&&(u=!!r.leading,d="maxWait"in r,a=d?aOe(Hk(r.maxWait)||0,t):a,h="trailing"in r?!!r.trailing:h);function f(w){var _=i,C=n;return i=n=void 0,c=w,o=e.apply(C,_),o}function p(w){return c=w,s=setTimeout(g,t),u?f(w):o}function v(w){var _=w-l,C=w-c,A=t-_;return d?oOe(A,a-C):A}function m(w){var _=w-l,C=w-c;return l===void 0||_>=t||_<0||d&&C>=a}function g(){var w=YC();if(m(w))return y(w);s=setTimeout(g,v(w))}function y(w){return s=void 0,h&&i?f(w):(i=n=void 0,o)}function b(){s!==void 0&&clearTimeout(s),c=0,i=l=n=s=void 0}function x(){return s===void 0?o:y(YC())}function S(){var w=YC(),_=m(w);if(i=arguments,n=this,l=w,_){if(s===void 0)return p(l);if(d)return clearTimeout(s),s=setTimeout(g,t),f(l)}return s===void 0&&(s=setTimeout(g,t)),o}return S.cancel=b,S.flush=x,S}var gD=sOe;function lOe(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var cOe=lOe;function uOe(e,t){return e>t}var dOe=uOe;function hOe(e,t){return t.length<2?e:aH(e,QTe(t,0,-1))}var fOe=hOe;function pOe(e,t){return K3e(e,t)}var yD=pOe;function mOe(e,t,r){for(var i=-1,n=e.length;++i<n;){var a=e[i],o=t(a);if(o!=null&&(s===void 0?o===o&&!x0(o):r(o,s)))var s=o,l=a}return l}var vOe=mOe;function gOe(e){return e&&e.length?vOe(e,X8,dOe):void 0}var yOe=gOe;function bOe(e,t){return t=pm(t,e),e=fOe(e,t),e==null||delete e[Bw(cOe(t))]}var xOe=bOe;function wOe(e){return XTe(e)?void 0:e}var SOe=wOe,COe=1,_Oe=2,AOe=4,MOe=sH(function(e,t){var r={};if(e==null)return r;var i=!1;t=q8(t,function(a){return a=pm(a,e),i||(i=a.length>1),a}),w0(e,fH(e),r),i&&(r=gH(r,COe|_Oe|AOe,SOe));for(var n=t.length;n--;)xOe(r,t[n]);return r}),OM=MOe;function EOe(e,t,r,i){if(!Ss(e))return e;t=pm(t,e);for(var n=-1,a=t.length,o=a-1,s=e;s!=null&&++n<a;){var l=Bw(t[n]),c=r;if(l==="__proto__"||l==="constructor"||l==="prototype")return e;if(n!=o){var u=s[l];c=i?i(u,l,s):void 0,c===void 0&&(c=Ss(u)?u:nD(t[n+1])?[]:{})}oD(s,l,c),s=s[l]}return e}var TOe=EOe;function POe(e,t,r){for(var i=-1,n=t.length,a={};++i<n;){var o=t[i],s=aH(e,o);r(s,o)&&TOe(a,pm(o,e),s)}return a}var DOe=POe;function OOe(e,t){return DOe(e,t,function(r,i){return rOe(e,i)})}var ROe=OOe,IOe=sH(function(e,t){return e==null?{}:ROe(e,t)}),ac=IOe,zOe="Expected a function";function kOe(e,t,r){var i=!0,n=!0;if(typeof e!="function")throw new TypeError(zOe);return Ss(r)&&(i="leading"in r?!!r.leading:i,n="trailing"in r?!!r.trailing:n),gD(e,t,{leading:i,maxWait:t,trailing:n})}var LOe=kOe;function xH(e){for(let t of Object.keys(e))e[t]===void 0&&delete e[t];return e}function $o(e,t){return Object.setPrototypeOf(e,t),e}var BOe=()=>typeof window>"u"?!1:window.navigator.userAgent.toLowerCase().includes(" electron/"),FOe=()=>typeof window>"u"?!1:window.navigator.platform.toUpperCase().includes("MAC"),NOe=()=>typeof window>"u"?!1:/iPad|iPhone|iPod/.test(window.navigator.userAgent)||Nw&&"ontouchend"in document,UOe=()=>typeof window>"u"?!1:window.navigator.userAgent.toLowerCase().indexOf("firefox")>-1,jOe=()=>typeof window>"u"?!1:"ontouchstart"in window||navigator.maxTouchPoints>0,VOe=()=>{if(typeof window>"u")return!1;let e=navigator.userAgent,t=navigator.vendor;return/Safari/i.test(e)&&/Apple Computer/.test(t)},HOe=()=>{if(typeof window>"u")return null;let e=navigator.userAgent.match(/Version\/(\d+\.\d)/);return e&&e[1]},WOe=()=>{if(typeof window>"u")return;let e=new URLSearchParams(window.location.search).get("desktop-app-version");return e?(window.localStorage.setItem("desktop-app-version",e),e):window.localStorage.getItem("desktop-app-version")??"0.0.6"},wH=BOe();wH&&WOe();var Nw=FOe(),S0=NOe(),GOe=UOe(),vo=jOe(),vL=VOe(),$Oe=Number(HOe());function SH(e){return Array.isArray(e)?e:[e]}function CH(e,t){let r=0;for(;r<e.length&&r<t.length;){if(e[r]<t[r])return-1;if(e[r]>t[r])return 1;r+=1}return r!==t.length?-1:r!==e.length?1:0}function By(e){return Nw?e.metaKey:e.ctrlKey}function qOe(e){return e.wheelDeltaY===0||e.deltaY===0?Nw&&e.shiftKey&&Math.abs(e.wheelDeltaX)>=120?!1:e.wheelDeltaX?e.wheelDeltaX===-3*e.deltaX||e.wheelDeltaX===-3*window.devicePixelRatio*e.deltaX:e.deltaMode===0:e.wheelDeltaY?e.wheelDeltaY===-3*e.deltaY||e.wheelDeltaY===-3*window.devicePixelRatio*e.deltaY:e.deltaMode===0}var Wt=[],t1={},xv={},Hb={};function _H(e){Wt.includes(e)||Wt.push(e)}function sp(e){delete t1[e.pointerId];for(let t=0;t<Wt.length;t++)if(Wt[t].pointerId===e.pointerId){Wt.splice(t,1);break}}function YOe(){Wt.splice(0,Wt.length)}function r1(e){if(e.pointerType!=="touch")return;let t=t1[e.pointerId];t===void 0&&(t={x:0,y:0},t1[e.pointerId]=t),t.x=e.pageX,t.y=e.pageY}function XC(e){let t=e.pointerId===Wt[0].pointerId?Wt[1]:Wt[0];return t1[t.pointerId]}function AH(e){xv[e.key]=!0,Hb[e.key]=Hb[e.key]===void 0?1:Hb[e.key]+1}function MH(e){if(Nw&&xv.Meta)for(let t in xv)xv[t]=!1;else xv[e.key]=!1;Hb={}}function XOe(e){e.addEventListener("pointerdown",_H,!0),e.addEventListener("pointerdown",r1,!0),e.addEventListener("pointermove",r1,!0),e.addEventListener("pointerup",sp,!0),e.addEventListener("pointercancel",sp,!0),e.addEventListener("pointerleave",sp,!0),window.addEventListener("keydown",AH,!0),window.addEventListener("keyup",MH,!0)}function KOe(e){e.removeEventListener("pointerdown",_H,!0),e.removeEventListener("pointerdown",r1,!0),e.removeEventListener("pointermove",r1,!0),e.removeEventListener("pointerup",sp,!0),e.removeEventListener("pointercancel",sp,!0),e.removeEventListener("pointerleave",sp,!0),window.removeEventListener("keydown",AH,!0),window.removeEventListener("keyup",MH,!0)}var EH,QOe=new Promise(e=>{EH=e}),Fy;function ZOe(){if(Fy)return Fy;async function e(){let t="https://unpkg.com/@splinetool/navmesh-wasm@1.9.21/build",r=Cc(()=>import("./navmesh-BFd9Mv4x.js"),[]),[i,n]=await Promise.all([r,fetch(`${t}/navmesh.wasm`).then(s=>s.arrayBuffer())]),a=i.default,o=await a({wasmBinary:n});EH(o)}return Fy=e(),Fy}var TH,JOe=new Promise(e=>{TH=e}),Ny;function eRe(){if(Ny)return Ny;async function e(){let t=await Cc(()=>import("./physics-BM4kW-A5.js"),[]);await t.init(),TH(t)}return Ny=e(),Ny}var Lt=class{modifyById(e,t){let r=this;if(r[e]===void 0)throw new Error("not expected");{let i={...r,[e]:t};return Object.setPrototypeOf(i,Lt.prototype),i}}add(e,t){var r;return((r=this.runOp({type:1,id:e,data:t}))==null?void 0:r.data)??this}runOp(e){let t=this;if(e.type===1){let r=t[e.id],i;r===void 0?i={type:2,id:e.id}:i={type:1,id:e.id,data:r};let{id:n,data:a}=e,o={...t,[n]:a};return Object.setPrototypeOf(o,Lt.prototype),{data:o,actual:e,reverse:i}}else if(e.type===2){let{id:r}=e,i=t[r];if(i===void 0)return null;{let n={...t};return Object.setPrototypeOf(n,Lt.prototype),delete n[r],{data:n,actual:e,reverse:{type:1,id:r,data:i}}}}return null}};function bD(e){if(e.deepFreeze!==void 0){e.deepFreeze(e);return}let t=Object.getOwnPropertyNames(e);for(let r of t){let i=e[r];i&&typeof i=="object"&&bD(i)}return Object.freeze(e)}function tRe(e,t){let r=0;for(;r<e.length&&r<t.length;){if(e[r]<t[r])return-1;if(e[r]>t[r])return 1;r+=1}return r!==t.length?-1:r!==e.length?1:0}var PH=class extends Error{};function KC(e){let t={...e};return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),t}function du(e,t,r){if(e===void 0?t===void 0?(e=0,t=10):e=t-10:t===void 0&&(t=e+10),e>t){let a=e;e=t,t=a}let i=[],n=1/(r+1);for(let a=0;a<r;a++){let o=e+(t-e)*(a+.75+Math.random()*.5)*n;i.push(o)}return i}function xD(e){return e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Float32Array||e instanceof Float64Array}function rRe(){return typeof process<"u"}function DH(e,t){for(let r of e)t(r.id,r.data)!==!0&&DH(r.children,t)}function OH(e,t){if(t(e.id,e.data)!==!0)for(let r of e.children)OH(r,t)}var ra=class extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,ra.prototype)}deepFreeze(){let e=0;for(;e<this.length;)bD(this[e]),e++}fillCaches0(e,t){this.objCaches.set(e.id,e),this.parentCaches.set(e.id,t);for(let r of e.children)this.fillCaches0(r,e.id)}fillCaches(){if(this.objCaches===void 0){this.objCaches=new Map,this.parentCaches=new Map;for(let e of this)this.fillCaches0(e,null)}}randomId(){this.fillCaches();let e=Array.from(this.objCaches.keys());if(e.length!==0)return e[Math.max(0,Math.floor(Math.random()*e.length)-1)]}nonExistOrDescendantOf(e,t){if(!this.has(e))return!0;for(;e;){let r=this.parent(e);if(r===t)return!0;e=r}return!1}rootAcestor(e){for(;e;){let t=this.parent(e);if(t)e=t;else return e}return e}isDescendantOf(e,t){for(;e;){let r=this.parent(e);if(r===t)return!0;e=r}return!1}data(e){var t;return(t=this.get(e))==null?void 0:t.data}has(e){return this.childrenOf(e)!==void 0}get(e){return this.fillCaches(),this.objCaches.get(e)}childrenOf(e){var t;return e===null?this:(t=this.get(e))==null?void 0:t.children}traverseFrom(e,t){if(e===null)this.traverse(t);else{let r=this.get(e);r&&OH(r,t)}}traverse(e){DH(this,e)}totalSize(){return this.fillCaches(),this.objCaches.size}parent(e){return this.fillCaches(),this.parentCaches.get(e)}childrenArray(e){return e===null?this:this.get(e).children}modifyById(e,t){if(this.get(e)===void 0)throw new Error("not expected");{let r=this.parent(e),i=this.childrenArray(r),n=i.findIndex(o=>o.id===e);if(n<0)throw new Error("not expected");let a=i[n];return i=[...i],i[n]={...a,data:t},this.modifyArrayBy(r,i)}}modifyArrayBy(e,t){let r=e,i=t;for(;r!==null;){let a=i,o=r;if(r=this.parent(r),r===void 0)throw new Error;i=this.childrenArray(r);let s=i.findIndex(l=>l.id===o);if(s<0)throw new Error;i=[...i],i[s]={...i[s],children:a}}Object.setPrototypeOf(i,ra.prototype);let n=i;return n.fillCaches(),n}runOp(e){switch(e.type){case 7:return this.addOp(e);case 8:return this.deleteOp(e);case 9:return this.moveOp(e)}return null}checkDuplicatedIdRec({id:e,children:t}){if(this.get(e)!==void 0)return!0;for(let r of t)if(this.checkDuplicatedIdRec(r))return!0;return!1}addOp(e){let{parent:t,fi:r,id:i,data:n,children:a}=e;if(t!==null&&this.get(t)===void 0||this.checkDuplicatedIdRec(e))return null;{let o=t,s=this.childrenArray(o),l={fi:r,id:i,data:n,children:a};return s=[...s,l],s.sort((c,u)=>c.fi-u.fi),e.localIndex=s.indexOf(l),{data:this.modifyArrayBy(o,s),actual:e,reverse:{type:8,id:i}}}}deleteOp(e){let{id:t}=e;if(this.get(t)===null)return null;{let r=this.parent(t);if(r===void 0)return null;let i=this.childrenArray(r),n=i.findIndex(o=>o.id===t);e.localIndex=n,i=[...i];let a=i.splice(n,1)[0];return{data:this.modifyArrayBy(r,i),actual:e,reverse:{type:7,...a,parent:r}}}}moveOp(e){let{parent:t,fi:r,id:i}=e;if(t!==null&&this.get(t)===void 0)return this.deleteOp({type:8,id:i});if(t!==null){let d=t;for(;d!==null;){if(d===void 0)throw new Error;if(d===i)throw new PH("cyclic tree");d=this.parent(d)}}let n=this.parent(i);if(n===void 0)return null;let a=n,o=this.childrenArray(n),s=o.findIndex(d=>d.id===i);o=[...o];let l=o.splice(s,1)[0],c=this.modifyArrayBy(n,o);n=t,o=c.childrenArray(n);let u=l.fi;return l={...l,fi:r},o=[...o,l],o.sort((d,h)=>d.fi-h.fi),e.localIndex=o.indexOf(l),c=c.modifyArrayBy(n,o),{data:c,actual:e,reverse:{type:9,parent:a,fi:u,id:i}}}previous(e,t){if(t===null){let i=this.childrenArray(e);return i.length===0?null:i[i.length-1].id}let r=null;for(let i of this.childrenArray(e)){if(i.id===t)return r;r=i.id}return null}traverseSortNext(e){let t=this.parent(e);if(t!==void 0){let r=this.childrenArray(t),i=r.findIndex(n=>n.id===e)+1;if(i<r.length)return r[i].id;if(t)return this.traverseSortNext(t)}}sortNext(e){let t=this.childrenArray(e);return t.length>0?t[0].id:this.traverseSortNext(e)}traverseSortPrevious(e){let t=this.childrenArray(e);return t.length>0?this.traverseSortPrevious(t[t.length-1].id):e}sortPrevious(e){let t=this.parent(e);if(t!==void 0){let r=this.childrenArray(t),i=r.findIndex(n=>n.id===e)-1;return i>=0?this.traverseSortPrevious(r[i].id):t}}getAllSorted(e){let t=[];for(let r of e){let i=this.getWithSortKey(r.id);i!==void 0&&t.push({...r,...i})}t.sort((r,i)=>tRe(r.sortKey,i.sortKey));for(let r of t)delete r.sortKey;return t}getWithSortKey(e){var t=e;let r=[],i=this.get(t),n=i;if(i!==void 0){for(;t;)r.splice(0,0,i.fi),t=this.parent(t),t!==null&&(i=this.get(t));return{...n,sortKey:r}}}insertBeforeHelper(e,t,r){return this.insertAfterHelper(e,this.previous(e,t),r)}insertAfterHelper(e,t,r){let i=this.childrenArray(e);if(t===null){if(i.length===0)return du(0,r,r);{let n=i[0].fi;return du(n-r,n,r)}}else{let n=this.get(t);if(n===void 0||this.parent(t)!==e)throw new Error("illegal args");let a=i.find(o=>o.fi>n.fi);if(a===void 0){let o=i[i.length-1].fi;return du(o,o+r,r)}else return du(n.fi,a.fi,r)}}},i1;(e=>{function t(r,i){if(i.type!==0)return null;if(Array.isArray(r)){let n=i.props,a={},o=[...r],s=!1;if(n)for(let l of Object.keys(n)){let c=parseInt(l);if(isNaN(c))throw new Error("wrong index");a[l]=o[c],o[c]=n[l],s=!0}return s?{data:o,actual:i,reverse:{type:0,props:a}}:null}else{let n=i.props,a={},o={...r},s=!1;if(n)for(let l of Object.keys(n)){a[l]=o[l];let c=n[l];c===void 0?delete o[l]:o[l]=c,s=!0}return s?{data:o,actual:i,reverse:{type:0,props:a}}:null}}e.runOp=t})(i1||(i1={}));var Dt=class extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,Dt.prototype)}deepFreeze(){let e=0;for(;e<this.length;)bD(this[e]),e++}fillCaches0(e){this.objCaches.set(e.id,e)}fillCaches(){if(this.objCaches===void 0){this.objCaches=new Map,Object.getOwnPropertyDescriptor(this,"objCaches").enumerable=!1;for(let e of this)this.fillCaches0(e)}}randomId(){this.fillCaches();let e=Array.from(this.objCaches.keys());if(e.length!==0)return e[Math.max(0,Math.floor(Math.random()*e.length)-1)]}data(e){var t;return(t=this.get(e))==null?void 0:t.data}get(e){return this.fillCaches(),this.objCaches.get(e)}modifyById(e,t){if(this.get(e)===void 0)throw new Error("not expected");{let r=this,i=r.findIndex(a=>a.id===e);if(i<0)throw new Error("not expected");let n=r[i];return r=[...r],r[i]={...n,data:t},this.modifyArrayBy(r)}}modifyArrayBy(e){Object.setPrototypeOf(e,Dt.prototype);let t=e;return rRe()||t.fillCaches(),t}runOp(e){switch(e.type){case 4:return this.addOp(e);case 5:return this.deleteOp(e);case 6:return this.moveOp(e)}return null}addOp(e){let{fi:t,id:r,data:i}=e,n=this,a={fi:t,id:r,data:i};return n=[...n,a],n.sort((o,s)=>o.fi-s.fi),e.localIndex=n.indexOf(a),{data:this.modifyArrayBy(n),actual:e,reverse:{type:5,id:r}}}deleteOp(e){let{id:t}=e,r=this,i=r.findIndex(a=>a.id===t);if(i===-1)return null;e.localIndex=i,r=[...r];let n=r.splice(i,1)[0];return{data:this.modifyArrayBy(r),actual:e,reverse:{type:4,...n}}}moveOp(e){let{fi:t,id:r}=e,i=this;i=[...i];let n=i.findIndex(s=>s.id===r);if(n===-1)return null;let a=i[n].fi,o={...i[n],fi:t};return i[n]=o,i.sort((s,l)=>s.fi-l.fi),e.localIndex=i.indexOf(o),{data:this.modifyArrayBy(i),actual:e,reverse:{type:6,fi:a,id:r}}}previous(e){if(e===null)return this.length===0?null:this[this.length-1].id;let t=null;for(let r of this){if(r.id===e)return t;t=r.id}return null}insertBeforeHelper(e,t){return this.insertAfterHelper(this.previous(e),t)}insertAfterHelper(e,t){let r=this;if(e===null){if(r.length===0)return du(0,t,t);{let i=r[0].fi;return du(i-t,i,t)}}else{let i=this.get(e);if(i===void 0)throw new Error("illegal args");let n=r.find(a=>a.fi>i.fi);if(n===void 0){let a=r[r.length-1].fi;return du(a,a+t,t)}else return du(i.fi,n.fi,t)}}};function Fp(e){return e&&typeof e=="object"&&e instanceof dn}var dn=class{unusedFunOverridesTable(e){}runOp(e){let t=[],r=this,i=0,n={};for(;i<e.path.length;){if(t.push(r),r=r===void 0?void 0:r[e.path[i]],r!==void 0&&!Fp(r))return null;i+=1}r=r?KC(r):new dn;for(let[s,l]of Object.entries(e.props)){let c=r[s];n[s]=c,l===void 0?delete r[s]:r[s]=l}for(;i>0;){if(Object.keys(r).length===0){let s=t[i-1];s&&(r=KC(s),delete r[e.path[i-1]])}else{let s=t[i-1];if(s){let l=KC(s);l[e.path[i-1]]=r,r=l}else{let l=new dn;l[e.path[i-1]]=r,r=l}}i-=1}let a=Object.setPrototypeOf(r,dn.prototype),o={...e,props:n};return{data:a,actual:e,reverse:o}}},Mu;(e=>{function t(n,a){return Lg(n,a)??n}e.apply=t;function r(n,a){return SD(n,a)}e.merge=r;function i(n,a){let o=0,s=a.path,l=n;for(;o<s.length&&l!==void 0;){if(l=xn.zoomOnce(l,s[o]),l===void 0)return a;if(!Fp(l))return;o+=1}if(l===void 0)return a;if(Fp(l))if(a.type===0){let c={...a.props};for(let u of Object.keys(l))delete c[u];return{...a,props:c}}else if(a.type===1||a.type===4||a.type===7){let c=wD([a],l);return c?(console.log(c),c):a}else return a}e.filterOp=i})(Mu||(Mu={}));function wD(e,t){if(t===void 0)return;let r=!1,i=e.map(n=>{let a=n.id,o=Lg(n.data,t[a]);if(r=r||o!==void 0,o===void 0&&(o=n.data),n.children){let s=wD(n.children,t);return s!==void 0?r=!0:s=n.children,{...n,id:a,data:o,children:s}}else return{...n,id:a,data:o}});if(r)return i}function iRe(e,t){if(t===void 0)return;let r=!1,i=e.map(n=>{let a=n.id,o=Lg(n.data,t[a]);return r=r||o!==void 0,o===void 0&&(o=n.data),{...n,id:a,data:o}});if(r)return Object.setPrototypeOf(i,Object.getPrototypeOf(e)),i}function Lg(e,t){if(!Fp(t))return t;if(e instanceof ra){let r=wD(e,t);return r!==void 0&&Object.setPrototypeOf(r,Object.getPrototypeOf(e)),r}else{if(e instanceof Dt)return iRe(e,t);if(Array.isArray(e)){let r=!1,i=e.map((n,a)=>{let o=Lg(n,t[a]);return r=r||o!==void 0,o===void 0&&(o=n),o});return r?(Object.setPrototypeOf(i,Object.getPrototypeOf(e)),i):void 0}else{if(e instanceof dn)return SD(e,t);if(e&&typeof e=="object"){let r={},i=!1;for(let[n,a]of Object.entries(e)){let o=Lg(a,t[n]);i=i||o!==void 0,o===void 0&&(o=a),r[n]=o}return i?(Object.setPrototypeOf(r,Object.getPrototypeOf(e)),r):void 0}}}}function SD(e,t){if(e===void 0)return t;if(t===void 0)return e;if(!Fp(t))return t;if(!Fp(e))return Mu.apply(e,t);let r=new Set;for(let n of Object.keys(e))r.add(n);for(let n of Object.keys(t))r.add(n);let i=new dn;for(let n of r){let a=SD(e===void 0?void 0:e[n],t===void 0?void 0:t[n]);i[n]=a}return i}function nRe(e,t){let r={cur:[],result:[],len:0};return e=Bg(e,t,r)??e,[e,r.result]}function n1(e,t){return e===null?null:(e.cur[e.len]=t,e.len+=1,e)}function a1(e){e&&(e.len-=1)}function aRe(e){if(e===null)return null;e.result.push(e.cur.slice(0,e.len))}function RH(e,t,r){let i=!1,n=e.map(a=>{let o=a.id,s=t[o];if(s!==void 0&&typeof s=="string"&&(i=!0,o=s,r!==null))throw new Error("not supported");let l=Bg(a.data,t,n1(r,o));a1(r),i=i||l!==void 0,l===void 0&&(l=a.data);let c=RH(a.children,t,r);return c!==void 0?i=!0:c=a.children,{...a,id:o,data:l,children:c}});if(i)return n}function oRe(e,t,r){let i=!1,n=e.map(a=>{let o=a.id,s=t[o];if(s!==void 0&&typeof s=="string"&&(i=!0,o=s,r!==null))throw new Error("not supported");let l=Bg(a.data,t,n1(r,o));return a1(r),i=i||l!==void 0,l===void 0&&(l=a.data),{...a,id:o,data:l}});if(i)return Object.setPrototypeOf(n,Object.getPrototypeOf(e)),n}function Bg(e,t,r){if(e instanceof ra){let i=RH(e,t,r);return i!==void 0&&Object.setPrototypeOf(i,Object.getPrototypeOf(e)),i}else{if(e instanceof Dt)return oRe(e,t,r);if(Array.isArray(e)){let i=!1,n=e.map((a,o)=>{let s=Bg(a,t,n1(r,o));return a1(r),i=i||s!==void 0,s===void 0&&(s=a),s});return i?(Object.setPrototypeOf(n,Object.getPrototypeOf(e)),n):void 0}else if(e&&typeof e=="object"&&!xD(e)){let i={},n=!1;for(let[a,o]of Object.entries(e))if(a!=="name"&&a!=="variableId"){let s=t[a];if(typeof s=="string"){if(r!==null)throw new Error("not supported");n=!0,a=s}let l=Bg(o,t,n1(r,a));a1(r),n=n||l!==void 0,l===void 0&&(l=o),i[a]=l}else i[a]=o;return n?(Object.setPrototypeOf(i,Object.getPrototypeOf(e)),i):void 0}else if(typeof e=="string"){let i=t[e];return i!==void 0&&aRe(r),i}else return}}var o1;(e=>{function t(r,i){let n=xn.zoom(i,r.path);if(typeof n=="object"){let a={};for(let o of Object.keys(r.props))a[o]=n[o];return{...r,props:a}}else return{...r,props:{}}}e.replaceProps=t})(o1||(o1={}));var Bn;(e=>{function t(l,c){return{...l,path:l.path.slice(c)}}e.drop=t;function r(l,c){var u;return((u=i(l,c))==null?void 0:u.data)??l}e.applySimple=r;function i(l,c){var h,f;let u=c.path;for(var d=[];;){let p;if(l instanceof dn&&c.type===0&&(p=l.runOp({...c,path:u.slice(d.length)}),p===null&&(p=void 0)),p===void 0&&d.length===u.length&&(l instanceof ra||l instanceof Dt||l instanceof Lt?p=l.runOp(c):p=i1.runOp(l,c)),p!==void 0)if(p!==null){let g=p.data;for(let y=d.length-1;y>=0;y--){let b=u[y],x=d[y];if(x instanceof ra){if(typeof b=="number")throw new Error("illegal arg");g=x.modifyById(b,g)}else if(x instanceof Dt){if(typeof b=="number")throw new Error("illegal arg");g=x.modifyById(b,g)}else if(x instanceof Lt){if(typeof b=="number")throw new Error("illegal arg");g=x.modifyById(b,g)}else if(x instanceof dn){let S={...x,[b]:g};g=Object.setPrototypeOf(S,dn.prototype)}else if(typeof x=="object")if(Array.isArray(x)){if(typeof b=="string"&&(b=parseInt(b),isNaN(b)))throw new Error("Invalid path");let S=g;g=[...x],g[b]=S}else g={...x,[b]:g};else return null}return{data:g,actual:{...p.actual,path:u},reverse:{...p.reverse,path:u}}}else return null;let v=u[d.length],m;if(l instanceof ra){if(typeof v=="number")throw new Error("");m=(h=l.get(v))==null?void 0:h.data}else if(l instanceof Dt){if(typeof v=="number")throw new Error("");m=(f=l.get(v))==null?void 0:f.data}else l!==null&&(m=l[v]);if(m!==void 0)d.push(l),l=m;else return null}}e.apply=i;function n(l,c){for(let u=0;u<l.length&&u<c.length;u++)if(l[u]!==c[u])return!0;return!1}e.pathDisjoint=n;function a(l,c){if(l.length!==c.length)return!1;for(let u=0;u<l.length;u++)if(l[u]!==c[u])return!1;return!0}e.pathEq=a;function o(l,c){return n(l.path,c.path)}e.commutative=o;function s(l,c){return l.type===0&&c.type===0&&a(l.path,c.path)?Object.keys(l.props).every(u=>c.props[u]!==void 0):!1}e.subsumed=s})(Bn||(Bn={}));var RM;(e=>{function t(){return[]}e.empty=t;function r(c,u){let d=[];for(let h of c){let[f,...p]=h.path;f===u&&d.push({...h,path:p})}return d}e.removePrefix=r;function i(c,u){return c.map(d=>({...d,path:[u,...d.path]}))}e.addPrefix=i;function n(c,u){return[...c,...u]}e.concat=n;function a(c,u){return[...c.filter(d=>!u.some(h=>Bn.subsumed(d,h))),...u]}e.compress=a;function o(c,u){return c.every(d=>u.every(h=>Bn.commutative(d,h)))}e.commutative=o;function s(c,u){for(let d of u){let h=l(c,d);h!==null&&(c=h.data)}return c}e.applyAll=s;function l(c,u){var d=c;let h=[],f=[];for(let p of u)try{if(p.type===3||p.type===5&&p.path[p.path.length-1]==="variables"){let v,m,g;if(p.type===3?(v=xn.zoom(d,[...p.path,p.id]),g=Bn.apply(d,{...p,type:2})):(v=xn.zoom(d,[...p.path,p.id,"value"]),g=Bn.apply(d,p)),g!==null){d=g.data;let[y,b]=nRe(d,{[p.id]:v});d=y;for(let x=0;x<b.length;x++){let S=b[x],w=S.pop();if(typeof w=="number"){let _=[w];for(let A=x+1;A<b.length;A++){let M=b[A],P=M[M.length-1];if(typeof P=="number"&&xn.equal(S,M.slice(0,M.length-1)))_.push(P),b.splice(A,1);else break}let C=xn.zoom(d,S);m=C.map((A,M)=>_.includes(M)?p.id:A),v=C,w=S.pop()}else{if(w==="alphaOverride"||w==="alpha"){v/=100;let _=v,C=xn.zoom(d,S.slice(0,S.length-2)),A=C.layers.map(M=>M.id===S[S.length-1]?{...M,data:{...M.data,[w]:_}}:M);Object.setPrototypeOf(A,Object.getPrototypeOf(C.layers)),C.layers=A}m=p.id}h.push({type:0,path:S,props:{[w]:v}}),f.push({type:0,path:S,props:{[w]:m}})}f.push(g.reverse),h.push(g.actual)}}else{let v=Bn.apply(d,p);v!==null&&(h.push(v.actual),d=v.data,f.push(v.reverse))}}catch(v){if(v instanceof PH)return null;throw v}return{data:d,actual:h,reverse:f.reverse()}}e.apply=l})(RM||(RM={}));var IH=Symbol(),sRe=Symbol(),Uw=Symbol(),C0=class{reportOp(e,t,r=[]){let i=this;if(t===null)return;i._current=t.data;let n=r;for(;!(i instanceof kH);){let a=i._path,o=i._current;if(a!==""&&n.splice(0,0,a),i=i._parent,i===null)return;i.update(a,o)}i.push(n,e,t.actual,t.reverse)}deleteChildren(e){if(this._children){let t=this._children[e];if(t){let r=t[Uw];r&&r(),delete this._children[e]}}}},lRe=class extends C0{constructor(e,t,r){super(),this._parent=e,this._path=t,this._current=r}update(e,t){if(Array.isArray(this._current)){if(typeof e=="string"&&(e=parseInt(e),isNaN(e)))throw new Error("Invalid path");this._current=[...this._current],this._current[e]=t}else this._current={...this._current,[e]:t}}runOp(e){this.reportOp(e,i1.runOp(this._current,e),e.path)}},cRe=class extends C0{constructor(e,t,r){super(),this._parent=e,this._path=t,this._current=r}update(e,t){this._current={...this._current,[e]:t},Object.setPrototypeOf(this._current,Lt.prototype)}runOp(e){this.reportOp(e,this._current.runOp(e))}},zH={get(e,t){if(t===Uw)return()=>{e._parent=null};if(t===IH)return e._current;if(t===sRe)return e;let{_current:r,_children:i}=e;if(t==="push"&&Array.isArray(r))throw new Error("not supported to expand array");let n=i===void 0?void 0:i[t];if(n!==void 0)return n;let a=r[t],o=jw(e,t,a);return o!==a?(i===void 0&&(i={},e._children=i),i[t]=o,o):a},has(e,t){return t in e._current},ownKeys(e){return Reflect.ownKeys(e._current)},defineProperty(){throw Error("not supported")},getPrototypeOf(e){return Object.getPrototypeOf(e._current)},setPrototypeOf(){throw Error("not supported")},getOwnPropertyDescriptor(e,t){let r=e._current,i=Reflect.getOwnPropertyDescriptor(r,t);return i&&{writable:!0,configurable:!0,enumerable:i.enumerable,value:r[t]}}},uRe={...zH,set(e,t,r){let i={type:0,props:{[t]:Yi(r)??r}};return e.deleteChildren(t),e.runOp(i),!0},deleteProperty(e,t){let r={type:0,props:{[t]:void 0}};return e.deleteChildren(t),e.runOp(r),!0}},dRe={...zH,set(e,t,r){return r===void 0?this.deleteProperty(e,t):(e.deleteChildren(t),e.runOp({type:1,id:t,data:r})),!0},deleteProperty(e,t){return e.runOp({type:2,id:t}),!0}},CD=class extends C0{constructor(e,t,r){super(),this._children={},this._parent=e,this._path=t,this._current=r,this[Uw]=()=>{this._parent=null}}unproxy(){return this._current}update(e,t){this._current=this._current.modifyById(e,t)}runOp(e){this.reportOp(e,this._current.runOp(e))}randomId(){return this._current.randomId()}isDescendantOf(e,t){return this._current.isDescendantOf(e,t)}childrenOf(e){return this._current.childrenOf(e)}traverse(e){return this._current.traverse(e)}get(e){return this._current.get(e)}parent(e){return this._current.parent(e)}traverse(e){this._current.traverse((t,r)=>{e(t,this.data(t))})}data(e){var o;let{_current:t,_children:r}=this,i=r===void 0?void 0:r[e];if(i!==void 0)return i;let n=(o=t.get(e))==null?void 0:o.data,a=jw(this,e,n);return a!==n?(r===void 0&&(r={},this._children=r),r[e]=a,a):n}add(e,t,r,i,n){this.runOp({type:7,parent:e,fi:t,id:r,data:i,children:n})}move(e,t,r){this.runOp({type:9,parent:e,fi:t,id:r})}insertAfter(e,t,r){let i=this._current.insertAfterHelper(e,t,r.length);for(let n=0;n<r.length;n++){let a=r[n];this.add(e,i[n],a.id,a.data,a.children)}}insertBefore(e,t,r){let i=this._current.insertBeforeHelper(e,t,r.length);for(let n=0;n<r.length;n++){let a=r[n];this.add(e,i[n],a.id,a.data,a.children)}}moveAfter(e,t,r){let i=this._current.insertAfterHelper(e,t,r.length);for(let n=0;n<r.length;n++){let a=r[n];this.move(e,i[n],a)}}moveBefore(e,t,r){let i=this._current.insertBeforeHelper(e,t,r.length);for(let n=0;n<r.length;n++){let a=r[n];this.move(e,i[n],a)}}delete(e){this.deleteChildren(e),this.runOp({type:8,id:e})}sortNext(e){return this._current.sortNext(e)}sortPrevious(e){return this._current.sortPrevious(e)}getAllSorted(e){return this._current.getAllSorted(e)}},_D=class extends C0{constructor(e,t,r){super(),this._children={},this._parent=e,this._path=t,this._current=r,this[Uw]=()=>{this._parent=null}}unproxy(){return this._current}get length(){return this._current.length}forEach(e){let t=this.length;for(let r=0;r<t;r++){let i=this._current[r].id,n=this._current[r].fi;e(this.data(this._current[r].id),i,n)}}find(e){let t=this.length;for(let r=0;r<t;r++){let i=this._current[r].id;if(e(this.data(i),i))return this.get(i)}}update(e,t){this._current=this._current.modifyById(e,t)}randomId(){return this._current.randomId()}get(e){return{...this._current.get(e),data:this.data(e)}}data(e){var o;let{_current:t,_children:r}=this,i=r===void 0?void 0:r[e];if(i!==void 0)return i;let n=(o=t.get(e))==null?void 0:o.data,a=jw(this,e,n);return a!==n?(r===void 0&&(r={},this._children=r),r[e]=a,a):n}runOp(e){this.reportOp(e,this._current.runOp(e))}add(e,t,r){this.runOp({type:4,fi:e,id:t,data:r})}move(e,t){this.runOp({type:6,fi:e,id:t})}insertAfter(e,t){let r=this._current.insertAfterHelper(e,t.length);for(let i=0;i<t.length;i++){let n=t[i];this.add(r[i],n.id,n.data)}}insertBefore(e,t){let r=this._current.insertBeforeHelper(e,t.length);for(let i=0;i<t.length;i++){let n=t[i];this.add(r[i],n.id,n.data)}}moveAfter(e,t){let r=this._current.insertAfterHelper(e,t.length);for(let i=0;i<t.length;i++){let n=t[i];this.move(r[i],n)}}moveBefore(e,t){let r=this._current.insertBeforeHelper(e,t.length);for(let i=0;i<t.length;i++){let n=t[i];this.move(r[i],n)}}delete(e){this.deleteChildren(e),this.runOp({type:5,id:e})}};function QC(e,t,r){if(e.length>0){let i=e[e.length-1];if(i.type===0&&t.type===0&&xn.equal(i.path,r)){Object.assign(i.props,t.props);return}}e.push({...t,path:r})}var kH=class extends C0{constructor(e){super(),this.ts=[],this.actual=[],this.reverse=[],this._current=e}update(e,t){if(e!=="")throw new Error("");this._current=t}push(e,t,r,i){QC(this.ts,t,e),QC(this.actual,r,e),QC(this.reverse,i,e)}result(){return{data:this._current,ts:this.ts,actual:this.actual,reverse:this.reverse.reverse()}}};function jw(e,t,r){return r instanceof ra?new CD(e,t,r):r instanceof Dt?new _D(e,t,r):r instanceof Lt?new Proxy(new cRe(e,t,r),dRe):r!==null&&typeof r=="object"?xD(r)?r:new Proxy(new lRe(e,t,r),uRe):r}function LH(e){let t=new kH(e);return[jw(t,"",e),t]}function Fg(e,t){let[r,i]=LH(e);return t(r),i.result()}function Yi(e){return e instanceof CD||e instanceof _D?e._current:e!==null&&typeof e=="object"?e[IH]:e}var xn;(e=>{function t(a,o){if(o.length===a.length)for(var s=0;s<a.length;){if(a[s]!==o[s])return!1;s+=1}else return!1;return!0}e.equal=t;function r(a,o,s){let l=n(s,a);if(l!==void 0&&typeof l=="object"&&l!==null){let c={...o};return Object.keys(l).forEach(u=>{delete c[u]}),c}else return o}e.removeOverridden=r;function i(a,o){if((a instanceof ra||a instanceof CD)&&typeof o=="string"||(a instanceof Dt||a instanceof _D)&&typeof o=="string")return a.data(o);if(typeof o=="number"&&Array.isArray(a)||typeof o=="string"&&typeof a=="object"&&a!==null)return a[o]}e.zoomOnce=i;function n(a,o,s=0){for(;s<o.length&&a!==void 0;)a=i(a,o[s]),s+=1;return a}e.zoom=n})(xn||(xn={}));function hRe(e,t){let r=[];if(t.length===e.length)for(var i=0;i<e.length;){if(t[i]==="*")r.push(e[i]);else if(e[i]!==t[i])return null;i+=1}else return null;return r}function li(e,t){let r=[];if(t.length<=e.length)for(var i=0;i<t.length;){if(t[i]==="*")r.push(e[i]);else if(e[i]!==t[i])return null;i+=1}else return null;return r}var BH=class{},gL=class extends BH{constructor(e){super(),this.id=e}},yL=class extends BH{constructor(e){super(),this.data=e}},IM;try{IM=new TextDecoder}catch{}var At,Eu,Ue=0,Ka={},Ur,hu,Do=0,Zs=0,po,oc,Ba=[],qr,bL={useRecords:!1,mapsAsObjects:!0},FH=class{},NH=new FH;NH.name="MessagePack 0xC1";var Np=!1,s1=class{constructor(e){e&&(e.useRecords===!1&&e.mapsAsObjects===void 0&&(e.mapsAsObjects=!0),e.structures?e.structures.sharedLength=e.structures.length:e.getStructures&&((e.structures=[]).uninitialized=!0,e.structures.sharedLength=0)),Object.assign(this,e)}unpack(e,t){if(At)return GH(()=>(kM(),this?this.unpack(e,t):s1.prototype.unpack.call(bL,e,t)));Eu=t>-1?t:e.length,Ue=0,Zs=0,hu=null,po=null,At=e;try{qr=e.dataView||(e.dataView=new DataView(e.buffer,e.byteOffset,e.byteLength))}catch(r){throw At=null,e instanceof Uint8Array?r:new Error("Source must be a Uint8Array or Buffer but was a "+(e&&typeof e=="object"?e.constructor.name:typeof e))}if(this instanceof s1){if(Ka=this,this.structures)return Ur=this.structures,Uy();(!Ur||Ur.length>0)&&(Ur=[])}else Ka=bL,(!Ur||Ur.length>0)&&(Ur=[]);return Uy()}unpackMultiple(e,t){let r,i=0;try{Np=!0;let n=e.length,a=this?this.unpack(e,n):Hw.unpack(e,n);if(t){for(t(a);Ue<n;)if(i=Ue,t(Uy())===!1)return}else{for(r=[a];Ue<n;)i=Ue,r.push(Uy());return r}}catch(n){throw n.lastPosition=i,n.values=r,n}finally{Np=!1,kM()}}_mergeStructures(e,t){e=e||[];for(let r=0,i=e.length;r<i;r++){let n=e[r];n&&(n.isShared=!0,r>=32&&(n.highByte=r-32>>5))}e.sharedLength=e.length;for(let r in t||[])if(r>=0){let i=e[r],n=t[r];n&&(i&&((e.restoreStructures||(e.restoreStructures=[]))[r]=i),e[r]=n)}return this.structures=e}decode(e,t){return this.unpack(e,t)}};function Uy(){try{if(!Ka.trusted&&!Np){let t=Ur.sharedLength||0;t<Ur.length&&(Ur.length=t)}let e=Li();if(Ue==Eu)Ur.restoreStructures&&xL(),Ur=null,At=null,oc&&(oc=null);else if(Ue>Eu){let t=new Error("Unexpected end of MessagePack data");throw t.incomplete=!0,t}else if(!Np)throw new Error("Data read, but end of buffer not reached");return e}catch(e){throw Ur.restoreStructures&&xL(),kM(),(e instanceof RangeError||e.message.startsWith("Unexpected end of buffer"))&&(e.incomplete=!0),e}}function xL(){for(let e in Ur.restoreStructures)Ur[e]=Ur.restoreStructures[e];Ur.restoreStructures=null}function Li(){let e=At[Ue++];if(e<160)if(e<128){if(e<64)return e;{let t=Ur[e&63]||Ka.getStructures&&UH()[e&63];return t?(t.read||(t.read=AD(t,e&63)),t.read()):e}}else if(e<144)if(e-=128,Ka.mapsAsObjects){let t={};for(let r=0;r<e;r++)t[VH()]=Li();return t}else{let t=new Map;for(let r=0;r<e;r++)t.set(Li(),Li());return t}else{e-=144;let t=new Array(e);for(let r=0;r<e;r++)t[r]=Li();return t}else if(e<192){let t=e-160;if(Zs>=Ue)return hu.slice(Ue-Do,(Ue+=t)-Do);if(Zs==0&&Eu<140){let r=t<16?MD(t):jH(t);if(r!=null)return r}return zM(t)}else{let t;switch(e){case 192:return null;case 193:return po?(t=Li(),t>0?po[1].slice(po.position1,po.position1+=t):po[0].slice(po.position0,po.position0-=t)):NH;case 194:return!1;case 195:return!0;case 196:return ZC(At[Ue++]);case 197:return t=qr.getUint16(Ue),Ue+=2,ZC(t);case 198:return t=qr.getUint32(Ue),Ue+=4,ZC(t);case 199:return cd(At[Ue++]);case 200:return t=qr.getUint16(Ue),Ue+=2,cd(t);case 201:return t=qr.getUint32(Ue),Ue+=4,cd(t);case 202:if(t=qr.getFloat32(Ue),Ka.useFloat32>2){let r=ED[(At[Ue]&127)<<1|At[Ue+1]>>7];return Ue+=4,(r*t+(t>0?.5:-.5)>>0)/r}return Ue+=4,t;case 203:return t=qr.getFloat64(Ue),Ue+=8,t;case 204:return At[Ue++];case 205:return t=qr.getUint16(Ue),Ue+=2,t;case 206:return t=qr.getUint32(Ue),Ue+=4,t;case 207:return Ka.int64AsNumber?(t=qr.getUint32(Ue)*4294967296,t+=qr.getUint32(Ue+4)):t=qr.getBigUint64(Ue),Ue+=8,t;case 208:return qr.getInt8(Ue++);case 209:return t=qr.getInt16(Ue),Ue+=2,t;case 210:return t=qr.getInt32(Ue),Ue+=4,t;case 211:return Ka.int64AsNumber?(t=qr.getInt32(Ue)*4294967296,t+=qr.getUint32(Ue+4)):t=qr.getBigInt64(Ue),Ue+=8,t;case 212:if(t=At[Ue++],t==114)return AL(At[Ue++]&63);{let r=Ba[t];if(r)return r.read?(Ue++,r.read(Li())):r.noBuffer?(Ue++,r()):r(At.subarray(Ue,++Ue));throw new Error("Unknown extension "+t)}case 213:return t=At[Ue],t==114?(Ue++,AL(At[Ue++]&63,At[Ue++])):cd(2);case 214:return cd(4);case 215:return cd(8);case 216:return cd(16);case 217:return t=At[Ue++],Zs>=Ue?hu.slice(Ue-Do,(Ue+=t)-Do):pRe(t);case 218:return t=qr.getUint16(Ue),Ue+=2,Zs>=Ue?hu.slice(Ue-Do,(Ue+=t)-Do):mRe(t);case 219:return t=qr.getUint32(Ue),Ue+=4,Zs>=Ue?hu.slice(Ue-Do,(Ue+=t)-Do):vRe(t);case 220:return t=qr.getUint16(Ue),Ue+=2,SL(t);case 221:return t=qr.getUint32(Ue),Ue+=4,SL(t);case 222:return t=qr.getUint16(Ue),Ue+=2,CL(t);case 223:return t=qr.getUint32(Ue),Ue+=4,CL(t);default:if(e>=224)return e-256;if(e===void 0){let r=new Error("Unexpected end of MessagePack data");throw r.incomplete=!0,r}throw new Error("Unknown MessagePack token "+e)}}}var fRe=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function AD(e,t){function r(){if(r.count++>2){let n=e.read=new Function("r","return function(){return {"+e.map(a=>fRe.test(a)?a+":r()":"["+JSON.stringify(a)+"]:r()").join(",")+"}}")(Li);return e.highByte===0&&(e.read=wL(t,e.read)),n()}let i={};for(let n=0,a=e.length;n<a;n++){let o=e[n];i[o]=Li()}return i}return r.count=0,e.highByte===0?wL(t,r):r}var wL=(e,t)=>function(){let r=At[Ue++];if(r===0)return t();let i=e<32?-(e+(r<<5)):e+(r<<5),n=Ur[i]||UH()[i];if(!n)throw new Error("Record id is not defined for "+i);return n.read||(n.read=AD(n,e)),n.read()};function UH(){let e=GH(()=>(At=null,Ka.getStructures()));return Ur=Ka._mergeStructures(e,Ur)}var zM=Vw,pRe=Vw,mRe=Vw,vRe=Vw;function Vw(e){let t;if(e<16&&(t=MD(e)))return t;if(e>64&&IM)return IM.decode(At.subarray(Ue,Ue+=e));let r=Ue+e,i=[];for(t="";Ue<r;){let n=At[Ue++];if(!(n&128))i.push(n);else if((n&224)===192){let a=At[Ue++]&63;i.push((n&31)<<6|a)}else if((n&240)===224){let a=At[Ue++]&63,o=At[Ue++]&63;i.push((n&31)<<12|a<<6|o)}else if((n&248)===240){let a=At[Ue++]&63,o=At[Ue++]&63,s=At[Ue++]&63,l=(n&7)<<18|a<<12|o<<6|s;l>65535&&(l-=65536,i.push(l>>>10&1023|55296),l=56320|l&1023),i.push(l)}else i.push(n);i.length>=4096&&(t+=Dn.apply(String,i),i.length=0)}return i.length>0&&(t+=Dn.apply(String,i)),t}function SL(e){let t=new Array(e);for(let r=0;r<e;r++)t[r]=Li();return t}function CL(e){if(Ka.mapsAsObjects){let t={};for(let r=0;r<e;r++)t[VH()]=Li();return t}else{let t=new Map;for(let r=0;r<e;r++)t.set(Li(),Li());return t}}var Dn=String.fromCharCode;function jH(e){let t=Ue,r=new Array(e);for(let i=0;i<e;i++){let n=At[Ue++];if((n&128)>0){Ue=t;return}r[i]=n}return Dn.apply(String,r)}function MD(e){if(e<4)if(e<2){if(e===0)return"";{let t=At[Ue++];if((t&128)>1){Ue-=1;return}return Dn(t)}}else{let t=At[Ue++],r=At[Ue++];if((t&128)>0||(r&128)>0){Ue-=2;return}if(e<3)return Dn(t,r);let i=At[Ue++];if((i&128)>0){Ue-=3;return}return Dn(t,r,i)}else{let t=At[Ue++],r=At[Ue++],i=At[Ue++],n=At[Ue++];if((t&128)>0||(r&128)>0||(i&128)>0||(n&128)>0){Ue-=4;return}if(e<6){if(e===4)return Dn(t,r,i,n);{let a=At[Ue++];if((a&128)>0){Ue-=5;return}return Dn(t,r,i,n,a)}}else if(e<8){let a=At[Ue++],o=At[Ue++];if((a&128)>0||(o&128)>0){Ue-=6;return}if(e<7)return Dn(t,r,i,n,a,o);let s=At[Ue++];if((s&128)>0){Ue-=7;return}return Dn(t,r,i,n,a,o,s)}else{let a=At[Ue++],o=At[Ue++],s=At[Ue++],l=At[Ue++];if((a&128)>0||(o&128)>0||(s&128)>0||(l&128)>0){Ue-=8;return}if(e<10){if(e===8)return Dn(t,r,i,n,a,o,s,l);{let c=At[Ue++];if((c&128)>0){Ue-=9;return}return Dn(t,r,i,n,a,o,s,l,c)}}else if(e<12){let c=At[Ue++],u=At[Ue++];if((c&128)>0||(u&128)>0){Ue-=10;return}if(e<11)return Dn(t,r,i,n,a,o,s,l,c,u);let d=At[Ue++];if((d&128)>0){Ue-=11;return}return Dn(t,r,i,n,a,o,s,l,c,u,d)}else{let c=At[Ue++],u=At[Ue++],d=At[Ue++],h=At[Ue++];if((c&128)>0||(u&128)>0||(d&128)>0||(h&128)>0){Ue-=12;return}if(e<14){if(e===12)return Dn(t,r,i,n,a,o,s,l,c,u,d,h);{let f=At[Ue++];if((f&128)>0){Ue-=13;return}return Dn(t,r,i,n,a,o,s,l,c,u,d,h,f)}}else{let f=At[Ue++],p=At[Ue++];if((f&128)>0||(p&128)>0){Ue-=14;return}if(e<15)return Dn(t,r,i,n,a,o,s,l,c,u,d,h,f,p);let v=At[Ue++];if((v&128)>0){Ue-=15;return}return Dn(t,r,i,n,a,o,s,l,c,u,d,h,f,p,v)}}}}}function ZC(e){return Ka.copyBuffers?Uint8Array.prototype.slice.call(At,Ue,Ue+=e):At.subarray(Ue,Ue+=e)}function cd(e){let t=At[Ue++];if(Ba[t])return Ba[t](At.subarray(Ue,Ue+=e));throw new Error("Unknown extension type "+t)}var _L=new Array(4096);function VH(){let e=At[Ue++];if(e>=160&&e<192){if(e=e-160,Zs>=Ue)return hu.slice(Ue-Do,(Ue+=e)-Do);if(!(Zs==0&&Eu<180))return zM(e)}else return Ue--,Li();let t=(e<<5^(e>1?qr.getUint16(Ue):e>0?At[Ue]:0))&4095,r=_L[t],i=Ue,n=Ue+e-3,a,o=0;if(r&&r.bytes==e){for(;i<n;){if(a=qr.getUint32(i),a!=r[o++]){i=1879048192;break}i+=4}for(n+=3;i<n;)if(a=At[i++],a!=r[o++]){i=1879048192;break}if(i===n)return Ue=i,r.string;n-=3,i=Ue}for(r=[],_L[t]=r,r.bytes=e;i<n;)a=qr.getUint32(i),r.push(a),i+=4;for(n+=3;i<n;)a=At[i++],r.push(a);let s=e<16?MD(e):jH(e);return s!=null?r.string=s:r.string=zM(e)}var AL=(e,t)=>{var r=Li();let i=e;t!==void 0&&(e=e<32?-((t<<5)+e):(t<<5)+e,r.highByte=t);let n=Ur[e];return n&&n.isShared&&((Ur.restoreStructures||(Ur.restoreStructures=[]))[e]=n),Ur[e]=r,r.read=AD(r,i),r.read()},HH=typeof self=="object"?self:global;Ba[0]=()=>{};Ba[0].noBuffer=!0;Ba[101]=()=>{let e=Li();return(HH[e[0]]||Error)(e[1])};Ba[105]=e=>{let t=qr.getUint32(Ue-4);oc||(oc=new Map);let r=At[Ue],i;r>=144&&r<160||r==220||r==221?i=[]:i={};let n={target:i};oc.set(t,n);let a=Li();return n.used?Object.assign(i,a):(n.target=a,a)};Ba[112]=e=>{let t=qr.getUint32(Ue-4),r=oc.get(t);return r.used=!0,r.target};Ba[115]=()=>new Set(Li());var WH=["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64","BigInt64","BigUint64"].map(e=>e+"Array");Ba[116]=e=>{let t=e[0],r=WH[t];if(!r)throw new Error("Could not find typed array for code "+t);return new HH[r](Uint8Array.prototype.slice.call(e,1).buffer)};Ba[120]=()=>{let e=Li();return new RegExp(e[0],e[1])};Ba[98]=e=>{let t=(e[0]<<24)+(e[1]<<16)+(e[2]<<8)+e[3],r=Ue;Ue+=t-4,po=[Li(),Li()],po.position0=0,po.position1=0;let i=Ue;Ue=r;try{return Li()}finally{Ue=i}};Ba[255]=e=>e.length==4?new Date((e[0]*16777216+(e[1]<<16)+(e[2]<<8)+e[3])*1e3):e.length==8?new Date(((e[0]<<22)+(e[1]<<14)+(e[2]<<6)+(e[3]>>2))/1e6+((e[3]&3)*4294967296+e[4]*16777216+(e[5]<<16)+(e[6]<<8)+e[7])*1e3):e.length==12?new Date(((e[0]<<24)+(e[1]<<16)+(e[2]<<8)+e[3])/1e6+((e[4]&128?-281474976710656:0)+e[6]*1099511627776+e[7]*4294967296+e[8]*16777216+(e[9]<<16)+(e[10]<<8)+e[11])*1e3):new Date("invalid");function GH(e){let t=Eu,r=Ue,i=Do,n=Zs,a=hu,o=oc,s=po,l=new Uint8Array(At.slice(0,Eu)),c=Ur,u=Ur.slice(0,Ur.length),d=Ka,h=Np,f=e();return Eu=t,Ue=r,Do=i,Zs=n,hu=a,oc=o,po=s,At=l,Np=h,Ur=c,Ur.splice(0,Ur.length,...u),Ka=d,qr=new DataView(At.buffer,At.byteOffset,At.byteLength),f}function kM(){At=null,oc=null,Ur=null}function gRe(e){e.unpack?Ba[e.type]=e.unpack:Ba[e.type]=e}var ED=new Array(147);for(let e=0;e<256;e++)ED[e]=+("1e"+Math.floor(45.15-e*.30103));var Hw=new s1({useRecords:!1});Hw.unpack;Hw.unpackMultiple;Hw.unpack;var yRe=new Float32Array(1);new Uint8Array(yRe.buffer,0,4);var Wb;try{Wb=new TextEncoder}catch{}var l1,TD,Ww=typeof Buffer<"u",JC=Ww?Buffer.allocUnsafeSlow:Uint8Array,$H=Ww?Buffer:Uint8Array,ML=Ww?4294967296:2144337920,tt,Hi,Ge=0,Os,Rs=null,bRe=/[\u0080-\uFFFF]/,qm=Symbol("record-id"),qH=class extends s1{constructor(e){super(e),this.offset=0;let t,r,i,n,a,o=0,s=$H.prototype.utf8Write?function(w,_,C){return tt.utf8Write(w,_,C)}:Wb&&Wb.encodeInto?function(w,_){return Wb.encodeInto(w,tt.subarray(_)).written}:!1,l=this;e||(e={});let c=e&&e.sequential,u=e.structures||e.saveStructures,d=e.maxSharedStructures;if(d==null&&(d=u?32:0),d>8160)throw new Error("Maximum maxSharedStructure is 8160");let h=e.maxOwnStructures;h==null&&(h=u?32:64),c&&!e.saveStructures&&(this.structures=[]);let f=d>32||h+d>64,p=d+64,v=d+h+64;if(v>8256)throw new Error("Maximum maxSharedStructure + maxOwnStructure is 8192");let m=[],g=0,y=0;this.pack=this.encode=function(w,_){if(tt||(tt=new JC(8192),Hi=new DataView(tt.buffer,0,8192),Ge=0),Os=tt.length-10,Os-Ge<2048?(tt=new JC(tt.length),Hi=new DataView(tt.buffer,0,tt.length),Os=tt.length-10,Ge=0):Ge=Ge+7&2147483640,t=Ge,a=l.structuredClone?new Map:null,l.bundleStrings?(Rs=["",""],tt[Ge++]=214,tt[Ge++]=98,Rs.position=Ge-t,Ge+=4):Rs=null,r=l.structures,r){r.uninitialized&&(r=l._mergeStructures(l.getStructures()));let C=r.sharedLength||0;if(C>d)throw new Error("Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to "+r.sharedLength);if(!r.transitions){r.transitions=Object.create(null);for(let A=0;A<C;A++){let M=r[A];if(!M)continue;let P,T=r.transitions;for(let R=0,z=M.length;R<z;R++){let F=M[R];P=T[F],P||(P=T[F]=Object.create(null)),T=P}T[qm]=A+64}o=C}c||(r.nextId=C+64)}i&&(i=!1),n=r||[];try{if(b(w),Rs){Hi.setUint32(Rs.position+t,Ge-Rs.position-t);let C=Rs;Rs=null,b(C[0]),b(C[1])}if(l.offset=Ge,a&&a.idsToInsert){Ge+=a.idsToInsert.length*6,Ge>Os&&S(Ge),l.offset=Ge;let C=wRe(tt.subarray(t,Ge),a.idsToInsert);return a=null,C}return _&SRe?(tt.start=t,tt.end=Ge,tt):tt.subarray(t,Ge)}finally{if(r){if(y<10&&y++,g>1e4)r.transitions=null,y=0,g=0,m.length>0&&(m=[]);else if(m.length>0&&!c){for(let C=0,A=m.length;C<A;C++)m[C][qm]=0;m=[]}if(i&&l.saveStructures){let C=r.sharedLength||d;r.length>C&&(r=r.slice(0,C));let A=tt.subarray(t,Ge);return l.saveStructures(r,o)===!1?(l._mergeStructures(l.getStructures()),l.pack(w)):(o=C,A)}}_&CRe&&(Ge=t)}};let b=w=>{Ge>Os&&(tt=S(Ge));var _=typeof w,C;if(_==="string"){let A=w.length;if(Rs&&A>=8&&A<4096){let T=bRe.test(w);Rs[T?0:1]+=w,tt[Ge++]=193,b(T?-A:A);return}let M;A<32?M=1:A<256?M=2:A<65536?M=3:M=5;let P=A*3;if(Ge+P>Os&&(tt=S(Ge+P)),A<64||!s){let T,R,z,F=Ge+M;for(T=0;T<A;T++)R=w.charCodeAt(T),R<128?tt[F++]=R:R<2048?(tt[F++]=R>>6|192,tt[F++]=R&63|128):(R&64512)===55296&&((z=w.charCodeAt(T+1))&64512)===56320?(R=65536+((R&1023)<<10)+(z&1023),T++,tt[F++]=R>>18|240,tt[F++]=R>>12&63|128,tt[F++]=R>>6&63|128,tt[F++]=R&63|128):(tt[F++]=R>>12|224,tt[F++]=R>>6&63|128,tt[F++]=R&63|128);C=F-Ge-M}else C=s(w,Ge+M,P);C<32?tt[Ge++]=160|C:C<256?(M<2&&tt.copyWithin(Ge+2,Ge+1,Ge+1+C),tt[Ge++]=217,tt[Ge++]=C):C<65536?(M<3&&tt.copyWithin(Ge+3,Ge+2,Ge+2+C),tt[Ge++]=218,tt[Ge++]=C>>8,tt[Ge++]=C&255):(M<5&&tt.copyWithin(Ge+5,Ge+3,Ge+3+C),tt[Ge++]=219,Hi.setUint32(Ge,C),Ge+=4),Ge+=C}else if(_==="number")if(w>>>0===w)w<64?tt[Ge++]=w:w<256?(tt[Ge++]=204,tt[Ge++]=w):w<65536?(tt[Ge++]=205,tt[Ge++]=w>>8,tt[Ge++]=w&255):(tt[Ge++]=206,Hi.setUint32(Ge,w),Ge+=4);else if(w>>0===w)w>=-32?tt[Ge++]=256+w:w>=-128?(tt[Ge++]=208,tt[Ge++]=w+256):w>=-32768?(tt[Ge++]=209,Hi.setInt16(Ge,w),Ge+=2):(tt[Ge++]=210,Hi.setInt32(Ge,w),Ge+=4);else{let A;if((A=this.useFloat32)>0&&w<4294967296&&w>=-2147483648){tt[Ge++]=202,Hi.setFloat32(Ge,w);let M;if(A<4||(M=w*ED[(tt[Ge]&127)<<1|tt[Ge+1]>>7])>>0===M){Ge+=4;return}else Ge--}tt[Ge++]=203,Hi.setFloat64(Ge,w),Ge+=8}else if(_==="object")if(!w)tt[Ge++]=192;else{if(a){let M=a.get(w);if(M){if(!M.id){let P=a.idsToInsert||(a.idsToInsert=[]);M.id=P.push(M)}tt[Ge++]=214,tt[Ge++]=112,Hi.setUint32(Ge,M.id),Ge+=4;return}else a.set(w,{offset:Ge-t})}let A=w.constructor;if(A===Object)x(w,!0);else if(A===Array){C=w.length,C<16?tt[Ge++]=144|C:C<65536?(tt[Ge++]=220,tt[Ge++]=C>>8,tt[Ge++]=C&255):(tt[Ge++]=221,Hi.setUint32(Ge,C),Ge+=4);for(let M=0;M<C;M++)b(w[M])}else if(A===Map){C=w.size,C<16?tt[Ge++]=128|C:C<65536?(tt[Ge++]=222,tt[Ge++]=C>>8,tt[Ge++]=C&255):(tt[Ge++]=223,Hi.setUint32(Ge,C),Ge+=4);for(let[M,P]of w)b(M),b(P)}else{for(let M=0,P=l1.length;M<P;M++){let T=TD[M];if(w instanceof T){let R=l1[M];if(R.write){R.type&&(tt[Ge++]=212,tt[Ge++]=R.type,tt[Ge++]=0),b(R.write.call(this,w));return}let z=tt,F=Hi,H=Ge;tt=null;let N;try{N=R.pack.call(this,w,U=>(tt=z,z=null,Ge+=U,Ge>Os&&S(Ge),{target:tt,targetView:Hi,position:Ge-U}),b)}finally{z&&(tt=z,Hi=F,Ge=H,Os=tt.length-10)}N&&(N.length+Ge>Os&&S(N.length+Ge),Ge=xRe(N,tt,Ge,R.type));return}}x(w,!w.hasOwnProperty)}}else if(_==="boolean")tt[Ge++]=w?195:194;else if(_==="bigint"){if(w<BigInt(1)<<BigInt(63)&&w>=-(BigInt(1)<<BigInt(63)))tt[Ge++]=211,Hi.setBigInt64(Ge,w);else if(w<BigInt(1)<<BigInt(64)&&w>0)tt[Ge++]=207,Hi.setBigUint64(Ge,w);else if(this.largeBigIntToFloat)tt[Ge++]=203,Hi.setFloat64(Ge,Number(w));else throw new RangeError(w+" was too large to fit in MessagePack 64-bit integer format, set largeBigIntToFloat to convert to float-64");Ge+=8}else if(_==="undefined")this.encodeUndefinedAsNil?tt[Ge++]=192:(tt[Ge++]=212,tt[Ge++]=0,tt[Ge++]=0);else if(_==="function")b(this.writeFunction&&this.writeFunction());else throw new Error("Unknown type: "+_)},x=this.useRecords===!1?this.variableMapSize?w=>{let _=Object.keys(w),C=_.length;C<16?tt[Ge++]=128|C:C<65536?(tt[Ge++]=222,tt[Ge++]=C>>8,tt[Ge++]=C&255):(tt[Ge++]=223,Hi.setUint32(Ge,C),Ge+=4);let A;for(let M=0;M<C;M++)b(A=_[M]),b(w[A])}:(w,_)=>{tt[Ge++]=222;let C=Ge-t;Ge+=2;let A=0;for(let M in w)(_||w.hasOwnProperty(M))&&(b(M),b(w[M]),A++);tt[C+++t]=A>>8,tt[C+t]=A&255}:w=>{let _=Object.keys(w),C,A=n.transitions||(n.transitions=Object.create(null)),M=0;for(let T=0,R=_.length;T<R;T++){let z=_[T];C=A[z],C||(C=A[z]=Object.create(null),M++),A=C}let P=A[qm];if(P)P>=96&&f?(tt[Ge++]=((P-=96)&31)+96,tt[Ge++]=P>>5):tt[Ge++]=P;else{P=n.nextId,P||(P=64),P<p&&this.shouldShareStructure&&!this.shouldShareStructure(_)?(P=n.nextOwnId,P<v||(P=p),n.nextOwnId=P+1):(P>=v&&(P=p),n.nextId=P+1);let T=_.highByte=P>=96&&f?P-96>>5:-1;A[qm]=P,n[P-64]=_,P<p?(_.isShared=!0,n.sharedLength=P-63,i=!0,T>=0?(tt[Ge++]=(P&31)+96,tt[Ge++]=T):tt[Ge++]=P):(T>=0?(tt[Ge++]=213,tt[Ge++]=114,tt[Ge++]=(P&31)+96,tt[Ge++]=T):(tt[Ge++]=212,tt[Ge++]=114,tt[Ge++]=P),M&&(g+=y*M),m.length>=h&&(m.shift()[qm]=0),m.push(A),b(_))}for(let T=0,R=_.length;T<R;T++)b(w[_[T]])},S=w=>{let _;if(w>16777216){if(w-t>ML)throw new Error("Packed buffer would be larger than maximum buffer size");_=Math.min(ML,Math.round(Math.max((w-t)*(w>67108864?1.25:2),4194304)/4096)*4096)}else _=(Math.max(w-t<<2,tt.length-1)>>12)+1<<12;let C=new JC(_);return Hi=new DataView(C.buffer,0,_),tt.copy?tt.copy(C,0,t,w):C.set(tt.slice(t,w)),Ge-=t,t=0,Os=C.length-10,tt=C}}useBuffer(e){tt=e,Hi=new DataView(tt.buffer,tt.byteOffset,tt.byteLength),Ge=0}};TD=[Date,Set,Error,RegExp,ArrayBuffer,Object.getPrototypeOf(Uint8Array.prototype).constructor,FH];l1=[{pack(e,t,r){let i=e.getTime()/1e3;if((this.useTimestamp32||e.getMilliseconds()===0)&&i>=0&&i<4294967296){let{target:n,targetView:a,position:o}=t(6);n[o++]=214,n[o++]=255,a.setUint32(o,i)}else if(i>0&&i<17179869184){let{target:n,targetView:a,position:o}=t(10);n[o++]=215,n[o++]=255,a.setUint32(o,e.getMilliseconds()*4e6+(i/1e3/4294967296>>0)),a.setUint32(o+4,i)}else if(isNaN(i)){if(this.onInvalidDate)return t(0),r(this.onInvalidDate());let{target:n,targetView:a,position:o}=t(3);n[o++]=212,n[o++]=255,n[o++]=255}else{let{target:n,targetView:a,position:o}=t(15);n[o++]=199,n[o++]=12,n[o++]=255,a.setUint32(o,e.getMilliseconds()*1e6),a.setBigInt64(o+4,BigInt(Math.floor(i)))}}},{pack(e,t,r){let i=Array.from(e),{target:n,position:a}=t(this.structuredClone?3:0);this.structuredClone&&(n[a++]=212,n[a++]=115,n[a++]=0),r(i)}},{pack(e,t,r){let{target:i,position:n}=t(this.structuredClone?3:0);this.structuredClone&&(i[n++]=212,i[n++]=101,i[n++]=0),r([e.name,e.message])}},{pack(e,t,r){let{target:i,position:n}=t(this.structuredClone?3:0);this.structuredClone&&(i[n++]=212,i[n++]=120,i[n++]=0),r([e.source,e.flags])}},{pack(e,t){this.structuredClone?EL(e,16,t):TL(Ww?Buffer.from(e):new Uint8Array(e),t)}},{pack(e,t){let r=e.constructor;r!==$H&&this.structuredClone?EL(e,WH.indexOf(r.name),t):TL(e,t)}},{pack(e,t){let{target:r,position:i}=t(1);r[i]=193}}];function EL(e,t,r,i){let n=e.byteLength;if(n+1<256){var{target:a,position:o}=r(4+n);a[o++]=199,a[o++]=n+1}else if(n+1<65536){var{target:a,position:o}=r(5+n);a[o++]=200,a[o++]=n+1>>8,a[o++]=n+1&255}else{var{target:a,position:o,targetView:s}=r(7+n);a[o++]=201,s.setUint32(o,n+1),o+=4}a[o++]=116,a[o++]=t,a.set(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),o)}function TL(e,t){let r=e.byteLength;var i,n;if(r<256){var{target:i,position:n}=t(r+2);i[n++]=196,i[n++]=r}else if(r<65536){var{target:i,position:n}=t(r+3);i[n++]=197,i[n++]=r>>8,i[n++]=r&255}else{var{target:i,position:n,targetView:a}=t(r+5);i[n++]=198,a.setUint32(n,r),n+=4}i.set(e,n)}function xRe(e,t,r,i){let n=e.length;switch(n){case 1:t[r++]=212;break;case 2:t[r++]=213;break;case 4:t[r++]=214;break;case 8:t[r++]=215;break;case 16:t[r++]=216;break;default:n<256?(t[r++]=199,t[r++]=n):n<65536?(t[r++]=200,t[r++]=n>>8,t[r++]=n&255):(t[r++]=201,t[r++]=n>>24,t[r++]=n>>16&255,t[r++]=n>>8&255,t[r++]=n&255)}return t[r++]=i,t.set(e,r),r+=n,r}function wRe(e,t){let r,i=t.length*6,n=e.length-i;for(t.sort((a,o)=>a.offset>o.offset?1:-1);r=t.pop();){let a=r.offset,o=r.id;e.copyWithin(a+i,a,n),i-=6;let s=a+i;e[s++]=214,e[s++]=105,e[s++]=o>>24,e[s++]=o>>16&255,e[s++]=o>>8&255,e[s++]=o&255,n=a}return e}function vm(e){if(e.Class){if(!e.pack&&!e.write)throw new Error("Extension has no pack or write function");if(e.pack&&!e.type)throw new Error("Extension has no type (numeric code to identify the extension)");TD.unshift(e.Class),l1.unshift(e)}gRe(e)}var YH=new qH({useRecords:!1});YH.pack;YH.pack;var SRe=512,CRe=1024,PL=new qH({structuredClone:!0});vm({Class:Lt.prototype.constructor,type:1,write(e){return{...e}},read(e){return Object.setPrototypeOf(e,Lt.prototype),e}});vm({Class:Dt.prototype.constructor,type:2,write(e){return[...e]},read(e){return Object.setPrototypeOf(e,Dt.prototype),e}});vm({Class:ra.prototype.constructor,type:3,write(e){return[...e]},read(e){return Object.setPrototypeOf(e,ra.prototype),e}});vm({Class:gL.prototype.constructor,type:4,write(e){return e.id},read(e){return new gL(e)}});vm({Class:yL.prototype.constructor,type:5,write(e){return e.data},read(e){return new yL(e)}});vm({Class:dn.prototype.constructor,type:6,write(e){return{...e}},read(e){return Object.setPrototypeOf(e,dn.prototype),e}});function _Re(e){var t=0;if(e.length===0)return t;for(let r=0;r<e.length;r++){let i=e[r];t=(t<<5)-t+i,t=t&t}return t}function LM(e){if(xD(e))return e;if(Array.isArray(e))return e.map(LM);if(typeof e=="object"&&e!==null){let t={};for(let r of Object.keys(e).sort())t[r]=LM(e[r]);return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),t}else return e}var BM;(e=>{function t(n){return PL.pack(n)}e.serialize=t;function r(n){return PL.unpack(n)}e.deserialize=r;function i(n){return _Re(t(LM(n))).toString()}e.checksum=i})(BM||(BM={}));var DL;(e=>{function t(i){return i.type==="Conditional"?i.condition.type==="Distance"?"Distance":"StateChange":i.type}e.toEventUIType=t;function r(i){return i==="Distance"||i==="StateChange"?"Conditional":i}e.fromEventUIType=r})(DL||(DL={}));function OL(e){return e==="MouseDown"||e==="MouseUp"||e==="KeyDown"||e==="KeyUp"||e==="Collision"||e==="Trigger"}var ha={LookAt:[],Follow:["Create"],DragDrop:["Transition","Animation","Audio","Particles","Create","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],MouseHover:["Transition","Animation","Particles","Create","Destroy","SwitchCamera","SceneTransition","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],Scroll:["Transition","Animation","Create","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],Start:["Transition","Animation","Audio","Particles","Video","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],Conditional:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],MouseDown:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],MouseUp:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],MousePress:["Transition","Animation","Audio","Particles","Video","Link","Create","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],KeyDown:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],KeyUp:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],KeyPress:["Transition","Animation","Audio","Particles","Video","Link","Create","SwitchCamera","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],GameControl:["Transition","Animation","Audio","Particles","Create","Conditional"],Collision:["Transition","Animation","Audio","Particles","Video","Create","Destroy","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],Trigger:["Transition","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],Resize:["Transition","Animation","Audio","Particles","Video","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],VariableChange:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],API:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],WEBHOOK:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"]},RL;(e=>{function t(i){return i.type==="MouseDown"||i.type==="MouseUp"||i.type==="MousePress"||i.type==="KeyDown"||i.type==="KeyUp"||i.type==="KeyPress"}e.is=t;function r(i){return i==="MouseDown"||i==="MouseUp"||i==="MousePress"?{type:i,mode:"Object",disabled:!1,actions:new Dt}:{type:i,disabled:!1,key:void 0,actions:new Dt}}e.defaultData=r})(RL||(RL={}));var c1;(e=>{function t(r){return{type:"Property",value:[r??null,"position","x"]}}e.propertyDefaultData=t,e.valueDefaultData={type:"Literal",value:0}})(c1||(c1={}));var FM;(e=>{function t(n){return{type:"Comparison",operator:"==",lOperand:c1.propertyDefaultData(n),rOperand:{...c1.valueDefaultData}}}e.comparisonDefaultData=t;function r(n){return{type:"Distance",toObject:n??null,fromObject:n??null,distance:200}}e.distanceDefaultData=r;function i(n,a){return{type:"State",object:n??null,state:a??null}}e.stateDefaultData=i})(FM||(FM={}));var IL;(e=>{function t(r){return r.find(i=>i==="ifActions"||i==="elseActions")!==void 0}e.isConditionalSubActions=t})(IL||(IL={}));var zL;(e=>{function t(i){return i.type==="Conditional"}e.is=t;function r(i){return{type:"Conditional",disabled:!1,inActions:new Dt,outActions:new Dt,condition:FM.distanceDefaultData(i)}}e.defaultData=r})(zL||(zL={}));var kL;(e=>e.defaultData={type:"DragDrop",cursor:"hand",disabled:!1,dampingFactor:1,objects:[],snapTo:"center",snapSurfaceMode:"bbox",snapSurfaceOffset:0,dropOn:"all",autoOrient:!0,dropDestinations:[],plane:"adaptive",planeMode:"locked",referenceFrame:"global",limits:[-1/0,1/0,-1/0,1/0,-1/0,1/0],drop:!1,resetOnSnapFail:!1,snapSpeed:20,resetSpeed:20,dragDropActions:{drag:new Dt,drop:new Dt}})(kL||(kL={}));var NM;(e=>e.defaultData={type:"Follow",disabled:!1,maxDelta:0,dampingFactor:1,target:"cursor",plane:"custom",resetOnPointerLeave:!0,resetAfterDistanceLimit:!0,enabledTranslation:[!0,!0,!0],limitDistanceEnabled:!1,limitDistance:1e3,snapDelay:0,resetSpeed:5,actions:new Dt})(NM||(NM={}));var UM;(e=>e.defaultData={type:"LookAt",disabled:!1,distance:1e3,dampingFactor:1,target:"cursor",tilt:"up",axis:"z",plane:"custom",resetOnPointerLeave:!0,resetAfterDistanceLimit:!0,enabledRotation:[!0,!0,!0],limitDistanceEnabled:!1,limitDistance:1e3,snapDelay:0,resetSpeed:5})(UM||(UM={}));var LL;(e=>{function t(i){return i.type==="MouseHover"}e.is=t;function r(){return{type:"MouseHover",disabled:!1,actions:new Dt}}e.defaultData=r})(LL||(LL={}));var BL;(e=>{function t(i){return i.type==="Scroll"}e.is=t;function r(){return{type:"Scroll",disabled:!1,steps:100,trigger:"load",startFrom:"enter",enterAnchor:"top",startOffset:0,endAfter:400,actions:new Dt}}e.defaultData=r})(BL||(BL={}));var FL;(e=>{function t(i){return i.type==="Start"}e.is=t;function r(){return{type:"Start",disabled:!1,actions:new Dt}}e.defaultData=r})(FL||(FL={}));var NL;(e=>{function t(i){return i.type==="Collision"}e.is=t;function r(){return{type:"Collision",disabled:!1,target:"character",actions:new Dt}}e.defaultData=r})(NL||(NL={}));var UL;(e=>{function t(i){return i.type==="Trigger"}e.is=t;function r(i,n){return{type:"Trigger",disabled:!1,target:"all",triggeringObjects:[],actions:new Dt,triggerZone:"box",position:n.toArray(),rotation:[0,0,0],size:i.toArray(),radius:i.length()/2,helperVisible:!0}}e.defaultData=r})(UL||(UL={}));var jM;(e=>{e.defaultSizes={mobile:[480,480],tablet:[768,768],desktop:[1200,1200],custom:[769,1200]};function t(o){return o.type==="Resize"}e.is=t;function r(o){return typeof o=="string"?o:"custom"}e.sizeToDevice=r;function i(o){return typeof o=="string"?[...e.defaultSizes[o]]:[...o]}e.deviceToSize=i;function n(){let o={size:"mobile",operator:"<",actions:new Dt},s={size:"tablet",operator:"<",actions:new Dt},l={size:[...e.defaultSizes.custom],operator:"<>",actions:new Dt},c=new Dt;return c.push({id:St.generateUUID(),fi:0,data:o},{id:St.generateUUID(),fi:1,data:s},{id:St.generateUUID(),fi:2,data:l}),{type:"Resize",disabled:!1,orientation:"horizontal",breakpoints:c}}e.defaultData=n;function a(){return{size:[...e.defaultSizes.custom],operator:"<>",actions:new Dt}}e.defaultBreakpointData=a})(jM||(jM={}));var VM;(e=>{e.propertyPaths={Position:["position"],"Position X":["position","x"],"Position Y":["position","y"],"Position Z":["position","z"],Rotation:["rotation"],"Rotation X":["rotation","x"],"Rotation Y":["rotation","y"],"Rotation Z":["rotation","z"],Scale:["scale"],"Scale X":["scale","x"],"Scale Y":["scale","y"],"Scale Z":["scale","z"],Width:["width"],Height:["height"],Depth:["depth"],"Mouse Position X":["mouse","x"],"Mouse Position Y":["mouse","y"],"Mouse Pressed":["mouse","pressed"],"Screen Width":["mouse","width"],"Screen Height":["mouse","height"],"Hit Position X":["raycast","x"],"Hit Position Y":["raycast","y"],"Hit Position Z":["raycast","z"],"Hit Object Position X":["raycast","objX"],"Hit Object Position Y":["raycast","objY"],"Hit Object Position Z":["raycast","objZ"]};function t(i){return i.type==="VariableChange"}e.is=t;function r(){return{disabled:!1,type:"VariableChange",actions:new Dt,variableId:"",objectId:null,property:"Position X"}}e.defaultData=r})(VM||(VM={}));var jL;(e=>{function t(i){return i.type==="API"}e.is=t;function r(){return{disabled:!1,type:"API",successActions:new Dt,errorActions:new Dt,userAPIId:""}}e.defaultData=r})(jL||(jL={}));var VL;(e=>{function t(i){return i.type==="WEBHOOK"}e.is=t;function r(){return{disabled:!1,type:"WEBHOOK",actions:new Dt,userWebhookId:""}}e.defaultData=r})(VL||(VL={}));var gm="personal camera",Yv="a218fcc3-276b-49b9-b485-49037fd14f5f",ARe=2960946,go=5526619,rc;(e=>{function t(p,v){return p[0]===v[0]&&p[1]===v[1]}e.isEqual=t;function r(p,v,m){return[p[0]+(v[0]-p[0])*m,p[1]+(v[1]-p[1])*m]}e.lerp=r;function i(p,v){return[p[0]+v[0],p[1]+v[1]]}e.add=i;function n(p,v){return[p[0]-v[0],p[1]-v[1]]}e.sub=n;function a(p,v){return[p[0]*v[0],p[1]*v[1]]}e.multiply=a;function o(p,v){return[p[0]/v[0],p[1]/v[1]]}e.divide=o;function s(p,v){return Math.pow(v[0]-p[0],2)+Math.pow(v[1]-p[1],2)}e.distanceSquared=s;function l(p,v){return Math.sqrt(s(p,v))}e.distance=l;function c(p,v){return p[0]*v[0]+p[1]*v[1]}e.dot=c;function u(p,v){return[p[0]*v,p[1]*v]}e.scalarMultiply=u;function d(p,v,m){let g=e.sub(v,p),y=e.sub(m,p),b=e.dot(g,y)/e.dot(g,g),x=e.scalarMultiply(g,b);return e.add(p,x)}e.projectionOnto=d;function h(p,v,m){return l(p,d(p,v,m))}e.projectionOntoDistance=h;function f(p,v){return[(p[0]+v[0])*.5,(p[1]+v[1])*.5]}e.center=f})(rc||(rc={}));var th;(e=>{function t(l,c){return l[0]===c[0]&&l[1]===c[1]&&l[2]===c[2]}e.isEqual=t;function r(l,c){return[l[0]+c[0],l[1]+c[1],l[2]+c[2]]}e.add=r;function i(l,c){return[l[0]-c[0],l[1]-c[1],l[2]-c[2]]}e.sub=i;function n(l,c){return[l[0]/c[0],l[1]/c[1],l[2]/c[2]]}e.div=n;function a(l,c){return[l[0]*c[0],l[1]*c[1],l[2]*c[2]]}e.mul=a;function o(l,c){return Math.hypot(l[0]-c[0],l[1]-c[1],l[2]-c[2])}e.dist=o;function s(l,c,u){return[l[0]+(c[0]-l[0])*u,l[1]+(c[1]-l[1])*u,l[2]+(c[2]-l[2])*u]}e.lerp=s})(th||(th={}));var u1;(e=>{function t(i,n){return i[0]===n[0]&&i[1]===n[1]&&i[2]===n[2]&&i[3]===n[3]}e.isEqual=t;function r(i,n,a){return[i[0]+(n[0]-i[0])*a,i[1]+(n[1]-i[1])*a,i[2]+(n[2]-i[2])*a,i[3]+(n[3]-i[3])*a]}e.lerp=r})(u1||(u1={}));var HL;(e=>{let t=180/Math.PI,r=Math.PI/180;function i(s){return typeof s=="number"?s*t:s}function n(s){return typeof s=="number"?s*r:s}function a(s){return[i(s[0]),i(s[1]),i(s[2])]}e.radToDeg=a;function o(s){return[n(s[0]),n(s[1]),n(s[2])]}e.degToRad=o})(HL||(HL={}));var Up;(e=>{e.identity=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function t(n,a){for(let o=0;o<16;o++)if(n[o]!==a[o])return!1;return!0}e.isEqual=t;function r(n){return n??e.identity}e.simplify=r;function i(n,a){let o=a.slice(0);for(var s=0,l=a.length;s<l;s+=3){let c=n[3]*a[s]+n[7]*a[s+1]+n[11]*a[s+2]+n[15];o[s]=(n[0]*a[s]+n[4]*a[s+1]+n[8]*a[s+2]+n[12])/c,o[s+1]=(n[1]*a[s]+n[5]*a[s+1]+n[9]*a[s+2]+n[13])/c,o[s+2]=(n[2]*a[s]+n[6]*a[s+1]+n[10]*a[s+2]+n[14])/c}return o}e.applyMatrix4=i})(Up||(Up={}));var ea;(e=>{function t(c){return typeof c=="object"&&typeof c.r=="number"&&typeof c.g=="number"&&typeof c.b=="number"}e.isRGB=t,e.white={r:1,g:1,b:1},e.red={r:1,g:0,b:0},e.black={r:0,g:0,b:0};function r(c){return{r:Math.round(c.r*255),g:Math.round(c.g*255),b:Math.round(c.b*255),a:1}}e.toRgb255a1=r;function i(c){return{r:c.r,g:c.g,b:c.b}}e.clone=i;function n(c){return c=Math.floor(c),{r:(c>>16&255)/255,g:(c>>8&255)/255,b:(c&255)/255}}e.fromHex=n;function a(c){return Math.round(c.r*255)*65536+Math.round(c.g*255)*256+Math.round(c.b*255)}e.toHex=a;function o(c,u){return c.r===u.r&&c.g===u.g&&c.b===u.b}e.equals=o;function s(c,u){return c.r.toFixed(2)===u.r.toFixed(2)&&c.g.toFixed(2)===u.g.toFixed(2)&&c.b.toFixed(2)===u.b.toFixed(2)}e.equalsFixed=s;function l(c,u,d){return{r:c.r+(u.r-c.r)*d,g:c.g+(u.g-c.g)*d,b:c.b+(u.b-c.b)*d}}e.lerp=l})(ea||(ea={}));var ii;(e=>{e.white={...ea.white,a:1},e.transparent={...ea.white,a:0};function t(l){return{r:l[0],g:l[1],b:l[2],a:l[3]}}e.from0to1=t;function r(l,c){return{...ea.fromHex(l),a:c}}e.fromHexAndA=r;function i(l){return{r:Math.round(l.r*255),g:Math.round(l.g*255),b:Math.round(l.b*255),a:l.a}}e.toRgb255a1=i;function n(l,c){return ea.equals(l,c)&&l.a===c.a}e.equals=n;function a(l,c){return ea.equalsFixed(l,c)&&l.a.toFixed(2)===c.a.toFixed(2)}e.equalsFixed=a;function o(l,c,u){return{r:l.r+(c.r-l.r)*u,g:l.g+(c.g-l.g)*u,b:l.b+(c.b-l.b)*u,a:l.a+(c.a-l.a)*u}}e.lerp=o;function s({r:l,g:c,b:u,a:d}=e.white){return`rgba(${l*255}, ${c*255}, ${u*255}, ${d})`}e.toStyle=s})(ii||(ii={}));var HM;(e=>e.identity={position:[0,0,0],rotation:[0,0,0],scale:[1,1,1]})(HM||(HM={}));var WL;(e=>e.defaultData={mass:1,stiffness:80,damping:10,velocity:0})(WL||(WL={}));var GL;(e=>e.defaultData={control1:[.5,0],control2:[.5,1]})(GL||(GL={}));var iu;(e=>(e.linear=[0,0,1,1],e.ease=[.25,.1,.25,1],e.easeIn=[.42,0,1,1],e.easeOut=[0,0,.58,1],e.easeInOut=[.42,0,.58,1]))(iu||(iu={}));function $L(e){return typeof e=="string"&&e.length===36?/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e):!1}var gh;(e=>{e.all=["PerspectiveCamera","OrthographicCamera"];function t(r){return e.all.includes(r)}e.is=t})(gh||(gh={}));var jp;(e=>{e.DefaultUp=[0,1,0],e.DefaultTargetOffset=1e3,e.defaultData={far:1e5,type:"OrthographicCamera",perspective:{near:70,fov:45,zoom:1},orthographic:{near:-1e5,zoom:1},up:e.DefaultUp,isUpVectorFlipped:!1,targetOffset:e.DefaultTargetOffset};function t(r){var i,n;return r.type==="PerspectiveCamera"?((i=r.perspective)==null?void 0:i.zoom)??1:((n=r.orthographic)==null?void 0:n.zoom)??1}e.getZoom=t})(jp||(jp={}));var fu;(e=>{function t(i,n=.1){return{disabled:!1,type:"linear",hideBase:!1,count:3,radial:{radius:Math.max(i[0],i[1])*2,start:0,end:360,alignment:!1,axis:"y",scale:[1,1,1],rotation:[0,0,0],position:[0,0,0]},toObject:{object:"",spreadType:"random",scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],axis:"x",seed:0,count:99,align:"normal"},linear:{scale:[1,1,1],rotation:[0,0,0],position:[i[0]+i[0]*n,0,0]},grid:{count:[2,2,2],size:i.map(a=>a*(1+n)),useCenter:!0},randomness:!1,randomnessObject:{strength:100,scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],movement:1,seed:0,freqScale:10,noiseType:"perlin"}}}e.defaultData=t;function r(i,n){let a={...i};if(XH.forEach(o=>{Object.assign(a,{[o]:n[o]??i[o]})}),a.radial={...i.radial},n.radial){let o=i.radial,s=n.radial;KH.forEach(l=>{Object.assign(a.radial,{[l]:s[l]??o[l]})})}if(a.linear={...i.linear},n.linear){let o=i.linear,s=n.linear;QH.forEach(l=>{Object.assign(a.linear,{[l]:s[l]??o[l]})})}if(a.grid={...i.grid},n.grid){let o=i.grid,s=n.grid;ZH.forEach(l=>{Object.assign(a.grid,{[l]:s[l]??o[l]})})}if(a.toObject={...i.toObject},n.toObject){let o=i.toObject,s=n.toObject;JH.forEach(l=>{Object.assign(a.toObject,{[l]:s[l]??o[l]})})}if(a.randomnessObject={...i.randomnessObject},n.randomnessObject){let o=i.randomnessObject,s=n.randomnessObject;eW.forEach(l=>{Object.assign(a.randomnessObject,{[l]:s[l]??o[l]})})}return a}e.merge=r})(fu||(fu={}));var WM;(e=>{e.defaultData={radial:{},linear:{},grid:{},toObject:{},randomnessObject:{}};let t=["radial","linear","grid","toObject","randomnessObject"];function r(i,n){let a=[];i.count!==void 0&&a.push({type:0,path:n,props:{count:i.count}});for(let o of t){let s=i[o];s&&Object.keys(s).length>0&&a.push({type:0,path:[...n,o],props:s})}return a}e.toOps=r})(WM||(WM={}));var XH=["count"],KH=["radius","start","end","position","scale","rotation"],QH=["position","scale","rotation"],ZH=["count","size"],JH=["count","position","scale","rotation"],eW=["strength","scale","rotation","position","movement","seed","freqScale"],GM;(e=>{e.all=["PointLight","SpotLight","DirectionalLight","HemisphereLight"];function t(r){return e.all.includes(r)}e.is=t})(GM||(GM={}));var $M;(e=>{function t(i){return r(i)}e.defaultData=t;function r(i){if(i==="PointLight")return{type:i,color:ii.white,intensity:1,distance:2e3,decay:1,shadows:!0,shadowResolution:1024,shadowRadius:1,penumbraSize:.5,depth:1e5};if(i==="SpotLight")return{type:i,color:ii.white,intensity:1,distance:2e3,decay:1,shadows:!0,penumbra:0,angle:30/180*Math.PI,depth:1e5,penumbraSize:.5,shadowResolution:1024,shadowRadius:1};if(i==="DirectionalLight")return{type:i,color:ii.white,intensity:1,shadows:!0,size:2e3,depth:1e5,penumbraSize:.5,shadowResolution:1024,shadowRadius:1};throw new Error("not implemented")}})($M||($M={}));var d1;(e=>(e.defaultShapeData={type:"PlaneEmitterShape",size:[100,100,100]},e.defaultCollisionData={colliderEntityId:null,collisionBounce:.75},e.defaultData={renderMaterial:{type:"particleMaterial",color:{r:1,g:.2,b:.545,a:1},color2:{r:.945,g:.714,b:.184,a:1},coloring:"gradient",ease:"linearFadeOut",easeSize:"linearFadeOut",transparent:!0,size:[40,40],texture:"pt_default_particle",spriteRotation:[0,0]},birthRatePerSec:50,gravity:1,noiseStrength:0,noiseScale:0,noiseSeed:1,noiseType:"curl",randomRotation:0,randomScale:.2,randomMass:.5,rootObjectType:"instancedMesh",life:1,direction:[0,0,0],directionMode:"axis",speed:10,shape:e.defaultShapeData,autoPlay:!0,emitTimeDelay:0,emitTimeCycle:"infinity",emitTimeDuration:1,...e.defaultCollisionData}))(d1||(d1={}));var Vp;(e=>e.defaultData={enabled:"visibility",fusedBody:!0,rigidBody:"positioned",density:1,pointMass:0,gravityScale:1,friction:.5,damping:0,restitution:.2,colliderType:"convex",enabledRotation:[!0,!0,!0],enabledTranslation:[!0,!0,!0]})(Vp||(Vp={}));var qM;(e=>{e.defaultData={castShadow:!0,receiveShadow:!0};function t(r,i){return r.castShadow===i.castShadow&&r.receiveShadow===i.receiveShadow}e.equals=t})(qM||(qM={}));var YM;(e=>{e.defaultData={flatShading:!1,wireframe:!1,side:0};function t(r,i){return r.flatShading===i.flatShading&&r.side===i.side&&r.wireframe===i.wireframe}e.equals=t})(YM||(YM={}));var XM;(e=>e.defaultData={...YM.defaultData,...qM.defaultData})(XM||(XM={}));var qL;(e=>{function t(r,i){var a,o;let n=[];if("material"in r){let s=typeof r.material=="string"?i.materials[r.material]??((a=i.lib.materials[r.material])==null?void 0:a.asset):r.material;s&&n.push(s)}else if("materials"in r)for(let s of r.materials){let l=typeof s=="string"?i.materials[s]??((o=i.lib.materials[s])==null?void 0:o.asset):s;l&&n.push(l)}return n}e.getMaterialData=t})(qL||(qL={}));var h1;(e=>(e.defaultVideo={data:"",thumb:"/_assets/_videos/catThumb.png",type:"video",name:"Cat video"},e.maxSize=3e7))(h1||(h1={}));var YL;(e=>{function t(r){return r==="texture"||r==="video"||r==="color"||r==="depth"||r==="normal"||r==="gradient"||r==="noise"||r==="fresnel"||r==="rainbow"||r==="toon"||r==="outline"||r==="particle"||r==="transmission"||r==="matcap"||r==="displace"||r==="pattern"||r==="light"}e.is=t})(YL||(YL={}));function MRe(e){return e.type!=="displace"}var XL;(e=>{function t(r){return r==="phong"||r==="toon"||r==="lambert"||r==="physical"}e.is=t})(XL||(XL={}));var tW=["mode","gradientType","noiseType","displacementType","projection","cnormal","crop","axis","side"],ERe=["wrapping","image","video","name","minFilter","magFilter"],On;(e=>{function t(a,o){let{texture:s,...l}=o;if(Object.assign(a,l),s){let c=a.texture;c&&Object.assign(c,s)}}e.patch=t;function r(a,o){return a==="light"&&o?i(o):n(a)}e.defaultData=r;function i(a){let o={mode:0,isMask:!1,visible:!0,bumpMap:void 0,bumpMapIntensity:5,roughnessMap:void 0,alphaOverride:1};switch(a){case"phong":return{...o,category:"phong",specular:{r:.2,g:.2,b:.2},shininess:5,type:"light",visible:!0,mode:0,occlusion:!0,alpha:.6};case"toon":return{...o,category:"toon",specular:{r:.2,g:.2,b:.2},shininess:10,type:"light",alpha:1};case"lambert":return{...o,category:"lambert",emissive:{r:0,g:0,b:0},type:"light",alpha:1,visible:!0,mode:0,occlusion:!0};case"physical":return{...o,category:"physical",roughness:.2,metalness:.2,reflectivity:.2,type:"light",alpha:1,visible:!0,mode:0,occlusion:!0}}}function n(a){let o={alpha:1,mode:0,isMask:!1,visible:!0};switch(a){case"texture":return{...o,type:"texture",size:[128,128],blending:0,axis:"x",side:2,projection:0,texture:{image:"image_0",wrapping:1e3,repeat:[1,1],offset:[0,0],rotation:0,minFilter:1008,magFilter:1006},crop:!1};case"video":return{...o,type:"video",size:[128,128],blending:0,axis:"x",side:2,projection:0,texture:{video:h1.defaultVideo,wrapping:1001,repeat:[1,1],offset:[0,0],rotation:0,minFilter:1008,magFilter:1006},crop:!1};case"color":return{...o,type:"color",color:ea.fromHex(go)};case"depth":return{...o,type:"depth",gradientType:1,smooth:!1,isVector:!0,isWorldSpace:!1,origin:[0,0,0],direction:[1,0,0],colors:[[1,1,1,1],[0,0,0,1]],steps:[0,1],near:50,far:200};case"normal":return{...o,type:"normal",cnormal:[1,1,1]};case"gradient":return{...o,type:"gradient",gradientType:0,smooth:!1,colors:[[0,0,0,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1]],steps:[0,1,1,1,1,1,1,1,1,1],num:2,angle:0,offset:[0,0],morph:[0,0]};case"noise":return{...o,type:"noise",size:[100,100,100],noiseType:0,scale:1,move:1,colorA:{...ea.fromHex(6710886),a:1},colorB:{...ea.fromHex(6710886),a:1},colorC:{...ea.fromHex(16777215),a:1},colorD:{...ea.fromHex(16777215),a:1},distortion:[1,1],fA:[1.7,9.2],fB:[8.3,2.8],voronoiStyle:0,highCut:1,lowCut:0,smoothness:.3,seed:0,quality:1};case"fresnel":return{...o,type:"fresnel",color:ii.fromHexAndA(16777215,1),bias:.1,scale:1,intensity:2,factor:1};case"rainbow":return{...o,type:"rainbow",filmThickness:30,movement:0,wavelengths:[0,0,0],noiseStrength:0,noiseScale:1,offset:[0,0,0]};case"toon":return{...o,type:"toon",positioning:2,colors:[[0,0,0,1],[.5,.5,.5,1],[.5,.5,.5,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1]],steps:[0,.475,.525,1,1,1,1,1,1,1],num:4,source:[0,1e3,0],isWorldSpace:!0,noiseStrength:0,noiseScale:1,shadowColor:ii.fromHexAndA(0,0),offset:[0,0,0]};case"outline":return{...o,type:"outline",outlineColor:ii.fromHexAndA(0,1),contourColor:ii.fromHexAndA(0,1),outlineWidth:2,contourWidth:5,outlineThreshold:.4,contourThreshold:0,outlineSmoothing:0,contourFrequency:10,contourDirection:[0,1,0],positionalLines:!1,compensation:!0};case"matcap":return{...o,type:"matcap",texture:{image:"matcap_0",wrapping:1001,repeat:[1,1],offset:[0,0],rotation:0,minFilter:1008,magFilter:1006}};case"transmission":return{...o,type:"transmission",thickness:10,ior:1.5,roughness:1};case"displace":return{visible:!0,type:"displace",displacementType:"noise",noiseType:0,scale:10,movement:1,offset:[0,0,0],intensity:8,voronoiStyle:0,smoothness:.3,seed:0,highCut:1,lowCut:0,quality:1};case"pattern":return{...o,type:"pattern",style:0,projection:0,axis:"y",blending:0,offset:[0,0],colorA:{...ea.fromHex(0),a:1},colorB:{...ea.fromHex(16777215),a:1},frequency:[10,10],size:.5,variation:0,smoothness:.5,zigzag:0,rotation:0,vertical:[0,1],horizontal:[0,1],sides:6}}}})(On||(On={}));var ia;(e=>{function t(u){return!u.layers.some(d=>d.data.type==="texture"&&d.data.projection!==0||d.data.type==="depth"&&!d.data.isWorldSpace||d.data.type==="noise"||d.data.type==="displace")}e.isMergable=t;function r(u){let d="";return u.layers.forEach(h=>{Object.entries(h.data).forEach(([f,p])=>{d+=`${f}${p}`,Array.isArray(p)?p.forEach(v=>d+=`${v}`):typeof p=="object"?Object.values(p).forEach(v=>{typeof v=="number"?d+=`${v.toFixed(4)}`:d+=`${v}`}):d+=`${p}`})}),d}e.getHash=r;function i(){return{layers:new Dt}}e.defaultEmptyData=i;function n(u="layer1",d="layer2"){return o("phong",u,d)}e.defaultData=n;function a(u,d){return{...u,name:d}}e.withName=a;function o(u,d="layer1",h="layer2"){let f=new Dt;return f.push({fi:0,data:On.defaultData("light",u),id:d}),f.push({fi:1,data:On.defaultData("color"),id:h}),{layers:f}}e.defaultTwoLayerData=o;function s(u){let d=On.defaultData("texture");u&&Object.assign(d.texture,{image:u});let h=new Dt;return h.push({fi:0,data:d,id:"layer1"}),h.push({fi:1,data:{...On.defaultData("transmission"),alpha:1},id:"layer2"}),h.push({fi:2,data:{...On.defaultData("light","lambert"),alpha:0},id:"layer3"}),{layers:h}}e.defaultUIObjectMaterial=s;function l(u,d="phong",h="layer1",f="layer2"){let p=On.defaultData("texture");Object.assign(p.texture,{image:u});let v=new Dt;return v.push({fi:0,data:p,id:h}),v.push({fi:1,data:On.defaultData("light",d),id:f}),{layers:v}}e.defaultTwoLayerTextureData=l;function c(u,d="phong",h="layer1",f="layer2"){let p=On.defaultData("video");Object.assign(p.texture,{video:u});let v=new Dt;return v.push({fi:0,data:p,id:h}),v.push({fi:1,data:On.defaultData("light",d),id:f}),{layers:v}}e.defaultTwoLayerVideoTextureData=c})(ia||(ia={}));var f1;(e=>{function t(){return{points:new Dt,roundness:0,shapeHoles:[],isClosed:!1}}e.defaultData=t})(f1||(f1={}));var p1;(e=>{function t(){return{points:new Dt,lastInsertionPlane:null,subdivisions:12,isClosed:!1}}e.defaultData=t})(p1||(p1={}));var rW={type:"Ellipse",width:50,height:50,spikes:16,angle:360,innerRadius:0},KM;(e=>{function t(r,i){let n={...r};return nW.forEach(a=>{Object.assign(n,{[a]:i[a]??r[a]})}),n}e.merge=t})(KM||(KM={}));var iW={shape:rW,depth:1,offset:0,bevel:50,bevelSides:6,angle:0,twist:0,startScale:1,endScale:1,capType:"flat"},nW=["depth","offset","angle","twist","startScale","endScale"],m1;(e=>{function t(i){return i==="PolygonGeometry"||i==="RectangleGeometry"||i==="StarGeometry"||i==="TriangleGeometry"||i==="EllipseGeometry"||i==="UIGeometry"}e.is2DParametricMesh=t;function r(i){return i==="PolygonGeometry"||i==="PolygonGeometry"||i==="RectangleGeometry"||i==="StarGeometry"||i==="TriangleGeometry"||i==="EllipseGeometry"||i==="PathGeometry"||i==="VectorGeometry"||i==="ConeGeometry"||i==="CubeGeometry"||i==="CylinderGeometry"||i==="DodecahedronGeometry"||i==="HelixGeometry"||i==="IcosahedronGeometry"||i==="LatheGeometry"||i==="PyramidGeometry"||i==="SphereGeometry"||i==="PlaneGeometry"||i==="BackdropGeometry"||i==="TorusGeometry"||i==="TorusKnotGeometry"||i==="BooleanGeometry"||i==="TextGeometry"||i==="InputGeometry"}e.isParametricMesh=r})(m1||(m1={}));var QM;(e=>{function t(r,i){let n={...r};return Object.assign(n,i),n.type==="PathGeometry"&&"extrusion"in i&&i.extrusion&&(n.extrusion={...r.extrusion},Object.assign(n.extrusion,KM.merge(n.extrusion,i.extrusion))),n}e.merge=t})(QM||(QM={}));var kd;(e=>{function t(r){if(r==="RectangleGeometry")return{width:320,height:320,type:r,cornerRadius:[0,0,0,0],cornerType:0,depth:0,extrudeBevelSize:0,extrudeBevelSegments:1};if(r==="UIGeometry")return{type:r,frame:"",cornerRadius:[0,0,0,0],cornerType:0,width:1,height:1};if(r==="PathGeometry")return{type:r,width:1,height:1,depth:1,path:p1.defaultData(),extrusion:iW};if(r==="VectorGeometry")return{width:1,height:1,type:r,subdivisions:12,shape:f1.defaultData(),depth:0,extrudeBevelSize:0,extrudeBevelSegments:1};if(r==="BooleanGeometry")return{type:r,operation:2,width:0,height:0,depth:0,phongAngle:35};if(r==="TextGeometry")return{type:r,width:100,height:100,depth:0,horizontalAlign:1,verticalAlign:1,fontSize:16,lineHeight:1.2,letterSpacing:0,text:{textValue:""},textTransform:1,font:"Roboto_regular",editable:!1,extrudeBevelSize:0,extrudeBevelSegments:1};if(r==="InputGeometry")return{...e.defaultData("TextGeometry"),type:r,editable:!0};if(r==="SphereGeometry")return{type:"SphereGeometry",width:100,height:100,depth:100,widthSegments:64,heightSegments:64,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:180};throw new Error("not implemented")}e.defaultData=t})(kd||(kd={}));var KL=["width","height","depth"],ZM;(e=>e.defaultData={enabled:!1,useBackgroundColor:!1,color:ea.white,near:.1,far:2e3})(ZM||(ZM={}));var v1;(e=>{let t={opacity:1,blendFunction:13,enabled:!1};e.defaultData={enabled:!1,pixelation:{...t,blendFunction:16,granularity:15},bloom:{...t,blendFunction:16,intensity:1,blurScale:1,luminanceThreshold:.25,luminanceSmoothing:.025,kernelSize:3},chromaticAberration:{...t,offset:[2,2]},vignette:{...t,darkness:1,offset:0},hueSaturation:{...t,hue:3,saturation:0},brightnessContrast:{...t,brightness:.25,contrast:0},depthOfField:{...t,focusDistance:100,focalLength:20,bokehScale:5},noise:{...t,blendFunction:16}}})(v1||(v1={}));var JM;(e=>e.defaultData={softShadowQuality:"low"})(JM||(JM={}));var eE;(e=>e.defaultData={enabled:!0,color:{r:.8274509803921568,g:.8274509803921568,b:.8274509803921568},intensity:.75})(eE||(eE={}));var tE;(e=>e.defaultData={occlusion:!1,aoFullRes:!1,radius:256,bias:.5,aoColor:{r:.19607843137254902,g:.19607843137254902,b:.19607843137254902}})(tE||(tE={}));var Hp;(e=>e.defaultData={usePhysics:!1,gravity:-10})(Hp||(Hp={}));var rE;(e=>e.defaultData={playCamera:gm,gameControlObject:null})(rE||(rE={}));var iE;(e=>e.defaultData={backgroundColor:ii.fromHexAndA(ARe,1),postprocessing:v1.defaultData,fog:ZM.defaultData,globalPhysics:Hp.defaultData,ambient:eE.defaultData,ao:tE.defaultData,shadow:JM.defaultData,publish:rE.defaultData})(iE||(iE={}));var nE;(e=>e.defaultData={colliderType:"box",size:[100,100,100],colliderHelperVisible:!0,forceType:"collider",forceRange:"global",forceIntensity:.5,forceDambing:.95})(nE||(nE={}));var QL;(e=>{function t(i){return i==="Component"||i==="Instance"}e.isComponentRelated=t;function r(i){return i==="Empty"||i==="Instance"}e.isEmptyOrComponent=r})(QL||(QL={}));var Wp;(e=>{e.identity={...HM.identity,hiddenMatrix:Up.identity};function t(n){return{position:n.position,rotation:n.rotation,scale:n.scale,hiddenMatrix:n.hiddenMatrix}}e.fromObject=t;function r(n,a){return{position:(a==null?void 0:a.position)||n.position,rotation:(a==null?void 0:a.rotation)||n.rotation,scale:(a==null?void 0:a.scale)||n.scale,hiddenMatrix:(a==null?void 0:a.hiddenMatrix)||n.hiddenMatrix}}e.merge=r;function i(n,a){return xH({position:th.isEqual(n.position,a.position)?void 0:a.position,rotation:th.isEqual(n.rotation,a.rotation)?void 0:a.rotation,scale:th.isEqual(n.scale,a.scale)?null:a.scale,hiddenMatrix:Up.isEqual(n.hiddenMatrix,a.hiddenMatrix)?void 0:a.hiddenMatrix})}e.diff=i})(Wp||(Wp={}));var Un;(e=>e.defaultData={states:new Dt,events:new Dt,visible:!0,raycastLock:!1,physics:Vp.defaultData,pathSnapping:{pathId:null,slide:0,offset:0,orientation:"tangential"},...Wp.identity,cloner:null})(Un||(Un={}));var aE;(e=>e.defaultData={type:"Empty",...Un.defaultData})(aE||(aE={}));var ZL;(e=>e.defaultData={type:"ParticleCollider",...nE.defaultData,...Un.defaultData})(ZL||(ZL={}));var JL;(e=>e.defaultData={type:"Component",...Un.defaultData})(JL||(JL={}));var eB;(e=>e.defaultData={type:"Particle",...Un.defaultData,...d1.defaultData})(eB||(eB={}));var Ld;(e=>e.defaultData={type:"Mesh",...Un.defaultData,...XM.defaultData})(Ld||(Ld={}));var Ng;(e=>e.defaultData={...Un.defaultData,...Wp.identity,position:[0,0,jp.DefaultTargetOffset],...jp.defaultData})(Ng||(Ng={}));var oE;(e=>{function t(r){return{...Un.defaultData,...$M.defaultData(r)}}e.defaultData=t,e.defaultDirectionalLightData={...e.defaultData("DirectionalLight"),position:[200,300,300],name:"Directional Light",intensity:.7}})(oE||(oE={}));var g1;(e=>{function t(i,n,a=0){for(;a<n.length;){let o=i?i[n[a]]:void 0;if(n.length===a+1)return o;if(o)i=o.descendants,a+=1;else return}}e.resolveWithDes=t;function r(i,n,a=0){let o=t(i,n,a);if(o){let s=Object.keys(o);if(s.length===1&&s[0]==="descendants")return}return o}e.resolve=r})(g1||(g1={}));var pu;(e=>{e.rootOverrideProps=["physics","events"],e.compositeNonOptionalOverrideProps=["geometry"],e.compositeEntireOverrideOverrideProps=["material"];function t(i,n){return{...Un.defaultData,...n,component:i,overrides:new dn,physics:void 0,events:void 0,type:"Instance"}}e.ofComponent=t;function r(i){let n=Wp.fromObject(i.data);return t(i.id,n)}e.fromComponentData=r})(pu||(pu={}));var Gp;(e=>{e.defaultData={type:"Page",...Un.defaultData,physics:{...Vp.defaultData,fusedBody:!1},...iE.defaultData,camera:Ng.defaultData};function t(r){return r.uiScene!==void 0}e.isUIPage=t})(Gp||(Gp={}));var sE;(e=>(e.defaultCamera={position:[0,0,1e3],scale:[1,1,1],rotation:[0,0,0],hiddenMatrix:Up.identity,name:"Play Camera",visible:!0,raycastLock:!1,physics:Vp.defaultData,states:new Dt,events:new Dt,cloner:null,pathSnapping:{pathId:null,orientation:"tangential",slide:0,offset:0},...jp.defaultData},e.KeysByResetCategory={States:["states"],Events:["events"],Material:["material","materials"],Geometry:["geometry"],Position:["position"],Rotation:["rotation"],Scale:["scale"],Transform:["position","scale","rotation","hiddenMatrix"],Name:["name"],Visibility:["visible","raycastLock","flatShading","wireframe","side"],Shadows:["castShadow","receiveShadow"],Cloner:["cloner"],Physics:["physics"]},e.defaultMeshObject={name:"Rectangle",...Un.defaultData,...Ld.defaultData,geometry:kd.defaultData("RectangleGeometry"),material:ia.defaultTwoLayerData("phong","layer1","layer2")},e.defaultBooleanObject={name:"Boolean",...Un.defaultData,...Ld.defaultData,geometry:kd.defaultData("BooleanGeometry"),material:ia.defaultTwoLayerData("phong","layer1","layer2")},e.defaultTextObject={name:"Text",...Un.defaultData,...Ld.defaultData,geometry:kd.defaultData("TextGeometry"),material:ia.defaultTwoLayerData("phong","layer1","layer2")},e.defaultInputObject={name:"Input",...Un.defaultData,...Ld.defaultData,geometry:kd.defaultData("InputGeometry"),material:ia.defaultTwoLayerData("phong","layer1","layer2")}))(sE||(sE={}));var Bd;(e=>{function t(a,o){let s={name:o};return a.type==="Mesh"?(s.geometry={},"material"in a&&(s.material={layers:new dn}),"materials"in a&&(s.materials=a.materials.map(l=>({layers:new dn})))):gh.is(a.type)&&(s.perspective={},s.orthographic={}),s}e.newEmpty=t;function r(a,o){if(o===void 0)return a;let s={...a};return"material"in s&&"material"in o&&o.material&&(s.material=Fg(s.material,l=>{if(typeof l!="string")for(let[c,u]of Object.entries(o.material.layers)){let d=l.layers.data(c);d&&On.patch(d,u)}}).data),s.materials&&o.materials&&(s.materials=Fg(s.materials,l=>{var c,u;for(let d=0;d<s.materials.length;d++){let h=o.materials[d];if(typeof h!="string")for(let[f,p]of Object.entries(h.layers)){let v=(u=(c=l[d])==null?void 0:c.layers)==null?void 0:u.data(f);v&&On.patch(v,p)}}}).data),s}function i(a,o){let s,l=[],c={orthographic:0,perspective:0,geometry:0};function u(d,h){for(let[f,p]of Object.entries(h.layers)){let{texture:v,...m}=p;if(v!==void 0&&Object.keys(v).length>0){let g={path:[...d,"layers",f,"texture"],props:v,type:0};l.push(g)}if(Object.keys(m).length>0){let g={path:[...d,"layers",f],props:m,type:0};l.push(g)}}}for(let[d,h]of Object.entries(o))if(d!=="name")if(d==="cloner")l.push(...WM.toOps(h,["cloner"]));else if(d==="pathSnapping")l.push({path:[d],props:{slide:h.slide,offset:h.offset},type:0});else if(d==="material")u(["material"],h);else if(d==="materials")for(let[f,p]of Object.entries(h))u(["materials",f],p);else if(c[d]===0){if(d==="geometry"&&h.extrusion!==void 0){let f={path:[d,"extrusion"],props:h.extrusion,type:0};l.push(f),h={...h},delete h.extrusion}if(Object.keys(h).length>0){let f={path:[d],props:h,type:0};l.push(f)}}else s===void 0&&(s={path:[],props:{},type:0},l.push(s)),s.props[d]=h;return l}e.toOps=i;function n(a,o){var l,c,u,d,h,f;if(o===void 0)return a;let s={...a};if(Object.assign(s,Wp.merge(s,o)),Object.assign(s,{pathSnapping:Object.assign({},s.pathSnapping,{slide:((l=o.pathSnapping)==null?void 0:l.slide)??((c=s.pathSnapping)==null?void 0:c.slide)??0,offset:((u=o.pathSnapping)==null?void 0:u.offset)??((d=s.pathSnapping)==null?void 0:d.offset)??0})}),gh.is(a.type)){s.orthographic={...s.orthographic},s.perspective={...s.perspective};let p=o;((h=p.orthographic)==null?void 0:h.zoom)!==void 0&&(s.orthographic.zoom=p.orthographic.zoom),((f=p.perspective)==null?void 0:f.zoom)!==void 0&&(s.perspective.zoom=p.perspective.zoom),p.isUpVectorFlipped!==void 0&&(s.isUpVectorFlipped=p.isUpVectorFlipped),p.targetOffset!==void 0&&(s.targetOffset=p.targetOffset)}else if(a.type==="Mesh")"geometry"in o&&Object.assign(s,{geometry:QM.merge(s.geometry,o.geometry)}),(o.material||o.materials)&&(s=r(s,o)),s.cloner&&"cloner"in o&&Object.assign(s,{cloner:fu.merge(s.cloner,o.cloner)});else if(a.type==="Empty")s.cloner&&"cloner"in o&&Object.assign(s,{cloner:fu.merge(s.cloner,o.cloner)});else if(GM.is(a.type)){let p=o;p.intensity!==void 0&&(s.intensity=p.intensity),p.color!==void 0&&(typeof p.color=="string"?s.color=p.color:s.color=ea.clone(p.color))}return s}e.patch=n})(Bd||(Bd={}));var y1;(e=>e.defaultData={enablePan:!0,enableZoom:!0,enableRotate:!0,enableDamping:!0,rotationLimitsMode:0,rotationVerticalOffset:{min:Math.PI/4,max:Math.PI/4},rotationHorizontalOffset:{min:Math.PI/4,max:Math.PI/4},rotationSoftLimit:2,panLimitsMode:0,panVerticalOffset:{min:250,max:250},panHorizontalOffset:{min:250,max:250},panSoftLimit:2,zoomLimitsEnabled:!1,zoomLimits:{min:.1,max:2},autoRotate:!1,autoRotateSpeed:2,autoRotateClockwise:!0,hoverRotatePanMode:0,hoverRotatePanStrength:20,hoverRotateDamping:.125,isTouchZoom:!0,orbitTouches:2,panTouches:3,resetHoverEffectOnPointerLeave:!0})(y1||(y1={}));var mu;(e=>e.defaultData={orbitControls:y1.defaultData,playPage:Yv,withBackground:!0,preventScroll:!1,preventTouchScroll:!1,hideCursor:!1,mouseEventTarget:"canvas",joystickSizeAndXYOffset:Array(12).fill(0).map((t,r)=>{let i=0,n=0;return r<5?n=-30:r<10&&(n=30),r===0||r===10||r===5?i=30:(r===4||r===11||r===9)&&(i=-30),[120,[i,n],"show"]}),settings:{image:{format:"jpg",ratio:1},video:{format:"mp4",imageFormat:"jpg",fps:30,mbps:80,ratio:Math.max(1,typeof window<"u"?Math.floor(window.devicePixelRatio):1),stopMode:"manual",duration:5e3},web:{logo:!0,compress:!0,preset:1,preload:!0,hint:!1,imageQuality:70}},stopRaycast:!0,hdTransmission:!1})(mu||(mu={}));var lE;(e=>e.defaultData={id:"basic",label:"Basic",style:"None",prompt:""})(lE||(lE={}));var cE;(e=>e.defaultData={weather:0,shadows:0,lightOrigin:0,temperature:0,sun:0,camera:0,environment:0,particles:0,nature:0,floor:0})(cE||(cE={}));var Fd;(e=>(e.defaultData=()=>({mode:"line-art-both",prompt:"",negativePrompt:"",style:{...lE.defaultData},isRandomSeed:!0,seed:e.generateSeed(),guessMode:!1,advanced:!1,steps:20,guidanceScale:7.5,controlNetScale:1,modifiers:cE.defaultData}),e.generateSeed=()=>Math.round(Math.random()*1e5)))(Fd||(Fd={}));var Ug;(e=>{function t(i){return i.find(n=>n.data.type==="Page"&&n.data.globalPhysics.usePhysics)!==void 0}e.physicsEnabled=t;function r(i,n,a){i.scene.objects.traverseFrom(n,(o,s)=>{var l;if(s.type==="Instance"){let c=(l=w1.getComponentData(i,s.component))==null?void 0:l.data;c&&a(o,s,c.events)}else a(o,s,s.events)})}e.traverseModuleInstances=r})(Ug||(Ug={}));var Nd;(e=>{e.TRASH_CAN_ID="830a2708-8ed9-49cf-a68e-085299892222",e.defaultLight={fi:-1,data:oE.defaultDirectionalLightData,id:"830a2708-8ed9-49cf-a68e-085299899103",children:[]};function t(n=!0,a=[]){let o=[],s=sE.defaultMeshObject;n&&(o.push({...e.defaultLight}),o.push({fi:1,id:"7ba78968-2a55-48f2-b14c-5191da3e075e",data:s,children:[]})),o.push(...a);let l=new ra;return l.push({fi:1,id:Yv,data:{...Gp.defaultData,name:"Scene 1"},children:o}),l}e.createDefaultObjectTreeWithPage=t,e.defaultData={objects:t(),publish:mu.defaultData,styles:Fd.defaultData()},e.emptyDataWithoutPage=function(){return{objects:new ra,publish:mu.defaultData,styles:Fd.defaultData()}},e.emptyDataWithPage=function(n=!0){return{objects:t(n),publish:mu.defaultData,styles:Fd.defaultData()}},e.emptyData=function(){return{objects:new ra,publish:{...mu.defaultData},styles:Fd.defaultData()}};function r(n){return{...e.defaultData,objects:$o(n,ra.prototype)}}e.withObjs=r;function i(n,a){return r([{id:n,data:a,children:[],fi:0}])}e.withObj=i})(Nd||(Nd={}));var Xv;(e=>e.defaultData={preset:"fullscreen",allowResponsive:!1,size:[512,512],coords:[0,0],sceneScale:1,color:{r:0,g:0,b:0,a:.5}})(Xv||(Xv={}));var uE;(e=>(e.defaultData=t=>({url:t,name:"New Webhook",parametersSchemas:new Dt}),e.defaultParameterValueByType=t=>t==="number"?0:t==="boolean"?!1:""))(uE||(uE={}));var tB;(e=>e.defaultData=(t,r="GET")=>({url:t,method:r,name:"New API",headers:new Dt,queries:new Dt,autoStart:!0}))(tB||(tB={}));var na;(e=>{function t(o){return o.textValue!==void 0}e.isTextValue=t;function r(o){return typeof o=="number"}e.isNumber=r;function i(o){return typeof o=="boolean"}e.isBoolean=i;function n(o){return t(o)?"string":i(o)?"boolean":"number"}e.typeOfVariable=n;function a(o){return e.isTextValue(o)?Array.isArray(o.textValue)?o.textValue.map(s=>s.toString().padStart(o.padding??2,"0")).join(o.deliminator??":")+(o.suffix!==void 0?" "+o.suffix:""):o.textValue.toString():e.isBoolean(o)?o?"True":"False":e.isNumber(o)?parseFloat(o.toFixed(3)).toString():o.toString()}e.getDisplayedValue=a})(na||(na={}));var dE;(e=>e.all=["images","videos","colors","audios","particles","fonts","materials","variables"])(dE||(dE={}));var rB;(e=>e.all=[...dE.all,"components"])(rB||(rB={}));var iB;(e=>{function t(){return{images:new Lt,videos:new Lt,colors:new Lt,audios:new Lt,particles:new Lt,fonts:new Lt,materials:new Lt,components:new Lt,variables:new Lt,userAPIs:new Lt,userWebhooks:new Lt}}e.defaultData=t})(iB||(iB={}));var mc;(e=>{function t(){return{images:new Lt,videos:new Lt,colors:new Lt,audios:new Lt,particles:new Lt,fonts:new Lt,materials:new Lt,components:new Lt,variables:new Lt,userAPIs:new Lt,userWebhooks:new Lt}}e.defaultData=t})(mc||(mc={}));var Oo;(e=>{function t(){let o={};return o["89b10010-844c-11ec-a8a3-0242ac120002"]={r:.5,g:.5,b:.5,a:1,name:"Default Color"},$o(o,Lt.prototype)}e.defaultColors=t;function r(){return $o({},Lt.prototype)}e.defaultImages=r;function i(){return{catelogs:new Lt,materials:new Lt,images:new Lt,videos:new Lt,colors:new Lt,audios:new Lt,particles:new Lt,fonts:new Lt,variables:new Dt,userAPIs:new Lt,userWebhooks:new Lt,lib:mc.defaultData()}}e.emptyData=i;function n(o){switch(o){case"number":return{value:0,name:"Number"};case"boolean":return{value:!1,name:"Boolean"};case"string":return{value:{textValue:"String value"},name:"String"};case"time":let s=[0,0,0];return{name:"Time",value:{textValue:s,deliminator:":",padding:2,suffix:"AM"},dynamicVariableType:"time",format:"HH:mm:ss",format12h24h:"12ampm",timeZone:null,hasEnd:!1,endValue:{textValue:s,deliminator:":",padding:2,suffix:"AM"},autoStart:!0,repeat:!1};case"counter":return{name:"Counter",value:0,dynamicVariableType:"counter",updateInterval:1e3,increment:1,autoStart:!0,hasEnd:!0,endValue:60,repeat:!0,randomStart:!1,range:[0,100],decimals:0};case"random":return{name:"Random",value:0,dynamicVariableType:"random",updateInterval:1e3,increment:1,autoStart:!0,isStatic:!1,hasEnd:!0,endValue:60,repeat:!0,min:0,max:100,decimals:0};default:console.error("Unknown variable type",o)}}e.defaultVariables=n;function a(o,s){if(s.format==="HH:mm:ss"){let l=Math.floor(o/3600),c=Math.floor((o-l*3600)/60),u=Math.round(o-l*3600-c*60);return{textValue:[l,c,u]}}else if(s.format==="mm:ss"){let l=Math.floor(o/60),c=Math.round(o-l*60);return{textValue:[l,c]}}else return s.format==="number"?o=Math.round(o):o=Math.round(o*1e3)/1e3,o}e.getFormattedTimerTime=a})(Oo||(Oo={}));var b1;(e=>e.list=["idle","move","jump","run"])(b1||(b1={}));var x1;(e=>(e.defaultColliderData={type:"capsule",height:200,radius:50,position:[0,0,0],rotation:[0,0,0]},e.defaultDataThirdPerson={moveMode:"walk",forwardDirection:"+z",speedTranslate:1e3,speedRotate:100,runMultiplier:2,rotationMode:"normal",rotBy:"keys",rotByTouch:"drag",delayPos:[.3,.3],delayRot:[.3,.3],keyAssignments:[["moveNegZ","W"],["moveNegX","A"],["movePosZ","S"],["movePosX","D"],["rotPosX",""],["rotPosY",""],["rotNegX",""],["rotNegY",""],["jump","Space"],["run",""],["none","Ctrl"]],touchControl:!0,joystickPosLoc:5,joystickRotLoc:11,jumpTouchButtonLoc:9,collider:e.defaultColliderData,colliderHelperVisible:!0,collisionEnabled:!0,jumpPower:100,resetYPosition:3e3,alignToGround:!1,autoOrientMove:!0,orientWith:"camera",orientMode:"radial",delayPosCamera:.3,delayRotCamera:.3,camera:"",cameraXAxis:"Limit",cameraYAxis:"Free",cameraRotXLimits:[0,Math.PI/2],cameraRotYLimits:[-Math.PI/2,Math.PI/2],gameActions:{idle:new Dt,move:new Dt,jump:new Dt,run:new Dt},navmesh:{enabled:!1,ch:6,cs:6,walkableClimb:5,walkableHeight:1,walkableRadius:0,zones:"all",objects:[],helperVisible:!0,destinationHelperRadius:0,destinationHelperColor:ii.fromHexAndA(3728051,1)}}))(x1||(x1={}));function nB(e){e.layers.forEach(t=>{if(t.type==="depth"&&t.colorA!==void 0){let r=t.colorA,i=t.colorB,n=[[r.r,r.g,r.b,r.a],[i.r,i.g,i.b,i.a]],a=[0,1];for(let s=2;s<10;s++)n.push(n[1]),a.push(1);let o={...ac(Yi(t),"type","visible","isVector","isWorldSpace","origin","alpha","mode"),near:Math.max(0,t.near),far:Math.max(0,t.far),colors:n,steps:a,num:2,direction:[1,0,0],smooth:!1,gradientType:1};Object.assign(t,o)}else if(t.type==="depth"&&t.gradientType===1&&(t.near<0||t.far<0)){let r={...Yi(t),near:Math.max(t.near,0),far:Math.max(t.far,0)};Object.assign(t,r)}})}function su(e,t){Object.values(e.shared.materials).forEach(r=>t(r))}function lu(e,t){e.scene.objects.traverse((r,i)=>{"materials"in i?i.materials.forEach((n,a)=>{n===void 0&&(i.materials[a]=ia.defaultData(),n=i.materials[a]),typeof n!="string"&&t(n)}):"material"in i?typeof i.material!="string"&&(i.material===void 0&&(i.material=ia.defaultData()),t(i.material)):i.type==="Mesh"&&(i.material===void 0&&(i.material=ia.defaultData()),t(i.material)),"overrides"in i&&Object.values(i.overrides).forEach(n=>{n.material&&typeof n.material!="string"&&Object.getPrototypeOf(n.material)!==dn.prototype&&t(n.material)})})}function TRe(e){Object.assign(e.scene.publish,{orbitControls:{...y1.defaultData,...Yi(e.scene.publish.orbitControls)}})}function PRe(e){Object.assign(e.scene.publish.settings,{video:{...mu.defaultData.settings.video,...Yi(e.scene.publish.settings.video)}})}function DRe(e){function t(r){if(r.layers){for(let i of Object.values(r.layers))if(i){for(let[n,a]of Object.entries(i))if((tW.includes(n)||typeof a=="boolean")&&delete i[n],n==="texture")for(let[o,s]of Object.entries(a))(ERe.includes(o)||typeof s=="boolean")&&delete a[o]}}}e.scene.objects.traverse((r,i)=>{i.states.forEach(n=>{let a=n;a.material?t(a.material):a.materials&&a.materials.forEach(o=>{t(o)})})})}function ORe(e){e.scene.publish.withBackground=!0}function RRe(e){e.scene.publish.settings.web={compress:!0,preload:!0,preset:1,logo:!0,hint:!1}}function IRe(e){e.scene.objects.traverse((t,r)=>{let i=r.cloner;i&&(i.radial.scale=i.radial.scale.map(n=>n+1),i.linear.scale=i.linear.scale.map(n=>n+1))})}function zRe(e){e.scene.objects.traverse((t,r)=>{let i=r.geometry;i&&(i.type==="DodecahedronGeometry"||i.type==="IcosahedronGeometry")&&(i.detail=Math.round(i.detail))})}function kRe(e){e.scene.objects.traverse((t,r)=>{let i=e.scene.objects.unproxy().parent(t);if(i){let n=Yi(e.scene.objects.data(i));n&&n.type==="Mesh"&&n.geometry.type==="BooleanGeometry"&&r.type==="Mesh"&&(r.visible=Yi(r).booleanExclude!==!0)}})}function LRe(e){e.scene.objects.traverse((t,r)=>{if(r.type==="Mesh"){let i=r;r.geometry.type==="NonParametricGeometry"?i.material!==void 0&&delete i.material:i.materials!==void 0&&delete i.materials}})}function BRe(e){function t(i){Object.setPrototypeOf(i,dn.prototype),i.texture&&Object.setPrototypeOf(i.texture,dn.prototype)}function r(i){Object.setPrototypeOf(i,dn.prototype);for(let n in i)t(i[n])}e.scene.objects.traverse((i,n)=>{n.states.forEach(a=>{let o=a;if(o.material){let s=Yi(o.material).layers;r(s),o.material.layers=s}if(o.materials)for(let s=0;s<o.materials.length;s++){let l=o.materials[s],c=Yi(l).layers;r(c),l.layers=c}})})}function aB(e){e.layers===void 0&&Object.assign(e,ia.defaultTwoLayerData("lambert"))}function e_(e){!e.layers||e.layers.forEach(t=>{if(t.type==="depth"&&t.colors.length===10){let r=[...t.colors];r.push(t.colors[9]);let i=[...t.steps];i.push(t.steps[9]);let n={...Yi(t),colors:r,steps:i};Object.assign(t,n)}})}function FRe(e){e.scene.objects.traverse((t,r)=>{r.type==="Mesh"&&(r.geometry.type==="BooleanGeometry"||r.geometry.type==="SubdivGeometry")&&(r.geometry.phongAngle=35)})}function oB(e){e.scene.objects.traverse((t,r)=>{"materials"in r?r.materials.forEach(i=>{typeof i!="string"&&e_(i)}):"material"in r&&typeof r.material!="string"&&e_(r.material)}),Object.values(e.shared.materials).forEach(t=>e_(t))}function NRe(e){e.scene.environment.ambientLight.softShadows=!1,e.scene.environment.ambientLight.softShadowQuality="low",e.scene.objects.traverse((t,r)=>{(r.type==="DirectionalLight"||r.type==="SpotLight")&&(r.shadowResolution=1024,r.shadowRadius=1,r.depth=1e5)}),e.shared.penumbraSize=new Array(5).fill(.5)}function URe(e){e.shared.audios=$o({},Lt.prototype)}function jRe(e){e.shared.videos=$o({},Lt.prototype)}function VRe(e){let t=e.shared.materials;Object.entries(t).forEach(([r,i])=>{if(!i.layers){let n={name:"Untitled Material",layers:[{fi:0,data:{type:"light",category:"phong",alpha:.6,visible:!0,mode:0,specular:{r:.2,g:.2,b:.2},shininess:5},id:"layer1"},{fi:1,data:{type:"color",alpha:1,visible:!0,mode:0,color:{r:.2823529411764706,g:.2823529411764706,b:.30196078431372547}},id:"layer2"}]};Object.assign(t,{[r]:n})}})}function HRe(e){Object.entries(Yi(e.shared.images)).filter(t=>t[1].asset===!1).map(t=>t[0]).forEach(t=>{delete e.shared.images[t]}),Object.entries(Yi(e.shared.audios)).filter(t=>t[1].asset===!1).map(t=>t[0]).forEach(t=>{delete e.shared.audios[t]})}function WRe(e){e.scene.publish.settings.web.preload=!1}function sB(e){e.layers&&e.layers.forEach(t=>{t.type==="depth"&&t.num!==void 0&&(t.colors=t.colors.slice(0,t.num),t.steps=t.steps.slice(0,t.num),delete t.num)})}function lB(e){e.layers&&e.layers.forEach(t=>{MRe(t)&&t.isMask===void 0&&(t.isMask=!1),(t.type==="texture"||t.type==="video")&&t.blending===void 0&&(t.blending=0),(t.type==="noise"||t.type==="displace"&&t.displacementType==="noise")&&(t.voronoiStyle===void 0&&(t.voronoiStyle=0),t.highCut===void 0&&(t.highCut=1),t.lowCut===void 0&&(t.lowCut=0),t.smoothness===void 0&&(t.smoothness=.3),t.seed===void 0&&(t.seed=0),t.quality===void 0&&(t.quality=1))})}function GRe(e){e.shared.fonts=$o({},Lt.prototype)}function $Re(e){return e.replace(".typeface","").replace(/optimer/gi,"open sans").replace("space_mono","space mono").replace(/alma_mono/gi,"varela round").replace(/droid_sans_mono/gi,"noto sans mono").replace(/droid_sans|gentilis|gnomon_(simple|foreground)|helvetiker/gi,"roboto").replace(/droid_serif/gi,"roboto slab").replace("_sans"," sans").replace("crimson_text","crimson text").replace("medium_medium","medium").replace("fatface_fatface","fatface").replace("100hairline","thin").replace("200thin","extralight").replace("300light","light").replace("500medium","medium").replace("600semi","semibold").replace("800heavy","extrabold").replace("900black","black").replace(/bodoni_(11|16|24|36|48|72|96)([^_])/gi,"bodoni_$1_$2").replace(/bodoni_(11|16|24|36|48|72|96)/gi,"bodoni moda").replace(/(thin|hairline)(_regular)?/gi,"100").replace(/(extra|ultra)light(_regular)?/gi,"200").replace(/light(_regular)?/gi,"300").replace(/_book|_normal|_roman/gi,"_regular").replace(/medium(_regular)?/gi,"500").replace(/(semi|demi)bold(_regular)?/gi,"600").replace(/(extra|ultra)bold(_regular)?/gi,"800").replace(/bold(_regular)?/gi,"700").replace(/(black|heavy|fatface)(_regular)?/gi,"900").replace(/([1-9]00)_italic/gi,"$1italic").replace(/regularitalic/gi,"italic").replace(/regularitalic/gi,"italic").split(" ").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" ")}function qRe(e){let t=[];e.scene.objects.traverse((r,i)=>{let n=i;if(n.type==="TextFrame"){let a=ia.defaultTwoLayerData("phong"),o=typeof n.color=="string"?e.shared.colors[n.color]:n.color;a.layers[1].data.color={r:o.r,g:o.g,b:o.b},a.layers[1].data.alpha=n.alpha;let s=$Re(n.font);e.shared.fonts[s]===void 0&&(e.shared.fonts[s]={name:s});let l={name:n.name,...Un.defaultData,...Ld.defaultData,flatShading:!1,wireframe:!1,geometry:{...kd.defaultData("TextGeometry"),width:n.width,height:n.height,font:s,depth:0,horizontalAlign:n.horizontalAlign,verticalAlign:n.verticalAlign,fontSize:n.fontSize*1.40625,lineHeight:n.lineHeight/1.40625,letterSpacing:n.letterSpacing-1,text:n.text,textTransform:n.textTransform,extrudeBevelSize:0,extrudeBevelSegments:1},material:a,states:Yi(n.states),events:Yi(n.events),visible:n.visible,raycastLock:n.raycastLock,position:n.position,rotation:n.rotation,scale:n.scale,hiddenMatrix:n.hiddenMatrix},c=Yi(e.scene.objects).parent(r);e.scene.objects.insertAfter(c??null,r,[{id:r+"new",data:l,children:[]}]),t.push(r)}}),t.forEach(r=>{e.scene.objects.delete(r)})}function YRe(e){let t={0:"MouseDown",1:"MouseUp",2:"MouseHover",5:"KeyDown",6:"KeyUp",7:"Start",9:"LookAt",10:"Follow",11:"Scroll",12:"Audio",13:"GameControl"};e.scene.objects.traverse((r,i)=>{i.events.forEach(n=>{if(t[Number(n.type)])if(Object.assign(n,{type:t[Number(n.type)]}),n.type==="Audio"&&"audioEvent"in n&&(Object.assign(n,{playAudio:n.audioEvent}),delete n.audioEvent),n.type==="GameControl")Object.assign(n,{gameActions:{idle:new Dt,move:new Dt,jump:new Dt}});else{let a=new Dt;Object.assign(n,{actions:a}),(n.type==="MouseDown"||n.type==="MouseUp"||n.type==="KeyDown"||n.type==="KeyUp")&&"url"in n&&a.push({fi:0,id:St.generateUUID(),data:{type:"Link",url:n.url,delay:0}}),"targets"in n&&(n.targets.forEach((o,s,l)=>{let c={state:void 0,repeat:0,delay:0,delayDirection:void 0,direction:"normal",duration:0,easing:4},u={easing:o.easing,duration:o.duration};o.easing===6?Object.assign(u,ac(o,"mass","stiffness","damping","velocity")):o.easing===5&&Object.assign(u,{control1:{...o.control1},control2:{...o.control2}});let d={repeat:o.repeat?-1:0,delay:o.delay,delayDirection:o.delayDirection,direction:o.cycle&&o.rewind?"pingpong-rewind":o.cycle?"pingpong":"normal"},h={state:o.state,...d,...u},f={allowSlerp:!0,type:"Transition",object:o.object,repeat:0,delay:0,delayDirection:void 0,direction:"normal",tweens:new Dt({fi:0,id:St.generateUUID(),data:c},{fi:1,id:St.generateUUID(),data:h})};a.push({fi:l,id:s,data:f})}),delete n.targets)}})})}function XRe(e){e.scene.objects.traverse((t,r)=>{function i(n,a){var l;let o=new Dt,s=[];if(r.events.forEach((c,u,d)=>{if(c.type==="Audio"&&c.trigger===a){let h;s.push(u),c.interaction==="play"?h={...ac(c,"interaction","audio","delay","volume","loop"),triggerAfter:"after"in c?c.after:void 0,toggle:"after"in c?c.toggle:void 0,type:"Audio"}:(c.interaction==="pause"||c.interaction==="stop")&&(h={...ac(c,"interaction","delay","object","playAudio"),type:"Audio"}),h&&o.push({fi:d,id:u,data:h})}}),s.forEach(c=>r.events.delete(c)),o.length){let c=(l=r.events.find(u=>u.type===n))==null?void 0:l.data;c?"actions"in c&&c.actions.insertBefore(null,o):r.events.insertBefore(null,[{id:St.generateUUID(),data:{type:n,actions:o}}])}}i("Start","start"),i("MouseDown","mouseDown"),i("MouseUp","mouseUp"),i("KeyDown","keyDown"),i("KeyUp","keyUp")})}function cB(e){var r;let t=(r=e.layers.find(i=>i.type==="light"))==null?void 0:r.data;if((t==null?void 0:t.category)==="basic"){let i=On.defaultData("light","phong"),n=t;Object.assign(n,i),n.visible=!1}}function uB(e){su(e,cB),lu(e,cB)}function KRe(e){e.scene.objects.traverse((t,r)=>{r.type==="Mesh"&&r.geometry.type==="SubdivGeometry"&&(r.geometry.scaleBaked||(r.geometry.scaleBaked=[1,1,1]))})}function QRe(e){e.scene.objects.traverse((t,r)=>{(r.type==="Empty"||r.type==="Mesh")&&r.cloner&&!r.cloner.randomnessObject&&!r.cloner.toObject&&!r.cloner.randomness&&(r.cloner={...r.cloner,toObject:{object:"",spreadType:"random",scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],axis:"x",seed:0,count:99,align:"normal"},randomness:!1,randomnessObject:{strength:100,scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],movement:1,seed:0,freqScale:10,noiseType:"perlin"}})})}function ZRe(e){e.scene.objects.traverse((t,r)=>{r.type==="Mesh"&&r.geometry.type==="NonParametricGeometry"&&!("material"in r)&&!("materials"in r)&&(r.material=ia.defaultTwoLayerData("phong"))})}function JRe(e){e.scene.publish.orbitControls.autoZoom===void 0&&(e.scene.publish.orbitControls.autoZoom=!1),e.scene.objects.traverse((t,r)=>{(r.type==="OrthographicCamera"||r.type==="PerspectiveCamera")&&(r.orthographic.autoZoom===void 0&&(r.orthographic.autoZoom=!1),r.orthographic.autoZoomFrustumSize===void 0&&(r.orthographic.autoZoomFrustumSize=790))})}function eIe(e){e.scene.objects.traverse((t,r)=>{r.pathSnapping===void 0&&(r.pathSnapping={pathId:null,slide:0,offset:0,orientation:"tangential"}),r.pathSnapping.offset===void 0&&(r.pathSnapping.offset=0)})}function tIe(e){e.scene.publish.mouseEventTarget===void 0&&(e.scene.publish.mouseEventTarget="canvas"),e.scene.publish.settings.web.hint===void 0&&(e.scene.publish.settings.web.hint=!1)}function rIe(e){let{video:t}=e.scene.publish.settings;t.format==="gif"&&t.fps>48&&(t.fps=15)}function iIe(e){e.scene.objects.traverse((t,r)=>{r.events.forEach(i=>{i.type==="GameControl"&&(i.resetYPosition=Math.abs(i.resetYPosition-r.position[1]))})})}function nIe(e){let t=e.scene.environment.usePhysics;e.scene.objects.traverse((r,i)=>{t&&i.physics===null?i.collision=!1:i.collision="visibility"})}function aIe(e){e.scene.objects.traverse((t,r)=>{r.events.forEach(i=>{i.type==="GameControl"&&(i.navmesh=x1.defaultDataThirdPerson.navmesh)})})}function oIe(e){e.scene.styles||(e.scene.styles=Fd.defaultData())}function dB(e){e.layers.forEach(t=>{t.type==="light"&&t.category!=="toon"&&t.occlusion===void 0&&(t.occlusion=!0)})}function sIe(e){e.scene.environment.ambientLight.occlusion===void 0&&(e.scene.environment.ambientLight.occlusion=!1),e.scene.environment.ambientLight.aoFullRes===void 0&&(e.scene.environment.ambientLight.aoFullRes=!1),e.scene.environment.ambientLight.radius===void 0&&(e.scene.environment.ambientLight.radius=256),e.scene.environment.ambientLight.bias===void 0&&(e.scene.environment.ambientLight.bias=.5),e.scene.environment.ambientLight.aoColor===void 0&&(e.scene.environment.ambientLight.aoColor={r:.19607843137254902,g:.19607843137254902,b:.19607843137254902}),lu(e,dB),su(e,dB)}function lIe(e){e.scene.objects.traverse((t,r)=>{r.events.forEach(i=>{i.type==="GameControl"&&Object.assign(i.gameActions,{run:new Dt})})})}function cIe(e){e.scene.objects.traverse((t,r)=>{r.events.forEach(i=>{i.type==="GameControl"&&(i.keyAssignments=[...i.keyAssignments,["run",""],["none","Ctrl"]])})})}function hB(e){e.layers&&e.layers.forEach(t=>{t.type==="light"&&t.bumpMapIntensity===void 0&&(t.bumpMapIntensity=5)})}function uIe(e,t){if(t<1&&(lu(e,nB),su(e,nB),e.schema=1),t<2&&(TRe(e),e.schema=2),t<3&&(DRe(e),e.schema=3),t<4&&(ORe(e),e.schema=4),t<5&&(RRe(e),e.schema=5),t<6&&(IRe(e),e.schema=6),t<7&&(zRe(e),e.schema=7),t<8&&(e.schema=8),t<9&&(oB(e),e.schema=9),t<10&&(FRe(e),e.schema=10),t<11&&(NRe(e),e.schema=11),t<12&&(oB(e),e.schema=12),t<13&&(URe(e),e.schema=13),t<14&&(VRe(e),e.schema=14),t<15&&(HRe(e),e.schema=15),t<16&&(WRe(e),e.schema=16),t<17&&(lu(e,sB),su(e,sB),e.schema=17),t<18&&(lu(e,aB),su(e,aB),e.schema=18),t<19&&(PRe(e),e.schema=19),t<20&&(GRe(e),qRe(e),e.schema=20),t<21&&(YRe(e),XRe(e),e.schema=21),t<22&&(uB(e),e.schema=22),t<23&&(KRe(e),e.schema=23),t<24&&(QRe(e),e.schema=24),(t<25||e.shared.videos===void 0)&&(jRe(e),t<25&&(e.schema=25)),t<26&&(kRe(e),e.schema=26),t<27&&(LRe(e),e.schema=27),t<28&&(uB(e),e.schema=28),t<29&&(BRe(e),e.schema=29),t<30&&(ZRe(e),e.schema=30),t<31&&(JRe(e),e.schema=31),t<33&&(eIe(e),e.schema=33),t<34&&(tIe(e),e.schema=34),t<35&&(rIe(e),e.schema=35),t<36&&(iIe(e),e.schema=36),t<37&&(nIe(e),e.schema=37),t<38&&(lu(e,lB),su(e,lB),e.schema=38),t<39&&(aIe(e),e.schema=39),t<40&&(oIe(e),e.schema=40),t<41&&(sIe(e),e.schema=41),t<42&&(lIe(e),e.schema=42),t<43&&(cIe(e),e.schema=43),t<99){lu(e,hB),su(e,hB),e.scene.publish.playCamera===null&&(e.scene.publish.playCamera=gm);let r=Yi(e.scene.objects),i=e.scene.objects;e.scene.publish.playPage=Yv,i.insertBefore(null,null,[{id:Yv,data:{...Gp.defaultData,backgroundColor:e.scene.backgroundColor,fog:e.scene.fog,postprocessing:e.scene.postprocessing,ao:ac(e.scene.environment.ambientLight,"occlusion","aoFullRes","radius","bias","aoColor"),publish:{playCamera:e.scene.publish.playCamera,gameControlObject:e.scene.publish.gameControlObject},shadow:ac(e.scene.environment.ambientLight,"softShadowQuality"),globalPhysics:{...Hp.defaultData,...ac(e.scene.environment,"usePhysics","gravity")},camera:Yi(e.scene.ownerCamera)??Gp.defaultData.camera,name:"Scene"},children:[]}]);for(let o of r)o.id!==Nd.TRASH_CAN_ID&&i.move(Yv,o.fi,o.id);let n=0,a=0;e.shared.penumbraSize&&e.scene.objects.traverse((o,s)=>{s.type==="DirectionalLight"?(s.penumbraSize=e.shared.penumbraSize[Math.min(n,2)],n+=1):s.type==="SpotLight"&&(s.penumbraSize=e.shared.penumbraSize[3+Math.min(a,1)],a+=1),(s.physics===void 0||s.physics===null)&&s.type!=="Instance"&&(s.physics={},Object.assign(s.physics,Vp.defaultData)),s.physics!==void 0&&s.physics!==null&&(s.physics.enabled=s.collision??"visibility",delete s.collision)}),e.schema=99}}function fB(e){e.layers&&e.layers.forEach(t=>{t.type==="light"&&t.alphaOverride===void 0&&(t.alphaOverride=1)})}function dIe(e){e.scene.objects.traverse((t,r)=>{let i=r.geometry;i&&i.type==="PathGeometry"&&(i.extrusion.capType="flat",i.extrusion.bevel=50,i.extrusion.bevelSides=6,i.extrusion.shape.type==="Custom"&&(i.extrusion.shape.shapeQuality="low"))})}function hIe(e){var t;Array.isArray(Yi(e.events))&&((t=e.events)==null||t.forEach(r=>{"disabled"in r||(r.disabled=!1),(r.type==="MouseDown"||r.type==="MouseUp"||r.type==="MousePress")&&(r.mode=r.mode||"Object")}))}var zf=180/Math.PI;function pB(e){e.rotation=e.rotation.slice(0,3).map(t=>t*zf)}function aW(e){var r,i;pB(e),e.type==="Page"&&pB(e.camera),(r=e.states)==null||r.forEach(n=>{n.rotation===void 0||n.rotation===null||(n.rotation=n.rotation.slice(0,3).map(a=>a*zf))});let t=e.geometry;t&&t.type==="SphereGeometry"&&(t.thetaLength=(t.thetaLength??180)*zf),t&&t.type==="TorusGeometry"&&(t.arc=t.arc*zf),t&&t.type==="PathGeometry"&&(t.extrusion.angle*=zf,t.extrusion.twist*=zf),e.type==="Mesh"&&e.geometry.type==="TextGeometry"&&(e.geometry.text={textValue:e.geometry.text}),Array.isArray(Yi(e.events))&&((i=e.events)==null||i.forEach(n=>{(n.type==="MouseDown"||n.type==="MouseUp"||n.type==="MousePress"||n.type==="KeyDown"||n.type==="KeyUp"||n.type==="KeyPress"||n.type==="Collision"||n.type==="Trigger")&&(n.runMode=n.toggle?"Toggle":"Repeat")}))}function fIe(e){e.shared.variables=$o({},Lt.prototype)}function pIe(e){let t=Yi(e.shared.variables);e.shared.variables=$o(Object.entries(t??{}).map(([r,i],n)=>({fi:n,id:r,data:i})),Dt.prototype)}var $l=115;function oW(e,t){t(e.data);for(let r of e.children)oW(r,t)}function mIe(e){let t=e.schema??104;t!==$l&&t<105&&(oW(e.asset,aW),e.schema=105)}function vIe(e){e.shared.particles=$o({},Lt.prototype),e.shared.lib&&(e.shared.lib.particles=mc.defaultData().particles)}function gIe(e){e.scene.objects.traverse((t,r)=>{r.type==="Particle"&&typeof r.renderMaterial.size=="number"&&Object.assign(r.renderMaterial,{size:[r.renderMaterial.size,r.renderMaterial.size]})})}function yIe(e){e.scene.objects.traverse((t,r)=>{r.type==="Page"&&(r.postprocessing.depthOfField.focusDistance=100,r.postprocessing.depthOfField.focalLength=20,r.postprocessing.depthOfField.bokehScale=5)})}function bIe(e){e.scene.objects.traverse((t,r)=>{var i;Array.isArray(Yi(r.events))!==!1&&((i=r.events)==null||i.forEach(n=>{var o,s,l,c,u,d,h,f,p,v,m;let a=n.runMode;n.type==="MouseDown"||n.type==="MouseUp"||n.type==="KeyDown"||n.type==="KeyUp"||n.type==="Collision"||n.type==="Trigger"?(o=n.actions)==null||o.forEach(g=>{g.type==="Transition"&&(g.runMode=a??"Repeat"),(g.type==="Animation"||g.type==="SwitchCamera")&&(g.runMode=a==="Toggle"?"Toggle":"Normal")}):n.type==="MouseHover"||n.type==="MousePress"||n.type==="KeyPress"?(s=n.actions)==null||s.forEach(g=>{(g.type==="Transition"||g.type==="Animation"||g.type==="SwitchCamera")&&(g.runMode="Toggle")}):n.type==="GameControl"?(delete n.actions,Object.keys(n.gameActions).forEach(g=>{var y;(y=n.gameActions[g])==null||y.forEach(b=>{b.type==="Transition"&&(b.runMode="Repeat"),b.type==="Animation"&&(b.runMode="Normal")})})):n.type==="DragDrop"?(delete n.actions,(c=(l=n.dragDropActions)==null?void 0:l.drag)==null||c.forEach(g=>{(g.type==="Transition"||g.type==="Animation"||g.type==="SwitchCamera")&&(g.runMode="Toggle")}),(d=(u=n.dragDropActions)==null?void 0:u.drop)==null||d.forEach(g=>{(g.type==="Transition"||g.type==="Animation"||g.type==="SwitchCamera")&&(g.runMode="Toggle")})):n.type==="Resize"?(delete n.actions,(h=n.breakpoints)==null||h.forEach(g=>{var y;(y=g.actions)==null||y.forEach(b=>{(b.type==="Transition"||b.type==="Animation"||b.type==="SwitchCamera")&&(b.runMode="Toggle")})})):n.type==="Start"?(f=n.actions)==null||f.forEach(g=>{g.type==="Transition"&&(g.runMode="Once"),(g.type==="Animation"||g.type==="SwitchCamera")&&(g.runMode="Normal")}):n.type==="VariableChange"||n.type==="Scroll"?(p=n.actions)==null||p.forEach(g=>{g.type==="Transition"&&(g.runMode="Repeat"),(g.type==="Animation"||g.type==="SwitchCamera")&&(g.runMode="Normal")}):n.type==="Conditional"&&(delete n.actions,(v=n.inActions)==null||v.forEach(g=>{g.type==="Transition"&&(g.runMode="Repeat"),(g.type==="Animation"||g.type==="SwitchCamera")&&(g.runMode="Normal")}),(m=n.outActions)==null||m.forEach(g=>{g.type==="Transition"&&(g.runMode="Repeat"),(g.type==="Animation"||g.type==="SwitchCamera")&&(g.runMode="Normal")}))}))})}function xIe(e){e.shared.userAPIs=$o({},Lt.prototype),e.shared.userWebhooks=$o({},Lt.prototype),e.shared.lib&&(e.shared.lib.userAPIs=mc.defaultData().userAPIs,e.shared.lib.userWebhooks=mc.defaultData().userWebhooks)}function sW(e){let t=e.schema??0;if(t!==$l){console.warn("updating from ",t,"to ",$l),uIe(e,t),t<100&&(e.scene.publish.joystickSizeAndXYOffset===void 0&&(e.scene.publish.joystickSizeAndXYOffset=mu.defaultData.joystickSizeAndXYOffset),e.schema=100),t<101&&(lu(e,fB),su(e,fB),e.schema=101),t<102&&(dIe(e),e.schema=102),t<104&&(e.shared.catelogs=new Lt,e.shared.lib=mc.defaultData(),e.schema=104),t<105&&(fIe(e),e.scene.objects.traverse((r,i)=>{aW(i)}),e.schema=105);for(let r of Object.values(e.shared.lib.components))mIe(r);t<106&&(pIe(e),e.schema=106),t<107&&(e.shared.lib.variables=mc.defaultData().variables,e.schema=107),t<109&&(vIe(e),e.schema=109),t<110&&(gIe(e),e.schema=110),t<111&&(e.scene.objects.traverse((r,i)=>{hIe(i)}),e.schema=111),t<112&&(yIe(e),e.schema=112),t<113&&(bIe(e),e.schema=113),t<114&&(e.scene.publish.settings.web.imageQuality===void 0&&(e.scene.publish.settings.web.imageQuality=70),e.schema=114),t<115&&(xIe(e),e.schema=115)}}var w1;(e=>{e.defaultData={schema:$l,scene:Nd.defaultData,frames:new Lt().add("72fc2993-2da3-4b6b-96ac-2879db3a28bd",Xv.defaultData),shared:{...Oo.emptyData(),colors:Oo.defaultColors()}},e.emptyDataForImports=function(){let a=Nd.emptyDataWithPage();return{schema:$l,scene:a,frames:new Lt().add("72fc2993-2da3-4b6b-96ac-2879db3a28bd",Xv.defaultData),shared:{...Oo.emptyData(),colors:Oo.defaultColors(),images:Oo.defaultImages()}}},e.emptyData=function(){return{schema:$l,scene:Nd.emptyDataWithPage(),frames:new Lt().add("72fc2993-2da3-4b6b-96ac-2879db3a28bd",Xv.defaultData),shared:Oo.emptyData()}},e.clipboard2dData=function(){return{schema:$l,scene:Nd.emptyData(),frames:new Lt,shared:Oo.emptyData()}},e.collabHelper={...RM,updateSchema(a){return(a.schema??0)<$l?Fg(a,sW):(a.schema??0)-$l}};function t(a){let o=e.collabHelper.updateSchema(a);return typeof o=="number"?o===0?a:null:o.data}e.updateSchemaDirectly=t;function r(a){return{...a,shared:{...a.shared,lib:mc.defaultData()}}}e.withoutLib=r;function i(a,o){let s=a.scene.objects.get(o);if(s&&s.data.type==="Component")return s;{let l=a.shared.lib.components[o];if(l)return l.asset}}e.getComponentData=i;function n(a){let o=Object.values(a.shared.userAPIs);for(let s of o){let l=s.headers;for(let c of l)if(c.data.key.toLowerCase()==="authorization"&&c.data.value!=="")return!0}return!1}e.hasSensitiveData=n})(w1||(w1={}));var hE;(e=>e.emptyImage={data:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVQYV2NgYAAAAAMAAWgmWQ0AAAAASUVORK5CYII=",name:"empty"})(hE||(hE={}));var mB;(e=>{function t(r){return!0}e.is=t})(mB||(mB={}));var S1;(e=>{e.defaultData={position:[0,0],scale:[1,1],rotation:0,shear:[0,0]};function t(i,n){return{position:(n==null?void 0:n.position)??i.position,rotation:(n==null?void 0:n.rotation)??i.rotation,scale:(n==null?void 0:n.scale)??i.scale,shear:(n==null?void 0:n.shear)??i.shear}}e.merge=t;function r(i,n){return xH({position:rc.isEqual(i.position,n.position)?void 0:n.position,rotation:i.rotation===n.rotation?void 0:n.rotation,scale:rc.isEqual(i.scale,n.scale)?void 0:n.scale,shear:i.shear&&n.shear&&rc.isEqual(i.shear,n.shear)?void 0:n.shear})}e.diff=r})(S1||(S1={}));var fE;(e=>e.defaultData={horizontalConstraint:0,verticalConstraint:0})(fE||(fE={}));var vB;(e=>e.defaultData={direction:"row",wrap:"unwrap",align:"top-left",gap:10,rowGap:10,autoGap:!1,autoRowGap:!1,leftPadding:8,rightPadding:8,topPadding:8,bottomPadding:8})(vB||(vB={}));var C1;(e=>e.defaultData={opacity:1,fill:{color:ii.fromHexAndA(go,1),enabled:!0},stroke:{color:ii.from0to1([0,0,0,1]),thickness:1,enabled:!1,mode:"inside"},layerBlur:{radius:2,enabled:!1},backgroundBlur:{radius:2,enabled:!1},dropShadow:{offset:[10,10],blurRadius:10,color:ii.from0to1([0,0,0,1]),enabled:!1,spread:0},innerShadow:{offset:[10,10],blurRadius:10,color:ii.from0to1([0,0,0,1]),enabled:!1,spread:0}})(C1||(C1={}));var Ud;(e=>{function t(o,s){return{name:s}}e.newEmpty=t;function r(o,s){if(s===void 0)return o;let l={...o},c=["width","height","cornerRadius"];for(let u of c)u in l&&u in s&&s[u]!==void 0&&Object.assign(l,{[u]:s[u]});return l}function i(o,s){if(s===void 0)return o;let l={...o};return"fill"in l&&"fill"in s&&s.fill!==void 0&&Object.assign(l,{fill:{...l.fill,...s.fill}}),"stroke"in l&&"stroke"in s&&s.stroke!==void 0&&Object.assign(l,{stroke:{...l.stroke,...s.stroke}}),"layerBlur"in l&&"layerBlur"in s&&s.layerBlur!==void 0&&Object.assign(l,{layerBlur:{...l.layerBlur,...s.layerBlur}}),"backgroundBlur"in l&&"backgroundBlur"in s&&s.backgroundBlur!==void 0&&Object.assign(l,{backgroundBlur:{...l.backgroundBlur,...s.backgroundBlur}}),"dropShadow"in l&&"dropShadow"in s&&s.dropShadow!==void 0&&Object.assign(l,{dropShadow:{...l.dropShadow,...s.dropShadow}}),"innerShadow"in l&&"innerShadow"in s&&s.innerShadow!==void 0&&Object.assign(l,{innerShadow:{...l.innerShadow,...s.innerShadow}}),l}function n(o,s){if(s===void 0)return o;let l={...o};return Object.assign(l,S1.merge(l,s)),l=r(l,s),l=i(l,s),l}e.patch=n;function a(o,s){let l,c=[];for(let[u,d]of Object.entries(s))u!=="name"&&(l===void 0&&(l={path:[],props:{},type:0},c.push(l)),l.props[u]=d);return c}e.toOps=a})(Ud||(Ud={}));var jg;(e=>e.defaultData={...S1.defaultData,...fE.defaultData,states:new Dt,events:new Dt,visible:!0,raycastLock:!1})(jg||(jg={}));var $p;(e=>e.defaultData={...jg.defaultData,...C1.defaultData})($p||($p={}));var _1;(e=>e.defaultData={cornerRadius:[0,0,0,0]})(_1||(_1={}));var pE;(e=>e.defaultData={...$p.defaultData,type:"ellipse2d",width:100,height:100,name:"Ellipse"})(pE||(pE={}));var Vg;(e=>e.defaultData={...$p.defaultData,..._1.defaultData,type:"rectangle2d",width:100,height:100,name:"Rectangle"})(Vg||(Vg={}));var mE;(e=>e.defaultData={...$p.defaultData,type:"text2d",width:100,height:100,fontSize:12,lineHeight:1.2,letterSpacing:0,text:{textValue:"Hello world"},horizontalAlign:1,verticalAlign:1,textTransform:1,font:"Roboto_regular",name:"Text"})(mE||(mE={}));var vE;(e=>e.defaultData={...$p.defaultData,type:"path2d",path:"",name:"Path"})(vE||(vE={}));var gB;(e=>{function t(r){return r.type==="ellipse2d"||r.type==="rectangle2d"||r.type==="text2d"||r.type==="vector2d"||r.type==="path2d"}e.is=t})(gB||(gB={}));var A1;(e=>e.defaultData={...jg.defaultData,name:"Group",type:"group2d"})(A1||(A1={}));var gE;(e=>e.defaultData=()=>({...jg.defaultData,..._1.defaultData,...C1.defaultData,name:"Frame",type:"frame2d",clipped:!0,width:200,height:200,fill:{color:ii.fromHexAndA(4737101,1),enabled:!0},stroke:{color:ii.fromHexAndA(0,1),thickness:1,enabled:!1,mode:"inside"},backgroundBlur:{radius:2,enabled:!1},layerBlur:{radius:2,enabled:!1}}))(gE||(gE={}));var rh;(e=>{function t(o){switch(o){case"rectangle2d":return{...Vg.defaultData};case"ellipse2d":return{...pE.defaultData};case"text2d":return{...mE.defaultData};case"vector2d":return{...Vg.defaultData};case"path2d":return{...vE.defaultData};case"frame2d":return{...gE.defaultData()};case"group2d":return{...A1.defaultData}}}e.defaultData=t;function r(o){return"width"in o&&"height"in o?[typeof o.width=="number"?o.width*.5:0,typeof o.height=="number"?o.height*.5:0]:[0,0]}e.getPivot=r;function i(o){return o.type==="rectangle2d"||o.type==="ellipse2d"||o.type==="text2d"||o.type==="frame2d"}e.isResizeable=i;function n(o){return o.type==="frame2d"&&o.autoLayout!==void 0}e.isAutoLayoutable=n;function a(o){return o.type==="rectangle2d"||o.type==="frame2d"}e.hasCorners=a})(rh||(rh={}));var yE;(e=>(e.defaultData={name:"UI",type:"scene2d",objects:new ra},e.emptyData=function(){return{type:"scene2d",objects:new ra}}))(yE||(yE={}));function jd(e,t=!1){let r=e[0].index!==null,i=new Set(Object.keys(e[0].attributes)),n=new Set(Object.keys(e[0].morphAttributes)),a={},o={},s=e[0].morphTargetsRelative,l=new Ot,c=0;for(let u=0;u<e.length;++u){let d=e[u],h=0;if(r!==(d.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(let f in d.attributes){if(!i.has(f))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+'. All geometries must have compatible attributes; make sure "'+f+'" attribute exists among all geometries, or in none of them.'),null;a[f]===void 0&&(a[f]=[]),a[f].push(d.attributes[f]),h++}if(h!==i.size)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". Make sure all geometries have the same number of attributes."),null;if(s!==d.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(let f in d.morphAttributes){if(!n.has(f))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+".  .morphAttributes must be consistent throughout all geometries."),null;o[f]===void 0&&(o[f]=[]),o[f].push(d.morphAttributes[f])}if(t){let f;if(r)f=d.index.count;else if(d.attributes.position!==void 0)f=d.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". The geometry must have either an index or a position attribute"),null;l.addGroup(c,f,u),c+=f}}if(r){let u=0,d=[];for(let h=0;h<e.length;++h){let f=e[h].index;for(let p=0;p<f.count;++p)d.push(f.getX(p)+u);u+=e[h].attributes.position.count}l.setIndex(d)}for(let u in a){let d=yB(a[u]);if(!d)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+u+" attribute."),null;l.setAttribute(u,d)}for(let u in o){let d=o[u][0].length;if(d===0)break;l.morphAttributes=l.morphAttributes||{},l.morphAttributes[u]=[];for(let h=0;h<d;++h){let f=[];for(let v=0;v<o[u].length;++v)f.push(o[u][v][h]);let p=yB(f);if(!p)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+u+" morphAttribute."),null;l.morphAttributes[u].push(p)}}return l}function yB(e){let t,r,i,n=0;for(let s=0;s<e.length;++s){let l=e[s];if(l.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. InterleavedBufferAttributes are not supported."),null;if(t===void 0&&(t=l.array.constructor),t!==l.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(r===void 0&&(r=l.itemSize),r!==l.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(i===void 0&&(i=l.normalized),i!==l.normalized)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;n+=l.array.length}let a=new t(n),o=0;for(let s=0;s<e.length;++s)a.set(e[s].array,o),o+=e[s].array.length;return new qt(a,r,i)}var wIe=Math.pow(2,-24),jy=class{constructor(){}};function Js(e,t,r){return r.min.x=t[e],r.min.y=t[e+1],r.min.z=t[e+2],r.max.x=t[e+3],r.max.y=t[e+4],r.max.z=t[e+5],r}function bB(e){let t=-1,r=-1/0;for(let i=0;i<3;i++){let n=e[i+3]-e[i];n>r&&(r=n,t=i)}return t}function xB(e,t){t.set(e)}function wB(e,t,r){let i,n;for(let a=0;a<3;a++){let o=a+3;i=e[a],n=t[a],r[a]=i<n?i:n,i=e[o],n=t[o],r[o]=i>n?i:n}}function Vy(e,t,r){for(let i=0;i<3;i++){let n=t[e+2*i],a=t[e+2*i+1],o=n-a,s=n+a;o<r[i]&&(r[i]=o),s>r[i+3]&&(r[i+3]=s)}}function Ym(e){let t=e[3]-e[0],r=e[4]-e[1],i=e[5]-e[2];return 2*(t*r+r*i+i*t)}function SIe(e,t){if(!e.index){let r=e.attributes.position.count,i=t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer,n;r>65535?n=new Uint32Array(new i(4*r)):n=new Uint16Array(new i(2*r)),e.setIndex(new qt(n,1));for(let a=0;a<r;a++)n[a]=a}}function CIe(e){if(!e.groups||!e.groups.length)return[{offset:0,count:e.index.count/3}];let t=[],r=new Set;for(let n of e.groups)r.add(n.start),r.add(n.start+n.count);let i=Array.from(r.values()).sort((n,a)=>n-a);for(let n=0;n<i.length-1;n++){let a=i[n],o=i[n+1];t.push({offset:a/3,count:(o-a)/3})}return t}function t_(e,t,r,i,n=null){let a=1/0,o=1/0,s=1/0,l=-1/0,c=-1/0,u=-1/0,d=1/0,h=1/0,f=1/0,p=-1/0,v=-1/0,m=-1/0,g=n!==null;for(let y=t*6,b=(t+r)*6;y<b;y+=6){let x=e[y+0],S=e[y+1],w=x-S,_=x+S;w<a&&(a=w),_>l&&(l=_),g&&x<d&&(d=x),g&&x>p&&(p=x);let C=e[y+2],A=e[y+3],M=C-A,P=C+A;M<o&&(o=M),P>c&&(c=P),g&&C<h&&(h=C),g&&C>v&&(v=C);let T=e[y+4],R=e[y+5],z=T-R,F=T+R;z<s&&(s=z),F>u&&(u=F),g&&T<f&&(f=T),g&&T>m&&(m=T)}i[0]=a,i[1]=o,i[2]=s,i[3]=l,i[4]=c,i[5]=u,g&&(n[0]=d,n[1]=h,n[2]=f,n[3]=p,n[4]=v,n[5]=m)}function _Ie(e,t,r,i){let n=1/0,a=1/0,o=1/0,s=-1/0,l=-1/0,c=-1/0;for(let u=t*6,d=(t+r)*6;u<d;u+=6){let h=e[u+0];h<n&&(n=h),h>s&&(s=h);let f=e[u+2];f<a&&(a=f),f>l&&(l=f);let p=e[u+4];p<o&&(o=p),p>c&&(c=p)}i[0]=n,i[1]=a,i[2]=o,i[3]=s,i[4]=l,i[5]=c}function AIe(e,t,r,i,n){let a=r,o=r+i-1,s=n.pos,l=n.axis*2;for(;;){for(;a<=o&&t[a*6+l]<s;)a++;for(;a<=o&&t[o*6+l]>=s;)o--;if(a<o){for(let c=0;c<3;c++){let u=e[a*3+c];e[a*3+c]=e[o*3+c],e[o*3+c]=u;let d=t[a*6+c*2+0];t[a*6+c*2+0]=t[o*6+c*2+0],t[o*6+c*2+0]=d;let h=t[a*6+c*2+1];t[a*6+c*2+1]=t[o*6+c*2+1],t[o*6+c*2+1]=h}a++,o--}else return a}}var Nl=32,MIe=(e,t)=>e.candidate-t.candidate,jc=new Array(Nl).fill().map(()=>({count:0,bounds:new Float32Array(6),rightCacheBounds:new Float32Array(6),leftCacheBounds:new Float32Array(6),candidate:0})),Hy=new Float32Array(6);function EIe(e,t,r,i,n,a){let o=-1,s=0;if(a===0)o=bB(t),o!==-1&&(s=(t[o]+t[o+3])/2);else if(a===1)o=bB(e),o!==-1&&(s=TIe(r,i,n,o));else if(a===2){let l=Ym(e),c=1.25*n,u=i*6,d=(i+n)*6;for(let h=0;h<3;h++){let f=t[h],p=(t[h+3]-f)/Nl;if(n<Nl/4){let v=[...jc];v.length=n;let m=0;for(let y=u;y<d;y+=6,m++){let b=v[m];b.candidate=r[y+2*h],b.count=0;let{bounds:x,leftCacheBounds:S,rightCacheBounds:w}=b;for(let _=0;_<3;_++)w[_]=1/0,w[_+3]=-1/0,S[_]=1/0,S[_+3]=-1/0,x[_]=1/0,x[_+3]=-1/0;Vy(y,r,x)}v.sort(MIe);let g=n;for(let y=0;y<g;y++){let b=v[y];for(;y+1<g&&v[y+1].candidate===b.candidate;)v.splice(y+1,1),g--}for(let y=u;y<d;y+=6){let b=r[y+2*h];for(let x=0;x<g;x++){let S=v[x];b>=S.candidate?Vy(y,r,S.rightCacheBounds):(Vy(y,r,S.leftCacheBounds),S.count++)}}for(let y=0;y<g;y++){let b=v[y],x=b.count,S=n-b.count,w=b.leftCacheBounds,_=b.rightCacheBounds,C=0;x!==0&&(C=Ym(w)/l);let A=0;S!==0&&(A=Ym(_)/l);let M=1+1.25*(C*x+A*S);M<c&&(o=h,c=M,s=b.candidate)}}else{for(let g=0;g<Nl;g++){let y=jc[g];y.count=0,y.candidate=f+p+g*p;let b=y.bounds;for(let x=0;x<3;x++)b[x]=1/0,b[x+3]=-1/0}for(let g=u;g<d;g+=6){let y=~~((r[g+2*h]-f)/p);y>=Nl&&(y=Nl-1);let b=jc[y];b.count++,Vy(g,r,b.bounds)}let v=jc[Nl-1];xB(v.bounds,v.rightCacheBounds);for(let g=Nl-2;g>=0;g--){let y=jc[g],b=jc[g+1];wB(y.bounds,b.rightCacheBounds,y.rightCacheBounds)}let m=0;for(let g=0;g<Nl-1;g++){let y=jc[g],b=y.count,x=y.bounds,S=jc[g+1].rightCacheBounds;b!==0&&(m===0?xB(x,Hy):wB(x,Hy,Hy)),m+=b;let w=0,_=0;m!==0&&(w=Ym(Hy)/l);let C=n-m;C!==0&&(_=Ym(S)/l);let A=1+1.25*(w*m+_*C);A<c&&(o=h,c=A,s=y.candidate)}}}}else console.warn(`MeshBVH: Invalid build strategy value ${a} used.`);return{axis:o,pos:s}}function TIe(e,t,r,i){let n=0;for(let a=t,o=t+r;a<o;a++)n+=e[a*6+i*2];return n/r}function PIe(e,t){let r=e.attributes.position,i=e.index.array,n=i.length/3,a=new Float32Array(n*6),o=r.normalized,s=r.array,l=r.offset||0,c=3;r.isInterleavedBufferAttribute&&(c=r.data.stride);let u=["getX","getY","getZ"];for(let d=0;d<n;d++){let h=d*3,f=d*6,p,v,m;o?(p=i[h+0],v=i[h+1],m=i[h+2]):(p=i[h+0]*c+l,v=i[h+1]*c+l,m=i[h+2]*c+l);for(let g=0;g<3;g++){let y,b,x;o?(y=r[u[g]](p),b=r[u[g]](v),x=r[u[g]](m)):(y=s[p+g],b=s[v+g],x=s[m+g]);let S=y;b<S&&(S=b),x<S&&(S=x);let w=y;b>w&&(w=b),x>w&&(w=x);let _=(w-S)/2,C=g*2;a[f+C+0]=S+_,a[f+C+1]=_+(Math.abs(S)+_)*wIe,S<t[g]&&(t[g]=S),w>t[g+3]&&(t[g+3]=w)}}return a}function DIe(e,t){function r(g){h&&h(g/f)}function i(g,y,b,x=null,S=0){if(!p&&S>=l&&(p=!0,c&&(console.warn(`MeshBVH: Max depth of ${l} reached when generating BVH. Consider increasing maxDepth.`),console.warn(e))),b<=u||S>=l)return r(y+b),g.offset=y,g.count=b,g;let w=EIe(g.boundingData,x,o,y,b,d);if(w.axis===-1)return r(y+b),g.offset=y,g.count=b,g;let _=AIe(s,o,y,b,w);if(_===y||_===y+b)r(y+b),g.offset=y,g.count=b;else{g.splitAxis=w.axis;let C=new jy,A=y,M=_-y;g.left=C,C.boundingData=new Float32Array(6),t_(o,A,M,C.boundingData,a),i(C,A,M,a,S+1);let P=new jy,T=_,R=b-M;g.right=P,P.boundingData=new Float32Array(6),t_(o,T,R,P.boundingData,a),i(P,T,R,a,S+1)}return g}SIe(e,t);let n=new Float32Array(6),a=new Float32Array(6),o=PIe(e,n),s=e.index.array,l=t.maxDepth,c=t.verbose,u=t.maxLeafTris,d=t.strategy,h=t.onProgress,f=e.index.count/3,p=!1,v=[],m=CIe(e);if(m.length===1){let g=m[0],y=new jy;y.boundingData=n,_Ie(o,g.offset,g.count,a),i(y,g.offset,g.count,a),v.push(y)}else for(let g of m){let y=new jy;y.boundingData=new Float32Array(6),t_(o,g.offset,g.count,y.boundingData,a),i(y,g.offset,g.count,a),v.push(y)}return v}function OIe(e,t){let r=DIe(e,t),i,n,a,o=[],s=t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;for(let u=0;u<r.length;u++){let d=r[u],h=l(d),f=new s(32*h);i=new Float32Array(f),n=new Uint32Array(f),a=new Uint16Array(f),c(0,d),o.push(f)}return o;function l(u){return u.count?1:1+l(u.left)+l(u.right)}function c(u,d){let h=u/4,f=u/2,p=!!d.count,v=d.boundingData;for(let m=0;m<6;m++)i[h+m]=v[m];if(p){let m=d.offset,g=d.count;return n[h+6]=m,a[f+14]=g,a[f+15]=65535,u+32}else{let m=d.left,g=d.right,y=d.splitAxis,b;if(b=c(u+32,m),b/4>Math.pow(2,32))throw new Error("MeshBVH: Cannot store child pointer greater than 32 bits.");return n[h+6]=b/4,b=c(b,g),n[h+7]=y,b}}}var vc=class{constructor(){this.min=1/0,this.max=-1/0}setFromPointsField(e,t){let r=1/0,i=-1/0;for(let n=0,a=e.length;n<a;n++){let o=e[n][t];r=o<r?o:r,i=o>i?o:i}this.min=r,this.max=i}setFromPoints(e,t){let r=1/0,i=-1/0;for(let n=0,a=t.length;n<a;n++){let o=t[n],s=e.dot(o);r=s<r?s:r,i=s>i?s:i}this.min=r,this.max=i}isSeparated(e){return this.min>e.max||e.min>this.max}};vc.prototype.setFromBox=function(){let e=new k;return function(t,r){let i=r.min,n=r.max,a=1/0,o=-1/0;for(let s=0;s<=1;s++)for(let l=0;l<=1;l++)for(let c=0;c<=1;c++){e.x=i.x*s+n.x*(1-s),e.y=i.y*l+n.y*(1-l),e.z=i.z*c+n.z*(1-c);let u=t.dot(e);a=Math.min(u,a),o=Math.max(u,o)}this.min=a,this.max=o}}();var RIe=function(){let e=new k,t=new k,r=new k;return function(i,n,a){let o=i.start,s=e,l=n.start,c=t;r.subVectors(o,l),e.subVectors(i.end,i.start),t.subVectors(n.end,n.start);let u=r.dot(c),d=c.dot(s),h=c.dot(c),f=r.dot(s),p=s.dot(s)*h-d*d,v,m;p!==0?v=(u*d-f*h)/p:v=0,m=(u+v*d)/h,a.x=v,a.y=m}}(),PD=function(){let e=new ye,t=new k,r=new k;return function(i,n,a,o){RIe(i,n,e);let s=e.x,l=e.y;if(s>=0&&s<=1&&l>=0&&l<=1){i.at(s,a),n.at(l,o);return}else if(s>=0&&s<=1){l<0?n.at(0,o):n.at(1,o),i.closestPointToPoint(o,!0,a);return}else if(l>=0&&l<=1){s<0?i.at(0,a):i.at(1,a),n.closestPointToPoint(a,!0,o);return}else{let c;s<0?c=i.start:c=i.end;let u;l<0?u=n.start:u=n.end;let d=t,h=r;if(i.closestPointToPoint(u,!0,t),n.closestPointToPoint(c,!0,r),d.distanceToSquared(u)<=h.distanceToSquared(c)){a.copy(d),o.copy(u);return}else{a.copy(c),o.copy(h);return}}}}(),IIe=function(){let e=new k,t=new k,r=new Ya,i=new jo;return function(n,a){let{radius:o,center:s}=n,{a:l,b:c,c:u}=a;if(i.start=l,i.end=c,i.closestPointToPoint(s,!0,e).distanceTo(s)<=o||(i.start=l,i.end=u,i.closestPointToPoint(s,!0,e).distanceTo(s)<=o)||(i.start=c,i.end=u,i.closestPointToPoint(s,!0,e).distanceTo(s)<=o))return!0;let d=a.getPlane(r);if(Math.abs(d.distanceToPoint(s))<=o){let h=d.projectPoint(s,t);if(a.containsPoint(h))return!0}return!1}}(),zIe=1e-15;function ff(e){return Math.abs(e)<zIe}var gc=class extends ta{constructor(...e){super(...e),this.isExtendedTriangle=!0,this.satAxes=new Array(4).fill().map(()=>new k),this.satBounds=new Array(4).fill().map(()=>new vc),this.points=[this.a,this.b,this.c],this.sphere=new ao,this.plane=new Ya,this.needsUpdate=!0}intersectsSphere(e){return IIe(e,this)}update(){let e=this.a,t=this.b,r=this.c,i=this.points,n=this.satAxes,a=this.satBounds,o=n[0],s=a[0];this.getNormal(o),s.setFromPoints(o,i);let l=n[1],c=a[1];l.subVectors(e,t),c.setFromPoints(l,i);let u=n[2],d=a[2];u.subVectors(t,r),d.setFromPoints(u,i);let h=n[3],f=a[3];h.subVectors(r,e),f.setFromPoints(h,i),this.sphere.setFromPoints(this.points),this.plane.setFromNormalAndCoplanarPoint(o,e),this.needsUpdate=!1}};gc.prototype.closestPointToSegment=function(){let e=new k,t=new k,r=new jo;return function(i,n=null,a=null){let{start:o,end:s}=i,l=this.points,c,u=1/0;for(let d=0;d<3;d++){let h=(d+1)%3;r.start.copy(l[d]),r.end.copy(l[h]),PD(r,i,e,t),c=e.distanceToSquared(t),c<u&&(u=c,n&&n.copy(e),a&&a.copy(t))}return this.closestPointToPoint(o,e),c=o.distanceToSquared(e),c<u&&(u=c,n&&n.copy(e),a&&a.copy(o)),this.closestPointToPoint(s,e),c=s.distanceToSquared(e),c<u&&(u=c,n&&n.copy(e),a&&a.copy(s)),Math.sqrt(u)}}();gc.prototype.intersectsTriangle=function(){let e=new gc,t=new Array(3),r=new Array(3),i=new vc,n=new vc,a=new k,o=new k,s=new k,l=new k,c=new jo,u=new jo,d=new jo;return function(h,f=null,p=!1){this.needsUpdate&&this.update(),h.isExtendedTriangle?h.needsUpdate&&h.update():(e.copy(h),e.update(),h=e);let v=this.plane,m=h.plane;if(Math.abs(v.normal.dot(m.normal))>1-1e-10){let g=this.satBounds,y=this.satAxes;r[0]=h.a,r[1]=h.b,r[2]=h.c;for(let S=0;S<4;S++){let w=g[S],_=y[S];if(i.setFromPoints(_,r),w.isSeparated(i))return!1}let b=h.satBounds,x=h.satAxes;t[0]=this.a,t[1]=this.b,t[2]=this.c;for(let S=0;S<4;S++){let w=b[S],_=x[S];if(i.setFromPoints(_,t),w.isSeparated(i))return!1}for(let S=0;S<4;S++){let w=y[S];for(let _=0;_<4;_++){let C=x[_];if(a.crossVectors(w,C),i.setFromPoints(a,t),n.setFromPoints(a,r),i.isSeparated(n))return!1}}return f&&(p||console.warn("ExtendedTriangle.intersectsTriangle: Triangles are coplanar which does not support an output edge. Setting edge to 0, 0, 0."),f.start.set(0,0,0),f.end.set(0,0,0)),!0}else{let g=this.points,y=!1,b=0;for(let R=0;R<3;R++){let z=g[R],F=g[(R+1)%3];c.start.copy(z),c.end.copy(F),c.delta(o);let H=y?u.start:u.end,N=ff(m.distanceToPoint(z));if(ff(m.normal.dot(o))&&N){u.copy(c),b=2;break}if((m.intersectLine(c,H)||N)&&!ff(H.distanceTo(F))){if(b++,y)break;y=!0}}if(b===1&&h.containsPoint(u.end))return f&&(f.start.copy(u.end),f.end.copy(u.end)),!0;if(b!==2)return!1;let x=h.points,S=!1,w=0;for(let R=0;R<3;R++){let z=x[R],F=x[(R+1)%3];c.start.copy(z),c.end.copy(F),c.delta(s);let H=S?d.start:d.end,N=ff(v.distanceToPoint(z));if(ff(v.normal.dot(s))&&N){d.copy(c),w=2;break}if((v.intersectLine(c,H)||N)&&!ff(H.distanceTo(F))){if(w++,S)break;S=!0}}if(w===1&&this.containsPoint(d.end))return f&&(f.start.copy(d.end),f.end.copy(d.end)),!0;if(w!==2)return!1;if(u.delta(o),d.delta(s),o.dot(s)<0){let R=d.start;d.start=d.end,d.end=R}let _=u.start.dot(o),C=u.end.dot(o),A=d.start.dot(o),M=d.end.dot(o),P=C<A,T=_<M;return _!==M&&A!==C&&P===T?!1:(f&&(l.subVectors(u.start,d.start),l.dot(o)>0?f.start.copy(u.start):f.start.copy(d.start),l.subVectors(u.end,d.end),l.dot(o)<0?f.end.copy(u.end):f.end.copy(d.end)),!0)}}}();gc.prototype.distanceToPoint=function(){let e=new k;return function(t){return this.closestPointToPoint(t,e),t.distanceTo(e)}}();gc.prototype.distanceToTriangle=function(){let e=new k,t=new k,r=["a","b","c"],i=new jo,n=new jo;return function(a,o=null,s=null){let l=o||s?i:null;if(this.intersectsTriangle(a,l))return(o||s)&&(o&&l.getCenter(o),s&&l.getCenter(s)),0;let c=1/0;for(let u=0;u<3;u++){let d,h=r[u],f=a[h];this.closestPointToPoint(f,e),d=f.distanceToSquared(e),d<c&&(c=d,o&&o.copy(e),s&&s.copy(f));let p=this[h];a.closestPointToPoint(p,e),d=p.distanceToSquared(e),d<c&&(c=d,o&&o.copy(p),s&&s.copy(e))}for(let u=0;u<3;u++){let d=r[u],h=r[(u+1)%3];i.set(this[d],this[h]);for(let f=0;f<3;f++){let p=r[f],v=r[(f+1)%3];n.set(a[p],a[v]),PD(i,n,e,t);let m=e.distanceToSquared(t);m<c&&(c=m,o&&o.copy(e),s&&s.copy(t))}}return Math.sqrt(c)}}();var ml=class{constructor(e,t,r){this.isOrientedBox=!0,this.min=new k,this.max=new k,this.matrix=new it,this.invMatrix=new it,this.points=new Array(8).fill().map(()=>new k),this.satAxes=new Array(3).fill().map(()=>new k),this.satBounds=new Array(3).fill().map(()=>new vc),this.alignedSatBounds=new Array(3).fill().map(()=>new vc),this.needsUpdate=!1,e&&this.min.copy(e),t&&this.max.copy(t),r&&this.matrix.copy(r)}set(e,t,r){this.min.copy(e),this.max.copy(t),this.matrix.copy(r),this.needsUpdate=!0}copy(e){this.min.copy(e.min),this.max.copy(e.max),this.matrix.copy(e.matrix),this.needsUpdate=!0}};ml.prototype.update=function(){return function(){let e=this.matrix,t=this.min,r=this.max,i=this.points;for(let l=0;l<=1;l++)for(let c=0;c<=1;c++)for(let u=0;u<=1;u++){let d=1*l|2*c|4*u,h=i[d];h.x=l?r.x:t.x,h.y=c?r.y:t.y,h.z=u?r.z:t.z,h.applyMatrix4(e)}let n=this.satBounds,a=this.satAxes,o=i[0];for(let l=0;l<3;l++){let c=a[l],u=n[l],d=1<<l,h=i[d];c.subVectors(o,h),u.setFromPoints(c,i)}let s=this.alignedSatBounds;s[0].setFromPointsField(i,"x"),s[1].setFromPointsField(i,"y"),s[2].setFromPointsField(i,"z"),this.invMatrix.copy(this.matrix).invert(),this.needsUpdate=!1}}();ml.prototype.intersectsBox=function(){let e=new vc;return function(t){this.needsUpdate&&this.update();let r=t.min,i=t.max,n=this.satBounds,a=this.satAxes,o=this.alignedSatBounds;if(e.min=r.x,e.max=i.x,o[0].isSeparated(e)||(e.min=r.y,e.max=i.y,o[1].isSeparated(e))||(e.min=r.z,e.max=i.z,o[2].isSeparated(e)))return!1;for(let s=0;s<3;s++){let l=a[s],c=n[s];if(e.setFromBox(l,t),c.isSeparated(e))return!1}return!0}}();ml.prototype.intersectsTriangle=function(){let e=new gc,t=new Array(3),r=new vc,i=new vc,n=new k;return function(a){this.needsUpdate&&this.update(),a.isExtendedTriangle?a.needsUpdate&&a.update():(e.copy(a),e.update(),a=e);let o=this.satBounds,s=this.satAxes;t[0]=a.a,t[1]=a.b,t[2]=a.c;for(let d=0;d<3;d++){let h=o[d],f=s[d];if(r.setFromPoints(f,t),h.isSeparated(r))return!1}let l=a.satBounds,c=a.satAxes,u=this.points;for(let d=0;d<3;d++){let h=l[d],f=c[d];if(r.setFromPoints(f,u),h.isSeparated(r))return!1}for(let d=0;d<3;d++){let h=s[d];for(let f=0;f<4;f++){let p=c[f];if(n.crossVectors(h,p),r.setFromPoints(n,t),i.setFromPoints(n,u),r.isSeparated(i))return!1}}return!0}}();ml.prototype.closestPointToPoint=function(){return function(e,t){return this.needsUpdate&&this.update(),t.copy(e).applyMatrix4(this.invMatrix).clamp(this.min,this.max).applyMatrix4(this.matrix),t}}();ml.prototype.distanceToPoint=function(){let e=new k;return function(t){return this.closestPointToPoint(t,e),t.distanceTo(e)}}();ml.prototype.distanceToBox=function(){let e=["x","y","z"],t=new Array(12).fill().map(()=>new jo),r=new Array(12).fill().map(()=>new jo),i=new k,n=new k;return function(a,o=0,s=null,l=null){if(this.needsUpdate&&this.update(),this.intersectsBox(a))return(s||l)&&(a.getCenter(n),this.closestPointToPoint(n,i),a.closestPointToPoint(i,n),s&&s.copy(i),l&&l.copy(n)),0;let c=o*o,u=a.min,d=a.max,h=this.points,f=1/0;for(let v=0;v<8;v++){let m=h[v];n.copy(m).clamp(u,d);let g=m.distanceToSquared(n);if(g<f&&(f=g,s&&s.copy(m),l&&l.copy(n),g<c))return Math.sqrt(g)}let p=0;for(let v=0;v<3;v++)for(let m=0;m<=1;m++)for(let g=0;g<=1;g++){let y=(v+1)%3,b=(v+2)%3,x=m<<y|g<<b,S=1<<v|m<<y|g<<b,w=h[x],_=h[S];t[p].set(w,_);let C=e[v],A=e[y],M=e[b],P=r[p],T=P.start,R=P.end;T[C]=u[C],T[A]=m?u[A]:d[A],T[M]=g?u[M]:d[A],R[C]=d[C],R[A]=m?u[A]:d[A],R[M]=g?u[M]:d[A],p++}for(let v=0;v<=1;v++)for(let m=0;m<=1;m++)for(let g=0;g<=1;g++){n.x=v?d.x:u.x,n.y=m?d.y:u.y,n.z=g?d.z:u.z,this.closestPointToPoint(n,i);let y=n.distanceToSquared(i);if(y<f&&(f=y,s&&s.copy(i),l&&l.copy(n),y<c))return Math.sqrt(y)}for(let v=0;v<12;v++){let m=t[v];for(let g=0;g<12;g++){let y=r[g];PD(m,y,i,n);let b=i.distanceToSquared(n);if(b<f&&(f=b,s&&s.copy(i),l&&l.copy(n),b<c))return Math.sqrt(b)}}return Math.sqrt(f)}}();var pf=new k,mf=new k,vf=new k,Wy=new ye,Gy=new ye,$y=new ye,SB=new k,CB=new k,_B=new k,qy=new k;function kIe(e,t,r,i,n,a){let o;return a===Nn?o=e.intersectTriangle(i,r,t,!0,n):o=e.intersectTriangle(t,r,i,a!==ga,n),o===null?null:{distance:e.origin.distanceTo(n),point:n.clone()}}function LIe(e,t,r,i,n,a,o,s,l){pf.fromBufferAttribute(t,a),mf.fromBufferAttribute(t,o),vf.fromBufferAttribute(t,s);let c=kIe(e,pf,mf,vf,qy,l);if(c){i&&(Wy.fromBufferAttribute(i,a),Gy.fromBufferAttribute(i,o),$y.fromBufferAttribute(i,s),c.uv=ta.getInterpolation(qy,pf,mf,vf,Wy,Gy,$y,new ye)),n&&(Wy.fromBufferAttribute(n,a),Gy.fromBufferAttribute(n,o),$y.fromBufferAttribute(n,s),c.uv1=ta.getInterpolation(qy,pf,mf,vf,Wy,Gy,$y,new ye)),r&&(SB.fromBufferAttribute(r,a),CB.fromBufferAttribute(r,o),_B.fromBufferAttribute(r,s),c.normal=ta.getInterpolation(qy,pf,mf,vf,SB,CB,_B,new k),c.normal.dot(e.direction)>0&&c.normal.multiplyScalar(-1));let u={a,b:o,c:s,normal:new k,materialIndex:0};ta.getNormal(pf,mf,vf,u.normal),c.face=u,c.faceIndex=a}return c}function lW(e,t,r,i,n){let a=i*3,o=e.index.getX(a),s=e.index.getX(a+1),l=e.index.getX(a+2),{position:c,normal:u,uv:d,uv1:h}=e.attributes,f=LIe(r,c,u,d,h,o,s,l,t);return f?(f.faceIndex=i,n&&n.push(f),f):null}function BIe(e,t,r,i,n,a){for(let o=i,s=i+n;o<s;o++)lW(e,t,r,o,a)}function FIe(e,t,r,i,n){let a=1/0,o=null;for(let s=i,l=i+n;s<l;s++){let c=lW(e,t,r,s);c&&c.distance<a&&(o=c,a=c.distance)}return o}function qs(e,t,r,i){let n=e.a,a=e.b,o=e.c,s=t,l=t+1,c=t+2;r&&(s=r.getX(t),l=r.getX(t+1),c=r.getX(t+2)),n.x=i.getX(s),n.y=i.getY(s),n.z=i.getZ(s),a.x=i.getX(l),a.y=i.getY(l),a.z=i.getZ(l),o.x=i.getX(c),o.y=i.getY(c),o.z=i.getZ(c)}function AB(e,t,r,i,n,a,o){let s=r.index,l=r.attributes.position;for(let c=e,u=t+e;c<u;c++)if(qs(o,c*3,s,l),o.needsUpdate=!0,i(o,c,n,a))return!0;return!1}var cW=class{constructor(e){this._getNewPrimitive=e,this._primitives=[]}getPrimitive(){let e=this._primitives;return e.length===0?this._getNewPrimitive():e.pop()}releasePrimitive(e){this._primitives.push(e)}};function cu(e,t){return t[e+15]===65535}function lp(e,t){return t[e+6]}function Hg(e,t){return t[e+14]}function Wg(e){return e+8}function Gg(e,t){return t[e+6]}function NIe(e,t){return t[e+7]}var $f=new Ji,M1=new k,UIe=["x","y","z"];function bE(e,t,r,i,n){let a=e*2,o=ym,s=Tu,l=Pu;if(cu(a,s)){let c=lp(e,l),u=Hg(a,s);BIe(t,r,i,c,u,n)}else{let c=Wg(e);E1(c,o,i,M1)&&bE(c,t,r,i,n);let u=Gg(e,l);E1(u,o,i,M1)&&bE(u,t,r,i,n)}}function xE(e,t,r,i){let n=e*2,a=ym,o=Tu,s=Pu;if(cu(n,o)){let l=lp(e,s),c=Hg(n,o);return FIe(t,r,i,l,c)}else{let l=NIe(e,s),c=UIe[l],u=i.direction[c]>=0,d,h;u?(d=Wg(e),h=Gg(e,s)):(d=Gg(e,s),h=Wg(e));let f=E1(d,a,i,M1)?xE(d,t,r,i):null;if(f){let v=f.point[c];if(u?v<=a[h+l]:v>=a[h+l+3])return f}let p=E1(h,a,i,M1)?xE(h,t,r,i):null;return f&&p?f.distance<=p.distance?f:p:f||p||null}}var jIe=function(){let e,t,r=[],i=new cW(()=>new Ji);return function(...a){e=i.getPrimitive(),t=i.getPrimitive(),r.push(e,t);let o=n(...a);i.releasePrimitive(e),i.releasePrimitive(t),r.pop(),r.pop();let s=r.length;return s>0&&(t=r[s-1],e=r[s-2]),o};function n(a,o,s,l,c=null,u=0,d=0){function h(y){let b=y*2,x=Tu,S=Pu;for(;!cu(b,x);)y=Wg(y),b=y*2;return lp(y,S)}function f(y){let b=y*2,x=Tu,S=Pu;for(;!cu(b,x);)y=Gg(y,S),b=y*2;return lp(y,S)+Hg(b,x)}let p=a*2,v=ym,m=Tu,g=Pu;if(cu(p,m)){let y=lp(a,g),b=Hg(p,m);return Js(a,v,e),l(y,b,!1,d,u+a,e)}else{let y=Wg(a),b=Gg(a,g),x=y,S=b,w,_,C,A;if(c&&(C=e,A=t,Js(x,v,C),Js(S,v,A),w=c(C),_=c(A),_<w)){x=b,S=y;let H=w;w=_,_=H,C=A}C||(C=e,Js(x,v,C));let M=cu(x*2,m),P=s(C,M,w,d+1,u+x),T;if(P===2){let H=h(x),N=f(x)-H;T=l(H,N,!0,d+1,u+x,C)}else T=P&&n(x,o,s,l,c,u,d+1);if(T)return!0;A=t,Js(S,v,A);let R=cu(S*2,m),z=s(A,R,_,d+1,u+S),F;if(z===2){let H=h(S),N=f(S)-H;F=l(H,N,!0,d+1,u+S,A)}else F=z&&n(S,o,s,l,c,u,d+1);return!!F}}}(),VIe=function(){let e=new gc,t=new gc,r=new it,i=new ml,n=new ml;return function a(o,s,l,c,u=null){let d=o*2,h=ym,f=Tu,p=Pu;if(u===null&&(l.boundingBox||l.computeBoundingBox(),i.set(l.boundingBox.min,l.boundingBox.max,c),u=i),cu(d,f)){let v=s,m=v.index,g=v.attributes.position,y=l.index,b=l.attributes.position,x=lp(o,p),S=Hg(d,f);if(r.copy(c).invert(),l.boundsTree)return Js(o,h,n),n.matrix.copy(r),n.needsUpdate=!0,l.boundsTree.shapecast({intersectsBounds:w=>n.intersectsBox(w),intersectsTriangle:w=>{w.a.applyMatrix4(c),w.b.applyMatrix4(c),w.c.applyMatrix4(c),w.needsUpdate=!0;for(let _=x*3,C=(S+x)*3;_<C;_+=3)if(qs(t,_,m,g),t.needsUpdate=!0,w.intersectsTriangle(t))return!0;return!1}});for(let w=x*3,_=S+x*3;w<_;w+=3){qs(e,w,m,g),e.a.applyMatrix4(r),e.b.applyMatrix4(r),e.c.applyMatrix4(r),e.needsUpdate=!0;for(let C=0,A=y.count;C<A;C+=3)if(qs(t,C,y,b),t.needsUpdate=!0,e.intersectsTriangle(t))return!0}}else{let v=o+8,m=p[o+6];return Js(v,h,$f),!!(u.intersectsBox($f)&&a(v,s,l,c,u)||(Js(m,h,$f),u.intersectsBox($f)&&a(m,s,l,c,u)))}}}();function E1(e,t,r,i){return Js(e,t,$f),r.intersectBox($f,i)}var wE=[],Gb,ym,Tu,Pu;function wv(e){Gb&&wE.push(Gb),Gb=e,ym=new Float32Array(e),Tu=new Uint16Array(e),Pu=new Uint32Array(e)}function Yy(){Gb=null,ym=null,Tu=null,Pu=null,wE.length&&wv(wE.pop())}var r_=Symbol("skip tree generation"),i_=new Ji,n_=new Ji,gf=new it,ud=new ml,Xm=new ml,Km=new k,Xy=new k,HIe=new k,WIe=new k,GIe=new k,MB=new Ji,Is=new cW(()=>new gc),Kv=class{static serialize(e,t={}){if(t.isBufferGeometry)return console.warn("MeshBVH.serialize: The arguments for the function have changed. See documentation for new signature."),Kv.serialize(arguments[0],{cloneBuffers:arguments[2]===void 0?!0:arguments[2]});t={cloneBuffers:!0,...t};let r=e.geometry,i=e._roots,n=r.getIndex(),a;return t.cloneBuffers?a={roots:i.map(o=>o.slice()),index:n.array.slice()}:a={roots:i,index:n.array},a}static deserialize(e,t,r={}){if(typeof r=="boolean")return console.warn("MeshBVH.deserialize: The arguments for the function have changed. See documentation for new signature."),Kv.deserialize(arguments[0],arguments[1],{setIndex:arguments[2]===void 0?!0:arguments[2]});r={setIndex:!0,...r};let{index:i,roots:n}=e,a=new Kv(t,{...r,[r_]:!0});if(a._roots=n,r.setIndex){let o=t.getIndex();if(o===null){let s=new qt(e.index,1,!1);t.setIndex(s)}else o.array!==i&&(o.array.set(i),o.needsUpdate=!0)}return a}constructor(e,t={}){if(e.isBufferGeometry){if(e.index&&e.index.isInterleavedBufferAttribute)throw new Error("MeshBVH: InterleavedBufferAttribute is not supported for the index attribute.")}else throw new Error("MeshBVH: Only BufferGeometries are supported.");if(t=Object.assign({strategy:0,maxDepth:40,maxLeafTris:10,verbose:!0,useSharedArrayBuffer:!1,setBoundingBox:!0,onProgress:null,[r_]:!1},t),t.useSharedArrayBuffer&&typeof SharedArrayBuffer>"u")throw new Error("MeshBVH: SharedArrayBuffer is not available.");this._roots=null,t[r_]||(this._roots=OIe(e,t),!e.boundingBox&&t.setBoundingBox&&(e.boundingBox=this.getBoundingBox(new Ji))),this.geometry=e}refit(e=null){e&&Array.isArray(e)&&(e=new Set(e));let t=this.geometry,r=t.index.array,i=t.attributes.position,n,a,o,s,l=0,c=this._roots;for(let d=0,h=c.length;d<h;d++)n=c[d],a=new Uint32Array(n),o=new Uint16Array(n),s=new Float32Array(n),u(0,l),l+=n.byteLength;function u(d,h,f=!1){let p=d*2;if(o[p+15]===65535){let v=a[d+6],m=o[p+14],g=1/0,y=1/0,b=1/0,x=-1/0,S=-1/0,w=-1/0;for(let _=3*v,C=3*(v+m);_<C;_++){let A=r[_],M=i.getX(A),P=i.getY(A),T=i.getZ(A);M<g&&(g=M),M>x&&(x=M),P<y&&(y=P),P>S&&(S=P),T<b&&(b=T),T>w&&(w=T)}return s[d+0]!==g||s[d+1]!==y||s[d+2]!==b||s[d+3]!==x||s[d+4]!==S||s[d+5]!==w?(s[d+0]=g,s[d+1]=y,s[d+2]=b,s[d+3]=x,s[d+4]=S,s[d+5]=w,!0):!1}else{let v=d+8,m=a[d+6],g=v+h,y=m+h,b=f,x=!1,S=!1;e?b||(x=e.has(g),S=e.has(y),b=!x&&!S):(x=!0,S=!0);let w=b||x,_=b||S,C=!1;w&&(C=u(v,h,b));let A=!1;_&&(A=u(m,h,b));let M=C||A;if(M)for(let P=0;P<3;P++){let T=v+P,R=m+P,z=s[T],F=s[T+3],H=s[R],N=s[R+3];s[d+P]=z<H?z:H,s[d+P+3]=F>N?F:N}return M}}}traverse(e,t=0){let r=this._roots[t],i=new Uint32Array(r),n=new Uint16Array(r);a(0);function a(o,s=0){let l=o*2,c=n[l+15]===65535;if(c){let u=i[o+6],d=n[l+14];e(s,c,new Float32Array(r,o*4,6),u,d)}else{let u=o+8,d=i[o+6],h=i[o+7];e(s,c,new Float32Array(r,o*4,6),h)||(a(u,s+1),a(d,s+1))}}}raycast(e,t=bs){let r=this._roots,i=this.geometry,n=[],a=t.isMaterial,o=Array.isArray(t),s=i.groups,l=a?t.side:t;for(let c=0,u=r.length;c<u;c++){let d=o?t[s[c].materialIndex].side:l,h=n.length;if(wv(r[c]),bE(0,i,d,e,n),Yy(),o){let f=s[c].materialIndex;for(let p=h,v=n.length;p<v;p++)n[p].face.materialIndex=f}}return n}raycastFirst(e,t=bs){let r=this._roots,i=this.geometry,n=t.isMaterial,a=Array.isArray(t),o=null,s=i.groups,l=n?t.side:t;for(let c=0,u=r.length;c<u;c++){let d=a?t[s[c].materialIndex].side:l;wv(r[c]);let h=xE(0,i,d,e);Yy(),h!=null&&(o==null||h.distance<o.distance)&&(o=h,a&&(h.face.materialIndex=s[c].materialIndex))}return o}intersectsGeometry(e,t){let r=this.geometry,i=!1;for(let n of this._roots)if(wv(n),i=VIe(0,r,e,t),Yy(),i)break;return i}shapecast(e,t,r){let i=this.geometry;if(e instanceof Function){if(t){let d=t;t=(h,f,p,v)=>{let m=f*3;return d(h,m,m+1,m+2,p,v)}}e={boundsTraverseOrder:r,intersectsBounds:e,intersectsTriangle:t,intersectsRange:null},console.warn("MeshBVH: Shapecast function signature has changed and now takes an object of callbacks as a second argument. See docs for new signature.")}let n=Is.getPrimitive(),{boundsTraverseOrder:a,intersectsBounds:o,intersectsRange:s,intersectsTriangle:l}=e;if(s&&l){let d=s;s=(h,f,p,v,m)=>d(h,f,p,v,m)?!0:AB(h,f,i,l,p,v,n)}else s||(l?s=(d,h,f,p)=>AB(d,h,i,l,f,p,n):s=(d,h,f)=>f);let c=!1,u=0;for(let d of this._roots){if(wv(d),c=jIe(0,i,o,s,a,u),Yy(),c)break;u+=d.byteLength}return Is.releasePrimitive(n),c}bvhcast(e,t,r){let{intersectsRanges:i,intersectsTriangles:n}=r,a=this.geometry.index,o=this.geometry.attributes.position,s=e.geometry.index,l=e.geometry.attributes.position;gf.copy(t).invert();let c=Is.getPrimitive(),u=Is.getPrimitive();if(n){let h=function(f,p,v,m,g,y,b,x){for(let S=v,w=v+m;S<w;S++){qs(u,S*3,s,l),u.a.applyMatrix4(t),u.b.applyMatrix4(t),u.c.applyMatrix4(t),u.needsUpdate=!0;for(let _=f,C=f+p;_<C;_++)if(qs(c,_*3,a,o),c.needsUpdate=!0,n(c,u,_,S,g,y,b,x))return!0}return!1};if(i){let f=i;i=function(p,v,m,g,y,b,x,S){return f(p,v,m,g,y,b,x,S)?!0:h(p,v,m,g,y,b,x,S)}}else i=h}e.getBoundingBox(n_),n_.applyMatrix4(t);let d=this.shapecast({intersectsBounds:h=>n_.intersectsBox(h),intersectsRange:(h,f,p,v,m,g)=>(i_.copy(g),i_.applyMatrix4(gf),e.shapecast({intersectsBounds:y=>i_.intersectsBox(y),intersectsRange:(y,b,x,S,w)=>i(h,f,y,b,v,m,S,w)}))});return Is.releasePrimitive(c),Is.releasePrimitive(u),d}intersectsBox(e,t){return ud.set(e.min,e.max,t),ud.needsUpdate=!0,this.shapecast({intersectsBounds:r=>ud.intersectsBox(r),intersectsTriangle:r=>ud.intersectsTriangle(r)})}intersectsSphere(e){return this.shapecast({intersectsBounds:t=>e.intersectsBox(t),intersectsTriangle:t=>t.intersectsSphere(e)})}closestPointToGeometry(e,t,r={},i={},n=0,a=1/0){e.boundingBox||e.computeBoundingBox(),ud.set(e.boundingBox.min,e.boundingBox.max,t),ud.needsUpdate=!0;let o=this.geometry,s=o.attributes.position,l=o.index,c=e.attributes.position,u=e.index,d=Is.getPrimitive(),h=Is.getPrimitive(),f=Xy,p=HIe,v=null,m=null;i&&(v=WIe,m=GIe);let g=1/0,y=null,b=null;return gf.copy(t).invert(),Xm.matrix.copy(gf),this.shapecast({boundsTraverseOrder:x=>ud.distanceToBox(x),intersectsBounds:(x,S,w)=>w<g&&w<a?(S&&(Xm.min.copy(x.min),Xm.max.copy(x.max),Xm.needsUpdate=!0),!0):!1,intersectsRange:(x,S)=>{if(e.boundsTree)return e.boundsTree.shapecast({boundsTraverseOrder:w=>Xm.distanceToBox(w),intersectsBounds:(w,_,C)=>C<g&&C<a,intersectsRange:(w,_)=>{for(let C=w*3,A=(w+_)*3;C<A;C+=3){qs(h,C,u,c),h.a.applyMatrix4(t),h.b.applyMatrix4(t),h.c.applyMatrix4(t),h.needsUpdate=!0;for(let M=x*3,P=(x+S)*3;M<P;M+=3){qs(d,M,l,s),d.needsUpdate=!0;let T=d.distanceToTriangle(h,f,v);if(T<g&&(p.copy(f),m&&m.copy(v),g=T,y=M/3,b=C/3),T<n)return!0}}}});{let w=u?u.count:c.count;for(let _=0,C=w;_<C;_+=3){qs(h,_,u,c),h.a.applyMatrix4(t),h.b.applyMatrix4(t),h.c.applyMatrix4(t),h.needsUpdate=!0;for(let A=x*3,M=(x+S)*3;A<M;A+=3){qs(d,A,l,s),d.needsUpdate=!0;let P=d.distanceToTriangle(h,f,v);if(P<g&&(p.copy(f),m&&m.copy(v),g=P,y=A/3,b=_/3),P<n)return!0}}}}}),Is.releasePrimitive(d),Is.releasePrimitive(h),g===1/0?null:(r.point?r.point.copy(p):r.point=p.clone(),r.distance=g,r.faceIndex=y,i&&(i.point?i.point.copy(m):i.point=m.clone(),i.point.applyMatrix4(gf),p.applyMatrix4(gf),i.distance=p.sub(i.point).length(),i.faceIndex=b),r)}closestPointToPoint(e,t={},r=0,i=1/0){let n=r*r,a=i*i,o=1/0,s=null;if(this.shapecast({boundsTraverseOrder:c=>(Km.copy(e).clamp(c.min,c.max),Km.distanceToSquared(e)),intersectsBounds:(c,u,d)=>d<o&&d<a,intersectsTriangle:(c,u)=>{c.closestPointToPoint(e,Km);let d=e.distanceToSquared(Km);return d<o&&(Xy.copy(Km),o=d,s=u),d<n}}),o===1/0)return null;let l=Math.sqrt(o);return t.point?t.point.copy(Xy):t.point=Xy.clone(),t.distance=l,t.faceIndex=s,t}getBoundingBox(e){return e.makeEmpty(),this._roots.forEach(t=>{Js(0,new Float32Array(t),MB),e.union(MB)}),e}},Qm=Ac(Vye()),$Ie=.5*(Math.sqrt(3)-1),Zm=(3-Math.sqrt(3))/6,qIe=1/3,zs=1/6,Qv=e=>Math.floor(e)|0,EB=new Float64Array([1,1,-1,1,1,-1,-1,-1,1,0,-1,0,1,0,-1,0,0,1,0,-1,0,1,0,-1]),a_=new Float64Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]);function o_(e=Math.random){let t=uW(e),r=new Float64Array(t).map(n=>EB[n%12*2]),i=new Float64Array(t).map(n=>EB[n%12*2+1]);return function(n,a){let o=0,s=0,l=0,c=(n+a)*$Ie,u=Qv(n+c),d=Qv(a+c),h=(u+d)*Zm,f=u-h,p=d-h,v=n-f,m=a-p,g,y;v>m?(g=1,y=0):(g=0,y=1);let b=v-g+Zm,x=m-y+Zm,S=v-1+2*Zm,w=m-1+2*Zm,_=u&255,C=d&255,A=.5-v*v-m*m;if(A>=0){let T=_+t[C],R=r[T],z=i[T];A*=A,o=A*A*(R*v+z*m)}let M=.5-b*b-x*x;if(M>=0){let T=_+g+t[C+y],R=r[T],z=i[T];M*=M,s=M*M*(R*b+z*x)}let P=.5-S*S-w*w;if(P>=0){let T=_+1+t[C+1],R=r[T],z=i[T];P*=P,l=P*P*(R*S+z*w)}return 70*(o+s+l)}}function YIe(e=Math.random){let t=uW(e),r=new Float64Array(t).map(a=>a_[a%12*3]),i=new Float64Array(t).map(a=>a_[a%12*3+1]),n=new Float64Array(t).map(a=>a_[a%12*3+2]);return function(a,o,s){let l,c,u,d,h=(a+o+s)*qIe,f=Qv(a+h),p=Qv(o+h),v=Qv(s+h),m=(f+p+v)*zs,g=f-m,y=p-m,b=v-m,x=a-g,S=o-y,w=s-b,_,C,A,M,P,T;x>=S?S>=w?(_=1,C=0,A=0,M=1,P=1,T=0):x>=w?(_=1,C=0,A=0,M=1,P=0,T=1):(_=0,C=0,A=1,M=1,P=0,T=1):S<w?(_=0,C=0,A=1,M=0,P=1,T=1):x<w?(_=0,C=1,A=0,M=0,P=1,T=1):(_=0,C=1,A=0,M=1,P=1,T=0);let R=x-_+zs,z=S-C+zs,F=w-A+zs,H=x-M+2*zs,N=S-P+2*zs,U=w-T+2*zs,ie=x-1+3*zs,te=S-1+3*zs,X=w-1+3*zs,W=f&255,q=p&255,$=v&255,le=.6-x*x-S*S-w*w;if(le<0)l=0;else{let V=W+t[q+t[$]];le*=le,l=le*le*(r[V]*x+i[V]*S+n[V]*w)}let ee=.6-R*R-z*z-F*F;if(ee<0)c=0;else{let V=W+_+t[q+C+t[$+A]];ee*=ee,c=ee*ee*(r[V]*R+i[V]*z+n[V]*F)}let Q=.6-H*H-N*N-U*U;if(Q<0)u=0;else{let V=W+M+t[q+P+t[$+T]];Q*=Q,u=Q*Q*(r[V]*H+i[V]*N+n[V]*U)}let ne=.6-ie*ie-te*te-X*X;if(ne<0)d=0;else{let V=W+1+t[q+1+t[$+1]];ne*=ne,d=ne*ne*(r[V]*ie+i[V]*te+n[V]*X)}return 32*(l+c+u+d)}}function uW(e){let t=new Uint8Array(512);for(let r=0;r<512/2;r++)t[r]=r;for(let r=0;r<512/2-1;r++){let i=r+~~(e()*(256-r)),n=t[r];t[r]=t[i],t[i]=n}for(let r=256;r<512;r++)t[r]=t[r-256];return t}var Zo=new ta,XIe=class{constructor(e){this.weightAttribute=null;let t=e.geometry;if(!t.isBufferGeometry||t.attributes.position.itemSize!==3)throw new Error("THREE.MeshSurfaceSampler: Requires BufferGeometry triangle mesh.");t.index&&(t=t.toNonIndexed()),this.geometry=t,this.randomFunction=Math.random,this.positionAttribute=this.geometry.getAttribute("position"),this.distribution=null}build(){let e=this.positionAttribute,t=new Float32Array(e.count/3);for(let i=0;i<e.count;i+=3){let n=1;Zo.a.fromBufferAttribute(e,i),Zo.b.fromBufferAttribute(e,i+1),Zo.c.fromBufferAttribute(e,i+2),n*=Zo.getArea(),t[i/3]=n}this.distribution=new Float32Array(e.count/3);let r=0;for(let i=0;i<t.length;i++)r+=t[i],this.distribution[i]=r;return this}setRandomGenerator(e){return this.randomFunction=e,this}sample(e,t){if(this.distribution){let r=this.distribution[this.distribution.length-1],i=this.binarySearch(this.randomFunction()*r);return this.sampleFace(i,e,t)}}binarySearch(e){if(!this.distribution)return 0;let t=this.distribution,r=0,i=t.length-1,n=-1;for(;r<=i;){let a=Math.ceil((r+i)/2);if(a===0||t[a-1]<=e&&t[a]>e){n=a;break}else e<t[a]?i=a-1:r=a+1}return n}sampleFace(e,t,r){let i=this.randomFunction(),n=this.randomFunction();return i+n>1&&(i=1-i,n=1-n),Zo.a.fromBufferAttribute(this.positionAttribute,e*3),Zo.b.fromBufferAttribute(this.positionAttribute,e*3+1),Zo.c.fromBufferAttribute(this.positionAttribute,e*3+2),t.set(0,0,0).addScaledVector(Zo.a,i).addScaledVector(Zo.b,n).addScaledVector(Zo.c,1-(i+n)),Zo.getNormal(r),this}},KIe=Ac(WV()),QIe=new it,ZIe=new it,JIe=new it,$g;(e=>{function t(r){return r&&r.__isSPEObject}e.is=t})($g||($g={}));var DD=e=>class extends e{constructor(){super(...arguments),this.previousModelViewMatrix=new it,this.copyPreviousMatrix=!0,this.hiddenMatrix=new it,this.matrixWorldRigid=new it,this.shearScale=new it,this.shearScaleInv=new it}get __isSPEObject(){return!0}isDescendantOf(t){t instanceof Xr&&(t=t.uuid);let r=this;for(;r.parent;){if(r.parent.uuid===t)return!0;r=r.parent}return!1}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.parent===null?this.matrixWorld.multiplyMatrices(this.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,t=!0);for(let r of this.children)r.updateMatrixWorld(t)}updateWorldMatrix(t,r){let i=this.parent;if(t&&i!==null&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.multiplyMatrices(this.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),r)for(let n of this.children)n.updateWorldMatrix(!1,!0)}traverseChildren(t,r=0){for(let i of this.children)$g.is(i)&&i.traverseObject(t,r+1)}traverseObject(t,r=0){if(t(this,r)!==!0)for(let i of this.children)$g.is(i)&&i.traverseObject(t,r+1)}updateMatrixWorldSVD(){let t=this.matrixWorld.elements,r=[[t[0],t[4],t[8]],[t[1],t[5],t[9]],[t[2],t[6],t[10]]],{u:i,v:n,q:a}=(0,KIe.SVD)(r),o=QIe.set(i[0][0],i[0][1],i[0][2],0,i[1][0],i[1][1],i[1][2],0,i[2][0],i[2][1],i[2][2],0,0,0,0,1),s=ZIe.set(n[0][0],n[0][1],n[0][2],0,n[1][0],n[1][1],n[1][2],0,n[2][0],n[2][1],n[2][2],0,0,0,0,1),l=JIe.copy(s).transpose();this.shearScale.makeScale(a[0],a[1],a[2]).multiply(l).premultiply(s),this.shearScaleInv.copy(this.shearScale).invert(),this.matrixWorldRigid.multiplyMatrices(o,l).copyPosition(this.matrixWorld),a.every(c=>Math.abs(a[0]-c)<.01)?this.hasNonUniformScale=!1:this.hasNonUniformScale=!0}attach(t,r){this.updateWorldMatrix(!0,!1);let i=new it().copy(this.matrixWorld).invert();return t.parent!==null&&(t.parent.updateWorldMatrix(!0,!1),i.multiply(t.parent.matrixWorld)),"hiddenMatrix"in t&&t.hiddenMatrix instanceof it?t.hiddenMatrix.premultiply(i):t.applyMatrix4(i),t.updateWorldMatrix(!1,!1),this.add(t),r!==void 0&&(this.children.pop(),this.children.splice(r,0,t)),this}copy(t,r=!1){return super.copy(t,r),this.hasNonUniformScale=t.hasNonUniformScale,this}onAfterRender(t,r,i,n,a,o){this.copyPreviousMatrix&&this.previousModelViewMatrix.copy(this.modelViewMatrix)}},eze=class extends DD(Xr){},tze=e=>e.type==="Mesh",ya=class extends eze{constructor(e){super(),this.object=e,this.matrixAutoUpdate=!1,this.hasNonUniformScale=e.hasNonUniformScale}raycast(e,t){}expand(){let e=0,t=this.object.entityChildren(e);for(;t;){let r=this.children[e];(r==null?void 0:r.object)!==t&&(r&&this.remove(r),r=new ya(t),this.add(r),this.children.splice(e,0,this.children.pop()),r.matrixWorldNeedsUpdate=!0,r.matrixAutoUpdate=!1,r.matrix=t.matrix,r.hiddenMatrix=t.hiddenMatrix),r.expand(),e+=1,t=this.object.entityChildren(e)}for(;this.children.length>e;)this.remove(this.children[e])}get visible(){var e;return this.playModeVisible!==void 0?this.playModeVisible:this.object.visible||this.object.dataPatched.visible&&((e=this.object.dataPatched.cloner)==null?void 0:e.hideBase)===!0}set visible(e){}get castShadow(){return this.object.castShadow}set castShadow(e){}get receiveShadow(){return this.object.receiveShadow}set receiveShadow(e){}get isMesh(){return tze(this.object)}get isLight(){return this.object.isLight}get layers(){return this.object.layers}set layers(e){}get isCamera(){return!1}get geometry(){if(this.object.geometry)return this.object.geometry}get material(){if(this.object.material)return this.object.material}},Ad=new k,Md=new k,cp=new it,dW=[new k(-1,1,1),new k(-1,-1,1),new k(1,-1,1),new k(1,1,1),new k(-1,1,-1),new k(-1,-1,-1),new k(1,-1,-1),new k(1,1,-1)],rze=[[0,3],[1,2],[5,6],[4,7],[0,1],[3,2],[7,6],[4,5],[0,4],[1,5],[2,6],[3,7]],ize=[[0,2],[7,5],[4,1],[3,6],[4,3],[1,6]],TB=(e,t,r)=>{e.updateEntityBoxSize(Ad,Md),cp.copy(t).multiply(e.matrixWorld),Md.x===0&&Md.y===0&&Md.z===0?r.push(new k(Ad.x,Ad.y,Ad.z).applyMatrix4(cp)):dW.forEach(i=>{r.push(i.clone().multiply(Md).add(Ad).applyMatrix4(cp))})},PB=class extends Ji{constructor(){super(...arguments),this.matrix=new it,this.vertices=[],this.faces=[],this.edges=[],this.centerEdges=[]}copy(e){return super.copy(e),this.matrix.copy(e.matrix),this.vertices=e.vertices.map(t=>t.clone()),this.faces=e.faces.map(t=>t.clone()),this.edges=e.edges.map(t=>t.clone()),this.centerEdges=e.centerEdges.map(t=>t.clone()),this}setFromObjectSize(e,t=!1){e.updateWorldMatrix(!1,t),this.makeEmpty(),this.matrix.copy(e.matrixWorld);let r=new it().copy(e.matrixWorld).invert();return this.expandByObjectSize(e,r,t)}expandByObjectSize(e,t,r=!1){let i=[];return r===!0?e.traverseEntity(n=>{if(n.visible||n.cloner&&n.data.visible){if(!("geometry"in n)){i.push(new k);return}TB(n,t,i)}}):TB(e,t,i),this.setFromPoints(i)}getCenter(e){return e=super.getCenter(e),e.applyMatrix4(this.matrix),e}getPositionToCenter(e){return e=super.getCenter(e),e.applyMatrix4(cp.copy(this.matrix).setPosition(0,0,0)),e}computeVertices(){this.getSize(Md).multiplyScalar(.5),this.getCenter(Ad),cp.copy(this.matrix).setPosition(Ad),this.vertices=dW.map(e=>e.clone().multiply(Md).applyMatrix4(cp))}computeEdges(){this.vertices.length>0&&this.computeVertices(),this.edges=rze.map(([e,t])=>new jo(this.vertices[e],this.vertices[t])),this.centerEdges=this.edges.map(e=>e.getCenter(new k))}computeFaces(){this.vertices.length>0&&this.computeVertices(),this.faces=ize.map(([e,t])=>this.vertices[e].clone().add(this.vertices[t]).multiplyScalar(.5))}},vu={Cloner:()=>{},changeEntityProptotype:()=>{},createEntity:()=>{}},nze=class extends b8{constructor(){super()}getPoints(e=12){let t=[],r,i=this.getCurveLengths(),n=i[i.length-1]/i.length;for(let a=0,o=this.curves;a<o.length;a++){let s=o[a],l=a===0?i[a]:i[a]-i[a-1],c=Math.ceil(e*l/n),u=s.getPoints(c);for(let d=0;d<u.length;d++){let h=u[d];r&&r.equals(h)||(t.push(h),r=h)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}},SE=.001;function CE(e,t,r){return t.clone().sub(e).cross(t.clone().sub(r)).length()<=SE}function s_(e,t){let r=new k(...e.position),i=new k(...e.controlNext.position),n=new k(...t.controlPrevious.position),a=new k(...t.position);return CE(r,i,a)&&CE(r,n,a)}function hW(e){let t=e.points.map(u=>new k(...u.data.position)),r=[e.points[0]],i=new k(...r[0].data.position);for(let u=0;u<e.points.length-1;u++)CE(i,t[u],t[u+1])||(r.push(e.points[u]),i=t[u]);r.push(e.points[e.points.length-1]);let n=e.isClosed,a=r.length-(n?0:1),o=r.length,s=[];for(let u=0;u<o;u++){let d=r[u].data,h=new k(...d.position),f=new k(...d.controlPrevious.position),p=new k(...d.controlNext.position),v={position:h,baseRoundness:d.roundness,controlPrevious:f,controlNext:p};if(d.roundness===0||!e.isClosed&&(u===0||u===o-1)){s[u]={...v,removedLength:0};continue}let m=n&&u==0?o-1:u-1,g=n&&u==o-1?0:u+1,y=r[m].data,b=r[g].data,x=new k(...y.position),S=new k(...b.position),w=x.clone().sub(h).normalize(),_=S.clone().sub(h).normalize();Object.assign(v,{prevDir:w,nextDir:_});let C=s_(y,d),A=s_(d,b);if(!C||!A)s[u]={...v,removedLength:0};else{let M=w.clone().add(_).normalize(),P=M.clone().cross(w).length()/w.dot(M);s[u]={...v,tan:P,removedLength:d.roundness/P}}}for(let u=0;u<a;u++){let d=u,h=n&&u===o-1?0:u+1,f=s[d],p=s[h];if(f.removedLength!==0||p.removedLength!==0){let v=f.position.distanceTo(p.position);f.removedLength=Math.min(f.removedLength,v/2),p.removedLength=Math.min(p.removedLength,v/2)}}let l=[];for(let u=0;u<a;u++){let d=u,h=n&&u===o-1?0:u+1,f=s[d],p=s[h],v=null;if(!s_(r[d].data,r[h].data))f.position.distanceTo(p.position)>SE&&(v=new Ub(f.position,f.controlNext,p.controlPrevious,p.position));else{let m=f.position.clone(),g=p.position.clone();(f.removedLength!==0||p.removedLength!==0)&&(f.nextDir&&m.add(f.nextDir.clone().setLength(f.removedLength)),p.prevDir&&g.add(p.prevDir.clone().setLength(p.removedLength))),m.distanceTo(g)>SE&&(v=new Ub(m,m.clone().lerp(g,.3),g.clone().lerp(m,.3),g))}l[2*u+1]=v}for(let u=0;u<o;u++){let d=s[u];if(d.removedLength===0){l[2*u]=null;continue}let h=d.position,f=d.prevDir.clone().multiplyScalar(d.removedLength).add(h),p=d.nextDir.clone().multiplyScalar(d.removedLength).add(h),v=d.tan*d.removedLength,m=d.prevDir.clone().add(d.nextDir).normalize(),g=f.clone().lerp(p,.5),y=f.distanceTo(p)/2,b=m.clone().multiplyScalar(Math.sqrt(Math.pow(v,2)-Math.pow(y,2))).add(g),x=m.clone().multiplyScalar(-v).add(b),S=h.distanceTo(x)/h.distanceTo(g),w=d.prevDir.clone().multiplyScalar(S*h.distanceTo(f)).add(h),_=w.clone().lerp(x,2),C=f.clone().lerp(w,4/3),A=p.clone().lerp(_,4/3);l[2*u]=new Ub(f,C,A,p)}let c=new nze;return l.forEach(u=>{u&&c.add(u)}),c}var _r;(e=>{function t(r){return r&&r.__isEntity}e.is=t})(_r||(_r={}));var ql=e=>_r.is(e),aze={type:"completeState",isfromEntity:!0},oze=["x","y","z"],l_=new k,sze=new k().set(0,1,0),OD=e=>class extends DD(e){constructor(){super(...arguments),this.raycastLock=!1,this.scaleLock=!1,this.disposed=!1,this.stateSelection=null,this.destroyedInAction=!1,this.instances=[],this.prevState=null,this.currentState=null,this.reversibleToState=null,this.currentTransitionEvent=null,this.previousAction=null,this._singleBBox=new PB,this._recursiveBBox=new PB,this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0,this._needApplyPathSnapping=!0,this.attachedPaths=new Set}get __isEntity(){return!0}entityChildren(t){let r=this.children[t];if(_r.is(r))return r}entityChildrenCount(){let t=this.children.length;for(;t--;)if(_r.is(this.children[t]))return t+1;return 0}get isConcreteEntity(){return typeof this.identity=="string"}get isVirtualEntity(){return typeof this.identity!="string"}get isInstanceRoot(){return this.isConcreteEntity&&this.data.type==="Instance"}nearestInstanceSelfOrParent(){let t=this;for(;t.data.type!=="Instance";){let r=t.parent;if(_r.is(r))t=r;else return}return t}forInstancesRec(t){this.instances.forEach(r=>{r.disposed||t(r),r.forInstancesRec(t)})}super_Entity(t,r){typeof t=="string"&&(this.uuid=t),this.identity=t,this.data=r,this.matrixAutoUpdate=!1,this.dataPatched=this.data}changeSelectedState(t,r,i=!1){if(!(this.data.states.length===0&&!i)){for(let n of this.data.states)Bd.toOps(this.data,n.data).forEach(a=>{let o=o1.replaceProps(a,this.data);this.dataPatched=this.data,this.updateByPatchedOp(o,this.data,r)});if(t!==null){let n=this.data.states.data(t);n&&(this.dataPatched=Bd.patch(this.data,n),Bd.toOps(this.data,n).forEach(a=>{this.updateByPatchedOp(a,this.dataPatched,r)}))}i&&this.updateTransformState(this.dataPatched,r),this.stateSelection=t,this.updatePathSnapping(this.dataPatched.pathSnapping)}}get singleBBox(){return this.singleBBoxNeedsUpdate&&(this.singleBBoxNeedsUpdate=!1,this._singleBBox.setFromObjectSize(this,!1),this._singleBBox.computeVertices(),this._singleBBox.computeEdges(),this._singleBBox.computeFaces()),this._singleBBox}get recursiveBBox(){return this.recursiveBBoxNeedsUpdate&&(this.recursiveBBoxNeedsUpdate=!1,this._recursiveBBox.setFromObjectSize(this,!0),this._recursiveBBox.computeVertices(),this._recursiveBBox.computeEdges(),this._recursiveBBox.computeFaces()),this._recursiveBBox}updateEntityBoxSize(t,r){t.setScalar(0),r.setScalar(0)}resetBBoxNeedsUpdateSelf(){this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0}resetBBoxNeedsUpdate(){this.resetBBoxNeedsUpdateSelf(),this.traverseAncestors(t=>{ql(t)&&t.resetBBoxNeedsUpdateSelf()}),this.traverseEntity(t=>{t.resetBBoxNeedsUpdateSelf()})}find(t){let r;return this.traverseEntity(i=>{i.uuid===t&&(r=i)}),r}traverseSortNextHelper(){let t=this.parent;if(t){let r=t.children,i=r.indexOf(this)+1;if(_r.is(r[i]))return r[i];if(_r.is(t))return t.traverseSortNextHelper()}}sortNext(){let t=this.children;return this.children.length>0&&_r.is(this.children[0])?t[0]:this.traverseSortNextHelper()}goUp(t){let r=this;for(;t>0&&r!==null;)r=r.parent,t-=1;return r}hasAnccestorOrSelf(t){return this===t||this.hasAnccestor(t)}hasAnccestor(t){let r=this.parent;for(;r;){if(t===r)return!0;r=r.parent}return!1}countToAccestor(t){let r=0,i=this;for(;i!==t;){if(i===null)return-1;i=i.parent,r+=1}return r}forEachEntity(t){for(let r of this.children)ql(r)&&t(r)}traverseEntityAncestors(t){this.traverseAncestors(r=>{_r.is(r)&&t(r)})}traverseConcreteEntity(t,r=0){if(t(this,r)!==!0)for(let i of this.children)ql(i)&&i.isConcreteEntity&&i.traverseEntity(t,r+1)}traverseEntity(t,r=0){if(t(this,r)!==!0)for(let i of this.children)ql(i)&&i.traverseEntity(t,r+1)}traverseVisibleEntity(t){t(this);for(let r of this.children)ql(r)&&r.visible&&r.traverseVisibleEntity(t)}updateMatrix(){super.updateMatrix(),this.cloner&&this.cloner.onObjUpdateMatrix(),this.dispatchEvent({type:"updateMatrix"})}updateMatrixWorld(t){super.updateMatrixWorld(t),this.dispatchEvent({type:"updateMatrixWorld"})}copy(t,r=!1){return super.copy(t,r),this.dataPatched=t.dataPatched,this.raycastLock=t.raycastLock,this.scaleLock=t.scaleLock,this.hiddenMatrix.copy(t.hiddenMatrix),this}hasEntityChild(){return this.children.some(t=>ql(t))}isAncestorOf(t){if(this.uuid===t)return!1;let r=!1;return this.traverseEntity(i=>{i.uuid===t&&(r=!0)}),r}toObjectTransformState(t=[]){this.updateWorldMatrix(!0,!1);let r={position:this.position.toArray(),rotation:[this.rotation.x*St.RAD2DEG,this.rotation.y*St.RAD2DEG,this.rotation.z*St.RAD2DEG],scale:this.scale.toArray(),hiddenMatrix:this.hiddenMatrix.toArray()};return OM(r,t)}getTransformValues(t,r,i){return r[t].map((n,a)=>(i==null?void 0:i.shared.getVariable(n,[this.uuid,t,oze[a]]))??n)}updateTransformState(t,r){let i=!1;return t.position&&(this.position.fromArray(this.getTransformValues("position",t,r)),i=!0),t.rotation&&(l_.fromArray(this.getTransformValues("rotation",t,r)).multiplyScalar(St.DEG2RAD),this.rotation.setFromVector3(l_),i=!0),t.scale&&(this.scale.fromArray(this.getTransformValues("scale",t,r)),i=!0),t.hiddenMatrix!==void 0&&(i=!0,this.hiddenMatrix.fromArray(t.hiddenMatrix??Up.identity)),i&&(this.updateMatrix(),this.resetBBoxNeedsUpdate(),this.invalidateClonerTransform(this),this.traverseEntityAncestors(n=>{n.invalidateClonerTransform(this)})),t.position&&t.rotation&&t.scale&&t.hiddenMatrix!==void 0&&this.updateWorldMatrix(!1,!0),i}onVariableUpdate(t=!1){if(t){this.resetBBoxNeedsUpdate();return}this.updateMatrix(),this.resetBBoxNeedsUpdate(),this.invalidateClonerTransform(this),this.traverseEntityAncestors(r=>{r.invalidateClonerTransform(this)})}dispose(){this.disposed=!0,this.cloner&&(this.cloner.removeFromParent(),this.cloner=void 0)}disposeChildrenRecursively(){for(let t of this.children)_r.is(t)&&t.disposeRecursively()}disposeRecursively(){this.dispose(),this.children.forEach(t=>{_r.is(t)&&t.disposeRecursively()})}toState(t=[]){let r={name:this.name,visible:this.visible,raycastLock:this.raycastLock,...this.toObjectTransformState(t)};return OM(r,t)}updateByObjUpdateOp(t,r){t!==void 0&&this.updateByOp({type:0,props:t,path:[]},{...this.data,...t},r,!1)}updateByOp(t,r,i,n){let a=this.data;this.data=r;let o=t,s=li(t.path,["states","*"]);if(s!==null){if(t.type===0){let[l]=s;if((this==null?void 0:this.stateSelection)===l){let c={...t.props};if(delete c.name,Object.values(t.props).some(u=>u===void 0)){let u=this.data;if(u!==void 0){let d=xn.zoom(u,t.path.slice(2));if(d)for(let h in t.props)t.props[h]===void 0&&h in d&&(c[h]=d[h])}}o={...t,props:c,path:t.path.slice(2)}}}}else if(t.type===0){let l=this.stateSelection?this.data.states.data(this.stateSelection):void 0;if(l!==void 0){if(t.props.name!==void 0&&l.name){let{name:u,...d}=l;l=d}if(t.props.material!==void 0&&"material"in l){let{material:u,...d}=l;l=d}let c=xn.removeOverridden(t.path,t.props,l);o={...t,props:c}}}if(this.updateByPatchedOpBase(o,Bd.patch(this.data,this.stateSelection?this.data.states.data(this.stateSelection):void 0),i),li(t.path,["overrides"])){let l=[],c=[...t.path];for(l.push(c[1]),c.splice(0,2);c.length>0&&c[0]==="descendants";)l.push(c[1]),c.splice(0,2);if(l[l.length-1]===void 0){if(t.type===0)for(let u of Object.keys(t.props)){l[l.length-1]=u;let d=i.scene.findInstance([this.uuid,...l]);d&&(d.overrideData=t.props[u],d.updateState(Mu.apply(d.component.data,d.overrideData),i))}}else{let u=i.scene.findInstance([this.uuid,...l]);if(u){let d=xn.zoom(u.component.data,c);if(t={...t,path:c},t.type===0){let h=t.props;if(d)for(let[f,p]of Object.entries(t.props))p===void 0&&(h===t.props&&(h={...t.props}),h[f]=d[f]);t={...t,props:h}}u.overrideData=g1.resolve(r.overrides,l),u.updateByOp(t,Bn.applySimple(u.data,t),i,!1)}}}else if(this.instances.length>0){let l;if(t.path.length===0&&t.type===0){let c;for(let u of pu.rootOverrideProps)u in t.props&&(c===void 0&&(c={}),c[u]=t.props[u]);c&&(l={...t,props:c})}else for(let c of pu.rootOverrideProps)if(li(t.path,[c])){l=t;break}l!==void 0&&this.instances.forEach(c=>{if(c.isInstanceRoot){let u=Mu.filterOp(c.overrideData,l);u&&c.updateByOp(u,Bn.applySimple(c.data,u),i,!0)}}),this.instances.forEach(c=>{if(!c.isInstanceRoot){let u=Mu.filterOp(c.overrideData,t);if(u){let d;a===c.data&&t===u?d=r:d=Bn.applySimple(c.data,u),c.updateByOp(u,d,i,!0)}}})}}updateByPatchedOpBase(t,r,i){if(this.dataPatched=r,t.path.length===0&&t.type===0)t.props.type!==void 0&&!gh.is(t.props.type)&&vu.changeEntityProptotype(this,r,i);else if(t.path.length===1&&t.path[0]==="geometry"&&t.type===0&&"type"in t.props){vu.changeEntityProptotype(this,r,i);for(let n of this.children)_r.is(n)&&n.updateVisible(i.scene)}this.updateByPatchedOp(t,r,i)}updateByPatchedOp(t,r,i){if(t.path.length===0&&t.type===0&&this.updateState(t.props,i),li(t.path,["pathSnapping"])!==null&&this.updatePathSnapping(r.pathSnapping),li(t.path,["cloner"])!==null){let n=Bn.drop(t,1);n.path.length===0&&n.type===0&&n.props.disabled===!0?this.setFromClonerState(null,i):this.cloner?this.cloner.updateState(r.cloner,i.scene):(this.setFromClonerState(r.cloner,i),this.expandCloner(i.scene)),this.updateVisible(i.scene)}}updatePathSnapping(t=this.dataPatched.pathSnapping){this._updatedPathSnapping=t,this._needApplyPathSnapping=!0}get updatedPathSnapping(){return this._updatedPathSnapping}applyPathSnapping(t){var p,v,m,g,y;let r=((p=this._updatedPathSnapping)==null?void 0:p.pathId)??this.dataPatched.pathSnapping.pathId,i=((v=this._updatedPathSnapping)==null?void 0:v.slide)??this.dataPatched.pathSnapping.slide??0,n=((m=this._updatedPathSnapping)==null?void 0:m.offset)??this.dataPatched.pathSnapping.offset??0,a=((g=this._updatedPathSnapping)==null?void 0:g.orientation)??this.dataPatched.pathSnapping.orientation;if(r===null)return;let o=t.find(r);if(!o||this._needApplyPathSnapping===!1)return;this._needApplyPathSnapping=!1;let s=o.data;if(s.geometry.path.points.length<=1)return;let l=hW(s.geometry.path),c=(i+n)%1;i+n===1&&c===0&&(c=1);let u=l.curves.length?l.getPointAt(c):null;if(u===null)return;let d=this.parent?(y=this.parent)==null?void 0:y.matrixWorld:new it;o.updateMatrixWorld();let h=new it().multiplyMatrices(d.clone().invert(),o.matrixWorld);u.applyMatrix4(h);let f={position:u.toArray(),rotation:s.rotation};if(a==="tangential"){let b=new it().extractRotation(o.matrixWorld),x=l.getTangentAt(c).applyMatrix4(b).add(u),S=new it().lookAt(u,x,sze),w=l_.setFromEuler(new bn().setFromRotationMatrix(S)).multiplyScalar(St.RAD2DEG);f={...f,rotation:w.toArray()}}this.updateTransformState(f),this.traverseEntity(b=>{b._cameraType&&b.dispatchEvent(aze)})}updateVisible(t){var i;if(this.visible=this.dataPatched.visible&&(!this.dataPatched.cloner||(this.dataPatched.cloner.disabled??!1)||((i=this.dataPatched.cloner)==null?void 0:i.hideBase)!==!0),!t)return;let r=!1;this.traverseEntity(n=>{if(n.data.type==="Splat")return r=!0,!0}),r&&t.reloadSplats()}updateState_Entity(t,r){t.name!==void 0&&(this.name=t.name),t.raycastLock!==void 0&&(this.raycastLock=t.raycastLock),t.visible!==void 0&&(this.updateVisible(r==null?void 0:r.scene),this.resetBBoxNeedsUpdate()),r&&"cloner"in t&&t.cloner!==void 0&&(this.setFromClonerState(t.cloner,r),this.updateVisible(r.scene)),this.updateTransformState(t,r)}get attachedSurfaceCloners(){return this.children.filter(t=>t instanceof vu.Cloner&&t.parameters.type==="toObject")}setFromClonerState(t,r){this.disposed||(t===null||t.disabled?(this.cloner&&this.cloner.removeFromParent(),this.cloner=void 0):this.cloner===void 0?(this.cloner=new vu.Cloner(this,t),r.scene.addPendingExpandCloner(this)):this.cloner.updateState(t,r.scene))}expandCloner(t){!this.disposed&&this.cloner&&this.cloner.expandClones(t)}invalidateClonerTransform(t){this.cloner&&this.cloner.invalidateTransform(t)}requestRender(){this.dispatchEvent({type:"requestRender"})}},fW=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,radialSegments:64,heightSegments:1,openEnded:!1,thetaStart:0,thetaLength:360,cornerRadius:8,cornerSegments:8,hollow:0},e.parameters);r.thetaLength=St.clamp(r.thetaLength,0,360);let i=r.width/2,n=r.radiusTop??i,a=r.radiusBottom??i;return n===a?(n=i,a=i):n>a?(n=i,a=a*i/n):(n=n*i/a,a=i),{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width),radiusTop:n,radiusBottom:a})}}static build(e){let{width:t,depth:r,height:i,radialSegments:n,heightSegments:a,openEnded:o,thetaStart:s,thetaLength:l,radiusTop:c,radiusBottom:u,cornerRadius:d,cornerSegments:h,hollow:f}=e.parameters,p;return l===0?(p=new Ot,p.setAttribute("position",new yt([],3))):d||f?p=new pW(c,u,i,n,a,o,s,l*Math.PI/180,d,d,h,f):p=new XP(c,u,i,n,a,o,s,l*Math.PI/180),p.scale(1,1,r/t),Object.assign(p,{userData:{...e,type:"CylinderGeometry"}})}};function Vc(e,t,r){r.x=e.x*t.x,r.y=e.y,r.z=e.x*t.y}function DB(e){return new ye(e.y,-e.x)}var pW=class extends Ot{constructor(e,t,r,i,n,a,o,s,l,c,u,d,h=!1){super(),this.type="RoundedCylinderBufferGeometry",e=e!==void 0?e:1,t=t!==void 0?t:1,r=r||1,i=Math.floor(i)||8,n=Math.floor(n)||1,a=a!==void 0?a:!1,o=o!==void 0?o:0,s=s!==void 0?s:Math.PI*2,a&&(l=0,c=0);let f=[],p=[],v=[],m=[],g=0,y=r/2,b=new k,x=new k;h&&e==0&&(e=l),h&&t==0&&(t=c);let S=new ye(e,y),w=new ye(t,-y),_=null,C=null,A=null,M=null,P=S.clone().sub(w),T=0,R=0,z=0;d>0&&(T=Math.min(e,t)*(1-d),R=e-T,z=t-T);let F=S.clone();F.x-=T;let H=Math.PI-P.angle(),N=P.angle(),U=Math.tan(N/2),ie=Math.tan(H/2),te=U+ie,X=d?te:ie,W=d?te:U;if(l=Math.min(l,(e-R)/X,P.length()/te),c=Math.min(c,(t-z)/W,P.length()/te),l>0){let ne=l/U;_=S.clone().sub(new ye(ne,l)),d&&(A=_.clone(),A.x-=T-te*l),S.sub(P.clone().setLength(ne))}if(c>0){let ne=c/ie;C=w.clone().sub(new ye(ne,-c)),w.add(P.clone().setLength(ne)),d&&(M=C.clone(),M.x-=T-te*c,F.sub(P.clone().setLength(ne)))}P=S.clone().sub(w);let q=P.length()<.5,$=[];for(let ne=0;ne<=i;ne++){let V=[],ue=ne/i,ve=ue*s+o,Ce=new ye(Math.sin(ve),Math.cos(ve));M&&C?(le(V,ue,Ce,H,c,M,-1,!0),le(V,ue,Ce,N,c,C,-1,!1)):C?(ee(V,Ce,C.x,0,-1),le(V,ue,Ce,N,c,C,-1,!1)):a||ee(V,Ce,t,z,-1);let G=DB(P).normalize();if(Vc(G,Ce,b),!q)for(let Z=0;Z<=n;Z++){let de=Z/n,Se=P.clone().multiplyScalar(de).add(w);Vc(Se,Ce,x),p.push(x.x,x.y,x.z),v.push(b.x,b.y,b.z),m.push(ue,.5+x.y/r),V.push(g++)}if(A&&_?(le(V,ue,Ce,H,l,_,1,!1),le(V,ue,Ce,N,l,A,1,!0)):_?(le(V,ue,Ce,H,l,_,1,!1),ee(V,Ce,_.x,0,1)):a||ee(V,Ce,e,R,1),d&&!q){let Z=DB(P).multiplyScalar(-1).normalize();Vc(Z,Ce,b);for(let de=0;de<=n;de++){let Se=de/n,we=P.clone().multiplyScalar(-Se).add(F);Vc(we,Ce,x),p.push(x.x,x.y,x.z),v.push(b.x,b.y,b.z),m.push(ue,.5+x.y/r),V.push(g++)}}d&&!a&&V.push(V[0]),$.push(V)}for(let ne=0;ne<$.length-1;ne++)for(let V=0;V<$[0].length-1;V++){if(a&&d&&V==n)continue;let ue=$[ne][V],ve=$[ne+1][V],Ce=$[ne+1][V+1],G=$[ne][V+1],Z=p[Ce*3+0],de=p[Ce*3+2];f.push(ue,ve,G),(Z!=0||de!=0)&&f.push(ve,Ce,G)}s<Math.PI*2&&(Q(-1,$[0],o),Q(1,$[$.length-1],o+s)),this.setIndex(f),this.setAttribute("position",new yt(p,3)),this.setAttribute("normal",new yt(v,3)),this.setAttribute("uv",new yt(m,2));function le(ne,V,ue,ve,Ce,G,Z,de){for(let Se=0;Se<u+1;Se++){let we=Se/u,_e=Z<0?we:1-we;de&&(_e-=1),_e*=ve;let Ee=new ye(Math.sin(_e),Math.cos(_e)*Z),fe=Ee.clone().multiplyScalar(Ce).add(G);Vc(fe,ue,x),p.push(x.x,x.y,x.z),Vc(Ee,ue,b),v.push(b.x,b.y,b.z),m.push(V,.5+x.y/r),ne.push(g++)}}function ee(ne,V,ue,ve,Ce){let G=new k,Z=new ye,de=[ue,ve];Ce<0&&de.reverse();for(let Se of de)Z.set(Se,y*Ce),Vc(Z,V,G),p.push(G.x,G.y,G.z),v.push(0,Ce,0),m.push(.5,.5),ne.push(g++)}function Q(ne,V,ue){let ve=new ye(Math.sin(ue),Math.cos(ue)),Ce=new ye(-Math.cos(ue),Math.sin(ue)),G=new k,Z=ne<0?(we,_e,Ee)=>f.push(we,_e,Ee):(we,_e,Ee)=>f.push(we,Ee,_e),de=new ye((e+t+R+z)/4,0);Vc(de,ve,G),p.push(G.x,G.y,G.z),v.push(Ce.x,0,Ce.y),m.push(.5,.5);let Se=g++;for(let we of V){let _e=p.slice(we*3,we*3+3);p.push(..._e),v.push(Ce.x,0,Ce.y);let Ee=m.slice(we*2,we*2+2);m.push(...Ee),g++}for(let we=Se+1;we<g-1;we++)Z(Se,we,we+1);Z(Se,g-1,Se+1)}}},lze=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,radialSegments:32,heightSegments:8,openEnded:!1,thetaStart:0,thetaLength:360,cornerRadiusTop:8,cornerRadiusBottom:8,cornerSegments:8},e.parameters);return r.thetaLength=St.clamp(r.thetaLength,0,360),{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(e){let{width:t,depth:r,height:i,radialSegments:n,heightSegments:a,openEnded:o,thetaStart:s,thetaLength:l,cornerRadiusTop:c,cornerRadiusBottom:u,cornerSegments:d}=e.parameters,h;return l===0?(h=new Ot,h.setAttribute("position",new yt([],3))):c>0||u>0||l<360?h=new pW(0,t/2,i,n,a,o,s,l*Math.PI/180,c,u,d,0,!0):h=new KP(t/2,i,n,a,o),h.scale(1,1,r/t),Object.assign(h,{userData:{...e,type:"ConeGeometry"}})}},cze=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,widthSegments:1,heightSegments:1,depthSegments:1,cornerRadius:8,cornerSegments:8},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(e){let{width:t,height:r,depth:i,widthSegments:n,heightSegments:a,depthSegments:o,cornerRadius:s,cornerSegments:l}=e.parameters,c;return s===0?c=new ws(t,r,i,n,a,o):c=new uze(t,r,i,n,a,o,s,l),Object.assign(c,{userData:{...e,type:"CubeGeometry"}})}},c_=Math.PI/2,uze=class extends Ot{constructor(e=1,t=1,r=1,i=1,n=1,a=1,o=0,s=4){super(),this.type="BoxGeometry",i=Math.floor(i),n=Math.floor(n),a=Math.floor(a),s=Math.floor(s),o=Math.min(o,e/2,t/2,r/2);let l=[],c=[],u=[],d=[],h=0;f("z","y","x",-1,-1,r,t,e,a,n),f("z","y","x",1,-1,r,t,-e,a,n),f("x","z","y",1,1,e,r,t,i,a),f("x","z","y",1,-1,e,r,-t,i,a),f("x","y","z",1,-1,e,t,r,i,n),f("x","y","z",-1,-1,e,t,-r,i,n),o>0&&(p("z","y","x",-1,-1,1,r,t,e,a),p("z","y","x",1,-1,-1,r,t,e,a),p("z","y","x",-1,1,-1,r,t,e,a),p("z","y","x",1,1,1,r,t,e,a),p("x","y","z",-1,-1,-1,e,t,r,i),p("x","y","z",1,-1,1,e,t,r,i),p("x","y","z",-1,1,1,e,t,r,i),p("x","y","z",1,1,-1,e,t,r,i),p("y","x","z",-1,-1,1,t,e,r,n),p("y","x","z",1,-1,-1,t,e,r,n),p("y","x","z",1,1,1,t,e,r,n),p("y","x","z",-1,1,-1,t,e,r,n),v(1,1,1),v(-1,1,1),v(1,-1,1),v(-1,-1,1),v(1,1,-1),v(-1,1,-1),v(1,-1,-1),v(-1,-1,-1)),this.setIndex(l),this.setAttribute("position",new yt(c,3)),this.setAttribute("normal",new yt(u,3)),this.setAttribute("uv",new yt(d,2));function f(m,g,y,b,x,S,w,_,C,A){let M=(S-2*o)/C,P=(w-2*o)/A,T=S/2-o,R=w/2-o,z=_/2,F=C+1,H=A+1,N=0,U=new k;for(let ie=0;ie<H;ie++){let te=ie*P-R;for(let X=0;X<F;X++){let W=X*M-T;U[m]=W*b,U[g]=te*x,U[y]=z,c.push(U.x,U.y,U.z),U[m]=0,U[g]=0,U[y]=_>0?1:-1,u.push(U.x,U.y,U.z),d.push(X/C),d.push(1-ie/A),N+=1}}for(let ie=0;ie<A;ie++)for(let te=0;te<C;te++){let X=h+te+F*ie,W=h+te+F*(ie+1),q=h+(te+1)+F*(ie+1),$=h+(te+1)+F*ie;l.push(X,W,$),l.push(W,q,$)}h+=N}function p(m,g,y,b,x,S,w,_,C,A){let M=(w-2*o)/A,P=w/2-o,T=_/2-o,R=C/2,z=A+1,F=0,H=new k,N=new k;for(let U=0;U<s+1;U++){let ie=U/s*c_,te=Math.sin(ie)*o,X=(1-Math.cos(ie))*o,W=Math.sin(ie),q=Math.cos(ie);H[g]=(T+te)*x,H[y]=(R-X)*S,N[m]=0,N[g]=W*Math.sign(H[g]),N[y]=q*Math.sign(H[y]);for(let $=0;$<z;$++){let le=$*M-P;H[m]=le*b,c.push(H.x,H.y,H.z),u.push(N.x,N.y,N.z),d.push($/A),d.push(0),F+=1}}for(let U=0;U<s;U++)for(let ie=0;ie<A;ie++){let te=h+ie+z*U,X=h+ie+z*(U+1),W=h+(ie+1)+z*(U+1),q=h+(ie+1)+z*U;l.push(te,X,q),l.push(X,W,q)}h+=F}function v(m,g,y){let b=new k,x=new k(e/2,t/2,r/2);x.subScalar(o);let S=[],w=m*g*y>0?(C,A,M)=>l.push(C,A,M):(C,A,M)=>l.push(C,M,A);for(let C=0;C<=s;C++){let A=[],M=c_*(1-C/s),P=Math.cos(M),T=Math.sin(M),R=0;for(let z=0;z<=C;z++){let F=Math.cos(R),H=Math.sin(R);b.x=P*F,b.y=T,b.z=P*H;let N=x.clone().addScaledVector(b,o);c.push(m*N.x,g*N.y,y*N.z),u.push(m*b.x,g*b.y,y*b.z),d.push(0,0),A.push(h++),R+=c_/C}S.push(A)}let _=S.length-1;for(let C=0;C<_;C++){let A=S[C],M=S[C+1],P=A.length-1;w(A[0],M[1],M[0]);for(let T=1;T<=P;T++)w(A[T-1],A[T],M[T]),w(A[T],M[T+1],M[T])}}}},RD=class extends Ot{constructor(e=[],t=[],r="",i=1,n=.2,a=4){super(),this.type="PolyhedronGeometryRound";let o=[],s=[],l=[];c(),u(),this.setAttribute("position",new yt(o,3)),this.setAttribute("normal",new yt(l,3)),this.setAttribute("uv",new yt(s,2));return;function c(){var N;n=Math.min(1-1e-5,n),n==0&&(a=0);let d={IcosahedronGeometry:5,DodecahedronGeometry:3,HexahedronGeometry:3,OctahedronGeometry:4,TetrahedronGeometry:3}[r],h=new k,f=h.clone(),p=new ta,v=n*i,m=i-v,g=a+1,y=new k,b=(U,ie)=>y.subVectors(U,ie).normalize(),x=(U,ie)=>Array(U).fill(void 0).map(ie),S=x(e.length/3,(U,ie)=>new k().fromArray(e,ie*3).setLength(i)),w=[],_=1e6;for(let U=0;U<S.length;U++){let ie=S[U],te=[],X,W,q,$=1e10,le=-1;for(;(le=t.indexOf(U,le+1))!=-1;){let V=le-le%3;X=t[V+(le+1)%3],W=t[V+(le+2)%3],q=ie.distanceToSquared(S[X]),$=Math.min($,q),te.push([X,W,q])}$+=1e-6;let ee=[],Q=0,ne=te.length;for(let V=0;V<ne;V++){[X,W,q]=te[Q];let ue=((N=w[X])==null?void 0:N.includes(U))==!0;q<=$&&ee.push(X+ +ue*_),Q=te.findIndex(ve=>ve[0]==W)}w.push(ee)}let C=[];{let U=0,ie=0,te,X,W=d==3;for(let q=0;q<=a;q++){te=q*(q+1)/2,X=(q+1)*(q+2)/2;for(let $=0;$<a-q;$++)[U,ie]=[te+$+q+2,X+$+q+3],C.push(te,X,...W?[ie,te]:[U,X],ie,U),[te,X]=[U,ie];C.push(te,X,te+a+2)}}let A=h.clone(),M=h.clone(),P=h.clone(),T=h.clone(),R=h.clone(),z=[],F=x(S.length,()=>x(d,()=>h.clone()));for(let U=0;U<S.length;U++){h.copy(S[U]).normalize(),A.copy(h).multiplyScalar(m);let ie=w[U];for(let ee=0;ee<ie.length;ee++){let Q=ie[ee],ne=ie[(ee+1)%d];p.setFromPointsAndIndices(S,U,Q%_,ne%_),p.b.sub(p.a).setLength(1e10).add(p.a),p.c.sub(p.a).setLength(1e10).add(p.a),p.closestPointToPoint(A,F[U][ee])}let te=[],X=[],W=[],q=new k;a==0&&[...F[U]].reduce((ee,Q)=>ee.add(Q),q).multiplyScalar(1/d);for(let ee=0;ee<d;ee++){let Q=[],ne=(ee-1+d)%d,V=F[U][ne],ue=F[U][ee];h.copy(V).sub(A),f.copy(ue).sub(A);let ve=A.angleTo(h),Ce=h.angleTo(f),G=Math.cos(ve)*v;a==0?M.copy(q):M.copy(A).setLength(m+G),X.push(G);let Z=[M,V,ue];for(let de=0;de<2;de++){let Se=Z[de],we=Z[de+1];T.subVectors(Se,A),R.subVectors(we,A),P.crossVectors(T,R).normalize();for(let _e=0;_e<g;_e++){let Ee=[ve,Ce][de]*_e/g;h.copy(T).applyAxisAngle(P,Ee).add(A),te.push(h.clone()),de&&(b(h,A),Q.push([_e==0?Se:h.clone(),y.clone()]))}de&&(b(we,A),Q.push([we,y.clone()]))}W.push(Q)}z.push(W);let $=2*g,le=2;for(let ee=0;ee<d;ee++){let Q=$*ee,ne=$*((ee+1)%d),V=[te[Q]];for(let ve=1;ve<g;ve++){T=te[Q+ve],R=te[ne+ve],V.push(T);for(let Ce=1,G=ve-le+1;Ce<=G;Ce++)h.lerpVectors(T,R,Ce/(G+1)),h.sub(A).setLength(X[ee]).add(A),V.push(h.clone());V.push(R)}for(let ve=0;ve<g;ve++)V.push(te[ve+g+Q]);V.push(te[ne+g]);let ue=C.map(ve=>V[ve]);o.push(...ue.map(ve=>[ve.x,ve.y,ve.z]).flat()),l.push(...ue.map(ve=>(b(ve,A),[y.x,y.y,y.z])).flat())}}let H=[];for(let U=0;U<w.length;U++)for(let ie=0;ie<d;ie++){let te=w[U][ie];if(te<_){let X=w[te].findIndex($=>$%_==U),W=z[U][ie],q=z[te][X];for(let $=0;$<g;$++){let le=W[$],ee=q[g-$],Q=W[$+1],ne=q[g-($+1)];[le,ee,Q,Q,ee,ne].forEach(V=>{o.push(V[0].x,V[0].y,V[0].z),l.push(V[1].x,V[1].y,V[1].z)})}H.push(W[0][0],q[g][0],W[g][0],q[0][0])}}for(;H.length;){let U,ie,te,X;[U,ie]=H.splice(0,2);let W=[U];for(;U!=ie;)W.push(ie),te=H.indexOf(ie),X=te%2,ie=H.splice(te-X,2)[1-X];y.subVectors(W[0],W[1]).cross(h.subVectors(W[0],W[2])).normalize();let q=y.dot(W[0])<0;q&&y.negate();for(let $=1;$<=W.length-2;$++)[W[$+ +q],W[$+1-+q],W[0]].forEach(le=>{o.push(le.x,le.y,le.z),l.push(y.x,y.y,y.z)})}}function u(){let d=new k;for(let w=0;w<o.length;w+=3){d.x=o[w+0],d.y=o[w+1],d.z=o[w+2];let _=x(d)/2/Math.PI+.5,C=S(d)/Math.PI+.5;s.push(_,1-C)}let h=new k,f=new k,p=new k,v=new k,m=new ye,g=new ye,y=new ye,b=(w,_,C,A)=>{A<0&&w.x===1&&(s[_]=w.x-1),C.x===0&&C.z===0&&(s[_]=A/2/Math.PI+.5)};for(let w=0,_=0;w<o.length;w+=9,_+=6){h.set(o[w+0],o[w+1],o[w+2]),f.set(o[w+3],o[w+4],o[w+5]),p.set(o[w+6],o[w+7],o[w+8]),m.set(s[_+0],s[_+1]),g.set(s[_+2],s[_+3]),y.set(s[_+4],s[_+5]),v.copy(h).add(f).add(p).divideScalar(3);let C=x(v);b(m,_+0,h,C),b(g,_+2,f,C),b(y,_+4,p,C)}for(let w=0;w<s.length;w+=6){let _=s[w+0],C=s[w+2],A=s[w+4],M=Math.max(_,C,A),P=Math.min(_,C,A);M>.9&&P<.1&&(_<.2&&(s[w+0]+=1),C<.2&&(s[w+2]+=1),A<.2&&(s[w+4]+=1))}function x(w){return Math.atan2(w.z,-w.x)}function S(w){return Math.atan2(-w.y,Math.sqrt(w.x*w.x+w.z*w.z))}}}static fromJSON(e){return new RD(e.vertices,e.indices,e.radius,e.corner,e.cornerSides)}},dze=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,detail:0,corner:0,cornerSides:4},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(e){let{width:t,height:r,depth:i,detail:n,corner:a,cornerSides:o}=e.parameters,s=n===0&&a!==0?new mW(t*.5,a,o):new w8(t*.5,n);return s.scale(1,r/t,i/t),Object.assign(s,{userData:{...e,type:"DodecahedronGeometry"}})}},mW=class extends RD{constructor(e=1,t=.2,r=4){let i=(1+Math.sqrt(5))/2,n=1/i,a=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-n,-i,0,-n,i,0,n,-i,0,n,i,-n,-i,0,-n,i,0,n,-i,0,n,i,0,-i,0,-n,i,0,-n,-i,0,n,i,0,n],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],s="DodecahedronGeometry";super(a,o,s,e,t,r),this.type=s}static fromJSON(e){return new mW(e.radius,e.corner,e.cornerSides)}},Jm=1e-12,ID=class{constructor(e){this.position=new ye,this.startPosition=new ye,this.uuid=St.generateUUID(),this.position=e.clone()}start(){this.reset()}reset(){this.startPosition.copy(this.position)}applyOffset(e){this.position.copy(this.startPosition).add(e)}copy(e){return this.position.copy(e.position),this.startPosition.copy(e.startPosition),this}clone(){return new ID(this.position).copy(this)}toJSON(){return[this.position.x,this.position.y]}},_E=class extends ID{constructor(e){super(e.position),this.parent=e}copy(e){return super.copy(e),this}clone(){return new _E(this.parent).copy(this)}},up=class extends ID{constructor(e,t){super(t),this.controls=[],this.roundness=0,this.areControlsDirectionsMirrored=!0,this.uuid=e,this.controls.push(new _E(this),new _E(this))}static create(e,t){let r=new up(e,new ye(...t.position));return r.controls[0].position.set(...t.controlPrevious.position),r.controls[1].position.set(...t.controlNext.position),r.roundness=t.roundness,r.areControlsDirectionsMirrored=t.areControlsDirectionsMirrored,r}getOppositeControl(e){let t=this.controls.indexOf(e);return t===0?this.controls[1]:t===1?this.controls[0]:null}applyOffsetToControls(e,t=1){for(let r=0,i=this.controls.length;r<i;r++){let n=this.controls[r];this.position.distanceTo(n.position)<=t?n.position.copy(this.position):n.applyOffset(e)}}controlsMoved(){return!(this.position.equals(this.controls[0].position)&&this.position.equals(this.controls[1].position))}copy(e){return super.copy(e),this.controls[0].copy(e.controls[0]),this.controls[1].copy(e.controls[1]),this.roundness=e.roundness,this.uuid=e.uuid,this}clone(){return new up(this.uuid,this.position).copy(this)}toJSON(){return super.toJSON().concat(this.controls[0].toJSON(),this.controls[1].toJSON(),[this.roundness])}computeTangents(){var r,i;let e=(r=this.curveBefore)==null?void 0:r.getTangentAt(1),t=(i=this.curveAfter)==null?void 0:i.getTangentAt(0);return[e,t]}computeNormals(e=new ye,t=new ye){let[r,i]=this.computeTangents();return r&&i&&(OB(r,e),OB(i,t)),[e,t]}computeTangent(e=new ye){let[t,r]=this.computeTangents();return t&&r&&e.copy(t).add(r).normalize(),e}computeNormal(e=new ye){let[t,r]=this.computeNormals();return e.copy(t).add(r).normalize(),e}};function OB(e,t=new ye){let r=e.length();return t.set(-e.y/r,e.x/r)}var zD=e=>e,bm=new ye,Gw=new ye,hze=new ye,fze=new ye,pze=new ye,mze=new ye,vW=new k,gW=new k;function vze(e){let t=new ye;t.addVectors(e.v0,bm.subVectors(e.v1,e.v0).multiplyScalar(2/3));let r=new ye;return r.addVectors(e.v2,Gw.subVectors(e.v1,e.v2).multiplyScalar(2/3)),new cs(e.v0,t,r,e.v2)}function Sv(e,t,r=Number.EPSILON){return Math.abs(e-t)<r}function gze(e,t,r=Number.EPSILON){return e.distanceTo(t)<r}function yze(e,t,r=Number.EPSILON){return e.distanceTo(t)<r}function yW(e,t,r){let i=Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)),n=Math.sqrt(Math.pow(t.x-r.x,2)+Math.pow(t.y-r.y,2)),a=Math.sqrt(Math.pow(r.x-e.x,2)+Math.pow(r.y-e.y,2));return Math.acos((n*n+i*i-a*a)/(2*n*i))}function bze(e,t,r){return IB(e,t)&&IB(t,r)&&AE(e.position,t.position,r.position)}function AE(e,t,r){return bm.copy(t).sub(e).cross(Gw.copy(r).sub(e))===0}function xze(e,t,r,i,n){let a=Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)),o=(e.y+t.y)/2,s=(e.x+t.x)/2,l=Math.sqrt(Math.pow(r,2)-Math.pow(a/2,2))*(e.y-t.y)/a,c=Math.sqrt(Math.pow(r,2)-Math.pow(a/2,2))*(t.x-e.x)/a;return i.set(s+l,o+c),n.set(s-l,o-c),[i,n]}function wze(e,t,r){let i=e.distanceTo(r),n=t.distanceTo(r);return i<n?t:e}function Sze(e,t,r,i,n,a){let o=t.x-e.x,s=t.y-e.y,l=r.x-e.x,c=r.y-e.y,u=Math.sqrt((o+l)*(o+l)+(s+c)*(s+c)),d;return yW(t,e,r)>Math.PI&&(u*=-1),Sv(c,s)?d=(s+c)*(i/u-.5)*8/3/(o-l):d=(o+l)*(i/u-.5)*8/3/(c-s),n.set(t.x-d*s,t.y+d*o),a.set(r.x+d*c,r.y-d*l),[n,a]}function RB(e,t){return e.position.equals(e.controls[1].position)&&t.position.equals(t.controls[0].position)}function IB(e,t){return AE(e.position,e.controls[1].position,t.position)&&AE(e.position,t.controls[0].position,t.position)}function Cze(e,t,r,i,n=.5){let a=bm.subVectors(t,e).multiplyScalar(n).add(e),o=Gw.subVectors(r,t).multiplyScalar(n).add(t),s=hze.subVectors(i,r).multiplyScalar(n).add(r),l=a,c=fze.subVectors(o,a).multiplyScalar(n).add(a),u=pze.subVectors(s,o).multiplyScalar(n).add(o),d=s,h=mze.subVectors(u,c).multiplyScalar(n).add(c);return[e.x,e.y,l.x,l.y,c.x,c.y,h.x,h.y,u.x,u.y,d.x,d.y,i.x,i.y]}function _ze(e,t,r=12,i=!0){let n=gW.set(0,0,0),a,o=0;for(let s=0;s<t.length;s++){let l=zD(t[s]),c=bm,u=ih(l,r);for(let d=0;d<=u;d++)if(l instanceof cs||l instanceof Bu||l instanceof ms){if(l.getPoint(d/u,c),n.set(c.x,c.y,0),a!==void 0&&yze(a,n))continue;a===void 0&&(a=vW),a.copy(n),e.setXYZ(o,n.x,n.y,n.z),o++}}return i&&o>1&&!(e.getX(o-1)===e.getX(0)&&e.getY(o-1)===e.getY(0)&&e.getZ(o-1)===e.getZ(0))&&(e.setXYZ(o,e.getX(0),e.getY(0),e.getZ(0)),o++),e}function Aze(e,t,r,i=12,n=!0){let a=gW.set(0,0,0),o=0,s=[];for(let l=0;l<t.length;l++){if(r[l]===!1)continue;let c,u=zD(t[l]),d=bm,h=ih(u,i);s.push(h);for(let f=0;f<=h;f++)if(u instanceof cs||u instanceof Bu||u instanceof ms){if(u.getPoint(f/h,d),a.set(d.x,d.y,0),c==null?void 0:c.equals(a))continue;c===void 0?c=vW:(e.setXYZ(o,c.x,c.y,c.z),o++,e.setXYZ(o,a.x,a.y,a.z),o++),c.copy(a)}}return n&&o>1&&!(e.getX(o-1)===e.getX(0)&&e.getY(o-1)===e.getY(0)&&e.getZ(o-1)===e.getZ(0))&&(e.setXYZ(o,e.getX(0),e.getY(0),e.getZ(0)),o++),s}function zB(e,t=12,r=!1){let i=[];for(let n=0,a=e.length;n<a;n++){let o=e[n],s=0;if(r&&o.roundedCurveCorner!==void 0){let l=ih(o.roundedCurveCorner,t)*.5;n>0&&(i[n-1]+=l),s+=l}o.curveAfter!==void 0&&(s+=ih(o.curveAfter,t)),i.push(s)}return e.length>0&&r&&e[0].roundedCurveCorner!==void 0&&(i[e.length-1]+=ih(e[0].roundedCurveCorner,t)*.5),i}function ih(e,t=12){return e&&e instanceof Dw?t*2:e&&(e instanceof ms||e instanceof y8)?1:e&&e instanceof YP?t*e.points.length:t}function Mze(e,t,r=12,i=!0){let n,a=0;for(let o=0;o<t.length;o++){let s=zD(t[o]),l=ih(s,r),c=bm;for(let u=0;u<=l;u++)if(s instanceof cs||s instanceof Bu||s instanceof ms){if(s.getPoint(u/l,c),n!==void 0&&gze(n,c,Jm))continue;n===void 0&&(n=Gw),n.copy(c),e.push(c.x,c.y),a++}}return Sv(e[0],e[e.length-2],Jm)&&Sv(e[1],e[e.length-1],Jm)&&(e.pop(),e.pop()),i&&a>1&&!(Sv(e[a-1],e[1],Jm)&&Sv(e[a-2],e[0],Jm))&&(e.push(e[0],e[1]),a++),e}var u_=new ye,Eze=new ye,Tze=new ye,Pze=new ye,Dze=new ye,Oze=new ye,Fi=class extends Gx{constructor(e=100,t=100){super(),this.points=[],this.shapeHoles=[],this.plane=new Ya(new k(0,0,-1)),this.subdivision=0,this.controlSnapDistance=4,this.pointIDs=0,this.isMesh2D=!1,this.isText=!1,this._roundness=0,this.isClosed=!1,this.useCubicForRoundedCorners=!0,this.uuid=St.generateUUID(),this.needsUpdate=!1,this.roundedCurves=[],this._width=e,this._height=t}static createFromState(e,t,r){let i=new Fi;return i.isClosed=e.isClosed,i.points=e.points.map(n=>up.create(n.id,n.data)),typeof e.roundness=="number"&&(i.roundness=e.roundness),i.shapeHoles=e.shapeHoles.map(n=>Fi.createFromState(n)),t!==void 0&&r!==void 0&&i.applySize(t,r),i.update(),i}get width(){return this._width}get height(){return this._height}get roundness(){return this._roundness}set roundness(e){if(this._roundness!==e){this._roundness=e;for(let t=0,r=this.points.length;t<r;t++)this.points[t].roundness=e;this.needsUpdate=!0}}getPointsIndexesByIds(e){return e.map(t=>this.getPointIndexById(t)).filter(t=>t>=0)}getPointIndexById(e){let t=this.points.length,r=this.points.findIndex(i=>i.uuid===e);if(r<0){let i=t;for(let n=0,a=this.shapeHoles.length;n<a;n++){let o=this.shapeHoles[n],s=o.points.length,l=o.getPointIndexById(e);if(l<0)i+=s;else return l+i}}return r}getLineIndexById(e){return this.getPointIndexById(e)}getBezierPoint(e){if(e<=this.points.length-1)return this.points[e];if(this.shapeHoles.length>0){let t=this.points.length;for(let r=0,i=this.shapeHoles.length;r<i;r++){let n=this.shapeHoles[r],a=e-t;if(a<=n.points.length-1)return n.points[a];t+=n.points.length}}throw new Error("This shape does not have a point for this index: "+e)}getBezierPointIndex(e){let t=this.points.indexOf(e);if(t>=0)return t;if(t=this.points.length,this.shapeHoles.length>0)for(let r=0,i=this.shapeHoles.length;r<i;r++){let n=this.shapeHoles[r],a=n.points.indexOf(e);if(a>=0)return t+a;t+=n.points.length}return-1}getAllPoints(){let e=[].concat(...this.shapeHoles.map(t=>t.points));return[...this.points,...e]}applySize(e,t){e===0&&(e=.001),t===0&&(t=.001),this._width=e,this._height=t}applyScale(e,t){let r=u_.set(e,t);for(let i=0,n=this.points.length;i<n;i++){let a=this.points[i];a.position.multiply(r),a.controls[0].position.multiply(r),a.controls[1].position.multiply(r)}for(let i=0,n=this.shapeHoles.length;i<n;i++)this.shapeHoles[i].applyScale(e,t);this._update()}createPoint(e,t=0,r=St.generateUUID()){let i;e instanceof ye?i=e:i=new ye(e,t);let n=new up(r,i);return n.roundness=this.roundness,n}addPoint(e){this.points.push(e),this.needsUpdate=!0}addPointAt(e,t){this.points.splice(t,0,e),this.needsUpdate=!0}getPointByUuid(e){for(let t=0,r=this.points.length;t<r;t++){let i=this.points[t];if(i.uuid===e)return i}for(let t=0,r=this.shapeHoles.length;t<r;t++){let i=this.shapeHoles[t].getPointByUuid(e);if(i)return i}}getFirstPoint(){return this.points[0]}getLastPoint(){return this.points[this.points.length-1]}removePoint(e){let t=this.points.indexOf(e);t>=0&&this.points.splice(t,1),this.needsUpdate=!0}removePointById(e){let t=this.points.find(r=>r.uuid===e);t&&this.removePoint(t)}update(){for(let e=0,t=this.shapeHoles.length;e<t;e++)this.shapeHoles[e].update();this._update()}extractShapePointsToBuffer(e,t=12,r=!1){this.subdivision=t,this.curveDivisions===void 0&&this.computeCurveDivisions(t);let i=r?this.roundedCurveDivisions:this.curveDivisions;return _ze(e,r?this.roundedCurves:this.curves,t,this.autoClose),i.reduce((n,a)=>n+a,0)+1}computeCurveDivisions(e=12){return this.curveDivisions=zB(this.points,e,!1),this.roundedCurveDivisions=zB(this.points,e,!0),this.curveDivisions}extractFilteredShapePointsToBuffer(e,t,r=12){return Aze(e,this.curves,t,r,this.autoClose).reduce((i,n)=>i+n,0)*2}extractShapePointsToFlatArray(e,t=12){return this.subdivision=t,this.curveDivisions===void 0&&this.computeCurveDivisions(t),Mze(e,this.roundedCurves,t,this.autoClose)}getCurveIndexFromVertexId(e,t=!1){let r=0;this.curveDivisions===void 0&&this.computeCurveDivisions(this.subdivision);let i=t?this.roundedCurveDivisions:this.curveDivisions,n=0;t&&this.points[0].roundedCurveCorner!==void 0&&(n=ih(this.points[0].roundedCurveCorner,this.subdivision)*.5);let a=e-n;a<0&&(a+=i.reduce((o,s)=>o+s,0));for(let o=0,s=i.length;o<s;o++){let l=i[o];if(a<r+l)return[o,(a-r+1)/l];r+=l}return[0,1]}getCurveT(e,t,r){let i=this.points[e],n=this.points[e>=this.points.length-1?0:e+1],a=this.curveDivisions,o=a[e];if(RB(i,n)){let l=i.position.distanceTo(n.position);return i.position.distanceTo(u_.set(r.x,r.y))/l}let s=0;for(let l=0;l<e;l++)s+=a[l];return(t-s)/o}dispose(){}_applyCurveForPoint(e,t){RB(t,e)?this.lineTo(e.position.x,e.position.y):this.bezierCurveTo(t.controls[1].position.x,t.controls[1].position.y,e.controls[0].position.x,e.controls[0].position.y,e.position.x,e.position.y);let r=this.curves[this.curves.length-1];e.curveBefore=r,t.curveAfter=r;let i=r.clone();e.roundedCurveBefore=i,t.roundedCurveAfter=i,e.roundedCurveCorner=void 0,this.roundedCurves.push(i)}_update(){if(this.curves=[],this.roundedCurves=[],!this.points.length)return;for(let t=0,r=this.points.length;t<r;t++){let i=this.points[t];if(t===0)this.moveTo(i.position.x,i.position.y);else{let n=this.points[t-1];this._applyCurveForPoint(i,n)}}let e=this.getLastPoint();if(e!=null&&e.curveAfter&&(e.curveAfter=void 0),this.isClosed){let t=this.points[0],r=this.points[this.points.length-1];this._applyCurveForPoint(t,r)}if(this.points.length>2){let t=0;for(let r=0,i=this.points.length;r<i;r++){let n=this.points[r],a=this.points[r-1]??this.points[this.points.length-1],o=this.points[r+1]??this.points[0],s=n.roundness,l=a&&o&&bze(a,n,o);if(!n.controlsMoved()&&s>0&&!l){let c=n.curveBefore,u=n.curveAfter;if(c===void 0||u===void 0)continue;let d=n.roundedCurveBefore,h=n.roundedCurveAfter,f=c.getLength(),p=u.getLength(),v=Math.min(s,f*.499),m=Math.min(s,p*.499),g=Math.min(v,m),y=1-g/f,b=g/p,x=c.getPointAt(y,u_),S=u.getPointAt(b,Eze);this._subSplitCurve(c,d,y,x,void 0),this._subSplitCurve(u,h,b,void 0,S);let w;if(this.useCubicForRoundedCorners){let _=yW(x,n.position,S)/2,C=Math.tan(_)*x.distanceTo(n.position),[A,M]=xze(x,S,C,Tze,Pze),P=wze(A,M,n.position),[T,R]=Sze(P,x,S,C,Dze,Oze);w=new cs(x.clone(),T.clone(),R.clone(),S.clone())}else w=new Bu(x.clone(),n.position.clone(),S.clone());n.roundedCurveCorner=w,this.roundedCurves.splice(r+t,0,w),t++}}}}_subSplitCurve(e,t,r,i,n){if(e instanceof ms)i!==void 0&&t.v2.copy(i),n!==void 0&&t.v1.copy(n);else{let a=e,o=t,s=a.getUtoTmapping(r,0),l=Cze(a.v0,a.v1,a.v2,a.v3,s);return i!==void 0&&(o.v0.set(l[0],l[1]),o.v1.set(l[2],l[3]),o.v2.set(l[4],l[5]),o.v3.set(l[6],l[7])),n!==void 0&&(o.v0.set(l[6],l[7]),o.v1.set(l[8],l[9]),o.v2.set(l[10],l[11]),o.v3.set(l[12],l[13])),o}return t}clone(){let e=new Fi(this._width,this._height);return e.points=this.points.map(t=>t.clone()),e.isClosed=this.isClosed,e.roundness=this.roundness,e.isMesh2D=this.isMesh2D,e.shapeHoles=this.shapeHoles.map(t=>t.clone()),e}toJSON(){return{points:this.points.reduce((e,t)=>e.concat(t.toJSON()),[]),shapeHoles:this.shapeHoles.map(e=>e.toJSON()),isClosed:this.isClosed,roundness:this.roundness}}fromJSON(e){var r;this.points=[],this.pointIDs=0;let t=e.points.length/7;for(let i=0;i<t;i++){let n=i*7,a=e.points[n+0],o=e.points[n+1],s=e.points[n+2],l=e.points[n+3],c=e.points[n+4],u=e.points[n+5],d=e.points[n+6],h=new up(St.generateUUID(),new ye(a,o));h.controls[0].position.set(s,l),h.controls[1].position.set(c,u),h.roundness=d,this.points.push(h)}return this.shapeHoles=(r=e.shapeHoles)!=null&&r.length?e.shapeHoles.map(i=>{let n=new Fi;return n.fromJSON(i),n}):[],this.isClosed=e.isClosed,this._roundness=e.roundness,this._update(),this}fromShape(e,t=!1){this.isText=t;let r=(n,a)=>{a instanceof cs&&a.v3.equals(n.position)&&n.controls[0].position.copy(a.v2)},i=n=>{let a=[],o,s;for(o=0,s=n.length;o<s;o++)n[o]instanceof Bu&&(n[o]=vze(n[o]));for(o=0,s=n.length;o<s;o++){let u=n[o],d=o>0?n[o-1]:null,h;u instanceof cs?(h=this.createPoint(u.v0),h.controls[1].position.copy(u.v1)):u instanceof ms&&(h=this.createPoint(u.v1)),h!==void 0&&(d!==null&&r(h,d),a.push(h))}let l=n[n.length-1],c=!1;return l instanceof cs?l.v3.equals(a[0].position)&&(a[0].controls[0].position.copy(l.v2),c=!0):l instanceof ms&&l.v2.equals(a[0].position)&&(c=!0),this.isClosed=c,a};return this.points=i(e.curves),e instanceof Gx&&(this.shapeHoles=e.holes.map(n=>{let a=new Fi;return a.fromShape(n),a})),this.update(),this}updatePoint(e,t){let r=this.getPointByUuid(e);r&&(t.position!==void 0&&r.position.fromArray(t.position),t.roundness!==void 0&&(r.roundness=t.roundness),t.areControlsDirectionsMirrored!==void 0&&(r.areControlsDirectionsMirrored=t.areControlsDirectionsMirrored),this.needsUpdate=!0)}updatePreviousControl(e,t){var i;let r=(i=this.getPointByUuid(e))==null?void 0:i.controls[0];r&&(t.position&&r.position.fromArray(t.position),this.needsUpdate=!0)}updateNextControl(e,t){var i;let r=(i=this.getPointByUuid(e))==null?void 0:i.controls[1];r&&(t.position&&r.position.fromArray(t.position),this.needsUpdate=!0)}},ME=Math.PI*2;function d_({x:e,y:t},r,i,n,a){return{x:e*r+n,y:t*i+a}}function Rze(e,t){let r=t===1.5707963267948966?.551915024494:t===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(t/4),i=Math.cos(e),n=Math.sin(e),a=Math.cos(e+t),o=Math.sin(e+t);return[{x:i-n*r,y:n+i*r},{x:a+o*r,y:o-a*r},{x:a,y:o}]}function kB(e,t,r,i){let n=e*i-t*r<0?-1:1,a=Math.min(1,Math.max(-1,e*r+t*i));return n*Math.acos(a)}function Ize(e,t,r,i,n,a,o,s,l,c){let u=Math.pow(n,2),d=Math.pow(a,2),h=Math.pow(o,2),f=Math.pow(s,2),p=u*d-u*f-d*h;p<0&&(p=0),p/=u*f+d*h,p=Math.sqrt(p)*(l===c?-1:1);let v=p*n/a*s,m=p*-a/n*o,g=v+(e+r)/2,y=m+(t+i)/2,b=(o-v)/n,x=(s-m)/a,S=(-o-v)/n,w=(-s-m)/a,_=kB(1,0,b,x),C=kB(b,x,S,w);return!c&&C>0&&(C-=ME),c&&C<0&&(C+=ME),{centerx:g,centery:y,ang1:_,ang2:C}}function zze({px:e,py:t,cx:r,cy:i,rx:n,ry:a,largeArcFlag:o,sweepFlag:s}){let l=[];if(n===0||a===0)return[];let c=(e-r)/2,u=(t-i)/2;if(c===0&&u===0)return[];n=Math.abs(n),a=Math.abs(a);let d=Math.pow(c,2)/Math.pow(n,2)+Math.pow(u,2)/Math.pow(a,2);d>1&&(n*=Math.sqrt(d),a*=Math.sqrt(d));let h=Ize(e,t,r,i,n,a,c,u,o,s),{ang1:f,ang2:p}=h,{centerx:v,centery:m}=h,g=Math.abs(p)/(ME/4);Math.abs(1-g)<1e-7&&(g=1);let y=Math.max(Math.ceil(g),1);p/=y;for(let b=0;b<y;b++)l.push(Rze(f,p)),f+=p;return l.map(b=>{let{x,y:S}=d_(b[0],n,a,v,m),{x:w,y:_}=d_(b[1],n,a,v,m),{x:C,y:A}=d_(b[2],n,a,v,m);return{x1:x,y1:S,x2:w,y2:_,x:C,y:A}})}var ri;(function(e){e[e.ODD=0]="ODD",e[e.NONZERO=1]="NONZERO",e[e.POSITIVE=2]="POSITIVE",e[e.NEGATIVE=3]="NEGATIVE",e[e.ABS_GEQ_TWO=4]="ABS_GEQ_TWO"})(ri||(ri={}));var sn;(function(e){e[e.POLYGONS=0]="POLYGONS",e[e.CONNECTED_POLYGONS=1]="CONNECTED_POLYGONS",e[e.BOUNDARY_CONTOURS=2]="BOUNDARY_CONTOURS"})(sn||(sn={}));function Gt(e,t){if(!e)throw t||"Assertion Failed!"}var zt=function(){function e(){}return e.vertEq=function(t,r){return t.s===r.s&&t.t===r.t},e.vertLeq=function(t,r){return t.s<r.s||t.s===r.s&&t.t<=r.t},e.transLeq=function(t,r){return t.t<r.t||t.t===r.t&&t.s<=r.s},e.edgeGoesLeft=function(t){return e.vertLeq(t.Dst,t.Org)},e.edgeGoesRight=function(t){return e.vertLeq(t.Org,t.Dst)},e.vertL1dist=function(t,r){return Math.abs(t.s-r.s)+Math.abs(t.t-r.t)},e.edgeEval=function(t,r,i){Gt(e.vertLeq(t,r)&&e.vertLeq(r,i));var n=r.s-t.s,a=i.s-r.s;return n+a>0?n<a?r.t-t.t+(t.t-i.t)*(n/(n+a)):r.t-i.t+(i.t-t.t)*(a/(n+a)):0},e.edgeSign=function(t,r,i){Gt(e.vertLeq(t,r)&&e.vertLeq(r,i));var n=r.s-t.s,a=i.s-r.s;return n+a>0?(r.t-i.t)*n+(r.t-t.t)*a:0},e.transEval=function(t,r,i){Gt(e.transLeq(t,r)&&e.transLeq(r,i));var n=r.t-t.t,a=i.t-r.t;return n+a>0?n<a?r.s-t.s+(t.s-i.s)*(n/(n+a)):r.s-i.s+(i.s-t.s)*(a/(n+a)):0},e.transSign=function(t,r,i){Gt(e.transLeq(t,r)&&e.transLeq(r,i));var n=r.t-t.t,a=i.t-r.t;return n+a>0?(r.s-i.s)*n+(r.s-t.s)*a:0},e.vertCCW=function(t,r,i){return t.s*(r.t-i.t)+r.s*(i.t-t.t)+i.s*(t.t-r.t)>=0},e.interpolate=function(t,r,i,n){return t=t<0?0:t,i=i<0?0:i,t<=i?i===0?(r+n)/2:r+(n-r)*(t/(t+i)):n+(r-n)*(i/(t+i))},e.intersect=function(t,r,i,n,a){var o,s,l;e.vertLeq(t,r)||(l=t,t=r,r=l),e.vertLeq(i,n)||(l=i,i=n,n=l),e.vertLeq(t,i)||(l=t,t=i,i=l,l=r,r=n,n=l),e.vertLeq(i,r)?e.vertLeq(r,n)?(o=e.edgeEval(t,i,r),s=e.edgeEval(i,r,n),o+s<0&&(o=-o,s=-s),a.s=e.interpolate(o,i.s,s,r.s)):(o=e.edgeSign(t,i,r),s=-e.edgeSign(t,n,r),o+s<0&&(o=-o,s=-s),a.s=e.interpolate(o,i.s,s,n.s)):a.s=(i.s+r.s)/2,e.transLeq(t,r)||(l=t,t=r,r=l),e.transLeq(i,n)||(l=i,i=n,n=l),e.transLeq(t,i)||(l=t,t=i,i=l,l=r,r=n,n=l),e.transLeq(i,r)?e.transLeq(r,n)?(o=e.transEval(t,i,r),s=e.transEval(i,r,n),o+s<0&&(o=-o,s=-s),a.t=e.interpolate(o,i.t,s,r.t)):(o=e.transSign(t,i,r),s=-e.transSign(t,n,r),o+s<0&&(o=-o,s=-s),a.t=e.interpolate(o,i.t,s,n.t)):a.t=(i.t+r.t)/2},e}(),ev=function(){function e(){this.next=null,this.prev=null,this.anEdge=null,this.trail=null,this.n=0,this.marked=!1,this.inside=!1}return e}(),Ky=function(){function e(t){this.side=t,this.next=null,this.Org=null,this.Sym=null,this.Onext=null,this.Lnext=null,this.Lface=null,this.activeRegion=null,this.winding=0}return Object.defineProperty(e.prototype,"Rface",{get:function(){return this.Sym.Lface},set:function(t){this.Sym.Lface=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Dst",{get:function(){return this.Sym.Org},set:function(t){this.Sym.Org=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Oprev",{get:function(){return this.Sym.Lnext},set:function(t){this.Sym.Lnext=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Lprev",{get:function(){return this.Onext.Sym},set:function(t){this.Onext.Sym=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Dprev",{get:function(){return this.Lnext.Sym},set:function(t){this.Lnext.Sym=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Rprev",{get:function(){return this.Sym.Onext},set:function(t){this.Sym.Onext=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Dnext",{get:function(){return this.Sym.Onext.Sym},set:function(t){this.Sym.Onext.Sym=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Rnext",{get:function(){return this.Sym.Lnext.Sym},set:function(t){this.Sym.Lnext.Sym=t},enumerable:!0,configurable:!0}),e}(),kf=function(){function e(){this.next=null,this.prev=null,this.anEdge=null,this.coords=[0,0,0],this.s=0,this.t=0,this.pqHandle=0,this.n=0,this.idx=0}return e}(),LB=function(){function e(){var t=new kf,r=new ev,i=new Ky(0),n=new Ky(1);t.next=t.prev=t,t.anEdge=null,r.next=r.prev=r,i.next=i,i.Sym=n,n.next=n,n.Sym=i,this.vHead=t,this.fHead=r,this.eHead=i,this.eHeadSym=n}return e.prototype.makeEdge_=function(t){var r=new Ky(0),i=new Ky(1);t.Sym.side<t.side&&(t=t.Sym);var n=t.Sym.next;return i.next=n,n.Sym.next=r,r.next=t,t.Sym.next=i,r.Sym=i,r.Onext=r,r.Lnext=i,r.Org=null,r.Lface=null,r.winding=0,r.activeRegion=null,i.Sym=r,i.Onext=i,i.Lnext=r,i.Org=null,i.Lface=null,i.winding=0,i.activeRegion=null,r},e.prototype.splice_=function(t,r){var i=t.Onext,n=r.Onext;i.Sym.Lnext=r,n.Sym.Lnext=t,t.Onext=n,r.Onext=i},e.prototype.makeVertex_=function(t,r,i){var n=t;Gt(n,"Vertex can't be null!");var a=i.prev;n.prev=a,a.next=n,n.next=i,i.prev=n,n.anEdge=r;var o=r;do o.Org=n,o=o.Onext;while(o!==r)},e.prototype.makeFace_=function(t,r,i){var n=t;Gt(n,"Face can't be null");var a=i.prev;n.prev=a,a.next=n,n.next=i,i.prev=n,n.anEdge=r,n.trail=null,n.marked=!1,n.inside=i.inside;var o=r;do o.Lface=n,o=o.Lnext;while(o!==r)},e.prototype.killEdge_=function(t){t.Sym.side<t.side&&(t=t.Sym);var r=t.next,i=t.Sym.next;r.Sym.next=i,i.Sym.next=r},e.prototype.killVertex_=function(t,r){var i=t.anEdge,n=i;do n.Org=r,n=n.Onext;while(n!==i);var a=t.prev,o=t.next;o.prev=a,a.next=o},e.prototype.killFace_=function(t,r){var i=t.anEdge,n=i;do n.Lface=r,n=n.Lnext;while(n!==i);var a=t.prev,o=t.next;o.prev=a,a.next=o},e.prototype.makeEdge=function(){var t=new kf,r=new kf,i=new ev,n=this.makeEdge_(this.eHead);return this.makeVertex_(t,n,this.vHead),this.makeVertex_(r,n.Sym,this.vHead),this.makeFace_(i,n,this.fHead),n},e.prototype.splice=function(t,r){var i=!1,n=!1;if(t!==r){if(r.Org!==t.Org&&(n=!0,this.killVertex_(r.Org,t.Org)),r.Lface!==t.Lface&&(i=!0,this.killFace_(r.Lface,t.Lface)),this.splice_(r,t),!n){var a=new kf;this.makeVertex_(a,r,t.Org),t.Org.anEdge=t}if(!i){var o=new ev;this.makeFace_(o,r,t.Lface),t.Lface.anEdge=t}}},e.prototype.delete=function(t){var r=t.Sym,i=!1;if(t.Lface!==t.Rface&&(i=!0,this.killFace_(t.Lface,t.Rface)),t.Onext===t)this.killVertex_(t.Org,null);else if(t.Rface.anEdge=t.Oprev,t.Org.anEdge=t.Onext,this.splice_(t,t.Oprev),!i){var n=new ev;this.makeFace_(n,t,t.Lface)}r.Onext===r?(this.killVertex_(r.Org,null),this.killFace_(r.Lface,null)):(t.Lface.anEdge=r.Oprev,r.Org.anEdge=r.Onext,this.splice_(r,r.Oprev)),this.killEdge_(t)},e.prototype.addEdgeVertex=function(t){var r=this.makeEdge_(t),i=r.Sym;this.splice_(r,t.Lnext),r.Org=t.Dst;var n=new kf;return this.makeVertex_(n,i,r.Org),r.Lface=i.Lface=t.Lface,r},e.prototype.splitEdge=function(t){var r=this.addEdgeVertex(t),i=r.Sym;return this.splice_(t.Sym,t.Sym.Oprev),this.splice_(t.Sym,i),t.Dst=i.Org,i.Dst.anEdge=i.Sym,i.Rface=t.Rface,i.winding=t.winding,i.Sym.winding=t.Sym.winding,i.idx=t.idx,i.Sym.idx=t.Sym.idx,i},e.prototype.connect=function(t,r){var i=!1,n=this.makeEdge_(t),a=n.Sym;if(r.Lface!==t.Lface&&(i=!0,this.killFace_(r.Lface,t.Lface)),this.splice_(n,t.Lnext),this.splice_(a,r),n.Org=t.Dst,a.Org=r.Org,n.Lface=a.Lface=t.Lface,t.Lface.anEdge=a,!i){var o=new ev;this.makeFace_(o,n,t.Lface)}return n},e.prototype.zapFace=function(t){var r=t.anEdge,i,n,a,o,s;n=r.Lnext;do i=n,n=i.Lnext,i.Lface=null,i.Rface===null&&(i.Onext===i?this.killVertex_(i.Org,null):(i.Org.anEdge=i.Onext,this.splice_(i,i.Oprev)),a=i.Sym,a.Onext===a?this.killVertex_(a.Org,null):(a.Org.anEdge=a.Onext,this.splice_(a,a.Oprev)),this.killEdge_(i));while(i!=r);o=t.prev,s=t.next,s.prev=o,o.next=s},e.prototype.countFaceVerts_=function(t){var r=t.anEdge,i=0;do i++,r=r.Lnext;while(r!==t.anEdge);return i},e.prototype.mergeConvexFaces=function(t){var r,i,n,a,o,s,l;for(r=this.fHead.next;r!==this.fHead;r=r.next)if(r.inside)for(i=r.anEdge,o=i.Org;n=i.Lnext,a=i.Sym,a&&a.Lface&&a.Lface.inside&&(s=this.countFaceVerts_(r),l=this.countFaceVerts_(a.Lface),s+l-2<=t&&zt.vertCCW(i.Lprev.Org,i.Org,a.Lnext.Lnext.Org)&&zt.vertCCW(a.Lprev.Org,a.Org,i.Lnext.Lnext.Org)&&(n=a.Lnext,this.delete(a),i=null,a=null)),!(i&&i.Lnext.Org===o);)i=n;return!0},e.prototype.check=function(){var t=this.fHead,r=this.vHead,i=this.eHead,n,a,o,s,l,c;for(a=t,a=t;(n=a.next)!==t;a=n){Gt(n.prev===a),l=n.anEdge;do Gt(l.Sym!==l),Gt(l.Sym.Sym===l),Gt(l.Lnext.Onext.Sym===l),Gt(l.Onext.Sym.Lnext===l),Gt(l.Lface===n),l=l.Lnext;while(l!==n.anEdge)}for(Gt(n.prev===a&&n.anEdge===null),s=r,s=r;(o=s.next)!==r;s=o){Gt(o.prev===s),l=o.anEdge;do Gt(l.Sym!==l),Gt(l.Sym.Sym===l),Gt(l.Lnext.Onext.Sym===l),Gt(l.Onext.Sym.Lnext===l),Gt(l.Org===o),l=l.Onext;while(l!==o.anEdge)}for(Gt(o.prev===s&&o.anEdge===null),c=i,c=i;(l=c.next)!==i;c=l)Gt(l.Sym.next===c.Sym),Gt(l.Sym!==l),Gt(l.Sym.Sym===l),Gt(l.Org!==null),Gt(l.Dst!==null),Gt(l.Lnext.Onext.Sym===l),Gt(l.Onext.Sym.Lnext===l);Gt(l.Sym.next===c.Sym&&l.Sym===this.eHeadSym&&l.Sym.Sym===l&&l.Org===null&&l.Dst===null&&l.Lface===null&&l.Rface===null)},e}(),BB=function(){function e(){this.handle=null}return e}(),FB=function(){function e(){this.key=null,this.node=0}return e}(),kze=function(){function e(t,r){this.leq=r,this.max=0,this.nodes=[],this.handles=[],this.initialized=!1,this.freeList=0,this.size=0,this.max=t,this.nodes=[],this.handles=[];for(var i=0;i<t+1;i++)this.nodes[i]=new BB,this.handles[i]=new FB;this.initialized=!1,this.nodes[1].handle=1,this.handles[1].key=null}return e.prototype.floatDown_=function(t){var r=this.nodes,i=this.handles,n,a,o;for(n=r[t].handle;;){if(o=t<<1,o<this.size&&this.leq(i[r[o+1].handle].key,i[r[o].handle].key)&&++o,Gt(o<=this.max),a=r[o].handle,o>this.size||this.leq(i[n].key,i[a].key)){r[t].handle=n,i[n].node=t;break}r[t].handle=a,i[a].node=t,t=o}},e.prototype.floatUp_=function(t){var r=this.nodes,i=this.handles,n,a,o;for(n=r[t].handle;;){if(o=t>>1,a=r[o].handle,o===0||this.leq(i[a].key,i[n].key)){r[t].handle=n,i[n].node=t;break}r[t].handle=a,i[a].node=t,t=o}},e.prototype.init=function(){for(var t=this.size;t>=1;--t)this.floatDown_(t);this.initialized=!0},e.prototype.min=function(){return this.handles[this.nodes[1].handle].key},e.prototype.insert=function(t){var r,i;if(r=++this.size,r*2>this.max){this.max*=2;var n,a;for(a=this.nodes.length,this.nodes.length=this.max+1,n=a;n<this.nodes.length;n++)this.nodes[n]=new BB;for(a=this.handles.length,this.handles.length=this.max+1,n=a;n<this.handles.length;n++)this.handles[n]=new FB}return this.freeList===0?i=r:(i=this.freeList,this.freeList=this.handles[i].node),this.nodes[r].handle=i,this.handles[i].node=r,this.handles[i].key=t,this.initialized&&this.floatUp_(r),i},e.prototype.extractMin=function(){var t=this.nodes,r=this.handles,i=t[1].handle,n=r[i].key;return this.size>0&&(t[1].handle=t[this.size].handle,r[t[1].handle].node=1,r[i].key=null,r[i].node=this.freeList,this.freeList=i,--this.size,this.size>0&&this.floatDown_(1)),n},e.prototype.delete=function(t){var r=this.nodes,i=this.handles,n;Gt(t>=1&&t<=this.max&&i[t].key!==null),n=i[t].node,r[n].handle=r[this.size].handle,i[r[n].handle].node=n,--this.size,n<=this.size&&(n<=1||this.leq(i[r[n>>1].handle].key,i[r[n].handle].key)?this.floatDown_(n):this.floatUp_(n)),i[t].key=null,i[t].node=this.freeList,this.freeList=t},e}(),h_=function(){function e(){this.eUp=null,this.nodeUp=null,this.windingNumber=0,this.inside=!1,this.sentinel=!1,this.dirty=!1,this.fixUpperEdge=!1}return e}(),NB=function(){function e(){this.key=null,this.next=null,this.prev=null}return e}(),Lze=function(){function e(t,r){this.frame=t,this.leq=r,this.head=new NB,this.head.next=this.head,this.head.prev=this.head}return e.prototype.min=function(){return this.head.next},e.prototype.max=function(){return this.head.prev},e.prototype.insert=function(t){return this.insertBefore(this.head,t)},e.prototype.search=function(t){var r=this.head;do r=r.next;while(r.key!==null&&!this.leq(this.frame,t,r.key));return r},e.prototype.insertBefore=function(t,r){do t=t.prev;while(t.key!==null&&!this.leq(this.frame,t.key,r));var i=new NB;return i.key=r,i.next=t.next,t.next.prev=i,i.prev=t,t.next=i,i},e.prototype.delete=function(t){t.next.prev=t.prev,t.prev.next=t.next},e}(),Bze=function(){function e(){}return e.regionBelow=function(t){return t.nodeUp.prev.key},e.regionAbove=function(t){return t.nodeUp.next.key},e.debugEvent=function(t){},e.addWinding=function(t,r){t.winding+=r.winding,t.Sym.winding+=r.Sym.winding},e.edgeLeq=function(t,r,i){var n=t.event,a=r.eUp,o=i.eUp;if(a.Dst===n)return o.Dst===n?zt.vertLeq(a.Org,o.Org)?zt.edgeSign(o.Dst,a.Org,o.Org)<=0:zt.edgeSign(a.Dst,o.Org,a.Org)>=0:zt.edgeSign(o.Dst,n,o.Org)<=0;if(o.Dst===n)return zt.edgeSign(a.Dst,n,a.Org)>=0;var s=zt.edgeEval(a.Dst,n,a.Org),l=zt.edgeEval(o.Dst,n,o.Org);return s>=l},e.deleteRegion=function(t,r){r.fixUpperEdge&&Gt(r.eUp.winding===0),r.eUp.activeRegion=null,t.dict.delete(r.nodeUp)},e.fixUpperEdge=function(t,r,i){Gt(r.fixUpperEdge),t.mesh.delete(r.eUp),r.fixUpperEdge=!1,r.eUp=i,i.activeRegion=r},e.topLeftRegion=function(t,r){var i=r.eUp.Org,n;do r=e.regionAbove(r);while(r.eUp.Org===i);if(r.fixUpperEdge){if(n=t.mesh.connect(e.regionBelow(r).eUp.Sym,r.eUp.Lnext),n===null)return null;e.fixUpperEdge(t,r,n),r=e.regionAbove(r)}return r},e.topRightRegion=function(t){var r=t.eUp.Dst;do t=e.regionAbove(t);while(t.eUp.Dst===r);return t},e.addRegionBelow=function(t,r,i){var n=new h_;return n.eUp=i,n.nodeUp=t.dict.insertBefore(r.nodeUp,n),n.fixUpperEdge=!1,n.sentinel=!1,n.dirty=!1,i.activeRegion=n,n},e.isWindingInside=function(t,r){switch(t.windingRule){case ri.ODD:return(r&1)!==0;case ri.NONZERO:return r!==0;case ri.POSITIVE:return r>0;case ri.NEGATIVE:return r<0;case ri.ABS_GEQ_TWO:return r>=2||r<=-2}throw new Error("Invalid winding rulle")},e.computeWinding=function(t,r){r.windingNumber=e.regionAbove(r).windingNumber+r.eUp.winding,r.inside=e.isWindingInside(t,r.windingNumber)},e.finishRegion=function(t,r){var i=r.eUp,n=i.Lface;n.inside=r.inside,n.anEdge=i,e.deleteRegion(t,r)},e.finishLeftRegions=function(t,r,i){for(var n,a=null,o=r,s=r.eUp;o!==i;){if(o.fixUpperEdge=!1,a=e.regionBelow(o),n=a.eUp,n.Org!=s.Org){if(!a.fixUpperEdge){e.finishRegion(t,o);break}n=t.mesh.connect(s.Lprev,n.Sym),e.fixUpperEdge(t,a,n)}s.Onext!==n&&(t.mesh.splice(n.Oprev,n),t.mesh.splice(s,n)),e.finishRegion(t,o),s=a.eUp,o=a}return s},e.addRightEdges=function(t,r,i,n,a,o){var s,l,c,u,d=!0;c=i;do Gt(zt.vertLeq(c.Org,c.Dst)),e.addRegionBelow(t,r,c.Sym),c=c.Onext;while(c!==n);for(a===null&&(a=e.regionBelow(r).eUp.Rprev),l=r,u=a;s=e.regionBelow(l),c=s.eUp.Sym,c.Org===u.Org;)c.Onext!==u&&(t.mesh.splice(c.Oprev,c),t.mesh.splice(u.Oprev,c)),s.windingNumber=l.windingNumber-c.winding,s.inside=e.isWindingInside(t,s.windingNumber),l.dirty=!0,!d&&e.checkForRightSplice(t,l)&&(e.addWinding(c,u),e.deleteRegion(t,l),t.mesh.delete(u)),d=!1,l=s,u=c;l.dirty=!0,Gt(l.windingNumber-c.winding===s.windingNumber),o&&e.walkDirtyRegions(t,l)},e.spliceMergeVertices=function(t,r,i){t.mesh.splice(r,i)},e.vertexWeights=function(t,r,i){var n=zt.vertL1dist(r,t),a=zt.vertL1dist(i,t),o=.5*a/(n+a),s=.5*n/(n+a);t.coords[0]+=o*r.coords[0]+s*i.coords[0],t.coords[1]+=o*r.coords[1]+s*i.coords[1],t.coords[2]+=o*r.coords[2]+s*i.coords[2]},e.getIntersectData=function(t,r,i,n,a,o){r.coords[0]=r.coords[1]=r.coords[2]=0,r.idx=-1,e.vertexWeights(r,i,n),e.vertexWeights(r,a,o)},e.checkForRightSplice=function(t,r){var i=e.regionBelow(r),n=r.eUp,a=i.eUp;if(zt.vertLeq(n.Org,a.Org)){if(zt.edgeSign(a.Dst,n.Org,a.Org)>0)return!1;zt.vertEq(n.Org,a.Org)?n.Org!==a.Org&&(t.pq.delete(n.Org.pqHandle),e.spliceMergeVertices(t,a.Oprev,n)):(t.mesh.splitEdge(a.Sym),t.mesh.splice(n,a.Oprev),r.dirty=i.dirty=!0)}else{if(zt.edgeSign(n.Dst,a.Org,n.Org)<0)return!1;e.regionAbove(r).dirty=r.dirty=!0,t.mesh.splitEdge(n.Sym),t.mesh.splice(a.Oprev,n)}return!0},e.checkForLeftSplice=function(t,r){var i=e.regionBelow(r),n=r.eUp,a=i.eUp,o;if(Gt(!zt.vertEq(n.Dst,a.Dst)),zt.vertLeq(n.Dst,a.Dst)){if(zt.edgeSign(n.Dst,a.Dst,n.Org)<0)return!1;e.regionAbove(r).dirty=r.dirty=!0,o=t.mesh.splitEdge(n),t.mesh.splice(a.Sym,o),o.Lface.inside=r.inside}else{if(zt.edgeSign(a.Dst,n.Dst,a.Org)>0)return!1;r.dirty=i.dirty=!0,o=t.mesh.splitEdge(a),t.mesh.splice(n.Lnext,a.Sym),o.Rface.inside=r.inside}return!0},e.checkForIntersect=function(t,r){var i=e.regionBelow(r),n=r.eUp,a=i.eUp,o=n.Org,s=a.Org,l=n.Dst,c=a.Dst,u,d,h=new kf,f,p;if(Gt(!zt.vertEq(c,l)),Gt(zt.edgeSign(l,t.event,o)<=0),Gt(zt.edgeSign(c,t.event,s)>=0),Gt(o!==t.event&&s!==t.event),Gt(!r.fixUpperEdge&&!i.fixUpperEdge),o===s||(u=Math.min(o.t,l.t),d=Math.max(s.t,c.t),u>d))return!1;if(zt.vertLeq(o,s)){if(zt.edgeSign(c,o,s)>0)return!1}else if(zt.edgeSign(l,s,o)<0)return!1;return e.debugEvent(t),zt.intersect(l,o,c,s,h),Gt(Math.min(o.t,l.t)<=h.t),Gt(h.t<=Math.max(s.t,c.t)),Gt(Math.min(c.s,l.s)<=h.s),Gt(h.s<=Math.max(s.s,o.s)),zt.vertLeq(h,t.event)&&(h.s=t.event.s,h.t=t.event.t),f=zt.vertLeq(o,s)?o:s,zt.vertLeq(f,h)&&(h.s=f.s,h.t=f.t),zt.vertEq(h,o)||zt.vertEq(h,s)?(e.checkForRightSplice(t,r),!1):!zt.vertEq(l,t.event)&&zt.edgeSign(l,t.event,h)>=0||!zt.vertEq(c,t.event)&&zt.edgeSign(c,t.event,h)<=0?c===t.event?(t.mesh.splitEdge(n.Sym),t.mesh.splice(a.Sym,n),r=e.topLeftRegion(t,r),n=e.regionBelow(r).eUp,e.finishLeftRegions(t,e.regionBelow(r),i),e.addRightEdges(t,r,n.Oprev,n,n,!0),!0):l===t.event?(t.mesh.splitEdge(a.Sym),t.mesh.splice(n.Lnext,a.Oprev),i=r,r=e.topRightRegion(r),p=e.regionBelow(r).eUp.Rprev,i.eUp=a.Oprev,a=e.finishLeftRegions(t,i,null),e.addRightEdges(t,r,a.Onext,n.Rprev,p,!0),!0):(zt.edgeSign(l,t.event,h)>=0&&(e.regionAbove(r).dirty=r.dirty=!0,t.mesh.splitEdge(n.Sym),n.Org.s=t.event.s,n.Org.t=t.event.t),zt.edgeSign(c,t.event,h)<=0&&(r.dirty=i.dirty=!0,t.mesh.splitEdge(a.Sym),a.Org.s=t.event.s,a.Org.t=t.event.t),!1):(t.mesh.splitEdge(n.Sym),t.mesh.splitEdge(a.Sym),t.mesh.splice(a.Oprev,n),n.Org.s=h.s,n.Org.t=h.t,n.Org.pqHandle=t.pq.insert(n.Org),e.getIntersectData(t,n.Org,o,l,s,c),e.regionAbove(r).dirty=r.dirty=i.dirty=!0,!1)},e.walkDirtyRegions=function(t,r){for(var i=e.regionBelow(r),n,a;;){for(;i.dirty;)r=i,i=e.regionBelow(i);if(!r.dirty&&(i=r,r=e.regionAbove(r),r===null||!r.dirty))return;if(r.dirty=!1,n=r.eUp,a=i.eUp,n.Dst!==a.Dst&&e.checkForLeftSplice(t,r)&&(i.fixUpperEdge?(e.deleteRegion(t,i),t.mesh.delete(a),i=e.regionBelow(r),a=i.eUp):r.fixUpperEdge&&(e.deleteRegion(t,r),t.mesh.delete(n),r=e.regionAbove(i),n=r.eUp)),n.Org!==a.Org)if(n.Dst!==a.Dst&&!r.fixUpperEdge&&!i.fixUpperEdge&&(n.Dst===t.event||a.Dst===t.event)){if(e.checkForIntersect(t,r))return}else e.checkForRightSplice(t,r);n.Org===a.Org&&n.Dst===a.Dst&&(e.addWinding(a,n),e.deleteRegion(t,r),t.mesh.delete(n),r=e.regionAbove(i))}},e.connectRightVertex=function(t,r,i){var n,a=i.Onext,o=e.regionBelow(r),s=r.eUp,l=o.eUp,c=!1;if(s.Dst!==l.Dst&&e.checkForIntersect(t,r),zt.vertEq(s.Org,t.event)&&(t.mesh.splice(a.Oprev,s),r=e.topLeftRegion(t,r),a=e.regionBelow(r).eUp,e.finishLeftRegions(t,e.regionBelow(r),o),c=!0),zt.vertEq(l.Org,t.event)&&(t.mesh.splice(i,l.Oprev),i=e.finishLeftRegions(t,o,null),c=!0),c){e.addRightEdges(t,r,i.Onext,a,a,!0);return}zt.vertLeq(l.Org,s.Org)?n=l.Oprev:n=s,n=t.mesh.connect(i.Lprev,n),e.addRightEdges(t,r,n,n.Onext,n.Onext,!1),n.Sym.activeRegion.fixUpperEdge=!0,e.walkDirtyRegions(t,r)},e.connectLeftDegenerate=function(t,r,i){var n,a,o,s,l;if(n=r.eUp,zt.vertEq(n.Org,i)){Gt(!1),e.spliceMergeVertices(t,n,i.anEdge);return}if(!zt.vertEq(n.Dst,i)){t.mesh.splitEdge(n.Sym),r.fixUpperEdge&&(t.mesh.delete(n.Onext),r.fixUpperEdge=!1),t.mesh.splice(i.anEdge,n),e.sweepEvent(t,i);return}Gt(!1),r=e.topRightRegion(r),l=e.regionBelow(r),o=l.eUp.Sym,a=s=o.Onext,l.fixUpperEdge&&(Gt(a!==o),e.deleteRegion(t,l),t.mesh.delete(o),o=a.Oprev),t.mesh.splice(i.anEdge,o),zt.edgeGoesLeft(a)||(a=null),e.addRightEdges(t,r,o.Onext,s,a,!0)},e.connectLeftVertex=function(t,r){var i,n,a,o,s,l,c=new h_;if(c.eUp=r.anEdge.Sym,i=t.dict.search(c).key,n=e.regionBelow(i),!!n){if(o=i.eUp,s=n.eUp,zt.edgeSign(o.Dst,r,o.Org)===0){e.connectLeftDegenerate(t,i,r);return}if(a=zt.vertLeq(s.Dst,o.Dst)?i:n,i.inside||a.fixUpperEdge){if(a===i)l=t.mesh.connect(r.anEdge.Sym,o.Lnext);else{var u=t.mesh.connect(s.Dnext,r.anEdge);l=u.Sym}a.fixUpperEdge?e.fixUpperEdge(t,a,l):e.computeWinding(t,e.addRegionBelow(t,i,l)),e.sweepEvent(t,r)}else e.addRightEdges(t,i,r.anEdge,r.anEdge,null,!0)}},e.sweepEvent=function(t,r){t.event=r,e.debugEvent(t);for(var i=r.anEdge;i.activeRegion===null;)if(i=i.Onext,i===r.anEdge){e.connectLeftVertex(t,r);return}var n=e.topLeftRegion(t,i.activeRegion);Gt(n!==null);var a=e.regionBelow(n),o=a.eUp,s=e.finishLeftRegions(t,a,null);s.Onext===o?e.connectRightVertex(t,n,s):e.addRightEdges(t,n,s.Onext,o,o,!0)},e.addSentinel=function(t,r,i,n){var a=new h_,o=t.mesh.makeEdge();o.Org.s=i,o.Org.t=n,o.Dst.s=r,o.Dst.t=n,t.event=o.Dst,a.eUp=o,a.windingNumber=0,a.inside=!1,a.fixUpperEdge=!1,a.sentinel=!0,a.dirty=!1,a.nodeUp=t.dict.insert(a)},e.initEdgeDict=function(t){t.dict=new Lze(t,e.edgeLeq);var r=t.bmax[0]-t.bmin[0],i=t.bmax[1]-t.bmin[1],n=t.bmin[0]-r,a=t.bmax[0]+r,o=t.bmin[1]-i,s=t.bmax[1]+i;e.addSentinel(t,n,a,o),e.addSentinel(t,n,a,s)},e.doneEdgeDict=function(t){for(var r,i=0;(r=t.dict.min().key)!==null;)r.sentinel||(Gt(r.fixUpperEdge),Gt(++i===1)),Gt(r.windingNumber===0),e.deleteRegion(t,r)},e.removeDegenerateEdges=function(t){var r,i,n,a=t.mesh.eHead;for(r=a.next;r!==a;r=i)i=r.next,n=r.Lnext,zt.vertEq(r.Org,r.Dst)&&r.Lnext.Lnext!==r&&(e.spliceMergeVertices(t,n,r),t.mesh.delete(r),r=n,n=r.Lnext),n.Lnext===r&&(n!==r&&((n===i||n===i.Sym)&&(i=i.next),t.mesh.delete(n)),(r===i||r===i.Sym)&&(i=i.next),t.mesh.delete(r))},e.initPriorityQ=function(t){var r,i,n,a=0;for(n=t.mesh.vHead,i=n.next;i!==n;i=i.next)a++;for(a+=8,r=t.pq=new kze(a,zt.vertLeq),n=t.mesh.vHead,i=n.next;i!==n;i=i.next)i.pqHandle=r.insert(i);return i!==n?!1:(r.init(),!0)},e.donePriorityQ=function(t){t.pq=null},e.removeDegenerateFaces=function(t,r){var i,n,a;for(i=r.fHead.next;i!==r.fHead;i=n)n=i.next,a=i.anEdge,Gt(a.Lnext!==a),a.Lnext.Lnext===a&&(e.addWinding(a.Onext,a),t.mesh.delete(a));return!0},e.computeInterior=function(t,r){r===void 0&&(r=!0);var i,n;if(e.removeDegenerateEdges(t),!e.initPriorityQ(t))return!1;for(e.initEdgeDict(t);(i=t.pq.extractMin())!==null;){for(;n=t.pq.min(),!(n===null||!zt.vertEq(n,i));)n=t.pq.extractMin(),e.spliceMergeVertices(t,i.anEdge,n.anEdge);e.sweepEvent(t,i)}return t.event=t.dict.min().key.eUp.Org,e.debugEvent(t),e.doneEdgeDict(t),e.donePriorityQ(t),e.removeDegenerateFaces(t,t.mesh)?(r&&t.mesh.check(),!0):!1},e}(),Fze=function(){function e(){this.mesh=new LB,this.normal=[0,0,0],this.sUnit=[0,0,0],this.tUnit=[0,0,0],this.bmin=[0,0],this.bmax=[0,0],this.windingRule=ri.ODD,this.dict=null,this.pq=null,this.event=null,this.vertexIndexCounter=0,this.vertices=[],this.vertexIndices=[],this.vertexCount=0,this.elements=[],this.elementCount=0}return e.prototype.dot_=function(t,r){return t[0]*r[0]+t[1]*r[1]+t[2]*r[2]},e.prototype.normalize_=function(t){var r=t[0]*t[0]+t[1]*t[1]+t[2]*t[2];if(!r)throw"Zero-size vector!";r=Math.sqrt(r),t[0]/=r,t[1]/=r,t[2]/=r},e.prototype.longAxis_=function(t){var r=0;return Math.abs(t[1])>Math.abs(t[0])&&(r=1),Math.abs(t[2])>Math.abs(t[r])&&(r=2),r},e.prototype.computeNormal_=function(t){var r,i,n,a,o,s,l=[0,0,0],c=[0,0,0],u=[0,0,0],d=[0,0,0],h=[0,0,0],f=[null,null,null],p=[null,null,null],v=this.mesh.vHead;r=v.next;for(var m=0;m<3;++m)a=r.coords[m],c[m]=a,p[m]=r,l[m]=a,f[m]=r;for(r=v.next;r!==v;r=r.next)for(var g=0;g<3;++g)a=r.coords[g],a<c[g]&&(c[g]=a,p[g]=r),a>l[g]&&(l[g]=a,f[g]=r);var y=0;if(l[1]-c[1]>l[0]-c[0]&&(y=1),l[2]-c[2]>l[y]-c[y]&&(y=2),c[y]>=l[y]){t[0]=0,t[1]=0,t[2]=1;return}for(s=0,i=p[y],n=f[y],u[0]=i.coords[0]-n.coords[0],u[1]=i.coords[1]-n.coords[1],u[2]=i.coords[2]-n.coords[2],r=v.next;r!==v;r=r.next)d[0]=r.coords[0]-n.coords[0],d[1]=r.coords[1]-n.coords[1],d[2]=r.coords[2]-n.coords[2],h[0]=u[1]*d[2]-u[2]*d[1],h[1]=u[2]*d[0]-u[0]*d[2],h[2]=u[0]*d[1]-u[1]*d[0],o=h[0]*h[0]+h[1]*h[1]+h[2]*h[2],o>s&&(s=o,t[0]=h[0],t[1]=h[1],t[2]=h[2]);s<=0&&(t[0]=t[1]=t[2]=0,t[this.longAxis_(u)]=1)},e.prototype.checkOrientation_=function(){for(var t=this.mesh.fHead,r,i=this.mesh.vHead,n,a=0,o=t.next;o!==t;o=o.next)if(n=o.anEdge,!(n.winding<=0))do a+=(n.Org.s-n.Dst.s)*(n.Org.t+n.Dst.t),n=n.Lnext;while(n!==o.anEdge);if(a<0){for(r=i.next;r!==i;r=r.next)r.t=-r.t;this.tUnit[0]=-this.tUnit[0],this.tUnit[1]=-this.tUnit[1],this.tUnit[2]=-this.tUnit[2]}},e.prototype.projectPolygon_=function(){var t=this.mesh.vHead,r=[0,0,0],i,n,a=!1;r[0]=this.normal[0],r[1]=this.normal[1],r[2]=this.normal[2],!r[0]&&!r[1]&&!r[2]&&(this.computeNormal_(r),a=!0),i=this.sUnit,n=this.tUnit;var o=this.longAxis_(r);i[o]=0,i[(o+1)%3]=1,i[(o+2)%3]=0,n[o]=0,n[(o+1)%3]=0,n[(o+2)%3]=r[o]>0?1:-1;for(var s=t.next;s!==t;s=s.next)s.s=this.dot_(s.coords,i),s.t=this.dot_(s.coords,n);a&&this.checkOrientation_();for(var l=!0,c=t.next;c!==t;c=c.next)l?(this.bmin[0]=this.bmax[0]=c.s,this.bmin[1]=this.bmax[1]=c.t,l=!1):(c.s<this.bmin[0]&&(this.bmin[0]=c.s),c.s>this.bmax[0]&&(this.bmax[0]=c.s),c.t<this.bmin[1]&&(this.bmin[1]=c.t),c.t>this.bmax[1]&&(this.bmax[1]=c.t))},e.prototype.addWinding_=function(t,r){t.winding+=r.winding,t.Sym.winding+=r.Sym.winding},e.prototype.tessellateMonoRegion_=function(t,r){var i,n;if(i=r.anEdge,!(i.Lnext!==i&&i.Lnext.Lnext!==i))throw"Mono region invalid";for(;zt.vertLeq(i.Dst,i.Org);i=i.Lprev);for(;zt.vertLeq(i.Org,i.Dst);i=i.Lnext);n=i.Lprev;for(var a=void 0;i.Lnext!==n;)if(zt.vertLeq(i.Dst,n.Org)){for(;n.Lnext!==i&&(zt.edgeGoesLeft(n.Lnext)||zt.edgeSign(n.Org,n.Dst,n.Lnext.Dst)<=0);)a=t.connect(n.Lnext,n),n=a.Sym;n=n.Lprev}else{for(;n.Lnext!==i&&(zt.edgeGoesRight(i.Lprev)||zt.edgeSign(i.Dst,i.Org,i.Lprev.Org)>=0);)a=t.connect(i,i.Lprev),i=a.Sym;i=i.Lnext}if(n.Lnext===i)throw"Mono region invalid";for(;n.Lnext.Lnext!==i;)a=t.connect(n.Lnext,n),n=a.Sym;return!0},e.prototype.tessellateInterior_=function(t){for(var r,i=t.fHead.next;i!==t.fHead;i=r)if(r=i.next,i.inside&&!this.tessellateMonoRegion_(t,i))return!1;return!0},e.prototype.discardExterior_=function(t){for(var r,i=t.fHead.next;i!==t.fHead;i=r)r=i.next,i.inside||t.zapFace(i)},e.prototype.setWindingNumber_=function(t,r,i){for(var n,a=t.eHead.next;a!==t.eHead;a=n)n=a.next,a.Rface.inside!==a.Lface.inside?a.winding=a.Lface.inside?r:-r:i?t.delete(a):a.winding=0},e.prototype.getNeighbourFace_=function(t){return!t.Rface||!t.Rface.inside?-1:t.Rface.n},e.prototype.outputPolymesh_=function(t,r,i,n){var a,o=0,s=0,l;i>3&&t.mergeConvexFaces(i);for(var c=t.vHead.next;c!==t.vHead;c=c.next)c.n=-1;for(var u=t.fHead.next;u!==t.fHead;u=u.next)if(u.n=-1,!!u.inside){a=u.anEdge,l=0;do{var c=a.Org;c.n===-1&&(c.n=s,s++),l++,a=a.Lnext}while(a!==u.anEdge);if(l>i)throw"Face vertex greater that support polygon";u.n=o,++o}this.elementCount=o,r===sn.CONNECTED_POLYGONS&&(o*=2),this.elements=[],this.elements.length=o*i,this.vertexCount=s,this.vertices=[],this.vertices.length=s*n,this.vertexIndices=[],this.vertexIndices.length=s;for(var c=t.vHead.next;c!==t.vHead;c=c.next)if(c.n!==-1){var d=c.n*n;this.vertices[d+0]=c.coords[0],this.vertices[d+1]=c.coords[1],n>2&&(this.vertices[d+2]=c.coords[2]),this.vertexIndices[c.n]=c.idx}for(var h=0,u=t.fHead.next;u!==t.fHead;u=u.next)if(u.inside){a=u.anEdge,l=0;do{var c=a.Org;this.elements[h++]=c.n,l++,a=a.Lnext}while(a!==u.anEdge);for(var f=l;f<i;++f)this.elements[h++]=-1;if(r===sn.CONNECTED_POLYGONS){a=u.anEdge;do this.elements[h++]=this.getNeighbourFace_(a),a=a.Lnext;while(a!==u.anEdge);for(var p=l;p<i;++p)this.elements[h++]=-1}}},e.prototype.outputContours_=function(t,r){var i,n,a=0,o=0;this.vertexCount=0,this.elementCount=0;for(var s=t.fHead.next;s!==t.fHead;s=s.next)if(s.inside){n=i=s.anEdge;do this.vertexCount++,i=i.Lnext;while(i!==n);this.elementCount++}this.elements=[],this.elements.length=this.elementCount*2,this.vertices=[],this.vertices.length=this.vertexCount*r,this.vertexIndices=[],this.vertexIndices.length=this.vertexCount;var l=0,c=0,u=0;a=0;for(var s=t.fHead.next;s!==t.fHead;s=s.next)if(s.inside){o=0,n=i=s.anEdge;do this.vertices[l++]=i.Org.coords[0],this.vertices[l++]=i.Org.coords[1],r>2&&(this.vertices[l++]=i.Org.coords[2]),this.vertexIndices[c++]=this.vertexIdCallback?this.vertexIdCallback(i):i.Org.idx,o++,i=i.Lnext;while(i!==n);this.elements[u++]=a,this.elements[u++]=o,a+=o}},e.prototype.addContour=function(t,r){this.mesh===null&&(this.mesh=new LB),t<2&&(t=2),t>3&&(t=3);for(var i=null,n=0;n<r.length;n+=t)i===null?(i=this.mesh.makeEdge(),this.mesh.splice(i,i.Sym)):(this.mesh.splitEdge(i),i=i.Lnext),i.Org.coords[0]=r[n+0],i.Org.coords[1]=r[n+1],t>2?i.Org.coords[2]=r[n+2]:i.Org.coords[2]=0,i.Org.idx=this.vertexIndexCounter++,this.edgeCreateCallback&&this.edgeCreateCallback(i),i.winding=1,i.Sym.winding=-1},e.prototype.tesselate=function(t,r,i,n,a,o){if(t===void 0&&(t=ri.ODD),r===void 0&&(r=sn.POLYGONS),o===void 0&&(o=!0),this.vertices=[],this.elements=[],this.vertexIndices=[],this.vertexIndexCounter=0,a&&(this.normal[0]=a[0],this.normal[1]=a[1],this.normal[2]=a[2]),this.windingRule=t,n<2&&(n=2),n>3&&(n=3),!this.mesh)return!1;this.projectPolygon_(),Bze.computeInterior(this,o);var s=this.mesh;return r===sn.BOUNDARY_CONTOURS?this.setWindingNumber_(s,1,!0):this.tessellateInterior_(s),o&&s.check(),r===sn.BOUNDARY_CONTOURS?this.outputContours_(s,n):this.outputPolymesh_(s,r,i,n),!0},e}();function gu(e){var t=e.windingRule,r=t===void 0?ri.ODD:t,i=e.elementType,n=i===void 0?sn.POLYGONS:i,a=e.polySize,o=a===void 0?3:a,s=e.vertexSize,l=s===void 0?2:s,c=e.normal,u=c===void 0?[0,0,1]:c,d=e.contours,h=d===void 0?[]:d,f=e.strict,p=f===void 0?!0:f,v=e.debug,m=v===void 0?!1:v;if(!h&&p)throw new Error("Contours can't be empty");if(h){var g=new Fze;e.edgeCreateCallback&&(g.edgeCreateCallback=e.edgeCreateCallback),e.vertexIdCallback&&(g.vertexIdCallback=e.vertexIdCallback);for(var y=0;y<h.length;y++)g.addContour(l||2,h[y]);return g.tesselate(r,n,o,l,u,p),{vertices:g.vertices,vertexIndices:g.vertexIndices,vertexCount:g.vertexCount,elements:g.elements,elementCount:g.elementCount,mesh:m?g.mesh:void 0}}}ri.ODD;ri.NONZERO;ri.POSITIVE;ri.NEGATIVE;ri.ABS_GEQ_TWO;sn.POLYGONS;sn.CONNECTED_POLYGONS;sn.BOUNDARY_CONTOURS;var EE=class{constructor(e=256,t=!1){this.capacity=e,this.size=0,this.debug=t,this.debug&&console.log(`allocating with cap ${e}`);let r=e*EE.eSize;this.buffer=new ArrayBuffer(r);let i=Float32Array.BYTES_PER_ELEMENT,n=0;this.positions=new Float32Array(this.buffer,n*i,3*e),n+=3*e,this.normals=new Float32Array(this.buffer,n*i,3*e),n+=3*e,this.uvs=new Float32Array(this.buffer,n*i,2*e)}realloc(e,t=!1){if(e<this.size)throw Error("cannot shrink buffer");if(e<=this.capacity&&!t)return;this.debug&&console.log(`resizing from ${this.capacity}  ${e}`);let r=e*EE.eSize,i=new ArrayBuffer(r),n=Float32Array.BYTES_PER_ELEMENT,a=0,o=new Float32Array(i,a*n,3*e);a+=3*e;let s=new Float32Array(i,a*n,3*e);a+=3*e;let l=new Float32Array(i,a*n,2*e);t?(o.set(this.positions.subarray(0,this.size*3)),s.set(this.normals.subarray(0,this.size*3)),l.set(this.uvs.subarray(0,this.size*2))):(o.set(this.positions),s.set(this.normals),l.set(this.uvs)),this.buffer=i,this.positions=o,this.normals=s,this.uvs=l,this.capacity=e}get(e=1){let t=this.size+e;if(t>this.capacity){let i=this.capacity;for(;t>i;)i*=2;this.realloc(i)}let r=this.size;return this.size=t,r}reserve(e){let t=this.size+e;t>this.capacity&&this.realloc(t)}shrink(){this.debug&&console.log(`shrinking ${this.capacity}  ${this.size}`),this.realloc(this.size,!0)}},bW=EE;bW.eSize=8*Float32Array.BYTES_PER_ELEMENT;var Nze=Ac(Wye()),kD={vertices:[160,160,-160,160,-160,-160,160,-160],vertexIndices:[1,0,3,2],vertexCount:4,elements:[0,4],elementCount:1,mesh:void 0},xW={vertices:[],vertexIndices:[],vertexCount:0,elements:[],elementCount:0,mesh:void 0},wW={vertices:[-160,160,160,-160,160,160,-160,-160],vertexIndices:[1,3,0,2],vertexCount:4,elements:[0,1,2,1,0,3],elementCount:2,mesh:void 0},f_=(e,t)=>([r,i])=>(i<r&&(i+=t),(e>=r?e:e+t)<=i),LD=class extends Ot{constructor(e,t,r=0,i=12,n=3,a=ri.ODD,o=!1){super(),this.forPathBevel=o,this.type="ShapeGeometry",this.vertexCache={},this._shape=e,this._depth=t,this._curveSegments=i,this._bevelSegmentsInput=n;let s=this._shape.extractShapePointsToFlatArray([],i),l=this._shape.shapeHoles.map(A=>{let M=A.extractShapePointsToFlatArray([],i),P=[];for(let T=M.length-1;T>=1;T-=2){let R=M[T-1],z=M[T-0];P.push(R,z)}return P}),c=[],u=[];for(let A=0;A<s.length;A+=2)u.push([s[A],s[A+1]]);c.push(u);for(let A=0;A<l.length;A++){let M=l[A],P=[];for(let T=0;T<M.length;T+=2)P.push([M[T],M[T+1]]);c.push(P)}let d;e.isText?d=new B8().setFromPoints(e.points.map(A=>A.position)).getSize(new ye).length()*.1:c[0].length===0?d=r:d=(0,Nze.default)(c).distance,r<=0?(this._bevel=0,this._bevelSegments=0):(this._bevel=Math.min(r,d,t/2),this._bevelSegments=Math.floor(n));let h;try{h=gu({windingRule:a,elementType:sn.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[s]})}catch{h=kD}let f;try{f=gu({windingRule:ri.ODD,elementType:sn.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[...l]})}catch{f=xW}if(!h)throw new Error("error generating geometry");let p=h.elementCount;if(f){h.elementCount+=f.elementCount;for(let A=0;A<f.elements.length;A++){let M=f.elements[A],P=A%2===0?h.vertexCount:0;h.elements.push(M+P)}for(let A=0;A<f.vertexIndices.length;A++){let M=f.vertexIndices[A],P=h.vertexCount;h.vertexIndices.push(M+P)}for(let A=0;A<f.vertices.length;A++){let M=f.vertices[A];h.vertices.push(M)}}let v=1/0,m=-1/0,g=1/0,y=-1/0;for(let A=0,M=h.vertexCount;A<M;A++){let P=A*2,T=h.vertices[P+0],R=h.vertices[P+1];T<v&&(v=T),T>m&&(m=T),R<g&&(g=R),R>y&&(y=R)}this._minX=v,this._minY=g,this._width=m-v,this._height=y-g,this._buffer=new bW(this._computeBufferEstimatedSize(h));let b=[],x=[];for(let A=h.elementCount-1;A>=0;A--){let M=A>=p,P=A*2,T=h.elements[P+0],R=h.elements[P+1],z=T+R,F={start:T,count:R,normals:[],continuous:[],concave:[]},H=T,N=z-1,U=T+1,ie=this._shape.roundedCurves.length;do{let $=H-T,le=h.vertices[N*2+0],ee=h.vertices[N*2+1],Q=h.vertices[H*2+0],ne=h.vertices[H*2+1],V=h.vertices[U*2+0],ue=h.vertices[U*2+1],ve=Q-le,Ce=ne-ee,G=Math.sqrt(ve*ve+Ce*Ce);ve/=G,Ce/=G;let Z=Q-V,de=ne-ue,Se=Math.sqrt(Z*Z+de*de);Z/=Se,de/=Se,F.normals[$*2+0]=-de,F.normals[$*2+1]=Z,F.concave[$]=ve*de-Ce*Z>0;let we=h.vertexIndices[H];if(Array.isArray(we))F.continuous[$]=!1;else{let[_e,Ee]=this._shape.getCurveIndexFromVertexId(we-1,!0);if(Ee>0&&Ee<1)F.continuous[$]=!0;else{let fe=Ee===1?_e+1:_e-1;fe=(fe+ie)%ie;let B=Ee===1?0:1,D=this._shape.roundedCurves[_e].getTangent(Ee),I=this._shape.roundedCurves[fe].getTangent(B);F.continuous[$]=D.dot(I)>.95}}M&&(F.normals[$*2+0]*=-1,F.normals[$*2+1]*=-1),[N,H,U]=[H,U,U+1],U>=z&&(U-=R)}while(U!==T+1);let te=[];te.push({bevelI:0,angle:0,size:0,boundary:{vertices:h.vertices.slice(T*2,z*2),vertexCount:R,vertexIndices:new Array(R).fill(!0).map(($,le)=>[le,le]),elements:[0,R],elementCount:1,mesh:null},reverseMap:[],insetPoints:h.vertices.slice(T*2,z*2)});let X=0;for(let $=1;$<=this._bevelSegments;$++){let le=$/this._bevelSegments*Math.PI/2,ee=(1-Math.cos(le))*this._bevel,Q=[],ne=[],V=0;for(let ve=0;ve<R;ve++){let Ce=ve*2,G=(ve-1+R)%R*2,Z=h.vertices[F.start*2+Ce+0],de=h.vertices[F.start*2+Ce+1],Se=-F.normals[G+0]*ee,we=-F.normals[G+1]*ee,_e=-F.normals[Ce+0]*ee,Ee=-F.normals[Ce+1]*ee;if(F.concave[ve]||!F.concave[ve]&&M){let fe=Math.atan2(we,Se),B=Math.atan2(Ee,_e);B>fe&&(B-=Math.PI*2);let D=B-fe;if(F.continuous[ve]||M){let I=fe+D/2,O=Math.cos(I)*ee,j=Math.sin(I)*ee;Q[2*V+0]=Z+O*(M?-1:1),Q[2*V+1]=de+j*(M?-1:1),ne[V]=ve,V++}else{let I=Math.max(1,Math.floor(i/4*Math.abs(D)/Math.PI));for(let O=0;O<=I;O++){let j=fe+D*(O/I),L=Math.cos(j)*ee,Ae=Math.sin(j)*ee;Q[2*V+0]=Z+L,Q[2*V+1]=de+Ae,ne[V]=ve,V++}}}else Q[2*V+0]=Z+Se,Q[2*V+1]=de+we,ne[V]=ve,V++,Q[2*V+0]=Z,Q[2*V+1]=de,ne[V]=ve,V++,Q[2*V+0]=Z+_e,Q[2*V+1]=de+Ee,ne[V]=ve,V++}let ue=gu({windingRule:ri.POSITIVE,elementType:sn.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[Q],edgeCreateCallback:ve=>{let Ce=ve.Org.idx,G=ne[Ce],Z=ne[(Ce+1)%ne.length];ve.idx=[G,Z],ve.Sym.idx=[Z,G]},vertexIdCallback:ve=>{let Ce=ve.Lprev.idx;return[Ce?Ce[1]:0,ve.idx?ve.idx[0]:0]}});if(!ue)throw console.log("Error"),new Error(`error generating bevel geometry for ${$}'th loop`);if(!ue.vertexCount){let ve=($-1)/this._bevelSegments*Math.PI/2;X=(1-Math.sin(ve))*this._bevel;break}for(let ve=0;ve<ue.vertexIndices.length;ve++){let[Ce,G]=ue.vertexIndices[ve];if(Ce===G)continue;let Z=G;G<Ce&&(Z+=R);for(let de=Ce;de<Z;de++){let Se=de%R,we=(de+1)%R;if(!F.continuous[Se]||!F.continuous[we]){ue.vertexIndices[ve]=[Ce,Se],ue.vertexIndices.splice(ve+1,0,[we,G]),ue.vertices.splice((ve+1)*2,0,ue.vertices[ve*2],ue.vertices[ve*2+1]);break}}}te.push({bevelI:$,angle:le,size:ee,boundary:ue,reverseMap:ne,insetPoints:Q})}let W=($,le,ee)=>{let Q=0,ne=$.boundary.vertexIndices.length;for(;Q<ne&&ee($.boundary.vertexIndices[le]);)le=(le+1)%ne,Q++;return Q},q=b.length;for(let $=1;$<te.length;$++){let le=te[$-1],ee=te[$],Q=le.boundary.vertexIndices.length,ne=ee.boundary.vertexIndices.length;if(!Q||!ne)break;let V=F.concave.length,ue=0,ve=f_(ue,R);for(;!le.boundary.vertexIndices.filter(ve).length||!ee.boundary.vertexIndices.filter(ve).length;)ue++,ve=f_(ue,R);let Ce=le.boundary.vertexIndices.findIndex(ve),G=ee.boundary.vertexIndices.findIndex(ve);do Ce=(Ce+1)%Q;while(ve(le.boundary.vertexIndices[Ce]));do G=(G+1)%ne;while(ve(ee.boundary.vertexIndices[G]));ue=(ue+1)%R;let Z=ue,de=0,Se=this._buildBevelVert(F,le,(Ce-1+Q)%Q,void 0,de),we=this._buildBevelVert(F,ee,(G-1+ne)%ne,void 0,de),_e=Se,Ee=we,fe,B,D=!1;do{de=(ue||V)/V,ve=f_(ue,R);let I=W(le,Ce,ve),O=W(ee,G,ve),j=D;if(D=!1,I&&!O){for(let L=0;L<I;L++)fe=this._buildBevelVert(F,le,(Ce+L)%Q,L/(I-1),de),b.push(_e.topN,fe.topP,Ee.topN),o===!1&&b.push(fe.bottomP,_e.bottomN,Ee.bottomN),_e=fe;D=!0}else if(!I&&O)for(let L=0;L<O;L++)B=this._buildBevelVert(F,ee,(G+L)%ne,L/(O-1),de),b.push(Ee.topN,_e.topP,B.topP),o===!1&&b.push(_e.bottomP,Ee.bottomN,B.bottomP),Ee=B;else if(I&&O)if(fe=this._buildBevelVert(F,le,Ce,0,de),B=this._buildBevelVert(F,ee,G,0,de),j?(b.push(_e.topN,B.topP,Ee.topN),b.push(_e.topN,fe.topP,B.topP),o===!1&&(b.push(B.bottomP,_e.bottomN,Ee.bottomN),b.push(B.bottomP,fe.bottomP,_e.bottomN))):(b.push(Ee.topN,_e.topN,fe.topP),b.push(Ee.topN,fe.topP,B.topP),o===!1&&(b.push(fe.bottomP,_e.bottomN,Ee.bottomN),b.push(fe.bottomP,Ee.bottomN,B.bottomP))),_e=fe,Ee=B,I===O)for(let L=1;L<I;L++)fe=this._buildBevelVert(F,le,(Ce+L)%Q,L/(I-1),de),B=this._buildBevelVert(F,ee,(G+L)%ne,L/(O-1),de),b.push(_e.topN,fe.topP,Ee.topN),b.push(Ee.topN,fe.topP,B.topP),o===!1&&(b.push(fe.bottomP,_e.bottomN,Ee.bottomN),b.push(fe.bottomP,Ee.bottomN,B.bottomP)),_e=fe,Ee=B;else if(I>O){let L=I/O,Ae=0;for(let We=1;We<I;We++)fe=this._buildBevelVert(F,le,(Ce+We)%Q,We/(I-1),de),b.push(_e.topN,fe.topP,Ee.topN),o===!1&&b.push(fe.bottomP,_e.bottomN,Ee.bottomN),_e=fe,We>(Ae+1)*L&&(Ae++,B=this._buildBevelVert(F,ee,(G+Ae)%ne,Ae/(O-1),de),b.push(Ee.topN,fe.topP,B.topP),o===!1&&b.push(fe.bottomP,Ee.bottomN,B.bottomP),Ee=B)}else{let L=O/I,Ae=0;for(let We=1;We<O;We++)B=this._buildBevelVert(F,ee,(G+We)%ne,We/(O-1),de),b.push(Ee.topN,fe.topP,B.topP),o===!1&&b.push(fe.bottomP,Ee.bottomN,B.bottomP),Ee=B,We>(Ae+1)*L&&(Ae++,fe=this._buildBevelVert(F,le,(Ce+Ae)%Q,Ae/(I-1),de),b.push(_e.topN,fe.topP,Ee.topN),o===!1&&b.push(fe.bottomP,_e.bottomN,Ee.bottomN),_e=fe)}Ce=(Ce+I)%Q,G=(G+O)%ne,ue=(ue+1)%V}while(ue!==Z)}if(o===!1&&this._depth>this._bevel*2&&this._buildWall(te,F,b),M){let $=[];for(let le=b.length-1;le>=q+2;le-=3){let ee=b[le-2],Q=b[le-1],ne=b[le-0];$.push(ne,Q,ee)}b.splice(q,b.length-q,...$)}if(M){let $=[];for(let le=te[te.length-1].boundary.vertices.length-1;le>=1;le-=2){let ee=te[te.length-1].boundary.vertices[le-1],Q=te[te.length-1].boundary.vertices[le-0];$.push(ee,Q)}x.push($)}if(!M){let $=te[te.length-1],le;try{le=gu({windingRule:te.length>1?ri.POSITIVE:ri.ODD,elementType:sn.POLYGONS,vertexSize:2,strict:!0,contours:[$.insetPoints,...x]})}catch{le=wW}if(!le)throw new Error("Error generating geometry for surface");l.length===0&&this._bevel<d&&Object.assign(this,{useNgonForTopBottomFaceDuringBake:!0});for(let ee=0;ee<le.elementCount*3;ee+=3){let Q=this._buildSurfaceVert(le,le.elements[ee+0],X),ne=this._buildSurfaceVert(le,le.elements[ee+1],X),V=this._buildSurfaceVert(le,le.elements[ee+2],X);b.push(Q.top,ne.top,V.top),o===!1&&b.push(V.bottom,ne.bottom,Q.bottom)}}this.vertexCache={}}this._buffer.shrink();let S=new qt(Uint32Array.from(b),1),w=new qt(this._buffer.positions,3),_=new qt(this._buffer.normals,3),C=new qt(this._buffer.uvs,2);w.needsUpdate=!0,_.needsUpdate=!0,C.needsUpdate=!0,S.needsUpdate=!0,this.setAttribute("position",w),this.setAttribute("normal",_),this.setAttribute("uv",C),this.setIndex(S)}_computeBufferEstimatedSize(e){return e.vertexCount*2*(2+this._bevelSegments)}_buildWall(e,t,r){let i=e[0];for(let n=0,a=i.boundary.vertexCount;n<a;n++){let o=this._buildBevelVert(t,i,n),s=this._buildBevelVert(t,i,(n+1)%a);r.push(s.topP,o.topN,o.bottomN),r.push(s.topP,o.bottomN,s.bottomP)}}_buildSurfaceVert(e,t,r){let i=t.toString();if(i in this.vertexCache)return this.vertexCache[i];let n=e.vertices[t*2+0],a=e.vertices[t*2+1],o=(n-this._minX)/this._width,s=(a-this._minY)/this._height;this.forPathBevel&&(s=1);let l=this._buffer.get(this.forPathBevel?1:2),c=l*3,u=l*2,d={top:l+0,bottom:l+1};return this._buffer.positions[c+0]=n,this._buffer.positions[c+1]=a,this._buffer.positions[c+2]=this.forPathBevel?this._bevel:this._depth-r,this._buffer.normals[c+0]=0,this._buffer.normals[c+1]=0,this._buffer.normals[c+2]=1,this._buffer.uvs[u+0]=o,this._buffer.uvs[u+1]=s,this.forPathBevel===!1&&(this._buffer.positions[c+3]=n,this._buffer.positions[c+4]=a,this._buffer.positions[c+5]=r,this._buffer.normals[c+3]=0,this._buffer.normals[c+4]=0,this._buffer.normals[c+5]=-1,this._buffer.uvs[u+2]=o,this._buffer.uvs[u+3]=s),this.vertexCache[i]=d,d}_buildBevelVert(e,t,r,i=1,n){let a=`${t.bevelI}:${r}`;if(a in this.vertexCache&&n!==0&&n!==1&&(!n||n===this.vertexCache[a].pathBevelUCoord))return this.vertexCache[a];let[o,s]=t.boundary.vertexIndices[r],l,c,u,d;o!==s?(c=o,l=s,d=!1,u=e.continuous[c]&&e.continuous[l]):(l=o,c=(l-1+e.count)%e.count,d=e.concave[l]&&t.bevelI>0,u=e.continuous[l]||d);let h=Math.cos(t.angle),f=Math.sin(t.angle),p=r*2,v=l*2,m=c*2,g=t.boundary.vertices[p+0],y=t.boundary.vertices[p+1],b=(1-f)*this._bevel,x=(g-this._minX)/this._width,S=(y-this._minY)/this._height;this.forPathBevel&&(n!==void 0&&(x=n),S=1);let w=e.normals[v+0],_=e.normals[v+1],C=e.normals[m+0],A=e.normals[m+1];if(d){let z=C-w,F=A-_;w=w+z*(1-i),_=_+F*(1-i);let H=Math.sqrt(w*w+_*_);w/=H,_/=H}let M=this.forPathBevel?this._buffer.get(u?1:2):this._buffer.get(u?2:4),P=M*3,T=M*2,R={i:r,fi:l,topP:M+0,topN:M+0,bottomP:M+1,bottomN:M+1,pathBevelUCoord:n};return this._buffer.positions[P+0]=g,this._buffer.positions[P+1]=y,this._buffer.positions[P+2]=(this.forPathBevel?this._bevel:this._depth)-b,this._buffer.normals[P+0]=w*h,this._buffer.normals[P+1]=_*h,this._buffer.normals[P+2]=f,this._buffer.uvs[T+0]=x,this._buffer.uvs[T+1]=S,this.forPathBevel===!1&&(this._buffer.positions[P+3]=g,this._buffer.positions[P+4]=y,this._buffer.positions[P+5]=b,this._buffer.normals[P+3]=w*h,this._buffer.normals[P+4]=_*h,this._buffer.normals[P+5]=-f,this._buffer.uvs[T+2]=S,this._buffer.uvs[T+3]=x),u||(this.forPathBevel?(M+=1,P+=3,T+=2):(M+=2,P+=6,T+=4),R.topP=M+0,R.bottomP=M+1,this._buffer.positions[P+0]=g,this._buffer.positions[P+1]=y,this._buffer.positions[P+2]=(this.forPathBevel?this._bevel:this._depth)-b,this._buffer.normals[P+0]=C*h,this._buffer.normals[P+1]=A*h,this._buffer.normals[P+2]=f,this._buffer.uvs[T+0]=x,this._buffer.uvs[T+1]=S,this.forPathBevel===!1&&(this._buffer.positions[P+3]=g,this._buffer.positions[P+4]=y,this._buffer.positions[P+5]=b,this._buffer.normals[P+3]=C*h,this._buffer.normals[P+4]=A*h,this._buffer.normals[P+5]=-f,this._buffer.uvs[T+2]=S,this._buffer.uvs[T+3]=x)),this.vertexCache[a]=R,R}clone(){let e=new LD(this._shape,this._depth,this._bevel,this._curveSegments,this._bevelSegmentsInput);return e.userData=Fw(this.userData),e}},SW=class extends Ot{constructor(e,t=12,r={}){super(),this.type="ShapeGeometry",this.windingRule=ri.ODD,this.elementType=sn.POLYGONS,this.polySize=3,this.vertexSize=2,this.strict=!0,this._shape=e,this._curveSegments=t,this._triangulationOptions=Object.assign({windingRule:ri.ODD,elementType:sn.POLYGONS,polySize:3,vertexSize:2,strict:!0},r);let i=this._shape.extractShapePointsToFlatArray([],this._curveSegments),n=this._shape.shapeHoles.map(h=>h.extractShapePointsToFlatArray([],this._curveSegments)),a,o=!0,s=!0,l,c;for(let h=0,f=i.length/2;h<f;h++){let p=h*2,v=i[p+0],m=i[p+1];if(l!==void 0&&v!==l&&(o=!1),c!==void 0&&m!==c&&(s=!1),l=v,c=m,!o&&!s)break}if(!o&&!s)try{a=gu({contours:[i,...n],windingRule:this._triangulationOptions.windingRule,elementType:this._triangulationOptions.elementType,polySize:this._triangulationOptions.polySize,vertexSize:this._triangulationOptions.vertexSize,strict:this._triangulationOptions.strict})}catch{a=kD}let u=(a==null?void 0:a.vertexCount)??1,d=(a==null?void 0:a.elementCount)??1;if(this._positionAttribute=new qt(new Float32Array(u*3),3),this._normalAttribute=new qt(new Float32Array(u*3),3),this._uvAttribute=new qt(new Float32Array(u*2),2),this._indexAttribute=new qt(new Uint32Array(d*3),1),a){let h=1/0,f=-1/0,p=1/0,v=-1/0;for(let y=0,b=u;y<b;y++){let x=y*2,S=a.vertices[x+0],w=a.vertices[x+1];S<h&&(h=S),S>f&&(f=S),w<p&&(p=w),w>v&&(v=w)}let m=f-h,g=v-p;for(let y=0,b=u;y<b;y++){let x=y*2,S=a.vertices[x+0],w=a.vertices[x+1],_=(S-h)/m,C=(w-p)/g;this._positionAttribute.setXYZ(y,S,w,0),this._normalAttribute.setXYZ(y,0,0,1),this._uvAttribute.setXY(y,_,C)}for(let y=0,b=d;y<b;y++){let x=y*3,S=a.elements[x+0],w=a.elements[x+1],_=a.elements[x+2];this._indexAttribute.setX(x+0,S),this._indexAttribute.setX(x+1,w),this._indexAttribute.setX(x+2,_)}}this.setAttribute("position",this._positionAttribute),this.setAttribute("normal",this._normalAttribute),this.setAttribute("uv",this._uvAttribute),this.setIndex(this._indexAttribute),this.setDrawRange(0,((a==null?void 0:a.elementCount)??1)*3)}clone(){let e=new SW(this._shape,this._curveSegments);return e.userData=Fw(this.userData),e}},CW=class extends LD{constructor(e,t,r=0,i=12,n=3,a=ri.ODD){super(e,t,r,i,n,a),this.type="ShapeGeometry"}_computeBufferEstimatedSize(e){return e.vertexCount*2*(2+this._bevelSegments)}_buildWall(e,t,r){let i=e[0];for(let n=0,a=i.boundary.vertexCount;n<a;n++){let o=this._buildBevelVert(t,i,n),s=this._buildBevelVert(t,i,(n+1)%a);r.push(s.topP,o.topN,o.bottomN),r.push(s.topP,o.bottomN,s.bottomP)}}clone(){let e=new CW(this._shape,this._depth,this._bevel,this._curveSegments,this._bevelSegmentsInput);return e.userData=Fw(this.userData),e}},Lh=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var c,u;let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,subdivisions:40,roundness:0,extrudeBevelSize:0,extrudeBevelSegments:3,windingRule:ri.ODD},e.parameters),i=Math.abs(r.width),n=Math.abs(r.height??r.width),a=Math.abs(r.depth??0),o=e.shape??(t==null?void 0:t.shape),s=(o==null?void 0:o.roundness)??r.roundness;o!==void 0&&(o instanceof Fi?(o.width!==i||o.height!==n)&&o.applySize(i,n):o=new Fi(i,n).fromJSON(o),((c=e.parameters)==null?void 0:c.roundness)!==void 0&&((u=e.parameters)==null?void 0:u.roundness)>0&&o.update());let l=o??new Fi(i,n);return{parameters:Object.assign(r,{width:i,height:n,depth:a,roundness:s}),shape:l}}static build(e){let{depth:t,extrudeBevelSize:r,extrudeBevelSegments:i,subdivisions:n,roundness:a,windingRule:o}=e.parameters;e.shape.roundness=a;let s;return t<=0?s=new SW(e.shape,n,{windingRule:o}):s=new CW(e.shape,t,r,n,i,o),Object.assign(s,{userData:{...e,type:"VectorGeometry"}})}},_W=Math.PI*2,BD=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0,spikes:64,angle:360,innerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:1},e.parameters);return r.angle=St.clamp(r.angle,0,360),{shape:e.shape&&e.shape instanceof Fi?e.shape:new Fi,parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??0)})}}static build(e){let{width:t,height:r,spikes:i,angle:n,innerRadius:a,depth:o,extrudeBevelSize:s,extrudeBevelSegments:l}=e.parameters,c=e.shape,u=t*.5,d=r*.5,h=Uze(c,u,d,n*Math.PI/180,i,a);c.isClosed=!0,c.update();let f;return n===0?(f=new Ot,f.setAttribute("position",new yt([],3))):f=Lh.create({shape:c,parameters:{subdivisions:h,depth:o,extrudeBevelSize:s,extrudeBevelSegments:l}}),Object.assign(f,{userData:{...e,type:"EllipseGeometry"}})}};function Uze(e,t,r,i,n,a){if(i>=_W)return n>30||n%4===0?(Vze(e,t,r,a),Math.round(n/4)):UB(e,i,n,t,r,a);i=Math.max(i,.001);let o={x:0,y:r},s=i+Math.PI*.5,l={x:Math.cos(s)*t,y:Math.sin(s)*r},c=zze({px:o.x,py:o.y,cx:l.x,cy:l.y,rx:t,ry:r,largeArcFlag:i>Math.PI,sweepFlag:!0});return n>30||n%c.length===0?jze(e,o.x,o.y,c,n,t,r,a):UB(e,i,n,t,r,a)}function jze(e,t,r,i,n,a,o,s){let l=Math.round(n/i.length);e.addPoint(dp(t,r));for(let c=0,u=i.length;c<u;c++){let d=i[c],h=e.points[c],f=dp(d.x,d.y);h.controls[1].position.set(d.x1,d.y1),f.controls[0].position.set(d.x2,d.y2),e.addPoint(f)}return s>0?AW(e,a,o,s):e.addPoint(dp(0,0)),l}function UB(e,t,r,i,n,a){let o=-t/r;for(let s=0;s<=r;s++){let l=o*s,c=Math.sin(l)*i,u=Math.cos(l)*n;e.addPoint(dp(c,u))}return t<_W?a>0?AW(e,i,n,a):e.addPoint(dp(0,0)):(e.removePoint(e.points[e.points.length-1]),a>0&&MW(e,i,n,a)),1}function Vze(e,t,r,i=0,n=0,a=0){let o=.5522847498,s=t*o,l=r*o;e.addPoint(Qy(n-t,a,n-t,a-l,n-t,a+l)),e.addPoint(Qy(n,a+r,n-s,a+r,n+s,a+r)),e.addPoint(Qy(n+t,a,n+t,a+l,n+t,a-l)),e.addPoint(Qy(n,a-r,n+s,a-r,n-s,a-r)),i>0&&MW(e,t,r,i)}function dp(e,t){return new up(St.generateUUID(),new ye(e,t))}function Qy(e,t,r,i,n,a){let o=dp(e,t);return o.controls[0].position.set(r,i),o.controls[1].position.set(n,a),o}function AW(e,t,r,i){EW(e,t,r,i).forEach(n=>e.addPoint(n))}function MW(e,t,r,i){let n=EW(e,t,r,i),a=new Fi;n.forEach(o=>a.addPoint(o)),a.isClosed=!0,e.shapeHoles.push(a)}function EW(e,t,r,i){let n=i*t/100,a=n*(Math.abs(r)/Math.abs(t)),o=new ye(n/t,a/r),s=e.points.map(l=>{let c=l.clone();return c.uuid=St.generateUUID(),c}).reverse();return s.forEach(l=>{l.position.multiply(o);let c=l.controls[0].position.clone().multiply(o),u=l.controls[1].position.clone().multiply(o);l.controls[0].position.copy(u),l.controls[1].position.copy(c)}),s}var Hze=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,revolutions:2,segments:40,pathRadius:10,pathType:0,pathSegments:30,cornerRadius:30,cornerSegments:4},e.parameters),i=Math.abs(r.width),n=Math.abs(r.height??i),a=Math.abs(r.depth??i),o=Math.abs(Math.min(i,a))/2;return{parameters:Object.assign(r,{width:i,height:n,depth:a,radius:o,segments:Math.round(r.segments),pathSegments:Math.round(r.pathSegments),cornerSegments:Math.round(r.cornerSegments)})}}static build(e){let{width:t,height:r,depth:i,radius:n,revolutions:a,segments:o,pathRadius:s,pathType:l,pathSegments:c,cornerRadius:u,cornerSegments:d}=e.parameters,h=new TW(!1,t,r,i,n,a,o,s,l,c,u,d);return Object.assign(h,{userData:{...e,type:"HelixGeometry"}})}},p_=new ap([0,0,0],1),TW=class extends Ot{constructor(e=!0,t=1,r=1,i=1,n=1,a=1,o=1,s=1,l=1,c=1,u=1,d=1){if(super(),a===0)return;let h=e&&a===1;h&&(d=0),u>100&&(u=100),u===0&&(d=0);let f=()=>new k,p=new k,v=f(),m=f(),g=f(),y,b,x,S,w,_,C,A,M=f(),P=f(),T=f(),R=f(),z=f(),F=f(),H=f(),N=f(),U=r-2*s+.001,ie=U/a,te=Math.ceil(o*a),X=te+1,W=U/te,q=-U/2,$=c+1,le=2*Math.PI/c,ee=Math.PI/2/d,Q=.01,ne=Math.min((1-u/100)*s,s-Q),V=s-ne,ue=0,ve=2,Ce=d*ve+ve,G=$*Ce/ve,Z=G+$*X,de=Math.max(0,$*(X+Ce)),[Se,we,_e]=[3,3,2].map(ke=>Array(de*ke).fill(0)),Ee=[],fe=n-s;function B(ke,et){let nt=Math.PI/2;_=et*W,A=2*Math.PI*(_%ie)/ie+nt,_+=q,C=Math.sin(A)*fe,w=Math.cos(A)*fe,e?ke.set(w,C,_):ke.set(w,_,C)}B(p,-1e-10),B(v,0),M.copy(p),B(p,1);let D=p.distanceTo(v),I=h?0:V+ne,O=D*te+2*I,j=ne,L=O-I;for(let ke=0;ke<=te;ke++){B(m,ke),N.subVectors(m,M).normalize(),M.copy(m),F.copy(m).setComponent(+e+1,0).normalize(),H.crossVectors(N,F).normalize();let et=ke===0,nt=ke===te,lt=et?3*Math.PI/2:ee,ut=et?j:L,vt=et?$:Z,se=et?0:de-$,Be=N.clone().multiplyScalar(et?-V:V).add(m),Ye=N.clone().multiplyScalar(et?-1:1).normalize();for(let pe=0;pe<$;pe++){let Te=pe*le;if(P.addVectors(p.copy(F).multiplyScalar(s*Math.cos(Te)),v.copy(H).multiplyScalar(s*Math.sin(Te))),T.copy(P).normalize(),et||nt){h||(ue=se+pe,[0,1,2].forEach(ce=>{Se[ue*3+ce]=Be.getComponent(ce),we[ue*3+ce]=Ye.getComponent(ce)}),_e[ue*2]=+nt,_e[ue*2+1]=pe/c),v.copy(T).multiplyScalar(ne),g.addVectors(m,v);for(let ce=0;ce<d;ce++){let Re=ce*ee+lt;R.addVectors(p.copy(N).multiplyScalar(V*Math.sin(Re)),v.copy(T).multiplyScalar(V*Math.cos(Re))),z.copy(R).normalize(),v.addVectors(g,R),R.normalize(),ue=vt+ce*$+pe,[0,1,2].forEach(at=>{Se[ue*3+at]=v.getComponent(at),we[ue*3+at]=z.getComponent(at)});let $e=+et+Math.sin(Re);_e[ue*2]=(ut+V*$e)/O,_e[ue*2+1]=pe/c}}v.addVectors(m,P),ue=G+ke*$+pe,[0,1,2].forEach(ce=>{Se[ue*3+ce]=v.getComponent(ce),we[ue*3+ce]=T.getComponent(ce)}),_e[ue*2]=(I+ke*D)/O,_e[ue*2+1]=pe/c}}let Ae=X+2*d+ve,[We,Ve]=[+h,Ae-1];for(let ke=We;ke<=Ve-1;ke++){let et=h&&ke===Ve-1;for(let nt=0;nt<$-1;nt++)y=ke*$+nt,b=y+1,x=(et?nt:y)+$,S=(et?nt+1:b)+$,ke===0?Ee.push(b,S,x):ke===Ae-2?Ee.push(y,b,x):Ee.push(y,b,x,b,S,x)}this.setIndex(Ee),this.setAttribute("position",new yt(Se,3)),this.setAttribute("normal",new yt(we,3)),this.setAttribute("uv",new yt(_e,2))}getClosedTorusIndicesForBooleanOrSubdiv(){let e=this.userData.parameters,t=Math.ceil(e.tubularSegments),r=e.radialSegments+1,i=Array.from(this.getIndex().array),n,a,o,s,l=6*(t-1)*e.radialSegments,c=t,u=c===t;for(let d=0;d<e.radialSegments;d++)n=c*r+d,a=n+1,o=(u?d:n)+r,s=(u?d+1:a)+r,i[l++]=n,i[l++]=a,i[l++]=o,i[l++]=a,i[l++]=s,i[l++]=o;return i.length=l,p_.array=i,p_.count=i.length,p_}},Wze=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,detail:0,corner:0,cornerSides:4},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(e){let{width:t,height:r,depth:i,detail:n,corner:a,cornerSides:o}=e.parameters,s=n===0&&a!==0?new PW(t*.5,a,o):new M8(t*.5,n);return s.scale(1,r/t,i/t),Object.assign(s,{userData:{...e,type:"IcosahedronGeometry"}})}},PW=class extends RD{constructor(e=1,t=.2,r=4){let i=(1+Math.sqrt(5))/2,n=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],a=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],o="IcosahedronGeometry";super(n,a,o,e,t,r),this.type=o}static fromJSON(e){return new PW(e.radius,e.corner,e.cornerSides)}},Gze=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var i;(((i=e.parameters)==null?void 0:i.points)??[]).forEach(n=>{Array.isArray(n)&&(n.x=n[0],n.y=n[1])});let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,segments:64,verticalSegments:64,points:[{x:0,y:-50,id:0},{x:50,y:-50,id:1},{x:50,y:50,id:2},{x:0,y:50,id:3}]},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(e){let{points:t,segments:r,verticalSegments:i}=e.parameters,n=new Gx;n.moveTo(t[0].x,t[0].y),n.bezierCurveTo(t[1].x,t[1].y,t[2].x,t[2].y,t[3].x,t[3].y);let a=new x8(n.extractPoints(i).shape,r);return a.rotateZ(Math.PI),Object.assign(a,{userData:{...e,type:"LatheGeometry"}})}},ks=new it,m_=new Xr,Zy=new k,T1=class extends ca{constructor(){super(),this.uuid=St.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}applyMatrix4(e){let t=new cn().getNormalMatrix(e);for(let r=0,i=this.vertices.length;r<i;r++)this.vertices[r].applyMatrix4(e);for(let r=0,i=this.faces.length;r<i;r++){let n=this.faces[r];n.normal.applyMatrix3(t).normalize();for(let a=0,o=n.vertexNormals.length;a<o;a++)n.vertexNormals[a].applyMatrix3(t).normalize()}return this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this}rotateX(e){return ks.makeRotationX(e),this.applyMatrix4(ks),this}rotateY(e){return ks.makeRotationY(e),this.applyMatrix4(ks),this}rotateZ(e){return ks.makeRotationZ(e),this.applyMatrix4(ks),this}translate(e,t,r){return ks.makeTranslation(e,t,r),this.applyMatrix4(ks),this}scale(e,t,r){return ks.makeScale(e,t,r),this.applyMatrix4(ks),this}lookAt(e){return m_.lookAt(e),m_.updateMatrix(),this.applyMatrix4(m_.matrix),this}fromBufferGeometry(e){let t=this,r=e.index!==null?e.index:void 0,i=e.attributes;if(i.position===void 0)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;let n=i.position,a=i.normal,o=i.color,s=i.uv,l=i.uv2;l!==void 0&&(this.faceVertexUvs[1]=[]);for(let d=0;d<n.count;d++)t.vertices.push(new k().fromBufferAttribute(n,d)),o!==void 0&&t.colors.push(new Bt().fromBufferAttribute(o,d));function c(d,h,f,p){let v=o===void 0?[]:[t.colors[d].clone(),t.colors[h].clone(),t.colors[f].clone()],m=a===void 0?[]:[new k().fromBufferAttribute(a,d),new k().fromBufferAttribute(a,h),new k().fromBufferAttribute(a,f)],g=new TE(d,h,f,m,v,p);t.faces.push(g),s!==void 0&&t.faceVertexUvs[0].push([new ye().fromBufferAttribute(s,d),new ye().fromBufferAttribute(s,h),new ye().fromBufferAttribute(s,f)]),l!==void 0&&t.faceVertexUvs[1].push([new ye().fromBufferAttribute(l,d),new ye().fromBufferAttribute(l,h),new ye().fromBufferAttribute(l,f)])}let u=e.groups;if(u.length>0)for(let d=0;d<u.length;d++){let h=u[d],f=h.start,p=h.count;for(let v=f,m=f+p;v<m;v+=3)r!==void 0?c(r.getX(v),r.getX(v+1),r.getX(v+2),h.materialIndex):c(v,v+1,v+2,h.materialIndex)}else if(r!==void 0)for(let d=0;d<r.count;d+=3)c(r.getX(d),r.getX(d+1),r.getX(d+2));else for(let d=0;d<n.count;d+=3)c(d,d+1,d+2);return this.computeFaceNormals(),e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Zy).negate(),this.translate(Zy.x,Zy.y,Zy.z),this}normalize(){this.computeBoundingSphere();let e=this.boundingSphere.center,t=this.boundingSphere.radius,r=t===0?1:1/t,i=new it;return i.set(r,0,0,-r*e.x,0,r,0,-r*e.y,0,0,r,-r*e.z,0,0,0,1),this.applyMatrix4(i),this}computeFaceNormals(){let e=new k,t=new k;for(let r=0,i=this.faces.length;r<i;r++){let n=this.faces[r],a=this.vertices[n.a],o=this.vertices[n.b],s=this.vertices[n.c];e.subVectors(s,o),t.subVectors(a,o),e.cross(t),e.normalize(),n.normal.copy(e)}}computeVertexNormals(e=!0){let t=new Array(this.vertices.length);for(let r=0,i=this.vertices.length;r<i;r++)t[r]=new k;if(e){let r=new k,i=new k;for(let n=0,a=this.faces.length;n<a;n++){let o=this.faces[n],s=this.vertices[o.a],l=this.vertices[o.b],c=this.vertices[o.c];r.subVectors(c,l),i.subVectors(s,l),r.cross(i),t[o.a].add(r),t[o.b].add(r),t[o.c].add(r)}}else{this.computeFaceNormals();for(let r=0,i=this.faces.length;r<i;r++){let n=this.faces[r];t[n.a].add(n.normal),t[n.b].add(n.normal),t[n.c].add(n.normal)}}for(let r=0,i=this.vertices.length;r<i;r++)t[r].normalize();for(let r=0,i=this.faces.length;r<i;r++){let n=this.faces[r],a=n.vertexNormals;a.length===3?(a[0].copy(t[n.a]),a[1].copy(t[n.b]),a[2].copy(t[n.c])):(a[0]=t[n.a].clone(),a[1]=t[n.b].clone(),a[2]=t[n.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)}computeFlatVertexNormals(){this.computeFaceNormals();for(let e=0,t=this.faces.length;e<t;e++){let r=this.faces[e],i=r.vertexNormals;i.length===3?(i[0].copy(r.normal),i[1].copy(r.normal),i[2].copy(r.normal)):(i[0]=r.normal.clone(),i[1]=r.normal.clone(),i[2]=r.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)}computeMorphNormals(){for(let t=0,r=this.faces.length;t<r;t++){let i=this.faces[t];i.__originalFaceNormal?i.__originalFaceNormal.copy(i.normal):i.__originalFaceNormal=i.normal.clone(),i.__originalVertexNormals||(i.__originalVertexNormals=[]);for(let n=0,a=i.vertexNormals.length;n<a;n++)i.__originalVertexNormals[n]?i.__originalVertexNormals[n].copy(i.vertexNormals[n]):i.__originalVertexNormals[n]=i.vertexNormals[n].clone()}let e=new T1;e.faces=this.faces;for(let t=0,r=this.morphTargets.length;t<r;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[];let n=this.morphNormals[t].faceNormals,a=this.morphNormals[t].vertexNormals;for(let o=0,s=this.faces.length;o<s;o++){let l=new k,c={a:new k,b:new k,c:new k};n.push(l),a.push(c)}}let i=this.morphNormals[t];e.vertices=this.morphTargets[t].vertices,e.computeFaceNormals(),e.computeVertexNormals();for(let n=0,a=this.faces.length;n<a;n++){let o=this.faces[n],s=i.faceNormals[n],l=i.vertexNormals[n];s.copy(o.normal),l.a.copy(o.vertexNormals[0]),l.b.copy(o.vertexNormals[1]),l.c.copy(o.vertexNormals[2])}}for(let t=0,r=this.faces.length;t<r;t++){let i=this.faces[t];i.normal=i.__originalFaceNormal,i.vertexNormals=i.__originalVertexNormals}}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Ji),this.boundingBox.setFromPoints(this.vertices)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new ao),this.boundingSphere.setFromPoints(this.vertices)}merge(e,t,r=0){if(!(e&&e.isGeometry)){console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e);return}let i,n=this.vertices.length,a=this.vertices,o=e.vertices,s=this.faces,l=e.faces,c=this.colors,u=e.colors;t!==void 0&&(i=new cn().getNormalMatrix(t));for(let d=0,h=o.length;d<h;d++){let f=o[d].clone();t!==void 0&&f.applyMatrix4(t),a.push(f)}for(let d=0,h=u.length;d<h;d++)c.push(u[d].clone());for(let d=0,h=l.length;d<h;d++){let f=l[d],p,v,m=f.vertexNormals,g=f.vertexColors,y=new TE(f.a+n,f.b+n,f.c+n);y.normal.copy(f.normal),i!==void 0&&y.normal.applyMatrix3(i).normalize();for(let b=0,x=m.length;b<x;b++)p=m[b].clone(),i!==void 0&&p.applyMatrix3(i).normalize(),y.vertexNormals.push(p);y.color.copy(f.color);for(let b=0,x=g.length;b<x;b++)v=g[b],y.vertexColors.push(v.clone());y.materialIndex=f.materialIndex+r,s.push(y)}for(let d=0,h=e.faceVertexUvs.length;d<h;d++){let f=e.faceVertexUvs[d];this.faceVertexUvs[d]===void 0&&(this.faceVertexUvs[d]=[]);for(let p=0,v=f.length;p<v;p++){let m=f[p],g=[];for(let y=0,b=m.length;y<b;y++)g.push(m[y].clone());this.faceVertexUvs[d].push(g)}}}mergeMesh(e){if(!(e&&e.isMesh)){console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e);return}e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)}mergeVertices(e=4){let t={},r=[],i=[],n=Math.pow(10,e);for(let s=0,l=this.vertices.length;s<l;s++){let c=this.vertices[s],u=Math.round(c.x*n)+"_"+Math.round(c.y*n)+"_"+Math.round(c.z*n);t[u]===void 0?(t[u]=s,r.push(this.vertices[s]),i[s]=r.length-1):i[s]=i[t[u]]}let a=[];for(let s=0,l=this.faces.length;s<l;s++){let c=this.faces[s];c.a=i[c.a],c.b=i[c.b],c.c=i[c.c];let u=[c.a,c.b,c.c];for(let d=0;d<3;d++)if(u[d]===u[(d+1)%3]){a.push(s);break}}for(let s=a.length-1;s>=0;s--){let l=a[s];this.faces.splice(l,1);for(let c=0,u=this.faceVertexUvs.length;c<u;c++)this.faceVertexUvs[c].splice(l,1)}let o=this.vertices.length-r.length;return this.vertices=r,o}setFromPoints(e){this.vertices=[];for(let t=0,r=e.length;t<r;t++){let i=e[t];this.vertices.push(new k(i.x,i.y,i.z||0))}return this}sortFacesByMaterialIndex(){let e=this.faces,t=e.length;for(let s=0;s<t;s++)e[s]._id=s;function r(s,l){return s.materialIndex-l.materialIndex}e.sort(r);let i=this.faceVertexUvs[0],n=this.faceVertexUvs[1],a,o;i&&i.length===t&&(a=[]),n&&n.length===t&&(o=[]);for(let s=0;s<t;s++){let l=e[s]._id;a&&a.push(i[l]),o&&o.push(n[l])}a&&(this.faceVertexUvs[0]=a),o&&(this.faceVertexUvs[1]=o)}toJSON(){let e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),this.parameters!==void 0){let f=this.parameters;for(let p in f)f[p]!==void 0&&(e[p]=f[p]);return e}let t=[];for(let f=0;f<this.vertices.length;f++){let p=this.vertices[f];t.push(p.x,p.y,p.z)}let r=[],i=[],n={},a=[],o={},s=[],l={};for(let f=0;f<this.faces.length;f++){let p=this.faces[f],v=!0,m=!1,g=this.faceVertexUvs[0][f]!==void 0,y=p.normal.length()>0,b=p.vertexNormals.length>0,x=p.color.r!==1||p.color.g!==1||p.color.b!==1,S=p.vertexColors.length>0,w=0;if(w=c(w,0,0),w=c(w,1,v),w=c(w,2,m),w=c(w,3,g),w=c(w,4,y),w=c(w,5,b),w=c(w,6,x),w=c(w,7,S),r.push(w),r.push(p.a,p.b,p.c),r.push(p.materialIndex),g){let _=this.faceVertexUvs[0][f];r.push(h(_[0]),h(_[1]),h(_[2]))}if(y&&r.push(u(p.normal)),b){let _=p.vertexNormals;r.push(u(_[0]),u(_[1]),u(_[2]))}if(x&&r.push(d(p.color)),S){let _=p.vertexColors;r.push(d(_[0]),d(_[1]),d(_[2]))}}function c(f,p,v){return v?f|1<<p:f&~(1<<p)}function u(f){let p=f.x.toString()+f.y.toString()+f.z.toString();return n[p]!==void 0||(n[p]=i.length/3,i.push(f.x,f.y,f.z)),n[p]}function d(f){let p=f.r.toString()+f.g.toString()+f.b.toString();return o[p]!==void 0||(o[p]=a.length,a.push(f.getHex())),o[p]}function h(f){let p=f.x.toString()+f.y.toString();return l[p]!==void 0||(l[p]=s.length/2,s.push(f.x,f.y)),l[p]}return e.data={},e.data.vertices=t,e.data.normals=i,a.length>0&&(e.data.colors=a),s.length>0&&(e.data.uvs=[s]),e.data.faces=r,e}clone(){return new T1().copy(this)}copy(e){this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;let t=e.vertices;for(let d=0,h=t.length;d<h;d++)this.vertices.push(t[d].clone());let r=e.colors;for(let d=0,h=r.length;d<h;d++)this.colors.push(r[d].clone());let i=e.faces;for(let d=0,h=i.length;d<h;d++)this.faces.push(i[d].clone());for(let d=0,h=e.faceVertexUvs.length;d<h;d++){let f=e.faceVertexUvs[d];this.faceVertexUvs[d]===void 0&&(this.faceVertexUvs[d]=[]);for(let p=0,v=f.length;p<v;p++){let m=f[p],g=[];for(let y=0,b=m.length;y<b;y++){let x=m[y];g.push(x.clone())}this.faceVertexUvs[d].push(g)}}let n=e.morphTargets;for(let d=0,h=n.length;d<h;d++){let f={};if(f.name=n[d].name,n[d].vertices!==void 0){f.vertices=[];for(let p=0,v=n[d].vertices.length;p<v;p++)f.vertices.push(n[d].vertices[p].clone())}if(n[d].normals!==void 0){f.normals=[];for(let p=0,v=n[d].normals.length;p<v;p++)f.normals.push(n[d].normals[p].clone())}this.morphTargets.push(f)}let a=e.morphNormals;for(let d=0,h=a.length;d<h;d++){let f={};if(a[d].vertexNormals!==void 0){f.vertexNormals=[];for(let p=0,v=a[d].vertexNormals.length;p<v;p++){let m=a[d].vertexNormals[p],g={};g.a=m.a.clone(),g.b=m.b.clone(),g.c=m.c.clone(),f.vertexNormals.push(g)}}if(a[d].faceNormals!==void 0){f.faceNormals=[];for(let p=0,v=a[d].faceNormals.length;p<v;p++)f.faceNormals.push(a[d].faceNormals[p].clone())}this.morphNormals.push(f)}let o=e.skinWeights;for(let d=0,h=o.length;d<h;d++)this.skinWeights.push(o[d].clone());let s=e.skinIndices;for(let d=0,h=s.length;d<h;d++)this.skinIndices.push(s[d].clone());let l=e.lineDistances;for(let d=0,h=l.length;d<h;d++)this.lineDistances.push(l[d]);let c=e.boundingBox;c!==null&&(this.boundingBox=c.clone());let u=e.boundingSphere;return u!==null&&(this.boundingSphere=u.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this}toBufferGeometry(){let e=new $ze().fromGeometry(this),t=new Ot,r=new Float32Array(e.vertices.length*3);if(t.setAttribute("position",Jy.call(new qt(r,3),e.vertices)),e.normals.length>0){let i=new Float32Array(e.normals.length*3);t.setAttribute("normal",Jy.call(new qt(i,3),e.normals))}if(e.colors.length>0){let i=new Float32Array(e.colors.length*3);t.setAttribute("color",jB.call(new qt(i,3),e.colors))}if(e.uvs.length>0){let i=new Float32Array(e.uvs.length*2);t.setAttribute("uv",VB.call(new qt(i,2),e.uvs))}if(e.uvs2.length>0){let i=new Float32Array(e.uvs2.length*2);t.setAttribute("uv2",VB.call(new qt(i,2),e.uvs2))}t.groups=e.groups;for(let i in e.morphTargets){let n=[],a=e.morphTargets[i];for(let o=0,s=a.length;o<s;o++){let l=a[o],c=new yt(l.data.length*3,3);c.name=l.name,n.push(Jy.call(c,l.data))}t.morphAttributes[i]=n}if(e.skinIndices.length>0){let i=new yt(e.skinIndices.length*4,4);t.setAttribute("skinIndex",HB.call(i,e.skinIndices))}if(e.skinWeights.length>0){let i=new yt(e.skinWeights.length*4,4);t.setAttribute("skinWeight",HB.call(i,e.skinWeights))}return e.boundingSphere!==null&&(t.boundingSphere=e.boundingSphere.clone()),e.boundingBox!==null&&(t.boundingBox=e.boundingBox.clone()),t}computeTangents(){console.error("THREE.Geometry: .computeTangents() has been removed.")}computeLineDistances(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")}applyMatrix(e){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}dispose(){this.dispatchEvent({type:"dispose"})}static createBufferGeometryFromObject(e){let t=new Ot,r=e.geometry;if(e.isPoints||e.isLine){let i=new yt(r.vertices.length*3,3),n=new yt(r.colors.length*3,3);if(t.setAttribute("position",Jy.call(i,r.vertices)),t.setAttribute("color",jB.call(n,r.colors)),r.lineDistances&&r.lineDistances.length===r.vertices.length){let a=new yt(r.lineDistances.length,1);t.setAttribute("lineDistance",qze.call(a,r.lineDistances))}r.boundingSphere!==null&&(t.boundingSphere=r.boundingSphere.clone()),r.boundingBox!==null&&(t.boundingBox=r.boundingBox.clone())}else e.isMesh&&(t=r.toBufferGeometry());return t}};T1.prototype.isGeometry=!0;var $ze=class{constructor(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}computeGroups(e){let t=[],r,i,n,a=e.faces;for(i=0;i<a.length;i++){let o=a[i];o.materialIndex!==n&&(n=o.materialIndex,r!==void 0&&(r.count=i*3-r.start,t.push(r)),r={start:i*3,materialIndex:n})}r!==void 0&&(r.count=i*3-r.start,t.push(r)),this.groups=t}fromGeometry(e){let t=e.faces,r=e.vertices,i=e.faceVertexUvs,n=i[0]&&i[0].length>0,a=i[1]&&i[1].length>0,o=e.morphTargets,s=o.length,l;if(s>0){l=[];for(let m=0;m<s;m++)l[m]={name:o[m].name,data:[]};this.morphTargets.position=l}let c=e.morphNormals,u=c.length,d;if(u>0){d=[];for(let m=0;m<u;m++)d[m]={name:c[m].name,data:[]};this.morphTargets.normal=d}let h=e.skinIndices,f=e.skinWeights,p=h.length===r.length,v=f.length===r.length;r.length>0&&t.length===0&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(let m=0;m<t.length;m++){let g=t[m];this.vertices.push(r[g.a],r[g.b],r[g.c]);let y=g.vertexNormals;if(y.length===3)this.normals.push(y[0],y[1],y[2]);else{let x=g.normal;this.normals.push(x,x,x)}let b=g.vertexColors;if(b.length===3)this.colors.push(b[0],b[1],b[2]);else{let x=g.color;this.colors.push(x,x,x)}if(n===!0){let x=i[0][m];x!==void 0?this.uvs.push(x[0],x[1],x[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",m),this.uvs.push(new ye,new ye,new ye))}if(a===!0){let x=i[1][m];x!==void 0?this.uvs2.push(x[0],x[1],x[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",m),this.uvs2.push(new ye,new ye,new ye))}for(let x=0;x<s;x++){let S=o[x].vertices;l[x].data.push(S[g.a],S[g.b],S[g.c])}for(let x=0;x<u;x++){let S=c[x].vertexNormals[m];d[x].data.push(S.a,S.b,S.c)}p&&this.skinIndices.push(h[g.a],h[g.b],h[g.c]),v&&this.skinWeights.push(f[g.a],f[g.b],f[g.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),this}},TE=class{constructor(e,t,r,i,n,a=0){this.a=e,this.b=t,this.c=r,this.normal=i&&i.isVector3?i:new k,this.vertexNormals=Array.isArray(i)?i:[],this.color=n&&n.isColor?n:new Bt,this.vertexColors=Array.isArray(n)?n:[],this.materialIndex=a}clone(){return new this.constructor().copy(this)}copy(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(let t=0,r=e.vertexNormals.length;t<r;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(let t=0,r=e.vertexColors.length;t<r;t++)this.vertexColors[t]=e.vertexColors[t].clone();return this}};function qze(e){return this.array.set(e),this}function jB(e){let t=this.array,r=0;for(let i=0,n=e.length;i<n;i++){let a=e[i];a===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",i),a=new Bt),t[r++]=a.r,t[r++]=a.g,t[r++]=a.b}return this}function VB(e){let t=this.array,r=0;for(let i=0,n=e.length;i<n;i++){let a=e[i];a===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",i),a=new ye),t[r++]=a.x,t[r++]=a.y}return this}function Jy(e){let t=this.array,r=0;for(let i=0,n=e.length;i<n;i++){let a=e[i];a===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",i),a=new k),t[r++]=a.x,t[r++]=a.y,t[r++]=a.z}return this}function HB(e){let t=this.array,r=0;for(let i=0,n=e.length;i<n;i++){let a=e[i];a===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",i),a=new Qt),t[r++]=a.x,t[r++]=a.y,t[r++]=a.z,t[r++]=a.w}return this}var Yze=["a","b","c"];function Xze(e,t){switch(t){case"c":return e.c;case"b":return e.b;case"a":default:return e.a}}function v_(e,t,r){let i=Math.min(e,t),n=Math.max(e,t),a=i+"_"+n;return r.get(a)}function g_(e,t,r,i,n,a){let o=Math.min(e,t),s=Math.max(e,t),l=o+"_"+s,c;if(i.has(l))c=i.get(l);else{let u=r[o],d=r[s];c={a:u,b:d,newEdge:null,faces:[]},i.set(l,c)}c.faces.push(n),a[e].edges.push(c),a[t].edges.push(c)}function Kze(e,t,r,i){let n,a,o;for(n=0,a=e.length;n<a;n++)r[n]={edges:[]};for(n=0,a=t.length;n<a;n++)o=t[n],g_(o.a,o.b,e,i,o,r),g_(o.b,o.c,e,i,o,r),g_(o.c,o.a,e,i,o,r)}function eb(e,t,r,i,n){e.push(new TE(t,r,i,void 0,void 0,n))}function yf(e,t){return Math.abs(t-e)/2+Math.min(e,t)}function tb(e,t,r,i){e.push([t.clone(),r.clone(),i.clone()])}var Qze=class{constructor(e=1){this.subdivisions=e}modify(e){e instanceof Ot?e=new T1().fromBufferGeometry(e):e=e.clone(),e.mergeVertices();let t=this.subdivisions;for(;t-- >0;)this._smooth(e);return e.computeFaceNormals(),e.computeVertexNormals(),e}_smooth(e){let t=new k,r,i,n,a,o,s=e.vertices,l=e.faces,c=e.faceVertexUvs[0],u=c!==void 0&&c.length>0,d=[],h=new Map;Kze(s,l,d,h);let f=[],p,v,m,g,y,b,x;for(let Q of Array.from(h.keys())){for(v=h.get(Q),m=new k,y=3/8,b=1/8,x=v.faces.length,x!=2&&(y=.5,b=0,x!=1),m.addVectors(v.a,v.b).multiplyScalar(y),t.set(0,0,0),a=0;a<x;a++){for(g=v.faces[a],o=0;o<3&&(p=s[Xze(g,Yze[o])],!(p!==v.a&&p!==v.b));o++);p&&t.add(p)}t.multiplyScalar(b),m.add(t),v.newEdge=f.length,f.push(m)}let S,w,_,C,A,M,P,T=[];for(i=0,n=s.length;i<n;i++){for(M=s[i],A=d[i].edges,r=A.length,r==3?S=3/16:r>3&&(S=3/(8*r)),w=1-r*Number(S),_=S,r<=2&&(r==2?(w=3/4,_=1/8):r==1||r==0),P=M.clone().multiplyScalar(w),t.set(0,0,0),a=0;a<r;a++)C=A[a],p=C.a!==M?C.a:C.b,t.add(p);t.multiplyScalar(Number(_)),P.add(t),T.push(P)}let R=T.concat(f),z=T.length,F,H,N,U=[],ie=[],te,X,W,q,$=new ye,le=new ye,ee=new ye;for(i=0,n=l.length;i<n;i++)g=l[i],F=Number(v_(g.a,g.b,h).newEdge)+z,H=Number(v_(g.b,g.c,h).newEdge)+z,N=Number(v_(g.c,g.a,h).newEdge)+z,eb(U,F,H,N,g.materialIndex),eb(U,g.a,F,N,g.materialIndex),eb(U,g.b,H,F,g.materialIndex),eb(U,g.c,N,H,g.materialIndex),u&&(te=c[i],X=te[0],W=te[1],q=te[2],$.set(yf(X.x,W.x),yf(X.y,W.y)),le.set(yf(W.x,q.x),yf(W.y,q.y)),ee.set(yf(X.x,q.x),yf(X.y,q.y)),tb(ie,$,le,ee),tb(ie,X,$,ee),tb(ie,W,le,$),tb(ie,q,ee,le));e.vertices=R,e.faces=U,u&&(e.faceVertexUvs[0]=ie)}},pn=new k,Zze=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=e.geometry??(t==null?void 0:t.geometry)??new Ot().copy(new ws(100,100,100)),i;t===void 0?(r.computeBoundingBox(),r.boundingBox.getSize(pn),i={width:pn.x,height:pn.y,depth:pn.z,subdivisions:0}):i=t.parameters;let n={...i,...e.parameters};return{parameters:{width:Math.abs(n.width),height:Math.abs(n.height),depth:Math.abs(n.depth),subdivisions:Math.abs(n.subdivisions)},geometry:r}}static build(e){let{width:t,height:r,depth:i,subdivisions:n}=e.parameters,a=e.geometry??new Ot().copy(new ws(100,100,100)),o=a.userData.parameters;o===void 0?(a.computeBoundingBox(),a.boundingBox.getSize(pn)):pn.set(o.width,o.height,o.depth),(t!==pn.x||r!==pn.y||i!==pn.z)&&a.scale(pn.x===0?1:t/pn.x,pn.y===0?1:r/pn.y,pn.z===0?1:i/pn.z);let s=a.originalGeometry;try{n>0?(s===void 0||(o==null?void 0:o.subdivisions)!==n)&&(s===void 0&&(s=a),a=new Qze(n).modify(s).toBufferGeometry()):(s!==void 0&&(a=s),s=void 0,a.getAttribute("normal")===void 0&&a.computeVertexNormals())}catch{s!==void 0&&(a=s),s=void 0,a.getAttribute("normal")===void 0&&a.computeVertexNormals()}return s!==void 0&&Object.assign(a,{originalGeometry:s}),delete e.geometry,Object.assign(a,{userData:{...e,type:"NonParametricGeometry"}})}static loadFromUrl(e,t,r){new k8(r).load(e,i=>{let n=this.normalizeInputs({geometry:i});i.boundingBox.getSize(pn);let a=100/pn.x;Object.assign(n.parameters,{width:100,height:pn.y*a,depth:pn.z*a}),t(this.build(n))})}},DW=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0,spikes:5,cornerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:3},e.parameters);return{shape:e.shape&&e.shape instanceof Fi?e.shape:new Fi,parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??0)})}}static build(e){let{width:t,height:r,spikes:i,cornerRadius:n,depth:a,extrudeBevelSize:o,extrudeBevelSegments:s}=e.parameters,l=e.shape,c=t*.5,u=r*.5,d=0,h=0,f=2*Math.PI/i;for(let v=0;v<i;v++){let m=f*v,g=d+Math.sin(m)*c,y=h+Math.cos(m)*u;l.addPoint(l.createPoint(g,y))}l.isClosed=!0;for(let v=0,m=l.points.length;v<m;v++)l.points[v].roundness=n;l.roundness=n,l.update();let p=Lh.create({shape:l,parameters:{roundness:n,depth:a,extrudeBevelSize:o,extrudeBevelSegments:s}});return Object.assign(p,{userData:{...e,type:"PolygonGeometry"}})}},Jze=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,radialSegments:4,heightSegments:1,cornerRadius:0,cornerSegments:8,openEnded:!1},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(e){let{width:t,height:r,depth:i,radialSegments:n,heightSegments:a,openEnded:o,cornerRadius:s,cornerSegments:l}=e.parameters,c=new tke(t*.5,r,n,a,o,s,l);return c.scale(1,1,i/t),Object.assign(c,{userData:{...e,type:"PyramidGeometry"}})}};function tv(e,t,r){r.x=e.x*t.x,r.y=e.y,r.z=e.x*t.y}function y_(e,t,r,i,n,a){let o=t.clone().sub(e),s=r.clone().sub(e),l=o.angleTo(s);if(o.normalize(),s.normalize(),i===n){let c=o.add(s).normalize();a.copy(e).addScaledVector(c,i/Math.sin(l/2))}else{let c=o.angleTo(s);a.copy(e),a.addScaledVector(o,n/Math.sin(c)),a.addScaledVector(s,i/Math.sin(c))}}function eke(e,t,r){let i=e.clone().sub(t),n=r.clone().sub(t);return i.projectOnVector(n),i.add(t)}var tke=class extends Ot{constructor(e=.5,t=1,r=4,i=1,n=!1,a=0,o=4){super(),r=Math.floor(Math.max(3,r)),i=Math.floor(i),o=Math.floor(o);let s=[],l=[],c=[],u=[],d=0,h=t/2,f=Math.PI/r,p=e*Math.cos(Math.PI/r),v=2*Math.PI/r,m=(r-2)*Math.PI/r,g=Math.PI-m,y=new k(0,-h,0),b=new k(0,h,0),x=new ye(e,-h),S=new ye(p,-h),w=new ye(0,b.y).sub(S),_=new ye(0,b.y).sub(x),C=new ye(w.y,-w.x).normalize(),A=new ye(_.y,-_.x).normalize(),M=e*Math.cos(Math.PI/r)*Math.tan((Math.PI-w.angle())/2)-1e-8;a=Math.min(a,M);let P;{let N=new k(C.x,C.y,0),U=new k(Math.cos(v)*N.x,N.y,Math.sin(v)*N.x);P=N.angleTo(U)}let T=a/Math.tan((Math.PI-w.angle())/2),R=a/Math.tan((Math.PI-P)/2),z=new k;if(!n){l.push(y.x,y.y,y.z),c.push(0,-1,0),u.push(0,0);let N=d++,U=[],ie=x.clone(),te=T/Math.cos(Math.PI/r);ie.x-=te;for(let X=0;X<r;X++){let W=X/r*Math.PI*2+f,q=new ye(Math.sin(W),Math.cos(W));tv(ie,q,z),l.push(z.x,z.y,z.z),c.push(0,-1,0),u.push(0,0),U.push(d++)}for(let X=0;X<U.length;X++)s.push(U[X],N,U[(X+1)%U.length])}{let N=new k,U=new k,ie=new k,te=new k,X=new k,W=new k;for(let q=0;q<r;q++){let $=q/r*Math.PI*2+f,le=(q+.5)/r*Math.PI*2+f,ee=(q+1)/r*Math.PI*2+f,Q=new ye(Math.sin($),Math.cos($)),ne=new ye(Math.sin(le),Math.cos(le)),V=new ye(Math.sin(ee),Math.cos(ee));tv(x,Q,U),tv(x,V,ie),tv(C,ne,N),y_(b,U,ie,R,R,te),l.push(te.x,te.y,te.z),y_(U,b,ie,R,T,X),l.push(X.x,X.y,X.z),y_(ie,U,b,T,R,W),l.push(W.x,W.y,W.z),c.push(N.x,N.y,N.z),c.push(N.x,N.y,N.z),c.push(N.x,N.y,N.z),u.push(0,0),u.push(0,0),u.push(0,0);let ue=d++,ve=d++,Ce=d++;if(s.push(ue,ve,Ce),a>0){{let de=U.clone().add(ie).multiplyScalar(.5),Se=b.clone().sub(de).normalize(),we=y.clone().sub(de).normalize().add(Se).normalize().multiplyScalar(-1),_e=W.clone().sub(X);F(de,_e,we,w.angle())}let G,Z;{let de=new k;tv(A,V,de);let Se=W.clone().add(te).multiplyScalar(.5);Se=eke(Se,ie,b);let we=W.clone().sub(te);[G,Z]=F(Se,we,de,P,te.y)}{let de=G,Se=de.clone().setY(0).normalize(),we=new k(0,-1,0),_e=Se.clone().cross(we);H(de,Se,we,_e)}{let de=w.angle(),Se=Math.PI-de,we=b.clone();we.y-=a/Math.sin(de-Math.PI/2);let _e=new k,Ee=[];for(let B=0;B<o;B++){let D=[],I=Math.PI/2-Se*B/o,O=Math.cos(I),j=Math.sin(I),L=le;for(let Ae=0;Ae<=B;Ae++){let We=Math.cos(L),Ve=Math.sin(L);N.x=O*Ve,N.y=j,N.z=O*We,_e.copy(we).addScaledVector(N,a),l.push(_e.x,_e.y,_e.z),c.push(N.x,N.y,N.z),u.push(0,0),D.push(d++),L+=Math.PI*2/B/r}Ee.push(D)}Z.reverse(),Ee.push(Z);let fe=Ee.length-1;for(let B=0;B<fe;B++){let D=Ee[B],I=Ee[B+1],O=D.length-1;s.push(I[1],D[0],I[0]);for(let j=1;j<=O;j++)s.push(D[j],D[j-1],I[j]),s.push(I[j+1],D[j],I[j])}}}}}this.setIndex(s),this.setAttribute("position",new yt(l,3)),this.setAttribute("normal",new yt(c,3)),this.setAttribute("uv",new yt(u,2));function F(N,U,ie,te,X){let W=-te/2,q=(Math.PI-te)/2,$=U.clone().normalize().cross(ie);N.addScaledVector(ie,-a/Math.sin(q));let le=new k,ee=new k,Q=1,ne=d,V=[];for(let ue=0;ue<=o;ue++){let ve=W+ue/o*te;ee.set(0,0,0),ee.addScaledVector($,Math.sin(ve)),ee.addScaledVector(ie,Math.cos(ve));for(let Ce=0;Ce<=Q;Ce++){let G=Ce/Q-.5;if(le.copy(N),le.addScaledVector(U,G),le.addScaledVector(ee,a),X!=null){let Z=Math.max(0,le.y-X);le.addScaledVector(U,-Z/U.y)}l.push(le.x,le.y,le.z),c.push(ee.x,ee.y,ee.z),u.push(0,0),Ce===0&&V.push(d),d++}}for(let ue=0;ue<o;ue++)for(let ve=0;ve<Q;ve++){let Ce=ne+ve+(Q+1)*ue,G=Ce+(Q+1),Z=G+1,de=Ce+1;s.push(Ce,G,de),s.push(G,Z,de)}return[N.clone().addScaledVector(U,.5),V]}function H(N,U,ie,te){let X=Math.PI/2,W=_.angle()-X,q=[],$=new k,le=new k;for(let Q=0;Q<=o;Q++){let ne=[],V=Q/o;for(let ue=0;ue<=Q;ue++){let ve=((Q?ue/Q:0)-.5)*g,Ce=Math.cos(ve),G=Math.sin(ve),Z=Math.atan(Math.tan(W)*Ce),de=(X+Z)*V,Se=Math.cos(de),we=Math.sin(de);$.set(0,0,0),$.addScaledVector(U,we*Ce),$.addScaledVector(ie,Se),$.addScaledVector(te,we*G),le.copy(N).addScaledVector($,a),l.push(le.x,le.y,le.z),c.push($.x,$.y,$.z),u.push(0,0),ne.push(d++)}q.push(ne)}let ee=q.length-1;for(let Q=0;Q<ee;Q++){let ne=q[Q],V=q[Q+1],ue=ne.length-1;s.push(ne[0],V[1],V[0]);for(let ve=1;ve<=ue;ve++)s.push(ne[ve-1],ne[ve],V[ve]),s.push(ne[ve],V[ve+1],V[ve])}}}},FD=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0,cornerRadius:[0,0,0,0],cornerType:1,extrudeBevelSize:0,extrudeBevelSegments:1},e.parameters),i=Object.assign((t==null?void 0:t.ui)??{enabledIndieCorners:!1},e.ui);return{shape:e.shape&&e.shape instanceof Fi?e.shape:new Fi,parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??0)}),ui:i}}static build(e){let t=e.shape,{width:r,height:i,cornerRadius:n,cornerType:a,depth:o,extrudeBevelSize:s,extrudeBevelSegments:l}=e.parameters,c={x:r*.5,y:i*.5},u={x:-c.x,y:-c.y},d={x:c.x,y:c.y};function h(x,S,w){return S>r&&w>i?Math.min(x*r/S,x*i/w):S>r?x*r/S:w>i?x*i/w:x}let f=[];f[0]=n[0]===0?0:h(n[0],n[0]+n[3],n[0]+n[1]),f[1]=n[1]===0?0:h(n[1],n[1]+n[2],n[1]+n[0]),f[2]=n[2]===0?0:h(n[2],n[2]+n[1],n[2]+n[3]),f[3]=n[3]===0?0:h(n[3],n[3]+n[0],n[3]+n[2]);let p=u.x,v=d.x,m=d.y,g=u.y;t.addPoint(t.createPoint(p,m)),t.addPoint(t.createPoint(v,m)),t.addPoint(t.createPoint(v,g)),t.addPoint(t.createPoint(p,g)),t.isClosed=!0;let y=!0;for(let x=0,S=t.points.length;x<S;x++)t.points[x].roundness=f[x],x>0&&f[x]!==f[x-1]&&(y=!1);y&&(t.roundness=f[0]),t.useCubicForRoundedCorners=a!==1,t.update();let b=Lh.create({shape:t,parameters:{depth:o,extrudeBevelSize:s,extrudeBevelSegments:l}});return Object.assign(b,{userData:{...e,type:"RectangleGeometry"}})}},rke=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,widthSegments:64,heightSegments:64,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:180},e.parameters);return r.thetaLength=St.clamp(r.thetaLength,0,180),{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(e){let{width:t=100,height:r=t,depth:i=t,widthSegments:n=64,heightSegments:a=64,phiStart:o,phiLength:s,thetaStart:l,thetaLength:c}=e.parameters,u;return c===0?(u=new Ot,u.setAttribute("position",new yt([],3))):u=new op(.5*t,n,a,o,s,l,c*St.DEG2RAD),u.scale(1,r/t,i/t),Object.assign(u,{userData:{...e,type:"SphereGeometry"}})}},ike=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0,widthSegments:8,heightSegments:8},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:0})}}static build(e){let{width:t=100,height:r=t,widthSegments:i=8,heightSegments:n=8}=e.parameters,a=new fc(t,r,i,n);return a.scale(1,1,1),Object.assign(a,{userData:{...e,type:"PlaneGeometry"}})}},nke=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,angle:90,cornerRadius:24,cornerSegments:8},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(e){let{width:t,height:r,depth:i,angle:n,cornerRadius:a,cornerSegments:o}=e.parameters,s=new ake(t,r,i,n,a,o);return Object.assign(s,{userData:{...e,type:"BackdropGeometry"}})}},ake=class extends Ot{constructor(e=1,t=1,r=1,i=90,n=10,a=24){super(),this.type="BackdropGeometry";let o=[],s=[],l=[],c=.001;n==0&&(a=1),a=Math.max(1,Math.floor(a)),n=Math.min(n,100),i=Math.min(180-c,i),i*=Math.PI/180;let u=[],d=Math.PI/2,h=(Q=0,ne=0,V=0)=>new k(Q,ne,V),f=h(),p=h(),[v,m,g]=[t/2,e/2,r/2],y=-m,b=+m,[x,S,w]=[h(y,-v,+g),h(y,-v,-g),h(y,+v,-g)],_=(Q,ne=!1)=>Math.sin(Q-Math.PI/(1+ +ne)),C=(Q,ne=!1)=>Math.cos(Q-Math.PI/(1+ +ne));w.y=Math.sin(i)*t-v;let A=Math.cos(i)*t-g,M=x.z-c;i<=d?(w.z=Math.min(A,M),w.z==M&&(w.y-=(A-M)/Math.tan(d-i))):S.z=Math.min(S.z-A-g,x.z-c),f.subVectors(x,S),p.subVectors(w,S);let P=Math.min(f.length(),p.length())*n/100,T=P*Math.tan(i/2),R=P/Math.cos(i/2),z=f.clone().normalize().add(p.normalize()).setLength(R).add(S);f.set(0,_(i,!0),C(i,!0)),u.push([w,f.clone()]);let F=(Math.PI-i)/a;for(let Q=0;Q<=a;Q++){let ne=d+i+Q*F;f.set(0,Math.sin(ne)*T,Math.cos(ne)*T),f.add(z),p.set(0,_(ne),C(ne)),u.push([f.clone(),p.clone()])}u.push([x,h(0,1,0)]);let H=Math.sin(F/2)*T*2,N=u.length-1,U=u[0][0].distanceTo(u[1][0]),ie=u[N-1][0].distanceTo(u[N][0]),te=U+H*a+ie;u[0].push(1);for(let Q=0;Q<=a;Q++)u[Q+1].push(1-(U+Q*H)/te);u[N].push(0);let[X,W,q]=u[0],$,le,ee;for(let Q=1;Q<u.length;Q++)[$,le,ee]=u[Q],o.push(y,X.y,X.z,y,$.y,$.z,b,X.y,X.z,b,X.y,X.z,y,$.y,$.z,b,$.y,$.z),s.push(0,W.y,W.z,0,le.y,le.z,0,W.y,W.z,0,W.y,W.z,0,le.y,le.z,0,le.y,le.z),l.push(0,q,0,ee,1,q,1,q,0,ee,1,ee),[X,W,q]=[$,le,ee];this.setAttribute("position",new yt(o,3)),this.setAttribute("normal",new yt(s,3)),this.setAttribute("uv",new yt(l,2))}},OW=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0,innerRadiusPercent:38.19,spikes:5,cornerRadius:0,angle:360,extrudeBevelSize:0,extrudeBevelSegments:1},e.parameters);return{shape:e.shape&&e.shape instanceof Fi?e.shape:new Fi,parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??0)})}}static build(e){let{width:t,height:r,innerRadiusPercent:i,spikes:n,cornerRadius:a,angle:o,depth:s,extrudeBevelSize:l,extrudeBevelSegments:c}=e.parameters,u=e.shape,d=t*.5,h=r*.5,f=0,p=0,v=o*Math.PI/360/n,m=Math.PI/2*3*-1,g=d*i/100,y=h*i/100;if(n===3&&i===50){v=2*Math.PI/n;for(let x=0;x<n;x++){let S=v*x,w=f+Math.sin(S)*d,_=p+Math.cos(S)*h;u.addPoint(u.createPoint(w,_))}}else for(let x=0;x<n;x++){let S=f+Math.cos(m)*d,w=p+Math.sin(m)*h;u.addPoint(u.createPoint(S,w)),m+=v,S=f+Math.cos(m)*g,w=p+Math.sin(m)*y,u.addPoint(u.createPoint(S,w)),m+=v}u.isClosed=!0;for(let x=0,S=u.points.length;x<S;x++)u.points[x].roundness=a;u.roundness=a,u.update();let b=Lh.create({shape:u,parameters:{roundness:a,depth:s,extrudeBevelSize:l,extrudeBevelSegments:c}});return Object.assign(b,{userData:{...e,type:"StarGeometry"}})}},oke=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??0)})}}static build(e){let{width:t,height:r}=e.parameters,i=new fc(t,r);return Object.assign(i,{userData:{...e,type:"TextFrameGeometry"}})}},ske=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,radialSegments:32,tubularSegments:64,arc:360,cornerRadius:30,cornerSegments:8},e.parameters),i=Math.abs(r.width),n=Math.abs(r.height??r.width),a=Math.round(Math.abs(r.depth??r.width*.25));return{parameters:Object.assign(r,{width:i,height:n,depth:a})}}static build(e){let{width:t,height:r,depth:i,radialSegments:n,tubularSegments:a,arc:o,cornerRadius:s,cornerSegments:l}=e.parameters,c=lke(t,r,i,t*.5,o,a,0,0,n,s,l);return c.scale(1,r/t,1),Object.assign(c,{userData:{...e,type:"TorusGeometry"}})}};function lke(e,t,r,i,n,a,o,s,l,c,u){[t,r]=[r,t],o=t/2;let d=St.clamp(n/360,0,1);if(d===0){let h=new Ot;return h.setAttribute("position",new yt([],3)),h}return d===1&&(c=0),new TW(!0,e,t,r,i,d,a,o,s,l,c,u)}var cke=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,tubularSegments:64,radialSegments:32,p:2,q:3},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width),tube:r.tube??r.width*.125})}}static build(e){let{width:t,tube:r,tubularSegments:i,radialSegments:n,p:a,q:o}=e.parameters,s=t*.5;s!==r&&(s-=r);let l=new T8(s,r,i,n,a,o);return Object.assign(l,{userData:{...e,type:"TorusKnotGeometry"}})}},uke=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0,spikes:5,cornerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:1,isRect:!1},e.parameters);return{shape:e.shape&&e.shape instanceof Fi?e.shape:new Fi,parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width*(r.isRect?1:Math.sqrt(3)/2)),depth:Math.abs(r.depth??0)})}}static build(e){let{width:t=100,height:r,cornerRadius:i,depth:n,extrudeBevelSize:a,extrudeBevelSegments:o,isRect:s}=e.parameters,l=e.shape,c=t*.5,u=r*.5;s?(l.addPoint(l.createPoint(-c,u)),l.addPoint(l.createPoint(c,-u)),l.addPoint(l.createPoint(-c,-u))):(l.addPoint(l.createPoint(0,u)),l.addPoint(l.createPoint(c,-u)),l.addPoint(l.createPoint(-c,-u))),l.isClosed=!0;for(let h=0,f=l.points.length;h<f;h++)l.points[h].roundness=i;l.roundness=i,l.update();let d=Lh.create({shape:l,parameters:{roundness:i,depth:n,extrudeBevelSize:a,extrudeBevelSegments:o}});return Object.assign(d,{userData:{...e,type:"TriangleGeometry"}})}};function dke(e,t){let r=2*Math.PI;return(e%r+r)%r===(t%r+r)%r}var hke=class{add(e,t,r){if(typeof arguments[0]!="string")for(let i in arguments[0])this.add(i,arguments[0][i],arguments[1]);else(Array.isArray(e)?e:[e]).forEach(function(i){this[i]=this[i]||[],t&&this[i][r?"unshift":"push"](t)},this)}run(e,t){this[e]=this[e]||[],this[e].forEach(function(r){r.call(t&&t.context?t.context:t,t)})}},fke=class{constructor(e){this.jsep=e,this.registered={}}register(...e){e.forEach(t=>{if(typeof t!="object"||!t.name||!t.init)throw new Error("Invalid JSEP plugin format");this.registered[t.name]||(t.init(this.jsep),this.registered[t.name]=t)})}},qe=class{static get version(){return"1.3.8"}static toString(){return"JavaScript Expression Parser (JSEP) v"+qe.version}static addUnaryOp(e){return qe.max_unop_len=Math.max(e.length,qe.max_unop_len),qe.unary_ops[e]=1,qe}static addBinaryOp(e,t,r){return qe.max_binop_len=Math.max(e.length,qe.max_binop_len),qe.binary_ops[e]=t,r?qe.right_associative.add(e):qe.right_associative.delete(e),qe}static addIdentifierChar(e){return qe.additional_identifier_chars.add(e),qe}static addLiteral(e,t){return qe.literals[e]=t,qe}static removeUnaryOp(e){return delete qe.unary_ops[e],e.length===qe.max_unop_len&&(qe.max_unop_len=qe.getMaxKeyLen(qe.unary_ops)),qe}static removeAllUnaryOps(){return qe.unary_ops={},qe.max_unop_len=0,qe}static removeIdentifierChar(e){return qe.additional_identifier_chars.delete(e),qe}static removeBinaryOp(e){return delete qe.binary_ops[e],e.length===qe.max_binop_len&&(qe.max_binop_len=qe.getMaxKeyLen(qe.binary_ops)),qe.right_associative.delete(e),qe}static removeAllBinaryOps(){return qe.binary_ops={},qe.max_binop_len=0,qe}static removeLiteral(e){return delete qe.literals[e],qe}static removeAllLiterals(){return qe.literals={},qe}get char(){return this.expr.charAt(this.index)}get code(){return this.expr.charCodeAt(this.index)}constructor(e){this.expr=e,this.index=0}static parse(e){return new qe(e).parse()}static getMaxKeyLen(e){return Math.max(0,...Object.keys(e).map(t=>t.length))}static isDecimalDigit(e){return e>=48&&e<=57}static binaryPrecedence(e){return qe.binary_ops[e]||0}static isIdentifierStart(e){return e>=65&&e<=90||e>=97&&e<=122||e>=128&&!qe.binary_ops[String.fromCharCode(e)]||qe.additional_identifier_chars.has(String.fromCharCode(e))}static isIdentifierPart(e){return qe.isIdentifierStart(e)||qe.isDecimalDigit(e)}throwError(e){let t=new Error(e+" at character "+this.index);throw t.index=this.index,t.description=e,t}runHook(e,t){if(qe.hooks[e]){let r={context:this,node:t};return qe.hooks.run(e,r),r.node}return t}searchHook(e){if(qe.hooks[e]){let t={context:this};return qe.hooks[e].find(function(r){return r.call(t.context,t),t.node}),t.node}}gobbleSpaces(){let e=this.code;for(;e===qe.SPACE_CODE||e===qe.TAB_CODE||e===qe.LF_CODE||e===qe.CR_CODE;)e=this.expr.charCodeAt(++this.index);this.runHook("gobble-spaces")}parse(){this.runHook("before-all");let e=this.gobbleExpressions(),t=e.length===1?e[0]:{type:qe.COMPOUND,body:e};return this.runHook("after-all",t)}gobbleExpressions(e){let t=[],r,i;for(;this.index<this.expr.length;)if(r=this.code,r===qe.SEMCOL_CODE||r===qe.COMMA_CODE)this.index++;else if(i=this.gobbleExpression())t.push(i);else if(this.index<this.expr.length){if(r===e)break;this.throwError('Unexpected "'+this.char+'"')}return t}gobbleExpression(){let e=this.searchHook("gobble-expression")||this.gobbleBinaryExpression();return this.gobbleSpaces(),this.runHook("after-expression",e)}gobbleBinaryOp(){this.gobbleSpaces();let e=this.expr.substr(this.index,qe.max_binop_len),t=e.length;for(;t>0;){if(qe.binary_ops.hasOwnProperty(e)&&(!qe.isIdentifierStart(this.code)||this.index+e.length<this.expr.length&&!qe.isIdentifierPart(this.expr.charCodeAt(this.index+e.length))))return this.index+=t,e;e=e.substr(0,--t)}return!1}gobbleBinaryExpression(){let e,t,r,i,n,a,o,s,l;if(a=this.gobbleToken(),!a||(t=this.gobbleBinaryOp(),!t))return a;for(n={value:t,prec:qe.binaryPrecedence(t),right_a:qe.right_associative.has(t)},o=this.gobbleToken(),o||this.throwError("Expected expression after "+t),i=[a,n,o];t=this.gobbleBinaryOp();){if(r=qe.binaryPrecedence(t),r===0){this.index-=t.length;break}n={value:t,prec:r,right_a:qe.right_associative.has(t)},l=t;let c=u=>n.right_a&&u.right_a?r>u.prec:r<=u.prec;for(;i.length>2&&c(i[i.length-2]);)o=i.pop(),t=i.pop().value,a=i.pop(),e={type:qe.BINARY_EXP,operator:t,left:a,right:o},i.push(e);e=this.gobbleToken(),e||this.throwError("Expected expression after "+l),i.push(n,e)}for(s=i.length-1,e=i[s];s>1;)e={type:qe.BINARY_EXP,operator:i[s-1].value,left:i[s-2],right:e},s-=2;return e}gobbleToken(){let e,t,r,i;if(this.gobbleSpaces(),i=this.searchHook("gobble-token"),i)return this.runHook("after-token",i);if(e=this.code,qe.isDecimalDigit(e)||e===qe.PERIOD_CODE)return this.gobbleNumericLiteral();if(e===qe.SQUOTE_CODE||e===qe.DQUOTE_CODE)i=this.gobbleStringLiteral();else if(e===qe.OBRACK_CODE)i=this.gobbleArray();else{for(t=this.expr.substr(this.index,qe.max_unop_len),r=t.length;r>0;){if(qe.unary_ops.hasOwnProperty(t)&&(!qe.isIdentifierStart(this.code)||this.index+t.length<this.expr.length&&!qe.isIdentifierPart(this.expr.charCodeAt(this.index+t.length)))){this.index+=r;let n=this.gobbleToken();return n||this.throwError("missing unaryOp argument"),this.runHook("after-token",{type:qe.UNARY_EXP,operator:t,argument:n,prefix:!0})}t=t.substr(0,--r)}qe.isIdentifierStart(e)?(i=this.gobbleIdentifier(),qe.literals.hasOwnProperty(i.name)?i={type:qe.LITERAL,value:qe.literals[i.name],raw:i.name}:i.name===qe.this_str&&(i={type:qe.THIS_EXP})):e===qe.OPAREN_CODE&&(i=this.gobbleGroup())}return i?(i=this.gobbleTokenProperty(i),this.runHook("after-token",i)):this.runHook("after-token",!1)}gobbleTokenProperty(e){this.gobbleSpaces();let t=this.code;for(;t===qe.PERIOD_CODE||t===qe.OBRACK_CODE||t===qe.OPAREN_CODE||t===qe.QUMARK_CODE;){let r;if(t===qe.QUMARK_CODE){if(this.expr.charCodeAt(this.index+1)!==qe.PERIOD_CODE)break;r=!0,this.index+=2,this.gobbleSpaces(),t=this.code}this.index++,t===qe.OBRACK_CODE?(e={type:qe.MEMBER_EXP,computed:!0,object:e,property:this.gobbleExpression()},this.gobbleSpaces(),t=this.code,t!==qe.CBRACK_CODE&&this.throwError("Unclosed ["),this.index++):t===qe.OPAREN_CODE?e={type:qe.CALL_EXP,arguments:this.gobbleArguments(qe.CPAREN_CODE),callee:e}:(t===qe.PERIOD_CODE||r)&&(r&&this.index--,this.gobbleSpaces(),e={type:qe.MEMBER_EXP,computed:!1,object:e,property:this.gobbleIdentifier()}),r&&(e.optional=!0),this.gobbleSpaces(),t=this.code}return e}gobbleNumericLiteral(){let e="",t,r;for(;qe.isDecimalDigit(this.code);)e+=this.expr.charAt(this.index++);if(this.code===qe.PERIOD_CODE)for(e+=this.expr.charAt(this.index++);qe.isDecimalDigit(this.code);)e+=this.expr.charAt(this.index++);if(t=this.char,t==="e"||t==="E"){for(e+=this.expr.charAt(this.index++),t=this.char,(t==="+"||t==="-")&&(e+=this.expr.charAt(this.index++));qe.isDecimalDigit(this.code);)e+=this.expr.charAt(this.index++);qe.isDecimalDigit(this.expr.charCodeAt(this.index-1))||this.throwError("Expected exponent ("+e+this.char+")")}return r=this.code,qe.isIdentifierStart(r)?this.throwError("Variable names cannot start with a number ("+e+this.char+")"):(r===qe.PERIOD_CODE||e.length===1&&e.charCodeAt(0)===qe.PERIOD_CODE)&&this.throwError("Unexpected period"),{type:qe.LITERAL,value:parseFloat(e),raw:e}}gobbleStringLiteral(){let e="",t=this.index,r=this.expr.charAt(this.index++),i=!1;for(;this.index<this.expr.length;){let n=this.expr.charAt(this.index++);if(n===r){i=!0;break}else if(n==="\\")switch(n=this.expr.charAt(this.index++),n){case"n":e+=`
`;break;case"r":e+="\r";break;case"t":e+="	";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:e+=n}else e+=n}return i||this.throwError('Unclosed quote after "'+e+'"'),{type:qe.LITERAL,value:e,raw:this.expr.substring(t,this.index)}}gobbleIdentifier(){let e=this.code,t=this.index;for(qe.isIdentifierStart(e)?this.index++:this.throwError("Unexpected "+this.char);this.index<this.expr.length&&(e=this.code,qe.isIdentifierPart(e));)this.index++;return{type:qe.IDENTIFIER,name:this.expr.slice(t,this.index)}}gobbleArguments(e){let t=[],r=!1,i=0;for(;this.index<this.expr.length;){this.gobbleSpaces();let n=this.code;if(n===e){r=!0,this.index++,e===qe.CPAREN_CODE&&i&&i>=t.length&&this.throwError("Unexpected token "+String.fromCharCode(e));break}else if(n===qe.COMMA_CODE){if(this.index++,i++,i!==t.length){if(e===qe.CPAREN_CODE)this.throwError("Unexpected token ,");else if(e===qe.CBRACK_CODE)for(let a=t.length;a<i;a++)t.push(null)}}else if(t.length!==i&&i!==0)this.throwError("Expected comma");else{let a=this.gobbleExpression();(!a||a.type===qe.COMPOUND)&&this.throwError("Expected comma"),t.push(a)}}return r||this.throwError("Expected "+String.fromCharCode(e)),t}gobbleGroup(){this.index++;let e=this.gobbleExpressions(qe.CPAREN_CODE);if(this.code===qe.CPAREN_CODE)return this.index++,e.length===1?e[0]:e.length?{type:qe.SEQUENCE_EXP,expressions:e}:!1;this.throwError("Unclosed (")}gobbleArray(){return this.index++,{type:qe.ARRAY_EXP,elements:this.gobbleArguments(qe.CBRACK_CODE)}}},pke=new hke;Object.assign(qe,{hooks:pke,plugins:new fke(qe),COMPOUND:"Compound",SEQUENCE_EXP:"SequenceExpression",IDENTIFIER:"Identifier",MEMBER_EXP:"MemberExpression",LITERAL:"Literal",THIS_EXP:"ThisExpression",CALL_EXP:"CallExpression",UNARY_EXP:"UnaryExpression",BINARY_EXP:"BinaryExpression",ARRAY_EXP:"ArrayExpression",TAB_CODE:9,LF_CODE:10,CR_CODE:13,SPACE_CODE:32,PERIOD_CODE:46,COMMA_CODE:44,SQUOTE_CODE:39,DQUOTE_CODE:34,OPAREN_CODE:40,CPAREN_CODE:41,OBRACK_CODE:91,CBRACK_CODE:93,QUMARK_CODE:63,SEMCOL_CODE:59,COLON_CODE:58,unary_ops:{"-":1,"!":1,"~":1,"+":1},binary_ops:{"||":1,"&&":2,"|":3,"^":4,"&":5,"==":6,"!=":6,"===":6,"!==":6,"<":7,">":7,"<=":7,">=":7,"<<":8,">>":8,">>>":8,"+":9,"-":9,"*":10,"/":10,"%":10},right_associative:new Set,additional_identifier_chars:new Set(["$","_"]),literals:{true:!0,false:!1,null:null},this_str:"this"});qe.max_unop_len=qe.getMaxKeyLen(qe.unary_ops);qe.max_binop_len=qe.getMaxKeyLen(qe.binary_ops);var qp=e=>new qe(e).parse(),mke=Object.getOwnPropertyNames(qe);mke.forEach(e=>{qp[e]===void 0&&e!=="prototype"&&(qp[e]=qe[e])});qp.Jsep=qe;var vke="ConditionalExpression",gke={name:"ternary",init(e){e.hooks.add("after-expression",function(t){if(t.node&&this.code===e.QUMARK_CODE){this.index++;let r=t.node,i=this.gobbleExpression();if(i||this.throwError("Expected expression"),this.gobbleSpaces(),this.code===e.COLON_CODE){this.index++;let n=this.gobbleExpression();if(n||this.throwError("Expected expression"),t.node={type:vke,test:r,consequent:i,alternate:n},r.operator&&e.binary_ops[r.operator]<=.9){let a=r;for(;a.right.operator&&e.binary_ops[a.right.operator]<=.9;)a=a.right;t.node.test=a.right,a.right=t.node,t.node=r}}else this.throwError("Expected :")}})}};qp.plugins.register(gke);var yke=["+","-","*","/","(",")","==","!=",">","<",">=","<=","and","or","!","%","^",","],bke=["0","1","2","3","4","5","6","7","8","9","."],xke=["sin","cos","tan","asin","acos","atan","atan2","sqrt","abs","log","exp","floor","ceil","round","min","max","random"];function wke(e){return typeof e!="string"?!1:!isNaN(e)&&!isNaN(parseFloat(e))}qp.addBinaryOp("^",11,!0);function RW(e,t,r="number"){let i="";for(let o=0;o<e.length;o++){let s=e[o];if("objType"in s&&s.objType==="api"){let l=JSON.parse(s.id),c=l[0],u=t.getUserAPI(c);if(u!==void 0){let d=u.retrieveValue(l.slice(1));d!==void 0&&(i+=d)}continue}if("objType"in s&&s.objType==="webhook"){let l=JSON.parse(s.id),[c,u]=l,d=t.getUserWebhook(c);if(d!==void 0){let h=d.getParameterValue(u);h!==void 0&&(i+=h)}continue}if("id"in s){let l=e[o-1];if(o>0&&"id"in l){console.error("Two variables in a row",e);return}let c=t.getVariable(s.id),u=na.getDisplayedValue(c);r==="number"&&na.isTextValue(c)&&Array.isArray(c.textValue)&&c.textValue.length===1?u=parseFloat(u).toString():r==="boolean"&&na.isBoolean(c)?u=c?"true":"false":r==="boolean"&&na.isTextValue(c)&&!Array.isArray(c.textValue)&&(u='"'+u+'"'),i+=u;continue}else if(r==="string"){s.name!=='"'&&(s.name!=="+"||s.escaped)&&(i+=s.name),s.name==="+"&&!s.escaped&&i[i.length-1]==="\\"&&(i=i.slice(0,-1)+s.name);continue}if(s.name==="and"){i+="&&";continue}if(s.name==="or"){i+="||";continue}if(s.name==="True"){i+="true";continue}if(s.name==="False"){i+="false";continue}if(r==="boolean"&&!wke(s.name)&&!bke.includes(s.name)&&!yke.includes(s.name)&&!xke.includes(s.name.replace(/\($/g,""))){i+='"'+s.name+'"';continue}i+=s.name}if(r==="string")return i;if(e.length===0){if(r==="number")return 0;if(r==="boolean")return!1}let n;try{n=qp(i)}catch(o){console.error(i,o);return}let a;try{a=zr(n)}catch(o){console.error(i,n,o)}return a}function zr(e){switch(e.type){case"BinaryExpression":switch(e.operator){case"==":return+(zr(e.left)===zr(e.right));case"!=":return+(zr(e.left)!==zr(e.right));case">":return+(zr(e.left)>zr(e.right));case">=":return+(zr(e.left)>=zr(e.right));case"<":return+(zr(e.left)<zr(e.right));case"<=":return+(zr(e.left)<=zr(e.right));case"+":return zr(e.left)+zr(e.right);case"-":return zr(e.left)-zr(e.right);case"*":return zr(e.left)*zr(e.right);case"/":return zr(e.left)/zr(e.right);case"%":return zr(e.left)%zr(e.right);case"&&":return zr(e.left)&&zr(e.right);case"||":return zr(e.left)||zr(e.right);case"^":return Math.pow(zr(e.left),zr(e.right));default:throw new Error("Unknown operator: "+e.operator)}case"UnaryExpression":switch(e.operator){case"-":return-zr(e.argument);case"!":return+!zr(e.argument);default:throw new Error("Unknown operator: "+e.operator)}case"Identifier":throw new Error("Unknown identifier: "+e.name);case"Literal":return e.value;case"CallExpression":if(e.callee.type==="Identifier"){if(e.callee.name==="random"){let t=0,r=1;if(e.arguments.length>=1)try{t=zr(e.arguments[0])}catch(i){console.warn(i)}if(e.arguments.length>=2)try{r=zr(e.arguments[1])}catch(i){console.warn(i)}return t=Math.min(r,t),r=Math.max(r,t),t+Math.random()*(r-t)}return Math[e.callee.name].apply(null,e.arguments.map(zr))}else throw new Error("Unknown node");default:throw new Error("Unknown node type: "+e.type)}}var Ske=new it,Cke=new it;function _ke(e,t,r){let i=[new k,new k,new k],n=[new k,new k,new k];return e.extractBasis(i[0],i[1],i[2]),t.extractBasis(n[0],n[1],n[2]),i.forEach((a,o)=>{let s=n[o],l=St.lerp(a.length(),s.length(),r);a.lerp(s,r).setLength(l)}),new it().makeBasis(i[0],i[1],i[2])}var Ake=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,height:100,depth:1,subdivisions:12,roundness:0,extrudeBevelSize:0,extrudeBevelSegments:3},e.parameters),i=Math.abs(r.width),n=Math.abs(r.height??r.width),a=Math.abs(r.depth??0),o=(t==null?void 0:t.shapeData)??BD.create({parameters:rW}).userData.shape;return{path:e.path??p1.defaultData(),parameters:Object.assign(r,{width:i,height:n,depth:a,extrusion:{...iW,...r.extrusion}}),shapeData:o}}static build(e){if(e.path.points.length>=2){let t=new Mke(e);return Object.assign(t,{userData:{...e,type:"PathGeometry"}})}else return Object.assign(new Ot,{userData:{...e,type:"PathGeometry"}})}},Mke=class extends Ot{constructor(e){super(),this.type="PathExtrusionGeometry",this.inputs=e,this.build()}_isGeometryClosed(){return this.inputs.path.isClosed&&this.inputs.parameters.extrusion.depth===1}_isOpenEnded(){let e=this.inputs.parameters.extrusion;return!(this.inputs.path.isClosed&&e.depth===1)||!dke(e.twist,0)||e.startScale!==e.endScale}build(){let e=this._extractPathPoints();if(e.length<2)return;let t=this._computeBasisMatrices(e),{depth:r,offset:i}=this.inputs.parameters.extrusion;r=Math.max(0,Math.min(r,1)),i=Math.max(0,Math.min(i,1));let n=this.inputs.path.isClosed?e.length:e.length-1,a=Math.floor(i*n),o=this.inputs.path.isClosed?Math.ceil((r+i)*n):Math.ceil(Math.min(1,r+i)*n),s=Math.min(Math.max(2,o-a+1),n+2),l=[],c=[];for(let N=0;N<s;N++){let U=this.inputs.path.isClosed?(N+a)%e.length:Math.min(N+a,e.length-1);l.push(e[U].clone()),c.push(t[U].clone())}let u=(N,U,ie)=>{l[N]=l[N].clone().lerp(l[U],ie),c[N]=_ke(c[N],c[U],ie)},d=0,h=i*n%1;(!this.inputs.path.isClosed||r<=1)&&(h||i===0)&&(d=h,u(0,1,d));let f=0,p=(i+r)*n%1;if((this.inputs.path.isClosed&&r<=1||!this.inputs.path.isClosed&&i+r<1)&&p&&(f=p,u(l.length-1,l.length-2,1-f)),r===0){let N=l.length-1;l[N].copy(l[0]),c[N].copy(c[0])}this._applyPathModifiers(c,d,f);let{bevel:v,bevelSides:m}=this.inputs.parameters.extrusion,g=v>0?this.inputs.parameters.extrusion.capType:"flat",y=5;this.inputs.parameters.extrusion.shape.type==="Custom"&&(y=this.inputs.parameters.extrusion.shape.shapeQuality==="low"?5:12);let{regions:b,infos:x,vertices:S}=this._computeShapePoints(y),w=0,_;g==="round"&&(_=new LD(this.inputs.shapeData,2*v,v,y,m,void 0,!0),w=_.getAttribute("position").count);let C=0,A=0;x.sort((N,U)=>N.start-U.start),x.forEach(N=>{N.verticesStart=C,N.verticesCount=N.continuous.reduce((U,ie,te)=>U+(te===0||!ie?2:1),0),A+=N.verticesCount,C=A});let M=A*s,P,T=0;if(this._isOpenEnded()&&g==="flat"){try{P=gu({windingRule:ri.ODD,elementType:sn.POLYGONS,polySize:3,vertexSize:2,strict:!0,contours:b})}catch{P=wW}T=P.vertexCount}let R=M+2*T+w*2,z=M+2*T,F={positions:new Float32Array(R*3),normals:new Float32Array(R*3),uvs:new Float32Array(R*2)},H=[];if(x.forEach(N=>{this._extrudeRegion(N,S,c,l,F,H,this._isGeometryClosed()&&!this._isOpenEnded())}),P&&(this._closeEnd(P,M,H,F,c[0],l[0],!1),this._closeEnd(P,M+T,H,F,c[c.length-1],l[l.length-1],!0)),_){F.positions.set(_.getAttribute("position").array,z*3),F.normals.set(_.getAttribute("normal").array,z*3),F.uvs.set(_.getAttribute("uv").array,z*2);for(let te=z;te<z+w;te++)F.uvs[te*2+1]=1e-4;let N=H.length;H.push(..._.getIndex().array.map(te=>te+z)),z+=w,F.positions.set(_.getAttribute("position").array,z*3),F.normals.set(_.getAttribute("normal").array,z*3),F.uvs.set(_.getAttribute("uv").array,z*2);let U=H.length;H.push(..._.getIndex().array.map(te=>te+z)),this.setAttribute("position",new qt(F.positions,3)),this.setAttribute("normal",new qt(F.normals,3)),this.setAttribute("uv",new qt(F.uvs,2)),this.setIndex(H);let ie=Ske;ie.copy(c[c.length-1]).setPosition(l[l.length-1]),this.applyMatrix4OnRange(ie,z,R),ie.copy(c[0]).setPosition(l[0]).multiply(Cke.makeScale(1,1,-1)),this.applyMatrix4OnRange(ie,z-w,z),this.reverseIndicesOnRange(N,U)}else this.setAttribute("position",new qt(F.positions,3)),this.setAttribute("normal",new qt(F.normals,3)),this.setAttribute("uv",new qt(F.uvs,2)),this.setIndex(H)}_extractPathPoints(){let e=hW(this.inputs.path).getPoints(this.inputs.path.subdivisions);if(e.length<2)return[];let t=[e[0]];return e.forEach(r=>{t[t.length-1].distanceToSquared(r)>.001&&t.push(r)}),this.inputs.path.isClosed&&t[t.length-1].distanceTo(t[0])<.001&&t.pop(),t}_computeBasisMatrices(e){let t=[],r=e.length,i=this.inputs.path.isClosed,n=new k,a=new k,o=new k,s=new k,l=new k(0,1,0);for(let p=0;p<r;p++){let v=e[p],m;p===0?m=i?e[e.length-2]:v.clone().multiplyScalar(2).sub(e[1]):m=e[p-1];let g;p===r-1?g=i?e[1]:v.clone().multiplyScalar(2).sub(e[p-1]):g=e[p+1];let y=v.clone().sub(m).normalize(),b=g.clone().sub(v).normalize(),x=y.clone().add(b).normalize();o.copy(x),p===0&&(x.equals(l)||x.clone().negate().equals(l))&&l.set(0,0,1);let S=l.clone().cross(x).normalize(),w=x.clone().cross(S).normalize();l.copy(w),s.copy(S),p===0&&(n.copy(w),a.copy(x));let _=new it().makeBasis(S,w,x);t.push(_)}let c=i?a:o,u=i?n:new k(0,1,0),d=c.clone().cross(s).normalize(),h=Math.acos(u.dot(d));if(isNaN(h))return t;let f=u.clone().cross(d);c.dot(f)>0&&(h*=-1);for(let p=1;p<t.length;p++){let v=new it().makeRotationZ(h*p/t.length);t[p].multiply(v)}return t}_applyPathModifiers(e,t,r){let i=e.length,{angle:n,twist:a,startScale:o,endScale:s}=this.inputs.parameters.extrusion,l=new it,c=new it;return e.forEach((u,d)=>{let h=d===0?0:d===i-1?1:(d-t)/(i-(r===0?0:1)-(t+(1-r)));l.makeRotationZ(St.lerp(n,n+a,h)*St.DEG2RAD);let f=St.lerp(o,s,h);c.makeScale(f,f,f),u.multiply(l).multiply(c)}),e}_computeShapePoints(e=12,t=ri.ODD){let r=this.inputs.shapeData,i=r.extractShapePointsToFlatArray([],e),n=r.shapeHoles.map(c=>{let u=c.extractShapePointsToFlatArray([],e),d=[];for(let h=u.length-1;h>=1;h-=2){let f=u[h-1],p=u[h-0];d.push(f,p)}return d}),a;try{a=gu({windingRule:t,elementType:sn.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[i]})}catch{a=kD}let o;try{o=gu({windingRule:ri.ODD,elementType:sn.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[...n]})}catch{o=xW}if(!a)throw new Error("error generating geometry");let s=a.elementCount;if(o){a.elementCount+=o.elementCount;for(let c=0;c<o.elements.length;c++){let u=o.elements[c],d=c%2===0?a.vertexCount:0;a.elements.push(u+d)}for(let c=0;c<o.vertexIndices.length;c++){let u=o.vertexIndices[c],d=a.vertexCount;a.vertexIndices.push(u+d)}for(let c=0;c<o.vertices.length;c++){let u=o.vertices[c];a.vertices.push(u)}}for(let c=0,u=a.vertexCount;c<u;c++){let d=c*2;a.vertices[d+0],a.vertices[d+1]}let l=[];for(let c=a.elementCount-1;c>=0;c--){let u=c>=s,d=c*2,h=a.elements[d+0],f=a.elements[d+1],p=h+f,v={start:h,count:f,normals:[],isHole:u,continuous:[],verticesStart:0,verticesCount:0};l.push(v);let m=h,g=p-1,y=h+1,b=r.roundedCurves.length;do{let x=m-h;a.vertices[g*2+0],a.vertices[g*2+1];let S=a.vertices[m*2+0],w=a.vertices[m*2+1],_=a.vertices[y*2+0],C=a.vertices[y*2+1],A=S-_,M=w-C,P=Math.sqrt(A*A+M*M);A/=P,M/=P,v.normals[x*2+0]=-M,v.normals[x*2+1]=A;let T=a.vertexIndices[m];if(Array.isArray(T))v.continuous[x]=!1;else{let[R,z]=r.getCurveIndexFromVertexId(T-1,!0);if(z>0&&z<1)v.continuous[x]=!0;else{let F=z===1?R+1:R-1;F=(F+b)%b;let H=z===1?0:1,N=r.roundedCurves[R].getTangent(z),U=r.roundedCurves[F].getTangent(H);v.continuous[x]=N.dot(U)>.95}}u&&(v.normals[x*2+0]*=-1,v.normals[x*2+1]*=-1),[g,m,y]=[m,y,y+1],y>=p&&(y-=f)}while(y!==h+1)}return{regions:[i,...n],infos:l,vertices:a.vertices}}_insertVertex(e,t,r,i,n){let a=t*2,o=t*3;e.positions[o+0]=r.x,e.positions[o+1]=r.y,e.positions[o+2]=r.z,e.normals[o+0]=i.x,e.normals[o+1]=i.y,e.normals[o+2]=i.z,e.uvs[a+0]=n.x,e.uvs[a+1]=n.y}_extrudeRegion(e,t,r,i,n,a,o){let s=new k,l=new k,c=new k,u=new k,d=new ye;r.forEach((f,p)=>{let v=i[p],m=e.verticesStart*r.length+e.verticesCount*p;for(let g=0;g<e.count;g++){let y=(e.start+g)*2;if(s.set(t[y+0],t[y+1],0),c.copy(s).applyMatrix4(f).add(v),e.continuous[g])u.set(e.normals[g*2+0],e.normals[g*2+1],0);else{let b=g===0?(e.start+e.count-1)*2:y-2;l.set(t[b+0],t[b+1],0),u.copy(s).sub(l),u.set(-u.y,u.x,0),e.isHole||u.negate()}if(u.applyMatrix4(f).normalize(),d.set(g===0?1:g/e.count,p/(r.length-1)),this._insertVertex(n,m,c,u,d),m++,!e.continuous[g]||g===0){if(g===0)u.set(e.normals[g*2+0],e.normals[g*2+1],0),d.set(0,p/(r.length-1));else{let b=g===e.count-1?e.start*2:y+2;l.set(t[b+0],t[b+1],0),u.copy(l).sub(s),u.set(-u.y,u.x,0),e.isHole||u.negate()}u.applyMatrix4(f).normalize(),this._insertVertex(n,m,c,u,d),m++}}});let h=r.length-1;for(let f=0;f<h;f++){let p=e.verticesStart*r.length+e.verticesCount*f,v=e.verticesStart*r.length+e.verticesCount*(f+1),m=0;for(let g=0;g<e.count;g++){(!e.continuous[g]||g===0)&&m++;let y=g===e.count-1?0:m+1,b=p+m,x=p+y,S=v+y,w=v+m;e.isHole?a.push(b,S,x,b,w,S):a.push(b,x,S,b,S,w),m++}}}_closeEnd(e,t,r,i,n,a,o){let s=e.vertexCount,l=new k(0,0,o?-1:1).applyMatrix4(n),c=new k,u=new ye;for(let h=0;h<s;h++){let f=2*h;c.set(e.vertices[f+0],e.vertices[f+1],0).applyMatrix4(n).add(a),this._insertVertex(i,t+h,c,l,u)}let d=e.elements;for(let h=0;h<e.elementCount;h++){let f=3*h,p=d[f+0]+t,v=d[f+(o?1:2)]+t,m=d[f+(o?2:1)]+t;r.push(p,v,m)}}applyMatrix4OnRange(e,t,r){let i=e.elements,n=new cn().getNormalMatrix(e).elements,a,o,s,l,c=this.attributes.position,u=this.attributes.normal;if(!c||!u)return;let d=c.array,h=u.array,f=c.itemSize;for(let p=t*f,v=r*f;p<v;p+=f){if(p===t)debugger;a=d[p+0],o=d[p+1],s=d[p+2],l=1/(i[3]*a+i[7]*o+i[11]*s+i[15]),d[p+0]=(i[0]*a+i[4]*o+i[8]*s+i[12])*l,d[p+1]=(i[1]*a+i[5]*o+i[9]*s+i[13])*l,d[p+2]=(i[2]*a+i[6]*o+i[10]*s+i[14])*l,a=h[p+0],o=h[p+1],s=h[p+2],h[p+0]=n[0]*a+n[3]*o+n[6]*s,h[p+1]=n[1]*a+n[4]*o+n[7]*s,h[p+2]=n[2]*a+n[5]*o+n[8]*s}c.needsUpdate=!0,u.needsUpdate=!0}reverseIndicesOnRange(e,t){let r=this.index;if(r){for(let i=e;i<t;i+=3){let n=r.getX(i),a=r.getX(i+1),o=r.getX(i+2);r.setXYZ(i,o,a,n)}r.needsUpdate=!0}}};function IW(){let e=new Ot;return e.setAttribute("position",new qt(new Float32Array([]),3)),e.setIndex(new qt(new Uint16Array([]),1)),e}var Eke=IW().attributes,Tke=12,Pke=1,PE=class extends Ot{constructor(e,t){super(),this.charWidths=[],this.charCoords=[],this.wrappedText=[],this.isLowResolution=!1,this.vectorShapes=[],Object.assign(this.attributes,Eke),this.userData={parameters:e,type:"TextGeometry"};let r=t.getFont(e.font);r!=null&&r.isLoaded?(this.font=r,this.update(e)):this.updateFont(e.font,t).then(()=>{this.update(e),t==null||t.requestRender()})}async updateFont(e,t){let r=t.getFont(e);r&&(this.font=r,await r.loadingPromise)}update(e){let t=this.font;if(this.userData={parameters:e,type:"TextGeometry"},!(t!=null&&t.isLoaded)){console.warn("Cannot update text because its font is not loaded");return}let{width:r,height:i,depth:n,extrudeBevelSize:a,extrudeBevelSegments:o,text:s,textTransform:l}=e,c=na.getDisplayedValue(s),u=l===2?c.toUpperCase():l===3?c.toLowerCase():c,d=Dke(e,t,u),{shapes:h,charWidths:f,charCoords:p}=t.generateShapes(d,e),v=(typeof r=="number"?r:1)*.5,m=(typeof i=="number"?i:1)*.5,g=h.map(x=>new Fi().fromShape(x,!0));this.vectorShapes=g;let y=g.map(x=>Lh.create({shape:x,parameters:{depth:n,extrudeBevelSegments:o,extrudeBevelSize:a,windingRule:n<=0?ri.NONZERO:ri.ODD,subdivisions:this.isLowResolution&&n>0?Pke:Tke}})),b=y.length?jd(y):IW();b.translate(-v,m,0),this.dispose(),this.wrappedText=d,this.charCoords=p,this.charWidths=f,this.deleteAttribute("extrudeNormal"),Object.entries(b.attributes).forEach(([x,S])=>{this.setAttribute(x,S)}),this.setIndex(b.index),this.computeBoundingSphere()}clone(){let e=$o(new Ot,PE.prototype);return e.copy(this),console.log("CloneGeometry",this,e),e}copy(e){return Object.entries(e.attributes).forEach(([t,r])=>{this.setAttribute(t,r)}),this.setIndex(e.index),this.userData={parameters:{...e.userData.parameters},type:"TextGeometry"},this}async setText(e){this.font&&await this.font.loadingPromise,await this.update({...this.userData.parameters,text:{textValue:e}})}get text(){return this.userData.parameters.text??""}};function Dke(e,t,r){let i=[""],n="";for(let a of r)n+=a,a===" "||a===`
`?(i[i.length-1]+=n,n="",a===`
`&&i.push("")):t.getTextWidth(i[i.length-1]+n,e)>e.width&&(i[i.length-1].length&&i.push(""),t.getTextWidth(i[i.length-1]+n,e)>e.width&&(n.length===1?(i[i.length-1]+=n,n=""):(i[i.length-1]+=n.slice(0,-1),n=n[n.length-1],i.push(""))));return i[i.length-1]+=n,i}var zW,kW=new Promise(e=>{zW=e}),WB=!1,rb;function Oke(){if(WB)return;if(rb)return rb;async function e(){let t="https://unpkg.com/@splinetool/modelling-wasm@1.9.21/build",r=Cc(()=>import("./process-B9H0U9ag.js"),[]),[i,n]=await Promise.all([r,fetch(`${t}/process.wasm`).then(s=>s.arrayBuffer())]),a=i.default,o=await a({wasmBinary:n});zW(o),WB=!0}return rb=e(),rb}var Rke=["font"];function qg(e,t,r,i){var c,u;let n,a,o;e.type==="PathGeometry"?(a=JSON.parse(JSON.stringify(e)),o=[[],["extrusion"]]):(a={...e},o=[[]]);for(let d of o){let h=a;for(let f of d)h=h[f];for(n in h){let f=h[n];$L(f)&&!Rke.includes(n)&&(h[n]=t.getVariable(f,[i.uuid,"geometry",...d,n]),$L(h[n])&&(h[n]=1))}}let s={parameters:a,type:a.type};if(a.type==="PathGeometry")s.path=a.path;else if(a.type==="VectorGeometry"){let d=Fi.createFromState(a.shape,a.width,a.height);s.shape=d}else if(a.type==="NonParametricGeometry"){if(a.data.groups&&((c=a.data.groups)==null||c.forEach(d=>d.materialIndex=Math.max(d.materialIndex??0,0))),s.geometry=new k8().parse(a),s.geometry.groups.length===0){let d=s.geometry;d.addGroup(0,Math.max(((u=d.getIndex())==null?void 0:u.count)??0,d.getAttribute("position").count),0)}}else if(a.type==="SubdivGeometry"){let d=new Pa(a,r);return d.data=e,d}else{if(a.type==="TextGeometry")return new PE(a,t);if(a.type==="InputGeometry")return new PE(a,t);if(a.type==="UIGeometry")return FD.create({parameters:{width:a.width,height:a.height,cornerRadius:a.cornerRadius,cornerType:a.cornerType}})}let l;try{l=XB(s)}catch(d){console.error(d)}if(!l){let d=Fi.createFromState(f1.defaultData(),100,100);s.shape=d,l=XB(s)}return l}var Ike=new it;function DE(e,t,r,i){let n=e.position.array,a=e.normal.array,o=Ike.makeScale(t,r,i).invert().elements,s,l,c;for(var u=0,d=n.length;u<d;u+=3)n[u]*=t,n[u+1]*=r,n[u+2]*=i,s=a[u],l=a[u+1],c=a[u+2],a[u]=o[0]*s+o[4]*l+o[8]*c,a[u+1]=o[1]*s+o[5]*l+o[9]*c,a[u+2]=o[2]*s+o[6]*l+o[10]*c;e.position.needsUpdate=!0,e.normal.needsUpdate=!0}var ib=new Ji,bf=new k,jt;kW.then(e=>{jt=e});var GB=new Float32Array([10,10,0,-10,10,0,-10,-10,0,10,-10,0]),$B=new Uint32Array([0,1,2,3]),qB=new Uint8Array([4]),Pa=class extends Ot{constructor(e,t){super(),this.data=e,this.flatShading=t,this.subdivPointer=0,this.rebuild(),this.freeSubdivPointer()}mutateDirectlyScaleBaked(e,t){this.freeSubdivPointer();let r=this.data.scaleBaked,i=th.div(t,r);this.subdividedGeometry&&DE(this.subdividedGeometry.attributes,...i),this.originalGeometry&&DE(this.originalGeometry.attributes,...i),this.data=e;let n=this.userData.parameters;this.userData.parameters={width:n.width*i[0],height:n.height*i[1],depth:n.depth*i[2]},this.originalGeometry.boundingSphere.center.multiply(bf.fromArray(i));let a=bf.set(n.width,n.height,n.depth).length();this.originalGeometry.boundingSphere.radius=a/2}ensureSubdivPointer(){return this.subdivPointer===0&&this.rebuild(),this.subdivPointer}rebuild(){let e,t,r;try{({originalGeometry:e,subdividedGeometry:t,subdivPointer:r}=Pa.build(this.data,void 0,!this.flatShading,void 0))}catch{e=new ws(100,100,100),r=0}this.subdivPointer=r,this.originalGeometry=e,this.subdividedGeometry=t??void 0;let i=this.subdividedGeometry??this.originalGeometry;Object.assign(this,i),this.calcBoundingBox()}freeSubdivPointer(){this.subdivPointer&&(Pa.freeSubdivPointer(this.subdivPointer),this.subdivPointer=0)}dispose(){super.dispose(),this.freeSubdivPointer()}calcBoundingBox(){let e=this.originalGeometry;e.boundingSphere===null&&(e.boundingSphere=new ao,this.subdividedGeometry&&(this.subdividedGeometry.boundingSphere=e.boundingSphere));let t=e.attributes.position,r=e.boundingSphere.center;ib.setFromBufferAttribute(t),ib.getCenter(r),e.boundingSphere.radius=r.distanceTo(ib.max),isNaN(e.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this),ib.getSize(bf);let i={width:bf.x,height:bf.y,depth:bf.z};return this.userData.parameters=i,i}static build(e,t,r,i){let n,a,o,s=(e==null?void 0:e.phongAngle)??35;r===!1&&(s=-1),t&&(jt.free_bvh(t),jt.free_subdivision_surface(t));try{n=Pa.allocate(e,i)}catch(l){console.error(l,e),n=Pa.allocate({positionWASM:GB,indexWASM:$B,verticesPerFaceWASM:qB},i)}if(jt.set_destination_refinement_level(n,0),a=Pa.buildLevel(n,!0,s),e.subdivisions>0)try{jt.set_destination_refinement_level(n,e.subdivisions),o=Pa.buildLevel(n,!1,s)}catch{try{jt.set_destination_refinement_level(n,e.subdivisions-1),o=Pa.buildLevel(n,!1,s)}catch{o=null}}else o=null;return{subdivPointer:n,originalGeometry:a,subdividedGeometry:o}}static primitiveToQuads(e,t,r){e.widthSegments>16&&(e.widthSegments=16),e.heightSegments>16&&(e.heightSegments=16),e.depthSegments>16&&(e.depthSegments=16),e.radialSegments>16&&(e.radialSegments=16),e.type==="DodecahedronGeometry"&&(e.detail=0);let i=e.shape!==void 0||e.path!==void 0?t.geometry:qg(e,r,!1),n;e.type==="TorusGeometry"&&e.arc===Math.PI*2?n=i.getClosedTorusIndicesForBooleanOrSubdiv():n=i.getIndex();let a,o,s,l;({positions:a,triIndices:l}=$w(i.getAttribute("position"),n));let c;if(e.type==="CylinderGeometry"&&e.cornerRadius===0&&e.hollow===0&&e.openEnded===!1){let u=e.radialSegments*e.heightSegments*3*2,d=u+e.radialSegments*3;c=[u,d]}return{indices:o,verticesPerFace:s}=LW(a,l,i,c),{positions:a,indices:o,verticesPerFace:s}}static allocate(e,t){var b;let r,i,n,a=[],o=[];e.positionWASM&&e.positionWASM.length>0?(r=e.positionWASM,i=e.indexWASM,n=e.verticesPerFaceWASM):(r=GB,i=$B,n=qB);let s=r.length,l=i.length,c=n.length,u=r.length+a.length+o.length,d=i.length+n.length,h=u*Float32Array.BYTES_PER_ELEMENT+d*Uint32Array.BYTES_PER_ELEMENT,f=u*Float32Array.BYTES_PER_ELEMENT,p=jt._malloc(h),v=new Float32Array(jt.HEAPF32.buffer,p,u),m=new Uint32Array(jt.HEAPU32.buffer,p+f,d);v.set(r,0),v.set(a,r.length),v.set(o,r.length+a.length),m.set(i,0),m.set(n,i.length);let g;(b=e==null?void 0:e.scaleBaked)!=null&&b.some(x=>x!==1)&&(g=new it().makeScale(...e.scaleBaked)),t&&(g?g.premultiply(t):g=t);let y=g?jt.alloc_subdivision_surface2(p,s,p+f,l,p+f+i.length*Uint32Array.BYTES_PER_ELEMENT,c,g.elements):jt.alloc_subdivision_surface(p,s,p+f,l,p+f+i.length*Uint32Array.BYTES_PER_ELEMENT,c);return jt._free(p),y}static buildLevel(e,t,r,i,n){let a=n?jt.get_mesh_data2(e,t?jt.Level.CONTROL:jt.Level.REFINED,r,n.elements):jt.get_mesh_data(e,t?jt.Level.CONTROL:jt.Level.REFINED,r),o=8,s=jt.HEAPU32.subarray(a>>2,(a>>2)+o),l=s.subarray(4,8),c=0,u=jt.HEAPU32[s[c]>>2],d=jt.HEAPF32.subarray(u>>2,(u>>2)+l[c]);c++;let h=jt.HEAPU32[s[c]>>2],f=jt.HEAPF32.subarray(h>>2,(h>>2)+l[c]);c++;let p=jt.HEAPU32[s[c]>>2],v=jt.HEAPU32.subarray(p>>2,(p>>2)+l[c]);c++;let m=jt.HEAPU32[s[c]>>2],g=jt.HEAPU32.subarray(m>>2,(m>>2)+l[c]);if(c++,i===void 0){let y=new Ot;if(y.setIndex(new ap(g,1)),y.setAttribute("position",new yt(d,3)),y.setAttribute("normal",new yt(f,3)),t){y.setAttribute("faceMap",new ap(v,1));let b=new Float32Array(f.length/3*4).fill(0);y.setAttribute("color",new qt(b,4))}return jt.free_mesh_data(a),y.userData.type="SubdivGeometry",y}i.getAttribute("position").copyArray(d),i.getAttribute("normal").copyArray(f),i.attributes.position.needsUpdate=!0,i.attributes.normal.needsUpdate=!0,jt.free_mesh_data(a)}static freeSubdivPointer(e){jt.free_bvh(e),jt.free_subdivision_surface(e)}static buildControlCageWireframe(e,t,r){let i=jt.get_wireframe_data_for_base_level(e),n=4,a=jt.HEAPU32.subarray(i>>2,(i>>2)+n),o=a.subarray(2,4),s=0,l=jt.HEAPU32[a[s]>>2],c=jt.HEAPF32.subarray(l>>2,(l>>2)+o[s]);s++;let u=jt.HEAPU32[a[s]>>2],d=jt.HEAPU32.subarray(u>>2,(u>>2)+o[s]);if(t===void 0){let h=new Ot;h.setAttribute("position",new yt(c,3));let f=new Float32Array(c.length);for(let p=0,v=c.length;p<v;)f[p++]=r.r,f[p++]=r.g,f[p++]=r.b;return h.setAttribute("color",new qt(f,3)),h.setIndex(new ap(d,1)),jt.free_wireframe_data_for_base_level(i),h}t.getAttribute("position").copyArray(c),t.attributes.position.needsUpdate=!0,jt.free_wireframe_data_for_base_level(i)}static updateCollabMesh(e,t,r){let i=t===0;i||jt.set_destination_refinement_level(e,t);let n=r?jt.get_topological_data2(e,i?jt.Level.CONTROL:jt.Level.REFINED,r.elements):jt.get_topological_data(e,i?jt.Level.CONTROL:jt.Level.REFINED),a=6,o=jt.HEAPU32.subarray(n>>2,(n>>2)+a),s=o.subarray(3,6),l=0,c=jt.HEAPU32[o[l]>>2],u=new Float32Array(jt.HEAPF32.subarray(c>>2,(c>>2)+s[l]));l++;let d=jt.HEAPU32[o[l]>>2],h=new Uint32Array(jt.HEAPU32.subarray(d>>2,(d>>2)+s[l]));l++;let f=jt.HEAPU32[o[l]>>2],p=new Uint8Array(jt.HEAPU32.subarray(f>>2,(f>>2)+s[l]));return jt.free_topological_data(n),{positions:u,indices:h,verticesPerFace:p}}},YB=["getX","getY","getZ"];function $w(e,t){let r={},i=t?t.count:e.count,n=0,a=[],o=[],s=1e4;for(let c=0;c<i;c++){let u=t?t.getX(c):c,d="";for(let h=0;h<3;h++)d+=`${~~(e[YB[h]](u)*s)},`;if(d in r)a.push(r[d]);else{for(let h=0;h<3;h++)o.push(e[YB[h]](u));r[d]=n,a.push(n),n++}}let l=[];for(let c=0;c<a.length;c+=3)a[c]===a[c+1]||a[c]===a[c+2]||a[c+1]===a[c+2]||l.push(a[c],a[c+1],a[c+2]);return{positions:o,triIndices:l}}var nb=new k,b_=new k,x_=new k,w_=new k;function LW(e,t,r,i){let n=[],a=[];if(r.userData.shape!==void 0&&r.userData.parameters.depth===0&&r.userData.shape.shapeHoles.length===0){let l=r.userData.shape.extractShapePointsToFlatArray([]),c=r.userData.parameters.spikes;if(r.userData.type==="EllipseGeometry"&&c<=24&&c%4===0&&r.userData.parameters.angle>=360){let h=l.length/2/c;l=l.filter((f,p)=>Math.floor(p/2)%h===0)}let u=0;for(let h=0;h<l.length;h+=2)u+=(l[h]-l[(h===0?l.length:h)-2])*(l[h+1]+l[(h===0?l.length:h)-1]);e.length=0;let d=0;if(u<0)for(let h=0;h<l.length;h+=2)e.push(l[h],l[h+1],0),n.push(d++);else for(let h=l.length-2;h>=0;h-=2)e.push(l[h],l[h+1],0),n.push(d++);return a.push(d),{indices:n,verticesPerFace:a}}let o=new Float32Array([r.userData.parameters.depth])[0],s=0;for(;s<t.length;){if(r.useNgonForTopBottomFaceDuringBake){let l=0;if((e[t[s]*3+2]===o||e[t[s]*3+2]===0)&&l++,(e[t[s+1]*3+2]===o||e[t[s+1]*3+2]===0)&&l++,(e[t[s+2]*3+2]===o||e[t[s+2]*3+2]===0)&&l++,l===3)break}if(t[s+1]===t[s+3]&&t[s+2]===t[s+5]||t[s+0]===t[s+3]&&t[s+2]===t[s+4]){nb.set(e[t[s]*3],e[t[s]*3+1],e[t[s]*3+2]),b_.set(e[t[s+1]*3],e[t[s+1]*3+1],e[t[s+1]*3+2]),x_.set(e[t[s+4]*3],e[t[s+4]*3+1],e[t[s+4]*3+2]),w_.set(e[t[s+5]*3],e[t[s+5]*3+1],e[t[s+5]*3+2]),b_.sub(nb).normalize(),x_.sub(nb).normalize(),w_.sub(nb).normalize();let l=b_.cross(x_).dot(w_);Math.abs(l)>.005||i&&i.some((c,u)=>u%2===1?!1:s>=i[u]&&s<i[u+1])?(n.push(t[s],t[s+1],t[s+2]),a.push(3),s+=3):(n.push(t[s],t[s+1],t[s+4],t[s+5]),a.push(4),s+=6)}else n.push(t[s],t[s+1],t[s+2]),a.push(3),s+=3}if(r.useNgonForTopBottomFaceDuringBake){let l=[],c=[],u=0;for(let d=0,h=0;d<e.length;d+=3,h++)e[d+2]===0&&(l.push(h),u++),e[d+2]===o&&c.push(h);if(r.userData.parameters.extrudeBevelSize===0){let d=c[0];c[0]=c[1],c[1]=d}l.reverse(),n.push(...l,...c),a.push(u,u)}return{indices:n,verticesPerFace:a}}var Wl={};Uye(Wl,{calcBoolean:()=>Fke,calcBooleanTopological:()=>Bke,freeMeshSet:()=>Vke,getMeshSet:()=>Nke,hasOpenEdges:()=>Uke,transformMeshSet:()=>jke});var BW,zke=new Promise(e=>{BW=e}),ab;function kke(){if(ab)return ab;async function e(){let t="https://unpkg.com/@splinetool/boolean-wasm@1.9.21/build",r=Cc(()=>import("./boolean-BpCokwB2.js"),[]),[i,n]=await Promise.all([r,fetch(`${t}/boolean.wasm`).then(s=>s.arrayBuffer())]),a=i.default,o=await a({wasmBinary:n});BW(o)}return ab=e(),ab}var yr,hp;zke.then(e=>yr=e);function Lke(e,t,r){let i,n;e.userData.parameters.type==="TorusGeometry"&&e.userData.parameters.arc===Math.PI*2?n=e.getClosedTorusIndicesForBooleanOrSubdiv():n=e.getIndex();let{positions:a,triIndices:o}=$w(e.getAttribute("position"),n),s;if(t&&r){let{indices:l,verticesPerFace:c}=LW(a,o,e);s=c.length,i=[];for(let u=0,d=0;u<s;u++){i.push(c[u]);for(let h=0;h<c[u];h++)i.push(l[d++])}}else{let l=o.length;i=Array(l+l/3),s=0;for(let c=0,u=0;u<i.length;)i[u++]=3,s++,i[u++]=o[c++],i[u++]=o[c++],i[u++]=o[c++]}return{positions:a,faceIndices:i,nFaces:s}}function FW(e){let t=e.length,r=t*Uint32Array.BYTES_PER_ELEMENT,i=t*Float32Array.BYTES_PER_ELEMENT,n=Number.isInteger(e[0])?r:i,a=yr._malloc(n);return(Number.isInteger(e[0])?new Uint32Array(yr.HEAPU32.buffer,a,t):new Float32Array(yr.HEAPF32.buffer,a,t)).set(e,0),a}function NW(e){switch(e){case 0:return yr.OP.UNION;case 1:return yr.OP.INTERSECTION;case 2:return yr.OP.A_MINUS_B;case 3:return yr.OP.B_MINUS_A;case 4:return yr.OP.SYMMETRIC_DIFFERENCE;case 5:return yr.OP.ALL;default:throw new Error("Unknown boolean operation "+e)}}function Bke(e,t){hp===void 0&&(hp=yr.init_csg());let r=FW(e),i=yr.csg_calc_topological(hp,r,e.length,NW(t));yr._free(r);let n=6,a=yr.HEAPU32.subarray(i>>2,(i>>2)+n),o=a.subarray(3,6),s=0,l=yr.HEAPU32[a[s]>>2],c=new Float32Array(yr.HEAPF32.subarray(l>>2,(l>>2)+o[s]));s++;let u=yr.HEAPU32[a[s]>>2],d=new Uint32Array(yr.HEAPU32.subarray(u>>2,(u>>2)+o[s]));s++;let h=yr.HEAPU32[a[s]>>2],f=new Uint8Array(yr.HEAPU32.subarray(h>>2,(h>>2)+o[s]));return yr.free_mesh_data(i),{positions:c,indices:d,verticesPerFace:f}}function Fke(e,t,r,i){hp===void 0&&(hp=yr.init_csg());let n=FW(e),a=yr.csg_calc(hp,n,e.length,i,NW(t));yr._free(n);let o=5,s=yr.HEAPU32.subarray(a>>2,(a>>2)+o),l=s.subarray(2,5),c=0,u=yr.HEAPU32[s[c]>>2],d=yr.HEAPF32.subarray(u>>2,(u>>2)+l[c]);c++;let h=yr.HEAPU32[s[c]>>2],f=yr.HEAPF32.subarray(h>>2,(h>>2)+l[c]);c++;let p=l[c];r.setAttribute("position",new yt(d,3)),r.setAttribute("normal",new yt(f,3));let v=yr.HEAPF32.subarray((a>>2)+5,(a>>2)+5+6);return r.boundingSphere===null&&(r.boundingSphere=new ao),r.boundingSphere.center.set(v[0],v[1],v[2]),r.boundingSphere.radius=(v[3]**2+v[4]**2+v[5]**2)**.5,r.userData.parameters={width:v[3]*2,height:v[4]*2,depth:v[5]*2},yr.free_mesh_data(a),p}function Nke(e,t,r){if(yr===void 0)return-1;let i,n,a;if(t&&e.userData.positions!==void 0){let m=e.userData;a=m.verticesPerFace.length,i=m.positions,n=Array(m.verticesPerFace.reduce((g,y)=>g+y,0)+a);for(let g=0,y=0,b=0;g<m.verticesPerFace.length;g++){n[b++]=m.verticesPerFace[g];for(let x=0;x<m.verticesPerFace[g];x++)n[b++]=m.indices[y++]}}else({positions:i,faceIndices:n,nFaces:a}=Lke(e,t,r));let o=i.length,s=n.length,l=i.length,c=n.length,u=l*Float32Array.BYTES_PER_ELEMENT+c*Uint32Array.BYTES_PER_ELEMENT,d=l*Float32Array.BYTES_PER_ELEMENT,h=yr._malloc(u),f=new Float32Array(yr.HEAPF32.buffer,h,l),p=new Uint32Array(yr.HEAPU32.buffer,h+d,c);f.set(i,0),p.set(n,0);let v=yr.get_csg_mesh(h,o,h+d,s,a);return yr._free(h),v}function Uke(e){return yr.has_open_edges(e)}function jke(e,t){yr.transform_csg_mesh(e,t.elements)}function Vke(e){yr.free_csg_mesh(e)}var Hke={ConeGeometry:lze,CubeGeometry:cze,CylinderGeometry:fW,DodecahedronGeometry:dze,EllipseGeometry:BD,HelixGeometry:Hze,IcosahedronGeometry:Wze,LatheGeometry:Gze,NonParametricGeometry:Zze,PolygonGeometry:DW,PyramidGeometry:Jze,RectangleGeometry:FD,SphereGeometry:rke,PlaneGeometry:ike,BackdropGeometry:nke,StarGeometry:OW,TextFrameGeometry:oke,TorusGeometry:ske,TorusKnotGeometry:cke,TriangleGeometry:uke,PathGeometry:Ake,VectorGeometry:Lh},XB=e=>Hke[e.type].create(e);function xf(e){return e!==null&&"booleanOp"in e}var UW=class extends OD(Oi){constructor(){super(...arguments),this.booleanMeshSetAddress=-1,this.booleanWasTransformed=!1,this.booleanMatrixInvOld=new it}updateVisible(e){super.updateVisible(e),this.visible=!xf(this.parent)&&this.visible,xf(this.parent)&&this.parent.invalidateDownstreamBooleanData()}freeBooleanPointer(){this.booleanMeshSetAddress!==-1&&(Wl.freeMeshSet(this.booleanMeshSetAddress),this.booleanMeshSetAddress=-1)}invalidateDownstreamBooleanData(e=!1){return e?this.booleanWasTransformed=!0:this.freeBooleanPointer(),xf(this.parent)?this.parent.invalidateDownstreamBooleanData():this}invalidateUpstreamBooleanData(){this.freeBooleanPointer();for(let e of this.children)e instanceof UW&&(e.freeBooleanPointer(),xf(e)&&e.invalidateUpstreamBooleanData())}updateTransformState(e,t){let r=super.updateTransformState(e,t);return r&&xf(this.parent)&&this.invalidateDownstreamBooleanData(!0),r}onVariableUpdate(e=!1){super.onVariableUpdate(e),xf(this.parent)&&this.invalidateDownstreamBooleanData(!0)}},ob=new Ji;function ND(e,t=0,r=e.count,i,n){let a=1/0,o=1/0,s=1/0,l=-1/0,c=-1/0,u=-1/0;for(let d=t;d<r;d++){let h=e.getX(d),f=e.getY(d),p=e.getZ(d);h<a&&(a=h),f<o&&(o=f),p<s&&(s=p),h>l&&(l=h),f>c&&(c=f),p>u&&(u=p)}ob.min.set(a,o,s),ob.max.set(l,c,u),ob.getCenter(i),ob.getSize(n).multiplyScalar(.5)}var Wke=new Ot,Gke=new hc,Fa=class extends UW{constructor(e,t){super(Wke,Gke),this.super_Entity(e,t)}updateState(e,t){this.updateState_Entity(e,t)}updateEntityBoxSize(e,t){let r=this.geometry.getAttribute("position");r!==void 0?ND(r,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:r.count,e,t):super.updateEntityBoxSize(e,t)}},nu=class{constructor(e){if(this.hashProperties=void 0,this.isNode=!0,this.shortcuts={},nu.uuidContext===null)throw new Error("plz startContext");nu.uuidContext===nu.globalContext?this.uuid="_gid"+nu.uuidContext.nodeContextUuid++:this.uuid="_uid"+nu.uuidContext.nodeContextUuid++,this.type=e,this.name=""}static startContext(e){this.uuidContext===null||this.uuidContext===nu.globalContext?this.uuidContext=e:console.error("Can't start context twice")}static endContext(e){this.uuidContext!==e&&console.error("Can't end context twice"),this.uuidContext=null}analyze(e,t){t=t??{},e.analyzing=!0,this.build(e.addFlow(t.slot,t.cache,t.context),"v4"),e.clearVertexNodeCode(),e.clearFragmentNodeCode(),e.removeFlow(),e.analyzing=!1}analyzeAndFlow(e,t,r){return r=r??{},this.analyze(e,r),this.flow(e,t,r)}flow(e,t,r){r=r??{},e.addFlow(r.slot,r.cache,r.context);let i={result:this.build(e,t),code:e.clearNodeCode(),extra:e.context.extra};return e.removeFlow(),i}build(e,t,r){t=t??this.getType(e,t);let i=e.getNodeData(r??this);return e.analyzing&&this.appendDepsNode(e,i,t),e.nodes.indexOf(this)===-1&&e.nodes.push(this),this.updateFrame!==void 0&&e.updaters.indexOf(this)===-1&&e.updaters.push(this),this.generate(e,t,r)}updateFrame(e){}generateReadonly(e,t,r,i,n,a){return""}generate(e,t,r,i,n){return""}parse(e,t,r,i){}appendDepsNode(e,t,r){t.deps=(t.deps||0)+1;let i=e.getTypeLength(r);(i>(t.outputMax||0)||this.getType(e,r))&&(t.outputMax=i,t.output=r)}setName(e){this.name=e}getName(){return this.name}getType(e,t){return t==="sampler2D"||t==="samplerCube"?t:this.type}},gn=nu;gn.globalContext={nodeContextUuid:0},gn.uuidContext=nu.globalContext;var KB=class{constructor(e){e=e??{},this.name=e.name,this.type=e.type,this.node=e.node,this.size=e.size,this.needsUpdate=e.needsUpdate}get value(){return this.node.value}set value(e){this.node.value=e}},$ke=class{constructor(){this.nodes={},this.keywords={}}add(e){this.nodes[e.name]=e}addKeyword(e,t,r){r=r!==void 0?r:!0,this.keywords[e]={callback:t,cache:r}}remove(e){delete this.nodes[e.name]}removeKeyword(e){delete this.keywords[e]}get(e){return this.nodes[e]}getKeyword(e,t){return this.keywords[e].callback(t)}getKeywordData(e){return this.keywords[e]}contains(e){return this.nodes[e]!==void 0}containsKeyword(e){return this.keywords[e]!==void 0}},Qa=new $ke,ni=class extends gn{constructor(e,t){super(e),this.scope="",t=t??{},this.shared=t.shared!==void 0?t.shared:!0,this.unique=t.unique!==void 0?t.unique:!1}build(e,t,r,i){if(t=t??this.getType(e),this.getShared(e,t)){let n=this.getUnique(e,t);n&&this.uuid===void 0&&(this.uuid=St.generateUUID()),r=e.getUUID(r??this.getUUID(),!n);let a=e.getNodeData(r),o=a.output||this.getType(e);if(e.analyzing)return(a.deps||0)>0||this.getLabel()?(this.appendDepsNode(e,a,t),this.generate(e,t,r)):super.build(e,t,r);if(n)return a.name=a.name||super.build(e,t,r),a.name;if(!this.getLabel()&&(!this.getShared(e,o)||e.context.ignoreCache||a.deps===1))return super.build(e,t,r);r=this.getUUID(!1);let s=this.getTemp(e,r);if(s)return e.format(s,o,t);{s=super.generate(e,t,r,a.output,i);let l=this.generate(e,o,r);return e.addNodeCode(s+" = "+l+";"),e.format(s,o,t)}}return super.build(e,t,r)}getShared(e,t){return t!=="sampler2D"&&t!=="samplerCube"&&this.shared}getUnique(e,t){return this.unique}setLabel(e){return this.label=e,this}getLabel(){return this.label}getUUID(e){let t=this.uuid;return typeof this.scope=="string"&&(t=this.scope+"-"+t),t}getTemp(e,t){t=t||this.uuid;let r=e.getVars()[t];return r?r.name:void 0}generate(e,t,r,i,n){return this.getShared(e,t)||console.error("TempNode is not shared"),r=r??this.uuid,e.getTempVar(r,i??this.getType(e),n,this.getLabel()).name}},so=class extends ni{constructor(e,t){t=t??{},t.shared=t.shared!==void 0?t.shared:!1,super(e,t),this.readonly=!1}setReadonly(e){return this.readonly=e,this.hashProperties=this.readonly?["value"]:void 0,this}getReadonly(){return this.readonly}generate(e,t,r,i,n,a){r=e.getUUID(r??this.getUUID()),i=i??this.getType(e);let o=e.getNodeData(r);return this.getReadonly()&&this.generateReadonly!==void 0?this.generateReadonly(e,t,r,i,n,a):e.isShader("vertex")?(o.vertex||(o.vertex=e.createVertexUniform(i,this,n,a,this.getLabel())),e.format(o.vertex.name,i,t)):(o.fragment||(o.fragment=e.createFragmentUniform(i,this,n,a,this.getLabel())),e.format(o.fragment.name,i,t))}},Zn=class extends so{constructor(e=0,t){super("v2"),this.nodeType="Vector2",this.value=e instanceof ye?e:new ye(e,t)}get x(){return this.value.x}set x(e){this.value.x=e}get y(){return this.value.y}set y(e){this.value.y=e}generateReadonly(e,t,r,i,n,a){return e.format("vec2("+this.value.x+", "+this.value.y+")",i,t)}},Eo=class extends so{constructor(e=0,t,r){super("v3"),this.nodeType="Vector3",this.value=e instanceof k?e:new k(e,t,r)}get x(){return this.value.x}set x(e){this.value.x=e}get y(){return this.value.y}set y(e){this.value.y=e}get z(){return this.value.z}set z(e){this.value.z=e}generateReadonly(e,t,r,i,n,a){return e.format("vec3("+this.value.x+", "+this.value.y+", "+this.value.z+")",i,t)}},sa=class extends Bt{constructor(e,t,r,i){super(e,t,r),this.isColorA=!0,this.a=i}setRGBA(e,t,r,i){super.setRGB(e,t,r),this.a=i}copy(e){return super.copy(e),this.a="a"in e?e.a:1,this}clone(){return new this.constructor(this.r,this.g,this.b,this.a)}equals(e){return super.equals(e)&&this.a===e.a}setStyle(e,t="srgb"){let r;if(e==="transparent")return this.setRGBA(0,0,0,0),this;if(r=/^((?:rgb|hsl)a?)\(([^)]*)\)/.exec(e)){let i,n=r[1],a=r[2];switch(n){case"rgb":case"rgba":if(i=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.a=n==="rgba"?parseFloat(i[4]):1,super.setStyle(e,t);break;case"hsl":case"hsla":if(i=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)%\s*,\s*(\d*\.?\d+)%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.a=n==="hsla"?parseFloat(i[4]):1,super.setStyle(e,t);break}}return super.setStyle(e,t)}get x(){return this.r}get y(){return this.g}get z(){return this.b}get w(){return this.a}set x(e){this.r=e}set y(e){this.g=e}set z(e){this.b=e}set w(e){this.a=e}},Gl=class extends so{constructor(e){super("v4"),this.nodeType="Vector4",this.value=e instanceof sa?e:new sa(e.r,e.g,e.b,e.a)}generateReadonly(e,t,r,i,n,a){return e.format("vec4("+this.value.r+", "+this.value.g+", "+this.value.b+", "+this.value.a+")",i,t)}},qke=/^\s*([a-z_0-9]+)\s([a-z_0-9]+)\s*\((.*?)\)/i,QB=/[a-z_0-9]+/gi,mt=class extends ni{constructor(e,t,r,i,n){super(n),this.src="",this.nodeType="Function",this.useKeywords=!0,this.includes=[],this.extensions={},this.keywords={},this.isMethod=n===void 0,this.isInterface=!1,this.parse(e,t,r,i)}getShared(e,t){return!this.isMethod}getType(e){return e.getTypeByFormat(this.type)}getInputByName(e){if(this.inputs){let t=this.inputs.length;for(;t--;)if(this.inputs[t].name===e)return this.inputs[t]}}getIncludeByName(e){if(this.includes){let t=this.includes.length;for(;t--;)if(this.includes[t].name===e)return this.includes[t]}}generate(e,t,r,i,n){let a,o=0,s=this.src;if(this.includes)for(let c=0;c<this.includes.length;c++)e.include(this.includes[c],this);for(let c in this.extensions)e.extensions[c]=!0;let l=[];for(;a=QB.exec(this.src);)l.push(a);for(let c=0;c<l.length;c++){let u=l[c],d=u[0],h=this.isMethod?!this.getInputByName(d):!0,f=d;if(this.keywords[d]||this.useKeywords&&h&&Qa.containsKeyword(d)){let p=this.keywords[d];if(!p){let v=Qa.getKeywordData(d);v.cache&&(p=e.keywords[d]),p=p||Qa.getKeyword(d,e),v.cache&&(e.keywords[d]=p)}f=p.build(e)}d!==f&&s[u.index+o-1]!=="."&&(s=s.substring(0,u.index+o)+f+s.substring(u.index+d.length+o),o+=f.length-d.length),this.getIncludeByName(f)===void 0&&Qa.contains(f)&&e.include(Qa.get(f))}return t==="source"?s:this.isMethod?(this.isInterface||e.include(this,void 0,s),this.name):e.format("( "+s+" )",this.getType(e),t)}parse(e,t,r,i){if(this.src=e||"",this.includes=t??[],this.extensions=r??{},this.keywords=i??{},this.isMethod){let n=qke.exec(this.src);if(this.inputs=[],n&&n.length==4){this.type=n[1],this.name=n[2];let a=n[3].match(QB);if(a){let o=0;for(;o<a.length;){let s=a[o++],l;s==="in"||s==="out"||s==="inout"?l=a[o++]:(l=s,s="");let c=a[o++];this.inputs.push({name:c,type:l,qualifier:s})}}this.isInterface=this.src.indexOf("{")===-1}else this.type="",this.name=""}}},Yke=/^([a-z_0-9]+)\s([a-z_0-9]+)\s?\=?\s?(.*?)(\;|$)/i,jW=class extends ni{constructor(e="",t){super(),this.src="",this.useDefine=!1,this.nodeType="Const",this.parse(e||jW.PI,void 0,void 0,void 0,t)}getType(e){return e.getTypeByFormat(this.type)}parse(e,t,r,i,n){this.src=e||"";let a,o,s="",l=Yke.exec(e);this.useDefine=n??this.src.charAt(0)==="#",l&&l.length>1?(o=l[1],a=l[2],s=l[3]):(a=this.src,o="f"),this.name=a,this.type=o,this.value=s}build(e,t){if(t==="source"){if(this.value)return this.useDefine?"#define "+this.name+" "+this.value:"const "+this.type+" "+this.name+" = "+this.value+";";if(this.useDefine)return this.src}return e.include(this),e.format(this.name,this.getType(e),t)}generate(e,t,r,i,n){return e.format(this.name,this.getType(e),t)}},Qr=jW;Qr.PI="PI",Qr.PI2="PI2",Qr.RECIPROCAL_PI="RECIPROCAL_PI",Qr.RECIPROCAL_PI2="RECIPROCAL_PI2",Qr.LOG2="LOG2",Qr.EPSILON="EPSILON";var Xke=new RegExp(`^structs*([a-z_0-9]+)s*{s*((.|
)*?)}`,"gim"),Kke=new RegExp("s*(w*?)s*(w*?)(=|;)","gim"),VW=class extends ni{constructor(e=""){super(),this.inputs=[],this.src="",this.nodeType="Struct",this.parse(e)}getType(e){return e.getTypeByFormat(this.name)}getInputByName(e){let t=this.inputs.length;for(;t--;)if(this.inputs[t].name===e)return this.inputs[t]}generate(e,t,r,i,n){return t==="source"?this.src+";":e.format("( "+this.src+" )",this.getType(e),t)}parse(e=""){this.src=e,this.inputs=[];let t=Xke.exec(e);if(t){let r=t[2],i;for(;i=Kke.exec(r);)this.inputs.push({type:i[1],name:i[2]});this.name=t[1]}else this.name="";this.type=this.name}},UD=class extends ni{constructor(e){super("v2",{shared:!1}),this.nodeType="UV",this.index=e??0}generate(e,t){e.requires.uv[this.index]=!0;let r=this.index>0?this.index+1:"",i=e.isShader("vertex")?"uv"+r:"vUv"+r;return e.format(i,this.getType(e),t)}};Qa.addKeyword("uv",function(){return new UD});Qa.addKeyword("uv2",function(){return new UD(1)});var Lf=class extends ni{constructor(e,t){super("v4"),this.nodeType="ColorSpace",this.input=e,this.method=t??Lf.LINEAR_TO_LINEAR,this.hashProperties=["method"]}static getEncodingComponents(e){switch(e){case xs:return["Linear"];case lr:return["sRGB"];default:return[]}}generate(e,t){var o;let r=this.input.build(e,"v4"),i=this.getType(e),n=Lf.Nodes[this.method],a=e.include(n);if(a===Lf.LINEAR_TO_LINEAR)return e.format(r,i,t);if(((o=n.inputs)==null?void 0:o.length)===2){let s=this.factor.build(e,"f");return e.format(a+"( "+r+", "+s+" )",i,t)}else return e.format(a+"( "+r+" )",i,t)}fromEncoding(e){let t=Lf.getEncodingComponents(e);this.method="LinearTo"+t[0],this.factor=t[1]}fromDecoding(e){let t=Lf.getEncodingComponents(e);this.method=t[0]+"ToLinear",this.factor=t[1]}},tl=Lf;tl.Nodes={LinearToLinear:new mt(["vec4 LinearToLinear( in vec4 value ) {","	return value;","}"].join(`
`)),sRGBToLinear:new mt(["vec4 sRGBToLinear( in vec4 value ) {","	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );","}"].join(`
`)),LinearTosRGB:new mt(["vec4 LinearTosRGB( in vec4 value ) {","	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );","}"].join(`
`))},tl.LINEAR_TO_LINEAR="LinearToLinear",tl.SRGB_TO_LINEAR="sRGBToLinear",tl.LINEAR_TO_SRGB="LinearTosRGB";var mi=class extends mt{constructor(e="",t,r,i,n){super(e,n,i,r,t),this.nodeType="Expression"}},Ql=class extends so{constructor(e=new Ri,t,r,i){super("v4",{shared:!0}),this.nodeType="Texture",this.value=e,this.uv=t??new UD,this.bias=r,this.project=i!==void 0?i:!1}getTexture(e,t){return super.generate(e,t,this.value.uuid,"t")}generate(e,t){if(t==="sampler2D")return this.getTexture(e,t);let r=this.getTexture(e,t),i=this.uv.build(e,this.project?"v4":"v2"),n=this.bias?this.bias.build(e,"f"):void 0;n===void 0&&e.context.bias&&(n=e.context.bias.setTexture(this).build(e,"f"));let a,o;this.project?a="texture2DProj":a=n?"tex2DBias":"tex2D",n?o=a+"( "+r+", "+i+", "+n+" )":o=a+"( "+r+", "+i+" )";let s={include:e.isShader("vertex"),ignoreCache:!0},l=this.getType(e);return e.addContext(s),this.colorSpace=this.colorSpace??new tl(new mi("",l)),this.colorSpace.fromDecoding(e.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(o),o=this.colorSpace.build(e,l),e.removeContext(),e.format(o,l,t)}},Ct=class extends so{constructor(e){super("f"),this.nodeType="Float",this.value=e??0}generateReadonly(e,t,r,i,n,a){return e.format(this.value+(this.value%1?"":".0"),i,t)}},ZB=class extends ni{constructor(e,t){super(),this.inputs=[],this.nodeType="FunctionCall",this.value=e,this.inputs=t??[]}getFunction(){return this.value}getType(e){return this.value.getType(e)}generate(e,t,r,i,n){i=this.getType(e);let a=this.value,o=a.build(e,t)+"( ",s=[];if(a.inputs){for(let l=0;l<a.inputs.length;l++){let c=a.inputs[l],u=this.inputs[l]||this.inputs[c.name];s.push(u.build(e,e.getTypeByFormat(c.type)))}o+=s.join(", ")+" )"}return e.format(o,i,t)}},HW=class extends ni{constructor(e,t,r=HW.ADD){super(),this.nodeType="Operator",this.type=e.type,this.a=e,this.b=t,this.op=r}getType(e){let t=this.a.getType(e),r=this.b.getType(e);return e.isTypeMatrix(t)?"v4":e.getTypeLength(r)>e.getTypeLength(t)?r:t}generate(e,t){let r=this.getType(e);this.type=r;let i=this.a.build(e,r),n=this.b.build(e,r);return e.format("( "+i+" "+this.op+" "+n+" )",r,t)}},$a=HW;$a.ADD="+",$a.SUB="-",$a.MUL="*",$a.DIV="/";var Kr=class extends ni{constructor(e,t=Kr.ABS,r,i){super(),this.nodeType="Math",this.a=e,typeof t!="string"?this.b=t:i=t,typeof r!="string"?this.c=r:i=r,this.method=i,this.hashProperties=["method"]}getNumInputs(e){switch(this.method){case Kr.MIX:case Kr.CLAMP:case Kr.REFRACT:case Kr.SMOOTHSTEP:case Kr.FACEFORWARD:return 3;case Kr.MIN:case Kr.MAX:case Kr.MOD:case Kr.STEP:case Kr.REFLECT:case Kr.DISTANCE:case Kr.DOT:case Kr.CROSS:case Kr.POW:return 2;default:return 1}}getInputType(e){let t=e.getTypeLength(this.a.getType(e)),r=this.b?e.getTypeLength(this.b.getType(e)):0,i=this.c?e.getTypeLength(this.c.getType(e)):0;return t>r&&t>i?this.a.getType(e):r>i?this.b.getType(e):this.c.getType(e)}getType(e){switch(this.method){case Kr.LENGTH:case Kr.DISTANCE:case Kr.DOT:return"f";case Kr.CROSS:return"v3"}return this.getInputType(e)}generate(e,t){let r,i,n,a=this.a?e.getTypeLength(this.a.getType(e)):0,o=this.b?e.getTypeLength(this.b.getType(e)):0,s=this.c?e.getTypeLength(this.c.getType(e)):0,l=this.getInputType(e),c=this.getType(e);switch(this.type=c,this.method){case Kr.NEGATE:return e.format("( -"+this.a.build(e,l)+" )",l,t);case Kr.INVERT:return e.format("( 1.0 - "+this.a.build(e,l)+" )",l,t);case Kr.CROSS:r=this.a.build(e,"v3"),i=this.b.build(e,"v3");break;case Kr.STEP:r=this.a.build(e,a===1?"f":l),i=this.b.build(e,l);break;case Kr.MIN:case Kr.MAX:case Kr.MOD:r=this.a.build(e,l),i=this.b.build(e,o===1?"f":l);break;case Kr.REFRACT:r=this.a.build(e,l),i=this.b.build(e,l),n=this.c.build(e,"f");break;case Kr.MIX:r=this.a.build(e,l),i=this.b.build(e,l),n=this.c.build(e,s===1?"f":l);break;default:r=this.a.build(e,l),this.b&&(i=this.b.build(e,l)),this.c&&(n=this.c.build(e,l));break}let u=[];u.push(r),i&&u.push(i),n&&u.push(n);let d=this.getNumInputs(e);if(u.length!==d)throw Error(`Arguments not match used in "${this.method}". Require ${d}, currently ${u.length}.`);return e.format(this.method+"( "+u.join(", ")+" )",c,t)}},or=Kr;or.RAD="radians",or.DEG="degrees",or.EXP="exp",or.EXP2="exp2",or.LOG="log",or.LOG2="log2",or.SQRT="sqrt",or.INV_SQRT="inversesqrt",or.FLOOR="floor",or.CEIL="ceil",or.NORMALIZE="normalize",or.FRACT="fract",or.SATURATE="saturate",or.SIN="sin",or.COS="cos",or.TAN="tan",or.ASIN="asin",or.ACOS="acos",or.ARCTAN="atan",or.ABS="abs",or.SIGN="sign",or.LENGTH="length",or.NEGATE="negate",or.INVERT="invert",or.MIN="min",or.MAX="max",or.MOD="mod",or.STEP="step",or.REFLECT="reflect",or.DISTANCE="distance",or.DOT="dot",or.CROSS="cross",or.POW="pow",or.MIX="mix",or.CLAMP="clamp",or.REFRACT="refract",or.SMOOTHSTEP="smoothstep",or.FACEFORWARD="faceforward";var Cv=class extends ni{constructor(e,t,r){super("v4"),this.nodeType="TextureCubeUV",this.value=e,this.uv=t,this.bias=r}bilinearCubeUV(e,t,r,i){let n=new ZB(Cv.Nodes.bilinearCubeUV,[t,r,i]);this.colorSpaceTL=this.colorSpaceTL??new tl(new mi("","v4")),this.colorSpaceTL.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceTL.input.parse(n.build(e)+".tl"),this.colorSpaceTR=this.colorSpaceTR??new tl(new mi("","v4")),this.colorSpaceTR.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceTR.input.parse(n.build(e)+".tr"),this.colorSpaceBL=this.colorSpaceBL??new tl(new mi("","v4")),this.colorSpaceBL.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceBL.input.parse(n.build(e)+".bl"),this.colorSpaceBR=this.colorSpaceBR??new tl(new mi("","v4")),this.colorSpaceBR.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceBR.input.parse(n.build(e)+".br");let a={include:e.isShader("vertex"),ignoreCache:!0};e.addContext(a),this.colorSpaceTLExp=new mi(this.colorSpaceTL.build(e,"v4"),"v4"),this.colorSpaceTRExp=new mi(this.colorSpaceTR.build(e,"v4"),"v4"),this.colorSpaceBLExp=new mi(this.colorSpaceBL.build(e,"v4"),"v4"),this.colorSpaceBRExp=new mi(this.colorSpaceBR.build(e,"v4"),"v4"),e.removeContext();let o=new mi("mix( mix( cubeUV_TL, cubeUV_TR, cubeUV.f.x ), mix( cubeUV_BL, cubeUV_BR, cubeUV.f.x ), cubeUV.f.y )","v4");return o.keywords.cubeUV_TL=this.colorSpaceTLExp,o.keywords.cubeUV_TR=this.colorSpaceTRExp,o.keywords.cubeUV_BL=this.colorSpaceBLExp,o.keywords.cubeUV_BR=this.colorSpaceBRExp,o.keywords.cubeUV=n,o}generate(e,t){if(e.isShader("fragment")){let r=this.uv,i=this.bias||e.context.roughness,n=new ZB(Cv.Nodes.roughnessToMip,[i]),a=new or(n,Cv.Nodes.m0,Cv.Nodes.cubeUV_maxMipLevel,or.CLAMP),o=new or(a,or.FLOOR),s=new or(a,or.FRACT),l=this.bilinearCubeUV(e,this.value,r,o),c=this.bilinearCubeUV(e,this.value,r,new $a(o,new Ct(1).setReadonly(!0),$a.ADD)),u=new or(l,c,s,or.MIX);return e.format(u.build(e),"v4",t)}else return console.warn("TextureCubeUVNode is not compatible with "+e.shader+" shader."),e.format("vec4( 0.0 )",this.getType(e),t)}},OE=Cv;OE.Nodes=function(){let e=new VW(`struct TextureCubeUVData {
			vec4 tl;
			vec4 tr;
			vec4 br;
			vec4 bl;
			vec2 f;
		}`),t=new Qr("float cubeUV_maxMipLevel 8.0",!0),r=new Qr("float cubeUV_minMipLevel 4.0",!0),i=new Qr("float cubeUV_maxTileSize 256.0",!0),n=new Qr("float cubeUV_minTileSize 16.0",!0),a=new mt(`float getFace(vec3 direction) {
				vec3 absDirection = abs(direction);
				float face = -1.0;
				if (absDirection.x > absDirection.z) {
					if (absDirection.x > absDirection.y)
						face = direction.x > 0.0 ? 0.0 : 3.0;
					else
						face = direction.y > 0.0 ? 1.0 : 4.0;
				} else {
					if (absDirection.z > absDirection.y)
						face = direction.z > 0.0 ? 2.0 : 5.0;
					else
						face = direction.y > 0.0 ? 1.0 : 4.0;
				}
				return face;
		}`);a.useKeywords=!1;let o=new mt(`vec2 getUV(vec3 direction, float face) {
				vec2 uv;
				if (face == 0.0) {
					uv = vec2(direction.z, direction.y) / abs(direction.x); // pos x
				} else if (face == 1.0) {
					uv = vec2(-direction.x, -direction.z) / abs(direction.y); // pos y
				} else if (face == 2.0) {
					uv = vec2(-direction.x, direction.y) / abs(direction.z); // pos z
				} else if (face == 3.0) {
					uv = vec2(-direction.z, direction.y) / abs(direction.x); // neg x
				} else if (face == 4.0) {
					uv = vec2(-direction.x, direction.z) / abs(direction.y); // neg y
				} else {
					uv = vec2(direction.x, direction.y) / abs(direction.z); // neg z
				}
				return 0.5 * (uv + 1.0);
		}`);o.useKeywords=!1;let s=new mt(`TextureCubeUVData bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {
			float face = getFace(direction);
			float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);
			mipInt = max(mipInt, cubeUV_minMipLevel);
			float faceSize = exp2(mipInt);
			float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);
			vec2 uv = getUV(direction, face) * (faceSize - 1.0);
			vec2 f = fract(uv);
			uv += 0.5 - f;
			if (face > 2.0) {
				uv.y += faceSize;
				face -= 3.0;
			}
			uv.x += face * faceSize;
			if(mipInt < cubeUV_maxMipLevel){
				uv.y += 2.0 * cubeUV_maxTileSize;
			}
			uv.y += filterInt * 2.0 * cubeUV_minTileSize;
			uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);
			uv *= texelSize;
			vec4 tl = texture2D(envMap, uv);
			uv.x += texelSize;
			vec4 tr = texture2D(envMap, uv);
			uv.y += texelSize;
			vec4 br = texture2D(envMap, uv);
			uv.x -= texelSize;
			vec4 bl = texture2D(envMap, uv);
			return TextureCubeUVData( tl, tr, br, bl, f );
		}`,[e,a,o,t,r,i,n]);s.useKeywords=!1;let l=new Qr("float r0 1.0",!0),c=new Qr("float v0 0.339",!0),u=new Qr("float m0 -2.0",!0),d=new Qr("float r1 0.8",!0),h=new Qr("float v1 0.276",!0),f=new Qr("float m1 -1.0",!0),p=new Qr("float r4 0.4",!0),v=new Qr("float v4 0.046",!0),m=new Qr("float m4 2.0",!0),g=new Qr("float r5 0.305",!0),y=new Qr("float v5 0.016",!0),b=new Qr("float m5 3.0",!0),x=new Qr("float r6 0.21",!0),S=new Qr("float v6 0.0038",!0),w=new Qr("float m6 4.0",!0),_=[l,c,u,d,h,f,p,v,m,g,y,b,x,S,w],C=new mt(`float roughnessToMip(float roughness) {
			float mip = 0.0;
			if (roughness >= r1) {
				mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;
			} else if (roughness >= r4) {
				mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;
			} else if (roughness >= r5) {
				mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;
			} else if (roughness >= r6) {
				mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;
			} else {
				mip = -2.0 * log2(1.16 * roughness);// 1.16 = 1.79^0.25
			}
			return mip;
		}`,_);return{bilinearCubeUV:s,roughnessToMip:C,m0:u,cubeUV_maxMipLevel:t}}();var Bf=class extends ni{constructor(e){super("v3"),this.nodeType="Normal",this.scope=e??Bf.VIEW}getShared(){return this.scope===Bf.WORLD}build(e,t,r,i){let n=e.context[this.scope+"Normal"];return n?n.build(e,t,r,i):super.build(e,t,r)}generate(e,t,r,i,n){let a;switch(this.scope){case Bf.VIEW:e.isShader("vertex")?a="transformedNormal":a="geometryNormal";break;case Bf.LOCAL:e.isShader("vertex")?a="objectNormal":(e.requires.normal=!0,a="vObjectNormal");break;case Bf.WORLD:e.isShader("vertex")?a="inverseTransformDirection( transformedNormal, viewMatrix ).xyz":(e.requires.worldNormal=!0,a="vWNormal");break}return e.format(a,this.getType(e),t)}},Ja=Bf;Ja.LOCAL="local",Ja.WORLD="world",Ja.VIEW="view",Ja.NORMAL="normal";Qa.addKeyword("viewNormal",function(){return new Ja(Ja.VIEW)});Qa.addKeyword("localNormal",function(){return new Ja(Ja.NORMAL)});Qa.addKeyword("worldNormal",function(){return new Ja(Ja.WORLD)});var Ul=class extends ni{constructor(e){super("v3"),this.nodeType="Position",this.scope=e??Ul.LOCAL}getType(){switch(this.scope){case Ul.PROJECTION:return"v4"}return this.type}getShader(){switch(this.scope){case Ul.LOCAL:case Ul.WORLD:return!1}return!0}generate(e,t,r,i,n){let a;switch(this.scope){case Ul.LOCAL:e.isShader("vertex")?a="transformed":(e.requires.position=!0,a="vPosition");break;case Ul.WORLD:if(e.isShader("vertex"))return"( modelMatrix * vec4( transformed, 1.0 ) ).xyz";e.requires.worldPosition=!0,a="vWPosition";break;case Ul.VIEW:a=e.isShader("vertex")?"-mvPosition.xyz":"vViewPosition";break;case Ul.PROJECTION:a=e.isShader("vertex")?"( projectionMatrix * modelViewMatrix * vec4( position, 1.0 ) )":"vec4( 0.0 )";break}return e.format(a,this.getType(),t)}},us=Ul;us.LOCAL="local",us.WORLD="world",us.VIEW="view",us.PROJECTION="projection";Qa.addKeyword("position",function(){return new us});Qa.addKeyword("worldPosition",function(){return new us(us.WORLD)});Qa.addKeyword("viewPosition",function(){return new us(us.VIEW)});var Vs=class extends ni{constructor(e){super("v3"),this.nodeType="Reflect",this.scope=e??Vs.CUBE}getUnique(e){return!e.context.viewNormal}getType(){switch(this.scope){case Vs.SPHERE:return"v2"}return this.type}generate(e,t){let r=this.getUnique(e);if(e.isShader("fragment")){let i;switch(this.scope){case Vs.VECTOR:{let n=new Ja(Ja.VIEW),a=e.context.roughness,o=n.build(e,"v3"),s=new us(us.VIEW).build(e,"v3"),l=a?a.build(e,"f"):void 0,c=`reflect( -normalize( ${s} ), ${o} )`;l&&(c=`normalize( mix( ${c}, ${o}, ${l} * ${l} ) )`);let u=`inverseTransformDirection( ${c}, viewMatrix )`;r?(e.addNodeCode(`vec3 reflectVec = ${u};`),i="reflectVec"):i=u;break}case Vs.CUBE:{let n=new Vs(Vs.VECTOR).build(e,"v3"),a="vec3( -"+n+".x, "+n+".yz )";r?(e.addNodeCode(`vec3 reflectCubeVec = ${a};`),i="reflectCubeVec"):i=a;break}case Vs.SPHERE:{let n="normalize( ( viewMatrix * vec4( "+new Vs(Vs.VECTOR).build(e,"v3")+", 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) ).xy * 0.5 + 0.5";r?(e.addNodeCode(`vec2 reflectSphereVec = ${n};`),i="reflectSphereVec"):i=n;break}}return e.format(i,this.getType(),t)}else return console.warn("ReflectNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.type,t)}},fp=Vs;fp.CUBE="cube",fp.SPHERE="sphere",fp.VECTOR="vector";var Qke=class extends ni{constructor(e=new Ql,t,r){super("v4"),this.nodeType="TextureCube",this.value=e,this.radianceNode=new OE(this.value,t??new fp(fp.VECTOR),r),this.irradianceNode=new OE(this.value,new Ja(Ja.WORLD),new Ct(1).setReadonly(!0))}generate(e,t){return e.isShader("fragment")?(e.require("irradiance"),e.context.bias&&e.context.bias.setTexture(this.value),(e.slot==="irradiance"?this.irradianceNode:this.radianceNode).build(e,t)):(console.warn("TextureCubeNode is not compatible with "+e.shader+" shader."),e.format("vec4( 0.0 )",this.getType(e),t))}},Zke=class extends so{constructor(e=new HP,t,r){super("v4",{shared:!0}),this.nodeType="CubeTexture",this.value=e,this.uv=t??new fp,this.bias=r}getTexture(e,t){return super.generate(e,t,this.value.uuid,"tc")}generate(e,t){var l;if(t==="samplerCube")return this.getTexture(e,t);let r=this.getTexture(e,t),i=(l=this.uv)==null?void 0:l.build(e,"v3"),n=this.bias?this.bias.build(e,"f"):void 0;n===void 0&&e.context.bias&&(n=e.context.bias.setTexture(this).build(e,"f"));let a;n?a="texCubeBias( "+r+", "+i+", "+n+" )":a="texCube( "+r+", "+i+" )";let o={include:e.isShader("vertex"),ignoreCache:!0},s=this.getType(e);return e.addContext(o),this.colorSpace=this.colorSpace??new tl(new mi("",s)),this.colorSpace.fromDecoding(e.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(a),a=this.colorSpace.build(e,s),e.removeContext(),e.format(a,s,t)}},Jke=`
uniform int frameIndex;
uniform vec2 resolution;
uniform mat4 previousModelViewMatrix;
uniform mat4 previousProjectionMatrix;

varying vec4 vCurrentPosition;
varying vec4 vPreviousPosition;
`,eLe=`
layout(location = 1) out vec4 gVelocity;

uniform int frameIndex;
uniform vec2 resolution;

varying vec4 vCurrentPosition;
varying vec4 vPreviousPosition;

const vec2 haltonSequence[16] = vec2[16](
vec2( 0.000000,-0.333334),
vec2(-0.500000, 0.333334),
vec2( 0.500000,-0.777778),
vec2(-0.750000,-0.111112),
vec2( 0.250000, 0.555556),
vec2(-0.250000,-0.555556),
vec2( 0.750000, 0.111112),
vec2(-0.875000, 0.777778),
vec2(0.125000, -0.925926),
vec2(-0.375000, -0.259260),
vec2(0.625000, 0.407408),
vec2(-0.625000, -0.703704),
vec2(0.375000, -0.037038),
vec2(-0.125000, 0.629630),
vec2(0.875000, -0.481482),
vec2(-0.937500, 0.185186));

vec2 vogelDiskSample(int sampleIndex, int sampleCount, float angle) {
  const float goldenAngle = 2.399963f; // radians
  float r = sqrt(float(sampleIndex) + 0.5f) / sqrt(float(sampleCount));
  float theta = float(sampleIndex) * goldenAngle + angle;
  float sine = sin(theta);
  float cosine = cos(theta);
  return vec2(cosine, sine) * r;
}

// Derived from the interleaved gradient function from Jimenez 2014 http:goo.gl/eomGso
float getNoiseInterleavedGradient(vec2 screenPos) {
    vec3 magic = vec3(0.06711056f, 0.00583715f, 52.9829189f);
    return fract(magic.z * fract(dot(screenPos, magic.xy)));
}

`,tLe=`
// TODO: This could be generated CPU side and passed to the shader every frame
const vec2 haltonSequence[16] = vec2[16](
vec2( 0.000000,-0.333334),
vec2(-0.500000, 0.333334),
vec2( 0.500000,-0.777778),
vec2(-0.750000,-0.111112),
vec2( 0.250000, 0.555556),
vec2(-0.250000,-0.555556),
vec2( 0.750000, 0.111112),
vec2(-0.875000, 0.777778),
vec2(0.125000, -0.925926),
vec2(-0.375000, -0.259260),
vec2(0.625000, 0.407408),
vec2(-0.625000, -0.703704),
vec2(0.375000, -0.037038),
vec2(-0.125000, 0.629630),
vec2(0.875000, -0.481482),
vec2(-0.937500, 0.185186));

// TODO: Pass correct view size
vec2 offset = haltonSequence[frameIndex];
offset.x /= resolution.x;
offset.y /= resolution.y;

vec4 currentPosition = gl_Position;
vec4 currentPositionJittered = currentPosition + (vec4(offset.x, offset.y, 0.0, 0.0) * currentPosition.w);

// We want to calculate the velocity with unjittered positions
// so that things that are not moving get a velocity = 0
vCurrentPosition = currentPosition;
vPreviousPosition = previousProjectionMatrix * previousModelViewMatrix * vec4(transformed, 1.0);
#ifdef OUTLINE_COMPENSATION
vPreviousPosition.xy += OUTLINE_COMPENSATION;
#endif
gl_Position = currentPositionJittered;

`,rLe=`
vec2 oldPos = vPreviousPosition.xy;
    oldPos /= vPreviousPosition.w;
    oldPos.xy = (oldPos.xy+1.)/2.0;

vec2 newPos = vCurrentPosition.xy;
    newPos /= vCurrentPosition.w;
    newPos.xy = (newPos.xy+1.)/2.0;

vec2 velocity = (newPos - oldPos);

// Discard fully transparent pixels 
if (gl_FragColor.a <= 0.0) discard;

gVelocity = vec4(velocity, 0.0, 1.0);
`,iLe=`
layout(location = 1) out vec4 gVelocity;
`,nLe=`
    // Discard fully transparent pixels 
    if (gl_FragColor.a <= 0.0) discard;

    gVelocity = vec4(0.0, 0.0, 0.0, 1.0);
`,JB=["x","y","z","w"],aLe=["float","vec2","vec3","vec4"],oLe={float:"f",vec2:"v2",vec3:"v3",vec4:"v4",mat4:"v4",int:"i",bool:"b","float[]":"f[]","vec4[]":"v4[]"},sLe={t:"sampler2D",tc:"samplerCube",b:"bool",i:"int",f:"float",c:"vec3",v2:"vec2",v3:"vec3",v4:"vec4",m3:"mat3",m4:"mat4","f[]":"float[]","v4[]":"vec4[]"},WW=class{constructor(){this.includes={consts:{},functions:{},structs:{}},this.cache="",this.slot="",this.shader="",this.context={},this.needsJitter=!0,this.getIncludesCode=function(){function e(t,r){return t.deps.length-r.deps.length}return function(t,r){let i=this.getIncludes(t,r);if(!i)return"";let n="";i=i.sort(e);for(let a=0;a<i.length;a++)i[a].src&&(n+=i[a].src+`
`);return n}}(),this.slots=[],this.caches=[],this.contexts=[],this.keywords={},this.nodeData={},this.fragmentVariables={},this.fragmentParsVariables={},this.vertexParsVariables={},this.requires={uv:[],color:[],transparent:!1,irradiance:!1,position:!1,worldPosition:!1,normal:!1,worldNormal:!1,vWorldViewDir:!1,modelMatrix:!1,viewMatrix:!1,projectionMatrix:!1},this.includes={consts:[],functions:[],structs:[]},this.attributes={},this.prefixCode=["#ifdef TEXTURE_LOD_EXT","	#define texCube(a, b) textureCube(a, b)","	#define texCubeBias(a, b, c) textureCubeLodEXT(a, b, c)","	#define tex2D(a, b) texture2D(a, b)","	#define tex2DBias(a, b, c) texture2DLodEXT(a, b, c)","#else","	#define texCube(a, b) textureCube(a, b)","	#define texCubeBias(a, b, c) textureCube(a, b, c)","	#define tex2D(a, b) texture2D(a, b)","	#define tex2DBias(a, b, c) texture2D(a, b, c)","#endif",`
			// NOTE: Include Spline's blending modes. This could be part of BlendNode
			#define SPE_BLENDING_NORMAL 0
			#define SPE_BLENDING_MULTIPLY 1
			#define SPE_BLENDING_SCREEN 2
			#define SPE_BLENDING_OVERLAY 3

			vec3 spe_normalBlend( vec3 a, vec3 b, float alpha ) {
				return mix( a, b, alpha );
			}

			vec3 spe_multiplyBlend( vec3 a, vec3 b, float alpha ) {
				return mix( a, a * b, alpha );
			}

			vec3 spe_screenBlend( vec3 a, vec3 b, float alpha ) {
				vec3 tmp = 1.0 - ( 1.0 - a ) * ( 1.0 - b );
				return mix( a, tmp, alpha );
			}

			vec3 spe_overlayBlend( vec3 a, vec3 b, float alpha ) {
				vec3 tmp = mix( 1. - 2. * (1. - a) * (1. - b), 2. * a * b, step( a, vec3(.5) ) );
				return clamp( mix( a, tmp, alpha ), 0.0, 1.0 );
			}

			vec3 spe_blend( vec3 a, vec3 b, float alpha, int mode ) {
				if ( mode == SPE_BLENDING_NORMAL ) return spe_normalBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_MULTIPLY ) return spe_multiplyBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_SCREEN ) return spe_screenBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_OVERLAY ) return spe_overlayBlend( a, b, alpha );
				return vec3( 1.0 );
			}
			`,"#include <packing>","#include <common>"].join(`
`),this.parsCode={vertex:["float neighbor_offset = 0.0001;",""].join(`
`),fragment:["float accumAlpha = 0.0;",`void accumulateAlpha(float alpha) {
					accumAlpha += (1.0 - accumAlpha) * alpha;
				}`,""].join(`
`)},this.code={vertex:"",fragment:""},this.nodeCode={vertex:"",fragment:""},this.resultCode={vertex:"",fragment:""},this.finalCode={vertex:"",fragment:""},this.inputs={uniforms:{list:[],vertex:[],fragment:[]},arrayUniforms:{list:[],vertex:[],fragment:[]},vars:{varying:[],vertex:[],fragment:[]}},this.defines={},this.uniforms={},this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.updaters=[],this.nodes=[],this.analyzing=!1}build(e,t){this.addVertexParsCode(Jke),this.addFragmentParsCode(eLe),this.buildShader("vertex",e),this.buildShader("fragment",t);for(let r=0;r<this.requires.uv.length;r++)if(this.requires.uv[r]){let i=r>0?r+1:"";this.addVaryCode("varying vec2 vUv"+i+";"),r>0&&this.addVertexParsCode("attribute vec2 uv"+i+";"),this.addVertexFinalCode("vUv"+i+" = uv"+i+";")}return this.requires.color[0]&&(this.addVaryCode("varying vec4 vColor;"),this.addVertexParsCode("attribute vec4 color;"),this.addVertexFinalCode("vColor = color;")),this.requires.color[1]&&(this.addVaryCode("varying vec4 vColor2;"),this.addVertexParsCode("attribute vec4 color2;"),this.addVertexFinalCode("vColor2 = color2;")),this.requires.position&&(this.addVaryCode("varying vec3 vPosition;"),this.addVertexFinalCode("vPosition = transformed;")),this.requires.worldPosition,this.requires.normal&&(this.addVaryCode("varying vec3 vObjectNormal;"),this.addVertexFinalCode("vObjectNormal = normal;")),this.requires.modelMatrix&&this.addFragmentParsCode("uniform mat4 modelMatrix;"),this.requires.viewMatrix&&this.addFragmentParsCode("uniform mat4 viewMatrix;"),this.requires.projectionMatrix&&this.addFragmentParsCode("uniform mat4 projectionMatrix;"),this.requires.worldNormal&&(this.addVaryCode("varying vec3 vWNormal;"),this.addVertexFinalCode("vWNormal = inverseTransformDirection( transformedNormal, viewMatrix ).xyz;")),this.requires.vWorldViewDir&&(this.addVaryCode("varying vec3 vWorldViewDir;"),this.addVertexFinalCode("vWorldViewDir = isPerspectiveMatrix( projectionMatrix ) ?  ( (modelMatrix * vec4(position, 1.0)).xyz - cameraPosition ) : vec3( -viewMatrix[0][2], -viewMatrix[1][2], -viewMatrix[2][2] );")),this.needsJitter&&(this.addVertexFinalCode(tLe),this.addFragmentFinalCode(rLe)),this}buildShader(e,t){this.resultCode[e]=t.build(this.setShader(e),"v4")}setMaterial(e,t){return this.defines={},this}addFlow(e,t,r){return this.addSlot(e).addCache(t).addContext(r)}removeFlow(){return this.removeSlot().removeCache().removeContext()}addCache(e){return this.cache=e??"",this.caches.push(this.cache),this}removeCache(){return this.caches.pop(),this.cache=this.caches[this.caches.length-1]||"",this}addContext(e){return this.context=Object.assign({},this.context,e),this.context.extra=this.context.extra||{},this.contexts.push(this.context),this}removeContext(){return this.contexts.pop(),this.context=this.contexts[this.contexts.length-1]||{},this}addSlot(e){return this.slot=e||"",this.slots.push(this.slot),this}removeSlot(){return this.slots.pop(),this.slot=this.slots[this.slots.length-1]||"",this}addFragmentVariable(e,t){this.fragmentVariables[e]===void 0&&(this.addFragmentCode(`${t} ${e};`),this.fragmentVariables[e]="")}addFragmentParsVariable(e,t){this.fragmentParsVariables[e]===void 0&&(this.addFragmentParsCode(`${t} ${e};`),this.fragmentParsVariables[e]="")}addVertexParsVariable(e,t){this.vertexParsVariables[e]===void 0&&(this.addVertexParsCode(`${t} ${e};`),this.vertexParsVariables[e]="")}addVertexCode(e){this.addCode(e,"vertex")}addFragmentCode(e){this.addCode(e,"fragment")}addCode(e,t){this.code[t??this.shader]+=e+`
`}addVertexNodeCode(e){this.addNodeCode(e,"vertex")}addFragmentNodeCode(e){this.addNodeCode(e,"fragment")}addNodeCode(e,t){this.nodeCode[t??this.shader]+=e+`
`}clearNodeCode(e){e=e??this.shader;let t=this.nodeCode[e];return this.nodeCode[e]="",t}clearVertexNodeCode(){return this.clearNodeCode("vertex")}clearFragmentNodeCode(){return this.clearNodeCode("fragment")}addVertexFinalCode(e){this.addFinalCode(e,"vertex")}addFragmentFinalCode(e){this.addFinalCode(e,"fragment")}addFinalCode(e,t){this.finalCode[t??this.shader]+=e+`
`}addVertexParsCode(e){this.addParsCode(e,"vertex")}addFragmentParsCode(e){this.addParsCode(e,"fragment")}addParsCode(e,t){this.parsCode[t??this.shader]+=e+`
`}addVaryCode(e){this.addVertexParsCode(e),this.addFragmentParsCode(e)}isCache(e){return this.caches.indexOf(e)!==-1}isSlot(e){return this.slots.indexOf(e)!==-1}define(e,t){this.defines[e]=t===void 0?1:t}require(e){this.requires[e]=!0}isDefined(e){return this.defines[e]!==void 0}getVar(e,t,r,i="varying",n="V",a=""){let o=this.getVars(i),s=o[e];if(!s){let l=o.length;s={name:r||"node"+n+l+(a?"_"+a:""),type:t},o.push(s),o[e]=s}return s}getTempVar(e,t,r,i){return this.getVar(e,t,r,this.shader,"T",i)}getAttribute(e,t){if(!this.attributes[e]){let r=this.getVar(e,t);this.addVertexParsCode("attribute "+t+" "+e+";"),this.addVertexFinalCode(r.name+" = "+e+";"),this.attributes[e]={varying:r,name:e,type:t}}return this.attributes[e]}getCode(e){return[this.prefixCode,this.parsCode[e],this.getVarListCode(this.getVars("varying"),"varying"),this.getVarListCode(this.inputs.uniforms[e],"uniform"),this.getVarListCode(this.inputs.arrayUniforms[e],"uniform"),this.getIncludesCode("consts",e),this.getIncludesCode("structs",e),this.getIncludesCode("functions",e),"void main() {",this.getVarListCode(this.getVars(e)),this.code[e],this.resultCode[e],this.finalCode[e],"}"].join(`
`)}getVarListCode(e,t){t=t??"";let r="";for(let i=0,n=e.length;i<n;++i){let a=e[i],o=a.type,s=a.name,l=a.size,c=this.getFormatByType(o);if(c===void 0)throw new Error("Node pars "+c+" not found.");c.includes("[]")?r+=t+" "+c.substring(0,c.length-2)+" "+s+`[${l}];
`:r+=t+" "+c+" "+s+`;
`}return r}getVars(e){return this.inputs.vars[e??this.shader]}getNodeData(e){let t=e instanceof gn?e.uuid:e;return this.nodeData[t]=this.nodeData[t]||{}}createUniform(e,t,r,i,n,a){if(t.includes("[]")){let o=this.inputs.arrayUniforms,s=o.list.length,l=new KB({type:t,size:r.size,name:i||"nodeUA"+s+(a?"_"+a:""),node:r,needsUpdate:n});return o.list.push(l),o[e].push(l),o[e][l.name]=l,this.uniforms[l.name]=l,l}else{let o=this.inputs.uniforms,s=o.list.length,l=new KB({type:t,name:i||"nodeU"+s+(a?"_"+a:""),node:r,needsUpdate:n});return o.list.push(l),o[e].push(l),o[e][l.name]=l,this.uniforms[l.name]=l,l}}createVertexUniform(e,t,r,i,n){return this.createUniform("vertex",e,t,r,i,n)}createFragmentUniform(e,t,r,i,n){return this.createUniform("fragment",e,t,r,i,n)}include(e,t,r){var a;let i;if(e=typeof e=="string"?Qa.get(e):e,this.context.include===!1)return e.name;e instanceof mt?i=this.includes.functions:e instanceof Qr?i=this.includes.consts:e instanceof VW&&(i=this.includes.structs);let n=i[this.shader]=i[this.shader]||[];if(e){let o=n[e.name];if(o||(o=n[e.name]={node:e,deps:[]},n.push(o),o.src=e.build(this,"source")),e instanceof mt&&t&&n[t.name]&&n[t.name].deps.indexOf(e)===-1&&(n[t.name].deps.push(e),(a=e.includes)==null?void 0:a.length)){let s=0;do this.include(e.includes[s++],t);while(s<e.includes.length)}return r&&(o.src=r),e.name}else throw new Error("Include not found.")}colorToVectorProperties(e){return e.replace("r","x").replace("g","y").replace("b","z").replace("a","w")}colorToVector(e){return e.replace(/c/g,"v3")}getIncludes(e,t){return this.includes[e][t||this.shader]}getConstructorFromLength(e){return aLe[e-1]}isTypeMatrix(e){return/^m/.test(e)}getTypeLength(e){return e==="f"?1:parseInt(this.colorToVector(e).substr(1))}getTypeFromLength(e){return e===1?"f":"v"+e}findNode(...e){for(let t=0;t<arguments.length;t++){let r=e[t];if(r!=null&&r.isNode)return r}}resolve(...e){for(let t=0;t<arguments.length;t++){let r=e[t];if(r!==void 0){if(r.isNode)return r;if(r.isTexture)switch(r.mapping){case fh:case ph:return new Zke(r);case p0:return new Qke(new Ql(r));default:return new Ql(r)}else{if(r.isVector2)return new Zn(r);if(r.isVector3)return new Eo(r);if(r.isVector4)return new Gl(r)}}}}format(e,t,r){switch(this.colorToVector(r+" <- "+t)){case"f <- v2":return e+".x";case"f <- v3":return e+".x";case"f <- v4":return e+".x";case"f <- i":case"f <- b":return"float( "+e+" )";case"v2 <- f":return"vec2( "+e+" )";case"v2 <- v3":return e+".xy";case"v2 <- v4":return e+".xy";case"v2 <- i":case"v2 <- b":return"vec2( float( "+e+" ) )";case"v3 <- f":return"vec3( "+e+" )";case"v3 <- v2":return"vec3( "+e+", 0.0 )";case"v3 <- v4":return e+".xyz";case"v3 <- i":case"v3 <- b":return"vec2( float( "+e+" ) )";case"v4 <- f":return"vec4( "+e+" )";case"v4 <- v2":return"vec4( "+e+", 0.0, 1.0 )";case"v4 <- v3":return"vec4( "+e+", 1.0 )";case"v4 <- i":case"v4 <- b":return"vec4( float( "+e+" ) )";case"i <- f":case"i <- b":return"int( "+e+" )";case"i <- v2":return"int( "+e+".x )";case"i <- v3":return"int( "+e+".x )";case"i <- v4":return"int( "+e+".x )";case"b <- f":return"( "+e+" != 0.0 )";case"b <- v2":return"( "+e+" != vec2( 0.0 ) )";case"b <- v3":return"( "+e+" != vec3( 0.0 ) )";case"b <- v4":return"( "+e+" != vec4( 0.0 ) )";case"b <- i":return"( "+e+" != 0 )"}return e}getTypeByFormat(e){return oLe[e]||e}getFormatByType(e){return sLe[e]||e}getUUID(e,t){return t=t!==void 0?t:!0,t&&this.cache&&(e=this.cache+"-"+e),e}getElementByIndex(e){return JB[e]}getIndexByElement(e){return JB.indexOf(e)}isShader(e){return this.shader===e}setShader(e){return this.shader=e,this}mergeDefines(e){for(let t in e)this.defines[t]=e[t];return this.defines}mergeUniform(e){for(let t in e)this.uniforms[t]=e[t];return this.uniforms}getTextureEncodingFromMap(e){let t;return e?e.isTexture&&(t=e.encoding):t=xs,t===xs&&this.context.gamma&&(t=lr),t}},Ni=class extends so{constructor(e=0,t,r,i){super("c"),this.nodeType="Color",this.value=e instanceof sa?e:new sa(e||0,t,r,i)}setRGBA(e){this.value.setRGBA(e.r,e.g,e.b,e.a)}generate(e,t,r,i,n,a){r=e.getUUID(r??this.getUUID()),i=i??this.getType(e);let o=e.getNodeData(r),s=this.getReadonly()&&this.generateReadonly!==void 0;if(this.alpha){let l=this.alpha.build(e,"f");e.addFragmentNodeCode(`accumAlpha += ( 1.0 - accumAlpha ) * ${l};`)}return s?this.generateReadonly(e,t,r,i,n,a):e.isShader("vertex")?(o.vertex||(o.vertex=e.createVertexUniform(i,this,n,a,this.getLabel())),e.format(o.vertex.name,i,t)):(o.fragment||(o.fragment=e.createFragmentUniform(i,this,n,a,this.getLabel())),e.format(o.fragment.name,i,t))}generateReadonly(e,t,r,i,n,a){return e.format("vec3("+this.value.r+", "+this.value.g+", "+this.value.b+")",i,t)}},si=class extends so{constructor(e){super("i"),this.nodeType="Int",this.value=Math.floor(e??0)}generateReadonly(e,t,r,i,n,a){return e.format(this.value.toString(),i,t)}},Ia=class extends so{constructor(e){super("b"),this.nodeType="Bool",this.value=e??!1}generateReadonly(e,t,r,i){return e.format(this.value?"true":"false",i,t)}},bd=class extends so{constructor(e=1,t){super("f[]"),this.nodeType="FloatArray",this.size=e,this.value=Array.isArray(t)?t:typeof t=="number"?new Array(e).fill(t):new Array(e).fill(0)}},jD=class extends so{},lLe=class extends jD{constructor(e){super("v3"),this.image=e,this._value=new k}get value(){return this._value.x=this.image.isVideo?this.image.img.videoWidth??0:this.image.img.width,this._value.y=this.image.isVideo?this.image.img.videoHeight??0:this.image.img.height,this._value}},RE=class extends jD{constructor(e,t,r=1008,i=1006){super("t"),this.image=e,this.wrap=t,this.minFilter=r,this.magFilter=i}get value(){return this.image.getTexture(this.wrap,this.minFilter,this.magFilter)}},GW=class extends so{constructor(e){super("m3"),this.nodeType="Matrix3",this.value=e??new cn}generateReadonly(e,t,r,i,n,a){return e.format("mat3("+this.value.elements.join(", ")+")",i,t)}get elements(){return this.value.elements}set elements(e){this.value.fromArray(e)}},vl=class extends so{constructor(e){super("m4"),this.nodeType="Matrix4",this.value=e??new it}generateReadonly(e,t,r,i,n,a){return e.format("mat4("+this.value.elements.join(", ")+")",i,t)}get elements(){return this.value.elements}set elements(e){this.value.fromArray(e)}};function e4(e,t,r,i=0){e.setUvTransform(r[0],r[1],t[0],t[1],0,0,0).premultiply(new cn().makeRotation(i*St.DEG2RAD))}var cLe=class extends GW{constructor(e,t,r=0){super(new cn),this.repeat=e,this.offset=t,this.rotation=r,e4(this.value,e,t,r)}updateMatrix(){e4(this.value,this.repeat,this.offset,this.rotation)}},xd=class extends so{constructor(e=1,t){super("v4[]"),this.nodeType="Vector4Array",this.size=e,this.value=Array.isArray(t)?t:t instanceof Qt?new Array(e).fill(t):new Array(e).fill(new Qt(0))}},t4=class extends ni{constructor(e,t,r,i){super("v3"),this.nodeType="Blend",this.a=e,this.b=t,this.alpha=r,this.mode=i}generate(e,t){if(e.isShader("fragment")){let r=[];return r.push(this.a.build(e,"c")),r.push(this.b.build(e,"c")),r.push(this.alpha.build(e,"f")),r.push(this.mode.build(e,"i")),e.format("spe_blend("+r.join(",")+")",this.getType(e),t)}else return console.warn("BlendNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},$W=class extends ni{constructor(e,t){super("v3"),this.nodeType="CustomColor",this.color=e,this.alpha=t,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.isShader("fragment")){let r=e.include($W.Nodes.customColor);e.addFragmentVariable(this.calpha,"float");let i=[];return i.push(this.color.build(e,"v3")),i.push(this.mask?`luminance(${this.mask.build(e,"v3")})`:"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.calpha),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("CustomColorNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},IE=$W;IE.Nodes=function(){return{customColor:new mt(`vec3 customColor(vec3 color, float mask, float alpha, out float calpha) {
				float lalpha = alpha * mask;
				calpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);
				accumAlpha += (1.0 - accumAlpha) * lalpha;

				return color;
			}`)}}();var qW=class extends ni{constructor(e,t){super("v3"),this.nodeType="CustomNormal",this.cnormal=e,this.alpha=t,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.isShader("fragment")){let r=e.include(qW.Nodes.customNormal);e.addFragmentVariable(this.calpha,"float");let i=[];return i.push(this.cnormal.build(e,"v3")),i.push("normal"),i.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.calpha),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("CustomNormalNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},YW=qW;YW.Nodes=function(){return{customNormal:new mt(`vec3 customNormal(vec3 cnormal, vec3 norm, float mask, float alpha, out float calpha) {
				vec3 normal = packNormalToRGB( norm ).rgb;
				normal *= step( vec3(0.5), cnormal );

				float lalpha = alpha * mask;
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += ( 1.0 - accumAlpha ) * lalpha;

				return normal;
			}`)}}();var _v=class extends ni{constructor(e,t,r,i,n,a,o,s,l,c,u,d){super("v3"),this.nodeType="CustomTexture",this.texture=e,this.textureSize=t,this.crop=r,this.projection=i,this.axis=n,this.side=a,this.size=o,this.blending=s,this.mat=l,this.isMask=d,this.alpha=c,this.mode=u,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){e.require("position"),e.require("normal"),e.require("uv"),e.requires.uv=[!0],e.extensions.shaderTextureLOD=!0,e.extensions.derivatives=!0;let r=`g${this.uuid.toString().replace(/-/g,"")}`,i;switch(this.projection.value){case 3:i=e.include(_v.Nodes.cylindrical);break;case 2:i=e.include(_v.Nodes.spherical);break;case 1:let a=["vec3(1.0, 0.0, 0.0)","vec3(0.0, 1.0, 0.0)","vec3(0.0, 0.0, 1.0)"][this.axis.value],o=["zy","xz","xy"][this.axis.value],s=new mt(`
		vec3 ${r}_planarTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
				vec2 projected = (1. + (position.${o})) / 2.;
				vec2 uvs = ( mat * vec3( (projected * 2. - 1.) / (size * .5), 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

				vec4 tmp = texture2D( tex, uvs );

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				${this.side.value===2?"":`lalpha *= step(0.0, ${this.side.value===1?"-1.0 * ":""}dot(vObjectNormal, ${a}));`}

				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}
				
				lalpha *= mask;

				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}`);i=e.include(s);break;case 4:i=e.include(_v.Nodes.triplanar);break;default:i=e.include(_v.Nodes.uv);break}e.addFragmentVariable(this.calpha,"float");let n=[];if(n.push("normal"),n.push(this.texture.generate(e,"t")),n.push(this.textureSize.build(e,"v2")),n.push(this.crop.build(e,"f")),n.push(this.mat.build(e,"mat3")),n.push(this.size.build(e,"v2")),n.push(this.blending.build(e,"f")),n.push(this.isMask.build(e,"b")),n.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),n.push(this.alpha.build(e,"f")),n.push(this.mode.build(e,"i")),n.push(this.calpha),this.projection.value===4){let a=`${r}_writeUvs`,o=a+"0",s=a+"1",l=a+"2",c=`${r}_triplanarWeights`;e.addFragmentVariable(o,"vec2"),e.addFragmentVariable(s,"vec2"),e.addFragmentVariable(l,"vec2"),e.addFragmentVariable(c,"vec3"),n.push(o),n.push(s),n.push(l),n.push(c)}else{let a=`${r}_writeUvs`;e.addFragmentVariable(a,"vec2"),n.push(a)}return e.format(i+"("+n.join(",")+")",this.getType(e),t)}},VD=_v;VD.Nodes=function(){let e=new mt(`
vec3 cylindricalTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
                vec3 posN = normalize(position);
                float u = 0.5 + atan(posN.z, posN.x) / (2.*3.1415);
                float scaledHeight = position.y / (size.y * 0.5);
                float v =  (scaledHeight / 2.) + .5;

                vec2 calculatedUv = vec2(u,v);
				vec2 uvs = ( mat * vec3( calculatedUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

                vec2 df = fwidth(uvs);
               	if(df.x > 0.5) df.x = 0.;

				#ifdef GL_EXT_shader_texture_lod
                vec4 tmp = texture2DLodEXT(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#else
                vec4 tmp = textureLod(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#endif

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}

				lalpha *= mask;
				
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}
`),t=new mt(`
vec3 sphericalTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
                vec3 posN = normalize(vPosition);
                float u = 0.5 + atan(posN.z, posN.x) / (2.*3.1415);
                float v = 0.5 + asin(posN.y) / 3.1415;

                vec2 calculatedUv = vec2(u,v);
				vec2 uvs = ( mat * vec3( calculatedUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

                vec2 df = fwidth(uvs);
               	if(df.x > 0.5) df.x = 0.;
				#ifdef GL_EXT_shader_texture_lod
                vec4 tmp = texture2DLodEXT(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#else
                vec4 tmp = textureLod(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#endif

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}

				lalpha *= mask;

				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}
`),r=new mt(`vec3 uvTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
				vec2 uvs = ( mat * vec3( vUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

				vec4 tmp = texture2D( tex, uvs );

				vec3 col = tmp.rgb;

				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}
				
				lalpha *= mask;

				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}`),i=new mt(`vec3 triplanarTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUvs0, out vec2 writeUvs1, out vec2 writeUvs2, out vec3 writeWeights) {
				vec3 p = position;
				vec2 uv0 = (1.0 + p.xy) / 2.0;     
				vec2 uv1 = (1.0 + p.zy) / 2.0;		
				vec2 uv2 = (1.0 + p.xz) / 2.0;		
	
				uv0 = (mat * vec3((uv0 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;
				uv1 = (mat * vec3((uv1 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;
				uv2 = (mat * vec3((uv2 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;

				// Range from 3 to 128 seems to be good
				float exponent = (1.0 - blending) * 125.0 + 3.0;

				vec3 n = vObjectNormal;
				vec3 weights = abs(normalize(n));
				weights = pow(weights, vec3(exponent));
				weights /= dot(weights, vec3(1.0));

				// Write out all sets of UVs that we generated
				writeUvs0 = uv0;
				writeUvs1 = uv1;
				writeUvs2 = uv2;
				writeWeights = weights;

				// Derivatives for LOD
				vec2 df0 = fwidth(uv0);
				vec2 df1 = fwidth(uv1);
				vec2 df2 = fwidth(uv2);
				if (df0.x > 0.5) df0.x = 0.0;
				if (df1.x > 0.5) df1.x = 0.0;
				if (df2.x > 0.5) df2.x = 0.0;

				#ifdef GL_EXT_shader_texture_lod
                	vec4 tmp = 
						texture2DLodEXT(tex, uv0, log2(max(df0.x, df0.y)*min(textureSize.x, textureSize.y))) * weights.z + 
						texture2DLodEXT(tex, uv1, log2(max(df1.x, df1.y)*min(textureSize.x, textureSize.y))) * weights.x + 
						texture2DLodEXT(tex, uv2, log2(max(df2.x, df2.y)*min(textureSize.x, textureSize.y))) * weights.y;
				#else
                	vec4 tmp = 
						textureLod(tex, uv0, log2(max(df0.x, df0.y)*min(textureSize.x, textureSize.y))) * weights.z + 
						textureLod(tex, uv1, log2(max(df1.x, df1.y)*min(textureSize.x, textureSize.y))) * weights.x + 
						textureLod(tex, uv2, log2(max(df2.x, df2.y)*min(textureSize.x, textureSize.y))) * weights.y;
				#endif

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;

				// Apply cropping across all 3 planes
				if ( crop > 0.5 ) {
					if ( uv0.x < 0.0 || uv0.x > 1.0 || uv0.y < 0.0 || uv0.y > 1.0 )  {
						lalpha = 0.0;
					}
					if ( uv1.x < 0.0 || uv1.x > 1.0 || uv1.y < 0.0 || uv1.y > 1.0 )  {
						lalpha = 0.0;
					}
					if ( uv2.x < 0.0 || uv2.x > 1.0 || uv2.y < 0.0 || uv2.y > 1.0 )  {
						lalpha = 0.0;
					}
				}

				lalpha *= mask;
				calpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;//n * 0.5 + 0.5;
			}			
			`);return{cylindrical:e,spherical:t,uv:r,triplanar:i}}();var Av=class extends ni{constructor(e,t,r,i,n,a,o,s,l,c,u,d){super("v3"),this.nodeType="Depth",this.gradientType=e,this.smooth=t,this.near=r,this.far=i,this.isVector=n,this.isWorldSpace=a,this.origin=o,this.direction=s,this.colors=l,this.steps=c,this.isMask=d,this.alpha=u,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){let r=`g${this.uuid.toString().replace(/-/g,"")}`,i=new mt(`vec3 ${r}_sdepth(float near, float far, vec3 origin, vec3 direction, vec4 colors[${r}_MAX_COLORS], float steps[${r}_MAX_COLORS], bool isMask, float mask, float alpha, out float calpha) {
               vec4 color = colors[0];
               #ifdef ${r}_IS_VECTOR
                   #ifdef ${r}_LINEAR
                       #ifdef ${r}_WORLDSPACE
                       float depth = vectorLinearWorldSpaceDepth(direction, origin, near, far);
                       #else
                       float depth = vectorLinearObjectSpaceDepth(direction, origin, near, far);
                       #endif
                   #else
                       #ifdef ${r}_WORLDSPACE
                           float depth = vectorSphericalWorldSpaceDepth(origin, near, far);
                       #else
                           float depth = vectorSphericalObjectSpaceDepth(origin, near, far);
                       #endif
                   #endif
               #else
                   float dist = length(vWPosition - cameraPosition);
			       float depth = ( dist - near ) / ( far - near );
               #endif


              float p;
              #ifdef ${r}_SMOOTH
				for ( int i = 1; i < ${r}_MAX_COLORS; i++ ) {
						p = clamp( ( depth - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
					}
              #else
                for ( int i = 1; i < ${r}_MAX_COLORS; i++ ) {
                   p = clamp(( depth - steps[i - 1] ) / ( steps[i] - steps[i - 1] ), 0.0, 1.0);
                   color = mix(color, colors[i], p);
                 }
              #endif

               float lalpha = alpha * color.a * mask;
               calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
			   accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));
			   
               return color.rgb;
			}`,[Av.Nodes.vectorLinearWorldSpaceDepth,Av.Nodes.vectorLinearObjectSpaceDepth,Av.Nodes.vectorSphericalObjectSpaceDepth,Av.Nodes.vectorSphericalWorldSpaceDepth]);if(e.isShader("fragment")){e.define(`${r}_MAX_COLORS`,this.colors.value.length),this.smooth.value&&e.define(`${r}_SMOOTH`),this.isVector.value>.5&&e.define(`${r}_IS_VECTOR`),this.gradientType.value===0&&e.define(`${r}_LINEAR`),this.isWorldSpace.value>.5&&e.define(`${r}_WORLDSPACE`),e.require("worldPosition"),e.addFragmentVariable(this.calpha,"float");let n=e.include(i),a=[];return a.push(this.near.build(e,"f")),a.push(this.far.build(e,"f")),a.push(this.origin.build(e,"v3")),a.push(this.direction.build(e,"v3")),a.push(this.colors.build(e,"v4[]")),a.push(this.steps.build(e,"f[]")),a.push(this.isMask.build(e,"b")),a.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),a.push(this.alpha.build(e,"f")),a.push(this.calpha),e.format(n+"("+a.join(",")+")",this.getType(e),t)}else return console.warn("DepthNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},XW=Av;XW.Nodes=function(){let e=new mt(`float vectorLinearWorldSpaceDepth(vec3 direction, vec3 origin, float near, float far) {
               vec3 n = normalize(direction);
               float dist = (n.x*(vWPosition.x - origin.x) + n.y*(vWPosition.y - origin.y) + n.z*(vWPosition.z - origin.z));
               return ( dist - near ) / ( far - near );
            }`),t=new mt(`float vectorLinearObjectSpaceDepth(vec3 direction, vec3 origin, float near, float far) {
               vec3 n = normalize(direction);
               float dist = (n.x*(position.x - origin.x) + n.y*(position.y - origin.y) + n.z*(position.z - origin.z));
               return ( dist - near ) / ( far - near );
            }`),r=new mt(`float vectorSphericalWorldSpaceDepth(vec3 origin, float near, float far) {
               float dist = length(vWPosition - origin);
               return ( dist - near ) / ( far - near );
            }`),i=new mt(`float vectorSphericalObjectSpaceDepth(vec3 origin, float near, float far) {
               float dist = length(position - origin);
               return ( dist - near ) / ( far - near );
            }`);return{vectorLinearWorldSpaceDepth:e,vectorLinearObjectSpaceDepth:t,vectorSphericalWorldSpaceDepth:r,vectorSphericalObjectSpaceDepth:i}}();var uLe=class extends ni{constructor(e,t,r,i,n,a,o,s){super("v3"),this.nodeType="Fresnel",this.color=e,this.bias=t,this.scale=r,this.intensity=i,this.factor=n,this.isMask=s,this.alpha=a,this.mode=o,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.require("vWorldViewDir"),e.require("worldNormal"),e.isShader("fragment")){e.addFragmentVariable(this.calpha,"float");let r=new mt(`vec3 fresnel(vec3 color, float bias, float scale, float intensity, float factor, bool isMask, float mask, float alpha, int mode, out float calpha) {
					float fresnel = bias + scale * pow( abs( factor + dot( normalize( vWorldViewDir ), normalize( vWNormal ) ) ), intensity );

					float lalpha = clamp(fresnel, 0.0, 1.0) * alpha * mask;
					calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
					accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

					return color;
				}`),i=e.include(r),n=[];return n.push(this.color.build(e,"c")),n.push(this.bias.build(e,"f")),n.push(this.scale.build(e,"f")),n.push(this.intensity.build(e,"f")),n.push(this.factor.build(e,"f")),n.push(this.isMask.build(e,"b")),n.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),n.push(this.alpha.build(e,"f")),n.push(this.mode.build(e,"i")),n.push(this.calpha),e.format(i+"("+n.join(",")+")",this.getType(e),t)}else return console.warn("FresnelNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},KW=class extends ni{constructor(e,t,r,i,n,a,o,s,l){super("v3"),this.nodeType="Gradient",this.gradientType=e,this.smooth=t,this.colors=r,this.steps=i,this.offset=n,this.morph=a,this.angle=o,this.isMask=l,this.alpha=s,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.isShader("fragment")){e.define("GRAD_MAX",10),e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let r=e.include(KW.Nodes.gradient),i=[];return i.push(this.gradientType.build(e,"i")),i.push(this.smooth.build(e,"b")),i.push(this.colors.build(e,"v4[]")),i.push(this.steps.build(e,"f[]")),i.push(this.offset.build(e,"v2")),i.push(this.morph.build(e,"v2")),i.push(this.angle.build(e,"f")),i.push(this.isMask.build(e,"b")),i.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.calpha),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("GradientNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},QW=KW;QW.Nodes=function(){return{gradient:new mt(`vec3 gradient(int gradientType, bool smoothed, vec4 colors[GRAD_MAX], float steps[GRAD_MAX], vec2 offset, vec2 morph, float angle, bool isMask, float mask, float alpha, out float calpha) {
				vec4 color = colors[0];
				vec2 m = morph / vUv.xy;
				vec2 rot = vec2( 0.5 + m.x, m.y );
				vec2 dt = vec2(
					cos( angle ) * rot.x - sin( angle ) * rot.y,
					sin( angle ) * rot.x + cos( angle ) * rot.y
				);
				vec2 pt = ( vUv - 0.5 + offset ) / 2.0 + dt / 2.0;
				float t = dot( pt, dt ) / dot( dt, dt );
				if ( gradientType == 1 ) {
					t = distance (
						( vUv + morph ) * 3.0,
						( vUv + offset ) + 1.0
					) + angle;
				} else if ( gradientType == 2 ) {
					float polar = atan(
						vUv.x + morph.x - 0.5 + offset.x,
						vUv.y + morph.y - 0.5 + offset.y
					) * -1.0;
					t = fract( ( angle / PI / -2.0 ) + 0.5 * ( polar / PI ) );
				}

				float p;
				if (smoothed) {
					for ( int i = 1; i < GRAD_MAX; i++ ) {
						p = clamp( ( t - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
					}

				} else {
					for ( int i = 1; i < GRAD_MAX; i++ ) {
						p = clamp( ( t - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], p);
					}
				}

				float lalpha = alpha * color.a * mask;
				calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));
				
				return color.xyz;
			}`)}}();var ZW=class extends ni{constructor(e,t,r,i,n){super("v3"),this.nodeType="Matcap",this.texture=e,this.isMask=i,this.alpha=t,this.mode=r,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`,this.rotation=n}generate(e,t){if(e.isShader("fragment")){e.addFragmentVariable(this.calpha,"float");let r=e.include(ZW.Nodes.matcap);e.require("normal"),e.requires.normal=!0;let i=[];return i.push(this.texture.generate(e,"t")),i.push("normal"),i.push(this.isMask.build(e,"b")),i.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.mode.build(e,"i")),i.push(this.calpha),i.push(this.rotation.build(e,"f")),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("MatcapNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},JW=ZW;JW.Nodes=function(){return{matcap:new mt(`vec3 matcap(sampler2D matcapTex, vec3 normal, bool isMask, float mask, float alpha, int mode, out float calpha, float rotation) {
					vec3 viewDir = normalize( vViewPosition );
					vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
					vec3 y = cross( viewDir, x );
					vec2 uv = vec2( dot( x, normal ), dot( y, normal ) );
					uv = mat2( cos(rotation), sin(rotation), -sin(rotation), cos(rotation) ) * uv;
					uv = uv * 0.495 + 0.5;
					vec4 matcapColor = texture2D( matcapTex, uv );

					float lalpha = alpha * mask;
					calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
					accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));
					
					return matcapColor.rgb;
            	}`)}}();var HD=(e=>(e.SIMPLEX="simplex3d",e.SIMPLEX_FRACTAL="simplex3dFractal",e.ASHIMA="simplexAshima",e.FBM="fbm",e.PERLIN="perlin",e.VORONOI="voronoi",e))(HD||{}),Xa=function(){let e=new mt(`vec3 random3(vec3 c) {
			float j = 4096.0*sin(dot(c,vec3(17.0, 59.4, 15.0)));
			vec3 r;
			r.z = fract(512.0*j);
			j *= .125;
			r.x = fract(512.0*j);
			j *= .125;
			r.y = fract(512.0*j);
			return r-0.5;
		}`),t=new mt(`float simplex3d(vec3 p) {
			 vec3 s = floor(p + dot(p, vec3(F3)));
			 vec3 x = p - s + dot(s, vec3(G3));
			 
			 vec3 e = step(vec3(0.0), x - x.yzx);
			 vec3 i1 = e*(1.0 - e.zxy);
			 vec3 i2 = 1.0 - e.zxy*(1.0 - e);
				
			 vec3 x1 = x - i1 + G3;
			 vec3 x2 = x - i2 + 2.0*G3;
			 vec3 x3 = x - 1.0 + 3.0*G3;
			 
			 vec4 w, d;
			 
			 w.x = dot(x, x);
			 w.y = dot(x1, x1);
			 w.z = dot(x2, x2);
			 w.w = dot(x3, x3);
			 
			 w = max(0.6 - w, 0.0);
			 
			 d.x = dot(random3(s), x);
			 d.y = dot(random3(s + i1), x1);
			 d.z = dot(random3(s + i2), x2);
			 d.w = dot(random3(s + 1.0), x3);
			 
			 w *= w;
			 w *= w;
			 d *= w;
			 
			 return dot(d, vec4(52.0));
		}`,[e]);t.keywords.F3=new Qr("float F3 0.3333333"),t.keywords.G3=new Qr("float G3 0.1666667");let r=new mt(`float simplex3dFractal(vec3 m) {
			mat3 rot1 = mat3(-0.37, 0.36, 0.85,-0.14,-0.93, 0.34,0.92, 0.01,0.4);
			mat3 rot2 = mat3(-0.55,-0.39, 0.74, 0.33,-0.91,-0.24,0.77, 0.12,0.63);
			mat3 rot3 = mat3(-0.71, 0.52,-0.47,-0.08,-0.72,-0.68,-0.7,-0.45,0.56);
			return 0.5333333 * simplex3d(m * rot1)
				 + 0.2666667 * simplex3d(2.0 * m * rot2)
				 + 0.1333333 * simplex3d(4.0 * m * rot3)
				 + 0.0666667 * simplex3d(8.0 * m);
		}`,[t]),i=new mt("vec4 permute(vec4 x){return mod(((x*34.0)+1.0)*x, 289.0);}"),n=new mt("vec4 taylorInvSqrt(vec4 r){return 1.79284291400159 - 0.85373472095314 * r;}"),a=new mt(`float simplexAshima(vec3 v) {
		  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;
		  const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);
		  vec3 i  = floor(v + dot(v, C.yyy) );
		  vec3 x0 =   v - i + dot(i, C.xxx) ;
		  vec3 g = step(x0.yzx, x0.xyz);
		  vec3 l = 1.0 - g;
		  vec3 i1 = min( g.xyz, l.zxy );
		  vec3 i2 = max( g.xyz, l.zxy );
		  vec3 x1 = x0 - i1 + 1.0 * C.xxx;
		  vec3 x2 = x0 - i2 + 2.0 * C.xxx;
		  vec3 x3 = x0 - 1. + 3.0 * C.xxx;
		  i = mod(i, 289.0 ); 
		  vec4 p = permute( permute( permute( 
					 i.z + vec4(0.0, i1.z, i2.z, 1.0 ))
				   + i.y + vec4(0.0, i1.y, i2.y, 1.0 )) 
				   + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));
		  float n_ = 1.0/7.0; // N=7
		  vec3  ns = n_ * D.wyz - D.xzx;
		  vec4 j = p - 49.0 * floor(p * ns.z *ns.z);  //  mod(p,N*N)
		  vec4 x_ = floor(j * ns.z);
		  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)
		  vec4 x = x_ *ns.x + ns.yyyy;
		  vec4 y = y_ *ns.x + ns.yyyy;
		  vec4 h = 1.0 - abs(x) - abs(y);
		  vec4 b0 = vec4( x.xy, y.xy );
		  vec4 b1 = vec4( x.zw, y.zw );
		  vec4 s0 = floor(b0)*2.0 + 1.0;
		  vec4 s1 = floor(b1)*2.0 + 1.0;
		  vec4 sh = -step(h, vec4(0.0));
		  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;
		  vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;
		  vec3 p0 = vec3(a0.xy,h.x);
		  vec3 p1 = vec3(a0.zw,h.y);
		  vec3 p2 = vec3(a1.xy,h.z);
		  vec3 p3 = vec3(a1.zw,h.w);
		  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));
		  p0 *= norm.x;
		  p1 *= norm.y;
		  p2 *= norm.z;
		  p3 *= norm.w;
		  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);
		  m = m * m;
		  return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1), 
										dot(p2,x2), dot(p3,x3) ) );
		}`,[i,n]),o=new mt("vec4 mod289(vec4 x){return x - floor(x * (1.0 / 289.0)) * 289.0;}"),s=new mt("vec4 perm(vec4 x){return mod289(((x * 34.0) + 1.0) * x);}",[o]),l=new mt(`float noise(vec3 p){
			vec3 a = floor(p);
			vec3 d = p - a;
			d = d * d * (3.0 - 2.0 * d);
			vec4 b = a.xxyy + vec4(0.0, 1.0, 0.0, 1.0);
			vec4 k1 = perm(b.xyxy);
			vec4 k2 = perm(k1.xyxy + b.zzww);
			vec4 c = k2 + a.zzzz;
			vec4 k3 = perm(c);
			vec4 k4 = perm(c + 1.0);
			vec4 o1 = fract(k3 * (1.0 / 41.0));
			vec4 o2 = fract(k4 * (1.0 / 41.0));
			vec4 o3 = o2 * d.z + o1 * (1.0 - d.z);
			vec2 o4 = o3.yw * d.x + o3.xz * (1.0 - d.x);
			return o4.y * d.y + o4.x * (1.0 - d.y);
		}`,[s]),c=new mt(`float fbm(vec3 x) {
			float v = 0.0;
			float a = 0.5;
			vec3 shift = vec3(100);
			for (int i = 0; i < NUM_OCTAVES; ++i) {
				v += a * noise(x);
				x = x * 2.0 + shift;
				a *= 0.5;
			}
			return v;
		}`,[l]);c.keywords.NUM_OCTAVES=new Qr("int NUM_OCTAVES 5");let u=new mt("vec3 fade(vec3 t) {return t*t*t*(t*(t*6.0-15.0)+10.0);}"),d=new mt(`float perlin(vec3 P){
		  vec3 Pi0 = floor(P);
		  vec3 Pi1 = Pi0 + vec3(1.0);
		  Pi0 = mod(Pi0, 289.0);
		  Pi1 = mod(Pi1, 289.0);
		  vec3 Pf0 = fract(P);
		  vec3 Pf1 = Pf0 - vec3(1.0);
		  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);
		  vec4 iy = vec4(Pi0.yy, Pi1.yy);
		  vec4 iz0 = Pi0.zzzz;
		  vec4 iz1 = Pi1.zzzz;
		  vec4 ixy = permute(permute(ix) + iy);
		  vec4 ixy0 = permute(ixy + iz0);
		  vec4 ixy1 = permute(ixy + iz1);
		  vec4 gx0 = ixy0 / 7.0;
		  vec4 gy0 = fract(floor(gx0) / 7.0) - 0.5;
		  gx0 = fract(gx0);
		  vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);
		  vec4 sz0 = step(gz0, vec4(0.0));
		  gx0 -= sz0 * (step(0.0, gx0) - 0.5);
		  gy0 -= sz0 * (step(0.0, gy0) - 0.5);
		  vec4 gx1 = ixy1 / 7.0;
		  vec4 gy1 = fract(floor(gx1) / 7.0) - 0.5;
		  gx1 = fract(gx1);
		  vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);
		  vec4 sz1 = step(gz1, vec4(0.0));
		  gx1 -= sz1 * (step(0.0, gx1) - 0.5);
		  gy1 -= sz1 * (step(0.0, gy1) - 0.5);
		  vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);
		  vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);
		  vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);
		  vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);
		  vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);
		  vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);
		  vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);
		  vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);
		  vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));
		  g000 *= norm0.x;
		  g010 *= norm0.y;
		  g100 *= norm0.z;
		  g110 *= norm0.w;
		  vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));
		  g001 *= norm1.x;
		  g011 *= norm1.y;
		  g101 *= norm1.z;
		  g111 *= norm1.w;
		  float n000 = dot(g000, Pf0);
		  float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));
		  float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));
		  float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));
		  float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));
		  float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));
		  float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));
		  float n111 = dot(g111, Pf1);
		  vec3 fade_xyz = fade(Pf0);
		  vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);
		  vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);
		  float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x); 
		  return 2.2 * n_xyz;
		}`,[i,n,u]),h=new mt(`float hashwithoutsine13(vec3 p3)
		{
			p3  = fract(p3 * .1031);
			p3 += dot(p3, p3.yzx + 33.33);
			return fract((p3.x + p3.y) * p3.z);
		}`),f=new mt(`vec3 hashwithoutsine33(vec3 p3)
		{
			p3 = fract(p3 * vec3(.1031, .1030, .0973));
			p3 += dot(p3, p3.yxz+33.33);
			return fract((p3.xxy + p3.yxx)*p3.zyx);
		}`),p=new mt(`float metric(in vec3 p)
		{
			// L2 
			return length(p);

			// Chebyshev 
			// vec3 a = abs(p);
			// return max(a.x, max(a.y, a.z));
		}`),v=new mt(`float smin( float a, float b, float k )
		{
			float h = smoothstep(0.0, 1.0, 0.5 + 0.5 * (b - a) / k);
			float correction = k * h * (1.0 - h);
			return mix(b, a, h) - correction;
		}`),m=new mt(`float smax( float a, float b, float k )
		{
			float h = smoothstep(1.0, 0.0, 0.5 + 0.5 * (a - b) / k);
			float correction = k * h * (1.0 - h);
			return mix(a, b, h) + correction;
		}`),g=new mt(`float remap(float value, float input_min, float input_max, float output_min, float output_max) {
			// Compute width of each interval
			float input_width = input_max - input_min;
			float output_width = output_max - output_min;
		
			// Convert input range into a 0-1 range 
			float scaled = (value - input_min) / input_width;
		
			// Convert the 0-1 range into a value in output range
			return output_min + (scaled * output_width);
		}`),y=new mt(`float voronoi(in vec3 x, in int style, in float smoothness, in float seed, in int quality) 
		{
			// Integer and fractional parts of this point's coordinates
			ivec3 p = ivec3(floor(x));
			vec3 f = fract(x);

			// Different variables that we will use to construct noise:
			//
			// f1: distance to the closest feature point
			// f2: distance to the second closest feature point
			// e: distance to the closest edge (cell boundary)
			//
			// We also compute "smooth" versions of all of the above quantites, essentially
			// replacing "hard" minimums with "smooth" minimums (described by IQ)
			float f1_smooth = 8.0;
			float f1 = 8.0;
			float f2_smooth = 8.0;
			float f2 = 8.0;
			float e_smooth = 8.0;
			float e = 8.0;

			// Variables stored from closest cell
			ivec3 mb;
			vec3 mr; 

			int steps = quality;
			
			for (int x = -steps; x <= steps; x++) 
			for (int y = -steps; y <= steps; y++)
			for (int z = -steps; z <= steps; z++)
			{
				ivec3 b = ivec3(x, y, z);
				vec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;
				float d = length(r);
				
				f1_smooth = smin(d, f1_smooth, smoothness);

				// Store un-smoothed distances too 
				if (d < f1) 
				{
					f2 = f1;
					f1 = d;

					mb = ivec3(x, y, z);
					mr = r;
				} 
				else if (d < f2) 
				{
					f2 = d;
				}
			}	
			
			float id = hashwithoutsine13(vec3(p + mb) + seed);

			// Second pass for edge distance  
			for (int x = -steps; x <= steps; x++) 
			for (int y = -steps; y <= steps; y++)
			for (int z = -steps; z <= steps; z++)
			{
				// Start search at the cell that contains the closest point to "x" (found in 1st pass)
				ivec3 b = mb + ivec3(x, y, z);
				vec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;
				float d1 = dot(0.5 * (mr + r), (r - mr)); 				// IQ normalizes "r - mr" but that breaks things for the smooth version?
				float d2 = dot(0.5 * (mr + r), normalize(r - mr));

				e_smooth = smin(d1, e_smooth, smoothness);

				e = min(e, d2);

				// Also compute a smooth version of F2 in this pass
				{
					ivec3 b = ivec3(x, y, z);
					if (b != mb) 
					{
						vec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;
						float d = length(r);

						f2_smooth = smin(d, f2_smooth, smoothness);
					}
				}
			}

			// Different visualization modes 
			if (style == 0) 
			{
				return f1_smooth;
			}
			if (style == 1) 
			{
				return f2_smooth;
			}
			if (style == 2) 
			{
				return f2_smooth - f1_smooth;
				
				// "Pebbles" also cool
				//return step(0.2, f2_smooth - f1_smooth);
			}
			if (style == 3) 
			{
				// This one is really good for rock / stone effects
				float a = f1; 
				float b = f2;
				float k = 3.0;
				float h = max(k - abs(a - b), 0.0) / k;
				float final = min(a, b) - h * h * k * (1.0 / 4.0);
				return final;
			}
			if (style == 4) 
			{
				// Some random adjustments to make this style stand out more 
				return exp(5.0 * e_smooth);
			}
			if (style == 5) 
			{
				return pow(f1_smooth, 3.0);
			}
			if (style == 6) 
			{				
				const float eps = 0.0125;

				// Thicker lines as the user increases the smoothness slider
				float thickness = smoothness * 0.25 + eps;

				// Blurrier lines as the user increases the smoothness slider
				float blur = pow(smoothness, 3.0) * 0.25 + eps;

				return smoothstep(
					thickness - thickness * blur, 
					thickness + thickness * blur, 
					e
				);
			}
			if (style == 7) 
			{
				return hashwithoutsine13(vec3(p + mb) + seed);
			}
		}
	`,[h,f,p,v,m,g]);return{simplex:t,simplexFractal:r,simplexAshima:a,fbm:c,perlin:d,voronoi:y}}(),e9=class extends ni{constructor(e,t,r,i,n,a,o,s,l,c,u,d,h,f,p,v,m,g,y){super("v3"),this.nodeType="Noise",this.scale=e,this.size=t,this.move=r,this.fA=i,this.fB=n,this.distortion=a,this.colorA=o,this.colorB=s,this.colorC=l,this.colorD=c,this.noiseType=d,this.voronoiStyle=f,this.highCut=p,this.lowCut=v,this.smoothness=m,this.seed=g,this.quality=y,this.isMask=h,this.alpha=u,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t,r,i,n){e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let a=Object.values(HD)[this.noiseType.value],o=a=="voronoi"?`
		float v = ${a}(st + move, voronoiStyle, smoothness, seed, quality);

		// Apply clipping to colors
		v = remap(v, lowCut, highCut, 0.0, 1.0);
		v = smax(v, 0.0, smoothness * 0.25);
		v = smin(v, 1.0, smoothness * 0.25);

		// Note that the voronoi mode only uses colors "A" and "C" from the UI 
		vec4 color = mix(colorA, colorC, v); 
		`:`
		vec3 q = vec3(${a}(st),
					   ${a}(st + vec3(1.0)),
					   ${a}(st + vec3(1.0)));
		vec3 r = vec3(${a}(st + vec3(distortion, 1.0) * q + vec3(fA, 1.0) + move),
					  ${a}(st + vec3(distortion, 1.0) * q + vec3(fB, 1.0) + move), 
					  ${a}(st * q));
		float f = ${a}(st + r);
		vec4 color;
		color = mix(colorA, colorB, clamp((f * f) * 4.0, 0.0, 1.0));
		color = mix(color, colorC, clamp(length(q), 0.0, 1.0));
		color = mix(color, colorD, clamp(length(r.x), 0.0, 1.0));
		`,s=new mt(`vec3 ${a}customNoise(float scale, vec3 size, float move, vec2 fA, vec2 fB, vec2 distortion, vec4 colorA, vec4 colorB, vec4 colorC, vec4 colorD, int voronoiStyle, float highCut, float lowCut, float smoothness, float seed, int quality, bool isMask, float mask, float alpha, out float calpha) 
			{
                // Prevent scale of zero 
				scale = max(abs(scale), 0.001);

				vec3 st = position / size;
				st /= scale;

				${o}

				float lalpha = alpha * color.a * mask;
				calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return clamp(color, 0.0, 1.0).rgb;
			}`,[Xa.simplex,Xa.simplexFractal,Xa.simplexAshima,Xa.fbm,Xa.perlin,Xa.voronoi]),l=e.include(s),c=[];return c.push(this.scale.build(e,"f")),c.push(this.size.build(e,"v3")),c.push(this.move.build(e,"f")),c.push(this.fA.build(e,"v2")),c.push(this.fB.build(e,"v2")),c.push(this.distortion.build(e,"v2")),c.push(this.colorA.build(e,"v4")),c.push(this.colorB.build(e,"v4")),c.push(this.colorC.build(e,"v4")),c.push(this.colorD.build(e,"v4")),c.push(this.voronoiStyle.build(e,"i")),c.push(this.highCut.build(e,"f")),c.push(this.lowCut.build(e,"f")),c.push(this.smoothness.build(e,"f")),c.push(this.seed.build(e,"f")),c.push(this.quality.build(e,"i")),c.push(this.isMask.build(e,"b")),c.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),c.push(this.alpha.build(e,"f")),c.push(this.calpha),e.format(l+"("+c.join(",")+")",this.getType(e),t)}};e9.numOctaves=5;var t9=class extends ni{constructor(e,t,r,i,n,a,o,s,l,c,u,d,h,f,p,v){super("v3"),this.nodeType="Outline",this.firstTime=!0,this.outlineColor=e,this.contourColor=t,this.outlineWidth=r,this.contourWidth=i,this.contourThreshold=n,this.outlineThreshold=a,this.contourFrequency=o,this.outlineSmoothing=s,this.contourDirection=l,this.positionalLines=c,this.compensation=u,this.resolution=d,this.normalMap=h,this.depthMap=f,this.pixelRatio=p,this.alpha=v,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){let r=`g${this.uuid.toString().replace(/-/g,"")}`;if(e.require("vWorldViewDir"),e.require("worldNormal"),e.extensions.derivatives=!0,this.compensation.value&&e.define("OUTLINE_COMPENSATION",`${r}_offset`),this.firstTime){let i=this.outlineWidth.build(e,"f"),n=this.resolution.build(e,"v2"),a=this.compensation.build(e,"b"),o=this.pixelRatio.build(e,"f");e.addVertexParsVariable("randomColor","attribute vec3"),e.addVertexParsVariable("extrudeNormal","attribute vec3"),e.addVertexParsVariable(i,"uniform float"),e.addVertexParsVariable(n,"uniform vec2"),e.addVertexParsVariable(a,"uniform bool"),e.addVertexParsVariable(o,"uniform float"),e.addVertexParsVariable("vID","flat out float"),e.addFragmentParsVariable("vID","flat in float"),e.addVertexFinalCode(`
                vID = randomColor.r;
                vec2 ${r}_offset = vec2(0.0);
                if (${a}) {
                    vec4 ${r}_clipPosition = projectionMatrix * (modelViewMatrix * vec4(transformed, 1.0));
                    // NOTE: For certain shapes, like spheres, we get incorrect extrusion when the
                    // normals face the camera directly. So we hackily fix this by offsetting the normal
                    // by a tiny amount.
                    vec3 ${r}_clipNormal = mat3(projectionMatrix) * (mat3(modelViewMatrix) * extrudeNormal) + 0.0000001;
                    ${r}_offset = normalize(${r}_clipNormal.xy) / ${n} * (${i} / 2.0) * ${r}_clipPosition.w * 2.0 * ${o};
                    ${r}_clipPosition.xy += ${r}_offset;
                    // TODO(MAX): To handle multiple outline layers, we only want to extrude
                    // if this offset is the biggest of all the potential offsets
                    gl_Position = ${r}_clipPosition;
                }
            `)}if(e.isShader("fragment")){e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let i=e.include(t9.Nodes.outline),n=[];return n.push(this.outlineColor.build(e,"c")),n.push(this.contourColor.build(e,"c")),n.push(this.outlineWidth.build(e,"f")),n.push(this.contourWidth.build(e,"f")),n.push(this.contourThreshold.build(e,"f")),n.push(this.outlineThreshold.build(e,"f")),n.push(this.contourFrequency.build(e,"f")),n.push(this.outlineSmoothing.build(e,"f")),n.push(this.contourDirection.build(e,"v3")),n.push(this.positionalLines.build(e,"b")),n.push(this.resolution.build(e,"v2")),n.push(this.normalMap.getTexture(e,"t")),n.push(this.depthMap.getTexture(e,"t")),n.push(this.pixelRatio.build(e,"f")),n.push(this.compensation.build(e,"b")),n.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),n.push(this.alpha.build(e,"f")),n.push(this.calpha),this.firstTime=!this.firstTime,e.format(i+"("+n.join(",")+")",this.getType(e),t)}else return console.warn("OutlineNode is not compatible with "+e.shader+" shader."),""}},r9=t9;r9.Nodes=function(){let e=new mt(`
float sobelSample(sampler2D t, sampler2D d, vec2 uv, vec2 resolution, float outlineWidth, float pixelRatio)
{
    vec2 halton = haltonSequence[frameIndex];
    float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
    float temporalAngle  = temporalOffset * PI2;

    vec2 texelSize = (vec2(1.0) / resolution);
    vec2 offsetSize = texelSize * outlineWidth * pixelRatio;

    vec2 uvSamples[9];
    vec4 normalSamples[9];

	uvSamples[0] = uv + vec2( -offsetSize.x, -offsetSize.y) + (vogelDiskSample(0, 9, temporalAngle) * texelSize);
	uvSamples[1] = uv + vec2(0.0, -offsetSize.y) + (vogelDiskSample(1, 9, temporalAngle) * texelSize);
	uvSamples[2] = uv + vec2(  offsetSize.x, -offsetSize.y) + (vogelDiskSample(2, 9, temporalAngle) * texelSize);
	uvSamples[3] = uv + vec2( -offsetSize.x, 0.0) + (vogelDiskSample(3, 9, temporalAngle) * texelSize);
	uvSamples[4] = uv;
	uvSamples[5] = uv + vec2(  offsetSize.x, 0.0) + (vogelDiskSample(5, 9, temporalAngle) * texelSize);
	uvSamples[6] = uv + vec2( -offsetSize.x, offsetSize.y) + (vogelDiskSample(6, 9, temporalAngle) * texelSize);
	uvSamples[7] = uv + vec2(0.0, offsetSize.y) + (vogelDiskSample(7, 9, temporalAngle) * texelSize);
	uvSamples[8] = uv + vec2(  offsetSize.x, offsetSize.y) + (vogelDiskSample(8, 9, temporalAngle) * texelSize);


    normalSamples[0] = texture2D(t, uvSamples[0]);
    normalSamples[1] = texture2D(t, uvSamples[1]);
    normalSamples[2] = texture2D(t, uvSamples[2]);
    normalSamples[3] = texture2D(t, uvSamples[3]);
    normalSamples[4] = texture2D(t, uvSamples[4]);
    normalSamples[5] = texture2D(t, uvSamples[5]);
    normalSamples[6] = texture2D(t, uvSamples[6]);
    normalSamples[7] = texture2D(t, uvSamples[7]);
    normalSamples[8] = texture2D(t, uvSamples[8]);

    float depthBias = 0.0001;
    // TODO(MAX): Can we somehow reduce the number of conditionals here with MATH?!
    if (normalSamples[0].a != vID && normalSamples[0].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[0]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[1].a != vID && normalSamples[1].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[1]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[2].a != vID && normalSamples[2].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[2]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[3].a != vID && normalSamples[3].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[3]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }


    if (normalSamples[4].a != vID && normalSamples[4].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[4]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[5].a != vID && normalSamples[5].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[5]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[6].a != vID && normalSamples[6].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[6]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[7].a != vID && normalSamples[7].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[7]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[8].a != vID && normalSamples[8].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[8]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    vec3 sobel_edge_h = normalSamples[2].rgb + (2.0*normalSamples[5].rgb) + normalSamples[8].rgb - (normalSamples[0].rgb + (2.0*normalSamples[3].rgb) + normalSamples[6].rgb);
  	vec3 sobel_edge_v = normalSamples[0].rgb + (2.0*normalSamples[1].rgb) + normalSamples[2].rgb - (normalSamples[6].rgb + (2.0*normalSamples[7].rgb) + normalSamples[8].rgb);

    float edgeNormal = sqrt(dot(sobel_edge_h, sobel_edge_h) + dot(sobel_edge_v, sobel_edge_v));
    return edgeNormal;
}
`);return{outline:new mt(`vec3 outline(vec3 outlineColor, vec3 contourColor, float outlineWidth, float contourWidth, float outlineThreshold, float contourThreshold, float outlineSmoothing, float contourFrequency, vec3 contourDirection, bool positionalLines, vec2 resolution, sampler2D normalMap, sampler2D depthMap, float pixelRatio, bool compensation, float mask, float alpha, out float calpha) {
                vec3 result = outlineColor;
                float resultAlpha = 0.0;

                vec3 N = normalize(vWNormal);
                vec2 nuv = (gl_FragCoord.xy / resolution);
                float sobelSample = compensation ? sobelSample(normalMap, depthMap, nuv, resolution, outlineWidth / 2., pixelRatio) : sobelSample(normalMap, depthMap, nuv, resolution, outlineWidth, pixelRatio);
                resultAlpha = smoothstep(outlineThreshold - outlineSmoothing, outlineThreshold + outlineSmoothing, sobelSample);

                //resultAlpha = 1.0;
                //result = vec3(sobelSample);

                float t = 1.0 - contourThreshold;
                if(positionalLines) {
                    vec3 NDir = position * contourDirection;
                    float NT = NDir.x + NDir.y + NDir.z;
                    float f  = fract(NT * contourFrequency * 0.01);
                    float df = fwidth(NT * contourFrequency);

                    float g = smoothstep(df * (contourWidth * 0.01), df * (contourWidth * 0.01 * 2.0), f);
                    if (g < 1.0 && resultAlpha == 0.0) {
                        result = contourColor;
                        resultAlpha = 1.0;
                    }
                 }
                 else {
                    vec3 NDir = N * contourDirection;
                    float NT = NDir.x + NDir.y + NDir.z;
                    float df = fwidth(NT * contourThreshold);
                    float f = sin(NT * 1.0 * contourFrequency);
                    float g = smoothstep(0.0, df * contourWidth, 1.0 - f);

                    if (df > (t * 0.5) && g < 1.0 && resultAlpha == 0.0) {
                        result = contourColor;
                        resultAlpha = 1.0 - g;
                    }
                 }

                 float lalpha = alpha * resultAlpha * mask;
                 calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
                 accumAlpha += ( 1.0 - accumAlpha ) * lalpha;
				 
                 return result;
             }`,[e])}}();var jl=class extends ni{constructor(e,t,r,i,n,a,o,s,l,c,u,d,h,f,p,v,m,g){super("v3"),this.nodeType="Pattern",this.style=e,this.projection=t,this.axis=r,this.blending=i,this.offset=n,this.colorA=a,this.colorB=o,this.frequency=s,this.size=l,this.variation=c,this.smoothness=u,this.zigzag=d,this.rotation=h,this.vertical=f,this.horizontal=p,this.sides=v,this.isMask=g,this.alpha=m,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.isShader("fragment")){e.require("position"),e.require("uv"),e.requires.uv=[!0],e.require("normal"),e.requires.normal=!0,e.addFragmentVariable(this.calpha,"float");let r;switch(this.style.value){case 0:r="circle";break;case 1:r="ring";break;case 2:r="polygon";break;case 3:r="xcross";break;case 4:r="diamond";break;case 5:r="checkerboard";break;case 6:r="line";break;case 7:r="wave";break;default:r="circle";break}let i=`g${this.uuid.toString().replace(/-/g,"")}`,n=new mt(`float hashwithoutsine12(vec2 p)
				{
					vec3 p3 = fract(vec3(p.xyx) * .1031);
					p3 += dot(p3, p3.yzx + 33.33);
					return fract((p3.x + p3.y) * p3.z);
				}`),a=new mt(`vec2 rotate_uv(in vec2 uv, float a, bool repeat) 
				{
					const float mid = 0.5;
					float radians = a * (PI / 180.0);
					vec2 rotated = vec2(
						cos(radians) * (uv.x - mid) + sin(radians) * (uv.y - mid) + mid,
						cos(radians) * (uv.y - mid) - sin(radians) * (uv.x - mid) + mid
					);
					return repeat ? fract(rotated): rotated;
				}`),o="";if(this.projection.value===4){let u=this.style.value===2?`${r}(uv0, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${r}(uv0, frequency, size, variation, smoothness_remapped, zigzag, rotation)`,d=this.style.value===2?`${r}(uv1, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${r}(uv1, frequency, size, variation, smoothness_remapped, zigzag, rotation)`,h=this.style.value===2?`${r}(uv2, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${r}(uv2, frequency, size, variation, smoothness_remapped, zigzag, rotation)`;o=`
				vec3 p = position;
				float factor = 0.0125;
				vec2 uv0 = fract(p.xy * factor);
				vec2 uv1 = fract(p.zy * factor);
				vec2 uv2 = fract(p.xz * factor);
				
				uv0 = rotate_uv(uv0 + offset, rotation, true);
				uv1 = rotate_uv(uv1 + offset, rotation, true);
				uv2 = rotate_uv(uv2 + offset, rotation, true);
	
				float d0 = ${u};
				float d1 = ${d};
				float d2 = ${h};
				
				// Range from 3 to 128 seems to be good
				float exponent = (1.0 - blending) * 125.0 + 3.0;

				vec3 n = vObjectNormal;
				vec3 weights = abs(normalize(n));
				weights = pow(weights, vec3(exponent));
				weights /= dot(weights, vec3(1.0));
				d0 *= weights.z;
				d1 *= weights.x;
				d2 *= weights.y;
				float draw = d0 + d1 + d2;
	
				vec2 custom_uv = uv0 * weights.z + uv1 * weights.x + uv2 * weights.y;
				`}else{let u=this.style.value===2?`${r}(custom_uv, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${r}(custom_uv, frequency, size, variation, smoothness_remapped, zigzag, rotation)`,d="";this.axis.value===0?d=`float radius = length(p);
					float theta = atan(p.y, p.z);
					float phi = acos(p.x / radius);`:this.axis.value===1?d=`float radius = length(p);
					float theta = atan(p.x, p.z);
					float phi = acos(p.y / radius);`:(this.axis.value,d=`float radius = length(p);
					float theta = atan(p.y, p.x);
					float phi = acos(p.z / radius);`);let h="";switch(this.projection.value){case 0:h="custom_uv = vUv.st;";break;case 1:break;case 2:h=`
							vec3 p = position;
							${d}
							custom_uv = vec2(theta, phi);
							custom_uv /= PI;
							`;break}o=`
				vec2 custom_uv;
				${h}
	
				custom_uv += offset;
				custom_uv = fract(custom_uv);
				custom_uv = rotate_uv(custom_uv, rotation, true);
	
				float draw = ${u};
				`}let s=new mt(`vec3 ${i}_pattern(vec3 normal, float blending, int style, vec2 offset, vec4 colorA, vec4 colorB, vec2 frequency, float size, float variation, float smoothness, float zigzag, float rotation, vec2 vertical, vec2 horizontal, int sides, bool isMask, float mask, float alpha, out float calpha) {
					const float TWO_PI = PI * 2.0;
					float smoothness_remapped = pow(smoothness, 5.0);	

					${o}

					// Construct final output color
					vec4 color = mix(colorA, colorB, draw);
					color.a = clamp(color.a, 0.0, 1.0);

					// Apply cuts
					color.a *= 
						step(vertical.x, custom_uv.y) * 
						step(custom_uv.y, vertical.y);
					color.a *= 
						step(horizontal.x, abs(custom_uv.x)) * 
						step(abs(custom_uv.x), horizontal.y);

					// Accumulate alpha 
					float lalpha = alpha * clamp(color.a, 0.0, 1.0) * mask;
					calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
					accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

					return clamp(color, 0.0, 1.0).rgb;
				}`,[a,n,jl.DrawFunctions.circle,jl.DrawFunctions.ring,jl.DrawFunctions.polygon,jl.DrawFunctions.cross,jl.DrawFunctions.diamond,jl.DrawFunctions.checkerboard,jl.DrawFunctions.line,jl.DrawFunctions.wave]),l=e.include(s),c=[];return c.push("normal"),c.push(this.blending.build(e,"f")),c.push(this.style.build(e,"i")),c.push(this.offset.build(e,"v2")),c.push(this.colorA.build(e,"v4")),c.push(this.colorB.build(e,"v4")),c.push(this.frequency.build(e,"v2")),c.push(this.size.build(e,"f")),c.push(this.variation.build(e,"f")),c.push(this.smoothness.build(e,"f")),c.push(this.zigzag.build(e,"f")),c.push(this.rotation.build(e,"f")),c.push(this.vertical.build(e,"v2")),c.push(this.horizontal.build(e,"v2")),c.push(this.sides.build(e,"i")),c.push(this.isMask.build(e,"b")),c.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),c.push(this.alpha.build(e,"f")),c.push(this.calpha),e.format(l+"("+c.join(",")+")",this.getType(e),t)}else return console.warn("PatterNode is not compatible with "+e.shader+" shader."),e.format("vec3(0.0)",this.getType(e),t)}},i9=jl;i9.DrawFunctions=function(){let e=new mt(`float hashwithoutsine12(vec2 p) {
				vec3 p3 = fract(vec3(p.xyx) * 0.1031);
				p3 += dot(p3, p3.yzx + 33.33);
				return fract((p3.x + p3.y) * p3.z);
			}`),t=new mt(`vec2 tile_and_center(in vec2 uv, in vec2 frequency, in float variation, in float zigzag, in float rotation) {
                // Create tiles in UV-space
                uv *= frequency;

                // Integer coords
                vec2 i = floor(uv);

                // Offset every other row based on zigzag param, then compute fractional coords
                float row_offset = mod(i.y, 2.0);
                uv.x += row_offset * zigzag;
                vec2 f = fract(uv);

				// Rotate the tile itself:
				// const float mid = 0.5;
				// f = vec2(
				// 	cos(rotation) * (f.x - mid) + sin(rotation) * (f.y - mid) + mid,
				// 	cos(rotation) * (f.y - mid) - sin(rotation) * (f.x - mid) + mid
				// );
				// f = fract(f);

                f = f * 2.0 - 1.0;

				// Recompute integer coords after shifting - then, random value per tile 
				i = floor(uv);
				float rand = (hashwithoutsine12(i) * 5.0 + 1.0);
				float jitter = mix(1.0, rand, variation);
				f *= jitter;

                return f;
            }`,[e]),r=new mt(`float circle(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
                return smoothstep(
                    -smoothness, 
                     smoothness, 
                     length(f) - size
                );
            }`,[t]),i=new mt(`float ring(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);

				float d = length(f);
                const float inner_width = 0.5;

                float outer = smoothstep(-smoothness, smoothness, d - size);
                float inner = smoothstep(-smoothness, smoothness, d - size * inner_width);
				return outer + (1.0 - inner);   
            }`,[t]),n=new mt(`float sdf_ngon(in vec2 p, in float r, in int n) {
                float an = (PI * 2.0) / float(n);
                float he = r * tan(0.5 * an);
                
                // Rotate to first sector
                p = -p.yx; 
                float bn = an * floor((atan(p.y, p.x) + 0.5 * an) / an);
                vec2  cs = vec2(cos(bn), sin(bn));
                p = mat2(cs.x, -cs.y, cs.y, cs.x)*p;
            
                // Side of polygon
                return length(p - vec2(r, clamp(p.y, -he, he))) * sign(p.x - r);
            }
            
            float polygon(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation, in int sides) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
                return smoothstep(-smoothness, smoothness, sdf_ngon(f, size, sides));
            }`,[t]),a=new mt(`float sdf_cross(in vec2 p, in vec2 b, float r ) {
                p = abs(p); 
				p = (p.y > p.x) ? p.yx : p.xy;
                vec2  q = p - b;
                float k = max(q.y, q.x);
                vec2  w = (k > 0.0) ? q : vec2(b.y - p.x, -k);
                return sign(k) * length(max(w, 0.0)) + r;
            }
            
            // Avoid namespace conflicts 
            float xcross(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
                return smoothstep(-smoothness, smoothness, sdf_cross(f, vec2(size, size * 0.25), smoothness));
            }`,[t]),o=new mt(`float ndot(vec2 a, vec2 b) { 
                return a.x*b.x - a.y*b.y; 
            }
            
            float sdf_diamond(in vec2 p, in vec2 b) {
                p = abs(p);
                float h = clamp(ndot(b - 2.0 * p, b) / dot(b, b), -1.0, 1.0);
                float d = length(p - 0.5 * b * vec2(1.0 - h, 1.0 + h));
                return d * sign(p.x * b.y + p.y * b.x - b.x * b.y);
            }

            float diamond(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
	            return smoothstep(-smoothness, smoothness, sdf_diamond(f, vec2(size)));
            }`,[t]),s=new mt(`float checkerboard(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                uv *= frequency;
                vec2 i = floor(uv);

                float offset = mod(i.y, 2.0);

                uv.x += offset + zigzag * offset;
                float x = floor(uv.x);
                
                return mod(x, 2.0);
            }`),l=new mt(`float line(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, 0.0, zigzag, rotation);
				
				// Different approach for variation param here
				float row = floor(uv * frequency).y;
				float rand = hashwithoutsine12(vec2(row));
				float s = mix(size, size * rand, variation);

				return smoothstep(
					s - smoothness, 
					s + smoothness, 
					abs(f.y)
				);
            }`,[t]),c=new mt(`// Uses bisection 
            float udf_cos(in vec2 p, in float a, in float b, in float c, in float d) {
                // Convert all data to a primitive cosine wave
                p = c * (p - vec2(d, a));
                
                const float TWO_PI = PI * 2.0;

                // Reduce to principal half cycle
                p.x = mod(p.x, TWO_PI); 
                if (p.x > PI) {
                    p.x = TWO_PI - p.x;
                }
            
                // Find zero of derivative (minimize distance)
                float xa = 0.0;
                float xb = TWO_PI;

                // 24 bit precision
                for (int i = 0; i < 24; i++) {
                    float x = 0.5 * (xa + xb);
                    float y = x - p.x + b * c * sin(x) * (p.y - b * c * cos(x));
                    if (y < 0.0) xa = x; 
                    else xb = x;
                }
                float x = 0.5 * (xa + xb);
                
                // Compute distance    
                vec2 q = vec2(x, b * c * cos(x));
                return length(p - q) / c;
            }

            float wave(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                float repeat = frequency.x;
                uv *= repeat;
                vec2 i = floor(uv);
                float row_offset = mod(i.y, 2.0);
                uv.x += row_offset * zigzag;
                vec2 f = vec2(uv.x, fract(uv.y));

                // Generalized cosine: y(x) = a + b * cos(cx + d)
                const float amplitude = 0.125;
                float wave_frequency = frequency.y * 0.1;
                float distance_estimate = udf_cos(f, 0.50, amplitude, wave_frequency * (2.0 * PI), 0.0);

				// Different approach for variation param here
				float rand = hashwithoutsine12(vec2(i.y));
				float s = mix(size, size * rand, variation);

                return smoothstep(-smoothness, smoothness, distance_estimate - s * 0.5);
            }`);return{tileAndCenter:t,circle:r,ring:i,polygon:n,cross:a,diamond:o,checkerboard:s,line:l,wave:c}}();var n9=class extends ni{constructor(e,t,r,i,n,a,o,s){super("v3"),this.nodeType="Rainbow",this.filmThickness=e,this.movement=t,this.wavelengths=r,this.noiseStrength=i,this.noiseScale=n,this.offset=a,this.isMask=s,this.alpha=o,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.require("vWorldViewDir"),e.require("worldNormal"),e.isShader("fragment")){e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let r=e.include(n9.Nodes.rainbow),i=[];return i.push(this.filmThickness.build(e,"f")),i.push(this.movement.build(e,"f")),i.push(this.wavelengths.build(e,"v3")),i.push(this.noiseStrength.build(e,"f")),i.push(this.noiseScale.build(e,"f")),i.push(this.offset.build(e,"v3")),i.push(this.isMask.build(e,"b")),i.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.calpha),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("RainbowNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},a9=n9;a9.Nodes=function(){let e=new mt(`vec3 attenuation(vec3 wavelengths, float filmThickness, float movement, float noiseStrength, float noiseScale, vec3 offset) {
                 vec3 st = position / noiseScale;
				 vec3 q = vec3(simplex3d(st),
							  simplex3d(st + vec3(1.0)),
							  simplex3d(st + vec3(1.0)));

				 vec3 r = vec3(simplex3d(st + vec3(1.4, 1.3, 1.0) * q + vec3(1.7, 9.2, 1.0)),
							  simplex3d(st + vec3(2.0, 1.2, 1.0) * q + vec3(8.3, 2.8, 1.0)),
							  simplex3d(st * q));

                 float noise = simplex3d(st + r);

                 return .5 + .5 * cos((((filmThickness + (noise * noiseStrength)) / (vec3(wavelengths.r * 1.0, wavelengths.g * 0.8, wavelengths.b * 0.6) + 1.0)) * dot(normalize(vWorldViewDir + (offset * -0.001)), normalize(vWNormal))) + movement);
             }`,[Xa.simplex]);return{rainbow:new mt(`vec3 rainbow(float filmThickness, float movement, vec3 wavelengths, float noiseStrength, float noiseScale, vec3 offset, bool isMask, float mask, float alpha, out float calpha) {
				vec3 res = clamp(attenuation(wavelengths, filmThickness, movement, noiseStrength, noiseScale, offset), 0.0, 2.0);

				float rainbowContribution = clamp(res.r + res.g + res.b, 0.0, 1.0);

				float lalpha = alpha * rainbowContribution * mask;
				calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return res;
             }`,[e])}}();var o9=class extends ni{constructor(e,t,r,i,n,a,o,s,l,c){super("v3"),this.nodeType="Toon",this.positioning=e,this.colors=t,this.steps=r,this.source=i,this.isWorldSpace=n,this.noiseStrength=a,this.noiseScale=o,this.shadowColor=s,this.offset=l,this.alpha=c,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.require("worldNormal"),e.require("worldPosition"),e.isShader("fragment")){e.define("COLORS_MAX",10),e.addFragmentVariable(this.calpha,"float");let r=e.include(o9.Nodes.toon),i=[];return i.push(this.positioning.build(e,"i")),i.push(this.colors.build(e,"v4[]")),i.push(this.steps.build(e,"f[]")),i.push(this.source.build(e,"v3")),i.push(this.isWorldSpace.build(e,"b")),i.push(this.noiseStrength.build(e,"f")),i.push(this.noiseScale.build(e,"f")),i.push(this.shadowColor.build(e,"v4")),i.push(this.offset.build(e,"v3")),i.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.calpha),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("ToonNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},s9=o9;s9.Nodes=function(){let e=new mt(`float rand(float n) {
				return fract(sin(n) * 43758.5453123);
			}`),t=new mt(`float hash1(float p) { 
				p = fract(p * 0.011); 
				p *= p + 7.5; 
				p *= p + p; 
				return fract(p); 
			}`),r=new mt(`float valueNoise(vec3 x) {
				const vec3 step = vec3(110, 241, 171);
			
				vec3 i = floor(x);
				vec3 f = fract(x);
			 
				// For performance, compute the base input to a 1D hash from the integer part of the argument and the 
				// incremental change to the 1D based on the 3D -> 1D wrapping
				float n = dot(i, step);
			
				vec3 u = f * f * (3.0 - 2.0 * f);
				return mix(mix(mix( hash1(n + dot(step, vec3(0, 0, 0))), hash1(n + dot(step, vec3(1, 0, 0))), u.x),
							   mix( hash1(n + dot(step, vec3(0, 1, 0))), hash1(n + dot(step, vec3(1, 1, 0))), u.x), u.y),
						   mix(mix( hash1(n + dot(step, vec3(0, 0, 1))), hash1(n + dot(step, vec3(1, 0, 1))), u.x),
							   mix( hash1(n + dot(step, vec3(0, 1, 1))), hash1(n + dot(step, vec3(1, 1, 1))), u.x), u.y), u.z);
			}`,[t]),i=new mt(`vec3 hash3(vec3 x) {
				x = vec3(dot(x,vec3(127.1, 311.7, 74.7)),
						 dot(x,vec3(269.5, 183.3, 246.1)),
						 dot(x,vec3(113.5, 271.9, 124.6)));
			
				return fract(sin(x)*43758.5453123);
			}`),n=new mt(`vec3 voronoiNoise(in vec3 x)
			{
				vec3 p = floor(x);
				vec3 f = fract(x);

				float id = 0.0;
				vec2 res = vec2(100.0);

				for(int k=-1; k<=1; k++)
				for(int j=-1; j<=1; j++)
				for(int i=-1; i<=1; i++)
				{
					vec3 b = vec3(float(i), float(j), float(k));

					// Comment out the "+ hash(p + b);" part below to get "square" cells
					vec3 r = vec3(b) - f + hash3(p + b);
					float d = dot(r, r);

					if (d < res.x)
					{
						id = dot(p + b, vec3(1.0, 57.0, 113.0));
						res = vec2(d, res.x);			
					}
					else if (d < res.y)
					{
						res.y = d;
					}
				}

				return vec3(sqrt(res), abs(id));
			}
			`,[i]);return{toon:new mt(`vec3 toon(int positioning, vec4 colors[COLORS_MAX], float steps[COLORS_MAX], vec3 source, bool isWorldSpace, float noiseStrength, float noiseScale, vec4 shadowColor, vec3 offset, float mask, float alpha, out float calpha) {
				float t = 0.0;
				float shadow = 1.0;

				if (positioning == 0) {

					// Can't do this mode if lighting is "none"
					#if (defined(PHONG) || defined(LAMBERT) || defined(STANDARD))

						// Algorithm from Chapter 10 of Graphics Shaders
						const vec3 weights = vec3(0.2125, 0.7154, 0.0721);
						vec3 lpos;
						vec3 l;
						float dproduct;

						#if (NUM_POINT_LIGHTS > 0)

							#if defined(USE_SHADOWMAP) && (NUM_POINT_LIGHT_SHADOWS > 0)
								PointLightShadow pointLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_POINT_LIGHTS; i++) {
								// Light positions are in view-space for some reason?
								lpos = (inverse(viewMatrix) * vec4(pointLights[UNROLLED_LOOP_INDEX].position, 1.0)).xyz;
								l = normalize(lpos - worldPosition);
								
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								
								// TODO: we want to use "intensity" but it isn't available in the shader code
								//dproduct += dot(pointLights[UNROLLED_LOOP_INDEX].color, weights);

								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS)
									pointLightShadow = pointLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getPointShadow( 
											pointShadowMap[UNROLLED_LOOP_INDEX], 
											pointLightShadow.shadowMapSize, 
											pointLightShadow.shadowBias, 
											pointLightShadow.shadowRadius,
											vPointShadowCoord[UNROLLED_LOOP_INDEX], 
											pointLightShadow.shadowCameraNear, 
											pointLightShadow.shadowCameraFar);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						#if NUM_DIR_LIGHTS > 0 
							
							#if defined(USE_SHADOWMAP) && (NUM_DIR_LIGHT_SHADOWS > 0)
								DirectionalLightShadow directionalLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_DIR_LIGHTS; i++) {
								// Use the direction vector for directional lights instead
								l = (inverse(viewMatrix) * vec4(directionalLights[UNROLLED_LOOP_INDEX].direction, 0.0)).xyz;
		
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS)
									directionalLightShadow = directionalLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getShadow( 
										UNROLLED_LOOP_INDEX,
										directionalShadowMap[UNROLLED_LOOP_INDEX], 
										directionalLightShadow.shadowMapSize, 
										directionalLightShadow.shadowBias, 
										directionalLightShadow.shadowRadius, 
										vDirectionalShadowCoord[UNROLLED_LOOP_INDEX]);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						#if NUM_SPOT_LIGHTS > 0 
							
							#if defined(USE_SHADOWMAP) && (NUM_SPOT_LIGHT_SHADOWS > 0)
								SpotLightShadow spotLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_SPOT_LIGHTS; i++) {
								lpos = (inverse(viewMatrix) * vec4(spotLights[UNROLLED_LOOP_INDEX].position, 1.0)).xyz;
								l = normalize(lpos - worldPosition);
								
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS)
									spotLightShadow = spotLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getShadow(
										UNROLLED_LOOP_INDEX,
										spotShadowMap[UNROLLED_LOOP_INDEX], 
										spotLightShadow.shadowMapSize, 
										spotLightShadow.shadowBias, 
										spotLightShadow.shadowRadius, 
										vSpotLightCoord[UNROLLED_LOOP_INDEX]);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						t = clamp(t, 0.0, 1.0);
				
					#endif

				} else if (positioning == 1) {
					
					vec3 origin = mix(position, worldPosition, float(isWorldSpace));
					vec3 direction = normalize(source - origin);
					t = dot(direction, normalize(worldNormal)) * 0.5 + 0.5;	

				} else {

					vec3 origin = worldPosition;
					vec3 source = cameraPosition - offset;
					vec3 direction = normalize(source - origin);
					t = dot(direction, normalize(worldNormal)) * 0.5 + 0.5;	
					
				}

				if (noiseStrength > 0.0) {
					// Distort with noise
					vec3 st = position / noiseScale;
					
					// Voronoi "smooth" noise
					float noise = 1.0 - voronoiNoise(st).x;

					// Voronoi cellular noise
					//float noise = 1.0 - rand(voronoiNoise(st).z);

					// Position warp noise
					// vec3 offset = vec3(
					// 	simplex3d(st),
					// 	simplex3d(st + vec3(111.1, 143.89, 217.19)),
					// 	simplex3d(st + vec3(171.1, 247.89, 117.23))
					// );
					// st += offset;
					// float noise = valueNoise(st);

					t += noise * noiseStrength;
				}

				t = clamp(t, 0.0, 1.0);

				// Compute ramp color
				float p;
				vec4 color = colors[0];
				for (int i = 1; i < COLORS_MAX; i++) {
					p = clamp((t - steps[i-1]) / (steps[i] - steps[i-1]), 0.0, 1.0);
					color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
				}

				// Incorporate custom shadow color
				if (positioning == 0) {

					vec3 blendedShadow = mix(color.rgb, shadowColor.rgb, shadowColor.a);
					color.rgb = mix(blendedShadow, color.rgb, shadow);
				
				}

				// Accumulate alpha as usual
				float lalpha = alpha * color.a * mask;
				calpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);
				accumAlpha += (1.0 - accumAlpha) * lalpha;

				return color.xyz;

            }`,[Xa.simplex,e,r,n])}}();var dLe=function(){return{textureBicubic:new mt(`float w0( float a ) {
            return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
        }
    
        float w1( float a ) {
            return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
        }
    
        float w2( float a ){
            return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
        }
    
        float w3( float a ) {
            return ( 1.0 / 6.0 ) * ( a * a * a );
        }
    
        // g0 and g1 are the two amplitude functions
        float g0( float a ) {
            return w0( a ) + w1( a );
        }
    
        float g1( float a ) {
            return w2( a ) + w3( a );
        }
    
        // h0 and h1 are the two offset functions
        float h0( float a ) {
            return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
        }
    
        float h1( float a ) {
            return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
        }
    
        vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
            uv = uv * texelSize.zw + 0.5;
    
            vec2 iuv = floor( uv );
            vec2 fuv = fract( uv );
    
            float g0x = g0( fuv.x );
            float g1x = g1( fuv.x );
            float h0x = h0( fuv.x );
            float h1x = h1( fuv.x );
            float h0y = h0( fuv.y );
            float h1y = h1( fuv.y );
    
            vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
            vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
            vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
            vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
    
            return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) + 
                   g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
        }

        vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
            vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
            vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
            vec2 fLodSizeInv = 1.0 / fLodSize;
            vec2 cLodSizeInv = 1.0 / cLodSize;
            vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
            vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
            return mix( fSample, cSample, fract( lod ) );
        }`)}}();function hLe(e,t){return e>=t?new ye(t/e,1):new ye(1,e/t)}var l9=class extends ni{constructor(e,t,r,i,n,a,o,s){super("v3"),this.nodeType="Transmission",this.thickness=e,this.ior=t,this.roughness=r,this.transmissionSamplerSize=i,this.transmissionSamplerMap=n,this.transmissionDepthMap=a,this.aspectRatio=o,this.alpha=s,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.extensions.shaderTextureLOD=!0,e.extensions.derivatives=!0,e.isShader("fragment")){e.define("NUM_SAMPLES",6),e.define("BLUR_SLOD",Math.pow(2,Vt.transmissionLod.value)),e.require("worldPosition"),e.requires.worldNormal=!0,e.requires.modelMatrix=!0,e.requires.projectionMatrix=!0,e.addFragmentVariable(this.calpha,"float");let r=e.include(l9.Nodes.transmission),i=[];return i.push(this.thickness.build(e,"f")),i.push(this.ior.build(e,"f")),i.push(this.roughness.build(e,"f")),i.push(this.transmissionSamplerSize.build(e,"v2")),i.push(this.transmissionSamplerMap.getTexture(e,"t")),i.push(this.transmissionDepthMap.getTexture(e,"t")),i.push(this.aspectRatio.build(e,"v2")),i.push("normal"),i.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.calpha),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("TransmissionNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},c9=l9;c9.Nodes=function(){let e=new mt(`vec3 blur(sampler2D sp, vec2 U, vec2 scale, float lod, sampler2D dm, vec2 unrefractedU, vec2 aspectRatio) {
                // Slightly modified version of this:
                // https://www.shadertoy.com/view/ltScRG

				// Special case for blur == 0.0
				if (lod == 0.0) {
					#ifdef TEXTURE_LOD_EXT
					return texture2DLodEXT( sp, U, 0.0).rgb;
					#else
					return textureLod( sp, U, 0.0).rgb;
					#endif
				}
				
				vec2 texelSize = vec2(1.0) / resolution;
                vec2 halton = haltonSequence[frameIndex];
                float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
                float temporalAngle  = temporalOffset * PI2;
				vec3 res = vec3(0.0);
                vec2 uv = vec2(0.0);
                vec2 offset = vec2(0.0);
                vec2 vogelSample = vec2(0.0);
                for (int i = 0; i < NUM_SAMPLES; i++) {
                    vogelSample =  vogelDiskSample(i, NUM_SAMPLES, temporalAngle) * texelSize;
                    offset = vogelSample * scale * (lod * 10.0); // TODO: used to be hardcoded to 20
                    uv = U + offset;
                    float opaqueDepth = unpackRGBAToDepth(textureLod(dm, uv, lod));
                    if (opaqueDepth != 0.0 && opaqueDepth < gl_FragCoord.z) {
                        uv = unrefractedU;
                        lod = lod > 4.0 ? lod : lod / 2.0;
                    }
                    res += textureLod(sp, uv, lod).rgb;
                }
                return res / float(NUM_SAMPLES);
            }`),t=new mt(`vec3 getVolumeTransmissionRay( vec3 n, vec3 v, float thickness, float ior, mat4 modelMatrix ) {
		        // Direction of refracted light.
		        vec3 refractionVector = refract( -v,  n, 1.0 / ior );
		        
				// Compute rotation-independant scaling of the model matrix.
		        vec3 modelScale;
		        modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		        modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		        modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );

		        // The thickness is specified in local space
		        return normalize( refractionVector ) * thickness * modelScale;
	        }`),r=new mt(`float applyIorToRoughness( float roughness, float ior ) {
				// Scale roughness with IOR so that an IOR of 1.0 results in no microfacet refraction and
				// an IOR of 1.5 results in the default amount of microfacet refraction.
				return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
			}`),i=new mt(`vec3 getTransmissionSample( vec2 fragCoord, float roughness, float ior, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 unrefractedCoords, vec2 aspectRatio) {
				// Threejs exports do not pass a depth map to this shader, so we have to fallback to the "Threejs method of blurring" - see
				// also the code in convertTransmission.ts, which runs during export
				#ifdef IS_THREEJS_EXPORT
					float lod = log2(transmissionSamplerSize.x) * applyIorToRoughness(roughness / 5.0, ior);
					return textureBicubic(transmissionSamplerMap, fragCoord.xy, lod).rgb;
				#else
					float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
					float lod = applyIorToRoughness(roughness, ior);
					return blur(transmissionSamplerMap, fragCoord, vec2(lod), min(framebufferLod / 5.5, 8.5), transmissionDepthMap, unrefractedCoords, aspectRatio);
				#endif
			}`,[dLe.textureBicubic,r,e]),n=new mt(`vec3 getIBLVolumeRefraction( vec3 n, vec3 v, float roughness, vec3 position, mat4 modelMatrix, mat4 viewMatrix, mat4 projMatrix, float ior, float thickness, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 aspectRatio ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;

				// Project refracted vector on the framebuffer, while mapping to normalized device coordinates.
				vec4 ndcPos = projMatrix * viewMatrix *  vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;

				vec4 ndcPosUnrefracted = projMatrix * viewMatrix * vec4(position, 1.0 );
				vec2 unrefractedCoords = ndcPosUnrefracted.xy / ndcPosUnrefracted.w;
				unrefractedCoords += 1.0;
				unrefractedCoords /= 2.0;

				// Sample framebuffer to get pixel the refracted ray hits.
				return getTransmissionSample( refractionCoords, roughness, ior, transmissionSamplerSize, transmissionSamplerMap, transmissionDepthMap, unrefractedCoords, aspectRatio );
    		}`,[i,t]);return{transmission:new mt(`vec3 transmission(float thickness, float ior, float roughness, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 aspectRatio, vec3 normal, float mask, float alpha, out float calpha) {
                vec3 v = vec3(0.);
                if (isOrthographic) {
                    v = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
                } else {
                    v = normalize(vWPosition - cameraPosition);
                }
                vec3 transmission = getIBLVolumeRefraction(vWNormal, -v, roughness,  vWPosition, modelMatrix, viewMatrix, projectionMatrix, ior, thickness, transmissionSamplerSize, transmissionSamplerMap, transmissionDepthMap, aspectRatio );
                
				float lalpha = alpha * mask;
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += ( 1.0 - accumAlpha ) * alpha;

				return transmission;
            }`,[n])}}();var zE=(e=>(e.NOISE="noise",e.MAP="map",e))(zE||{}),u9=class extends ni{constructor(e,t,r,i,n,a,o,s,l,c,u){super("v3"),this.displacementTypeIndex=new si(0),this.nodeType="VertexDisplacement",this.intensity=e,this.movementOrTexture=t,Object.values(zE)[this.displacementTypeIndex.value]==="map"&&(this.mat=new GW(this.movementOrTexture.value.matrix)),this.cropOrOffset=r,this.scale=c,this.noiseFunctionIndex=u,this.voronoiStyle=i,this.smoothness=n,this.seed=a,this.highCut=o,this.lowCut=s,this.quality=l}generate(e,t){if(e.isShader("vertex")){e.define("USE_LAYER_DISPLACE");let r,i=[];switch(i.push("displaced_position"),i.push("displaced_normal"),Object.values(zE)[this.displacementTypeIndex.value]){case"map":{r=e.include(u9.Nodes.map),i.push(this.movementOrTexture.getTexture(e,"t")),i.push("uv"),i.push(this.cropOrOffset.build(e,"f")),this.mat&&i.push(this.mat.build(e,"mat3"));break}case"noise":{let n=Object.values(HD)[this.noiseFunctionIndex.value],a=new mt(`vec3 orthogonal(vec3 v) {
							return normalize(abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0) : vec3(0.0, -v.z, v.y));
						}`),o=n=="voronoi"?`
					float v = ${n}((p + offset) * scale * 0.001 + neighbour_offset + (movement * 0.1), voronoiStyle, smoothness, seed, quality);
					v = remap(v, lowCut, highCut, 0.0, 1.0);
					v = smax(v, 0.0, smoothness * 0.25);
					v = smin(v, 1.0, smoothness * 0.25);

					return p + n * v * intensity;
					`:`
					return p + n * ${n}((p + offset) * scale * 0.001 + neighbour_offset + (movement * 0.1)) * intensity;
					`,s=new mt(`vec3 distorted(vec3 p, vec3 n, float scale, float intensity, vec3 offset, float neighbour_offset, float movement, int voronoiStyle, float smoothness, float seed, float highCut, float lowCut, int quality) {
							${o}
						}`,[Xa.simplex,Xa.simplexFractal,Xa.simplexAshima,Xa.fbm,Xa.perlin,Xa.voronoi]),l=new mt(`vec3 vertexDisplacementNoise(vec3 position, vec3 normal, float scale, vec3 offset, float movement, int voronoiStyle, float smoothness, float seed, float highCut, float lowCut, int quality, float intensity, out vec3 displaced_normal) {
							vec3 displaced_position = distorted(position, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);
							vec3 tangent1 = orthogonal(normal);
							vec3 tangent2 = normalize(cross(normal, tangent1));

                            // TODO(Max): The distance to the neighbors was originally scaled by 0.1.
                            // This caused some small oval/circular visual artifacts in the lighting.
                            // For now, simply using neighbors further away betters the problem,
                            // but we should figure out the underlying cause when we have some time.
                            // Maybe its related to how we calculate the tangent and bitangent?
							vec3 nearby1 = position + tangent1;
							vec3 nearby2 = position + tangent2;
							vec3 distorted1 = distorted(nearby1, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);
							vec3 distorted2 = distorted(nearby2, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);
							displaced_normal = normalize(cross(distorted1 - displaced_position, distorted2 - displaced_position));
							return displaced_position;
						}`,[s,a]);r=e.include(l),i.push(this.scale.build(e,"f")),i.push(this.cropOrOffset.build(e,"v3")),i.push(this.movementOrTexture.build(e,"f")),i.push(this.voronoiStyle.build(e,"i")),i.push(this.smoothness.build(e,"f")),i.push(this.seed.build(e,"f")),i.push(this.highCut.build(e,"f")),i.push(this.lowCut.build(e,"f")),i.push(this.quality.build(e,"i"));break}}return i.push(this.intensity.build(e,"f")),i.push("displaced_normal"),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("VertexDisplacementNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},d9=u9;d9.Nodes=function(){let e=new mt(`vec3 orthogonal(vec3 v) {
				return normalize(abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0) : vec3(0.0, -v.z, v.y));
			}`),t=new mt(`float displacementMapTexture(sampler2D tex, float crop, vec2 uv, mat3 mat, vec2 offset) {
				vec2 uvs = (mat * vec3(uv * 2.0 - 1.0, 1.0) / 2.0 + 0.5).xy + offset;
				vec4 tmp = texture2D(tex, uvs);
				vec3 col = tmp.rgb;
				if (crop > 0.5) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						return 0.0;
					}
				}
				return col.r;
			}`);return{map:new mt(`vec3 vertexDisplacementMap(vec3 position, vec3 normal, sampler2D tex, vec2 uv, float crop, mat3 mat, float intensity, out vec3 displaced_normal) {
				vec3 displaced_position = position + normal * displacementMapTexture(tex, crop, uv, mat, vec2(0.0)) * intensity;
				vec3 tangent1 = normalize(orthogonal(normal));
				vec3 tangent2 = normalize(cross(normal, tangent1));
				vec3 nearby1 = position + tangent1 * 0.1;
				vec3 nearby2 = position + tangent2 * 0.1;
				vec3 distorted1 = nearby1 + normal * displacementMapTexture(tex, crop, uv, mat, vec2(neighbor_offset)) * intensity;
				vec3 distorted2 = nearby2 + normal * displacementMapTexture(tex, crop, uv, mat, vec2(neighbor_offset)) * intensity;
				displaced_normal = normalize(cross(distorted1 - displaced_position, distorted2 - displaced_position));
				return displaced_position;
			}`,[e,t])}}();var Vt={normalRenderTarget:new Ql,normalRenderTargetDepth:new Ql,transmissionRenderTarget:new Ql,aspectRatio:new Zn,transmissionSize:new Zn(2048,2048),transmissionRenderTargetDepth:new Ql,aoRenderTarget:new Ql,aoEnabled:new Ia,pixelRatioNode:new Ct(1),resolution:new Zn,penumbraSize:new bd(5,.5),frameIndex:new si(0),transmissionLod:new si(2)};for(let e of Object.values(Vt))e.isRenderGlobal=!0;var h9={skiaWasmUrl:"https://unpkg.com/@splinetool/ui-wasm@1.9.21/build/ui.wasm"},WD=class extends gn{constructor(){super("basic"),this.nodeType="Basic",this.color=new Ni(go),this.shadingAlpha=new Ct(1),this.shadingBlend=new si(0),this.previousModelViewMatrix=new vl,this.previouseProjectionMatrix=new vl}get category(){return"phong"}generate(e){let t;if(e.isShader("vertex")){let r=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:Vt.frameIndex}),e.mergeUniform({resolution:Vt.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(sm.merge([ft.fog])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <normal_pars_vertex>"].join(`
`));let i=["#include <beginnormal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#if defined( USE_LAYER_DISPLACE )
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <begin_vertex>
				#endif /* !USE_LAYER_DISPLACE */
				`];r&&i.push(r.code,r.result?"displaced_position = "+r.result+";":""),i.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","	vNormal = transformedNormal;","#endif"),i.push("#include <project_vertex>","#include <fog_vertex>","#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=i.join(`
`)}else{this.color===void 0&&(this.color=new Ni(go)),this.color.analyze(e,{slot:"color"}),this.alpha&&this.alpha.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"});let r=this.color.flow(e,"c",{slot:"color"}),i=this.alpha?this.alpha.flow(e,"f"):void 0,n=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0,a=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0;e.requires.transparent=i!==void 0,e.addParsCode(["varying vec3 vWPosition;","#include <fog_pars_fragment>","#include <dithering_pars_fragment>","varying vec3 vViewPosition;","#include <normal_pars_fragment>"].join(`
`));let o=["#include <normal_fragment_begin>",r.code];i&&o.push(i.code,"#ifdef ALPHATEST"," if ( "+i.result+" <= ALPHATEST ) discard;","#endif"),a?o.push(a.code,`vec3 outgoingLight = ${r.result};`,`vec3 finalColor = spe_blend(outgoingLight, ${a.result}, 1.0, SPE_BLENDING_NORMAL);`):o.push(`vec3 finalColor = ${r.result};`);let s="1.0";this.mask&&(this.mask.analyze(e),s=`luminance(${this.mask.flow(e,"v3").result})`),i?o.push(`gl_FragColor = vec4( finalColor, accumAlpha * ${i.result} * ${s} );`):o.push("gl_FragColor = vec4("+r.result+", 1.0 );"),n&&o.push(`gl_FragColor.a *= ${n.result};`),o.push("#include <fog_fragment>","#include <dithering_fragment>"),t=o.join(`
`)}return t}},fLe=class extends gn{constructor(){super("lambert"),this.nodeType="Lambert",this.color=new Ni(go),this.emissive=new Ni(0),this.emissiveIntensity=new Ct(1),this.previousModelViewMatrix=new vl,this.previouseProjectionMatrix=new vl,this.shadingAlpha=new Ct(1),this.shadingBlend=new si(0),this.occlusion=new Ia(!0)}get category(){return"lambert"}build(e){let t;if(e.define("LAMBERT"),e.requires.lights=!0,e.extensions.derivatives=!0,e.isShader("vertex")){let r=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:Vt.frameIndex}),e.mergeUniform({resolution:Vt.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(sm.merge([ft.fog,ft.lights])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","varying vec3 vLightFront;","varying vec3 vIndirectFront;","#ifndef DOUBLE_SIDED","   #define DOUBLE_SIDED","#endif","#ifdef DOUBLE_SIDED","	varying vec3 vLightBack;","	varying vec3 vIndirectBack;","#endif","#include <bsdfs>","#include <lights_pars_begin>","#include <color_pars_vertex>","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let i=["#include <beginnormal_vertex>",`
				#include <skinbase_vertex>
				#include <skinnormal_vertex>
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = objectNormal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];r&&i.push(r.code,r.result?"displaced_position = "+r.result+";":""),i.push("transformed = displaced_position;","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),i.push("	#include <project_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>",`
					vec3 diffuse = vec3( 1.0 );
					GeometricContext geometry;
					geometry.position = mvPosition.xyz;
					geometry.normal = normalize( transformedNormal );
					geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
				`),i.push(`
					GeometricContext backGeometry;
					backGeometry.position = geometry.position;
					backGeometry.normal = -geometry.normal;
					backGeometry.viewDir = geometry.viewDir;
					vLightFront = vec3( 0.0 );
					vIndirectFront = vec3( 0.0 );
					#ifdef DOUBLE_SIDED
						vLightBack = vec3( 0.0 );
						vIndirectBack = vec3( 0.0 );
					#endif
					IncidentLight directLight;
					float dotNL;
					vec3 directLightColor_Diffuse;
					vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
					vIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );
					#ifdef DOUBLE_SIDED
						vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
						vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );
					#endif
					#if NUM_POINT_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
							getPointLightInfo( pointLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_SPOT_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
							getSpotLightInfo( spotLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_DIR_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
							getDirectionalLightInfo( directionalLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_HEMI_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
							vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
							#ifdef DOUBLE_SIDED
								vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );
							#endif
						}
						#pragma unroll_loop_end
					#endif
				`,"	#include <shadowmap_vertex>","	#include <fog_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=i.join(`
`)}else{e.mergeUniform({penumbraSize:Vt.penumbraSize}),e.mergeUniform({frameIndex:Vt.frameIndex}),e.mergeUniform({aoMap:Vt.aoRenderTarget}),e.mergeUniform({aoEnabled:Vt.aoEnabled}),this.color===void 0&&(this.color=new Ni(go)),this.color.analyze(e,{slot:"color"}),this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e);let r=this.color.flow(e,"c",{slot:"color"}),i=this.emissive.flow(e,"c",{slot:"emissive"}),n=this.emissiveIntensity.flow(e,"f",{slot:"emissive"}),a=this.occlusion.flow(e,"b",{slot:"occlusion"}),o=this.shadingAlpha.flow(e,"f"),s=this.shadingBlend.flow(e,"i"),l=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,c=this.alpha?this.alpha.flow(e,"f"):void 0,u=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0;e.requires.transparent=c!==void 0,e.addParsCode(["uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","varying vec3 vViewPosition;","varying vec3 vWPosition;","varying vec3 vLightFront;","varying vec3 vIndirectFront;","#ifndef DOUBLE_SIDED","   #define DOUBLE_SIDED","#endif","#include <normal_pars_fragment>","#ifdef DOUBLE_SIDED","	varying vec3 vLightBack;","	varying vec3 vIndirectBack;","#endif","#include <bsdfs>","#include <lights_pars_begin>","#include <fog_pars_fragment>","#include <shadowmap_pars_fragment>","#include <shadowmask_pars_fragment>","#include <clipping_planes_pars_fragment>","#include <dithering_pars_fragment>"].join(`
`));let d=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx, viewdy));
				bool isFrontFacing = (dot(normal, faceNormal) >= 0.0);
				`,"#include <clipping_planes_fragment>"];d.push(r.code,"vec3 diffuseColor = "+r.result+";","ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );"),c&&d.push(c.code,"#ifdef ALPHATEST","if ( "+c.result+" <= ALPHATEST ) discard;","#endif"),d.push("#ifdef DOUBLE_SIDED","	reflectedLight.indirectDiffuse += ( isFrontFacing ) ? vIndirectFront : vIndirectBack;","#else","	reflectedLight.indirectDiffuse += vIndirectFront;","#endif","#include <lightmap_fragment>","reflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );","#ifdef DOUBLE_SIDED","	reflectedLight.directDiffuse = ( isFrontFacing ) ? vLightFront : vLightBack;","#else","	reflectedLight.directDiffuse = vLightFront;","#endif","reflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();"),i&&d.push(i.code,"reflectedLight.directDiffuse += "+i.result+" * "+n.result+";"),d.push("vec3 ao = aoEnabled && "+a.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = (reflectedLight.directDiffuse + reflectedLight.indirectDiffuse) ;");let h="1.0";this.mask&&(this.mask.analyze(e),h=`luminance(${this.mask.flow(e,"v3").result})`),d.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${o.result} * ${h} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${o.result} * ${h}, ${s.result} );

					outgoingLight *= ao;
				}
				`),l&&d.push(l.code,`outgoingLight = spe_blend(outgoingLight, ${l.result}, 1.0, SPE_BLENDING_NORMAL);`),c?d.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${c.result} );`):d.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),u&&d.push(`gl_FragColor.a *= ${u.result};`),d.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=d.join(`
`)}return t}},Yp=function(){let e=new mt(`vec2 dHdxy(sampler2D bumpMap, vec2 bumpMapUv, float bumpScale) {

            // Gradient of UVs w.r.t. X coordinate (in screen-space)
            vec2 dSTdx = dFdx(bumpMapUv);

            // Gradient of UVs w.r.t. Y coordinate (in screen-space)
            vec2 dSTdy = dFdy(bumpMapUv);
            
            // Forward differencing
            float Hll = bumpScale * luminance(texture(bumpMap, bumpMapUv).rgb);
            float dBx = bumpScale * luminance(texture(bumpMap, bumpMapUv + dSTdx).rgb) - Hll;
            float dBy = bumpScale * luminance(texture(bumpMap, bumpMapUv + dSTdy).rgb) - Hll;
            
            return vec2( dBx, dBy );
        }`),t=new mt(`vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
            vec3 vSigmaX = dFdx( surf_pos.xyz );
            vec3 vSigmaY = dFdy( surf_pos.xyz );
            vec3 vN = surf_norm; // normalized
            
            vN = normalize(vN);

            vec3 R1 = cross( vSigmaY, vN );
            vec3 R2 = cross( vN, vSigmaX );

            R1 = normalize(R1);
            R2 = normalize(R2);
    
            float fDet = dot( vSigmaX, R1 ) * faceDirection;
    
            vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
            return normalize( abs( fDet ) * vN - vGrad );
        }`);return{dHdxy:e,perturbNormalArb:t}}(),pLe=class extends gn{constructor(){super("phong"),this.nodeType="Phong",this.color=new Ni(go),this.specular=new Ni(1118481),this.shininess=new Ct(30),this.previousModelViewMatrix=new vl,this.previouseProjectionMatrix=new vl,this.shadingAlpha=new Ct(1),this.shadingBlend=new si(0),this.occlusion=new Ia(!0)}get category(){return"phong"}build(e){let t;if(e.define("PHONG"),e.requires.lights=!0,e.extensions.derivatives=!0,e.isShader("vertex")){let r=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:Vt.frameIndex}),e.mergeUniform({resolution:Vt.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(sm.merge([ft.fog,ft.lights])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let i=["#include <beginnormal_vertex>",`
				#include <skinbase_vertex>
				#include <skinnormal_vertex>
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = objectNormal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];r&&i.push(r.code,r.result?"displaced_position = "+r.result+";":""),i.push("transformed = displaced_position;","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),i.push("	#include <project_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>","	#include <shadowmap_vertex>","	#include <fog_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=i.join(`
`)}else{e.mergeUniform({penumbraSize:Vt.penumbraSize}),e.mergeUniform({frameIndex:Vt.frameIndex}),e.mergeUniform({aoMap:Vt.aoRenderTarget}),e.mergeUniform({aoEnabled:Vt.aoEnabled}),this.color===void 0&&(this.color=new Ni(go)),this.color.analyze(e,{slot:"color"}),this.specular.analyze(e),this.shininess.analyze(e);let r=this.occlusion.flow(e,"b",{slot:"occlusion"});this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e);let i=this.color.flow(e,"c",{slot:"color"}),n=this.specular.flow(e,"c"),a=this.shininess.flow(e,"f"),o=this.shadingAlpha.flow(e,"f"),s=this.shadingBlend.flow(e,"i"),l=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,c=this.alpha?this.alpha.flow(e,"f"):void 0,u=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0;e.requires.transparent=c!==void 0,e.addParsCode(["varying vec3 vWPosition;","uniform vec3 emissive;","uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","#include <normal_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_phong_pars_fragment>","#include <shadowmap_pars_fragment>","#include <dithering_pars_fragment>"].join(`
`));let d=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	BlinnPhongMaterial material;"];if(this.bumpMap){e.include(Yp.dHdxy),e.include(Yp.perturbNormalArb);let f=this.bumpMap.texture.flow(e,"t"),p=this.bumpMap.flow(e,"v3"),v=this.bumpMapIntensity?this.bumpMapIntensity.flow(e,"f").result:"1.0",m="";this.bumpMap.projection.value===4?m=`
					vec3 bumpNormal = vec3(0.0);
					{
						vec2 uv0 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						vec2 grad0 = dHdxy(${f.result}, uv0, ${v});
						vec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);

						vec2 grad1 = dHdxy(${f.result}, uv1, ${v});
						vec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);

						vec2 grad2 = dHdxy(${f.result}, uv2, ${v});
						vec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);
						
						bumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;
						bumpNormal = normalize(bumpNormal);
					}

					normal = bumpNormal;
					`:m=`
					vec2 bumpMapCachedUv = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs;
					vec2 grad = dHdxy(${f.result}, bumpMapCachedUv, ${v});
					normal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );
					`,d.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${p.result};
					${m}
					`)}d.push(i.code,"	vec3 diffuseColor = "+i.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );","	vec3 totalEmissiveRadiance = emissive;",n.code,"	vec3 specular = "+n.result+";",a.code,"	float shininess = max( 0.0001, "+a.result+" );","	float specularStrength = 1.0;"),c&&d.push(c.code,"#ifdef ALPHATEST","if ( "+c.result+" <= ALPHATEST ) discard;","#endif"),d.push("material.diffuseColor = diffuseColor;"),d.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),d.push("vec3 ao = aoEnabled && "+r.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse)) + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;");let h="1.0";this.mask&&(this.mask.analyze(e),h=`luminance(${this.mask.flow(e,"v3").result})`),d.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${o.result} * ${h} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${o.result} * ${h}, ${s.result} );
					
					outgoingLight *= ao;
				}
				`),l&&d.push(l.code,`outgoingLight = spe_blend(outgoingLight, ${l.result}, 1.0, SPE_BLENDING_NORMAL);`),c?d.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${c.result});`):d.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),u&&d.push(`gl_FragColor.a *= ${u.result};`),d.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=d.join(`
`)}return t}},mLe=class extends gn{constructor(){super("standard"),this.nodeType="Standard",this.color=new Ni(go),this.roughness=new Ct(.3),this.metalness=new Ct(0),this.reflectivity=new Ct(.5),this.previousModelViewMatrix=new vl,this.previouseProjectionMatrix=new vl,this.shadingAlpha=new Ct(1),this.shadingBlend=new si(0),this.occlusion=new Ia(!0)}get category(){return"physical"}build(e){let t;if(e.define("STANDARD"),e.requires.lights=!0,e.extensions.derivatives=!0,e.extensions.shaderTextureLOD=!0,e.isShader("vertex")){let r=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:Vt.frameIndex}),e.mergeUniform({resolution:Vt.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(sm.merge([ft.fog,ft.lights])),ft.LTC_1&&(e.uniforms.ltc_1={value:void 0},e.uniforms.ltc_2={value:void 0}),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let i=["#include <beginnormal_vertex>",`
				#include <skinbase_vertex>
				#include <skinnormal_vertex>
				#if !defined( USE_LAYER_DISPLACE )
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = objectNormal;

				#if defined( USE_LAYER_DISPLACE )
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <begin_vertex>
				#endif /* !USE_LAYER_DISPLACE */
				`];r&&i.push(r.code,r.result?"displaced_position = "+r.result+";":""),i.push("transformed = displaced_position;","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),i.push("#include <project_vertex>","#include <fog_vertex>","#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>","#include <shadowmap_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=i.join(`
`)}else{e.mergeUniform({penumbraSize:Vt.penumbraSize}),e.mergeUniform({frameIndex:Vt.frameIndex}),e.mergeUniform({aoMap:Vt.aoRenderTarget}),e.mergeUniform({aoEnabled:Vt.aoEnabled});let r={gamma:!0};this.color===void 0&&(this.color=new Ni(go)),this.color.analyze(e,{slot:"color",context:r}),this.roughness.analyze(e),this.metalness.analyze(e);let i=this.occlusion.flow(e,"b",{slot:"occlusion"});this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e),this.reflectivity&&this.reflectivity.analyze(e);let n=this.color.flow(e,"c",{slot:"color",context:r}),a=this.roughness.flow(e,"f"),o=this.metalness.flow(e,"f"),s=this.shadingAlpha.flow(e,"f"),l=this.shadingBlend.flow(e,"i"),c=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,u=this.alpha?this.alpha.flow(e,"f"):void 0,d=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0,h=this.reflectivity?this.reflectivity.flow(e,"f"):void 0;e.requires.transparent=u!==void 0,e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","#include <normal_pars_fragment>","#include <dithering_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_physical_pars_fragment>","#include <shadowmap_pars_fragment>"].join(`
`));let f=["#include <clipping_planes_fragment>","	#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	PhysicalMaterial material;","	material.diffuseColor = vec3( 1.0 );"];if(this.bumpMap){e.include(Yp.dHdxy),e.include(Yp.perturbNormalArb);let v=this.bumpMap.texture.flow(e,"t"),m=this.bumpMap.flow(e,"v3"),g=this.bumpMapIntensity?this.bumpMapIntensity.flow(e,"f").result:"1.0",y="";this.bumpMap.projection.value===4?y=`
					vec3 bumpNormal = vec3(0.0);
					{
						vec2 uv0 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						vec2 grad0 = dHdxy(${v.result}, uv0, ${g});
						vec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);

						vec2 grad1 = dHdxy(${v.result}, uv1, ${g});
						vec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);

						vec2 grad2 = dHdxy(${v.result}, uv2, ${g});
						vec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);
						
						bumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;
						bumpNormal = normalize(bumpNormal);
					}

					normal = bumpNormal;
					`:y=`
					vec2 bumpMapCachedUv = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs;
					vec2 grad = dHdxy(${v.result}, bumpMapCachedUv, ${g});
					normal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );
					`,f.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${m.result};
					${y}
					`)}if(f.push(n.code,"	vec3 diffuseColor = "+n.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );",o.code,"	float metalnessFactor = "+o.result+";"),this.roughnessMap){let v=this.roughnessMap.texture.flow(e,"t"),m=this.roughnessMap.flow(e,"v3"),g="";this.roughnessMap.projection.value===4?g=`
					float roughnessChange = 1.0;
					{
						vec2 uv0 = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						float r0 = luminance(texture(${v.result}, uv0).rgb) * roughnessScale;
						float r1 = luminance(texture(${v.result}, uv1).rgb) * roughnessScale;
						float r2 = luminance(texture(${v.result}, uv2).rgb) * roughnessScale;

						roughnessChange = (r0 * weights.z + r1 * weights.x + r2 * weights.y);
					}
					float roughnessFactor = roughnessChange * ${a.result};
					`:g=`
					vec2 roughnessMapCachedUv = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs;

					vec4 vals = texture(${v.result},  roughnessMapCachedUv);
					float roughnessFactor = luminance(vals.rgb) * ${a.result};
					`,f.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${m.result};

					const float roughnessScale = 1.0;

					${g}
				`)}else f.push(a.code,"	float roughnessFactor = "+a.result+";");u&&f.push(u.code,"#ifdef ALPHATEST","	if ( "+u.result+" <= ALPHATEST ) discard;","#endif"),f.push("vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );"),f.push("material.diffuseColor = diffuseColor * ( 1.0 - metalnessFactor );","material.roughness = max( roughnessFactor, 0.0525 );","material.roughness += geometryRoughness;","material.roughness = min( material.roughness, 1.0 );","material.roughness = clamp( roughnessFactor, 0.04, 1.0 );"),h?f.push(h.code,"material.specularColor = mix( vec3( 0.16 * pow2( "+h.result+" ) ), diffuseColor, metalnessFactor );"):f.push("material.specularColor = mix( vec3( 0.04 ), diffuseColor, metalnessFactor );"),f.push("#include <lights_fragment_begin>"),f.push("#include <lights_fragment_end>"),f.push("vec3 ao = aoEnabled && "+i.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse)) + reflectedLight.directSpecular + reflectedLight.indirectSpecular;");let p="1.0";this.mask&&(this.mask.analyze(e),p=`luminance(${this.mask.flow(e,"v3").result})`),f.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${s.result} * ${p} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${s.result} * ${p}, ${l.result} );
					
					outgoingLight *= ao;
				}
				`),c&&f.push(c.code,`outgoingLight = spe_blend(outgoingLight, ${c.result}, 1.0, SPE_BLENDING_NORMAL);`),u?f.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${u.result} );`):f.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),d&&f.push(`gl_FragColor.a *= ${d.result};`),f.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=f.join(`
`)}return t}},vLe=class extends gn{constructor(){super("toon"),this.nodeType="Toon",this.color=new Ni(go),this.specular=new Ni(1118481),this.shininess=new Ct(30),this.previousModelViewMatrix=new vl,this.previouseProjectionMatrix=new vl,this.shadingAlpha=new Ct(1),this.shadingBlend=new si(0)}get category(){return"toon"}build(e){let t;if(e.define("TOON"),e.requires.lights=!0,e.extensions.derivatives=!0,e.isShader("vertex")){let r=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:Vt.frameIndex}),e.mergeUniform({resolution:Vt.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(sm.merge([ft.fog,ft.lights])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let i=["#include <beginnormal_vertex>",`
				#include <skinbase_vertex>
				#include <skinnormal_vertex>
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = objectNormal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];r&&i.push(r.code,r.result?"displaced_position = "+r.result+";":""),i.push("transformed = displaced_position;","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),i.push("	#include <project_vertex>","	#include <fog_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>","	#include <shadowmap_vertex>","	#include <fog_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=i.join(`
`)}else{e.mergeUniform({penumbraSize:Vt.penumbraSize}),e.mergeUniform({frameIndex:Vt.frameIndex}),e.mergeUniform({aoMap:Vt.aoRenderTarget}),e.mergeUniform({aoEnabled:Vt.aoEnabled}),this.color===void 0&&(this.color=new Ni(go)),this.color.analyze(e,{slot:"color"}),this.specular.analyze(e),this.shininess.analyze(e),this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e);let r=this.color.flow(e,"c",{slot:"color"}),i=this.specular.flow(e,"c"),n=this.shininess.flow(e,"f"),a=this.shadingAlpha.flow(e,"f"),o=this.shadingBlend.flow(e,"i"),s=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,l=this.alpha?this.alpha.flow(e,"f"):void 0,c=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0;e.requires.transparent=l!==void 0,e.addParsCode(["uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","varying vec3 vWPosition;","#include <normal_pars_fragment>","#include <gradientmap_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <dithering_pars_fragment>",`
					varying vec3 vViewPosition;
					struct ToonMaterial {
						vec3	diffuseColor;
						vec3	specularColor;
						float	specularShininess;
						float	specularStrength;
					};
					void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
						vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
			
						reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
						reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
					}
					void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
						reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
					}
					#define RE_Direct				RE_Direct_Toon
					#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
					#define Material_LightProbeLOD( material )	(0)
					`,"#include <shadowmap_pars_fragment>","#include <bumpmap_pars_fragment>","#include <normalmap_pars_fragment>"].join(`
`));let u=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	ToonMaterial material;"];if(this.bumpMap){e.include(Yp.dHdxy),e.include(Yp.perturbNormalArb);let h=this.bumpMap.texture.flow(e,"t"),f=this.bumpMap.flow(e,"v3"),p=this.bumpMapIntensity?this.bumpMapIntensity.flow(e,"f").result:"1.0",v="";this.bumpMap.projection.value===4?v=`
					vec3 bumpNormal = vec3(0.0);
					{
						vec2 uv0 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						vec2 grad0 = dHdxy(${h.result}, uv0, ${p});
						vec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);

						vec2 grad1 = dHdxy(${h.result}, uv1, ${p});
						vec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);

						vec2 grad2 = dHdxy(${h.result}, uv2, ${p});
						vec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);
						
						bumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;
						bumpNormal = normalize(bumpNormal);
					}

					normal = bumpNormal;
					`:v=`
					vec2 bumpMapCachedUv = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs;
					vec2 grad = dHdxy(${h.result}, bumpMapCachedUv, ${p});
					normal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );
					`,u.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${f.result};
					${v}
					`)}u.push(r.code,"	vec3 diffuseColor = "+r.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );",i.code,"	vec3 specular = "+i.result+";",n.code,"	float shininess = max( 0.0001, "+n.result+" );","	float specularStrength = 1.0;"),l&&u.push(l.code,"#ifdef ALPHATEST","if ( "+l.result+" <= ALPHATEST ) discard;","#endif"),u.push("material.diffuseColor = diffuseColor;"),u.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),u.push("vec3 ao = aoEnabled ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse) * ao) + reflectedLight.directSpecular;");let d="1.0";this.mask&&(this.mask.analyze(e),d=`luminance(${this.mask.flow(e,"v3").result})`),u.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${a.result} * ${d} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${a.result} * ${d}, ${o.result} );
				}
				`),s&&u.push(s.code,`outgoingLight = spe_blend(outgoingLight, ${s.result}, 1.0, SPE_BLENDING_NORMAL);`),l?u.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${l.result} );`):u.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),c&&u.push(`gl_FragColor.a *= ${c.result};`),u.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=u.join(`
`)}return t}},gLe=class{constructor(e=1e3*10){this.timeout=e,this.cache=new Map,this.head={data:null,time:0,src:null,next:null,prev:null},this.tail={data:null,time:1/0,src:null,next:null,prev:null},this.hasClean=!1,this.head.next=this.tail,this.tail.prev=this.head}log(...e){}remove(e){let t=this.cache.get(e);t&&(this.dispose(e,t.data),this.cache.delete(e),t.prev.next=t.next,t.next.prev=t.prev)}scheduleCleanup(){this.hasClean||(this.log("scheduled cleanup"),this.hasClean=!0,setTimeout(()=>{this.hasClean=!1,this.log("cleaning");let e=Date.now(),t=this.head.next;for(;t.time<e-this.timeout;)this.dispose(t.src,t.data),this.cache.delete(t.src),t=t.next,t.prev=this.head,this.head.next=t;this.head.next!==this.tail?this.scheduleCleanup():this.log("no more cleanup")},this.timeout+1e3))}has(e){var t;return(t=this.cache.get(e))==null?void 0:t.data}load(e){let t=Date.now(),r=this.cache.get(e);return r===void 0?(r={data:this.create(e),src:e,time:t,next:null,prev:null},this.cache.set(e,r)):(r.time=t,r.prev.next=r.next,r.next.prev=r.prev),r.prev=this.tail.prev,r.next=this.tail,this.tail.prev.next=r,this.tail.prev=r,this.scheduleCleanup(),r.data}},yLe=class extends gLe{create(e){return URL.createObjectURL(new Blob([e]))}dispose(e,t){URL.revokeObjectURL(t)}},S_;function bLe(e){return typeof e=="string"?e:(S_||(S_=new yLe),S_.load(e))}var xLe=class{constructor(e,t){this.data=e,this.cache=t,this.refCount=0}deref(){this.refCount,this.refCount-=1,this.refCount===0&&(this.cache.remove(this),this.dispose())}dispose(){this.refCount}},wLe=class{constructor(){this.cache=new Map}remove(e){this.cache.delete(e.data)}load(e){let t=this.cache.get(e);return t===void 0&&(t=this.create(e),this.cache.set(e,t)),t.refCount+=1,t}},f9=class extends xLe{constructor(e,t){super(e,t.imageHolderCache),this.data=e,this.shared=t,this.loaded=!1,this.isVideo=!1,this.isBuffer=!1,this._cache={1e3:{},1001:{},1002:{}},this.isVideo=e.type==="video",this.isBuffer=e.isWebGLRenderTarget===!0,this.loadPromise=this.updateSrc(this.isBuffer?e:e.data)}async updateSrc(e){if(typeof document>"u")return;this.disposeTextures(),this.loaded=!1;let t=()=>{this.loaded=!0;for(let i of Object.values(this._cache))for(let n of Object.values(i))for(let a of Object.values(n))a&&(a.image=this.img,a.needsUpdate=!0);this.shared.requestRender()};if(this.isBuffer)this.img=e,this.loaded=!0;else if(this.isVideo){if(this.img=document.createElement("video"),this.img.preload="auto",this.img.playsInline=!0,this.img.currentTime=.01,typeof e!="string"){var r=new FileReader;r.readAsDataURL(new Blob([e],{type:"video/mp4"}));let i;await new Promise(n=>{r.onloadend=a=>{var o;i=(o=a.target)==null?void 0:o.result,n(null)}}),this.img.src=i}else this.img.src=e;this.img.onloadeddata=()=>{t()}}else this.img=new Image,this.img.src=bLe(e),this.img.onload=t}getTexture(e,t=1008,r=1006){var n,a;let i=(a=(n=this._cache[e])==null?void 0:n[t])==null?void 0:a[r];if(i)return i;{let o;return this.isBuffer?o=this.img.texture:this.isVideo?o=new n_e(this.img,void 0,e,e):o=new Ri(this.img,void 0,e,e,r,t),this.loaded&&(o.needsUpdate=!0),this._cache[e]===void 0&&(this._cache[e]={}),this._cache[e][t]===void 0&&(this._cache[e][t]={}),this._cache[e][t][r]=o,o}}setNeedsUpdate(e){for(let t of Object.values(this._cache))for(let r of Object.values(t))for(let i of Object.values(r))i&&(i.needsUpdate=e)}disposeTextures(){for(let[e,t]of Object.entries(this._cache))for(let[r,i]of Object.entries(t))for(let[n,a]of Object.entries(i))a==null||a.dispose(),this._cache[e]!==void 0&&this._cache[e][r]!==void 0&&(this._cache[e][r][n]=void 0)}dispose(){super.dispose(),this.disposeTextures()}},uu=class extends f9{};function SLe(e,t){var r=MLe(t);return r.formatToParts?_Le(r,e):ALe(r,e)}var CLe={year:0,month:1,day:2,hour:3,minute:4,second:5};function _Le(e,t){try{for(var r=e.formatToParts(t),i=[],n=0;n<r.length;n++){var a=CLe[r[n].type];a>=0&&(i[a]=parseInt(r[n].value,10))}return i}catch(o){if(o instanceof RangeError)return[NaN];throw o}}function ALe(e,t){var r=e.format(t).replace(/\u200E/g,""),i=/(\d+)\/(\d+)\/(\d+),? (\d+):(\d+):(\d+)/.exec(r);return[i[3],i[1],i[2],i[4],i[5],i[6]]}var C_={};function MLe(e){if(!C_[e]){var t=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:"America/New_York",year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(new Date("2014-06-25T04:00:00.123Z")),r=t==="06/25/2014, 00:00:00"||t==="06/25/2014 00:00:00";C_[e]=r?new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:e,year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):new Intl.DateTimeFormat("en-US",{hourCycle:"h23",timeZone:e,year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}return C_[e]}function p9(e,t,r,i,n,a,o){var s=new Date(0);return s.setUTCFullYear(e,t,r),s.setUTCHours(i,n,a,o),s}var r4=36e5,ELe=6e4,__={timezone:/([Z+-].*)$/,timezoneZ:/^(Z)$/,timezoneHH:/^([+-]\d{2})$/,timezoneHHMM:/^([+-]\d{2}):?(\d{2})$/};function m9(e,t,r){var i,n;if(!e||(i=__.timezoneZ.exec(e),i))return 0;var a;if(i=__.timezoneHH.exec(e),i)return a=parseInt(i[1],10),i4(a)?-(a*r4):NaN;if(i=__.timezoneHHMM.exec(e),i){a=parseInt(i[1],10);var o=parseInt(i[2],10);return i4(a,o)?(n=Math.abs(a)*r4+o*ELe,a>0?-n:n):NaN}if(DLe(e)){t=new Date(t||Date.now());var s=r?t:TLe(t),l=kE(s,e),c=r?l:PLe(t,l,e);return-c}return NaN}function TLe(e){return p9(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}function kE(e,t){var r=SLe(e,t),i=p9(r[0],r[1]-1,r[2],r[3]%24,r[4],r[5],0).getTime(),n=e.getTime(),a=n%1e3;return n-=a>=0?a:1e3+a,i-n}function PLe(e,t,r){var i=e.getTime(),n=i-t,a=kE(new Date(n),r);if(t===a)return t;n-=a-t;var o=kE(new Date(n),r);return a===o?a:Math.max(a,o)}function i4(e,t){return-23<=e&&e<=23&&(t==null||0<=t&&t<=59)}var n4={};function DLe(e){if(n4[e])return!0;try{return new Intl.DateTimeFormat(void 0,{timeZone:e}),n4[e]=!0,!0}catch{return!1}}var OLe=Ac(Gye(),1),a4=Ac($ye(),1),RLe=/(Z|[+-]\d{2}(?::?\d{2})?| UTC| [a-zA-Z]+\/[a-zA-Z_]+(?:\/[a-zA-Z_]+)?)$/,ILe=RLe,A_=36e5,o4=6e4,zLe=2,za={dateTimePattern:/^([0-9W+-]+)(T| )(.*)/,datePattern:/^([0-9W+-]+)(.*)/,plainTime:/:/,YY:/^(\d{2})$/,YYY:[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],YYYY:/^(\d{4})/,YYYYY:[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],MM:/^-(\d{2})$/,DDD:/^-?(\d{3})$/,MMDD:/^-?(\d{2})-?(\d{2})$/,Www:/^-?W(\d{2})$/,WwwD:/^-?W(\d{2})-?(\d{1})$/,HH:/^(\d{2}([.,]\d*)?)$/,HHMM:/^(\d{2}):?(\d{2}([.,]\d*)?)$/,HHMMSS:/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,timeZone:ILe};function kLe(e,t){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");if(e===null)return new Date(NaN);var r={},i=r.additionalDigits==null?zLe:(0,OLe.default)(r.additionalDigits);if(i!==2&&i!==1&&i!==0)throw new RangeError("additionalDigits must be 0, 1 or 2");if(e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]")return new Date(e.getTime());if(typeof e=="number"||Object.prototype.toString.call(e)==="[object Number]")return new Date(e);if(!(typeof e=="string"||Object.prototype.toString.call(e)==="[object String]"))return new Date(NaN);var n=LLe(e),a=BLe(n.date,i),o=a.year,s=a.restDateString,l=FLe(s,o);if(isNaN(l))return new Date(NaN);if(l){var c=l.getTime(),u=0,d;if(n.time&&(u=NLe(n.time),isNaN(u)))return new Date(NaN);if(n.timeZone||r.timeZone){if(d=m9(n.timeZone||r.timeZone,new Date(c+u)),isNaN(d))return new Date(NaN)}else d=(0,a4.default)(new Date(c+u)),d=(0,a4.default)(new Date(c+u+d));return new Date(c+u+d)}else return new Date(NaN)}function LLe(e){var t={},r=za.dateTimePattern.exec(e),i;if(r?(t.date=r[1],i=r[3]):(r=za.datePattern.exec(e),r?(t.date=r[1],i=r[2]):(t.date=null,i=e)),i){var n=za.timeZone.exec(i);n?(t.time=i.replace(n[1],""),t.timeZone=n[1].trim()):t.time=i}return t}function BLe(e,t){var r=za.YYY[t],i=za.YYYYY[t],n;if(n=za.YYYY.exec(e)||i.exec(e),n){var a=n[1];return{year:parseInt(a,10),restDateString:e.slice(a.length)}}if(n=za.YY.exec(e)||r.exec(e),n){var o=n[1];return{year:parseInt(o,10)*100,restDateString:e.slice(o.length)}}return{year:null}}function FLe(e,t){if(t===null)return null;var r,i,n,a;if(e.length===0)return i=new Date(0),i.setUTCFullYear(t),i;if(r=za.MM.exec(e),r)return i=new Date(0),n=parseInt(r[1],10)-1,l4(t,n)?(i.setUTCFullYear(t,n),i):new Date(NaN);if(r=za.DDD.exec(e),r){i=new Date(0);var o=parseInt(r[1],10);return VLe(t,o)?(i.setUTCFullYear(t,0,o),i):new Date(NaN)}if(r=za.MMDD.exec(e),r){i=new Date(0),n=parseInt(r[1],10)-1;var s=parseInt(r[2],10);return l4(t,n,s)?(i.setUTCFullYear(t,n,s),i):new Date(NaN)}if(r=za.Www.exec(e),r)return a=parseInt(r[1],10)-1,c4(t,a)?s4(t,a):new Date(NaN);if(r=za.WwwD.exec(e),r){a=parseInt(r[1],10)-1;var l=parseInt(r[2],10)-1;return c4(t,a,l)?s4(t,a,l):new Date(NaN)}return null}function NLe(e){var t,r,i;if(t=za.HH.exec(e),t)return r=parseFloat(t[1].replace(",",".")),M_(r)?r%24*A_:NaN;if(t=za.HHMM.exec(e),t)return r=parseInt(t[1],10),i=parseFloat(t[2].replace(",",".")),M_(r,i)?r%24*A_+i*o4:NaN;if(t=za.HHMMSS.exec(e),t){r=parseInt(t[1],10),i=parseInt(t[2],10);var n=parseFloat(t[3].replace(",","."));return M_(r,i,n)?r%24*A_+i*o4+n*1e3:NaN}return null}function s4(e,t,r){t=t||0,r=r||0;var i=new Date(0);i.setUTCFullYear(e,0,4);var n=i.getUTCDay()||7,a=t*7+r+1-n;return i.setUTCDate(i.getUTCDate()+a),i}var ULe=[31,28,31,30,31,30,31,31,30,31,30,31],jLe=[31,29,31,30,31,30,31,31,30,31,30,31];function v9(e){return e%400===0||e%4===0&&e%100!==0}function l4(e,t,r){if(t<0||t>11)return!1;if(r!=null){if(r<1)return!1;var i=v9(e);if(i&&r>jLe[t]||!i&&r>ULe[t])return!1}return!0}function VLe(e,t){if(t<1)return!1;var r=v9(e);return!(r&&t>366||!r&&t>365)}function c4(e,t,r){return!(t<0||t>52||r!=null&&(r<0||r>6))}function M_(e,t,r){return!(e!=null&&(e<0||e>=25)||t!=null&&(t<0||t>=60)||r!=null&&(r<0||r>=60))}function HLe(e,t,r){var i=kLe(e,r),n=m9(t,i,!0),a=new Date(i.getTime()-n),o=new Date(0);return o.setFullYear(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate()),o.setHours(a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds(),a.getUTCMilliseconds()),o}function ka(e,t){return t.color(e)}function u4(e=new Date,t){let r=t.format,i=e.getSeconds(),n=e;t&&t.timeZone!==null&&(n=HLe(new Date,t.timeZone));let a=n.getHours(),o=n.getMinutes(),s;t.format12h24h==="12ampm"&&(s=a>=12?"PM":"AM");let l=a;t.format12h24h!=="24"&&(l=a%12,l===0&&(l=12));let c,u;switch(r){case"HH:mm:ss":c=[l,o,i];break;case"HH:mm":c=[l,o];break;case"HH":c=[l],s=void 0;break;case"mm":c=[o],s=void 0;break;case"ss":c=[i],s=void 0;break;case"year":u=n.getFullYear();break;case"month":u=n.getMonth()+1;break;case"dayOfYear":u=Math.floor((n.getTime()-new Date(n.getFullYear(),0,0).getTime())/864e5);break;case"dayOfMonth":u=n.getDate();break;case"secondOfDay":u=a*60*60+o*60+i;break;default:console.error("Unknown time format",r),u=0;break}return c!==void 0?{textValue:c,suffix:s}:u}function WLe(e,t){switch(e.type){case"fresnel":return qLe(e,t);case"gradient":return YLe(e,t);case"depth":return XLe(e,t);case"normal":return KLe(e,t);case"noise":return QLe(e,t);case"rainbow":return ZLe(e,t);case"toon":return JLe(e,t);case"outline":return eBe(e,t);case"transmission":return tBe(e,t);case"color":return $Le(e,t);case"pattern":return rBe(e,t)}}function GLe(e){return{type:e.type}}function Es(e,t){let{alpha:r,mode:i,isMask:n}=e,a=typeof r=="string"?(Number(t.getVariable(r))??100)/100:r;return{...GLe(e),alpha:a,mode:i,isMask:n}}function $Le(e,t){return{...Es(e,t),color:ka(e.color,t)}}function qLe(e,t){let{bias:r,scale:i,intensity:n,factor:a,color:o}=e;return{...Es(e,t),color:ka(o,t),bias:r,scale:i,intensity:n,factor:a}}function YLe(e,t){let{gradientType:r,smooth:i,colors:n,steps:a,angle:o,offset:s,morph:l}=e;return{...Es(e,t),gradientType:r,smooth:i,colors:n.map(c=>new Qt(c[0],c[1],c[2],c[3])),num:n.length,steps:a,offset:new ye(...s),morph:new ye(...l),angle:o}}function XLe(e,t){let{gradientType:r,near:i,far:n,isVector:a,isWorldSpace:o,origin:s,direction:l,colors:c,steps:u,smooth:d}=e;return{...Es(e,t),gradientType:r,near:i,far:n,isVector:a,isWorldSpace:o,origin:new k(...s),direction:l?new k(...l):new k(1,0,0),colors:c.map(h=>h!==void 0?new Qt(h[0],h[1],h[2],h[3]):new Qt(0,0,0,0)),steps:u.slice(0,c.length),smooth:d}}function KLe(e,t){let{cnormal:r}=e;return{...Es(e,t),cnormal:new k(r[0],r[1],r[2])}}function QLe(e,t){return{...Es(e,t),scale:e.scale,move:e.move,fA:new ye(...e.fA),fB:new ye(...e.fB),size:new k(...e.size),distortion:new ye(...e.distortion),colorA:ka(e.colorA,t),colorB:ka(e.colorB,t),colorC:ka(e.colorC,t),colorD:ka(e.colorD,t),noiseType:e.noiseType,voronoiStyle:e.voronoiStyle,highCut:e.highCut,lowCut:e.lowCut,smoothness:e.smoothness,seed:e.seed,quality:e.quality}}function ZLe(e,t){return{...Es(e,t),filmThickness:e.filmThickness,movement:e.movement,wavelengths:new k(...e.wavelengths),noiseStrength:e.noiseStrength,noiseScale:e.noiseScale,offset:new k(...e.offset)}}function JLe(e,t){return{...Es(e,t),positioning:e.positioning,colors:e.colors.map(r=>new Qt(r[0],r[1],r[2],r[3])),num:e.colors.length,steps:e.steps,source:new k(...e.source),isWorldSpace:e.isWorldSpace,noiseStrength:e.noiseStrength,noiseScale:e.noiseScale,shadowColor:ka(e.shadowColor,t),offset:new k(...e.offset)}}function eBe(e,t){return{...Es(e,t),outlineColor:ka(e.outlineColor,t),contourColor:ka(e.contourColor,t),outlineWidth:e.outlineWidth,contourWidth:e.contourWidth,outlineThreshold:e.outlineThreshold,contourThreshold:e.contourThreshold,outlineSmoothing:e.outlineSmoothing,contourFrequency:e.contourFrequency,contourDirection:new k(...e.contourDirection),positionalLines:e.positionalLines,compensation:e.compensation}}function tBe(e,t){return{...Es(e,t),thickness:e.thickness,ior:e.ior,roughness:e.roughness}}function rBe(e,t){return{...Es(e,t),style:e.style,projection:e.projection,axis:e.axis,blending:e.blending,offset:new ye(...e.offset),colorA:ka(e.colorA,t),colorB:ka(e.colorB,t),frequency:new ye(...e.frequency),size:e.size,variation:e.variation,smoothness:e.smoothness,zigzag:e.zigzag,rotation:e.rotation,vertical:new ye(...e.vertical),horizontal:new ye(...e.horizontal),sides:e.sides}}var P1=class extends sa{},iBe={noise:["noiseType"],texture:["projection","axis","side"],video:["projection","axis","side"],displace:["noiseType"],light:["roughnessMap","bumpMap"],depth:["smooth","isWorldSpace","gradientType","isVector"],pattern:["style","projection","axis"]},nBe={depth:["colors"]};function aBe(e,t,r){var a,o;if(t==="isMask")return!0;let i=iBe[e.type],n=nBe[e.type];if(n!==void 0){let s=e.color;if(n.includes(t)){let l=(o=(a=s[t])==null?void 0:a.value)==null?void 0:o.length;if(l!==void 0&&l!==r.length)return!0}}return i!==void 0?i.includes(t):!1}function g9(e,t,r){let i=r.uniforms[`f${r.id}_texture`];if(!i)return!1;let n=!1,a=e;if("image"in a){let o=a.image,s=t.image(o),l=i;l.image instanceof uu||l.image.deref(),l.image=s}if("video"in a){let o=a.video,s=t.video(o),l=i;l.image instanceof uu||l.image.deref(),l.image=s}if("wrapping"in a){let o=i;o.wrap=a.wrapping}if("minFilter"in a){let o=i;o.minFilter=a.minFilter}if("magFilter"in a){let o=i;o.magFilter=a.magFilter}if("rotation"in a&&r.uniforms[`f${r.id}_rotation`])return r.uniforms[`f${r.id}_rotation`].value=(a.rotation??0)*St.DEG2RAD,n;if("repeat"in a||"offset"in a||"rotation"in a){let o="mat",s=r.uniforms[`f${r.id}_${o}`];"repeat"in a&&(s.repeat=a.repeat),"offset"in a&&(s.offset=a.offset),"rotation"in a&&(s.rotation=a.rotation??0),s.updateMatrix()}return n}function oBe(e,t,r,i){let n=!1;for(let[a,o]of Object.entries(e)){if(a==="bumpMap"||a==="roughnessMap"){n=!0;continue}if(!a||o===void 0)continue;if(b9(a,r,i,t)){a==="visible"&&r.type==="light"&&(n=!0);continue}r.visible=i.visible;let s=r.uniforms[`f${r.id}_${a}`];if(s&&!(s instanceof jD))switch(n=n||aBe(r,a,o),s.constructor){case Ni:if(typeof o=="string"){let l=t.getColor(o);l&&(s.value=l);break}else{let l=o;s.value instanceof P1?s.value=new sa(l.r,l.g,l.b,l.a):s.setRGBA(l);break}case Gl:if(typeof o=="string"){let l=t.getColor(o);l&&(s.value=l);break}else{let l=o;s.value instanceof P1?s.value=new sa(l.r,l.g,l.b,l.a):s.value.setRGBA(l.r,l.g,l.b,l.a);break}case Zn:{let l=o;s.value.setX(l[0]),s.value.setY(l[1]);break}case Eo:{let l=o;s.value.setX(l[0]),s.value.setY(l[1]),s.value.setZ(l[2]);break}case Ql:{g9(o,t,r);break}case xd:{s.value=o.map(l=>new Qt(...l));break}default:{s.value=o;break}}}return n}var yh=(e,t,r)=>Math.max(0,Math.min(1,Number(t.getVariable(typeof e=="number"?e*100:e,r)??100)/100))??1,_0=class{constructor(e,t,r,i,n){this.id=e,this.uuid=t,this.data=r,this.uniforms={};for(let a in i)this.uniforms[`f${this.id}_${a}`]=i[a];for(let a in r)b9(a,this,r,n)}get type(){return this.data.type}static create(e,t,r,i){if(r.type==="light")return Ws.createLigherLayer(e,t,r,i);if(r.type==="texture"||r.type==="video"){let n=r.type==="texture"?i.uiBuffer(r.texture.image)??i.image(r.texture.image):i.video(r.texture.video),a=new RE(n,r.texture.wrapping,r.texture.minFilter??1008,r.texture.magFilter??1006),o=new lLe(n),s=new cLe(r.texture.repeat,r.texture.offset,r.texture.rotation??0),l=new Ct(r.crop?1:0),c=new si(r.projection??0),u=new si(["x","y","z"].indexOf(r.axis)??0),d=new si(r.side??0),h=new Zn(r.size?new ye(r.size[0],r.size[1]):new ye(100,100)),f=new Ct(r.blending??0),p=new Ct(yh(r.alpha,i)),v=new si(r.mode??0),m=new Ia(r.isMask??!1),g=new VD(a,o,l,c,u,d,h,f,s,p,v,m),y=new mi(g.calpha,"f");return new ki(e,t,r,{texture:a,textureSize:o,crop:l,projection:c,axis:u,side:d,size:h,blending:f,mat:s,alpha:p,mode:v,isMask:m},g,v,y,m,i)}else if(r.type==="matcap"){let n=i.image(r.texture.image),a=new RE(n,r.texture.wrapping,r.texture.minFilter??1008,r.texture.magFilter??1006),o=new Ct(yh(r.alpha,i)),s=new si(r.mode??0),l=new Ia(r.isMask??!1),c=new Ct((r.texture.rotation??0)*St.DEG2RAD),u=new JW(a,o,s,l,c),d=new mi(u.calpha,"f");return new ki(e,t,r,{texture:a,alpha:o,mode:s,isMask:l,rotation:c},u,s,d,l,i)}else if(r.type==="displace")if(r.displacementType==="noise"){let n=new Eo(new k(...r.offset)),a=new Ct(r.scale??10),o=new Ct(r.intensity??8),s=new Ct(r.movement??1),l=new si(r.noiseType??0),c=new si(r.voronoiStyle??0),u=new Ct(r.smoothness??.5),d=new Ct(r.seed??0),h=new Ct(r.highCut??1),f=new Ct(r.lowCut??0),p=new si(r.quality??1),v=new d9(o,s,n,c,u,d,h,f,p,a,l);return new y9(e,t,r,{offset:n,scale:a,intensity:o,movement:s,noiseType:l,voronoiStyle:c,smoothness:u,seed:d,highCut:h,lowCut:f,quality:p},v,i)}else throw new Error;else return cBe(e,t,r,i)}updateByOp(e,t,r){let i=e;if(i.path[0]===void 0){if(i.type===0)return"type"in i.props||"category"in i.props||"visible"in i.props?(r.scene.markNeedsUpdateRendererDirty(),!0):oBe(i.props,r.shared,this,t)}else if(i.path[0]==="texture")return"texture"in t||"video"in t?g9(i.props,r.shared,this):!0;return!1}dispose(){if(sBe(this)){let e=this.uniforms[`f${this.id}_texture`];if(!e)return!1;let t=e;t.image instanceof uu||t.image.deref()}}hasValueByKey(e){return this.uniforms[e]!==void 0}hasValue(e){return this.hasValueByKey(`f${this.id}_${e}`)}setValue(e,t){let r=`f${this.id}_${e}`;this.hasValueByKey(r)&&t!==void 0&&(this.uniforms[r].value=t)}getNode(e){let t=`f${this.id}_${e}`;if(this.hasValueByKey(t))return this.uniforms[t]}getValue(e){let t=`f${this.id}_${e}`;if(this.hasValueByKey(t))return this.uniforms[t].value}getName(e){let t=/f\d+_(.*)/.exec(e);if(t&&t.length>1)return t[1];console.log(`Layer.getName: error ${e}`)}getNames(){let e=[];for(let t in this.uniforms){let r=this.getName(t);r&&e.push(r)}return e}},ki=class extends _0{constructor(e,t,r,i,n,a,o,s,l){super(e,t,r,i,l),this.params=i,this.color=n,this.mode=a,this.alpha=o,this.isMask=s}},y9=class extends _0{constructor(e,t,r,i,n,a){super(e,t,r,i,a),this.position=n}},Ws=class extends _0{constructor(e,t,r,i,n,a){super(e,t,r,n,a),this.node=i}static createLigherLayer(e,t,r,i){let n,a=new Ct(yh(r.alpha,i)),o=new si(r.mode),s=new Ct(r.bumpMapIntensity),l=new Ct(yh(r.alphaOverride,i)),c;if(!r.visible)n=new WD,c={};else if(r.category==="lambert"){n=new fLe;let u=new Ni(i.color(r.emissive)??0),d=new Ia(r.occlusion??!0);c={emissive:u,occlusion:d},n.emissive=u,n.occlusion=d}else if(r.category==="toon"){n=new vLe;let u=new Ct(r.shininess??30),d=new Ni(i.color(r.specular)??1118481);c={shininess:u,specular:d},n.shininess=u,n.specular=d}else if(r.category==="physical"){n=new mLe;let u=new Ct(r.roughness??.3),d=new Ct(r.metalness??0),h=new Ct(r.reflectivity??.5),f=new Ia(r.occlusion??!0);c={roughness:u,metalness:d,reflectivity:h,occlusion:f},n.roughness=u,n.metalness=d,n.reflectivity=h,n.occlusion=f}else{n=new pLe;let u=new Ct(r.shininess??30),d=new Ni(r.specular!==void 0?i.color(r.specular)??1118481:1118481),h=new Ia(r.occlusion??!0);c={shininess:u,specular:d,occlusion:h},n.shininess=u,n.specular=d,n.occlusion=h}return n.alpha=new Ct(1),n.shadingAlpha=a,n.shadingBlend=o,n.bumpMapIntensity=s,n.alphaOverride=l,c.alpha=n.shadingAlpha,c.mode=n.shadingBlend,c.bumpMapIntensity=n.bumpMapIntensity,c.alphaOverride=n.alphaOverride,new Ws(e,t,r,n,c,i)}get category(){return this.node.category}};function sBe(e){let t=e instanceof _0?e.type:e;return t==="texture"||t==="video"||t==="displace_map"||t==="matcap"}function Co(e){return{alpha:new Ct(e.alpha??1),mode:new si(e.mode??0),isMask:new Ia(e.isMask??!1)}}function lBe(e,t,r,i,n){switch(e.type){case"color":{let a=new Ni(i.color??go),o=Co(i),s=new IE(a,o.alpha),l=new mi(s.calpha,"f");return new ki(t,r,e,{color:a,...o},s,o.mode,l,o.isMask,n)}case"fresnel":{let a=new Ni(i.color??16777215),o=new Ct(i.bias??.1),s=new Ct(i.scale??1),l=new Ct(i.intensity??2),c=new Ct(i.factor??1),u=Co(i),d=new uLe(a,o,s,l,c,u.alpha,u.mode,u.isMask),h=new mi(d.calpha,"f");return new ki(t,r,e,{color:a,bias:o,scale:s,intensity:l,factor:c,...u},d,u.mode,h,u.isMask,n)}case"rainbow":{let a=new Ct(i.filmThickness??30),o=new Ct(i.movement??0),s=new Eo(i.wavelengths??new k(0,0,0)),l=new Ct(i.noiseStrength??0),c=new Ct(i.noiseScale??1),u=new Eo(i.offset??new k(0,0,0)),d=Co(i),h=new a9(a,o,s,l,c,u,d.alpha,d.isMask),f=new mi(h.calpha,"f");return new ki(t,r,e,{filmThickness:a,movement:o,wavelengths:s,noiseStrength:l,noiseScale:c,offset:u,...d},h,d.mode,f,d.isMask,n)}case"transmission":{let a=new Ct(i.thickness??10),o=new Ct(i.ior??1.5),s=new Ct(i.roughness??.5),l=Vt.transmissionSize,c=Vt.transmissionRenderTarget,u=Vt.transmissionRenderTargetDepth,d=window.innerWidth,h=window.innerHeight,f=d>=h?new Zn(h/d,1):new Zn(1,d/h),p=Co(i),v=new c9(a,o,s,l,c,u,f,p.alpha),m=new mi(v.calpha,"f");return new ki(t,r,e,{thickness:a,ior:o,roughness:s,aspectRatio:f,...p},v,p.mode,m,p.isMask,n)}case"toon":{let a=new si(i.positioning??0),o;i.colors?o=new xd(i.colors.length,i.colors):(o=new xd(10,new Qt(0,0,0,1)),o.value[1]=new Qt(1,1,1,1));let s;i.steps?s=new bd(i.steps.length,i.steps):(s=new bd(10,1),s.value[0]=0);let l=new Eo(i.source??new k(0,0,0)),c=new Ia(i.isWorldSpace??!0),u=new Ct(i.noiseStrength??0),d=new Ct(i.noiseScale??1),h=new Gl(i.shadowColor),f=new Eo(i.offset??new k(0,0,0)),p=Co(i),v=new s9(a,o,s,l,c,u,d,h,f,p.alpha),m=new mi(v.calpha,"f");return new ki(t,r,e,{positioning:a,colors:o,steps:s,source:l,isWorldSpace:c,noiseStrength:u,noiseScale:d,shadowColor:h,offset:f,...p},v,p.mode,m,p.isMask,n)}case"outline":{let a=new Ni(i.outlineColor??16777215),o=new Ni(i.contourColor??16777215),s=new Ct(i.outlineWidth??.1),l=new Ct(i.contourWidth??.1),c=new Ct(i.outlineThreshold??.1),u=new Ct(i.contourThreshold??.1),d=new Ct(i.outlineSmoothing??.1),h=new Ct(i.contourFrequency??.1),f=new Eo(i.contourDirection??new k(0,1,0)),p=new Ia(i.positionalLines??!1),v=new Ia(i.compensation??!0),m=Vt.normalRenderTarget,g=Vt.normalRenderTargetDepth,y=Vt.pixelRatioNode,b=Vt.resolution,x=Co(i),S=new r9(a,o,s,l,c,u,d,h,f,p,v,b,m,g,y,x.alpha),w=new mi(S.calpha,"f");return new ki(t,r,e,{outlineColor:a,contourColor:o,outlineWidth:s,contourWidth:l,outlineThreshold:c,contourThreshold:u,outlineSmoothing:d,contourFrequency:h,contourDirection:f,positionalLines:p,compensation:v,...x},S,x.mode,w,x.isMask,n)}case"depth":{let a=new si(i.gradientType??0),o=new Ia(i.smooth??!1),s=new Ct(i.near??50),l=new Ct(i.far??200),c=new Ct(i.isVector??1),u=new Ct(i.isWorldSpace??0),d=new Eo(i.origin??new k),h=new Eo(i.direction??new k),f;i.colors?f=new xd(i.colors.length,i.colors):(f=new xd(2,new Qt(0,0,0,1)),f.value[1]=new Qt(1,1,1,1));let p;i.steps?p=new bd(i.steps.length,i.steps):(p=new bd(2,1),p.value[0]=0);let v=Co(i),m=new XW(a,o,s,l,c,u,d,h,f,p,v.alpha,v.isMask),g=new mi(m.calpha,"f");return new ki(t,r,e,{gradientType:a,smooth:o,near:s,far:l,isVector:c,isWorldSpace:u,origin:d,direction:h,colors:f,steps:p,...v},m,v.mode,g,v.isMask,n)}case"noise":{let a=new Ct(i.scale??1),o=new Eo(i.size??new k(100,100,100)),s=new Ct(i.move??1),l=new Zn(i.fA??new ye(1.7,9.2)),c=new Zn(i.fB??new ye(8.3,2.8)),u=new Zn(i.distortion??new ye(1,1)),d=new Gl(i.colorA),h=new Gl(i.colorB),f=new Gl(i.colorC),p=new Gl(i.colorD),v=new si(i.noiseType??0),m=new si(i.voronoiStyle??0),g=new Ct(i.highCut??1),y=new Ct(i.lowCut??0),b=new Ct(i.smoothness??.5),x=new Ct(i.seed??.5),S=new si(i.quality??1),w=Co(i),_=new e9(a,o,s,l,c,u,d,h,f,p,w.alpha,v,w.isMask,m,g,y,b,x,S),C=new mi(_.calpha,"f");return new ki(t,r,e,{scale:a,size:o,move:s,fA:l,fB:c,distortion:u,colorA:d,colorB:h,colorC:f,colorD:p,noiseType:v,...w,voronoiStyle:m,highCut:g,lowCut:y,smoothness:b,seed:x,quality:S},_,w.mode,C,w.isMask,n)}case"normal":{let a=new Eo(i.cnormal??new k(1,1,1)),o=Co(i),s=new YW(a,o.alpha),l=new mi(s.calpha,"f");return new ki(t,r,e,{cnormal:a,...o},s,o.mode,l,o.isMask,n)}case"gradient":{let a=new si(i.gradientType??0),o=new Ia(i.smooth??!1),s;i.colors?s=new xd(i.colors.length,i.colors):(s=new xd(10,new Qt(0,0,0,1)),s.value[1]=new Qt(1,1,1,1));let l;i.steps?l=new bd(i.steps.length,i.steps):(l=new bd(10,1),l.value[0]=0);let c=new Zn(i.offset??new ye(0,0)),u=new Zn(i.morph??new ye(0,0)),d=new Ct(i.angle??0),h=Co(i),f=new QW(a,o,s,l,c,u,d,h.alpha,h.isMask),p=new mi(f.calpha,"f");return new ki(t,r,e,{gradientType:a,smooth:o,colors:s,steps:l,offset:c,morph:u,angle:d,...h},f,h.mode,p,h.isMask,n)}case"pattern":{let a=new si(i.style??0),o=new si(i.projection??0),s=new si(["x","y","z"].indexOf(i.axis)??0),l=new Ct(i.blending??0),c=new Zn(i.offset??new ye(0,0)),u=new Gl(i.colorA),d=new Gl(i.colorB),h=new Zn(i.frequency??new ye(10,10)),f=new Ct(i.size??.5),p=new Ct(i.variation??0),v=new Ct(i.smoothness??.5),m=new Ct(i.zigzag??0),g=new Ct(i.rotation??0),y=new Zn(i.vertical??new ye(0,1)),b=new Zn(i.horizontal??new ye(0,1)),x=new si(i.sides??6),S=Co(i),w=new i9(a,o,s,l,c,u,d,h,f,p,v,m,g,y,b,x,S.alpha,S.isMask),_=new mi(w.calpha,"f");return new ki(t,r,e,{style:a,projection:o,axis:s,blending:l,offset:c,colorA:u,colorB:d,frequency:h,size:f,variation:p,smoothness:v,zigzag:m,rotation:g,vertical:y,horizontal:b,sides:x,...S},w,S.mode,_,S.isMask,n)}default:{let a=new Ni(1,0,0,1),o=Co(i),s=new IE(a,o.alpha),l=new mi(s.calpha,"f");return new ki(t,r,e,{color:a,...o},s,o.mode,l,o.isMask,n)}}}function cBe(e,t,r,i){let n=WLe(r,i);return lBe(r,e,t,n,i)}function b9(e,t,r,i){if(r.type==="displace"&&(e==="intensity"||e==="visible")){let n=t.uniforms[`f${t.id}_intensity`];return n?(n.value=r.intensity*(r.visible?1:0),n):void 0}if(r.type!=="displace"&&(e==="alpha"||e==="visible")){let n=t.uniforms[`f${t.id}_alpha`];if(!n)return;if(n.value=yh(r.alpha,i)*(r.visible?1:0),r.type==="outline"&&e==="visible"){let a=t.uniforms[`f${t.id}_compensation`];a&&(a.value=r.compensation&&r.visible)}return n}}function qf(e,t){let r=0,i=e.layers.find(n=>n.data.type==="light");if(i){let n=i.data,a=Number(t.getVariable(n.alphaOverride));if((typeof n.alphaOverride=="string"?a/100:n.alphaOverride)<1)return!0}for(let n of e.layers){if(n.data.type!=="displace"&&n.data.isMask)return!0;if(n.data.type!=="displace"&&"alpha"in n.data&&n.data.type!=="light"&&n.data.type!=="fresnel"&&n.data.type!=="texture"&&n.data.type!=="matcap"&&n.data.type!=="rainbow"&&n.data.type!=="outline"&&n.data.type!=="pattern"){let a=n.data.visible?n.data.alpha:0;if(typeof a=="string"&&(a=Math.max(0,Math.min(1,Number(t.getVariable(a)??100)/100))),a===1&&n.data.type==="depth"||n.data.type==="gradient"){for(let o of n.data.colors)if(o[3]<1){a=o[3];break}}else if(a===1&&n.data.type==="noise"){let o=t.color(n.data.colorA).a,s=t.color(n.data.colorB).a,l=t.color(n.data.colorC).a,c=t.color(n.data.colorD).a,u=Math.min(o,Math.min(s,Math.min(l,c)));u<1&&(a=u)}r+=(1-r)*a}}return r<1}var Nu=class extends Vr{constructor(){super(void 0),this.flatShading=!1,this.needsJitter=!0,this.nodeContextUuid=0,this.fog=!0,this.dithering=!0,this.vertexColors=!0,this.transparent=!0}customProgramCacheKey(){return""}},uBe=class extends Nu{constructor(e,t,r,i){super(),this.flatShading=e,this.side=t,this.wireframe=r,this.root=i}updateAfterBuild(){let e=this.root;this.lights=e.lights,this.vertexShader=e.vertexShader,this.fragmentShader=e.fragmentShader,this.defines=e.defines,this.uniforms=e.uniforms,this.extensions=e.extensions,this.transparent=e.transparent,this.cacheKey=e.customProgramCacheKey()+"flat"+this.flatShading+this.side}onBeforeCompile(e,t){this.root.onBeforeCompile(e)}get data(){return this.root.data}get category(){return this.root.category}get hasAO(){return this.root.hasAO}getFlavor(e,t,r){return this.root.getFlavor(e,t,r)}get layers(){return this.root.layers}get fragment(){return this.root.fragment}getLayersOfType(e){return this.root.getLayersOfType(e)}getLayerByUuid(e){return this.root.getLayerByUuid(e)}updateByOp(e,t,r){this.root.updateByOp(e,t,r)}nodeMaterialDispose(){this.root.nodeMaterialDispose()}},GD=class extends Nu{constructor(e,t,r=!0){super(),this.data=e,this.allowVariableSaves=r,this.layerIdGen=0,this.flavors=[],this.masks={},this.type="NodeMaterial",this.updaters=[],this.needsJitter=t.shared.needsJitter,gn.startContext(this),this.reset0(e,t),gn.endContext(this)}get nodeMaterial(){return this}getFlavor(e,t,r){let i=r?6:(e?3:0)+t;if(i===0)return this;this.flavors===void 0&&(this.flavors=[]),i-=1;let n=this.flavors[i];return n===void 0&&(n=new uBe(e,t,r,this),n.needsJitter=this.needsJitter,this.flavors[i]=n,n.flatShading=e,n.side=t,n.updateAfterBuild()),n}get fragment(){return this.lightLayer.node}get category(){return this.lightLayer.category}get hasAO(){var e;return((e=this.lightLayer.getNode("occlusion"))==null?void 0:e.value)??!1}reset(e,t,r=!1){gn.startContext(this),(this.data!==e||r)&&this.reset0(e,t),gn.endContext(this)}reset0(e,t){this.data=e;let r=e.layers??ia.defaultTwoLayerData("phong").layers;try{this.layers=r.map(i=>_0.create(this.layerIdGen++,i.id,i.data,t.shared))}catch{this.layers=[]}this.layers.reverse(),this.name=e.name??"Untitled Material",this.onUpdate(t.shared),this.transparent=qf(e,t.shared),this.saveVariableLocations(t)}onVariableUpdate(e,t,r){if(e[0]==="alphaOverride")this.transparent=qf(this.data,r.shared),this.lightLayer.setValue("alphaOverride",Math.max(0,Math.min(Number(t)/100,1)));else if(e[0]==="layer"){let i=e[1],n=e[2];if(i&&n){let a=this.layers.find(o=>o.uuid===i);a!=null&&a.hasValue(n)&&(n==="alpha"?(this.transparent=qf(this.data,r.shared),a.setValue(n,Math.max(0,Math.min(Number(t)/100,1)))):a.setValue(n,t))}}}saveVariableLocations(e){if(!this.allowVariableSaves)return;let t=this.data.layers.find(r=>r.data.type==="light");t&&e.shared.getVariable(t.data.alphaOverride,["material",this.uuid,"alphaOverride"]),this.data.layers.forEach(r=>{"alpha"in r.data&&typeof r.data.alpha=="string"&&e.shared.getVariable(r.data.alpha,["material",this.uuid,"layer",r.id,"alpha"])})}getLayersOfType(e){return this.layers.filter(t=>t.type===e)}getLayerByUuid(e){return this.layers.find(t=>t.uuid===e)}onUpdate(e){this.lightLayer=this.layers.find(t=>t instanceof Ws),this.lightLayer===void 0&&(this.lightLayer=new Ws(0,"",{...On.defaultData("light","phong"),visible:!1},new WD,{},e)),this.dispose();for(let t of this.flavors)t&&t.dispose();this.applyTextureMaps(),this.applyMasks(),this.blendColors(),this.blendAfterColors(),this.blendPositions(),this.build(),this.nodeContextUuid=0}applyTextureMaps(){let e=this.layers.find(n=>n instanceof Ws);if(!e)return;let t=e.data,r=t.bumpMap,i=t.roughnessMap;e.node.bumpMap=void 0,e.node.roughnessMap=void 0;for(let n=0;n<this.layers.length;++n){let a=this.layers[n];a instanceof ki&&a.color instanceof VD&&(a.uuid===r&&(e.node.bumpMap=a.color),a.uuid===i&&(e.node.roughnessMap=a.color))}}updateByOp(e,t,r){if(gn.startContext(this),t!==void 0?this.data=t:t=this.data,this.transparent=qf(t,r.shared),e.path[0]==="layers"){let i=r.shared,n=e.path[1];if(n===void 0)r.scene.markNeedsUpdateRendererDirty(),this.reset0(t,r);else{e.type===0&&e.props.occlusion!==void 0&&r.scene.markNeedsUpdateRendererDirty();let a=this.layers.find(o=>o.uuid===n);if(a){let o=t.layers.data(n),s;e.type===0&&("alpha"in e.props||"alphaOverride"in e.props)&&("alpha"in e.props?s={...e.props,alpha:yh(e.props.alpha,i,["material",this.uuid,"layer",n,"alpha"])}:s={...e.props,alphaOverride:yh(e.props.alphaOverride,i,["material",this.uuid,"alphaOverride"])}),a.updateByOp({...e,...s?{props:s}:{},path:e.path.slice(2)},o,r)&&this.reset0(t,r)}}}else this.reset0(t,r);gn.endContext(this)}applyMasks(){for(let e=0;e<this.layers.length;++e){let t=this.layers[e];t instanceof ki?t.color.mask=void 0:t instanceof Ws&&(t.node.mask=void 0)}for(let e=0;e<this.layers.length;++e){let t=this.layers[e];if(t instanceof ki&&t.isMask.value&&t.data.visible&&e>0){let r=e-1,i=this.layers[r];i instanceof Ws?i.node.mask=new $a(t.color,t.alpha,$a.MUL):i instanceof ki&&(i.isMask.value||(i.color.mask=new $a(t.color,t.alpha,$a.MUL)))}}}blendColors(){let e=this.layers.findIndex(r=>r instanceof ki),t=this.layers.findIndex(r=>r instanceof Ws);if(e!==-1&&e<t){let r=this.layers[e].color;for(let i=e+1;i<t;++i){let n=this.layers[i];if(n instanceof ki){if(n.isMask.value)continue;r=new t4(r,n.color,n.alpha,n.mode)}}this.fragment.color=r}else this.fragment.color=void 0}blendAfterColors(){let e=new mi("outgoingLight","f"),t=this.layers.findIndex(r=>r instanceof Ws);if(this.layers.length>t+1){for(let r=t+1;r<this.layers.length;++r){let i=this.layers[r];if(i instanceof ki){if(i.isMask.value)continue;e=new t4(e,i.color,i.alpha,i.mode)}}this.fragment.afterColor=e}else this.fragment.afterColor=void 0}blendPositions(){let e=this.layers.filter(t=>t instanceof y9);if(e.length>0){let t=e[0].position;for(let r=1;r<e.length;++r)e[r]&&(t=new $a(t,e[r].position,$a.ADD),t=new $a(t,new Ct(.5).setReadonly(!0),$a.MUL));this.fragment.position=t}else this.fragment.position=void 0}getDefines(){return this.defines}getUniforms(){return this.uniforms}getVertexShader(){return this.vertexShader}getFragmentShader(){return this.fragmentShader}onBeforeCompile(e){e.defines=this.defines,e.uniforms=this.uniforms,e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader,e.extensionDerivatives=this.extensions.derivatives===!0,e.extensionFragDepth=this.extensions.fragDepth===!0,e.extensionDrawBuffers=this.extensions.drawBuffers===!0,e.extensionShaderTextureLOD=this.extensions.shaderTextureLOD===!0}clampUniformsForPreview(e,t){let r=(i,n,a)=>Math.min(Math.max(i,n),a);for(let i of this.layers)if(i.type==="displace"){let n=r(i.uniforms[`f${i.id}_intensity`].value,e,t);i.uniforms[`f${i.id}_intensity`].value=n}}updateFrame(e){for(let t=0;t<this.updaters.length;++t)e.updateNode(this.updaters[t])}build(){let e=new WW;e.needsJitter=this.needsJitter,this.lights=this.lightLayer.data.visible,e.build(this.fragment,this.fragment),this.vertexShader=e.getCode("vertex"),this.fragmentShader=e.getCode("fragment"),this.defines=e.defines,this.uniforms=e.uniforms,this.extensions=e.extensions,this.updaters=e.updaters;for(let t of this.flavors)t&&t.updateAfterBuild();return this}nodeMaterialDispose(){this.layers.forEach(e=>e.dispose()),super.dispose();for(let e of this.flavors)e&&e.dispose()}assetsLoaded(){for(let e of this.layers)if(e instanceof ki){let t=e.params.texture;if(t instanceof RE&&!t.image.loaded)return!1}return!0}};Object.defineProperties(Nu.prototype,{properties:{get:function(){return this.fragment.properties}}});var LE=class extends GD{constructor(e,t,r){super(e,t,!1),this.uuid=r,this.allowVariableSaves=!0,this.saveVariableLocations(t)}},d4=new Map;function dBe(e){if(typeof e=="string")return e;let t=d4.get(e);return t||(t={url:URL.createObjectURL(new Blob([e]))},d4.set(e,t)),t.url}var x9,hBe=new Promise(e=>{x9=e}),h4=!1,sb;function fBe(){if(h4)return;if(sb)return sb;async function e(){await Cc(()=>import("./howler-BlyJ2Z3D.js").then(t=>t.h),[]),x9(window!==void 0?window:global),h4=!0}return sb=e(),sb}var w9;hBe.then(e=>w9=e);function pBe(e){let t=!1;return e.scene.objects.traverse((r,i)=>{if(i.events===void 0||Array.isArray(i.events)===!1)return!0;let n=[];i.events.forEach(a=>{"dragDropActions"in a.data?(n.push(...a.data.dragDropActions.drag),n.push(...a.data.dragDropActions.drop)):"inActions"in a.data?(n.push(...a.data.inActions),n.push(...a.data.outActions)):"gameActions"in a.data?(n.push(...a.data.gameActions.idle),n.push(...a.data.gameActions.move),n.push(...a.data.gameActions.jump),n.push(...a.data.gameActions.run)):"breakpoints"in a.data?a.data.breakpoints.forEach(o=>{n.push(...o.data.actions)}):"actions"in a.data&&n.push(...a.data.actions),t=t||n.some(o=>o.data.type==="Audio")})}),t}var Mv=class{constructor({src:e,volume:t,delay:r,loop:i}){this._volume=1,this.delay=0,this._loop=1,this.loopsRemaining=0,this._status="stopped",this.onEnd=()=>{this.loopsRemaining===1/0?this.replay():this.loopsRemaining>1?(this.replay(),this.loopsRemaining--):(this._status="stopped",this.loopsRemaining=this._loop)};let n;typeof e=="string"?n={src:e}:n={src:dBe(e),format:"wav"},this.sound=new w9.Howl(n),this.sound.on("end",this.onEnd),this.src=e,t!==void 0&&(this.volume=t),r!==void 0&&(this.delay=r),i!==void 0&&(this.loop=i)}get status(){return this._status}get volume(){return this._volume}set volume(e){this._volume=e,this.sound.volume(e)}get loop(){return this._loop}set loop(e){this._loop=e,this.loopsRemaining=e}replay(){this.clearDelay(),this.delayTimerId=window.setTimeout(()=>{this.sound.play(),this.clearDelay()},this.delay)}fade(e,t=1e3){e?(this.sound.volume(this._volume),this.clearFade(),this.fadeTimerId=window.setTimeout(()=>{this.sound.fade(this._volume,0,t),this.clearFade()},e)):this.sound.fade(this._volume,0,t)}on(e,t,r){this.sound.on(e,t,r)}off(e,t,r){this.sound.off(e,t,r)}play(){this._status==="playing"||this.sound.playing()||(this._status==="paused"?(this.sound.seek()===0?this.replay():this.sound.play(),this._status="playing"):this._status==="stopped"&&(this.replay(),this._status="playing"))}pause(){this._status==="playing"&&(this.sound.pause(),this.clearFade(),this.clearDelay(),this._status="paused")}stop(){this.sound.stop(),this.loopsRemaining=this._loop,this.clearFade(),this.clearDelay(),this._status="stopped"}clearFade(){this.fadeTimerId&&(clearTimeout(this.fadeTimerId),delete this.fadeTimerId)}clearDelay(){this.delayTimerId&&(clearTimeout(this.delayTimerId),delete this.delayTimerId)}dispose(e=!1){this.off(),this.stop(),this.clearFade(),this.clearDelay()}},mBe=class{constructor(){this.type="ShapePath",this.color=new Bt,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new Wx,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){var r;return(r=this.currentPath)==null||r.lineTo(e,t),this}quadraticCurveTo(e,t,r,i){var n;return(n=this.currentPath)==null||n.quadraticCurveTo(e,t,r,i),this}bezierCurveTo(e,t,r,i,n,a){var o;return(o=this.currentPath)==null||o.bezierCurveTo(e,t,r,i,n,a),this}splineThru(e){var t;return(t=this.currentPath)==null||t.splineThru(e),this}toShapes(){let e={ORIGIN:0,DESTINATION:1,BETWEEN:2,LEFT:3,RIGHT:4,BEHIND:5,BEYOND:6},t={loc:e.ORIGIN,t:0};function r(f,p,v,m){let g=f.x,y=p.x,b=v.x,x=m.x,S=f.y,w=p.y,_=v.y,C=m.y,A=(x-b)*(S-_)-(C-_)*(g-b),M=(y-g)*(S-_)-(w-S)*(g-b),P=(C-_)*(y-g)-(x-b)*(w-S),T=A/P,R=M/P;if(P===0&&A!==0||T<=0||T>=1||R<0||R>1)return null;if(A===0&&P===0){for(let z=0;z<2;z++)if(i(z===0?v:m,f,p),t.loc===e.ORIGIN){let F=z===0?v:m;return{x:F.x,y:F.y,t:t.t}}else if(t.loc===e.BETWEEN){let F=+(g+t.t*(y-g)).toPrecision(10),H=+(S+t.t*(w-S)).toPrecision(10);return{x:F,y:H,t:t.t}}return null}else{for(let H=0;H<2;H++)if(i(H===0?v:m,f,p),t.loc===e.ORIGIN){let N=H===0?v:m;return{x:N.x,y:N.y,t:t.t}}let z=+(g+T*(y-g)).toPrecision(10),F=+(S+T*(w-S)).toPrecision(10);return{x:z,y:F,t:T}}}function i(f,p,v){let m=v.x-p.x,g=v.y-p.y,y=f.x-p.x,b=f.y-p.y,x=m*b-y*g;if(f.x===p.x&&f.y===p.y){t.loc=e.ORIGIN,t.t=0;return}if(f.x===v.x&&f.y===v.y){t.loc=e.DESTINATION,t.t=1;return}if(x<-Number.EPSILON){t.loc=e.LEFT;return}if(x>Number.EPSILON){t.loc=e.RIGHT;return}if(m*y<0||g*b<0){t.loc=e.BEHIND;return}if(Math.sqrt(m*m+g*g)<Math.sqrt(y*y+b*b)){t.loc=e.BEYOND;return}let S;m!==0?S=y/m:S=b/g,t.loc=e.BETWEEN,t.t=S}function n(f,p){let v=[],m=[];for(let g=1;g<f.length;g++){let y=f[g-1],b=f[g];for(let x=1;x<p.length;x++){let S=p[x-1],w=p[x],_=r(y,b,S,w);_!==null&&v.find(C=>C.t<=_.t+Number.EPSILON&&C.t>=_.t-Number.EPSILON)===void 0&&(v.push(_),m.push(new ye(_.x,_.y)))}}return m}function a(f,p,v){let m=new ye;p.getCenter(m);let g=[];return v.forEach(y=>{y.boundingBox.containsPoint(m)&&n(f,y.points).forEach(b=>{g.push({identifier:y.identifier,isCW:y.isCW,point:b})})}),g.sort((y,b)=>y.point.x-b.point.x),g}function o(f,p,v,m,g){(g==null||g==="")&&(g="nonzero");let y=new ye;f.boundingBox.getCenter(y);let b=[new ye(v,y.y),new ye(m,y.y)],x=a(b,f.boundingBox,p);x.sort((M,P)=>M.point.x-P.point.x);let S=[],w=[];x.forEach(M=>{M.identifier===f.identifier?S.push(M):w.push(M)});let _=S[0].point.x,C=[],A=0;for(;A<w.length&&w[A].point.x<_;)C.length>0&&C[C.length-1]===w[A].identifier?C.pop():C.push(w[A].identifier),A++;if(C.push(f.identifier),g==="evenodd"){let M=C.length%2===0,P=C[C.length-2];return{identifier:f.identifier,isHole:M,for:P}}else if(g==="nonzero"){let M=!0,P=null,T=null;for(let R=0;R<C.length;R++){let z=C[R];p[z]&&(M?(T=p[z].isCW,M=!1,P=z):T!==p[z].isCW&&(T=p[z].isCW,M=!0))}return{identifier:f.identifier,isHole:M,for:P}}else console.warn('fill-rule: "'+g+'" is currently not implemented.')}let s=0,l=999999999,c=-999999999,u=[];this.subPaths.forEach(f=>{let p=f.getPoints(),v=-999999999,m=999999999,g=-999999999,y=999999999;for(let b=0;b<p.length;b++){let x=p[b];x.y>v&&(v=x.y),x.y<m&&(m=x.y),x.x>g&&(g=x.x),x.x<y&&(y=x.x)}c<=g&&(c=g+1),l>=y&&(l=y-1),p.length&&u.push({curves:f.curves,points:p,isCW:A8.isClockWise(p),identifier:s++,boundingBox:new B8(new ye(y,m),new ye(g,v))})});let d=u.map(f=>{var p;return o(f,u,l,c,(p=this.userData)==null?void 0:p.style.fillRule)}),h=[];return u.forEach(f=>{let p=d[f.identifier];if(p&&!p.isHole){let v=new Gx;v.curves=f.curves,d.filter(m=>(m==null?void 0:m.isHole)&&m.for===f.identifier).forEach(m=>{if(m){let g=u[m.identifier],y=new Wx;y.curves=g.curves,v.holes.push(y)}}),h.push(v)}}),h}},S9=!1,C9,f4=new Promise(e=>{C9=e}),p4=!1,lb;function vBe(){if(S9=!0,p4)return;if(lb)return lb;async function e(){let t=await Cc(()=>import("./opentype-D6jUvuOk.js"),[]);C9(t),p4=!0}return lb=e(),lb}var gBe=class{async load(e,t,r=()=>{}){let{load:i}=await f4;i(e,(n,a)=>{n||!a?r(n??"Something went wrong"):t(a)})}async parse(e){let{parse:t,Bidi:r}=await f4;try{let i=t(e),n=new r,a=o=>i.charToGlyphIndex(o.char);return n.registerModifier("glyphIndex",null,a),n.applyFeatures(i,i.defaultRenderOptions.features),{font:i,bidi:n}}catch(i){console.error(i)}}};async function yBe(e){return await(await fetch(e)).arrayBuffer()}var bBe=new gBe;async function m4(e){let t,r,i=!1;if(e.url?(t=await yBe(e.url),r=e.url,i=e.url.startsWith("/")):e.data&&(t=e.data.buffer.slice(e.data.byteOffset,e.data.byteOffset+e.data.byteLength)),t)if(S9){let n=await bBe.parse(t);if(n)return{font:n.font,url:r,intercepted:i,arr:t,bidi:n.bidi}}else return{font:void 0,url:r,intercepted:i,arr:t,bidi:null}}function xBe(e,t){return t.state.glyphIndex===e||t.state.fina===e||t.state.medi===e||t.state.init===e}var wBe=class{constructor(e){this._arrayBuffer=new ArrayBuffer(1),this._isLoaded=!1,this._intercepted=!1,this._isUserFont=e.isUserFont??!1,this._loadingPromise=m4(e).then(t=>{t&&(this._arrayBuffer=t.arr,this._url=t.url,this.font=t.font,this._intercepted=t.intercepted,this._isLoaded=!0,this._bidi=t.bidi)})}update(e){this._isLoaded=!1,this._isUserFont=e.isUserFont??!1,this._loadingPromise=m4(e).then(t=>{t&&(this._arrayBuffer=t.arr,this._url=t.url,this.font=t.font,this._intercepted=t.intercepted,this._isLoaded=!0,this._bidi=t.bidi)})}get url(){return this._url}get intercepted(){return this._intercepted}get isLoaded(){return this._isLoaded}get loadingPromise(){return this._loadingPromise}reverseLigaturesTable(e,t,r){if(!this._bidi)return[];let i=this._bidi;i.getTextGlyphs(t);let n=i.tokenizer.tokens,a=[],o=0,s=r.length===n.length;for(let l=0;l<r.length;l++){let c=r[l].index,u=String.fromCharCode(r[l].unicode),d=n[o];if(xBe(c,d)||s)a.push({char:u,index:c,replacements:[d.state.glyphIndex],replacementChars:[d.char]}),o++;else{let h=d.char,f="",p=[d.state.glyphIndex],v=[],m=!1;for(;!m;)o++,f=t.charAt(o),h+=f,p.push(e.charToGlyphIndex(f)),v=e.stringToGlyphs(h),v.length===1&&v[0].index===c&&(m=!0),o>t.length&&(m=!0);a.push({char:u,index:c,replacements:p,replacementChars:Array.from(h)}),o++}}return a}generateShapes(e,t){if(!this._isLoaded)return;let r=this.font,i=t.fontSize/this.unitsPerEm,n=t.fontSize*t.lineHeight,a=e.map(g=>this.getTextWidth(g,t)),o=t.width,s=this.getCharWidth(`
`,t),l=t.horizontalAlign===1?s:0,c=this.computeSpaceWidthForLine(e,0,t),u=this.getLineInitialOffsetX(a[0],o,t.horizontalAlign,e[0],s),d=this.getLineInitialOffsetY(n,e.length,t.height,i,t.verticalAlign),h=[],f=e.map(g=>[]),p=e.map(g=>[]),v;for(let g=0;g<e.length;g++){let y=e[g],b={features:{liga:!0}},x=[];try{x=r.stringToGlyphs(y,b)}catch(w){console.warn(w)}u=this.getLineInitialOffsetX(a[g],o,t.horizontalAlign,y,s);let S=[];try{S=this.reverseLigaturesTable(r,y,x)}catch(w){console.warn(w)}c=this.computeSpaceWidthForLine(e,g,t);for(let w=0;w<x.length;w++){let _=x[w],C=_.index===0?`
`:_.unicode?String.fromCharCode(_.unicode):void 0,A=S[w],M=0,P=0;w===0&&t.horizontalAlign===2&&_.leftSideBearing!==void 0&&(P=-_.leftSideBearing*i),v&&(M=r.getKerningValue(_,v)*i),u+=P+M;let T=0;if(C===`
`)T=l;else if(C===" ")T=c;else{let R=this.createPath(_,i,u,d,t);R&&(T=R.offsetX-(M+P),h.push(R.path))}if(A.replacements.length===1)p[g].push([u,d]),f[g].push(T);else{let R=A.replacements.map(N=>(r.glyphs.get(N).advanceWidth??0)*i),z=R.reduce((N,U)=>N+=U,0),F=R.map(N=>N/z),H=u;for(let N=0;N<F.length;N++){let U=T*F[N];p[g].push([H,d]),f[g].push(U),H+=U}}u+=T,v=_}d-=n}let m=[];for(let g=0,y=h.length;g<y;g++)m.push(...h[g].toShapes());return{shapes:m,charWidths:f,lineWidths:a,charCoords:p}}get isUserFont(){return this._isUserFont}get arrayBuffer(){return this._arrayBuffer}get ascender(){var e;return((e=this.font)==null?void 0:e.ascender)??0}get descender(){var e;return((e=this.font)==null?void 0:e.descender)??0}get familyName(){var e;return((e=this.font)==null?void 0:e.names.fontFamily)??""}get subfamilyName(){var e;return((e=this.font)==null?void 0:e.names.fontSubfamily)??""}get unitsPerEm(){var e;return((e=this.font)==null?void 0:e.unitsPerEm)??1}getLineInitialOffsetX(e,t,r,i,n){return(r===3||r===2)&&i.indexOf(`
`)>=0&&(e-=n),r===3?t*.5-e*.5:r===2?t-e:0}getLineInitialOffsetY(e,t,r,i,n){let a=t*e,o=Math.abs(this.ascender-this.descender)*i,s=e-o,l=-this.ascender*i-s/2;return n===3?-(r-a-l):n===2?-(r*.5-a*.5-l):l}createPath(e,t,r,i,n){var l;let a=e.getPath(r,-i,n.fontSize,{kerning:!1,letterSpacing:n.letterSpacing});if(!a){console.error('THREE.Font: character "'+e+'" does not exists in font family '+this.familyName+".");return}let o=new mBe,s=(e.advanceWidth??1)*t;if(e)for(let c of a.commands){let u=(l=o.currentPath)==null?void 0:l.currentPoint;if(!(u&&c.type!=="Z"&&u.x===c.x&&-u.y===c.y))switch(c.type){case"M":o.moveTo(c.x,-c.y);break;case"L":o.lineTo(c.x,-c.y);break;case"Q":o.quadraticCurveTo(c.x1,-c.y1,c.x,-c.y);break;case"C":o.bezierCurveTo(c.x1,-c.y1,c.x2,-c.y2,c.x,-c.y);break}}return o.subPaths.forEach(c=>{let u=SBe(c.curves);u!==void 0&&c.currentPoint.distanceTo(u)>0&&c.lineTo(u.x,u.y)}),{offsetX:s+n.fontSize*n.letterSpacing,path:o}}getCharWidth(e,t){var r;return((r=this.font)==null?void 0:r.getAdvanceWidth(e,t.fontSize,{kerning:!0,letterSpacing:t.letterSpacing}))??0}getTextWidth(e,t){var r;return((r=this.font)==null?void 0:r.getAdvanceWidth(e,t.fontSize,{kerning:!0,letterSpacing:t.letterSpacing}))??0}computeSpaceWidthForLine(e,t,r){let i=this.getCharWidth(" ",r),n=e[t];if(n){let a=this.countSpaces(n.trimEnd());if(r.horizontalAlign===4&&t<e.length-1&&a){let o=r.width,s=this.getTextWidth(n,r);return(o-(s-a*i))/a}}return i}countSpaces(e){return(e.match(/ /g)||[]).length}};function SBe(e){if(e.length){let t=e[0];if(t instanceof ms)return t.v1;if(t instanceof cs||t instanceof Bu)return t.v0}}var CBe=class{constructor(){this.objects=new Map,this.unreachable=new Set}getCached(e){return this.objects.get(e)}get size(){return this.objects.size}get(e,t,r){let i=this.objects.get(e);return i===void 0?(i=this.createObject(e,t,r),this.objects.set(e,i)):i.isShared=!0,i}forceDelete(e){let t=this.objects.get(e);t&&(this.disposeObject(t),this.objects.delete(e))}mutateIfUnique(e,t){let r=this.objects.get(e);if(r&&r.isShared!==!0)return this.objects.delete(e),this.objects.set(t,r),r}startGc(){this.unreachable=new Set(this.objects.keys())}markAsReachable(e,t){let r=this.objects.get(e);t===r&&this.unreachable.delete(e)}endGc(){this.unreachable.forEach(e=>{this.disposeObject(this.objects.get(e)),this.objects.delete(e)}),this.unreachable.clear()}dispose(){this.objects.forEach(e=>{this.disposeObject(e)}),this.objects.clear()}},v4=class extends CBe{constructor(e){super(),this.flatShading=e}disposeObject(e){e.dispose()}createObject(e,t,r){let i=qg(e,t,this.flatShading,r);return i.computeBoundingSphere(),i}},_Be={markNeedsUpdateRendererDirty:()=>{}};function $D(e){return{all:e=e||new Map,on:function(t,r){var i=e.get(t);i?i.push(r):e.set(t,[r])},off:function(t,r){var i=e.get(t);i&&(r?i.splice(i.indexOf(r)>>>0,1):e.set(t,[]))},emit:function(t,r){var i=e.get(t);i&&i.slice().map(function(n){n(r)}),(i=e.get("*"))&&i.slice().map(function(n){n(t,r)})}}}var ABe=class{constructor(e,t,r){var i;this.id=e,this.userAPI=t,this.result=void 0,this.error="null",this.isPrefetched=!1,this.isLoading=!1,this.isLoaded=!1,this.prefetchPromise=new Promise(n=>n()),this.emitter=$D(),((i=t==null?void 0:t.integration)==null?void 0:i.type)==="OpenAI"?this.result={content:""}:t.method==="GET"&&t.url!==""&&(this.prefetchPromise=this.prefetch(r))}async prefetch(e){await this.callUserAPI(e)}async callUserAPI(e){var t,r,i;this.emitter.emit("start",{userAPIId:this.id}),this.isLoading=!0,this.isLoading=!1;try{this.result=await DBe(this.userAPI,e),this.error="null",this.emitter.emit("success",{userAPIId:this.id})}catch(n){let a=((i=(r=(t=n.message)==null?void 0:t.split("_:_"))==null?void 0:r[0])==null?void 0:i.replace("status:",""))??"null";this.error=a,this.result=null,this.emitter.emit("error",{userAPIId:this.id})}this.isLoading=!1,this.isPrefetched=!0,this.isLoaded=!0}update(e,t){this.userAPI=e,this.userAPI.url!==""&&this.userAPI.method==="GET"&&this.prefetch(t)}retrieveValue(e){if(this.result)try{return xn.zoom(this.result,e)}catch(t){console.error(t)}}retrieveZoomedKeyValues(e){if(this.result){let t=e&&e.length?xn.zoom(this.result,e):this.result;if(PBe(t))return Object.entries(t);if(TBe(t))return t.map((r,i)=>[i.toString(),r]);throw EBe(t)?new Error("This path points to a value, use retrieveValue() instead. "+(e==null?void 0:e.join("."))):new Error("Path error"+(e==null?void 0:e.join(".")))}}dispose(){}on(e,t){this.emitter.on(e,t)}off(e,t){this.emitter.off(e,t)}get autostart(){return this.userAPI.autoStart}};function MBe(e){let t=new Headers;return e.headers.forEach(r=>{r.data.key!==""&&t.append(r.data.key,r.data.value)}),t}function EBe(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||e===null}function TBe(e){return Array.isArray(e)}function PBe(e){return typeof e=="object"&&e!==null}async function DBe(e,t,r=new AbortController){var a,o;let i;if(((a=e.integration)==null?void 0:a.type)==="OpenAI"){let s=$b(e.integration.prompt===""?"":JSON.parse(e.integration.prompt),t),l=e.integration.behavior===""?"":$b(JSON.parse(e.integration.behavior),t);i=`{
			"model": "${e.integration.model}",
			"messages": [${e.integration.useBehavior?`
			{
				"role": "system",
				"content": "${l}"
			},`:""}
			{
				"role": "user",
				"content": "${s}"
			}
			]
		}`}else e.method==="POST"&&e.body&&(i=$b(JSON.parse(e.body),t));let n=await fetch(e.url,{method:e.method,headers:MBe(e),signal:r.signal,body:i});if(!n.ok)throw new Error("status:"+n.status+"_:_"+n.statusText);return((o=e.integration)==null?void 0:o.type)==="OpenAI"?{content:(await n.json()).choices[0].message.content}:await n.json()}var _9=(e,t)=>{if(typeof e=="string"){let r=t.getVariable(e);if(r)return _9(r,t)}return na.isBoolean(e)?na.getDisplayedValue(e).toLowerCase():na.getDisplayedValue(e)},$b=(e,t)=>e.map((r,i)=>{if("text"in r)return r.text;if("type"in r){if(r.type==="paragraph")return(i>0?`
`:"")+$b(r.children,t);if(r.type==="variable"){let n=t.getVariable(r.variableId);if(n!==void 0)return _9(n,t)}}return""}).join(""),qb=1e3,g4=512*qb;function OBe(e,t){let r=typeof e;return!!((t==="string"||t==="number")&&r===t||t==="boolean"&&(e==="true"||e==="false"||e===!0||e===!1)||t==="image"&&r==="string"&&e.startsWith("http"))}var RBe="https://hooks.spline.design",IBe=`${RBe}/events?hashFile=`,zBe=class{constructor(e,t){this.id=e,this.userWebhook=t,this.result=void 0,this._connected=!1,this.emitter=$D(),this.reconnectWaitFor=qb,this._onError=r=>{var i,n,a;(i=this.eventSource)==null||i.removeEventListener("message",this._onMessage),(n=this.eventSource)==null||n.removeEventListener("error",this._onError),(a=this.eventSource)==null||a.removeEventListener("open",this._onConnected),this._scheduleReconnect()},this._onConnected=r=>{clearTimeout(this.scheduledReconnectHandle),this.reconnectWaitFor=qb,this._connected=!0},this._onDisconnected=()=>{clearTimeout(this.scheduledReconnectHandle),this.reconnectWaitFor=qb,this._connected=!1},this._onMessage=r=>{let i=r.data,n;try{n=JSON.parse(i)}catch(a){console.error("Error parsing webhook message",a)}if(n){let a=!1;this.userWebhook.parametersSchemas.forEach(({data:o})=>{n[o.name]!==void 0&&OBe(n[o.name],o.type)&&(this.result===void 0&&(this.result={}),this.result[o.name]=n[o.name],a=!0)}),a&&this.emitter.emit("message",{userWebhookId:this.id})}}}connect(){clearTimeout(this.scheduledReconnectHandle),this.userWebhook.url&&(this.eventSource=new EventSource(IBe+this.userWebhook.url),this.eventSource.addEventListener("message",this._onMessage),this.eventSource.addEventListener("error",this._onError),this.eventSource.addEventListener("open",this._onConnected))}disconnect(){var e,t,r,i;(e=this.eventSource)==null||e.removeEventListener("message",this._onMessage),(t=this.eventSource)==null||t.removeEventListener("error",this._onError),(r=this.eventSource)==null||r.removeEventListener("open",this._onConnected),(i=this.eventSource)==null||i.close(),this._onDisconnected(),clearTimeout(this.scheduledReconnectHandle)}_scheduleReconnect(){this.reconnectWaitFor*=2,this.reconnectWaitFor>g4&&(this.reconnectWaitFor=g4),clearTimeout(this.scheduledReconnectHandle),this.scheduledReconnectHandle=setTimeout(()=>{this.scheduledReconnectHandle=void 0,this.connect()},this.reconnectWaitFor)}update(e){this.userWebhook=e}dispose(){this._connected&&this.disconnect()}get connected(){return this._connected}on(e,t){this.emitter.on(e,t)}off(e,t){this.emitter.off(e,t)}getParametersKeys(){return this.userWebhook.parametersSchemas.map(e=>e.data.name)}getParameterValue(e){var t;if(this.getParametersKeys().includes(e)){if(this.result)return(t=this.result)==null?void 0:t[e];for(let r of this.userWebhook.parametersSchemas)if(r.data.name===e)return uE.defaultParameterValueByType(r.data.type)}}};function BE(e){return"variable_"+e}var kBe=class extends wLe{constructor(e){super(),this.shared=e}create(e){return new f9(e,this.shared)}},qD=class{constructor(e,t={},r=!0,i=!1){if(this.data=e,this.needsJitter=r,this.enableLocalStorageForPersistentVariables=i,this.geometryCache=new v4(!0),this.geometryCache2=new v4(!1),this.imageHolderCache=new kBe(this),this.thisContext={scene:_Be,shared:this},this.deletedMaterial=new LE(ia.defaultTwoLayerData("phong"),this.thisContext,""),this.deletedImage=new uu(hE.emptyImage,this),this.deletedVideo=new uu(h1.defaultVideo,this),this.materials={},this.images={},this.uiBuffers={},this.videos={},this.colors={},this.audios={},this.particles={},this.fonts={},this.variables={},this.userAPIs={},this.userWebhooks={},this.mouseProperty=null,this.raycastProperty=null,this.requestRender=()=>{this._requestRender&&this._requestRender()},t.images)for(let[n,a]of Object.entries(t.images))this.addImage(n,a);if(t.videos)for(let[n,a]of Object.entries(t.videos))this.addVideo(n,a);if(t.audios)for(let[n,a]of Object.entries(t.audios))this.addAudio(n,a);if(t.particles)for(let[n,a]of Object.entries(t.particles))this.addParticle(n,a);this.reset(e)}setRequestRender(e){this._requestRender=e}getImageLoadPromises(){return Object.values(this.images).map(e=>e.loadPromise)}setEntityOpContext(e){this.entityOpContext=e}reset(e,t=!1){this.data=e,this.resetLib(e.lib);for(let{id:r,data:i}of e.variables)this.addVariableHolder(r,i),t&&this.updateVariableHolder(r,i);for(let[r,i]of Object.entries(e.userAPIs))this.addUserAPI(r,i);for(let[r,i]of Object.entries(e.userWebhooks))this.addUserWebhook(r,i);for(let[r,i]of Object.entries(e.images))this.addImage(r,i);for(let[r,i]of Object.entries(e.videos))this.addVideo(r,i);for(let[r,i]of Object.entries(e.colors))this.addColor(r,i);for(let[r,i]of Object.entries(e.materials))this.addMaterial(r,i);for(let[r,i]of Object.entries(e.audios))this.addAudio(r,i);for(let[r,i]of Object.entries(e.particles))this.addParticle(r,i);for(let[r,i]of Object.entries(e.fonts))this.addFont(r,i)}addMaterial(e,t){if(this.materials[e]){let r=this.materials[e];r.reset(t,this.thisContext),r.dispose()}else{let r=new LE(t,this.thisContext,e);this.materials[e]=r}}deleteMaterial(e){this.materials[e]&&(this.materials[e].nodeMaterialDispose(),delete this.materials[e])}getMaterial(e){return this.materials[e]}getMaterialOrDeletedPlaceholder(e){return this.materials[e]??this.deletedMaterial}material(e){return typeof e=="string"?this.getMaterialOrDeletedPlaceholder(e):e==null?(console.error("material is undefined or null"),this.deletedMaterial):new GD(e,this.thisContext)}getMaterials(){return this.materials}addImage(e,t){return this.images[e]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),this.images[e].updateSrc(t.data),!0):(this.images[e]=new uu(t,this),!1)}deleteImage(e){let t=this.images[e];t&&(t.dispose(),delete this.images[e])}getDefaultImage(){return this.images.image_0}getImage(e){return this.images[e]??this.deletedImage}image(e){return typeof e=="string"?this.getImage(e):this.imageHolderCache.load(e)}addUIBuffer(e,t){return this.uiBuffers[e]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),this.uiBuffers[e].updateSrc(t),!0):(this.uiBuffers[e]=new uu(t,this),!1)}uiBuffer(e){return this.uiBuffers[e]}addVideo(e,t){return this.videos[e]?(this.videos[e].updateSrc(t.data),!0):(this.videos[e]=new uu(t,this),!1)}deleteVideo(e){let t=this.videos[e];t&&(t.dispose(),delete this.videos[e])}getVideo(e){return this.videos[e]??this.deletedVideo}video(e){return typeof e=="string"?this.getVideo(e):this.imageHolderCache.load(e)}addColor(e,t){return this.colors[e]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),"a"in t?this.colors[e].setRGBA(t.r,t.g,t.b,t.a):this.colors[e].setRGBA(t.r,t.g,t.b,1),!0):("a"in t?this.colors[e]=new P1(t.r,t.g,t.b,t.a):this.colors[e]=new P1(t.r,t.g,t.b,1),!1)}updateColor(e,t){if(this.colors[e]){this.onColorOrImageUpdate&&this.onColorOrImageUpdate();let r=this.colors[e];return this.colors[e].r=t.r??r.r,this.colors[e].g=t.g??r.g,this.colors[e].b=t.b??r.b,this.colors[e].a=t.a??r.a,!0}return!1}deleteColor(e){this.colors[e]&&delete this.colors[e]}getColor(e){return this.colors[e]}color(e){let t;if(typeof e=="string"){let r=this.getColor(e);r?t=r:(console.warn("Tried to create color layer params with a color key that does not exist in the assets manager"),t=new sa(0,0,0,0))}else return"a"in e?new sa(e.r,e.g,e.b,e.a):new sa(e.r,e.g,e.b,1);return t}addAudio(e,t){this.audios[e]=t}getAudio(e){let t=this.audios[e];if(t instanceof Mv)return t;{let r=new Mv({src:t.data});return this.audios[e]=r,r}}addParticle(e,t){this.particles[e]=t}getParticle(e){return this.particles[e]}deleteParticle(e){this.particles[e]&&delete this.particles[e]}deleteAudio(e){let t=this.audios[e];t&&(t instanceof Mv&&t.dispose(),delete this.audios[e])}addFont(e,t){this.fonts[e]=new wBe(t),this.fonts[e].loadingPromise.then(()=>this.requestRender())}getFont(e){return this.fonts[e]}deleteFont(e){this.fonts[e]&&delete this.fonts[e]}dispose(){Object.keys(this.materials).forEach(e=>this.deleteMaterial(e)),this._requestRender=void 0,Object.values(this.audios).forEach(e=>{e instanceof Mv&&e.dispose()}),this.audios={},this.particles={},this.geometryCache.dispose(),this.geometryCache2.dispose()}addVariableHolder(e,t){if(this.variables[e]===void 0){let r=t.value;if(this.enableLocalStorageForPersistentVariables&&t.persistent){let i=localStorage.getItem(BE(e));r=i!==null?JSON.parse(i):t.value}return this.variables[e]={value:r,locations:[],persistent:t.persistent},"dynamicVariableType"in t&&(this.variables[e].dynamicVariablePlayState="Playing",this.variables[e].dynamicVariableToggleIsForward=void 0),!0}return this.variables[e].value=t.value,!1}resetDynamicVariablePlayState(){for(let e in this.variables)this.variables[e].dynamicVariablePlayState!==void 0&&(this.variables[e].dynamicVariablePlayState="Playing",this.variables[e].dynamicVariableToggleIsForward=void 0)}updateVariableHolder(e,t){this.updateVariable(e,t.value)}updateVariable(e,t){if(this.variables[e]===void 0)return!1;this.variables[e].value=t,this.enableLocalStorageForPersistentVariables&&this.variables[e].persistent&&localStorage.setItem(BE(e),JSON.stringify(t));let r=t;for(;typeof r=="string";)r=this.variables[r].value;let i=this.entityOpContext.scene;for(let n=this.variables[e].locations.length-1;n>=0;n--){let a=this.variables[e].locations[n];if(a[0]==="material"){let o=a[1],s=r,l={scene:i,shared:this},c=a.slice(2);i.traverseMaterial(d=>{let h=d.root??d;h.uuid===o&&h.onVariableUpdate(c,s,l)});let u=this.materials[o];u&&u.onVariableUpdate(c,s,l)}else{let o=i.find(a[0]);if(o===void 0){this.variables[e].locations.splice(n,1);continue}if(a[1]!=="geometry"&&a[1]!=="particles"){for(let s=1;s<a.length-1;s++)o=o[a[s]];a[1]==="rotation"?o[a[a.length-1]]=r*St.DEG2RAD:o[a[a.length-1]]=r}if(o=i.find(a[0]),o.type==="ParticleEmitter"&&o.updateVariableState(r,a),_r.is(o)){if(a[1]==="position"||a[1]==="rotation"||a[1]==="scale")o.onVariableUpdate();else if(a[1]==="geometry"){let s=o;o.component&&(s=o.component);let l=s.dataPatched;s.chooseGeoemtryCache(this).forceDelete(l.geometry),s.createGeometryDelayed(this.entityOpContext),s.onVariableUpdate(!0),s.instances.forEach(c=>{let u=c.dataPatched;c.chooseGeoemtryCache(this).forceDelete(u.geometry),c.createGeometryDelayed(this.entityOpContext),c.onVariableUpdate(!0)})}}}}return this.requestRender(),!0}deleteVariable(e){this.variables[e]&&delete this.variables[e]}getVariable(e,t){var r,i,n;if(Array.isArray(e)){if(e[0]==="mouse")return((r=this.mouseProperty)==null?void 0:r[e[1]])??0;if(e[0]==="raycast")return((i=this.raycastProperty)==null?void 0:i[e[1]])??0;let a=this.entityOpContext.scene.find(e[0]);if(e[1]==="width"||e[1]==="height"||e[1]==="depth")return a.geometry.userData.parameters[e[1]];for(let o=1;o<e.length;o++)a=a[e[o]];return e[1]==="rotation"&&(a*=St.RAD2DEG),a}for(let a in this.variables){if(t===void 0)break;let o=this.variables[a],s=(n=o.locations)==null?void 0:n.findIndex(l=>xn.equal(l,t));s!==void 0&&s!==-1&&o.locations.splice(s,1)}if(typeof e=="string"){let a=e,o=e;do{if(o=a,this.variables[a]===void 0)break;let s=this.variables[a].value;t&&this.variables[o]!==void 0&&this.variables[o].locations.push(t),a=s}while(typeof a=="string");return a}else return e}getVariables(){return this.variables}getDynamicVariablePlayState(e){var t;return(t=this.variables[e])==null?void 0:t.dynamicVariablePlayState}setDynamicVariablePlayState(e,t){this.variables[e]!==void 0&&(this.variables[e].dynamicVariablePlayState=t)}getDynamicVariableToggleIsForward(e){var t;return(t=this.variables[e])==null?void 0:t.dynamicVariableToggleIsForward}setDynamicVariableToggleIsForward(e,t){this.variables[e]!==void 0&&(this.variables[e].dynamicVariableToggleIsForward=t)}resetLib(e){for(let[t,r]of Object.entries(e.images))this.addImage(t,r.asset);for(let[t,r]of Object.entries(e.audios))this.addAudio(t,r.asset);for(let[t,r]of Object.entries(e.particles))this.addParticle(t,r.asset);for(let[t,r]of Object.entries(e.colors))this.addColor(t,r.asset);for(let[t,r]of Object.entries(e.fonts))this.addFont(t,r.asset);for(let[t,r]of Object.entries(e.materials))this.addMaterial(t,r.asset);for(let[t,r]of Object.entries(e.videos))this.addVideo(t,r.asset);for(let[t,r]of Object.entries(e.variables))this.addVariableHolder(t,r.asset)}updateLibByOp(e,t){e.path[0]==="images"?e.path.length===1&&e.type===1?this.addImage(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteImage(e.id):e.path[0]==="videos"?e.path.length===1&&e.type===1?this.addVideo(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteVideo(e.id):e.path[0]==="audios"?e.path.length===1&&e.type===1?this.addAudio(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteAudio(e.id):e.path[0]==="particles"?e.path.length===1&&e.type===1?this.addParticle(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteParticle(e.id):e.path[0]==="colors"?e.path.length===1&&e.type===1?this.addColor(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteColor(e.id):e.path[0]==="materials"?e.path.length===1&&e.type===1?this.addMaterial(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteMaterial(e.id):e.path[0]==="fonts"?e.path.length===1&&e.type===1?this.addFont(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteFont(e.id):e.path[0]==="variables"?e.path.length===1&&e.type===1?this.addVariableHolder(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteVariable(e.id):e.path[0]==="components"&&t.updateByLibOp(e,this)}updateByOp(e,t,r){var i,n;if(this.data=t,e.path[0]==="images")e.path.length===2&&e.type===0?e.props.data&&this.getImage(e.path[1]).updateSrc(e.props.data):e.path.length===1&&e.type===1?this.addImage(e.id,e.data):e.path.length===1&&e.type===2&&this.deleteImage(e.id);else if(e.path[0]==="videos")e.path.length===2&&e.type===0?e.props.data&&this.getVideo(e.path[1]).updateSrc(e.props.data):e.path.length===1&&e.type===1?this.addVideo(e.id,e.data):e.path.length===1&&e.type===2&&this.deleteVideo(e.id);else if(e.path[0]==="audios")e.path.length===2&&e.type===0?e.props.data&&this.addAudio(e.path[1],t.audios[e.path[1]]):e.path.length===1&&e.type===1?this.addAudio(e.id,e.data):e.path.length===1&&e.type===2&&this.deleteAudio(e.id);else if(e.path[0]==="particles")e.path.length===2&&e.type===0?e.props.data&&this.addParticle(e.path[1],t.particles[e.path[1]]):e.path.length===1&&e.type===1?this.addParticle(e.id,e.data):e.path.length===1&&e.type===2&&this.deleteParticle(e.id);else if(e.path[0]==="colors")e.path.length===2&&e.type===0?this.updateColor(e.path[1],e.props):e.path.length===1&&e.type===1?this.addColor(e.id,e.data):e.path.length===1&&e.type===2&&this.deleteColor(e.id);else if(e.path[0]==="materials")e.path.length===1&&e.type===1?this.addMaterial(e.id,e.data):e.path.length===1&&e.type===2?this.deleteMaterial(e.id):e.path.length>1&&this.getMaterial(e.path[1]).updateByOp(Bn.drop(e,2),t.materials[e.path[1]],{shared:this,scene:r});else if(e.path[0]==="fonts")e.path.length===2&&e.type===0?this.updateFont(e.path[1],e,r):e.path.length===1&&e.type===1?this.addFont(e.id,e.data):e.path.length===1&&e.type===2&&this.deleteFont(e.id);else if(e.path[0]==="variables")e.path.length===2&&e.type===0?"value"in e.props?this.updateVariable(e.path[1],e.props.value):"persistent"in e.props&&(this.variables[e.path[1]].persistent=e.props.persistent):e.path.length===1&&e.type===4?this.addVariableHolder(e.id,e.data):e.path.length===1&&e.type===5&&this.deleteVariable(e.id);else if(e.path[0]==="userAPIs"){if(e.path.length===1&&e.type===1)this.addUserAPI(e.id,e.data);else if(e.path.length===1&&e.type===2)this.deleteUserAPI(e.id);else if(typeof e.path[1]=="string"){let a=t.userAPIs[e.path[1]];a&&((i=this.getUserAPI(e.path[1]))==null||i.update(a,this))}}else if(e.path[0]==="userWebhooks"){if(e.path.length===1&&e.type===1)this.addUserWebhook(e.id,e.data);else if(e.path.length===1&&e.type===2)this.deleteUserWebhook(e.id);else if(typeof e.path[1]=="string"){let a=t.userWebhooks[e.path[1]];a&&((n=this.getUserWebhook(e.path[1]))==null||n.update(a))}}else e.path[0]==="lib"&&this.updateLibByOp(Bn.drop(e,1),r)}updateFont(e,t,r){if(t.props.url){let i=this.getFont(e),n={...this.data.fonts[e],url:t.props.url};i.update(n),i.loadingPromise.then(()=>this.requestRender()),r.updateFont(e,this)}}addUserAPI(e,t){return this.userAPIs[e]?(this.userAPIs[e].update(t,this),!0):(this.userAPIs[e]=new ABe(e,t,this),!1)}getUserAPI(e){return this.userAPIs[e]}getUserAPIs(){return this.userAPIs}deleteUserAPI(e){let t=this.userAPIs[e];t&&(t.dispose(),delete this.userAPIs[e])}addUserWebhook(e,t){return this.userWebhooks[e]?(this.userWebhooks[e].update(t),!0):(this.userWebhooks[e]=new zBe(e,t),!1)}getUserWebhook(e){return this.userWebhooks[e]}getUserWebhooks(){return this.userWebhooks}deleteUserWebhook(e){let t=this.userWebhooks[e];t&&(t.dispose(),delete this.userWebhooks[e])}};new qD(Oo.emptyData());var xm=class extends Fa{updateByPatchedOp(e,t,r){if(super.updateByPatchedOp(e,t,r),hRe(e.path,["materials"])!==null&&e.type===0&&Array.isArray(this.material))for(let[i,n]of Object.entries(e.props)){let a=r.shared.material(n);this.material[Number(i)]=a}else if(li(e.path,["material"])&&this.material instanceof Nu)"material"in t&&typeof t.material!="string"&&this.material.updateByOp(Bn.drop(e,1),t.material,r);else if(li(e.path,["materials","*"])&&Array.isArray(this.material)){let i=e.path[1];if("materials"in t&&i<this.material.length){let n=t.materials[i];typeof n!="string"&&this.material[i].updateByOp(Bn.drop(e,2),n,r)}}}get needsAO(){return this.material!==void 0?(Array.isArray(this.material)?this.material[0]:this.material).hasAO:!1}updateState(e,t){var i,n;super.updateState(e,t),e.castShadow!==void 0&&(this.castShadow=e.castShadow),e.receiveShadow!==void 0&&(this.receiveShadow=e.receiveShadow);let r=this.dataPatched;if(((i=e.geometry)==null?void 0:i.type)!=="NonParametricGeometry"&&"material"in e&&e.material!==void 0&&(this.disposeMaterial(),this.material=t.shared.material(e.material).getFlavor(r.flatShading,r.side,r.wireframe),t.scene.markNeedsUpdateRendererDirty()),(((n=e.geometry)==null?void 0:n.type)==="NonParametricGeometry"||"materials"in e)&&("materials"in e&&e.materials!==void 0?(this.disposeMaterial(),this.material=e.materials.map(a=>t.shared.material(a).getFlavor(r.flatShading,r.side,r.wireframe)),t.scene.markNeedsUpdateRendererDirty()):"material"in e&&e.material!==void 0&&(this.disposeMaterial(),this.material=[t.shared.material(e.material).getFlavor(r.flatShading,r.side,r.wireframe)],t.scene.markNeedsUpdateRendererDirty())),e.flatShading!==void 0||e.wireframe!==void 0||e.side!==void 0)if(Array.isArray(this.material))for(let a=0;a<this.material.length;a++)this.material[a]=this.material[a].getFlavor(r.flatShading,r.side,r.wireframe);else this.material=this.material.getFlavor(r.flatShading,r.side,r.wireframe)}disposeMaterial(){this.material&&SH(this.material).forEach(e=>{e instanceof Nu&&(e instanceof LE||e.nodeMaterialDispose())})}dispose(){this.disposeMaterial(),super.dispose()}},y4=new k,b4=new Qt,x4=new Qt,LBe=new k,w4=new it,ba=class extends xm{constructor(e,t,r){super(e,t),this.data=t,this.isSkinnedMesh=!1,this.localGeometry=void 0,t.bindMode&&t.bindMatrix&&(this.bindMode=t.bindMode,this.bindMatrix=new it().fromArray(t.bindMatrix),this.bindMatrixInverse=new it)}chooseGeoemtryCache(e){return e.geometryCache}markGeometryAsReachable(e){this.geometryCreateDeleyed instanceof Ot&&this.chooseGeoemtryCache(e).markAsReachable(this.dataPatched.geometry,this.geometryCreateDeleyed)}get geometry(){if(this.localGeometry!==void 0)return this.localGeometry;if(this.geometryCreateDeleyed instanceof qD){let e=this.geometryCreateDeleyed,t=this.chooseGeoemtryCache(e);this.geometryCreateDeleyed=t.get(this.dataPatched.geometry,e,this)}return this.geometryCreateDeleyed}set geometry(e){this.localGeometry=e}get is2DAndNoDepth(){let e=this.dataPatched.geometry;return m1.is2DParametricMesh(e.type)&&e.depth===0}get is2DType(){return m1.is2DParametricMesh(this.geometry.userData.type)}get isNonParametric(){return this.geometry.userData.type==="NonParametricGeometry"}updateByPatchedOp(e,t,r){super.updateByPatchedOp(e,t,r),li(e.path,["geometry"])&&this.updateByPatchedOpGeometry(Bn.drop(e,1),t.geometry,r)}removeInteractionGeometry(e){var t;(t=this.localGeometry)==null||t.dispose(),this.localGeometry=void 0}updateGeometryInteractions(e,t){var i;this.invalidateDownstreamBooleanData();let r=this.data.geometry.type;if(r==="NonParametricGeometry"||r==="SubdivGeometry"){let n=e;if(this.localGeometry===void 0){let c={...this.data.geometry,...n};this.localGeometry=qg(c,t,this.data.flatShading,this)}let a,o,s;n.scaleBaked?[a,o,s]=n.scaleBaked:{width:a,height:o,depth:s}=n;let l=this.localGeometry.userData;l.sxPrev!==void 0&&DE(this.localGeometry.attributes,a/l.sxPrev,o/l.syPrev,s/l.szPrev),l.sxPrev=a,l.syPrev=o,l.szPrev=s}else{let n={...this.data.geometry,...e};(i=this.localGeometry)==null||i.dispose(),this.localGeometry=qg(n,t,this.data.flatShading,this)}}refreshAttachedClonersInteractions(){for(let e of this.attachedSurfaceCloners)e.update()}refreshAttachedCloners(e){for(let t of this.attachedSurfaceCloners)e.scene.addPendingUpdateCloner(t.object)}refreshAttachedPaths(e){for(let t of this.attachedPaths)e.scene.addPendingCommand(()=>t.updateShape())}createGeometryDelayed(e){this.geometryCreateDeleyed=e.shared,this.refreshAttachedCloners(e),this.refreshAttachedPaths(e)}updateByPatchedOpGeometry(e,t,r){var n;let i=!1;e.type===0&&e.path.length===0&&Object.keys(e.props).includes("scaleBaked")&&this.geometryCreateDeleyed instanceof Pa&&this.chooseGeoemtryCache(r.shared).mutateIfUnique(this.geometryCreateDeleyed.data,t)===this.geometryCreateDeleyed&&(i=!0,this.geometryCreateDeleyed.mutateDirectlyScaleBaked(t,e.props.scaleBaked),this.refreshAttachedCloners(r),this.refreshAttachedPaths(r)),i||((n=r.scene)==null||n.markGeometryCacheDirty(),this.createGeometryDelayed(r)),this.resetBBoxNeedsUpdate(),this.invalidateDownstreamBooleanData()}updateGeometryOnStateUpdate(e,t){this.createGeometryDelayed(t)}updateState(e,t){e.geometry!==void 0&&this.updateGeometryOnStateUpdate(e.geometry,t),super.updateState(e,t)}updateGeometryGroupsIfNeeded(){var e;Array.isArray(this.material)&&this.geometry.groups.length===0&&this.geometry.addGroup(0,Math.max(((e=this.geometry.getIndex())==null?void 0:e.count)??0,this.geometry.getAttribute("position").count),0)}updateEntityBoxSize(e,t){let r=this.geometry.userData.parameters;this.is2DType?e.set(0,0,r.depth*.5):this.isNonParametric?(e.setScalar(0),this.geometry.boundingSphere&&e.copy(this.geometry.boundingSphere.center),t.set(r.width,r.height,r.depth??0).multiplyScalar(.5)):e.setScalar(0),t.set(r.width,r.height,r.depth??0).multiplyScalar(.5)}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"&&this.bindMatrixInverse.copy(this.bindMatrix).invert()}bind(e,t){this.skeleton=e,this.isSkinnedMesh=!0,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(e){let t=new Qt,r=this.geometry.attributes.skinWeight;for(let i=0,n=r.count;i<n;i++){t.fromBufferAttribute(r,i);let a=1/t.manhattanLength();a!==1/0?t.multiplyScalar(a):t.set(1,0,0,0),r.setXYZW(i,t.x,t.y,t.z,t.w)}}boneTransform(e,t){let r=this.skeleton;if(r===void 0)return;let i=this.geometry;b4.fromBufferAttribute(i.attributes.skinIndex,e),x4.fromBufferAttribute(i.attributes.skinWeight,e),y4.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let n=0;n<4;n++){let a=x4.getComponent(n);if(a!==0){let o=b4.getComponent(n);w4.multiplyMatrices(r.bones[o].matrixWorld,r.boneInverses[o]),t.addScaledVector(LBe.copy(y4).applyMatrix4(w4),a)}}return t.applyMatrix4(this.bindMatrixInverse)}};function BBe(e){var o,s;if(e.geometry.attributes.extrudeNormal||!e.geometry.attributes.position||!e.geometry.attributes.normal)return;let t=new Map,r=e.geometry.attributes,i=r.position.array,n=r.normal.array,a=new Float32Array(i.length);for(let l=0;l<i.length;l+=3){let c=`${i[l]}_${i[l+1]}_${i[l+2]}`,u=new k(n[l],n[l+1],n[l+2]);t.has(c)?(o=t.get(c))==null||o.normals.push(u):t.set(c,{normals:[u],result:new k})}t.forEach((l,c)=>{for(let u of l.normals)l.result.add(u);l.result.divideScalar(l.normals.length)});for(let l=0;l<i.length;l+=3){let c=`${i[l]}_${i[l+1]}_${i[l+2]}`,u=(s=t.get(c))==null?void 0:s.result;u&&(a[l]=u.x,a[l+1]=u.y,a[l+2]=u.z)}e.geometry.setAttribute("extrudeNormal",new yt(a,3))}function FBe(e){if(e.geometry.attributes.extrudeNormals||!e.geometry.attributes.position)return;let t=e.geometry.attributes.position.array,r=new Float32Array(t.length),i=new k;for(let n=0;n<t.length;n+=3)i.set(t[n],t[n+1],t[n+2]).normalize(),r[n]=i.x,r[n+1]=i.y,r[n+2]=i.z;e.geometry.setAttribute("extrudeNormal",new yt(r,3))}function YD(e){if(Array.isArray(e.material)){for(let t of e.material)if(t.getLayersOfType("outline").length===0)return}else if(!(e.material instanceof Nu)||e.material.getLayersOfType("outline").length===0)return;e instanceof ba&&e.is2DAndNoDepth?FBe(e):BBe(e)}function XD(e){if(!e.geometry.attributes.position)return;let t=e.geometry.attributes.position.array,r=new Float32Array(t.length),i=parseInt(e.uuid.replace(/\D/g,"")),n=[St.seededRandom(i),St.seededRandom(i+1e4),St.seededRandom(i+2e4)];for(let a=0;a<t.length;a++)r[a]=n[a%3];e.geometry.setAttribute("randomColor",new qt(r,3))}var Ls=new Ji,rv=new k;function NBe(e){let t=!1;return e.scene.objects.traverse((r,i)=>{i.type==="Mesh"&&i.geometry.type==="SubdivGeometry"&&(t=!0)}),t}var Yg=class extends ba{constructor(e,t,r){super(e,t,r),this.data=t,this.hiddenMatrixOld=new it,this.smoothShading=!0,this.skipReactionUpdate=!1}chooseGeoemtryCache(e){return this.dataPatched.flatShading?e.geometryCache:e.geometryCache2}get subdivPointerNew(){return this.localGeometry!==void 0?this.subdivPointer:this.geometry.ensureSubdivPointer()}get originalGeometryNew(){return this.localGeometry!==void 0?this.originalGeometry:this.geometry.originalGeometry}get phongAngle(){return this.data.geometry.phongAngle??45}updateEntityBoxSize(e,t){let r=this.geometry.userData.parameters;e.copy(this.originalGeometryNew.boundingSphere.center),t.set(r.width,r.height,r.depth??0).multiplyScalar(.5)}createGeometryByControls(e){var a,o,s;if(this.skipReactionUpdate===!0)return;let t=(a=this.localGeometry)==null?void 0:a.uuid,{originalGeometry:r,subdividedGeometry:i,subdivPointer:n}=Pa.build(e,this.subdivPointer,this.smoothShading,this.hasNonUniformScale?this.shearScale:void 0);this.subdivPointer=n,r!==void 0&&((o=this.originalGeometry)==null||o.dispose(),this.originalGeometry=r),i!==void 0&&((s=this.subdividedGeometry)==null||s.dispose(),this.subdividedGeometry=i??void 0),this.localGeometry=this.subdividedGeometry??this.originalGeometry,YD(this),XD(this),this.calcBoundingBox(),t&&(this.localGeometry.uuid=t)}updateState(e,t){if(super.updateState(e,t),e.flatShading!==void 0){let r=this.material;this.material=Array.isArray(r)?r.map(i=>i.getFlavor(!1,i.side,i.wireframe)):r.getFlavor(!1,r.side,r.wireframe),this.smoothShading=!e.flatShading,this.createGeometryDelayed(t)}}updateMesh(e=!1){Pa.buildLevel(this.subdivPointer,!0,this.smoothShading?this.phongAngle:-1,this.originalGeometry,e&&this.hasNonUniformScale?this.shearScaleInv:void 0),this.subdividedGeometry&&Pa.buildLevel(this.subdivPointer,!1,this.smoothShading?this.phongAngle:-1,this.subdividedGeometry,e&&this.hasNonUniformScale?this.shearScaleInv:void 0)}updateTopology(){this.originalGeometry.dispose(),this.originalGeometry=Pa.buildLevel(this.subdivPointer,!0,this.smoothShading?this.phongAngle:-1),this.subdividedGeometry&&(this.subdividedGeometry.dispose(),this.subdividedGeometry=Pa.buildLevel(this.subdivPointer,!1,this.smoothShading?this.phongAngle:-1)),this.localGeometry=this.subdividedGeometry??this.originalGeometry}raycast(e,t){let r=this.localGeometry;this.localGeometry=this.originalGeometryNew,Fa.prototype.raycast.call(this,e,t),this.localGeometry=r}activateSVDCompensation(){!this.hasNonUniformScale||(this.matrix.copy(this.matrixWorldRigid),this.hiddenMatrixOld.copy(this.hiddenMatrix),this.hiddenMatrix.copy(this.parent.matrixWorld).invert())}deactivateSVDCompensation(){!this.hasNonUniformScale||(this.updateMatrix(),this.hasNonUniformScale=void 0,this.hiddenMatrix.copy(this.hiddenMatrixOld))}calcBoundingBox(){let e=this.originalGeometry;e.boundingSphere===null&&(e.boundingSphere=new ao,this.subdividedGeometry&&(this.subdividedGeometry.boundingSphere=e.boundingSphere));let t=e.attributes.position,r=e.boundingSphere.center;Ls.setFromBufferAttribute(t),Ls.getCenter(r),e.boundingSphere.radius=r.distanceTo(Ls.max),isNaN(e.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this),Ls.getSize(rv),this.hasNonUniformScale&&rv.divide(this.scale);let i={width:rv.x,height:rv.y,depth:rv.z};return this.geometry.userData.parameters=i,i}updateBoundingSphere(e){let t=this.originalGeometry;Ls.min.set(e[0],e[2],e[4]),Ls.max.set(e[1],e[3],e[5]),this.hasNonUniformScale&&(Ls.min.applyMatrix4(this.shearScaleInv),Ls.max.applyMatrix4(this.shearScaleInv)),t.boundingSphere===null&&(t.boundingSphere=new ao);let r=t.boundingSphere.center;Ls.getCenter(r),t.boundingSphere.radius=r.distanceTo(Ls.max)}freeSubdivPointer(){var e,t;this.subdivPointer&&(Pa.freeSubdivPointer(this.subdivPointer),this.subdivPointer=0),this.localGeometry=void 0,(e=this.originalGeometry)==null||e.dispose(),(t=this.subdividedGeometry)==null||t.dispose()}dispose(){super.dispose(),this.freeSubdivPointer()}updateByPatchedOpGeometry(e,t,r){super.updateByPatchedOpGeometry(e,t,r),this.localGeometry&&this.createGeometryByControls(t)}},S4=-1,UBe=1,jBe={x:[1,0,0],"-x":[-1,0,0],y:[0,1,0],"-y":[0,-1,0],z:[0,0,1],"-z":[0,0,-1]},VBe={polygon_center:0,edge:1,vertex:2},cb=(e,t)=>(r,i)=>!t||r===0||e===0?0:e*i/100,sr=(e,t)=>{let r=Math.abs(t),i=r*-1;return(e-S4)*(r-i)/(UBe-S4)+i};function HBe(e){let t=[],r={};for(var i=0,n=e.length;i<n;i++){var a=JSON.stringify(e[i].pos.map(o=>Math.round(o*1e4)/1e4));r[a]||(t.push(e[i]),r[a]=!0)}return t}var WBe=new k,ub=new k,GBe=new k,$Be=new k;function pp(e,t){let r=GBe.fromArray(e),i=$Be.fromArray(t);ub.copy(i).sub(r);let n=ub.length();return ub.normalize().multiplyScalar(n*.5),WBe.copy(r).add(ub).toArray()}var Ro=new ta,db=new k,D1=new k,Ed=new k;function qBe(e){let t=[];for(let r=0;r<=e.index.count;r++)if(db.fromArray(e.index.array,r*3),Ro.setFromAttributeAndIndices(e.attributes.position,db.x,db.y,db.z),Ro.getNormal(D1),Ro.getMidpoint(Ed),!(isNaN(Ed.x)||isNaN(Ed.y)||isNaN(Ed.z))){let{a:i,b:n,c:a}=Ro,o=i.toArray(),s=n.toArray(),l=a.toArray(),c=i.distanceTo(n),u=n.distanceTo(a),d=a.distanceTo(i),h=pp(o,s),f=pp(s,l),p=pp(l,o),v=[c,u,d],m=Math.max(...v),g=v.filter(x=>Math.round(x)===Math.round(m)).length>1,y=[],b=Ro.getMidpoint(Ed).toArray();m===c&&!g&&(y=[f,p,p],b=h),m===u&&!g&&(y=[h,p,p],b=f),m===d&&!g&&(y=[h,f,f],b=p),g&&(y=[h,f,p]),t.push({vertices:[o,s,l],faceCenters:y,midpoint:b,norm:Ro.getNormal(D1).toArray()})}return t}function YBe(e){let t=[],{position:r}=e.attributes;for(let i=0;i<r.count;i++){Ro.setFromAttributeAndIndices(r,i*3,i*3+1,i*3+2),Ro.getNormal(D1),Ro.getMidpoint(Ed);let n=Ro.a.toArray(),a=Ro.b.toArray(),o=Ro.c.toArray();t.push({vertices:[n,a,o],faceCenters:[pp(n,a),pp(a,o),pp(o,n)],midpoint:Ed.toArray(),norm:D1.toArray()})}return t}var XBe=4,KBe=.5,E_=e=>.5*(1-Math.cos(e*Math.PI)),QBe=class{constructor(){this.perlin=new Array(4096)}noise(e,t=0,r=0){if(this.perlin==null){this.perlin=new Array(4096);for(let m=0;m<4096;m++)this.perlin[m]=Math.random()}e<0&&(e=-e),t<0&&(t=-t),r<0&&(r=-r);let i=Math.floor(e),n=Math.floor(t),a=Math.floor(r),o=e-i,s=t-n,l=r-a,c,u,d=0,h=.5,f,p,v;for(let m=0;m<XBe;m++){let g=i+(n<<4)+(a<<8);c=E_(o),u=E_(s),f=this.perlin[g&4095],f+=c*(this.perlin[g+1&4095]-f),p=this.perlin[g+16&4095],p+=c*(this.perlin[g+16+1&4095]-p),f+=u*(p-f),g+=256,p=this.perlin[g&4095],p+=c*(this.perlin[g+1&4095]-p),v=this.perlin[g+16&4095],v+=c*(this.perlin[g+16+1&4095]-v),p+=u*(v-p),f+=E_(l)*(p-f),d+=f*h,h*=KBe,i<<=1,o*=2,n<<=1,s*=2,a<<=1,l*=2,o>=1&&(i++,o--),s>=1&&(n++,s--),l>=1&&(a++,l--)}return d}noiseSeed(e){let t=(()=>{let r,i;return{setSeed(n){i=r=(n??Math.random()*4294967296)>>>0},getSeed(){return r},rand(){return i=(1664525*i+1013904223)%4294967296,i/4294967296}}})();t.setSeed(e),this.perlin=new Array(4096);for(let r=0;r<4096;r++)this.perlin[r]=t.rand()}},ZBe=QBe,C4=new k,_4=new it,A4=new om;function M4(e){let t=!1;return e.scene.objects.traverse((r,i)=>{i.type==="Mesh"&&i.geometry.type==="TextGeometry"&&(t=!0)}),t}var KD=class extends ba{constructor(e,t,r){super(e,t,r),this.data=t}get textGeometry(){return this.geometry}get charWidths(){return this.textGeometry.charWidths}get charCoords(){return this.textGeometry.charCoords}get wrappedText(){return this.textGeometry.wrappedText}get font(){return this.textGeometry.font}get initialOffsetY(){var t;let e=this.dataPatched;return((t=this.font)==null?void 0:t.getLineInitialOffsetY(this.lineHeight,this.wrappedText.length,e.geometry.height,this.fontScale,e.geometry.verticalAlign))??0}get fontScale(){let e=this.dataPatched;return this.font?e.geometry.fontSize/this.font.unitsPerEm:1}get AD(){return Math.abs(this.ascender-this.descender)}get ascender(){var e;return(((e=this.font)==null?void 0:e.ascender)??1)*this.fontScale}get descender(){var e;return(((e=this.font)==null?void 0:e.descender)??1)*this.fontScale}get lineHeight(){let e=this.dataPatched;return e.geometry.fontSize*e.geometry.lineHeight}raycast(e,t){let{matrixWorld:r}=this;if(!(isNaN(e.ray.origin.x)||this.scale.x===0||this.scale.y===0||this.scale.z===0)&&(_4.copy(r).invert(),A4.copy(e.ray).applyMatrix4(_4),A4.intersectBox(this.singleBBox,C4))){let i=C4.applyMatrix4(r),n=e.ray.origin.distanceTo(i);t.push({distance:n,point:i.clone(),object:this})}}},Aa=1e-4,Bs,A9,M9,E9,E4=new k,T4=new k;kW.then(e=>{Bs=e,A9=[Bs.get_face_center,Bs.get_edge_midpoint,Bs.get_vertex_position],M9=[Bs.get_face_normal,Bs.get_edge_normal,Bs.get_vertex_normal],E9=[Bs.face_count,Bs.edge_count,Bs.vertex_count]});var JBe=new it,e4e=new it,Hc=new k,hb=new k,iv=new k,T_=new k,t4e=new k,r4e=new k,Il=new ZBe,ds=class extends DD(Xr){constructor(e,t){super(),this.parameters=t,this.objectForSample=void 0,this._pendingMediaLoad=!1,this.object=e}resetOnMove(){this.removeFromParent(),this.parent=null}expandClones(e){if(this.parent===null)this.updateState(this.parameters,e);else for(let t of this.children)t instanceof ya&&t.expand()}invalidateTransform(e){this.matrixWorldNeedsUpdate=!0,this.traverse(t=>{t instanceof ya&&t.object===e&&(t.matrixWorldNeedsUpdate=!0)})}onObjUpdateMatrix(){this.parameters.type!=="toObject"&&(this.matrixWorldNeedsUpdate=!0)}update(){switch(this._updateCount(),this.parameters.type){case"radial":this._updateRadial(this.parameters);break;case"linear":this._updateLinear(this.parameters);break;case"grid":this._updateGrid(this.parameters);break;case"toObject":this._updateToObject(this.parameters)}for(let e of this.children)e.updateMatrix(),e.hasNonUniformScale&&(e.updateMatrixWorld(),e.updateMatrixWorldSVD())}_updateCount(e){let t;if(e!==void 0?t=e:t=this.parameters.type==="grid"?Math.round(this.parameters.grid.count[0])*Math.round(this.parameters.grid.count[1])*Math.round(this.parameters.grid.count[2]):this.parameters.count,this.parameters.type==="toObject"&&!this.parameters.toObject.object&&(t=0),this.parameters.type==="toObject"&&this.objectForSample){for(let i=0,n=this.children.length;i<n;++i)this.remove(this.children[0]);let r=this.children;if(r.length===t)return;if(r.length<t)for(let i=0,n=t-r.length;i<n;++i){let a=new ya(this.object);a.expand(),this.add(a)}else for(let i=0,n=r.length-t;i<n;++i)this.remove(r[i])}else{if(this.children.length===t)return;if(this.children.length<t)for(let r=0,i=t-this.children.length;r<i;++r){let n=new ya(this.object);n.expand(),this.add(n)}else for(let r=0,i=this.children.length-t;r<i;++r)this.remove(this.children[0])}}_updateRadial(e){let t=e.radial,r=t.start*St.DEG2RAD,i=t.end*St.DEG2RAD,n=r-i,a=new bn(t.rotation[0],t.rotation[1],t.rotation[2]),o;switch(t.axis){case"z":o=new k(0,0,1);break;case"y":o=new k(0,1,0);break;default:case"x":o=new k(1,0,0);break}let s=e.randomnessObject??fu.defaultData([1,1,1]).randomnessObject,l=s.noiseType==="perlin";Il.noiseSeed(s.seed);let c=o_((0,Qm.default)(s.seed)),u=cb(s.strength,this.parameters.randomness);for(let[d,h]of this.children.entries()){let f=d*(s.freqScale/10)+s.movement,p=l?Il.noise(f):c(f,f),v=d+1;h.scale.x=t.scale[0]+u(v,sr(p,s.scale[0]))||Aa,h.scale.y=t.scale[1]+u(v,sr(p,s.scale[1]))||Aa,h.scale.z=t.scale[2]+u(v,sr(p,s.scale[2]))||Aa,h.position.setScalar(0);let m=n/e.count*d-r;switch(t.axis){case"x":h.rotation.set(0,m,0);break;case"y":h.rotation.set(0,0,m);break;case"z":h.rotation.set(m,0,0);break}h.translateOnAxis(o,t.radius),h.position.x+=t.position[0]+u(v,sr(p,s.position[0])),h.position.y+=t.position[1]+u(v,sr(p,s.position[1])),h.position.z+=t.position[2]+u(v,sr(p,s.position[2]));let g=u(v,sr(p,s.rotation[0])),y=u(v,sr(p,s.rotation[1])),b=u(v,sr(p,s.rotation[2]));t.alignment===!0?(h.rotation.x+=a.x+g,h.rotation.y+=a.y+y,h.rotation.z+=a.z+b):h.rotation.set(a.x+g,a.y+y,a.z+b)}}_updateLinear(e){if(e.type!=="linear")throw new Error;let t=e.linear,r=new bn(t.rotation[0],t.rotation[1],t.rotation[2]),i=e.randomnessObject??fu.defaultData([1,1,1]).randomnessObject,n=i.noiseType==="perlin";Il.noiseSeed(i.seed);let a=o_((0,Qm.default)(i.seed)),o=cb(i.strength,this.parameters.randomness);for(let[s,l]of this.children.entries()){let c=s*(i.freqScale/10)+i.movement,u=n?Il.noise(c):a(c,c),d=s+1,h=o(d,sr(u,i.rotation[0])),f=o(d,sr(u,i.rotation[1])),p=o(d,sr(u,i.rotation[2]));l.scale.x=1+(t.scale[0]-1)*s+o(d,sr(u,i.scale[0]))||Aa,l.scale.y=1+(t.scale[1]-1)*s+o(d,sr(u,i.scale[1]))||Aa,l.scale.z=1+(t.scale[2]-1)*s+o(d,sr(u,i.scale[2]))||Aa,l.rotation.x=r.x*s+h,l.rotation.y=r.y*s+f,l.rotation.z=r.z*s+p,l.position.x=t.position[0]*s+o(d,sr(u,i.position[0])),l.position.y=t.position[1]*s+o(d,sr(u,i.position[1])),l.position.z=t.position[2]*s+o(d,sr(u,i.position[2]))}}_updateGrid(e){let t=0,r=e.grid,i=e.randomnessObject??fu.defaultData([1,1,1]).randomnessObject,n=cb(i.strength,this.parameters.randomness),a=i.noiseType==="perlin";Il.noiseSeed(i.seed);let o=YIe((0,Qm.default)(i.seed));if(r.useCenter===!0){let s={x:r.count[0]%2===0?2:1,y:r.count[1]%2===0?2:1,z:r.count[2]%2===0?2:1},l=new k(r.size[0]*(r.count[0]-s.x)*.5,r.size[1]*(r.count[1]-s.y)*.5,r.size[2]*(r.count[2]-s.z)*.5);for(let c=0;c<r.count[0];c++)for(let u=0;u<r.count[1];u++)for(let d=0;d<r.count[2];d++){let h=[(c+1)*(i.freqScale/10)+i.movement,(u+1)*(i.freqScale/10)+i.movement,(d+1)*(i.freqScale/10)+i.movement],f=a?Il.noise(...h):o(...h),p=this.children[t++];p.scale.x=1+n(t,sr(f,i.scale[0]))||Aa,p.scale.y=1+n(t,sr(f,i.scale[1]))||Aa,p.scale.z=1+n(t,sr(f,i.scale[2]))||Aa;let v=n(t,sr(f,i.rotation[0])),m=n(t,sr(f,i.rotation[1])),g=n(t,sr(f,i.rotation[2]));p.rotation.set(v,m,g),p.position.x=r.size[0]*c-l.x+n(t,sr(f,i.position[0])),p.position.y=r.size[1]*u-l.y+n(t,sr(f,i.position[1])),p.position.z=r.size[2]*d-l.z+n(t,sr(f,i.position[2]))}}else for(let s=0;s<r.count[0];s++)for(let l=0;l<r.count[1];l++)for(let c=0;c<r.count[2];c++){let u=[(s+1)*(i.freqScale/10)+i.movement,(l+1)*(i.freqScale/10)+i.movement,(c+1)*(i.freqScale/10)+i.movement],d=a?Il.noise(...u):o(...u),h=this.children[t++];h.scale.x=1+n(t,sr(d,i.scale[0]))||Aa,h.scale.y=1+n(t,sr(d,i.scale[1]))||Aa,h.scale.z=1+n(t,sr(d,i.scale[2]))||Aa;let f=n(t,sr(d,i.rotation[0])),p=n(t,sr(d,i.rotation[1])),v=n(t,sr(d,i.rotation[2]));h.rotation.set(f,p,v),h.position.x=r.size[0]*s+n(t,sr(d,i.position[0])),h.position.y=-r.size[1]*l+n(t,sr(d,i.position[1])),h.position.z=-r.size[2]*c+n(t,sr(d,i.position[2]))}}_updateToObject(e){var v;if(e.type!=="toObject")throw new Error;let{toObject:t}=e,r=new bn(t.rotation[0],t.rotation[1],t.rotation[2]),i=e.randomnessObject??fu.defaultData([1,1,1]).randomnessObject,n=i.noiseType==="perlin";Il.noiseSeed(i.seed);let a=o_((0,Qm.default)(i.seed)),o=cb(i.strength,this.parameters.randomness);if(!t.object){for(let[,m]of this.children.entries())m.position.set(0,0,0),m.scale.setScalar(1),m.rotation.set(0,0,0);this.objectForSample=void 0;return}if(!this.objectForSample)return;if(this.objectForSample instanceof KD)if(!((v=this.objectForSample.font)!=null&&v.isLoaded)||this.objectForSample.geometry.attributes.position===void 0){this._pendingMediaLoad=!0;return}else this._pendingMediaLoad=!1;if(this.objectForSample.geometry===void 0&&this.objectForSample.isAncestorOf(this.object.uuid)){console.warn(`Oh no! The object "${this.object.name}" (${this.object.uuid}) seem to be a child/descendant of the object it's being cloned to. Please re-parent it so that they are siblings instead.`);return}let s=this.getSubdivData(),l=[],c=m=>{let g=m.length,y=m.map(S=>S[0]).reduce((S,w)=>S+w,0),b=m.map(S=>S[1]).reduce((S,w)=>S+w,0),x=m.map(S=>S[2]).reduce((S,w)=>S+w,0);return[y/g,b/g,x/g]},u=m=>Math.round(m*1e6)/1e6;s.forEach(m=>{let g=s.filter(y=>u(m.pos[0])===u(y.pos[0])&&u(m.pos[1])===u(y.pos[1])&&u(m.pos[2])===u(y.pos[2]));g.length>1?l.push({pos:m.pos,norm:c(g.map(y=>y.norm))}):l.push(m)});let d=HBe(l);if(d.length>0){let m=Math.round(d.length*t.count/100);this._updateCount(m)}else{let m=this.objectForSample.geometry.getAttribute("position");if(!m||isNaN(m.count)||m.count===0){console.warn(`Oh no! The object "${this.object.name}" (${this.object.uuid}) cannot be cloned on the surface of "${this.objectForSample.name}" (${this.objectForSample.uuid}) because the latter does not have a valid geometry.`);return}}this.objectForSample.updateMatrixWorld();let h=new XIe(this.objectForSample).build(),f=jBe[t.axis],p=this.children;h.setRandomGenerator((0,Qm.default)(this.object.uuid+t.seed));for(let[m,g]of p.entries()){let y=m*(i.freqScale/10)+i.movement,b=n?Il.noise(y):a(y,y),x=m+1,S=o(x,sr(b,i.rotation[0])),w=o(x,sr(b,i.rotation[1])),_=o(x,sr(b,i.rotation[2]));t.spreadType==="random"?h.sample(iv,T_):(d.length&&(iv.fromArray(d[m].pos),T_.fromArray(d[m].norm)),this.objectForSample instanceof Yg&&iv.applyMatrix4(JBe.copy(this.objectForSample.matrixWorld).invert())),iv.applyMatrix4(this.object.hiddenMatrix.clone().invert()),g.position.copy(iv),Hc.fromArray(f);let C=t.align==="normal"?T_:this.object.getWorldDirection(r4e),A=hb.fromArray(t.position);hb.x+=o(x,sr(b,i.position[0])),hb.y+=o(x,sr(b,i.position[1])),hb.z+=o(x,sr(b,i.position[2]));let M=Math.acos(C.dot(Hc)),P=t4e.crossVectors(Hc,C).normalize(),T=e4e.makeRotationAxis(P,M),R=C.clone().cross(this.object.up).normalize(),z=R.clone().cross(C).normalize(),F=new it().makeBasis(R,C,z),H=new k(Hc.y,Hc.z,Hc.x).normalize(),N=H.clone().cross(Hc).normalize(),U=new it().makeBasis(H,Hc,N).invert(),ie=new it().multiplyMatrices(F,U);g.rotation.setFromRotationMatrix(ie),A.applyMatrix4(T),g.position.add(A),g.rotation.x=g.rotation.x+r.x+S,g.rotation.y=g.rotation.y+r.y+w,g.rotation.z=g.rotation.z+r.z+_,g.scale.setScalar(1),g.scale.x=g.scale.x+t.scale[0]+o(x,sr(b,i.scale[0]))||Aa,g.scale.y=g.scale.y+t.scale[1]+o(x,sr(b,i.scale[1]))||Aa,g.scale.z=g.scale.z+t.scale[2]+o(x,sr(b,i.scale[2]))||Aa,g.scale.multiply(this.object.scale),g.hiddenMatrix=this.object.hiddenMatrix}}getSubdivData(){if(!this.objectForSample)return[];let e=this.parameters.toObject.spreadType;if(e==="random")return[];if(this.objectForSample instanceof Yg){let t=this.objectForSample,r=VBe[e],i=E9[r],n=A9[r],a=M9[r],o=[],s=i(t.subdivPointerNew);for(let l=0;l<=s-1;l++){let c=n(t.subdivPointerNew,l),u=a(t.subdivPointerNew,l);E4.fromArray(c).applyMatrix4(t.matrixWorld),T4.fromArray(u),o.push({pos:E4.toArray(),norm:T4.toArray()})}return o}else return(this.objectForSample.geometry.index?qBe(this.objectForSample.geometry):YBe(this.objectForSample.geometry)).map((t,r)=>e==="polygon_center"?{pos:t.midpoint,norm:t.norm}:e==="vertex"?[{pos:t.vertices[0],norm:t.norm},{pos:t.vertices[1],norm:t.norm},{pos:t.vertices[2],norm:t.norm}]:e==="edge"?[{pos:t.faceCenters[0],norm:t.norm},{pos:t.faceCenters[1],norm:t.norm},{pos:t.faceCenters[2],norm:t.norm}]:[]).flat()}updateState(e,t){var r;if(this.parameters=Fw(e),this.parameters.type!=="toObject")(this.parent===null||this.parent!==this.object)&&(this.removeFromParent(),(r=this.object.parent)==null||r.add(this),this.matrix=this.object.matrix,this.hiddenMatrix=this.object.hiddenMatrix,this.matrixWorldNeedsUpdate=!0,this.matrixAutoUpdate=!1);else if(this.parent===null||this.parent.uuid!==this.parameters.toObject.object){this.removeFromParent();let i=t.find(this.parameters.toObject.object);i instanceof Fa?this.objectForSample=i:this.objectForSample=void 0,this.matrix=new it,this.hiddenMatrix=new it,this.matrixWorldNeedsUpdate=!0,this.matrixAutoUpdate=!1,i&&i.add(this)}this.update()}get pendingMediaLoad(){return this._pendingMediaLoad}},A0=e=>{var t;return t=class extends e{},t.geometryHelper=new ws(30,30,30),t},fb=new om,P_=new ao,P4=new it,M0=(e,t,r,i,n=!1,a=e)=>{let o=t,s=a.matrixWorld;if(o.boundingSphere===null&&o.computeBoundingSphere(),P_.copy(o.boundingSphere),P_.applyMatrix4(s),r.ray.intersectsSphere(P_)===!1||(P4.copy(s).invert(),fb.copy(r.ray).applyMatrix4(P4),o.boundingBox!==null&&fb.intersectsBox(o.boundingBox)===!1))return;let l,c,u,d,h=o.index,f=o.attributes.position,p=o.drawRange,v,m;if(n===!1){let y=Math.max(0,p.start),b=Math.min(h.count,p.start+p.count);for(v=y,m=b;v<m;v+=3)if(c=h.getX(v),u=h.getX(v+1),d=h.getX(v+2),l=g(e,r,fb,f,c,u,d),l){l.faceIndex=Math.floor(v/3),i.push(l);return}}else{let y=o.attributes.position,b=new k,x=new k,S=new k,w=new k,_=2,C=1/((a.scale.x+a.scale.y+a.scale.z)/3),A=C*C,M=Math.max(0,p.start),P=Math.min(y.count,p.start+p.count);for(let T=M,R=P-1;T<R;T+=_){if(b.fromBufferAttribute(y,T),x.fromBufferAttribute(y,T+1),fb.distanceSqToSegment(b,x,w,S)>A)continue;w.applyMatrix4(a.matrixWorld);let z=r.ray.origin.distanceTo(w);z<r.near||z>r.far||i.push({distance:z,point:S.clone().applyMatrix4(a.matrixWorld),object:e})}}function g(y,b,x,S,w,_,C){let A=new k,M=new k,P=new k,T=new k,R=new k;if(A.fromBufferAttribute(S,w),M.fromBufferAttribute(S,_),P.fromBufferAttribute(S,C),x.intersectTriangle(A,M,P,!1,T)===null)return null;R.copy(T),R.applyMatrix4(y.matrixWorld);let z=b.ray.origin.distanceTo(R);return z<b.near||z>b.far?null:{faceIndex:1,distance:z,point:R.clone(),object:y}}},pb=new k,_o=new Rh,i4e=class extends v0{constructor(e){let t=new Ot,r=new Zu({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],n=[],a={},o=new Bt(15711266),s=new Bt(15711266),l=new Bt(2857471);c("n1","n2",o),c("n2","n4",o),c("n4","n3",o),c("n3","n1",o),c("f1","f2",o),c("f2","f4",o),c("f4","f3",o),c("f3","f1",o),c("n1","f1",o),c("n2","f2",o),c("n3","f3",o),c("n4","f4",o),c("p","n1",s),c("p","n2",s),c("p","n3",s),c("p","n4",s),c("u1","u2",l),c("u2","u3",l),c("u3","u1",l);function c(d,h,f){u(d,f),u(h,f)}function u(d,h){i.push(0,0,0),n.push(h.r,h.g,h.b),a[d]===void 0&&(a[d]=[]),a[d].push(i.length/3-1)}t.setAttribute("position",new yt(i,3)),t.setAttribute("color",new yt(n,3)),super(t,r),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update()}update(){let e=this.geometry,t=this.pointMap;_o.projectionMatrixInverse.elements=[.5112609807824982,-0,-0,-0,-0,.41421356237309503,-0,-0,-0,-0,-0,-.099999,-0,-0,-1.0000000000000002,.100001];let r=1,i=1,n=.8;Jo("n1",t,e,_o,-r,-i,n),Jo("n2",t,e,_o,r,-i,n),Jo("n3",t,e,_o,-r,i,n),Jo("n4",t,e,_o,r,i,n);let a=n;Jo("f1",t,e,_o,-r,-i,a),Jo("f2",t,e,_o,r,-i,a),Jo("f3",t,e,_o,-r,i,a),Jo("f4",t,e,_o,r,i,a);let o=a,s=.5;Jo("u1",t,e,_o,r*.7*s,i*1.1,o),Jo("u2",t,e,_o,-r*.7*s,i*1.1,o),Jo("u3",t,e,_o,0,i*(1.1+.9*s),o),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}};function Jo(e,t,r,i,n,a,o){pb.set(n,a,o).unproject(i);let s=t[e];if(s!==void 0){let l=r.getAttribute("position");for(let c=0,u=s.length;c<u;c++)l.setXYZ(s[c],pb.x,pb.y,pb.z)}}var n4e=class extends A0(i4e){constructor(e){super(e),this.object=e,this.object=e,this.name=`CombinedCameraHelper: ${e.uuid}`}updateMatrixWorld(e){super.updateMatrixWorld(e),this.updateTarget()}updateTarget(){let e=this.object.getTarget();this.updateWorldMatrix(!0,!1),this.worldToLocal(e)}raycast(e,t){M0(this.object,this.geometry,e,t,!0)}},FE;(e=>e.is=t=>"objectHelper"in t)(FE||(FE={}));var wm=(e,t)=>class extends OD(e){constructor(){super(...arguments),this.objectHelper=new t(this),this.gizmos={}}get geometryHelper(){return t.geometryHelper}raycast(r,i){this.objectHelper.raycast(r,i)}showGizmos(){for(let r in this.gizmos){let i=this.gizmos[r];i instanceof Kx&&(i.visible=!0)}}updateEntityBoxSize(r,i){this.objectHelper.visible&&this.geometryHelper instanceof ws?(r.setScalar(0),i.set(this.geometryHelper.parameters.width,this.geometryHelper.parameters.height,this.geometryHelper.parameters.height).multiplyScalar(.5)):super.updateEntityBoxSize(r,i)}hideGizmos(){for(let r in this.gizmos){let i=this.gizmos[r];i instanceof Kx&&(i.visible=!1)}}},mb=790,wf=new k,D_=new k,O_=new Kt,R_=new k,nv=new k,I_=new k,xa=class extends wm(Rh,n4e){constructor(e="",t={...Ng.defaultData,name:""}){super(),this._cameraType="OrthographicCamera",this.targetOffset=jp.DefaultTargetOffset,this.isUpVectorFlipped=!1,this.angleOffsetFromUp=0,this.wasMovedByUser=!1,this.wasMovedBySwitchCameraAction=!1,this.super_Entity(e,t),this.previousProjectionMatrix=new it,this.matrixAutoUpdate=!0,this.width=window.innerWidth,this.height=window.innerHeight;let r=this.width,i=this.height;this.orthoCamera=new Tw(r*-.5,r*.5,i*.5,i*-.5,-5e4,1e4),this.perspCamera=new pa(45,r/i,50,1e4),this.left=this.orthoCamera.left,this.right=this.orthoCamera.right,this.top=this.orthoCamera.top,this.bottom=this.orthoCamera.bottom,this.far=this.orthoCamera.far,this.view=this.orthoCamera.view,this.aspect=this.perspCamera.aspect,this.focus=this.perspCamera.focus,this.filmGauge=this.perspCamera.filmGauge,this.filmOffset=this.perspCamera.filmOffset,this.objectHelper.update()}get isPerspectiveCamera(){return this.cameraType==="PerspectiveCamera"}get isOrthographicCamera(){return!this.isPerspectiveCamera}get cameraType(){return this._cameraType}set fov(e){this.perspCamera.fov=e}get fov(){return this.perspCamera.fov}setNear(e,t){e==="PerspectiveCamera"?this.perspCamera.near=t:this.orthoCamera.near=t}setZoom(e,t){t>=0&&(e==="PerspectiveCamera"?this.perspCamera.zoom=t:this.orthoCamera.zoom=t)}set cameraType(e){e==="PerspectiveCamera"?this.toPerspective():e==="OrthographicCamera"&&this.toOrthographic()}get near(){return this._cameraType==="PerspectiveCamera"?this.perspCamera.near:this.orthoCamera.near}set near(e){this._cameraType==="PerspectiveCamera"?this.perspCamera.near=e:this.orthoCamera.near=e}get zoom(){return this._cameraType==="PerspectiveCamera"?this.perspCamera.zoom:this.orthoCamera.zoom}set zoom(e){e>=0&&(this._cameraType==="PerspectiveCamera"?this.perspCamera.zoom=e:this.orthoCamera.zoom=e)}lookAt(e,t,r){typeof e=="number"&&(e=new k(e,t,r)),super.lookAt(e),this.getWorldPosition(wf),this.targetOffset=wf.distanceTo(e)}getTarget(e=new k){return this.getWorldDirection(D_),this.getWorldPosition(wf),D_.multiplyScalar(this.targetOffset),e.copy(wf).add(D_),e}getDistanceToTarget(){let e=this.getTarget();return this.getWorldPosition(wf),wf.distanceTo(e)}updateUp(){this.getWorldQuaternion(O_),R_.set(0,0,1).applyQuaternion(O_),nv.copy(Xr.DEFAULT_UP),this.isUpVectorFlipped&&nv.negate(),nv.applyQuaternion(O_),I_.copy(Xr.DEFAULT_UP).projectOnPlane(R_),this.angleOffsetFromUp=I_.angleTo(nv),this.angleOffsetFromUp*=I_.cross(nv).dot(R_)>=0?1:-1}updateTransformState(e,t){let r=super.updateTransformState(e,t);return e.isUpVectorFlipped!==void 0&&(this.isUpVectorFlipped=e.isUpVectorFlipped),this.updateUp(),r}getViewFrontToObject(e){let t=e.getWorldPosition(new k),r=e.getWorldDirection(new k).multiplyScalar(this.targetOffset);return{position:t.clone().add(r),target:t}}getViewToTarget(e){let t=this.getWorldDirection(new k).multiplyScalar(this.targetOffset);return{position:e.clone().sub(t),target:e}}getViewToObject(e){let t=new k;return e.getWorldPosition(t),this.getViewToTarget(t)}setViewplaneSize(e,t,r=!1){if(this.aspect=e/t,r){let i=e>t?this.aspect:1,n=e>t?1:this.aspect;this.left=-mb*.5*i,this.right=mb*.5*i,this.top=mb*.5*(1/n),this.bottom=-mb*.5*(1/n)}else this.left=-e*.5,this.right=e*.5,this.top=t*.5,this.bottom=-t*.5;this.updateProjectionMatrix()}copyViewPlaneSize(e){this.aspect=e.aspect,this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.updateProjectionMatrix()}toOrthographic(){this.orthoCamera.left=this.left,this.orthoCamera.right=this.right,this.orthoCamera.top=this.top,this.orthoCamera.bottom=this.bottom,this.orthoCamera.view=this.view,this.orthoCamera.far=this.far,this.orthoCamera.updateProjectionMatrix(),this.projectionMatrix=this.orthoCamera.projectionMatrix,this.projectionMatrixInverse=this.orthoCamera.projectionMatrixInverse,this._cameraType="OrthographicCamera",this.objectHelper&&this.objectHelper.update()}toPerspective(){this.perspCamera.aspect=this.aspect,this.perspCamera.fov=this.fov,this.perspCamera.view=this.view,this.perspCamera.far=this.far,this.perspCamera.updateProjectionMatrix(),this.projectionMatrix=this.perspCamera.projectionMatrix,this.projectionMatrixInverse=this.perspCamera.projectionMatrixInverse,this._cameraType="PerspectiveCamera",this.objectHelper&&this.objectHelper.update()}setFocalLength(e){this.perspCamera.setFocalLength(e),this.toPerspective()}getFocalLength(){return this.perspCamera.getFocalLength()}getEffectiveFOV(){return this.perspCamera.getEffectiveFOV()}getFilmWidth(){return this.perspCamera.getFilmWidth()}getFilmHeight(){return this.perspCamera.getFilmHeight()}setViewOffset(e,t,r,i,n,a){this._cameraType==="PerspectiveCamera"?this.perspCamera.setViewOffset(e,t,r,i,n,a):this.orthoCamera.setViewOffset(e,t,r,i,n,a)}clearViewOffset(){this._cameraType==="PerspectiveCamera"?(this.perspCamera.clearViewOffset(),this.toPerspective()):(this.orthoCamera.clearViewOffset(),this.toOrthographic())}copyHistory(){this.previousProjectionMatrix&&this.previousProjectionMatrix.copy(this.projectionMatrix)}updateProjectionMatrix(){this._cameraType==="PerspectiveCamera"?this.toPerspective():this._cameraType==="OrthographicCamera"&&this.toOrthographic()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}copy(e,t){return super.copy(e,t),this.parent=e.parent,this.orthoCamera.copy(e.orthoCamera),this.perspCamera.copy(e.perspCamera),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.far=e.far,this.view=e.view===null?null:Object.assign({},e.view),this._cameraType=e._cameraType,this.aspect=e.aspect,this.fov=e.fov,this.focus=e.focus,this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this.targetOffset=e.targetOffset,this.updateProjectionMatrix(),this}toCameraState(e=[]){let t={type:this.cameraType,far:this.far,orthographic:{near:this.orthoCamera.near,zoom:this.orthoCamera.zoom},perspective:{near:this.perspCamera.near,fov:this.perspCamera.fov,zoom:this.perspCamera.zoom},up:this.up.toArray(),targetOffset:this.targetOffset,isUpVectorFlipped:this.isUpVectorFlipped};return OM(t,e)}updateCameraSubtype(e,t){let r=e==="perspective"?"PerspectiveCamera":"OrthographicCamera";t.zoom!==void 0&&this.setZoom(r,t.zoom),t.near!==void 0&&this.setNear(r,t.near),t.fov!==void 0&&r==="PerspectiveCamera"&&(this.fov=t.fov)}updateState(e,t){this.updateCameraState(e,t)}updateCameraState(e,t){this.updateState_Entity(e,t),e.far!==void 0&&(this.far=e.far),e.orthographic!==void 0&&this.updateCameraSubtype("orthographic",e.orthographic),e.perspective!==void 0&&this.updateCameraSubtype("perspective",e.perspective),e.type!==void 0&&(this.cameraType=e.type),e.up!==void 0&&this.up.fromArray(e.up),e.targetOffset!==void 0&&(this.targetOffset=e.targetOffset),e.isUpVectorFlipped!==void 0&&(this.isUpVectorFlipped=e.isUpVectorFlipped),this.updateProjectionMatrix()}updateByPatchedOp(e,t,r){super.updateByPatchedOp(e,t,r),e.path.length===1&&e.type===0&&this.updateCameraSubtype(e.path[0],e.props)}toState(e){return{...super.toState(e),...this.toCameraState(e),type:this.cameraType}}},Sf=new it,a4e=new it;function D4(e){let t=!1;return e.scene.objects.traverse((r,i)=>{var n;((n=i.geometry)==null?void 0:n.type)==="BooleanGeometry"&&(t=!0)}),t}var bh=class extends xm{constructor(e,t,r){super(e,t),this.data=t,this.meshSetAddresses=[],this.needsTransformForDownstream=!1,this.geometry=new Ot,this.onAfterRender=(i,n,a,o,s,l)=>{super.onAfterRender(i,n,a,o,s,l),this.recomputeBoolean()},this.geometry.userData.parameters={width:0,height:0,depth:0}}get booleanOp(){return this.data.geometry.operation}get phongAngle(){return this.data.geometry.phongAngle??45}get isLOD(){return this.recomputeBoolean(),!1}updateByPatchedOp(e,t,r){super.updateByPatchedOp(e,t,r),e.path.length===1&&e.path[0]==="geometry"&&e.type===0&&e.props.operation!==void 0&&(this.freeBooleanPointer(),this.resetBBoxNeedsUpdate())}freeBooleanPointer(){super.freeBooleanPointer(),this.geometry.dispose()}recomputeBoolean(e,t=!0){var i;if(this.booleanMeshSetAddress!==-1&&!e)return;for(let n=0;n<this.children.length;n++){let a=this.children[n];a instanceof bh&&a.dataPatched.visible===!0&&a.recomputeBoolean(e===!0,t)}this.meshSetAddresses=[];for(let n=0;n<this.children.length;n++){let a=this.children[n];if(a instanceof Fa&&a.dataPatched.visible===!0&&((i=a.geometry.attributes.position)==null?void 0:i.count)>0&&a.geometry.drawRange.count>0&&a.booleanMeshSetAddress!==0){Sf.multiplyMatrices(a.hiddenMatrix,a.matrix);try{if(a.booleanMeshSetAddress===-1){if((a.geometry.index??a.geometry.getAttribute("position")).count/3<15e5&&(a.booleanMeshSetAddress=Wl.getMeshSet(a.geometry,e===!0,t)),a.booleanMeshSetAddress===-1)return;Wl.transformMeshSet(a.booleanMeshSetAddress,Sf),a.booleanMatrixInvOld.copy(Sf).invert(),a.booleanWasTransformed=!1}else a instanceof bh&&a.needsTransformForDownstream===!0?(Wl.transformMeshSet(a.booleanMeshSetAddress,Sf),a.needsTransformForDownstream=!1):a.booleanWasTransformed===!0&&(Wl.transformMeshSet(a.booleanMeshSetAddress,a4e.multiplyMatrices(Sf,a.booleanMatrixInvOld)),a.booleanMatrixInvOld.copy(Sf).invert(),a.booleanWasTransformed=!1)}catch(o){console.error(o),a.booleanMeshSetAddress=0,a.geometry.userData.booleanOperationDidFail=!0;continue}Wl.hasOpenEdges(a.booleanMeshSetAddress)===!1||n===this.children.length-1&&this.booleanOp===2?(this.meshSetAddresses.push(a.booleanMeshSetAddress),a.geometry.userData.booleanOperationDidFail=!1):a.geometry.userData.booleanOperationDidFail="openEdges"}}if(this.meshSetAddresses.length===0){this.geometry.setAttribute("position",new yt([],0)),this.geometry.setDrawRange(0,0);return}if(e===!0)return Wl.calcBooleanTopological(this.meshSetAddresses,this.booleanOp);let r=this.geometry;r.dispose(),this.geometry=new Ot,this.geometry.userData=r.userData,this.geometry.boundingSphere=r.boundingSphere;try{this.booleanMeshSetAddress=Wl.calcBoolean(this.meshSetAddresses,this.booleanOp,this.geometry,this.phongAngle)}catch(n){this.booleanMeshSetAddress=0,this.geometry.userData.booleanOperationDidFail=!0,console.error(n)}this.booleanMatrixInvOld.copy(this.matrix).invert(),this.needsTransformForDownstream=!0,YD(this),XD(this)}dispose(){super.dispose(),this.geometry.dispose()}},NE;(e=>{function t(r){return _r.is(r)&&r instanceof b0}e.is=t})(NE||(NE={}));var QD=(e,t)=>class extends wm(e,t){updateState_Light(r,i){this.updateState_Entity(r,i),r.color!==void 0&&(this.color=i.shared.color(r.color)),r.intensity!==void 0&&(this.intensity=r.intensity),r.depth!==void 0&&(this.shadow.camera.far=r.depth,this.shadow.needsUpdate=!0),r.shadows!==void 0&&(this.castShadow=r.shadows)}},os=e=>e instanceof Fa,ic=e=>e!==null&&e instanceof bh,o4e=e=>e instanceof xa,s4e=e=>NE.is(e),UE=e=>FE.is(e),l4e=new k(1,1,1),O4=new k,c4e=new k,R4=new Kt,E0=class extends A0(p2e){constructor(e,t=15){super(t),this.object=e,this.dummy=new tc,this.object.updateMatrixWorld(),this.name=`EmptyObjectHelper: ${e.uuid}`,this.matrix=this.dummy.matrixWorld,this.matrixAutoUpdate=!1,this.object.isBone&&(this.visible=!1)}raycast(e,t){M0(this.object,E0.geometryHelper,e,t,!1,this.dummy)}update(){}updateMatrix(){}updateMatrixWorld(e){this.object.matrixWorld.decompose(O4,R4,c4e),this.matrix.compose(O4,R4,l4e),super.updateMatrixWorld(e)}updateWorldMatrix(e,t){}},mp=class extends wm(tc,E0){constructor(e,t){super(),this.super_Entity(e,t),this.objectHelper.update()}updateState(e,t){this.updateState_Entity(e,t),"buffer"in e&&Object.keys(e).length===1&&t.scene.reloadSplats()}},Yb=class extends wm(tc,E0){constructor(e,t,r){super(),this.super_Entity(e,t),this.context=r,this.objectHelper.update()}updateState(e,t){this.updateState_Entity(e,t)}},T9={RED:0,GREEN:1,BLUE:2,ALPHA:3},T0="varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}",u4e=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform lowp sampler2D cocBuffer;uniform vec2 texelSize;uniform float scale;uniform vec4 kernel64[32];varying vec2 vUv;void main(){
#ifdef FOREGROUND
vec2 CoCNearFar=texture2D(cocBuffer,vUv).rg;float CoC=CoCNearFar.r*scale;
#else
float CoC=texture2D(cocBuffer,vUv).g*scale;
#endif
if(CoC==0.0){gl_FragColor=texture2D(inputBuffer,vUv);}else{
#ifdef FOREGROUND
vec2 step=texelSize*max(CoC,CoCNearFar.g*scale);
#else
vec2 step=texelSize*CoC;
#endif
vec4 acc=vec4(0.0);for(int i=0;i<32;++i){vec4 kernel=kernel64[i];vec2 uv=step*kernel.xy+vUv;acc+=texture2D(inputBuffer,uv);uv=step*kernel.zw+vUv;acc+=texture2D(inputBuffer,uv);}gl_FragColor=acc/64.0;}}`,vb=class extends Vr{constructor(e=!1,t=!1){super({name:"BokehMaterial",defines:{PASS:e?"2":"1"},uniforms:{kernel64:new rt(null),kernel16:new rt(null),inputBuffer:new rt(null),cocBuffer:new rt(null),texelSize:new rt(new ye),scale:new rt(1)},blending:un,depthWrite:!1,depthTest:!1,fragmentShader:u4e,vertexShader:T0}),this.toneMapped=!1,t&&(this.defines.FOREGROUND="1"),this.generateKernel()}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}set cocBuffer(e){this.uniforms.cocBuffer.value=e}setCoCBuffer(e){this.uniforms.cocBuffer.value=e}get scale(){return this.uniforms.scale.value}set scale(e){this.uniforms.scale.value=e}getScale(e){return this.uniforms.scale.value=e}setScale(e){this.uniforms.scale.value=e}generateKernel(){let e=2.39996323,t=new Float32Array(128),r=new Float32Array(32),i=0,n=0;for(let s=0;s<80;++s){let l=s*e,c=Math.sqrt(s)/Math.sqrt(80),u=c*Math.cos(l),d=c*Math.sin(l);s%5===0?(r[n++]=u,r[n++]=d):(t[i++]=u,t[i++]=d)}let a=[],o=[];for(let s=0;s<128;)a.push(new Qt(t[s++],t[s++],t[s++],t[s++]));for(let s=0;s<32;)o.push(new Qt(r[s++],r[s++],r[s++],r[s++]));this.uniforms.kernel64.value=a,this.uniforms.kernel16.value=o}setTexelSize(e,t){this.uniforms.texelSize.value.set(e,t)}setSize(e,t){this.uniforms.texelSize.value.set(1/e,1/t)}};function I4(e,t,r){return e*(t-r)-t}function jE(e,t,r){return Math.min(Math.max((e+t)/(t-r),0),1)}var d4e=`#include <common>
#include <packing>
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform float focusDistance;uniform float focusRange;uniform float cameraNear;uniform float cameraFar;varying vec2 vUv;float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}void main(){float depth=readDepth(vUv);
#ifdef PERSPECTIVE_CAMERA
float viewZ=perspectiveDepthToViewZ(depth,cameraNear,cameraFar);float linearDepth=viewZToOrthographicDepth(viewZ,cameraNear,cameraFar);
#else
float linearDepth=depth;
#endif
float signedDistance=linearDepth-focusDistance;float magnitude=smoothstep(0.0,focusRange,abs(signedDistance));gl_FragColor.rg=magnitude*vec2(step(signedDistance,0.0),step(0.0,signedDistance));}`,h4e=class extends Vr{constructor(e){super({name:"CircleOfConfusionMaterial",defines:{DEPTH_PACKING:"0"},uniforms:{depthBuffer:new rt(null),focusDistance:new rt(0),focusRange:new rt(0),cameraNear:new rt(.3),cameraFar:new rt(1e3)},blending:un,depthWrite:!1,depthTest:!1,fragmentShader:d4e,vertexShader:T0}),this.toneMapped=!1,this.uniforms.focalLength=this.uniforms.focusRange,this.adoptCameraSettings(e)}get near(){return this.uniforms.cameraNear.value}get far(){return this.uniforms.cameraFar.value}set depthBuffer(e){this.uniforms.depthBuffer.value=e}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e,t=Mc){this.depthBuffer=e,this.depthPacking=t}get focusDistance(){return this.uniforms.focusDistance.value}set focusDistance(e){this.uniforms.focusDistance.value=e}get worldFocusDistance(){return-I4(this.focusDistance,this.near,this.far)}set worldFocusDistance(e){this.focusDistance=jE(-e,this.near,this.far)}getFocusDistance(e){this.uniforms.focusDistance.value=e}setFocusDistance(e){this.uniforms.focusDistance.value=e}get focalLength(){return this.focusRange}set focalLength(e){this.focusRange=e}get focusRange(){return this.uniforms.focusRange.value}set focusRange(e){this.uniforms.focusRange.value=e}get worldFocusRange(){return-I4(this.focusRange,this.near,this.far)}set worldFocusRange(e){this.focusRange=jE(-e,this.near,this.far)}getFocalLength(e){return this.focusRange}setFocalLength(e){this.focusRange=e}adoptCameraSettings(e){e&&(this.uniforms.cameraNear.value=e.near,this.uniforms.cameraFar.value=e.far,e instanceof pa?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}},f4e=`#include <common>
#include <dithering_pars_fragment>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec4 sum=texture2D(inputBuffer,vUv0);sum+=texture2D(inputBuffer,vUv1);sum+=texture2D(inputBuffer,vUv2);sum+=texture2D(inputBuffer,vUv3);gl_FragColor=sum*0.25;
#include <encodings_fragment>
#include <dithering_fragment>
}`,p4e="uniform vec2 texelSize;uniform vec2 halfTexelSize;uniform float kernel;uniform float scale;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vec2 dUv=(texelSize*vec2(kernel)+halfTexelSize)*scale;vUv0=vec2(uv.x-dUv.x,uv.y+dUv.y);vUv1=vec2(uv.x+dUv.x,uv.y+dUv.y);vUv2=vec2(uv.x+dUv.x,uv.y-dUv.y);vUv3=vec2(uv.x-dUv.x,uv.y-dUv.y);gl_Position=vec4(position.xy,1.0,1.0);}",z4=class extends Vr{constructor(e=new ye){super({name:"KawaseBlurMaterial",uniforms:{inputBuffer:new rt(null),texelSize:new rt(new ye),halfTexelSize:new rt(new ye),kernel:new rt(0),scale:new rt(1)},blending:un,depthWrite:!1,depthTest:!1,fragmentShader:f4e,vertexShader:p4e}),this.toneMapped=!1,this.setTexelSize(e.x,e.y)}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.inputBuffer=e}get scale(){return this.uniforms.scale.value}set scale(e){this.uniforms.scale.value=e}getScale(){return this.uniforms.scale.value}setScale(e){this.uniforms.scale.value=e}getKernel(){return null}get kernel(){return this.uniforms.kernel.value}set kernel(e){this.uniforms.kernel.value=e}setKernel(e){this.kernel=e}setTexelSize(e,t){this.uniforms.texelSize.value.set(e,t),this.uniforms.halfTexelSize.value.set(e,t).multiplyScalar(.5)}setSize(e,t){let r=this.uniforms;r.texelSize.value.set(1/e,1/t),r.halfTexelSize.value.copy(r.texelSize.value).multiplyScalar(.5)}},m4e=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform float opacity;varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);gl_FragColor=opacity*texel;
#include <encodings_fragment>
}`,v4e=class extends Vr{constructor(){super({name:"CopyMaterial",uniforms:{inputBuffer:new rt(null),opacity:new rt(1)},blending:un,depthWrite:!1,depthTest:!1,fragmentShader:m4e,vertexShader:T0}),this.toneMapped=!1}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}getOpacity(e){return this.uniforms.opacity.value}setOpacity(e){this.uniforms.opacity.value=e}},g4e=`varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;
#if THREE_REVISION < 143
#define luminance(v) linearToRelativeLuminance(v)
#endif
#if EDGE_DETECTION_MODE != 0
varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;
#endif
#if EDGE_DETECTION_MODE == 1
#include <common>
#endif
#if EDGE_DETECTION_MODE == 0 || PREDICATION_MODE == 1
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}vec3 gatherNeighbors(){float p=readDepth(vUv);float pLeft=readDepth(vUv0);float pTop=readDepth(vUv1);return vec3(p,pLeft,pTop);}
#elif PREDICATION_MODE == 2
uniform sampler2D predicationBuffer;vec3 gatherNeighbors(){float p=texture2D(predicationBuffer,vUv).r;float pLeft=texture2D(predicationBuffer,vUv0).r;float pTop=texture2D(predicationBuffer,vUv1).r;return vec3(p,pLeft,pTop);}
#endif
#if PREDICATION_MODE != 0
vec2 calculatePredicatedThreshold(){vec3 neighbours=gatherNeighbors();vec2 delta=abs(neighbours.xx-neighbours.yz);vec2 edges=step(PREDICATION_THRESHOLD,delta);return PREDICATION_SCALE*EDGE_THRESHOLD*(1.0-PREDICATION_STRENGTH*edges);}
#endif
#if EDGE_DETECTION_MODE != 0
uniform sampler2D inputBuffer;
#endif
void main(){
#if EDGE_DETECTION_MODE == 0
const vec2 threshold=vec2(DEPTH_THRESHOLD);
#elif PREDICATION_MODE != 0
vec2 threshold=calculatePredicatedThreshold();
#else
const vec2 threshold=vec2(EDGE_THRESHOLD);
#endif
#if EDGE_DETECTION_MODE == 0
vec3 neighbors=gatherNeighbors();vec2 delta=abs(neighbors.xx-vec2(neighbors.y,neighbors.z));vec2 edges=step(threshold,delta);if(dot(edges,vec2(1.0))==0.0){discard;}gl_FragColor=vec4(edges,0.0,1.0);
#elif EDGE_DETECTION_MODE == 1
float l=luminance(texture2D(inputBuffer,vUv).rgb);float lLeft=luminance(texture2D(inputBuffer,vUv0).rgb);float lTop=luminance(texture2D(inputBuffer,vUv1).rgb);vec4 delta;delta.xy=abs(l-vec2(lLeft,lTop));vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0))==0.0){discard;}float lRight=luminance(texture2D(inputBuffer,vUv2).rgb);float lBottom=luminance(texture2D(inputBuffer,vUv3).rgb);delta.zw=abs(l-vec2(lRight,lBottom));vec2 maxDelta=max(delta.xy,delta.zw);float lLeftLeft=luminance(texture2D(inputBuffer,vUv4).rgb);float lTopTop=luminance(texture2D(inputBuffer,vUv5).rgb);delta.zw=abs(vec2(lLeft,lTop)-vec2(lLeftLeft,lTopTop));maxDelta=max(maxDelta.xy,delta.zw);float finalDelta=max(maxDelta.x,maxDelta.y);edges.xy*=step(finalDelta,LOCAL_CONTRAST_ADAPTATION_FACTOR*delta.xy);gl_FragColor=vec4(edges,0.0,1.0);
#elif EDGE_DETECTION_MODE == 2
vec4 delta;vec3 c=texture2D(inputBuffer,vUv).rgb;vec3 cLeft=texture2D(inputBuffer,vUv0).rgb;vec3 t=abs(c-cLeft);delta.x=max(max(t.r,t.g),t.b);vec3 cTop=texture2D(inputBuffer,vUv1).rgb;t=abs(c-cTop);delta.y=max(max(t.r,t.g),t.b);vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0))==0.0){discard;}vec3 cRight=texture2D(inputBuffer,vUv2).rgb;t=abs(c-cRight);delta.z=max(max(t.r,t.g),t.b);vec3 cBottom=texture2D(inputBuffer,vUv3).rgb;t=abs(c-cBottom);delta.w=max(max(t.r,t.g),t.b);vec2 maxDelta=max(delta.xy,delta.zw);vec3 cLeftLeft=texture2D(inputBuffer,vUv4).rgb;t=abs(c-cLeftLeft);delta.z=max(max(t.r,t.g),t.b);vec3 cTopTop=texture2D(inputBuffer,vUv5).rgb;t=abs(c-cTopTop);delta.w=max(max(t.r,t.g),t.b);maxDelta=max(maxDelta.xy,delta.zw);float finalDelta=max(maxDelta.x,maxDelta.y);edges*=step(finalDelta,LOCAL_CONTRAST_ADAPTATION_FACTOR*delta.xy);gl_FragColor=vec4(edges,0.0,1.0);
#endif
}`,y4e=`uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;
#if EDGE_DETECTION_MODE != 0
varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;
#endif
void main(){vUv=position.xy*0.5+0.5;vUv0=vUv+texelSize*vec2(-1.0,0.0);vUv1=vUv+texelSize*vec2(0.0,-1.0);
#if EDGE_DETECTION_MODE != 0
vUv2=vUv+texelSize*vec2(1.0,0.0);vUv3=vUv+texelSize*vec2(0.0,1.0);vUv4=vUv+texelSize*vec2(-2.0,0.0);vUv5=vUv+texelSize*vec2(0.0,-2.0);
#endif
gl_Position=vec4(position.xy,1.0,1.0);}`,qw={DEPTH:0,LUMA:1,COLOR:2},b4e={DISABLED:0,DEPTH:1,CUSTOM:2},x4e=class extends Vr{constructor(e=new ye,t=qw.COLOR){super({name:"EdgeDetectionMaterial",defines:{THREE_REVISION:am.replace(/\D+/g,""),LOCAL_CONTRAST_ADAPTATION_FACTOR:"2.0",EDGE_THRESHOLD:"0.1",DEPTH_THRESHOLD:"0.01",PREDICATION_MODE:"0",PREDICATION_THRESHOLD:"0.01",PREDICATION_SCALE:"2.0",PREDICATION_STRENGTH:"1.0",DEPTH_PACKING:"0"},uniforms:{inputBuffer:new rt(null),depthBuffer:new rt(null),predicationBuffer:new rt(null),texelSize:new rt(e)},blending:un,depthWrite:!1,depthTest:!1,fragmentShader:g4e,vertexShader:y4e}),this.toneMapped=!1,this.edgeDetectionMode=t}set depthBuffer(e){this.uniforms.depthBuffer.value=e}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e,t=Mc){this.depthBuffer=e,this.depthPacking=t}get edgeDetectionMode(){return Number(this.defines.EDGE_DETECTION_MODE)}set edgeDetectionMode(e){this.defines.EDGE_DETECTION_MODE=e.toFixed(0),this.needsUpdate=!0}getEdgeDetectionMode(){return this.edgeDetectionMode}setEdgeDetectionMode(e){this.edgeDetectionMode=e}get localContrastAdaptationFactor(){return Number(this.defines.LOCAL_CONTRAST_ADAPTATION_FACTOR)}set localContrastAdaptationFactor(e){this.defines.LOCAL_CONTRAST_ADAPTATION_FACTOR=e.toFixed("6"),this.needsUpdate=!0}getLocalContrastAdaptationFactor(){return this.localContrastAdaptationFactor}setLocalContrastAdaptationFactor(e){this.localContrastAdaptationFactor=e}get edgeDetectionThreshold(){return Number(this.defines.EDGE_THRESHOLD)}set edgeDetectionThreshold(e){this.defines.EDGE_THRESHOLD=e.toFixed("6"),this.defines.DEPTH_THRESHOLD=(e*.1).toFixed("6"),this.needsUpdate=!0}getEdgeDetectionThreshold(){return this.edgeDetectionThreshold}setEdgeDetectionThreshold(e){this.edgeDetectionThreshold=e}get predicationMode(){return Number(this.defines.PREDICATION_MODE)}set predicationMode(e){this.defines.PREDICATION_MODE=e.toFixed(0),this.needsUpdate=!0}getPredicationMode(){return this.predicationMode}setPredicationMode(e){this.predicationMode=e}set predicationBuffer(e){this.uniforms.predicationBuffer.value=e}setPredicationBuffer(e){this.uniforms.predicationBuffer.value=e}get predicationThreshold(){return Number(this.defines.PREDICATION_THRESHOLD)}set predicationThreshold(e){this.defines.PREDICATION_THRESHOLD=e.toFixed("6"),this.needsUpdate=!0}getPredicationThreshold(){return this.predicationThreshold}setPredicationThreshold(e){this.predicationThreshold=e}get predicationScale(){return Number(this.defines.PREDICATION_SCALE)}set predicationScale(e){this.defines.PREDICATION_SCALE=e.toFixed("6"),this.needsUpdate=!0}getPredicationScale(){return this.predicationScale}setPredicationScale(e){this.predicationScale=e}get predicationStrength(){return Number(this.defines.PREDICATION_STRENGTH)}set predicationStrength(e){this.defines.PREDICATION_STRENGTH=e.toFixed("6"),this.needsUpdate=!0}getPredicationStrength(){return this.predicationStrength}setPredicationStrength(e){this.predicationStrength=e}setSize(e,t){this.uniforms.texelSize.value.set(1/e,1/t)}},w4e=`#include <common>
#include <packing>
#include <dithering_pars_fragment>
#define packFloatToRGBA(v) packDepthToRGBA(v)
#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;
#if THREE_REVISION < 143
#define luminance(v) linearToRelativeLuminance(v)
#endif
#if THREE_REVISION >= 137
vec4 sRGBToLinear(const in vec4 value){return vec4(mix(pow(value.rgb*0.9478672986+vec3(0.0521327014),vec3(2.4)),value.rgb*0.0773993808,vec3(lessThanEqual(value.rgb,vec3(0.04045)))),value.a);}
#endif
float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}float getViewZ(const in float depth){
#ifdef PERSPECTIVE_CAMERA
return perspectiveDepthToViewZ(depth,cameraNear,cameraFar);
#else
return orthographicDepthToViewZ(depth,cameraNear,cameraFar);
#endif
}FRAGMENT_HEADvoid main(){FRAGMENT_MAIN_UVvec4 color0=texture2D(inputBuffer,UV);vec4 color1=vec4(0.0);FRAGMENT_MAIN_IMAGEgl_FragColor=color0;
#ifdef ENCODE_OUTPUT
#include <encodings_fragment>
#endif
#include <dithering_fragment>
}`,S4e="uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;VERTEX_HEADvoid main(){vUv=position.xy*0.5+0.5;VERTEX_MAIN_SUPPORTgl_Position=vec4(position.xy,1.0,1.0);}",es={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},VE=class extends Vr{constructor(e,t,r,i,n=!1){super({name:"EffectMaterial",defines:{THREE_REVISION:am.replace(/\D+/g,""),DEPTH_PACKING:"0",ENCODE_OUTPUT:"1"},uniforms:{inputBuffer:new rt(null),depthBuffer:new rt(null),resolution:new rt(new ye),texelSize:new rt(new ye),cameraNear:new rt(.3),cameraFar:new rt(1e3),aspect:new rt(1),time:new rt(0)},blending:un,depthWrite:!1,depthTest:!1,dithering:n}),this.toneMapped=!1,e&&this.setShaderParts(e),t&&this.setDefines(t),r&&this.setUniforms(r),this.adoptCameraSettings(i)}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(e){this.uniforms.depthBuffer.value=e}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e,t=Mc){this.depthBuffer=e,this.depthPacking=t}setShaderParts(e){return this.fragmentShader=w4e.replace(es.FRAGMENT_HEAD,e.get(es.FRAGMENT_HEAD)).replace(es.FRAGMENT_MAIN_UV,e.get(es.FRAGMENT_MAIN_UV)).replace(es.FRAGMENT_MAIN_IMAGE,e.get(es.FRAGMENT_MAIN_IMAGE)),this.vertexShader=S4e.replace(es.VERTEX_HEAD,e.get(es.VERTEX_HEAD)).replace(es.VERTEX_MAIN_SUPPORT,e.get(es.VERTEX_MAIN_SUPPORT)),this.needsUpdate=!0,this}setDefines(e){for(let t of e.entries())this.defines[t[0]]=t[1];return this.needsUpdate=!0,this}setUniforms(e){for(let t of e.entries())this.uniforms[t[0]]=t[1];return this}setExtensions(e){this.extensions={};for(let t of e)this.extensions[t]=!0;return this}get encodeOutput(){return this.defines.ENCODE_OUTPUT!==void 0}set encodeOutput(e){this.encodeOutput!==e&&(e?this.defines.ENCODE_OUTPUT="1":delete this.defines.ENCODE_OUTPUT,this.needsUpdate=!0)}isOutputEncodingEnabled(e){return this.encodeOutput}setOutputEncodingEnabled(e){this.encodeOutput=e}get time(){return this.uniforms.time.value}set time(e){this.uniforms.time.value=e}setDeltaTime(e){this.uniforms.time.value+=e}adoptCameraSettings(e){e&&(this.uniforms.cameraNear.value=e.near,this.uniforms.cameraFar.value=e.far,e instanceof pa?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}setSize(e,t){let r=this.uniforms;r.resolution.value.set(e,t),r.texelSize.value.set(1/e,1/t),r.aspect.value=e/t}static get Section(){return es}},C4e=`#include <common>
#if THREE_REVISION < 143
#define luminance(v) linearToRelativeLuminance(v)
#endif
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef RANGE
uniform vec2 range;
#elif defined(THRESHOLD)
uniform float threshold;uniform float smoothing;
#endif
varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);float l=luminance(texel.rgb);
#ifdef RANGE
float low=step(range.x,l);float high=step(l,range.y);l*=low*high;
#elif defined(THRESHOLD)
l=smoothstep(threshold,threshold+smoothing,l);
#endif
#ifdef COLOR
gl_FragColor=vec4(texel.rgb*l,l);
#else
gl_FragColor=vec4(l);
#endif
}`,_4e=class extends Vr{constructor(e=!1,t=null){super({name:"LuminanceMaterial",defines:{THREE_REVISION:am.replace(/\D+/g,"")},uniforms:{inputBuffer:new rt(null),threshold:new rt(0),smoothing:new rt(1),range:new rt(null)},blending:un,depthWrite:!1,depthTest:!1,fragmentShader:C4e,vertexShader:T0}),this.toneMapped=!1,this.colorOutput=e,this.luminanceRange=t}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get threshold(){return this.uniforms.threshold.value}set threshold(e){this.smoothing>0||e>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.threshold.value=e}getThreshold(){return this.threshold}setThreshold(e){this.threshold=e}get smoothing(){return this.uniforms.smoothing.value}set smoothing(e){this.threshold>0||e>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.smoothing.value=e}getSmoothingFactor(){return this.smoothing}setSmoothingFactor(e){this.smoothing=e}get useThreshold(){return this.threshold>0||this.smoothing>0}set useThreshold(e){}get colorOutput(){return this.defines.COLOR!==void 0}set colorOutput(e){e?this.defines.COLOR="1":delete this.defines.COLOR,this.needsUpdate=!0}isColorOutputEnabled(e){return this.colorOutput}setColorOutputEnabled(e){this.colorOutput=e}get useRange(){return this.luminanceRange!==null}set useRange(e){this.luminanceRange=null}get luminanceRange(){return this.uniforms.range.value}set luminanceRange(e){e!==null?this.defines.RANGE="1":delete this.defines.RANGE,this.uniforms.range.value=e,this.needsUpdate=!0}getLuminanceRange(){return this.luminanceRange}setLuminanceRange(e){this.luminanceRange=e}},A4e=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef MASK_PRECISION_HIGH
uniform mediump sampler2D maskTexture;
#else
uniform lowp sampler2D maskTexture;
#endif
#if MASK_FUNCTION != 0
uniform float strength;
#endif
varying vec2 vUv;void main(){
#if COLOR_CHANNEL == 0
float mask=texture2D(maskTexture,vUv).r;
#elif COLOR_CHANNEL == 1
float mask=texture2D(maskTexture,vUv).g;
#elif COLOR_CHANNEL == 2
float mask=texture2D(maskTexture,vUv).b;
#else
float mask=texture2D(maskTexture,vUv).a;
#endif
#if MASK_FUNCTION == 0
#ifdef INVERTED
mask=step(mask,0.0);
#else
mask=1.0-step(mask,0.0);
#endif
#else
mask=clamp(mask*strength,0.0,1.0);
#ifdef INVERTED
mask=1.0-mask;
#endif
#endif
#if MASK_FUNCTION == 2
gl_FragColor=vec4(mask*texture2D(inputBuffer,vUv).rgb,mask);
#else
gl_FragColor=mask*texture2D(inputBuffer,vUv);
#endif
}`,P9={DISCARD:0,MULTIPLY:1,MULTIPLY_RGB_SET_ALPHA:2},M4e=class extends Vr{constructor(e=null){super({name:"MaskMaterial",uniforms:{maskTexture:new rt(e),inputBuffer:new rt(null),strength:new rt(1)},blending:un,depthWrite:!1,depthTest:!1,fragmentShader:A4e,vertexShader:T0}),this.toneMapped=!1,this.setColorChannel(T9.RED),this.setMaskFunction(P9.DISCARD)}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}set maskTexture(e){this.uniforms.maskTexture.value=e,delete this.defines.MASK_PRECISION_HIGH,e.type!==wa&&(this.defines.MASK_PRECISION_HIGH="1"),this.needsUpdate=!0}setMaskTexture(e){this.maskTexture=e}set colorChannel(e){this.defines.COLOR_CHANNEL=e.toFixed(0),this.needsUpdate=!0}setColorChannel(e){this.colorChannel=e}set maskFunction(e){this.defines.MASK_FUNCTION=e.toFixed(0),this.needsUpdate=!0}setMaskFunction(e){this.maskFunction=e}get inverted(){return this.defines.INVERTED!==void 0}set inverted(e){this.inverted&&!e?delete this.defines.INVERTED:e&&(this.defines.INVERTED="1"),this.needsUpdate=!0}isInverted(){return this.inverted}setInverted(e){this.inverted=e}get strength(){return this.uniforms.strength.value}set strength(e){this.uniforms.strength.value=e}getStrength(){return this.strength}setStrength(e){this.strength=e}},E4e=`#define sampleLevelZeroOffset(t, coord, offset) texture2D(t, coord + offset * texelSize)
#if __VERSION__ < 300
#define round(v) floor(v + 0.5)
#endif
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform lowp sampler2D areaTexture;uniform lowp sampler2D searchTexture;uniform vec2 texelSize;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixCoord;void movec(const in bvec2 c,inout vec2 variable,const in vec2 value){if(c.x){variable.x=value.x;}if(c.y){variable.y=value.y;}}void movec(const in bvec4 c,inout vec4 variable,const in vec4 value){movec(c.xy,variable.xy,value.xy);movec(c.zw,variable.zw,value.zw);}vec2 decodeDiagBilinearAccess(in vec2 e){e.r=e.r*abs(5.0*e.r-5.0*0.75);return round(e);}vec4 decodeDiagBilinearAccess(in vec4 e){e.rb=e.rb*abs(5.0*e.rb-5.0*0.75);return round(e);}vec2 searchDiag1(const in vec2 texCoord,const in vec2 dir,out vec2 e){vec4 coord=vec4(texCoord,-1.0,1.0);vec3 t=vec3(texelSize,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(coord.z<float(MAX_SEARCH_STEPS_DIAG_INT-1)&&coord.w>0.9)){break;}coord.xyz=t*vec3(dir,1.0)+coord.xyz;e=texture2D(inputBuffer,coord.xy).rg;coord.w=dot(e,vec2(0.5));}return coord.zw;}vec2 searchDiag2(const in vec2 texCoord,const in vec2 dir,out vec2 e){vec4 coord=vec4(texCoord,-1.0,1.0);coord.x+=0.25*texelSize.x;vec3 t=vec3(texelSize,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(coord.z<float(MAX_SEARCH_STEPS_DIAG_INT-1)&&coord.w>0.9)){break;}coord.xyz=t*vec3(dir,1.0)+coord.xyz;e=texture2D(inputBuffer,coord.xy).rg;e=decodeDiagBilinearAccess(e);coord.w=dot(e,vec2(0.5));}return coord.zw;}vec2 areaDiag(const in vec2 dist,const in vec2 e,const in float offset){vec2 texCoord=vec2(AREATEX_MAX_DISTANCE_DIAG,AREATEX_MAX_DISTANCE_DIAG)*e+dist;texCoord=AREATEX_PIXEL_SIZE*texCoord+0.5*AREATEX_PIXEL_SIZE;texCoord.x+=0.5;texCoord.y+=AREATEX_SUBTEX_SIZE*offset;return texture2D(areaTexture,texCoord).rg;}vec2 calculateDiagWeights(const in vec2 texCoord,const in vec2 e,const in vec4 subsampleIndices){vec2 weights=vec2(0.0);vec4 d;vec2 end;if(e.r>0.0){d.xz=searchDiag1(texCoord,vec2(-1.0,1.0),end);d.x+=float(end.y>0.9);}else{d.xz=vec2(0.0);}d.yw=searchDiag1(texCoord,vec2(1.0,-1.0),end);if(d.x+d.y>2.0){vec4 coords=vec4(-d.x+0.25,d.x,d.y,-d.y-0.25)*texelSize.xyxy+texCoord.xyxy;vec4 c;c.xy=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(-1,0)).rg;c.zw=sampleLevelZeroOffset(inputBuffer,coords.zw,vec2(1,0)).rg;c.yxwz=decodeDiagBilinearAccess(c.xyzw);vec2 cc=vec2(2.0)*c.xz+c.yw;movec(bvec2(step(0.9,d.zw)),cc,vec2(0.0));weights+=areaDiag(d.xy,cc,subsampleIndices.z);}d.xz=searchDiag2(texCoord,vec2(-1.0,-1.0),end);if(sampleLevelZeroOffset(inputBuffer,texCoord,vec2(1,0)).r>0.0){d.yw=searchDiag2(texCoord,vec2(1.0),end);d.y+=float(end.y>0.9);}else{d.yw=vec2(0.0);}if(d.x+d.y>2.0){vec4 coords=vec4(-d.x,-d.x,d.y,d.y)*texelSize.xyxy+texCoord.xyxy;vec4 c;c.x=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(-1,0)).g;c.y=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(0,-1)).r;c.zw=sampleLevelZeroOffset(inputBuffer,coords.zw,vec2(1,0)).gr;vec2 cc=vec2(2.0)*c.xz+c.yw;movec(bvec2(step(0.9,d.zw)),cc,vec2(0.0));weights+=areaDiag(d.xy,cc,subsampleIndices.w).gr;}return weights;}float searchLength(const in vec2 e,const in float offset){vec2 scale=SEARCHTEX_SIZE*vec2(0.5,-1.0);vec2 bias=SEARCHTEX_SIZE*vec2(offset,1.0);scale+=vec2(-1.0,1.0);bias+=vec2(0.5,-0.5);scale*=1.0/SEARCHTEX_PACKED_SIZE;bias*=1.0/SEARCHTEX_PACKED_SIZE;return texture2D(searchTexture,scale*e+bias).r;}float searchXLeft(in vec2 texCoord,const in float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.x>end&&e.g>0.8281&&e.r==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(-2.0,0.0)*texelSize+texCoord;}float offset=-(255.0/127.0)*searchLength(e,0.0)+3.25;return texelSize.x*offset+texCoord.x;}float searchXRight(vec2 texCoord,const in float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.x<end&&e.g>0.8281&&e.r==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(2.0,0.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e,0.5)+3.25;return-texelSize.x*offset+texCoord.x;}float searchYUp(vec2 texCoord,const in float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.y>end&&e.r>0.8281&&e.g==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=-vec2(0.0,2.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e.gr,0.0)+3.25;return texelSize.y*offset+texCoord.y;}float searchYDown(vec2 texCoord,const in float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;i++){if(!(texCoord.y<end&&e.r>0.8281&&e.g==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(0.0,2.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e.gr,0.5)+3.25;return-texelSize.y*offset+texCoord.y;}vec2 area(const in vec2 dist,const in float e1,const in float e2,const in float offset){vec2 texCoord=vec2(AREATEX_MAX_DISTANCE)*round(4.0*vec2(e1,e2))+dist;texCoord=AREATEX_PIXEL_SIZE*texCoord+0.5*AREATEX_PIXEL_SIZE;texCoord.y=AREATEX_SUBTEX_SIZE*offset+texCoord.y;return texture2D(areaTexture,texCoord).rg;}void detectHorizontalCornerPattern(inout vec2 weights,const in vec4 texCoord,const in vec2 d){
#if !defined(DISABLE_CORNER_DETECTION)
vec2 leftRight=step(d.xy,d.yx);vec2 rounding=(1.0-CORNER_ROUNDING_NORM)*leftRight;rounding/=leftRight.x+leftRight.y;vec2 factor=vec2(1.0);factor.x-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(0,1)).r;factor.x-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,1)).r;factor.y-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(0,-2)).r;factor.y-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,-2)).r;weights*=clamp(factor,0.0,1.0);
#endif
}void detectVerticalCornerPattern(inout vec2 weights,const in vec4 texCoord,const in vec2 d){
#if !defined(DISABLE_CORNER_DETECTION)
vec2 leftRight=step(d.xy,d.yx);vec2 rounding=(1.0-CORNER_ROUNDING_NORM)*leftRight;rounding/=leftRight.x+leftRight.y;vec2 factor=vec2(1.0);factor.x-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(1,0)).g;factor.x-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,1)).g;factor.y-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(-2,0)).g;factor.y-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(-2,1)).g;weights*=clamp(factor,0.0,1.0);
#endif
}void main(){vec4 weights=vec4(0.0);vec4 subsampleIndices=vec4(0.0);vec2 e=texture2D(inputBuffer,vUv).rg;if(e.g>0.0){
#if !defined(DISABLE_DIAG_DETECTION)
weights.rg=calculateDiagWeights(vUv,e,subsampleIndices);if(weights.r==-weights.g){
#endif
vec2 d;vec3 coords;coords.x=searchXLeft(vOffset[0].xy,vOffset[2].x);coords.y=vOffset[1].y;d.x=coords.x;float e1=texture2D(inputBuffer,coords.xy).r;coords.z=searchXRight(vOffset[0].zw,vOffset[2].y);d.y=coords.z;d=round(resolution.xx*d+-vPixCoord.xx);vec2 sqrtD=sqrt(abs(d));float e2=sampleLevelZeroOffset(inputBuffer,coords.zy,vec2(1,0)).r;weights.rg=area(sqrtD,e1,e2,subsampleIndices.y);coords.y=vUv.y;detectHorizontalCornerPattern(weights.rg,coords.xyzy,d);
#if !defined(DISABLE_DIAG_DETECTION)
}else{e.r=0.0;}
#endif
}if(e.r>0.0){vec2 d;vec3 coords;coords.y=searchYUp(vOffset[1].xy,vOffset[2].z);coords.x=vOffset[0].x;d.x=coords.y;float e1=texture2D(inputBuffer,coords.xy).g;coords.z=searchYDown(vOffset[1].zw,vOffset[2].w);d.y=coords.z;d=round(resolution.yy*d-vPixCoord.yy);vec2 sqrtD=sqrt(abs(d));float e2=sampleLevelZeroOffset(inputBuffer,coords.xz,vec2(0,1)).g;weights.ba=area(sqrtD,e1,e2,subsampleIndices.x);coords.x=vUv.x;detectVerticalCornerPattern(weights.ba,coords.xyxz,d);}gl_FragColor=weights;}`,T4e="uniform vec2 texelSize;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixCoord;void main(){vUv=position.xy*0.5+0.5;vPixCoord=vUv*resolution;vOffset[0]=vUv.xyxy+texelSize.xyxy*vec4(-0.25,-0.125,1.25,-0.125);vOffset[1]=vUv.xyxy+texelSize.xyxy*vec4(-0.125,-0.25,-0.125,1.25);vOffset[2]=vec4(vOffset[0].xz,vOffset[1].yw)+vec4(-2.0,2.0,-2.0,2.0)*texelSize.xxyy*MAX_SEARCH_STEPS_FLOAT;gl_Position=vec4(position.xy,1.0,1.0);}",P4e=class extends Vr{constructor(e=new ye,t=new ye){super({name:"SMAAWeightsMaterial",defines:{MAX_SEARCH_STEPS_INT:"16",MAX_SEARCH_STEPS_FLOAT:"16.0",MAX_SEARCH_STEPS_DIAG_INT:"8",MAX_SEARCH_STEPS_DIAG_FLOAT:"8.0",CORNER_ROUNDING:"25",CORNER_ROUNDING_NORM:"0.25",AREATEX_MAX_DISTANCE:"16.0",AREATEX_MAX_DISTANCE_DIAG:"20.0",AREATEX_PIXEL_SIZE:"(1.0 / vec2(160.0, 560.0))",AREATEX_SUBTEX_SIZE:"(1.0 / 7.0)",SEARCHTEX_SIZE:"vec2(66.0, 33.0)",SEARCHTEX_PACKED_SIZE:"vec2(64.0, 16.0)"},uniforms:{inputBuffer:new rt(null),searchTexture:new rt(null),areaTexture:new rt(null),resolution:new rt(t),texelSize:new rt(e)},blending:un,depthWrite:!1,depthTest:!1,fragmentShader:E4e,vertexShader:T4e}),this.toneMapped=!1}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get searchTexture(){return this.uniforms.searchTexture.value}set searchTexture(e){this.uniforms.searchTexture.value=e}get areaTexture(){return this.uniforms.areaTexture.value}set areaTexture(e){this.uniforms.areaTexture.value=e}setLookupTextures(e,t){this.searchTexture=e,this.areaTexture=t}get orthogonalSearchSteps(){return Number(this.defines.MAX_SEARCH_STEPS_INT)}set orthogonalSearchSteps(e){let t=Math.min(Math.max(e,0),112);this.defines.MAX_SEARCH_STEPS_INT=t.toFixed("0"),this.defines.MAX_SEARCH_STEPS_FLOAT=t.toFixed("1"),this.needsUpdate=!0}setOrthogonalSearchSteps(e){this.orthogonalSearchSteps=e}get diagonalSearchSteps(){return Number(this.defines.MAX_SEARCH_STEPS_DIAG_INT)}set diagonalSearchSteps(e){let t=Math.min(Math.max(e,0),20);this.defines.MAX_SEARCH_STEPS_DIAG_INT=t.toFixed("0"),this.defines.MAX_SEARCH_STEPS_DIAG_FLOAT=t.toFixed("1"),this.needsUpdate=!0}setDiagonalSearchSteps(e){this.diagonalSearchSteps=e}get diagonalDetection(){return this.defines.DISABLE_DIAG_DETECTION===void 0}set diagonalDetection(e){e?delete this.defines.DISABLE_DIAG_DETECTION:this.defines.DISABLE_DIAG_DETECTION="1",this.needsUpdate=!0}isDiagonalDetectionEnabled(){return this.diagonalDetection}setDiagonalDetectionEnabled(e){this.diagonalDetection=e}get cornerRounding(){return Number(this.defines.CORNER_ROUNDING)}set cornerRounding(e){let t=Math.min(Math.max(e,0),100);this.defines.CORNER_ROUNDING=t.toFixed("4"),this.defines.CORNER_ROUNDING_NORM=(t/100).toFixed("4"),this.needsUpdate=!0}setCornerRounding(e){this.cornerRounding=e}get cornerDetection(){return this.defines.DISABLE_CORNER_DETECTION===void 0}set cornerDetection(e){e?delete this.defines.DISABLE_CORNER_DETECTION:this.defines.DISABLE_CORNER_DETECTION="1",this.needsUpdate=!0}isCornerRoundingEnabled(){return this.cornerDetection}setCornerRoundingEnabled(e){this.cornerDetection=e}setSize(e,t){let r=this.uniforms;r.texelSize.value.set(1/e,1/t),r.resolution.value.set(e,t)}},D4e=new Rh,Wc=null;function O4e(){if(Wc===null){let e=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),t=new Float32Array([0,0,2,0,0,2]);Wc=new Ot,Wc.setAttribute!==void 0?(Wc.setAttribute("position",new qt(e,3)),Wc.setAttribute("uv",new qt(t,2))):(Wc.addAttribute("position",new qt(e,3)),Wc.addAttribute("uv",new qt(t,2)))}return Wc}var Ua=class{constructor(e="Pass",t=new ll,r=D4e){this.name=e,this.renderer=null,this.scene=t,this.camera=r,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}get renderToScreen(){return!this.rtt}set renderToScreen(e){if(this.rtt===e){let t=this.getFullscreenMaterial();t!==null&&(t.needsUpdate=!0),this.rtt=!e}}setRenderer(e){this.renderer=e}isEnabled(){return this.enabled}setEnabled(e){this.enabled=e}get fullscreenMaterial(){return this.screen!==null?this.screen.material:null}set fullscreenMaterial(e){let t=this.screen;t!==null?t.material=e:(t=new Oi(O4e(),e),t.frustumCulled=!1,this.scene===null&&(this.scene=new ll),this.scene.add(t),this.screen=t)}getFullscreenMaterial(){return this.fullscreenMaterial}setFullscreenMaterial(e){this.fullscreenMaterial=e}getDepthTexture(){return null}setDepthTexture(e,t=Mc){}render(e,t,r,i,n){throw new Error("Render method not implemented!")}setSize(e,t){}initialize(e,t,r){}dispose(){for(let e of Object.keys(this)){let t=this[e];if(t!==null&&typeof t=="object"&&typeof t.dispose=="function"){if(t instanceof ll||t===this.renderer)continue;this[e].dispose()}}}},HE=class extends Ua{constructor(e,t=!0){super("CopyPass"),this.fullscreenMaterial=new v4e,this.needsSwap=!1,this.renderTarget=e,e===void 0&&(this.renderTarget=new jr(1,1,{minFilter:hr,magFilter:hr,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="CopyPass.Target"),this.autoResize=t}get resize(){return this.autoResize}set resize(e){this.autoResize=e}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}setAutoResizeEnabled(e){this.autoResize=e}render(e,t,r,i,n){this.fullscreenMaterial.inputBuffer=t.texture,e.setRenderTarget(this.renderToScreen?null:this.renderTarget),e.render(this.scene,this.camera)}setSize(e,t){this.autoResize&&this.renderTarget.setSize(e,t)}initialize(e,t,r){r!==void 0&&(this.renderTarget.texture.type=r,r!==wa?this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1":e.outputEncoding===lr&&(this.renderTarget.texture.encoding=lr))}},R4e=class extends Ua{constructor(){super("ClearMaskPass",null,null),this.needsSwap=!1}render(e,t,r,i,n){let a=e.state.buffers.stencil;a.setLocked(!1),a.setTest(!1)}},z_=new Bt,ZD=class extends Ua{constructor(e=!0,t=!0,r=!1){super("ClearPass",null,null),this.needsSwap=!1,this.color=e,this.depth=t,this.stencil=r,this.overrideClearColor=null,this.overrideClearAlpha=-1}setClearFlags(e,t,r){this.color=e,this.depth=t,this.stencil=r}getOverrideClearColor(){return this.overrideClearColor}setOverrideClearColor(e){this.overrideClearColor=e}getOverrideClearAlpha(){return this.overrideClearAlpha}setOverrideClearAlpha(e){this.overrideClearAlpha=e}render(e,t,r,i,n){let a=this.overrideClearColor,o=this.overrideClearAlpha,s=e.getClearAlpha(),l=a!==null,c=o>=0;l?(z_.copy(e.getClearColor(z_)),e.setClearColor(a,c?o:s)):c&&e.setClearAlpha(o),e.setRenderTarget(this.renderToScreen?null:t),e.clear(this.color,this.depth,this.stencil),l?e.setClearColor(z_,s):c&&e.setClearAlpha(s)}},Gc=-1,eo=class extends ca{constructor(e,t=Gc,r=Gc,i=1){super(),this.resizable=e,this.base=new ye(1,1),this.preferred=new ye(t,r),this.target=this.preferred,this.s=i}get width(){let{base:e,preferred:t,scale:r}=this,i;return t.width!==Gc?i=t.width:t.height!==Gc?i=Math.round(t.height*(e.width/Math.max(e.height,1))):i=Math.round(e.width*r),i}set width(e){this.preferredWidth=e}get height(){let{base:e,preferred:t,scale:r}=this,i;return t.height!==Gc?i=t.height:t.width!==Gc?i=Math.round(t.width/Math.max(e.width/Math.max(e.height,1),1)):i=Math.round(e.height*r),i}set height(e){this.preferredHeight=e}getWidth(){return this.width}getHeight(){return this.height}get scale(){return this.s}set scale(e){this.s!==e&&(this.s=e,this.preferred.setScalar(Gc),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getScale(){return this.scale}setScale(e){this.scale=e}get baseWidth(){return this.base.width}set baseWidth(e){this.base.width!==e&&(this.base.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getBaseWidth(){return this.base.width}setBaseWidth(e){this.base.width!==e&&(this.base.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}get baseHeight(){return this.base.height}set baseHeight(e){this.base.height!==e&&(this.base.height=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getBaseHeight(){return this.baseHeight}setBaseHeight(e){this.baseHeight=e}setBaseSize(e,t){(this.base.width!==e||this.base.height!==t)&&(this.base.set(e,t),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}get preferredWidth(){return this.preferred.width}set preferredWidth(e){this.preferred.width!==e&&(this.preferred.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getPreferredWidth(){return this.preferredWidth}setPreferredWidth(e){this.preferredWidth=e}get preferredHeight(){return this.preferred.height}set preferredHeight(e){this.preferred.height!==e&&(this.preferred.height=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getPreferredHeight(){return this.preferredHeight}setPreferredHeight(e){this.preferredHeight=e}setPreferredSize(e,t){(this.preferred.width!==e||this.preferred.height!==t)&&(this.preferred.set(e,t),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}copy(e){this.base.set(e.getBaseWidth(),e.getBaseHeight()),this.preferred.set(e.getPreferredWidth(),e.getPreferredHeight()),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height)}static get AUTO_SIZE(){return Gc}},k_=!1,k4=class{constructor(e=null){this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.materialsFlatShaded=null,this.materialsFlatShadedBackSide=null,this.materialsFlatShadedDoubleSide=null,this.setMaterial(e),this.meshCount=0,this.replaceMaterial=t=>{if(t.isMesh){let r;if(t.material.flatShading)switch(t.material.side){case ga:r=this.materialsFlatShadedDoubleSide;break;case Nn:r=this.materialsFlatShadedBackSide;break;default:r=this.materialsFlatShaded;break}else switch(t.material.side){case ga:r=this.materialsDoubleSide;break;case Nn:r=this.materialsBackSide;break;default:r=this.materials;break}this.originalMaterials.set(t,t.material),t.isSkinnedMesh?t.material=r[2]:t.isInstancedMesh?t.material=r[1]:t.material=r[0],++this.meshCount}}}setMaterial(e){if(this.disposeMaterials(),this.material=e,e!==null){let t=this.materials=[e.clone(),e.clone(),e.clone()];for(let r of t)r.uniforms=Object.assign({},e.uniforms),r.side=bs;t[2].skinning=!0,this.materialsBackSide=t.map(r=>{let i=r.clone();return i.uniforms=Object.assign({},e.uniforms),i.side=Nn,i}),this.materialsDoubleSide=t.map(r=>{let i=r.clone();return i.uniforms=Object.assign({},e.uniforms),i.side=ga,i}),this.materialsFlatShaded=t.map(r=>{let i=r.clone();return i.uniforms=Object.assign({},e.uniforms),i.flatShading=!0,i}),this.materialsFlatShadedBackSide=t.map(r=>{let i=r.clone();return i.uniforms=Object.assign({},e.uniforms),i.flatShading=!0,i.side=Nn,i}),this.materialsFlatShadedDoubleSide=t.map(r=>{let i=r.clone();return i.uniforms=Object.assign({},e.uniforms),i.flatShading=!0,i.side=ga,i})}}render(e,t,r){let i=e.shadowMap.enabled;if(e.shadowMap.enabled=!1,k_){let n=this.originalMaterials;this.meshCount=0,t.traverse(this.replaceMaterial),e.render(t,r);for(let a of n)a[0].material=a[1];this.meshCount!==n.size&&n.clear()}else{let n=t.overrideMaterial;t.overrideMaterial=this.material,e.render(t,r),t.overrideMaterial=n}e.shadowMap.enabled=i}disposeMaterials(){if(this.material!==null){let e=this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide).concat(this.materialsFlatShaded).concat(this.materialsFlatShadedBackSide).concat(this.materialsFlatShadedDoubleSide);for(let t of e)t.dispose()}}dispose(){this.originalMaterials.clear(),this.disposeMaterials()}static get workaroundEnabled(){return k_}static set workaroundEnabled(e){k_=e}},I4e=class extends Ua{constructor(e,t,r=null){super("RenderPass",e,t),this.needsSwap=!1,this.clearPass=new ZD,this.overrideMaterialManager=r===null?null:new k4(r),this.ignoreBackground=!1,this.skipShadowMapUpdate=!1,this.selection=null}get renderToScreen(){return super.renderToScreen}set renderToScreen(e){super.renderToScreen=e,this.clearPass.renderToScreen=e}get overrideMaterial(){let e=this.overrideMaterialManager;return e!==null?e.material:null}set overrideMaterial(e){let t=this.overrideMaterialManager;e!==null?t!==null?t.setMaterial(e):this.overrideMaterialManager=new k4(e):t!==null&&(t.dispose(),this.overrideMaterialManager=null)}getOverrideMaterial(){return this.overrideMaterial}setOverrideMaterial(e){this.overrideMaterial=e}get clear(){return this.clearPass.enabled}set clear(e){this.clearPass.enabled=e}getSelection(){return this.selection}setSelection(e){this.selection=e}isBackgroundDisabled(){return this.ignoreBackground}setBackgroundDisabled(e){this.ignoreBackground=e}isShadowMapDisabled(){return this.skipShadowMapUpdate}setShadowMapDisabled(e){this.skipShadowMapUpdate=e}getClearPass(){return this.clearPass}render(e,t,r,i,n){let a=this.scene,o=this.camera,s=this.selection,l=o.layers.mask,c=a.background,u=e.shadowMap.autoUpdate,d=this.renderToScreen?null:t;s!==null&&o.layers.set(s.getLayer()),this.skipShadowMapUpdate&&(e.shadowMap.autoUpdate=!1),(this.ignoreBackground||this.clearPass.overrideClearColor!==null)&&(a.background=null),this.clearPass.enabled&&this.clearPass.render(e,t),e.setRenderTarget(d),this.overrideMaterialManager!==null?this.overrideMaterialManager.render(e,a,o):e.render(a,o),o.layers.mask=l,a.background=c,e.shadowMap.autoUpdate=u}},L4=class extends Ua{constructor(e,t,{resolutionScale:r=1,width:i=eo.AUTO_SIZE,height:n=eo.AUTO_SIZE,renderTarget:a}={}){super("DepthPass"),this.needsSwap=!1,this.renderPass=new I4e(e,t,new p8({depthPacking:e8}));let o=this.renderPass;o.skipShadowMapUpdate=!0,o.ignoreBackground=!0;let s=o.getClearPass();s.overrideClearColor=new Bt(16777215),s.overrideClearAlpha=1,this.renderTarget=a,this.renderTarget===void 0&&(this.renderTarget=new jr(1,1,{minFilter:Wr,magFilter:Wr,stencilBuffer:!1}),this.renderTarget.texture.name="DepthPass.Target");let l=this.resolution=new eo(this,i,n,r);l.addEventListener("change",c=>this.setSize(l.baseWidth,l.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}render(e,t,r,i,n){let a=this.renderToScreen?null:this.renderTarget;this.renderPass.render(e,a)}setSize(e,t){let r=this.resolution;r.setBaseSize(e,t),this.renderTarget.setSize(r.width,r.height)}},Pr={SKIP:0,ADD:1,ALPHA:2,AVERAGE:3,COLOR_BURN:4,COLOR_DODGE:5,DARKEN:6,DIFFERENCE:7,EXCLUSION:8,LIGHTEN:9,MULTIPLY:10,DIVIDE:11,NEGATION:12,NORMAL:13,OVERLAY:14,REFLECT:15,SCREEN:16,SOFT_LIGHT:17,SUBTRACT:18},z4e="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return min(x+y,1.0)*opacity+x*(1.0-opacity);}",k4e="vec3 blend(const in vec3 x,const in vec3 y,const in float opacity){return y*opacity+x*(1.0-opacity);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){float a=min(y.a,opacity);return vec4(blend(x.rgb,y.rgb,a),max(x.a,a));}",L4e="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(x+y)*0.5*opacity+x*(1.0-opacity);}",B4e="float blend(const in float x,const in float y){return(y==0.0)?y:max(1.0-(1.0-x)/y,0.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",F4e="float blend(const in float x,const in float y){return(y==1.0)?y:min(x/(1.0-y),1.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",N4e="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return min(x,y)*opacity+x*(1.0-opacity);}",U4e="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return abs(x-y)*opacity+x*(1.0-opacity);}",j4e="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(x+y-2.0*x*y)*opacity+x*(1.0-opacity);}",V4e="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return max(x,y)*opacity+x*(1.0-opacity);}",H4e="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return x*y*opacity+x*(1.0-opacity);}",W4e="float blend(const in float x,const in float y){return(y>0.0)?min(x/y,1.0):1.0;}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",G4e="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(1.0-abs(1.0-x-y))*opacity+x*(1.0-opacity);}",$4e="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return y*opacity+x*(1.0-opacity);}",q4e="float blend(const in float x,const in float y){return(x<0.5)?(2.0*x*y):(1.0-2.0*(1.0-x)*(1.0-y));}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",Y4e="float blend(const in float x,const in float y){return(y==1.0)?y:min(x*x/(1.0-y),1.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",X4e="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(1.0-(1.0-x)*(1.0-y))*opacity+x*(1.0-opacity);}",K4e="float blend(const in float x,const in float y){return(y<0.5)?(2.0*x*y+x*x*(1.0-2.0*y)):(sqrt(x)*(2.0*y-1.0)+2.0*x*(1.0-y));}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",Q4e="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return max(x+y-1.0,0.0)*opacity+x*(1.0-opacity);}",Z4e=new Map([[Pr.SKIP,null],[Pr.ADD,z4e],[Pr.ALPHA,k4e],[Pr.AVERAGE,L4e],[Pr.COLOR_BURN,B4e],[Pr.COLOR_DODGE,F4e],[Pr.DARKEN,N4e],[Pr.DIFFERENCE,U4e],[Pr.EXCLUSION,j4e],[Pr.LIGHTEN,V4e],[Pr.MULTIPLY,H4e],[Pr.DIVIDE,W4e],[Pr.NEGATION,G4e],[Pr.NORMAL,$4e],[Pr.OVERLAY,q4e],[Pr.REFLECT,Y4e],[Pr.SCREEN,X4e],[Pr.SOFT_LIGHT,K4e],[Pr.SUBTRACT,Q4e]]),J4e=class extends ca{constructor(e,t=1){super(),this.f=e,this.opacity=new rt(t)}getOpacity(){return this.opacity.value}setOpacity(e){this.opacity.value=e}get blendFunction(){return this.f}set blendFunction(e){this.f=e,this.dispatchEvent({type:"change"})}getBlendFunction(){return this.blendFunction}setBlendFunction(e){this.blendFunction=e}getShaderCode(){return Z4e.get(this.blendFunction)}},cl={NONE:0,DEPTH:1,CONVOLUTION:2},Cl=class extends ca{constructor(e,t,{attributes:r=cl.NONE,blendFunction:i=Pr.SCREEN,defines:n=new Map,uniforms:a=new Map,extensions:o=null,vertexShader:s=null}={}){super(),this.name=e,this.renderer=null,this.attributes=r,this.fragmentShader=t,this.vertexShader=s,this.defines=n,this.uniforms=a,this.extensions=o,this.blendMode=new J4e(i),this.blendMode.addEventListener("change",l=>this.setChanged())}getName(){return this.name}setRenderer(e){this.renderer=e}getDefines(){return this.defines}getUniforms(){return this.uniforms}getExtensions(){return this.extensions}getBlendMode(){return this.blendMode}getAttributes(){return this.attributes}setAttributes(e){this.attributes=e,this.setChanged()}getFragmentShader(){return this.fragmentShader}setFragmentShader(e){this.fragmentShader=e,this.setChanged()}getVertexShader(){return this.vertexShader}setVertexShader(e){this.vertexShader=e,this.setChanged()}setChanged(){this.dispatchEvent({type:"change"})}setDepthTexture(e,t=Mc){}update(e,t,r){}setSize(e,t){}initialize(e,t,r){}dispose(){for(let e of Object.keys(this)){let t=this[e];if(t!==null&&typeof t=="object"&&typeof t.dispose=="function"){if(t instanceof ll||t===this.renderer)continue;this[e].dispose()}}}};function B4(e,t,r){for(let i of t){let n="$1"+e+i.charAt(0).toUpperCase()+i.slice(1),a=new RegExp("([^\\.])(\\b"+i+"\\b)","g");for(let o of r.entries())o[1]!==null&&r.set(o[0],o[1].replace(a,n))}}function eFe(e,t,r,i,n,a,o){let s=new Map([["fragment",t.getFragmentShader()],["vertex",t.getVertexShader()]]),l=s.get("fragment")!==void 0&&/mainImage/.test(s.get("fragment")),c=s.get("fragment")!==void 0&&/mainUv/.test(s.get("fragment")),u=[],d=[],h=!1,f=!1;if(s.get("fragment")===void 0)console.error("Missing fragment shader",t);else if(c&&o&cl.CONVOLUTION)console.error("Effects that transform UV coordinates are incompatible with convolution effects",t);else if(!l&&!c)console.error("The fragment shader contains neither a mainImage nor a mainUv function",t);else{let p=/(?:\w+\s+(\w+)\([\w\s,]*\)\s*{[^}]+})/g,v=VE.Section;if(c){let g=`	${e}MainUv(UV);
`;r.set(v.FRAGMENT_MAIN_UV,r.get(v.FRAGMENT_MAIN_UV)+g),h=!0}if(s.get("vertex")!==null&&/mainSupport/.test(s.get("vertex"))){let g=`	${e}MainSupport(`;g+=/mainSupport *\([\w\s]*?uv\s*?\)/.test(s.get("vertex"))?`vUv);
`:`);
`,r.set(v.VERTEX_MAIN_SUPPORT,r.get(v.VERTEX_MAIN_SUPPORT)+g),u=u.concat([...s.get("vertex").matchAll(/(?:varying\s+\w+\s+(\w*))/g)].map(y=>y[1])),d=d.concat(u).concat([...s.get("vertex").matchAll(p)].map(y=>y[1]))}d=d.concat([...s.get("fragment").matchAll(p)].map(g=>g[1])),d=d.concat([...t.defines.keys()].map(g=>g.replace(/\([\w\s,]*\)/g,""))),d=d.concat([...t.uniforms.keys()]),t.uniforms.forEach((g,y)=>a.set(e+y.charAt(0).toUpperCase()+y.slice(1),g)),t.defines.forEach((g,y)=>n.set(e+y.charAt(0).toUpperCase()+y.slice(1),g)),B4(e,d,n),B4(e,d,s);let m=t.blendMode;if(i.set(m.blendFunction,m),l){let g=/MainImage *\([\w\s,]*?depth[\w\s,]*?\)/,y=`${e}MainImage(color0, UV, `;o&cl.DEPTH&&g.test(s.get("fragment"))&&(y+="depth, ",f=!0),y+=`color1);
	`;let b=e+"BlendOpacity";a.set(b,m.opacity),y+=`color0 = blend${m.blendFunction}(color0, color1, ${b});

	`,r.set(v.FRAGMENT_MAIN_IMAGE,r.get(v.FRAGMENT_MAIN_IMAGE)+y),y=`uniform float ${b};

`,r.set(v.FRAGMENT_HEAD,r.get(v.FRAGMENT_HEAD)+y)}r.set(v.FRAGMENT_HEAD,r.get(v.FRAGMENT_HEAD)+s.get("fragment")+`
`),s.get("vertex")!==null&&r.set(v.VERTEX_HEAD,r.get(v.VERTEX_HEAD)+s.get("vertex")+`
`)}return{varyings:u,transformedUv:h,readDepth:f}}var O1=class extends Ua{constructor(e,...t){super("EffectPass"),this.fullscreenMaterial=new VE(null,null,null,e),this.effects=t.sort((r,i)=>i.attributes-r.attributes),this.skipRendering=!1,this.uniformCount=0,this.varyingCount=0,this.minTime=1,this.maxTime=Number.POSITIVE_INFINITY}get encodeOutput(){return this.fullscreenMaterial.encodeOutput}set encodeOutput(e){this.fullscreenMaterial.encodeOutput=e}get dithering(){return this.fullscreenMaterial.dithering}set dithering(e){let t=this.fullscreenMaterial;t.dithering=e,t.needsUpdate=!0}verifyResources(){let e=this.renderer.capabilities,t=Math.min(e.maxFragmentUniforms,e.maxVertexUniforms);this.uniformCount>t&&console.warn("The current rendering context doesn't support more than "+t+" uniforms, but "+this.uniformCount+" were defined"),t=e.maxVaryings,this.varyingCount>t&&console.warn("The current rendering context doesn't support more than "+t+" varyings, but "+this.varyingCount+" were defined")}updateMaterial(){let e=VE.Section,t=new Map([[e.FRAGMENT_HEAD,""],[e.FRAGMENT_MAIN_UV,""],[e.FRAGMENT_MAIN_IMAGE,""],[e.VERTEX_HEAD,""],[e.VERTEX_MAIN_SUPPORT,""]]),r=new Map,i=new Map,n=new Map,a=new Set,o=0,s=0,l=0,c=!1,u=!1;for(let h of this.effects)if(h.blendMode.blendFunction===Pr.SKIP)l|=h.getAttributes()&cl.DEPTH;else if(l&h.getAttributes()&cl.CONVOLUTION)console.error("Convolution effects cannot be merged",h);else{l|=h.getAttributes();let f="e"+o++,p=eFe(f,h,t,r,i,n,l);if(s+=p.varyings.length,c=c||p.transformedUv,u=u||p.readDepth,h.extensions!==null)for(let v of h.extensions)a.add(v)}let d=/\bblend\b/g;for(let h of r.values()){let f=h.getShaderCode().replace(d,`blend${h.blendFunction}`);t.set(e.FRAGMENT_HEAD,t.get(e.FRAGMENT_HEAD)+f+`
`)}l&cl.DEPTH?(u&&t.set(e.FRAGMENT_MAIN_IMAGE,`float depth = readDepth(UV);

	`+t.get(e.FRAGMENT_MAIN_IMAGE)),this.needsDepthTexture=this.getDepthTexture()===null):this.needsDepthTexture=!1,c?(t.set(e.FRAGMENT_MAIN_UV,`vec2 transformedUv = vUv;
`+t.get(e.FRAGMENT_MAIN_UV)),i.set("UV","transformedUv")):i.set("UV","vUv"),t.forEach((h,f,p)=>p.set(f,h.trim().replace(/^#/,`
#`))),this.uniformCount=n.size,this.varyingCount=s,this.skipRendering=o===0,this.needsSwap=!this.skipRendering,this.fullscreenMaterial.setShaderParts(t).setExtensions(a).setUniforms(n).setDefines(i)}recompile(){this.updateMaterial(),this.verifyResources()}getDepthTexture(){return this.fullscreenMaterial.depthBuffer}setDepthTexture(e,t=Mc){this.fullscreenMaterial.depthBuffer=e,this.fullscreenMaterial.depthPacking=t;for(let r of this.effects)r.setDepthTexture(e,t)}render(e,t,r,i,n){for(let a of this.effects)a.update(e,t,i);if(!this.skipRendering||this.renderToScreen){let a=this.fullscreenMaterial;a.inputBuffer=t.texture,a.time+=i,e.setRenderTarget(this.renderToScreen?null:r),e.render(this.scene,this.camera)}}setSize(e,t){this.fullscreenMaterial.setSize(e,t);for(let r of this.effects)r.setSize(e,t)}initialize(e,t,r){this.renderer=e;for(let i of this.effects)i.initialize(e,t,r),i.addEventListener("change",n=>this.handleEvent(n));this.updateMaterial(),this.verifyResources(),r!==void 0&&r!==wa&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}dispose(){super.dispose();for(let e of this.effects)e.dispose()}handleEvent(e){switch(e.type){case"change":this.recompile();break}}},tFe=[new Float32Array([0,0]),new Float32Array([0,1,1]),new Float32Array([0,1,1,2]),new Float32Array([0,1,2,2,3]),new Float32Array([0,1,2,3,4,4,5]),new Float32Array([0,1,2,3,4,5,7,8,9,10])],JD=class extends Ua{constructor({resolutionScale:e=.5,width:t=eo.AUTO_SIZE,height:r=eo.AUTO_SIZE,kernelSize:i=Yw.LARGE}={}){super("KawaseBlurPass"),this.renderTargetA=new jr(1,1,{minFilter:hr,magFilter:hr,stencilBuffer:!1,depthBuffer:!1}),this.renderTargetA.texture.name="Blur.Target.A",this.renderTargetB=this.renderTargetA.clone(),this.renderTargetB.texture.name="Blur.Target.B";let n=this.resolution=new eo(this,t,r,e);n.addEventListener("change",a=>this.setSize(n.baseWidth,n.baseHeight)),this.blurMaterial=new z4,this.ditheredBlurMaterial=new z4,this.ditheredBlurMaterial.uniforms.scale=this.blurMaterial.uniforms.scale,this.ditheredBlurMaterial.dithering=!0,this.dithering=!1,this.kernelSize=i}getResolution(){return this.resolution}get width(){return this.resolution.width}set width(e){this.resolution.preferredWidth=e}get height(){return this.resolution.height}set height(e){this.resolution.preferredHeight=e}get scale(){return this.blurMaterial.scale}set scale(e){this.blurMaterial.scale=e}getScale(){return this.blurMaterial.scale}setScale(e){this.blurMaterial.scale=e}getKernelSize(){return this.kernelSize}setKernelSize(e){this.kernelSize=e}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}render(e,t,r,i,n){let a=this.scene,o=this.camera,s=this.renderTargetA,l=this.renderTargetB,c=tFe[this.kernelSize],u=this.blurMaterial,d=t,h,f;for(this.fullscreenMaterial=u,h=0,f=c.length-1;h<f;++h){let p=h&1?l:s;u.kernel=c[h],u.inputBuffer=d.texture,e.setRenderTarget(p),e.render(a,o),d=p}this.dithering&&(u=this.ditheredBlurMaterial,this.fullscreenMaterial=u),u.kernel=c[h],u.inputBuffer=d.texture,e.setRenderTarget(this.renderToScreen?null:r),e.render(a,o)}setSize(e,t){let r=this.resolution;r.setBaseSize(e,t);let i=r.width,n=r.height;this.renderTargetA.setSize(i,n),this.renderTargetB.setSize(i,n),this.blurMaterial.setSize(i,n),this.ditheredBlurMaterial.setSize(i,n)}initialize(e,t,r){r!==void 0&&(this.renderTargetA.texture.type=r,this.renderTargetB.texture.type=r,r!==wa?(this.blurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.ditheredBlurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1"):e.outputEncoding===lr&&(this.renderTargetA.texture.encoding=lr,this.renderTargetB.texture.encoding=lr))}static get AUTO_SIZE(){return eo.AUTO_SIZE}},rFe=class extends Ua{constructor({width:e=eo.AUTO_SIZE,height:t=eo.AUTO_SIZE,renderTarget:r,luminanceRange:i,colorOutput:n}={}){super("LuminancePass"),this.fullscreenMaterial=new _4e(n,i),this.needsSwap=!1,this.renderTarget=r,this.renderTarget===void 0&&(this.renderTarget=new jr(1,1,{minFilter:hr,magFilter:hr,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="LuminancePass.Target",this.renderTarget.texture.generateMipmaps=!1);let a=this.resolution=new eo(this,e,t);a.addEventListener("change",o=>this.setSize(a.baseWidth,a.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}render(e,t,r,i,n){let a=this.fullscreenMaterial;a.inputBuffer=t.texture,e.setRenderTarget(this.renderToScreen?null:this.renderTarget),e.render(this.scene,this.camera)}setSize(e,t){let r=this.resolution;r.setBaseSize(e,t),this.renderTarget.setSize(r.width,r.height)}initialize(e,t,r){r!==void 0&&r!==wa&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},iFe=class extends Ua{constructor(e,t){super("MaskPass",e,t),this.needsSwap=!1,this.clearPass=new ZD(!1,!1,!0),this.inverse=!1}get inverted(){return this.inverse}set inverted(e){this.inverse=e}get clear(){return this.clearPass.enabled}set clear(e){this.clearPass.enabled=e}getClearPass(){return this.clearPass}isInverted(){return this.inverted}setInverted(e){this.inverted=e}render(e,t,r,i,n){let a=e.getContext(),o=e.state.buffers,s=this.scene,l=this.camera,c=this.clearPass,u=this.inverted?0:1,d=1-u;o.color.setMask(!1),o.depth.setMask(!1),o.color.setLocked(!0),o.depth.setLocked(!0),o.stencil.setTest(!0),o.stencil.setOp(a.REPLACE,a.REPLACE,a.REPLACE),o.stencil.setFunc(a.ALWAYS,u,4294967295),o.stencil.setClear(d),o.stencil.setLocked(!0),this.clearPass.enabled&&(this.renderToScreen?c.render(e,null):(c.render(e,t),c.render(e,r))),this.renderToScreen?(e.setRenderTarget(null),e.render(s,l)):(e.setRenderTarget(t),e.render(s,l),e.setRenderTarget(r),e.render(s,l)),o.color.setLocked(!1),o.depth.setLocked(!1),o.stencil.setLocked(!1),o.stencil.setFunc(a.EQUAL,1,4294967295),o.stencil.setOp(a.KEEP,a.KEEP,a.KEEP),o.stencil.setLocked(!0)}},as=class extends Ua{constructor(e,t="inputBuffer"){super("ShaderPass"),this.fullscreenMaterial=e,this.inputBufferUniform=null,this.setInput(t)}setInput(e){if(this.inputBufferUniform=null,this.fullscreenMaterial!==null){let t=this.fullscreenMaterial.uniforms;t!==void 0&&t[e]!==void 0&&(this.inputBufferUniform=t[e])}}render(e,t,r,i,n){this.inputBufferUniform!==null&&t!==null&&(this.inputBufferUniform.value=t.texture),e.setRenderTarget(this.renderToScreen?null:r),e.render(this.scene,this.camera)}initialize(e,t,r){r!==void 0&&r!==wa&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},L_=1/1e3,nFe=1e3,aFe=class{constructor(){this.previousTime=0,this.currentTime=0,this.delta=0,this.fixedDelta=1e3/60,this.elapsed=0,this.timescale=1,this.fixedDeltaEnabled=!1,this.autoReset=!1}setFixedDeltaEnabled(e){return this.fixedDeltaEnabled=e,this}isAutoResetEnabled(e){return this.autoReset}setAutoResetEnabled(e){return typeof document<"u"&&document.hidden!==void 0&&(e?document.addEventListener("visibilitychange",this):document.removeEventListener("visibilitychange",this),this.autoReset=e),this}getDelta(){return this.delta*L_}getFixedDelta(){return this.fixedDelta*L_}setFixedDelta(e){return this.fixedDelta=e*nFe,this}getElapsed(){return this.elapsed*L_}getTimescale(){return this.timescale}setTimescale(e){return this.timescale=e,this}update(e){return this.fixedDeltaEnabled?this.delta=this.fixedDelta:(this.previousTime=this.currentTime,this.currentTime=e!==void 0?e:performance.now(),this.delta=this.currentTime-this.previousTime),this.delta*=this.timescale,this.elapsed+=this.delta,this}reset(){return this.delta=0,this.elapsed=0,this.currentTime=performance.now(),this}handleEvent(e){document.hidden||(this.currentTime=performance.now())}dispose(){this.setAutoResetEnabled(!1)}},Yw={VERY_SMALL:0,SMALL:1,MEDIUM:2,LARGE:3,VERY_LARGE:4,HUGE:5},oFe=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D map;
#else
uniform lowp sampler2D map;
#endif
uniform float intensity;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=clamp(texture2D(map,uv)*intensity,0.0,1.0);}`,sFe=class extends Cl{constructor({blendFunction:e=Pr.SCREEN,luminanceThreshold:t=.9,luminanceSmoothing:r=.025,resolutionScale:i=.5,intensity:n=1,width:a=eo.AUTO_SIZE,height:o=eo.AUTO_SIZE,kernelSize:s=Yw.LARGE}={}){super("BloomEffect",oFe,{blendFunction:e,uniforms:new Map([["map",new rt(null)],["intensity",new rt(n)]])}),this.renderTarget=new jr(1,1,{minFilter:hr,magFilter:hr,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="Bloom.Target",this.renderTarget.texture.generateMipmaps=!1,this.uniforms.get("map").value=this.renderTarget.texture,this.luminancePass=new rFe({renderTarget:this.renderTarget,colorOutput:!0}),this.luminanceMaterial.threshold=t,this.luminanceMaterial.smoothingFactor=r,this.blurPass=new JD({resolutionScale:i,width:a,height:o,kernelSize:s});let l=this.blurPass.getResolution();l.addEventListener("change",c=>this.setSize(l.baseWidth,l.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}get resolution(){return this.blurPass.resolution}getResolution(){return this.blurPass.resolution}getBlurPass(){return this.blurPass}getLuminancePass(){return this.luminancePass}get luminanceMaterial(){return this.luminancePass.fullscreenMaterial}getLuminanceMaterial(){return this.luminancePass.fullscreenMaterial}get width(){return this.resolution.width}set width(e){this.resolution.preferredWidth=e}get height(){return this.resolution.height}set height(e){this.resolution.preferredHeight=e}get dithering(){return this.blurPass.dithering}set dithering(e){this.blurPass.dithering=e}get kernelSize(){return this.blurPass.kernelSize}set kernelSize(e){this.blurPass.kernelSize=e}get distinction(){return console.warn(this.name,"distinction was removed"),1}set distinction(e){console.warn(this.name,"distinction was removed")}get intensity(){return this.uniforms.get("intensity").value}set intensity(e){this.uniforms.get("intensity").value=e}getIntensity(){return this.intensity}setIntensity(e){this.intensity=e}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}update(e,t,r){let i=this.renderTarget;this.luminancePass.enabled?(this.luminancePass.render(e,t,i),this.blurPass.render(e,i,i)):this.blurPass.render(e,t,i)}setSize(e,t){let r=this.resolution;r.setBaseSize(e,t),this.renderTarget.setSize(r.width,r.height),this.luminancePass.resolution.copy(r)}initialize(e,t,r){this.blurPass.initialize(e,t,r),r!==void 0&&(this.renderTarget.texture.type=r,e.outputEncoding===lr&&(this.renderTarget.texture.encoding=lr))}},lFe="uniform float brightness;uniform float contrast;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=inputColor.rgb+vec3(brightness-0.5);if(contrast>0.0){color/=vec3(1.0-contrast);}else{color*=vec3(1.0+contrast);}outputColor=vec4(min(color+vec3(0.5),1.0),inputColor.a);}",cFe=class extends Cl{constructor({blendFunction:e=Pr.NORMAL,brightness:t=0,contrast:r=0}={}){super("BrightnessContrastEffect",lFe,{blendFunction:e,uniforms:new Map([["brightness",new rt(t)],["contrast",new rt(r)]])})}get brightness(){return this.uniforms.get("brightness").value}set brightness(e){this.uniforms.get("brightness").value=e}getBrightness(e){return this.brightness}setBrightness(e){this.brightness=e}get contrast(){return this.uniforms.get("contrast").value}set contrast(e){this.uniforms.get("contrast").value=e}getContrast(e){return this.contrast}setContrast(e){this.contrast=e}},uFe="void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=vec4(vec3(average(inputColor.rgb)),inputColor.a);}",dFe=class extends Cl{constructor(e=Pr.NORMAL){super("ColorAverageEffect",uFe,{blendFunction:e})}},hFe="varying vec2 vUvR;varying vec2 vUvB;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec2 ra=texture2D(inputBuffer,vUvR).ra;vec2 ba=texture2D(inputBuffer,vUvB).ba;outputColor=vec4(ra.x,inputColor.g,ba.x,max(max(ra.y,ba.y),inputColor.a));}",fFe="uniform vec2 offset;varying vec2 vUvR;varying vec2 vUvB;void mainSupport(const in vec2 uv){vec2 shift=offset*vec2(1.0,aspect);vUvR=uv+shift;vUvB=uv-shift;}",pFe=class extends Cl{constructor({blendFunction:e=Pr.NORMAL,offset:t=new ye(.001,5e-4)}={}){super("ChromaticAberrationEffect",hFe,{vertexShader:fFe,blendFunction:e,attributes:cl.CONVOLUTION,uniforms:new Map([["offset",new rt(t)]])})}get offset(){return this.uniforms.get("offset").value}set offset(e){this.uniforms.get("offset").value=e}getOffset(){return this.offset}setOffset(e){this.offset=e}},mFe=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D nearColorBuffer;uniform mediump sampler2D farColorBuffer;
#else
uniform lowp sampler2D nearColorBuffer;uniform lowp sampler2D farColorBuffer;
#endif
uniform lowp sampler2D nearCoCBuffer;uniform float scale;void mainImage(const in vec4 inputColor,const in vec2 uv,const in float depth,out vec4 outputColor){vec4 colorNear=texture2D(nearColorBuffer,uv);vec4 colorFar=texture2D(farColorBuffer,uv);float CoCNear=texture2D(nearCoCBuffer,uv).r;CoCNear=min(CoCNear*scale,1.0);vec4 result=inputColor*(1.0-colorFar.a)+colorFar;result=mix(result,colorNear,CoCNear);outputColor=result;}`,vFe=class extends Cl{constructor(e,{blendFunction:t=Pr.NORMAL,worldFocusDistance:r,worldFocusRange:i,focusDistance:n=0,focalLength:a=.1,focusRange:o=a,bokehScale:s=1,width:l=eo.AUTO_SIZE,height:c=eo.AUTO_SIZE}={}){super("DepthOfFieldEffect",mFe,{blendFunction:t,attributes:cl.DEPTH,uniforms:new Map([["nearColorBuffer",new rt(null)],["farColorBuffer",new rt(null)],["nearCoCBuffer",new rt(null)],["scale",new rt(1)]])}),this.camera=e,this.renderTarget=new jr(1,1,{minFilter:hr,magFilter:hr,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="DoF.Intermediate",this.renderTarget.texture.generateMipmaps=!1,this.renderTargetMasked=this.renderTarget.clone(),this.renderTargetMasked.texture.name="DoF.Masked.Far",this.renderTargetNear=this.renderTarget.clone(),this.renderTargetNear.texture.name="DoF.Bokeh.Near",this.uniforms.get("nearColorBuffer").value=this.renderTargetNear.texture,this.renderTargetFar=this.renderTarget.clone(),this.renderTargetFar.texture.name="DoF.Bokeh.Far",this.uniforms.get("farColorBuffer").value=this.renderTargetFar.texture,this.renderTargetCoC=this.renderTarget.clone(),this.renderTargetCoC.texture.name="DoF.CoC",this.renderTargetCoCBlurred=this.renderTargetCoC.clone(),this.renderTargetCoCBlurred.texture.name="DoF.CoC.Blurred",this.uniforms.get("nearCoCBuffer").value=this.renderTargetCoCBlurred.texture,this.cocPass=new as(new h4e(e));let u=this.cocMaterial;u.focusDistance=n,u.focusRange=o,r!==void 0&&(u.worldFocusDistance=r),i!==void 0&&(u.worldFocusRange=i),this.blurPass=new JD({kernelSize:Yw.MEDIUM,width:l,height:c});let d=this.blurPass.getResolution();d.addEventListener("change",f=>this.setSize(d.getBaseWidth(),d.getBaseHeight())),this.maskPass=new as(new M4e(this.renderTargetCoC.texture));let h=this.maskPass.fullscreenMaterial;h.maskFunction=P9.MULTIPLY,h.colorChannel=T9.GREEN,this.bokehNearBasePass=new as(new vb(!1,!0)),this.bokehNearBasePass.fullscreenMaterial.cocBuffer=this.renderTargetCoCBlurred.texture,this.bokehNearFillPass=new as(new vb(!0,!0)),this.bokehNearFillPass.fullscreenMaterial.cocBuffer=this.renderTargetCoCBlurred.texture,this.bokehFarBasePass=new as(new vb(!1,!1)),this.bokehFarBasePass.fullscreenMaterial.cocBuffer=this.renderTargetCoC.texture,this.bokehFarFillPass=new as(new vb(!0,!1)),this.bokehFarFillPass.fullscreenMaterial.cocBuffer=this.renderTargetCoC.texture,this.target=null,this.bokehScale=s}get cocTexture(){return this.renderTargetCoC.texture}get cocMaterial(){return this.cocPass.fullscreenMaterial}get circleOfConfusionMaterial(){return this.cocMaterial}getCircleOfConfusionMaterial(){return this.circleOfConfusionMaterial}getBlurPass(){return this.blurPass}get resolution(){return this.blurPass.getResolution()}getResolution(){return this.blurPass.getResolution()}get bokehScale(){return this.uniforms.get("scale").value}set bokehScale(e){let t=[this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass];for(let r of t)r.fullscreenMaterial.setScale(e);this.maskPass.fullscreenMaterial.setStrength(e),this.uniforms.get("scale").value=e}getBokehScale(){return this.bokehScale}setBokehScale(e){this.bokehScale=e}getTarget(){return this.target}setTarget(e){this.target=e}calculateFocusDistance(e){let t=this.camera,r=t.position.distanceTo(e);return jE(-r,t.near,t.far)}setDepthTexture(e,t=Mc){this.circleOfConfusionMaterial.depthBuffer=e,this.circleOfConfusionMaterial.depthPacking=t}update(e,t,r){let i=this.renderTarget,n=this.renderTargetCoC,a=this.renderTargetCoCBlurred,o=this.renderTargetMasked;if(this.target!==null){let s=this.calculateFocusDistance(this.target);this.circleOfConfusionMaterial.focusDistance=s}this.cocPass.render(e,null,n),this.blurPass.render(e,n,a),this.maskPass.render(e,t,o),this.bokehFarBasePass.render(e,o,i),this.bokehFarFillPass.render(e,i,this.renderTargetFar),this.bokehNearBasePass.render(e,t,i),this.bokehNearFillPass.render(e,i,this.renderTargetNear)}setSize(e,t){let r=this.resolution;r.setBaseSize(e,t);let i=r.width,n=r.height,a=[this.cocPass,this.blurPass,this.maskPass,this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass];a.push(this.renderTargetCoC,this.renderTargetMasked),a.forEach(o=>o.setSize(e,t)),a=[this.renderTarget,this.renderTargetNear,this.renderTargetFar,this.renderTargetCoCBlurred],a.forEach(o=>o.setSize(i,n)),[this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass].forEach(o=>o.fullscreenMaterial.setSize(i,n))}initialize(e,t,r){[this.cocPass,this.maskPass,this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass].forEach(i=>i.initialize(e,t,r)),this.blurPass.initialize(e,t,wa),r!==void 0&&(this.renderTarget.texture.type=r,this.renderTargetNear.texture.type=r,this.renderTargetFar.texture.type=r,this.renderTargetMasked.texture.type=r,e.outputEncoding===lr&&(this.renderTarget.texture.encoding=lr,this.renderTargetNear.texture.encoding=lr,this.renderTargetFar.texture.encoding=lr,this.renderTargetMasked.texture.encoding=lr))}};new k;new it;var gFe="uniform vec3 hue;uniform float saturation;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=vec3(dot(inputColor.rgb,hue.xyz),dot(inputColor.rgb,hue.zxy),dot(inputColor.rgb,hue.yzx));float average=(color.r+color.g+color.b)/3.0;vec3 diff=average-color;if(saturation>0.0){color+=diff*(1.0-1.0/(1.001-saturation));}else{color+=diff*-saturation;}outputColor=vec4(min(color,1.0),inputColor.a);}",yFe=class extends Cl{constructor({blendFunction:e=Pr.NORMAL,hue:t=0,saturation:r=0}={}){super("HueSaturationEffect",gFe,{blendFunction:e,uniforms:new Map([["hue",new rt(new k)],["saturation",new rt(r)]])}),this.hue=t}get saturation(){return this.uniforms.get("saturation").value}set saturation(e){this.uniforms.get("saturation").value=e}getSaturation(){return this.saturation}setSaturation(e){this.saturation=e}get hue(){let e=this.uniforms.get("hue").value;return Math.acos((e.x*3-1)/2)}set hue(e){let t=Math.sin(e),r=Math.cos(e);this.uniforms.get("hue").value.set((2*r+1)/3,(-Math.sqrt(3)*t-r+1)/3,(Math.sqrt(3)*t-r+1)/3)}getHue(){return this.hue}setHue(e){this.hue=e}};new Bt;var bFe=`void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 noise=vec3(rand(uv*time));
#ifdef PREMULTIPLY
outputColor=vec4(min(inputColor.rgb*noise,vec3(1.0)),inputColor.a);
#else
outputColor=vec4(noise,inputColor.a);
#endif
}`,xFe=class extends Cl{constructor({blendFunction:e=Pr.SCREEN,premultiply:t=!1}={}){super("NoiseEffect",bFe,{blendFunction:e}),this.premultiply=t}get premultiply(){return this.defines.has("PREMULTIPLY")}set premultiply(e){this.premultiply!==e&&(e?this.defines.set("PREMULTIPLY","1"):this.defines.delete("PREMULTIPLY"),this.setChanged())}isPremultiplied(){return this.premultiply}setPremultiplied(e){this.premultiply=e}},wFe="uniform bool active;uniform vec2 d;void mainUv(inout vec2 uv){if(active){uv=vec2(d.x*(floor(uv.x/d.x)+0.5),d.y*(floor(uv.y/d.y)+0.5));}}",SFe=class extends Cl{constructor(e=30){super("PixelationEffect",wFe,{uniforms:new Map([["active",new rt(!1)],["d",new rt(new ye)]])}),this.resolution=new ye,this.d=0,this.granularity=e}get granularity(){return this.d}set granularity(e){let t=Math.floor(e);t%2>0&&(t+=1),this.d=t,this.uniforms.get("active").value=t>0,this.setSize(this.resolution.width,this.resolution.height)}getGranularity(){return this.granularity}setGranularity(e){this.granularity=e}setSize(e,t){this.resolution.set(e,t),this.uniforms.get("d").value.setScalar(this.d).divide(this.resolution)}};new k;new k;var F4="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAAQCAYAAACm53kpAAAAeElEQVRYR+2XSwqAMAxEJ168ePEqwRSKhIIiuHjJqiU0gWE+1CQdApcVAMUAuARaMGCX1MIL/Ow13++9lW2s3mW9MWvsnWc/2fvGygwPAN4E8QzAA4CXAB6AHjG4JTHYI1ey3pcx6FHnEfhLDOIBKAmUBK6/ANUDTlROXAHd9EC1AAAAAElFTkSuQmCC",N4="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAAIwCAYAAAABNmBHAAAgAElEQVR4Xuy9CbhlV1ktOvbpq09DkiIkUBI6kxASIH0DlAQiIK1wRfSJTx+i4JX7vKIigs8HXpXvqVcvrcC9agQ7IDTSSWgqCQQliDRBJKkkhDSkqVPNqVOnP+8b//rH3P+eZ+199tlznVTlvVrft7+1T7OaueZY42/m37QALKNk2wHg1pITlB17mC+Pp11W3X/LHyT32vhg48/5SOv+PnwpsHA70JoGlueB1iKApeqzvOzn44GatTB76Xzhd7suBR7+WWADgDEAwwCG/L54b/poDLrHuvvm70Z2Avhsc+PVcxscBU8F8C8ADg5+ipIjD/PlGwfgju8B924E5seARUfLsiNmqQW0IjL8+7L2NYD/7COBzfcCm+aB8SVgdAkYIRCXKyDax4EdAanL5PuNPllNvXDlAHwFgP8AcC2AhRIoDXbsYb48dl5WkVFTE3LGDcC9m4CZCWBuFFgeAZaGAYJQQCRqDHT+McJrVb8zwATUXH02MHYfMHEIGFsAxgjApQqACYQORjtd/B7Axt/z79sC0+cMPgjjlwPwVwHcA+DfAHzTxcVgWBroqMN8+cYBeM71wH0TwKExYHYUWCIAHYRLTlkCYgcIBcAgU/n3qy8GRu4HRgnAOWBkERhddPAJhGJDBxkvw7cqimr+zFM/ZLnZF64cgL8BYD+AWwB8x/dlWuWagHiYL984AJ/0RWBy1AE4AizyM1yxYAcTigW55xMbAkxEiwEdkJ/ZCQxPAiOHgBECcKEC4TBZcKkSv+mTieNcNPNC26mLNsj45QD8LQDTAO4GcJt/7iw2bfoG4WG+vAGwm9ExiEg69zpg/wgwPQLMjgALzn4E4aIzoJjQ9g4024uygkj+pyuAoX0VAIfngOH5NgCHMhAm8Sv2y3XDZeBhNIp8OzJE8OsBzAKYBHAXgDt8/4O+MVT0j4f58o0D8Pxrgf3DwMwIMEPQEYRkNwfgsuuDZLskip0No0gWMD/9HGDoADAkAC4Aw/wsAgZAgs2Z0ABI0GU6IVmKv+f28KDnHxkA/G0A8y6G73N9kOCjXnh/Ebb6OvgwX75xAF5wLTA1VIHPADgMLDj4yIA5AAm6aCUnv4oz46eeDwxNAUMzwJAz4BABSNDFTwSfg7DDKHE23MG5PqIY8A1u/dINs9dBdy8AgnGPM2NfUBrsnw7z5RsH4IXXAAcJviFgluAbygBINnSLWOAjGxJ4pgOKDV0v/OSLKp8iGXBovhLBBOCQM2ACoTOhnYrAdItYbCij5JFzRyIAqRccAnDAQUjg6UNQ7hsMXP0cRQAexss3DsCLCECCLwCQzMcPwUi2MwAScAKbfnY/YRLFQ8DHX+IAJAMSfDkAF13kLvleIjhjQQHxUVS3jjgGpKeeNzYVQEjgUS8k+PghONdhIwAP4+XXBYCHKIJbwJyDTgaIAdCBJx3Q2M8tYAHP9m4df/ylQOsQ0JqtRLCx30K1wtLBggScQOgsKBGcWHAJeOwRC0BSM1mQIKRbhh+Bj98JQP6t4U0APEyXXxcAEnxkQAFwoVUxID9kvQg+c1C7vidRbIDkc24B//hTQGumDcCWA5DgMxASdNIFBUI5pCML8v8API5zfEQx4BudgqiczviSnJhQwCP4BMCGl+wO8+U7AJi/W4O4YS6+pmK/2ciADsAOBhTIIiAJnPB7AvNjP+0AnANaYkAHX2JBAc+tYaJXOqBZv24Vc386XW5dtkHGW+4HFAJonpOe+YYQZAShgKjv3PNvPQaxVoI8zJdfFwASfPzMUwS3Kt1v0UFIlos6oDFdAGFcliMAP/ryAEAGNwQRnDOgLbdlIEwrIs6AZ/QgkMMHQF6ZAKQcJAsSYPwIeAIk9wJgoPK1gi7+PwF4GC/fOAAvIQPSs0URTPBJ/Pp3GSEGRHfBCIQ0xowBtUbcAj7ys5X4Jfu1HIAGQrIgQRXEsAFQIORDFhiDY/rMHmrU4QUgR08AkgUjCAW6CD6CkwBsAIQC4GG6fPMA3OXiNzCg2I9gNCMksmAAoemDzoimFwL48M85AKkiuQVMAAp8CYRRDAt8GQiJ67N6GJODAXAHlsGguscA2AJg1IPGYmxOpBxFWkRN9LsATgIwXnNs/v/5z/9XCf8BO3YAtxbc/46/KDt+5+ea1Yku2VUxHz/z0v24FwMGK1gWsK2OUUxHHdCBeRUB6OxHABr4ZICIBd0QWSF+XRdMTAjgCdTrG9cBNwE4F8CpDkICyYLGsuhFt6zs+gISwUen8zEAjgMw4cfx2H6O/90yAFo84Cbg4ID3/9TfLTt+5+ebnRABkODjx0SwPi5ec/FrYpmqSAxM8Dn60CsqAFI6GfhqAMiDE/gokmvEr0C4PgDkBQm40wE8zMFEUDKEVoxIMLl/KS73mE7H9d+vcKHQQcjwW0Yu9nP8m8sAmOIBuWY6wP2/4s0ezjjg8TuvaR6ABJ70vxUApGrm7EbGE+i472BAB+WHfqHS/eoAaEwY2E9+wLSXTqhI7CXgnB6LCoOJ4BiST+hTnG0HcCwAglCx3ARoZEVFXnBPp/O/A/hXACc7CPs9/i1lAOyIB+RDX+P9/+pbQjjjAMfv/PL6AFDs1wFAgs/9fgKfgdE/ZEpuiQlbwAde6QAMBgiRmsSwA9BY0JfjovGRDBMH4TlcXGhcBOc6HkF0gjPhZgchxTLZMAci/04W/B6Ab3t09EPXcPyflgFwRTwgJ2MN9/8bf5qFM67x+B/aW4XQz42FeL0YrRyikztUFw0704mf9kXgxhOAqc3AAsPyRxxQCs/PdXOFY0W1KHy3QIUGtx+6vdnx1vsB+dsTncm2AogglFgVEAlUWrOMB2RyEmMCGQ/Y7/HvKns6tfGAnJQ+r/9b76oJZ1zD8WdyQjYBh8aBhVEHjELouQ8ukQ7VRSCJAALwkr+sALhnGzDD3JAJYJHg9uhoi4bx8ytkWUtvHT/7+Zc4dw1uZ3612fH2dkQf7yxIEEockwkJQn4IQoq8unhAhmPRKKFx0uv4K8ueTs94wD7u//VX9ghn7OP4c+4G7h8HpseB+dF2AKlFLwuAIZ8jD6NPrOhAffmfA9/ZBuzZCkyRWSeqBCWyoYGQ5yQrBpDbum/ME1HoPo0XEkSD2zlfbna8q6+EUJcTCxKEtHL5EQjP6BEPyIgYAZBvYt3xHyx7OqvGA65y/7/9wVXCGVc5/sl7qxD66dEqiYgRzAqhN1A4CBNAAlDyAFI+iZ9/N3DLJuC+jcDUBmCWyUnOrmTYCMIOkNclLg0B8/RsNLg9+UvNjnd1APLmmQpFHyEBROuWACQT8nN+H/GAvY7/VNnT6SsesMf13/CpahGnZzhjj+PPmwX2MYdDIfQexWyBAwEUOQDrRDN/98p3A7dvAO6fAA5sqHJDBEAyoUVGkwEd6HR12XU4kwzfl6fCXTZzjy57vvnR513X7Hj7AyDvggAUi9EyFgiZqNxPQF6345nOWbD1HQ/Y5fpvuLa/2+82/vNHgAPDFQDnhoF5j2C2qBWCI8bw1eRw5CL5l94L3DEOTI4DB8Y9OWmsEu/zBJ3rgsaybqBob/7A4C7jtWcooRrczr+u2fH2D0AOQgAUCxKEP7aGgLy64+m6KdjWFA9Yc/03/Osa4glrjr+AupqHz1sEs0cxG0BC9HIePLoit9eNkVf9L+DuUWByDJgaq4ybGYLPAWgiXmLedUE7dwC7saL7CqfPKXi4NYdaykCD410bAHlDEsNiwZ9wAPYbkJcfz6T2gm3N8YDZ9d/wHxUA+739fPwXPrSKYGb+BuP3jAFDElFH9HIWwbzCIGkBr/or4J4RYO8oMOW6ZVcAuvi1Cgoha04BCwT5gfMKHm7NoRde2+x41w5A3hQZkADk5+cGiAeMx3+/7AENFA8Yrv/G71cAXFM4Yzj+otOAaQLQA0gZxaIIZtMDFTigKJV8H9Iq6aZ59ZXAvSPAvpEKgBTtBODcSCWCZeRYtpzrmLyeGNCAyFl1v+Hei8qeb370Rdc2O97BAMi7EgB/2QG41nhAHU9LuWAbOB7Qr//GPRUA13r7Gv9FZwIMoVcEswEwfDoimEP0shKKtIphaZQAXv1+YM+wA3DEdcvRKkGJADQQEsQuhi1Tjt95vBsh5nx2IO59SsHDrTmUOStNjndwAAqEry0IyCMICkOyiuIBNwBvPFQQT7gBuPjc9oRYAIHyOEL4vIFEYVNaOou5vCGE/tV/A0wOVcnpzI47NOri3QFIBpSeaSDUdYLOSWvYImSGgftpJDa4MWJbAGxivGUA5MAOc0Be6eVLj7/4Mk+hzCOYPYpZDBiNkLh+G/M3yFyv/ltgL3W3YQfgcFUhgRY2PwY+Z7/EhAR1SFyXCOb57r28QfQBsJQBMn5D4y0HYLPje9Cd7RIC0PM3EiMofF4gVCBp1P840ix/gyz56r+vAMjk9Gl375iB4+CzveuZdLkkEPJ8ZEfX/6R73vOjzT5Si9hucLxHAVg4PwJgRwh9CKOXK8YA4ZEqKZXSQWh5P+5AftXfA/uGKvYjCKn72cctbFrZNECka5L5CPwIPtMH3TVz17MLB5gdLgA2Nd6jACycHwLQxFEUSR5ASvARDB0h9AQb9bXIgCGk6lUfAPYTgEPAITKgg1BObk58srTJgG58WMkWMaAbQQT1nc8rHGANAJsc71EAFs4PAagQestgC1lsBJ4BMCSOK6dDUcwqqaFiQr/0QeAAAdjy+jBiQQeeMSBZT3nCPUDIa9z+/MIB1gCwyfEeBWDh/BCAeQSzgkjFfGLBBD5nxQ4DxN0wv3hVxX5TBGDwL5obxvVA5YqYL5BeMLd66YYxJpRB0gK+96LCAdYAsMnxHgVg4fwIgMrhUPKQ2C+Bz0PmBTqBMQehAbDlIjj4F80KJguSVZ0FuXpjoCOgXawLjALhbT9eOMAuAGxqvEcBWDg/l1IE05Ed0ygZnyHdz0VwCqEPIfNyx0QQvvLDFQCp+8nfZk5und8tXwIgWcHSNX0N2CJmnAl3v6RwgNnhl17T7HiPArBwfghAS7mV/hey2JS9FvM3BLpUUi1YwDRMXvkRYJoAlAh2l0dcZ04s6JUTDIjyBcrl4yDc/dLCAdYAsMnxHgVg4fxwKVwJgGEJNmWtxpQMpX9on2eRhVA+O56AjMfnP+e3Xvf3NwG4xIPTleiY55bpGh6UbafNU0l0z0p+5Jh5HqYJ6b51nP6XP8cx12XNHQVgIQB/bFPVg2OC7Q+WgVFWng/FvtWLI06uWh5oguKEcXVS/9sEAF//VGD7t4ETDgJbF4CNi8CGZWBs2fPL/H6Vwp2KEtVk4fJ+v/EIYPN9wKa5qu+IncfPwXHVZe/aOL3EbwS7xv8A1rQvnO0j8PArTgTGZ4BxFv9mIxhOCGsv+0OPYDRghcLfkWkEuq0+G00x4OtfDGz+d2DbHmDLjL8si8AYP/7CGIAiEEMTG92zXqSbH+d9R2aA0XnvO+JjthiIrOVDHHPOkBrzUQAWAPsZp3oPDpa/Xag6EVkLBK+5rAnJC3/nYk/APD704WiEAV8OTHwX2LQH2DgFbJgFNrBhjd8r79deGoEwsllgNBOzy8CdjweG9wBj08AIAci2D6HafmyAk4/Z7SJ72hGYRwFYAMDLTwOGp4FRFgD3HhzqRGQiyeurqOdG6r0Rm8IEZjzRlkiqCWoEgK8Axm4BJu4HJhyAbFhDxmbDGnZO4j0SgLGDkpibgEq66TJw/1nA0F5gdLpq+zDqFfd5LMeWqu5HNST0uJOIllg+qgMWgI+HPv0xwLA3gWHpW2sC441gCECbmKziaGrnUdMO4aHeh6MxAP4SMHI7ML4HGD8AjHvHJGNAgpDgY/ck3stipRemvVhc+uASMPUEYGh/9dIRgGx8Y+MNbR/00uVtH0wEx94j/v0oAxaA8Ed+GBieAYZZg5kADC0QWGOFzGJlcGPzl1BxNLXD8sk4xftwNAbA/wwM3wGMUmxOOQBnHXzetIYvibonmSiuYTNjriVg7glAiwBk0fNZH6+PmX9P6kfNmCXGpftJ7TgKwBIAnln14BAAYxMYm5C6RjCyCoOyr0qkD/c+HI0B8DXA8N3AyCQwesD1VQKH7EcASm1Q+y4CkN9pUKiVF5nLvy+fBbTUd8QBaH1HvNBROiZvfsNnrF4kcvPwpdsBLBeU18Nf7AB23Dp4ecHC8oBgUlJJecLS+7+WOpE3gbE+HKw+yoevCYkMGKqPJrdEKARutaFYRs1fiEZ0wP8CDN8LDO8FRqYq3W10pgKgfYLaYCzootgA6KXaTA90y374TKB1sBozy77xHFZ536utRgAmEaw6g5kUSFZwSXnA330qsOlfgHMPDlZesLA8IOjoLypPWHj/11EnCiVwkz7kAExtsGraYUWdSDX5TmsagL8KDBGA7Bd30JsW0oWivnEOQNP7yGTSBR101AlZSUtGyfgZDkCWY1HnJdcBVe6325hTvelg2CQjZNDygG/2An0j1wKnL6y9vGBheUC8prQ8YeH9X39OVQSc7Mc6fCaKvAeHdCIVf4yMYCynTpX+nb97NJmlSQb8r8DQHm9YOFUZTKOzoXGhs6AxF0HIexcLBvWBuiHN8s2ne98R3qc6L4Vyb2oBVjfm9MIFHbjDCh6kPOBbQoG+oW8CO5bWVl6wsDwgfr20PGHh/X/1iaEIuDcCTIW/1Q4rFv8OnYiW3c+W2iKwUjKbyjQNwL1uuR6sAEgDgq1brXOmV81PxhNB6DUDBSYzQJwFtz623XcktX1Q1VWKaTF/zZhVazBVYA1tX5MazsGvobwe/jQr0Ne6BTh5uf/ygoXlAfG60vKEhff/rSe1i4DnTWDUACY1guFTDqLYdCBvf6DJYSMYATBfOx1kLfj1v1axH10nQ3Sd0GUkBnTfpemtBJgseIKQAHLQcVxa2TnuMW0Aqui5es8xBIegVdVVE8VhzHnLh65WMB9An+X18K6aAn2tO4ETl6vqbKuVFywsDwhevqg8YeH93/Rk70JE90nowxZbIJjvS3WYNSGUwGHJTpPxwwcbBuBrgRYBeKACn7VtpdUu/c0NJxO9BIxcKu4TTODzbkonPLoaL0vyUQRb2y8HsL1ckfWzMeuFi40Qezqi+yiPhyt7FOjr6/gCFwgP7Xb5vssTFt7/nQRg6MGRWmDRoeyTlpgw68GRTwgZgo1gGmXAX6/8dtaylSKY/koyID9BhzML3q1gAos2AcOrZYSoq/pJp1VtODRm9Z3LS/7WjVkvXOzEtOpKyGrlAT+4SoG+VY8vBGCvy/dVnrDw/vee65NBJiAjBIVcAJQjOm+DkCZEeiGAMw6sAwDZsJrAdhFM9rPGhd4904Co5oVuCZPV6kD40Ec6+9W8dBTBsfdc3nkpvnB82fp2RPcs79dHgb51LA9ofsDV6vut5/3PnxcAmLVBiDqgevDaJLkYrpuQxzcNwN8AWgIgRbB8loEBzXDwl4cGiDGft58SCOWGedgjvOJ+bPvgRkiuA+ZjzhnQQOiFNVbloa7l/fos0LdO5QENgEXlCfs8Qbf7HyMA3QVjYihYhLENgjX9y/qwxQmRU/asfd0ZcLU2CHVGyusJQLKfVi98CS12T5f7iECkHpsMkAhCF8+nshWH2I/jXsOYO144GV/9ApAIrS3vt4YCfetQHtAA2G+/4PW4/2PPbzMgmUMi2NoeSCRxIt2/FvuxWURIWCXg357gfTjEDNIHnTRXRCpH5ugKwGl3HpMBXQc0v6WLYVm/5limj04rG762K2uYY9jBkr9+rI03NL5ZbczS/dJ+LQyoga4o77fGAn0NlwdMAOy3vl/T938KAcj121z8Bn+Y9eWQJRz8Y6kNagDh2ey5EvxjxQD8TWdAuneCCO4An1vw5vdzQMmdktwq7pLZQR+dM34+ZumAxvY1Y04uqOAJ6FsExzeto7zfAAX6GiwPaLWR1lrfr8n7f/Rl3QGzmsis+/uO71V9OFgP2gpPhgr7TGRqRUT6dyvr4aIs/pm/2zVUNbBSv6G8e5pEv0Cvec7Po7+bTtjlBRlkvAMBkDeQyvsNWKCvofKACYBrre/X1P0/oWEAnnFD1YdjhtXxR73mX10FfCHHE9pVWcGAI/S0gKsfA2y+twrFZw6Hxf/F0Pk8Ri/kpGSnMuDx5T0iACgQHioo0NdAecBUHW6QdsV2/cL7v/Cyqr5gnc42CCOcfX1VIZ/V8We9IDmTzVXwPDJiXuKXPxtDBma8+lzP4WAgKkPxCUAPE4v5GzEuMX0PYJPLhB6FJsc7MAMmkVxaYC/K9gG+F1++8AQ7Gwbgk78I7GFpXgIwFiRXOwaJZPUbiR0yCUDRk+cHf+YpwMj9HgfI8ClGPyvsSiH0WSKRuYlitLb/zHM/JOSs5C/YIC9cMQDZr/dwxgOW9gtGYUBi0wA8l304vDQvAchilFbpIBQhZ7Ejq6ZQ0/Yhil8y4j89Axie9DAsD6FX9HOK3QtROTFkviN83kG4felIY8DCeLrSeMDSfsEovAECUFsTjHD+tcB+tkFgcXKvBRir7qtFl9owmO4Xy/1G3bAFfPrZHorFNWBFwHjQAFctIghj2kBarw06If/+MM9ZqTN6DgsDojCerjQesLRfMApvoGkAWh8Ob/tgAPSKWCp8ngNQtadjmTdltvNvn3peFYhgQQgh+iUmEaUAUoXM1yRLmWuFLaE9Z+XIAWBhPF1pPGBpv2AU3kDTALzwmqo6qtVh9kJErAudABia38TC5wJgS2xIhAwBn3yhByL4EhzXfRXxYsDTJ4IvrNN2JFMxZcBzVo4cABbG05XGA5b2C0bhDTQNQLZBYH1AVsQSAAU+imI1obHyblnjG/kJk3U8BHz8xVUQAhnQIl5CyNgKAGp5LKSSCoAySh5Jj79vTagcxUaIBeRNe79g9gq+DXig4wGzy+PONfT7RWFA4noAkGXZVAhcBckJQgNgrLiaNb3paIDo1vHHX+oA9LQBi4DxJcOUPJUnTgU2NJUyROs8irGARxQAC+PpCtsFd40H/AEf0gMQkLgeACT41PiGoLOKqyrJq3K/Ya9mNyr5FusN/uPLPIeDa8Bc+w3rtyl4VFHaMZc3i9RWBM9jjzgAFsbTFbYLRmm/YBTeQNMAtD4cBKDXBTQGdAB2MGBo8SCLmEuS1AFVAJ3A/NhPt0PoCcA8bSDG76XI7aySg6JYuGfKwJHFgH0E5B3ueMCe/Y4L+xVHAOZ+9EHcEgQgwbeiEYx6jwTdz4qfu7EhEJqxGqruf/RnHIAEnxgwBM0aC8aUAYWNBRCmoIll4HTqO122QcZbrgMWxtMVtgvuOx6wa7/jwhtoGoDWh4MBJ16WN4lfr8AqI0TVV1O1fa9BbQzovkAy4Ed+NgCQUSxZCFWvCOaOFREXyUwZOPIA2GdA3uGOB6wPaOz+QPv5S+MA3OXiN9aclghW+d3IgupBF2pPqxcxGenDPxfSRh2ASiKKiVP2PaZScvAKoA0VDc6cOlIB2GdA3uGOB1zR77iwX/F6AFB9ONSOQW0frA50sILVcckWJyIDSgwPAVcJgFbYuZ3FJvAlEHbJ3IsgJLGedeBIA+AAAXmHOx6wo99xYb/i9QKg2iAIfDJEJHqj4SExbEty0gkdhB/6P9oZbBZIGiKYVb9GKaN50lRHBLOvhDxh/5EKwDUG5B3ueMB2QGM/grb7/6wHAPNGMAY+GSGUjC52VX2f2CD4+HO0gqkZfegXKgBaHkcWtS0AWii9xG1ImrLlN5XR8L8fmQD05BVrmEENmpYSP9QX+KHiqj2/82+HqqDWwnbBRfGATdzAegGwru2DpRq7Mzq2fpAf0Nq0Rl2wBXzglZ4yUAPAmDSVWDBPHQjLcgTqOZ6zUvdKHh4ruDCerox/Dnu7YqwXAC1NI/QcEQuK6WK/kdgCTGC0PYAP/KIDMBgglq+hIkrOfsaCviLSofcJgJ5AdM7kkSaCj/HqQKVIGvD4swF8bcBjmzjsaQ2H5D/6acBd9wALB4DFWWB5AVherMp4GKIYEOp7+26UF0aSfT/xYuDG7wDjrIpAERytXf2vajj7ueryQXSFl10K/ON3gIWDwCLvjfGB8Z54O+Ee4ve6513uB2R1yzsqC+twbC8HcNVhfAeaBuDP/TvwtS3A/ePAIfYFVlPq2HHTuyulZCTlhbjhETF5yxTQGgPGhoHhIWC4VSXGD3n0tLkMHXHxu+YyB+MlPwDuZs5K6FlsbCzdVO9DuKfkHM8AEkP7B8fOkwDcD+B7np42+JkGOvKdAL4E4K8P0zvQdET0b14D3DgB3D0B7B8HZka9WzrD88N6sFm+YcUjrn7E1ZDvMtF9DBgeAYaHgSGB0PNHCD4BLwLRsByAyX/ij0/dDUxuqlIG5hix7eFhvLcOVUAtyPSydAFmOQNe6EYGV/9ZESiKgIEgtbaD/gHALQC4ovY5r5KwtjOU/XfTAHzzLuCmIeDuMWDvKHBwpMoN0WQzNtAaYSs0K4ZlOSAjGG9kPjCBRwZ0ABKEBJexYAZEAU3A7Oi1BeDym4EDnjQ1TwCGWMW8MXcKks0YOyZNlQOQjcgYIUHllEzYQ0ktm+r6oz8G4F4AXwXwRd8/kO9A0wB8y65KmPxgGJgcqYJTKYpTv2CCzyddQJRDOjKivn+Deh8BF8BnwBtaCUA+YYEyAU8h+c6Az9gNHHRmrgOgmDA3jHQ+iWupCeUAvNSrA9HNwqx+muk9nJVNg/CTfrmbAPwbgK8D+PcHkIibjob5o13A3XypWsAkG1cPA9PDFQDZM1id0i1KxsWfOrKnAFXlifCFFMMRcASigOcs2MGAIfE9iWXplS6On7UbmPaUUTXQrgsVMzcRj5Folg2V5ayUA5BWYKwOxKUafnosWjcJwk+7W5F2EKvlE3xcXaNYfiCYsGkA/smuqug6hcleAnAImPbO6YwRpMgjCAVAm/yQmKTv5hNsAf/i7SyNBSl2a8Qv/4/M1yF+BZSYlNQCnnVrpbC+mToAACAASURBVJcaI7sOSEY2NpaDXLqpR+vE/OVksDgImgGgghHoYJbTWc7oJtFWc65/cg2AYvh2ALsB3AzgVv95nS/f4QdsIkT9T3cBrGtITWZfC5hqtQHInsEGQn3UDDvEDEY/ICf7SxMOrAg8T+c00JGkvHGd2DABUYZIAONzCUDppCFhSukCBsLQrFtZe/IixYQpSyEoJoqnuPWrVRAubQh83HNlZB23z7j1ywmj6CIIqUPxw2Xeu9bx2jx10wz4Z7sqTYZaDD8EIDuoE3hMVEphWg66JIp90k0sBxBcy+iPIIaT1RtEsHS/yIAqw+VSNPWQfe5tlVEk8auXgVa5BUsEJuT5uoliAbE5AGotmIAjCPnR9xDG3TQernYAUupTdBGEFMf83OkApHG+XlvTAPwfuyrgSZOhas3u6cwTsUBVn2gTwyFMi8wjHZAA1M9fYGHDULJD1m8Cpa8fRxDad+l+Ykf/3XNvd11U+qiL39SxXevSsshdDFvgbI1O2AwAtRZMZzTBRuDFjxe1Xg8QEIB8yyj5yYIUxfQIkfkIRnmHCM712JoG4FsdgHHp3ACoMH2G6jM4lWzoQarSvwQ6MSB/vporVaFkh+mCLlpVR8Z+dqDZLoDOpHSiQeAFDkBjPrlgCHgCUaFifg67H/9uYjn4Ai1vpTERTAASBaoQJBAKeNqHlL6mwPDZYAOROag/EYRkPX34MwHIvzW9rQcA+TLpI22G7EcQKlJGsYIJhC6ClUMiXfBTbFUQAej6nPS/OuAl9pOOqIc2BLzg++3VmWgIEUz82cRuCAtLIHQQm0gO52uOAb22sC3JEWgRfPpZf2sQBQIgLydPEIFGwPEj8MlF2bSbsulghLftqsCXq9HGgHysznrGgi5qzTUTFH8FLhAUn3hIJwCN0HLncw37qaF2zoYvuKNivmQIuUNc7GvWt6sHNs26twA6vhyq8NEMAHlyntFrDCcQehyaPTl+FwAbXDcmAKMRThakEk8Q8kPg8SPL0qzLBl+A9QCgR6uZGs3vfHz8TtBZvkgGQrEPBVAUg2Sij50QAOjiVKI3saADJRm7dSLYWfSFDkCem/dhZeMy9pPY5QvSDYQyUJoDIK8qMezh3wY6fSL49PcGgCAA8pScJLIgAUYQEmz8RPA17StvGoBv39W24eREiBoNQSgWNI1HBkdgxJSw1AI+dFIbgOYmkjimQ1r6XXC3rAbCHycAgytohf8vsB/r2KRaRq7zpZ+D37HMX0s3DDcCUGLYaw53MJ4YUODzusqlGCQAOQCejuxA8UULUkxIwAmMAp8Wa3qkN/R9W+sBwOhIEPjk5SLr8HeKFbTQfb77csPIMHGl/4MPbReslPhNe4+MiTpi9AFGV4nI7MfvagNQLh/pfrYnDAS8aJQ42A2w4em2cAyWQUuJVQTGWLs1uL7DG9J1RjhA+jvYk4t3KXeMqijpzrud4At9z3XtP16yGfjKZmCGooYh1tZzvv8xXPFl4PoJYC97k9FlwZWD+Azi/deMZWeP13eQCGEyoERudChIjbb3mJYwH7V0QIKuCwj/gfMj0asn2I0FXRSHXfL/iRkNgLyeVj8ccMY//J1fyxzTAXT2+xoQViKYD/1hDqLxPiYxTgSvQrphphG97tz4Slqafnj7uk1kIQDZrvWTw8B3jwEW+RLxPgSiCERdPwPR7+wCPg/gulFgfruDkOMQkFc5x84e708JAMmCuRNBXi4TIg5CGRzGiBGE/D4E/C2r2vcAYJoify62i0aJSMhB+2IHoNwu0fkcjQ85pu3ack5nIBREqneYFyWLkAXIJHESe00Cyx5QyeL6F/tyEcDcrOW2n7fX8df0mME+/vQ/PQjhoy3gzo3AISYf80MQaQx1peH9wb7v2mrtmCBkIMMejp3jIJD1MsaxaMZ8v5N/67INAsB3BAYU4JL4DSo1J15AFPAEwuQHZJzkKfUAtOHLJSOQRWndBYQvCQA01cfnNopfsaCJaD2baBn79QjSTiOEP1EcawIpkq2kegBTNgHWEpOKF8Uwq2NRFPM4AqCf46/rA2U9/uVDvurB01zvAJpiiwOl3fEeciCGF+Ij11f+QkbSfMPfIzqw57mEFZ9Dl3Ps5HXWAYByHJAJKV7N+s0cCQQhwSlfm4lGZ0KB8C/rABgZUS6ZHITBSEhCowUYAAksF7cStWREyxRwtuPpOlgw+5s9sq6OaIJIIlUgEhA1edoTgHxa9HVw5jibZNF+j/9yGQA/7pbujZ4bwv2+cWB6tFo0NzYnkxFA+cvEAo43VBoEo2e+48EMXEOmD9F6xhCE8RwZEJ80VblKvDlmzwicfqy93/o+8K8TwB2jVSgW138FrJQTXBNlnJgmrjZwanow9CBP/rL9wF0jwAGWDtFyoN9PHutnIHT05mPXz93dMGQAPniJsjiBXiTbxDZFMF9NLUPQxKR5qezz1Y6/YZDH0D6GkdAkYJIvRalAdHAMmPZoYhb6NhDWvEyf/ma737CXN7R1ZC7hUbPgcFgqt/ZZjADnM1xqEVhYBpb4CUk5UsL7jQvj///5buDrLeCOEeD+YQchYwG9VIfyg1NaZszFiCH6DkRGLze5/dgk8IMWcMCjdCiCzR8od1B8OTwvJM8JEShFut1fzMhi+eRJr6LI7hYP2M/xVLwKNoZjUTwRMAQQmYyhWGQxsSADOflZ4kukj7PhZ75bETjBpkAGahMkcrGgwhsXeCyBHBj1wmOBQwvAwqKzoFeRV8ZaerjKYAuirmPY/o9X7q5Cyr7fAvYMAftCPGAEoYlBiVtFwLjtp2U4irj7yOANbi+crHyrfCbTquJV44O0F1FrwQGIMZFqdQDyP/gGSZ8TC0ZRRsOlVzzgasd/u+zpMByLehAfCgMQCDyGZJHFCCgLZ2f8mgI5qauEcVx9e5vACTgCTwEMWr5TdIpWKJb5MvrnoocDswvAPAG4VLGg6UKeqmi4iuDz4er30oX0FP7u5moMvIf7W8B+jwlUNAzFnlZCIhvGFRCeWzrgXSSIBreXTFZSgVLHAp4UHOFuociEEsn2PJwl/XEk0dzfSojeerFg1IOo5BKAveIBex1P67lgUzgWQaJwLAKRH04i14ItgDKEtGsRnWx49b2Vkk9wUefTGrKCF7R0JxZMqxN8cmPAxWcAcxGABKEAKPA5u9lEaAbCmKMI+sDN1X3z+ro24wEZFc0VEE64ABgT180PF9ZdBcDb6JpqcPtPk+1ACbmKjJnllwyuILunEAWjZHkBsrsRUnfD0qEiC5IJfyisgMhzWhcP2O14Ro4WbASgAMQJ48SJwchmBCDFa8qpyBbSP7OvU4PQ0p2W7+LSnSJUFOrI4V7w5IoBTQQTfJ6oTSYk2mQcpGRyH2syGjIF6EM3V/fM++C1CfwUExhCsmzCaQT43lZC3e1hBpEHh36XEqrB7Scmq5dV0XZxmV8WuDFzAF9iwhow9seAGoBcGtKjqAc+1l9rLb/1igesO55ysmCrC8ei6IxRMAKTWNBi6Xw98xNTFUi0jEcmpYgRAPhddpVi9OIEPP5cYD4CcLkCooHPwaW9kV+iwWrQHT8uA1fd3F7DFvgUHUP2k8jTiogAqLoxFpDgbMj9jXSuN7i9dLIdaxzBp5XVBMIMgFEnFAPKT9qPd6A9BIGI7MfPmf4U+40HzI8nWgq2PBxL4FEkjKJixGRRFyQQPzzd1iAUzCAQas1YOmAEoFjwkecDC/PAwhKw6CxIkCXwOdVJLxTobMjBdyIgfvimNvNJ7Evf4jWtdnRYD1YNGVuG93VWuWs4Jf+mlZCCZxwP/cnJ6mXVKk2+tK8lQQVHRTGc64SDAZB3Ey3JcxyACkToJx4wHl+YwqloGDICmYmTFgMQFBET8yyYzyAG/AfWX8mCGQg0BTRoHwt9KVaPE/HQ890AIfgWK+CRAaMRYnVdxHbhdY8Wslw1V93UDsmPIj9GxgiAioRRMIJNvoti+SW/Ikd0gwAU8+XxJcbGITJPDvI6XdCFREFSknTB83xka40H1PGF9dnycCxFwygkK0bASJQSVAbAYeD98xUAe5U3jKIwBosSgNsuABYogl3/IwgFPrOIg1Xc4ZrpAsSrvruykl2ucykapkMMh4CExD5DwJfWAYAxwk4MKPAJgOIjGSEGwuCakRhemw6Yv0UUwRf7L00L9pnsNx6Qx4feY4O8pDEcixOjsoTKKpMYjSFYYjOC8Eq3Wnnr0YYS+0Tmi2HysrPGLqwASNYzBnT2Mz2QD91laxLB0gs12GAh81cf/o/OcHyJ+qj0S/zxnhUZbSyYWaL8+Rq2S29wowiWkJPan4MvgrDDGAlRe7KIywDIgR3meEDWg9HbJgApNTkXo8o0i7oVgxnEgFr8F7jEdnU5GvqfJQKQKyEOPlsNIQvyvupAGHS/Okv4qv9oh+PHxMLk8ggBCRxvAmEN+AiEzz2iQfQBeNmkh4K52hJBKOaNe/FSLobLRXCz43rQnu2yi9oMSMDxs2jo8303ERz1wsCGZECF4kd3DwEYYwJjhoNlQrgIjlYodbBPrwMAZfEmyzcIv27gs6XDzC/IR1DOgA9a6DRz4wZAsZ+LYXvQYsHoD4ziOFklna6YD3+nnU6dZ7bGDAcBUImIAmEUw/zbJ1i/scGNDJiLXmle3RhQ+l/aq57gUQCWzwwBKPeLsZ/LFrGg/ShRXAe64Ajkv30kALAjF8R11Dy3K7KRwJcsUTaqWScARou3w/INVnCH+A36n8RvM3nB5XP4oD6DATBYwGb5ajlOLOh6X8JaBKRG77+7ygGYp1bn+V25/01AzBnwQ1ypanD7KWfA1QDYC3zJIj7KgOUzc9nFbetX/r+O5biwNhyX5uSEDr5o0xsJwLp8/m4A7GaJUv/j3/5+HQFYJ3oFPPkho/hNeqBcMkcB2BAA6XrxmMBkfFAci/m0JpwzXw0TXvXtzrz+PKc/Ml/ugzM9MDqCAbz/keVjjGcQA/YLvjoguo1mRslRI6RwfsiA5nqhL5D6nscF8gfTdfxpS+/hLzvWfzMQCoB1Fq/8b3VWaPIDZqsRV64DALsZHVHs1gEvsqFAeBSApQC8pHK90Oql4UEAyvCwNeGcBXNLOPMLftgZsI75ouUr9ousp2TEyIJ/sU4AzC1e+WIFshyAHPZREVwItrrD3wGAhibTYBhxVpe/xePyrNBuWaoNp3DgFwC81O+RAepK/a5Lfe51jxr7JwA83nPXYgq1asl0yX5N48+f4VEGLATlK1vAo5YB1gBSRmsM+NFE57lcfPD5pPFWCJImtyvGgGfOAacBYO59zFglgHgPefZsXV6/gPXBYeC0RVgyJNOGYuJjPka9eHWgjL9bWzhWk0/n/wPn+k8bgFNmgYcsVflZnBRmIShtJM/m7JGibGBoOIIez9wKPP4AcNpylfbNlGfdI+9NjBjz8JVzppckZuJ+dBw4aQ44drk6j1LIY9JkPD7P4s2lwVEGLHwJnncscNIh4Nh5YMsSsHm5ndOu1BGFThJ8/K6JrZtoslST2+XHA6ftB05ZAE5crgAups5TfaL6EF+UyIif3gAcOwtsXep82eIYY9JkXpMgMp/AeZQBC2b8OduBYw8C2+aALQvARgJwGZhY7swEzbNa88IRvAVO1qkF91J36DNOBE7eD2yfB45fqphLnevzdGeBKBfL8UX5/CZgyyyweRHYsFwxYHzRNK6oetSBMDLjUQAWTPqPngpsnQK2zgKbCMAlYMMSME4ALrcnR6JYQIwsoUnjpDRstOLy7cBJB4CHUGwuAtuW2nUDVH1EFUhycSwWjGD64mZg0xywcaECoI0z5P3X5P6nWlHdgHgUgAUAfOYOYMtBYNMssHEe2LgITBCADkIzSJZXpCOnIg25uPrhgnupO/TyhwLHHwSOmwW2LVSik2pCrDsQskzNIBGIpBdGI+VfNgMb5oENCxX4yPRjPj4xaJ0+WGeEHRXBDUz2Mx4FbDoIbJypADixUAFwzAFI8KUJChMV2SUaAGc1cE/xFJef3FYRti64nkqWDrqqEhbrsm5zvZCdPCd8nHzJOLZuABRz9hTHZwPL7LnLnoNMIY2VyaKcjtZLHOAbNgNPngKe4BacfGF1pnydD+hphQ/8XV5UiEueLGnDN1tWXj/3/4cTwAUzwGPcRcFJiDpPt3FLmf5vjwE2HAQ2zPrEzDv7OQg5OSM+ScYQy5Xbo8465u/ZfLTJ7fKHAdumKxVh8wKwealSE6inEoSy2MWCdbUHIghv3AqMzwHji9VLZuDzD8cXxxWZs5c7apmW0fMBnIHKn5X7d6I5npvRz94O7LgXuGIReJSb+Xl1tzqflybwRwqf9i97BQRWomWJQ7oZVFtJoqDX/b/oGODsvcBTATB9gsfGqmzdjtVz+G+PAyamgYmZCoDjFE2anCVg1CeJwOMnTRB/DmUINVkkgia3y08BtkwDW+YqAFJFMD1VAAw6XG61R31O9/fdrcDYPDDmY0zjc1UjivBuAMx1QdMB+WAYXU8dhEU16dOSkppbcHFSrng8MHwnsGMPcN5ypURHp2xMIa7zDz2z8Gn/kVe0YomO0wEwBYKujL7v/zHA6C3AxfOVh58g5AsZxx4fZM7sf3h6BcDxWWeGBZ+cMEFiwGEHHRnDzun7ONHs/djkRgBunql0VDOSHIDU3cxSD4aEajhFXS4H4S1bgVGN0V8we7E0Fh9jVDG6Obr1LJMRwn+kOCaTEYT0dsfqZHXl/p7PrLi9wIY7gO0H2yAgCAWCWCowKrYE8nMLn/a7PQn9X7zIJPPkCcK+758y7x7guNsB6l98gZjLLYet3Ay5n0sv4R+fCYxPA2MOwLEAQLIDPyP8uBg2cRYmzFweAYilKkn+OC8/Fdh0CNhEA4nGA40kd6FES13WLO8v1qHKAfh9B+DoYjU2Ak/js/8NAIwg7OUb7LCC+WAfB4CpBJoIiTRNRmS1l13kqWh3Adv2A8cdqqp1MB+aIOSxWv6pq5D2kkIAvt8rF7BLJksN/jMqfa7v+7/Ak4B3A6ceqpasKMq5akAmlLWY37t8ZW97PDB2qALg2BxgAFwANEGcnI5JcrDZRPlkaXL4u1KJUAfAjbTQ59x6dSvdLPXAgGYshZWR6JIRaXB/NwFI8C1WwLMXzMeSwLfcXuKrA2G+wrLCDcN/IIg4ERRn0qvyySAQX6mG1XuA4fuAbTOVwktRRr2MLCoQyvEZ/UY/WwjAj3jtFJZkU79g1ghkgEBf98+0Umb/3A2M3lkBl/fOcdMok2EjkZyv8773LAfgHDDKjwNwxEUw9yailpwdxBAEYhBbAuGzG3aKkQEJwAkCkOCjlb7Y6SYyf2UwlAS+vKYnAXjfNmDEX7DEfA5CjUcsnzvbu1nDtUMmCDkRZEEyGdlAk6G6lQTSa6m0MP6HuY73AxNTlcJLZ6WOJYC5/CNxLpHMgdKIKNl69Qvu6/75AjHOiTU87gKOOViJb748BKCWrnK/maTA+58AjM0Ao7PA6Lx/xBAupoYDC9okBRAmPdBZ47lNA/DhwMRsxX7mPgl+SrmK5EaRNRslXFQ9CKB9DkADn79cZtkHFkysJ103eBbqlh97DpmTQTYgk9VNxu+xYbXKU3lhFoJPOgdFGY+lPkgQxokkgF9Xgj4AvfoFs84eX4Ke9x9fIC+tRfDxvvniif358sSir2LCj5wNjBKAc8CIi2AxxLCzIAGY9L7AhGIKgpATw4l8wToB0JjPrfTkp+SLQbHrOqm5jNyajS6VCMIpApDAWwQ4LrGgXqzIfnq5cv0vN0ZXHTInME5GBNLb1DGdOYQsI7AfGKFjlgqve8wJwG4T+fuFAFytXzCLb+VgWnH/fIGYfc46Hs7iHC8ZkPcdXx4VfVXJw8+cA4wIgM6AHSLKWZCTESfLfg7WsIyRF3ckiRQ+HACXkwHptyP4KHrpJvKVGnOhRF9eBF9wE0mUEogz2wC+WGI/vVxiQQIxAs9+rmHA6E1YFYB8DJwQMZl0OrLZ++i7sfT8zroYHLS9df4RACWKxSZvLXzG/fQLZqk2gqn2/vUCUQ9UZaM9wDaPeSPrC4A5C1KV+NITKwCS/SiCR/jRBDlLmP7nHynsxno1IPwJSyRpbiMADXzuPDYfZfBTEoAmcuVQdiaW0zwXwQsCYDYmMaDA1wG8TBSvaoR0G77EcGSET6hjOvVApfRPAUN0zjr45JzVcSqiTxD+VeGzXku/4Nr7JwDJOkxFIwt6j6+RqUrlkO4bXzp1gCAAv04AzgLDDsBhKugLFUvQUhTwCEKbnKCw14HwJ9cDgGQ9WegRgDI8XEcVEDvAl7lVlglAgi+I4CR+Zf1mLGgMmDFhBGFfDCicRJFERviSABjLS7FC0MFKMU+07wOPE0kGvaoQgGvtF9z1/iODkwn3VWoEXxres5ib9xx1wZufBAwLgAQexbAD0JiQwJOuJBA68/H3Zhk6+3CifqqwWNMKN8wjKgbk6gWJgC+FMaBb5vJVmsUbV2vCqo3cRWZcCIACoax53+ulkqNd7iqOcU1WcC9cxEm5kQBUdZ+sTnSL/jEtTWngi21jhJNJBivZBukXvOL+yYBkcOqxKjJ4AGgxzMrBVwdAMmHrZOAYF2l6y/mwV6xD17zmWo6MbRyeWtOHwxJ91IIhr6rqZS70DPPLXDVUrfBwzHKr1EUp6/h0T/6L/GcCqslt4IhoTcwdAqDSs7I60WQH6R329pHuFyuXDJmEjuOSbdB+wSvuP5bGUjmsA5XoUvcvBXKKAQnApUdXwah0b8jXR2YzJTsC0ZHB33FL+2yiX3h/1YeD1fFZGT81g/H6yqkVa9YEpqMhTADle8erHA6t7Mh6j4ZBXdBGjFyO4CSIm9wGBiBvgqxwIAJQlXIyEJLyI/i0SkAG/FbhaEr6BXfcv+5dLKhCg4z1C1HEBJ8+BODQGZXfk/quAZC6ketAZEQCTWAU8PIJt0fgwHzZvVWNaKqi7JLOmtDWFy42g1FxH/XfqGkII0C+a0tnDkfsGxQjn3VPsk7tXmuy+Xp0JhtoJosAaFcUAJUYKiYJxcqHqKAH9rPlG2cMrmCUbMX9guMLpGTcCMKDlZGhMK8IPnPIn1X5PA2AwegwEEYmDGBMjOI5whGQP3NPBT7VJlRNaKvF4t2IWHbDErtDlSk1p4lJ7/zd246tglGZryIfrFhQ7pU8WCAX0ZENG+57U14Z4YrCeLrSxXdev6TfLwrbxT7znMrfKQXfHLQCnyvmRIv0Q3430ezMmL98P393G3wqz6am1NYzzoGn+svqRmTAU2citctqAX/2EI8F9ACEmLHXLZGoFxtSl2xyK2bAYwrj6Xr12+1noL/jUTCD9vvFrn6u0v1/nvGkaoVBAQi0eummMAuXQHMWJAA7gCixG8U0gFfcXdlBKk4Z6zELgAJfZEKrxpC1xOIl/+Sk7jkcdYlSco90y9+gK6vJrRiADD0piad7RuFo3udNCgft94vCdrGXn+tujgV3QAcHLcFnroelivHkchEL8ue0uQ74S3eubAITS3IQhKkMRjBMokgWG3L//2z3VSnP4VDgQWxUEEUxAZFHL0eR3HDfm3IRbDHkBfF0zy4EIKNhSvr9goGEBdvTz/MIYQLQdVsTwRTFDj5jQmdArRDYJQNDSs961R3tPhx5NXoVgoxleHnarjohgLec3D2HI492yQNvIwvqO9fJm9zKGbAwnu6FhaP5pFuMg/b7tTbpBdvTz68cz/zI8azVj8iAHTqgmFHXDUB89R2dtaC7tUGw4kDOgFb0R2wYRDGZ8g9O8aU4XwPOczhiwGlMjqqLWiFYGu570wADFsbTvaxg8nkow7E8nM/atfKzln6/1mS4YHv6BQ4+Z0BbqHcd0NwwYbVD3+1yWhXJxPBrbq8AqE/XApSqAxiBV2MZ/54DMOZwKE00rnDUWcR5KiV/brjtSAMALIyn+/mCyeehjIYp6fdrvVELth8RAClyHXxmhPi6r1m8FM0ucgk8+y4RHC1kAK/5XgW+2hZYofafWcPq1B5AqDqEYsQ3nepR2gqhV2yiol1COkD0C+aOaoGx4aL7DQCwMJ7uVwomn4fm7VrX2u/XAlELth+5sHPtN+l/Ap6sX2dCsZ/phZkIJgv9l++1wbcq+2WFv2NXIjNKAPzuw7MUAV8DTuynFIEsQy83RgTAhiv+NgBABaQOGE/3mwWTLwAqHnaQfr9GnwUbARgDNBUlkpzQboyYCyYDYdILdf0l4NduW9kGoa4geNdazLElKoA3Prx7DofiETtC6XvE7hGEzJlpcis3Qgrj6d5UOJoYDcMglrX2+y0NPtl5UZUjkfx/Hqbecoe0OZzdF1gHQrln9Bhee4s3f3Zxm4MvAk9VSFdUIw0i+Q2PaBtISiBSSFgCYMjMW00MP7pwvvLDmwFgQTzdHxcOSGvBg/b7ZRZByWYAlOERluKM3Ra9CKWc0q73dTBhMFT4ZwIw9l5Lrpes+HjeBiGCUOKXeuBvPcKTiEIOR0f+RhDBMYi0Lhea4GTaa5NbOQAVDzhgPB1La5RssV3rIP1+7yy5OAADoAchEHBkFbKfGRpiweAPtMs5IFNokyOGk/7rAYC9OhBFwNXVY1at5tftCBHaWVS2AJdEcEinrDNC+Lumiyc1B8AB4+muLARAXTDCWvr93lR4/Z0Xt6ODFQkj8WtumEwHTKDLQejAfN3uds/dfjoQdatGLxb8jQBAYz6/boxiFgAVudzNIc2/s3xLk1szAORoB4yn+2DhaATAGJCtbpkCYq9+v4V+aBgAQ4i66XtaC85YkDog/zdZvzUgfN1N7a633Xqv6fe9msDIHfNaB6Ay2JRE1AHAEDIfI5nzZCLeN4Nbm9yaA+CA8XSsul6yqV0rJ2WQfr+splCyCYBR/HJyKX4phs0PKBZ0lqOYTpvniAiUAmAd+HKjo1cvDjHgr+3wPJQsVCymUZrPMuRsRBDG4AQCsunyJtFGHwAAIABJREFUcc0BUJlxQoH62q8ST8cggpKNAFRGwCD9fkuvbwAkyGgJE3C+Nz1P1q9/T3F1EZBxvZh50s6AEYC5yyUHXt5/Q8zI5/KrAmAIkkipkyGPYwXz1aRT8v5ZO6jJrRyAvKOvNXlLazsXs9bo/ztc29Pohgotp5J49Rcj/pzfIwGS//3OM4CNd1dpntQpFUmjEH4LYIgnyn/OLjL8FeDGhwJbNgFjI8DIEDA8BAy1PFK7FSKf43cNKrvHx+8C/vmxwMgmYHgEaA35J0StpvvzL/nP8RbLAfhyT207TChgDRiu/ZL9DsfWNABvYzbhCDBKoBAk/pEobGWTqp819hzQ1/0k0PoaMDEJbJjxVZFgDad0SaUO5LksWVj+XScDmw5UEUDJ6U4d0nVbC91S3ovfVHp5al64cgC+k7mZAP768KCA0WD3A/ieLz090CDceVmlAuhBljLgrfcAw6PAyDAwPFwBkCAbItM4a/FiNtERjBl76W9ffD2AbwJDdwFj+6syImRXrd5Y2FjIYcnzWPLEqnsfC0zsr6qBMQmfIDR/pyJ6xMhKyMrSDiKD2xja6TADTt0/AGAs1KcAUCFrOLF6tbtiRVFavT/wuMCa7MfVTlH098YBeBcwNAIMEYAUlS4uBULOmK3LCnwOPANlEIOSoF9+C4DvVoWXhvdWZVOYqWgi3vOXDUQhgieB0EElViMYJ08HxqeqnG8D4IIDkAzo51DKQQJvBKUmKACzbM4+5hUivwrgiwC4LzvjmgCh6nBcgiMTcv9Abo0D8E6g5eCjfpUA6AxoQIzgi8ALmWwC4z//DxcPPwBak8DQFDB8yJPpPZHeGCyC0KN5DFCByfh9/+OAsekKgEzCTwD047X0SCPM1IYQjCv2E/MJoGVwUUQoPboq0MdqkWVn7RtDDMahB4g+P6qhXFpjVtkDtRGA2nKjos7IyOyHFUbIrXe0FXsTuzIYfNb4O2M3ATGIYQOmPn6hG6gi3eUkQQAeAIYOAUOzALMVh2pAlESqGFBAXAYOMQVjxll03iO/yYKRAT0FQXkwZkjp1pz51LO2XAT3KtD3AIAwj4Wg05kfiuUHYlsXAJLVnP0INLM0OYFx78AzcRySeTsw2AJueI+Dj2Fne4EWKz5MA0MzDkCCkAByUWqsJzarEanzj2zXwjEGFHuGY+pYsMojzZL1G9EBexXou339IRBrC3lJGmNDuSHX+w7WC4Cm6wWxm8DngLTImgC8pBcGBuTXf/1fXnyTugnFwxTQOgi0CECyIFlsvvJfEnh0mhsYI/s5uxFYi1xZof7oOqSAawwYjRGBzYGXbtWXaCIrlvHUagX6SP/ruMVYCEbEqECXAMjfree2HgA0ESur1/0vtnNwGSsG0RsZME20/+/XWH6Mugk/yngPAGy5GDYALjiIHIgRUIrsZjM7Ax+BSx1S4pfffQVIep8dL7dMDsTGjJB+CvQxTHmdtrw4l0CovFruC2NOe975egDQsCXRK/eK634JhBK90q2C7I1i+Gt0jxF40k1cPJAB7UP2m3MGJAAFQrGei9iUTH9yBUDTHfU3B5+BOIKQ43BWtNtPcWIOzEZE8FoK9K0DCGNxLi3FqaKA9gTgeoFwPQAoI0OulWT11oEwiFz7cwbErzNxWtEYBB+VY76Vh4DWrH8IOoGQ7Ocg1CqMRLPltmxvs1/SHaP4dcAJePYyyUCRIzrTB8tE8FoL9DUMwl61kQQ87Rmy2PS2rgB0a1ci18RudEJH57OsY02y/+83/sZdBKr4FXQTApBvprGgQCg9UEAM+h9F6ugJDkC3gJPBEvRGrYoYCBX9IxEcS5K4i6cZAHIw8oXQ4mLBb35YH5d7OekadtTV1UZSjaEIPH4nQzYNwgjAHNwDuWGYpZc7lzPfX1cQur5oBorfzDf+zi0yVTuSkuxBI2Q+PhQDIUEnMLo1TBCZLufGw/ixbQa0KB8CTODjPohdY78IQmfDjmW7Yo/doAX6GqIiAtDHaYswSmeMubV81kp11L6hy2PdAcgblfslOKC1IiKRmyRxZgV/8++DS8BFrxXi5Hd/U6MeSKdqEsEKhpBRsgRMbAtuG4KU/+9ry5brzP/lPVMv1EPOQegharrVcgZUhVHFxNPcp9VFtlOWkL437C0WABWypFRGsV0sb5Hn2zYBwvUGoKl10v1knDgo0y7XA8Pfv0UACnjaK33Co9gJQAOe64FkNvtZAHQdjz9v2Nz2GSa3jYej2W3KGuZ9ixGdIVSoKT13B2s5AHkGheST6qn0erHv5AIgAAU+LVfw/wq3CEAV7clBKDDGZG9/5oVXx/oyYARczcqH5GyH8eFplTawFvAtrtXLGpNrQDGbejupB3omlIHQGc/ErzOcGSRs8zrhAbbuL1Tco/JfbLlNwHOmi2kIcs3owbdwNpYtynDQhsFcgvuG9/YapGFvYX22zZcAU0/GwA2LJ/4AmGF9mwEbBu98Y3cMF+uAGQCj2HVp3BbPuo3IlqxAy5wHAq4OfARmEBXGfNIBa0BIsG0ecwC67merHgRpZLwocrWaovuTxew/V0txJQ2DWeae3WAGbdhb2DB4+wRw7w5g8Qpv88liyGtoWHzMi4C9fAEHbBi8kwUKu2xNAdBxaGBLbJdZux1LwAGECYAEm6wyfpelJrEgFnRDxESwgyUxIUsVMwjVy5AYO0bG89Auu1/5BF38KqjBHlUAYXsteNCGwTeWNuwtk4JMkrlzGNizA1hm69g1Nix+zDOBW0aBeRZZGqBh8M4emfWNADDT+zqMjQyESdQFHfDbZECCLRgdHeCTe8CBaKJY1rDnBRCIAuGW4TYAZeFG8ZuMkGiQ1IEwGCJtHZBmy1obBsvVMnDD3jIAerti3LEBOMjGcOpa3WfD4ic9t6oveDtLfw7QMHjnH6wPAybW6yaG4+8D4HIQfvtDIVtLejpBFsVvUI7NIBHw3DUjRzL3rDVtsYPOkAScuX3coNDynT2VYJCkn+PjqvUD8hVbS8NgjphGxcANe8sAGNoVY/824BCBtIaGxRe8pLKZdpMkTvXiJ2toGHzSNHDPScAyq3er4qPyGaNc7JCRXWLT2TjwGmCOeQashq6+qSpZmp8vojQpheF58ncdZVjLnjWPHr4VWKTKxrHGUqq97qXu3jp0wPy+eEC/DYNZsZAO6IEb9pY9lNCuGPcNV830ZmkM9dmw+OKfbdcXvJMPdY0Ng0/7GnDXKcDMccBS7MwdKz8KCAKQIgY0MWGCtr4TOHAasMwOkTqf6unyuLykfd254nkb7qsw/iVg7jhgmSX31Vpd9yRHeLx+zRhjEGRbB6wDYT8NdymyubzDzCCGfpMJWfSRYfr9HP/aMgBm7YoxNQHMbQHm+ID6aFh8yS93tAvGQb7da2gYfPoXgbtPAqaPA+a3AEubgGU1RM6B060fgkRoCzj+TcD+04CFE4BldZdRc4/YxlxgjJMewSiwN1zWfsOngdljq3EmY08vm5i/7j5yIMqpvupKyGoNg9lngYosl9wY/0dZdrMzYl8Ne8sAWNOu2MA3zw/F2CoNiy99XbvftrcLriz6PhsGn3U9cM9xMODObQYWCMANwPJ49UliuW6SaqqBn/gGYP8pwPyJwNIxwDK76ahDeN6uXYCuYyABkEza4LbpY5WEWdSLxjF26/dQB0SJ6r4ByAN6NQxmkWcqrnQ00x1DEDJFjR8CcNWGvWVPp6ZdMQ6OVOCb3wAscPJ6NCy+7PerkP5Q3tBY1PrT9tEw+JwbgPu2AlNbgVkCcCOwtAFYcgAuiwWlM/XqDjMEbP9t4MB2YO54YJFMo/5gHIcALV1TRZ17FXOhPtvgtvkqf9H4kvHDlyKK4l6VzvVSBF22uwjOb7pbw+CfcwBSkyeFEHAUx/yw9JTyEbo27C17Ol3aFWNuAlgIn9QxO2tYfNlbK6MvaxeMRYquvL9rTcPgJ30TuH8LcHAzMOugX3QALo21WXBZLEHwRF1OgHS2eOgbgIPHA7PHAezNu7QFWFZ7JnXJ5rnqxHEulvlzwyVNN3+wern5Yovl7SXLGwvn4riLWO4fgMRJXcPd/+pmOymELEhRzBxJAo9gVL4kwVnbsLccgHEpWi3epocCAMeBRU5eTcPiy/6qtl0wpvhA+2gYfO7NwOQm4OBGYGaDs+5ExYDGgqP+ccAkINaVpB8GTv4d4OBxwNw2YGFrxYCmV0YxLNYheCXau7EhV3ga3Lb8g4+R45uoGLADgHWqhsBXA8K1AZADyRvuvtkBSArh+i9DsQhCOtf0UUgW/7aiYW/Z0+nRrhizoxXwFhyAi5y4rGHxU66qAFhT3rDSIVdpGHzencDejcDBDcDsBDBP1uX1CMJRwFiQIBzxieL3KIY1YW5MPOxNwLRb8gs0aghAss1GZ1O+SFHsdRPt0i/PLHu++dFb/x4mXfhcbWxhfCtYMFr/uWvKxfDaAcg7ipPCvFOVpuo3HrCjYW/ZA+rRrti6TS6MVQ+L4NPH2nx698GnXF0BsKa8Iab4dFZpGHz+JLBvApieqAA4J8CPOQuOBBAOV0CUYbIskRkAecrvAdNbXc/aDCxSpyT4CEIyTgRgneiLIp3nP6fs+a4A4N8B8/48CUC+ZGJA29fpuLmxJW+5h5kNFg2jiWHSi0r0Uv4pCoZsxw8DUfnhd4Vk0XGdGvaWPaBV2hVjdjgA0BlpkQ/K9bmn/HOVqtClvKEBqlfD4AtmgP3jDsBxB6DA7tdbcvYzJvQJkii2n4NOeMpbgJktbYPGACiF3wFoEx1ZMNe/4jnPLXu+KwD4t/5SO/iMBcXuesHylyACMBPDgzGg7opM8mEHIGdwrfGA1rC37AH10a64Yr4APvvOSdwEPOVbKxu+K2pdKRTmdI3dqkPPVgbSTBGAY8AsATjWniBdx0QxJylOFCcr6HBiw1P/CDgU3EgEIMW52M8YkLolQRddIN1AyKWiBretf9MJQN6HsaCPxe4rvgDdHOcOxDIAcmDFDXvLnk4f7Yqt63gEIB/Yoj+4p9xaAbBHeUPM8qF2aRh84QQwNQYcGgdmx4C50WqCFngNsgSvQ+Dxu4MuiawhwIAXVk1O+e/A7CZgThY1dcno1nHL2oDIyZULpBsAFTBZ9pjT0QQgn2V6ufRicS8QRgbs5ZYpEsENDejBfpoLrwAOjgIzZMBRZ0AHoUC+SOA56xJwNlEyTFw5FxBPeWvlzpnbANCdQ1eSGTRybMuydgMggVBsKmtYoC6Mt8znZxsZMLzAxoAOvsh+ydDqtXx4FIDl8L/omQ7A0QqA82S/ERdTI22mNfaTuBIIxR4BhKe+y61punQC+MytI/Zz/c9EuvyBeetLAfGZ5WOMZ9j2/gqABB1fMLsHAVBqhfTcyH5d9MByEdzs+B50Z7voGZX+NzNSsd8cwUcG5ASRKYbdHRNYwhhDIHRgGmO0gFP+HJh15jOXjnyKblVT5Cbfoq+yJOszF8P8+VnNPlICkMAzds/YLxlYznrJwIpO6egTPMqA5ZNDAB6iCCYAyYBcBqTRQ0e4630SxZyQJQIvMJ8mSeLrYe+p/GzGfnTpEIBy6US/out+K1wg+brs88rHmDOgAVCMnrEfxxMte1Mt6j7u9zzKgIXzczEBOJIB0BnCJoqgIfDEhM58SWzJEPGJe9hfVH42un/Mfxl9bgSiBySIBWnAJBDGEDAB8QWFA8wO3/a+wH4+rg4RLPYLul8tCI8CsJmJMQAOuwFC9qMI9g9Z0CxhZz65K0wfFBPqu7PEyVdWAOTHVlTcpxhXHZLz1w0ZA6EDLhkCskRf0sw4dRYC0PQ/vVSRAYPo7QCdj7GqVOSMeBSAzUzMxZcDMwLgcKX/zbv45SQlHXDIgagJc+bjZBqAWhUoH/Y+B2D0J7rFa6LYDRmzomsAaOeKqxEvbWacHQB08JkRIteSXiSBLYJOLB+X4xrzAzY7vgfd2S4RAKkDDgPzNEAIxMASSWF38WsgkuXLyXTRSRCe/DduSZMBMwe6ObTd8JBj24Aot07uDObPP9XsIzUGFPs5+JJ/M6oT4buxHv9X7BeY8KgOWDg/Z58GTC9Xq5FxTXOw9c3Cm6k5fPcjgbHbgAlvVG2tH1T3Oavoq6BlniZ+12n5u/2sDbOvasqoFg8x2Lnbcd1GdhSAhXN+7qMrAC4sA8sORJ6yHwD28z+Ft4fdv8UyqUDrDmCEBcpZ39kLS6aq9l4D2rLb/KYsFTPWdfbvh86vQu2s1K/K+zIjTsXIVQ9a59Egs4Y6sZfIA/EcSp/jEXv8BWcAhxaA+SVgSQAkGAMICcwVlNLlqTc9Gbv/HAA7MrL4+f1VlXwrUq7SvCoyGcrrWpGhuur2fNGYwM8YT67hT3s1LaZvqn5MLM0bzmHMmIFSgdFNj/mIBct63NhFZwEzDsBFgpDPeanNgATfCtGsX9TIKwNrg9tuVkhlng7TI/YArX1VkXKrEe1l2SynN1RCsFJsqnQv3UIMxhwIRjU5AGN9QUteVz3BUAvahuNgjC3HxLAND7nBp/cgONXF5wCz8xUDGgCjKPbvevlzcKUHH2ag6cnYzepYBB9Zi2FxDJdjoXJv1WDFiLJ6MKqKZUzoQFTfj2HmwTKcTpVWvcxHKm6kKgoORAEvVclPD6NdzLXpMT8IYNPcLV7yJGB2AVhYrAC4SNA5AxKM9ryDPE5fs6eeVKWGZ2M3S3MQfEyJUKV8L1ZpJXpVJ9pLilmlAxWkVJHKwIhjjD9TtVXVm1HdOy/pJiaMFRWM+bo0rWl4yM1N7oPhTJecC8wRgAttBjQWdBBGESwgSiV0Pb9DRgu0TY19N+M1mRKh8niqFx3rRDsLqjgl9yaGXT80vcL1wnE252PAZCzAHQCoiqoW3yYWFIt664fUpKaREr1NPakH6XkuOQ+YDwy4FMSwgU8GSRSz0UJx3Vx/5vFNbrs/EiLRY+v4ACITww6iJEodQKwBIyBRv9vwhKzUW6z66TUGEwhDS3ezqusAyNxnJn8xa1KRPSFts9YfFB/QDZcAm78CnDBT5U8rCqjfc3yh8Gn/hGd/MsKf1+QzYJ4891Jye13iy1cAE9cDJ+6FpYrEkidxDN3OtXR+FwBGMezoMmxJLOumAuD4J4rxJrfdH/XCoLGFVKiUbw+LAPQqWWaMMLrd6/+JycSIm85w9lOpt1j1MwAwFTiqAWEUxeYH5ENn/jInUVHeMXQ/f/jRePvCa4DhTwLHfBc4frGqqaNJzLPw6iZxV+HTplFGvZrXZT45N39+HW3TujlZv8D6fp8HRq8Dts9XIOR5YtakgBgdrrrt5Qsq8Ssd0BhQ4HMwmVitAWHAY/LbLDQNQDaTVJ8Q6W4qVB51OOqDZDPVB3TLOBepW5jmqaLbec3jGgBGMSxvvemDYkQ9GoKF1ShUCSKCqBeQrvmfVZPC1keBjXcCmw911tTJ8q5XgOLaQgA+x/OdWA2EGZ98gbjleTHdQHQN+2iwls3nK3/Zhj3VeQhovYzdxmArSwQgDRA3QiSCJUrTnjfl4KozRCSCCeYmt90EoJJbVCk/1+FiCwFZxLk4dRfLFia6x8LbYkD9v9cXtLG6+O4AYQRfrgPygVIcqyhTXcWFOJH8fh3rz7EKwnUArq8mcGwK2MCC1i7WY7Zenh56feHT/jE3yliE4TZncd636gPFCKWavGhcRx2J+cvs9MlSw0Ty3cCm+c7n0G0MExdW4BMIbTXE9UCynvyCCX+Ovm4gbByA/xisVgJPpXrzLj4EoRJjJIZrWHArS9iprK+KcefgiyB0XVKGjOmCmW9xhRVMUSyRFnNeFGEdI2q+/HFXclkp9WsAbgTG9wGj08CI64WxRk/OTDcUAvBHXSLQxcVCDMQSWbzv+1e7WVbz+k5w2tJtsbcCYV6WJY7hmAsDA7r1Sz3OgOgoM+KTOJbcjSI5yGIaNE1uuwlAAU/MF+tF5/0sIghVLdVdM2S0bSzHx2Mi+FTxXf8X925NC4BycK8QwfmgVX1LlcFiykEMcL2BndJJ7aQfijKfxLGDwAhByM7aC5U4qwPzNwufNnNuOH4VZaCPlPo2AahqFqoPVFc14ga2m+WEEL0cAz9kdPrOmMu8r1o/rTsXz7f9oswFs+jO6LAqkvC3Ggg5Fg6mwW03CUI6X12h8lyfcz3QHqr3DIl64DbqaQKc9mI87QXACD6vpJqY0EVxz2CEyCI5eMSGX2e7VtI5J4yTRyZhscrvt1nQuivOAaNLlYESwcySgiVbr37Bfd0/u31yEgg2FVaiPCeVOguqAfGov0iR0R9JABJ0bnwk9nMxw+fOh55EbgRhzozrBUA1polN9CLwok5HEEUQBjFMQB7D+j656PW+IrJ8O/bBCo4sGFdGejqiyYCx3mKe9/JtTiBvmI5OFiTisg9LtJFF7gZGDrUbHKs79+hyu5hSaUvh1foFr3r/6vZJCiXgCDwVVFJ7MVmRLsrGltuFCc68yFdACMDAflwR4QM3HPoKgIExt4gz42SuaQb8hBOE2oZmlu+KFlKR3QSssMJxDPWbbjpfLoJrxG8CYT8MKGZSVTCxYFTIb84nkCxCIPLDiby30gXFghaF4c2ReR466Uu2fvoFr3r/fKAEFxvpqMcd9yonIrkuK5LLV7MVCM+/uDJCyIC2J8a0z1iwqyESgMl15Sa33QKgmtPEBnp11mwuXgO70Ud4DHWzfgDYC3zBEOk7HlA6XKyHQzb8HgGoCSQLqsxorIy1Bxie7Wx0rFaf+wr9Xv32C+56/7HbJ5VHtRYT+GJrsehHcya57PyKAQk6+vBkBZPpjPEExlwU59awg3C24W6KBsC6tqHR+MidyVG3i3rdAnAsH2T093XT+zLr197MTA80h3SfsZP2UqpCrPQ46oF317VrpeiKXTJ9MhMLkgGdCacKG/mupV9w1/vnwyGgCDCKWzJe3lqsyzLWZWe6/kc/oKzgKH4jC7oolhdC4jiuzM0WPo+cPQ2AsX1obFCTO5Jzn566PwbReiwnfTWjI4KvDoh1juh+aT+WKSYD3i8Aql2rJk+VsVQly5kkddv2FvHT61icqO7Fr71/IkLNXOi0FQjV0046oBy6wZ922Q95ICqDEaL4XWw3COcf9Mw73DFB9AqE6wZAAS8XuzGQIDKf+oVkqxt00ttAc+YT0PJ9qRFSB8xoye5Xu1ZVeCSgCLbYLVNswoncHxoeLwCzBGjBNki/4BX3z9lXgUCyIIGmhova83cRgO5Te9yLgP3MfmsBS8xs8/U67ePQOqy9umBUruDchqo8sHSd3PMfT5ifo+ack8eFHI6QEcnT5GvdOnVdXof+ptJ+BVPWceiaRHA8Us/nkACo8mzqlqmWrbFDppT5A5UIZm7CPA2Vgm3QfsEd909kKIqB1qJAKCBG8ZstZz3xHOAAiwmpDIdng1maZQAkZzsHZ537YfQrwNyxoQ+HakrnS0h1mUA1C96TdJTmORyhC3oeqdwROi+GDhkFI6bYNrcNDEDeAkXwQizPRpmnIs3OdqZPSaRFUcbchHlgie6agq2kX7Dd/+d8lUJVXuUzk8ERmS+2vfd4uvN2VOV5rSwb0y3JhgIh9wJeN3YMQCIgR78Q+nDEVYBYZUrUpbXFnM7COSdf7N4IPvtDnT2BY/h8Chh10MXQeYGS+7GGjaQiABpuNIFiECnzdWJMIUHcazLptC7YivsF8/7FgLFMqpiQL5TuNbKfA/DC46rqqAbAwIKWK+timRUBEiNGsOQsyQm+Gpjd4n046hbT84KPuYjOmHHyp92gcgDS2OoIuVIeh/xyUkaVwyEWdLrewHE3uBUDcKIwnq40HpDXL+n3CzbaKdguel5VnFJl2awaghLQBTzteZ0cjLq2A2n0M6EPh2pC57Wg41poLzZsAZNso0Hw6eVR/J8bF9YjWGmVCpGKwQLBRCcrbiSxNLgVAxCF8XSl8YDHHFPW7xeFBRwv/rGqOKUBkODzqgdWPYAM53vTASMQu4Bx9J+69OHIF+N71F1O1gUB+AsBfFqKC+4Wi4BWX+CYgOTAU36wdMVNVKka3MoBWBhPxyiuko3xkSX9fvGMkqsDlzzHC1N6SQ4DoINOe7KelWWTheziObeKCdARApD1AdVnRH048gKUAmAEYi6Oh4DJV4VoGDWqjq4XLbO5o1jBoimEPhPJmwu9FvnTLgdgYTwd2wyXbMyRKen3i2eXXB245FlVYUpVxUpGiLtmGBlrTEhVUwV8dEkVKAq3MHJ1uzRbRx+OOgDWFX6MsXJU/36lJoEoA2AKvw8+uwTEDIBbStdOs8ddDsDCeDom7ZdszBIs6fcL9ror2C75US9IxJJsEsHdGFBil4yYuUwknofJgF4XcEUfjrz+X7fKo4EJJ//PkMORO6FrVjQMeL5kJhZMMXzLwNZCt1nzDFgYT8cQwpLt4hDON0i/X7ys5OrAJVe0S/ISgFY7j9ZvnQ7I3+lyqpYaL98CWp/N+nDkZdhi6bW8An1kP3fRTLKVWlwF6RZCH2L4zDDR0k1IqeTNb2OQSYNbOQMWxtMxeqtkY6I+ny9VEz6btfb7xc+XXB249AoXv85+tIBVgJJ6n4lf6oV+mfjdDJNMH0wAVFX90GMk1f5TxlS3Fggh92DyN0IORy5665KIfCktsl+K3VsGtpVOWOMiuDCerlSnjQ2rB+n3C+pIBdulz8wqonrNPLKgwKaC5B3s53qhXVq6oDNg6sOhqvqhEr3V2VNLBjmnSSNdrOLJ1zkAu6VPRjFcFz4fXDJ8i45hG94Gt3IGjOFYA8TTlQZ/qGH1oP1+8ZtlT1MAtHK8mQg25zOZUSCLIliWcbw8wfW5Ln04ssqnHX04euiCk6/3de66MPpuAQVZAEFkw2MKFw6a1wEL4+lSBvmAOMhD8vkOkFX77feLNw14YT/ssmc4A6oOdHBEkwXlgjH2k4Nal6wB4fIuX9LzZjAmorNeHMo5Tc0OewHwDTUh9HXxfGJsYkAbAAAgAElEQVS/uvCpoAcew6zBBrdyBlQwwoDxdLZWXLDFkHyF8xGE/fb7xR8XXByAAVC1oB18HQYIT+8uGfP75SCUs1o64he8v4j6cIQ+IqkPhxrBCHjdjBH6AblQkAeY1ondukSiELmsUPpjbyp7XuvDgAXxdNZVvWCLIfmKg6Bbhrjup98v3lVwcQLw8gqA5v9zC9jErutltg8gMxDWWMBaMVkmANWFyEV6R0uH2I1IzW7ypbkQOTP5f2ch9KsFkwp0kQlDAOmxzHpscGuGAQvi6VD4RgmAg/b7xZVlT5MATNXwqQc6KGwf2U2uGV2uzg3D4ua7fDnPwZcKgIdq9GaIBPZb0YdD7hgyIFWMXiH0eQ5vXS5HcMkc++9lz2t9GLAgns7KxxZsCkgdtN8vWD+vYDMAUpcja7lOR9eLVcIP4tcuob/3AOHCdW02VTX62ApB4Mv1v24gnPy9HiH03fJ366KYHYTHsgBBg1s5AxbG0+HLZaOp65i+ln6/YM5EwdYBwGj1cmUkE7+8THLNdAHhwrUOXtcrO/pwhF4cct2oN68BMDCfmsJM/n6PEPoYPp8bH3kCkbtjji2tJJA962YAWBBPZ0WBCrbYsFoOf9pDAiENk179fkuvf9nTXewKcBSjsn7ldonWbgQpx+26otaLIwAlfi2QQSJY3Yjy5i9dmsFM/oEDMM/Z7Uf0RiYUA7J+ToNbOQC3e0WBBm9qLad6HICG1ZK1XB5PoxnuOOIcxSXe/Of8xHV/P+FpwN47gKUpYHmuSve0pKZgCKSq5wqniWE1WZz/xouBm74KTMwBI17lVBXwtWSs+8/vL45Ff3vhpcAnvwos8d48DZX3M2hx9XIAnu0IIO0chu35AOgLL0yuG/jOmwbg028G/mNz1YWdETbm4I5BrFlov+EtD2wIo7l+Atg8D2xY7iw3V5diEqO54mnj6XdMAYcU+6gon7A3NSO2qFjlyZYDkAX6uD5Iam44YaUfVNDNxaJcLIPXcGGpfi6PnZdVD1wPspQBX/wl4OaNwN6Jqg+xwrxslcVFuYJblehkcYYZGPS3L20BxueBcS8nwg5H5kZkx6TQSbXFZcCQKadx5Cz5mPurAFxrRaa17pAR2PFC+ElSHKQ/0QjQcgCyGyM9v3SnsDBRJgL6msWCf6IfWeUJac8UFlpY8500DcCfvgb43hiwZwyYVhd2D/VSrKGAmIDnBkiafEcN9cprHgKMzgNjS1V7rRjRlceyrqif6KAkMgXIM+6tAnDl+zSL36O9+U8p9jGHQo285/2XA/AnXeNnKAorDXH/AILwbSvLEz6Ql2+cAf/3XcCdw8DkKHBwpOpFbE2wadzIdyh3jjNQirYWEwYq+/zJwMh8pf+xKNSwM6DZMmzNRRbM2K+2Ii6TlFrAWfd5V3i/F7IgT2LBF5LbIdkqxLPWvtzlAGQ3RpU3Y7AiixMxLOUB2t7pKQ8M0qCTnp8HkojJgNqaMEJesQv4AR3Iw8DB4QqAs+6SWRiqgJgY0HVDAdBA4Ba4xN7ndlSFAAjAYX4IPO5dBDMAdS2i+Jx7XTf1eEdTDfgAQnR34p/wQkRmjNAoByDT/ugFphXAmjAEn8qaPQAgZCs0lSckCNmVigEbFMsPBBE3DcBX7gLuawH7hoAD7EM8DMw48AhATrjtQwiXoqkTEwWd7LOneXNCbz6Tiq/TInb2M8ZzIFrTQbGiy92oGz7pXl/7jvdAJnb2470IbB3T77Sai+hyAP5voTqW6sKwFAc/TAdc5+3dvcsTrvPVYSK4SQb8xV3+6IaAqSHg0FDVh3iOIFTIFxtit9orL5Z/LD1Q4s+B8OnHVuXwhhdd5DoLGsgCCJ04q66X/Ju/vSaeAxDPvbdtmdtKDV90gVEPIl/xySkviOhmAEjrlzSkwj40SlQZYZ39I+8JBMx8mZryhOsKwqYB+KpdVSDFvhYwPVR9BD7uyX4SwRS59nNI+bRck/DzJ05v12M0nY8fAk8iWL5BB5qASPGRCi8EVjzv3mqpkC9ACrrwhKukB67GhpqRRowQMqCiYbj8oOoHeUWpdYIBAUj8c8WjrjyhNIJ1unzjDPjqXdUjJAAP8TMEzLYq9uOHICQALe/EwWe+QgddAqCzzD8+vgIgg0qp+5nYjaDzCgjmnCYone0klqP4JSgvvK+6LoFPoFMlkPGh+0rPWta4RHTNJJQz4M8EAGoNTPVU8opS64CC9zoAWTFChcq7lCdch6s3L4J/2QFIEBKA1P9mHIBmhPh3Ai354RyAAmWsR/PRs6vOR8Z8FMPS97yxtIlYgVB/I7jC0rIKSfLXF1EEB+BFFjQ3jCLA49OWsRTTEPzvzQEwry7VrZ5KwzAQAPssT9jw1dcHgCrORQCS/bgn+1HsCYQSveaHkzvGv1scgU/6R55Y1YIxhvOm1EZekQWl8wVDxJgwc88QiJc6AKX/meHDawX9z16M/Em7bO8Q08GBP/jEkAEVjMBoAFWXUjRA3KtNwOBXW3EkAZhrALktpC6lKtTV4OU7RHB+3kHWgv/zrnYZl2kCkF4uF8MGQGc+MqEYUCA0n1tkwxbw4ScHAHr71Q7W4++c8czwcBAmHVB/c7Bcek9b3FuwbdD/kjGWgzJjQ3thGmVA3jhfOyU+RxB6FamOFp8NrhsTgLy8Cpzm5QlVptAU+6CiNgXCaIQ0BcDYV8b0P4pi30vfIxD5+w72C9aliegW8MHzqrmh/meuFhYi0pKbs6D9fsh/n1XFMrYMbPgUByCZz6J+uEknDA9AornWFRb01WZEsACoHhOqyC7wdetT0QAK2KqOb5MCUvPyhLE0oQxzqaYNXL5xBvyVXe12vByLADjXAvgxBvSPGFGMIjCmJbEW8HfntxtQmxT0cmxp9UPAdKAZ1upA6EB7qgDo6oCUxXRtPVSpAwJpnUhuxAqWCCYK1MBExZljY5S8SYr+pxAFAuBayhNG26jw8usCQLX0SAAkwwcAEngyQizaXoziIli+Oe7/9kJvNk1LmBMe9ECO3XRB7aPeF0EYHNVPdT8gj016YBcWtBfBVYJuz7mF7VgGY/pO8f5WdQ1/7U67nIKNS7j0wIbDPFZsyNHHY7od/xdlEHj8CcC3TgCWHgGAPSxiSdt4312u/8SPAl8/Dlh4pDeZW2PD4J1c9+uyDaIDkgEJQKnTfG/N8nUAmu5HUnMW5ARbPfEuIHy/ACjRK7FL5pOR4RaxgTHofKl8r/S1ZWBnAGDKefbn3AFIPRPXB7sFiVQimKVgGdl5ooNwLQ1/1U+DQGSXQ9r5Evy1q9rZbP1lGQDZsPpzI8APHgXgod7qUx11YtBbFzC+/C+BL7SAWwhgdoLkONSLqy5oLogYft3ZI1F7EAC+phsAnekokhP4HIzml/PvthQWmPB9LJ7jxkcSr14jWj4/0wFlgJD5eoDw6fe4DzAYPHokWhHJZ3TFSkn4h7YOSOBwEtiMTv1aY0uktFYTmI2/43EMQmCuAJmUE0gmVD8EFdPpdnxhVhqzDr8F4NMtYM9Jfg98EVTeNu9Q2OFZBX7vr9vtgm/lcezczZ61ZNN8DCvilYCdPXqNDQpAlfGTKm0M6AA0PTAyoMSx64cRfPQHXsniOTI+fEWDFGp+Qb9BeySRBV2kpl0QxxGAlHDmkI56X6z+EP7UDYSdRgh/IouwIZ36lHabBE0GJ0r10Rgb/xA/tt/j/6aMAf+7R4CxzuBXWRGULwBfIrY6UNfpvLae7n0I+LO/reoLMqiVMbW38oUhkNkQIzZO7tIweGePcmWlAFTjAYHPVGwXxWoLYblEDkLuTT8MDPhXLJ4jALpaJB+ggU6xfgJknT7IKXIQXh4Y0FZCog+wxiUTwSkXUbSMV1rB/A31OXWuFpPUda/mRHKi1e6U+hA7Zq7l+A+UAfDtHg/LrptkQpZ727cRWOL9542Pa3rOvuOqagUltgtmJM08j4/PILbIDKz6w5PAHsbraTnMGdZWIwIzxIfeK0rn578J3LAVuH8CODRahV/FFQ/1IumIvXP1QudNfyNT8oVqcHviPcBd48A0g2RDuoDqHdb2SalZAdG9dnfDkAE0gXnH5ijWCDbKCq5/MRiV0QD8HgHQ63jG0hdsLGxA3x9Bw1Asli7hO3BwApgng/Gjvq01IHrXJ7q3Cz7E++YziF2rs1ZLZ+8H9jJsSoECWXj6igmR87aLgfbGq4GvbgLu2gjsHwdmCEIPSI1h+SkCRjpfUC3iNWcpoRrcnrYbuGsUOMBo7QBCxSTG/igxVcBIVGPWM1h1JYQPnyKNExGZMDIJ9b66eEBGxPDY1Y5nv+GCjfGAxD+DDpiawphABWZPjwNzNLAEIH4XCH0M7/5c93bBfI8Yk2cgVAdvdT10ifDkBWC/r9lGH51NhIsnsWHOfPmEUKT94WeAG8eAO8aAfWPAwVEHISNQlKQUglJjJExqC+H6Nq93kOpUg9szbwLuHa66QzFWkaFieXxi6hgVHOMCYGRuJ+5V4jYJIDKI9KlsAvFDq8QDrnb8NWVPh9EwdFkQ79TlSMIsN0Mi5s9MoOGno4U6f3YAvefL7Y7rvdoFLxOANSA8f7xSgWmd0kCQbmZ6mTLEnJ0UqWLhUkxlrBn6n3wWuGkYuGukCsufGq2iojnRFpafsU7MDxErJuZhYCsJosHtWTcBe1oeq+hxigJgXBrMmTBPnJKLrr+VED54ibHYvZos8sO+DNcrHrDX8YVVyglAKud0LtMjFPtNMz6QLDY7VomLJd671AEH4Xu+3g7nWq28ISvX58/hguOBg8vtFQvV/hEzxfqOevuTfpjri8vAWz8L3NYCfjBc6ZYHmBcitnFd06pxyb8W4gPlgonBqffTtdTg9pybqiVNBssyUsdUD7eGO9amnf3sXtxQipl7Wg/sD4A8AwHIyZMYky50Tp/xgN2OL8y051qw2hXzwRCEdT2nmck1RxHG+w5jeO9NFQBpR6ldMIMXlFWgVndqF2dVFsJzuOgRwMElB6DcI6rznemD0RnbwQiSRS3g7Z+tVIl7PC9kahiYZm6IizuLigliT/VoUog+p8P9l3wJ7qGEanB77k3VczroUToWLCsABud4ypaLCUoxf9i/9w9ADiICULrQRWuIB6w7nuZrwaZwLBGwClSqSyz3AhHbaRGEFGOmC44D72UVgjW2C2Z4lIF4ArjodODQcqUGqAxfcpG4mJVuVqcL5tbs2z/veV0tYK/nhTAqesYNHdO5PCJZos+WuzxHJIViuXFyJxupNLg976ZK2lizUKodilGUgzyGhokF8yw5Mf+qRkjdjfuDtwkkm7DTkNaBaQ2ox1q3eMD8+B6O3H6em8Kx1Ccx9ptWl9iYIUAAWrI3I3nHgPdOtsO5eOuxXXBdj0V1vOL/so3Cxef60tlSpYwveKf0pAu6ohfdJ8k4CUqgvr5jV6VGTBKALeCAh+VbZLTnh5gu6D44A6H8cVlkNK95O1WkBrfn31R5HSy+JCwPplAxRegE/2T+AloGncNmbQyogUQx/KwB4gHj8YWNTwRAOW0FIIIndoqNkTAxz/bd09XDGLBdMM6/pLKi5whAX60gCK2ujxzEAqGL2pQ1Jis5AJEAFHvTujYAKjRf+SEugm1d2COQLU/DAwQ44caEw8AtZzSIPgAvuKkdrWMM6M7xCMBoiBn4YpCE2NCfxWAA5MEuwvCCEICwlnhAHV+YORfDsWJGgPpMKwg1b9QpFnzHbD2BK2JGul9s8KkYW17vLALQRTCBpzXZpS4gtCXXMAkduuAy8E7PijPWprXJ5CR38ygw1fJDohh2BlRAgq2OeN7uTWc1D0AFNtmL54ESBsCaJcLkDajxj5ZXRiCIGA0waDwgjy8sk5+HY+X9ppUbJSCp6TnFCMXwny1WAFQ8rUAc2wUrRL6mXTAefWnFfnz3FpbagQKLAqAzoZjAKkkpXkNO5GCEvOMLFXOnnC4xIKOjnQGNdWSM+GqHQGd7JSsxUf+JzQLwhTdV4je1nQvr1MkPGtlf9yP2Dy+gAqZ6rQytfvdHSDxgLwBF8AmAYjHWluEDiKGMiqOVvtejXTBOuRSYJwDJAARgZAGWL9Nk+IM3SzgTydE4eec1nZHbtDaNAf1Dpd/SMx2END6kD0oXtFhBXmcY+OY6AFChnKnzl7NfdMR3qCAae2B+VVMYXASvDs3/X/zHJZcB84vuiqABEo0QPnhnwqQLyRURmZBPytnwHde0M1vN2lR6picoKULaxHDIEdHkW2iWg4/7b5zb7DSQAVd0/griV2JYojfpwRGEYsGBrOBmx/OgP5sAKANkcbFzNWTRnX/GSGImMYH/LYlk+gGvdT+bW+SWH+Ig1GqL5QeTtR2EYj5LVHfjw/ZDwL8yJ6TB7UU3VVoTjTYxYDK+Ivv7dzNAZIxpZSiU8jjKgIWTcykZkBawDBBnQdMr5QeTKI5iWCB09AmEb7+ucnOQ/aTPWn6wuzyS4u+R0Ob6CUGqJpIDA97AdqINbgRgBJ69CG4Jp6q/ckjXqB/RKla4WpkO2ODgHoynigA0JiLwaNiEt95YQKJ4FRC+7brKzRH9jZbN6iJYuSHm9I5iOAOhHNJfZkh+gxsBKPbLu3+JgaWDdojhMO5kkDWSlNTg4B6MpyIAjf3IggJgMD4MCARjFMU9QCgAykhSKnUCYHB9JB0wy5aTRUxmup4h+Q1uAmDs+hpXgFLnB6ULONOn5xACNJqxghsc3IPxVBGAiQG9aLeilWUJW1FvVXEN0TKp1C6At19TMSCBpz1dHtT/JH7N9yaxp6QkF73KBxYIr10nAMproB44qQGTj6sjUrtOFPtLeFQHLES9AdDFrq1E6M13MaxVCTNAXNFThIylLcor40zxtgDAPKuVwDMrOKw+SBTbtR2MND7sZwC7Qvm4wqHa4T/uIrhb+7n0EgbQdTijoyg+agWXT8llDsAFWr/B8qP1K7bT0pvtVwHhW6+t2C/m8svvZlawi2CKe37nhFtapkDnILRqBQA+v04AjMyn79EIkXO/DnzyCBwVweX4wxs9B4rRZgyPVFqykgDd+5JSpBU5r0vHyHz+jsc3ub0KABsZMCyQgeExKyFPVIz3lmcM6OfPAGCADYPE67Jfs6h7G0o+xvi7oyK4cLZfOgpsXwC2Lq9MwuuVERonKn4nSJrcXnQKcM7dwMMXgYcsVxkSebJgzOWPqdB1ad2f3gpsnwK2LXWeR9m3danUIV1lBSCPArBwtp+7DThuBti6UDWDmWA/DvXk8LRptfPtNUlihYZTOPCi04GH3wFsnwGOW6iAs5n3GeJJ+KLoE+9VDClQ8R6vOQHYegDYwuY3S6H/iJ8jb11ck0q9Qhoc9QMWgPBZJwFbpoFN88DGRWBiqQIgWyJY3lPozaGJ1KTEPh36zpTkJrcXPRE44S7g+Cng2DlgyyKwaclfFoIwvCwx9Zn3Q1DmIPx/2/sSaMuusszvjfXq1ZRUElJkKsBEGQyYhJCBSkUqAW1tsBdpuxEVaBzowXZqe1g90G2LotjQdmMjKqtBxQERdAWUAkUlZNBGkQRNyIAEMAkxpFKpqjfUG3t9//m/c/+737njPq9uVeqcte66b7jnnn32/s6///3v//++Tz0dmD0KzC4DM6vAFpd/0L3Gh6yTDgnvLwKzAWDGiH/ThcC2OWDrErB1pRgQisIQhAa+AED+HEEY6uNLyrRnZLSl6tSbrgLOeBQ44yiw8ziwfaV4UGbdegmA5QMTLFlqsfn7XecDW+eAmePAltXiXnkuZSBkRcm4UGXtU2uo3xsAZgz6y54JzMwDWzkgBOAqMMVBCSAUObh8QuN/CiTgcWAuyWhL1amvvBbY+VgxbW477paa7gIBqCnUrbUBiQuhAKDUot13IbBlDtiyBEyvtO5VDxvvVfxW/JkWNFrCeK8NAGsY7BsvKQC4hQCkJNaKy2LRIsg6SJ3IQSe1onKKC2CsOYMeN+0Dtj0ObDsGbFsEZmWp5S74g2Ir2uA22BScAJGA+dJFwPQ8ML0ETAUAkgDTPq9zdK/+sMWpPF19NxYwA4g3PtsHxAE4SQC6FdSgmGWRRIJLZJll8EGKjHiX1jwaN10HzD4BbD0GzC4WrsKMW2pNobZoCu6CLCDfCTqzgg6sr+wFphaAKQfgZHKvpRSYg7HN5XCL2AbAZwPrZGaj6ippXhgn0kqmU1woxnHedg5AATuWHig2FE1uVRwoxoX+Wcbg89S3AqCKPONcCi8oPtVP+9++G3j+oSK2xRBFDElUxbTS+3nvc4FpDsjxllXQoJg8FgdCQoGJJTTicLcQ6vPL6wbg9cDM4cJv27oAzFA5ky9/UOSvmg8oP86n0dICBn25JwjARWDSAUgBHN6vfdbv10AbARh8X91vDM2ss+NvAECKPVLCsHoyUgRqrlbnRwB933OBc+4DXrIC0IEmiLnE75di8HsyAcjzWUVGUi6uICMpVwwJVMXdeOk3XAxc+Hng+vV2esAYw+sWoP31r3eLcLwQBeQUrEHh4Jo2h4vDmJPuAyMLGAeEn7uqbgB+I7DlSWBGCwe31Gb9aL20kGDb/EGRxY6WTz8f2wtM8l4pgL1SgM8esHCvsuylME4nn9cfQLtldg6TZ0kUKorAfij23vAPCmqp3fcCl60XFINid1PlZrf41/dnApB6wSQjutUfIDJR8CGIQOwWEH7DywpKrWc8CFzqRLHkVYrB2jS2FQH5vkuBycXCAlIUUAAkCM2iRBA6+ARCe7DjYmQduLYTleiQ/XTTS4DpI+6nLhZW2nzVCEBaMLd+soIGqjD1ampdugiYWCpeBKA9bBJC9ActAk8LES26SqsftInLZ44dQif4Igdhym5WLrPDyuYH/7HTCNwDnPko8LXrBccjQaioe6BiKad3+QY/MGTH6rS3OBvCnQDuAIyqhiDkQ9RX+29yE3on8IwjxQPI8zkTiApGU3oVkD/4fGDieAuAdMw5MFQjEgg1DYsUku+a3uI0TGBfV7PotwHwaOEmbHEATvuDIutni6UAQoFRIFRYhfe/dhEw7tbe9Of0Si1g8HkrwRcevDajz07gIJ7n05rYyWIpb4ya/7vv8PRdFpj/LXDmkQLAnA4jCCOlTBRN/rFMAJKgkkVHpGUjySSBSFeg7/azqk8EgbSEq8UDRACLKDXSyaQ7Br//DcA4LSCtwnKhTEkQcmAIQhtM+Uaajl0uS9NatITXWzpzfcdNB4DpY+6nBgDaCtanYLN6fCj4u1ay0QIqtML/EYC61wSA9tAJeP6eWsAoDysFpg1eB0HIQRCIIkVeCqQf/05P3WCB+UPA+CPAzvmCaFWDKEuYcl1yMN+Y2dckqGTeHPEvvWDSNhOAfbefX0A6rS8CUw8X9066bFIfdqMHJID++DJgLACQumyc3gyAEYRRKFCLD1eu5ODLF6QvXedx0w3A1BwwxdAJLTXjd8seQnGrZ9bPFxLyA7WIKON63tYtCQBN/sv9QPm6BkLp0vl9t/m6ietR6fbyBA4gnXtORwRRpNnTtPpW6gWLH83lKqcOFTEnDiKtoHwy8RNFhrefyeztbnrBfbWfgttsP+kIyO32ELD1cHHvInrlvWs6TsnB7qAUlg/suFtAWkE55zYQ0QpqcALoNCXTEt7A3KoaDwGQfqoAOEUBa7fUbKctltwCajVbxvSiyvoasM0BaBKwwdKb9fN7NfcqBWGiSWykWXER0umeacUEonQgCKRfIgDFjya5yq8Wfsfs8dYgiuMxgpAg/vnMzu6mF0z6Zj5APdvPQec0TEosnvQosGOhaLuIYvnwEYSithE52F1XFAA0p5yigD4otCqygFKnpHUpLYP0OcKURYv6Mj4MNR433QhM0gL6QongawOg+6rl9CswKoSkEIxPyTsuAPigCYBmAXVfYcVf+n0SRYw6dP1YwNgHsgSajiJP429RrpWOM6cxDiJB6NINM4w7LbUGMQUwB/M9mZ3dSy+YVG0EoBiDBST5ddZ+PkCsAiIlQZDa3LVatJ0WXG2PbL98AB+4omB3oP/HgTUhmGgBfRqWf2TTrUSjExDSP/qWzQDgfAFAWyzR8rkFtDAKX75jo6nUguZxZ8NByHbvvqBQ36T1swcsBaBAGGRg40Ir+rt9WUDhQ5ZAU7Es2e9LLzglqHRxNkbeuW+oQRRls5jaMjnK0a9ecNf2R4LAwO829kQB3LTtEYQPUwzQAWgW0AGo8AQH0ljp/V17pm0KRcEifGuNOnocO1rACQbKPXhs8TtNwVr5uh+n6Zf3wDgu29g2FdMtOc8B6PdpFj08ZFrplw+ZA5FTvAQQ0/BT36FPDkRqBT9Jag7xYlQItY0f88j78sZzCcKPZlrAQfSCK9uvB4h577SCotUiEJ8opq8IQFl/PUBPEoBLxbRE62LSqG4dFB8r5bHcOtiOQSqT5T7RKzYDgJx+BUCCTxZQCwhaQc9oKcEnEBKknj5FsJ1LAPo9xoWWPWDy+6IIoqbeaO0VA+zHB0zxIQDKkn1GgtXiRxMIAx0Vn0Db+lkuFjLRCt5WEwD71Qvu2H5OfekD5FaciQay/GIbFgBXriwAyGmJADR1ck3DwTE3TQ4B0LetzBJErTYAr2BBSI3HTS8tLKBZPo/fWQDZp197Z3scjGb5BDp/L3+njMweB6B83Gj9wj3atOsPWin9WgXCFlVO/3ctf4iD8XkBkH5USlAZlNPZAQqARr5vxu1yjmH0givbX0UQKI63o0Wun/xHuR8E4VnPK5JQLd4VNttTBvK2uoiKOUf/f+GjwMNBh0NMV6J0c0NpcRv7mrYv3kh8/uHxYp+bVpwLp3R7sts2YzouSq3KGa+q7+x7Co4nazAerRKsVlV1QitF59dyyFZaYY0HMu9mWL3gtvZXMbymBIFMZ1ov2h0B+LTLisxgW+Eq5uU92iZ72ud9vvR+4JFp4NjkRh2ONi0OB1/UBCkvEYRhfuNs4OmhhiPKnFQlx6aAjMnSXJUAACAASURBVPjmz1w41nnwO4cCIBvBwZgTAOUHRq3gyDExD4zRGVYEnpm5LqmQc0M5esFt7acFl0SlHiBxuTkYxxdaihUC4QVXFu5FCUD5QtJl85sjGA0ziQxqeu/fem+hw0F2fLLQGxFlYMRvo7v1WmIVtpt1DFkXvOR7LwJ2HSkyoZmEypoVVe8p7b6qEMnidGG/Vl/L2aPOIwuA1pAIQE3DAmFa4j9f7CPaFpCHKujr5xzZesGdHqAqKz5X+FLRAl58le+jui+kTBALMcgZ73CDBkpN2/7+bfcWOhwUyCEAjQTcAVhKdjkPc2RajewKyu/n1//qJcA2uhBMRGXQOcn9U6JIOjXHQqSYOsVoQp1HNgAvz8yny80H5PVz9H6RqVd849WtXQ/zA0Ow2ayGLJ474L0G79vvbulwkJi8BGCg4S01SKqofoNvSIC+5zkhFUupV8rUTpJN06KpaBkFQm5M1HlkA3AyM5/u9Zl38zrk6f0iU6/4hmscgK5ISUtCTowyDqb7UxwsqFJW3fo/vbuIBJEZ1YRgyHwQKNi0KEl1OKTCZJdxtPDn//v8ooaDaVgqFyiTD2IKfcjZS4Fo+7g+HXOPv84jG4DIzKfLzQf8KVfI/FNKrQ6h94tfz+vOA9cGAAbrpylY2SDlVTTt+uCnV3/V3a7DQQAysJAwobZJgUXi78Qayhd812WeiOAZzEyUiAkHMeu5BF5FwZQAWLPwknkLQy9CrPMy8+lIHZFzvN3T+YbV+8X7c64OHHix74V6zIxB+RJ0wQ+UU992tYoFy3fcXcTDxQkoPsCUhFIczKVCegSg5B8A/PILN9ZwxBSxtiKiUAOi7JW0dLTustF8AGbm0/1o3vjjnSGdj+lYlGwdRO8XN+c1wABIoHk6k61yuSCJITq3jDY9Vx0BqK++uwAfX6JkI/hME0SC1EGguiQ+isqcQRLrF6/0jO2w+6FMnZhyZYsQ1W50qOHgPX1NXndtODsfgMwHzMin+0+ZN0S9YOllMzWfLwKQSS396P3iY3kNOLDPM1y065H4gOW3p4uTDkB8zWdb7FgbdDhEgJkCUDRvogTmd/vPv3BVAUBuvylNzAAYi4hisVQnEHoIqWblrxqm4Mx8ujfljT+YjsWBYgIOc0oJPsq1slCpH71fKybJOEoAuuVTRSCnYlmU6P/Z4iSJEcbLv+Yu9/1EAh7JKEXDKxq4ChUiKymRbwjgHdcUWTARgLYXHSr2LOU+BV7MVwzxwOfkOWybYAGZD5iRT0edjpxD6VhcOQ6j94tP51wdOHBdMeXa9OqWRcmWXA1XLUIUH6zyCwlAs3z+YBkfs1u+VIejJEF3ckrjI9T0y/aMA2+/tgAg08VURKT8vbKMUgAMIGzzAcOi5HknHQAz8+l+MW/829KxhtH7tTz+jIMAJPCYMULAWd6fvi+EY9ouoZBM/Kx/4LUBgFLgNC5o16FrE8JJVJgkiFhaQQBv3+dVbMrWVsC8UxFRkjjaVsW2DtRdOJ/vAyohVYK7A+bTvTdj8HlqTMcaRu/XxHkzjgNkIOWuDr8jnYYDKDutgpUhra0uAlAyCCUAK8BXcjBXgLCk/h0D/hcByDxFAdAzoFUqUBYRJTUcMWdPP7ONL6i5bLQeALJRQ+bT/W7G4AuAOXq/lsGdcRgAY+glLkYclJVTsa6ptCX3uQjAKINQstFrAZKIwWxQIhIJuovB/Nx+r2LzFCwlj8Y0evl/MYk0kieVtcvrwGUnHQCVjjVkPl3mItQsIPuElx9G79dOzDgMgGkAWlNyBJn8xKprBRC+zgEo4LWRgcdVcOCjjlNvmx84DrzNAahaFZWLygKWxUNibIhTcPD9BMLLa65bzreAMSGVoXvJ/Cgh1WUfO+XTZS5CDYDs9GH1fnOrIDcAkABTTDCCLYK0Cwi/586WcKJUiEpC8CCBYDsiiSplqUIUmOjf+o2tIiKVUJbgU5uSWl4DWwX4+PcXnrQATBNS+8yny1yEopdcay+930y5YhgAg+9n2OoUeI5TdQer+32fdhmGoOBZanBo+g1yEKU4dYgFSvqB//vZBIBt9RshkTbW8ZZZ2hUgvDL3iU3uux4LSBM0ZD7dPRnTH08VAIfV+2XAOucQAMuVcKfFSD/+IAABsEoGwYAoHZIKEEYxRIHwLS8pUuhjFVs6/ZZhIVWyxVKBBIRXnbQATBNS+8ynI4tBzkEACv+chlUVIKE/5cRGsWmlKfIzudc3APLQSlg3E2OCyVRc1kpU3DgBmKoQsWtlBcswjPu+nfTYtBL+GQdgOf16GCZW6pXlBCqWSgqJypoOAFfXXDifbwFJLvi5HAjlnUsiIe6AjOp4iQNQHRlT2PlgJCUbbc2s+v/hFwFb/q7gm6HlYpBbmTV2sscQyy/qFBj2v0/cAdz/HGD7NDA1AUyOOU+1CwWOewNjKj6/O03F1/WuugW4/XJgfBoYmwDGdH7IxB5kLPIB+I8AfNwZgga5ck2fJbEm8V9zNWPfrasbgMuPAcuseJ8Exsb9FdBhA+7gaQNKB6TfcgCYug+YJT+g89aoBDMmIMScP12uTKj13uDv8zsKig/uJ1uQOsnojm3qB5P5ACRBH3OhPuzzRN9DV88HqQLEWPJnvTy5nm/t/1s4BcuSpRZtGAu4fi+wtBVYEyccrYwn6hF8/FkJp9bKxAKVFsn/d8urgbHPA9NPOEOWl4+2cfoFHhfVrJTZPKHSj5daOtup6JyCpPx8rHWRVQ7WOlrYCMx8AHIzlxkALPD9c0VB+x/A3E/+E2fUYHXdF7KTGwdvTd0AHP9r4PgWYG0KWBdfsBdsMPfPrKKsoL9XAVLAvO2fFylCE4cKliyrDVZNcGS1CqEYhWFiAZV+XntaURdTLmpCEbpchTYLqi6NrkMCzLzt5Xc4HwyJmmkJ+Z73jQOh4NWeDUZiK1K08f0EXt7CMHVawIk7gaVpYJUA9LI1Ao8bzKX1cytoFtFfpdCIWz7rgzHgth8u0oPGDwETc8CEMySUzFaikgtlpW1Ta8JqNba7lVljSRgW+Q6ZP/57WQvj6fydBjXfAjKbgEvMLwWCvhNoipgNpnQshlS4IGFWzIk6ylWwAz93ETLxGWB5ClidLABoIOS7pmGfG+33YAG5mND0G8F4678vkiPJczNOAC4UyQm2N8w94kirFlfIAl7i402d6dbPWWAtrsjOFiuCvAJZOQE0pHTFsckHYDeCvhNgipQNxoAz8/8IPr5nbvH2jd+6AThJAE4AqwTdZKEBLDoDgU4+YVkPHIBoPwareOt/BkDexsMFAFnbzNJYm0IDnVwbt4uyur1kwL7Tp+iZM/08WT9Rc7DHUmuYTr/x+6o4ovvu9fjBbgR9JyA+omwwxvZI5ULg6ZW7y9FPf9QNwKm/CgCcKABovh8ByVy/UCtJq2f+X1yYJPGU27lIZLbuEWDsWBHesZeDz4iURLUWa1TE47LqK12fZmd3OXidFctqm92KatVs1jAEsNv6sdymaa2g8+xUL4I+Pn2beCgbLGWHI/h8G3oTr45iK86POlbBU9yKI/AcfLR+ouQwH9BfmmbLlTHboOnZ/T9+5vaf8FUaAThXsFOQ45mUcgZCWTAxe0UQ+urYMO1/37GtxQmoLCBtRSp30LrDp2SFdzYMgk/R+VNwvwR9mwQDsaspGSfJgYDYNTbp8psCQFJxEIBkQjDrxt8dXCUIY+COH5MVFPi8SOn2n/QYLZ9Gp0cxANIP5IvAkzVzxivRydnKNzBa8fddM84b6AFyAriMF2pajk9kYIeoClXmA3AQgr5NQEHMBqMVFMNaIOayNRL/vhlH3RZwmhbQQUcAasrVVGz4EtjCu/3dfb/ID3PbT7uKAZ/MhcIC0vqRTo4W0IBIEAmEtFwCYqjW03bcmdwBYeoWgetUbrR8snrloiR2drpACf+rD4D9EvTVjIJu7HBV+781X752Czj9lwUZkTEgcPoNPp5Nv4oBRhCG6dd+1DkMz1JIhR1BAHJ7zwqO3fIRRM5tmDK5CoQKsSgOeBYBKFZULTqcB9r6Ni5KYmd3WKDUA0BlhNLM8EbT1QBXBU72aI5ZjUcVOxz7WLkQ8d37vsart/uA6RcPsxNSAtAXHDYNC1AEpf9s01kKwuBwGU7HgVt/1jtD1e60fgQigSe/j5bQp+KYpGB+H62jT7P8/ZypBIC8Dhcx8eY9wF015abhmnoAyJ5WSrKeNgKO9SHxnT/LSasJBim5lRjWBEIVeROInKL1qunybRawLgASdEy74qjaNNzJCgqEEYzBGvK0297mAFSHEIB6ebKDgc8J1ksmV8t29f1en6L5v6cxIK5iK6Xne/5jCTiFcTqVn/r/tWDPWwXnEPTVgIKUHU7ljASawKefIwDpMdRxRB+wFgD+RREDJABpwSzz2c0LfxczVjkVKwaYgtBBezu3SvX08d39P5uO3QKahXMQciourZRAGKZWar/YZ1xXRPe8wQr2AUK7TvbOVTZBXx4MBECRnConUBSFEXT6mf/TK+/qmzAF/0UBOPqBZYF52HrTFCw2LH5G8UCzJEko5nZqmRnPh/uCXmpnVpDTsIPPwKApOaSA2QLDLSHf97iPx0tpISLfz7bl4iFfsUsnj+HZWEeOYDCDnDmCvZkEgedcCjxGseIhBYt3vx049HwMLRh8gA9gh2MoH9ABqKJzxf0McO7XlSAU4HzhYYFq+5D7hwBu/98OQLlIBCKnW39SlXNY+nqeiq2dkQg+gnGPb9/ZpT0lq6MV5D96gLCwgDmCwbdnCvZmCgY/dxy47xxg5SWuUjigYPHFbwA+fyGwfr2rXrMvPB+vp3L3GHCgi9JOHQCkRVPppeUBigXLFymyejYTB4YsgfA20ofRAlYB0FfAlvQqP0/TsX5PLOB5DNu471cmIwiBaRww/F01J+mz2pqChxUMZvpJlmBv3iTocsW4dzewfhkGFix+2febXDAeJO/YEILBB7pU1g8LQFo98QASVGYNQ6DZfEG3fnEqrgLhbf/HV15anbkFNCvohWSl9XPQ2XTM/2s3I4DwPIZwBEDfgitH0Ek6N6x+u/iD7T4g/YdBBYPpWHEaHlqwNw+AQa4Yj54JrJO+aQDB4pt+oCAyYvOPEIQDCgYfeF/9U3AbAMX7ItAlVtAspKZdz5SOlvA2pstxjES3wJ+92NgAGK2gwi78QoVfEhBeQACqNNP1RdoA18kKdgDhxkUI/zKIYDCnqyzB3jwAJnLFOEIW7QEEi1/1Y21ywVglCAcQDD5/Efj7M4CVrZ5AKlkhxeQUaxBI4nvFzxf8IfCVC4HV7cC6ZEX5nen3VX1vAGLZq8ysrvHY+QBwbGfI2E6JpLvdX+ksthpUvQrmX/sVDGZVUJZgb17vJHLFeGQcmCdVb5+Cxd/5xjZ6QzzMLOQBBIOfTV2Ps4HFHQ7CLQUQmUrV0rgKJMsCjsxGAqTn/hzw0EXA4tnAyg5gbTYBorKkUyLnkB9YVhTxu+kT13iccwtwdBewPAus+b2ar9xJAafqfgMQO4dh+J9+BHe5gqZZZzYok1JJUcpaR6bp93P+W/N6p0KuGIemgEWKgPQhWPxdP7NBLhiHKYHUp2DwpZ8rLOD8tmJQVplOLxAqmbRKC6EDYC7/CeCRPcCx3cDSrsISrs04CPm9ArZk55UvKAspYLqPaPdR4/H0g8DRHcDyVr/X6VabLHk2PhjpPVZY7d5xwF6CwS9y/4LbbVyQsEKIufGiKe0p2JvXOx3kinF0GjhOQY+oNRtljji9TQPf/fOV9IZY4Gq4D8Hgy/4W+Oo2YG5bUUy04vUcLCqSJVRWszJbNgxSmMau+q/Ao2cBR88EjtOqbgNWWaTkIFz3YiWrF4nAjtN0nBZrJnU+/8PA3CxwfMYB6LUra3oglL0tps6wlVha5rLiqd9AdDfB4Je6U0s/0BXTDYh80Sr2FOzNA2AXuWIszABL1JaKWq1R+nwGeM17OsoFY5XTVw/B4Cv+Djg0C8xvLYqJCECzgsxmZlq9T8e0XGUyaUizavPtxoFr/zvw2BnA0Z3A8e2FVV3x6c4sqwObckeyhiXAowUSADhD1XhceDMwx37lvU4XxVN2n3rJIocygkr/Vbs7fe+EdBLcfaXXQ3IPWIrpBB6XlnwpR76jYG9e7/SQKzarxM7qJFj8mg8UarMV9IZ4gvNDD8HgKx8HDs8A8zMFAFnPYQPDl0Co2g4fpDZLqKCxT0/7fhJ4fCdwbFvhRiwRgJruCOwUgCpeCvUjZmEFxhfk9W969kW/B8xvKQqnVgg+B6CB0MsI7P70AHgmd2n1NQ0rv7FvALIlVYK73MnQCDLThSGZoDpuP7uCeuX5n8zroB5yxThGnQ0CgyBMxY63Aq/5aBHG6EBviDlOLV0Eg1+0AByZLgbl+HRxnZXJoqqttA4ODovlJZVuSjTQFtq+NwNPbHMAzramdVpVs6wEoPtdNg37wJfvsYiJP9NFqvHY+7vAwjSwxAeNxVO8T6aNVRRRlT6hHrJ0Ovaw0WDJCKng7g86APvNB9wg2JvXO33IFWOBgn8EIf2nRLD4tbe1+AU7yAWbZeskGHwVdd2mgAUCcNKnJgLQrZ/V9/Jnn5JUYmnAE3hCmv3+t8AWQfSzyPK/POOgJgDdsgqA5nfJAvLdLV+bz0kK4RqPZ3wQWJxyAPqDVhZQyQr7gyaXI9axWCFVAGLvRUhV46PgLnUWBs0HbBPszeudPuWKsTRZAJDTo8l8ui/42juL5veQC7ZpsEow+OrZQlqVVuH4FLA8WVyDAOTAmHUQCAWQkOlsQAwDt/9/AE8SgPQpNa07+AhAA6HLXbb5Xr4IaAMfv/eGvP5NzyYA7UGjBWTWjh40v9fSyscHLtaxhJWxFVsNNAXH1khw983+DYPmA5aCvXkdNIBccemfceooAfhAAcA+6A2xLuAGucxrzgKOMexDfV9OwbS2BB/BEoqLSrBoYGgJ3E8qLcIEsP/ngCPuUy7S13L3wb6PU56/m/Xj4Ps0TKCXQA6AXuNeZY3HMz5QANAeND1kwcKXlj6wOZQ+b7R+Pi0PD0DeFAfk590CKg8qncfoFzIRVWVqfFfBhgn25vXOAHLFWCDbvPstBsJZ4LUPt+jdesgFg+qVptWq11bg2gtgfuLiRAAgQeg+oEmsOujsXb5SsAoCIN/3vx04OlNM6Yv0tdx1MKvK7/TFjVmeCD4HQQQhf159eV7/pmc/kwCcKABoeYvR0oept7SEoZQ0Tr1lPuPQFlAtO0nyAcWhpzw/FSjFzGjLx+RGvxzoSeC1hwsA9klvaFN5FAy+9mJgnhaQ0qqagglADo4c9AhCDpJPl5ZommQ8738HcGw6AJBW1VecZv0cePwOY0/wl1lAD/WUCx0mMlDLr8bjmb+Dwp3x4nkDYbD0thIO5aNtfmDi/xGEeRawxhs7Vb/q2huABQJwAlhyy2cC0xoggjAAUCWWAkksOiIY978TmOOqeqqwqAx3WGhHK06n7TDwOcAV/iipPAKjwgrZm2o8nkUA0gKmAHTrp+o9MTrEYvq44o9pZIOtgmu8mafCV72YAKT/RwAy5OPOuVlAAk9Oule6xQRTWUKlWtkU/IvAHAHti5oIwDK841ZPFtCmdr0U8PaC9hVultd4CIC8P2Ztt/m5/qC11TJXlJDGGpfGAmYODgFoCxACkLpuWh3KCgqE8gNVZK4KtxgjJAB/2X1Krao1rfN7CWZf3LSBT4uAEIyWBVpipL7GgwA0AW25GbGENBTRx3rm1M2w39mmrFVwjTd1Kn+VAZALEE5LtIDyMWUBvbLNLGHgd5H/V07BDp7r3uU+Jadgn3ptxekA5MBri0/Wp4wzBjDbCnkMWMqVpE8GJwLQqvfc0pqbkVj5aNk7gbCxgJno30cAjntowtXNaZ1suvSKNhsYTcVKmw9F5xGE+94dfEoP+JYhD/8OC8eIPUsUHokVVKB78XszbzAF4Pvd//PCKVGIpOAr78mn4DZOm8YC1jco+w6EFTDDPJqeCEBZBa5GffVbhmQ8DtZW5TYOvPhXip0GTuu22lTMLSw+aAVl9QhEWjurI/aQiLJkTMLsX9R3r/ymZ73fp1+37OU9hunXSkdl7T3QrhKCtlCM59k2i5CMMSIAGdqxEIwrmptzTsCEut5yilKoJLAcxCq3fe8tLCDBFwO+tKjyuxSCMdYEXoeDrHcHvu0tTwLzmwHA4N/Gh6zNCqqeOSxC2lb8tQSiMwbuqXIqAcjFh2JjBKGJyShQG6ygVbfJegULWBYcMR3rvb6oCRaQwFPgl1M5rR7/JtBZOIZWx/0+s4QeY5z/1/X2tFnAxPpFELaVkdLN8MWGVr4pCBsfMHN8bmTKfCjZ0Ncp456/x58zLzfw6Qf3ABd8pUgEYmqk5bGyek06IQl1bkXScnlN/u8L24Gdx1qVq91KQvrpgwaAAw9p+wnXPw1YjyWMGtDo2ASOFGMU7SIEUzdYD34vMPmXwLbHgdkFYAtlGiim6DpxJtvq9LtlVr/aWKEB8pUXAOOPAFPzwBTZ9r04vdQ9Ts4pAZ3cd+yHxgfMAOH+vcA69/9Uxijmz/AerYpdar1lNSMYzV+vWY/34I8DY58Gph8Bpo8A04vAFEFIknIHohGVR62QhFRSYjQE6qFri2z3iaPAhHNNlxKwArI0Q1IAxwfReacbC5gBPp66/5ICgLKCtqnsrKKlrFZUFPKOr7osMTtdsxzqQRZ93Q1MPARMPllohUxRqkEK6gShOP0S+dY2hlRv99y+ovRi7IiTnTvLqmg6xDPYpqAUgRgsoR7MxgJmgHD/c4E1FXu7FRRbvEgd7evXWlbPpp9EgUjiJpwe6zwOMlvpAWCMVusJYPIYMOlSDZRpoGiNxKzbdIQlXONMWJbGtw4svdgz3El47nzTRvPrrKptAJT6ZrzfintvAJgx4vsvdQvIXK5VYF3sUZxmJUvgA1FOvwF8spKyBtM1y6EepI4LqVMedbEaTp0EIKdPKh5FqYYqSxgo2jgFr13j6XXHnOiSZOeBVSvyC8qC2r05FVvVw9cAMAOA178AWPMp2LJaaekiCPXExwHw660n1oB/niGQazwOkkSepbJ/72I1x4CJ+cJ6lYI1riccrVicUuVSmIW82pkwnHHVOKbFsOozQGkFkwewnBES37ABYMaAX39ZAUCCb82nIlo+40p2gNnvsoKunxH1xGwA/LOzdQOQJPIuHzV2GBg7Cow7AI0l33XfjOsv6oVodes6ISbBsAZMX+kJxU56KY7pkmFVhOciuvTzSt05v0+ryuT/9gDrZNe4wPMsI7VJP3GcP7gUOOdvgL1rRYJ0ZI5IV3hV4/wrGYPPU3/AiRhYusy2K7mU999P+z90ObD7LuBZK0Xdkeq9NSX2+o4HLwfWlopFCC0fgciBMtAFC8CGrYXVoVjnU2G7rTXrzh4kfRzLY1kyGwBoeiGcPiXb5eAzdXWnazPCSScb4j3xfmav8Cx2p50lAMW0VXINitCogl2r9H2dcctWwQxQsn6ZTBbMNtcgdKIbiZj51VcBk38CXPxoQcfCUg8pjcYgZScw/momACnXyr4leBhs5QaBTHpf7X8dMPYJYO8XgAv9e8QJlAZZq8D4xSuANYKPJQn0AR2AHKy1MACKe9nfFI6IEqduEWoHIJ9wlsVKLekoMCa9EAegSTYQeM4TXco2SEMkAHEbBZoj4bbYtdyCVrFqGXgTSxgXYTZeHLi9AMjEQRCVUXP/n4KUaaT8vVTi+Rtg7GPAuYcAWlMCgUVkQfJ2Q12yBvPXMwHImhDWwf81imsTiLSEvHZkr+jY/p9CQRD4p8DOBwteItai05qn31FFdfLlFxYWgCDUIkRkj/TxbCEi/89jfPZ3X2VqYSJQbmUNQY3HQT7hbv2sLoerVwKQHNEEoCsm8R4MhPRjXUGzVEIKIoY7yaEYuY4dgGb5RXruoSgtSCLLarkICQ9f6QNykGjFdjsIBaI4kGlt8W+Rg5g0HJ8qAp47nihAzFpuWtPIMBZJlASILvR6fQ0DCVbJCkJOJCqnk4pGpb99tZ8MopyiKDX7WWDiwYKXiEQOehCrgKh+eJQ+EQHo1Lby/zRlyf8TIbf9XS5ftIb8I92YugH4ay2pLusorl7dAoonWtMwQSTdOFuQSLTGHyIC8kxSIQuA4hwU2WUAoO4/grBcDbsfWElSzg+JCoYDoEGM1ixSkHzgF/wG7y8sIa3J7JPAGWuFJSQIaU01iJHUiYP4e33BrPOHmG/JMaOfTZVYRhwGav87vWKPJ9/rSH4IOGO5sITqg/ggxXs4TOaBAECbeoOsgfl+DrQShFqcEIhyyt0MbMusEkx76iAZXKM8BvXiZAGlF+KaIbaadYpem4aDgpJZQz6YJABV5VcHAJZ0v4FxX6KG5UpYs0KnqjhRuagEVgPglYAl9ciHf8mdUrJh0Qx9vkDBzBywfbkYQIGwahA/kglATsHsDzKA0BATiPyZ4NEDwIeoa/uFYKKXL2f24nQoIgd9R3yQCMTFqwIAfdBWI7+yB5ZLECYLETd85YJl+2YAUNosLIel/xYlu4Jsl6bhNhD6it4WJCvA2Zc4Gxo73RcgJeOqFmGR6rcChLYACyGojmEYdj59KnZ+tIQRhH9IvWA2hiREjDeRI9Cly7fMF3EtWRFawhQIf5IJwE56wdTIYdt7tp9ys1K8JnoJvod9Wn682PNkP4hUy1ndWgstAtBDMLYN5/6PAc5DGNoF4SrZfN+4+IhT8jqwg2Cp8ThIJ5vfSWBXAVCrWN9SMxDK+skaOvhoAc8me654pmUB3f0wyt+E8FyRAGmPlOEoiSD2qgvmAKoOm52fAuiTDHSyIRxx+lI0QxxADubfF5vffMmSajrWlP7nmZ3dSy+4r/ZzAUEHnQ8R70HsXlK+PgJsW68G4XYGZj0EY2EYATCAT6tAhmE0DXcC4faapcwMgAIfLb0kuzT9Qmw5uwAAIABJREFUSi+EfeALkSrpBovbrQDnkm8wAo8/E3i+CCsZ98NCpAp8cUekZyBavI4ET/TnaAk/RQCyAXy6uNSPA0i+wMeB6ePA5HFgZq2wpNGK3FUDAHmv3fSCe7afX8CB4UNEEOolVi/3obastNwJ9cO5BOBKEQMsAcifHWzRAigWWAlCn5K2bQYAOe1KMjTIR2kRUhKVS7IrLia0v+3xwHMZMCbYNP0KfG79zAqK5DxOvyEuWu6VD5KSHy2YAEQAfpaRdl5UkuUctIpBnCIIl4psD03FtIIP1ADAlBuJM47EqqUX3LX9kSBQcuuyftK78xUkHyQ+RLqHZ3Fv1KcgLj5kAQ1s0Qo6IA1nHhNLQzA8ZxvBXuNx8DcS5UYpNnoYxsCnUIqvZo0F3wPTMa7Hv53HOJVbS/l+5bumX7d+5WLE44hxIRJB2NMCqj9ixwuE90svWCaIA6bAp959EKeWChAyA0PTOV2unGMQveCO7bfqHbcS4rJR7Ewqnw5AWhLuImg2uFQAXAVs8RGmntW4+g2hB3P79L/EJ9zGvqrxOPibiVihAOgrWQOf/EBfBcsPNBBqW9Hv6zzGqFzmoXz3B9AePgXiq6bgiv4YOB9QHS8AfpkAFMMjrWAcQA0iO9XJiQyAnos2vV7ESHOOQfWCO7Zf7F40mZFQScRKAYBaSU6vAVcTgN7xXHiUFpDTMK2dFh56912BTiDcvpkATIXzCL4g3WXTZ4jpGfjoF/oihL+fx+0yWUABLwIwtYKKIabgCzHQvi2ggBKn0McEQDaKT5cGkIOo6SuyYzEfjQB0EM5nZgAPoxe8of3sgSqCQM3jkdFLvpRvR13+7UVRuhUFSavNO6otwp88ZZ3+t4M6HLtch6OT9AG/q9cmtf//gV1JDYcnQ2zY6/YakfSrU+Pg1M45NqPt3IEtoM7WFHokyrWKkooglCMWLYjiUXMtK3g8Uzd1WL3gDe3vRRCoUEYCwGtYFxxqgA2E/jI20F5hhmQod98BHNnlxOTig1aGiDanO21yV4DygWuB8YeB6fnC9WEtiKVVKeE0ZGiXWczeJoWMIig5a9V5DA1ANoKDeDylZ9NSXxyAsiKawrQqmCv2HVf5e8aRoxfc1n7xs+khItAUvojvyWryxVcWJZksVSyZoQRA3dcAoHzax4Gj2wtu6FVKM7gMgti02jbV476oUJJs1j/AbA1mQ3Pm8eTRsoZDtR+xZKCiEKmMXTIeXHPGdhYArX8FwG4DGMEnAHIK4yvT58nWC2b73cexaZgWWaEKgU1gjNbPP7PvOYGsUSBkv3hBtmRWNzxjTk9RWktvxp6POj0vARjY9sWkFel8RWxegjIF4RjwAOnZWMPBTGjqvHmszxJOBUD3xyznL2bqROvoP3N3q84jG4C7M/PpcvMBef0cvV9k6hXv+2Yno5QfGArRbaCC0mWv2YtF3ecerNDhkNZIIsXQRv5dlTtGADJSz2gEE1EJQM//026HdIEZLC8B6A0tk0g1Ja8DuzJdphS82QBEZj5dbj7gxZN5er/IZI+67pscgE7QaDOUMyC0Wb8+gXjuR4F5J6YsaXnFhBoAGEVvUhb60jISgCQnoh/OLBgvIrL8v7DdFkEYM5dtNg97tvz5zJqzdfIBmJlPl5sP+DJP5xtW7xffnzeh7H+Z+3+RpkyWT1YxuURJYVtx6T0fCTocouQV85VkHRIGegEuEv/YKpkA/JceVmL8kv6t5/9pu62tfiPWcFQVEa0DZ9WcLJEPwMx8uvfnjT9IgZyj94t/ldeA/S9tMaGa9SNdmsIxbvVscVJ1GScoMt4UPwhAsmMZ0aXzQBsvdGRBjQz0FUpEJRAJQOq4KAnBdz+sfiPJ3bOYn8fsykyVWMfiN3BOzckS+QDMzKe7OW/88aqQzsfE5kH1fvGjeQ0wADodmVGwOeiMsUqHrGOnS4UFy9P/wAEojkEnI+IqOIJQNLgpCXhcmLAtD/D+kgQE235L93tj+YBqgTX9BiCeW/NedT4AmQ+YkU/3sbzxBymQuZhm8g1T+QbV+wWFdjKO/Te2mEFNlCb6gPF708VJ1TXHgKd91GnZpDfi1k/gM2vqU3DUnCuBmNQe3P9vw6pe229KOvB0K1k+ZS+rnrfM2AlA3JMZtah/EZKZT3drxuDz1O/yxAwu9JgJxr3lQfR+8aa8Buy/wdWQZAVl+ZzCrG3q9c/YrkmHy3IRYryAAqAkEBIlopJxNNUbER+fA/H+/+AAdP9PmS9dazicJybm7mlB8nR2dI1HvgVkOlZGPt2nM29GCamcGZjAwlQ+vvrV+8X/zGsAAUiLVPp/wd+zaTMFWw+/kAA0GQQnpCw5mDsAMIrcRB5mC/+MAffTwgfwKY2KfmCZ6ZIkUShrxXxBX4yYaV8Hzmcn13jUA8CMfDqWYeQcSkhVOl8U6uxH7xekrsg49h8oiCENgC5TUG5vKxxT8f2aRtOtcAKQ1s8soPuOVUIwpchNlEEIOyNSIrrvv3hwnckWIZPZsnbcDyzTpvg3lU8mpZQqozyfK74aj3wAKh1LgrsD5tMxiz/nkGD1sHq/YNFOxkEAcuW7oqmXlisuQOT7VV2jwi/kTgj1RkoZhBje8Z83SCAEEJZW0C3gff8tADCt4VASaWIBK0HI9q8BF5yUAMzIp8tNx5Jg9bB6v/jdDPSRns0BWIZeUitIo9IhHmhXTvzCPQddccnZ76U1V/IvC4SBCFyg26DFNg7c++Mhhb6qiCikT7WVUmr6lYn2nRKyrdZ51GMBlZIc07GUBdMjny6XCiUmpA6j94vMZbgBMFo552pu27PXAqXTyAUQcitOQjAm9xX0N9pIwIPmSCmH5QuPqER0L4kDYgp9zOUL6fYxkbZcFceyAreAF3GlV+NRDwAz8uksnT3jiILVSmpWNlhMze+k94vMZfgGAPJeHDjpCrgM01Tdry9OzvmYAzAqLVWIwEShwzbRwwSEn+MqP6bQK5tZlWyhjCCCsC19Xv7gOnBRbgp7cu/5AOyVjqVMmA75dJZ9nHF0yohWNlhMxKnS+0XmMtwAmFq4imnYbrEqNJPc+9kfd62RKh0On8qV9hXZ9askEPgAfI56ziocUgVbzGT28lEtRMoKtg7lBHtznfZNA+CQ+XQWM8k4uglWK/NLYKzS+8U9GReXD0g/Tyvh4Ne17Yb4Zbr6g6y7/aNWcoPpjKRTsJIags5IJwkEAv6en05S6GUBfRWsUExZyVZVQCQwrgN7Wfdd41GPBczIp8ODeXfTSbBa6YYxlY8/p3q/udc3C+jTbtvqt2oadnB2m4oNgMn0W0p+hYWHWbwg9yU/0Kb9EIy+5y2hiCit4UgKyTeAkN8Valk4Le/ldlONRz4AWWBRM6fdIPfHstw/G+SE5rMnVQ/kA5AkLHS0ak7V7reXfhgACaBqDtD3e/nmc5k9kA/A80JReq+U38zGVp3ObJo/BvAOD3dtwiWar9zEHsgHIGlFubqSx7+Jja36anLLcDvvgwA+NDpDfILv+qlzuXwAXuSjrkKemlO2e3U1uWUYnL8dwB/5e2apca9LNv+vsQfyAUheX4VguB+mzIsaG9ntqxhF4Xbe3QD+n7/uHLAW9wQ1tblMRQ/UA0CaHC7plXEh+q4T0OWcfhleYTSHBK0EH/mi+fcRuKQn4I6fWpeoB4AevCz3HOOm9yb3F5mBlZBNclYCj1aRfyfrbgPCTR6AzK+vD4CyglX7jpmN7HY66d1E0ctdIrEEE4wEIMlam+Pk7YF6AMj7EwAVbU82vTerCwhAXopJN9zVI+AYrOeULLZgErY2x8nZA/kAJGWr0naUWdFpy2cT+oCWjpdjLFxE5UzYIBBpEUX5nLnlvAktb76SPVAfAOUHpiAMm96bsVtCAMaKALICMyxDq6cXfycA+b/mOLl6oF4AiqBRIEzBp7/X2Af0+fi1XIioMIlAI+AIPIGPmeROWV3j1Zuvyu2B+gHoFfZiDS2lC0LiY52WUADkQoTTMH1BFSYRdHoRfKSu5v9qrizMHYPT+vx6ARhSuDcAzzmDo5ZGHT1PAKYMwQxME2jiSo/gEwBrrq+u41ZOy++oD4BaCcsXTPiSI3ey8s4KGoG8QwCMFM+0ggQhLR0BF19SXuD/ayakz7uR0/TsMcxg3SjfqWNA0hsrga/ojaq/8WPcC+YIk4Ke4CMSuB2XVht1Oj8zIfXlU8BtU8DhmYRXWdfrdF1fgr3+S8At48CD04DVjXQSDO70PTUnaJ5uOCwsIIFHSSFy1pKPWCDsZxCpw8UVgKSPxLXM937OzxxAljzcPAbcswU4Qh4V3UN8mKoeKm/bu78IfKJQa8VD48CylHQiL3O3/qg5Rf30BKACMtJXjXKQcfBSK8Dfqc3KVCwuN2VFGRnm/yKZtq4Re5ifyQQgM2A+BeB3GHaZBo5MAIue0l7Kt3cC4xhw+5eL7TuCkJk1jBtyerbUfYG5ExjZ/pqrxE5fAOrOq5SmowVIrRp1IyT2R6+fg0bgVYG4CsyZe2UsaiOGKXr4Sfp9k8CxCYAFSKyvXeY1o1BxQux91yMtfsHPutgnnyUuUvhc0ZsgUXib+nVkq6+ZKaABIHsgVZnuwD9sVo66rrR4ImdhLGSQ8zPL/JgBQxeU1ouWkO9PTgDzbgmXxrzMkatl3keivfG5x4r4IRcz5BfkO5vEZ0kgpIfBZ8yKjlL17syy0tMNcOn9dl4Fy6dLFabj1Mpvow9Ify+I4Nlo9Xt+ZqU9VdJpqZh4QDDyxUyYOYJwHDg+DhgI/WUVZl7aSEt93+GO9Ia2iuZKOfA7lhp9JpvAVy61w2mOwO5hmCgMHC1H9O24gu6UD9jP+ZmbtLRaSsei9SL4XDPbAEh/kGQ/pSUcc0lbApFWb67lQUhpVnLBsoKqqZclFMmUtrxPcwxl3X7vOCAtYLSCcugFQmqhdssH7HU+RznjiOlYXA8wqkOfkItTAom+oKygca4ES8jY+N3z7fSG4hfUtp3ihUHruVSsFy1iRvNP+1N7A5BdJACmVpAgZPhGOyCigEjlPLudn7kvFtOxuB4g6OjD8UWLRkCZFRwrLCEXJQQhp2K+37lQeBCRX1A7KPQto1prFEmSYn2mB9EAsO+kYfk8KQhZF8yjVz5gp/MztyOUjiW9bCUhEBhKRCCgSis45uQ/PhX/xfFWMgOnWu2gxB0TF/o0kEZ/kCDM1Ts+3RHYnwVUL6XhDFrAswfIB6w6P1MrTulY0sum1VICglKwCEACqvQFCUK3gHcsFQCM/ILayqP1k9JshVqrncMalOYYvgcGAyCvIwuod8YBJQmZpmGJeyRwkGw4n8jJOJQNw3idLFhMRNB0SgASTJyKoy/4ieXCeFfJBUeV2SoAclFyR0bbm1OHTUiN0/DTAwD7zQeM52dqj8VsGEkVE2jKetG7AEhQ0frJAv6RC0trC1skl+IWlNinGLbSaZg7Mc0xfA8MbgF1LQV1z08A2G8+oM7PVF9Ms2GUE0gQyp+Lwu2yagLgR9ZaYpkSypQ6a6Q2DCqzpkvietXIFdoZfuieGmcOD0DeP0HEbBhNwYPmA/L8zJQsATAKnguEqS+XTqkE4YfWWwCUFZTksYAYwZfIBeN9Tw0cjOwu8gDIZqsoSSvhEeQDiiGYFoyWiSDRypWgi69UP5sc5fIcquSCNeXqe2X9ZAHfM7Khe2pcOB+AT41+aO5iRD3QAHBEHd9ctuiBBoANEkbaAw0AR9r9zcUbADYYGGkPNAAcafc3F28A2GBgpD3QAHCk3d9cvAFgg4GR9kADwJF2f3PxBoANBkbaAw0AR9r9zcUbADYYGGkPNAAcafc3F28A2GBgpD3QAHCk3d9cfOxqYJ2au9RdPtdp/khoEOlglDYT39V1PzQFXLsMXAlgt9PCxJKPbufyf8/KHIPfBPAZABf79Xc5XQ0ZQ1Q7360NbxoHrlsDvs5ZRsgo0une06by6X1mZvtP99PNAp4F4LsBXA5gjw8EGTeqaGF4QhzQF80CX7cAvGIdeDYAfhdZ2sTKUcVrpE7nd31N5gj8e2dIo2osk7NZpMdK0Z19tv+bJ4F9K8D1ACj8yfNSikHeg+5Z969m57Y/8/ZP+dPLKZhP/rcA+AYAF7g1oRUhEMUzFMt6eSJfX78b2DkPfM0i8GIAX+uWlAMppreUUErn8p2gzTl+2flg/sDbTkvIOik+CP20//mzwAXzwDcCuNTPJeFXpEpM6QEjIHm/zTF8D7T5gATYNQCe69aAloRTGulfBESBSYNyxR5g/Bhw7hKwZwl4vk9LnM5JmsBzUyDGAX3B8G23Mz/g9BuUa/0IiutfMkj7zwKmngAuXSvOpUvAWYBtF4BTnspIj/O8zPaf7qdvWITw6eZA0JLQEhKEGgxZhUj/dz3NzSKwbR44exnYvVKcy+mM5Km0JhxInUtrGkmzCPicg3W5LMGkQiZZTm9xS9Z3+4m2o8C5c4X15pTKW2Lb+fCx7WLtjYxzqiql29Icw/dA5SqYf6RTTilg+lYCIXmICKQ4IK9wxfSJY8AZK8CuFWDnanEua9ZTAMsaCog3Dt92O/MvnRGBtGwkqKRmMEkqCaa+2k+0LQDTh4rP88UHj74kF1WaATo9QHQ7mmP4HugYhtEKj4PB6ZQ+FS0hQahpldPya1kXTOqNY8DscgG+HavAttUCvBxInitrkgL4lcO33c7spBdM3kAuSnq2nx9gQfAh4JyVwvrxwel2z3p4aMlzH6DM2z/lT+8aB+Q/OT4EEqckWQSBkGD6EQKQnDCLwBSnYgcf32fXioGUFawC4esyu7CXXnDP9tOCsyD4KLB1rmgvX7zfbu2WG/Jtme0/3U/vKxBNAMoi0KcjkATCN3HOEr3UAjDrwOP71rXixYEkeKMFlSX8ocwR6KUXTJ7AaNE2tF8WfA4Ye7Kw1mwvX/yZn+eKnvcrfzC6IK/ObP/pfnpfAGQnySoISBqUXyAASS1AK0JfagWYcRDOrAF66TxZQU7jBOEbM0egH71gcgXSFZAV54NQtj9YcNIpbONCyh8Ygi8CVospApDuB63g92W2/3Q/vW8AsqM4gLIKBBIH8bcJwMCNMX68BTqBb8s6sGWtsIA6jwDk662ZI9CvXjA5A6NVa2t/IAicnC/aGV+8T74IQPm/AmGuBc+8/VP+9IEAyLslAKMV/LgAyIUInfnjwPQqMOOgI/DstQ5Mr7UAqMF8V2YXDqoXXNl+EQQ6N9v29aKdesUpWJZbAPyPme0/3U8fGIDssDid/pUASCvCaXgJmFguAEfgEXT27gDkuwaUg/nbmSMwjF7whvbLhSDL5TwwvdRqo9oqHzACkCB8U2b7T/fThwIgO01T1IMCoAZxGRhbKoAXQUcQTjkI+a4B5e5FzjGsXvCG9gdqrLGFYrpVG/UuHzBOw2/LaXxzbh43DKeoJwlAHqLndSs4udoCoIBHQE45EPk3DuitmYOQoxdctp8+rFwIWsGFYiFFoLGNchcEQC6e+OJC5J2Z7T/dTx/aApYdJ37AyJK/DIwvFxYvWr0IwEn/H1Opco5sveDUhSAAF4HJpQJkWixp6k2n4IYfMGf0amDHev2I8+l4/UbvNw8Eozw72wJePOJ8und7EkKj9ztKGA1/7WwATo44n45pWI3e7/AAGPWZ2QBkYHCU+XTMfGGQmYIxjd7vqOE0+PXzATjifDrKtTZ6v4MP/MlyRj4AR5xPF+VaqZLJF1UzKdPV6P2eLDDr3I58AI44n07ZMARbo/d78gMubWE+AEecT8e9YOn2Uheu0fs9tUCYD8AR59MpG6bR+z21gKfW1gNAz4geRT5dTEZo9H5PPRDmAzBmRM8BJzqfLiYjSKKr0fs9dYBYDwBHmE9XtRfMsIz04aQZ1+j9npygrA+Akqs8wfl0BCCTWRq935MTYL1aVQ8Ao1zlAnAi8+kEQGZTNXq/vYb75Pt/fQAcUT5dBGCj93vyAaxXi+oDoFLyT3A+3Rcavd9eY3xS/z8fgCQX/LPR3SOzkon55jg1eyAfgD8M4NcAPD6aDmBtB1e4NMDNcer1QD4AbwbwxwDe4UvRE9wHZG1gNSXDLlwLNcep1QP5APxzzwj9IIAPnXhT5ORc5EYCA9HNcWr1QD4AmRH6FQBMTSZZH98ZmD5Bh5g1FopiNns1x6nTA/kAvAfAEwDudnI+EvQxPfkEzYfaCXRSBluQMB7YHKdGD+QDsBNBH/9+AkAobqTADGK7Inw1x8nfA/kA7EXQt8kgrGAGMfBxZ5Cv5ji5eyAfgL0I+r68uR0QmUFoBQU8vfNvzXHy9kA9AORoMw7CdGQCjoUZDwL4kv/+8OZ1gJhBIjGDgMh3vTavBc035/RAPgD7JegjODfhiMwgoqeJwNPPTaB6Ezq/hq+sB4AcXeXEP+ZhGVo9vRimIQD5v5oPAZCupgDI9wg8/qz/1Xz55usyeyAfgMMQ9GU2Op4eAchpOIJQQEz/VuPlm6/K7IH6AMjgGzdl6QtyX5jWjpQFevF3lq3xf6yhrOlIAUgQCojR8gmE+l9Nl2++JrMH6gEgR5UA5KYsc+AZmCbQCDi+IvgEQMob1XBEAHIajgBMLV+0kCdws6aGu3zqfkV9AGTwjftg3JRVVRAtHQEXX/wbAcoXP5d5CID8GoJKvqDAloKOoIz/y7x8c3pmD4zhaqwjRzCYyQg5gr2ZgsFTLweWr8XQgsXjbwLWrnNtMlKgNoLBmZAa7PTCAuYIBlMvlWQswwr2UlUw45jdDSx8HbD+Ctd+HVCwePKbgJV9aASDM8Yg59TWFDysYPBtmYK91IbNOHaPA/M7gUXKXA4hWDz79cA8+W0aweCMURj+1HYfcBjBYO54MMY3tGDv8I3nmWSHOzYOLJ0LLPGXAQWLz3oB8MQUsEa16kYwOG8whjh74yJkUMFgbsNlCfYO0epwissVY34bsHw2sEIRkAEEi/dcU0SP5qhF1ggG5w3GEGdXr4L5134Fg4kAjuDQgr1DtDqcUmZETwArZwAru4BVqsv0KVh8/o3F4v0QXZBGMDhvMIY4u3MYhv95Zh+Cu1xBcxuOU/HfeDIq5cv7FuwdotXhlCBXjOXZAnyrO4BV6in0IVh8wStLuWCsUAyvEQzOG5ABz+4eB+R/ewnu/kOP/3G/l4kJTERlljQtIot2e53/IwO2OPl4FLtcnCqAp9cahT56CBZf+LpSLhhz1N5qBIPzBmTAs/sLRHcTDKbiNHdBGGymOC/3hglEvgjAnoK9A7Y4+XgiV4zVWYDAs/etxaubYPFFP1QkLtCIP8neaASD8wZkwLP7AyC/tJNg8L/xLNBu+YBdBXsHbHEFAINcMVamgdWZAoRrfPdXm8KitLdmgYveWAq+2y7iMqfuRjA4b1AGOLt/APJLqwSD3+y5T1yI0AoSbAxMMzGV1o8/My2ro2DvAK2t+GgiV4zj4+3AIwDXtwBrVJeuECze+9aW4Dut4PxkIhYsdetGMDhvoDqcPRgA+SWp4O4veQ5Uv/mAGwR78+6rQq4Yq9PAOi2fA4/vBkKudKVU7VZw77uKvWFuZbtcMNb5v0YwOG9g+jx7cADyi6Pg7gccgIxlcA5TKhaD01yYKBmVFpBZMfx/m2Bvny3t8LGqoqTliZbVI+gMgHwnMAnCIFi897cLAAZ6QyzFzzSCwXkD1OPs4QDIL5XgLmk5JHk/SD5gKdibd38VcsVYGmuBTaAzEHLHgyCcaokB7/1IkUET5IKxwF5pBIPzBqbPs4cHIC/AaeqvPL9pmHxAE+zts6VdLCD/lcgVY3UyWD0Bj1ZwqgCggXA7sPfWAoAJvaEtZBrB4Lyx6efsPADyCtmCvf00s/NnOsgVY3m8BTRZPZuGBUACdArY+5lWDqGmYbIrLHEx0ggG5w1OH2fnA7CPizQfaXqgUw80AGywMdIeaAA40u5vLt4AsMHASHugAeBIu7+5eAPABgMj7YEGgCPt/ubiDQAbDIy0BxoAjrT7m4s3AGwwMNIeaAA40u5vLt4AsMHASHugAeBIu7+5eAPABgMj7YEGgCPt/ubiDQAbDIy0B8ZYNMbkX+ZekpuIiOQrPar+xs889HJg6jZg5jAwvVZ8B+ll9PlO5/Fc/o+ECjnHfi8zYfkvM5ulmp4qJXVqx5deD4zfAkw/CGxdAZgoHfuh131QkaI5hu8Bs4Ds8B0AWLnIRGCBsFfn87JffDMwdjOw5R5g8giwZa34jnQQUwDo99wBfJ4TM7COiNdlaj2rA/jeV/vfDeATAP4UGH8I2Lrc6gc+SHqY4oMZ74VSKM0xfA+UUzB/oBUUCKMl6zSQ/PsXqZD5KQC/A0w/DEwcAcYXgYnVwppwADuBkefnCim90FmBWXwnK87Uen53BI8sbuwqaz9p5UgnQhBS+ZN1zE8Ak0utviCwq8DI8/nx5hi+Bzb4gJzKZE1SEFZZgS9/2pWR/gTAJ4HJQ8DEMWB8ARhfBsaWCwDquwQKvvNgHXvOcYVbPFJPkw+dDxC/W1Y4tWDpw/Rlgo4lo1T4/KxTihDNpJwj3/UiMLXemprjffC7eWpzDN8DlYsQDiKtVxzEqoHkyX9HRizW+nIgaQnvAiaeBCbmC0s4tgSMu2rMePAR9X252jXklaTFU108K0MHav/nvJ6ZxVVk9OI7GR2IZoGQNc/HgbHgIwqILIVujuF7oOMqWFawCoRxkfEIB5CWgkREBCNf9wMTc8A4QciBWyoGz16rwNgaML5eWKpctYZL3N+TWLX0gvtuP0HHk2n16JDyxXmVhfU0qywbJbr5GSuXKxA/sV5Y9UYWdnjwyS3qKKgarWA69Wg6fjQOIK0HadnIjPVFB+AiME4AuiUkCFnESyCSkmAuU7Cjm15wX+2X2ifBRn9A8mKcW2UFjULVQcgVDl80u40SYh763FfvquhLCxitoBYUsoJfjXKttByMq9CKcHn4sPuCbgXNJwyWkECcz5Q376UX3LNncZyQAAADEklEQVT9fFgIJs6lBBwtn3Tt6FpIz4RWnuQxPh2XIGzm4CwQ9hWIFgBTK0gQHiIAJddKq0ELQh+KL1qUR4MvSEsoENIKrgALHNiMox+94K7tl9qnnMio8MSf6SNwGpYVjCDk/Ju7isq496fCqX0BkDeqlWwKwic1gAQSpzGREnFgREz01eALLvvq2Kfi45m6cf3qBXdsfxRbJMho8dimqOhEK8cXQRr9QVpvPoDNMXQP9A3ACELFxPh+jACkP0fLIKFCCRRqKuPUdqjlC9o07JZwKVNHeBC94DQcZO0XAAkmgotAk9QYrR9f/BvByYfMSATDVMzwTXMM3QMDAVAgVHCZ7/MaQK4QZUHiNCbBQlqUw74YCb7gcmYkelC9YFlwvVv7RRAorTuBkECU9asCID9/x9B935zYzyKkqpfiNHxcA0gLQgvBAaPVkCqm3h2AtC5m/RyEqzw/4xhGL3hD++MmslgqCbgUfLKAcRrmTlBzDN0DA1tAXUlWcDm1IOIIJAjlT/Fd05lbFQFwjdtgGcewesFt7Rc/Gx8iWjUCjGCT1YvWT1MwgUqrf3NG45tTbcu0aximWx9xENcEQHGbcYAEwtSXSqY0gnCdgeuMI0cvuGx/FUGgFhwEYrR80QckWN+X0fjm1DwAWv8RgJFilJZBznz0pQg+AZAAlVWh1GvGka0XzB0cCQi30aSGVa9AF62fLOB7MhrfnJoPwPER59Px+o3e76mL5Kwp2G57xPl0kxc3er+nLvyKtLmhfUC78RHn081ONnq/pzcAR5xPR9mRRu/31IVgvgUccT4dNaobvd/TGYAjzqejumqj93s6A3DE+XRUg2VSCjdaGr3fUw+I+VPwiPPpqJjO8J1Nw43e7ymHwHoAKMFd7QErAeEE5NNJMb3R+z3lsGcNzgfgiPPpomJ6o/d76oGwPgCOKJ8uKqY3er+nKwBHmE+noqRG7/fUA199U/AI8+kEwEbv93QHoEhZTnA+nYqSGr3fBoAtaiqBUImdm5hPJwA2er+nKwBHnE+X1gUzSbnR+z11wPj/AeCpPDD3t7rvAAAAAElFTkSuQmCC",CFe="uniform sampler2D weightMap;varying vec2 vOffset0;varying vec2 vOffset1;void movec(const in bvec2 c,inout vec2 variable,const in vec2 value){if(c.x){variable.x=value.x;}if(c.y){variable.y=value.y;}}void movec(const in bvec4 c,inout vec4 variable,const in vec4 value){movec(c.xy,variable.xy,value.xy);movec(c.zw,variable.zw,value.zw);}void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec4 a;a.x=texture2D(weightMap,vOffset0).a;a.y=texture2D(weightMap,vOffset1).g;a.wz=texture2D(weightMap,uv).rb;vec4 color=inputColor;if(dot(a,vec4(1.0))>=1e-5){bool h=max(a.x,a.z)>max(a.y,a.w);vec4 blendingOffset=vec4(0.0,a.y,0.0,a.w);vec2 blendingWeight=a.yw;movec(bvec4(h),blendingOffset,vec4(a.x,0.0,a.z,0.0));movec(bvec2(h),blendingWeight,a.xz);blendingWeight/=dot(blendingWeight,vec2(1.0));vec4 blendingCoord=blendingOffset*vec4(texelSize,-texelSize)+uv.xyxy;color=blendingWeight.x*texture2D(inputBuffer,blendingCoord.xy);color+=blendingWeight.y*texture2D(inputBuffer,blendingCoord.zw);}outputColor=color;}",_Fe="varying vec2 vOffset0;varying vec2 vOffset1;void mainSupport(const in vec2 uv){vOffset0=uv+texelSize*vec2(1.0,0.0);vOffset1=uv+texelSize*vec2(0.0,1.0);}",Td={LOW:0,MEDIUM:1,HIGH:2,ULTRA:3},D9=class extends Cl{constructor({preset:e=Td.MEDIUM,edgeDetectionMode:t=qw.COLOR,predicationMode:r=b4e.DISABLED}={}){super("SMAAEffect",CFe,{vertexShader:_Fe,blendFunction:Pr.NORMAL,attributes:cl.CONVOLUTION|cl.DEPTH,uniforms:new Map([["weightMap",new rt(null)]])});let i,n;arguments.length>1&&(i=arguments[0],n=arguments[1],arguments.length>2&&(e=arguments[2]),arguments.length>3&&(t=arguments[3])),this.renderTargetEdges=new jr(1,1,{minFilter:hr,stencilBuffer:!1,depthBuffer:!1}),this.renderTargetEdges.texture.name="SMAA.Edges",this.renderTargetWeights=this.renderTargetEdges.clone(),this.renderTargetWeights.texture.name="SMAA.Weights",this.uniforms.get("weightMap").value=this.renderTargetWeights.texture,this.clearPass=new ZD(!0,!1,!1),this.clearPass.overrideClearColor=new Bt(0),this.clearPass.overrideClearAlpha=1,this.edgeDetectionPass=new as(new x4e),this.edgeDetectionMaterial.edgeDetectionMode=t,this.edgeDetectionMaterial.predicationMode=r,this.weightsPass=new as(new P4e);let a=new I8;a.onLoad=()=>{let o=new Ri(i);o.name="SMAA.Search",o.magFilter=Wr,o.minFilter=Wr,o.generateMipmaps=!1,o.needsUpdate=!0,o.flipY=!0,this.weightsMaterial.searchTexture=o;let s=new Ri(n);s.name="SMAA.Area",s.magFilter=hr,s.minFilter=hr,s.generateMipmaps=!1,s.needsUpdate=!0,s.flipY=!1,this.weightsMaterial.areaTexture=s,this.dispatchEvent({type:"load"})},a.itemStart("search"),a.itemStart("area"),i!==void 0&&n!==void 0?(a.itemEnd("search"),a.itemEnd("area")):typeof Image<"u"&&(i=new Image,n=new Image,i.addEventListener("load",()=>a.itemEnd("search")),n.addEventListener("load",()=>a.itemEnd("area")),i.src=F4,n.src=N4),this.applyPreset(e)}get edgesTexture(){return this.renderTargetEdges.texture}getEdgesTexture(){return this.edgesTexture}get weightsTexture(){return this.renderTargetWeights.texture}getWeightsTexture(){return this.weightsTexture}get edgeDetectionMaterial(){return this.edgeDetectionPass.fullscreenMaterial}get colorEdgesMaterial(){return this.edgeDetectionMaterial}getEdgeDetectionMaterial(){return this.edgeDetectionMaterial}get weightsMaterial(){return this.weightsPass.fullscreenMaterial}getWeightsMaterial(){return this.weightsMaterial}setEdgeDetectionThreshold(e){this.edgeDetectionMaterial.edgeDetectionThreshold=e}setOrthogonalSearchSteps(e){this.weightsMaterial.orthogonalSearchSteps=e}applyPreset(e){let t=this.edgeDetectionMaterial,r=this.weightsMaterial;switch(e){case Td.LOW:t.edgeDetectionThreshold=.15,r.orthogonalSearchSteps=4,r.diagonalDetection=!1,r.cornerDetection=!1;break;case Td.MEDIUM:t.edgeDetectionThreshold=.1,r.orthogonalSearchSteps=8,r.diagonalDetection=!1,r.cornerDetection=!1;break;case Td.HIGH:t.edgeDetectionThreshold=.1,r.orthogonalSearchSteps=16,r.diagonalSearchSteps=8,r.cornerRounding=25,r.diagonalDetection=!0,r.cornerDetection=!0;break;case Td.ULTRA:t.edgeDetectionThreshold=.05,r.orthogonalSearchSteps=32,r.diagonalSearchSteps=16,r.cornerRounding=25,r.diagonalDetection=!0,r.cornerDetection=!0;break}}setDepthTexture(e,t=Mc){this.edgeDetectionMaterial.depthBuffer=e,this.edgeDetectionMaterial.depthPacking=t}update(e,t,r){this.clearPass.render(e,this.renderTargetEdges),this.edgeDetectionPass.render(e,t,this.renderTargetEdges),this.weightsPass.render(e,this.renderTargetEdges,this.renderTargetWeights)}setSize(e,t){this.edgeDetectionMaterial.setSize(e,t),this.weightsMaterial.setSize(e,t),this.renderTargetEdges.setSize(e,t),this.renderTargetWeights.setSize(e,t)}dispose(){let{searchTexture:e,areaTexture:t}=this.weightsMaterial;e!==null&&t!==null&&(e.dispose(),t.dispose()),super.dispose()}static get searchImageDataURL(){return F4}static get areaImageDataURL(){return N4}},AFe=`uniform float offset;uniform float darkness;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){const vec2 center=vec2(0.5);vec3 color=inputColor.rgb;
#if VIGNETTE_TECHNIQUE == 0
float d=distance(uv,center);color*=smoothstep(0.8,offset*0.799,d*(darkness+offset));
#else
vec2 coord=(uv-center)*vec2(offset);color=mix(color,vec3(1.0-darkness),dot(coord,coord));
#endif
outputColor=vec4(color,inputColor.a);}`,gb={DEFAULT:0,ESKIL:1},MFe=class extends Cl{constructor({blendFunction:e=Pr.NORMAL,technique:t=gb.DEFAULT,eskil:r=!1,offset:i=.5,darkness:n=.5}={}){super("VignetteEffect",AFe,{blendFunction:e,defines:new Map([["VIGNETTE_TECHNIQUE",t.toFixed(0)]]),uniforms:new Map([["offset",new rt(i)],["darkness",new rt(n)]])})}get technique(){return Number(this.defines.get("VIGNETTE_TECHNIQUE"))}set technique(e){this.technique!==e&&(this.defines.set("VIGNETTE_TECHNIQUE",e.toFixed(0)),this.setChanged())}get eskil(){return this.technique===gb.ESKIL}set eskil(e){this.technique=e?gb.ESKIL:gb.DEFAULT}getTechnique(){return this.technique}setTechnique(e){this.technique=e}get offset(){return this.uniforms.get("offset").value}set offset(e){this.uniforms.get("offset").value=e}getOffset(){return this.offset}setOffset(e){this.offset=e}get darkness(){return this.uniforms.get("darkness").value}set darkness(e){this.uniforms.get("darkness").value=e}getDarkness(){return this.darkness}setDarkness(e){this.darkness=e}},Ec=class{constructor(e,t){this.enabled=!1,this.effect=new e(t),Object.defineProperty(this,"opacity",{enumerable:!0,set(r){this.effect.blendMode.opacity.value=r},get(){return this.effect.blendMode.opacity.value}}),Object.defineProperty(this,"blendFunction",{enumerable:!0,set(r){this.effect.blendMode.setBlendFunction(Number(r))},get(){return this.effect.blendMode.blendFunction}}),this.blendFunction=Pr.NORMAL}},EFe=class extends Ec{constructor(){super(sFe),this.blendFunction=Pr.SCREEN}set intensity(e){this.effect.intensity=e}get intensity(){return this.effect.intensity}set luminanceThreshold(e){this.effect.luminanceMaterial.threshold=e}get luminanceThreshold(){return this.effect.luminanceMaterial.threshold}set luminanceSmoothing(e){this.effect.luminanceMaterial.smoothing=e}get luminanceSmoothing(){return this.effect.luminanceMaterial.smoothing}set blurScale(e){this.effect.blurPass.scale=e}get blurScale(){return this.effect.blurPass.scale}set kernelSize(e){this.effect.blurPass.kernelSize=e}get kernelSize(){return this.effect.blurPass.kernelSize}},TFe=class extends Ec{constructor(){super(cFe)}set contrast(e){this.effect.uniforms.get("contrast").value=e}get contrast(){return this.effect.uniforms.get("contrast").value}set brightness(e){this.effect.uniforms.get("brightness").value=e}get brightness(){return this.effect.uniforms.get("brightness").value}},PFe=class extends Ec{constructor(){super(pFe),this.effect.offset=new ye(.01,.01)}set offset(e){this.effect.offset.set(e[0]/1e3,e[1]/1e3)}get offset(){return[this.effect.offset.x*1e3,this.effect.offset.y*1e3]}},DFe=class extends Ec{constructor(){super(dFe)}},OFe=class extends Ec{constructor(){super(yFe),this._hue=0}set hue(e){this._hue=e,this.effect.setHue(e)}get hue(){return this._hue}set saturation(e){this.effect.uniforms.get("saturation").value=e}get saturation(){return this.effect.uniforms.get("saturation").value}},RFe=class extends Ec{constructor(){super(xFe),this.blendFunction=Pr.OVERLAY}},IFe=class extends Ec{constructor(){super(MFe)}get eskil(){return this.effect.eskil}set eskil(e){this.effect.eskil=e}get darkness(){return this.effect.uniforms.get("darkness").value}set darkness(e){this.effect.uniforms.get("darkness").value=e}get offset(){return this.effect.uniforms.get("offset").value}set offset(e){this.effect.uniforms.get("offset").value=e}},zFe=class extends Ec{constructor(e){super(vFe)}set focalLength(e){this.effect.circleOfConfusionMaterial.uniforms.focalLength.value=e/2e3}get focalLength(){return this.effect.circleOfConfusionMaterial.uniforms.focalLength.value}set focusDistance(e){this.effect.circleOfConfusionMaterial.uniforms.focusDistance.value=this.isPerspectiveCamera?e/2e3:(e+992)/2e3}get focusDistance(){return this.effect.circleOfConfusionMaterial.uniforms.focusDistance.value}get bokehScale(){return this.effect.bokehScale}set bokehScale(e){this.effect.bokehScale=e}setCamera(e){let t=!1;(e.isPerspectiveCamera&&this.isPerspectiveCamera===!1||!e.isPerspectiveCamera&&this.isPerspectiveCamera===!0)&&(t=!0),e.isPerspectiveCamera?(this.effect.circleOfConfusionMaterial.adoptCameraSettings(e.perspCamera),this.isPerspectiveCamera=!0):(this.effect.circleOfConfusionMaterial.adoptCameraSettings(e),this.isPerspectiveCamera=!1),t&&this.effect.setChanged()}},kFe=class extends Ec{constructor(){super(SFe)}get granularity(){return this.effect.getGranularity()}set granularity(e){this.effect.setGranularity(e)}},LFe=`#define GLSLIFY 1
varying vec2 vUv;varying vec2 vTexCoords[9];uniform vec2 resolution;void main(){vUv=position.xy*0.5+0.5;vec2 texelSize=vec2(1.0)/resolution;vTexCoords[0]=vUv+vec2(-texelSize.x,-texelSize.y);vTexCoords[1]=vUv+vec2(0.0,-texelSize.y);vTexCoords[2]=vUv+vec2(texelSize.x,-texelSize.y);vTexCoords[3]=vUv+vec2(-texelSize.x,0.0);vTexCoords[4]=vUv+vec2(0.0,0.0);vTexCoords[5]=vUv+vec2(texelSize.x,0.0);vTexCoords[6]=vUv+vec2(-texelSize.x,texelSize.y);vTexCoords[7]=vUv+vec2(0.0,texelSize.y);vTexCoords[8]=vUv+vec2(texelSize.x,texelSize.y);gl_Position=vec4(position.xy,1.0,1.0);}`,BFe=`#define GLSLIFY 1
#include <common>
varying vec2 vUv;varying vec2 vTexCoords[9];uniform sampler2D inputBuffer;uniform sampler2D historyBuffer;uniform sampler2D velocityBuffer;uniform sampler2D depthBuffer;uniform vec2 resolution;
#define USE_YCOCG
#define USE_CATMULL_ROM
const float feedback_min=0.5;const float feedback_max=0.95;vec3 RGB_YCoCg(vec3 c){return vec3(c.x/4.0+c.y/2.0+c.z/4.0,c.x/2.0-c.z/2.0,-c.x/4.0+c.y/2.0-c.z/4.0);}vec3 YCoCg_RGB(vec3 c){return clamp(vec3(c.x+c.y-c.z,c.x+c.z,c.x-c.y-c.z),vec3(0.0),vec3(1.0));}vec4 sample_color(sampler2D tex,vec2 uv){
#ifdef USE_YCOCG
vec4 c=texture(tex,uv);return vec4(RGB_YCoCg(c.rgb),c.a);
#else
return texture(tex,uv);
#endif
}vec4 sample_catmull_rom(sampler2D tex,vec2 uv,vec2 texSize){vec2 samplePos=uv*texSize;vec2 texPos1=floor(samplePos-0.5)+0.5;vec2 f=samplePos-texPos1;vec2 w0=f*(-0.5+f*(1.0-0.5*f));vec2 w1=1.0+f*f*(-2.5+1.5*f);vec2 w2=f*(0.5+f*(2.0-1.5*f));vec2 w3=f*f*(-0.5+0.5*f);vec2 w12=w1+w2;vec2 offset12=w2/(w1+w2);vec2 texPos0=texPos1-1.0;vec2 texPos3=texPos1+2.0;vec2 texPos12=texPos1+offset12;texPos0/=texSize;texPos3/=texSize;texPos12/=texSize;vec4 result=vec4(0.0);result+=texture2D(tex,vec2(texPos12.x,texPos0.y))*w12.x*w0.y;result+=texture2D(tex,vec2(texPos0.x,texPos12.y))*w0.x*w12.y;result+=texture2D(tex,vec2(texPos12.x,texPos12.y))*w12.x*w12.y;result+=texture2D(tex,vec2(texPos3.x,texPos12.y))*w3.x*w12.y;result+=texture2D(tex,vec2(texPos12.x,texPos3.y))*w12.x*w3.y;return result;}vec3 choose_motion_vector(){
#ifdef CHOOSE_LONGEST_MOTION_VECTOR
float longest=-1.0;vec3 v_choose=vec3(-1.0);for(int i=0;i<9;i++){vec3 v=texture2D(velocityBuffer,vTexCoords[i]).rgb;float l=length(v.xy);if(l>longest){longest=l;v_choose=v;}}return v_choose;
#else
float closest_depth=1000.0;vec2 closest_uv_offset=vec2(0.0);for(int i=0;i<9;i++){float neighbor_depth=texture2D(depthBuffer,vTexCoords[i]).r;if(neighbor_depth<closest_depth){closest_uv_offset=vTexCoords[i];closest_depth=neighbor_depth;}}return texture2D(velocityBuffer,closest_uv_offset).rgb;
#endif
}vec4 clipAabb(vec3 aabb_min,vec3 aabb_max,vec4 avg,vec4 input_texel){const float FLT_EPS=0.00000001;vec3 p_clip=0.5*(aabb_max+aabb_min);vec3 e_clip=0.5*(aabb_max-aabb_min)+FLT_EPS;vec4 v_clip=input_texel-vec4(p_clip,avg.w);vec3 v_unit=v_clip.xyz/e_clip;vec3 a_unit=abs(v_unit);float ma_unit=max(a_unit.x,max(a_unit.y,a_unit.z));if(ma_unit>1.0){return vec4(p_clip,avg.w)+v_clip/ma_unit;}else{return input_texel;}}vec3 clip_aabb_variance(in vec3 cOld,in vec3 cNew,in vec3 centre,in vec3 halfSize){if(all(lessThanEqual(abs(cOld-centre),halfSize))){return cOld;}vec3 dir=(cNew-cOld);vec3 near=centre-sign(dir)*halfSize;vec3 tAll=(near-cOld)/dir;float t=0.0001;for(int i=0;i<3;i++){if(tAll[i]>=0.0&&tAll[i]<t){t=tAll[i];}}if(t>=0.0001){return cOld;}return cOld+dir*t;}void main(){vec3 v=choose_motion_vector();vec2 velocity=v.rg;vec2 previousPixelPos=vUv-velocity;vec4 currentColor=sample_color(inputBuffer,vUv);
#ifdef USE_CATMULL_ROM
vec4 previousColor=sample_catmull_rom(historyBuffer,previousPixelPos,resolution);
#else
vec4 previousColor=sample_color(historyBuffer,previousPixelPos);
#endif
#ifdef USE_YCOCG
previousColor=vec4(RGB_YCoCg(previousColor.rgb),previousColor.a);
#endif
vec4 ctl=sample_color(inputBuffer,vTexCoords[0]);vec4 ctc=sample_color(inputBuffer,vTexCoords[1]);vec4 ctr=sample_color(inputBuffer,vTexCoords[2]);vec4 cml=sample_color(inputBuffer,vTexCoords[3]);vec4 cmc=sample_color(inputBuffer,vTexCoords[4]);vec4 cmr=sample_color(inputBuffer,vTexCoords[5]);vec4 cbl=sample_color(inputBuffer,vTexCoords[6]);vec4 cbc=sample_color(inputBuffer,vTexCoords[7]);vec4 cbr=sample_color(inputBuffer,vTexCoords[8]);vec4 cmin=min(ctl,min(ctc,min(ctr,min(cml,min(cmc,min(cmr,min(cbl,min(cbc,cbr))))))));vec4 cmax=max(ctl,max(ctc,max(ctr,max(cml,max(cmc,max(cmr,max(cbl,max(cbc,cbr))))))));vec4 cavg=(ctl+ctc+ctr+cml+cmc+cmr+cbl+cbc+cbr)/9.0;vec4 cmin5=min(ctc,min(cml,min(cmc,min(cmr,cbc))));vec4 cmax5=max(ctc,max(cml,max(cmc,max(cmr,cbc))));vec4 cavg5=(ctc+cml+cmc+cmr+cbc)/5.0;cmin=0.5*(cmin+cmin5);cmax=0.5*(cmax+cmax5);cavg=0.5*(cavg+cavg5);
#ifdef USE_YCOCG
vec2 chroma_extent=vec2(0.25*0.5*(cmax.r-cmin.r));vec2 chroma_center=currentColor.gb;cmin.yz=chroma_center-chroma_extent;cmax.yz=chroma_center+chroma_extent;cavg.yz=chroma_center;
#endif
vec4 previousColorClipped=clamp(previousColor,cmin,cmax);
#ifdef LUMINANCE_DIFFERENCES
#ifdef USE_YCOCG
float lum0=currentColor.r;float lum1=previousColorClipped.r;
#else
float lum0=luminance(currentColor.rgb);float lum1=luminance(previousColorClipped.rgb);
#endif
float unbiased_diff=abs(lum0-lum1)/max(lum0,max(lum1,0.2));float unbiased_weight=1.0-unbiased_diff;float unbiased_weight_sqr=unbiased_weight*unbiased_weight;float k_feedback=mix(feedback_min,feedback_max,unbiased_weight_sqr);vec4 result=mix(currentColor,previousColorClipped,vec4(k_feedback));
#else
const float alpha=0.1;vec4 result=mix(currentColor,previousColorClipped,1.0-alpha);
#endif
#ifdef USE_YCOCG
gl_FragColor=vec4(YCoCg_RGB(result.rgb).rgb,result.a);
#else
gl_FragColor=result;
#endif
}`,FFe=`#define GLSLIFY 1
varying vec2 vUv;void main(){gl_Position=vec4(position.xy,1.0,1.0);vUv=position.xy*0.5+0.5;}`,NFe=`#define GLSLIFY 1
layout(location=1)out vec4 gVelocity;varying vec2 vUv;uniform sampler2D inputBuffer;void main(){gl_FragColor=texture2D(inputBuffer,vUv);gVelocity=vec4(0.0);}`,WE=class extends Vr{constructor(){super({name:"PassthroughMaterial",uniforms:{inputBuffer:new rt(null)},blending:un,depthWrite:!1,depthTest:!1,vertexShader:FFe,fragmentShader:NFe})}set inputBuffer(e){this.uniforms.inputBuffer.value=e}},UFe=class extends Ua{constructor(){super("TAAResolvePass"),this.MRTCompatible=!0,this.needsSwap=!1,this.passThroughMaterial=new WE,this.resolutionVector=new ye,this.resolveMaterial=new Vr({name:"TAAResolveMaterial",uniforms:{inputBuffer:new rt(null),historyBuffer:new rt(null),velocityBuffer:new rt(null),depthBuffer:new rt(null),resolution:new rt(new ye)},blending:un,depthWrite:!1,depthTest:!1,vertexShader:LFe,fragmentShader:BFe}),this.historyRenderTarget=new jr(1024,1024,{minFilter:hr,stencilBuffer:!1,depthBuffer:!1}),this.historyRenderTarget.texture.name="TAA.History",this.resultRenderTarget=new jr(1024,1024,{minFilter:hr,stencilBuffer:!1,depthBuffer:!1}),this.resultRenderTarget.texture.name="TAA.Output"}setSize(e,t){this.historyRenderTarget.setSize(e,t),this.resultRenderTarget.setSize(e,t)}render(e,t){this.fullscreenMaterial=this.resolveMaterial,this.resolveMaterial.uniforms.inputBuffer.value=t.texture[0],this.resolveMaterial.uniforms.velocityBuffer.value=t.texture[1],this.resolveMaterial.uniforms.depthBuffer.value=t.depthTexture,this.resolveMaterial.uniforms.historyBuffer.value=this.historyRenderTarget.texture,this.resolveMaterial.uniforms.resolution.value.set(t.width,t.height),e.setRenderTarget(this.resultRenderTarget),e.render(this.scene,this.camera),this.fullscreenMaterial=this.passThroughMaterial,this.passThroughMaterial.inputBuffer=this.resultRenderTarget.texture,e.setRenderTarget(this.historyRenderTarget),e.render(this.scene,this.camera);let r=this.renderToScreen?null:t;this.fullscreenMaterial=this.passThroughMaterial,this.passThroughMaterial.inputBuffer=this.resultRenderTarget.texture,e.setRenderTarget(r),e.render(this.scene,this.camera)}dispose(){this.resultRenderTarget.dispose(),this.historyRenderTarget.dispose(),this.resolveMaterial.dispose(),this.passThroughMaterial.dispose()}},jFe=class extends Ua{constructor(e,t,r){super("TransmissionPass",void 0,t),this.MRTCompatible=!0,this.depthPass=new L4(e,t,{renderTarget:r.transmissionDepthTarget}),this.passThroughMaterial=new WE,this.splineScene=e,this.needsSwap=!1}updatePasses(e){this.passThroughMaterial=new WE,this.depthPass=new L4(this.splineScene,this.camera,{renderTarget:e.transmissionDepthTarget})}setCamera(e){this.camera=e}setScene(e){this.splineScene=e}render(e,t,r){let i=this.camera.layers.mask,n=e;n.setRenderTarget(n.transmissionRenderTarget),this.fullscreenMaterial=this.passThroughMaterial,this.passThroughMaterial.inputBuffer=t.texture[0],n.clear(),n.render(this.scene,this.camera),this.camera.layers.disable(3),this.depthPass.render(e,t,r),n.shadowMap.needsUpdate=!1,n.shadowMap.autoUpdate=!1;let a=this.renderToScreen?null:t;this.camera.layers.set(3),e.setRenderTarget(a),e.render(this.splineScene,this.camera),this.camera.layers.mask=i}},U4=new ll,VFe=new Vr({transparent:!0,vertexShader:`
        void main() {
            gl_Position = vec4(0.0);
        }
    `,fragmentShader:`
        layout(location = 1) out vec4 gVelocity;

        void main() {
            gl_FragColor = vec4(0.0);
			gVelocity = vec4(0.0);
        }
    `}),GE=class extends Ua{constructor(e,t,r){super("OpaquePass",t??U4,r),this.MRTCompatible=!0,this.hasTransmissionPass=!1,this.clear=!0,this.clearColorOnly=!1,this.clearDepth=!1,this.needsSwap=!1,this.originalMaterials=new Map,this.MRTCompatible=e}setCamera(e){this.camera=e}setScene(e){this.scene=e??U4}getScene(){return this.scene}render(e,t){this.camera.layers.enable(3),this.hasTransmissionPass&&(this.originalMaterials.clear(),this.scene.traverse(i=>{i.layers.isEnabled(3)&&i instanceof Fa&&(this.originalMaterials.set(i.id,i.material),i.material=VFe)}),e.shadowMap.needsUpdate=!0,e.shadowMap.autoUpdate=!0),this.camera.layers.enable(8);let r=this.renderToScreen?null:t;e.setRenderTarget(r),this.clearColorOnly&&e.clear(!0,!1,!0),this.clear&&e.clear(),e.render(this.scene,this.camera),this.clearDepth&&e.clear(!1,!0,!1),this.hasTransmissionPass&&this.originalMaterials.forEach((i,n)=>{let a=this.scene.getObjectById(n);a&&(a.material=i)})}},HFe=class{constructor(e,{depthBuffer:t=!0,stencilBuffer:r=!1,multisampling:i=0,frameBufferType:n=0}={}){this.renderer=e,this.helperStartIndex=0,this.copyPass=new HE,this.depthTexture=null,this.timer=new aFe,this._width=1,this._height=1,this.passes=[],this.helperPasses=[],this.autoRenderToScreen=!0,this.inputBuffer=this.createBuffer(t,r,n,i,!0,"input buffer mrt"),this.inputBufferSingle=this.createBuffer(t,r,n,i,!1," input buffer single"),this.inputBufferSingle.texture.dispose(),this.inputBufferSingle.depthTexture.dispose(),this.inputBufferSingle.texture=this.inputBuffer.texture[0],this.inputBufferSingle.depthTexture=this.inputBuffer.depthTexture,this.outputBuffer=this.inputBuffer.clone(),this.outputBuffer.name="output buffer mrt",this.outputBufferSingle=this.createBuffer(t,r,n,i,!1,"output buffer single"),this.outputBufferSingle.texture.dispose(),this.outputBufferSingle.depthTexture.dispose(),this.outputBufferSingle.texture=this.outputBuffer.texture[0],this.outputBufferSingle.depthTexture=this.outputBuffer.depthTexture,this.setRenderer(e)}get multisampling(){return this.inputBuffer.samples||0}set multisampling(e){let t=this.inputBuffer,r=this.multisampling;r>0&&e>0?(this.inputBuffer.samples=e,this.outputBuffer.samples=e,this.inputBuffer.dispose(),this.outputBuffer.dispose()):r!==e&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),console.log("creating new input buffer"),this.inputBuffer=this.createBuffer(t.depthBuffer,t.stencilBuffer,t.texture.type,e,!0,"new input buffer"),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}getTimer(){return this.timer}getRenderer(){return this.renderer}setRenderer(e){var t;if(this.renderer=e,e!==null){let r=e.getSize(new ye),i=((t=e.getContext().getContextAttributes())==null?void 0:t.alpha)??!1,n=this.inputBuffer.texture[0].type;n===wa&&e.outputEncoding===lr&&(this.inputBuffer.texture[0].encoding=lr,this.outputBuffer.texture[0].encoding=lr,this.inputBuffer.dispose(),this.outputBuffer.dispose(),console.log("doing some kinda dispose??")),e.autoClear=!1,this.setSize(r.width,r.height,!1);for(let a of this.passes)a.initialize(e,i,n)}}replaceRenderer(e,t=!0){let r=this.renderer,i=r.domElement.parentNode;return this.setRenderer(e),t&&i!==null&&(i.removeChild(r.domElement),i.appendChild(e.domElement)),r}createDepthTexture(){let e=this.depthTexture=new Lp(this._width,this._height);return this.inputBuffer.depthTexture=e,this.inputBuffer.stencilBuffer?(e.format=mh,e.type=Zd):e.type=Jl,e}deleteDepthTexture(){if(this.depthTexture!==null){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();for(let e of this.passes)e.setDepthTexture(null)}}createBuffer(e,t,r,i,n,a){let o=this.renderer,s=o===null?new ye:o.getDrawingBufferSize(new ye),l={minFilter:hr,magFilter:hr,wrapS:_i,wrapT:_i,stencilBuffer:t,depthBuffer:e},c;return i>0?(c=new jr(s.width,s.height,l),c.samples=i):(n?(c=new axe(s.width,s.height,2,l),c.texture[1].type=dc):c=new jr(s.width,s.height,l),c.depthTexture=new Lp(2048,2048),c.depthTexture.type=ln),r===wa&&o!==null&&o.outputEncoding===lr&&(Array.isArray(c.texture)?c.texture.forEach(u=>u.encoding=lr):c.texture.encoding=lr),Array.isArray(c.texture)?c.texture.forEach((u,d)=>{u.name=`EffectComposer.Buffer ${n} ${d}`,u.generateMipmaps=!1}):(c.texture.name=`EffectComposer.Buffer ${n}`,c.texture.generateMipmaps=!1),c.name=a,c}addPass(e,t){var s;let r=this.passes,i=this.renderer,n=i.getDrawingBufferSize(new ye),a=((s=i.getContext().getContextAttributes())==null?void 0:s.alpha)??!1,o;if(e.MRTCompatible&&(o=this.inputBuffer.texture[0].type),e.MRTCompatible||(o=this.inputBuffer.texture.type),e.setRenderer(i),e.setSize(n.width,n.height),e.initialize(i,a,o),this.autoRenderToScreen&&(r.length>0&&(r[r.length-1].renderToScreen=!1),e.renderToScreen&&(this.autoRenderToScreen=!1)),t!==void 0?r.splice(t,0,e):r.push(e),this.autoRenderToScreen&&(r[r.length-1].renderToScreen=!0),e.needsDepthTexture||this.depthTexture!==null)if(this.depthTexture===null){let l=this.createDepthTexture();for(e of r)e.setDepthTexture(l)}else e.setDepthTexture(this.depthTexture)}setHelperStartIndex(e){this.helperStartIndex=e}removePass(e){let t=this.passes,r=t.indexOf(e);if(r!==-1&&t.splice(r,1).length>0){if(this.depthTexture!==null){let i=(n,a)=>n||a.needsDepthTexture;t.reduce(i,!1)||e.getDepthTexture()===this.depthTexture&&e.setDepthTexture(null)}this.autoRenderToScreen&&r===t.length&&(e.renderToScreen=!1,t.length>0&&(t[t.length-1].renderToScreen=!0))}}removeAllPasses(){let e=this.passes;e.length>0&&(this.autoRenderToScreen&&(e[e.length-1].renderToScreen=!1),this.passes=[])}render(e){let t=this.renderer,r=this.copyPass,i=this.inputBuffer,n=this.outputBuffer,a=this.inputBufferSingle,o=this.outputBufferSingle,s=!1,l,c,u,d;e===void 0&&(e=this.timer.update().getDelta());for(let h of this.passes)h.enabled&&(h.MRTCompatible?h.render(t,i,n,e,s):h.render(t,a,o,e,s),h.needsSwap&&(s&&(r.renderToScreen=h.renderToScreen,l=t.getContext(),c=t.state.buffers.stencil,c.setFunc(l.NOTEQUAL,1,4294967295),r.render(t,i,n,e,s),c.setFunc(l.EQUAL,1,4294967295)),u=i,d=a,i=n,a=o,n=u,o=d),h instanceof iFe?s=!0:h instanceof R4e&&(s=!1))}setSize(e,t,r){let i=this.renderer;if(this._width=e,this._height=t,e===void 0||t===void 0){let a=i.getSize(new ye);e=a.width,t=a.height}i.setSize(e,t,r);let n=i.getDrawingBufferSize(new ye);this.inputBuffer.setSize(n.width,n.height),this.outputBuffer.setSize(n.width,n.height),this.inputBufferSingle.setSize(n.width,n.height),this.outputBufferSingle.setSize(n.width,n.height);for(let a of this.passes)a.setSize(n.width,n.height)}reset(){let e=this.timer.isAutoResetEnabled();this.dispose(),this.autoRenderToScreen=!0,this.timer.setAutoResetEnabled(e)}dispose(){for(let e of this.passes)e.dispose();this.passes=[],this.inputBuffer!==null&&this.inputBuffer.dispose(),this.outputBuffer!==null&&this.outputBuffer.dispose(),this.inputBufferSingle!==null&&this.inputBufferSingle.dispose(),this.outputBufferSingle!==null&&this.outputBufferSingle.dispose(),this.deleteDepthTexture(),this.copyPass.dispose(),this.timer.dispose()}},WFe=new Vr({name:"CombineMaterial",uniforms:{inputBufferA:new rt(null),inputBufferB:new rt(null)},blending:un,depthWrite:!1,depthTest:!1,vertexShader:`
varying vec2 vUv;
void main() {
    gl_Position = vec4(position.xy, 1.0, 1.0);
    vUv = position.xy * 0.5 + 0.5;
}
`,fragmentShader:`
    varying vec2 vUv;
    uniform sampler2D inputBufferA;
    uniform sampler2D inputBufferB;

    // TODO: Why do we need these when postpro of framemode is enabled???
    layout(location = 1) out vec4 gVelocity;

    void main() {
	vec4 resA = texture2D(inputBufferA, vUv);
	vec4 resB = texture2D(inputBufferB, vUv);
    float a = resA.a + resB.a * ( 1.0 - resA.a );

	vec4 res;
	res.rgb =  resA.rgb + (resB.rgb * (1.0 - resA.a));
	res.a = resA.a + resB.a * (1.0 - resA.a);
	gl_FragColor = res;
    gVelocity = vec4(0.0);
    }
`}),GFe=class extends Ua{constructor(e){super("HelperPass",void 0,e),this.MRTCompatible=!1,this.fullscreenMaterial=WFe,this.helperPass=new GE(!1,void 0,this.camera),this.helperPass.hasTransmissionPass=!1,this.helperPass.clear=!1,this.helperPass.renderToScreen=!1,this.helperPassOnTop=new GE(!1,void 0,this.camera),this.helperPassOnTop.hasTransmissionPass=!1,this.helperPassOnTop.clear=!1,this.helperPassOnTop.renderToScreen=!1;let t=new D9({preset:Td.LOW,edgeDetectionMode:qw.COLOR});this.effectPass=new O1(this.camera,t),this.rt=new jr(10,10,{minFilter:hr,magFilter:hr,wrapS:_i,wrapT:_i,depthBuffer:!0})}setSize(e,t){this.rt.setSize(e,t),this.effectPass.setSize(e,t)}set sceneHelpers(e){this.helperPass.setScene(e)}get sceneHelpers(){return this.helperPass.getScene()}set sceneHelpersOnTop(e){this.helperPassOnTop.setScene(e)}get sceneHelpersOnTop(){return this.helperPassOnTop.getScene()}setCamera(e){this.helperPass.setCamera(e),this.helperPassOnTop.setCamera(e)}initialize(e,t,r){super.initialize(e,t,r),this.effectPass.initialize(e,t,r)}dispose(){super.dispose(),this.rt.dispose(),this.effectPass.dispose()}render(e,t,r){this.rt.depthTexture=t.depthTexture;let i=e.getClearAlpha();e.setClearAlpha(0),this.helperPass.clearDepth=!0,this.helperPass.clearColorOnly=!0,this.helperPass.render(e,this.rt),this.helperPassOnTop.render(e,this.rt),this.effectPass.renderToScreen=!1,this.effectPass.render(e,this.rt,r),this.fullscreenMaterial.uniforms.inputBufferA.value=r.texture,this.fullscreenMaterial.uniforms.inputBufferB.value=t.texture,e.setClearAlpha(i),e.setRenderTarget(null),e.clear(),e.render(this.scene,this.camera)}},$Fe=`#define GLSLIFY 1
#include <skinning_pars_vertex>
out vec3 n;void main(){
#include <beginnormal_vertex>
#include <skinbase_vertex>
#include <skinnormal_vertex>
#include <defaultnormal_vertex>
#include <begin_vertex>
#include <skinning_vertex>
vec4 view_space=viewMatrix*modelMatrix*vec4(transformed,1.0);gl_Position=projectionMatrix*view_space;n=normalize(transformedNormal);}`,qFe=`#define GLSLIFY 1
in vec3 n;void main(){gl_FragColor=vec4(n,1.0);}`,YFe=`#define GLSLIFY 1
out vec2 v_uv;void main(){v_uv=uv;gl_Position=vec4(position.xy,1.0,1.0);}`,XFe=`#define GLSLIFY 1
in vec2 v_uv;const float pi=3.14159265;const float num_steps=4.0;const float num_directions=4.0;uniform float near;uniform float far;uniform float fov;uniform vec4 proj_info;uniform bool is_ortho;uniform vec2 resolution;uniform float radius_of_influence;uniform float radius_in_screen_space;uniform float exponent;uniform vec3 ao_color;uniform float bias;uniform sampler2D texture_depth;uniform sampler2D texture_normals;uniform sampler2D texture_blue_noise;uniform sampler2D texture_blue_noise_in_disk;uniform sampler2D texture_color_pass;uniform int frame_index;uniform bool fog_enabled;uniform float fog_near;uniform float fog_far;vec3 uv_to_view_space(vec2 uv,float eye_z){return vec3((uv*proj_info.xy+proj_info.zw)*(is_ortho ? 1.0 : eye_z),eye_z);}float linearize_depth(float depth_sampled){float z=is_ortho ? depth_sampled : depth_sampled*2.0-1.0;return mix((2.0*near*far)/(far+near-z*(far-near)),near+z*(far-near),float(is_ortho));}vec3 get_view_position(vec2 uv_coords){float linear_depth=linearize_depth(texture(texture_depth,uv_coords).x);return uv_to_view_space(uv_coords,linear_depth);}vec3 min_difference(vec3 p,vec3 right,vec3 left){vec3 v1=right-p;vec3 v2=p-left;return(dot(v1,v1)<dot(v2,v2))? v1 : v2;}vec3 rebuild_normal(in vec2 uv,in vec3 p){vec2 one_over_resolution=1.0/resolution;vec3 r=get_view_position(uv+vec2(one_over_resolution.x,0));vec3 l=get_view_position(uv+vec2(-one_over_resolution.x,0));vec3 t=get_view_position(uv+vec2(0,one_over_resolution.y));vec3 b=get_view_position(uv+vec2(0,-one_over_resolution.y));return normalize(cross(min_difference(p,r,l),min_difference(p,t,b)));}float falloff(float distance_squared){float neg_inv_r2=-1.0/(radius_of_influence*radius_of_influence);return distance_squared*neg_inv_r2+1.0;}float ao_contribution(vec3 P,vec3 N,vec3 S){vec3 to_sample=S-P;float norm_squared=dot(to_sample,to_sample);float norm=sqrt(norm_squared);float cos_theta=dot(N,to_sample)/norm;return clamp(cos_theta-bias,0.0,1.0)*clamp(falloff(norm_squared),0.0,1.0);}float compute_ambient_occlusion(vec2 uv,float radius_in_screen_space,vec3 pc,vec3 view_space_n){vec2 one_over_resolution=1.0/resolution;ivec2 noise_uv=ivec2(int(mod(gl_FragCoord.x,128.0)),int(mod(gl_FragCoord.y,128.0)));float noise=texelFetch(texture_blue_noise,noise_uv,0).r;noise=fract(noise+0.61803398875*float(frame_index));float theta=noise*2.0*3.1415;float ct=cos(theta);float st=sin(theta);float step_size=radius_in_screen_space/(num_steps+1.0);const float angle_step=2.0*pi/num_directions;float contribution=0.0;for(int i=0;i<int(num_directions);++i){float current_pixel=step_size+1.0;for(int j=0;j<int(num_steps);++j){int index=i*int(num_steps)+j;vec2 blue_noise_sample=texelFetch(texture_blue_noise_in_disk,ivec2(index,0),0).rg;vec2 disk_point;disk_point.x=blue_noise_sample.x*ct-blue_noise_sample.y*st;disk_point.y=blue_noise_sample.x*st+blue_noise_sample.y*ct;vec2 sample_direction=disk_point;vec2 snapped_uv=round(current_pixel*sample_direction)*one_over_resolution+uv;vec3 ps=get_view_position(snapped_uv);current_pixel+=step_size;contribution+=ao_contribution(pc,view_space_n,ps);}}float mult=1.0/(1.0-bias);contribution*=mult/(num_directions*num_steps);return clamp(1.0-contribution*2.0,0.0,1.0);}
#define USE_GBUFFER_NORMALS
void main(){vec3 view_space_p=get_view_position(v_uv);
#ifdef USE_GBUFFER_NORMALS
vec3 view_space_n=texture(texture_normals,v_uv).rgb;view_space_n.z*=-1.0;
#else
vec3 view_space_n=-rebuild_normal(v_uv,view_space_p);
#endif
float radius_ss=radius_in_screen_space/(is_ortho ? 1.0 : view_space_p.z);float ao=compute_ambient_occlusion(v_uv,radius_ss,view_space_p,view_space_n);float final=pow(ao,exponent);if(view_space_p.z>=far){final=1.0;}vec3 color=mix(ao_color,vec3(1.0),final);if(fog_enabled){float fog_factor=smoothstep(fog_near,fog_far,view_space_p.z);color=mix(color,vec3(1.0),fog_factor);}gl_FragColor=vec4(color,1.0);}`,KFe=`#define GLSLIFY 1
out vec2 v_uv;void main(){gl_Position=vec4(position.xy,1.0,1.0);v_uv=uv;}`,QFe=`#define GLSLIFY 1
in vec2 v_uv;uniform sampler2D texture_ao_lrez;uniform sampler2D texture_depth_lrez;uniform sampler2D texture_depth_hrez;uniform float near;uniform float far;float linearize_depth(float depth_sampled){float z=depth_sampled*2.0-1.0;return(2.0*near*far)/(far+near-z*(far-near));}vec2 nearest_depth_filter(in vec2 uv){vec2 resolution=vec2(textureSize(texture_depth_lrez,0));vec2 texel_size=1.0/resolution;vec2 offset=uv-0.5*texel_size;float d_hrez=texture(texture_depth_hrez,uv).r;float a=abs(d_hrez-texture(texture_depth_lrez,offset).r);float b=abs(d_hrez-texture(texture_depth_lrez,offset+vec2(texel_size.x,0.0)).r);float c=abs(d_hrez-texture(texture_depth_lrez,offset+vec2(0.0,texel_size.y)).r);float d=abs(d_hrez-texture(texture_depth_lrez,offset+vec2(texel_size.x,texel_size.y)).r);float min_diff=min(a,min(b,min(c,d)));if(min_diff==a)return offset;if(min_diff==b)return offset+vec2(texel_size.x,0.0);if(min_diff==c)return offset+vec2(0.0,texel_size.y);if(min_diff==d)return offset+vec2(texel_size.x,texel_size.y);}void main(){
#ifdef DEBUG
float d_lrez=texture(texture_depth_lrez,v_uv).r;float d_hrez=texture(texture_depth_hrez,v_uv).r;float output_d=mix(linearize_depth(d_lrez)/far,linearize_depth(d_hrez)/far,step(0.5,v_uv.x));gl_FragColor=vec4(vec3(output_d),1.0);
#else
vec2 filtered_uv=nearest_depth_filter(v_uv);vec4 ao=texture(texture_ao_lrez,filtered_uv);gl_FragColor=vec4(ao.rgb,1.0);gl_FragColor=ao;
#endif
}`,av=[[.478712,.875764],[-.337956,-.793959],[-.955259,-.028164],[.864527,.325689],[.209342,-.395657],[-.106779,.672585],[.156213,.235113],[-.413644,-.082856],[-.415667,.323909],[.141896,-.93998],[.954932,-.182516],[-.766184,.410799],[-.434912,-.458845],[.415242,-.078724],[.728335,-.491777],[-.058086,-.066401],[.20299,.686837],[-.808362,-.556402],[.507386,-.640839],[-.723494,-.22924],[.48974,.317826],[-.622663,.765301],[-.01064,.929347],[.663146,.647618],[-.096674,-.413835],[.525945,-.321063],[-.122533,.366019],[.195235,-.687983],[-.563203,.098748],[.418563,.561335],[-.378595,.800367],[.826922,.001024],[-.085372,-.766651],[-.92192,.183673],[-.590008,-.721799],[.167751,-.164393],[.032961,-.56253],[.6329,-.107059],[-.46408,.569669],[-.173676,-.958758],[-.242648,-.234303],[-.275362,.157163],[.382295,-.795131],[.562955,.115562],[.190586,.470121],[.770764,-.297576],[.237281,.93105],[-.666642,-.455871],[-.905649,-.298379],[.33952,.157829],[.701438,-.7041],[-.062758,.160346],[-.220674,.957141],[.642692,.432706],[-.77339,-.015272],[-.671467,.24688],[.158051,.062859],[.806009,.527232],[-.05762,-.247071],[.333436,-.51671],[-.550658,-.315773],[-.652078,.589846],[.008818,.530556],[-.210004,.519896]],ZFe=new Vr({vertexShader:$Fe,fragmentShader:qFe}),Cf=new Vr({vertexShader:KFe,fragmentShader:QFe,uniforms:{texture_ao_lrez:new rt(null),texture_depth_lrez:new rt(null),texture_depth_hrez:new rt(null),near:new rt(null),far:new rt(null)}}),JFe=class extends Ua{constructor(e,t){super("AmbientOcclusionPass",void 0,t),this.fogEnabled=!1,this.fogNear=1,this.fogFar=1e3,this.frameIndex=0,this._runHalfRes=!0,this._width=1,this._height=1;let r=1024,i=1024;this.gBuffer=new jr(r,i,{type:S0?dc:ln,depthTexture:new Lp(r,i),minFilter:hr,magFilter:hr}),this.depthBufferHighRes=new jr(r,i,{depthTexture:new Lp(r,i)}),this.aoBuffer=new jr(r,i,{minFilter:hr,magFilter:hr}),this.splineScene=e,this.splineCamera=t;let n=new Float32Array(av.length*2);for(let o=0;o<av.length;o++){let s=o*2;n[s+0]=av[o][0],n[s+1]=av[o][1]}this.blueNoiseInDiskTexture=new Lo(n,av.length,1,Bx,ln),this.blueNoiseInDiskTexture.wrapS=Zl,this.blueNoiseInDiskTexture.wrapT=Zl,this.blueNoiseInDiskTexture.needsUpdate=!0,this.hbaoMaterial=new Vr({vertexShader:YFe,fragmentShader:XFe,uniforms:{near:new rt(null),far:new rt(null),fov:new rt(null),proj_info:new rt(new Qt),is_ortho:new rt(!1),resolution:new rt(new ye),radius_of_influence:new rt(8),radius_in_screen_space:new rt(1),exponent:new rt(1),ao_color:new rt(new k),bias:new rt(.5),texture_depth:new rt(null),texture_normals:new rt(null),texture_blue_noise:new rt(null),texture_blue_noise_in_disk:new rt(this.blueNoiseInDiskTexture),frame_index:new rt(0),fog_enabled:new rt(!1),fog_near:new rt(1),fog_far:new rt(1e3)}}),this.radius=128,this.aoColor={r:0,g:0,b:0},this.bias=.5,this.hbaoMaterial.uniforms.texture_depth.value=this.gBuffer.depthTexture,this.hbaoMaterial.uniforms.texture_normals.value=this.gBuffer.texture,this.needsSwap=!0,this.aaBuffer=new jr(r,i,{minFilter:hr,magFilter:hr,wrapS:_i,wrapT:_i,depthBuffer:!1,type:ln});let a=new D9({preset:Td.ULTRA,edgeDetectionMode:qw.COLOR});this.effectPass=new O1(this.camera,a)}initialize(e,t,r){super.initialize(e,t,r),this.effectPass.initialize(e,t,r)}setBlueNoiseTexture(e){this.hbaoMaterial.uniforms.texture_blue_noise.value=e}setSize(e,t){this._width=e,this._height=t,this.depthBufferHighRes.setSize(e,t);let r=this._runHalfRes?.5:1,i=e*r,n=t*r;this.gBuffer.setSize(i,n),this.aoBuffer.setSize(i,n),this.hbaoMaterial.uniforms.resolution.value.set(i,n),this.aaBuffer.setSize(i,n),this.effectPass.setSize(i,n)}get runHalfRes(){return this._runHalfRes}set runHalfRes(e){this._runHalfRes=e,this.setSize(this._width,this._height)}setCamera(e){this.splineCamera=e}setScene(e){this.splineScene=e}setDepthTexture(e){this.depthBufferHighRes.depthTexture=e,Cf.uniforms.texture_depth_hrez.value=e,Cf.needsUpdate=!0}render(e,t,r){this.splineScene.overrideMaterial=ZFe;let i=this.splineCamera.layers.mask;if(this.splineCamera.layers.set(5),e.setRenderTarget(this.gBuffer),e.clear(),e.render(this.splineScene,this.splineCamera),e.setRenderTarget(this.depthBufferHighRes),e.clear(),e.render(this.splineScene,this.splineCamera),this.splineScene.overrideMaterial=null,this.splineCamera.layers.mask=i,this.hbaoMaterial.uniforms.radius_of_influence.value=this.radius,this.hbaoMaterial.uniforms.ao_color.value.set(this.aoColor.r,this.aoColor.g,this.aoColor.b),this.hbaoMaterial.uniforms.bias.value=this.bias,this.hbaoMaterial.uniforms.fog_enabled.value=this.fogEnabled,this.hbaoMaterial.uniforms.fog_near.value=this.fogNear,this.hbaoMaterial.uniforms.fog_far.value=this.fogFar,this.hbaoMaterial.uniforms.frame_index.value=this.frameIndex,this.frameIndex++,this.splineCamera.isPerspectiveCamera){this.hbaoMaterial.uniforms.near.value=this.splineCamera.perspCamera.near,this.hbaoMaterial.uniforms.far.value=this.splineCamera.perspCamera.far;let n=this.splineCamera.perspCamera.projectionMatrix.elements,a=2/n[0],o=2/n[5],s=-(1-n[8])/n[0],l=-(1+n[9])/n[5];this.hbaoMaterial.uniforms.proj_info.value.set(a,o,s,l);let c=this.splineCamera.perspCamera.fov*(Math.PI/180),u=this.hbaoMaterial.uniforms.resolution.value.y/(Math.tan(c*.5)*2),d=this.hbaoMaterial.uniforms.radius_of_influence.value*.5*u;this.hbaoMaterial.uniforms.radius_in_screen_space.value=d,this.hbaoMaterial.uniforms.is_ortho.value=!1}else{this.hbaoMaterial.uniforms.near.value=this.splineCamera.orthoCamera.near,this.hbaoMaterial.uniforms.far.value=this.splineCamera.orthoCamera.far;let n=this.splineCamera.orthoCamera.projectionMatrix.elements,a=2/n[0],o=2/n[5],s=-(1+n[12])/n[0],l=-(1-n[13])/n[5];this.hbaoMaterial.uniforms.proj_info.value.set(a,o,s,l);let c=.5*(this.hbaoMaterial.uniforms.resolution.value.y/o),u=this.hbaoMaterial.uniforms.radius_of_influence.value*c;this.hbaoMaterial.uniforms.radius_in_screen_space.value=u,this.hbaoMaterial.uniforms.is_ortho.value=!0}this.runHalfRes?(this.fullscreenMaterial=this.hbaoMaterial,e.setRenderTarget(this.aoBuffer),e.clear(),e.render(this.scene,this.camera),this.fullscreenMaterial=Cf,Cf.uniforms.texture_ao_lrez.value=this.aoBuffer.texture,Cf.uniforms.texture_depth_lrez.value=this.gBuffer.depthTexture,Cf.uniforms.texture_depth_hrez.value=this.depthBufferHighRes.depthTexture,e.setRenderTarget(e.aoRenderTarget),e.clear(),e.render(this.scene,this.camera)):(this.fullscreenMaterial=this.hbaoMaterial,e.setRenderTarget(this.aaBuffer),e.clear(),e.render(this.scene,this.camera),this.effectPass.renderToScreen=!1,this.effectPass.render(e,this.aaBuffer,e.aoRenderTarget))}dispose(){this.gBuffer.dispose(),this.depthBufferHighRes.dispose(),this.aoBuffer.dispose()}},e5e=`
varying vec2 vUv;
void main() {
    vUv = uv;
    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,t5e=`
uniform sampler2D tInput;
uniform sampler2D tMap;
uniform vec2 resolution;
varying vec2 vUv;

uniform vec2 uResolution;
uniform vec2 uCoords;

// Draws a rectangle at center <st> with size <size>
float rectangle(vec2 st, vec2 size) {
    size = vec2(0.5) - size * 0.5;
    vec2 uv = vec2(step(size.x, st.x), step(size.y, st.y));
    uv *= vec2(step(size.x, 1.0 - st.x), step(size.y, 1.0 - st.y));

    return uv.x * uv.y;
}

uniform vec2 uSize;
uniform float uScale;
uniform float uDPR;
uniform float uCurrent;
uniform vec3 uSceneColor;

void main() {
    vec2 screenUv = gl_FragCoord.xy / uResolution.xy;
    screenUv *= 1.0 / uDPR;

    vec2 center = vec2(0.5, -0.5);
    vec2 outsideUv = screenUv;
    outsideUv += center;
    outsideUv -= uCoords.xy / uResolution.xy;
    outsideUv = (outsideUv - 0.5) + 0.5;
    outsideUv -= center;
    vec2 s = (uSize / uResolution) * uScale;
    float isOutside = 1.0 - rectangle(outsideUv, s);
    
    vec2 mid = vec2(0.5);
    vec2 insideUv = (screenUv - mid + s * mid) / s;
    vec4 background = texture2D(tInput, screenUv);
    vec4 image = texture2D(tMap, insideUv);
    gl_FragColor = mix(image, background, isOutside);
}
`,r5e=class extends as{constructor(){super(new Vr({vertexShader:e5e,fragmentShader:t5e,uniforms:{tInput:new rt(null),tMap:new rt(null),uResolution:new rt(new ye),uSize:new rt(new ye),uCoords:new rt(new ye),uScale:new rt(1),uSceneColor:new rt(new Bt(16711680)),uDPR:new rt(1),uCurrent:new rt(0)}}),"tInput"),this.needsSwap=!0}get uniforms(){return this.fullscreenMaterial.uniforms}get texture(){return this.uniforms.tMap.value}set texture(e){this.uniforms.tMap.value=e}},i5e=`
void main() {
    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,n5e=`
uniform sampler2D toScene;
uniform sampler2D fromScene;
uniform vec2 resolution;

uniform vec2 uResolution;
uniform float uDPR;

uniform float mixRatio;
uniform sampler2D tMixTexture;
uniform int useTexture;
uniform float threshold;

void main() {
	vec2 screenUv = gl_FragCoord.xy / uResolution.xy;
	screenUv *= 1.0 / uDPR;

	vec4 texel1 = texture2D( fromScene, screenUv );
	vec4 texel2 = texture2D( toScene, screenUv );

	if (useTexture==1) {
		
		vec4 transitionTexel = texture2D( tMixTexture, screenUv );
		float r = mixRatio * (1.0 + threshold * 2.0) - threshold;
		float mixf=clamp((transitionTexel.r - r)*(1.0/threshold), 0.0, 1.0);
		
		gl_FragColor = mix( texel1, texel2, mixf );
	} else {
		
		gl_FragColor = mix( texel1, texel2, mixRatio );
		
	}
}
`,a5e=[],o5e=class extends as{constructor(){super(new Vr({vertexShader:i5e,fragmentShader:n5e,uniforms:{toScene:new rt(null),fromScene:new rt(null),uResolution:new rt(new ye),uDPR:new rt(1),mixRatio:new rt(0),threshold:new rt(.1),useTexture:new rt(0),tMixTexture:{value:a5e[0]}}}),"toScene"),this.needsSwap=!0}get uniforms(){return this.fullscreenMaterial.uniforms}get texture(){return this.uniforms.fromScene.value}set texture(e){this.uniforms.fromScene.value=e}},s5e=`
void main() {
    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,l5e=`
uniform sampler2D inputBuffer;
uniform sampler2D blurredInputBuffer;
uniform sampler2D overlay;
uniform float blurIntensity;

uniform vec2 uResolution;
uniform float uDPR;

void main() {
	vec2 screenUv = gl_FragCoord.xy / uResolution.xy;
	screenUv *= 1.0 / uDPR;

	vec4 texel1 = texture2D( overlay, screenUv );
	vec4 texel2 = texture2D( inputBuffer, screenUv );
	vec4 texel3 = texture2D( blurredInputBuffer, screenUv );

	float blurMask2 = max(sign(texel1.a), 0.0) * blurIntensity;
    gl_FragColor = mix( mix(texel2, texel3, blurMask2), texel1, texel1.a );
}
`,c5e=class extends as{constructor(){super(new Vr({vertexShader:s5e,fragmentShader:l5e,uniforms:{inputBuffer:new rt(null),blurredInputBuffer:new rt(null),overlay:new rt(null),uResolution:new rt(new ye),uDPR:new rt(1),blurIntensity:new rt(0)}})),this._blurEnabled=!1,this.blurTarget=new jr(1,1,{minFilter:hr,magFilter:hr,wrapS:_i,wrapT:_i}),this.blurPass=new JD({width:window.innerWidth,height:window.innerHeight,kernelSize:Yw.HUGE,resolutionScale:.25}),this.blurPass.renderToScreen=!1,this.uniforms.blurredInputBuffer.value=this.blurTarget.texture}get uniforms(){return this.fullscreenMaterial.uniforms}get texture(){return this.uniforms.overlay.value}set texture(e){this.uniforms.overlay.value=e}setResolution(e,t,r=1){this.uniforms.uResolution.value.set(e,t),this.uniforms.uDPR.value=r,this.blurPass.setSize(e,t),this.blurTarget.setSize(e,t),this.blurPass.setSize(e,t)}get uiCanvas(){return this._uiCanvas}set uiCanvas(e){this._uiCanvas=e,e.texture&&(this.uniforms.overlay.value=e.texture);let t=e.frame;if(t){let r=t.data.backgroundBlur,i=r.radius;this._blurEnabled=r.enabled,this.uniforms.blurIntensity.value=this._blurEnabled?1:0,this.blurPass.scale=i/3}}render(e,t,r,i,n){this._blurEnabled&&(this.blurPass.setDepthTexture(this.getDepthTexture()),this.blurPass.render(e,t,this.blurTarget,i,n)),super.render(e,t,r,i,n)}};function j4(e,t){return t&&t.enabled&&e.push(t.effect),e}var u5e=e=>Object.values(Pr).includes(e)?e:Pr.NORMAL,d5e=class extends ca{constructor(e,t){super(),this._needsDOFResize=t,this.postprocessingState=v1.defaultData,this._scene=new ll,this._camera=new xa,this.effects=new Map,this.blueNoiseTexture=new Lo,this._renderToScreen=!0,this._isUIOverlayEnabled=!1,this.clock=new Q_e,this.renderer=e,this.debug=!1,this.effects.set("bloom",new EFe),this.effects.set("chromaticAberration",new PFe),this.effects.set("vignette",new IFe),this.effects.set("noise",new RFe),this.effects.set("colorAverage",new DFe),this.effects.set("hueSaturation",new OFe),this.effects.set("brightnessContrast",new TFe),this.effects.set("depthOfField",new zFe),this.effects.set("pixelation",new kFe),this.effectComposer=new HFe(this.renderer),this.effectComposer.autoRenderToScreen=!1,this.opaquePass=new GE(!0,this.scene,this.camera),this.opaquePass.clear=!0,this.transmissionPass=new jFe(this.scene,this.camera,this.renderer),this.aoPass=new JFe(this.scene,this.camera),this.taaPass=new UFe,this.taaPass.renderToScreen=!1,this.helperPass=new GFe(this.camera),this.helperPass.renderToScreen=!1,this.stylesOverlayPass=new r5e,this.stylesOverlayPass.enabled=!1,this.uiOverlayPass=new c5e,this.uiOverlayPass.enabled=!1,this.sceneTransitionPass=new o5e,this.sceneTransitionPass.enabled=!1,this._initCopyPass(),this._initPasses()}set overlayTexture(e){e!==void 0?(this.stylesOverlayPass.texture=e,this.stylesOverlayPass.enabled=!0):this.stylesOverlayPass.enabled=!1}get overlayTexture(){return this.stylesOverlayPass.texture}set sceneHelpers(e){this.helperPass.sceneHelpers=e}get sceneHelpers(){return this.helperPass.sceneHelpers}set sceneHelpersOnTop(e){this.helperPass.sceneHelpersOnTop=e}get sceneHelpersOnTop(){return this.helperPass.sceneHelpersOnTop}get scene(){return this._scene}set scene(e){this._scene=e,this.opaquePass.setScene(e),this.transmissionPass.setScene(e),this.aoPass.setScene(e)}get camera(){return this._camera}set camera(e){let t=this._camera!==e;this._camera=e,this.opaquePass.setCamera(e),this.transmissionPass.setCamera(e),t&&this.transmissionPass.updatePasses(this.renderer),this.aoPass.setCamera(e),this.helperPass.setCamera(e),this.effects.get("depthOfField").setCamera(e)}updateRenderToScreen(){let e=!1;for(let t=this.effectComposer.passes.length-1;t>=0;t--){let r=this.effectComposer.passes[t];if(r.enabled===!0&&!e&&this._renderToScreen){r.renderToScreen=!0,e=!0;continue}r.renderToScreen=!1}}get isUIOverlayEnabled(){return this._isUIOverlayEnabled}disableUIOverlay(){this._isUIOverlayEnabled=!1}enableUIOverlay(){this._isUIOverlayEnabled=!0}disableHelpers(){this.helperPass.enabled=!1,this.updateRenderToScreen()}enableHelpers(){this.helperPass.enabled=!0,this.updateRenderToScreen()}updateBlueNoiseTexture(e){this.blueNoiseTexture=new Lo(e,128,128),this.blueNoiseTexture.wrapS=Zl,this.blueNoiseTexture.wrapT=Zl,this.blueNoiseTexture.minFilter=Wr,this.blueNoiseTexture.magFilter=Wr,this.blueNoiseTexture.needsUpdate=!0}setAmbientOcclusionParams(e,t,r,i,n,a,o,s){this.aoPass.enabled=e,this.aoPass.radius=t,this.aoPass.bias=r,this.aoPass.aoColor=i,this.aoPass.fogEnabled=n,this.aoPass.fogNear=a,this.aoPass.fogFar=o,this.aoPass.runHalfRes!==!s&&(this.aoPass.runHalfRes=!s)}setTransmissionPassEnabled(e){this.transmissionPass.enabled=e,this.opaquePass.hasTransmissionPass=e}_initPasses(){var e,t,r;if((e=this.uvEffectPass)==null||e.dispose(),(t=this.effectPass)==null||t.dispose(),this.effectComposer.removeAllPasses(),this.transmissionPass.updatePasses(this.renderer),this.effectComposer.addPass(this.aoPass),this.effectComposer.addPass(this.opaquePass),this.effectComposer.addPass(this.transmissionPass),this.effectComposer.addPass(this.taaPass),this.postprocessingState.enabled){let i=[this.effects.get("pixelation")].reduce(j4,[]);i.length>0&&(this.uvEffectPass=new O1(this.camera,...i),this.uvEffectPass.renderToScreen=!1,this.effectComposer.addPass(this.uvEffectPass));let n=[this.effects.get("chromaticAberration"),this.effects.get("bloom"),this.effects.get("depthOfField"),this.effects.get("colorAverage"),this.effects.get("hueSaturation"),this.effects.get("brightnessContrast"),this.effects.get("vignette"),this.effects.get("noise")].reduce(j4,[]);if(n.length>0&&(this.effectPass=new O1(this.camera,...n),this.effectPass.renderToScreen=!1,this.effectComposer.addPass(this.effectPass),this._needsDOFResize&&((r=this.effects.get("depthOfField"))==null?void 0:r.enabled)&&window!==void 0)){let a=this.renderer.viewportWidth,o=this.renderer.viewportHeight;this.renderer.setSize(a-1,o-1),this.renderer.setSize(a,o)}}this.effectComposer.addPass(this.stylesOverlayPass),this.effectComposer.addPass(this.uiOverlayPass),this.effectComposer.addPass(this.sceneTransitionPass),this.effectComposer.addPass(this.helperPass)}_initCopyPass(){if(this._savePass)return;let e=new ye;this.renderer.getDrawingBufferSize(e),this._rt=new jr(e.x,e.y,{depthBuffer:!1,stencilBuffer:!1,wrapS:Zl,wrapT:Zl}),this._rt.samples=0,this._savePass=new HE(this._rt,!1),this._savePass.renderToScreen=!1}setCopyPass(e){this._rt=e,this._savePass=new HE(this._rt,!1),this.renderToScreen=!1}get renderToScreen(){return this._renderToScreen}set renderToScreen(e){if(this._renderToScreen===e)return;let t=this.effectComposer;!t||(e===!0?t.removePass(this._savePass):t.addPass(this._savePass),this._renderToScreen=e,this.updateRenderToScreen())}set sceneTransitionFromTexture(e){e!==this.sceneTransitionPass.texture&&(e!==null?this.sceneTransitionPass.enabled=!0:(this.sceneTransitionPass.enabled=!1,this.updateRenderToScreen()),this.sceneTransitionPass.texture=e)}get texture(){return this._rt&&this._rt.texture}get renderTarget(){return this._rt}updatePostprocessing(e){let{enabled:t,...r}=e,i=!1;t!==this.postprocessingState.enabled&&(i=!0);for(let n of Object.entries(r)){let a=n[1],o=this.effects.get(n[0]);if(o){o.enabled!==a.enabled&&(i=!0),o.enabled=a.enabled;for(let[s,l]of Object.entries(a))s==="blendFunction"?o.blendFunction=u5e(l):o[s]=l}}this.postprocessingState=e,i&&this._initPasses()}render(){this.effectComposer.render(this.clock.getDelta())}setScissor(e,t,r,i){e instanceof Qt?(this.effectComposer.inputBuffer.scissor.set(e.x,e.y,e.z,e.w),this.effectComposer.outputBuffer.scissor.set(e.x,e.y,e.z,e.w)):(this.effectComposer.inputBuffer.scissor.set(e,t,r,i),this.effectComposer.outputBuffer.scissor.set(e,t,r,i));let n=this.renderer.getPixelRatio();this.effectComposer.inputBuffer.scissor.multiplyScalar(n),this.effectComposer.outputBuffer.scissor.multiplyScalar(n),this.renderer.setScissor(e,t,r,i)}setScissorTest(e){this.effectComposer.inputBuffer.scissorTest=e,this.effectComposer.outputBuffer.scissorTest=e,this.renderer.setScissorTest(e)}setViewport(e,t,r,i){e instanceof Qt?(this.effectComposer.inputBuffer.viewport.copy(e),this.effectComposer.outputBuffer.viewport.copy(e)):(this.effectComposer.inputBuffer.viewport.set(e,t,r,i),this.effectComposer.outputBuffer.viewport.set(e,t,r,i))}resize(e,t,r){if(this.effectComposer.setSize(e,t,r),this._rt){let i=this.renderer.getPixelRatio();this._rt.setSize(e*i,t*i)}}dispose(){var e,t;(e=this.uvEffectPass)==null||e.dispose(),(t=this.effectPass)==null||t.dispose(),this.effectComposer.dispose()}},h5e=e=>`

// PCSS implementation based on:
// https://www.gamedev.net/articles/programming/graphics/contact-hardening-soft-shadows-made-fast-r4906/
// NOTE: This number affects how big the shadow blur can
// possibly get. Bigger number == bigger blur, but less precise results

const float  gPenumbraFilterSize = 80.0;
const int   gPenumbraSamples = ${e};
const int gShadowSamples = ${e};
const float gShadowSamplesRpc = 1.0f / float(gShadowSamples);

#ifdef USE_SHADOWMAP
    #if NUM_DIR_LIGHT_SHADOWS > 0

        uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
        varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];

        struct DirectionalLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
        };

        uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];

    #endif

    #if NUM_SPOT_LIGHT_SHADOWS > 0

        uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
        varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_SHADOWS ];

        struct SpotLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
        };

        uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];

    #endif

    #if NUM_POINT_LIGHT_SHADOWS > 0

        uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
        varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];

        struct PointLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
            float shadowCameraNear;
            float shadowCameraFar;
        };

        uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];

    #endif

    /*
    #if NUM_RECT_AREA_LIGHTS > 0

        // TODO (abelnation): create uniforms for area light shadows

    #endif
    */

float computePenumbra(int index, sampler2D shadowMap, float temporalAngle, float texelSize, vec2 uv, float compare, float texelScalar, float shadowRadius)
{
    float penumbra = 1.0;
    float blockerDepthAvg = 0.0;
    float blockerCount = 0.0;

    #pragma unroll_loop_start
    for(int i = 0; i < gPenumbraSamples; i ++)
    {
        vec2 offset = (vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize) * texelScalar;
        float depth = unpackRGBAToDepth( texture2D( shadowMap, uv + offset ) );

        if(depth < compare + 0.0001)
        {
            blockerDepthAvg += depth;
            blockerCount++;
        }
    }
    #pragma unroll_loop_end

    if (blockerCount > 0.0)
    {
        blockerDepthAvg /= blockerCount;

        // Compute penumbra
        penumbra = (compare - blockerDepthAvg) / (blockerDepthAvg);
        penumbra *= penumbra;
        penumbra *= 200.0 * penumbraSize[min(index, 5 - 1)]; // Magic number that affects how quickly the penumbra grows

        return clamp(penumbra, 0.00, 1.0);
    }
    return 0.0;
}

float vogelShadow(int index, sampler2D shadowMap, vec2 uv, float texelSize, float compare, float shadowRadius)
{
    float shadow         = 0.0f;

    // NOTE: When using TAA, we should use screen space interleaved gradient noise
    vec2 halton = haltonSequence[frameIndex];
    float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
    float temporalAngle  = temporalOffset * PI2;

    float texelScalar = (gPenumbraFilterSize) / (texelSize * 1024.);
    float penumbra = computePenumbra(index, shadowMap, temporalAngle, texelSize, uv, compare, texelScalar, shadowRadius);
    if (penumbra == -1.0) {
        return 1.0;
    }

    #pragma unroll_loop_start
    for (int i = 0; i < gShadowSamples; i++)
    {
        vec2 vogelSample =  vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;
        // Overall blurring offset
        vec2 offset = vogelSample * (shadowRadius * 2.);

        // Penumbra offset
        offset += vogelSample * (penumbra * texelScalar);

        shadow += step( compare, unpackRGBAToDepth( texture2D( shadowMap, uv + offset ) ) );
    }
    #pragma unroll_loop_end

    return shadow * gShadowSamplesRpc;
}


    float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {

        return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );

    }

    vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {

        return unpackRGBATo2Half( texture2D( shadow, uv ) );

    }

    float VSMShadow (sampler2D shadow, vec2 uv, float compare ){

        float occlusion = 1.0;

        vec2 distribution = texture2DDistribution( shadow, uv );

        float hard_shadow = step( compare , distribution.x ); // Hard Shadow

        if (hard_shadow != 1.0 ) {

            float distance = compare - distribution.x ;
            float variance = max( 0.00000, distribution.y * distribution.y );
            float softness_probability = variance / (variance + distance * distance ); // Chebeyshevs inequality
            softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 ); // 0.3 reduces light bleed
            occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );

        }
        return occlusion;

    }

    float getShadow( int i, sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {

        float shadow = 1.0;

        shadowCoord.xyz /= shadowCoord.w;
        shadowCoord.z += shadowBias;

        // if ( something && something ) breaks ATI OpenGL shader compiler
        // if ( all( something, something ) ) using this instead

        bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
        bool inFrustum = all( inFrustumVec );

        bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );

        bool frustumTest = all( frustumTestVec );

        if ( frustumTest ) {

        #if defined( SHADOWMAP_TYPE_PCF )

            vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
            return vogelShadow(i, shadowMap, shadowCoord.xy, texelSize.x, shadowCoord.z, shadowRadius );

        #elif defined( SHADOWMAP_TYPE_PCF_SOFT )

            vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
            float dx = texelSize.x;
            float dy = texelSize.y;

            vec2 uv = shadowCoord.xy;
            vec2 f = fract( uv * shadowMapSize + 0.5 );
            uv -= f * texelSize;

            shadow = (
                texture2DCompare( shadowMap, uv, shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
                mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
                     f.x ) +
                mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
                     f.x ) +
                mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
                     f.y ) +
                mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
                     f.y ) +
                mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
                          texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
                          f.x ),
                     mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
                          texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
                          f.x ),
                     f.y )
            ) * ( 1.0 / 9.0 );

        #elif defined( SHADOWMAP_TYPE_VSM )

            shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );

        #else // no percentage-closer filtering:

            shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );

        #endif

        }

        return shadow;

    }

    // cubeToUV() maps a 3D direction vector suitable for cube texture mapping to a 2D
    // vector suitable for 2D texture mapping. This code uses the following layout for the
    // 2D texture:
    //
    // xzXZ
    //  y Y
    //
    // Y - Positive y direction
    // y - Negative y direction
    // X - Positive x direction
    // x - Negative x direction
    // Z - Positive z direction
    // z - Negative z direction
    //
    // Source and test bed:
    // https://gist.github.com/tschw/da10c43c467ce8afd0c4

    vec2 cubeToUV( vec3 v, float texelSizeY ) {

        // Number of texels to avoid at the edge of each square

        vec3 absV = abs( v );

        // Intersect unit cube

        float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
        absV *= scaleToCube;

        // Apply scale to avoid seams

        // two texels less per square (one texel will do for NEAREST)
        v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );

        // Unwrap

        // space: -1 ... 1 range for each square
        //
        // #X##         dim    := ( 4 , 2 )
        //  # #         center := ( 1 , 1 )

        vec2 planar = v.xy;

        float almostATexel = 1.5 * texelSizeY;
        float almostOne = 1.0 - almostATexel;

        if ( absV.z >= almostOne ) {

            if ( v.z > 0.0 )
                planar.x = 4.0 - v.x;

        } else if ( absV.x >= almostOne ) {

            float signX = sign( v.x );
            planar.x = v.z * signX + 2.0 * signX;

        } else if ( absV.y >= almostOne ) {

            float signY = sign( v.y );
            planar.x = v.x + 2.0 * signY + 2.0;
            planar.y = v.z * signY - 2.0;

        }

        // Transform to UV space

        // scale := 0.5 / dim
        // translate := ( center + 0.5 ) / dim
        return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );

    }

    float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {

        float shadow = 1.0;
        vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );

        // for point lights, the uniform @vShadowCoord is re-purposed to hold
        // the vector from the light to the world-space position of the fragment.
        vec3 lightToPosition = shadowCoord.xyz;

        // dp = normalized distance from light to fragment position
        float compare = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear ); // need to clamp?
        compare += shadowBias;

        // bd3D = base direction 3D
        vec3 bd3D = normalize( lightToPosition );

        vec2 halton = haltonSequence[frameIndex];
        float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
        float temporalAngle  = temporalOffset * PI2;

        #if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_VSM )
            for (int i = 0; i < gShadowSamples; i++) {
                vec2 vogelSample = vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;

                // Overall blurring offset
                vec3 offset = vec3(vogelSample.x, vogelSample.y, -vogelSample.x) * (shadowRadius + 5.);

                // NOTE: Removed for now
                // Penumbra offset
                //offset += vec3(vogelSample.x, vogelSample.y, vogelSample.y)  * (penumbra * gPenumbraFilterSize);

                shadow += texture2DCompare( shadowMap, cubeToUV( bd3D + offset, texelSize.y ), compare );

            }
            return shadow * gShadowSamplesRpc;

        #elif defined( SHADOWMAP_TYPE_PCF_SOFT )
            for (int i = 0; i < 16; i++) {
                vec2 vogelSample = vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;

                // Overall blurring offset
                vec3 offset = vec3(vogelSample.x, vogelSample.y, -vogelSample.x) * (shadowRadius + 5.);

                shadow += texture2DCompare( shadowMap, cubeToUV( bd3D + offset, texelSize.y ), compare );

            }
            return shadow * (1.0 / 16.0);
        #else // no percentage-closer filtering

            return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), compare );

        #endif

    }

#endif
`,f5e=cr.lights_fragment_begin,p5e=cr.shadowmask_pars_fragment,V4=null,m5e=e=>{switch(e){case"low":return 8;case"medium":return 16;case"high":return 32;default:return 16}},v5e=(e="medium")=>{if(V4===e)return!1;V4=e;let t=m5e(e);cr.shadowmap_pars_fragment=h5e(t);let r=f5e.slice();r=r.replace("getShadow( spotShadowMap[ i ]","getShadow( UNROLLED_LOOP_INDEX + 3, spotShadowMap[ i ]"),r=r.replace("getShadow( directionalShadowMap[ i ]","getShadow( UNROLLED_LOOP_INDEX, directionalShadowMap[ i ]"),cr.lights_fragment_begin=r;let i=p5e.slice();return i=i.replaceAll("getShadow(","getShadow( UNROLLED_LOOP_INDEX, "),cr.shadowmask_pars_fragment=i,!0},g5e=`
attribute vec3 randomColor;
varying vec3 vNormal;
flat out vec3 vColor;
#include <skinning_pars_vertex>

void main()
{
#include <beginnormal_vertex>
#include <skinbase_vertex>
#include <skinnormal_vertex>
vec3 transformed = vec3(position);
#include <skinning_vertex>

vNormal = normal;
vColor = randomColor;
gl_Position = projectionMatrix * (modelViewMatrix * vec4(transformed, 1.0));
}
`,y5e=`
uniform float depthContrast;
varying vec3 vNormal;
flat in vec3 vColor;
void main()
{
vec3 normal = (normalize(vNormal)).rgb;

float contrastDepth = (gl_FragCoord.z - 0.5) * depthContrast + 0.5;

vec3 resultColor = mix(mix(vColor, normal, 0.2), vec3(contrastDepth), 0.4);
gl_FragColor = vec4(resultColor, vColor.r);
gl_FragColor = vec4(resultColor, vColor.r);
}
`,B_=new Vr({vertexShader:g5e,fragmentShader:y5e,uniforms:{depthContrast:{value:1}}}),H4=new Ri,b5e=new ye,x5e=class extends m8{constructor(e){super(e),this._pixelRatio=this.getPixelRatio(),this.viewportWidth=1,this.viewportHeight=1,this.resolution=new ye,this.dummyCamera=new xa,this.sceneTransitionDuration=0,this.sceneTransitionTimeRemaining=-1,this.isXRCopyPassSet=!1,this.clear=(n=!0,a=!0,o=!0)=>{let s=this.getContext(),l=0;n&&(l|=s.COLOR_BUFFER_BIT),a&&(l|=s.DEPTH_BUFFER_BIT),o&&(l|=s.STENCIL_BUFFER_BIT),s.clear(l),s.clearBufferfv(s.COLOR,1,[0,0,0,1])},this.pipeline=new d5e(this,(e==null?void 0:e.needsDOFResize)??!1),this.autoClear=!1;let t=this.setPixelRatio.bind(this),r=this.setSize.bind(this);this.shadowMap.enabled=!0,this.shadowMap.type=FP,this.dummyCamera.matrixAutoUpdate=!1,this.domElement.removeAttribute("data-engine");let i=this.getContext();if(i&&"drawingBufferColorSpace"in i)try{i.drawingBufferColorSpace="display-p3"}catch(n){console.warn(n)}this.setPixelRatio=n=>{this._pixelRatio!==n&&(this._pixelRatio=n,t(n))},this.setSize=(n,a,o=!0)=>{var s,l;(this.viewportWidth!==n||this.viewportHeight!==a)&&(this.viewportWidth=n,this.viewportHeight=a,r(n,a,o),(s=this.normalRenderTarget)==null||s.setSize(n*this._pixelRatio,a*this._pixelRatio),this._resizeTransmission(n,a),(l=this.transmissionDepthTarget)==null||l.setSize(n*this._pixelRatio/2,a*this._pixelRatio/2),this.pipeline.resize(n,a,o))},this._superDispose=this.dispose,this.dispose=this._currentDispose}createAORenderTarget(){this.aoRenderTarget===void 0&&(this.aoRenderTarget=new jr(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio,{generateMipmaps:!1,minFilter:hr,magFilter:hr,wrapS:_i,wrapT:_i,depthBuffer:!1}))}_resizeTransmission(e,t){var r,i;(r=this.transmissionRenderTarget)==null||r.setSize(e*this._pixelRatio/(this.hdTransmission?1:2),t*this._pixelRatio/(this.hdTransmission?1:2)),(i=this.aoRenderTarget)==null||i.setSize(e*this._pixelRatio/1,t*this._pixelRatio/1)}get hdTransmission(){return Vt.transmissionLod.value===1}set hdTransmission(e){Vt.transmissionLod.value=e===!0?1:2,this._resizeTransmission(this.viewportWidth,this.viewportHeight)}createTransmissionRenderTarget(){this.transmissionRenderTarget===void 0&&(this.transmissionRenderTarget=new jr(this.viewportWidth*this._pixelRatio/(this.hdTransmission?1:2),this.viewportHeight*this._pixelRatio/(this.hdTransmission?1:2),{generateMipmaps:!0,minFilter:zp,magFilter:hr,wrapS:_i,wrapT:_i,depthBuffer:!1}),this.transmissionDepthTarget=new jr(this.viewportWidth*this._pixelRatio/2,this.viewportHeight*this._pixelRatio/2,{minFilter:Wr,magFilter:Wr,depthBuffer:!1}))}createNormalRenderTarget(){this.normalRenderTarget===void 0&&(this.normalRenderTarget=new jr(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio,{generateMipmaps:!1,minFilter:Wr,magFilter:Wr,type:ln,depthTexture:new Lp(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio)}))}renderNormal(e,t,r){this.normalRenderTarget&&(this.setClearColor(0),r.layers.enable(8),r.layers.disable(0),r.layers.disable(3),t.traverseEntity(i=>{i.layers.isEnabled(8)&&(i.copyPreviousMatrix=!1)}),this.setRenderTarget(this.normalRenderTarget),this.clear(),r instanceof xa?B_.uniforms.depthContrast.value=(r.far-r.near)/1e4:B_.uniforms.depthContrast.value=1,t.overrideMaterial=B_,this.render(t,r),this.setClearColor(t.bgColor,t.bgColor.a),this.setRenderTarget(null),t.overrideMaterial=e.wireframeState?ZE:null,r.layers.enable(0),r.layers.enable(3),t.traverseEntity(i=>{i.layers.isEnabled(8)&&(i.copyPreviousMatrix=!0)}))}renderSplineSceneWithDummyCamera(e,t,r=1){this.dummyCamera.updateCameraState(t.dataPatched),this.dummyCamera.matrix.copy(t.matrixWorld);let i=t.height,n=t.width,a=this.viewportWidth/this.viewportHeight;n<i?n=i*a:i=n/a,this.dummyCamera.setViewplaneSize(n,i);for(let o=0;o<r;o++)this.renderSplineScene(e,this.dummyCamera)}renderSplineScene(e,t,{sceneHelpers:r=this.sceneHelpers,sceneHelpersOnTop:i=this.sceneHelpersOnTop,overrideTransmission:n=void 0,overrideNormal:a=void 0}={}){var h;let o=e instanceof s3?e.activePage:e,s=o.visible;o.visible=!0;let l=o.scene;this.xr.enabled&&(this.isXRCopyPassSet===!1&&this.getRenderTarget()!==null&&(this.pipeline.setCopyPass(this.getRenderTarget()),this.isXRCopyPassSet=!0),this.xr.updateCamera(t)),this.setClearColor(o.bgColor,o.bgColor.a),o.penumbraSizeArray.forEach((f,p)=>{Vt.penumbraSize.value[p]=f}),Vt.pixelRatioNode.value=this.getPixelRatio(),this.resolution.x!==0&&this.resolution.y!==0?Vt.resolution.value.set(this.resolution.x,this.resolution.y):Vt.resolution.value.set(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio),a!==void 0?(Vt.normalRenderTarget.value=a,Vt.normalRenderTargetDepth.value=H4):l.needsNormal()&&(this.createNormalRenderTarget(),Vt.normalRenderTarget.value=this.normalRenderTarget.texture,Vt.normalRenderTargetDepth.value=this.normalRenderTarget.depthTexture,this.renderNormal(l,o,t));let c=o.data.ao,u=c.occlusion;if(u&&(this.createAORenderTarget(),Vt.aoRenderTarget.value=this.aoRenderTarget.texture),Vt.aoEnabled.value=u,this.pipeline.setAmbientOcclusionParams(c.occlusion,c.radius,c.bias,o.aoColor,o.fog!==null,o.backupFog.near,o.backupFog.far,c.aoFullRes&&!S0),this.pipeline.aoPass.setBlueNoiseTexture(this.pipeline.blueNoiseTexture),this.pipeline.isUIOverlayEnabled&&((h=o.uiCanvas)==null?void 0:h.enabled)&&o.uiCanvas.texture&&o.uiCanvas.texture.image.width>0){let f=this.getSize(b5e),p=this.getPixelRatio();(o.uiCanvas.width!==this.viewportWidth||o.uiCanvas.height!==this.viewportHeight||o.uiCanvas.dpr!==p)&&o.uiCanvas.applySize({width:this.viewportWidth,height:this.viewportHeight},p),o.uiCanvas.render(this),this.pipeline.uiOverlayPass.uiCanvas=o.uiCanvas,this.pipeline.uiOverlayPass.enabled=!0,this.pipeline.uiOverlayPass.setResolution(f.x,f.y,p),this.pipeline.updateRenderToScreen()}else this.pipeline.uiOverlayPass.enabled=!1,this.pipeline.updateRenderToScreen();let d=!1;if(n!==void 0)Vt.transmissionRenderTarget.value=n,Vt.transmissionRenderTargetDepth.value=H4,this.pipeline.setTransmissionPassEnabled(!1);else{let f=l.needsTransmission();f&&(this.transmissionRenderTarget===void 0&&(d=!0),this.createTransmissionRenderTarget(),Vt.transmissionRenderTarget.value=this.transmissionRenderTarget.texture,Vt.aspectRatio.value=hLe(this.viewportWidth,this.viewportHeight),Vt.transmissionRenderTargetDepth.value=this.transmissionDepthTarget.texture),this.pipeline.setTransmissionPassEnabled(f)}t.layers.enable(3),t.layers.enable(8),this.pipeline.sceneHelpers=r,this.pipeline.sceneHelpersOnTop=i,this.pipeline.scene=o,this.pipeline.camera=t,d&&this.pipeline.transmissionPass.updatePasses(this),this.pipeline.postprocessingState!==o.postprocessing&&(this.pipeline.updatePostprocessing(o.postprocessing),!r&&!i&&this.pipeline.disableHelpers()),this.clearAlphaOverride!==void 0&&this.setClearAlpha(this.clearAlphaOverride),o.overrideMaterial=l.wireframeState?ZE:null,this.pipeline.render(),Vt.frameIndex.value=(Vt.frameIndex.value+1)%16,t instanceof xa&&t.copyHistory(),o.visible=s}renderFromSceneForSceneTransitionPass(e,t,r){this.pipeline.renderToScreen=!1,this.pipeline.renderTarget,this.renderSplineScene(e,t),this.pipeline.sceneTransitionFromTexture=this.pipeline.renderTarget.texture,this.sceneTransitionDuration=r,this.sceneTransitionTimeRemaining=r,this.pipeline.renderToScreen=!0;let i=this.pipeline.sceneTransitionPass.uniforms;i.uDPR.value=window.devicePixelRatio,i.uResolution.value.set(this.domElement.width,this.domElement.height).divideScalar(window.devicePixelRatio)}_currentDispose(){var e,t,r,i,n,a;this._superDispose(),this.pipeline.dispose(),(e=this.aoRenderTarget)==null||e.dispose(),(t=this.transmissionRenderTarget)==null||t.dispose(),(r=this.transmissionDepthTarget)==null||r.dispose(),(i=this.normalRenderTarget)==null||i.dispose(),(a=(n=this.normalRenderTarget)==null?void 0:n.depthTexture)==null||a.dispose()}},O9=class extends A0(f2e){constructor(e,t=15,r=10066329){super(e,t,r),this.object=e,this.added=!1,this.name=`DirectionalLightHelper: ${e.uuid}`}raycast(e,t){M0(this.object,O9.geometryHelper,e,t)}},R9=class extends A0(h2e){constructor(e,t=15,r=6710886){super(e,t,r),this.object=e,this.name=`PointLightHelper: ${e.uuid}`}raycast(e,t){M0(this.object,R9.geometryHelper,e,t)}},$E=class extends A0(d2e){constructor(e,t=6710886){super(e,t),this.object=e,this.name=`SpotLightHelper: ${e.uuid}`}raycast(e,t){M0(this.object,$E.geometryHelper,e,t)}update(){if(this.object!==void 0){let e=$E._vector,t=this.object.distance?this.object.distance:1e3,r=t*Math.tan(this.object.angle);this.cone.scale.set(r,r,t),e.setFromMatrixPosition(this.object.target.matrixWorld),this.cone.lookAt(e);let i=this.color!==void 0?this.color:this.light.color;if(this.cone.material instanceof Array)for(let n=0,a=this.cone.material.length;n<a;n++)this.cone.material[n].color.set(i);else this.cone.material.color.set(i)}}},I9=$E;I9._vector=new k;var z9=class extends tc{constructor(){super(),this.caretIndex=0,this._caretVisibleAlpha=1,this._selectionVisibleAlpha=.3,this.current={start:0,end:void 0},this.matrixAutoUpdate=!1,this.caretMesh=new Oi(new fc(1,1),new hc({transparent:!0,opacity:0,side:ga})),this.add(this.caretMesh),this.selectionMesh=new Oi(new fc(1,1),new hc({color:2857471,transparent:!0,depthTest:!1,depthWrite:!1,opacity:0,side:ga})),this.add(this.selectionMesh),this.hide()}get caretHeight(){var e;return((e=this.object)==null?void 0:e.AD)??0}show(e){this.visible=!0,this.object=e,this.caretMesh.scale.set(1,this.caretHeight,1),this.caretMesh.position.y=-this.caretHeight*.5,this.setCaretPosition(this.caretIndex),this.update()}hide(){this.visible=!1}update(){if(this.object===void 0)return;this.updateHelperMatrix();let{depth:e}=this.object.geometry.userData.parameters;this.caretMesh.position.z=e,this.selectionMesh.position.z=e}updateHelperMatrix(){if(this.object===void 0)return;let e=this.object,t=e.parent;t!==null&&t.updateWorldMatrix(!0,!1),e.matrixAutoUpdate&&e.updateMatrix(),t!==null?(this.matrixWorld.multiplyMatrices(t.matrixWorld,e.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,e.matrix)):this.matrixWorld.multiplyMatrices(e.hiddenMatrix,e.matrix),this.matrix.copy(this.matrixWorld);for(let r of this.children)r.matrixWorld.copy(this.matrixWorld);e.updateWorldMatrix(!0,!0)}setCaretColor(e){let t=this.caretMesh.material;t.color.setRGB(e.r,e.g,e.b);let r=this._caretVisibleAlpha===t.opacity;this._caretVisibleAlpha=e.a,r&&(t.opacity=this._caretVisibleAlpha)}setSelectionColor(e){this.selectionMesh.material.color.setRGB(e.r,e.g,e.b)}setCaretPosition(e,t={}){if(this.object===void 0)return;this.caretIndex=e;let r=this.object.wrappedText,[i,n]=R1(r,e),[a,o]=e>0?R1(r,e-1):[null,null];(e>0&&r.length?r[a].charAt(o):null)===`
`&&(i++,n=0),this.current.start=e,this.current.end=void 0;let[s,l]=F_(this.object,i,n),{AD:c,descender:u}=this.object,d=u+c*.5,{width:h,height:f,depth:p}=this.object.geometry.userData.parameters,v=typeof h=="string"?0:h,m=typeof f=="string"?0:f;this.caretMesh.scale.set(1,this.caretHeight,1),this.caretMesh.position.set(s-v*.5,l+d+m*.5,p),this.hideSelectionMesh(),this.showCaretMesh()}setSelection(e,t){if(this.object===void 0)return;let r=this.object.wrappedText;this.current.start=e,this.current.end=t;let i=[],n=[],a=w5e(r,e,t),{lineHeight:o,AD:s,descender:l}=this.object,c=l+s*.5-o*.5;for(let[m,g,y]of a)if(g!==y){let[b,x]=F_(this.object,m,g),[S,w]=F_(this.object,m,y);x+=c,w+=c,w+=o;let _=i.length/3;i.push(b,x,0),i.push(S,x,0),i.push(S,w,0),i.push(b,w,0),n.push(_+0,_+1,_+2),n.push(_+2,_+3,_+0)}let u=new Ot;u.setIndex(n),u.setAttribute("position",new yt(i,3));let{width:d,height:h,depth:f}=this.object.geometry.userData.parameters,p=typeof d=="string"?0:d,v=typeof h=="string"?0:h;this.selectionMesh.geometry.dispose(),this.selectionMesh.geometry=u,this.selectionMesh.position.x=-p*.5,this.selectionMesh.position.y=v*.5,this.selectionMesh.position.z=f,this.showSelectionMesh(),this.hideCaretMesh()}getSelectionFromPosition(e,t,r="previous"){if(this.object===void 0||this.object.font===void 0)return;let i=this.object.wrappedText,n=i.length,a=this.object.lineHeight,o=n*a,{height:s,verticalAlign:l}=this.object.geometry.userData.parameters,c=typeof s=="string"?0:s,u=0;l===3?u=c-o:l===2&&(u=c*.5-o*.5);let d=Math.min(Math.floor(Math.max(Math.min(-t-u,o),0)/a),n-1),h=this.object.charCoords[d],f=this.object.charWidths[d],p=0,v=!1;if(r==="previous"){for(let m=0;m<h.length;m++)if(h[m][0]+f[m]*.5-e>0){p=m,v=!0;break}}else if(r==="closest"){let m=1/0;for(let g=0;g<h.length;g++){let y=h[g][0]+f[g]*.5,b=Math.abs(y-e);b<m&&(m=b,p=g,v=!0)}}else for(let m=0;m<h.length;m++){let g=h[m][0],y=h[m][0]+f[m];if(e>=g&&e<y){p=m,v=!0;break}}return v||(p=h.length),{index:this.getGlobalIndexFromLineAndCharIndexes(i,d,p),lineIndex:d,characterIndex:p}}getGlobalIndexFromLineAndCharIndexes(e,t,r){return e.slice(0,t).reduce((i,n)=>i+=n.length,0)+r}showSelectionMesh(){this.selectionMesh.material.opacity=this._selectionVisibleAlpha}hideSelectionMesh(){this.selectionMesh.material.opacity=0}showCaretMesh(){this.caretMesh.material.opacity=this._caretVisibleAlpha}hideCaretMesh(){this.caretMesh.material.opacity=0}};function F_(e,t,r){let{charCoords:i,charWidths:n,initialOffsetY:a,lineHeight:o}=e;if(i[t]&&i[t].length===0||i.length===0){let u=0,{horizontalAlign:d}=e.data.geometry,h=e.wrappedText,{width:f}=e.geometry.userData.parameters;return h.length===1&&h[0].length===0&&(d===3?u=f*.5:d===2&&(u=f)),[u,a-o*t]}let s=i[t];if(s===void 0||s.length===0)return[0,0];let[l,c]=s[Math.min(r,s.length-1)];return r>=s.length&&(l+=n[t][r-1]),[l,c]}function R1(e,t){var i;let r=0;for(let n=0;n<e.length;n++){let a=e[n],o=t-r;if(o<=a.length)return[n,o];r+=a.length}return[Math.max(0,e.length-1),((i=e[e.length-1])==null?void 0:i.length)??0]}function w5e(e,t,r){let[i,n]=R1(e,t),[a,o]=R1(e,r),s=[];n>=e[i].length&&(i++,n=0);for(let l=i;l<=a;l++){let c=e[l],u=l===i?n:0,d=l===a?o:c.length;s.push([l,u,d])}return s}function S5e(e,t){let r=ea.fromHex(3223857),i=.8;for(let n of e.layers){if(n.data.type==="light"||n.data.type==="displace"||n.data.type==="fresnel"||n.data.type==="matcap"||n.data.type==="texture"||n.data.type==="toon"||n.data.type==="outline"||n.data.type==="transmission"||n.data.type==="noise")continue;let a=typeof n.data.alpha=="string"?Number(t.getVariable(n.data.alpha)):n.data.alpha;if(n.data.type==="color"&&a>.3){r=C5e(n.data.color,t),i=a;break}else if((n.data.type==="depth"||n.data.type==="gradient")&&a>.3){let o=_5e(n.data);r={r:o[0],g:o[1],b:o[2]},i=typeof n.data.alpha=="string"?1:n.data.alpha;break}}return{...r,a:i}}function C5e(e,t){return typeof e=="string"?t.data.colors[e]:e}function _5e(e){return e.colors[0]}function A5e(e,t){e.shadow.camera.right=t/2,e.shadow.camera.left=-t/2,e.shadow.camera.top=t/2,e.shadow.camera.bottom=-t/2,e.shadow.needsUpdate=!0}var k9=class extends QD(K_e,O9){constructor(e,t,r){super(),this.super_Entity(e,t),this.castShadow=!0,this.shadow.mapSize.width=2048,this.shadow.mapSize.height=2048,this.shadow.normalBias=1,this.layers.enable(3);let i=this.shadow.camera;i.top=1250,i.bottom=-1250,i.right=1250,i.left=-1250,i.near=-1e4,i.far=2500;let n=new Xx(this.shadow.camera);n.visible=!1,this.gizmos.shadowmap=n}update(){this.shadow.camera.updateProjectionMatrix();for(let e in this.gizmos){let t=this.gizmos[e];t instanceof Xx&&t.update()}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.objectHelper&&this.objectHelper.update()}updateState(e,t){this.updateState_Light(e,t);let r=e.depth!==void 0&&e.depth!==this.shadow.camera.far||e.size!==void 0&&e.size/2!==this.shadow.camera.right;e.size!==void 0&&A5e(this,e.size),e.shadowRadius!==void 0&&(this.shadow.radius=e.shadowRadius),e.shadowResolution!==void 0&&(this.shadow.mapSize.set(e.shadowResolution,e.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null)),e.penumbraSize!==void 0&&t.scene.markPenumbraSizeDirty(),r&&this.update()}},W4=new k,G4=new k,$4=new Kt,L9=class extends QD($_e,I9){constructor(e,t,r){super(),this.super_Entity(e,t),this.castShadow=!0,this.shadow.mapSize.width=1024,this.shadow.mapSize.height=1024,this.shadow.normalBias=1,this.layers.enable(3);let i=this.shadow.camera;i.fov=St.RAD2DEG*2*this.angle,i.aspect=1,i.near=100,i.far=2500;let n=new Xx(this.shadow.camera);n.visible=!1,this.gizmos.shadowmap=n,this.update()}update(){this.shadow.camera.updateProjectionMatrix();for(let e in this.gizmos){let t=this.gizmos[e];t instanceof Xx&&t.update()}}updateMatrixWorld(e){super.updateMatrixWorld(e),G4.setFromMatrixPosition(this.matrixWorld),$4.setFromRotationMatrix(this.matrixWorld),W4.copy(this.up).applyQuaternion($4).negate().multiplyScalar(this.distance),this.target.position.copy(G4).add(W4),this.target.updateMatrixWorld(),this.objectHelper&&this.objectHelper.update()}updateState(e,t){this.updateState_Light(e,t),e.distance!==void 0&&(this.distance=e.distance),e.decay!==void 0&&(this.decay=e.decay),e.angle!==void 0&&(this.angle=e.angle),e.penumbra!==void 0&&(this.penumbra=e.penumbra),e.shadowRadius!==void 0&&(this.shadow.radius=e.shadowRadius),e.penumbraSize!==void 0&&t.scene.markPenumbraSizeDirty(),e.shadowResolution!==void 0&&(this.shadow.mapSize.set(e.shadowResolution,e.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null))}};function M5e(e){let t=(e[0][0]+e[1][1])/2,r=(e[0][0]-e[1][1])/2,i=(e[1][0]+e[0][1])/2,n=(e[1][0]-e[0][1])/2,a=Math.sqrt(t*t+n*n),o=Math.sqrt(r*r+i*i),s=a+o,l=a-o,c=Math.atan2(i,r),u=Math.atan2(n,t),d=(u-c)/2,h=(u+c)/2,f=[[Math.cos(h),Math.sin(h)],[-Math.sin(h),Math.cos(h)]],p=[[s,0],[0,l]],v=[[Math.cos(d),Math.sin(d)],[-Math.sin(d),Math.cos(d)]];return f[0][0]*=-1,f[0][1]*=-1,v[0][0]*=-1,v[1][0]*=-1,[f,p,v]}function Xb(e,t){return[[e[0][0]*t[0][0]+e[0][1]*t[1][0],e[0][0]*t[0][1]+e[0][1]*t[1][1]],[e[1][0]*t[0][0]+e[1][1]*t[1][0],e[1][0]*t[0][1]+e[1][1]*t[1][1]]]}function q4(e){return[[e[0][0],e[1][0]],[e[0][1],e[1][1]]]}function E5e(e){let[t,r,i]=M5e(e),n=Xb(t,q4(i)),a=Xb(Xb(i,r),q4(i)),o=Math.atan2(n[1][0],n[0][0]),s=[a[0][0],a[1][1]],l=[a[0][1]/a[1][1],a[1][0]/a[0][0]];return{rotation:o,scale:s,shear:l}}function T5e({rotation:e,scale:t,shear:r}){let i=Math.cos(e),n=Math.sin(e),a=[[i,-n],[n,i]],o=[[t[0],r[0]*t[1]],[r[1]*t[0],t[1]]],s=Xb(a,o);return[s[0][0],s[1][0],s[0][1],s[1][1]]}var kr;(e=>{function t(){return[1,0,0,0,1,0,0,0,1]}e.identity=t;function r(w,_=e.identity()){for(let C=0,A=w.length;C<A;C++)_[C]=w[C];return _}e.copy=r;function i(w,_,C,A,M,P){return e.setAbcdef(e.identity(),w,_,C,A,M,P)}e.create=i;function n(w,_,C,A,M,P,T){return w[0]=_,w[1]=A,w[2]=P,w[3]=C,w[4]=M,w[5]=T,w}e.setAbcdef=n;function a(w,_){let[C,A,M,P,T,R]=s(w),[z,F,H,N,U,ie]=s(_),te=z*C+F*M,X=z*A+F*P,W=H*C+N*M,q=H*A+N*P,$=U*C+ie*M+T,le=U*A+ie*P+R;return e.create(te,X,W,q,$,le)}e.append=a;function o(w,_){let[C,A,M,P,T,R]=s(w),[z,F,H,N,U,ie]=s(_),te=C,X=A,W=M,q=P;(z!==1||F!==0||H!==0||N!==1)&&(te=C*z+A*H,X=C*F+A*N,W=M*z+P*H,q=M*F+P*N);let $=T*z+R*H+U,le=T*F+R*N+ie;return e.create(te,X,W,q,$,le)}e.prepend=o;function s(w){return[w[0],w[3],w[1],w[4],w[2],w[5]]}e.getAbcdef=s;function l(w){let[_,C,A,M,P,T]=e.getAbcdef(w),R=_*M-C*A,z=M/R,F=-C/R,H=-A/R,N=_/R,U=(A*T-M*P)/R,ie=-(_*T-C*P)/R;return e.create(z,F,H,N,U,ie)}e.invert=l;function c([w,_],C){let[A,M,P,T,R,z]=e.getAbcdef(C);return[A*w+P*_+R,M*w+T*_+z]}e.apply=c;function u(w,_){let[C,A,M,P,T,R]=e.getAbcdef(_),z=1/(C*P+M*-A),[F,H]=w;return[P*z*F+-M*z*H+(R*M-T*P)*z,C*z*H+-A*z*F+(-R*C+T*A)*z]}e.applyInverse=u;function d(w,_,C=_){let[A,M,P,T,R,z]=e.getAbcdef(w);return e.setAbcdef(w,A*_,M*C,P*_,T*C,R*_,z*C),w}e.scale=d;function h(w,_){let C=Math.cos(_),A=Math.sin(_),[M,P,T,R,z,F]=e.getAbcdef(w);return e.setAbcdef(w,M*C-P*A,M*A+P*C,T*C-R*A,T*A+R*C,z*C-F*A,z*A+F*C),w}e.rotate=h;function f(w,_,C){let[A,M]=C,P=e.translate(w,-A,-M);return P=e.rotate(P,_),P=e.translate(P,A,M),P}e.rotateAround=f;function p(w,_,C){let[A,M,P,T,R,z]=e.getAbcdef(w);return e.setAbcdef(w,A,M,P,T,R+_,z+C),w}e.translate=p;function v(w,_,C){let[A,M,P,T]=e.getAbcdef(w);return e.setAbcdef(w,A,M,P,T,_,C),w}e.setTranslate=v;function m(w,_,C){let[A,M,P,T]=e.getAbcdef(w);return e.setAbcdef(w,A,M,P,T,_,C),w}e.setPosition=m;function g(w){let[_,C,A,M]=e.getAbcdef(w),P=Math.sqrt(_*_+C*C),T=Math.sqrt(A*A+M*M);return[P,T]}e.getScale=g;function y(w){let[,,,,_,C]=e.getAbcdef(w);return[_,C]}e.getPosition=y;function b(w,_){return e.decompose(w,_).rotation}e.getRotation=b;function x(w,_){let[C,A,M,P,T,R]=e.getAbcdef(w),{rotation:z,scale:F,shear:H}=E5e([[C,M],[A,P]]);return{position:[T+(_[0]*C+_[1]*M)-_[0],R+(_[0]*A+_[1]*P)-_[1]],scale:F,rotation:z,shear:H,pivot:_}}e.decompose=x;function S(w,_,C,A,M=[0,0]){let[P,T]=w,[R,z]=A,[F,H,N,U]=T5e({rotation:C,scale:_,shear:M}),ie=P-(R*F+z*N)+R,te=T-(R*H+z*U)+z;return e.create(F,H,N,U,ie,te)}e.compose=S})(kr||(kr={}));var P5e=Math.PI/180;function D5e(e,t,r,i,n,a){let o=e-r,s=t-i;return o*o/(n*n)+s*s/(a*a)<=1}function O5e(e){return e*P5e}var Vn=class{constructor(e,t,r){this.uuid=e,this.data=t,this.localMatrix=kr.identity(),this.worldMatrix=kr.identity(),this.ignoreCameraZoom=!1,this.visible=!0,this._singleBBox=new qE,this._recursiveBBox=new qE,this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0,this.stateSelection=null,this.prevState=null,this.currentState=null,this.reversibleToState=null,this.currentTransitionEvent=null,this.previousAction=null,this.name="",this.position=[0,0],this.scale=[1,1],this.rotation=0,this.shear=[0,0],this.emitter=$D(),this.dpr=r.dpr??1,this.dataPatched=t}project(e,t){let r=this.worldMatrix;return t&&(r=kr.append(t.worldMatrix,r)),kr.applyInverse(e,r)}intersects(e,t,r,i=!1){return this.visible&&!this.data.raycastLock&&this.intersectsInLocalSpace(...this.project([e,t],r),i)}intersectsInLocalSpace(e,t,r=!1){let{min:i,max:n}=r?this.recursiveBBox:this.singleBBox;return e>=i[0]&&e<=n[0]&&t>=i[1]&&t<=n[1]}applyTransforms(e){e.setTransform(this.worldMatrix,this.ignoreCameraZoom)}get singleBBox(){return this.singleBBoxNeedsUpdate&&(this.singleBBoxNeedsUpdate=!1,this._singleBBox.setFromObjectSize(this,!1),this._singleBBox.computeVertices(),this._singleBBox.computeEdges()),this._singleBBox}get recursiveBBox(){return this.recursiveBBoxNeedsUpdate&&(this.recursiveBBoxNeedsUpdate=!1,this._recursiveBBox.setFromObjectSize(this,!0),this._recursiveBBox.computeVertices(),this._recursiveBBox.computeEdges()),this._recursiveBBox}updateLocalMatrix(){this.localMatrix=kr.compose(this.position,this.scale,O5e(this.rotation),rh.getPivot(this.dataPatched),this.shear)}updateWorldMatrix(e,t,r){let i=this.parent;t&&i!==null&&i!==void 0&&i.updateWorldMatrix(e,!0,!1),e&&this.updateLocalMatrix(),this.parent?this.worldMatrix=kr.append(this.parent.worldMatrix,this.localMatrix):this.worldMatrix=kr.copy(this.localMatrix),this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0}get pivot(){return rh.getPivot(this.data)}getCenter(){return[0,0]}getHalfSize(){return[0,0]}get id(){return this.uuid}resetBBoxNeedsUpdateSelf(){this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0}resetBBoxNeedsUpdate(){this.resetBBoxNeedsUpdateSelf(),this.traverseAncestors(e=>{e.resetBBoxNeedsUpdateSelf()})}updateTransformState(e){let t=!1;e.position!==void 0&&(t=!0,this.position=e.position),e.rotation!==void 0&&(t=!0,this.rotation=e.rotation),e.scale!==void 0&&(t=!0,this.scale=e.scale),e.shear!==void 0&&(t=!0,this.shear=e.shear),t&&(this.updateWorldMatrix(!0,!1,!0),this.resetBBoxNeedsUpdate())}updateByOp(e,t,r){e.type===0&&e.props.visible!==void 0&&(this.visible=e.props.visible),this.data=t,this.data=t;let i=e,n=li(e.path,["states","*"]);if(n!==null){if(e.type===0){let[a]=n;if((this==null?void 0:this.stateSelection)===a){let o={...e.props};if(delete o.name,Object.values(e.props).some(s=>s===void 0)){let s=this.data;if(s!==void 0){let l=xn.zoom(s,e.path.slice(2));if(l)for(let c in e.props)e.props[c]===void 0&&c in l&&(o[c]=l[c])}}i={...e,props:o,path:e.path.slice(2)}}}}else if(e.type===0){let a=this.stateSelection?this.data.states.data(this.stateSelection):void 0;if(a!==void 0){if(e.props.name!==void 0&&a.name){let{name:s,...l}=a;a=l}let o=xn.removeOverridden(e.path,e.props,a);i={...e,props:o}}}this.updateByPatchedOpBase(i,Ud.patch(this.data,this.stateSelection?this.data.states.data(this.stateSelection):void 0),r)}changeSelectedState(e,t,r=!1){if(!(this.data.states.length===0&&!r)){for(let i of this.data.states)Ud.toOps(this.data,i.data).forEach(n=>{let a=o1.replaceProps(n,this.data);this.dataPatched=this.data,this.updateByPatchedOp(a,this.data,t)});if(e!==null){let i=this.data.states.data(e);i&&(this.dataPatched=Ud.patch(this.data,i),Ud.toOps(this.data,i).forEach(n=>{this.updateByPatchedOp(n,this.dataPatched,t)}))}r&&this.updateTransformState(this.dataPatched),this.stateSelection=e}}updateState(e,t){e.name!==void 0&&(this.name=e.name),e.visible!==void 0&&(this.visible=e.visible),this.updateTransformState(e)}updateByPatchedOpBase(e,t,r){this.dataPatched=t,this.updateByPatchedOp(e,t,r)}updateByPatchedOp(e,t,r){e.path.length===0&&e.type===0&&this.updateState(e.props,r),this.requestRender()}traverseFrameAncestors(e){this.traverseAncestors(t=>{t.data.type==="frame2d"&&e(t)})}traverseAncestors(e){let t=this.parent;for(;t;)e(t),t=t.parent}requestRender(){this.traverseFrameAncestors(e=>{e.requestRender()})}clone(e){let t=new Vn(this.uuid,this.data,e);return t.parent=void 0,t}addEventListener(e,t){this.emitter.on(e,t)}removeEventListener(e,t){this.emitter.off(e,t)}dispatchEvent(e){this.emitter.emit(e.type,{...e,target:e.target??this})}traverseSortNextHelper(){let e=this.parent;if(e){let t=e.children;if(t){let r=t.indexOf(this)+1;return t[r]?t[r]:e.traverseSortNextHelper()}}}sortNext(){let e=this.children;return e&&e.length>0&&e[0]?e[0]:this.traverseSortNextHelper()}isDescendantOf(e){e instanceof Vn&&(e=e.uuid);let t=this;for(;t.parent;){if(t.parent.uuid===e)return!0;t=t.parent}return!1}},ss=class extends Vn{constructor(e,t,r){super(e,t,r),this.uuid=e,this.data=t,this.context=r,this.children=[]}add(e){e.parent&&e.parent instanceof ss&&e.parent.remove(e),this.children.push(e),e.parent=this}remove(e){let t=this.children.indexOf(e);t>=0&&(this.children.splice(t,1),e.parent=void 0)}traverse(e){let t=e(this);if(t!==!0)for(let r of this.children)r instanceof ss?r.traverse(e):t=e(r)}intersectsChildrenHelper(e,t,r,i,n){for(let a of this.children)if(a.intersects(e,t,r,!1)&&(n.push(a),i)||a instanceof ss&&a.intersectsChildrenHelper(e,t,r,i,n))return!0;return!1}intersectsChildren(e,t,r,i=!1,n=[],a=!1){return this.intersectsChildrenHelper(e,t,r,i,n),n}intersectsChildrenHelperReverse(e,t,r,i,n){for(let a of this.children)if(a instanceof ss&&a.intersectsChildrenHelperReverse(e,t,r,i,n)||a.intersects(e,t,r,!1)&&(n.push(a),i))return!0;return!1}intersectsChildrenReverse(e,t,r,i=!1,n=[],a=!1){return this.intersectsChildrenHelperReverse(e,t,r,i,n),n}updateWorldMatrix(e,t,r){if(super.updateWorldMatrix(e,t,r),r&&this.children)for(let i of this.children)i.updateWorldMatrix(e,!1,!0)}find(e){let t;return this.traverse(r=>{r.uuid===e&&(t=r)}),t}innerDrawChildren(e){for(let t=this.children.length-1;t>=0;t--)this.children[t].draw(e)}resetBBoxNeedsUpdate(){super.resetBBoxNeedsUpdate(),this.traverse(e=>{e.resetBBoxNeedsUpdateSelf()})}clone(e){let t=new ss(this.uuid,this.data,e);t.parent=void 0;for(let r of this.children)t.add(r.clone(e));return t}},Uu=class extends ss{constructor(e,t,r){super(e,t,r),this.uuid=e,this.data=t,this.updateState(t,r)}draw(e){!this.visible||(e.save(),this.applyTransforms(e),this.innerDrawChildren(e),e.restore())}clone(e){let t=new Uu(this.uuid,this.data,e);t.parent=void 0;for(let r of this.children)t.add(r.clone(e));return t}};function R5e(e,t){let[[r,i],[n,a]]=e,[[o,s],[l,c]]=t,u=(r-n)*(s-c)-(i-a)*(o-l);if(u===0)return!1;let d=((r-o)*(s-c)-(i-s)*(o-l))/u,h=-((r-n)*(i-s)-(i-a)*(r-o))/u;return d>=0&&d<=1&&h>=0&&h<=1}var B9=[[-1,1],[-1,-1],[1,-1],[1,1]],Y4=(e,t,r)=>{let i=e.getCenter(),n=e.getHalfSize(),a=kr.append(t,e.worldMatrix);n[0]===0&&n[1]===0?r.push(kr.apply(i,a)):B9.forEach(o=>{let s=[o[0]*n[0]+i[0],o[1]*n[1]+i[1]];r.push(kr.apply(s,a))})},qE=class{constructor(){this.matrix=kr.identity(),this.min=[1/0,1/0],this.max=[-1/0,-1/0],this.vertices=[],this.edges=[]}setFromObjectSize(e,t=!1){e.updateWorldMatrix(),this.makeEmpty(),kr.copy(e.worldMatrix,this.matrix);let r=kr.invert(e.worldMatrix);this.expandByObjectSize(e,r,t)}expandByObjectSize(e,t,r=!1){let i=[];r===!0&&e instanceof ss?e.traverse(n=>{n.visible&&Y4(n,t,i)}):Y4(e,t,i),this.setFromPoints(i)}setFromSize(e,t,r){this.makeEmpty(),kr.copy(r,this.matrix),this.expandBySize(e,t,r)}expandBySize(e,t,r){[kr.apply([0,0],r),kr.apply([0,t],r),kr.apply([e,t],r),kr.apply([e,0],r)].forEach(i=>this.expandByPoint(i))}getCenter(){let[e,t]=this.min,[r,i]=this.getHalfSize();return kr.apply([e+r,t+i],this.matrix)}getSize(){return[this.max[0]-this.min[0],this.max[1]-this.min[1]]}getHalfSize(){return[(this.max[0]-this.min[0])*.5,(this.max[1]-this.min[1])*.5]}makeEmpty(){this.min=[1/0,1/0],this.max=[-1/0,-1/0]}setFromPoints(e){this.makeEmpty();for(let t of e)this.expandByPoint(t)}expandByPoint(e){this.min=[Math.min(this.min[0],e[0]),Math.min(this.min[1],e[1])],this.max=[Math.max(this.max[0],e[0]),Math.max(this.max[1],e[1])]}computeVertices(){let[e,t]=this.getHalfSize(),r=this.getCenter(),[i,n,a,o]=kr.getAbcdef(this.matrix),s=kr.create(i,n,a,o,r[0],r[1]);this.vertices=B9.map(([l,c])=>kr.apply([l*e,c*t],s))}computeEdges(){this.edges=[];for(let e=0,t=this.vertices.length;e<t;++e)this.edges.push([this.vertices[e],this.vertices[(e+1)%t]])}project(e,t){let r=this.matrix;return t&&(r=kr.append(t.worldMatrix,r)),kr.applyInverse(e,r)}intersects(e,t,r){return this.intersectsInLocalSpace(...this.project([e,t],r))}intersectsInLocalSpace(e,t){let{min:r,max:i}=this;return e>=r[0]&&e<=i[0]&&t>=r[1]&&t<=i[1]}containsPoint(e){let[t,r]=e,[i,n]=this.min,[a,o]=this.max;return t>=i&&t<=a&&r>=n&&r<=o}intersectsBBox2D(e){for(let t=0,r=this.edges.length;t<r;t++){let i=this.edges[t];for(let n=0,a=e.edges.length;n<a;n++){let o=e.edges[n];if(R5e(i,o))return!0}}for(let t=0,r=e.vertices.length;t<r;t++){let i=e.vertices[t];if(this.containsPoint(i))return!0}return!1}ensureMinMax(){let e=this.min,t=this.max;this.min=[Math.min(e[0],t[0]),Math.min(e[1],t[1])],this.max=[Math.max(e[0],t[0]),Math.max(e[1],t[1])]}copy(e){this.min=[...e.min],this.max=[...e.max],kr.copy(e.matrix,this.matrix),this.computeVertices(),this.computeEdges()}clone(){let e=new qE;return e.copy(this),e}},F9,I5e=new Promise(e=>{F9=e}),X4=!1,yb;function z5e(){if(X4)return;if(yb)return yb;async function e(){let t=await Cc(()=>import("./ui-L7l3pL7d.js"),[]);F9(t.default??t),X4=!0}return yb=e(),yb}function K4(e){let t=!1;return e.scene.objects.traverse((r,i)=>{(i.type==="Mesh"&&i.geometry.type==="UIGeometry"||i.type==="Page"&&i.uiFrame!==void 0)&&(t=!0)}),t}var tr,N_;async function k5e(e){let t=await I5e;tr||(N_||(N_=t({locateFile:()=>e})),tr=await N_)}var Q4=kr.identity(),N9=class{constructor(e,t=1){this.canvas=e,this._dpr=t,this._width=0,this._height=0,this._strokeMode="inside",this._layerBlur=0,this._backgroundBlur=0,this._dropShadowBlur=0,this._dropShadowOffsetX=0,this._dropShadowOffsetY=0,this._dropShadowColor=ii.transparent,this._innerShadowBlur=0,this._innerShadowOffsetX=0,this._innerShadowOffsetY=0,this._innerShadowSpread=0,this._innerShadowColor=ii.transparent,this._fonts=new Map,this._isSizeDirty=!1;try{let r=e.getBoundingClientRect();e.width=r.width*t,e.height=r.height*t}catch{console.log(e.width,t)}this._currentM3Transform=Q4,this._currentTransform=new Float32Array(Q4)}get dpr(){return this._dpr}set dpr(e){this._dpr=e,this._isSizeDirty=!0}async init(){var e,t;if(!this.wasmURL)throw Error("Your must set the wasm binary url with renderer.wasmURL = ... before you can call renderer.init");await k5e(this.wasmURL),this._surface=tr.MakeWebGLCanvasSurface(this.canvas),this.ctx=(e=this._surface)==null?void 0:e.getCanvas(),this._paint=new tr.Paint,this._paint.setAntiAlias(!0),this._paintFill=this._paint.copy(),this._paintFill.setStyle(tr.PaintStyle.Fill),this._paintStroke=this._paint.copy(),this._paintStroke.setStyle(tr.PaintStyle.Stroke),(t=this.ctx)==null||t.scale(this.dpr,this.dpr)}get currentTransform(){return this._currentM3Transform}get currentTransformBuffer(){return this._currentTransform}set currentTransform(e){this._currentM3Transform=e,this._currentTransform.set(e)}async loadFont(e,t){let r=await(await fetch(e)).arrayBuffer();this.registerFont(r,t)}registerFont(e,t){if(this._fonts.has(t))return;let r=tr.FontMgr.FromData(e);if(r)this._fonts.set(t,r);else throw new Error("Invalid font data for "+t)}get width(){return this._width}get height(){return this._height}set strokeColor(e){this._paintStroke&&this._paintStroke.setColor(bb(e),tr.ColorSpace.DISPLAY_P3)}set fillColor(e){this._paintFill&&this._paintFill.setColor(bb(e),tr.ColorSpace.DISPLAY_P3)}set lineWidth(e){this._paintStroke&&this._paintStroke.setStrokeWidth(this._strokeMode==="center"?e:e*2)}set strokeMode(e){this._strokeMode=e}set dropShadowBlur(e){this._dropShadowBlur=e}set dropShadowColor(e){this._dropShadowColor=e}set dropShadowOffsetX(e){this._dropShadowOffsetX=e}set dropShadowOffsetY(e){this._dropShadowOffsetY=e}set innerShadowBlur(e){this._innerShadowBlur=e}set innerShadowColor(e){this._innerShadowColor=e}set innerShadowOffsetX(e){this._innerShadowOffsetX=e}set innerShadowOffsetY(e){this._innerShadowOffsetY=e}set innerShadowSpread(e){this._innerShadowSpread=e}set layerBlur(e){this._layerBlur=e}set backgroundBlur(e){this._backgroundBlur=e}clear(){var e;(e=this.ctx)==null||e.clear(tr.TRANSPARENT)}save(){var e;(e=this.ctx)==null||e.save()}restore(){var e;(e=this.ctx)==null||e.restore()}beginPath(){var e;(e=this._currentPath)==null||e.delete(),this._currentPath=new tr.Path}closePath(){let e=this._currentPath;if(e){if(e.isEmpty())return;let t=e.getBounds();(t[3]-t[1]||t[2]-t[0])&&e.close()}}fill(){this._paintInner(this._paintFill,!0)}stroke(){this._paintInner(this._paintStroke,!1)}clipRect(e,t,r,i,n=0,a=0,o=0,s=0){var c,u;let l=tr.XYWHRect(e,t,r,i);if(n===0&&a===0&&s===0&&o===0)(c=this.ctx)==null||c.clipRect(l,tr.ClipOp.Intersect,!0);else{let d=tr.RRectXY(l,n,n);d[4]=d[5]=n,d[6]=d[7]=a,d[8]=d[9]=o,d[10]=d[11]=s,(u=this.ctx)==null||u.clipRRect(d,tr.ClipOp.Intersect,!0)}}_applyShadowOffsetMatrix(){if(this.ctx){let e=kr.invert(this.currentTransform);this.ctx.concat(e);let t=kr.translate(kr.identity(),this._dropShadowOffsetX,this._dropShadowOffsetY);this.ctx.concat(t),this.ctx.concat(this._currentTransform)}}_applyEffectsToPaint(e,t,r=!0){var i,n,a,o;if(this.ctx&&this._currentPath){let s,l=!1;if(r&&this._hasDropShadow()){let c=e.copy();c.setColor(bb(this._dropShadowColor));let u;this._dropShadowBlur>0&&(u=tr.MaskFilter.MakeBlur(tr.BlurStyle.Normal,this._dropShadowBlur*this.dpr*(((i=this.camera)==null?void 0:i.scale)??1),!1),c.setMaskFilter(u)),this.ctx.save(),this.ctx.clipPath(this._currentPath,tr.ClipOp.Difference,!0),this._applyShadowOffsetMatrix(),t(c),this.ctx.restore(),c.delete(),u==null||u.delete()}if(this._backgroundBlur>0&&r){this.ctx.save(),this.ctx.clipPath(this._currentPath,tr.ClipOp.Intersect,!0);let c=tr.ImageFilter.MakeBlur(this._backgroundBlur,this._backgroundBlur,tr.TileMode.Clamp,null),u=e.copy();u.setImageFilter(c),u.setAlphaf(1);let d=this._currentPath.computeTightBounds();this.ctx.saveLayer(u,d,null,tr.SaveLayerInitWithPrevious),this.ctx.drawColor(e.getColor()),this.ctx.restore(),this.ctx.restore(),u.delete(),c.delete(),l=!0}if(this._layerBlur>0){let c=e.copy();s=tr.MaskFilter.MakeBlur(tr.BlurStyle.Normal,this._layerBlur*this.dpr*(((n=this.camera)==null?void 0:n.scale)??1),!1),c.setMaskFilter(s),t(c),c.delete(),s.delete(),l=!0}if(l||t(e),r&&this._hasInnerShadow()){let c=new tr.Paint;c.setAntiAlias(!0),c.setStyle(tr.PaintStyle.Fill),c.setColor(bb(this._innerShadowColor));let u;this._innerShadowBlur>0&&(u=tr.MaskFilter.MakeBlur(tr.BlurStyle.Normal,this._innerShadowBlur*this.dpr*(((a=this.camera)==null?void 0:a.scale)??1),!1),c.setMaskFilter(u));let d=this._currentPath.computeTightBounds(),[h,f,p,v]=d,m=p-h,g=v-f;this.ctx.save(),this.ctx.clipPath(this._currentPath,tr.ClipOp.Intersect,!0),this.ctx.saveLayer(c,d,null,tr.SaveLayerInitWithPrevious),(o=this.ctx)==null||o.translate(this._innerShadowOffsetX,this._innerShadowOffsetY),this.ctx.drawRect(tr.XYWHRect(-1e3-this._innerShadowOffsetX,-1e3-this._innerShadowOffsetY,2e3+m+Math.abs(this._innerShadowOffsetX*2),2e3+g+Math.abs(this._innerShadowOffsetY*2)),c),c.setBlendMode(tr.BlendMode.Clear),this.ctx.drawPath(this._currentPath,c),this.ctx.restore(),this.ctx.restore(),c.delete(),u==null||u.delete()}}}_paintInner(e,t=!0){if(this.ctx&&this._currentPath&&e){let r=this.ctx,i=this._currentPath;this._applyEffectsToPaint(e,n=>{let a=!1;!t&&this._strokeMode!=="center"&&(r.save(),r.clipPath(i,this._strokeMode==="outside"?tr.ClipOp.Difference:tr.ClipOp.Intersect,!0),a=!0),r.drawPath(i,n),a&&r.restore()},t)}}_hasDropShadow(){var e;return((e=this._dropShadowColor)==null?void 0:e.a)>0}_hasInnerShadow(){var e;return((e=this._innerShadowColor)==null?void 0:e.a)>0}path(e){var t;(t=this._currentPath)==null||t.addPath(tr.Path.MakeFromSVGString(e))}ellipse(e,t,r,i,n,a,o,s){var c;if(!Z4([e,t,r,i])||!this._currentPath)return;if(r<0||i<0)throw Error("radii cannot be negative");let l=tr.XYWHRect(e-r,t-i,r*2,i*2);(c=this._currentPath)==null||c.addOval(l)}rect(e,t,r,i,n=0,a=0,o=0,s=0){var c,u;let l=tr.XYWHRect(e,t,r,i);if(Z4(l))if(n===0&&a===0&&s===0&&o===0)(c=this._currentPath)==null||c.addRect(l);else{let d=tr.RRectXY(l,n,n);d[4]=d[5]=n,d[6]=d[7]=a,d[8]=d[9]=o,d[10]=d[11]=s,(u=this._currentPath)==null||u.addRRect(d)}}getHorizontalAlign(e){switch(e){case 2:return tr.TextAlign.Right;case 3:return tr.TextAlign.Center;case 4:return tr.TextAlign.Justify;case 1:default:return tr.TextAlign.Left}}drawTextInner(e,t,r,[i,n,a,o],s,l,c=!0){let u=0,{ctx:d}=this;if(!d)return u;let h=l.copy(),f=l.copy();return f.setAlphaf(0),this._applyEffectsToPaint(h,p=>{t.pushPaintStyle(r,p,f),t.addText(e);let v=t.build();v.layout(a);let m=n;s===2?m+=(o-v.getHeight())/2:s===3&&(m+=o-v.getHeight()),d.drawParagraph(v,i,m),u=v.getHeight(),t.reset(),v.delete()},c),h.delete(),f.delete(),u}drawText(e,t){let r=0,i=this._fonts.get(t.font),{ctx:n,_paintFill:a,_paintStroke:o}=this;if(i&&n){let s=new tr.TextStyle({fontFamilies:[t.font],fontSize:t.fontSize,heightMultiplier:t.lineHeight,letterSpacing:t.letterSpacing}),l=new tr.ParagraphStyle({textStyle:s,textAlign:this.getHorizontalAlign(t.horizontalAlign)}),c=tr.XYWHRect(t.x,t.y,t.width,t.height),u=tr.ParagraphBuilder.Make(l,i);a&&(r=this.drawTextInner(e,u,s,c,t.verticalAlign,a,!0)),o&&(r=this.drawTextInner(e,u,s,c,t.verticalAlign,o,!1)),u.delete()}return{height:r}}render(){var e;(e=this._surface)==null||e.flush()}moveTo(e,t){var r;(r=this._currentPath)==null||r.moveTo(e,t)}lineTo(e,t){var r;(r=this._currentPath)==null||r.lineTo(e,t)}bezierCurveTo(e,t,r,i,n,a){var o;(o=this._currentPath)==null||o.cubicTo(e,t,r,i,n,a)}quadraticCurveTo(e,t,r,i){var n;(n=this._currentPath)==null||n.quadTo(e,t,r,i)}setTransform(e,t=!1){var n,a,o,s,l;if(!this.ctx)return;let r=this.ctx.getTotalMatrix(),i=kr.invert(r);if(i&&this.ctx.concat(i),(n=this.ctx)==null||n.scale(this.dpr,this.dpr),((a=this.camera)==null?void 0:a.enabled)&&((o=this.ctx)==null||o.concat(this.camera.worldMatrix),t)){let c=kr.getScale(this.camera.worldMatrix);(s=this.ctx)==null||s.scale(1/c[0],1/c[1])}(l=this.ctx)==null||l.concat(e),this.currentTransform=e}transform(e){var t;(t=this.ctx)==null||t.concat(e)}setSize(e,t){var r;!this._isSizeDirty&&e===this._width&&t===this._height||(this._isSizeDirty=!1,this._width=e,this._height=t,this.canvas.style.width=e+"px",this.canvas.style.height=t+"px",this.canvas.width=e*this.dpr,this.canvas.height=t*this.dpr,this._surface&&(this._surface=tr.MakeWebGLCanvasSurface(this.canvas),this.ctx=(r=this._surface)==null?void 0:r.getCanvas()))}};function Z4(e){for(let t=0;t<e.length;t++)if(e[t]!==void 0&&!Number.isFinite(e[t]))return!1;return!0}function bb({r:e,g:t,b:r,a:i}){return tr.Color4f(e,t,r,i)}var J4=class{constructor(e,t,r){this.uuid=e,this.data=t,this.enabled=!1,this.color=ii.transparent,this.blurRadius=0,this.offset=[0,0],this.spread=0,this.update(t)}update(e){e.color!==void 0&&(this.color=e.color),e.enabled!==void 0&&(this.enabled=e.enabled),e.blurRadius!==void 0&&(this.blurRadius=e.blurRadius),e.offset!==void 0&&(this.offset=e.offset),e.spread!==void 0&&(this.spread=e.spread)}},eF=class{constructor(e,t,r){this.uuid=e,this.data=t,this.enabled=!1,this.radius=0,this.update(t)}update(e){e.enabled!==void 0&&(this.enabled=e.enabled),e.radius!==void 0&&(this.radius=e.radius)}},L5e=class{constructor(e,t,r){this.uuid=e,this.data=t,this.enabled=!1,this.color=ii.transparent,this.update(t)}update(e){e.enabled!==void 0&&(this.enabled=e.enabled),e.color!==void 0&&(this.color=e.color)}},B5e=class{constructor(e,t,r){this.uuid=e,this.data=t,this.enabled=!1,this.color=ii.transparent,this.thickness=0,this.mode="inside",this.update(t)}update(e){e.enabled!==void 0&&(this.enabled=e.enabled),e.color!==void 0&&(this.color=e.color),e.thickness!==void 0&&(this.thickness=e.thickness),e.mode!==void 0&&(this.mode=e.mode)}},In=class extends Vn{constructor(e,t,r){super(e,t,r),this.uuid=e,this.data=t,this.autoClose=!0,this.fill=new L5e(e+"-fill",t.fill,r),this.stroke=new B5e(e+"-stroke",t.stroke,r),this.dropShadow=new J4(e+"-dropShadow",t.dropShadow,r),this.innerShadow=new J4(e+"-innerShadow",t.innerShadow,r),this.backgroundBlur=new eF(e+"-backgroundBlur",t.backgroundBlur,r),this.layerBlur=new eF(e+"-layerBlur",t.layerBlur,r)}applyFillStroke(e){e.fillColor=this.fill.enabled?this.fill.color:ii.transparent,e.strokeColor=this.stroke.enabled&&this.stroke.thickness>0?this.stroke.color:ii.transparent,e.strokeMode=this.stroke.mode,e.lineWidth=this.stroke.thickness}applyFilters(e){this.layerBlur.enabled?e.layerBlur=this.layerBlur.radius*5:e.layerBlur=0,this.backgroundBlur.enabled?e.backgroundBlur=this.backgroundBlur.radius*5:e.backgroundBlur=0,this.dropShadow.enabled?(e.dropShadowBlur=this.dropShadow.blurRadius*5,e.dropShadowColor=this.dropShadow.color,e.dropShadowOffsetX=this.dropShadow.offset[0],e.dropShadowOffsetY=this.dropShadow.offset[1]):e.dropShadowColor=ii.transparent,this.innerShadow.enabled?(e.innerShadowSpread=this.innerShadow.spread,e.innerShadowBlur=this.innerShadow.blurRadius*5,e.innerShadowColor=this.innerShadow.color,e.innerShadowOffsetX=this.innerShadow.offset[0],e.innerShadowOffsetY=this.innerShadow.offset[1]):e.innerShadowColor=ii.transparent}innerDraw(e){}draw(e){!this.visible||(e.save(),this.applyTransforms(e),this.applyFilters(e),this.applyFillStroke(e),e.beginPath(),this.innerDraw(e),this.autoClose&&e.closePath(),this.fill.enabled&&e.fill(),this.stroke.enabled&&e.stroke(),e.restore())}updateByPatchedOp(e,t,r){super.updateByPatchedOp(e,t,r),e.type===0&&(li(e.path,["fill"])?this.fill.update(e.props):li(e.path,["stroke"])?this.stroke.update(e.props):li(e.path,["dropShadow"])?this.dropShadow.update(e.props):li(e.path,["innerShadow"])?this.innerShadow.update(e.props):li(e.path,["layerBlur"])?this.layerBlur.update(e.props):li(e.path,["backgroundBlur"])?this.backgroundBlur.update(e.props):this.resetBBoxNeedsUpdate())}updateState(e,t){super.updateState(e,t),e.fill!==void 0&&this.fill.update(e.fill),e.stroke!==void 0&&this.stroke.update(e.stroke),e.dropShadow!==void 0&&this.dropShadow.update(e.dropShadow),e.innerShadow!==void 0&&this.innerShadow.update(e.innerShadow),e.layerBlur!==void 0&&this.layerBlur.update(e.layerBlur),e.backgroundBlur!==void 0&&this.backgroundBlur.update(e.backgroundBlur)}clone(e){let t=new In(this.uuid,this.data,e);return t.parent=void 0,t}},e3=class extends In{constructor(e,t,r){super(e,t,r),this.uuid=e,this.data=t,this.width=0,this.height=0,this.updateState(t,r)}innerDraw(e){e.ellipse(this.width*.5,this.height*.5,this.width*.5,this.height*.5,0,0,Math.PI*2)}intersectsInLocalSpace(e,t){return D5e(e,t,this.width*.5,this.height*.5,this.width*.5,this.height*.5)}getCenter(){return[this.width*.5,this.height*.5]}getHalfSize(){return[this.width*.5,this.height*.5]}updateSizeState(e){let t=!1;e.width!==void 0&&(this.width=typeof e.width=="number"?e.width:this.width,t=!0),e.height!==void 0&&(this.height=typeof e.height=="number"?e.height:this.height,t=!0),t&&this.updateWorldMatrix(!0,!1,!0)}updateState(e,t){super.updateState(e,t),this.updateSizeState(e)}clone(e){let t=new e3(this.uuid,this.data,e);return t.parent=void 0,t}},P0=class extends In{constructor(e,t,r){super(e,t,r),this.uuid=e,this.data=t,this.width=0,this.height=0,this.cornerRadius=[0,0,0,0],this.updateState(t,r)}innerDraw(e){e.rect(0,0,this.width,this.height,...this.cornerRadius)}getCenter(){return[this.width*.5,this.height*.5]}getHalfSize(){return[this.width*.5,this.height*.5]}updateCornerState(e){e.cornerRadius!==void 0&&(this.cornerRadius=e.cornerRadius)}updateSizeState(e){let t=!1;e.width!==void 0&&(this.width=typeof e.width=="number"?e.width:this.width,t=!0),e.height!==void 0&&(this.height=typeof e.height=="number"?e.height:this.height,t=!0),t&&this.updateWorldMatrix(!0,!1,!0)}updateState(e,t){super.updateState(e,t),this.updateSizeState(e),this.updateCornerState(e)}clone(e){let t=new P0(this.uuid,this.data,e);return t.parent=void 0,t}},t3=class extends In{constructor(e,t,r){super(e,t,r),this.uuid=e,this.data=t,this._textHeight=0,this._textHeightDirty=!0,this.width=0,this.height=0,this.updateState(t,r)}get textHeight(){return this._textHeight}applyFillStroke(e){e.fillColor=this.fill.enabled?this.fill.color:ii.transparent,e.strokeColor=this.stroke.enabled&&this.stroke.thickness>0?this.stroke.color:ii.transparent,e.strokeMode="center",e.lineWidth=this.stroke.thickness}innerDraw(e){var a;(a=this._fontHolder)!=null&&a.arrayBuffer&&this._fontHolder.arrayBuffer.byteLength>1&&this.data.font&&e.registerFont(this._fontHolder.arrayBuffer,this.data.font);let t=this.data.textTransform,r=this.data.text.textValue.toString(),i=t===2?r.toUpperCase():t===3?r.toLowerCase():r,{height:n}=e.drawText(i,{x:0,y:0,width:this.width,height:this.height,fontSize:this.data.fontSize,lineHeight:this.data.lineHeight??1,letterSpacing:this.data.letterSpacing??0,horizontalAlign:this.data.horizontalAlign,verticalAlign:this.data.verticalAlign,font:this.data.font});this._textHeight=n}getCenter(){return[this.width*.5,this.height*.5]}getHalfSize(){return[this.width*.5,this.height*.5]}updateSizeState(e){let t=!1;e.width!==void 0&&(this.width=typeof e.width=="number"?e.width:this.width,t=!0),e.height!==void 0&&(this.height=typeof e.height=="number"?e.height:this.height,t=!0),t&&this.updateWorldMatrix(!0,!1,!0)}updateFontState(e,{shared:t}){e.font!==void 0&&(this._fontHolder=t.getFont(e.font),this._fontHolder&&!this._fontHolder.isLoaded&&this._fontHolder.loadingPromise.then(()=>{this.requestRender()}))}updateState(e,t){super.updateState(e,t),this.updateSizeState(e),this.updateFontState(e,t)}clone(e){let t=new t3(this.uuid,this.data,e);return t.parent=void 0,t}},U9=class extends In{constructor(e,t,r){super(e,t,r),this.uuid=e,this.data=t,this.curves=[],this.extremasBBox={min:[0,0],max:[0,0]},this.updateState(t,r)}computeExtremas(){this.curves.length===0&&this.computeCurves();let e=this.curves.map(i=>I1.extremas(i)),t=[1/0,1/0],r=[-1/0,-1/0];for(let i=0,n=e.length;i<n;i++){let a=e[i];a[0][0]<t[0]&&(t[0]=a[0][0]),a[0][1]<t[1]&&(t[1]=a[0][1]),a[1][0]>r[0]&&(r[0]=a[1][0]),a[1][1]>r[1]&&(r[1]=a[1][1])}return this.extremasBBox.min=[t[0],t[1]],this.extremasBBox.max=[r[0],r[1]],this.extremasBBox}computeCurves(){this.curves=[];for(let r=1,i=this.data.points.length;r<i;r++){let n=this.data.points[r].data,a=this.data.points[r-1].data,o={start:a.position,cp1:a.controlNext.position,cp2:n.controlPrevious.position,end:n.position};this.curves.push(o)}let e=this.data.points[0].data,t=this.data.points[this.data.points.length-1].data;if(this.data.isClosed){let r={start:t.position,cp1:t.controlNext.position,cp2:e.controlPrevious.position,end:e.position};this.curves.push(r)}}getCenter(){let[e,t]=this.extremasBBox.min,[r,i]=this.getHalfSize();return[e+r,t+i]}getHalfSize(){let{min:e,max:t}=this.extremasBBox;return[(t[0]-e[0])*.5,(t[1]-e[1])*.5]}innerDraw(e){for(let i=0,n=this.data.points.length;i<n;i++){let a=this.data.points[i].data;if(i===0){let[o,s]=a.position;e.moveTo(o,s)}else{let o=this.data.points[i-1].data,[s,l]=o.controlNext.position,[c,u]=a.controlPrevious.position,[d,h]=a.position,f={start:o.position,cp1:o.controlNext.position,cp2:a.controlPrevious.position,end:a.position};I1.derive(f),e.bezierCurveTo(s,l,c,u,d,h)}}let t=this.data.points[0].data,r=this.data.points[this.data.points.length-1].data;if(this.data.isClosed){let[i,n]=r.controlNext.position,[a,o]=t.controlPrevious.position,[s,l]=t.position;e.bezierCurveTo(i,n,a,o,s,l)}}updateState(e,t){super.updateState(e,t),this.computeExtremas()}clone(e){let t=new U9(this.uuid,this.data,e);return t.parent=void 0,t}},I1;(e=>{function t(o){let s=o.start,l=o.cp1,c=o.cp2,u=o.end,d=[3*(l[0]-s[0]),3*(l[1]-s[1])],h=[3*(c[0]-l[0]),3*(c[1]-l[1])],f=[3*(u[0]-c[0]),3*(u[1]-c[1])],p={start:d,cp:h,end:f};return o.derivative=p,p.derivative=YE.derive(p),p}e.derive=t;function r(o,s,l,c=!1){let u=o-2*s+l;if(u!==0){let d=-Math.sqrt(Math.abs(s*s-o*l)),h=-o+s,f=-(d+h)/u,p=-(-d+h)/u;return[f,p]}else if(s!==l&&u===0)return[(2*s-l)/(2*(s-l))];return[]}function i(o){let s=o.derivative??e.derive(o),l=s.start,c=s.cp,u=s.end;return[r(l[0],c[0],u[0]),r(l[1],c[1],u[1])]}e.droot=i;function n(o){let[s,l]=e.droot(o),c=[o.start[0],o.end[0]],u=[o.start[1],o.end[1]];for(let d of s)c.push(e.compute(o,Math.min(1,Math.max(0,d)))[0]);for(let d of l)u.push(e.compute(o,Math.min(1,Math.max(0,d)))[1]);return c.sort((d,h)=>d-h),u.sort((d,h)=>d-h),[[c[0],u[0]],[c[c.length-1],u[u.length-1]]]}e.extremas=n;function a(o,s){if(s===0)return[...o.start];if(s===1)return[...o.end];let l=1-s,c=l*l,u=s*s,d=c*l,h=c*s*3,f=l*u*3,p=s*u;return[d*o.start[0]+h*o.cp1[0]+f*o.cp2[0]+p*o.end[0],d*o.start[1]+h*o.cp1[1]+f*o.cp2[1]+p*o.end[1]]}e.compute=a})(I1||(I1={}));var YE;(e=>{function t(n){let a=n.start,o=n.cp,s=n.end,l=[2*(o[0]-a[0]),2*(o[1]-a[1])],c=[2*(s[0]-o[0]),2*(s[1]-o[1])],u={start:l,end:c};return u.derivative=XE.derive(u),n.derivative=u,u}e.derive=t;function r(n){let a=n.derivative??e.derive(n),o=a.start,s=a.end;return[o[0]!==s[0]?o[0]/(o[0]-s[0]):0,o[1]!==s[1]?o[1]/(o[1]-s[1]):0]}e.droot=r;function i(n,a){if(a===0)return[...n.start];if(a===1)return[...n.end];let o=1-a,s=o*o,l=a*a,c=s,u=o*a*2,d=l;return[c*n.start[0]+u*n.cp[0]+d*n.end[0],c*n.start[1]+u*n.cp[1]+d*n.end[1]]}e.compute=i})(YE||(YE={}));var XE;(e=>{function t(i){let n=i.start,a=i.end,o=[a[0]-n[0],a[1]-n[1]];return i.derivative=o,i.derivative}e.derive=t;function r(i,n){if(n===0)return[...i.start];if(n===1)return[...i.end];let a=i.start,o=i.end;return[a[0]+(o[0]-a[0])*n,a[1]+(o[1]-a[1])*n]}e.compute=r})(XE||(XE={}));var ul=class extends ss{constructor(e,t,r){super(e,t,r),this.uuid=e,this.width=0,this.height=0,this.clipped=!0,this.background=new P0(e+"-background",Vg.defaultData,r),this.background.parent=this,this.updateState(t,r)}get fill(){return this.background.fill}get stroke(){return this.background.stroke}get backgroundBlur(){return this.background.backgroundBlur}get layerBlur(){return this.background.layerBlur}get dropShadow(){return this.background.dropShadow}get innerShadow(){return this.background.innerShadow}get cornerRadius(){return this.background.cornerRadius}set cornerRadius(e){this.background.cornerRadius=e}updateLocalMatrix(){var e;super.updateLocalMatrix(),(e=this.background)==null||e.updateLocalMatrix()}updateWorldMatrix(e,t,r){var i;super.updateWorldMatrix(e,t,r),(i=this.background)==null||i.updateWorldMatrix(e,t,r)}draw(e){if(!this.visible)return;e.save();let t=this.width,r=this.height;this.applyTransforms(e),this.background.width=t,this.background.height=r,this.background.draw(e),this.clipped&&e.clipRect(0,0,t,r,...this.cornerRadius),this.innerDrawChildren(e),e.restore()}getCenter(){return[this.width*.5,this.height*.5]}getHalfSize(){return[this.width*.5,this.height*.5]}updateCornerState(e){e.cornerRadius!==void 0&&(this.cornerRadius=e.cornerRadius)}updateSizeState(e){let t=!1;e.width!==void 0&&(this.width=typeof e.width=="number"?e.width:this.width,t=!0),e.height!==void 0&&(this.height=typeof e.height=="number"?e.height:this.height,t=!0),t&&this.updateWorldMatrix(!0,!1,!0)}updateState(e,t){super.updateState(e,t),this.updateSizeState(e),this.updateCornerState(e),e.fill!==void 0&&this.fill.update(e.fill),e.stroke!==void 0&&this.stroke.update(e.stroke),e.dropShadow!==void 0&&this.dropShadow.update(e.dropShadow),e.innerShadow!==void 0&&this.innerShadow.update(e.innerShadow),e.layerBlur!==void 0&&this.layerBlur.update(e.layerBlur),e.backgroundBlur!==void 0&&this.backgroundBlur.update(e.backgroundBlur),e.clipped!==void 0&&(this.clipped=e.clipped)}requestRender(){super.requestRender(),this.dispatchEvent({type:"render"})}dispose(){this.removeEventListener("render")}updateByPatchedOp(e,t,r){super.updateByPatchedOp(e,t,r),e.type===0&&(li(e.path,["fill"])?this.fill.update(e.props):li(e.path,["stroke"])?this.stroke.update(e.props):li(e.path,["dropShadow"])?this.dropShadow.update(e.props):li(e.path,["innerShadow"])?this.innerShadow.update(e.props):li(e.path,["layerBlur"])?this.layerBlur.update(e.props):li(e.path,["backgroundBlur"])?this.backgroundBlur.update(e.props):this.resetBBoxNeedsUpdate())}clone(e){let t=new ul(this.uuid,this.data,e);t.parent=void 0;for(let r of this.children)t.add(r.clone(e));return t}},F5e=Ac(GV(),1),Xw=class extends In{constructor(e,t,r){super(e,t,r),this.uuid=e,this.data=t,this._pathBBox=new DOMRect,this.path="",this.updateState(t,r),this.autoClose=!1,this.computeSVGBBox()}computeSVGBBox(){let e=document.createElementNS("http://www.w3.org/2000/svg","svg"),t=document.createElementNS("http://www.w3.org/2000/svg","path");document.body.appendChild(e),t.setAttribute("d",this.path),e.appendChild(t),this._pathBBox=t.getBBox(),e.remove()}innerDraw(e){e.path(this.path)}intersectsInLocalSpace(e,t){return e>=this._pathBBox.x&&e<=this._pathBBox.x+this._pathBBox.width&&t>=this._pathBBox.y&&t<=this._pathBBox.y+this._pathBBox.height}getCenter(){return[(this._pathBBox.x+this._pathBBox.width)/2,(this._pathBBox.y+this._pathBBox.height)/2]}getHalfSize(){return[(this._pathBBox.x+this._pathBBox.width)/2,(this._pathBBox.y+this._pathBBox.height)/2]}updateState(e,t){super.updateState(e,t),e.path!==void 0&&(this.path=e.path,this.computeSVGBBox())}clone(e){let t=new Xw(this.uuid,this.data,e);return t.parent=void 0,t}};function N5e(e,t=1,r=1){if(t<=0||r<=0)return e;let i=(0,F5e.parseSVG)(e).map(n=>{let a={...n};return"x"in a&&(a.x=a.x*t),"y"in a&&(a.y=a.y*r),"x1"in a&&(a.x1=a.x1*t),"x2"in a&&(a.x2=a.x2*t),"y1"in a&&(a.y1=a.y1*r),"y2"in a&&(a.y2=a.y2*r),"rx"in a&&(a.rx=a.rx*t),"ry"in a&&(a.ry=a.ry*r),a});return U5e(i)}function U5e(e){let t=["rx","ry","xAxisRotation","largeArc","sweep","x1","y1","x2","y2","x","y"],r;return e.map(i=>{let n=[];t.forEach(o=>{if(o in i){let s=i[o]*1;n.length&&s>=0&&n.push(","),n.push(s)}});let a=(r===i.code?n[0]<0?"":",":i.code)+n.join("");return r=i.code,a}).join("")}function j5e(e,t,r){switch(t.type){case"ellipse2d":return new e3(e,t,r);case"rectangle2d":return new P0(e,t,r);case"text2d":return new t3(e,t,r);case"vector2d":return new U9(e,t,r);case"path2d":return new Xw(e,t,r);case"frame2d":return new ul(e,t,r);case"group2d":default:return new Uu(e,t,r)}}var j9=class{constructor(e,t,r){this.uuid=e,this.data=t,this.group=new Uu(j9.GROUP_ID,{...A1.defaultData},r),this.createChildrenObjects(t.objects,this.group,r)}createObject(e,t,r,i,n,a){let o=j5e(e,t,a);o&&(i.add(o),i.children.splice(n,0,i.children.pop()),o.updateWorldMatrix(),r.length>0&&(o instanceof Uu||o instanceof ul)&&this.createChildrenObjects(r,o,a))}createChildrenObjects(e,t,r){let i=0;for(let n of e)this.createObject(n.id,n.data,n.children,t,i,r),i+=1}draw(e){this.group.draw(e)}updateEntityByOp(e,t,r,i){let n=this.find(e);if(n)try{n.updateByOp(t,r,{shared:i})}catch(a){console.error(a)}}updateTreeByOp(e,t){if(e.path.length===0&&e.type===7){let r=e.parent===null?this.group:this.find(e.parent);r!==void 0&&r instanceof ss&&(this.createObject(e.id,e.data,e.children,r,e.localIndex,t),r.requestRender())}else if(e.path.length===0&&e.type===8){let r=this.find(e.id);if(r!==void 0&&r.parent!==void 0&&r.parent instanceof ss){let i=r.parent;r.resetBBoxNeedsUpdate(),i==null||i.remove(r),i==null||i.requestRender()}}else if(e.path.length===0&&e.type===9){let r=this.find(e.id);if(r!==void 0){let i=r.parent,n=e.parent===null?this:this.find(e.parent);if(n instanceof ss||n===this){n.add(r);let a=e.localIndex;n.children.splice(a,0,n.children.pop()),r.updateWorldMatrix(!0,!1,!0),i==null||i.requestRender(),r.requestRender()}r.resetBBoxNeedsUpdate()}}}add(e){this.group.add(e)}remove(e){this.group.remove(e)}traverse(e){this.group.traverse(t=>{t!==this.group&&e(t)})}intersectsChildren(e,t,r,i=!1,n=[]){return this.group.intersectsChildren(e,t,r,i,n,!0)}intersectsChildrenReverse(e,t,r,i=!1,n=[]){return this.group.intersectsChildrenReverse(e,t,r,i,n,!0)}find(e){return this.group.find(e)}get children(){return this.group.children}project(e,t){return this.group.project(e,t)}getWithSortKey(e){let t=this.find(e);if(t===void 0)return;let r=[],i=t;for(;i!==this.group;){let n=i;i=i.parent;let a=i.children.indexOf(n);r.splice(0,0,a)}return{entity:t,sortKey:r}}getAllSorted(e){let t=[];for(let r of e){let i=this.getWithSortKey(r.id);i!==void 0&&t.push(i)}return t.sort((r,i)=>CH(r.sortKey,i.sortKey)),t.map(r=>r.entity)}},r3=j9;r3.GROUP_ID="scene2d";function V9({constraints:e,newParentWidth:t,newParentHeight:r,initialParentWidth:i,initialParentHeight:n,objectInitialWidth:a,objectInitialHeight:o,objectInitialPosition:s}){let{horizontalConstraint:l,verticalConstraint:c}=e,u=t-i,d=r-n,h=a,f=o,p=s[0],v=s[1];if(l!==0){if(l===1)p+=u;else if(l===3)p+=u/2;else if(l===2)h=Math.max(1,h+u);else if(l===4){let m=t/i;h*=m,p*=m}}if(c!==0){if(c===1)v+=d;else if(c===3)v+=d/2;else if(c===2)f=Math.max(1,f+d);else if(c===4){let m=r/n;f*=m,v*=m}}return{width:h,height:f,position:[p,v]}}Ac(GV(),1);var V5e=`
	varying vec2 vUv;
	void main() {
		vUv = uv;
		gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
	}`,H5e=`
	uniform sampler2D tDiffuse;
	varying vec2 vUv;
	void main() {
		vec4 texel = texture2D( tDiffuse, vUv );
		gl_FragColor = texel;
	}`,W5e=new Tw(-1,1,1,-1,0,1),G5e=class extends Ot{constructor(){super(),this.setAttribute("position",new yt([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new yt([0,2,0,0,2,0],2))}},$5e=new G5e,q5e=class{constructor(e){this._mesh=new Oi($5e,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,W5e)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}},H9=new Vr({defines:{},uniforms:{tDiffuse:new rt(null)},vertexShader:V5e,fragmentShader:H5e}),Y5e=new q5e(H9),U_=null,j_=null,X5e=()=>(U_===null&&(U_=document.createElement("canvas")),U_),K5e=e=>(j_===null&&(j_=new N9(e)),j_),Q5e=kr.identity(),W9=class{constructor(e,t,r,i){this.uuid=e,this.width=t,this.height=r,this.context=i,this.enabled=!0,this.isScreenSpace=!1,this.dpr=window.devicePixelRatio,this.isFrameDirty=!1,this.onRenderRequestedDownstream=()=>{this.isFrameDirty=!0,this.context.shared.requestRender()},this._innerApplySize=()=>{let n=this.width,a=this.height,o=this.dpr;this.renderer.dpr=this.isScreenSpace?o:Math.floor(2048/Math.max(n,a)),this.renderer.setSize(n,a)},this.onFrameOverrideObjectEvent=n=>{var a,o;if(((a=n.target)==null?void 0:a.uuid)!==void 0){let s=(o=this.frameRoot)==null?void 0:o.find(n.target.uuid);s&&s.dispatchEvent({...n,target:s})}},this.scene2d=new r3(St.generateUUID(),yE.defaultData,{dpr:window.devicePixelRatio,shared:i.shared}),this.canvas=X5e(),this.renderer=K5e(this.canvas),this.promise=this.init(),this.renderTarget=new jr(1,1,{type:dc,stencilBuffer:!1,depthBuffer:!1}),i.shared.addUIBuffer(this.uuid,this.renderTarget),this.textureHolder=i.shared.uiBuffer(this.uuid)}get canvasTexture(){return this._canvasTexture||(this._canvasTexture=new a_e(this.canvas)),this._canvasTexture}async init(){this.renderer instanceof N9&&(this.renderer.wasmURL=h9.skiaWasmUrl),await this.renderer.init()}render(e){var t,r;if(this.isFrameDirty){this.isFrameDirty=!1,this._innerApplySize(),this.renderer.clear(),(t=this.frameOverride)==null||t.draw(this.renderer),this.renderer.render(),H9.uniforms.tDiffuse.value=this.canvasTexture,this.canvasTexture.needsUpdate=!0;let i=e.getRenderTarget();e.setRenderTarget(this.renderTarget),e.clear(),Y5e.render(e),e.setRenderTarget(i),(r=this.textureHolder)==null||r.setNeedsUpdate(!0)}}updateEntity2DByOp(e,t,r,i){this.scene2d.updateEntityByOp(e,t,r,i),this.applySize()}updateTreeByOp(e,t){this.scene2d.updateTreeByOp(e,t),this.applySize()}applyOverrides(e){if(this.frameOverride&&this.frameRoot){this.frameOverride.position=[0,0],this.frameOverride.rotation=0;let t=(e==null?void 0:e.width)??this.width,r=(e==null?void 0:e.height)??this.height;this.frameOverride.width=t,this.frameOverride.height=r,this.frameOverride.localMatrix=Q5e,this.isScreenSpace&&(this.frameOverride.fill.color=ii.from0to1([0,0,0,0])),this.frameOverride.data={...this.frameOverride.data,width:t,height:r},G9({objectOverride:this.frameOverride,objectRoot:this.frameRoot,newParentWidth:this.frameOverride.width,newParentHeight:this.frameOverride.height,initialParentWidth:this.frameRoot.width,initialParentHeight:this.frameRoot.height}),this.frameOverride.updateWorldMatrix(!0,!1,!0)}}applySize(e,t=window.devicePixelRatio){var s,l;let r=(e==null?void 0:e.width)??this.width,i=(e==null?void 0:e.height)??this.height;this.dpr=t,this.width=r,this.height=i,this._innerApplySize();let n=1,a=512,o=512;(r*t<a||i*t<o)&&(n=Math.max(a/(r*t),o/(i*t))),this.renderTarget.setSize(r*t*n,i*t*n),(s=this._canvasTexture)==null||s.dispose(),this._canvasTexture=void 0,this.applyOverrides(e),(l=this.frameOverride)==null||l.requestRender()}applyFrame(e){var r,i;let t=this.context.scene.find2D(e);if(!(!t||!(t instanceof ul)))return this.disposeFrameOverride(),this.frameRoot=t,this.frameOverride=t.clone({dpr:this.renderer.dpr,shared:this.context.shared}),this.scene2d.add(this.frameOverride),this.applySize(),(r=this.frame)==null||r.addEventListener("render",this.onRenderRequestedDownstream),this.frameOverride.traverse(n=>{n.addEventListener("beginState",this.onFrameOverrideObjectEvent)}),this.frameOverride.traverse(n=>{n.addEventListener("completeState",this.onFrameOverrideObjectEvent)}),(i=this.frame)==null||i.requestRender(),t}get frame(){return this.frameOverride}get frameId(){var e;return(e=this.frame)==null?void 0:e.uuid}find(e){return this.scene2d.find(e)}get texture(){var e;return(e=this.textureHolder)==null?void 0:e.getTexture(1001)}disposeFrameOverride(){var e,t,r;(e=this.frameOverride)==null||e.removeEventListener("render",this.onRenderRequestedDownstream),(t=this.frameOverride)==null||t.traverse(i=>{i.removeEventListener("beginStateChange",this.onFrameOverrideObjectEvent)}),(r=this.frameOverride)==null||r.traverse(i=>{i.removeEventListener("completeState",this.onFrameOverrideObjectEvent)}),this.frameOverride&&this.scene2d.remove(this.frameOverride)}};function G9({objectOverride:e,objectRoot:t,newParentWidth:r,newParentHeight:i,initialParentWidth:n,initialParentHeight:a}){if(e instanceof ul&&t instanceof ul||e instanceof Uu&&t instanceof Uu)for(let o=0,s=e.children.length;o<s;o++){let l=e.children[o],c=t.children[o];l&&c&&l.uuid===c.uuid&&J5e({objectOverride:l,objectRoot:c,newParentWidth:r,newParentHeight:i,initialParentWidth:n,initialParentHeight:a})}}function Z5e(e){if(KE(e))return[e.width,e.height];if(e instanceof Xw){let[t,r]=e.getHalfSize();return[t*2,r*2]}else if(e instanceof Uu){let[t,r]=e.recursiveBBox.getHalfSize();return[t*2,r*2]}return[0,0]}function J5e({objectOverride:e,objectRoot:t,newParentWidth:r,newParentHeight:i,initialParentWidth:n,initialParentHeight:a}){let[o,s]=Z5e(t),{width:l,height:c,position:u}=V9({constraints:e.data,newParentWidth:r,newParentHeight:i,initialParentWidth:n,initialParentHeight:a,objectInitialWidth:o,objectInitialHeight:s,objectInitialPosition:t.position});if(e.position=u,e.data={...e.data,position:u},e.states)for(let d in e.states)eNe({stateId:d,objectOverride:e,objectRoot:t,newParentWidth:r,newParentHeight:i,initialParentWidth:n,initialParentHeight:a});if(KE(e)||e instanceof Uu)KE(e)&&(e.width=l,e.height=c,e.data={...e.data,width:l,height:c}),G9({objectOverride:e,objectRoot:t,newParentWidth:l,newParentHeight:c,initialParentWidth:o,initialParentHeight:s});else if(e instanceof Xw){let d=t,h=o!==0?l/o:1,f=s!==0?c/s:1;e.path=N5e(d.path,h,f),e.data={...e.data,path:e.path}}}function eNe({stateId:e,objectOverride:t,objectRoot:r,newParentWidth:i,newParentHeight:n,initialParentWidth:a,initialParentHeight:o}){var c,u;let s=(c=t.states)==null?void 0:c[e],l=(u=r.states)==null?void 0:u[e];if(s&&l){let{width:d,height:h,position:f}=V9({constraints:t.data,newParentWidth:i,newParentHeight:n,initialParentWidth:a,initialParentHeight:o,objectInitialWidth:rh.isResizeable(l)?l.width:0,objectInitialHeight:rh.isResizeable(l)?l.height:0,objectInitialPosition:l.position});Object.assign(t.states[e],{position:f}),rh.isResizeable(s)&&Object.assign(t.states[e],{width:d,height:h})}}function KE(e){return e instanceof P0||e instanceof ul||e instanceof e3||e instanceof t3}var Rn=class extends OD(ll){constructor(e,t,r){super(),this.data=t,this.bgColor=new sa(1,1,1,1),this.fog=null,this.backupFog=new v8(16777215,.1,2e3),this.fogUseBGColor=!1,this.isActive=!1,this.aoColor=new Bt,this.penumbraSizeArrayCache=null,this.super_Entity(e,t),this.personalCamera=new xa(gm,{...Ng.defaultData,...t.camera,name:"Personal Camera"}),this.personalCamera.objectHelper.visible=!1,this.add(this.personalCamera),this.activeCamera=this.personalCamera,this.ambientLight=new W_e(13882323,8553090,.75),this.ambientLight.name="Default Ambient Light",this.ambientLight.layers.enable(3),this.ambientLight.removeFromParent(),this.add(this.ambientLight),t.uiScene?this.uiScene=new r3((Array.isArray(e)?e[0]:e)+"-ui",t.uiScene,{dpr:window.devicePixelRatio,shared:r.shared}):t.uiFrame&&this.createUICanvas(t.uiFrame,r)}get scene(){return this.parent}get postprocessing(){return this.data.postprocessing}get frameId(){return this.data.uiFrame}get frame(){var e;return(e=this.uiCanvas)==null?void 0:e.frame}createUICanvas(e,t){this.uiCanvas=new W9(this.uuid+"-uiscreen",window.innerWidth,window.innerHeight,t),this.uiCanvas.isScreenSpace=!0,this.uiCanvas.promise.then(()=>{var r,i;(r=this.uiCanvas)==null||r.applyFrame(e),(i=this.uiCanvas)==null||i.applySize()})}updateVisible(){}setBackgroundColor(e){this.bgColor=e,this.fogUseBGColor===!0&&(this.backupFog.color=e)}entityChildrenCount(){return this.uiScene?this.uiScene.children.length:super.entityChildrenCount()}updateAmbientLight(e,t){e.color!==void 0&&(this.ambientLight.color=ka(e.color,t)),e.intensity!==void 0&&(this.ambientLight.intensity=e.intensity),e.enabled!==void 0&&(e.enabled?this.add(this.ambientLight):this.remove(this.ambientLight))}onDeactive(){this.isActive=!1}onActive(e){this.isActive=!0,e.fog=this.fog,this.traverseEntity(t=>{t instanceof bh&&t.recomputeBoolean()}),this.updateShadow(this.data.shadow)}forceMaterialsUpdate(){this.traverseEntity(e=>{if(e instanceof xm)if(Array.isArray(e.material))for(let t of e.material)t.needsUpdate=!0;else e.material.needsUpdate=!0,e.material.dispose()})}updateShadow(e){e.softShadowQuality!==void 0&&this.isActive&&v5e(e.softShadowQuality)&&this.forceMaterialsUpdate()}updateFog(e,t){if(e.enabled?this.fog=this.backupFog:this.fog=null,this.isActive){let r=this.scene;r.fog=this.fog}this.fogUseBGColor=e.useBackgroundColor,e.useBackgroundColor?this.backupFog.color.set(this.bgColor):this.backupFog.color=ka(e.color,t),this.backupFog.near=e.near,this.backupFog.far=e.far}updateAo(e,t){e.aoColor!==void 0&&(this.aoColor=ka(e.aoColor,t))}updateByOp(e,t,r,i){let n=this.data.uiFrame;super.updateByOp(e,t,r,i);let a=t;li(e.path,["fog"])?this.updateFog(a.fog,r.shared):li(e.path,["ao"])?this.updateAo(a.ao,r.shared):li(e.path,["ambient"])?this.updateAmbientLight(a.ambient,r.shared):li(e.path,["shadow"])?this.updateShadow(a.shadow):e.type===0&&e.path.length===0&&(e.props.uiFrame!==void 0||n!==a.uiFrame)&&this.updateUIFrame(e.props.uiFrame,r)}updateUIFrame(e,t){e?(this.uiCanvas||this.createUICanvas(e,t),this.uiCanvas.enabled=!0,this.uiCanvas.applyFrame(e)):this.uiCanvas&&(this.uiCanvas.enabled=!1)}updateState(e,t){this.updateState_Entity(e,t),e.backgroundColor!==void 0&&this.setBackgroundColor(ka(e.backgroundColor,t.shared)),e.fog!==void 0&&this.updateFog(e.fog,t.shared),e.ambient!==void 0&&this.updateAmbientLight(e.ambient,t.shared),e.ao!==void 0&&this.updateAo(e.ao,t.shared),e.shadow!==void 0&&this.updateShadow(e.shadow)}createFrame(e,t){}raycast(e,t){super.raycast(e,t)}switchActiveCamera(e){e&&e.isDescendantOf(this)&&(this.activeCamera!==this.personalCamera&&(this.activeCamera.objectHelper.visible=!0),this.activeCamera=e,e.objectHelper.visible=!1)}get playCamera(){var e;return((e=this.scene)==null?void 0:e.find(this.data.publish.playCamera))??this.personalCamera}switchToPlayCamera(){this.switchActiveCamera(this.playCamera)}get penumbraSizeArray(){return this.penumbraSizeArrayCache===null&&this.updatePenumbraSizeArray(),this.penumbraSizeArrayCache}updatePenumbraSizeArray(){this.penumbraSizeArrayCache=new Array(5).fill(.5);let e=0,t=0;this.traverseEntity(r=>{if(!r.visible)return!0;r instanceof k9&&r.visible&&e<3&&(this.penumbraSizeArrayCache[e]=r.data.penumbraSize??.5,e+=1),r instanceof L9&&r.visible&&e<2&&(this.penumbraSizeArrayCache[3+t]=r.data.penumbraSize??.5,t+=1)})}raycastWithClones(e){let t=[],r=i=>{for(let n of i.children){let a=n.cloner;_r.is(n)&&(n.visible||a!=null&&a.object.data.visible)&&((os(n)||UE(n)&&this.scene.enableHelpers&&n.objectHelper.visible)&&(e.intersectObject(n,!1,t),QE(n,e,t,!0)),r(n))}};return r(this),t}updateEntity2DByOp(e,t,r,i){var n;(n=this.uiCanvas)==null||n.updateEntity2DByOp(e,t,r,i)}},tNe=class extends QD(Y_e,R9){constructor(e,t,r){super(),this.super_Entity(e,t),this.castShadow=!0,this.shadow.mapSize.width=1024,this.shadow.mapSize.height=1024,this.shadow.normalBias=1,this.layers.enable(3);let i=this.shadow.camera;i.fov=90,i.aspect=1,i.near=100,i.far=2500;let n=new k(-i.far+this.position.x,-i.far+this.position.y,-i.far+this.position.z),a=new k(i.far+this.position.x,i.far+this.position.y,i.far+this.position.z),o=new Ji(n,a),s=new Kx(o,new Bt(16755200));s.visible=!1,this.gizmos.shadowmap=s,this.update()}update(){if(this.shadow&&(this.shadow.camera.updateProjectionMatrix(),this.gizmos))for(let e in this.gizmos){let t=this.gizmos[e];if(t instanceof Kx){let r=this.shadow.camera,i=new k(-r.far+this.position.x,-r.far+this.position.y,-r.far+this.position.z),n=new k(r.far+this.position.x,r.far+this.position.y,r.far+this.position.z);t.box.set(i,n),t.updateMatrixWorld(!0)}}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.objectHelper&&this.objectHelper.update()}updateState(e,t){this.updateState_Light(e,t),e.distance!==void 0&&(this.distance=e.distance),e.decay!==void 0&&(this.decay=e.decay),e.shadowRadius!==void 0&&(this.shadow.radius=e.shadowRadius),e.shadowResolution!==void 0&&(this.shadow.mapSize.set(e.shadowResolution,e.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null))}},rNe=class extends ba{get forceComputeSize(){return!0}get shape(){return this.geometry.userData.shape}updateEntityBoxSize(e,t){let r=this.geometry.getAttribute("position");r!==void 0?ND(r,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:r.count,e,t):super.updateEntityBoxSize(e,t)}},i3=class extends ba{constructor(e,t,r){super(e,t,r),this._shapeId=null,this._context=r}updateState(e,t){super.updateState(e,t),this.updateShape()}updateShape(){var i;let e={...this.data.geometry.extrusion.shape};for(let n in e)typeof e[n]=="string"&&(e[n]=this._context.shared.getVariable(e[n],[this.uuid,"geometry","extrusion","shape",n]));let t;if(e.type==="Custom"){let n=e.shapeId;if(n!==this._shapeId&&this.detachShape(),n){this._shapeId=n;let a=this._context.scene.find(n);a!=null&&a.data&&(a.attachedPaths.add(this),t=(i=a.geometry.userData)==null?void 0:i.shape),t||this._context.scene.addPendingCommand(()=>this.updateShape())}}else{let n;switch(e.type){case"Rectangle":n=FD;break;case"Ellipse":n=BD;break;case"Polygon":n=DW;break;case"Star":n=OW;break;default:throw new Error(`Unknown shape type: ${e.type}`)}t=n.create({parameters:e}).userData.shape}let r=this.geometry;t&&r.inputs&&(r.inputs.shapeData=t,r.build(),this.attachedSurfaceCloners.forEach(n=>n.update()))}detachShape(){var e;this._shapeId!==null&&((e=this._context.scene.find(this._shapeId))==null||e.attachedPaths.delete(this))}createGeometryDelayed(e){this.geometryCreateDeleyed=e.shared,this.updateShape(),this.refreshAttachedPaths(e)}updateTransformState(e,t){return super.updateTransformState(e,t)}updateGeometryInteractions(e,t){super.updateGeometryInteractions(e,t),this.updateShape()}updateEntityBoxSize(e,t){let r=this.geometry.getAttribute("position");r!==void 0?ND(r,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:r.count,e,t):super.updateEntityBoxSize(e,t)}},n3=class extends KD{constructor(e,t,r){super(e,t,r),this.data=t}},vp=class extends wm(tc,E0){constructor(e,t,r){super(),t.type==="Instance"&&typeof e=="string"&&(t=this.transformAssignData(t,r)),this.super_Entity(e,t),this.objectHelper.update()}get isComponentRoot(){return this.data.type==="Component"&&typeof this.identity=="string"}get isInstanceRoot(){return this.data.type==="Instance"&&typeof this.identity=="string"}transformAssignData(e,t){let r=w1.getComponentData({scene:t.scene.data,shared:t.shared.data},e.component);if(r){let i,n;for(let a of pu.rootOverrideProps)e[a]===void 0?(i===void 0&&(i={...e}),i[a]=r.data[a]):(n===void 0&&(n={}),n[a]=e[a],i===void 0&&(i={...e}),i[a]=Mu.apply(r.data[a],e[a]));return this.overrideData=n,i}else return{...Un.defaultData,...e,...ac(Un.defaultData,pu.rootOverrideProps)}}updateByOp(e,t,r,i){let n;if(this.isInstanceRoot&&!i){if(t=this.transformAssignData(t,r),e.type===0&&e.path.length===0&&this.component)for(let a of pu.rootOverrideProps)a in e.props&&e.props[a]===void 0&&(n===void 0&&(n={...e,props:{...e.props}}),n.props[a]=this.component.data[a]);else if(e.type===0&&e.path.length>0&&pu.rootOverrideProps.includes(e.path[0])){let a=e.path[0];n===void 0&&(n={...e,path:[],props:{[a]:t[a]}})}}super.updateByOp(n??e,t,r,i)}updateState(e,t){this.updateState_Entity(e,t)}expandInstanceChildren(e){let t=this.data;if(this.component===void 0){let r=e.scene.find(t.component)??null,i=!1;if(r!==this.oldComponent){if(this.oldComponent){let n=0;for(let a of this.children)if(_r.is(a))e.scene.disposeAndUnregisterEntityRecursivelyIfNotReregistered(a),a3(a),n+=1;else break;this.children.splice(0,n)}i=!0}if(r){let n={};$9(e,[this.uuid],t.overrides,this,r,r,0,i,n);for(let a of this.children)if(_r.is(a)){let o=a.data;o.type==="Empty"&&o.animations&&a.traverseEntity(s=>{let l=s.dataPatched;if(s instanceof ba&&l.bones&&l.boneInverses){let c=s.dataPatched;if(c.bones&&c.boneInverses){let u=c.bones.map(f=>e.scene.find(n[f])),d=c.boneInverses.map(f=>new it().fromArray(f)),h=new $P(u,d);s.bind(h,s.bindMatrix)}}else s.matrixAutoUpdate=!0})}}this.oldComponent=this.component}}};function a3(e){if(e.component){let t=e.component.instances.indexOf(e);t>=0&&e.component.instances.splice(t,1);for(let r of e.children)_r.is(r)&&a3(r)}}function tF(e,t,r,i){return e.component===t&&yD(e.identity,i)?e.overrideData===r?2:1:0}function $9(e,t,r,i,n,a,o,s,l){if(o>50)return!1;if(i.component!==n){if(i.component){let u=i.component.instances.indexOf(i);u>=0&&i.component.instances.splice(u,1)}n.instances.find(u=>u===i)||n.instances.push(i),i.component=n}n instanceof vp&&n.isInstanceRoot&&n.expandInstanceChildren(e);let c=0;for(let u of n.children)if(_r.is(u)){let d=[...t,...typeof u.identity=="string"?[u.identity]:u.identity],h=g1.resolve(r,d,1);h!=null&&!(h instanceof dn)&&(Object.setPrototypeOf(h,dn.prototype),console.error("wrong prototype"));let f=null,p;if(!s){let v=i.children[c];if(f=_r.is(v)?v:null,f!==null){let m=tF(f,u,h,d);p=m>=1?f.stateSelection:void 0,m!==2&&(f=null)}if(f===null&&(f=e.scene.findInstance(d)??null,f!==null)){let m=tF(f,u,h,d);if(p=m>=1?f.stateSelection:void 0,m!==2)f=null;else{let g=f.parent.children.indexOf(f);f.parent.children.splice(g,1),i.children.splice(c,0,f),f.parent===i?g<=c&&console.error("not possible"):(f.parent=i,f.matrixWorldNeedsUpdate=!0,f.resetBBoxNeedsUpdate(),f.updateVisible(),e.pendingDeletes.delete(f))}}}if(f===null){let v=h?Mu.apply(u.data,h):u.data;gh.is(v.type)&&(v={...v,type:"Empty"}),f=vu.createEntity(d,v,e),f.overrideData=h,i.add(f),i.children.splice(i.children.length-1,1),i.children.splice(c,0,f),f.updateState(f.data,e),p&&f.changeSelectedState(p,e),e.scene.registerInstanceAndSetUuid(f)}if(f.isBone){let v=f.identity[f.identity.length-1];l[v]=f.uuid}c+=1,$9(e,t,r,f,u,a,o+1,s,l)}if(!s){let u=c;for(;;){let d=i.children[c];if(_r.is(d))e.pendingDeletes.add(d);else break;c+=1}i.children.splice(u,c-u)}return!0}var iNe=class extends wm(g8,E0){constructor(e,t){super(),this.super_Entity(e,t),this.objectHelper.update(),this.matrixAutoUpdate=!0}updateState(e,t){this.updateState_Entity(e,t)}},va=class extends ba{constructor(e,t,r){super(e,t,r),this.onBeforeRender=i=>{this.uiCanvas.render(i)},this.uiCanvas=new W9(e+"-canvas",t.geometry.width,t.geometry.height,r),this.uiCanvas.promise.then(()=>{this.applyFrame(this.dataPatched.geometry.frame,r.shared)})}updateByPatchedOpGeometry(e,t,r){super.updateByPatchedOpGeometry(e,t,r),e.type===0&&(e.props.frame!==void 0&&this.applyFrame(e.props.frame,r.shared),(e.props.width!==void 0||e.props.height!==void 0)&&this.applySize(e.props,r.shared))}applySize(e,t){let r=(e==null?void 0:e.width)??this.dataPatched.geometry.width,i=(e==null?void 0:e.height)??this.dataPatched.geometry.height;this.uiCanvas.applySize({width:r,height:i}),this.applyGeometryParametersFromFrame(t)}applyFrame(e,t){this.uiCanvas.applyFrame(e),this.applyGeometryParametersFromFrame(t),this.applyMaterialParametersFromFrame({shared:t})}applyGeometryParametersFromFrame(e){var r;let t=this.frame;t&&(Object.assign(this.data,{geometry:Object.assign(this.data.geometry,{cornerRadius:t.cornerRadius,cornerType:0})}),Object.assign(this.dataPatched,{geometry:Object.assign(this.dataPatched.geometry,{cornerRadius:t.cornerRadius,cornerType:0})}),(r=this.localGeometry)==null||r.dispose(),this.localGeometry=qg(this.dataPatched.geometry,e,this.data.flatShading,this))}applyMaterialParametersFromFrame(e){let t=this.frame;if(t){let r=t.data.backgroundBlur;Object.assign(this.data.material.layers[0].data.texture,{image:this.uiCanvas.uuid}),Object.assign(this.data.material.layers[1].data,{roughness:r.radius,alpha:r.enabled?1:0}),Object.assign(this.dataPatched.material.layers[0].data.texture,{image:this.uiCanvas.uuid}),Object.assign(this.dataPatched.material.layers[1].data,{roughness:r.radius,alpha:r.enabled?1:0}),this.material.reset(this.dataPatched.material,e,!0)}}updateEntity2DByOp(e,t,r,i){this.uiCanvas.updateEntity2DByOp(e,t,r,i),e===this.frameId&&t.type===0&&(t.props.cornerRadius!==void 0?this.applyGeometryParametersFromFrame(i):li(t.path,["backgroundBlur"])&&this.applyMaterialParametersFromFrame({shared:i}))}get frame(){return this.uiCanvas.frame}get frameId(){var e;return(e=this.frame)==null?void 0:e.uuid}removeInteractionGeometry(e){super.removeInteractionGeometry(e),this.applySize({},e)}updateGeometryInteractions(e,t){super.updateGeometryInteractions(e,t),this.applySize({width:e.width,height:e.height},t)}},nNe=class{constructor(e,t,r){this.variables=[],this.currentTextureIndex=0;let i=ln,n=new ll,a=new Rh;a.position.z=1;let o={passThruTexture:{value:null}},s=u(h(),o),l=new Oi(new fc(2,2),s);n.add(l),this.setDataType=function(f){return i=f,this},this.addVariable=function(f,p,v){let m=this.createShaderMaterial(p),g={name:f,initialValueTexture:v,material:m,dependencies:null,renderTargets:[],wrapS:null,wrapT:null,minFilter:Wr,magFilter:Wr};return this.variables.push(g),g},this.setVariableDependencies=function(f,p){f.dependencies=p},this.init=function(){if(r.capabilities.isWebGL2===!1&&r.extensions.has("OES_texture_float")===!1)return"No OES_texture_float support for float textures.";if(r.capabilities.maxVertexTextures===0)return"No support for vertex shader textures.";for(let f=0;f<this.variables.length;f++){let p=this.variables[f];p.renderTargets[0]=this.createRenderTarget(e,t,p.wrapS,p.wrapT,p.minFilter,p.magFilter),p.renderTargets[1]=this.createRenderTarget(e,t,p.wrapS,p.wrapT,p.minFilter,p.magFilter),this.renderTexture(p.initialValueTexture,p.renderTargets[0]),this.renderTexture(p.initialValueTexture,p.renderTargets[1]);let v=p.material,m=v.uniforms;if(p.dependencies!==null)for(let g=0;g<p.dependencies.length;g++){let y=p.dependencies[g];if(y.name!==p.name){let b=!1;for(let x=0;x<this.variables.length;x++)if(y.name===this.variables[x].name){b=!0;break}if(!b)return"Variable dependency not found. Variable="+p.name+", dependency="+y.name}m[y.name]={value:null},v.fragmentShader=`
uniform sampler2D `+y.name+`;
`+v.fragmentShader}}return this.currentTextureIndex=0,null},this.compute=function(){let f=this.currentTextureIndex,p=this.currentTextureIndex===0?1:0;for(let v=0,m=this.variables.length;v<m;v++){let g=this.variables[v];if(g.dependencies!==null){let y=g.material.uniforms;for(let b=0,x=g.dependencies.length;b<x;b++){let S=g.dependencies[b];y[S.name].value=S.renderTargets[f].texture}}this.doRenderTarget(g.material,g.renderTargets[p])}this.currentTextureIndex=p},this.getCurrentRenderTarget=function(f){return f.renderTargets[this.currentTextureIndex]},this.getAlternateRenderTarget=function(f){return f.renderTargets[this.currentTextureIndex===0?1:0]},this.dispose=function(){l.geometry.dispose(),l.material.dispose();let f=this.variables;for(let p=0;p<f.length;p++){let v=f[p];v.initialValueTexture&&v.initialValueTexture.dispose();let m=v.renderTargets;for(let g=0;g<m.length;g++)m[g].dispose()}};function c(f){f.defines.resolution="vec2( "+e.toFixed(1)+", "+t.toFixed(1)+" )"}this.addResolutionDefine=c;function u(f,p){p=p||{};let v=new Vr({uniforms:p,vertexShader:d(),fragmentShader:f});return c(v),v}this.createShaderMaterial=u,this.createRenderTarget=function(f,p,v,m,g,y){return f=f||e,p=p||t,v=v||_i,m=m||_i,g=g||Wr,y=y||Wr,new jr(f,p,{wrapS:v,wrapT:m,minFilter:g,magFilter:y,format:Ln,type:i,depthBuffer:!1})},this.createTexture=function(){let f=new Float32Array(e*t*4),p=new Lo(f,e,t,Ln,ln);return p.needsUpdate=!0,p},this.renderTexture=function(f,p){o.passThruTexture.value=f,this.doRenderTarget(s,p),o.passThruTexture.value=null},this.doRenderTarget=function(f,p){let v=r.getRenderTarget(),m=r.xr.enabled,g=r.shadowMap.autoUpdate,y=r.outputEncoding,b=r.toneMapping;r.xr.enabled=!1,r.shadowMap.autoUpdate=!1,r.outputEncoding=xs,r.toneMapping=sl,l.material=f,r.setRenderTarget(p),r.render(n,a),l.material=s,r.xr.enabled=m,r.shadowMap.autoUpdate=g,r.outputEncoding=y,r.toneMapping=b,r.setRenderTarget(v)};function d(){return`void main()	{

	gl_Position = vec4( position, 1.0 );

}
`}function h(){return`uniform sampler2D passThruTexture;

void main() {

	vec2 uv = gl_FragCoord.xy / resolution.xy;

	gl_FragColor = texture2D( passThruTexture, uv );

}
`}}},qn=new ta,xb=new k,aNe=class{constructor(e){let t=e.geometry;if(!t.isBufferGeometry||t.attributes.position.itemSize!==3)throw new Error("THREE.MeshSurfaceSampler: Requires BufferGeometry triangle mesh.");t.index&&(console.warn("THREE.MeshSurfaceSampler: Converting geometry to non-indexed BufferGeometry."),t=t.toNonIndexed()),this.geometry=t,this.randomFunction=Math.random,this.positionAttribute=this.geometry.getAttribute("position"),this.colorAttribute=this.geometry.getAttribute("color"),this.weightAttribute=null,this.distribution=null}setWeightAttribute(e){return this.weightAttribute=e?this.geometry.getAttribute(e):null,this}build(){let e=this.positionAttribute,t=this.weightAttribute,r=new Float32Array(e.count/3);for(let n=0;n<e.count;n+=3){let a=1;t&&(a=t.getX(n)+t.getX(n+1)+t.getX(n+2)),qn.a.fromBufferAttribute(e,n),qn.b.fromBufferAttribute(e,n+1),qn.c.fromBufferAttribute(e,n+2),a*=qn.getArea(),r[n/3]=a}this.distribution=new Float32Array(e.count/3);let i=0;for(let n=0;n<r.length;n++)i+=r[n],this.distribution[n]=i;return this}setRandomGenerator(e){return this.randomFunction=e,this}sample(e,t,r){let i=this.distribution[this.distribution.length-1],n=this.binarySearch(this.randomFunction()*i);return this.sampleFace(n,e,t,r)}binarySearch(e){let t=this.distribution,r=0,i=t.length-1,n=-1;for(;r<=i;){let a=Math.ceil((r+i)/2);if(a===0||t[a-1]<=e&&t[a]>e){n=a;break}else e<t[a]?i=a-1:r=a+1}return n}sampleFace(e,t,r,i){let n=this.randomFunction(),a=this.randomFunction();return n+a>1&&(n=1-n,a=1-a),qn.a.fromBufferAttribute(this.positionAttribute,e*3),qn.b.fromBufferAttribute(this.positionAttribute,e*3+1),qn.c.fromBufferAttribute(this.positionAttribute,e*3+2),t.set(0,0,0).addScaledVector(qn.a,n).addScaledVector(qn.b,a).addScaledVector(qn.c,1-(n+a)),r!==void 0&&qn.getNormal(r),i!==void 0&&this.colorAttribute!==void 0&&(qn.a.fromBufferAttribute(this.colorAttribute,e*3),qn.b.fromBufferAttribute(this.colorAttribute,e*3+1),qn.c.fromBufferAttribute(this.colorAttribute,e*3+2),xb.set(0,0,0).addScaledVector(qn.a,n).addScaledVector(qn.b,a).addScaledVector(qn.c,1-(n+a)),i.r=xb.x,i.g=xb.y,i.b=xb.z),this}};function oNe(e){let t=new Float32Array(e*e*2);for(let r=0;r<e;r++)for(let i=0;i<e;i++){let n=r*e+i;t[n*2+0]=r/(e-1),t[n*2+1]=i/(e-1)}return t}function sNe(e){let t=Math.ceil(Math.sqrt(e));return Math.max(t,1)}function lNe(e,t){let r=new Oi(e.geometry,e.material),i=[],n=[],a=new k,o=new k;r.geometry.index!==null&&(r.geometry=r.geometry.toNonIndexed());let s=new aNe(r).build();for(let u=0;u<t;u++)s.sample(a,o),i.push(a.x,a.y,a.z),n.push(o.x,o.y,o.z);let l=new Float32Array(i),c=new Float32Array(n);return{positions:l,normals:c}}function rF(e,t){let r=e,i=new Float32Array(4*t*t);for(let a=0;a<t*t;a++)i[4*a]=r[3*a],i[4*a+1]=r[3*a+1],i[4*a+2]=r[3*a+2],i[4*a+3]=0;let n=new Lo(i,t,t,Ln,ln);return n.needsUpdate=!0,n}function cNe({size:e}){let t=new Float32Array(4*e*e);for(let i=0;i<e*e;i++)t[4*i]=i,t[4*i+1]=0,t[4*i+2]=0,t[4*i+3]=0;let r=new Lo(t,e,e,Ln,ln);return r.needsUpdate=!0,r}function uNe(e){let t=new Float32Array(4*e*e);for(let i=0;i<e*e;i++)t[4*i]=0,t[4*i+1]=0,t[4*i+2]=0,t[4*i+3]=0;let r=new Lo(t,e,e,Ln,ln);return r.needsUpdate=!0,r}var dNe=`
// uniform sampler2D uCurrentPosition; // Pass in the variable from GPGPU
// uniform sampler2D uCurrentVelocity; // Pass in the variable from GPGPU
// uniform sampler2D uCurrentEmissionRate; // Pass in the variable from GPGPU
uniform sampler2D uOriginalPosition;
uniform float uTime;
uniform float uSpeed;     // update speed of the particles
uniform vec3 uWorldOffset;    
uniform vec4 uWorldQuaternion;
uniform float uMaxLifeTime;
uniform vec3 uEmitterSize;
uniform float uFPSRatio;     // 1  for 60 FPS

float random (vec2 st) {
    return fract(sin(dot(st.xy,
        vec2(12.9898,78.233)))*
        43758.5453123);
}
vec3 applyQuaternionToVector( vec4 q, vec3 v ){
    return v + 2.0 * cross( q.xyz, cross( q.xyz, v ) + q.w * v );
}

vec3 applyForce(vec3 force, float mass) {
    vec3 acceleration = force / mass;
    
    return acceleration;
  }
  

void main() {
    vec2 vUv = gl_FragCoord.xy / resolution.xy;
    vec3 position = texture2D( uCurrentPosition, vUv ).xyz;
    float currentLife = texture2D( uCurrentPosition, vUv ).w;   // from 1 to 0
    float isSpawning = texture2D( uCurrentEmissionRate, vUv ).r;        // 1. = spawning, 0. = not spawning
    float isActive = texture2D( uCurrentEmissionRate, vUv ).g;          // 1. = active, 0. = not active
    float timeStart = texture2D( uCurrentEmissionRate, vUv ).b;         // timeStart in seconds when the particle was emitted
    vec3 originalPosition = ((texture2D( uOriginalPosition, vUv ).xyz) * uEmitterSize);
    vec3 velocity = texture2D( uCurrentVelocity, vUv ).xyz;
    float collisionFlag = texture2D( uCurrentVelocity, vUv ).w;             // 1. = collided, 0. = not collided
    float lifeTime = uMaxLifeTime;

    // Calculate the position adjustment based on collision
    //     if (collisionFlag > .5) {  
    float isColliding = step(0.5, collisionFlag); // 1.0 if collisionFlag > 0.5, otherwise 0.0
    float bounceOffset = 3.0 * isColliding; // Becomes 3.0 if colliding, 0.0 otherwise
    vec3 collisionAdjustedVelocity = velocity * (1.0 + bounceOffset);

    // Update position based on collision or normal movement
    vec3 fpsVelocity = velocity * min(uFPSRatio, 5.0);
    position += mix(fpsVelocity, collisionAdjustedVelocity, isColliding);

    // EMISSION RATE - BIRTH
    // if (isSpawning == 1.0) {
    // Better Approach to avoid If statement
    vec3 newPosition = applyQuaternionToVector(uWorldQuaternion, originalPosition) + uWorldOffset;
    originalPosition = mix(originalPosition, newPosition, isSpawning);
    position = mix(position, originalPosition, isSpawning);;
    timeStart = mix(timeStart, uTime, isSpawning);

    // Calculate timeLeft for life normalization
    float timeLeft = max(lifeTime - (uTime - timeStart), 0.0);
    float life_Normalize = timeLeft / lifeTime;

    // Use isActive to blend between the calculated color and black
    vec4 activeColor = vec4(position, life_Normalize);
    // if (isActive == 1.0) {
    gl_FragColor = mix(vec4(0.0), activeColor, isActive);

}
`,hNe=`

    vec3 mod289(vec3 x) {
      return x - floor(x * (1.0 / 289.0)) * 289.0;
    }
    
    vec4 mod289(vec4 x) {
    return x - floor(x * (1.0 / 289.0)) * 289.0;
    }
    
    vec4 permute(vec4 x) {
        return mod289(((x*34.0)+1.0)*x);
    }
    
    vec4 taylorInvSqrt(vec4 r)
    {
    return 1.79284291400159 - 0.85373472095314 * r;
    }
    
    vec3 fade(vec3 t) {
  return t*t*t*(t*(t*6.0-15.0)+10.0);
}

    float snoise(vec3 v)
    {
    const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;
    const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);
    vec3 i  = floor(v + dot(v, C.yyy) );
    vec3 x0 =   v - i + dot(i, C.xxx) ;
    vec3 g = step(x0.yzx, x0.xyz);
    vec3 l = 1.0 - g;
    vec3 i1 = min( g.xyz, l.zxy );
    vec3 i2 = max( g.xyz, l.zxy );
    vec3 x1 = x0 - i1 + C.xxx;
    vec3 x2 = x0 - i2 + C.yyy; // 2.0*C.x = 1/3 = C.y
    vec3 x3 = x0 - D.yyy;      // -1.0+3.0*C.x = -0.5 = -D.y
    
    // Permutations
    i = mod289(i);
    vec4 p = permute( permute( permute(
                i.z + vec4(0.0, i1.z, i2.z, 1.0 ))
              + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))
              + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));
    
    // Gradients: 7x7 points over a square, mapped onto an octahedron.
    // The ring size 17*17 = 289 is close to a multiple of 49 (49*6 = 294)
    float n_ = 0.142857142857; // 1.0/7.0
    vec3  ns = n_ * D.wyz - D.xzx;
    
    vec4 j = p - 49.0 * floor(p * ns.z * ns.z);  //  mod(p,7*7)
    
    vec4 x_ = floor(j * ns.z);
    vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)
    
    vec4 x = x_ *ns.x + ns.yyyy;
    vec4 y = y_ *ns.x + ns.yyyy;
    vec4 h = 1.0 - abs(x) - abs(y);
    
    vec4 b0 = vec4( x.xy, y.xy );
    vec4 b1 = vec4( x.zw, y.zw );
    
    vec4 s0 = floor(b0)*2.0 + 1.0;
    vec4 s1 = floor(b1)*2.0 + 1.0;
    vec4 sh = -step(h, vec4(0.0));
    
    vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;
    vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;
    
    vec3 p0 = vec3(a0.xy,h.x);
    vec3 p1 = vec3(a0.zw,h.y);
    vec3 p2 = vec3(a1.xy,h.z);
    vec3 p3 = vec3(a1.zw,h.w);
    
    //Normalise gradients
    vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));
    p0 *= norm.x;
    p1 *= norm.y;
    p2 *= norm.z;
    p3 *= norm.w;
    
    // Mix final noise value
    vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);
    m = m * m;
    return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1),
                                  dot(p2,x2), dot(p3,x3) ) );
    }
    
    vec3 snoiseVec3( vec3 x ){
    
      float s  = snoise(vec3( x ));
      float s1 = snoise(vec3( x.y - 19.1 , x.z + 33.4 , x.x + 47.2 ));
      float s2 = snoise(vec3( x.z + 74.2 , x.x - 124.5 , x.y + 99.4 ));
      vec3 c = vec3( s , s1 , s2 );
      return c;
    
    }
    
      
    vec3 curlNoise( vec3 p, float seed){
      p += seed;
      const float e = .1;
      vec3 dx = vec3( e   , 0.0 , 0.0 );
      vec3 dy = vec3( 0.0 , e   , 0.0 );
      vec3 dz = vec3( 0.0 , 0.0 , e   );
    
      vec3 p_x0 = snoiseVec3( p - dx );
      vec3 p_x1 = snoiseVec3( p + dx );
      vec3 p_y0 = snoiseVec3( p - dy );
      vec3 p_y1 = snoiseVec3( p + dy );
      vec3 p_z0 = snoiseVec3( p - dz );
      vec3 p_z1 = snoiseVec3( p + dz );
    
      float x = p_y1.z - p_y0.z - p_z1.y + p_z0.y;
      float y = p_z1.x - p_z0.x - p_x1.z + p_x0.z;
      float z = p_x1.y - p_x0.y - p_y1.x + p_y0.x;
    
      const float divisor = 1.0 / ( 2.0 * e );
      return normalize( vec3( x , y , z ) * divisor );
    
    }


// Classic Perlin noise
float cnoise(vec3 P)
{
  vec3 Pi0 = floor(P); // Integer part for indexing
  vec3 Pi1 = Pi0 + vec3(1.0); // Integer part + 1
  Pi0 = mod289(Pi0);
  Pi1 = mod289(Pi1);
  vec3 Pf0 = fract(P); // Fractional part for interpolation
  vec3 Pf1 = Pf0 - vec3(1.0); // Fractional part - 1.0
  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);
  vec4 iy = vec4(Pi0.yy, Pi1.yy);
  vec4 iz0 = Pi0.zzzz;
  vec4 iz1 = Pi1.zzzz;

  vec4 ixy = permute(permute(ix) + iy);
  vec4 ixy0 = permute(ixy + iz0);
  vec4 ixy1 = permute(ixy + iz1);

  vec4 gx0 = ixy0 * (1.0 / 7.0);
  vec4 gy0 = fract(floor(gx0) * (1.0 / 7.0)) - 0.5;
  gx0 = fract(gx0);
  vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);
  vec4 sz0 = step(gz0, vec4(0.0));
  gx0 -= sz0 * (step(0.0, gx0) - 0.5);
  gy0 -= sz0 * (step(0.0, gy0) - 0.5);

  vec4 gx1 = ixy1 * (1.0 / 7.0);
  vec4 gy1 = fract(floor(gx1) * (1.0 / 7.0)) - 0.5;
  gx1 = fract(gx1);
  vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);
  vec4 sz1 = step(gz1, vec4(0.0));
  gx1 -= sz1 * (step(0.0, gx1) - 0.5);
  gy1 -= sz1 * (step(0.0, gy1) - 0.5);

  vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);
  vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);
  vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);
  vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);
  vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);
  vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);
  vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);
  vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);

  vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));
  g000 *= norm0.x;
  g010 *= norm0.y;
  g100 *= norm0.z;
  g110 *= norm0.w;
  vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));
  g001 *= norm1.x;
  g011 *= norm1.y;
  g101 *= norm1.z;
  g111 *= norm1.w;

  float n000 = dot(g000, Pf0);
  float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));
  float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));
  float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));
  float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));
  float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));
  float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));
  float n111 = dot(g111, Pf1);

  vec3 fade_xyz = fade(Pf0);
  vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);
  vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);
  float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x); 
  return 2.2 * n_xyz;
}


vec3 fbm_vec3(vec3 p, float frequency, float offset)
{
  return vec3(
    cnoise((p+vec3(offset))*frequency),
    cnoise((p+vec3(offset+20.0))*frequency),
    cnoise((p+vec3(offset-30.0))*frequency)
  );
}

`,fNe=`
  #ifdef USE_COLLIDER
    float restitution = max(uBounce * 2., .01); // Energy Loss
    // SPHERE COLLIDER
    // **************************************************************
    #ifdef USE_SPHERE_COLLIDER       
      // Convert collider size to radii (assuming uColliderSize is the diameter in each axis)
      vec3 radii = uColliderSize;
      // Adjust position relative to collider
      vec3 relPos = position - uColliderPos;
      // Apply rotation of the collider to the relative position
      relPos = applyQuaternionToVector(uColliderQuaternionInvert, relPos);            
      // Scale relative position by radii (for ellipsoid collision detection)
      vec3 scaledPos = relPos / radii;
      // Calculate ellipsoidal distance
      float dist = length(scaledPos); // Distance in terms of ellipsoid
      
      // Check for collision
      if (dist <= 1. + particleSize / length(radii) && collisionFlag == 0.0) {
          // Compute the normal at the collision point, accounting for particle size
        vec3 adjustedPos = scaledPos * (1.0 + particleSize / length(radii));          
        // Compute the normal at the collision point
        vec3 normal = ellipsoidNormal(adjustedPos, radii);
        // Rotate the normal back to world space
        normal = applyQuaternionToVector(uColliderQuaternion, normal);
        // Reflect the velocity vector off the normal
        velocity = reflect(velocity, normal) * restitution;

        collisionFlag = 1.0;
      } else {
        collisionFlag = 0.0;
      }
    #endif

    // BOX COLLIDER or PLANE COLLIDER 
    // **************************************************************
    #ifdef USE_BOX_COLLIDER
      // Box dimensions and repulsion variables
      vec3 boxHalfSize = uColliderSize / 2.0;
      // Convert world position to box's local space
      vec3 localPos = applyQuaternionToVector(uColliderQuaternionInvert, position - uColliderPos);      
      // Collision detection
      vec3 localDistance = abs(localPos) - boxHalfSize;
      float distToSurface = max(localDistance.x, max(localDistance.y, localDistance.z));    

      // Collision Detected
      if (distToSurface <= particleSize * 0.5 && collisionFlag == 0.0) {      
        // Find the nearest face normal for bounce direction
        vec3 normal;
        if (localDistance.x > localDistance.y && localDistance.x > localDistance.z) {
            normal = vec3(sign(localPos.x), 0.0, 0.0);
        } else if (localDistance.y > localDistance.z) {
            normal = vec3(0.0, sign(localPos.y), 0.0);
        } else {
            normal = vec3(0.0, 0.0, sign(localPos.z));
        }            
        // Rotate normal back to world space
        normal = applyQuaternionToVector(uColliderQuaternion, normal);      
        // Reflect velocity and apply repulsion force
        velocity = reflect(velocity, normal) * restitution;
        
        collisionFlag = 1.0;
      } else {
        collisionFlag = 0.0;
      }
    #endif      
  #endif      
  // END COLLIDER    
`,pNe=`
  #ifdef USE_ATTRACTOR

      #ifdef USE_SPHERE_COLLIDER      
        // Convert collider size to radii (assuming uColliderSize is the diameter in each axis)
        vec3 radii = uColliderSize;
        // Adjust position relative to collider
        vec3 relPos = position - uColliderPos;
        // Apply rotation of the collider to the relative position
        relPos = applyQuaternionToVector(uColliderQuaternionInvert, relPos);            
        // Scale relative position by radii (for ellipsoid collision detection)
        vec3 scaledPos = relPos / radii;
        // Calculate ellipsoidal distance
        float distToSurface = length(scaledPos); // Distance in terms of ellipsoid
        float insideCheck = 1.0;

      #endif


      #ifdef USE_BOX_COLLIDER
        // Box dimensions
        vec3 boxHalfSize = uColliderSize / 2.0;
        // Convert world position to box's local space
        vec3 localPos = applyQuaternionToVector(uColliderQuaternionInvert, position - uColliderPos);      
        vec3 localDistance = abs(localPos) - boxHalfSize;
        float distToSurface = max(localDistance.x, max(localDistance.y, localDistance.z));
        float insideCheck = particleSize;
      #endif      
  
      // Apply vortex force inside the Helper
      #ifdef USE_FORCE_LOCAL_SPACE
        if (distToSurface <= insideCheck ) {    
            // Define parameters for the attractor field
            #ifdef USE_SPHERE_COLLIDER      
              float attractorStrength = (1.0 - distToSurface ) * uForceIntensity; // Adjust as needed
            #endif

            #ifdef USE_BOX_COLLIDER
              float attractorStrength = max((1.0 - insideCheck / distToSurface), 0.) * uForceIntensity; // Adjust as needed
              #endif

            float attractorDamping = uForceDamping;  // Adjust as needed (higher values will attenuate velocity more)
          
            // Use the same radii calculation code as for the collider
            vec3 attractorRadii = uColliderSize;
            // Adjust position relative to attractor center
            vec3 relPos = position - uColliderPos;
            // Apply rotation of the collider to the relative position
            relPos = applyQuaternionToVector(uColliderQuaternionInvert, relPos);            
            // Scale relative position by radii (for ellipsoid attraction)
            vec3 scaledPos = relPos / attractorRadii;

            // Calculate ellipsoidal distance as attractor radius
            float attractorRadius = length(scaledPos);
            // Calculate the distance from the attractor center
            vec3 relativePosition = position - uColliderPos;
            // Calculate the force vector towards the attractor center
            vec3 attractorForce = normalize(relativePosition) * attractorStrength;
            // Apply the attractor force to the particle
            velocity -= attractorForce;
            // Attenuate the particle's velocity
            velocity *= attractorDamping;
        }
      #else 
            // Calculate the distance from the attractor center
            vec3 relativePosition = position - uColliderPos;
            // Calculate the force vector towards the attractor center
            vec3 attractorForce = normalize(relativePosition) * uForceIntensity;
            // Apply the attractor force to the particle
            velocity -= attractorForce;
            // Attenuate the particle's velocity
            velocity *= uForceDamping;
      #endif    
  #endif      
`,mNe=`
  #ifdef USE_VORTEX
    // Box dimensions
    vec3 boxHalfSize = uColliderSize / 2.0;
    // Convert world position to box's local space
    vec3 localPos = applyQuaternionToVector(uColliderQuaternionInvert, position - uColliderPos);      
    vec3 localDistance = abs(localPos) - boxHalfSize;
    float distToSurface = max(localDistance.x, max(localDistance.y, localDistance.z));

    // Apply vortex force inside the box
    if (distToSurface <= particleSize) {
      float vortexStrength = uForceIntensity;
      vec3 localTopCenter = vec3(0.0, 0., 0.0);

      // Transform the local top center to the world space
      vec3 vortexCenter = uColliderPos + applyQuaternionToVector(uColliderQuaternion, localTopCenter);
      // Calculate the vector from particle to vortex center
      vec3 vortexVector = vortexCenter - position;

      // Calculate the rotation axis from the inverse of the collider's quaternion and the fixed up vector
      // Note: important to add a tiny z component to the up vector to avoid instability
      vec3 upVector = vec3(0.0, 1.0, 0.01);
      vec3 rotationAxis = cross(upVector, applyQuaternionToVector(uColliderQuaternion, vortexVector));
      rotationAxis = normalize(rotationAxis);

      // Add rotational component to velocity
      float rotationSpeed = length(vortexVector * vortexStrength * 3.0) ; 

      vec3 rotationVelocity = rotationAxis * rotationSpeed;
      // velocity += rotationVelocity * 0.005 ;
      velocity = rotationVelocity * 0.005 ;

      // Calculate vortex force
      // vec3 vortexForce = normalize(vortexVector) * uSpeed * .1 ;
      // Apply the vortex force to the particle
      vec3 originDirection = applyQuaternionToVector(uWorldQuaternion, directions);
      velocity += applyForce( originDirection * uSpeed * (1. - uForceDamping) , mass * .5);
    }
  #endif      
`,vNe=`
// uniform sampler2D uCurrentPosition; // Pass in the variable from GPGPU
// uniform sampler2D uCurrentVelocity; // Pass in the variable from GPGPU
// uniform sampler2D uCurrentEmissionRate; // Pass in the variable from GPGPU
uniform sampler2D uOriginalPosition;
uniform sampler2D uDirections;     
uniform vec3 uDirectionsAxis;
uniform vec4 uWorldQuaternion;
uniform vec3 uGravity;        
uniform float uNoiseStrength;     // Variation of the noise
uniform float uNoiseScale;        // Scale of the noise
uniform float uNoiseSeed;         // Seed of the noise
uniform float particleSize;
uniform float uSpeed;     // update speed of the particles
uniform float uRandomMassFactor;

// COLLIDER
uniform vec3 uColliderPos;                // Collider Position
uniform vec3 uColliderSize;               // Collider Dimension
uniform vec4 uColliderQuaternion;         // Collider Rotation
uniform vec4 uColliderQuaternionInvert;   // Collider Rotation
uniform float uBounce;                    // Bounce factor
uniform float uForceDamping;
uniform float uForceIntensity;


`+hNe+`
float rand(vec2 co){
    return fract(sin(dot(co, vec2(12.9898, 78.233))) * 43758.5453);
}
vec3 applyQuaternionToVector( vec4 q, vec3 v ){
    return v + 2.0 * cross( q.xyz, cross( q.xyz, v ) + q.w * v );
 } 
vec3 applyForce(vec3 force, float mass) {
  vec3 acceleration = force / mass;
  
  return acceleration;
}

vec4 conjugate(vec4 q) {
  return vec4(q.w, -q.x, -q.y, -q.z);
}

// Function to compute the normal of the ellipsoid at a given point
vec3 ellipsoidNormal(vec3 p, vec3 radii) {
  return normalize(p / (radii * radii));
}

float friction = .3;

void main() {
    vec2 vUv = gl_FragCoord.xy / resolution.xy;
    vec3 position = texture2D( uCurrentPosition, vUv ).xyz;
    vec3 originalPosition = texture2D( uOriginalPosition, vUv ).xyz;
    float timeLeft = texture2D( uCurrentPosition, vUv ).w;
    vec3 directions = texture2D( uDirections, vUv ).xyz;    
    vec3 velocity = texture2D( uCurrentVelocity, vUv ).xyz;
    float mass = rand(originalPosition.xy) * 0.5 + 0.5;
    float isSpawning = texture2D( uCurrentEmissionRate, vUv ).x;        // 1. = spawning, 0. = not spawning
    float isActive = texture2D( uCurrentEmissionRate, vUv ).y;          // 1. = active, 0. = not active
    float collisionFlag =texture2D( uCurrentVelocity, vUv ).w;          // Indicate collision

    // Randomness Mass
    mass = (1.0 - (uRandomMassFactor * mass));
    
    if (isActive == 1.0) {
      // **************************************************************
      // FORCES NOISES
      // **************************************************************
      #ifdef USE_CURL_NOISE
        if (uNoiseScale > 0.0 ) {
          velocity = curlNoise(position * uNoiseScale * .002, uNoiseSeed) * ( uNoiseStrength + 1.0) * .05 * uSpeed;
        }
        // Variation of the noise Over Time
        if (uNoiseStrength > 0.0 && uNoiseScale == 0.0 ) {
          velocity += curlNoise( position, uNoiseSeed)  * uNoiseStrength * 0.05 * uSpeed;
        }
      #endif
      // **************************************************************
      #ifdef USE_SIMPLEX_NOISE
        if (uNoiseScale > 0.0 ) {
          velocity = vec3(snoise(position * uNoiseScale * .001) * ( uNoiseStrength + 1.0) * .1);
          velocity *= uSpeed;
        }
        // Variation of the noise Over Time
        if (uNoiseStrength > 0.0 && uNoiseScale == 0.0) {
          velocity += vec3(snoise(position * uNoiseStrength * .001) * .05 * uSpeed);
        }
      #endif
      // ************************************************************** 
      #ifdef USE_FBM_NOISE
        if (uNoiseScale > 0.0 ) {
          velocity = fbm_vec3(position * uNoiseScale * .001, ( uNoiseStrength + 1.0), uNoiseSeed);
          velocity *= uSpeed;
        }
        // Variation of the noise Over Time
        if (uNoiseStrength > 0.0 && uNoiseScale == 0.0 ) {      
          velocity += fbm_vec3(position * uNoiseStrength * .001, ( uNoiseStrength + 1.0), uNoiseSeed) * .1 * uSpeed;
        }
      #endif

      // COLLIDER
      ${fNe}
      // ATTRACTION
      ${pNe}  
      // VORTEX
      ${mNe}
    } 
    // End isActive

    // SPAWN BIRTH 
    // **************************************************************
    // if (isSpawning == 1.)
    #ifdef USE_NORMALS
      velocity = mix(velocity, applyQuaternionToVector(uWorldQuaternion, directions) * uSpeed, isSpawning);
    #else
      velocity = mix(velocity, applyQuaternionToVector(uWorldQuaternion, uDirectionsAxis) * uSpeed, isSpawning);    
    #endif
    
    // if (collisionFlag == 0.0)
    velocity += applyForce(uGravity, mass * .5) * (1.0 - collisionFlag);

    gl_FragColor = vec4(velocity, collisionFlag);
}
`,q9=`

  // Linear Fade In
  float linearFadeIn(float t) {
    return t;
  }


  // linear fade out
  float linearFadeOut(float t) {
    return 1.0 - t;
  }
  
  float linearInOut(float t) {
    return t < 0.5 ? t :  (1.0 - t);  
  }

    // lerp
    float lerp(float a, float b, float t) {
      return a + (b - a) * t;
    }

  // Ease In Out Quart
  float exponentialInOut(float t) {
    return t < 0.4 ? lerp(0.0, 1.0, t / 0.4) :
    t > 0.6 ? lerp(1.0, 0.0, (t - 0.6) / 0.4) :
    1.0;
   }

  // constant
  float constant(float t) {
    return 1.0;
  } 
`,gNe=`

float rand(vec3 co){
  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
}

vec3 applyQuaternionToVector( vec4 q, vec3 v ){
  return v + 2.0 * cross( q.xyz, cross( q.xyz, v ) + q.w * v );
}

vec3 applyForce(vec3 force, float mass) {
  vec3 acceleration = force / mass;
    
  return acceleration;
}
`,yNe=`
vec3 rgb2xyz (in vec3 rgb) {
    float r = rgb.r;
	float g = rgb.g;
	float b = rgb.b;

	r = r > 0.04045 ? pow(((r + 0.055) / 1.055), 2.4) : (r / 12.92);
	g = g > 0.04045 ? pow(((g + 0.055) / 1.055), 2.4) : (g / 12.92);
	b = b > 0.04045 ? pow(((b + 0.055) / 1.055), 2.4) : (b / 12.92);

	float x = (r * 0.4124) + (g * 0.3576) + (b * 0.1805);
	float y = (r * 0.2126) + (g * 0.7152) + (b * 0.0722);
	float z = (r * 0.0193) + (g * 0.1192) + (b * 0.9505);
    
    vec3 xyz = vec3(
        (r * 0.4124) + (g * 0.3576) + (b * 0.1805) * 100.0,
        (r * 0.2126) + (g * 0.7152) + (b * 0.0722) * 100.0,
        (r * 0.0193) + (g * 0.1192) + (b * 0.9505) * 100.0
    );
    return(xyz);
}

vec3 xyz2lab (in vec3 xyz) {
	float x = xyz.x / 95.047;
	float y = xyz.y / 100.0;
	float z = xyz.z / 108.883;

	x = x > 0.008856 ? pow(x, 1.0 / 3.0) : (7.787 * x) + (16.0 / 116.0);
	y = y > 0.008856 ? pow(y, 1.0 / 3.0) : (7.787 * y) + (16.0 / 116.0);
	z = z > 0.008856 ? pow(z, 1.0 / 3.0) : (7.787 * z) + (16.0 / 116.0);

    vec3 lab = vec3((116.0 * y) - 16.0, 500.0 * (x - y), 200.0 * (y - z));
    return(lab);
}

vec3 rgb2lab(in vec3 rgb) {
    vec3 xyz = rgb2xyz(rgb);
    vec3 lab = xyz2lab(xyz);
    return(lab);
}

vec3 xyz2rgb (in vec3 xyz) {
	float x = xyz.x / 100.0;
	float y = xyz.y / 100.0;
	float z = xyz.z / 100.0;
	
    
	float r = (x *  3.2406) + (y * -1.5372) + (z * -0.4986);
	float g = (x * -0.9689) + (y *  1.8758) + (z *  0.0415);
	float b = (x *  0.0557) + (y * -0.2040) + (z *  1.0570);

	r = r > 0.0031308 ? ((1.055 * pow(r, 1.0 / 2.4)) - 0.055) : r * 12.92;
	g = g > 0.0031308 ? ((1.055 * pow(g, 1.0 / 2.4)) - 0.055) : g * 12.92;
	b = b > 0.0031308 ? ((1.055 * pow(b, 1.0 / 2.4)) - 0.055) : b * 12.92;

	r = min(max(0.0, r), 1.0);
	g = min(max(0.0, g), 1.0);
	b = min(max(0.0, b), 1.0);

	return(vec3(r, g, b));
}

vec3 lab2xyz (in vec3 lab) {
    float l = lab.x;
	float a = lab.y;
	float b = lab.z;

  	float y = (l + 16.0) / 116.0;
	float x = a / 500.0 + y;
	float z = y - b / 200.0;

	float y2 = pow(y, 3.0);
	float x2 = pow(x, 3.0);
	float z2 = pow(z, 3.0);

  	y = y2 > 0.008856 ? y2 : (y - 16.0 / 116.0) / 7.787;
	x = x2 > 0.008856 ? x2 : (x - 16.0 / 116.0) / 7.787;
	z = z2 > 0.008856 ? z2 : (z - 16.0 / 116.0) / 7.787;

	x *= 95.047;
	y *= 100.0;
	z *= 108.883;

	return(vec3(x, y, z));
}
vec3 lab2rgb (in vec3 lab) {
    vec3 xyz = lab2xyz(lab);
    vec3 rgb = xyz2rgb(xyz);
    return(rgb);
}

`,bNe=`
  uniform sampler2D uPosition;
  uniform float uSize;
  uniform float uSizeEnd;
  uniform vec3 uWorldOffset;
  uniform vec4 uWorldQuaternion;
  // Billboard Behavior - Currently at Zero, but we can change that
  uniform float uRotation;
  uniform float uRotationEnd;
  uniform vec2 center;

  // Randomness
  uniform float uRandScaleFactor;
  uniform float uRandRotationFactor;

  attribute vec2 ref;

  varying float v_LifeLeft;    // normalized lifetime 1 to 0
  varying vec2 vUv;
  varying vec2 vRef;

  ${gNe}
  ${q9}
`,xNe=({easeSize:e="linearFadeOut"})=>`
  vUv = uv;  
  vRef = ref;
  // Normalized LifeTime 1 to 0
  float lifeLeft = texture2D(uPosition, ref).w;
  v_LifeLeft = lifeLeft;
  // Position From DataTexture Simulation
  vec3 pos = texture2D(uPosition, ref).rgb - uWorldOffset;
  // Apply World Quaternion
  pos = applyQuaternionToVector(uWorldQuaternion, pos);  
            
  #ifdef  USE_SIZE_END
    // Scaled Over Time
    float t = 1. - lifeLeft;
    float currentSize = mix(uSize, uSizeEnd, t); // Linearly interpolate between uSize and uSizeEnd
    vec3 scaledPosition = position * vec3(currentSize);
  #else
    // Change Size Behavior over LifeTime
    float easeSize = ${e}(1. - lifeLeft);
    // Scaled Over Time
    vec3 scaledPosition = position * vec3(uSize * easeSize);
  #endif

  // Billboard Behavior
  vec2 scale;
  scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
  scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );    
  // Randomness 
  float randRef = rand(ref);
  scale *= (1.0 - (uRandScaleFactor * randRef));
  // Rotation
  float randRotation =  2.0 * PI * ( uRandRotationFactor * randRef);
  float originalRotation = (1.0 - uRotation) * 2.0 * PI;
  float originalRotationEnd = (1.0 - uRotationEnd) * 2.0 * PI;
  // OverTime
  float finalRotation = mix(originalRotation + randRotation, originalRotationEnd + randRotation, lifeLeft);

  vec2 alignedPosition = ( scaledPosition.xy - ( center - vec2( 0.5 ) ) ) * scale;
  vec2 rotatedPosition;
  rotatedPosition.x = cos( finalRotation ) * alignedPosition.x - sin( finalRotation ) * alignedPosition.y;
  rotatedPosition.y = sin( finalRotation ) * alignedPosition.x + cos( finalRotation ) * alignedPosition.y;
  
  mat4 instanceMatrix = mat4(
    vec4(1.0, 0.0, 0.0, 0.0),
    vec4(0.0, 1.0, 0.0, 0.0),
    vec4(0.0, 0.0, 1.0, 0.0),
    vec4(pos.x, pos.y, pos.z, 1.0)
  );  

  mvPosition = modelViewMatrix * instanceMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
  mvPosition.xy += rotatedPosition;
  gl_Position = projectionMatrix  * mvPosition;   
`,wNe=`
  uniform vec4 uColor;                // start color
  uniform vec4 uColor2;               // end color
  uniform sampler2D uTexture;         // texture
  varying float v_LifeLeft;   // normalized lifetime 1 to 0
  varying vec2 vUv;
  varying vec2 vRef;

  float random(vec2 co) {
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
  }
  `+q9+`  
  ${yNe}

`,SNe=({easeOpacity:e="linearFadeOut"})=>`  
  // if Particle is dead, hide it
  if (v_LifeLeft <= 0.005 ) {
    discard;
  }

  #ifdef USE_RANDOM_COLORING
    float randVal = random(vRef); // Generate a random value based on the reference
    vec4 color = mix(uColor, uColor2, randVal); // Interpolate between the two colors
  #else
    vec4 color = mix(uColor, uColor2, 1. - v_LifeLeft);
  #endif

  // Opacity over Life Time
  float finalAlpha = ${e}(1. - v_LifeLeft);  
  vec4 textureColor = texture2D(uTexture, vUv).rgba; 
  finalColor = textureColor.rgb * color.rgb;
  finalAlpha = color.a * textureColor.a * finalAlpha;
  
  gl_FragColor = vec4(finalColor, finalAlpha);     

`,CNe=class extends Vr{constructor(e,t){super(),this.needsJitter=!0,this.type="ParticleMaterial",this.easeOpacity="linearFadeIn",this.easeSize="linearFadeIn",this.useSizeEnd=!1,this.isColoringRandom=!1,this.init(e,t),this.context=t}reset(){}init(e,t){this.transparent=!0,this.depthTest=!0,this.depthWrite=!1,this.easeOpacity=e.ease,this.easeSize=e.easeSize,this.layers=[],gn.startContext(gn.globalContext),this.lightLayer=new Ws(0,"",{...On.defaultData("light","phong"),visible:!1},new WD,{},t.shared),gn.endContext(gn.globalContext),this.build()}updateState(e){e.coloring!==void 0&&(this.isColoringRandom=e.coloring==="random"),e.color!==void 0&&(e.color instanceof Array?this.uniforms.uColor.value=e.color:this.uniforms.uColor.value=this.context.shared.color(e.color)),e.color2!==void 0&&(e.color2 instanceof Array?this.uniforms.uColor2.value=e.color2:this.uniforms.uColor2.value=this.context.shared.color(e.color2)),e.size!==void 0&&(this.uniforms.uSize.value=e.size[0],this.uniforms.uSizeEnd.value=e.size[1],e.size[0]!==e.size[1]?this.useSizeEnd=!0:this.useSizeEnd=!1),e.ease!==void 0&&(this.easeOpacity=e.ease,this.build()),e.easeSize!==void 0&&(this.easeSize=e.easeSize,this.build()),this.needsUpdate=!0}onBeforeCompile(e){this.build(),e.defines=this.defines,e.uniforms=this.uniforms,e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader}build(){let e=new WW;return e.needsJitter=this.needsJitter,e.addFragmentParsCode(iLe),e.buildShader("vertex",this.fragment),e.buildShader("fragment",this.fragment),e.addFragmentFinalCode(nLe),this.isColoringRandom&&e.define("USE_RANDOM_COLORING"),this.useSizeEnd&&e.define("USE_SIZE_END"),e.addVertexParsCode(bNe),e.addFragmentParsCode(wNe),e.addVertexFinalCode(xNe({easeSize:this.easeSize})),e.addFragmentFinalCode(SNe({easeOpacity:this.easeOpacity})),this.vertexShader=e.getCode("vertex"),this.fragmentShader=e.getCode("fragment"),this.defines=e.defines,this.uniforms={...e.uniforms,...this.uniforms},this.extensions=e.extensions,this}get nodeMaterial(){return this}get fragment(){return this.lightLayer.node}getDefines(){return this.defines}nodeMaterialDispose(){this.layers.forEach(e=>e.dispose()),super.dispose()}},V_=class{constructor(e,t,r,i){this.type="SphereEmitterShape",this.targetMesh=void 0,this.size=e,this.type=r,this.textureSize=sNe(t);let n=1;this.targetMesh=(i==null?void 0:i.type)==="Mesh"&&i?i:this.getMesh(r,n);let{positions:a,dataTexture:o,dataTextureNormals:s}=this.createPositions(this.textureSize,this.targetMesh??this.getMesh(r,n));this.positionsTexture=o,this.positionsAttribute=a,this.directionsTexture=s}createPositions(e,t){let{positions:r,normals:i}=lNe(t,e*e),n=rF(r,e),a=rF(i,e);return{dataTexture:n,positions:r,dataTextureNormals:a}}getMesh(e,t){let r=null;switch(e){case"SphereEmitterShape":{r=new op(t*.5,32,32);break}case"TorusEmitterShape":{r=new E8(t*.5,.3,15,40);break}case"ConeEmitterShape":{r=new KP(t,t,15);break}case"BoxEmitterShape":{r=new ws(t,t,t);break}case"PlaneEmitterShape":{r=new fc(t,t),r.rotateX(-Math.PI/2);break}case"MeshEmitterShape":{r=new op(t,32,32);break}default:{r=new op(t,32,32);break}}return new Oi(r,new hc({color:16711680}))}applyToShader(e,t){this.size=new k().fromArray(t.size),e.uEmitterSize.value=this.size}dispose(){this.positionsTexture.dispose(),this.directionsTexture.dispose(),this.positionsAttribute=new Float32Array}};function Ff(e){let t={...e},r=d1.defaultData;t.forceFieldObjectId&&(t.colliderEntityId=t.forceFieldObjectId);let i={...r.shape,...t.shape},n={...r.renderMaterial,...t.renderMaterial};return{...r,...t,shape:i,renderMaterial:n}}var _Ne=`
// uniform sampler2D uCurrentPosition; // Pass in the variable from GPGPU
// uniform sampler2D uCurrentVelocity; // Pass in the variable from GPGPU
// uniform sampler2D uCurrentEmissionRate; // Pass in the variable from GPGPU

uniform sampler2D uIndex; // Texture with corresponding index
uniform float uLastIndexEmitted; // Last emitted index
uniform float uParticlesToEmit; // Number of particles to emit on that frame
uniform float uTime;

void main() {
    vec2 vUv = gl_FragCoord.xy / resolution.xy;
    float particleIndex = texture(uIndex, vUv).x;
    float timeLeft = texture2D( uCurrentPosition, vUv ).w;
    float isActive = texture2D( uCurrentEmissionRate, vUv ).g;    // 1. = active, 0. = not active
    float timeStart = texture2D( uCurrentEmissionRate, vUv ).b;


    // ********** Detect Colision to Create a flag and use it in position **********
    // We are doing this here, so

    // ********** Emit Particles **********
    // X = isSpawning 0.0 or 1.0
    // Y = isActive 0.0 or 1.0
    // Check if the vertex index is between the first value and the last value
    // if (particleIndex >= uLastIndexEmitted && particleIndex < uLastIndexEmitted + uParticlesToEmit) {
    //     // Emit a particle by writing 1 to the red channel of the color output
    //     // r: 1. == emit the particle
    //     // g: 1. == particle is now active
    //     timeStart = uTime;
    //     gl_FragColor = vec4(1.0, 1.0, timeStart, 1.0);
    // } else {
    //     // The Particle is either already emitted or not in the range of the particles to emit
    //     // Do not emit a particle by writing 0 to the red channel of the color output        
    //     gl_FragColor = vec4(0.0, isActive, timeStart, 1.0);
    // }
    // Determine if the particle is within the emission range
    float emitLowerBound = step(uLastIndexEmitted, particleIndex);
    float emitUpperBound = step(particleIndex, uLastIndexEmitted + uParticlesToEmit - 1.0);
    float emitParticle = emitLowerBound * emitUpperBound; // 1.0 if in range, 0.0 otherwise

    // Set timeStart and color
    timeStart = mix(timeStart, uTime, emitParticle);
    gl_FragColor = vec4(emitParticle, mix(isActive, 1.0, emitParticle), timeStart, 1.0);


}
`,H_=10,ANe=class extends Xr{constructor(e,t){super(),this.type="ParticleEmitter",this.debugMode=!1,this.worldSpace=!0,this.rootObject=null,this.gpuCompute=null,this.positionSimRT=null,this.velocitySimRT=null,this.emissionRateSimRT=null,this.emitterShape=void 0,this.isEmitting=!1,this.hasBeenReset=!1,this.emittedParticlesAmount=0,this.lastEmitTime=0,this.globalTime=0,this.targetFPS=60,this.previousRatio=1,this.lerpFactor=.4,this.particlesAmount=0,this.noiseStrength=0,this.noiseScale=0,this.isBillboardBased=!0,this.simFeaturesDefinition={USE_COLLIDER:!1,USE_ATTRACTOR:!1,USE_VORTEX:!1,USE_SPHERE_COLLIDER:!1,USE_BOX_COLLIDER:!1,USE_FORCE_LOCAL_SPACE:!1,USE_NORMALS:!1,USE_CURL_NOISE:!0,USE_SIMPLEX_NOISE:!1,USE_FBM_NOISE:!1},this.textureLoader=new H_e,this.currentWorldPosition=new k,this.systemQuaternion=new Kt,this.worldGravity=new k(0,0,0),this.directionAxis=new k(0,0,0),this.colliderV3=new k(0,0,0),this.colliderQuaternion=new Kt(0,0,0,1),this.matrixAutoUpdate=!0,this.renderer=e,this.system=t,this.shared=t.context.shared;let r=t.data;this.material=new CNe(r.renderMaterial,t.context),this.material.uniforms={uSize:{value:0},uSizeEnd:{value:0},uColor:{value:r.renderMaterial.color},uColor2:{value:r.renderMaterial.color2},uPosition:{value:new k(0,0,0)},uEmissionData:{value:new k(0,0,0)},uTexture:{value:this.defaultTexture},uWorldOffset:{value:new k(0,0,0)},uWorldQuaternion:{value:new Qt(0,0,0,1)},uRandScaleFactor:{value:r.randomScale??0},uRandRotationFactor:{value:r.randomRotation??0},uRotation:{value:r.renderMaterial.spriteRotation[0]??0},uRotationEnd:{value:r.renderMaterial.spriteRotation[1]??0}},this.setTexture(this.material.uniforms,r.renderMaterial.texture),this.init(r)}setTexture(e,t){let r=t.data;if(typeof t=="string"){let i=this.shared.image(t),n=new Ri(i.img);n.needsUpdate=!0,e.uTexture.value=n;return}if(typeof r!="string"){let i=new Image;i.onload=()=>{let o=new Ri(i);o.needsUpdate=!0,e.uTexture.value=o};let n=new Blob([r],{type:"image/*"}),a=URL.createObjectURL(n);i.src=a}}updateGeometryAttributes(e,t){var i;let r=oNe(t);!((i=this.emitterShape)!=null&&i.positionsAttribute)||e.geometry.setAttribute("ref",new Pg(r,2))}applyWorldSpace(){if(!this.system.started||!this.worldSpace||!this.positionSimRT||!this.velocitySimRT)return;let e=this.system;e.getWorldQuaternion(this.systemQuaternion),this.systemQuaternion.invert(),e.getWorldPosition(this.currentWorldPosition),this.material.uniforms.uWorldOffset.value=this.currentWorldPosition,this.material.uniforms.uWorldQuaternion.value.copy(this.systemQuaternion.normalize()),this.positionSimRT.material.uniforms.uWorldOffset.value=this.currentWorldPosition,this.systemQuaternion.invert(),this.positionSimRT.material.uniforms.uWorldQuaternion.value.copy(this.systemQuaternion.normalize()),this.velocitySimRT.material.uniforms.uWorldQuaternion.value.copy(this.systemQuaternion.normalize())}update(e,t){var o;if(!this.gpuCompute||!this.positionSimRT||!this.velocitySimRT||!this.emissionRateSimRT||this.hasBeenReset)return;if(this.checkIfAllParticlesAreDead()&&!this.hasBeenReset){this.reset();return}this.applyWorldSpace(),this.globalTime=e,this.positionSimRT.material.uniforms.uTime.value=e,this.emissionRateSimRT.material.uniforms.uTime.value=e;let r=1e3/t,i=this.targetFPS/r,n=this.previousRatio+(i-this.previousRatio)*this.lerpFactor;this.positionSimRT.material.uniforms.uFPSRatio.value=n,this.previousRatio=n;let a=this.isEmitting?this.GoEmitSomeParticles(e,this.system.data.birthRatePerSec):0;this.emissionRateSimRT.material.uniforms.uLastIndexEmitted.value=this.emittedParticlesAmount,this.emissionRateSimRT.material.uniforms.uParticlesToEmit.value=a,this.material.uniforms.uPosition.value=(o=this.gpuCompute.getCurrentRenderTarget(this.positionSimRT))==null?void 0:o.texture,this.system.colliderEntities.length>0&&this.renderColliders(),this.gpuCompute.compute()}renderColliders(){if(!this.velocitySimRT)return;let e=this.system.colliderEntities[0],t=this.simFeaturesDefinition.USE_COLLIDER||this.simFeaturesDefinition.USE_ATTRACTOR||this.simFeaturesDefinition.USE_VORTEX;if(e.destroyedInAction&&t&&this.init(Ff({...this.system.data,colliderEntityId:null})),!e||e.destroyedInAction)return;e.getWorldPosition(this.colliderV3),this.colliderV3.y===0&&(this.colliderV3.y=1e-4),this.velocitySimRT.material.uniforms.uColliderPos.value.copy(this.colliderV3);let r=e.data.size;this.colliderV3.fromArray(r),this.velocitySimRT.material.uniforms.uColliderSize.value.copy(this.simFeaturesDefinition.USE_SPHERE_COLLIDER?this.colliderV3.multiplyScalar(.5):this.colliderV3),e.getWorldQuaternion(this.colliderQuaternion),this.velocitySimRT.material.uniforms.uColliderQuaternion.value.copy(this.colliderQuaternion.normalize()),this.velocitySimRT.material.uniforms.uColliderQuaternionInvert.value.copy(this.colliderQuaternion.normalize().invert())}updateState(e){!this.velocitySimRT||!this.positionSimRT||(e.renderMaterial&&this.updateMaterialState(e.renderMaterial),this.updateParticleState(e))}updateVariableState(e,t){if(!this.velocitySimRT||!this.positionSimRT)return;t[2]==="size"&&this.material.updateState({size:[e,this.material.uniforms.uSizeEnd.value]}),t[2]==="sizeEnd"&&this.material.updateState({size:[this.material.uniforms.uSize.value,e]});let r=(i,n)=>{let a=[...this.system.data.shape.size];a[i]=n,this.updateParticleState({shape:{...this.system.data.shape,size:a}})};t[2]==="shape_size_0"&&r(0,e),t[2]==="shape_size_1"&&r(1,e),t[2]==="shape_size_2"&&r(2,e),t[2]==="speed"&&(this.velocitySimRT.material.uniforms.uSpeed.value=e/H_),t[2]==="gravity"&&this.worldGravity.set(0,e/100,0),t[2]==="noiseStrength"&&(this.noiseStrength=e,this.velocitySimRT.material.uniforms.uNoiseStrength.value=this.noiseStrength),t[2]==="noiseScale"&&(this.noiseScale=e,this.velocitySimRT.material.uniforms.uNoiseScale.value=this.noiseScale),t[2]==="direction_x"&&(this.directionAxis=this.getDirectionAxis([Number(e),this.system.data.direction[1],this.system.data.direction[2]])),t[2]==="direction_y"&&(this.directionAxis=this.getDirectionAxis([this.system.data.direction[0],Number(e),this.system.data.direction[2]])),t[2]==="direction_z"&&(this.directionAxis=this.getDirectionAxis([this.system.data.direction[0],this.system.data.direction[1],Number(e)]))}updateMaterialState(e){this.material.updateState({...e,size:e.size?[Number(this.shared.getVariable(e.size[0],[this.uuid,"particles","size"])),Number(this.shared.getVariable(e.size[1],[this.uuid,"particles","sizeEnd"]))]:[0,0]}),e.texture&&(this.setTexture(this.material.uniforms,e.texture),this.material.needsUpdate=!0)}updateParticleState(e){var t,r,i;if(!(!this.positionSimRT||!this.velocitySimRT)){if(this.shouldReInitGPUCompute(e)&&this.init(Ff(this.system.data)),e.life!==void 0&&(this.positionSimRT.material.uniforms.uMaxLifeTime.value=e.life),e.speed!==void 0&&(this.velocitySimRT.material.uniforms.uSpeed.value=Number(this.shared.getVariable(e.speed,[this.uuid,"particles","speed"]))/H_),e.collisionBounce!==void 0&&(this.velocitySimRT.material.uniforms.uBounce.value=e.collisionBounce),e.noiseStrength!==void 0&&(this.noiseStrength=Number(this.shared.getVariable(e.noiseStrength,[this.uuid,"particles","noiseStrength"])),this.velocitySimRT.material.uniforms.uNoiseStrength.value=this.noiseStrength),e.noiseScale!==void 0&&(this.noiseScale=Number(this.shared.getVariable(e.noiseScale,[this.uuid,"particles","noiseScale"])),this.velocitySimRT.material.uniforms.uNoiseScale.value=this.noiseScale),e.noiseSeed!==void 0&&(this.velocitySimRT.material.uniforms.uNoiseSeed.value=e.noiseSeed),e.randomMass!==void 0&&(this.velocitySimRT.material.uniforms.uRandomMassFactor.value=e.randomMass),((t=e.renderMaterial)==null?void 0:t.size)!==void 0){let n=this.shared.getVariable(e.renderMaterial.size[0],[this.uuid,"particles","size"]);this.velocitySimRT.material.uniforms.particleSize.value=Number(n)}if(((r=e.renderMaterial)==null?void 0:r.spriteRotation)!==void 0&&(this.material.uniforms.uRotation.value=e.renderMaterial.spriteRotation[0],this.material.uniforms.uRotationEnd.value=e.renderMaterial.spriteRotation[1]),e.shape!==void 0){let n=e.shape.size??this.system.data.shape.size,a=[Number(this.shared.getVariable(n[0],[this.uuid,"particles","shape_size_0"])),Number(this.shared.getVariable(n[1],[this.uuid,"particles","shape_size_1"])),Number(this.shared.getVariable(n[2],[this.uuid,"particles","shape_size_2"]))],o={...Ff(this.system.data).shape,size:a};(i=this.emitterShape)==null||i.applyToShader(this.positionSimRT.material.uniforms,o)}if(e.gravity!==void 0&&(this.worldGravity.set(0,Number(this.shared.getVariable(this.system.data.gravity,[this.uuid,"particles","gravity"]))/100,0),this.velocitySimRT.material.uniforms.uGravity={value:this.worldGravity}),e.direction!==void 0){let n=this.getDirectionFromVariable(e.direction);this.directionAxis=this.getDirectionAxis(n),this.velocitySimRT.material.uniforms.uDirectionsAxis.value=this.directionAxis}e.randomRotation!==void 0&&(this.material.uniforms.uRandRotationFactor.value=e.randomRotation),e.randomScale!==void 0&&(this.material.uniforms.uRandScaleFactor.value=e.randomScale)}}updateForceFieldParameters(e){!this.velocitySimRT||(e.forceIntensity!==void 0&&(this.velocitySimRT.material.uniforms.uForceIntensity.value=e.forceIntensity),e.forceDambing!==void 0&&(this.velocitySimRT.material.uniforms.uForceDamping.value=e.forceDambing))}getDirectionAxis(e){let t=[Number(e[0])*St.DEG2RAD,Number(e[1])*St.DEG2RAD,Number(e[2])*St.DEG2RAD],r=new bn(t[0],t[1],t[2],"XYZ");return this.directionAxis.set(0,1,0).applyEuler(r).normalize(),this.velocitySimRT&&(this.velocitySimRT.material.uniforms.uDirectionsAxis.value=this.directionAxis),this.directionAxis}shouldReInitGPUCompute(e){let{birthRatePerSec:t,rootObjectType:r,colliderEntityId:i,shape:n,emitTimeDuration:a,emitTimeCycle:o,life:s,directionMode:l,noiseType:c}=e;return t!==void 0||r!==void 0||i||i===null||o!==void 0||n!==void 0||s!==void 0||a!==void 0||l!==void 0||c!==void 0}init(e){this.dispose(),this.particlesAmount=this.getMaxParticlesAmount({birthRatePerSecond:e.birthRatePerSec,particleMaxLifeTime:e.life,loopDuration:e.emitTimeCycle==="infinity"?0:e.emitTimeDuration}),this.particlesAmount>1e5&&(console.warn("The maximum number of particles is limited to 100000."),this.particlesAmount=1e5),this.emitterShape=this.createShape(e.shape,this.particlesAmount);let t=setInterval(()=>{if(this.emitterShape)if(isNaN(this.emitterShape.positionsTexture.source.data.data[0])){this.init(e);return}else clearInterval(t)},100);if(!this.emitterShape)return;let r=new nNe(this.emitterShape.textureSize,this.emitterShape.textureSize,this.renderer),i=this.updateSimulationDefinition(e),n=r.addVariable("uCurrentPosition",i+dNe,this.emitterShape.positionsTexture),a=r.addVariable("uCurrentVelocity",i+vNe,this.emitterShape.directionsTexture),o=r.addVariable("uCurrentEmissionRate",_Ne,uNe(this.emitterShape.textureSize));r.setVariableDependencies(n,[n,a,o]),r.setVariableDependencies(a,[n,a,o]),r.setVariableDependencies(o,[n,a,o]);let s=cNe({size:this.emitterShape.textureSize}),l={uOriginalPosition:{value:this.emitterShape.positionsTexture},uWorldOffset:{value:new k(0,0,0)},uWorldQuaternion:{value:new Qt(0,0,0,1)},uTime:{value:0},uFPSRatio:{value:1},uMaxLifeTime:{value:e.life},uEmitterSize:{value:new k(Number(this.shared.getVariable(e.shape.size[0],[this.uuid,"particles","shape_size_0"])),Number(this.shared.getVariable(e.shape.size[1],[this.uuid,"particles","shape_size_1"])),Number(this.shared.getVariable(e.shape.size[2],[this.uuid,"particles","shape_size_2"])))},particleSize:{value:0}};n.material.uniforms=l;let c=this.getDirectionFromVariable(e.direction);this.directionAxis=this.getDirectionAxis(c),this.worldGravity.set(0,Number(this.shared.getVariable(this.system.data.gravity,[this.uuid,"particles","gravity"]))/100,0),this.noiseStrength=Number(this.shared.getVariable(e.noiseStrength,[this.uuid,"particles","noiseStrength"])),this.noiseScale=Number(this.shared.getVariable(e.noiseScale,[this.uuid,"particles","noiseScale"]));let u=e.colliderEntityId&&this.system.getColliderData(e.colliderEntityId),d={uOriginalPosition:{value:this.emitterShape.positionsTexture},uDirections:{value:this.emitterShape.directionsTexture},uDirectionsAxis:{value:this.directionAxis},uWorldQuaternion:{value:new Qt(0,0,0,1)},uColliderPos:{value:new k(0,0,0)},uColliderSize:{value:new k(0,0,0)},uForceIntensity:{value:u?u.forceIntensity:0},uForceDamping:{value:u?u.forceDambing:0},uColliderQuaternion:{value:new Qt(0,0,0,1)},uColliderQuaternionInvert:{value:new Qt(0,0,0,1)},particleSize:{value:0},uGravity:{value:this.worldGravity},uNoiseStrength:{value:this.noiseStrength},uNoiseScale:{value:this.noiseScale},uNoiseSeed:{value:e.noiseSeed},uRandomMassFactor:{value:e.randomMass},uBounce:{value:e.collisionBounce},uSpeed:{value:Number(this.shared.getVariable(e.speed,[this.uuid,"particles","speed"]))/H_}};a.material.uniforms=d;let h={uIndex:{value:s},uTime:{value:0},uLastIndexEmitted:{value:0},uParticlesToEmit:{value:0}};o.material.uniforms=h;let f=[Number(this.shared.getVariable(e.shape.size[0],[this.uuid,"particles","shape_size_0"])),Number(this.shared.getVariable(e.shape.size[1],[this.uuid,"particles","shape_size_1"])),Number(this.shared.getVariable(e.shape.size[2],[this.uuid,"particles","shape_size_2"]))],p={...Ff(this.system.data).shape,size:f};this.emitterShape.applyToShader(n.material.uniforms,p),r.init(),this.gpuCompute=r,this.positionSimRT=n,this.velocitySimRT=a,this.emissionRateSimRT=o,this.rootObject=this.createPrimaryEmitter(this.emitterShape.textureSize),this.add(this.rootObject),this.material.needsUpdate=!0}getDirectionFromVariable(e){let t=Number(this.shared.getVariable(e[0],[this.uuid,"particles","direction_x"])),r=Number(this.shared.getVariable(e[1],[this.uuid,"particles","direction_y"])),i=Number(this.shared.getVariable(e[2],[this.uuid,"particles","direction_z"]));return[t,r,i]}updateSimulationDefinition(e){if(this.simFeaturesDefinition.USE_COLLIDER=!1,this.simFeaturesDefinition.USE_ATTRACTOR=!1,this.simFeaturesDefinition.USE_VORTEX=!1,this.simFeaturesDefinition.USE_SPHERE_COLLIDER=!1,this.simFeaturesDefinition.USE_BOX_COLLIDER=!1,this.simFeaturesDefinition.USE_FORCE_LOCAL_SPACE=!1,this.simFeaturesDefinition.USE_NORMALS=!1,this.simFeaturesDefinition.USE_CURL_NOISE=!1,this.simFeaturesDefinition.USE_SIMPLEX_NOISE=!1,this.simFeaturesDefinition.USE_FBM_NOISE=!1,e.colliderEntityId&&this.system.colliderEntities.length>0){let r=this.system.getColliderData(e.colliderEntityId);switch(r==null?void 0:r.forceType){case"attractor":this.simFeaturesDefinition.USE_ATTRACTOR=!0;break;case"collider":this.simFeaturesDefinition.USE_COLLIDER=!0;break;case"vortex":this.simFeaturesDefinition.USE_VORTEX=!0;break}let i=r==null?void 0:r.colliderType;i==="sphere"&&(this.simFeaturesDefinition.USE_SPHERE_COLLIDER=!0),i==="box"&&(this.simFeaturesDefinition.USE_BOX_COLLIDER=!0),(r==null?void 0:r.forceRange)==="helper"&&(this.simFeaturesDefinition.USE_FORCE_LOCAL_SPACE=!0)}e.directionMode==="normals"&&(this.simFeaturesDefinition.USE_NORMALS=!0),e.noiseType==="curl"&&(this.simFeaturesDefinition.USE_CURL_NOISE=!0),e.noiseType==="simplex"&&(this.simFeaturesDefinition.USE_SIMPLEX_NOISE=!0),e.noiseType==="fbm"&&(this.simFeaturesDefinition.USE_FBM_NOISE=!0);let t="";for(let[r,i]of Object.entries(this.simFeaturesDefinition))i&&(t+=`#define ${r}
`);return t}createShape(e,t){this.emitterShape&&this.emitterShape.dispose();let r=new k(Number(this.shared.getVariable(e.size[0],[this.uuid,"particles","shape_size_0"])),Number(this.shared.getVariable(e.size[1],[this.uuid,"particles","shape_size_1"])),Number(this.shared.getVariable(e.size[2],[this.uuid,"particles","shape_size_2"])));if(e.type==="MeshEmitterShape"){let i=null;return this.system.context.scene.traverseEntity(n=>{n.uuid===e.fromMeshId&&(i=n)}),i?new V_(r,t,e.type,i):new V_(r,t,"SphereEmitterShape")}else return new V_(r,t,e.type)}createPrimaryEmitter(e){let t,r=e*e;return t=new i_e(new fc(1,1,1),this.material,r),this.updateGeometryAttributes(t,e),this.material.needsUpdate=!0,t.onBeforeRender=()=>{this.applyWorldSpace()},t}getMaxParticlesAmount({birthRatePerSecond:e,particleMaxLifeTime:t,loopDuration:r=0}){return Math.ceil(e*(t+r))}dispose(){var e,t,r;!this.gpuCompute||((t=(e=this.rootObject)==null?void 0:e.parent)==null||t.remove(this.rootObject),this.gpuCompute.dispose(),this.material.nodeMaterialDispose(),(r=this.emitterShape)==null||r.dispose())}GoEmitSomeParticles(e,t){let r=e-this.lastEmitTime,i=1/t;if(r>=i){let n=Math.max(1,Math.floor(r/i));return this.lastEmitTime=e,this.emittedParticlesAmount+n>this.particlesAmount&&(this.emittedParticlesAmount=0),this.emittedParticlesAmount+=n,n}return 0}checkIfAllParticlesAreDead(){return this.lastEmitTime+this.system.data.life+1<this.globalTime}reset(){this.hasBeenReset=!0,this.lastEmitTime=0,this.emittedParticlesAmount=0,this.gpuCompute&&this.init(Ff(this.system.data))}startEmitting(e){this.isEmitting=!0,this.hasBeenReset=!1,this.lastEmitTime=e}stopEmitting(){this.isEmitting=!1}},Kb=class extends Fa{constructor(e,t,r){super(e,t),this.type="ParticleSystem",this.geometry=new Ot,this.actualTime=0,this.currentLoopTime=0,this.started=!1,this.stopped=!1,this.timeoutId=void 0,this.isFrozen=!1,this.isIdle=!0,this.emitter=null,this.colliderEntities=[],this.renderer=null,this.isPreWarm=!1,this._hasOnAfterRenderBeenCalled=!1,this.onAfterRender=i=>{this._hasOnAfterRenderBeenCalled||(this._hasOnAfterRenderBeenCalled=!0,this.init(i))},this.context=r,this.data={...t,...Ff(t)},this.geometry.setAttribute("position",new yt([],3)),this.material=new hc({colorWrite:!1}),this.frustumCulled=!1}init(e){this.renderer=e,this.emitter=new ANe(e,this),this.add(this.emitter),this.updateParticleState(this.data)}update(e){if(!this.isReady||!this.started||this.isFrozen||this.isIdle)return;this.actualTime+=e,this.stopped||(this.currentLoopTime+=e);let t=this.data.emitTimeCycle==="one_time";if((this.data.emitTimeCycle==="loop"||t)&&this.currentLoopTime>this.data.emitTimeDuration*1e3&&(this.stopped||(this.stop(),t||this.start(this.data.emitTimeDelay*1e3))),this.emitter&&this.started){let r=this.actualTime/1e3;this.emitter.update(r,e)}this.scale.set(1,1,1),this.updateMatrix()}isReady(){return!!this.emitter}hasCollider(e){return this.colliderEntities.some(t=>t.identity===e)}getColliderData(e){let t=this.colliderEntities.find(r=>r.identity===e);return t?t.data:null}updateByPatchedOp(e,t,r){super.updateByPatchedOp(e,t,r),li(e.path,["renderMaterial"])&&this.updateParticleState({renderMaterial:{...this.data.renderMaterial,...Bn.drop(e,1).props}}),li(e.path,["shape"])&&this.updateParticleState({shape:{...this.data.shape,...Bn.drop(e,1).props}})}updateState(e,t){super.updateState(e,t),this.updateParticleState(e)}updateParticleState(e){if(this.emitter){if(e.colliderEntityId!==void 0&&e.colliderEntityId!==null){let t=this.context.scene.find(e.colliderEntityId);this.colliderEntities=t?[t]:[]}e.colliderEntityId===null&&(this.colliderEntities=[]),this.emitter.updateState(e),e.emitTimeCycle&&this.started&&this.start()}}updateFromColliderEntity(e){!this.emitter||(this.emitter.updateForceFieldParameters(e),this.stop(),this.start())}start(e=0){var t;if(this.currentLoopTime=0,e){this.timeoutId=window.setTimeout(()=>{this.start(0)},e);return}this.started=!0,this.stopped=!1,this.isFrozen=!1,(t=this.emitter)==null||t.startEmitting(this.actualTime/1e3)}froze(){this.isFrozen=!0}unFroze(){this.isFrozen=!1}stop(){var e;this.stopped=!0,this.currentLoopTime=0,(e=this.emitter)==null||e.stopEmitting(),clearTimeout(this.timeoutId)}reset(){var e;this.started=!1,this.stopped=!1,(e=this.emitter)==null||e.reset()}wakeUp(){this.isIdle=!1}sleep(){this.isIdle=!0,this.reset()}};function MNe(){try{let e=window.location.href;if(e.includes("reducesubdiv=")){let t=e.indexOf("reducesubdiv=")+13;return parseInt(e.slice(t,t+1))}}catch{}}var W_=MNe();function ENe(e,t,r){var n;W_!==void 0&&(((n=t==null?void 0:t.geometry)==null?void 0:n.subdivisions)??0)>W_&&(console.log("reducing subdivisions",t.name,t.geometry.subdivisions),t.geometry.subdivisions=W_);let i;return t.geometry.type==="TextGeometry"?new KD(e,t,r):t.geometry.type==="InputGeometry"?new n3(e,t,r):(t.geometry.type==="SubdivGeometry"?i=new Yg(e,t,r):t.geometry.type==="PathGeometry"?i=new i3(e,t,r):t.geometry.type==="VectorGeometry"?i=new rNe(e,t,r):t.geometry.type==="BooleanGeometry"?i=new bh(e,t,r):t.geometry.type==="UIGeometry"?i=new va(e,t,r):i=new ba(e,t,r),i)}function o3(e,t,r){return console.assert(t.type!==void 0),t.type==="Mesh"?ENe(e,t,r):t.type==="Empty"?new mp(e,t):t.type==="Particle"?new Kb(e,t,r):t.type==="ParticleCollider"?new Yb(e,t,r):t.type==="Splat"?new mp(e,t):t.type==="Bone"?new iNe(e,t):t.type==="Page"?new Rn(e,t,r):t.type==="PointLight"?new tNe(e,t,r):t.type==="SpotLight"?new L9(e,t,r):t.type==="DirectionalLight"?new k9(e,t,r):t.type==="Component"||t.type==="Instance"?new vp(e,t,r):gh.is(t.type)?new xa(e,t):(console.error(t),new mp(e,t))}vu.createEntity=o3;function TNe(e,t,r){let i=o3(e.identity,t,r),n=e.children,a=e.attachedPaths,o=e.parent,s=e.component,l=e.instances,c=e.overrideData,u=e.uuid,d=e.stateSelection;e.dispose();for(let h of Object.keys(e))delete e[h];Object.setPrototypeOf(e,Object.getPrototypeOf(i));for(let h of Object.keys(i))e[h]=i[h];e.children=[...e.children,...n],e.attachedPaths=a,e.parent=o,e.component=s,e.instances=l,e.uuid=u,e.overrideData=c,e.updateState(e.data,r),d&&e.changeSelectedState(d,r),e.resetBBoxNeedsUpdate()}vu.changeEntityProptotype=TNe;vu.Cloner=ds;function PNe(e,t,r,i){e.updateByOp(t,r,i,!1)}function iF(e,t){let r=!1,i=t.getLayersOfType("transmission"),n=t.getLayersOfType("outline");return n.length>0&&(e.layers.set(8),i.length>0&&e.layers.enable(3),r=!0,XD(e),YD(e)),i.length===0&&n.length===0&&e.layers.set(0),e instanceof xm&&e.needsAO&&e.layers.enable(5),r}function nF(e,t){if(!t.layers)return!1;let r=!1,i=t.getLayersOfType("transmission").filter(a=>a.data.visible),n=t.getLayersOfType("outline").filter(a=>a.data.visible);return i.length>0&&(e.layers.set(3),n.length>0&&e.layers.enable(8),r=!0),i.length===0&&n.length===0&&e.layers.set(0),e.needsAO&&e.layers.enable(5),r}function DNe(e){let t=!1;return e.traverseEntity(r=>{if(r instanceof xm)if(Array.isArray(r.material))for(let i=0;i<r.material.length;i++)iF(r,r.material[i])&&(t=!0);else iF(r,r.material)&&(t=!0)}),t}function ONe(e){let t=!1;return e.traverseEntity(r=>{if(r instanceof xm)if(Array.isArray(r.material))for(let i=0;i<r.material.length;i++)nF(r,r.material[i])&&(t=!0);else nF(r,r.material)&&(t=!0)}),t}var RNe=new L8,INe=new it,zNe=new om;function QE(e,t,r,i=!1){let n=e.cloner;if(n)for(let a of n.children){let o=INe.copy(a.matrixWorld).invert(),s=zNe.copy(t.ray).applyMatrix4(o),l=e.matrixWorld;s.applyMatrix4(l);let c=RNe;c.set(s.origin,s.direction),c.near=t.near,c.far=t.far;let u=c.intersectObject(e,!1);u.length>0&&r.push({...u[0],object:i?a:e})}}var kNe=class{constructor(){this._constraints=new Map}setConstraint(e,t){t===null?this._constraints.delete(e):this._constraints.set(e,t)}removeDependencies(e){this._constraints.delete(e)}applyConstraints(e){let t=new Set;this._constraints.forEach((r,i)=>{let n=[i,r],a=r;for(;this._constraints.has(a);){if(a=this._constraints.get(a),n.includes(a)){console.warn(`circular dependency detected: ${n.join(" -> ")}`);break}t.has(a)||n.push(a)}for(let o=n.length-2;o>=0;o--)if(!t.has(n[o])){let s=e.find(n[o]);s?s.applyPathSnapping(e):console.warn(`missing entity ${n[o]}`),t.add(n[o])}})}findDependency(e,t){let r=e;for(;this._constraints.has(r);)if(r=this._constraints.get(r),r===t)return!0;return!1}},LNe="AGFzbQEAAAAADwhkeWxpbmsuMAEEAAAAAAETA2AAAGAIf39/f39/f38AYAABfwISAQNlbnYGbWVtb3J5AgMAgIAEAwQDAAECBzkDEV9fd2FzbV9jYWxsX2N0b3JzAAALc29ydEluZGV4ZXMAARNlbXNjcmlwdGVuX3Rsc19pbml0AAIK3gMDAwABC9IDAwF/BnwBfgJAIAdFDQAgAysDUCEMIAMrAzAhDSADKwMQIQ5BACEDRP///////+9/IQtEAAAAAAAAEAAhCgNAIAIgA0ECdGoCfyAOIAEgA0EMbGoiCCoCALuiIA0gCCoCBLuioCAMIAgqAgi7oqBEAAAAAAAAsECiIgmZRAAAAAAAAOBBYwRAIAmqDAELQYCAgIB4CzYCACAJIAsgCSALYxshCyAJIAogCSAKZBshCiADQQFqIgMgB0cNAAsgB0UNACAGuCAKIAuhoyEJQQAhAwNAAn8gCSACIANBAnRqIgEoAgC3IAuhoiIKmUQAAAAAAADgQWMEQCAKqgwBC0GAgICAeAshCCABIAg2AgAgBCAIQQJ0aiIBIAEoAgBBAWo2AgAgA0EBaiIDIAdHDQALCyAGQQJPBEAgBCgCACEIQQEhAwNAIAQgA0ECdGoiASABKAIAIAhqIgg2AgAgA0EBaiIDIAZHDQALCyAHQQFrIgGtIQ8DQCAEIAIgD6dBAnQiA2ooAgBBAnRqIgcgBygCAEEBayIHNgIAIAUgASAHa0ECdGogACADaigCADYCACAPUCEDIA9CAX0hDyADRQ0ACyAGBEAgBEEAIAZBAnT8CwALCwQAQQAL",yu=class{};gv(yu,"DepthMapRange",65536),gv(yu,"MemoryPageSize",65536),gv(yu,"BytesPerFloat",4),gv(yu,"BytesPerInt",4);function BNe(e){let t,r,i,n,a,o,s,l,c,u,d,h,f,p,v,m;function g(P){let T=new Float64Array(u,o,16);for(let z=0;z<16;z++)T[z]=P[z];let R;if(i>1){t.exports.sortIndexes(n,a,c,o,s,l,h.DepthMapRange,i);let z=new Uint32Array(i);R=z.buffer,z.set(new Uint32Array(u,l,i))}else if(i===1){let z=new Uint32Array(i);z[0]=new Uint32Array(u,n,r)[0],R=z.buffer}else R=new ArrayBuffer(0);e.postMessage({sortDone:!0,indexesBuffer:R},[R])}function y(P,T,R){let z=new Float32Array(u,a,r*3);i=0;let F=new Uint32Array(u,n,r);for(let H=0;H<R.length-1;H++){let N=T[H],U=P[H].elements,ie=N.filter(X=>X.enabled&&X.mode==="Include").map(X=>X.type==="Box"?w(X):A(X)),te=N.filter(X=>X.enabled&&X.mode==="Exclude").map(X=>X.type==="Box"?w(X):A(X));for(let X=R[H];X<R[H+1];X++){let W=f[X*3],q=f[X*3+1],$=f[X*3+2];if((ie.length===0||x(W,q,$,ie))&&(te.length===0||!x(W,q,$,te))){let le=1/(U[3]*W+U[7]*q+U[11]*$+U[15]);z[i*3]=(U[0]*W+U[4]*q+U[8]*$+U[12])*le,z[i*3+1]=(U[1]*W+U[5]*q+U[9]*$+U[13])*le,z[i*3+2]=(U[2]*W+U[6]*q+U[10]*$+U[14])*le,F[i]=X,i++}}}}function b(P,T){let R=[],z=T.filter(N=>N.enabled&&N.mode==="Include").map(N=>N.type==="Box"?w(N):A(N)),F=T.filter(N=>N.enabled&&N.mode==="Exclude").map(N=>N.type==="Box"?w(N):A(N)),H=P.length;for(let N=0;N<H;N+=3){let U=P[N],ie=P[N+1],te=P[N+2];(z.length===0||x(U,ie,te,z))&&(F.length===0||!x(U,ie,te,F))||R.push(N/3)}return R}function x(P,T,R,z,F){return z.some(H=>{let N=S(P,T,R,H.invRotationMatrix,H.cropCenter);return Array.isArray(H)?C(N.x,N.y,N.z,H):M(N.x,N.y,N.z,H)})}function S(P,T,R,z,F){let H=P-F[0],N=T-F[1],U=R-F[2],ie=1/(z[3]*H+z[7]*N+z[11]*U+z[15]);return{x:(z[0]*H+z[4]*N+z[8]*U+z[12])*ie+F[0],y:(z[1]*H+z[5]*N+z[9]*U+z[13])*ie+F[1],z:(z[2]*H+z[6]*N+z[10]*U+z[14])*ie+F[2]}}function w(P){let T=P.cropSize[0]/2,R=P.cropSize[1]/2,z=P.cropSize[2]/2,F=[P.cropCenter[0]-T,P.cropCenter[1]-R,P.cropCenter[2]-z,P.cropCenter[0]+T,P.cropCenter[1]+R,P.cropCenter[2]+z],H=_(P.cropRotation);return Object.assign(F,{invRotationMatrix:H,cropCenter:P.cropCenter})}function _(P){let T=[],R=P[0]*Math.PI/180,z=P[1]*Math.PI/180,F=P[2]*Math.PI/180,H=Math.cos(R),N=Math.sin(R),U=Math.cos(z),ie=Math.sin(z),te=Math.cos(F),X=Math.sin(F),W=H*te,q=H*X,$=N*te,le=N*X;return T[0]=U*te,T[1]=-U*X,T[2]=ie,T[4]=q+$*ie,T[5]=W-le*ie,T[6]=-N*U,T[8]=le-W*ie,T[9]=$+q*ie,T[10]=H*U,T[12]=0,T[13]=0,T[14]=0,T[3]=0,T[7]=0,T[11]=0,T[15]=1,T}function C(P,T,R,z){return P>=z[0]&&P<=z[3]&&T>=z[1]&&T<=z[4]&&R>=z[2]&&R<=z[5]}function A(P){let T=2/P.cropSize[0],R=2/P.cropSize[1],z=2/P.cropSize[2],F=_(P.cropRotation);return{invRadiusX:T,invRadiusY:R,invRadiusZ:z,cropCenter:P.cropCenter,invRotationMatrix:F}}function M(P,T,R,z){let F=(P-z.cropCenter[0])*z.invRadiusX,H=(T-z.cropCenter[1])*z.invRadiusY,N=(R-z.cropCenter[2])*z.invRadiusZ;return F*F+H*H+N*N<=1}e.onmessage=P=>{if(P.data.getCroppedIndexes){let T=new Uint32Array(b(new Float32Array(P.data.positions),P.data.crops)).buffer;e.postMessage({outOfBoundsIndexes:T},[T])}else if(P.data.positions)d=P.data.positions,f=new Float32Array(d),v=P.data.meshMatrixWorlds,m=P.data.cropsArray,p=P.data.meshIndexIntervals,y(v,m,p),e.postMessage({sortSetupComplete:!0});else if(P.data.sort||P.data.newMatrixWorlds||P.data.newCropsArray)(P.data.newMatrixWorlds||P.data.newCropsArray)&&(m=P.data.newCropsArray||m,v=P.data.newMatrixWorlds||v,y(v,m,p)),g(P.data.sort.view,P.data.sort.cameraPosition);else if(P.data.init){h=P.data.init.Constants,r=P.data.init.splatCount;let T=h.BytesPerInt,R=h.BytesPerFloat*3,z=new Uint8Array(P.data.init.sorterWasmBytes),F=T+R,H=r*F,N=r*h.BytesPerInt*2+h.DepthMapRange*h.BytesPerInt*2,U=h.MemoryPageSize*32,ie=H+N+U,te=Math.floor(ie/h.MemoryPageSize)+1,X={module:{},env:{memory:new WebAssembly.Memory({initial:te*2,maximum:te*3,shared:!0})}};WebAssembly.compile(z).then(W=>WebAssembly.instantiate(W,X)).then(W=>{t=W,n=0,a=r*T,o=a+r*R,c=o+16*h.BytesPerFloat*2,s=c+r*h.BytesPerInt,l=s+h.DepthMapRange*h.BytesPerInt,u=X.env.memory.buffer,e.postMessage({sortSetupPhase1Complete:!0})})}}}function FNe(e){let t=new Worker(URL.createObjectURL(new Blob(["(",BNe.toString(),")(self)"],{type:"application/javascript"}))),r=atob(LNe),i=new Uint8Array(r.length);for(let n=0;n<r.length;n++)i[n]=r.charCodeAt(n);return t.postMessage({init:{sorterWasmBytes:i.buffer,splatCount:e,Constants:{BytesPerFloat:yu.BytesPerFloat,BytesPerInt:yu.BytesPerInt,DepthMapRange:yu.DepthMapRange,MemoryPageSize:yu.MemoryPageSize}}}),t}var G_=function(){let e=new Float32Array(1),t=new Int32Array(e.buffer);return function(r){return e[0]=r,t[0]}}(),NNe=function(e,t,r,i){return e+(t<<8)+(r<<16)+(i<<24)},wb=new ye;function aF(e){let t=!1;return e.scene.objects.traverse((r,i)=>{if(i.visible===!1)return!0;i.type==="Splat"&&(t=!0)}),t}var Qb=class extends Oi{constructor(e,t,r,i,n=!1,a=1,o,s){super(r,i),this.splatCount=t,this.meshIndexIntervals=o,this.meshMatrixWorlds=s,this.splatBuffers=e,this.geometry=r,this.material=i,this.splatDataTextures=null,this.halfPrecisionCovariancesOnGPU=n,this.devicePixelRatio=a,this.resetLocalSplatDataAndTexturesFromSplatBuffer()}static buildMesh(e,t,r=!1,i=1,n,a){let o=Qb.buildGeomtery(t),s=Qb.buildMaterial(n);return new Qb(e,t,o,s,r,i,n,a)}static buildMaterial(e){let t=`
            precision highp float;
            #include <common>

            attribute uint splatIndex;

            uniform highp sampler2D covariancesTexture;
            uniform highp usampler2D centersColorsTexture;
            uniform vec2 focal;
            uniform vec2 viewport;
            uniform vec2 basisViewport;
            uniform vec2 covariancesTextureSize;
            uniform vec2 centersColorsTextureSize;
						uniform highp sampler2D meshMatrixWorldsTexture;
						uniform uint meshIndexIntervals[257];
						uniform float orthoZoom;

            varying vec4 vColor;
            varying vec2 vUv;

            varying vec2 vPosition;

            const vec4 encodeNorm4 = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0);
            const uvec4 mask4 = uvec4(uint(0x000000FF), uint(0x0000FF00), uint(0x00FF0000), uint(0xFF000000));
            const uvec4 shift4 = uvec4(0, 8, 16, 24);
            vec4 uintToRGBAVec (uint u) {
               uvec4 urgba = mask4 & u;
               urgba = urgba >> shift4;
               vec4 rgba = vec4(urgba) * encodeNorm4;
               return rgba;
            }

            vec2 getDataUV(in int stride, in int offset, in vec2 dimensions) {
                vec2 samplerUV = vec2(0.0, 0.0);
                float d = float(splatIndex * uint(stride) + uint(offset)) / dimensions.x;
                samplerUV.y = float(floor(d)) / dimensions.y;
                samplerUV.x = fract(d);
                return samplerUV;
            }

            void main () {
                uvec4 sampledCenterColor = texture(centersColorsTexture, getDataUV(1, 0, centersColorsTextureSize));
                vec3 splatCenter = uintBitsToFloat(uvec3(sampledCenterColor.gba));
                vColor = uintToRGBAVec(sampledCenterColor.r);

                vPosition = position.xy * 2.0;

								uint meshIndex;
								for (int i = 1; i < 257; i++) {
									if (splatIndex < meshIndexIntervals[i]) {
										meshIndex = uint(i - 1);
										break;
									}
								}

								float strideMulmeshIndex = float(4u*meshIndex);
								float meshMatrixWorldsTextureLength = float(256*4);

								mat4 modelMat = mat4(
									texture(meshMatrixWorldsTexture, vec2((strideMulmeshIndex+0.0)/meshMatrixWorldsTextureLength, 0)),
									texture(meshMatrixWorldsTexture, vec2((strideMulmeshIndex+1.0)/meshMatrixWorldsTextureLength, 0)),
									texture(meshMatrixWorldsTexture, vec2((strideMulmeshIndex+2.0)/meshMatrixWorldsTextureLength, 0)),
									texture(meshMatrixWorldsTexture, vec2((strideMulmeshIndex+3.0)/meshMatrixWorldsTextureLength, 0))
								);
								mat4 modelViewMat = viewMatrix * modelMat;
								vec4 viewCenter = modelViewMat * vec4(splatCenter, 1.0); 
                vec4 clipCenter = projectionMatrix * viewCenter;

                vec2 sampledCovarianceA = texture(covariancesTexture, getDataUV(3, 0, covariancesTextureSize)).rg;
                vec2 sampledCovarianceB = texture(covariancesTexture, getDataUV(3, 1, covariancesTextureSize)).rg;
                vec2 sampledCovarianceC = texture(covariancesTexture, getDataUV(3, 2, covariancesTextureSize)).rg;

                vec3 cov3D_M11_M12_M13 = vec3(sampledCovarianceA.rg, sampledCovarianceB.r);
                vec3 cov3D_M22_M23_M33 = vec3(sampledCovarianceB.g, sampledCovarianceC.rg);

                // Compute the 2D covariance matrix from the upper-right portion of the 3D covariance matrix
                mat3 Vrk = mat3(
                    cov3D_M11_M12_M13.x, cov3D_M11_M12_M13.y, cov3D_M11_M12_M13.z,
                    cov3D_M11_M12_M13.y, cov3D_M22_M23_M33.x, cov3D_M22_M23_M33.y,
                    cov3D_M11_M12_M13.z, cov3D_M22_M23_M33.y, cov3D_M22_M23_M33.z
                );
                float s = 1.0 / (viewCenter.z * viewCenter.z);

                mat3 W = transpose(mat3(modelViewMat));
                mat3 T = orthoZoom > 0.0 ? W : W * mat3(
									focal.x / viewCenter.z, 0., -(focal.x * viewCenter.x) * s,
									0., focal.y / viewCenter.z, -(focal.y * viewCenter.y) * s,
									0., 0., 0.
								);
                mat3 cov2Dm = transpose(T) * Vrk * T;
                cov2Dm[0][0] += 0.3;
                cov2Dm[1][1] += 0.3;

                // We are interested in the upper-left 2x2 portion of the projected 3D covariance matrix because
                // we only care about the X and Y values. We want the X-diagonal, cov2Dm[0][0],
                // the Y-diagonal, cov2Dm[1][1], and the correlation between the two cov2Dm[0][1]. We don't
                // need cov2Dm[1][0] because it is a symetric matrix.
                vec3 cov2Dv = vec3(cov2Dm[0][0], cov2Dm[0][1], cov2Dm[1][1]);

                vec3 ndcCenter = clipCenter.xyz / clipCenter.w;

                // We now need to solve for the eigen-values and eigen vectors of the 2D covariance matrix
                // so that we can determine the 2D basis for the splat. This is done using the method described
                // here: https://people.math.harvard.edu/~knill/teaching/math21b2004/exhibits/2dmatrices/index.html
                //
                // This is a different approach than in the original work at INRIA. In that work they compute the
                // max extents of the 2D covariance matrix in screen space to form an axis aligned bounding rectangle
                // which forms the geometry that is actually rasterized. They then use the inverse 2D covariance
                // matrix (called 'conic') to determine fragment opacity.
                float a = cov2Dv.x;
                float d = cov2Dv.z;
                float b = cov2Dv.y;
                float D = a * d - b * b;
                float trace = a + d;
                float traceOver2 = 0.5 * trace;
                float term2 = sqrt(trace * trace / 4.0 - D);
                float eigenValue1 = traceOver2 + term2;
								float eigenValue2 = max(traceOver2 - term2, 0.00); // prevent negative eigen value

                const float maxSplatSize = 1024.0;
                vec2 eigenVector1 = normalize(vec2(b, eigenValue1 - a));
                // since the eigen vectors are orthogonal, we derive the second one from the first
                vec2 eigenVector2 = vec2(eigenVector1.y, -eigenVector1.x);
                vec2 basisVector1 = eigenVector1 * min(sqrt(2.0 * eigenValue1), maxSplatSize);
                vec2 basisVector2 = eigenVector2 * min(sqrt(2.0 * eigenValue2), maxSplatSize);

                vec2 ndcOffset = vec2(vPosition.x * basisVector1 + vPosition.y * basisVector2) * basisViewport;

								if (orthoZoom > 0.0) {
									ndcOffset *= orthoZoom;
								}

                gl_Position = vec4(ndcCenter.xy + ndcOffset, ndcCenter.z, 1.0);
            }`,r=`
            precision highp float;
            #include <common>

            uniform vec3 debugColor;

            varying vec4 vColor;
            varying vec2 vUv;

            varying vec2 vPosition;
						layout(location = 1) out vec4 gVelocity; 

            void main () {
                // compute the negative squared distance from the center of the splat to the
                // current fragment in the splat's local space.
                float A = -dot(vPosition, vPosition);
                if (A < -4.0) discard;
                vec3 color = vColor.rgb;
                A = exp(A) * vColor.a;
                gl_FragColor = vec4(color.rgb, A);
								gVelocity = vec4(0.0); // so it is ignored by TAA
            }`,i={covariancesTexture:{type:"t",value:null},centersColorsTexture:{type:"t",value:null},meshIndexIntervals:{value:e},meshMatrixWorldsTexture:{type:"t",value:null},focal:{type:"v2",value:new ye},viewport:{type:"v2",value:new ye},basisViewport:{type:"v2",value:new ye},debugColor:{type:"v3",value:new Bt},covariancesTextureSize:{type:"v2",value:new ye(1024,1024)},centersColorsTextureSize:{type:"v2",value:new ye(1024,1024)},orthoZoom:{type:"f",value:-1}};return new Vr({uniforms:i,vertexShader:t,fragmentShader:r,transparent:!0,alphaTest:1,blending:Qd,depthTest:!0,depthWrite:!1,side:ga})}static buildGeomtery(e){let t=new Ot;t.setIndex([0,1,2,0,2,3]);let r=new Float32Array(4*3),i=new qt(r,3);t.setAttribute("position",i),i.setXYZ(0,-1,-1,0),i.setXYZ(1,-1,1,0),i.setXYZ(2,1,1,0),i.setXYZ(3,1,-1,0),i.needsUpdate=!0;let n=new z8().copy(t),a=new Uint32Array(e),o=new Pg(a,1,!1);return o.setUsage(Vbe),n.setAttribute("splatIndex",o),n.instanceCount=e,n}resetLocalSplatDataAndTexturesFromSplatBuffer(){this.updateLocalSplatDataFromSplatBuffer(),this.allocateAndStoreLocalSplatDataInTextures()}updateLocalSplatDataFromSplatBuffer(){this.splatBuffers.forEach(i=>i.buildPreComputedBuffers()),this.covariances=new Float32Array(this.splatCount*6),this.colors=new Uint8Array(this.splatCount*4),this.centers=new Float32Array(this.splatCount*3);let e=0,t=0,r=0;for(let i of this.splatBuffers){let n=i.nsplats;this.colors.subarray(e,e+n*4).set(i.colorsA),e+=n*4,this.centers.subarray(t,t+n*3).set(i.decoded.xyz.denormDequant().data),t+=n*3,this.covariances.subarray(r,r+n*6).set(new Float32Array(i.precomputedCovarianceBufferData)),r+=n*6}}allocateAndStoreLocalSplatDataInTextures(){let e=this.splatCount,t=new ye(4096,1024);for(;t.x*t.y*2<e*6;)t.y*=2;let r=new ye(4096,1024);for(;r.x*r.y*4<e*4;)r.y*=2;let i,n;if(this.halfPrecisionCovariancesOnGPU){n=new Uint16Array(t.x*t.y*2);for(let u=0;u<this.covariances.length;u++)n[u]=y2e.toHalfFloat(this.covariances[u]);i=new Lo(n,t.x,t.y,Bx,dc)}else n=new Float32Array(t.x*t.y*2),n.set(this.covariances),i=new Lo(n,t.x,t.y,Bx,ln);i.needsUpdate=!0,this.material.uniforms.covariancesTexture.value=i,this.material.uniforms.covariancesTextureSize.value.copy(t);let a=new Uint32Array(r.x*r.y*4);for(let u=0;u<e;u++){let d=u*4,h=u*3,f=u*4;a[f]=NNe(this.colors[d],this.colors[d+1],this.colors[d+2],this.colors[d+3]),a[f+1]=G_(this.centers[h]),a[f+2]=G_(this.centers[h+1]),a[f+3]=G_(this.centers[h+2])}let o=new Lo(a,r.x,r.y,QV,Jl);o.internalFormat="RGBA32UI",o.needsUpdate=!0,this.material.uniforms.centersColorsTexture.value=o,this.material.uniforms.centersColorsTextureSize.value.copy(r);let s=256*4,l=new Float32Array(256*16);for(let u=0;u<this.meshMatrixWorlds.length;u++)l.set(this.meshMatrixWorlds[u].elements,u*16);let c=new Lo(l,s,1,Ln,ln);c.needsUpdate=!0,this.material.uniforms.meshMatrixWorldsTexture.value=c,this.material.uniformsNeedUpdate=!0,this.splatDataTextures={covariances:{data:n,texture:i,size:t},centerColors:{data:a,texture:o,size:r},meshMatrixWorlds:{data:l,texture:c}}}updateIndexes(e){let t=this.geometry;t.attributes.splatIndex.set(e),t.attributes.splatIndex.needsUpdate=!0,t.instanceCount=e.length}updateUniforms(e,t,r,i){this.splatCount>0&&(wb.set(e.x*this.devicePixelRatio,e.y*this.devicePixelRatio),this.material.uniforms.viewport.value.copy(wb),this.material.uniforms.basisViewport.value.set(2/wb.x,2/wb.y),this.material.uniforms.focal.value.set(t,r),this.material.uniforms.orthoZoom.value=i,this.material.uniformsNeedUpdate=!0)}getSplatDataTextures(){return this.splatDataTextures}getSplatCount(){return this.splatCount}getCenters(){return this.centers}getColors(){return this.colors}getCovariances(){return this.covariances}dispose(){this.geometry.dispose(),this.material.dispose(),this.splatDataTextures&&(this.splatDataTextures.covariances.texture.dispose(),this.splatDataTextures.centerColors.texture.dispose(),this.splatDataTextures.meshMatrixWorlds.texture.dispose()),this.removeFromParent()}},Y9,UNe=new Promise(e=>{Y9=e}),oF=!1,Sb;function jNe(){if(oF)return;if(Sb)return Sb;async function e(){let t=await Cc(()=>import("./gaussian-splat-compression-ro4O0smp.js"),[]);Y9(t),oF=!0}return Sb=e(),Sb}var X9;UNe.then(e=>X9=e);var VNe=class{constructor(e={}){gv(this,"updateView",function(){let t=new it,r=[],i=new k(0,0,-1),n=new k(0,0,-1),a=new k,o=new k;return function(s=!1,l){let c=this.updateMatrixWorldsInWorkerIfNeeded(),u=this.cropsChanged();if(!s){n.set(0,0,-1).applyQuaternion(l.quaternion);let h=!1,f=!1;if(n.dot(i)<=.95&&(h=!0),o.copy(l.position).sub(a).length()>=1&&(f=!0),!h&&!f&&!c&&!u&&!this.needsInitialRender)return}this.needsInitialRender=!1,a.copy(l.position),i.copy(n),t.copy(l.matrixWorld).invert(),t.premultiply(this.dummyPerspectiveMatrix),r[0]=l.position.x,r[1]=l.position.y,r[2]=l.position.z;let d={sort:{view:t.elements,cameraPosition:r,splatRenderCount:this.splatRenderCount,splatSortCount:this.splatRenderCount},...c?{newMatrixWorlds:this.meshMatrixWorlds}:{},...u?{newCropsArray:this.cropsArray}:{}};this.sortRunning?this.queuedMessage=d:(this.queuedMessage=null,this.sortRunning=!0,this.sortWorker.postMessage(d))}}()),this.scene=e.scene,this.currentPage=null,this.devicePixelRatio=window.devicePixelRatio,this.sortWorker=null,this.splatRenderCount=0,this.splatSortCount=0,this.splatMesh=null,this.sortRunning=!1,this.meshMatrixWorlds=null,this.meshMatrixWorldsOld=null,this.cropsArray=null,this.splatEntries=null,this.queuedMessage=null,this.needsInitialRender=!0,this.dummyPerspectiveMatrix=new it().makePerspective(-1,1,-1,1,.1,1e3)}updateSplatMeshUniforms(e,t){let r=new ye;this.splatMesh!==null&&this.splatMesh.getSplatCount()>0&&(e.getSize(r),this.cameraFocalLengthX=t.projectionMatrix.elements[0]*this.devicePixelRatio*r.x*.45,this.cameraFocalLengthY=t.projectionMatrix.elements[5]*this.devicePixelRatio*r.y*.45,this.splatMesh.updateUniforms(r,this.cameraFocalLengthX,this.cameraFocalLengthY,t.isPerspectiveCamera?-1:t.zoom*this.devicePixelRatio))}loadSplat(e={}){this.activePage=this.scene.activePage,e.position&&(e.position=new k().fromArray(e.position)),e.orientation&&(e.orientation=new Kt().fromArray(e.orientation)),e.halfPrecisionCovariances=!!e.halfPrecisionCovariances;let t=[];if(this.splatEntries=t,this.activePage.traverseVisibleEntity(a=>{a.data.type==="Splat"&&t.push(a)}),this.splatMesh&&this.splatMesh.dispose(),t.length===0)return this.splatMesh=null,!1;this.meshMatrixWorlds=t.map(a=>a.matrixWorld),this.meshMatrixWorldsOld=t.map(a=>a.matrixWorld.clone()),this.cropsArray=t.map(a=>a.data.crops.map(o=>o.data));let r=t.map(a=>new X9.GSplineBuffer(new Uint8Array(a.data.buffer).buffer)),i=0,n=[0];for(let a of r)i+=a.getSplatCount(),n.push(i);return this.setupSplatMesh(r,i,e.position,e.orientation,e.halfPrecisionCovariances,this.devicePixelRatio,n,this.meshMatrixWorlds),this.setupSortWorker(i),!0}updateMatrixWorldsInWorkerIfNeeded(){let e=this.splatDataTextures.meshMatrixWorlds.data;for(let t=0;t<this.meshMatrixWorlds.length;t++)e.set(this.meshMatrixWorlds[t].elements,t*16);return this.splatDataTextures.meshMatrixWorlds.texture.needsUpdate=!0,this.meshMatrixWorlds.every((t,r)=>t.equals(this.meshMatrixWorldsOld[r]))?!1:(this.meshMatrixWorldsOld=this.meshMatrixWorlds.map(t=>t.clone()),!0)}cropsChanged(){let e=!1;return this.splatEntries.forEach((t,r)=>{var i;t.data.crops.forEach((n,a)=>{this.cropsArray[r][a]===void 0?(e=!0,this.cropsArray[r][a]=n.data):Object.entries(n.data).forEach(([o,s])=>{var l;Array.isArray(s)&&s.some((c,u)=>c!==this.cropsArray[r][a][o][u])?(e=!0,this.cropsArray[r][a][o]=s):s!==((l=this.cropsArray[r][a])==null?void 0:l[o])&&(e=!0,this.cropsArray[r][a][o]=s)})}),t.data.crops.length!==((i=this.cropsArray[r])==null?void 0:i.length)&&(this.cropsArray[r].length=t.data.crops.length,e=!0)}),e}setupSplatMesh(e,t,r=new k,i=new Kt,n=!1,a=1,o,s){this.splatMesh=Qb.buildMesh(e,t,n,a,o,s),this.splatMesh.position.copy(r),this.splatMesh.quaternion.copy(i),this.splatMesh.frustumCulled=!1,this.splatMesh.renderOrder=99999,this.splatRenderCount=t,this.splatMesh.onBeforeRender=(l,c,u)=>this.update(l,u)}setupSortWorker(e){this.sortWorker=FNe(e),this.sortWorker.onmessage=t=>{var r;t.data.sortDone?(this.sortRunning=!1,(r=this.splatMesh)==null||r.updateIndexes(new Uint32Array(t.data.indexesBuffer)),this.lastSortTime=t.data.sortTime,this.queuedMessage&&(this.sortWorker.postMessage(this.queuedMessage),this.queuedMessage=null)):t.data.sortCanceled?this.sortRunning=!1:t.data.sortSetupPhase1Complete?this.sortWorker.postMessage({positions:this.splatMesh.getCenters().buffer,meshMatrixWorlds:this.splatMesh.meshMatrixWorlds,meshIndexIntervals:this.splatMesh.meshIndexIntervals,cropsArray:this.cropsArray}):t.data.sortSetupComplete&&(this.splatDataTextures=this.splatMesh.getSplatDataTextures(),this.scene.activePage.add(this.splatMesh),this.needsInitialRender=!0)}}update(e,t){this.splatMesh!==null&&(this.updateSplatMeshUniforms(e,t),this.updateView(!1,t))}getSplatMesh(){return this.splatMesh}},ZE=new hc;ZE.wireframe=!0;var sF=new k,s3=class extends ll{constructor(e,t){super(),this.data=e,this.sharedAssets=t,this.enableHelpers=!1,this.wireframeState=!1,this.needsTransmissionDirty=!0,this.needsNormalDirty=!0,this._needsTransmission=!1,this._needsNormal=!1,this.geometryCacheChanged=!1,this.splatViewer=null,this.entityByUuid={},this.entityIdentityToEntity={},this.toExpandCloner=new Set,this.toUpdateCloner=new Set,this.pendingCommands=[],this.pathConstraints=new kNe,this.invisibleObjects=new mp("jflkdsafjasdifjaslk",{...aE.defaultData,visible:!1,name:"buildin invisible"}),this.needsRecomputeInstances=!1,this.init(e,t),this.matrixAutoUpdate=!1,this.errorPage=new Rn("fdasfa",{...Gp.defaultData,name:""},{shared:t,scene:this})}markGeometryCacheDirty(){this.geometryCacheChanged=!0}markNeedsUpdateRendererDirty(){this.needsTransmissionDirty=!0,this.needsNormalDirty=!0}needsTransmission(){return this.needsTransmissionDirty&&(this._needsTransmission=ONe(this),this.needsTransmissionDirty=!1),this._needsTransmission}needsNormal(){return this.needsNormalDirty&&(this._needsNormal=DNe(this),this.needsNormalDirty=!1),this._needsNormal}registerInstanceAndSetUuid(e){let t=e.identity.join("-"),r=this.entityIdentityToEntity[t];r&&(e.uuid=r.uuid),this.entityIdentityToEntity[t]=e,this.entityByUuid[e.uuid]=e}markPenumbraSizeDirty(){for(let e of this.children)e instanceof Rn&&(e.penumbraSizeArrayCache=null)}findInstance(e){return this.entityIdentityToEntity[e.join("-")]}get bgColor(){return this.activePage.bgColor}get postprocessing(){return this.activePage.data.postprocessing}getWithSortKey(e){let t=this.find(e);if(t===void 0)return;let r=[],i=t;for(;i!==this;){let n=i;i=i.parent;let a=i.children.indexOf(n);r.splice(0,0,a)}return{entity:t,sortKey:r}}getAllSorted(e){let t=[];for(let r of e){let i=this.getWithSortKey(r.id);i!==void 0&&t.push(i)}return t.sort((r,i)=>CH(r.sortKey,i.sortKey)),t.map(r=>r.entity)}nonExistOrDescendantOf(e,t){let r=this.find(e);if(r===void 0)return!0;for(;r;){if(r.uuid===t)return!0;r=r.parent}return!1}find(e){if(this.activePage&&this.activePage.personalCamera.parent){if(e==="f23858d0-4a3b-4bd8-8173-66ed0af7f6fb-personalCamera")return this.activePage.personalCamera;if(e===gm)return this.activePage.personalCamera}if(e===""||e===void 0)return;let t=this.entityByUuid[e];return t===void 0?this.getObjectByProperty("uuid",e):t}find2D(e){for(let t of this.children)if(t instanceof Rn&&t.uiScene){let r=t.uiScene.find(e);if(r)return r}}findScene2DfromObject2D(e){for(let t of this.children)if(t instanceof Rn&&t.uiScene&&t.uiScene.find(e))return t.uiScene}find2DInUIObjects(e){let t;return this.traverseEntity(r=>{t===void 0&&r instanceof va&&(t=r.uiCanvas.find(e))}),t}traverse2D(e){for(let t of this.children)t instanceof Rn&&t.uiScene&&t.uiScene.traverse(e)}debugEnsureEntity(e){let t=this.find(e);if(t){if(Array.isArray(t.identity)&&this.findInstance(t.identity)===void 0){console.error("not found instance");debugger}}else{console.error("not found");debugger}}addPendingExpandCloner(e){this.toExpandCloner.add(e)}addPendingUpdateCloner(e){this.toUpdateCloner.add(e)}markToExpandCloner(e){this.toExpandCloner.add(e),e.traverseEntityAncestors(t=>{this.toExpandCloner.add(t)})}doPendingExpandCloner(){this.toExpandCloner.forEach(e=>{e.expandCloner(this)}),this.toExpandCloner.clear()}doPendingUpdateCloner(){this.toUpdateCloner.forEach(e=>{var t;(t=e.cloner)==null||t.update()}),this.toUpdateCloner.clear()}doPendingUpdates(){this.doPendingExpandCloner(),this.doPendingUpdateCloner(),this.applyPendingCommands()}addPendingCommand(e){this.pendingCommands.push(e)}applyPendingCommands(){this.pendingCommands.forEach(e=>e()),this.pendingCommands.length=0}updateByLibOp(e,t){e.path.length===1&&e.path[0]==="components"&&e.type===1&&this.createChildrenObjects([{...e.data.asset,id:e.id}],this.invisibleObjects,t)}updateTreeByOp(e,t){var r;if(e.path.length===0&&e.type===7){let i=e.parent===null?this:this.find(e.parent);if(i===void 0)throw new Error("unexpected");let n=this.createObject(e.id,e.data,e.children,i,e.localIndex,t);n.updateVisible(this),n.resetBBoxNeedsUpdate(),os(n)&&ic(n.parent)&&(n.invalidateUpstreamBooleanData(),n.parent.invalidateDownstreamBooleanData().recomputeBoolean()),this.markNeedsRecomputeInstancesForAncessors(i),this.markNeedsRecomputeInstancesForChildren(n),this.markToExpandCloner(n),this.markPenumbraSizeDirty(),n.updatePathSnapping()}else if(e.path.length===0&&e.type===8){let i=this.find(e.id);if(i===void 0)throw new Error("unexpected");this.markToExpandCloner(i),i.resetBBoxNeedsUpdate(),this.unregisterObject(i);let n=i.parent;this.markNeedsRecomputeInstancesForAncessors(n),this.markNeedsRecomputeInstancesForChildren(i),this.markPenumbraSizeDirty(),i.parent.remove(i),ic(i.parent)&&(i.parent.invalidateUpstreamBooleanData(),i.parent.invalidateDownstreamBooleanData().recomputeBoolean()),os(i)&&(i.freeBooleanPointer(),n instanceof bh&&n.invalidateDownstreamBooleanData().recomputeBoolean()),i instanceof i3&&i.detachShape(),this.disposeAndUnregisterEntityRecursivelyIfNotReregistered(i),this.pathConstraints.removeDependencies(i.uuid),i.updatePathSnapping()}else if(e.path.length===0&&e.type===9){let i=this.find(e.id);if(i===void 0)throw new Error("unexpected");this.markNeedsRecomputeInstancesForChildren(i);let n=i.parent;this.markNeedsRecomputeInstancesForAncessors(n),(r=i.cloner)==null||r.resetOnMove(),this.markToExpandCloner(i);let a=e.parent===null?this:this.find(e.parent);if(a===void 0)throw new Error("unexpected");a.add(i),this.markNeedsRecomputeInstancesForAncessors(a),this.markToExpandCloner(i),i.invalidateClonerTransform(i),i.updateVisible(this),i.resetBBoxNeedsUpdate(),this.markPenumbraSizeDirty();let o=e.localIndex;a.children.splice(o,0,a.children.pop()),os(i)&&(i.invalidateUpstreamBooleanData(),ic(i.parent)?i.parent.invalidateDownstreamBooleanData().recomputeBoolean():n instanceof bh&&n.invalidateDownstreamBooleanData().recomputeBoolean()),i.updatePathSnapping()}this.markNeedsUpdateRendererDirty(),this.markGeometryCacheDirty()}get playPage(){return this.find(this.data.publish.playPage)??this.errorPage}updatePage(e){var t;this.activePage&&this.activePage.onDeactive(),this.activePage=this.errorPage;for(let r of this.children)r instanceof Rn&&(r.visible=r.uuid===e,r.visible&&(this.activePage=r,this.activePage.onActive(this)));this.activePage!==((t=this.splatViewer)==null?void 0:t.activePage)&&this.reloadSplats()}updateEntityByOp(e,t,r,i){if(t.type===0){if(("overrides"in t.props||"component"in t.props)&&this.markNeedsRecomputeInstances(),"visible"in t.props&&this.markPenumbraSizeDirty(),t.path.includes("overrides")&&"states"in t.props){let{rest:a}=t.props;t={...t,props:a},this.markNeedsRecomputeInstances()}t.path[0]==="pathSnapping"&&t.props.pathId!==void 0&&this.pathConstraints.setConstraint(e,t.props.pathId)}let n=this.find(e);if(n)try{PNe(n,t,r,{scene:this,shared:i}),n instanceof ba&&n.updateGeometryGroupsIfNeeded()}catch(a){console.error(a)}}updateEntity2DByOp(e,t,r,i,n,a=[]){e.updateEntityByOp(t,r,i,n),this.traverseEntity(o=>{(o instanceof va||o instanceof Rn)&&(a.includes(o.frameId??"")||o.frameId===t)&&o.updateEntity2DByOp(t,r,i,n)})}get activeCamera(){return this.activePage.activeCamera}switchActiveCamera(e){this.activePage.switchActiveCamera(e)}isInvisibleObjects(e){return e===this.invisibleObjects||e.hasAnccestor(this.invisibleObjects)}init(e,t){let r=Object.entries(t.data.lib.components).map((i,n)=>({data:i[1].asset.data,children:i[1].asset.children,id:i[0],fi:n}));this.invisibleObjects.updateState(this.invisibleObjects.data,{scene:this,shared:t}),this.add(this.invisibleObjects),this.createChildrenObjects(r,this.invisibleObjects,t),this.createChildrenObjects(e.objects,this,t),this.updatePage(e.publish.playPage),this.activePage.switchToPlayCamera(),this.expandInstances(t,!0),this.traverseEntity(i=>{i instanceof xa&&i.updateUp()}),this.doPendingExpandCloner(),this.applyPendingCommands()}markNeedsRecomputeInstances(){this.needsRecomputeInstances=!0}markNeedsRecomputeInstancesForChildren(e){e.traverseEntity(t=>{(t.data.type==="Component"||t.data.type==="Instance")&&this.markNeedsRecomputeInstances()})}markNeedsRecomputeInstancesForAncessors(e){_r.is(e)&&(e.data.type==="Component"&&this.markNeedsRecomputeInstances(),e.traverseAncestors(t=>{_r.is(t)&&t.data.type==="Component"&&this.markNeedsRecomputeInstances()}))}relativeizeInner(e,t,r,i,n,a,o){if(e){let s=i.find(e);s&&s!==i&&n.forInstancesRec(l=>{l.data=Fg(l.data,c=>{let u=c.events.data(o.id),d=l.goUp(a);if(d){let h=[...SH(d.identity),e].join("-"),f=this.entityIdentityToEntity[h];if(f){let p=f.uuid,v=xn.zoom(u,t);v[r]=p}else console.warn("cannot find instance")}}).data})}}rewriteActions(e,t,r,i,n,a){e.forEach(o=>{o.data.type==="Transition"?this.relativeizeInner(o.data.object,[...t,o.id],"object",r,i,n,a):o.data.type==="Animation"?this.relativeizeInner(o.data.object,[...t,o.id],"object",r,i,n,a):o.data.type==="Conditional"&&(this.rewriteActions(o.data.ifActions,[...t,o.id,"ifActions"],r,i,n,a),this.rewriteActions(o.data.elseActions,[...t,o.id,"elseActions"],r,i,n,a))})}rewriteEventsBeforeGoToPlayMode(){this.traverseEntity(e=>{if(e instanceof vp&&typeof e.identity=="string"&&e.data.type==="Component")return e.traverseEntity((t,r)=>{t.data.events.forEach(i=>{if(i.data.type==="GameControl"){let n=!1;if(t.forInstancesRec(a=>{a.data=Fg(a.data,o=>{a.isInstanceRoot||(o.events.delete(i.id),n=!0)}).data}),n===!1)for(let a of b1.list)this.rewriteActions(i.data.gameActions[a],["gameActions",a],e,t,r,i)}else i.data.type==="Conditional"?(i.data.condition.type==="Distance"?(this.relativeizeInner(i.data.condition.fromObject,["condition"],"fromObject",e,t,r,i),this.relativeizeInner(i.data.condition.toObject,["condition"],"toObject",e,t,r,i)):i.data.condition.type==="State"?this.relativeizeInner(i.data.condition.object,["condition"],"object",e,t,r,i):i.data.condition.type==="Comparison"&&(i.data.condition.lOperand.type==="Property"&&this.relativeizeInner(i.data.condition.lOperand.value[0],["condition","lOperand","value"],0,e,t,r,i),i.data.condition.rOperand.type==="Property"&&this.relativeizeInner(i.data.condition.rOperand.value[0],["condition","rOperand","value"],0,e,t,r,i)),this.rewriteActions(i.data.inActions,["inActions"],e,t,r,i),this.rewriteActions(i.data.outActions,["outActions"],e,t,r,i)):"actions"in i.data&&this.rewriteActions(i.data.actions,["actions"],e,t,r,i)})}),!0})}expandInstances(e,t,r){let i=new Set;this.traverseEntity(n=>{if(n instanceof vp&&n.isInstanceRoot)return n.expandInstanceChildren({scene:this,shared:e,pendingDeletes:i}),t||n.resetBBoxNeedsUpdate(),r&&n.traverseEntity(a=>{r.addClip(a)}),!0});for(let n of i)this.disposeAndUnregisterEntityRecursivelyIfNotReregistered(n),a3(n)}recomputeInstances(e,t){this.needsRecomputeInstances&&(this.needsRecomputeInstances=!1,this.traverseEntity(r=>{r instanceof vp&&r.isInstanceRoot&&(r.component=void 0)}),this.expandInstances(e,!1,t))}disposeAndUnregisterEntityRecursivelyIfNotReregistered(e){e.traverseEntity(t=>{let r=typeof t.identity=="string"?t.identity:t.identity.join("-");this.entityIdentityToEntity[r]===t&&(delete this.entityByUuid[t.uuid],delete this.entityIdentityToEntity[r]),t.dispose()})}clearScene(){for(let e of this.children)_r.is(e)&&e.disposeRecursively();this.children.length=0}resetAfterClear(e,t){this.init(e,t)}raycast(e){return this.raycast1(e,!1)}raycast1(e,t){let r=[],i=n=>{for(let a of n.children){let o=a.cloner;if(_r.is(a)&&!a.raycastLock&&(a.visible||o!=null&&o.object.data.visible))if(t===!0&&a.isInstanceRoot){let s=[];if(e.intersectObject(a,!0,s),s.length){let l=s[0];l.object=a,l.point.applyMatrix4(l.object.matrixWorld);let c=a.matrixWorld.clone().invert();l.point.applyMatrix4(c),r.push(l)}}else(os(a)||UE(a)&&this.enableHelpers&&a.objectHelper.visible)&&(e.intersectObject(a,!1,r),QE(a,e,r)),i(a)}};return i(this.activePage),r}raycastWithClones(e){let t=[],r=i=>{for(let n of i.children){let a=n.cloner;_r.is(n)&&(n.visible||a!=null&&a.object.data.visible)&&((os(n)||UE(n)&&this.enableHelpers&&n.objectHelper.visible)&&(e.intersectObject(n,!1,t),QE(n,e,t,!0)),r(n))}};return r(this),t}forEachEntity(e){for(let t of this.children)_r.is(t)&&e(t)}traverseConcreteEntity(e){for(let t of this.children)_r.is(t)&&t.isConcreteEntity&&t.traverseEntity(e)}traverseEntity(e){for(let t of this.children)_r.is(t)&&t.traverseEntity(e)}updateFont(e,t){this.traverseEntity(r=>{if(r instanceof ba&&r.data.type==="Mesh"&&(r.data.geometry.type==="TextGeometry"||r.data.geometry.type==="InputGeometry")&&r.data.geometry.font===e){let i=r.geometry,n=r.data.geometry;i.updateFont(e,t).then(()=>{i.update(n);let a=r.invalidateDownstreamBooleanData();ic(a)&&a.recomputeBoolean()})}})}traverseObject(e){for(let t of this.children)$g.is(t)&&t.traverseObject(e)}traverseVisibleEntity(e){for(let t of this.children)_r.is(t)&&t.visible&&t.traverseVisibleEntity(e)}dispose(){this.clearScene()}createChildrenObjects(e,t,r){let i=0;for(let n of e)this.createObject(n.id,n.data,n.children,t,i,r),i+=1}registerObjectCreatedInLegacy(e){this.entityByUuid[e.uuid]=e}unregisterObject(e){delete this.entityByUuid[e.uuid];for(let t of e.children)this.unregisterObject(t)}createObject(e,t,r,i,n,a){var l;let o={scene:this,shared:a},s=o3(e,t,o);return s&&(this.entityByUuid[e]=s,i.add(s),i.children.splice(n,0,i.children.pop()),r.length>0&&(s.isInstanceRoot?console.error("instance should not have children!"):this.createChildrenObjects(r,s,a)),s.updateState(t,o),s instanceof ba&&s.updateGeometryGroupsIfNeeded(),s.updateVisible(this),s.cloner&&this.toExpandCloner.add(s),(l=t.pathSnapping)!=null&&l.pathId&&this.pathConstraints.setConstraint(e,t.pathSnapping.pathId)),t.type==="Empty"&&t.animations&&s.traverseEntity(c=>{let u=c.dataPatched;if(c instanceof ba&&u.bones&&u.boneInverses){let d=u.bones.map(p=>this.find(p)),h=u.boneInverses.map(p=>new it().fromArray(p)),f=new $P(d,h);c.bind(f,c.bindMatrix)}else c.matrixAutoUpdate=!0}),s}getCenter(e){let t=[];for(let i=0,n=e.length;i<n;++i){let{id:a,recursive:o}=e[i],s=this.find(a),l=o?s.recursiveBBox:s.singleBBox;t.push(...l.vertices)}let r=new Ji;return r.setFromPoints(t),r.getCenter(sF),sF}copyMatrixWorld(e,t){if(e===null){t.identity();return}let r=this.find(e);r?t.copy(r.matrixWorld):t.identity()}copyParentMatrixWorld(e,t){var i;if(e===null){t.identity();return}let r=(i=this.find(e))==null?void 0:i.parent;r?t.copy(r.matrixWorld):t.identity()}traverseMaterial(e){this.traverseEntity(t=>{if(t instanceof Fa)if(Array.isArray(t.material))for(let r=0;r<t.material.length;r++)t.material[r]instanceof Nu&&e(t.material[r]);else t.material instanceof Nu&&e(t.material)})}updateViewPlaneSize(e,t,r=!1){this.traverseConcreteEntity(i=>{i instanceof xa&&i.setViewplaneSize(e,t,r)})}initializeSplatViewer(){this.splatViewer=new VNe({scene:this}),this.reloadSplats()}reloadSplats(){var e;(e=this.splatViewer)==null||e.loadSplat()}},Zb=(e,t)=>{let r=t.x-e.x,i=t.y-e.y;return Math.sqrt(r*r+i*i)},HNe=(e,t)=>{let r=t.x-e.x,i=t.y-e.y;return GNe(Math.atan2(i,r))},WNe=(e,t,r)=>{let i={x:0,y:0};return r=JE(r),i.x=e.x-t*Math.cos(r),i.y=e.y-t*Math.sin(r),i},JE=e=>e*(Math.PI/180),GNe=e=>e*(180/Math.PI),$Ne=e=>isNaN(e.buttons)?e.pressure!==0:e.buttons!==0,$_=new Map,lF=e=>{$_.has(e)&&clearTimeout($_.get(e)),$_.set(e,setTimeout(e,100))},z1=(e,t,r)=>{let i=t.split(/[ ,]+/g),n;for(let a=0;a<i.length;a+=1)n=i[a],e.addEventListener?e.addEventListener(n,r,!1):e.attachEvent&&e.attachEvent(n,r)},cF=(e,t,r)=>{let i=t.split(/[ ,]+/g),n;for(let a=0;a<i.length;a+=1)n=i[a],e.removeEventListener?e.removeEventListener(n,r):e.detachEvent&&e.detachEvent(n,r)},K9=e=>(e.preventDefault(),e.type.match(/^touch/)?e.changedTouches:e),uF=()=>{if(typeof window>"u")return;let e=window.pageXOffset!==void 0?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,t=window.pageYOffset!==void 0?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop;return{x:e,y:t}},eT=(e,t)=>{t.top||t.right||t.bottom||t.left?(e.style.top=t.top,e.style.right=t.right,e.style.bottom=t.bottom,e.style.left=t.left):(e.style.left=t.x+"px",e.style.top=t.y+"px")},l3=(e,t,r)=>{let i=Q9(e);for(let n in i)if(i.hasOwnProperty(n))if(typeof t=="string")i[n]=t+" "+r;else{let a="";for(let o=0,s=t.length;o<s;o+=1)a+=t[o]+" "+r+", ";i[n]=a.slice(0,-2)}return i},qNe=(e,t)=>{let r=Q9(e);for(let i in r)r.hasOwnProperty(i)&&(r[i]=t);return r},Q9=e=>{let t={};return t[e]="",["webkit","Moz","o"].forEach(function(r){t[r+e.charAt(0).toUpperCase()+e.slice(1)]=""}),t},q_=(e,t)=>{for(let r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e},YNe=(e,t)=>{let r={};for(let i in e)e.hasOwnProperty(i)&&t.hasOwnProperty(i)?r[i]=t[i]:e.hasOwnProperty(i)&&(r[i]=e[i]);return r},tT=(e,t)=>{if(e.length)for(let r=0,i=e.length;r<i;r+=1)t(e[r]);else t(e)},XNe=(e,t,r)=>({x:Math.min(Math.max(e.x,t.x-r),t.x+r),y:Math.min(Math.max(e.y,t.y-r),t.y+r)});typeof window<"u"&&(Z9="ontouchstart"in window,J9=!!window.PointerEvent,e7=!!window.MSPointerEvent);var Z9,J9,e7,ov={touch:{start:"touchstart",move:"touchmove",end:"touchend, touchcancel"},mouse:{start:"mousedown",move:"mousemove",end:"mouseup"},pointer:{start:"pointerdown",move:"pointermove",end:"pointerup, pointercancel"},MSPointer:{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}},Yf,Xg={};J9?Yf=ov.pointer:e7?Yf=ov.MSPointer:Z9?(Yf=ov.touch,Xg=ov.mouse):Yf=ov.mouse;function Bh(){}Bh.prototype.on=function(e,t){var r=this,i=e.split(/[ ,]+/g),n;r._handlers_=r._handlers_||{};for(var a=0;a<i.length;a+=1)n=i[a],r._handlers_[n]=r._handlers_[n]||[],r._handlers_[n].push(t);return r};Bh.prototype.off=function(e,t){var r=this;return r._handlers_=r._handlers_||{},e===void 0?r._handlers_={}:t===void 0?r._handlers_[e]=null:r._handlers_[e]&&r._handlers_[e].indexOf(t)>=0&&r._handlers_[e].splice(r._handlers_[e].indexOf(t),1),r};Bh.prototype.trigger=function(e,t){var r=this,i=e.split(/[ ,]+/g),n;r._handlers_=r._handlers_||{};for(var a=0;a<i.length;a+=1)n=i[a],r._handlers_[n]&&r._handlers_[n].length&&r._handlers_[n].forEach(function(o){o.call(r,{type:n,target:r},t)})};Bh.prototype.config=function(e){var t=this;t.options=t.defaults||{},e&&(t.options=YNe(t.options,e))};Bh.prototype.bindEvt=function(e,t){var r=this;return r._domHandlers_=r._domHandlers_||{},r._domHandlers_[t]=function(){typeof r["on"+t]=="function"?r["on"+t].apply(r,arguments):console.warn('[WARNING] : Missing "on'+t+'" handler.')},z1(e,Yf[t],r._domHandlers_[t]),Xg[t]&&z1(e,Xg[t],r._domHandlers_[t]),r};Bh.prototype.unbindEvt=function(e,t){var r=this;return r._domHandlers_=r._domHandlers_||{},cF(e,Yf[t],r._domHandlers_[t]),Xg[t]&&cF(e,Xg[t],r._domHandlers_[t]),delete r._domHandlers_[t],this};var c3=Bh;function Mn(e,t){return this.identifier=t.identifier,this.position=t.position,this.frontPosition=t.frontPosition,this.collection=e,this.defaults={size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:1,mode:"dynamic",zone:document.body,lockX:!1,lockY:!1,shape:"circle"},this.config(t),this.options.mode==="dynamic"&&(this.options.restOpacity=0),this.id=Mn.id,Mn.id+=1,this.buildEl().stylize(),this.instance={el:this.ui.el,on:this.on.bind(this),off:this.off.bind(this),show:this.show.bind(this),hide:this.hide.bind(this),add:this.addToDom.bind(this),remove:this.removeFromDom.bind(this),destroy:this.destroy.bind(this),setPosition:this.setPosition.bind(this),resetDirection:this.resetDirection.bind(this),computeDirection:this.computeDirection.bind(this),trigger:this.trigger.bind(this),position:this.position,frontPosition:this.frontPosition,ui:this.ui,identifier:this.identifier,id:this.id,options:this.options},this.instance}Mn.prototype=new c3;Mn.constructor=Mn;Mn.id=0;Mn.prototype.buildEl=function(e){return this.ui={},this.options.dataOnly?this:(this.ui.el=document.createElement("div"),this.ui.back=document.createElement("div"),this.ui.front=document.createElement("div"),this.ui.el.className="nipple collection_"+this.collection.id,this.ui.back.className="back",this.ui.front.className="front",this.ui.el.setAttribute("id","nipple_"+this.collection.id+"_"+this.id),this.ui.el.appendChild(this.ui.back),this.ui.el.appendChild(this.ui.front),this)};Mn.prototype.stylize=function(){if(this.options.dataOnly)return this;var e=this.options.fadeTime+"ms",t=qNe("borderRadius","50%"),r=l3("transition","opacity",e),i={};return i.el={position:"absolute",opacity:this.options.restOpacity,display:"block",zIndex:999},i.back={position:"absolute",display:"block",width:this.options.size+"px",height:this.options.size+"px",marginLeft:-this.options.size/2+"px",marginTop:-this.options.size/2+"px",background:"rgba(255, 255, 255, .4)",border:"solid 2px rgba(0, 0, 0, .1)"},i.front={width:this.options.size/2+"px",height:this.options.size/2+"px",position:"absolute",display:"block",marginLeft:-this.options.size/4+"px",marginTop:-this.options.size/4+"px",background:"rgba(255, 255, 255, .8)",border:"solid 2px rgba(0, 0, 0, .1)"},q_(i.el,r),this.options.shape==="circle"&&q_(i.back,t),q_(i.front,t),this.applyStyles(i),this};Mn.prototype.applyStyles=function(e){for(var t in this.ui)if(this.ui.hasOwnProperty(t))for(var r in e[t])this.ui[t].style[r]=e[t][r];return this};Mn.prototype.addToDom=function(){return this.options.dataOnly||document.body.contains(this.ui.el)?this:(this.options.zone.appendChild(this.ui.el),this)};Mn.prototype.removeFromDom=function(){return this.options.dataOnly||!document.body.contains(this.ui.el)?this:(this.options.zone.removeChild(this.ui.el),this)};Mn.prototype.destroy=function(){clearTimeout(this.removeTimeout),clearTimeout(this.showTimeout),clearTimeout(this.restTimeout),this.trigger("destroyed",this.instance),this.removeFromDom(),this.off()};Mn.prototype.show=function(e){var t=this;return t.options.dataOnly||(clearTimeout(t.removeTimeout),clearTimeout(t.showTimeout),clearTimeout(t.restTimeout),t.addToDom(),t.restCallback(),setTimeout(function(){t.ui.el.style.opacity=1},0),t.showTimeout=setTimeout(function(){t.trigger("shown",t.instance),typeof e=="function"&&e.call(this)},t.options.fadeTime)),t};Mn.prototype.hide=function(e){var t=this;if(t.options.dataOnly)return t;if(t.ui.el.style.opacity=t.options.restOpacity,clearTimeout(t.removeTimeout),clearTimeout(t.showTimeout),clearTimeout(t.restTimeout),t.removeTimeout=setTimeout(function(){var r=t.options.mode==="dynamic"?"none":"block";t.ui.el.style.display=r,typeof e=="function"&&e.call(t),t.trigger("hidden",t.instance)},t.options.fadeTime),t.options.restJoystick){let r=t.options.restJoystick,i={};i.x=r===!0||r.x!==!1?0:t.instance.frontPosition.x,i.y=r===!0||r.y!==!1?0:t.instance.frontPosition.y,t.setPosition(e,i)}return t};Mn.prototype.setPosition=function(e,t){var r=this;r.frontPosition={x:t.x,y:t.y};var i=r.options.fadeTime+"ms",n={};n.front=l3("transition",["top","left"],i);var a={front:{}};a.front={left:r.frontPosition.x+"px",top:r.frontPosition.y+"px"},r.applyStyles(n),r.applyStyles(a),r.restTimeout=setTimeout(function(){typeof e=="function"&&e.call(r),r.restCallback()},r.options.fadeTime)};Mn.prototype.restCallback=function(){var e=this,t={};t.front=l3("transition","none",""),e.applyStyles(t),e.trigger("rested",e.instance)};Mn.prototype.resetDirection=function(){this.direction={x:!1,y:!1,angle:!1}};Mn.prototype.computeDirection=function(e){var t=e.angle.radian,r=Math.PI/4,i=Math.PI/2,n,a,o;if(t>r&&t<r*3&&!e.lockX?n="up":t>-r&&t<=r&&!e.lockY?n="left":t>-r*3&&t<=-r&&!e.lockX?n="down":e.lockY||(n="right"),e.lockY||(t>-i&&t<i?a="left":a="right"),e.lockX||(t>0?o="up":o="down"),e.force>this.options.threshold){var s={},l;for(l in this.direction)this.direction.hasOwnProperty(l)&&(s[l]=this.direction[l]);var c={};this.direction={x:a,y:o,angle:n},e.direction=this.direction;for(l in s)s[l]===this.direction[l]&&(c[l]=!0);if(c.x&&c.y&&c.angle)return e;(!c.x||!c.y)&&this.trigger("plain",e),c.x||this.trigger("plain:"+a,e),c.y||this.trigger("plain:"+o,e),c.angle||this.trigger("dir dir:"+n,e)}else this.resetDirection();return e};var KNe=Mn;function en(e,t){var r=this;r.nipples=[],r.idles=[],r.actives=[],r.ids=[],r.pressureIntervals={},r.manager=e,r.id=en.id,en.id+=1,r.defaults={zone:document.body,multitouch:!1,maxNumberOfNipples:10,mode:"dynamic",position:{top:0,left:0},catchDistance:200,size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:1,lockX:!1,lockY:!1,shape:"circle",dynamicPage:!1,follow:!1},r.config(t),(r.options.mode==="static"||r.options.mode==="semi")&&(r.options.multitouch=!1),r.options.multitouch||(r.options.maxNumberOfNipples=1);let i=getComputedStyle(r.options.zone.parentElement);return i&&i.display==="flex"&&(r.parentIsFlex=!0),r.updateBox(),r.prepareNipples(),r.bindings(),r.begin(),r.nipples}en.prototype=new c3;en.constructor=en;en.id=0;en.prototype.prepareNipples=function(){var e=this,t=e.nipples;t.on=e.on.bind(e),t.off=e.off.bind(e),t.options=e.options,t.destroy=e.destroy.bind(e),t.ids=e.ids,t.id=e.id,t.processOnMove=e.processOnMove.bind(e),t.processOnEnd=e.processOnEnd.bind(e),t.get=function(r){if(r===void 0)return t[0];for(var i=0,n=t.length;i<n;i+=1)if(t[i].identifier===r)return t[i];return!1}};en.prototype.bindings=function(){var e=this;e.bindEvt(e.options.zone,"start"),e.options.zone.style.touchAction="none",e.options.zone.style.msTouchAction="none"};en.prototype.begin=function(){var e=this,t=e.options;if(t.mode==="static"){var r=e.createNipple(t.position,e.manager.getIdentifier());r.add(),e.idles.push(r)}};en.prototype.createNipple=function(e,t){var r=this,i=r.manager.scroll,n={},a=r.options,o={x:r.parentIsFlex?i.x:i.x+r.box.left,y:r.parentIsFlex?i.y:i.y+r.box.top};if(e.x&&e.y)n={x:e.x-o.x,y:e.y-o.y};else if(e.top||e.right||e.bottom||e.left){var s=document.createElement("DIV");s.style.display="hidden",s.style.top=e.top,s.style.right=e.right,s.style.bottom=e.bottom,s.style.left=e.left,s.style.position="absolute",a.zone.appendChild(s);var l=s.getBoundingClientRect();a.zone.removeChild(s),n=e,e={x:l.left+i.x,y:l.top+i.y}}var c=new KNe(r,{color:a.color,size:a.size,threshold:a.threshold,fadeTime:a.fadeTime,dataOnly:a.dataOnly,restJoystick:a.restJoystick,restOpacity:a.restOpacity,mode:a.mode,identifier:t,position:e,zone:a.zone,frontPosition:{x:0,y:0},shape:a.shape});return a.dataOnly||(eT(c.ui.el,n),eT(c.ui.front,c.frontPosition)),r.nipples.push(c),r.trigger("added "+c.identifier+":added",c),r.manager.trigger("added "+c.identifier+":added",c),r.bindNipple(c),c};en.prototype.updateBox=function(){var e=this;e.box=e.options.zone.getBoundingClientRect()};en.prototype.bindNipple=function(e){var t=this,r,i=function(n,a){r=n.type+" "+a.id+":"+n.type,t.trigger(r,a)};e.on("destroyed",t.onDestroyed.bind(t)),e.on("shown hidden rested dir plain",i),e.on("dir:up dir:right dir:down dir:left",i),e.on("plain:up plain:right plain:down plain:left",i)};en.prototype.pressureFn=function(e,t,r){var i=this,n=0;clearInterval(i.pressureIntervals[r]),i.pressureIntervals[r]=setInterval((function(){var a=e.force||e.pressure||e.webkitForce||0;a!==n&&(t.trigger("pressure",a),i.trigger("pressure "+t.identifier+":pressure",a),n=a)}).bind(i),100)};en.prototype.onstart=function(e){var t=this,r=t.options,i=e;e=K9(e),t.updateBox();var n=function(a){t.actives.length<r.maxNumberOfNipples?t.processOnStart(a):i.type.match(/^touch/)&&(Object.keys(t.manager.ids).forEach(function(o){if(Object.values(i.touches).findIndex(function(l){return l.identifier===o})<0){var s=[e[0]];s.identifier=o,t.processOnEnd(s)}}),t.actives.length<r.maxNumberOfNipples&&t.processOnStart(a))};return tT(e,n),t.manager.bindDocument(),!1};en.prototype.processOnStart=function(e){var t=this,r=t.options,i,n=t.manager.getIdentifier(e),a=e.force||e.pressure||e.webkitForce||0,o={x:e.pageX,y:e.pageY},s=t.getOrCreate(n,o);s.identifier!==n&&t.manager.removeIdentifier(s.identifier),s.identifier=n;var l=function(u){u.trigger("start",u),t.trigger("start "+u.id+":start",u),u.show(),a>0&&t.pressureFn(e,u,u.identifier),t.processOnMove(e)};if((i=t.idles.indexOf(s))>=0&&t.idles.splice(i,1),t.actives.push(s),t.ids.push(s.identifier),r.mode!=="semi")l(s);else{var c=Zb(o,s.position);if(c<=r.catchDistance)l(s);else{s.destroy(),t.processOnStart(e);return}}return s};en.prototype.getOrCreate=function(e,t){var r=this,i=r.options,n;return/(semi|static)/.test(i.mode)?(n=r.idles[0],n?(r.idles.splice(0,1),n):i.mode==="semi"?r.createNipple(t,e):(console.warn("Coudln't find the needed nipple."),!1)):(n=r.createNipple(t,e),n)};en.prototype.processOnMove=function(e){var t=this,r=t.options,i=t.manager.getIdentifier(e),n=t.nipples.get(i),a=t.manager.scroll;if(!$Ne(e)){this.processOnEnd(e);return}if(!n){console.error("Found zombie joystick with ID "+i),t.manager.removeIdentifier(i);return}if(r.dynamicPage){var o=n.el.getBoundingClientRect();n.position={x:a.x+o.left,y:a.y+o.top}}n.identifier=i;var s=n.options.size/2,l={x:e.pageX,y:e.pageY};r.lockX&&(l.y=n.position.y),r.lockY&&(l.x=n.position.x);var c=Zb(l,n.position),u=HNe(l,n.position),d=JE(u),h=c/s,f={distance:c,position:l},p,v;if(n.options.shape==="circle"?(p=Math.min(c,s),v=WNe(n.position,p,u)):(v=XNe(l,n.position,s),p=Zb(v,n.position)),r.follow){if(c>s){let b=l.x-v.x,x=l.y-v.y;n.position.x+=b,n.position.y+=x,n.el.style.top=n.position.y-(t.box.top+a.y)+"px",n.el.style.left=n.position.x-(t.box.left+a.x)+"px",c=Zb(l,n.position)}}else l=v,c=p;var m=l.x-n.position.x,g=l.y-n.position.y;n.frontPosition={x:m,y:g},r.dataOnly||eT(n.ui.front,n.frontPosition);var y={identifier:n.identifier,position:l,force:h,pressure:e.force||e.pressure||e.webkitForce||0,distance:c,angle:{radian:d,degree:u},vector:{x:m/s,y:-g/s},raw:f,instance:n,lockX:r.lockX,lockY:r.lockY};y=n.computeDirection(y),y.angle={radian:JE(180-u),degree:180-u},n.trigger("move",y),t.trigger("move "+n.id+":move",y)};en.prototype.processOnEnd=function(e){var t=this,r=t.options,i=t.manager.getIdentifier(e),n=t.nipples.get(i),a=t.manager.removeIdentifier(n.identifier);!n||(r.dataOnly||n.hide(function(){r.mode==="dynamic"&&(n.trigger("removed",n),t.trigger("removed "+n.id+":removed",n),t.manager.trigger("removed "+n.id+":removed",n),n.destroy())}),clearInterval(t.pressureIntervals[n.identifier]),n.resetDirection(),n.trigger("end",n),t.trigger("end "+n.id+":end",n),t.ids.indexOf(n.identifier)>=0&&t.ids.splice(t.ids.indexOf(n.identifier),1),t.actives.indexOf(n)>=0&&t.actives.splice(t.actives.indexOf(n),1),/(semi|static)/.test(r.mode)?t.idles.push(n):t.nipples.indexOf(n)>=0&&t.nipples.splice(t.nipples.indexOf(n),1),t.manager.unbindDocument(),/(semi|static)/.test(r.mode)&&(t.manager.ids[a.id]=a.identifier))};en.prototype.onDestroyed=function(e,t){var r=this;r.nipples.indexOf(t)>=0&&r.nipples.splice(r.nipples.indexOf(t),1),r.actives.indexOf(t)>=0&&r.actives.splice(r.actives.indexOf(t),1),r.idles.indexOf(t)>=0&&r.idles.splice(r.idles.indexOf(t),1),r.ids.indexOf(t.identifier)>=0&&r.ids.splice(r.ids.indexOf(t.identifier),1),r.manager.removeIdentifier(t.identifier),r.manager.unbindDocument()};en.prototype.destroy=function(){var e=this;e.unbindEvt(e.options.zone,"start"),e.nipples.forEach(function(r){r.destroy()});for(var t in e.pressureIntervals)e.pressureIntervals.hasOwnProperty(t)&&clearInterval(e.pressureIntervals[t]);e.trigger("destroyed",e.nipples),e.manager.unbindDocument(),e.off()};var QNe=en;function Gn(e){var t=this;t.ids={},t.index=0,t.collections=[],t.scroll=uF(),t.config(e),t.prepareCollections();var r=function(){var n;t.collections.forEach(function(a){a.forEach(function(o){n=o.el.getBoundingClientRect(),o.position={x:t.scroll.x+n.left,y:t.scroll.y+n.top}})})};if(typeof window>"u")return t.collections;z1(window,"resize",function(){lF(r)});var i=function(){t.scroll=uF()};return z1(window,"scroll",function(){lF(i)}),t.collections}Gn.prototype=new c3;Gn.constructor=Gn;Gn.prototype.prepareCollections=function(){var e=this;e.collections.create=e.create.bind(e),e.collections.on=e.on.bind(e),e.collections.off=e.off.bind(e),e.collections.destroy=e.destroy.bind(e),e.collections.get=function(t){var r;return e.collections.every(function(i){return r=i.get(t),!r}),r}};Gn.prototype.create=function(e){return this.createCollection(e)};Gn.prototype.createCollection=function(e){var t=this,r=new QNe(t,e);return t.bindCollection(r),t.collections.push(r),r};Gn.prototype.bindCollection=function(e){var t=this,r,i=function(n,a){r=n.type+" "+a.id+":"+n.type,t.trigger(r,a)};e.on("destroyed",t.onDestroyed.bind(t)),e.on("shown hidden rested dir plain",i),e.on("dir:up dir:right dir:down dir:left",i),e.on("plain:up plain:right plain:down plain:left",i)};Gn.prototype.bindDocument=function(){var e=this;e.binded||(e.bindEvt(document,"move").bindEvt(document,"end"),e.binded=!0)};Gn.prototype.unbindDocument=function(e){var t=this;(!Object.keys(t.ids).length||e===!0)&&(t.unbindEvt(document,"move").unbindEvt(document,"end"),t.binded=!1)};Gn.prototype.getIdentifier=function(e){var t;return e?(t=e.identifier===void 0?e.pointerId:e.identifier,t===void 0&&(t=this.latest||0)):t=this.index,this.ids[t]===void 0&&(this.ids[t]=this.index,this.index+=1),this.latest=t,this.ids[t]};Gn.prototype.removeIdentifier=function(e){var t={};for(var r in this.ids)if(this.ids[r]===e){t.id=r,t.identifier=this.ids[r],delete this.ids[r];break}return t};Gn.prototype.onmove=function(e){var t=this;return t.onAny("move",e),!1};Gn.prototype.onend=function(e){var t=this;return t.onAny("end",e),!1};Gn.prototype.oncancel=function(e){var t=this;return t.onAny("end",e),!1};Gn.prototype.onAny=function(e,t){var r=this,i,n="processOn"+e.charAt(0).toUpperCase()+e.slice(1);t=K9(t);var a=function(s,l,c){c.ids.indexOf(l)>=0&&(c[n](s),s._found_=!0)},o=function(s){i=r.getIdentifier(s),tT(r.collections,a.bind(null,s,i)),s._found_||r.removeIdentifier(i)};return tT(t,o),!1};Gn.prototype.destroy=function(){var e=this;e.unbindDocument(!0),e.ids={},e.index=0,e.collections.forEach(function(t){t.destroy()}),e.off()};Gn.prototype.onDestroyed=function(e,t){var r=this;if(r.collections.indexOf(t)<0)return!1;r.collections.splice(r.collections.indexOf(t),1)};var ZNe=Gn,dF=new ZNe,JNe={create:function(e){return dF.create(e)},factory:dF},t7=new Map,Zv=new Map,Vd=class{constructor(e,t,r,i){this.data=t;let{audio:n,volume:a,delay:o,loop:s}=t;if(!n)throw new Error("Missing property");let l=typeof n=="string"?i.getAudio(n).src:n.data;this.audioPlayer=new Mv({src:l,volume:a,delay:o,loop:s}),Zv.has(r.uuid)?Zv.get(r.uuid).push(this):Zv.set(r.uuid,[this]),t7.set(e,this)}playByToggle(){this.data.toggle==="stop"?this.audioPlayer.status==="playing"?this.audioPlayer.stop():(this.audioPlayer.stop(),this.audioPlayer.play()):this.data.toggle==="pause"?this.audioPlayer.status==="playing"?this.audioPlayer.pause():this.audioPlayer.play():(this.audioPlayer.stop(),this.audioPlayer.play())}dispose(){this.audioPlayer.stop()}},rT=class{constructor(e){this.data=e}dispatch(){this.data.playAudio?this.pauseAudio(this.data.playAudio):this.data.object?this.pauseAllAudiosFromObject(this.data.object):this.pauseAllAudios()}pauseAudio(e){let t=t7.get(e);!t||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{t.audioPlayer[this.data.interaction](),this.disposeDelay()},this.data.delay)):t.audioPlayer[this.data.interaction]())}pauseAllAudiosFromObject(e){let t=Zv.get(e);!(t!=null&&t.length)||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{t.forEach(r=>r.audioPlayer[this.data.interaction]()),this.disposeDelay()},this.data.delay)):t.forEach(r=>r.audioPlayer[this.data.interaction]()))}pauseAllAudios(){let e=[...Zv.values()];!e.length||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{e.forEach(t=>{t.forEach(r=>{r.audioPlayer[this.data.interaction]()})}),this.disposeDelay()},this.data.delay)):e.forEach(t=>{t.forEach(r=>{r.audioPlayer[this.data.interaction]()})}))}disposeDelay(){clearTimeout(this.timeoutId),delete this.timeoutId}dispose(){clearTimeout(this.timeoutId),delete this.timeoutId}},r7=class{constructor(e,t,r,i,n){if(this.data=t,this.shared=i,this.condition=n,t.interaction==="play")this.interaction=new Vd(e,t,r,i);else if(t.interaction==="pause"||t.interaction==="stop")this.interaction=new rT(t);else throw new Error("Missing property")}dispatchBasic(){if(gi(this.shared,this.condition)===!1)return!1;this.interaction instanceof Vd?this.interaction.playByToggle():this.interaction.dispatch()}dispatchConditional(){if(gi(this.shared,this.condition)===!1)return!1;this.interaction instanceof Vd?this.interaction.audioPlayer.play():this.interaction.dispatch()}dispatchGameControl(e){if(gi(this.shared,this.condition)===!1)return!1;this.interaction instanceof Vd&&(e==="start"?this.interaction.audioPlayer.play():this.interaction.audioPlayer.stop())}dispose(){this.interaction.dispose()}},i7=class{constructor(e,t,r,i){this.data=e,this.page=t,this.shared=r,this.condition=i,this.delay=0,this.emission=e.emission,e.delay!==void 0&&(this.delay=e.delay),this.particleSystem=this.page.scene.find(this.data.emitterObjectId)}toggleEmitting(){this.particleSystem.started&&!this.particleSystem.stopped?this.stop(this.delay):this.start(this.delay)}toggleFroze(){this.particleSystem.started&&!this.particleSystem.isFrozen?this.freeze(this.delay):this.unFreeze(this.delay)}start(e=0){if(e){this.delayTimerId=window.setTimeout(()=>{this.start(0),this.clearDelay()},e);return}this.particleSystem.start()}stop(e=0){if(e){this.delayTimerId=window.setTimeout(()=>{this.stop(0),this.clearDelay()},e);return}this.particleSystem.stop()}freeze(e=0){if(e){this.delayTimerId=window.setTimeout(()=>{this.freeze(0),this.clearDelay()},e);return}this.particleSystem.froze()}unFreeze(e=0){if(e){this.delayTimerId=window.setTimeout(()=>{this.unFreeze(0),this.clearDelay()},e);return}this.particleSystem.unFroze()}reset(e=0){if(e){this.delayTimerId=window.setTimeout(()=>{this.reset(0),this.clearDelay()},e);return}this.particleSystem.reset()}reverseFromCurrent(){switch(this.emission){case"emitToggle":this.toggleEmitting();break;case"pauseToggle":this.toggleFroze();break}}dispatchBasic(){if(gi(this.shared,this.condition)===!1||!this.particleSystem)return!1;switch(this.emission){case"start":this.start(this.delay);break;case"emitToggle":this.toggleEmitting();break;case"pause":this.freeze(this.delay);break;case"pauseToggle":this.toggleFroze();break;case"stop":this.stop(this.delay);break;case"reset":this.reset(this.delay);break}}dispatchConditional(){if(gi(this.shared,this.condition)===!1||!this.particleSystem)return!1;switch(this.emission){case"start":this.start(this.delay);break;case"stop":this.stop(this.delay);break;case"reset":this.reset(this.delay);break}}dispatchGameControl(e){if(gi(this.shared,this.condition)===!1||!this.particleSystem)return!1;e==="start"?this.start(this.delay):this.stop(this.delay)}dispose(){!this.particleSystem||(this.particleSystem.reset(),this.clearDelay())}clearDelay(){this.delayTimerId&&(clearTimeout(this.delayTimerId),delete this.delayTimerId)}},eUe="text/plain",tUe="us-ascii",hF=(e,t)=>t.some(r=>r instanceof RegExp?r.test(e):r===e),rUe=(e,{stripHash:t})=>{let r=/^data:(?<type>[^,]*?),(?<data>[^#]*?)(?:#(?<hash>.*))?$/.exec(e);if(!r)throw new Error(`Invalid URL: ${e}`);let{type:i,data:n,hash:a}=r.groups,o=i.split(";");a=t?"":a;let s=!1;o[o.length-1]==="base64"&&(o.pop(),s=!0);let l=(o.shift()||"").toLowerCase(),c=[...o.map(u=>{let[d,h=""]=u.split("=").map(f=>f.trim());return d==="charset"&&(h=h.toLowerCase(),h===tUe)?"":`${d}${h?`=${h}`:""}`}).filter(Boolean)];return s&&c.push("base64"),(c.length>0||l&&l!==eUe)&&c.unshift(l),`data:${c.join(";")},${s?n.trim():n}${a?`#${a}`:""}`};function iUe(e,t){if(t={defaultProtocol:"http:",normalizeProtocol:!0,forceHttp:!1,forceHttps:!1,stripAuthentication:!0,stripHash:!1,stripTextFragment:!0,stripWWW:!0,removeQueryParameters:[/^utm_\w+/i],removeTrailingSlash:!0,removeSingleSlash:!0,removeDirectoryIndex:!1,sortQueryParameters:!0,...t},e=e.trim(),/^data:/i.test(e))return rUe(e,t);if(/^view-source:/i.test(e))throw new Error("`view-source:` is not supported as it is a non-standard protocol");let r=e.startsWith("//");!r&&/^\.*\//.test(e)||(e=e.replace(/^(?!(?:\w+:)?\/\/)|^\/\//,t.defaultProtocol));let i=new URL(e);if(t.forceHttp&&t.forceHttps)throw new Error("The `forceHttp` and `forceHttps` options cannot be used together");if(t.forceHttp&&i.protocol==="https:"&&(i.protocol="http:"),t.forceHttps&&i.protocol==="http:"&&(i.protocol="https:"),t.stripAuthentication&&(i.username="",i.password=""),t.stripHash?i.hash="":t.stripTextFragment&&(i.hash=i.hash.replace(/#?:~:text.*?$/i,"")),i.pathname){let a=/\b[a-z][a-z\d+\-.]{1,50}:\/\//g,o=0,s="";for(;;){let c=a.exec(i.pathname);if(!c)break;let u=c[0],d=c.index,h=i.pathname.slice(o,d);s+=h.replace(/\/{2,}/g,"/"),s+=u,o=d+u.length}let l=i.pathname.slice(o,i.pathname.length);s+=l.replace(/\/{2,}/g,"/"),i.pathname=s}if(i.pathname)try{i.pathname=decodeURI(i.pathname)}catch{}if(t.removeDirectoryIndex===!0&&(t.removeDirectoryIndex=[/^index\.[a-z]+$/]),Array.isArray(t.removeDirectoryIndex)&&t.removeDirectoryIndex.length>0){let a=i.pathname.split("/"),o=a[a.length-1];hF(o,t.removeDirectoryIndex)&&(a=a.slice(0,-1),i.pathname=a.slice(1).join("/")+"/")}if(i.hostname&&(i.hostname=i.hostname.replace(/\.$/,""),t.stripWWW&&/^www\.(?!www\.)[a-z\-\d]{1,63}\.[a-z.\-\d]{2,63}$/.test(i.hostname)&&(i.hostname=i.hostname.replace(/^www\./,""))),Array.isArray(t.removeQueryParameters))for(let a of[...i.searchParams.keys()])hF(a,t.removeQueryParameters)&&i.searchParams.delete(a);if(t.removeQueryParameters===!0&&(i.search=""),t.sortQueryParameters){i.searchParams.sort();try{i.search=decodeURIComponent(i.search)}catch{}}t.removeTrailingSlash&&(i.pathname=i.pathname.replace(/\/$/,""));let n=e;return e=i.toString(),!t.removeSingleSlash&&i.pathname==="/"&&!n.endsWith("/")&&i.hash===""&&(e=e.replace(/\/$/,"")),(t.removeTrailingSlash||i.pathname==="/")&&i.hash===""&&t.removeSingleSlash&&(e=e.replace(/\/$/,"")),r&&!t.normalizeProtocol&&(e=e.replace(/^http:\/\//,"//")),t.stripProtocol&&(e=e.replace(/^(?:https?:)?\/\//,"")),e}var nUe=class{constructor({url:e,context:t},r,i,n){if(this.controlsManager=r,this.shared=i,this.condition=n,!e)throw new Error("Missing property");this.url=e.startsWith("mailto:")?e:iUe(e,{removeTrailingSlash:!1,removeSingleSlash:!1,stripWWW:!1}),this.context=t??"tab"}dispatch(){var e;if(gi(this.shared,this.condition)===!1)return!1;S0?window.location.assign(this.url):(this.context==="tab"||wH&&this.context==="none"?window.open(this.url,"_blank"):this.context==="window"?window.open(this.url,"_blank",`width=${window.innerWidth}, height=${window.innerHeight}`):window.open(this.url,"_parent"),(e=this.controlsManager.orbitControls)==null||e.onPointerUp(Wt[0]),YOe())}},n7=class{constructor(e,t,r,i,n){this.data=e,this.page=t,this.controlsManager=r,this.shared=i,this.condition=n,this.timeoutIdQueue=[],this.dispatchInner=()=>{this.objects.forEach(this.destroyCallback)},this.destroyCallback=a=>{var c,u;this.timeoutIdQueue.shift();let o=this.page.scene.find(a);if(o===void 0)return;let s=this.controlsManager.sharedGameControlGlobals.rapierWorld,l=s?(c=o.dataPatched.physics)==null?void 0:c.fusedBody:!0;if(o.cloner){for(let d of o.cloner.children)l?(d.playModeVisible=!1,d.rigidBody&&((u=o.dataPatched.physics)==null?void 0:u.rigidBody)==="positioned"&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(d.rigidBody.collider(0).handle),s.removeRigidBody(d.rigidBody),d.rigidBody=void 0),d.bvhGeometry&&(d.bvhGeometry=void 0)):this.clone===void 0||this.clone===d?(d.playModeVisible=!1,d.rigidBody&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(d.rigidBody.collider(0).handle),s.removeRigidBody(d.rigidBody),d.rigidBody=void 0)):d.playModeVisible===void 0&&(d.playModeVisible=!0);(l||this.clone===void 0||this.clone===!1)&&(o.visible=!1,o.rigidBody&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(o.rigidBody.collider(0).handle),s.removeRigidBody(o.rigidBody),o.rigidBody=void 0),o.bvhGeometry&&(o.bvhGeometry=void 0))}else o.rigidBody&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(o.rigidBody.collider(0).handle),s.removeRigidBody(o.rigidBody),o.rigidBody=void 0),o.bvhGeometry&&(o.bvhGeometry=void 0),o.visible=!1;s===void 0?this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim=this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.filter(d=>d.bvhGeometry!==void 0):this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim=this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.filter(d=>d.rigidBody!==void 0),o.destroyedInAction=!0,this.controlsManager.requestRender()},this.objects=[...e.objects]}dispatch(e){if(gi(this.shared,this.condition)===!1)return!1;this.clone=e,this.data.delay?this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3)):this.dispatchInner()}dispatchFromStart(){if(gi(this.shared,this.condition)===!1)return!1;this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3))}dispose(){this.timeoutIdQueue.forEach(e=>window.clearTimeout(e))}},a7=class{constructor(e,t,r,i,n){this.data=e,this.page=t,this.shared=r,this.eventManager=i,this.condition=n,this.shared=r}dispatch(){if(gi(this.shared,this.condition)===!1)return!1;clearTimeout(this.timeoutId),delete this.timeoutId,this.timeoutId=window.setTimeout(()=>{var e;this.shared.reset(this.shared.data,!0),x3(this.page,this.shared,!0),this.eventManager.reset(),(e=this.eventManager.controlsManager.gameControl)==null||e.reset(!0),this.page.switchToPlayCamera(),this.eventManager.controlsManager.requestRender(),delete this.timeoutId},(this.data.delay??0)*1e3)}dispose(){clearTimeout(this.timeoutId),delete this.timeoutId}},o7={update:null,begin:null,loopBegin:null,changeBegin:null,change:null,changeComplete:null,timelineChangeComplete:null,loopComplete:null,complete:null,loop:1,direction:"normal",autoplay:!0,timelineOffset:0,rewind:!0},u3={duration:1e3,delay:0,endDelay:0,startOnceDelay:0,pingPongDelayCorrection:0,pingPongEndDelayCorrection:0,easing:"easeOutElastic(1, .5)",round:0},aUe=["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective","matrix","matrix3d"],k1={CSS:{},springs:{}};function hs(e,t,r){return Math.min(Math.max(e,t),r)}function Jv(e,t){return e.indexOf(t)>-1}function Y_(e,t){return e.apply(null,t)}var $t={arr:function(e){return Array.isArray(e)},obj:function(e){return Jv(Object.prototype.toString.call(e),"Object")},pth:function(e){return $t.obj(e)&&e.hasOwnProperty("totalLength")},svg:function(e){return e instanceof SVGElement},inp:function(e){return e instanceof HTMLInputElement},dom:function(e){return!("isNode"in e)&&(e.nodeType||$t.svg(e))},str:function(e){return typeof e=="string"},fnc:function(e){return typeof e=="function"},und:function(e){return typeof e>"u"},hex:function(e){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(e)},rgb:function(e){return/^rgb/.test(e)},hsl:function(e){return/^hsl/.test(e)},col:function(e){return $t.hex(e)||$t.rgb(e)||$t.hsl(e)},key:function(e){return!o7.hasOwnProperty(e)&&!u3.hasOwnProperty(e)&&e!=="targets"&&e!=="keyframes"}};function s7(e){var t=/\(([^)]+)\)/.exec(e);return t?t[1].split(",").map(function(r){return parseFloat(r)}):[]}function l7(e,t){var r=s7(e),i=hs($t.und(r[0])?1:r[0],.1,100),n=hs($t.und(r[1])?100:r[1],.1,100),a=hs($t.und(r[2])?10:r[2],.1,100),o=hs($t.und(r[3])?0:r[3],.1,100),s=Math.sqrt(n/i),l=a/(2*Math.sqrt(n*i)),c=l<1?s*Math.sqrt(1-l*l):0,u=1,d=l<1?(l*s+-o)/c:-o+s;function h(p){var v=t?t*p/1e3:p;return l<1?v=Math.exp(-v*l*s)*(u*Math.cos(c*v)+d*Math.sin(c*v)):v=(u+d*v)*Math.exp(-v*s),p===0||p===1?p:1-v}function f(){var p=k1.springs[e];if(p)return p;for(var v=1/6,m=0,g=0;;)if(m+=v,h(m)===1){if(g++,g>=16)break}else g=0;var y=m*v*1e3;return k1.springs[e]=y,y}return t?h:f}function oUe(e){return e===void 0&&(e=10),function(t){return Math.ceil(hs(t,1e-6,1)*e)*(1/e)}}var sUe=function(){var e=11,t=1/(e-1);function r(u,d){return 1-3*d+3*u}function i(u,d){return 3*d-6*u}function n(u){return 3*u}function a(u,d,h){return((r(d,h)*u+i(d,h))*u+n(d))*u}function o(u,d,h){return 3*r(d,h)*u*u+2*i(d,h)*u+n(d)}function s(u,d,h,f,p){var v,m,g=0;do m=d+(h-d)/2,v=a(m,f,p)-u,v>0?h=m:d=m;while(Math.abs(v)>1e-7&&++g<10);return m}function l(u,d,h,f){for(var p=0;p<4;++p){var v=o(d,h,f);if(v===0)return d;var m=a(d,h,f)-u;d-=m/v}return d}function c(u,d,h,f){if(!(0<=u&&u<=1&&0<=h&&h<=1))return;var p=new Float32Array(e);if(u!==d||h!==f)for(var v=0;v<e;++v)p[v]=a(v*t,u,h);function m(g){for(var y=0,b=1,x=e-1;b!==x&&p[b]<=g;++b)y+=t;--b;var S=(g-p[b])/(p[b+1]-p[b]),w=y+S*t,_=o(w,u,h);return _>=.001?l(g,w,u,h):_===0?w:s(g,y,y+t,u,h)}return function(g){return u===d&&h===f||g===0||g===1?g:a(m(g),d,f)}}return c}(),c7=function(){var e={linear:function(){return function(i){return i}}},t={Sine:function(){return function(i){return 1-Math.cos(i*Math.PI/2)}},Circ:function(){return function(i){return 1-Math.sqrt(1-i*i)}},Back:function(){return function(i){return i*i*(3*i-2)}},Bounce:function(){return function(i){for(var n,a=4;i<((n=Math.pow(2,--a))-1)/11;);return 1/Math.pow(4,3-a)-7.5625*Math.pow((n*3-2)/22-i,2)}},Elastic:function(i,n){i===void 0&&(i=1),n===void 0&&(n=.5);var a=hs(i,1,10),o=hs(n,.1,2);return function(s){return s===0||s===1?s:-a*Math.pow(2,10*(s-1))*Math.sin((s-1-o/(Math.PI*2)*Math.asin(1/a))*(Math.PI*2)/o)}}},r=["Quad","Cubic","Quart","Quint","Expo"];return r.forEach(function(i,n){t[i]=function(){return function(a){return Math.pow(a,n+2)}}}),Object.keys(t).forEach(function(i){var n=t[i];e["easeIn"+i]=n,e["easeOut"+i]=function(a,o){return function(s){return 1-n(a,o)(1-s)}},e["easeInOut"+i]=function(a,o){return function(s){return s<.5?n(a,o)(s*2)/2:1-n(a,o)(s*-2+2)/2}}}),e}();function d3(e,t){if($t.fnc(e))return e;var r=e.split("(")[0],i=c7[r],n=s7(e);switch(r){case"spring":return l7(e,t);case"cubicBezier":return Y_(sUe,n);case"steps":return Y_(oUe,n);default:return Y_(i,n)}}function u7(e){try{var t=document.querySelectorAll(e);return t}catch{return}}function Kw(e,t){for(var r=e.length,i=arguments.length>=2?arguments[1]:void 0,n=[],a=0;a<r;a++)if(a in e){var o=e[a];t.call(i,o,a,e)&&n.push(o)}return n}function Qw(e){return e.reduce(function(t,r){return t.concat($t.arr(r)?Qw(r):r)},[])}function fF(e){return $t.arr(e)?e:($t.str(e)&&(e=u7(e)||e),e instanceof NodeList||e instanceof HTMLCollection?[].slice.call(e):[e])}function h3(e,t){return e.some(function(r){return r===t})}function f3(e){var t={};for(var r in e)t[r]=e[r];return t}function iT(e,t){var r=f3(e);for(var i in e)r[i]=t.hasOwnProperty(i)?t[i]:e[i];return r}function Zw(e,t){var r=f3(e);for(var i in t)r[i]=$t.und(e[i])?t[i]:e[i];return r}function lUe(e){var t=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g.exec(e);return t?"rgba("+t[1]+",1)":e}function cUe(e){var t=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,r=e.replace(t,function(s,l,c,u){return l+l+c+c+u+u}),i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(r),n=parseInt(i[1],16),a=parseInt(i[2],16),o=parseInt(i[3],16);return"rgba("+n+","+a+","+o+",1)"}function uUe(e){var t=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(e)||/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g.exec(e),r=parseInt(t[1],10)/360,i=parseInt(t[2],10)/100,n=parseInt(t[3],10)/100,a=t[4]||1;function o(h,f,p){return p<0&&(p+=1),p>1&&(p-=1),p<1/6?h+(f-h)*6*p:p<1/2?f:p<2/3?h+(f-h)*(2/3-p)*6:h}var s,l,c;if(i==0)s=l=c=n;else{var u=n<.5?n*(1+i):n+i-n*i,d=2*n-u;s=o(d,u,r+1/3),l=o(d,u,r),c=o(d,u,r-1/3)}return"rgba("+s*255+","+l*255+","+c*255+","+a+")"}function dUe(e){if($t.rgb(e))return lUe(e);if($t.hex(e))return cUe(e);if($t.hsl(e))return uUe(e)}function sc(e){var t=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/.exec(e);if(t)return t[1]}function hUe(e){if(Jv(e,"translate")||e==="perspective")return"px";if(Jv(e,"rotate")||Jv(e,"skew"))return"deg"}function nT(e,t){return $t.fnc(e)?e(t.target,t.id,t.total):e}function rl(e,t){return e.getAttribute(t)}function p3(e,t,r){var i=sc(t);if(h3([r,"deg","rad","turn"],i))return t;var n=k1.CSS[t+r];if(!$t.und(n))return n;var a=100,o=document.createElement(e.tagName),s=e.parentNode&&e.parentNode!==document?e.parentNode:document.body;s.appendChild(o),o.style.position="absolute",o.style.width=a+r;var l=a/o.offsetWidth;s.removeChild(o);var c=l*parseFloat(t);return k1.CSS[t+r]=c,c}function d7(e,t,r){if(t in e.style){var i=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),n=e.style[t]||getComputedStyle(e).getPropertyValue(i)||"0";return r?p3(e,n,r):n}}function m3(e,t){if($t.dom(e)&&!$t.inp(e)&&(rl(e,t)||$t.svg(e)&&e[t]))return"attribute";if($t.dom(e)&&h3(aUe,t))return"transform";if($t.dom(e)&&t!=="transform"&&d7(e,t))return"css";if(e[t]!=null)return"object"}function h7(e){if($t.dom(e)){for(var t=e.style.transform||"",r=/(\w+)\(([^)]*)\)/g,i=new Map,n;n=r.exec(t);)i.set(n[1],n[2]);return i}}function fUe(e,t,r,i){var n=Jv(t,"scale")?1:0+hUe(t),a=h7(e).get(t)||n;return r&&(r.transforms.list.set(t,a),r.transforms.last=t),i?p3(e,a,i):a}function v3(e,t,r,i){switch(m3(e,t)){case"transform":return fUe(e,t,i,r);case"css":return d7(e,t,r);case"attribute":return rl(e,t);default:return e[t]||0}}function g3(e,t){var r=/^(\*=|\+=|-=)/.exec(e);if(!r)return e;var i=sc(e)||0,n=parseFloat(t),a=parseFloat(e.replace(r[0],""));switch(r[0][0]){case"+":return n+a+i;case"-":return n-a+i;case"*":return n*a+i}}function f7(e,t){if($t.col(e))return dUe(e);if(/\s/g.test(e))return e;var r=sc(e),i=r?e.substr(0,e.length-r.length):e;return t?i+t:i}function y3(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function pUe(e){return Math.PI*2*rl(e,"r")}function mUe(e){return rl(e,"width")*2+rl(e,"height")*2}function vUe(e){return y3({x:rl(e,"x1"),y:rl(e,"y1")},{x:rl(e,"x2"),y:rl(e,"y2")})}function p7(e){for(var t=e.points,r=0,i,n=0;n<t.numberOfItems;n++){var a=t.getItem(n);n>0&&(r+=y3(i,a)),i=a}return r}function gUe(e){var t=e.points;return p7(e)+y3(t.getItem(t.numberOfItems-1),t.getItem(0))}function m7(e){if(e.getTotalLength)return e.getTotalLength();switch(e.tagName.toLowerCase()){case"circle":return pUe(e);case"rect":return mUe(e);case"line":return vUe(e);case"polyline":return p7(e);case"polygon":return gUe(e)}}function yUe(e){var t=m7(e);return e.setAttribute("stroke-dasharray",t),t}function bUe(e){for(var t=e.parentNode;$t.svg(t)&&$t.svg(t.parentNode);)t=t.parentNode;return t}function v7(e,t){var r=t||{},i=r.el||bUe(e),n=i.getBoundingClientRect(),a=rl(i,"viewBox"),o=n.width,s=n.height,l=r.viewBox||(a?a.split(" "):[0,0,o,s]);return{el:i,viewBox:l,x:l[0]/1,y:l[1]/1,w:o/l[2],h:s/l[3]}}function xUe(e,t){var r=$t.str(e)?u7(e)[0]:e,i=t||100;return function(n){return{property:n,el:r,svg:v7(r),totalLength:m7(r)*(i/100)}}}function wUe(e,t){function r(s){s===void 0&&(s=0);var l=t+s>=1?t+s:0;return e.el.getPointAtLength(l)}var i=v7(e.el,e.svg),n=r(),a=r(-1),o=r(1);switch(e.property){case"x":return(n.x-i.x)*i.w;case"y":return(n.y-i.y)*i.h;case"angle":return Math.atan2(o.y-a.y,o.x-a.x)*180/Math.PI}}function pF(e,t){var r=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?/g,i=f7($t.pth(e)?e.totalLength:e,t)+"";return{original:i,numbers:i.match(r)?i.match(r).map(Number):[0],strings:$t.str(e)||t?i.split(r):[]}}function g7(e){var t=e?Qw($t.arr(e)?e.map(fF):fF(e)):[];return Kw(t,function(r,i,n){return n.indexOf(r)===i})}function y7(e){var t=g7(e);return t.map(function(r,i){return{target:r,id:i,total:t.length,transforms:{list:h7(r)}}})}function SUe(e,t){var r=f3(t);if(/^spring/.test(r.easing)&&(r.duration=l7(r.easing)),$t.arr(e)){var i=e.length,n=i===2&&!$t.obj(e[0]);n?e={value:e}:$t.fnc(t.duration)||(r.duration=t.duration/i)}var a=$t.arr(e)?e:[e];return a.map(function(o,s){var l=$t.obj(o)&&!$t.pth(o)?o:{value:o};return $t.und(l.delay)&&(l.delay=s?0:t.delay),$t.und(l.endDelay)&&(l.endDelay=s===a.length-1?t.endDelay:0),l}).map(function(o){return Zw(o,r)})}function CUe(e){for(var t=Kw(Qw(e.map(function(a){return Object.keys(a)})),function(a){return $t.key(a)}).reduce(function(a,o){return a.indexOf(o)<0&&a.push(o),a},[]),r={},i=function(a){var o=t[a];r[o]=e.map(function(s){var l={};for(var c in s)$t.key(c)?c==o&&(l.value=s[c]):l[c]=s[c];return l})},n=0;n<t.length;n++)i(n);return r}function _Ue(e,t){var r=[],i=t.keyframes;i&&(t=Zw(CUe(i),t));for(var n in t)$t.key(n)&&r.push({name:n,tweens:SUe(t[n],e)});return r}function AUe(e,t){var r={};for(var i in e){var n=nT(e[i],t);$t.arr(n)&&(n=n.map(function(a){return nT(a,t)}),n.length===1&&(n=n[0])),r[i]=n}return r.duration=parseFloat(r.duration),r.delay=parseFloat(r.delay),r}function MUe(e,t){var r;return e.tweens.map(function(i){var n=AUe(i,t),a=n.value,o=$t.arr(a)?a[1]:a,s=sc(o),l=v3(t.target,e.name,s,t),c=r?r.to.original:l,u=$t.arr(a)?a[0]:c,d=sc(u)||sc(l),h=s||d;return $t.und(o)&&(o=c),n.from=pF(u,h),n.to=pF(g3(o,u),h),n.start=r?r.end:0,n.end=n.start+n.delay+n.duration+n.endDelay,n.easing=d3(n.easing,n.duration),n.isPath=$t.pth(a),n.isColor=$t.col(n.from.original),n.isColor&&(n.round=1),r=n,n})}var b7={css:function(e,t,r){return e.style[t]=r},attribute:function(e,t,r){return e.setAttribute(t,r)},object:function(e,t,r){return e[t]=r},transform:function(e,t,r,i,n){if(i.list.set(t,r),t===i.last||n){var a="";i.list.forEach(function(o,s){a+=s+"("+o+") "}),e.style.transform=a}}};function x7(e,t){var r=y7(e);r.forEach(function(i){for(var n in t){var a=nT(t[n],i),o=i.target,s=sc(a),l=v3(o,n,s,i),c=s||sc(l),u=g3(f7(a,c),l),d=m3(o,n);b7[d](o,n,u,i.transforms,!0)}})}function EUe(e,t){var r=m3(e.target,t.name);if(r){var i=MUe(t,e),n=i[i.length-1];return{type:r,property:t.name,animatable:e,tweens:i,duration:n.end,delay:i[0].delay,endDelay:n.endDelay}}}function TUe(e,t){return Kw(Qw(e.map(function(r){return t.map(function(i){return EUe(r,i)})})),function(r){return!$t.und(r)})}function w7(e,t){var r=e.length,i=function(a){return a.timelineOffset?a.timelineOffset:0},n={};return n.duration=r?Math.max.apply(Math,e.map(function(a){let o=a.startOnceDelay??0,s=a.pingPongDelayCorrection??0,l=a.pingPongEndDelayCorrection??0;return i(a)+o+s+l+a.duration*(a.loop??1)})):t.duration,n.delay=r?Math.min.apply(Math,e.map(function(a){let o=a.startOnceDelay??0,s=a.pingPongDelayCorrection??0;return i(a)+o+s+a.delay})):t.delay,n.endDelay=r?n.duration-Math.max.apply(Math,e.map(function(a){let o=a.startOnceDelay??0,s=a.pingPongDelayCorrection??0,l=a.pingPongEndDelayCorrection??0;return i(a)+o+s+a.duration*(a.loop??1)-a.endDelay-l})):t.endDelay,n}var mF=0;function PUe(e){var t=iT(o7,e),r=iT(u3,e),i=_Ue(r,e),n=y7(e.targets),a=TUe(n,i),o=w7(a,r),s=mF;return mF++,Zw(t,{id:s,children:[],animatables:n,animations:a,duration:o.duration,delay:o.delay,endDelay:o.endDelay,startOnceDelay:r.startOnceDelay,pingPongDelayCorrection:r.pingPongDelayCorrection,pingPongEndDelayCorrection:r.pingPongEndDelayCorrection})}var Vo=[],vF=[],Jb,DUe=function(){function e(){Jb=requestAnimationFrame(t)}function t(r){var i=Vo.length;if(i){for(var n=0;n<i;){var a=Vo[n];a.paused?(Vo.splice(n,1),i-=1):(a.tick(r),n++)}e()}else Jb=cancelAnimationFrame(Jb)}return e}();function OUe(e){document.hidden?(Vo.forEach(function(t){return t.pause(e.timeStamp)}),vF=Vo.slice(0),Xi.running=Vo=[]):vF.forEach(function(t){return t.play(e.timeStamp)})}typeof document<"u"&&document.addEventListener("visibilitychange",OUe);function Xi(e){e===void 0&&(e={});var t=0,r=0,i=0,n,a,o=0,s=null;function l(w){var _=window.Promise&&new Promise(function(C){return s=C});return w.finished=_,_}var c=PUe(e);l(c);function u(){var w=c.direction;w!=="alternate"&&(c.direction=w!=="normal"?"normal":"reverse"),c.reversed=!c.reversed,a.forEach(function(_){(_.loop===1||_.loop%2===0)&&(_.reversed=c.reversed)})}function d(){c.direction="normal",c.reversed=!1,a.forEach(function(w){return w.reversed=!1})}function h(w){return c.reversed?c.duration-w:w}function f(){t=0,r=h(c.currentTime)*(1/Xi.speed)}function p(w,_,C=!1){_&&(c.reversed?_.seek(_.duration*_.loop-(w-_.timelineOffset-_.pingPongDelayCorrection),C):_.seek(w-_.timelineOffset-_.startOnceDelay-_.pingPongDelayCorrection,C))}function v(w,_=!1){if(c.reversed)for(var C=o;C--;)p(w,a[C],_);else for(var A=0;A<o;A++)p(w,a[A],_)}function m(w){var Q,ne,V,ue,ve,Ce,G,Z,de,Se;var _=0,C=c.animations,A=C.length;for(c.direction!=="alternate"&&((Q=c.parent)==null?void 0:Q.direction)==="alternate"?((ne=c.parent)==null?void 0:ne.rewind)===!1&&c.reversePlayback===!0&&c.rewind===!1&&((V=c.parent)!=null&&V.reversed&&c.direction==="alternate"?w=c.duration-c.delay+c.endDelay-w:w=c.duration+c.delay-c.endDelay-w):x(!1,(ue=c.parent)==null?void 0:ue.rewind,c.rewind,(ve=c.parent)==null?void 0:ve.reversePlayback,c.reversePlayback)&&((Ce=c.parent)!=null&&Ce.reversed&&c.direction==="alternate"?w=c.duration-c.delay+c.endDelay-w:w=c.duration+c.delay-c.endDelay-w);_<A;){var M=C[_],P=M.animatable,T=M.tweens,R=T.length-1,z=T[R];R&&(z=Kw(T,function(_e){return w<_e.end})[0]||z);let we;(G=c.parent)!=null&&G.reversed&&c.direction==="alternate"?we=hs(w-z.start-z.endDelay,0,z.duration)/z.duration:we=hs(w-z.start-z.delay,0,z.duration)/z.duration;for(var F=isNaN(we)?1:z.easing(we),H=z.to.strings,N=z.round,U=[],ie=z.to.numbers.length,te=void 0,X=0;X<ie;X++){var W=void 0;let _e,Ee;c.direction!=="alternate"?((Z=c.parent)==null?void 0:Z.rewind)===!1&&c.reversePlayback===!0&&c.rewind===!1?(_e=z.to.numbers[X],Ee=z.from.numbers[X]||0):(Ee=z.to.numbers[X],_e=z.from.numbers[X]||0):x(!0,(de=c.parent)==null?void 0:de.rewind,c.rewind,(Se=c.parent)==null?void 0:Se.reversePlayback,c.reversePlayback)?(_e=z.to.numbers[X],Ee=z.from.numbers[X]||0):(Ee=z.to.numbers[X],_e=z.from.numbers[X]||0),z.isPath?W=wUe(z.value,F*Ee):W=_e+F*(Ee-_e),N&&(z.isColor&&X>2||(W=Math.round(W*N)/N)),U.push(W)}var q=H.length;if(!q)te=U[0];else{te=H[0];for(var $=0;$<q;$++){H[$];var le=H[$+1],ee=U[$];isNaN(ee)||(le?te+=ee+le:te+=ee+" ")}}b7[M.type](P.target,M.property,te,P.transforms),M.currentValue=te,_++}}function g(w){c[w]&&!c.passThrough&&c[w](c)}function y(){c.remaining&&c.remaining!==!0&&c.remaining--}let b={0:!1,1:!0,2:!1,3:!0,4:!1,5:!1,6:!1,7:!1,8:!1,9:!0,10:!0,11:!1,12:!1,13:!1,14:!0,15:!0,16:!1,17:!0,18:!0,19:!1,20:!1,21:!1,22:!0,23:!0,24:!1,25:!0,26:!1,27:!0,28:!1,29:!1,30:!1,31:!1};function x(w,_,C,A,M){return b[w<<4|_<<3|C<<2|A<<1|M]}function S(w,_=!1){var T;var C=c.duration;let A=c.delay,M=C-c.endDelay;(T=c.parent)!=null&&T.reversed&&c.direction==="alternate"&&(A=c.endDelay,M=C-c.delay);var P=h(w);if(c.progress=hs(P/C*100,0,100),_||(c.reversePlayback=P<c.currentTime),o&&v(P,_),!c.began&&c.currentTime>=0&&(c.began=!0,g("begin")),!c.loopBegan&&c.currentTime>0&&(c.loopBegan=!0,g("loopBegin")),(c.reversed||P>=0)&&P<=A&&c.currentTime!==0&&(m(0),g("change")),(P>=M&&c.currentTime!==C+c.pingPongDelayCorrection||!C)&&(m(C),g("change")),P>A&&P<M?(c.changeBegan||(c.changeBegan=!0,c.changeCompleted=!1,g("changeBegin")),m(P),g("change")):c.changeBegan?(c.changeCompleted=!0,c.changeBegan=!1,g("change"),o&&g("timelineChangeComplete")):c.began&&P>M&&g("changeComplete"),c.currentTime=hs(P,0,C+c.pingPongDelayCorrection),c.began&&g("update"),w>=C)if(y(),!c.remaining)c.paused=!0,c.completed||(c.completed=!0,g("loopComplete"),g("complete"),!c.passThrough&&"Promise"in window&&(s(),l(c)));else{o?t+=c.duration/Xi.speed:t+=c.duration;for(let R of a)R.setStartTime(0),R.remaining=R.loop;g("loopComplete"),c.loopBegan=!1,c.direction==="alternate"?u():o&&d()}}return c.reset=function(){var w=c.direction;c.passThrough=!1,c.currentTime=0,c.progress=0,c.paused=!0,c.began=!1,c.loopBegan=!1,c.changeBegan=!1,c.completed=!1,c.changeCompleted=!1,c.reversePlayback=!1,c.reversed=w==="reverse",c.remaining=c.loop,a=c.children,o=a.length;for(var _=o;_--;)c.children[_].reset();m(c.reversed?c.duration:0)},c.setStartTime=function(w){t=w},c.set=function(w,_){return x7(w,_),c},c.tick=function(w){i=w,t||(t=i),S((i+(r-t))*Xi.speed)},c.seek=function(w,_=!1){S(w-t,_)},c.pause=function(w){c.paused=!0,o&&(n=w??performance.now())},c.play=function(w){!c.paused||(c.completed&&c.reset(),c.paused=!1,Vo.push(c),o&&n!==void 0&&(t+=(w??performance.now())-n),Jb||DUe())},c.reverse=function(){u(),c.completed=!c.reversed,f()},c.restart=function(){c.reset(),c.play()},c.reset(),c.autoplay&&c.play(),c}function gF(e,t){for(var r=t.length;r--;)h3(e,t[r].animatable.target)&&t.splice(r,1)}function RUe(e){for(var t=g7(e),r=Vo.length;r--;){var i=Vo[r],n=i.animations,a=i.children;gF(t,n);for(var o=a.length;o--;){var s=a[o],l=s.animations;gF(t,l),!l.length&&!s.children.length&&a.splice(o,1)}!n.length&&!a.length&&i.pause()}}function IUe(e,t){t===void 0&&(t={});var r=t.direction||"normal",i=t.easing?d3(t.easing):null,n=t.grid,a=t.axis,o=t.from||0,s=o==="first",l=o==="center",c=o==="last",u=$t.arr(e),d=parseFloat(u?e[0]:e),h=u?parseFloat(e[1]):0,f=sc(u?e[1]:e)||0,p=t.start||0+(u?d:0),v=[],m=0;return function(g,y,b){if(s&&(o=0),l&&(o=(b-1)/2),c&&(o=b-1),!v.length){for(var x=0;x<b;x++){if(!n)v.push(Math.abs(o-x));else{var S=l?(n[0]-1)/2:o%n[0],w=l?(n[1]-1)/2:Math.floor(o/n[0]),_=x%n[0],C=Math.floor(x/n[0]),A=S-_,M=w-C,P=Math.sqrt(A*A+M*M);a==="x"&&(P=-A),a==="y"&&(P=-M),v.push(P)}m=Math.max.apply(Math,v)}i&&(v=v.map(function(R){return i(R/m)*m})),r==="reverse"&&(v=v.map(function(R){return a?R<0?R*-1:-R:Math.abs(m-R)}))}var T=u?(h-d)/m:d;return p+T*(Math.round(v[y]*100)/100)+f}}function zUe(e){e===void 0&&(e={});var t=Xi(e);return t.duration=0,t.add=function(r,i){var n=Vo.indexOf(t),a=t.children;n>-1&&Vo.splice(n,1);function o(h){h.passThrough=!0}for(var s=0;s<a.length;s++)o(a[s]);var l=Zw(r,iT(u3,e));l.targets=l.targets||e.targets;var c=t.duration;l.autoplay=!1,l.timelineOffset=$t.und(i)?c:g3(i,c),o(t);var u=Xi(l);o(u),a.push(u),u.parent=t;var d=w7(a,e);return t.delay=d.delay,t.endDelay=d.endDelay,t.duration=d.duration,u.loop===!0&&(t.duration=1/0),t.seek(0),t.reset(),t.autoplay&&t.play(),t},t}Xi.version="3.2.0";Xi.speed=1;Xi.running=Vo;Xi.remove=RUe;Xi.get=v3;Xi.set=x7;Xi.convertPx=p3;Xi.path=xUe;Xi.setDashoffset=yUe;Xi.stagger=IUe;Xi.timeline=zUe;Xi.easing=d3;Xi.penner=c7;Xi.random=function(e,t){return Math.floor(Math.random()*(t-e+1))+e};var S7=Xi,yF=new k,bF=new k,xF=new Kt;function kUe(e,t,r,i){if(i===0)return r.copy(e);if(i===1)return r.copy(t);let n=e.w*t.w+e.x*t.x+e.y*t.y+e.z*t.z;if(n>=1)return r.copy(e);let a=1-n*n;if(a<=Number.EPSILON){let u=1-i;return r.w=u*e.w+i*t.w,r.x=u*e.x+i*t.x,r.y=u*e.y+i*t.y,r.z=u*e.z+i*t.z,r.normalize(),r}let o=Math.sqrt(a),s=Math.atan2(o,n),l=Math.sin((1-i)*s)/o,c=Math.sin(i*s)/o;return r.w=e.w*l+t.w*c,r.x=e.x*l+t.x*c,r.y=e.y*l+t.y*c,r.z=e.z*l+t.z*c,r}function Jn(e,t,r,i,n,a){let o=r[e]!==void 0?r[e]:void 0,s=i[e];if(s==null)return;let l=o!=null?typeof o=="string"?Number(n.getVariable(o)??0):o:t[e],c=typeof s=="string"?Number(n.getVariable(s)??0):s;if(l!==c)return{update:u=>{let d=St.lerp(l,c,u);a?t[e]=Math.trunc(d):t[e]=d},start:()=>{t[e]=l},end:()=>{t[e]=c}}}function b3(e,t,r,i,n,a){let o=r[e]?r[e]:void 0,s=i[e];if(!s)return;let l=t[e],c=[...o??l].map(d=>typeof d=="string"?Number(n.getVariable(d)??0):d),u=[...s].map(d=>typeof d=="string"?Number(n.getVariable(d)??0):d);if(!(c.length!==u.length||yD(c,u)))return{update:d=>{c.forEach((h,f)=>{let p=St.lerp(h,u[f],d);t[e][f]=a?Math.trunc(p):p})},start:()=>{Object.assign(t[e],c)},end:()=>{Object.assign(t[e],u)}}}function L1(e,t,r){return t.forEach((i,n)=>{e.setComponent(n,typeof i=="string"?Number(r.getVariable(i)??0):i)}),e}function wF(e,t,r,i,n){let a=r[e]?r[e]:void 0,o=i[e];if(!o)return;let s=t[e],l=a?L1(new k,a,n):s.clone(),c=L1(new k,o,n);if(!l.equals(c))return{update:u=>{s.lerpVectors(l,c,u)},start:()=>{s.copy(l)},end:()=>{s.copy(c)}}}function SF(e,t,r){return t.forEach((i,n)=>{e.setComponent(n,typeof i=="string"?Number(r.getVariable(i)??0):i)}),e}function B1(e,t,r,i,n){let a=r[e]?r[e]:void 0,o=i[e];if(!o)return;let s=t[e],l=!(s instanceof ye),c=s instanceof ye?s:new ye().fromArray(s),u=a?SF(new ye,a,n):c.clone(),d=SF(new ye,o,n);if(!u.equals(d))return{update:h=>{c.lerpVectors(u,d,h),l&&(t[e]=c.toArray())},start:()=>{c.copy(u),l&&(t[e]=c.toArray())},end:()=>{c.copy(d),l&&(t[e]=c.toArray())}}}function LUe(e,t,r,i){let n=r[e]?r[e]:void 0,a=i[e];if(!a)return;let o=t[e],s=n?new it().fromArray(n):o.clone(),l=new k,c=new Kt,u=new k;s.decompose(l,c,u);let d=new it().fromArray(a),h=new k,f=new Kt,p=new k;if(d.decompose(h,f,p),!s.equals(d))return{update:v=>{xF.slerpQuaternions(c,f,v),yF.lerpVectors(l,h,v),bF.lerpVectors(u,p,v),o.compose(yF,xF,bF)},start:()=>{o.compose(l,c,u)},end:()=>{o.compose(h,f,p)}}}function BUe(e,t,r,i,n){let a=r[e]?r[e]:void 0,o=i[e];if(!o)return;let s=t[e],l=a?typeof a=="string"?n.getColor(a).clone():new Bt().setRGB(a.r,a.g,a.b):s.clone(),c=typeof o=="string"?n.getColor(o).clone():new Bt().setRGB(o.r,o.g,o.b);if(l.equals(c))return;let u=s.clone();return t[e]=u,{update:d=>{u.lerpColors(l,c,d)},start:()=>{u.copy(l)},end:()=>{u.copy(c)}}}function Cb(e,t,r,i,n){let a=r[e]?r[e]:void 0,o=i[e];if(!o)return;let s=t[e],l=new sa(s.r,s.g,s.b,s.a),c=a?typeof a=="string"?n.getColor(a).clone():new sa(a.r,a.g,a.b,a.a):l.clone(),u=typeof o=="string"?n.getColor(o).clone():new sa(o.r,o.g,o.b,o.a);if(!c.equals(u))return{update:d=>{l.lerpColors(c,u,d);let h=St.lerp(c.a,u.a,d);l.a=h,t[e]={r:l.r,g:l.g,b:l.b,a:l.a}},start:()=>{l.copy(c)},end:()=>{l.copy(u)}}}function Ju(e,t,r,i,n){if(typeof t[e]=="number")return Jn(e,t,r??{},i,n);if(Array.isArray(t[e]))return b3(e,t,r??{},i,n)}function FUe(e,t,r,i){var s,l,c,u;let n=[],a=e.cameraType==="OrthographicCamera"?(s=t.orthographic)==null?void 0:s.zoom:(l=t.perspective)==null?void 0:l.zoom,o=e.cameraType==="OrthographicCamera"?(c=r.orthographic)==null?void 0:c.zoom:(u=r.perspective)==null?void 0:u.zoom;if(o!==void 0){let d=a??e.zoom,h=o;d!==h&&n.push({update:f=>{e.zoom=St.lerp(d,h,f),e.updateProjectionMatrix()},start:()=>{e.zoom=d,e.updateProjectionMatrix()},end:()=>{e.zoom=h,e.updateProjectionMatrix()}})}if(r.targetOffset!==void 0){let d=Jn("targetOffset",e,t,r,i);d&&n.push(d)}return n}function NUe(e,t,r,i){if(r.scaleBaked===void 0)return;let n=(t.scaleBaked??e.data.geometry.scaleBaked).map(s=>typeof s=="string"?Number(i.getVariable(s)??0):s),a=r.scaleBaked.map(s=>typeof s=="string"?Number(i.getVariable(s)??0):s);if(th.isEqual(n,a))return;let o=[];return o.push({update:s=>{e.updateGeometryInteractions({scaleBaked:[St.lerp(n[0],a[0],s),St.lerp(n[1],a[1],s),St.lerp(n[2],a[2],s)]},i),e.invalidateDownstreamBooleanData(),e.refreshAttachedClonersInteractions()},start:()=>{e.updateGeometryInteractions({scaleBaked:n},i),e.invalidateDownstreamBooleanData(),e.refreshAttachedClonersInteractions()},end:()=>{e.updateGeometryInteractions({scaleBaked:a},i),e.invalidateDownstreamBooleanData(),e.refreshAttachedClonersInteractions()}}),o}function UUe(e,t,r,i){if(!r.extrusion)return;let n=e.extrusion,a=t.extrusion??{},o=r.extrusion,s=[];return nW.forEach(l=>{let c=Ju(l,n,a,o,i);c&&s.push(c)}),s}function jUe(e,t,r,i){let n=[];if(!("geometry"in r))return n;let a=e.geometry.userData.parameters,o="geometry"in t?t.geometry:{},s=r.geometry;if(e instanceof Yg){let l=NUe(e,o,s,i);l&&n.push(...l)}else{let l={};if(Object.assign(l,ac(a,KL)),KL.forEach(c=>{let u=Ju(c,l,o,s,i);u&&n.push(u)}),e instanceof i3){Object.assign(l,{extrusion:{...a.extrusion}});let c=UUe(l,o,s,i);c&&n.push(...c)}n.length&&n.push({update:c=>{e.updateGeometryInteractions(l,i),e.updateGeometryGroupsIfNeeded(),e.refreshAttachedClonersInteractions()},start:c=>{e.updateGeometryInteractions(l,i),e.updateGeometryGroupsIfNeeded(),e.refreshAttachedClonersInteractions()},end:c=>{e.updateGeometryInteractions(l,i),e.updateGeometryGroupsIfNeeded(),e.refreshAttachedClonersInteractions()}})}return n}function VUe(e,t,r,i){let n=[];if(r.intensity!==void 0){let a=Jn("intensity",e,t,r,i);a&&n.push(a)}if(r.color!==void 0){let a=BUe("color",e,t,r,i);a&&n.push(a)}return n}function HUe(e,t,r,i){let n=[];if(Array.isArray(e.material)){if(!("materials"in r&&r.materials))return n;let a="materials"in t&&t.materials?t.materials:[],o=r.materials;e.material.forEach((s,l)=>{if(!o[l])return;let c=a[l]??{},u=o[l];typeof c=="string"||typeof u=="string"||n.push(...CF(s,c,u,i))})}else{if(!("material"in r&&r.material))return n;let a="material"in t&&t.material?t.material:{},o=r.material;if(typeof a=="string"||typeof o=="string")return n;n.push(...CF(e.material,a,o,i))}return n}function CF(e,t,r,i){var o;let n=[],a=qf(r,i)||!!t.layers&&qf(t,i);n.push(ZUe(e,a));for(let s of e.layers){let l=(o=t.layers)==null?void 0:o.data(s.uuid),c=r.layers.data(s.uuid);if(!c||s.type!=="light"&&(!(s.visible??!0)||!(c.visible??!0)))continue;let u=s.getNames().filter(d=>!tW.some(h=>d.includes(h)));for(let d of u)try{let h=s.getValue(d),f;if(d==="colors")f=KUe(s,l,c,d);else if(Array.isArray(h))d==="steps"&&(f=XUe(s,l,c,d));else if(typeof h=="number")f=WUe(s,l,c,d,i);else{if(typeof h=="boolean")continue;h instanceof ye?f=GUe(s,l,c,d):h instanceof k?f=$Ue(s,l,c,d,i):h instanceof sa?f=YUe(s,l,c,d,i):h instanceof Bt?f=qUe(s,l,c,d,i):"isTexture"in h&&(f=QUe(s,l,c,d))}f&&(Array.isArray(f)?n.push(...f):n.push(f))}catch(h){console.error(`lerpMaterial: unexpected material layer for ${d}`,h)}}return n}function WUe(e,t,r,i,n){if(!e.hasValue(i)||!(i in r))return;let a=t?t[i]:e.getValue(i),o=r[i],s=typeof a=="string"?Number(n.getVariable(a)??0):a,l=typeof o=="string"?Number(n.getVariable(o)??0):o;if(s!==l)return{update:c=>{e.setValue(i,St.lerp(s,l,c))},start:()=>{e.setValue(i,s)},end:()=>{e.setValue(i,l)}}}function GUe(e,t,r,i){if(!e.hasValue(i)||!(i in r))return;let n=e.getValue(i),a=t?new ye().fromArray(t[i]):n.clone(),o=new ye().fromArray(r[i]);if(!a.equals(o))return{update:s=>{n.lerpVectors(a,o,s)},start:()=>{n.copy(a)},end:()=>{n.copy(o)}}}function $Ue(e,t,r,i,n){if(!e.hasValue(i)||!(i in r))return;let a=e.getValue(i),o=t?t[i]:void 0,s=r[i],l=o?L1(new k,o,n):a.clone(),c=L1(new k,s,n);if(!l.equals(c))return{update:u=>{a.lerpVectors(l,c,u)},start:()=>{a.copy(l)},end:()=>{a.copy(c)}}}function qUe(e,t,r,i,n){if(!e.hasValue(i)||!(i in r))return;let a=t?t[i]:void 0,o=r[i],s=e.getValue(i),l=a?typeof a=="string"?n.getColor(a).clone():new Bt().setRGB(a.r,a.g,a.b):s.clone(),c=typeof o=="string"?n.getColor(o).clone():new Bt().setRGB(o.r,o.g,o.b);if(l.equals(c))return;let u=s.clone();return{update:d=>{e.getValue(i)!==u&&e.setValue(i,u),u.lerpColors(l,c,d)},start:()=>{u.copy(l)},end:()=>{u.copy(c)}}}function YUe(e,t,r,i,n){if(!e.hasValue(i)||!(i in r))return;let a=t?t[i]:void 0,o=r[i],s=e.getValue(i),l=a?typeof a=="string"?n.getColor(a).clone():new Bt().setRGB(a.r,a.g,a.b):s.clone(),c=typeof o=="string"?n.getColor(o).clone():new sa(o.r,o.g,o.b,o.a);if(l.equals(c))return;let u=s.clone();return{update:d=>{e.getValue(i)!==u&&e.setValue(i,u),u.lerpColors(l,c,d)},start:()=>{u.copy(l)},end:()=>{u.copy(c)}}}function XUe(e,t,r,i="steps"){if(!e.hasValue(i)||!(i in r))return;let n=[],a=e.getValue(i),o=t?t[i]:a,s=r[i];return yD(o,s)||n.push({update:l=>{let c=[...a];for(let u=0;u<a.length;++u){let d=o[u],h=s[u];c[u]=St.lerp(d,h,l)}e.setValue(i,c)},start:()=>{e.setValue(i,o)},end:()=>{e.setValue(i,s)}}),n.length?n:void 0}function KUe(e,t,r,i="colors"){if(!e.hasValue(i)||!(i in r))return;let n=[],a=e.getValue(i),o=t?t[i]:a.map(l=>l.toArray()),s=r[i];for(let l=0;l<a.length;++l){let c=[...o[l]],u=[...s[l]];u1.isEqual(c,u)||n.push({update:d=>{a[l].fromArray(u1.lerp(c,u,d))},start:()=>{a[l].fromArray(c)},end:()=>{a[l].fromArray(u)}})}return n.length?n:void 0}function QUe(e,t,r,i="texture"){var m,g;if(!e.hasValue(i)||!(i in r))return;let n=e.getNode("rotation"),a=((m=t==null?void 0:t[i])==null?void 0:m.rotation)??0,o=((g=r[i])==null?void 0:g.rotation)??0;if(n&&a!==o)return{update:y=>{n.value=St.lerp(a,o,y)*St.DEG2RAD},start:()=>{n.value=a*St.DEG2RAD},end:()=>{n.value=o*St.DEG2RAD}};let s=e.getNode("mat");if(!s)return;let l=t?t[i]:s,c=r[i],u=[...l.repeat],d=[...l.offset],h=[...c.repeat],f=[...c.offset],p=l.rotation??0,v=c.rotation??0;if(!rc.isEqual(u,h)||!rc.isEqual(d,f)||p!==v)return{update:y=>{s.repeat=rc.lerp(u,h,y),s.offset=rc.lerp(d,f,y),s.rotation=St.lerp(p,v,y),s.updateMatrix()},start:()=>{s.repeat=[...u],s.offset=[...d],s.rotation=p,s.updateMatrix()},end:()=>{s.repeat=[...h],s.offset=[...f],s.rotation=v,s.updateMatrix()}}}function ZUe(e,t){return{update:()=>{e.transparent=t}}}var X_=new k,_F=new bn;function JUe(e,t,r,i,n){var p,v,m,g,y,b;let a=[],o,s,l,c,u,d,h,f;if(e instanceof Vn?(o=B1("position",e,t,r,n),o&&a.push(o),l=Jn("rotation",e,t,r,n),l&&a.push(l),c=B1("shear",e,t,r,n),c&&a.push(c)):(f={slide:((p=t.pathSnapping)==null?void 0:p.slide)??((v=e.updatedPathSnapping)==null?void 0:v.slide)??((m=e.dataPatched.pathSnapping)==null?void 0:m.slide)??0,offset:((g=t.pathSnapping)==null?void 0:g.offset)??((y=e.updatedPathSnapping)==null?void 0:y.offset)??((b=e.dataPatched.pathSnapping)==null?void 0:b.offset)??0},d=Jn("slide",f,t.pathSnapping??e.updatedPathSnapping??e.dataPatched.pathSnapping,r.pathSnapping??e.dataPatched.pathSnapping,n),d&&a.push(d),h=Jn("offset",f,t.pathSnapping??e.updatedPathSnapping??e.dataPatched.pathSnapping,r.pathSnapping??e.dataPatched.pathSnapping,n),h&&a.push(h),!d&&!h&&(o=wF("position",e,t,r,n),o&&a.push(o),s=wF("scale",e,t,r,n),s&&a.push(s),l=e6e(e,t,r,i,n),l&&a.push(l),u=LUe("hiddenMatrix",e,t,r),u&&a.push(u))),o||s||l||u||d||h){let x=e instanceof Vn?()=>{e.updateWorldMatrix(!0)}:()=>{var S;e.updateMatrix(),e.hasNonUniformScale&&(e.updateMatrixWorld(),e.updateMatrixWorldSVD()),(S=e.parent)!=null&&S.matrixWorldFusedFalse&&(e.matrixWorld.multiplyMatrices(e.parent.matrixWorldFusedFalse,e.matrix),e.matrixWorldNeedsUpdate=!1),os(e)&&ic(e.parent)&&e.invalidateDownstreamBooleanData(!0),e.updatePathSnapping(Object.assign({},t.pathSnapping,f))};a.push({update:x,start:x,end:x})}return a}function e6e(e,t,r,i,n){var u;let a=t!=null&&t.rotation?t.rotation.map(d=>(typeof d=="string"?Number(n.getVariable(d)??0):d)*St.DEG2RAD):void 0,o=(u=r.rotation)==null?void 0:u.map(d=>(typeof d=="string"?Number(n.getVariable(d)??0):d)*St.DEG2RAD);if(!o)return;let s=a?new k().fromArray(a):new k().setFromEuler(e.rotation),l=new k().fromArray(o);if(s.equals(l))return;let c=X_.subVectors(l,s);if(i&&c.toArray().every(d=>Math.abs(d)<2*Math.PI)){let d=new Kt().setFromEuler(_F.setFromVector3(s)),h=new Kt().setFromEuler(_F.setFromVector3(l));return{update:f=>{kUe(d,h,e.quaternion,f)},start:()=>{e.rotation.setFromVector3(s)},end:()=>{e.rotation.setFromVector3(l)}}}else return{update:d=>{X_.lerpVectors(s,l,d),e.rotation.setFromVector3(X_)},start:()=>{e.rotation.setFromVector3(s)},end:()=>{e.rotation.setFromVector3(l)}}}function t6e(e,t,r,i){let n=[];if(!("cloner"in r)||!e.cloner)return n;let a=e.cloner,o="cloner"in t?t.cloner:{},s=r.cloner;XH.forEach(f=>{let p;f==="count"?p=Jn("count",a.parameters,o,s,i,!0):p=Ju(f,a.parameters,o??{},s,i),p&&n.push(p)});let l=r6e(a,o,s,i);l!=null&&l.length&&n.push(...l);let c=i6e(a,o,s,i);c!=null&&c.length&&n.push(...c);let u=n6e(a,o,s,i);u!=null&&u.length&&n.push(...u);let d=a6e(a,o,s,i);d!=null&&d.length&&n.push(...d);let h=o6e(a,o,s,i);return h!=null&&h.length&&n.push(...h),n.length&&n.push({update:()=>{a.update()}}),n}function r6e(e,t,r,i){if(e.parameters.type!=="radial")return;let n=t.radial,a=r.radial;if(!a)return;let o=e.parameters.radial,s=[];return KH.forEach(l=>{let c=Ju(l,o,n??{},a,i);c&&s.push(c)}),s}function i6e(e,t,r,i){if(e.parameters.type!=="linear")return;let n=t.linear,a=r.linear;if(!a)return;let o=[],s=e.parameters.linear;return QH.forEach(l=>{let c=Ju(l,s,n??{},a,i);c&&o.push(c)}),o}function n6e(e,t,r,i){if(e.parameters.type!=="grid")return;let n=t.grid,a=r.grid;if(!a)return;let o=[],s=e.parameters.grid;return ZH.forEach(l=>{let c;l==="count"?c=b3(l,s,n??{},a,i,!0):c=Ju(l,s,n??{},a,i),c&&o.push(c)}),o}function a6e(e,t,r,i){if(e.parameters.type!=="toObject")return;let n=t.toObject,a=r.toObject;if(!a)return;let o=[],s=e.parameters.toObject;return JH.forEach(l=>{let c;l==="count"?c=Jn(l,s,n??{},a,i,!0):c=Ju(l,s,n??{},a,i),c&&o.push(c)}),o}function o6e(e,t,r,i){if(!e.parameters.randomness)return;let n=t.randomnessObject,a=r.randomnessObject;if(!a)return;let o=[],s=e.parameters.randomnessObject;return eW.forEach(l=>{let c=Ju(l,s,n??{},a,i);c&&o.push(c)}),o}function s6e(e,t){return{update:()=>{e instanceof In&&(e.fill.enabled=t)}}}function l6e(e,t){return{update:()=>{e instanceof In&&(e.stroke.enabled=t)}}}function c6e(e,t){return{update:()=>{e instanceof In&&(e.dropShadow.enabled=t)}}}function u6e(e,t){return{update:()=>{e instanceof In&&(e.innerShadow.enabled=t)}}}function d6e(e,t){return{update:()=>{e instanceof In&&(e.backgroundBlur.enabled=t)}}}function h6e(e,t){return{update:()=>{e instanceof In&&(e.layerBlur.enabled=t)}}}function f6e(e,t,r,i,n){let a=[],o,s,l,c,u,d,h,f,p,v,m,g,y,b,x;if("width"in e&&(o=Jn("width",e,t,r,n),o&&a.push(o)),"height"in e&&(s=Jn("height",e,t,r,n),s&&a.push(s)),e instanceof In||e instanceof ul){let S={...t.fill},w={...r.fill};S.enabled!==void 0&&S.enabled!==w.enabled&&(a.push(s6e(e,!0)),S.enabled||Object.assign(S,{enabled:!0,color:{...S.color,a:0}}),w.enabled||Object.assign(w,{enabled:!0,color:{...w.color,a:0}})),l=Cb("color",e.fill,S,w,n),l&&a.push(l)}if(e instanceof In){let S={...t.stroke},w={...r.stroke};(S.enabled||w.enabled)&&(a.push(l6e(e,!0)),S.enabled||Object.assign(S,{enabled:!0,color:{...S.color,a:0}}),w.enabled||Object.assign(w,{enabled:!0,color:{...w.color,a:0}})),c=Cb("color",e.stroke,S,w,n),c&&a.push(c),u=Jn("thickness",e.stroke,S,w,n),u&&a.push(u)}if(e instanceof In){let S={...t.dropShadow},w={...r.dropShadow};(S.enabled||w.enabled)&&(a.push(c6e(e,!0)),S.enabled||Object.assign(S,{enabled:!0,color:{...S.color,a:0}}),w.enabled||Object.assign(w,{enabled:!0,color:{...w.color,a:0}})),d=Cb("color",e.dropShadow,S,w,n),d&&a.push(d),h=Jn("blurRadius",e.dropShadow,S,w,n),h&&a.push(h),p=Jn("spread",e.dropShadow,S,w,n),p&&a.push(p),f=B1("offset",e.dropShadow,S,w,n),f&&a.push(f)}if(e instanceof In){let S={...t.innerShadow},w={...r.innerShadow};(S.enabled||w.enabled)&&(a.push(u6e(e,!0)),S.enabled||Object.assign(S,{enabled:!0,color:{...S.color,a:0}}),w.enabled||Object.assign(w,{enabled:!0,color:{...w.color,a:0}})),v=Cb("color",e.innerShadow,S,w,n),v&&a.push(v),m=Jn("blurRadius",e.innerShadow,S,w,n),m&&a.push(m),y=Jn("spread",e.innerShadow,S,w,n),y&&a.push(y),g=B1("offset",e.innerShadow,S,w,n),g&&a.push(g)}if(e instanceof In||e instanceof ul){let S={...t.backgroundBlur},w={...r.backgroundBlur};(S.enabled||w.enabled)&&(a.push(d6e(e,!0)),S.enabled||Object.assign(S,{enabled:!0,radius:0}),w.enabled||Object.assign(w,{enabled:!0,radius:0})),b=Jn("radius",e.backgroundBlur,S,w,n),b&&a.push(b)}if(e instanceof In){let S={...t.layerBlur},w={...r.layerBlur};(S.enabled||w.enabled)&&(a.push(h6e(e,!0)),S.enabled||Object.assign(S,{enabled:!0,radius:0}),w.enabled||Object.assign(w,{enabled:!0,radius:0})),x=Jn("radius",e.layerBlur,S,w,n),x&&a.push(x)}if(e instanceof ul||e instanceof P0){let S=b3("cornerRadius",e,t,r,n);S&&a.push(S)}return a}function AF(e,t,r,i,n){let a=[];return e.data.visible&&a.push(...JUe(e,t,r,n,i)),e instanceof Vn?a.push(...f6e(e,t,r,n,i)):(e.data.visible&&a.push(...t6e(e,t,r,i)),os(e)?(e instanceof ba&&e.data.visible&&a.push(...jUe(e,t,r,i)),e.data.visible&&a.push(...HUe(e,t,r,i))):s4e(e)?e.data.visible&&a.push(...VUe(e,t,r,i)):o4e(e)&&a.push(...FUe(e,t,r,i))),a.length?{update:o=>{a.forEach(s=>s.update(o))},start:o=>{a.forEach(s=>{var l;return(l=s.start)==null?void 0:l.call(s,o)})},end:o=>{a.forEach(s=>{var l;return(l=s.end)==null?void 0:l.call(s,o)})}}:void 0}var MF=new k;function x3(e,t,r=!1){var a;let i=[],n=o=>{let s=o.data;delete o.states,o.currentState=null,o.reversibleToState=null,o.currentTransitionEvent=null;for(let l of s.states){let c={...l.data};o.states||(o.states={}),o.states[l.id]=Ud.patch(s,c)}TF(e.scene,o,null,t,s.events.find(l=>l.data.type==="Follow"||l.data.type==="LookAt")!==void 0),EF(e)};e.scene.traverse2D(n),e.traverseChildren(o=>{var u,d,h,f,p,v;if(r&&((u=o.rigidBody)==null||u.setTranslation(o.position0,!0),(d=o.rigidBody)==null||d.setRotation(o.rotation0,!0),(h=o.rigidBody)==null||h.setLinvel(MF,!0),(f=o.rigidBody)==null||f.setAngvel(MF,!0)),!_r.is(o))return;let s=o.uuid,l=o.data;if(delete o.states,o.uuid===gm)return;let c=!1;i.some(m=>{var g;return(g=e.scene.find(s))==null?void 0:g.isDescendantOf(m)})?c=!0:((p=l.physics)==null?void 0:p.fusedBody)===!0&&l.physics.rigidBody==="dynamic"&&i.push(s),o.data=l,o.currentState=null,o.reversibleToState=null,o.currentTransitionEvent=null;for(let m of l.states){let g={...m.data};e.data.globalPhysics.usePhysics===!0&&l.physics&&(l.physics.rigidBody==="dynamic"||c)&&(m.data.position!==void 0&&delete g.position,m.data.rotation!==void 0&&delete g.rotation,m.data.hiddenMatrix!==void 0&&delete g.hiddenMatrix),o.states||(o.states={}),o.states[m.id]=Bd.patch(l,g)}TF(e.scene,o,null,t,l.events.find(m=>m.data.type==="Follow"||m.data.type==="LookAt")!==void 0),EF(e),o instanceof va&&o.frame&&(o.frame.traverse(m=>n(m)),(v=o.uiCanvas)==null||v.applySize())}),e.frame&&(e.frame.traverse(o=>n(o)),(a=e.uiCanvas)==null||a.applySize())}function EF(e){e.traverseEntity(t=>{for(let r of t.data.events){let i=[];switch(r.data.type){case"Follow":case"MouseHover":case"Scroll":case"MouseDown":case"MouseUp":case"MousePress":case"KeyUp":case"KeyDown":case"KeyPress":case"Collision":i.push(...r.data.actions);break;case"GameControl":for(let n of Object.values(r.data.gameActions))i.push(...n);break;case"DragDrop":i.push(...r.data.dragDropActions.drag,...r.data.dragDropActions.drop);break;case"Conditional":i.push(...r.data.inActions,...r.data.outActions);break}for(let n of i)if(n.data.type==="Create"&&n.data.hideBase==="Yes"){let a=e.scene.find(n.data.object);a&&(a.visible=!1)}}})}function TF(e,t,r,i,n=!1){if(t instanceof ba&&t.removeInteractionGeometry(i),t instanceof Vn?t.changeSelectedState(r,{shared:i},n):t.changeSelectedState(r,{scene:e,shared:i},n),t instanceof ba&&t.updateGeometryGroupsIfNeeded(),t instanceof xa&&t.updateCameraState(t.dataPatched,{scene:e,shared:i}),!(t instanceof Vn)){if(t.cloner)for(let a of t.cloner.children)a.playModeVisible=void 0;t.updateVisible()}}function C7(e){let t;if(e.easing===5){let{control1:r,control2:i}=e;t=`cubicBezier(
			${r[0]}, ${r[1]}, ${i[0]}, ${i[1]}
		)`}else if(e.easing===6){let{mass:r,stiffness:i,damping:n,velocity:a}=e;t=`spring( ${r}, ${i}, ${n}, ${a} )`}else{let r;switch(e.easing){case 0:r=iu.linear;break;case 1:r=iu.ease;break;case 2:r=iu.easeIn;break;case 3:r=iu.easeOut;break;case 4:r=iu.easeInOut;break;default:r=iu.linear}let[i,n,a,o]=r;t=`cubicBezier( ${i}, ${n}, ${a}, ${o} )`}return{duration:Math.max(e.duration,1e-4),easing:t}}function aT(e){let t={delay:0,loop:e.repeat===-1?!0:e.repeat+1};if(e.repeat===0)t.direction="normal",t.rewind=!1;else switch(e.direction){case"pingpong":t.direction="alternate",t.rewind=!1;break;case"pingpong-rewind":t.direction="alternate",t.rewind=!0;break;default:t.direction="normal",t.rewind=!1;break}switch(t.delay=0,t.endDelay=0,t.startOnceDelay=0,t.pingPongDelayCorrection=0,t.pingPongEndDelayCorrection=0,e.delayDirection){case"start-once":t.startOnceDelay=e.delay;break;case"start":t.delay=e.delay;break;case"end":t.endDelay=e.delay;break;case"start-end":case void 0:t.delay=e.delay,t.endDelay=e.delay;break}return t.direction==="alternate"&&(t.delay/=2,t.endDelay/=2,e.delayDirection==="start"?(t.pingPongDelayCorrection=t.delay,typeof t.loop=="number"&&t.loop%2===0&&(t.pingPongEndDelayCorrection=t.delay)):e.delayDirection==="end"?typeof t.loop=="number"&&t.loop%2!==0&&(t.pingPongEndDelayCorrection=t.endDelay):e.delayDirection==="start-end"&&(t.pingPongDelayCorrection=t.delay,t.pingPongEndDelayCorrection=t.endDelay)),t}var p6e={type:"beginState"},m6e={type:"completeState",isfromEntity:!1},PF=class{constructor(e,t,r,i,n,a){if(this.object=e,this.data=i,this.sharedAssets=n,this.allowSlerp=a,this.targets={t:0},this.firstLoop=!0,this._changeBegan=!1,this._changeCompleted=!0,this.onChange=()=>{this.callback&&(this.callback.update(this.targets.t),this.object.requestRender()),this.targets.t===0||this.targets.t===1?this._changeCompleted||(this._changeCompleted=!0,this._changeBegan=!1,this.onChangeComplete()):(this._changeCompleted&&(this._changeCompleted=!1),this._changeBegan||(this._changeBegan=!0,this.onChangeBegin()))},this.onChangeBegin=()=>{this.object.reversibleToState=this.to.id;let o=this.targets.t>.5?this.from.id:this.to.id;this.object.prevState!==this.object.currentState&&(this.object.prevState=this.object.currentState),this.object.currentState=o,this.object.dispatchEvent({type:"beginState",state:o}),this.object instanceof Vn||this.object.traverseEntity(s=>{s!==this.object&&s instanceof xa&&s.dispatchEvent(p6e)})},this.onChangeComplete=()=>{this.firstLoop&&(this.onFirstLoop(),this.firstLoop=!1),this.object.reversibleToState=this.to.id;let o=this.targets.t<.5?this.from.id:this.to.id;this.object.prevState!==this.object.currentState&&(this.object.prevState=this.object.currentState),this.object.currentState=o,this.object.dispatchEvent({type:"completeState",state:o}),this.object instanceof Vn||this.object.traverseEntity(s=>{s!==this.object&&s instanceof xa&&s.dispatchEvent(m6e)})},this.onFirstLoop=()=>{this.useCurrentState&&(this.callback=AF(this.object,this.from.data,this.to.data,this.sharedAssets,this.allowSlerp))},t===void 0){let o=ex(this.object,this.object.currentState===r?this.object.prevState:this.object.currentState);if(!o)throw new Error("Missing property");this.from=o}else{let o=ex(this.object,t);if(!o)throw new Error("Missing property");this.from=o}if(r===void 0)throw new Error("Missing property");{let o=ex(this.object,r);if(!o)throw new Error("Missing property");this.to=o}this.useCurrentState=t===void 0||r===void 0,this.params={targets:this.targets,t:1,autoplay:!1,...aT(i),...C7(i),change:this.onChange},this.callback=AF(this.object,t===void 0?{}:this.from.data,r===void 0?{}:this.to.data,this.sharedAssets,this.allowSlerp)}get changeBegan(){return this._changeBegan}get changeCompleted(){return this._changeCompleted}},_7=class extends ca{constructor(e,t,r,i,n){var o;if(super(),this.eventType=e,this.data=t,this.page=r,this.shared=i,this.condition=n,this.toggleIsForward=!1,this.timelineNeedsRebuild=!1,this.hasPlayedOnce=!1,this.onTimelineChangeComplete=()=>{var s;this.data.tweens[0].data.direction!=="normal"&&(this.toggleIsForward=!this.toggleIsForward),this.timelineNeedsRebuild!==!1&&((s=this.timeline)==null||s.pause(),this.buildTimeline({isForward:this.toggleIsForward,needsRebuild:!1,isRebuild:!0}),this.timeline.play())},!t.object)throw new Error("Missing property");let a=this.page.scene.find(t.object)??((o=this.page.uiCanvas)==null?void 0:o.find(t.object))??this.page.scene.find2DInUIObjects(t.object);if(!a)throw new Error("Missing property");if(!a.states)throw new Error("Missing property");if(this.object=a,t.tweens.length<2)throw new Error("Missing property");this.tweens=Array(this.data.tweens.length-1),this.startOnceDelay=t.tweens[0].data.delayDirection==="start-once"?t.tweens[0].data.delay:0,this.init()}get playing(){var e;return((e=this.timeline)==null?void 0:e.paused)===!1}get changeBegan(){return this.tweens.some(e=>e.changeBegan)??!1}init(){this.initialCurrentState=ex(this.object,this.object.currentState).id,this.toggleIsForward=!1}get currentState(){return this.data.runMode==="Toggle"&&OL(this.eventType)?this.initialCurrentState:this.object.currentState}buildTimeline({isForward:e=!0,needsRebuild:t=!1,isRebuild:r=!1}={}){var i,n,a,o;try{let s=aT(this.data.tweens[0].data);r&&typeof s.loop=="number"&&s.loop--,(i=this.timeline)==null||i.pause(),this.timeline=S7.timeline({autoplay:!1,...s,...s.loop===!0||s.loop>1?{timelineChangeComplete:this.onTimelineChangeComplete}:{}});let l=this.tweens.findIndex(c=>c==null?void 0:c.changeBegan);if(t===!0&&(this.timelineNeedsRebuild=!0),e){let c=l===-1?0:l;for(let u=c;u<this.data.tweens.length-1;u++){let d=this.data.tweens[u],h=this.data.tweens[u+1],f;u===c&&(this.object.wasMovedByUser===!0||((n=this.object.previousAction)==null?void 0:n.changeBegan)===!0)?(f=void 0,this.object instanceof xa&&(this.object.wasMovedByUser=!1)):f=d.data.state===void 0?this.currentState:d.data.state;let p=new PF(this.object,f,h.data.state===void 0?this.currentState:h.data.state,h.data,this.shared,this.data.allowSlerp??!1);l!==-1&&u===c&&Object.assign(p.params,{startOnceDelay:0}),this.tweens[u]=p,this.timeline.add(p.params,this.timeline.duration+(u===c?s.delay:0))}this.timeline.duration+=s.endDelay}else{let c=l===-1?this.data.tweens.length-1:l+1;for(let u=c;u>0;u--){let d=this.data.tweens[u],h=this.data.tweens[u-1],f;u===c&&(this.object.wasMovedByUser===!0||((a=this.object.previousAction)==null?void 0:a.changeBegan)===!0)?(f=void 0,this.object instanceof xa&&(this.object.wasMovedByUser=!1)):f=d.data.state===void 0?this.currentState:d.data.state;let p=new PF(this.object,f,h.data.state===void 0?this.currentState:h.data.state,d.data,this.shared,this.data.allowSlerp??!1);l!==-1&&u===c&&Object.assign(p.params,{startOnceDelay:0}),this.tweens[u-1]=p,this.timeline.add(p.params,this.timeline.duration+(u===c?s.endDelay:0))}this.timeline.duration+=s.delay}}catch(s){s instanceof Error&&console.error(s.message)}((o=this.object.previousAction)==null?void 0:o.playing)===!0&&this.object.previousAction.pause(),this.object.previousAction=this}play(){if(gi(this.shared,this.condition)===!1||OL(this.eventType)&&this.data.runMode==="Once"&&this.hasPlayedOnce||(this.hasPlayedOnce=!0,this.playing))return!1;clearTimeout(this.timeoutId);let e=aT(this.data.tweens[0].data).pingPongDelayCorrection;this.timeoutId=window.setTimeout(()=>{try{this.buildTimeline(),this.timeline.play()}catch(t){t instanceof Error&&console.error(t.message)}},this.startOnceDelay+e)}pause(){var e;(e=this.timeline)==null||e.pause(),clearTimeout(this.timeoutId),this.tweens=Array(this.data.tweens.length-1),delete this.timeoutId}stop(){this.pause();let e=this.data.tweens[0].data.state===void 0?this.initialCurrentState:this.data.tweens[0].data.state;this.object instanceof Vn?this.object.changeSelectedState(e,{shared:this.shared}):this.object.changeSelectedState(e,{scene:this.page.scene,shared:this.shared}),this.object.currentState=e}seek(e){var t;if(gi(this.shared,this.condition)===!1)return!1;this.timeline===void 0&&this.buildTimeline(),(t=this.timeline)==null||t.seek(e*this.timeline.duration,!0)}toggle(e){var t;if(gi(this.shared,this.condition)===!1)return!1;clearTimeout(this.timeoutId),this.toggleIsForward=e??!this.toggleIsForward,this.playing?((t=this.timeline)==null||t.pause(),this.buildTimeline({isForward:this.toggleIsForward,needsRebuild:!0}),this.timeline.play()):this.timeoutId=window.setTimeout(()=>{var r;(r=this.timeline)==null||r.pause(),this.buildTimeline({isForward:this.toggleIsForward}),this.timeline.play()},this.startOnceDelay)}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){this.pause()}};function ex(e,t){var n;let r,i;if(typeof t=="string"?(r=t,i=(n=e.states)==null?void 0:n[r]):t===null&&(r=null,i=e.data),!(r===void 0||i===void 0))return{id:r,data:i}}var v6e={type:"beginState"},DF={type:"completeState",isfromEntity:!1},OF={type:"requestRender"},A7=class extends ca{constructor(e,t,r,i){super(),this.data=e,this.page=t,this.shared=r,this.condition=i,this.toggleIsForward=!1,this.posStart=new k,this.posEnd=new k,this.qStart=new Kt,this.qEnd=new Kt,this.zoomStart=1,this.zoomEnd=1}init(){}get playing(){return this.animation&&this.animation.began&&!this.animation.completed}buildAnimation(e=!1){if(!this.data.animate)return;let t=this.page.scene.find(this.data.targetCamera);if(!t||!t.visible)throw new ReferenceError("Target camera not founded or not visible");let r={t:0};this.posStart.copy(this.page.activeCamera.position),this.qStart.copy(this.page.activeCamera.quaternion),this.zoomStart=this.page.activeCamera.zoom,this.animation=S7({targets:r,t:1,...C7(this.data),update:()=>{r.t===0&&(this.data.runMode==="Toggle"&&!this.toggleIsForward?this.fromCamera&&(this.posEnd.copy(this.fromCamera.position),this.qEnd.copy(this.fromCamera.quaternion),this.zoomEnd=this.fromCamera.zoom,this.switchCamera(this.fromCamera.uuid)):(this.posEnd.copy(t.position),this.qEnd.copy(t.quaternion),this.zoomEnd=t.zoom,this.fromCamera=this.page.activeCamera,this.switchCamera(t.uuid)),this.page.activeCamera.dispatchEvent(v6e));let i=this.page.activeCamera;i.position.lerpVectors(this.posStart,this.posEnd,r.t),i.quaternion.slerpQuaternions(this.qStart,this.qEnd,r.t),i.zoom=this.zoomStart+(this.zoomEnd-this.zoomStart)*r.t,i.wasMovedBySwitchCameraAction=!0,i.updateMatrix(),i.updateMatrixWorld(),i.updateProjectionMatrix(),i.dispatchEvent(OF),r.t===1&&i.dispatchEvent(DF)}})}switchCamera(e){let t=this.page.activeCamera,r=this.page.scene.find(e);if(!r||!r.visible)throw new ReferenceError("Target camera not founded or not visible");this.page.switchActiveCamera(r),t.dispatchEvent({type:"cameraChange",camera:r})}play(){if(gi(this.shared,this.condition)===!1)return!1;if(!this.playing&&this.page.activeCamera.uuid!==this.data.targetCamera)try{clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{var e;delete this.timeoutId,this.data.animate?(this.buildAnimation(),(e=this.animation)==null||e.play()):this.switchCamera(this.data.targetCamera)},this.data.delay*1e3)}catch{}}pause(){var e;(e=this.animation)==null||e.pause(),clearTimeout(this.timeoutId),delete this.timeoutId}toggle(e){var t,r;if(gi(this.shared,this.condition)===!1)return!1;if(window.clearTimeout(this.timeoutId),delete this.timeoutId,e!==this.toggleIsForward)try{this.playing?((t=this.animation)==null||t.pause(),this.toggleIsForward=e??!this.toggleIsForward,this.buildAnimation(!0),(r=this.animation)==null||r.play()):this.timeoutId=window.setTimeout(()=>{var i,n;this.toggleIsForward=e??!this.toggleIsForward,this.data.animate?((i=this.animation)==null||i.pause(),this.buildAnimation(),(n=this.animation)==null||n.play()):(this.toggleIsForward?(this.fromCamera=this.page.activeCamera,this.switchCamera(this.data.targetCamera)):this.fromCamera&&this.switchCamera(this.fromCamera.uuid),this.page.activeCamera.dispatchEvent(DF),this.page.activeCamera.dispatchEvent(OF))},this.data.delay*1e3)}catch{}}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){this.pause(),this.toggleIsForward=!1}};function M7(e){let t=e==null?void 0:e.tracks.filter(r=>r.ValueTypeName==="vector"||r.ValueTypeName==="quaternion").map(r=>r.times.length);if(t!=null&&t.length){let r=yOe(t);return r&&r>2?r:2}return 2}var E7=class extends ca{constructor(e,t,r,i,n){var l,c,u;super(),this.data=e,this.page=t,this.animationControls=r,this.shared=i,this.condition=n,this.startOnceDelay=0,this.toggleIsForward=!1;let a=e.object,o=t.scene.find(e.object);o&&Array.isArray(o.identity)&&(a=o.identity[0]),this.data={...e,object:a};let s=this.animationControls.clipIdToAction[e.clipId+"/"+a];if(this.duration=((l=s==null?void 0:s.getClip())==null?void 0:l.duration)??1,this.data.crop2){let d=M7(s==null?void 0:s.getClip());this.leftFrameTime=this.data.crop2[0]/(d-1)*this.duration,this.rightFrameTime=this.data.crop2[1]/(d-1)*this.duration}else{let d=(u=(c=s==null?void 0:s.getClip())==null?void 0:c.tracks[0])==null?void 0:u.times.length;d&&d>1?(this.leftFrameTime=this.data.crop[0]/d*this.duration,this.rightFrameTime=this.data.crop[1]/d*this.duration):(this.leftFrameTime=0,this.rightFrameTime=this.duration)}this.startOnceDelay=e.delay}get playing(){var e;return((e=this.threeAnimAction)==null?void 0:e.isRunning())??!1}play(e=!1){if(gi(this.shared,this.condition)===!1)return!1;window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{var r;if(this.threeAnimAction=this.animationControls.play(this.data),!this.threeAnimAction)return;this.threeAnimAction.reset(),this.threeAnimAction.time=this.leftFrameTime,this.threeAnimAction._clip.start=this.leftFrameTime,this.threeAnimAction._clip.duration=this.rightFrameTime;let t=this.data.object;Object.entries(this.animationControls.clipIdToAction).forEach(([i,n])=>{let a=i.split("/")[1];this.threeAnimAction!==n&&a===t&&n.isRunning()&&(e?n.fadeOut(.2):n.stop())}),e&&((r=this.threeAnimAction)==null||r.fadeIn(.2))},this.startOnceDelay)}pause(){this.threeAnimAction&&(this.threeAnimAction.paused=!0),window.clearTimeout(this.timeoutId),delete this.timeoutId}stop(){var e;(e=this.threeAnimAction)==null||e.fadeOut(.2)}seek(e){this.threeAnimAction=this.animationControls.play(this.data),this.threeAnimAction&&(this.threeAnimAction.paused=!0,this.threeAnimAction.time=St.clamp(this.threeAnimAction.time+1/60*e,this.leftFrameTime,this.rightFrameTime-16e-5),this.animationControls.needsUpdate=!0,this.animationControls.requestRender())}toggle(e,t=!1){if(gi(this.shared,this.condition)===!1)return!1;this.toggleIsForward=e??!this.toggleIsForward,this.threeAnimAction&&(this.threeAnimAction._loopCount=0),this.playing?this.threeAnimAction&&(this.threeAnimAction.timeScale=this.toggleIsForward?1:-1,this.toggleIsForward?(this.threeAnimAction._clip.start=this.leftFrameTime,this.threeAnimAction._clip.duration=this.rightFrameTime):(this.threeAnimAction._clip.start=this.rightFrameTime,this.threeAnimAction._clip.duration=this.leftFrameTime)):this.timeoutId=window.setTimeout(()=>{var r;if(this.threeAnimAction=this.animationControls.play(this.data),this.threeAnimAction){this.toggleIsForward?(this.threeAnimAction.time=this.leftFrameTime,this.threeAnimAction._clip.start=this.leftFrameTime,this.threeAnimAction._clip.duration=this.rightFrameTime):(this.threeAnimAction.time=this.rightFrameTime,this.threeAnimAction._clip.start=this.rightFrameTime,this.threeAnimAction._clip.duration=this.leftFrameTime),this.threeAnimAction.paused=!1,this.threeAnimAction.timeScale=this.toggleIsForward?1:-1;let i=this.data.clipId.split("/")[1];Object.entries(this.animationControls.clipIdToAction).forEach(([n,a])=>{let o=n.split("/")[1];this.threeAnimAction!==a&&o===i&&a.isRunning()&&(t?a.fadeOut(.2):a.stop())}),t&&((r=this.threeAnimAction)==null||r.fadeIn(.2))}},this.startOnceDelay)}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){var t;let e=(t=this.animationControls.clipIdToAction[this.data.clipId+"/"+this.data.object])==null?void 0:t.getClip();e&&(e.duration=this.duration),this.pause()}},T7=class{constructor(e,t,r,i,n){this.data=e,this.page=t,this.eventManager=r,this.shared=i,this.condition=n,this.timeOutId=-1,this.scene=t.scene}dispatch(){if(gi(this.shared,this.condition)===!1)return!1;this.data.target!==this.page.uuid&&(window.clearTimeout(this.timeOutId),this.timeOutId=window.setTimeout(()=>{this.play()},this.data.delay*1e3))}dispose(){window.clearTimeout(this.timeOutId)}play(){if(this.scene.children.every(t=>t.uuid!==this.data.target))return;this.data.transition==="fade"&&this.data.duration>0&&this.eventManager.eventContext.renderer.renderFromSceneForSceneTransitionPass(this.scene,this.scene.activeCamera,this.data.duration*1e3),this.eventManager.deactivate(),this.eventManager.controlsManager.deactivate();let e=this.scene.activeCamera;this.scene.updatePage(this.data.target),this.scene.traverseVisibleEntity(t=>{t.type==="ParticleSystem"&&(t.sleep(),t.wakeUp(),t.data.autoPlay?t.start():t.stop())}),this.scene.activePage.switchToPlayCamera(),this.scene.activeCamera.copyViewPlaneSize(e),x3(this.scene.activePage,this.shared),this.eventManager.activate(),this.eventManager.controlsManager.activate(this.eventManager)}},P7=class{constructor(e,t,r,i){this.data=e,this.page=t,this.shared=r,this.condition=i,this.evaluatedCondition=!1}checkConditions(){this.evaluatedCondition=gi(this.shared,this.condition)}dispatch(){if(this.evaluatedCondition===!1)return!1;let e=this.shared.getVariable(this.data.variableId),t=RW(this.data.expression,this.shared,na.typeOfVariable(e));t!==void 0&&this.shared.updateVariable(this.data.variableId,typeof t=="string"?{textValue:t}:t)}dispose(){}},D7=class{constructor(e,t,r,i){this.data=e,this.page=t,this.shared=r,this.condition=i,this.timeoutId=null}dispatchInner(){if(gi(this.shared,this.condition)===!1)return!1;let e=this.shared.getDynamicVariablePlayState(this.data.variableId);if(this.data.mode==="PlayPause")this.shared.getDynamicVariableToggleIsForward(this.data.variableId)===void 0&&this.shared.setDynamicVariableToggleIsForward(this.data.variableId,!0),this.shared.setDynamicVariablePlayState(this.data.variableId,e==="Playing"?"Paused":"Playing");else if(this.data.mode==="Play"&&e!=="Playing")this.shared.getDynamicVariableToggleIsForward(this.data.variableId)===void 0&&this.shared.setDynamicVariableToggleIsForward(this.data.variableId,!0),this.shared.setDynamicVariablePlayState(this.data.variableId,"Playing");else if(this.data.mode==="Stop"&&e!=="Stopped")this.shared.setDynamicVariablePlayState(this.data.variableId,"Stopped");else if(this.data.mode==="Pause"&&e!=="Paused")this.shared.setDynamicVariablePlayState(this.data.variableId,"Paused");else if(this.data.mode==="Restart")this.shared.setDynamicVariablePlayState(this.data.variableId,"Restarted");else if(this.data.mode==="Toggle"){let t=this.shared.getDynamicVariableToggleIsForward(this.data.variableId);e==="Playing"?this.shared.setDynamicVariableToggleIsForward(this.data.variableId,t===void 0?!1:!t):(this.shared.setDynamicVariableToggleIsForward(this.data.variableId,!t),this.shared.setDynamicVariablePlayState(this.data.variableId,"Playing"))}}dispatch(){let e=this.data.delay,t=this.shared.getDynamicVariablePlayState(this.data.variableId);this.data.mode==="PlayPause"&&t==="Playing"&&(e=this.data.pauseDelay),e!==0?(this.timeoutId&&window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{this.timeoutId=null,this.dispatchInner()},e)):this.dispatchInner()}dispose(){this.timeoutId&&window.clearTimeout(this.timeoutId)}},g6e=class{constructor(e,t,r,i){this.data=e,this.page=t,this.shared=r,this.condition=i}dispatch(){if(gi(this.shared,this.condition)===!1)return!1;(this.data.target==="single"?this.data.variableId?[this.data.variableId]:[]:Object.keys(this.shared.getVariables())).forEach(e=>{var r;this.shared.getVariable(e);let t=(r=this.shared.data.variables.data(e))==null?void 0:r.value;t!==void 0&&this.shared.updateVariable(e,t),this.shared.enableLocalStorageForPersistentVariables&&localStorage.removeItem(BE(e))})}dispose(){}},y6e=class{constructor(e,t,r,i){this.data=e,this.page=t,this.shared=r,this.condition=i}dispatch(){var e;if(gi(this.shared,this.condition)===!1)return!1;this.data.userAPIId&&((e=this.shared.getUserAPI(this.data.userAPIId))==null||e.callUserAPI(this.shared))}dispose(){}};function gi(e,t){if(t===void 0)return!0;if(t.expression.length===0)return!1;let r=RW(t.expression,e,"boolean");return t.negate?!r:!!r}function $n(e,t,r,i,n,a){let o={Audio:[],Video:[],Particles:[],Link:[],Destroy:[],Create:[],Reset:[],Transition:[],SwitchCamera:[],Animation:[],SceneTransition:[],SetVariable:[],DynamicVariablePlay:[],ClearLocalStorage:[],UserAPI:[]},s=l=>({id:c,data:u})=>{try{u.type==="Audio"?ha[e.type].includes("Audio")&&o.Audio.push(new r7(c,u,a,i,l)):u.type==="Video"&&!(a instanceof Vn)?ha[e.type].includes("Video")&&o.Video.push(new R7(c,u,a,i,l)):u.type==="Particles"?ha[e.type].includes("Particles")&&o.Particles.push(new i7(u,r,i,l)):u.type==="Link"?ha[e.type].includes("Link")&&o.Link.push(new nUe(u,n.controlsManager,i,l)):u.type==="Create"?ha[e.type].includes("Create")&&o.Create.push(new I7(u,r,n.controlsManager,i,l)):u.type==="Destroy"?ha[e.type].includes("Destroy")&&o.Destroy.push(new n7(u,r,n.controlsManager,i,l)):u.type==="Reset"?ha[e.type].includes("Reset")&&o.Reset.push(new a7(u,r,i,n,l)):u.type==="Transition"?ha[e.type].includes("Transition")&&o.Transition.push(new _7(e.type,u,r,i,l)):u.type==="SwitchCamera"?ha[e.type].includes("SwitchCamera")&&o.SwitchCamera.push(new A7(u,r,i,l)):u.type==="SceneTransition"?ha[e.type].includes("SceneTransition")&&o.SceneTransition.push(new T7(u,r,n,i,l)):u.type==="Animation"?ha[e.type].includes("Animation")&&o.Animation.push(new E7(u,r,n.animationControls,i,l)):u.type==="SetVariable"?ha[e.type].includes("SetVariable")&&o.SetVariable.push(new P7(u,r,i,l)):u.type==="DynamicVariablePlay"?ha[e.type].includes("DynamicVariablePlay")&&o.DynamicVariablePlay.push(new D7(u,r,i,l)):u.type==="Conditional"?ha[e.type].includes("Conditional")&&(u.ifActions.forEach(s({expression:u.condition,negate:!1})),u.elseActions.forEach(s({expression:u.condition,negate:!0}))):u.type==="ClearLocalStorage"?ha[e.type].includes("ClearLocalStorage")&&o.ClearLocalStorage.push(new g6e(u,r,i,l)):u.type==="UserAPI"&&ha[e.type].includes("UserAPI")&&o.UserAPI.push(new y6e(u,r,i,l))}catch{}};return t.forEach(s()),o}function jn(e){Object.values(e).forEach(t=>{t.forEach(r=>{(r instanceof r7||r instanceof R7||r instanceof i7||r instanceof E7||r instanceof _7||r instanceof I7||r instanceof n7||r instanceof A7||r instanceof T7||r instanceof a7||r instanceof P7||r instanceof D7)&&r.dispose()})})}function b6e(e,t){let r;if("material"in e){let i=e.material;Array.isArray(i)?r=e.material[0].layers.find(n=>n.uuid===t):r=e.material.layers.find(n=>n.uuid===t)}if(r)return r.color.texture.image.img instanceof HTMLVideoElement?r.color.texture.image.img:void 0}var O7=new Map,eg=new Map,gp=class{constructor(e,t,r){this.data=t,this.delay=0,this.status="stopped";let{layerId:i,loop:n,volume:a,delay:o}=t;if(this.object=r,i===void 0)throw new Error("Missing property");let s=b6e(r,i);s&&(this.videoElement=s,this.videoElement.loop=n===1/0,S0&&(this.videoElement.autoplay=!0),a!==void 0&&(this.videoElement.volume=a)),o!==void 0&&(this.delay=o),eg.has(r.uuid)?eg.get(r.uuid).push(this):eg.set(r.uuid,[this]),O7.set(e,this),this.pause()}mute(){!this.videoElement||(this.videoElement.muted=!0)}unMute(){!this.videoElement||(this.videoElement.muted=!1)}play(e){if(!this.videoElement)return;let t=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);e?(this.mute(),this.delay+=150):t?(this.mute(),window.setTimeout(()=>{this.unMute()},100)):this.unMute(),this.delayTimerId=window.setTimeout(()=>{if(!this.videoElement)return;let r=this.videoElement.play();r!==void 0&&r.then(i=>{}).catch(i=>{this.play()}),this.clearDelay()},this.delay),this.status="playing"}clearDelay(){this.delayTimerId&&(clearTimeout(this.delayTimerId),delete this.delayTimerId)}pause(){!this.videoElement||(this.videoElement.pause(),this.status="paused")}stop(){!this.videoElement||(this.videoElement.pause(),this.videoElement.currentTime=0,this.status="stopped",this.clearDelay())}playByToggle(){this.data.toggle==="stop"?this.status==="playing"?this.stop():(this.stop(),this.play()):this.data.toggle==="pause"?this.status==="playing"?this.pause():this.play():(this.stop(),this.play())}dispose(){!this.videoElement||(this.stop(),this.videoElement.muted=!0)}},oT=class{constructor(e){this.data=e}dispatch(){this.data.playVideo?this.pauseVideo(this.data.playVideo):this.data.object?this.pauseAllVideosFromObject(this.data.object):this.pauseAllVideos()}pauseVideo(e){let t=O7.get(e);!t||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{t[this.data.interaction](),this.disposeDelay()},this.data.delay)):t[this.data.interaction]())}pauseAllVideosFromObject(e){let t=eg.get(e);!(t!=null&&t.length)||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{t.forEach(r=>r[this.data.interaction]()),this.disposeDelay()},this.data.delay)):t.forEach(r=>r[this.data.interaction]()))}pauseAllVideos(){let e=[...eg.values()];!e.length||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{e.forEach(t=>{t.forEach(r=>{r[this.data.interaction]()})}),this.disposeDelay()},this.data.delay)):e.forEach(t=>{t.forEach(r=>{r[this.data.interaction]()})}))}disposeDelay(){clearTimeout(this.timeoutId),delete this.timeoutId}dispose(){clearTimeout(this.timeoutId),delete this.timeoutId}},R7=class{constructor(e,t,r,i,n){if(this.data=t,this.shared=i,this.condition=n,t.interaction==="play")this.interaction=new gp(e,t,r);else if(t.interaction==="pause"||t.interaction==="stop")this.interaction=new oT(t);else throw new Error("Missing property")}dispatchBasic(){if(gi(this.shared,this.condition)===!1)return!1;this.interaction instanceof gp?this.interaction.playByToggle():this.interaction.dispatch()}dispatchConditional(){if(gi(this.shared,this.condition)===!1)return!1;this.interaction instanceof gp?this.interaction.play():this.interaction.dispatch()}dispose(){this.interaction.dispose()}},RF=(()=>{let e,t,r,i;function n(s){!e&&!IF()&&(t==null?void 0:t.sharedGameControlGlobals.createdObjects.length)>0&&(e=requestAnimationFrame(a)),s&&(t=s,i=s.requestRender)}function a(s){let l=r?s-r:0,c=t.sharedGameControlGlobals.createdObjects,u=t.sharedGameControlGlobals.nCreatedPerAction,d=c.length,h=0;for(;h<d;){let f=c[h];f.userData.createdTime===void 0&&(f.userData.createdTime=s),f.userData.lifetime===void 0&&f.userData.quantity===void 0||f.userData.lifetime&&s-f.userData.createdTime<f.userData.lifetime||f.userData.quantity&&u[f.userData.actionId]<=f.userData.quantity?(f.userData.velocity&&(f.position.addScaledVector(f.userData.velocity,l/1e3),f.updateMatrix(),i()),h++):(u[f.userData.actionId]>f.userData.quantity&&u[f.userData.actionId]--,c.splice(h,1),f.removeFromParent(),t.sharedGameControlGlobals.rapierWorld&&f.rigidBody?(t.sharedGameControlGlobals.colliderToEntity.delete(f.rigidBody.collider(0).handle),t.sharedGameControlGlobals.rapierWorld.removeRigidBody(f.rigidBody)):(f.bvhGeometry=void 0,t.sharedGameControlGlobals.entitiesWithTransformAnim=t.sharedGameControlGlobals.entitiesWithTransformAnim.filter(p=>p.bvhGeometry!==void 0)),d--,i())}e=h>0?requestAnimationFrame(a):void 0,r=h>0?s:void 0}function o(){IF()?e&&(cancelAnimationFrame(e),e=void 0,r=void 0):n()}return typeof document<"u"&&document.addEventListener("visibilitychange",o),n})();function IF(){return!!document&&document.hidden}var zF=new Kt,x6e=new k,w6e=new k,I7=class{constructor(e,t,r,i,n){this.data=e,this.page=t,this.controlsManager=r,this.shared=i,this.condition=n,this.intervalId=null,this.timeoutIdQueue=[],this.uniqueId=St.generateUUID(),this.dispatch=()=>{if(gi(this.shared,this.condition)===!1)return!1;this.data.delay?this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3)):this.dispatchInner()},this.dispatchFromStart=()=>{if(gi(this.shared,this.condition)===!1)return!1;this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3))},this.dispatchThrottled=LOe(this.dispatch,1e3/this.data.creationSpeed),this.dispatchStart=()=>{this.intervalId===null&&(this.intervalId=window.setInterval(this.dispatch,1e3/this.data.creationSpeed))},this.dispatchStop=()=>{this.intervalId!==null&&(window.clearInterval(this.intervalId),this.intervalId=null)},this.dispatchInner=()=>{this.timeoutIdQueue.shift();let o=new ya(this.object);if(o.playModeVisible=!0,o.expand(),this.data.coordinateSystem!=="world"){let l=this.data.coordinateSystem,c=this.page.scene.find(l);c&&(c.updateMatrixWorldSVD(),o.hiddenMatrix.copy(c.matrixWorldRigid))}o.scale.copy(this.object.scale),o.position.fromArray(this.data.position),o.rotation.fromArray(this.data.rotation),o.updateMatrix(),this.page.add(o);let s=this.controlsManager.sharedGameControlGlobals;s.createdObjects.push(o),s.nCreatedPerAction[this.uniqueId]===void 0?s.nCreatedPerAction[this.uniqueId]=1:s.nCreatedPerAction[this.uniqueId]++,o.updateWorldMatrix(!0,!0),o.traverseObject(this.traverseObjectCB),RF(),this.controlsManager.requestRender()},this.traverseObjectCB=o=>{var u,d,h,f;o.hasNonUniformScale&&o.updateMatrixWorldSVD();let s;if(this.controlsManager.sharedGameControlGlobals.rapierWorld){if(o instanceof ds)if(o.objectForSample){if(o.objectForSample.dataPatched.physics.fusedBody)return;s=o.object}else return o.object.dataPatched.physics.fusedBody===!0&&o.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(o instanceof ya)s=o.object;else if(s=o,(u=s.dataPatched.cloner)==null?void 0:u.hideBase)return!0}else{if(o instanceof ds)return;o instanceof ya?s=o.object:s=o}this.data.destroy==="Time"?o.userData.lifetime=this.data.lifetime*1e3:this.data.destroy==="Quantity"&&(o.userData.quantity=this.data.destroyAfterQuantity,o.userData.actionId=this.uniqueId);let l=new k().fromArray(this.data.velocity),c=s.dataPatched;if(!(c.physics.enabled==="visibility"?!c.visible:!c.physics.enabled)&&(this.controlsManager.sharedGameControlGlobals.rapierWorld?(this.controlsManager.addRigidBody(o,s,{fromCreate:!0,dynamic:this.data.dynamic}),this.data.destroy==="Collision"&&((d=o.rigidBody)==null||d.collider(0).setActiveEvents(1),o.userData.hasCollisionDestroy=!0),o.matrixWorld.decompose(x6e,zF,w6e),l.applyQuaternion(zF),this.data.velocity.some(p=>p!==0)&&this.data.dynamic&&((h=o.rigidBody)==null||h.setLinvel(l.divideScalar(this.controlsManager.pixelsPerMeter),!0))):("geometry"in o.object&&this.controlsManager.addBoundsTree(o),this.data.velocity.some(p=>p!==0)&&this.data.dynamic&&(o.userData.velocity=l)),((f=s.dataPatched.physics)==null?void 0:f.fusedBody)===!0))return!0};let a=this.page.scene.find(this.data.object);if(!a)throw new Error("Missing Property");if(this.object=a,this.data.coordinateSystem!=="world"&&!this.page.scene.find(this.data.coordinateSystem))throw new Error("Missing Property");RF(r)}dispose(){this.intervalId!==null&&(window.clearInterval(this.intervalId),this.intervalId=null),this.timeoutIdQueue.forEach(e=>window.clearTimeout(e)),this.dispatchThrottled.cancel(),this.page.remove(...this.controlsManager.sharedGameControlGlobals.createdObjects),this.controlsManager.sharedGameControlGlobals.createdObjects=[]}},z7=200,K_=.02,Q_=.3,S6e=65;new k;var kF=new k,LF=new k,C6e=new k,Ma=new k,Ha=new k,$c=new k,Z_=new it,BF=new it,_6e=new it;new it;var ts=new Kt,zl=new Kt,Fs=new bn(0,0,0,"YXZ"),A6e=new k(1,0,0),rs=new k(0,1,0),M6e=new k(0,0,1),FF=new k(1,1,1);new ao;var E6e=1,T6e=.025,P6e=16e-6,NF=12,D6e=20,Pn=new jo,Ao=new Ji,O6e={type:"requestRender"},R6e={type:"updateMatrix"},UF=Math.PI/6,sT=class extends ca{constructor(e,t,r,i,n,a,o,s,l){var p;super(),this.object=e,this.domElement=t,this.data=r,this.gloabalPhysics=i,this.controlsManager=n,this.cameraFollow=a,this.camera=o,this.page=s,this.sharedAssets=l,this.enableDamping=!0,this.hiddenMatrix0=new it,this.target0=new k,this.zoom0=1,this.rotForce=1,this.moveForce=1,this.pixelsPerMeter=z7,this.euler0=new bn(0,0,0,"YXZ"),this.position0Cam=new k,this.quat0Cam=new Kt,this.scale0Cam=new k,this.hiddenMatrix0Cam=new it,this.threshEndTranslate=.01,this.threshEndRotate=1e-8,this.threshEndRotVel=.005,this.collider={type:"capsule",radius:40,segment:new jo(new k(0,-40,0),new k(0,40,0)),matrix:new it,position:new k,rotation:new Kt},this.euler=new bn(0,0,0,"YXZ"),this.eulerDelta=new k,this.lastPosition=new k,this.lastCameraQuaternion=new Kt,this.lastCameraPosition=new k,this.PI_2=Math.PI/2,this.prevMouse=new ye,this.velocityTarget=new k,this.velocity=new k,this.directionXZ=new k,this.rotVelocityStick=new k,this.rotVelocityTarget=new k,this.rotVelocity=new k,this.rotDirection=new k,this.nonColliderRotOffset=new it,this.nonColliderPosOffset=new it,this.firstPointerId=-1,this.rot=new k,this.path=[],this.movementState={moveNegZ:0,movePosZ:0,moveNegX:0,movePosX:0,moveNegY:0,movePosY:0,rotPosX:0,rotNegX:0,rotPosY:0,rotNegY:0,jump:0,run:0},this.vrEulerYOffset=0,this.onObject=!1,this.actionState={},this.keyAssignments=[["moveNegZ","W"],["moveNegX","A"],["movePosZ","S"],["movePosX","D"],["rotPosX","ArrowUp"],["rotPosY","ArrowLeft"],["rotNegX","ArrowDown"],["rotNegY","ArrowRight"],["jump"," "]],this.collisionEnabled=!0,this.offsetMatrix=new it,this.objectToTarget=new k,this.objectToTarget0=new k,this.objectToCamXZ=new k,this.objectToCamXZ0=new k,this.targetToCamera=new k,this.targetToCamera0=new k,this.cameraPolarAxis0=new k,this.targetPos=new k,this.targetQuat=new Kt,this.lerpFactorPos=new k().setScalar(.3),this.lerpFactorPosStart=.3,this.lerpFactorPosEnd=.3,this.lerpFactorRotStart=.3,this.lerpFactorRotEnd=.3,this.lerpFactorPosCamera=.3,this.lerpFactorRotCamera=.3,this.objXZQuat=new Kt,this.objXZQuatInv=new Kt,this.objXZRotMat=new it,this.isFirstPerson=!1,this.didHit=!1,this.groundVelocity=new k,this.pushedVelocity=new k,this.groundYRotation=0,this.objectRealQuat=new Kt,this.colliderWorldQuat=new Kt,this.groundNormal=new k,this.groundTilt=new Kt,this.groundTiltInv=new Kt,this.lastHitObj=null,this.isFirstFrame=!0,this.rotationAccumWhenOrientWithCamera=0,this.navMeshPathDest=null,this.position=new k,this.quaternion=new Kt,this.scale=new k,this.initialAction=!0,this.onPointerDown=v=>{var m;!(v.target===this.domElement||v.target instanceof HTMLElement&&v.target.tagName==="SPLINE-VIEWER"&&((m=v.target.shadowRoot)!=null&&m.contains(this.domElement)))||this.firstPointerId!==-1||(this.firstPointerId=v.pointerId,this.domElement.ownerDocument.addEventListener("pointermove",this.onPointerMove),this.domElement.ownerDocument.addEventListener("pointerup",this.onPointerUp),this.rotBy!=="keys"&&!vo&&!vL&&this.domElement.requestPointerLock(),this.prevMouse.set(v.clientX,v.clientY))},this.onPointerUp=v=>{this.firstPointerId=-1,this.domElement.ownerDocument.removeEventListener("pointermove",this.onPointerMove),this.domElement.ownerDocument.removeEventListener("pointerup",this.onPointerUp),v.pointerType==="mouse"&&this.domElement.ownerDocument.exitPointerLock()},this.onPointerMove=v=>{if(v.pointerId!==this.firstPointerId)return;let m=v.clientX-this.prevMouse.x,g=v.clientY-this.prevMouse.y;this.prevMouse.set(v.clientX,v.clientY),v.pointerType==="mouse"&&this.rotBy!=="keys"&&(vL&&$Oe<15.5&&!vo?(this.eulerDelta.y=-m*this.mouseOrbitSensitivity,this.eulerDelta.x=-g*this.mouseOrbitSensitivity):(this.eulerDelta.y=-v.movementX*this.mouseOrbitSensitivity,this.eulerDelta.x=-v.movementY*this.mouseOrbitSensitivity)),v.pointerType!=="mouse"&&this.rotByTouch==="drag"&&(this.eulerDelta.y=-m*this.mouseOrbitSensitivity*5,this.eulerDelta.x=-g*this.mouseOrbitSensitivity*5),this.controlsManager.requestRender()},this.onPointerlockChange=v=>{this.domElement.ownerDocument.pointerLockElement===this.domElement?sT.isLocked=!0:sT.isLocked=!1},this.onPointerlockError=()=>{console.error("SPE.GameControls: Unable to use Pointer Lock API")},this.handleVisibilityChange=()=>{if(document!=null&&document.hidden)for(let v in this.movementState)this.movementState[v]=0},this.onKeyDown=v=>{!(v.target instanceof HTMLInputElement)&&(v.code==="ArrowLeft"||v.code==="ArrowUp"||v.code==="ArrowRight"||v.code==="ArrowDown"||v.code==="Space")&&v.preventDefault();for(let m of this.keyAssignments)if(v.key.toUpperCase()===m[1]||v.key===m[1]){this.movementState[m[0]]=1;break}this.controlsManager.requestRender()},this.onKeyUp=v=>{for(let m of this.keyAssignments)if(v.key.toUpperCase()===m[1]||v.key===m[1]||v.code.slice(3,v.code.length).toUpperCase()===m[1]){this.movementState[m[0]]=0;break}},this.copyVRGamePadValues=(v,m)=>{for(let g=2;g<4;g++){let y=v.axes[g];m===0?g===2?this.movementState.movePosX=y:this.movementState.movePosZ=y:(v.buttons[3].pressed?this.movementState.jump=1:this.movementState.jump=0,g===2?(Math.abs(this.movementState.rotPosY)<.3&&Math.abs(y)>=.3&&(this.vrEulerYOffset+=y<0?1:-1),this.movementState.rotPosY=y):this.moveMode==="fly"&&(this.movementState.moveNegY=y))}},this.sharedGameControlGlobals=n.sharedGameControlGlobals,e===o&&(this.isFirstPerson=!0),this.hiddenMatrix0.copy(this.object.hiddenMatrix),this.object.parent?this.object.hiddenMatrix.copy(this.object.parent.matrixWorld).invert():this.object.hiddenMatrix.identity(),this.object.matrix.copy(this.object.matrixWorld),this.object.matrix.decompose(this.position,this.quaternion,this.scale),this.euler0.setFromQuaternion(this.quaternion,"YXZ");let c=this.euler0.clone(),u=c.y;if(this.objectRealQuat.copy(this.quaternion),c.y=0,this.quaternion.setFromEuler(c),this.objXZQuat.copy(this.quaternion),this.objXZQuatInv.copy(this.objXZQuat).invert(),this.objXZRotMat.makeRotationFromQuaternion(this.quaternion),c.set(0,u,0),this.quaternion.setFromEuler(c),this.rot.setFromEuler(c),this.object.matrixAutoUpdate=!1,(this.isFirstPerson||this.cameraFollow===!0)&&(this.target0.copy(this.camera.getTarget()),this.zoom0=this.camera.zoom),this.cameraFollow===!0){this.position0Cam.copy(this.camera.position),this.quat0Cam.copy(this.camera.quaternion),this.scale0Cam.copy(this.camera.scale),this.hiddenMatrix0Cam.copy(this.camera.hiddenMatrix),this.camera.parent?(this.camera.hiddenMatrix.copy((p=this.camera)==null?void 0:p.parent.matrixWorld),this.camera.matrix.copy(this.camera.matrixWorld)):this.camera.hiddenMatrix.identity(),this.camera.matrix.copy(this.camera.matrixWorld),this.camera.matrix.decompose(this.camera.position,this.camera.quaternion,this.camera.scale),this.camera.matrixAutoUpdate=!1,this.offsetMatrix.copy(this.object.matrix).invert().multiply(this.camera.matrix);let v=new k(0,0,-1).applyQuaternion(this.camera.quaternion),m=new k().subVectors(this.position,this.camera.position);this.objectToCamXZ.copy(m),this.objectToCamXZ.y=0,this.objectToCamXZ0.copy(this.objectToCamXZ);let g,y;Math.abs(v.y)<1e-6?(m.y=0,v.y=0,y=m.projectOnVector(v)):m.y/v.y>0?y=v.multiplyScalar(m.y/v.y):y=v.multiplyScalar(m.length()),this.targetToCamera0.copy(y).negate(),g=this.camera.position.clone().add(y),this.objectToTarget0.subVectors(g,this.position);let b=new bn().setFromQuaternion(this.camera.quaternion,"YXZ");this.cameraPolarOffset=-b.x,b.x=0,b.z=0,b.y-=Math.PI/2,this.cameraPolarAxis0.set(0,0,-1).applyEuler(b)}if(this.object instanceof xa&&(this.object.matrixAutoUpdate=!1),this.euler.setFromQuaternion(this.quaternion,"YXZ"),this.rotByTouch=r.rotByTouch??"joystick",this.rotBy=r.rotBy??"keys",this.rotationMode=r.rotationMode??"normal",this.moveMode=r.moveMode??"walk",this.collisionEnabled=r.collisionEnabled,this.speedTranslate=(r.speedTranslate??250)*E6e,this.speedOrbit=(r.speedRotate??100)*T6e,this.mouseOrbitSensitivity=(r.speedRotate??100)*P6e,this.keyAssignments=r.keyAssignments.map(v=>{let m=[v[0],v[1]];return m[1]===""?m[1]="ArrowUp":m[1]===""?m[1]="ArrowLeft":m[1]===""?m[1]="ArrowDown":m[1]===""?m[1]="ArrowRight":m[1]===""?m[1]="Shift":m[1]===""?m[1]="Enter":m[1]==="Space"?m[1]=" ":m[1]===""?m[1]="Meta":m[1]==="Ctrl"?m[1]="Control":m[1]==="Esc"&&(m[1]="Escape"),m}),r.rotBy==="mouse"){let v;v=this.keyAssignments.findIndex(m=>m[0]==="rotNegX"),v!==-1&&(this.keyAssignments[v][1]=""),v=this.keyAssignments.findIndex(m=>m[0]==="rotPosX"),v!==-1&&(this.keyAssignments[v][1]=""),v=this.keyAssignments.findIndex(m=>m[0]==="rotPosY"),v!==-1&&(this.keyAssignments[v][1]=""),v=this.keyAssignments.findIndex(m=>m[0]==="rotNegY"),v!==-1&&(this.keyAssignments[v][1]="")}this.lerpFactorPosStart=1-.02**(1/((r.delayPos[0]??.3)*60)),this.lerpFactorPosEnd=1-.02**(1/((r.delayPos[1]??.3)*60)),this.lerpFactorPos.setScalar(this.lerpFactorPosStart),this.lerpFactorRotStart=1-.02**(1/((r.delayRot[0]??.3)*60)),this.lerpFactorRotEnd=1-.02**(1/((r.delayRot[1]??.3)*60)),this.lerpFactorPosCamera=1-.02**(1/((r.delayPosCamera??.3)*60)),this.lerpFactorRotCamera=1-.02**(1/((r.delayRotCamera??.3)*60)),this.gravity=(this.gloabalPhysics.gravity??Hp.defaultData.gravity)*NF,this.usePhysics=this.gloabalPhysics.usePhysics??Hp.defaultData.usePhysics,this.jumpPower=r.jumpPower*D6e,this.resetYPosition=this.position.y+Math.abs(r.resetYPosition)*(this.gravity>0?1:-1),this.alignToGround=r.alignToGround??!1,this.orientMode=r.autoOrientMove?r.orientMode:"none",this.orientWith=r.orientWith??x1.defaultDataThirdPerson.orientWith,this.slopeThresh=S6e*Math.PI/180,r.collider.type==="capsule"?(this.collider.radius=r.collider.radius,this.collider.segment.start.y=r.collider.height/2-r.collider.radius,this.collider.segment.end.y=-this.collider.segment.start.y,this.offset=r.collider.height*K_/this.pixelsPerMeter,this.stepThresh=r.collider.height*Q_/this.pixelsPerMeter,this.colliderHeight=r.collider.height):r.collider.type==="sphere"?(this.collider.radius=r.collider.radius,this.collider.segment.start.y=0,this.collider.segment.end.y=0,this.offset=2*r.collider.radius*K_/this.pixelsPerMeter,this.stepThresh=2*r.collider.radius*Q_/this.pixelsPerMeter,this.colliderHeight=r.collider.radius*2):(this.offset=r.collider.height*K_/this.pixelsPerMeter,this.stepThresh=r.collider.height*Q_/this.pixelsPerMeter,this.colliderHeight=r.collider.height),this.collider.type=r.collider.type;let d=new k().fromArray(r.collider.position),h=new Kt().setFromEuler(new bn().fromArray([...r.collider.rotation,"XYZ"]));this.collider.position.copy(d).multiply(this.scale),this.collider.rotation.copy(h),this.collider.matrix.compose(d,h,FF),r.cameraXAxis!==void 0&&(this.cameraXAxis=r.cameraXAxis,this.cameraYAxis=r.cameraYAxis,this.minPolarAngle=r.cameraRotXLimits[0],this.maxPolarAngle=r.cameraRotXLimits[1],this.minAzimuthAngleRel=r.cameraRotYLimits[0],this.maxAzimuthAngleRel=r.cameraRotYLimits[1]),this.forwardDir=r.forwardDirection??"-z",this.isFirstPerson&&(this.forwardDir="-z"),this.runMultiplier=r.runMultiplier??2;let f=r.navmesh.destinationHelperRadius*2;if(f>0){let v=new Dt;v.push({fi:0,data:{...On.defaultData("light","phong"),alpha:0},id:"layer1"}),v.push({fi:0,data:{...On.defaultData("color"),color:r.navmesh.destinationHelperColor,alpha:r.navmesh.destinationHelperColor.a},id:"layer2"});let m=new GD({layers:v},{scene:this.page.scene,shared:this.sharedAssets});this.navMeshPathDest=new Oi(fW.create({parameters:{width:f,height:f/10,hollow:.7}}),m),this.navMeshPathDest.material.userData.opacity0=r.navmesh.destinationHelperColor.a}this.activate()}reset(e=!1){if(this.object.hiddenMatrix.copy(this.hiddenMatrix0),e){this.object.updateMatrix(),this.object.updateMatrixWorld(),this.object.matrix.copy(this.object.matrixWorld),this.object.matrix.decompose(this.position,this.quaternion,this.scale),this.object.parent?this.object.hiddenMatrix.copy(this.object.parent.matrixWorld).invert():this.object.hiddenMatrix.identity();let t=new bn().setFromQuaternion(this.quaternion,"YXZ"),r=t.y;this.objectRealQuat.copy(this.quaternion),t.y=0,this.quaternion.setFromEuler(t),this.objXZQuat.copy(this.quaternion),this.objXZQuatInv.copy(this.objXZQuat).invert(),this.objXZRotMat.makeRotationFromQuaternion(this.quaternion),t.set(0,r,0),this.quaternion.setFromEuler(t),this.rot.setFromEuler(t),this.euler.setFromQuaternion(this.quaternion,"YXZ"),this.velocityTarget.set(0,0,0),this.velocity.set(0,0,0)}else this.object instanceof xa?this.object.matrixAutoUpdate=!0:this.object.updateMatrix();this.cameraFollow===!0&&(this.camera.quaternion.copy(this.quat0Cam),this.camera.position.copy(this.position0Cam),this.camera.scale.copy(this.scale0Cam),this.camera.hiddenMatrix.copy(this.hiddenMatrix0Cam),this.camera.matrixAutoUpdate=!0),this.controlsManager.requestRender()}activate(){this.instantiateActions(),this.domElement.ownerDocument.addEventListener("pointerdown",this.onPointerDown),this.domElement.ownerDocument.addEventListener("keydown",this.onKeyDown),this.domElement.ownerDocument.addEventListener("keyup",this.onKeyUp),this.domElement.ownerDocument.addEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.addEventListener("pointerlockerror",this.onPointerlockError),this.domElement.ownerDocument.addEventListener("visibilitychange",this.handleVisibilityChange)}deactivate(){this.disposeActions(),this.domElement.ownerDocument.removeEventListener("pointerdown",this.onPointerDown),this.domElement.ownerDocument.removeEventListener("keydown",this.onKeyDown),this.domElement.ownerDocument.removeEventListener("keyup",this.onKeyUp),this.domElement.ownerDocument.removeEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.removeEventListener("pointerlockerror",this.onPointerlockError),this.domElement.ownerDocument.removeEventListener("visibilitychange",this.handleVisibilityChange)}dispose(){var e;this.deactivate(),(e=this.navMeshPathDest)!=null&&e.parent&&this.page.remove(this.navMeshPathDest)}instantiateActions(){let e=this.data,t=this.sharedAssets;e.gameActions!==void 0&&(this.actions={},b1.list.forEach(r=>{this.actions[r]=$n({...e,disabled:!1,type:"GameControl"},e.gameActions[r],this.page,t,this.controlsManager.eventManager,this.object)})),this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.dispatchStopEvent("jump"),this.dispatchStartEvent("idle"),this.initialAction&&(this.initialAction=!1)}disposeActions(){this.initialAction=!1,this.dispatchStopEvent("idle"),this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.dispatchStopEvent("jump"),jn(this.actions.idle),jn(this.actions.move),jn(this.actions.run),jn(this.actions.jump)}dispatchStartEvent(e){this.actions[e]!==void 0&&(this.actionState[e]||(this.actionState[e]=!0,this.actions[e].Transition.forEach(t=>{t.play()}),this.actions[e].Animation.forEach(t=>{t.play(this.initialAction===!1)}),this.actions[e].Create.forEach(t=>{t.dispatchStart()}),this.actions[e].Audio.forEach(t=>{t.dispatchGameControl("start")}),this.actions[e].Particles.forEach(t=>{t.dispatchGameControl("start")})))}dispatchStopEvent(e){this.actions[e]!==void 0&&(!this.actionState[e]||(this.actionState[e]=!1,this.actions[e].Transition.forEach(t=>{t.stop(),t.object.currentState!==null&&t.object.changeSelectedState(null,{scene:this.page.scene,shared:this.sharedAssets})}),this.actions[e].Create.forEach(t=>{t.dispatchStop()}),this.actions[e].Audio.forEach(t=>{t.dispatchGameControl("stop")}),this.actions[e].Particles.forEach(t=>{t.dispatchGameControl("stop")})))}get colliderWorldPosition(){return Ma.copy(this.collider.position).applyQuaternion(this.objectRealQuat).add(this.position)}update(e,t,r){var s,l,c,u,d,h,f,p,v;if(this.gravity<0?this.position.y<this.resetYPosition:this.position.y>this.resetYPosition)return this.reset(!0),!0;this.sharedGameControlGlobals.gamePads.forEach(this.copyVRGamePadValues);let i=(this.isFirstFrame?16.6:e)/1e3;this.isFirstFrame&&(this.isFirstFrame=!1);let n=i*60,a=!1;if(this.usePhysics&&this.collisionEnabled){let m=Ha.set(0,(this.velocity.y===0?this.pixelsPerMeter*Math.max(Math.abs(this.gravity)/(10*NF),1)*(this.gravity>0?1:-1):this.velocity.y)*i,0).divideScalar(this.pixelsPerMeter),g=this.sharedGameControlGlobals.rapierWorld.castShape(this.colliderWorldPosition.divideScalar(this.pixelsPerMeter),this.colliderWorldQuat,m,(s=this.object.rigidBody)==null?void 0:s.collider(0).shape,1,!1,16,void 0,void 0,this.object.rigidBody);if(g){this.onObject=!0,this.groundNormal.set(g.normal2.x,g.normal2.y,g.normal2.z).applyQuaternion(this.colliderWorldQuat).negate(),this.alignToGround&&this.groundTiltAdjustment(this.groundNormal),Math.acos(this.groundNormal.y)<this.slopeThresh&&(a=!0),((l=g.collider.parent())==null?void 0:l.bodyType())===0&&Math.acos(this.groundNormal.y)*(180/Math.PI)>45&&(this.onObject=!1);let y=g.collider.parent();this.groundYRotation=0,this.groundVelocity.set(0,0,0);for(let b of this.sharedGameControlGlobals.entitiesWithTransformAnim)if(b.rigidBody===y&&b.userData.isFollowingObj!==this.object.uuid){(b.hasNonUniformScale?b.matrixWorldRigid:b.matrixWorld).decompose(Ma,zl,Ha),this.groundVelocity.subVectors(Ma,b.prevT),this.object.getWorldPosition(Ha).add(this.collider.position).sub(Ma),this.groundYRotation=Fs.setFromQuaternion(zl).y-b.prevR.y,$c.copy(Ha).applyAxisAngle(rs,this.groundYRotation),this.groundVelocity.add($c.sub(Ha)).divideScalar(i);break}}else this.onObject=!1}if(this.moveMode==="walk"&&this.collisionEnabled&&(this.movementState.jump===1&&this.onObject&&(this.velocityTarget.y=this.jumpPower,this.movementState.jump=0,this.dispatchStopEvent("idle"),this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.dispatchStopEvent("jump"),this.dispatchStartEvent("jump"),this.onObject=!1),this.onObject?this.velocityTarget.y/=2:this.velocityTarget.y+=this.gravity*n),this.moveMode==="fly"&&(this.velocityTarget.y=(this.movementState.movePosY-this.movementState.moveNegY)*this.speedTranslate),this.directionXZ.z=this.movementState.movePosZ-this.movementState.moveNegZ,this.directionXZ.x=this.movementState.movePosX-this.movementState.moveNegX,this.forwardDir==="+z"&&this.directionXZ.multiplyScalar(-1),this.directionXZ.manhattanLength()>0&&(this.path=[]),this.navMeshPathDest){let m=this.navMeshPathDest.material;if(this.moveMode==="walk"&&this.path.length>1){this.navMeshPathDest.position.copy(this.path[this.path.length-1]),this.navMeshPathDest.parent||this.page.add(this.navMeshPathDest);let g=Ma.subVectors(this.path[1],this.position),y=Ha.subVectors(this.path[1],this.path[0]);g.dot(y)<0?this.path.shift():(this.directionXZ.x=y.x,this.directionXZ.z=y.z),m.opacity=m.userData.opacity0}else m.opacity-=.05*m.userData.opacity0,this.navMeshPathDest.material.opacity<=0&&this.navMeshPathDest.parent&&this.page.remove(this.navMeshPathDest)}this.directionXZ.normalize(),this.movementState.run?this.moveForce=this.runMultiplier:this.moveForce=1,this.velocityTarget.z=this.directionXZ.z*this.speedTranslate*this.moveForce,this.velocityTarget.x=this.directionXZ.x*this.speedTranslate*this.moveForce,(this.moveMode==="walk"?this.velocityTarget.x+this.velocityTarget.z===0:this.velocityTarget.manhattanLength()===0)?this.lerpFactorPos.setScalar(this.lerpFactorPosEnd):this.lerpFactorPos.setScalar(this.lerpFactorPosStart),this.moveMode==="walk"&&(this.lerpFactorPos.y=1),this.didHit===!1&&this.pushedVelocity.manhattanLength()===0||this.usePhysics===!1?(this.velocity.x+=(this.velocityTarget.x-this.velocity.x)*(1-(1-this.lerpFactorPos.x)**n),this.velocity.y+=(this.velocityTarget.y-this.velocity.y)*(1-(1-this.lerpFactorPos.y)**n),this.velocity.z+=(this.velocityTarget.z-this.velocity.z)*(1-(1-this.lerpFactorPos.z)**n)):this.velocity.copy(this.velocityTarget),(this.moveMode==="walk"?this.velocity.x**2+this.velocity.z**2<this.speedTranslate:this.velocity.lengthSq()<this.speedTranslate)?(this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.onObject&&(this.dispatchStopEvent("jump"),this.dispatchStartEvent("idle"))):(this.dispatchStopEvent("idle"),this.onObject&&(this.dispatchStopEvent("jump"),this.movementState.run?(this.dispatchStopEvent("move"),this.dispatchStartEvent("run")):(this.dispatchStopEvent("run"),this.dispatchStartEvent("move"))));let o=C6e.copy(this.velocity);if(this.orientMode!=="none"&&this.isFirstPerson===!1){let m=Ha.copy(o);m.y=0,o.set(0,o.y,m.length()*(this.forwardDir==="+z"?1:-1))}if(this.directionXZ.manhattanLength()>0&&this.orientMode!=="none"&&this.isFirstPerson===!1)if(this.orientWith==="camera"&&this.path.length<=1){let m=Ma;this.camera.getWorldDirection(m);let g=$c.copy(rs).multiplyScalar(m.dot(rs));m.sub(g);let y=Ha.copy(this.directionXZ);y.x*=-1,this.rot.y=m.angleTo(y)*(m.cross(y).y>0?-1:1)+this.rotationAccumWhenOrientWithCamera}else this.rot.y=(this.path.length>1?0:this.euler.y)+Math.atan2(-this.directionXZ.z,this.directionXZ.x)+Math.PI/2*(this.forwardDir==="+z"?1:-1);if(Fs.setFromVector3(this.rot),this.moveMode==="walk"&&(Fs.x=0),o.applyEuler(Fs),a&&(zl.setFromUnitVectors(rs,this.groundNormal),o.applyQuaternion(zl)),r){let m=Fs.set(0,this.vrEulerYOffset*UF,0);r.applyEuler(m),o.x+=r.x,o.z+=r.z,this.nonColliderPosOffset.elements[13]+=r.y*i}if(this.usePhysics===!0){let m=Ha;this.pushedVelocity.set(0,0,0);for(let g of this.sharedGameControlGlobals.entitiesWithTransformAnim){let y=$c.setFromMatrixPosition(g.matrixWorld).sub(g.prevT).divideScalar(i).divideScalar(this.pixelsPerMeter),b=g.rigidBody.collider(0).castCollider(y,this.object.rigidBody.collider(0),Ma.copy(o).divideScalar(this.pixelsPerMeter),i,!1);y.multiplyScalar(this.pixelsPerMeter);let x=_r.is(g)?g:g.object;if(b!==null&&this.lastHitObj!==x){let S;g instanceof ya&&(S=g);let w=this.sharedGameControlGlobals.entityToCollisionEvents[x.uuid];if(w)for(let _ of w)_.data.target==="character"&&(_.dispatch(S),x.dispatchEvent(cT));this.lastHitObj=x}if(b!==null){this.pushedVelocity.copy(y),m.copy(b.normal1).applyQuaternion(g.quaternion);break}}if(this.pushedVelocity.manhattanLength()!==0){let g=m.dot(o);g<0&&o.addScaledVector(m,-g),o.add(this.pushedVelocity)}else o.add(this.groundVelocity)}if(this.rotDirection.y=Number(this.movementState.rotPosY)-Number(this.movementState.rotNegY),this.rotDirection.x=Number(this.movementState.rotPosX)-Number(this.movementState.rotNegX),this.rotDirection.normalize(),this.rotationMode==="normal"&&(this.movementState.rotPosX||this.movementState.rotNegX)||this.rotationMode==="steer"&&(this.movementState.rotPosX||this.movementState.rotNegX)&&(this.movementState.movePosZ||this.movementState.moveNegZ||this.moveMode==="walk")?this.rotVelocityStick.x=-this.rotDirection.x*this.speedOrbit*this.rotForce:this.rotVelocityStick.x=0,this.rotationMode==="normal"&&(this.movementState.rotPosY||this.movementState.rotNegY)||this.rotationMode==="steer"&&(this.movementState.rotPosY||this.movementState.rotNegY)&&(this.movementState.movePosZ||this.movementState.moveNegZ)?this.rotVelocityStick.y=-this.rotDirection.y*this.speedOrbit*this.rotForce:this.rotVelocityStick.y=0,this.rotVelocityTarget.subVectors(this.eulerDelta.divideScalar(i),this.rotVelocityStick),this.rotVelocityTarget.manhattanLength()===0?this.rotVelocity.lerp(this.rotVelocityTarget,1-(1-this.lerpFactorRotEnd)**n):this.rotVelocity.lerp(this.rotVelocityTarget,1-(1-this.lerpFactorRotStart)**n),this.euler.x+=this.rotVelocity.x*i,this.euler.y+=this.rotVelocity.y*i+this.groundYRotation,this.rotVelocityTarget.y===0&&this.directionXZ.manhattanLength()===0?this.rotationAccumWhenOrientWithCamera=0:(this.cameraFollow===!1||this.cameraYAxis==="Locked")&&(this.rotationAccumWhenOrientWithCamera+=this.rotVelocity.y*i),this.isFirstPerson===!1&&this.orientMode!=="none"&&this.directionXZ.manhattanLength()>0){if(this.orientMode==="radial"){this.objectToCamXZ.copy(this.objectToCamXZ0).applyAxisAngle(rs,this.euler.y-this.euler0.y);let m=Ha.copy(this.objectToCamXZ).normalize(),g=$c.copy(o).multiplyScalar(i);g.y=0;let y=g.sub(Ma.copy(m).multiplyScalar(g.dot(m))).cross(m).y;this.euler.y-=Math.atan2(y,this.objectToCamXZ.length())}}else this.rot.y+=this.rotVelocity.y*i+this.groundYRotation,this.rotVelocityTarget.y!==0&&(this.cameraFollow===!1||this.cameraYAxis==="Locked")&&(this.euler.y=this.rot.y);if(this.cameraFollow===!0&&(this.moveMode==="walk"?this.cameraXAxis==="Limit"?this.euler.x=St.clamp(this.euler.x,-this.maxPolarAngle+this.cameraPolarOffset+1e-6,-this.minPolarAngle+this.cameraPolarOffset-1e-6):this.euler.x=St.clamp(this.euler.x,-this.PI_2+this.cameraPolarOffset,this.PI_2+this.cameraPolarOffset):this.cameraXAxis==="Limit"&&(this.euler.x=St.clamp(this.euler.x,-this.PI_2,this.PI_2))),this.moveMode==="fly"?this.rot.x=this.euler.x:this.isFirstPerson&&(t?(Fs.copy(t),Fs.y=0):(Fs.copy(this.euler),Fs.y=0),this.nonColliderRotOffset.makeRotationFromEuler(Fs)),t&&(this.moveMode==="walk"?(this.rot.y=t.y,this.rot.x=0,this.rot.z=0):this.rot.setFromEuler(t),this.rot.y+=this.vrEulerYOffset*UF),ts.setFromAxisAngle(A6e,this.rot.x),zl.setFromAxisAngle(rs,this.rot.y),zl.multiply(ts),ts.setFromAxisAngle(M6e,this.rot.z),zl.multiply(ts),this.quaternion.copy(zl),this.objectRealQuat.multiplyQuaternions(this.quaternion,this.objXZQuat),this.colliderWorldQuat.copy(this.objectRealQuat).multiply(this.collider.rotation),this.collisionEnabled)if(this.usePhysics){let m=Ha.copy(o).multiplyScalar(i/this.pixelsPerMeter),g=null;this.didHit=!1;let y=new k;for(let b=0;b<5;b++){let x=m.length(),S=$c.copy(m).normalize();if(g=this.sharedGameControlGlobals.rapierWorld.castShape(this.colliderWorldPosition.divideScalar(this.pixelsPerMeter).add(y),this.colliderWorldQuat,S,(c=this.object.rigidBody)==null?void 0:c.collider(0).shape,x,!1,24,void 0,void 0,this.object.rigidBody),g!==null){this.didHit=!0;let w=this.sharedGameControlGlobals.colliderToEntity.get(g.collider.handle);if(w!==this.lastHitObj&&b===0){this.lastHitObj=w;let M=this.sharedGameControlGlobals.entityToCollisionEvents[w==null?void 0:w.uuid];if(M){for(let P of M)if(P.data.target==="character"){let T=((u=this.sharedGameControlGlobals.rapierWorld)==null?void 0:u.getCollider(g.collider.handle))._parent,R;if(w.cloner){for(let z of w.cloner.children)if(z.rigidBody===T){R=z;break}}P.dispatch(R),w.dispatchEvent(cT)}}}let _=kF.set(g.normal2.x,g.normal2.y,g.normal2.z).applyQuaternion(this.colliderWorldQuat),C=LF.copy(S).multiplyScalar(g.toi).dot(_),A=g.toi;if(A===0&&(this.position.y+=this.offset*this.pixelsPerMeter),C>this.offset&&(A=g.toi*(C-this.offset)/C,y.addScaledVector(S,A)),m.copy(S).multiplyScalar(x-A),Math.acos(-_.y)>this.slopeThresh){let M=this.colliderWorldPosition.divideScalar(this.pixelsPerMeter).add(y),P=$c.copy(g.witness2).applyQuaternion(this.colliderWorldQuat);P.y=0;let T=M.add(P);T.y+=this.stepThresh;let R=this.sharedGameControlGlobals.rapierWorld.castShape(T,this.colliderWorldQuat,m,(d=this.object.rigidBody)==null?void 0:d.collider(0).shape,1,!1,24,void 0,void 0,this.object.rigidBody);R!==null&&R.toi===0&&(_.y=0,_.normalize())}m.addScaledVector(_,-m.dot(_))}else{b===0&&this.directionXZ.manhattanLength()!==0&&(this.lastHitObj=null),y.add(m);break}}this.position.addScaledVector(y,this.pixelsPerMeter),(h=this.object.rigidBody)==null||h.setTranslation(Ma.copy(this.position).divideScalar(this.pixelsPerMeter),!0),(f=this.object.rigidBody)==null||f.setRotation(ts.copy(this.quaternion).premultiply(this.groundTilt).multiply(this.objXZQuat),!0)}else{let m=this.onObject?1:5,g=o.multiplyScalar(i/m);for(let y=0;y<m;y++)this.position.add(g),this.collisionAdjustment(i/m)}else this.position.addScaledVector(o,i);if(this.moveMode==="walk"&&this.onObject&&(this.velocityTarget.y=0,this.velocity.y=0),this.quaternion.premultiply(this.groundTilt).multiply(this.objXZQuat),this.object.matrix.compose(this.position,this.quaternion,this.scale),this.object.matrixWorldNeedsUpdate=!0,this.object.matrix.multiply(this.nonColliderPosOffset).multiply(this.nonColliderRotOffset),this.quaternion.premultiply(this.groundTiltInv).multiply(this.objXZQuatInv),this.cameraFollow===!0){this.updateFollowArms();let m=this.objectToTarget.add(this.position),g=this.targetToCamera.add(m);Z_.lookAt(g,m,rs).setPosition(g),Z_.decompose(this.targetPos,this.targetQuat,Ma),this.camera.quaternion.slerp(this.targetQuat,1-(1-this.lerpFactorRotCamera)**n),this.camera.position.lerp(this.targetPos,1-(1-this.lerpFactorPosCamera)**n),this.camera.updateMatrix(),this.camera.updateMatrixWorld(),this.cameraYAxis==="Limit"&&this.orientMode==="cartesian"&&(this.euler.y=St.clamp(this.euler.y,this.minAzimuthAngleRel,this.maxAzimuthAngleRel)),this.euler.x=St.clamp(this.euler.x,-this.PI_2+(this.cameraPolarOffset<0?this.cameraPolarOffset:0),this.PI_2+(this.cameraPolarOffset>0?this.cameraPolarOffset:0))}return this.eulerDelta.set(0,0,0),this.object.dispatchEvent(R6e),this.path.length<2&&this.lastPosition.distanceToSquared(this.position)<this.threshEndTranslate&&Math.abs(this.rotVelocity.x)<this.threshEndRotVel&&Math.abs(this.rotVelocity.y)<this.threshEndRotVel&&(this.camera===void 0||this.isFirstPerson||this.lastCameraPosition.distanceToSquared(this.camera.position)<this.threshEndTranslate&&8*(1-this.lastCameraQuaternion.dot(this.camera.quaternion))<this.threshEndRotate)&&(this.moveMode==="fly"||this.onObject===!0||this.collisionEnabled===!1)&&(this.navMeshPathDest===null||this.navMeshPathDest.material.opacity<-.04*((v=(p=this.navMeshPathDest)==null?void 0:p.material)==null?void 0:v.userData.opacity0))?!1:(this.camera&&(this.lastCameraPosition.copy(this.camera.position),this.lastCameraQuaternion.copy(this.camera.quaternion)),this.lastPosition.copy(this.position),this.object.dispatchEvent(O6e),!0)}updateFollowArms(){this.objectToTarget.copy(this.objectToTarget0),this.targetToCamera.copy(this.targetToCamera0);let e=ts.setFromAxisAngle(rs,this.cameraYAxis==="Limit"&&this.orientMode!=="radial"?St.clamp(this.euler.y-this.euler0.y,this.minAzimuthAngleRel,this.maxAzimuthAngleRel):this.euler.y-this.euler0.y);(this.cameraYAxis!=="Locked"||this.orientMode==="radial")&&this.objectToTarget.applyQuaternion(e);let t;this.cameraXAxis==="Limit"?t=St.clamp(this.euler.x,-this.maxPolarAngle+this.cameraPolarOffset+1e-6,-this.minPolarAngle+this.cameraPolarOffset-1e-6):t=St.clamp(this.euler.x,-this.PI_2+this.cameraPolarOffset+1e-6,this.PI_2+this.cameraPolarOffset-1e-6);let r=Ma.copy(this.cameraPolarAxis0);(this.cameraYAxis!=="Locked"||this.orientMode==="radial")&&r.applyQuaternion(e);let i=zl.setFromAxisAngle(r,t);this.cameraYAxis!=="Locked"&&this.targetToCamera.applyQuaternion(e),this.cameraXAxis!=="Locked"&&this.targetToCamera.applyQuaternion(i)}groundTiltAdjustment(e){rs.angleTo(e)*180/Math.PI<15||rs.angleTo(e)*180/Math.PI>85?ts.identity():ts.setFromUnitVectors(rs,e),this.groundTilt.slerp(ts,.06),this.groundTiltInv.copy(this.groundTilt).invert()}collisionAdjustment(e){var n;let t=LF.set(0,0,0);this.object.matrix.compose(this.position,this.quaternion,this.scale);let r=Z_.multiplyMatrices(this.object.matrix,this.objXZRotMat).multiply(this.collider.matrix).decompose(Ma,ts,Ha).compose(Ma,ts,FF);this.sharedGameControlGlobals.entitiesWithTransformAnim.forEach(a=>{if(a===this.object||a.isDescendantOf(this.object))return;Ao.makeEmpty(),a.updateMatrixWorldSVD();let o=a.matrixWorldRigid,s=BF.copy(o).invert(),l=_6e.copy(BF).multiply(r);Pn.copy(this.collider.segment),Pn.start.applyMatrix4(l),Pn.end.applyMatrix4(l);let c=kF.copy(this.position).applyMatrix4(s);Ao.expandByPoint(Pn.start),Ao.expandByPoint(Pn.end),Ao.min.addScalar(-this.collider.radius),Ao.max.addScalar(this.collider.radius),a.bvhGeometry.boundsTree.shapecast({traverseBoundsOrder(u){return u.distanceToPoint(Pn.end)},intersectsBounds:u=>u.intersectsBox(Ao),intersectsTriangle:u=>{let d=Ma,h=Ha,f=u.closestPointToSegment(Pn,d,h);if(f<this.collider.radius){let p=this.collider.radius-f,v=h.sub(d).normalize(),m=$c.copy(c);m.addScaledVector(v,p);let g=m.applyMatrix4(o).sub(this.position);t.add(g),Pn.start.addScaledVector(v,p),Pn.end.addScaledVector(v,p)}}})}),Ao.makeEmpty(),Pn.copy(this.collider.segment),Pn.start.applyMatrix4(r),Pn.end.applyMatrix4(r),Ao.expandByPoint(Pn.start),Ao.expandByPoint(Pn.end),Ao.min.addScalar(-this.collider.radius),Ao.max.addScalar(this.collider.radius),(n=this.sharedGameControlGlobals.staticMeshBVH)==null||n.shapecast({traverseBoundsOrder(a){return a.distanceToPoint(Pn.end)},intersectsBounds:a=>a.intersectsBox(Ao),intersectsTriangle:a=>{let o=Ma,s=Ha,l=a.closestPointToSegment(Pn,o,s);if(l<this.collider.radius){let c=this.collider.radius-l,u=s.sub(o).normalize();this.alignToGround&&this.groundTiltAdjustment(u),t.addScaledVector(u,c),Pn.start.addScaledVector(u,c),Pn.end.addScaledVector(u,c)}}}),this.onObject=Math.abs(t.y)>Math.abs(e*this.velocity.y*.25),this.onObject&&this.dispatchStopEvent("jump");let i=Math.max(0,t.length()-1e-5);t.normalize().multiplyScalar(i),this.position.add(t)}},k7=sT;k7.isLocked=!1;var I6e=Ac(WV());function Yl(e,t){let r=new Ot;if(!e.getAttribute("position"))return r.setAttribute("position",new yt([],3)),r.setIndex([]),r;let{positions:i,triIndices:n}=$w(e.getAttribute("position"),e.getIndex());return r.setAttribute("position",new yt(i,3)),r.setIndex(n),t&&r.applyMatrix4(t),r}var z6e=new it,k6e=new it,Ns=[[0,0,0],[0,0,0],[0,0,0]];function L7(e){let t=e.elements;Ns[0][0]=t[0],Ns[0][1]=t[4],Ns[0][2]=t[8],Ns[1][0]=t[1],Ns[1][1]=t[5],Ns[1][2]=t[9],Ns[2][0]=t[2],Ns[2][1]=t[6],Ns[2][2]=t[10];let{u:r,v:i}=(0,I6e.SVD)(Ns),n=z6e.set(r[0][0],r[0][1],r[0][2],0,r[1][0],r[1][1],r[1][2],0,r[2][0],r[2][1],r[2][2],0,0,0,0,1),a=k6e.set(i[0][0],i[0][1],i[0][2],0,i[1][0],i[1][1],i[1][2],0,i[2][0],i[2][1],i[2][2],0,0,0,0,1);return n.multiply(a.transpose())}var L6e=class extends L8{constructor(){super(),this.layers.enable(3),this.layers.enable(8)}setFromCamera(e,t){t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,-1).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):t.isPerspectiveCamera?(this.ray.origin.set(e.x,e.y,-1).unproject(t),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):console.error("Raycaster: Unsupported camera type.")}intersectVisibleObjects(e,t=!0,r=[]){return e.forEach(i=>{i.visible&&this.intersectObject(i,t,r)}),r}createRaycastLineHelper(){let e=new Zu({color:65280,linewidth:10}),t=new k(this.ray.origin.x,this.ray.origin.y,this.ray.origin.z),r=new k(this.ray.direction.x,this.ray.direction.y,this.ray.direction.z),i=this.camera.far-this.camera.near,n=new k().addVectors(t,r.multiplyScalar(i)),a=new Ot;return a.setFromPoints([t,n]),new Hx(a,e)}},B7=e=>e instanceof mp||e instanceof vp;function B6e(e,t){return e.distance-t.distance}function F7(e,t,r){if(!(!ql(t)||!t.visible)){os(t)&&t.raycast(e,r);for(let i of t.children)F7(e,i,r)}}function tx(e,t,r,i=!1){if(!i&&!r.some(a=>F1(e,a)!==void 0))return[];let n=[];return t.children.forEach(a=>F7(e,a,n)),n.sort(B6e),n}function lT(e){let t=[];if(e.length){let r=e[0].object;ql(r)&&t.push(r);let i=r.parent;for(;i;)B7(i)&&t.push(i),i=i.parent}return t}function Xl(e,t,r,i){let n=e.frame;if(n){let a=t[0]*n.width,o=(1-t[1])*n.height;for(let s of r){let l=s===n.uuid?n:n.find(s);if(l!=null&&l.intersects(a,o))return i(l),!0}}return!1}function F1(e,t){if(os(t)){if(t.visible){let r=[];return t.raycast(e,r),r.length?r[0]:void 0}}else if(B7(t))return N7(e,t)}function N7(e,t){if(!(!ql(t)||!t.visible)){if(os(t)){let r=[];if(t.raycast(e,r),r.length)return r[0]}for(let r of t.children){let i=N7(e,r);if(i)return i}}}function F6e(e,t,r){return{x:(e-(r.left+window.scrollX))/r.width*2-1,y:-((t-(r.top+window.scrollY))/r.height)*2+1}}function N6e(e,t,r){return{x:(e-(r.left+window.scrollX))/r.width,y:1-(t-(r.top+window.scrollY))/r.height}}var U6e=class{constructor(e,t,r,i,n,a,o,s){this.renderer=e,this.publish=t,this.scene=r,this.getCamera=i,this.sharedAssets=n,this.requestRender=a,this.isExport=o,this.frame=s,this.raycaster=new L6e,this._useWindowEvents=!1,this.pointerWorld={x:0,y:0},this.pointerScreen={x:0,y:0},this._useWindowEvents=t.mouseEventTarget==="window",this.domElement=e.domElement,this.eventElement=this._useWindowEvents?window:e.domElement,this._domRect=this.domElement.getBoundingClientRect()}get stopRaycast(){return this.publish.stopRaycast}get page(){return this.scene.activePage}set useWindowEvents(e){this._useWindowEvents=e,this.eventElement=e?window:this.renderer.domElement}get useWindowEvents(){return this._useWindowEvents}set domRect(e){this._domRect=e}get domRect(){return this._domRect}updateRaycaster(e){var i;let{pageX:t,pageY:r}=((i=e.touches)==null?void 0:i.length)>0?e.touches[0]:e;this.pointerWorld=F6e(t,r,this._domRect),this.pointerScreen=N6e(t,r,this._domRect),this.raycaster.setFromCamera(this.pointerWorld,this.getCamera())}},lo=class{constructor(e){this.eventContext=e,this.domEventsNeeded=new Set,this.hasVideoAction=!1}connect(){}disconnect(){}},w3=[["start","Start"],["keyDown","KeyDown"],["keyUp","KeyUp"],["mouseDown","MouseDown"],["mouseUp","MouseUp"],["mouseHover","MouseHover"],["collision","Collision"],["lookAt","LookAt"],["follow","Follow"],["scroll","Scroll"]],U7=e=>{var t;return(t=w3.find(([r,i])=>i===e))==null?void 0:t[0]},D0=e=>{var t;return(t=w3.find(([r])=>r===e))==null?void 0:t[1]},j6e=(e,t)=>{let r=U7(e);if(r){let i=new CustomEvent(r,{bubbles:!0});return Object.defineProperty(i,"target",{writable:!1,value:t}),i}},V6e=class extends lo{constructor(){super(...arguments),this.objectsPerEvents=new Map,this.splineEvents={},this.onBeginEvent=e=>{var i;if(!e.eventName||!e.target||e.eventName==="Scroll")return;let t=(i=this.splineEvents[U7(e.eventName)])==null?void 0:i[e.target.uuid];if(!t)return;e.eventName==="Scroll"&&e.deltaY!==void 0&&Object.assign(t,{deltaY:e.deltaY});let{domElement:r}=this.eventContext;r.dispatchEvent(t)}}connect(){let{page:e}=this.eventContext;e.traverseEntity(t=>{var r,i;if((r=t.data)!=null&&r.events.length){for(let[n,a]of w3)if(t.data.events.some(o=>o.data.type===a&&!o.data.disabled)){this.objectsPerEvents.has(n)?(i=this.objectsPerEvents.get(n))==null||i.push(t):this.objectsPerEvents.set(n,[t]);let o={id:t.uuid,name:t.name},s=j6e(a,o),l=this.splineEvents[n];l?l[t.uuid]=s:this.splineEvents[n]={[t.uuid]:s}}}}),this.objectsPerEvents.forEach(t=>{t.forEach(r=>{r.addEventListener("beginEvent",this.onBeginEvent)})})}disconnect(){this.objectsPerEvents.forEach(e=>{e.forEach(t=>{t.removeEventListener("beginEvent",this.onBeginEvent)})})}},H6e=class{constructor(e,t,r,i,n,a){if(this.id=e,this.data=t,this.object=r,this.entered=!1,(t.type==="KeyDown"||t.type==="KeyUp"||t.type==="KeyPress")&&!t.key)throw new Error("Missing property");this.actions=$n(t,t.actions,i,n,a,r)}disconnect(){jn(this.actions)}dispatchHeld(e){this.actions.Create.forEach(t=>{e&&t.dispatchThrottled.cancel(),t.dispatchThrottled()})}dispatch(e=!1){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),this.data.type==="MousePress"||this.data.type==="KeyPress"?this.entered||(this.entered=!0,this.actions.Transition.forEach(t=>t.playFromCurrent()),this.actions.Animation.forEach(t=>t.playFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.playFromCurrent()),this.actions.Create.forEach(t=>t.dispatchStart())):(this.actions.Transition.some(t=>t.playing&&t.data.runMode!=="Toggle")||this.actions.Transition.forEach(t=>{t.data.runMode==="Toggle"?t.toggle():t.play()}),this.actions.SwitchCamera.some(t=>t.playing&&t.data.runMode!=="Toggle")||this.actions.SwitchCamera.forEach(t=>{t.data.runMode==="Toggle"?t.toggle():t.play()}),this.actions.Animation.forEach(t=>{t.data.runMode==="Toggle"?t.toggle():t.play()})),this.actions.Link.forEach(t=>{t.dispatch()}),this.actions.SceneTransition.forEach(t=>{t.dispatch()}),e===!1&&this.actions.Create.forEach(t=>{t.dispatch()}),this.actions.Destroy.forEach(t=>{t.dispatch()}),this.actions.Reset.forEach(t=>{t.dispatch()}),this.actions.Audio.forEach(t=>{t.dispatchBasic()}),this.actions.Video.forEach(t=>{t.dispatchBasic()}),this.actions.Particles.forEach(t=>{t.dispatchBasic()}),this.actions.SetVariable.forEach(t=>t.checkConditions()),this.actions.SetVariable.forEach(t=>t.dispatch()),this.actions.DynamicVariablePlay.forEach(t=>t.dispatch()),this.actions.ClearLocalStorage.forEach(t=>t.dispatch()),this.actions.UserAPI.forEach(t=>t.dispatch())}dispatchRelease(){this.entered&&(this.entered=!1,this.actions.Transition.forEach(e=>e.reverseFromCurrent()),this.actions.Particles.forEach(e=>e.reverseFromCurrent()),this.actions.Animation.forEach(e=>e.reverseFromCurrent()),this.actions.SwitchCamera.forEach(e=>e.reverseFromCurrent()),this.actions.Create.forEach(e=>e.dispatchStop()))}dispatchUserEvent(e){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),e?(this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.Animation.forEach(t=>t.reverseFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.reverseFromCurrent())):(this.actions.Transition.forEach(t=>t.playFromCurrent()),this.actions.Animation.forEach(t=>t.playFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.playFromCurrent())),this.actions.Link.forEach(t=>{t.dispatch()}),this.actions.SceneTransition.forEach(t=>{t.dispatch()}),this.actions.Create.forEach(t=>{t.dispatch()}),this.actions.Destroy.forEach(t=>{t.dispatch()}),this.actions.Reset.forEach(t=>{t.dispatch()}),this.actions.Audio.forEach(t=>{t.dispatchBasic()}),this.actions.Video.forEach(t=>{t.dispatchBasic()}),this.actions.Particles.forEach(t=>{t.dispatchBasic()}),this.actions.SetVariable.forEach(t=>t.checkConditions()),this.actions.SetVariable.forEach(t=>t.dispatch()),this.actions.DynamicVariablePlay.forEach(t=>t.dispatch()),this.actions.ClearLocalStorage.forEach(t=>t.dispatch()),this.actions.UserAPI.forEach(t=>t.dispatch())}},W6e=class extends lo{constructor(e,t,r){super(e),this.eventManager=t,this.useForRaycastProperty=r,this.objectsPerTypes={MouseDown:[],MouseUp:[],MousePress:[],KeyDown:[],KeyUp:[],KeyPress:[]},this.canvasMouseEvents=[],this.eventsPerObjects={MouseDown:{},MouseUp:{},MousePress:{},KeyDown:{},KeyUp:{},KeyPress:{}},this.heldKeys={},this.heldKeysPress={},this._prevObjects=[],this.sceneInterects=null,this.onCanvasRaycast=i=>{if(this.useForRaycastProperty===!0&&this.sceneInterects===null){this.eventContext.updateRaycaster(i);let{raycaster:n,page:a}=this.eventContext,o=tx(n,a,[],!0);this.sceneInterects=o,o.length&&(this.eventContext.sharedAssets.raycastProperty={x:o[0].point.x,y:o[0].point.y,z:o[0].point.z,objX:o[0].object.matrixWorld.elements[12],objY:o[0].object.matrixWorld.elements[13],objZ:o[0].object.matrixWorld.elements[14]})}},this.onCanvasMouseDown=i=>{(i.target===this.eventContext.domElement||i.target.tagName==="SPLINE-VIEWER")&&this.canvasMouseEvents.forEach(n=>{(n.data.type==="MouseDown"||n.data.type==="MousePress")&&(this.onCanvasRaycast(i),n.dispatch())})},this.onCanvasMouseUp=i=>{(i.target===this.eventContext.domElement||i.target.tagName==="SPLINE-VIEWER")&&this.canvasMouseEvents.forEach(n=>{n.data.type==="MouseUp"?(this.onCanvasRaycast(i),n.dispatch()):n.data.type==="MousePress"&&n.dispatchRelease()})},this.onMouseDown=i=>{Wt.length>1||(this.eventContext.updateRaycaster(i),this.handleMouseEvent("MouseDown"))},this.onMouseUp=i=>{Wt.length>1||(this.eventContext.updateRaycaster(i),this.handleMouseEvent("MouseUp"))},this.onMousePressDown=i=>{Wt.length>1||(this.eventContext.updateRaycaster(i),this.handleMousePressEvent())},this.onMousePressRelease=i=>{Wt.length>1||(this.eventContext.updateRaycaster(i),this.handleMousePressEvent(!0))},this.onKeyDown=i=>{this.heldKeys[i.key]||(this.handleKeyEvent(i,"KeyDown"),this.handleKeyEventHeld(i,"KeyDown",!0)),this.heldKeys[i.key]=!0},this.onKeyUp=i=>{this.handleKeyEvent(i,"KeyUp"),this.handleKeyEventHeld(i,"KeyUp",!0)},this.onKeyPressDown=i=>{this.heldKeysPress[i.key]?this.handleKeyEventHeld(i,"KeyPress"):(this.handleKeyEvent(i,"KeyPress"),this.handleKeyEventHeld(i,"KeyPress",!0)),this.heldKeysPress[i.key]=!0},this.onKeyPressUp=i=>{this.handleKeyEvent(i,"KeyPress",!0)},this.releaseHeldKey=i=>{delete this.heldKeys[i.key]},this.releaseHeldKeyPress=i=>{delete this.heldKeysPress[i.key]},this._onUserEvent=({eventName:i,target:n,reverse:a})=>{var s,l,c,u;if(!i||!n)return;let o=D0(i);o&&(o==="MouseDown"||o==="MouseUp"||o==="MousePress"?(n.dispatchEvent({type:"beginEvent",eventName:o}),(l=(s=this.eventsPerObjects[o])==null?void 0:s[n.uuid])==null||l.forEach(d=>{d.dispatchUserEvent(a)})):(o==="KeyDown"||o==="KeyUp"||o==="KeyPress")&&(n.dispatchEvent({type:"beginEvent",eventName:o}),(u=(c=this.eventsPerObjects[o])==null?void 0:c[n.uuid])==null||u.forEach(d=>{d.dispatchUserEvent()})))}}connect(){var n,a,o,s,l,c;let{page:e,sharedAssets:t,domElement:r}=this.eventContext,i=(u,d)=>{var f,p;if(!((f=u.data)!=null&&f.events.length))return;let h=["MouseDown","MouseUp","MousePress","KeyDown","KeyUp","KeyPress"];for(let v of h){let m=this.eventsPerObjects[v];u.data.events.filter(({data:g})=>g.type===v&&g.disabled!==!0).forEach(({id:g,data:y})=>{try{let b=new H6e(g,y,u,e,t,this.eventManager);b.actions.Video.length&&(this.hasVideoAction=!0),(y.type==="MouseDown"||y.type==="MouseUp"||y.type==="MousePress")&&(y.mode==="Canvas"||y.mode==="Window")?this.canvasMouseEvents.push(b):m[u.uuid]?m[u.uuid].some(x=>x.id===b.id)||m[u.uuid].push(b):m[u.uuid]=[b]}catch{}}),(p=m[u.uuid])!=null&&p.length&&this.objectsPerTypes[v].push(u instanceof Vn&&(v==="MouseDown"||v==="MouseUp"||v==="MousePress")?d:u)}};e.traverseEntity(u=>{var d;(u instanceof va||u instanceof Rn)&&((d=u.frame)==null||d.traverse(h=>{i(h,u)})),i(u)}),this.heldKeys={},this.heldKeysPress={},this.domEventsNeeded.clear(),r.addEventListener("pointerdown",this.onCanvasMouseDown),r.addEventListener("pointerup",this.onCanvasMouseUp),((n=this.objectsPerTypes.MouseDown)!=null&&n.length||this.useForRaycastProperty)&&(this.domEventsNeeded.add("pointerdown"),r.addEventListener("pointerdown",this.onMouseDown)),(a=this.objectsPerTypes.MouseUp)!=null&&a.length&&(this.domEventsNeeded.add("pointerup"),r.addEventListener("pointerup",this.onMouseUp)),(o=this.objectsPerTypes.MousePress)!=null&&o.length&&(this.domEventsNeeded.add("pointerdown"),r.addEventListener("pointerdown",this.onMousePressDown),this.domEventsNeeded.add("pointerup"),r.addEventListener("pointerup",this.onMousePressRelease)),(s=this.objectsPerTypes.KeyDown)!=null&&s.length&&(this.domEventsNeeded.add("keydown"),document.addEventListener("keydown",this.onKeyDown),document.addEventListener("keyup",this.releaseHeldKey)),(l=this.objectsPerTypes.KeyUp)!=null&&l.length&&(this.domEventsNeeded.add("keyup"),document.addEventListener("keyup",this.onKeyUp)),(c=this.objectsPerTypes.KeyPress)!=null&&c.length&&(this.domEventsNeeded.add("keydown"),document.addEventListener("keydown",this.onKeyPressDown),document.addEventListener("keyup",this.releaseHeldKeyPress),this.domEventsNeeded.add("keyup"),document.addEventListener("keyup",this.onKeyPressUp)),Object.entries(this.objectsPerTypes).forEach(([u,d])=>{d.forEach(h=>{h.addEventListener("userEvent",this._onUserEvent)})})}disconnect(){let{domElement:e}=this.eventContext;this.domEventsNeeded.clear(),this.heldKeys={},this.heldKeysPress={},e.removeEventListener("pointerdown",this.onCanvasMouseDown),e.removeEventListener("pointerup",this.onCanvasMouseUp),e.removeEventListener("pointerdown",this.onMouseDown),e.removeEventListener("pointerdown",this.onMousePressDown),e.removeEventListener("pointerup",this.onMouseUp),e.removeEventListener("pointerup",this.onMousePressRelease),document.removeEventListener("keydown",this.onKeyDown),document.removeEventListener("keyup",this.onKeyUp),document.removeEventListener("keydown",this.onKeyPressDown),document.removeEventListener("keyup",this.onKeyPressUp),document.removeEventListener("keyup",this.releaseHeldKey),Object.values(this.eventsPerObjects).forEach(t=>{Object.values(t).forEach(r=>{r.forEach(i=>{i.disconnect()})})}),this.canvasMouseEvents.forEach(t=>{t.disconnect()}),Object.entries(this.objectsPerTypes).forEach(([t,r])=>{r.forEach(i=>{i.removeEventListener("userEvent",this._onUserEvent)})})}handleMouseEvent(e){var s,l,c,u;let{stopRaycast:t,raycaster:r,page:i,pointerScreen:n}=this.eventContext,a=this.objectsPerTypes[e],o=a.filter(d=>!(d instanceof Vn));if(!(!a.length&&!this.useForRaycastProperty)&&!(i.uiCanvas&&Xl(i,[n.x,n.y],Object.keys(this.eventsPerObjects[e]),d=>{this.handleObjectMouseEventDispatch(d,e)}))){if(t||this.useForRaycastProperty){let d;if(this.sceneInterects===null?d=tx(r,i,o,this.useForRaycastProperty):(d=this.sceneInterects,this.sceneInterects=null),this.useForRaycastProperty&&d.length&&(this.eventContext.sharedAssets.raycastProperty={x:d[0].point.x,y:d[0].point.y,z:d[0].point.z,objX:d[0].object.matrixWorld.elements[12],objY:d[0].object.matrixWorld.elements[13],objZ:d[0].object.matrixWorld.elements[14]}),t){let h=[((l=(s=d[0])==null?void 0:s.uv)==null?void 0:l.x)??0,((u=(c=d[0])==null?void 0:c.uv)==null?void 0:u.y)??0];lT(d).forEach(f=>{f instanceof va&&Xl(f,h,Object.keys(this.eventsPerObjects[e]),p=>{this.handleObjectMouseEventDispatch(p,e)}),this.eventsPerObjects[e][f.uuid]&&this.handleObjectMouseEventDispatch(f,e)})}}t||o.forEach(d=>{var f,p;let h=F1(r,d);h&&(this.handleObjectMouseEventDispatch(d,e),d instanceof va&&Xl(d,[((f=h==null?void 0:h.uv)==null?void 0:f.x)??0,((p=h==null?void 0:h.uv)==null?void 0:p.y)??0],Object.keys(this.eventsPerObjects[e]),v=>{this.handleObjectMouseEventDispatch(v,e)}))})}}handleMousePressEvent(e=!1){let t="MousePress",r=this.objectsPerTypes[t],i=r.filter(a=>!(a instanceof Vn)),n=[];if(r.length){if(!e){let{stopRaycast:a,raycaster:o,page:s,pointerScreen:l}=this.eventContext,c=!1;if(s.uiCanvas&&(c=Xl(s,[l.x,l.y],Object.keys(this.eventsPerObjects[t]),u=>{n.push(u)})),a&&!c){let u=tx(o,s,i);n=lT(u),u.forEach(d=>{var h,f;d.object instanceof va&&Xl(d.object,[((h=d==null?void 0:d.uv)==null?void 0:h.x)??0,((f=d==null?void 0:d.uv)==null?void 0:f.y)??0],Object.keys(this.eventsPerObjects[t]),p=>{n.push(p)})})}else i.forEach(u=>{var h,f;let d=F1(o,u);d&&(n.push(u),u instanceof va&&Xl(u,[((h=d==null?void 0:d.uv)==null?void 0:h.x)??0,((f=d==null?void 0:d.uv)==null?void 0:f.y)??0],Object.keys(this.eventsPerObjects[t]),p=>{n.push(p)}))})}this._prevObjects.length&&this._prevObjects.forEach(a=>{n.includes(a)||this.handleObjectMouseEventDispatchRelease(a,t)}),n.length&&n.forEach(a=>{this.handleObjectMouseEventDispatch(a,t)}),this._prevObjects=n}}handleObjectMouseEventDispatch(e,t){var r,i;e.dispatchEvent({type:"beginEvent",eventName:t}),(i=(r=this.eventsPerObjects[t])==null?void 0:r[e.uuid])==null||i.forEach(n=>{n.dispatch()})}handleObjectMouseEventDispatchRelease(e,t){var r,i;e.dispatchEvent({type:"beginEvent",eventName:t}),(i=(r=this.eventsPerObjects[t])==null?void 0:r[e.uuid])==null||i.forEach(n=>{n.dispatchRelease()})}handleKeyEvent(e,t,r=!1){this.objectsPerTypes[t].forEach(i=>{let n=this.eventsPerObjects[t][i.uuid];n.some(({data:a})=>"key"in a&&a.key===e.key)&&i.dispatchEvent({type:"beginEvent",eventName:t}),n.forEach(a=>{"key"in a.data&&a.data.key===e.key&&(r?a.dispatchRelease():a.dispatch(!0))})})}handleKeyEventHeld(e,t,r=!1){this.objectsPerTypes[t].forEach(i=>{this.eventsPerObjects[t][i.uuid].forEach(n=>{"key"in n.data&&n.data.key===e.key&&n.dispatchHeld(r)})})}},G6e=new k,$6e=new k,j7=class{constructor(e,t,r,i,n){this.actionsIn=$n(e,e.inActions,r,i,n,t),this.actionsOut=$n(e,e.outActions,r,i,n,t)}disconnect(){jn(this.actionsIn),jn(this.actionsOut)}},q6e=class extends j7{constructor(e,t,r,i,n,a){super(t,r,i,n,a),this.id=e,this.data=t,this.object=r,this.stage="out",this.objects=[],this.onUpdateMatrixWorld=()=>{for(let h of this.objects)if(!h.visible)return;let c=G6e.setFromMatrixPosition(this.objects[0].matrixWorld),u=$6e.setFromMatrixPosition(this.objects[1].matrixWorld),d=c.distanceTo(u)<=this.distance?"in":"out";if(this.stage!==d){this.stage=d;let h=d==="in"?this.actionsIn:this.actionsOut;h.Audio.forEach(f=>f.dispatchConditional()),h.Particles.forEach(f=>f.dispatchConditional()),h.Video.forEach(f=>f.dispatchConditional()),h.Link.forEach(f=>f.dispatch()),h.Create.forEach(f=>f.dispatch()),h.Destroy.forEach(f=>f.dispatch()),h.Reset.forEach(f=>f.dispatch()),h.Transition.forEach(f=>{f.object.currentTransitionEvent!==this&&(f.object.currentTransitionEvent=this),f.init()}),h.Transition.forEach(f=>f.play()),h.Animation.forEach(f=>f.play()),h.SwitchCamera.forEach(f=>f.play()),h.SceneTransition.forEach(f=>f.dispatch()),h.SetVariable.forEach(f=>f.checkConditions()),h.SetVariable.forEach(f=>f.dispatch()),h.DynamicVariablePlay.forEach(f=>f.dispatch()),h.ClearLocalStorage.forEach(f=>f.dispatch()),h.UserAPI.forEach(f=>f.dispatch())}};let{distance:o,fromObject:s,toObject:l}=t.condition;this.distance=o;for(let c of[s,l]){if(!c)throw new Error("Missing property");let u=i.find(c);if(!u)throw new Error("Missing property");this.objects.push(u)}}connect(){window.setTimeout(()=>{this.objects.forEach(e=>{e.addEventListener("updateMatrixWorld",this.onUpdateMatrixWorld)}),this.onUpdateMatrixWorld()},0)}disconnect(){super.disconnect(),this.stage="out",this.objects.forEach(e=>{e.removeEventListener("updateMatrixWorld",this.onUpdateMatrixWorld)})}},Y6e=class extends j7{constructor(e,t,r,i,n,a){var l;super(t,r,i,n,a),this.id=e,this.data=t,this.object=r,this.onBegin=({target:c,state:u})=>{this.toState!==u&&(this.actionsOut.Audio.forEach(d=>d.dispatchConditional()),this.actionsOut.Particles.forEach(d=>d.dispatchConditional()),this.actionsOut.Video.forEach(d=>d.dispatchConditional()),this.actionsOut.Link.forEach(d=>d.dispatch()),this.actionsOut.Create.forEach(d=>d.dispatch()),this.actionsOut.Destroy.forEach(d=>d.dispatch()),this.actionsOut.Reset.forEach(d=>d.dispatch()),this.actionsIn.Transition.forEach(d=>d.pause()),this.object.currentTransitionEvent=this,this.actionsOut.Transition.forEach(d=>d.play()),this.actionsOut.Animation.forEach(d=>d.play()),this.actionsIn.SwitchCamera.forEach(d=>d.pause()),this.actionsOut.SwitchCamera.forEach(d=>d.play()),this.actionsOut.SceneTransition.forEach(d=>d.dispatch()),this.actionsOut.SetVariable.forEach(d=>d.checkConditions()),this.actionsOut.SetVariable.forEach(d=>d.dispatch()),this.actionsOut.DynamicVariablePlay.forEach(d=>d.dispatch()),this.actionsOut.ClearLocalStorage.forEach(d=>d.dispatch()),this.actionsOut.UserAPI.forEach(d=>d.dispatch()))},this.onComplete=({target:c,state:u})=>{this.toState===u&&(this.actionsIn.Audio.forEach(d=>d.dispatchConditional()),this.actionsIn.Particles.forEach(d=>d.dispatchConditional()),this.actionsIn.Video.forEach(d=>d.dispatchConditional()),this.actionsIn.Link.forEach(d=>d.dispatch()),this.actionsIn.Create.forEach(d=>d.dispatch()),this.actionsIn.Destroy.forEach(d=>d.dispatch()),this.actionsIn.Reset.forEach(d=>d.dispatch()),this.actionsOut.Transition.forEach(d=>d.pause()),this.actionsOut.Transition.forEach(d=>d.pause()),this.object.currentTransitionEvent=this,this.actionsIn.Transition.forEach(d=>d.play()),this.actionsIn.Animation.forEach(d=>d.play()),this.actionsOut.SwitchCamera.forEach(d=>d.pause()),this.actionsIn.SwitchCamera.forEach(d=>d.play()),this.actionsIn.SceneTransition.forEach(d=>d.dispatch()),this.actionsIn.SetVariable.forEach(d=>d.checkConditions()),this.actionsIn.SetVariable.forEach(d=>d.dispatch()),this.actionsIn.DynamicVariablePlay.forEach(d=>d.dispatch()),this.actionsOut.ClearLocalStorage.forEach(d=>d.dispatch()),this.actionsOut.UserAPI.forEach(d=>d.dispatch()))};let{condition:o}=t;if(!o.object)throw new Error("Missing property");let s=i.find(o.object)??i.scene.find2D(o.object);if(!s)throw new Error("Missing property");if(this.toObject=s,o.state&&!((l=this.toObject.states)!=null&&l[o.state]))throw new Error("Missing property");this.toState=o.state}connect(){zd(this.actionsOut).forEach(e=>{var t;(t=this.actionsOut[e])!=null&&t.length&&this.toObject.addEventListener("beginState",this.onBegin)}),zd(this.actionsIn).forEach(e=>{var t;(t=this.actionsIn[e])!=null&&t.length&&this.toObject.addEventListener("completeState",this.onComplete)})}disconnect(){super.disconnect(),zd(this.actionsOut).forEach(e=>{var t;(t=this.actionsIn[e])!=null&&t.length&&this.toObject.removeEventListener("beginState",this.onBegin)}),zd(this.actionsIn).forEach(e=>{var t;(t=this.actionsIn[e])!=null&&t.length&&this.toObject.removeEventListener("completeState",this.onComplete)})}},X6e=class extends lo{constructor(e,t){super(e),this.eventManager=t,this.eventsPerConditions={Comparison:[],Distance:[],State:[]},this.hasVideoAction=!1}connect(){super.connect();let{page:e,sharedAssets:t}=this.eventContext;e.traverseEntity(r=>{var i;if((i=r.data)!=null&&i.events.length){for(let{id:n,data:a}of r.data.events)if(!a.disabled&&a.type==="Conditional")try{let o;a.condition.type==="Comparison"||(a.condition.type==="Distance"?o=new q6e(n,a,r,e,t,this.eventManager):a.condition.type==="State"&&(o=new Y6e(n,a,r,e,t,this.eventManager))),o&&(this.eventsPerConditions[a.condition.type].push(o),(o.actionsIn.Video.length||o.actionsOut.Video.length)&&(this.hasVideoAction=!0))}catch{}}}),Object.values(this.eventsPerConditions).forEach(r=>r.forEach(i=>i.connect()))}disconnect(){super.disconnect(),Object.values(this.eventsPerConditions).forEach(e=>e.forEach(t=>t.disconnect()))}},sv=new k,qc=new k,dd=new k,jF=new Ya,K6e=.01,Hr=new k,vn=new k,VF=new k,Hd=new Kt,J_=new bn,Q6e=new it,e2=new cn,_f=new k,Us=new k,Af=.2;function t2(e,t){!t||(t[0]<t[1]&&(e.x=Math.min(Math.max(e.x,t[0]),t[1])),t[2]<t[3]&&(e.y=Math.min(Math.max(e.y,t[2]),t[3])),t[4]<t[5]&&(e.z=Math.min(Math.max(e.z,t[4]),t[5])))}var Z6e=function(){let e=new it;return(t,r,i)=>{let n=t.obj;e.copy(n.hiddenMatrix),n.parent!==null&&e.premultiply(n.parent.matrixWorld),e.invert(),n.position.copy(r),t.reference==="global"&&t2(n.position,t.limits),n.position.applyMatrix4(e),t.reference==="parent"?t2(n.position,t.limits):t.reference==="local"&&(Hd.copy(t.quat0).invert(),n.position.sub(t.position0),n.position.applyQuaternion(Hd),t2(n.position,t.limits),Hd.invert(),n.position.applyQuaternion(Hd),n.position.add(t.position0)),e.multiply(i??n.matrixWorld).decompose(Hr,n.quaternion,vn),n.updateMatrix(),n.hasNonUniformScale&&(n.updateMatrixWorld(),n.updateMatrixWorldSVD()),n instanceof Fa&&ic(n.parent)&&n.invalidateDownstreamBooleanData(!0)}}(),J6e=class{constructor(e,t,r,i,n,a,o){this.object=e,this.id=t,this.data=r,this.dropDestIds=[],this.activeIdx=null,this.wasDragEventTriggered=!1,this.resetDampingFactor=this.data.resetSpeed===0?1:8/this.data.resetSpeed+1,this.snapDampingFactor=this.data.snapSpeed===0?1:8/this.data.snapSpeed+1,this.actionsDrag=$n(r,r.dragDropActions.drag,i,n,a,this.object),this.actionsDrop=$n(r,r.dragDropActions.drop,i,n,a,this.object);let s=[];this.data.objects.forEach(l=>{let c=i.find(l);!c||c.data.visible!==!1&&(s.push(c),o[c.uuid]&&o[c.uuid].forEach(u=>{let d=i.find(u);!d||d.data.visible!==!1&&s.push(d)}))}),this.data.dropDestinations.forEach(l=>{let c=i.find(l);!c||c.data.visible!==!1&&(this.dropDestIds.push(c.uuid),o[c.uuid]&&o[c.uuid].forEach(u=>{let d=i.find(u);!d||d.data.visible!==!1&&this.dropDestIds.push(d.uuid)}))}),this.dragItems=s.map(l=>(this.data.planeMode==="locked"&&(l.userData.lockedPlane=!0),l.userData.worldPosition0=new k().setFromMatrixPosition(l.matrixWorld),{obj:l,fromPosition:new k().setFromMatrixPosition(l.matrixWorld),pointStart:new k,pointEnd:new k,paused:!0,currentDampingFactor:this.data.dampingFactor,reset:!1,position0:new k().copy(l.position),quat0:new Kt().copy(l.quaternion),snapped:!1,orientationMatrix:new it,limits:this.data.limits,reference:this.data.referenceFrame}))}get activeDragItem(){return this.activeIdx!==null?this.dragItems[this.activeIdx]:null}dispose(){jn(this.actionsDrag),jn(this.actionsDrop),this.dragItems.forEach(e=>{e.fromPosition.copy(e.obj.userData.worldPosition0),e.pointStart.copy(e.fromPosition),e.pointEnd.copy(e.pointStart),e.obj.recursiveBBoxNeedsUpdate=!0,e.obj.userData.lockedPlane=void 0,e.obj.position.copy(e.position0),e.obj.quaternion.copy(e.quat0),e.obj.updateMatrix()})}},eje=class extends lo{constructor(e,t){super(e),this.eventManager=t,this.events=[],this.lastDropDestination=null,this.dragTimeout=null,this.onPointerDown=r=>{var o;if(Wt.length>1)return;this.eventContext.updateRaycaster(r);let{raycaster:i,page:n}=this.eventContext,a=n.raycastWithClones(i);if(this.lastDropDestination=null,a.length===0){this.activeEvent=null;return}for(let s of this.events){let l=0;for(let{obj:c,pointEnd:u,pointStart:d}of s.dragItems){if(c===a[0].object||c===a[0].object.object||_r.is(c)&&c.isAncestorOf(a[0].object.uuid)){if(s.activeIdx=l,s.activeDragItem.reset=!1,s.activeDragItem.currentDampingFactor=s.data.dampingFactor,s.activeDragItem.snapped=!1,s.data.cursor==="hand"&&this.setCursor("grabbing"),this.eventManager.controlsManager.usePhysics){s.activeDragItem.obj.rigidBody&&s.activeDragItem.obj.rigidBody.setBodyType(2,!0);let h=s.activeDragItem.obj;c.hasNonUniformScale&&c.updateMatrixWorldSVD(),(h.hasNonUniformScale?h.matrixWorldRigid:h.matrixWorld).decompose(Hr,Hd,vn),J_.setFromQuaternion(Hd),h.prevR===void 0?(h.prevR=J_.clone(),h.prevT=Hr.clone()):(h.prevR.copy(J_),h.prevT.copy(Hr)),this.eventManager.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.push(s.activeDragItem.obj)}this.calcPlaneIntersectPos(c,d,s.data.plane,s.data.referenceFrame),u.copy(d),(this.eventManager.controlsManager.usePhysics&&((o=c.data.physics)==null?void 0:o.rigidBody)==="dynamic"||s.data.drop===!1||s.data.resetOnSnapFail===!1)&&s.activeDragItem.fromPosition.setFromMatrixPosition(s.activeDragItem.obj.matrixWorld),this.activeEvent=s,this.eventManager.controlsManager.orbitControls&&(this.eventManager.controlsManager.orbitControls.enabled=!1);return}l++}}this.activeEvent=null},this.onPointerMove=r=>{var o,s,l,c;if(Wt.length>1)return;this.eventContext.updateRaycaster(r);let{raycaster:i,page:n}=this.eventContext,a=n.raycastWithClones(i);if(Wt.length===0){let u=!1;for(let d of this.events){for(let{obj:h}of d.dragItems)if(h===((o=a[0])==null?void 0:o.object)||h===((l=(s=a[0])==null?void 0:s.object)==null?void 0:l.object)||_r.is(h)&&h.isAncestorOf((c=a[0])==null?void 0:c.object.uuid)){switch(u=!0,d.data.cursor){case"hand":this.setCursor("grab");break;case"move":this.setCursor("move");break}break}if(u)break}u||this.setCursor("default");return}if(this.activeEvent&&this.activeEvent.activeDragItem){let u=this.activeEvent.activeDragItem;u.snapped=!1;let d;if(this.activeEvent.data.drop&&(d=a.filter(h=>u.obj!==h.object&&!u.obj.isAncestorOf(h.object.uuid)&&!(h.object instanceof mp)&&(this.activeEvent.data.dropOn==="all"||this.activeEvent.dropDestIds.some(f=>f===h.object.uuid||n.scene.find(f).isAncestorOf(h.object.uuid))))[0]),d){let h=VF.copy(d.face.normal).applyMatrix3(e2.getNormalMatrix(d.object.matrixWorld));if(this.activeEvent.data.snapTo==="center")u.fromPosition.setFromMatrixPosition(d.object.matrixWorld);else if(this.activeEvent.data.snapTo==="surface"){if(u.fromPosition.copy(d.point),this.activeEvent.data.snapSurfaceMode==="bbox"){Hr.copy(h).applyMatrix3(e2.setFromMatrix4(u.obj.matrixWorld).transpose());let f=u.obj;Hr.x>Af?vn.x=-f.recursiveBBox.min.x:Hr.x<-Af&&(vn.x=-f.recursiveBBox.max.x),Hr.y>Af?vn.y=-f.recursiveBBox.min.y:Hr.y<-Af&&(vn.y=-f.recursiveBBox.max.y),Hr.z>Af?vn.z=-f.recursiveBBox.min.z:Hr.z<-Af&&(vn.z=-f.recursiveBBox.max.z),vn.applyMatrix3(e2.invert())}else vn.copy(h).multiplyScalar(this.activeEvent.data.snapSurfaceOffset);u.fromPosition.add(vn)}this.activeEvent.data.autoOrient&&(Hr.set(0,1,0).cross(h),Hr.length()<1e-4&&Hr.set(-1,0,0).cross(h),vn.crossVectors(VF,Hr),u.orientationMatrix.makeBasis(Hr,vn,h)),u.pointStart.copy(u.fromPosition),u.pointEnd.copy(u.pointStart),u.currentDampingFactor=this.activeEvent.snapDampingFactor,u.snapped=!0,this.lastDropDestination!==d.object&&(this.lastDropDestination=d.object,this.activeEvent.actionsDrop.Transition.forEach(f=>{f.play()}),this.activeEvent.actionsDrop.Animation.forEach(f=>{f.play()}),this.activeEvent.actionsDrop.Audio.forEach(f=>{f.dispatchGameControl("start")}),this.activeEvent.actionsDrop.Particles.forEach(f=>{f.dispatchGameControl("start")}),this.activeEvent.actionsDrop.Create.forEach(f=>{f.dispatchThrottled()}))}else u.orientationMatrix.makeRotationFromQuaternion(u.quat0),this.lastDropDestination=null,u.currentDampingFactor=this.activeEvent.data.dampingFactor,this.calcPlaneIntersectPos(u.obj,u.pointEnd,this.activeEvent.data.plane,this.activeEvent.data.referenceFrame),this.activeEvent.actionsDrop.Transition.forEach(h=>{h.stop(),h.object.currentState!==null&&h.object.changeSelectedState(null,{scene:this.eventContext.page.scene,shared:this.eventContext.sharedAssets})}),this.activeEvent.actionsDrop.Animation.forEach(h=>{h.stop()}),this.activeEvent.actionsDrop.Audio.forEach(h=>{h.dispatchGameControl("stop")}),this.activeEvent.actionsDrop.Particles.forEach(h=>{h.dispatchGameControl("stop")});this.activeEvent.actionsDrag.Create.forEach(h=>{h.dispatchThrottled()}),this.activeEvent.actionsDrag.SetVariable.forEach(h=>h.checkConditions()),this.activeEvent.actionsDrag.SetVariable.forEach(h=>h.dispatch()),this.activeEvent.actionsDrag.DynamicVariablePlay.forEach(h=>h.dispatch()),this.activeEvent.actionsDrag.ClearLocalStorage.forEach(h=>h.dispatch()),this.activeEvent.actionsDrag.UserAPI.forEach(h=>h.dispatch()),this.activeEvent.wasDragEventTriggered===!1&&(this.activeEvent.wasDragEventTriggered=!0,this.activeEvent.actionsDrag.Transition.forEach(h=>{h.play()}),this.activeEvent.actionsDrag.Animation.forEach(h=>{h.play()}),this.activeEvent.actionsDrag.Audio.forEach(h=>{h.dispatchGameControl("start")}),this.activeEvent.actionsDrag.Particles.forEach(h=>{h.dispatchGameControl("start")})),this.dragTimeout&&window.clearTimeout(this.dragTimeout),this.dragTimeout=window.setTimeout(()=>{!this.activeEvent||(this.activeEvent.wasDragEventTriggered=!1,this.activeEvent.actionsDrag.Audio.forEach(h=>{h.dispatchGameControl("stop")}),this.activeEvent.actionsDrag.Particles.forEach(h=>{h.dispatchGameControl("stop")}),this.activeEvent.actionsDrag.Transition.forEach(h=>{h.stop(),h.object.currentState!==null&&h.object.changeSelectedState(null,{scene:this.eventContext.page.scene,shared:this.eventContext.sharedAssets})}),this.activeEvent.actionsDrag.Animation.forEach(h=>{h.stop()}))},500),this.updateDragItem(u),u.obj.dispatchEvent({type:"requestRender"})}},this.onPointerUp=r=>{var i;if(this.activeEvent&&this.activeEvent.activeDragItem){this.activeEvent.data.cursor==="hand"&&this.setCursor("grab");let n=((i=this.activeEvent.activeDragItem.obj.data.physics)==null?void 0:i.rigidBody)==="dynamic";this.activeEvent.activeDragItem.snapped===!1&&this.activeEvent.data.drop&&this.activeEvent.data.resetOnSnapFail&&(this.eventManager.controlsManager.usePhysics===!1||!n)&&(this.activeEvent.activeDragItem.reset=this.activeEvent.data.resetOnSnapFail,this.activeEvent.activeDragItem.paused=!1,this.activeEvent.activeDragItem.currentDampingFactor=this.activeEvent.resetDampingFactor),this.eventManager.controlsManager.usePhysics&&n&&(this.eventManager.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.pop(),this.activeEvent.activeDragItem.obj.rigidBody.setBodyType(0,!0),this.activeEvent.activeDragItem.paused=!0),this.activeEvent.wasDragEventTriggered===!0&&(this.activeEvent.wasDragEventTriggered=!1,this.activeEvent.actionsDrag.Transition.forEach(a=>{a.stop(),a.object.currentState!==null&&a.object.changeSelectedState(null,{scene:this.eventContext.page.scene,shared:this.eventContext.sharedAssets})}),this.activeEvent.actionsDrag.Animation.forEach(a=>{a.stop()}),this.activeEvent.actionsDrag.Audio.forEach(a=>{a.dispatchGameControl("stop")}),this.activeEvent.actionsDrag.Particles.forEach(a=>{a.dispatchGameControl("stop")}),this.activeEvent.actionsDrop.SetVariable.forEach(a=>a.checkConditions()),this.activeEvent.actionsDrop.SetVariable.forEach(a=>a.dispatch()),this.activeEvent.actionsDrop.DynamicVariablePlay.forEach(a=>a.dispatch()),this.activeEvent.actionsDrop.ClearLocalStorage.forEach(a=>a.dispatch()),this.activeEvent.actionsDrop.UserAPI.forEach(a=>a.dispatch())),this.eventManager.controlsManager.orbitControls&&(this.eventManager.controlsManager.orbitControls.enabled=!0)}}}connect(){let e={};if(this.eventContext.page.traverseEntity(r=>{r.component&&(e[r.component.uuid]?e[r.component.uuid].push(r.uuid):e[r.component.uuid]=[r.uuid])}),this.eventContext.page.traverseEntity(r=>{var i;(i=r.data)==null||i.events.filter(n=>n.data.type==="DragDrop"&&!n.data.disabled).forEach(n=>{this.events.push(new J6e(r,n.id,n.data,this.eventContext.page,this.eventContext.sharedAssets,this.eventManager,e))})}),!this.events.length)return;this.domEventsNeeded.clear(),this.domEventsNeeded.add("pointerdown");let t=this.eventContext.domElement;t.addEventListener("pointerdown",this.onPointerDown),t.addEventListener("pointermove",this.onPointerMove),t.addEventListener("pointerup",this.onPointerUp),this.domEventsNeeded.add("pointermove")}disconnect(){if(!this.events.length)return;this.domEventsNeeded.clear();let e=this.eventContext.domElement;e.removeEventListener("pointerdown",this.onPointerDown),e.removeEventListener("pointermove",this.onPointerMove),e.removeEventListener("pointerup",this.onPointerUp),this.events.forEach(t=>t.dispose())}setCursor(e){this.eventContext.domElement.style.cursor=e}onAnimationFrameDamping(){for(let e of this.events)for(let t of e.dragItems)t.paused||this.updateDragItem(t,!0)}calcPlaneIntersectPos(e,t,r,i){let{getCamera:n,raycaster:a}=this.eventContext;n().getWorldDirection(qc),qc.negate();let o=Hd.identity();switch(i==="parent"?Q6e.multiplyMatrices(e.parent.matrixWorld,e.hiddenMatrix).decompose(Hr,o,vn):i==="local"&&e.matrixWorld.decompose(Hr,o,vn),r){case"x":Hr.set(1,0,0).applyQuaternion(o),_f.copy(qc).cross(Hr),Us.copy(Hr).cross(_f);break;case"y":Hr.set(0,1,0).applyQuaternion(o),_f.copy(qc).cross(Hr),Us.copy(Hr).cross(_f);break;case"z":Hr.set(0,0,1).applyQuaternion(o),_f.copy(qc).cross(Hr),Us.copy(Hr).cross(_f);break;case"xy":Us.set(0,0,1).applyQuaternion(o);break;case"yz":Us.set(1,0,0).applyQuaternion(o);break;case"xz":Us.set(0,1,0).applyQuaternion(o);break;case"adaptive":qc.angleTo(vn.set(0,1,0))>Math.PI/6?(Hr.crossVectors(vn.set(0,1,0),qc),Us.crossVectors(Hr,vn)):Us.set(0,1,0);break;default:Us.copy(qc);break}dd.setFromMatrixPosition(e.matrixWorld);let s=e.userData.lockedPlane?e.userData.worldPosition0:dd;if(jF.setFromNormalAndCoplanarPoint(Us,s),!!a.ray.intersectPlane(jF,t)&&(r==="x"||r==="y"||r==="z")){let l=vn.subVectors(t,s).dot(Hr);t.copy(s).addScaledVector(Hr,l)}}updateDragItem(e,t=!1){var r,i;dd.setFromMatrixPosition(e.obj.matrixWorld),e.reset==="current"?sv.subVectors(e.fromPosition,dd).divideScalar(e.currentDampingFactor):e.reset==="original"?(sv.subVectors(e.obj.userData.worldPosition0,dd).divideScalar(e.currentDampingFactor),e.fromPosition.copy(e.obj.userData.worldPosition0),e.pointStart.copy(e.fromPosition),e.pointEnd.copy(e.pointStart)):sv.subVectors(e.pointEnd,e.pointStart).add(e.fromPosition).sub(dd).divideScalar(e.currentDampingFactor),e.paused=e.currentDampingFactor>1?sv.length()<K6e:!0,(this.activeEvent&&this.activeEvent.data.dampingFactor===1||t)&&Z6e(e,sv.add(dd),(r=this.activeEvent)!=null&&r.data.drop&&((i=this.activeEvent)!=null&&i.data.autoOrient)?e.orientationMatrix:null),e.obj.dispatchEvent({type:"beginEvent",eventName:"DragDrop"}),this.eventManager.requestRender()}},Mf=new k,r2=new k,kl=new k,Ll=new k,HF=new Ya,tje=.01,rje={type:"requestRender"},ije=function(){let e=new k,t=new k;return(r,i,n)=>n>0?(e.subVectors(r,i),e.length()<=n?r:t.copy(i).add(e.normalize().multiplyScalar(n))):i}(),WF=function(){let e=new it;return(t,r)=>{t.position.copy(r),t.parent!==null&&(e.copy(t.parent.matrixWorld).invert(),t.position.applyMatrix4(e)),e.copy(t.hiddenMatrix).invert(),t.position.applyMatrix4(e),t.updateMatrix(),t.hasNonUniformScale&&(t.updateMatrixWorld(),t.updateMatrixWorldSVD()),t instanceof Fa&&ic(t.parent)&&t.invalidateDownstreamBooleanData(!0)}}(),nje=class{constructor(e,t,r,i,n,a){this.data=e,this.id=t,this.object=r,this.paused=!1,this.currentDampingFactor=1,this.snapComplete=!1,this.isReset=!1,this.worldPosition0=new k,this.timeoutId=null,this.delayFinished=!0,this.wasOutside=!1,this.data={...NM.defaultData,...e,...e.resetOnPointerLeave===void 0&&{resetOnPointerLeave:!1}},e.target===void 0||e.target==="cursor"||(this.target=i.find(e.target)),this.data.dampingFactor&&(this.currentDampingFactor=this.data.dampingFactor),this.resetDampingFactor=80/this.data.resetSpeed+1,this.object.getWorldPosition(this.worldPosition0),this.actions=$n(e,e.actions,i,n,a,r)}},aje=class extends lo{constructor(e,t){super(e),this.eventManager=t,this.events=[],this.pairOfEventListeners=[],this.onMouseMove=r=>{if(!(Wt.length>1)){this.eventContext.updateRaycaster(r);for(let i of this.events)i.target===void 0&&this.updateSingleEvent(i)}},this.onMouseEnter=r=>{for(let i of this.events)i.target===void 0&&(i.isReset=!1,i.currentDampingFactor=i.data.dampingFactor)},this.onMouseLeave=r=>{for(let i of this.events)i.target===void 0&&(i.data.resetOnPointerLeave&&(i.isReset=!0,i.currentDampingFactor=i.resetDampingFactor),this.updateSingleEvent(i))},this.onTargetChange=r=>()=>{this.updateSingleEvent(r)}}connect(){let{page:e}=this.eventContext;if(e.traverseEntity(i=>{var a,o;let n=(a=i.data)==null?void 0:a.events.find(s=>s.data.type==="Follow"&&!s.data.disabled);n&&(!e.data.globalPhysics.usePhysics||((o=i.dataPatched.physics)==null?void 0:o.rigidBody)!=="dynamic")&&this.events.push(new nje(n.data,n.id,i,e,this.eventContext.sharedAssets,this.eventManager))}),!this.events.length)return;let{domElement:t,eventElement:r}=this.eventContext;this.domEventsNeeded.clear(),vo&&(this.domEventsNeeded.add("pointerdown"),t.addEventListener("pointerdown",this.onMouseMove)),this.domEventsNeeded.add("pointermove"),r.addEventListener("pointermove",this.onMouseMove),this.eventContext.useWindowEvents||(t.addEventListener("pointerenter",this.onMouseEnter),t.addEventListener("pointerleave",this.onMouseLeave));for(let i of this.events)if(i.target!==void 0){let n=i.target,a=this.onTargetChange(i);this.pairOfEventListeners.push([n,a]),n.addEventListener("requestRender",a)}}disconnect(){if(!this.events.length)return;let{domElement:e,eventElement:t}=this.eventContext;this.domEventsNeeded.clear(),vo&&e.removeEventListener("pointerdown",this.onMouseMove),t.removeEventListener("pointermove",this.onMouseMove),e.removeEventListener("pointerenter",this.onMouseEnter),e.removeEventListener("pointerleave",this.onMouseLeave);for(let[r,i]of this.pairOfEventListeners)r.removeEventListener("requestRender",i);for(let r of this.events)r.paused=!0,r.isReset=!1,jn(r.actions)}onAnimationFrameDamping(){for(let e of this.events)e.paused||this.updateSingleEvent(e,!0)}updateSingleEvent(e,t=!1){var o;this.events.forEach(s=>{s.actions.Create.forEach(l=>{l.dispatchThrottled()})});let{plane:r,limitDistance:i,limitDistanceEnabled:n}=e.data;if(e.object.getWorldPosition(kl),e.isReset)Ll.copy(e.worldPosition0);else if(e.target)e.target.getWorldPosition(Ll);else{let{getCamera:s,raycaster:l}=this.eventContext;if(r==="custom"?(s().getWorldDirection(r2),r2.negate(),Mf.copy(r2)):r==="xy"?Mf.set(0,0,1):r==="xz"?Mf.set(0,1,0):r==="yz"&&Mf.set(1,0,0),HF.setFromNormalAndCoplanarPoint(Mf,kl),!l.ray.intersectPlane(HF,Ll))return}if(!e.isReset){if(Ll.distanceTo(e.worldPosition0)>i&&n&&e.target)if(e.snapComplete=!1,e.data.snapDelay&&(e.delayFinished=!1,typeof window<"u"&&e.timeoutId!==null&&(window.clearTimeout(e.timeoutId),e.timeoutId=null)),e.wasOutside=!0,e.data.resetAfterDistanceLimit)Ll.copy(e.worldPosition0),e.currentDampingFactor=e.resetDampingFactor;else return;else if(e.wasOutside&&(e.data.snapDelay&&typeof window<"u"&&(e.timeoutId=window.setTimeout(()=>{e.delayFinished=!0,e.paused=!1,this.updateSingleEvent(e)},e.data.snapDelay*1e3)),e.currentDampingFactor=e.data.dampingFactor,e.wasOutside=!1),e.delayFinished===!1)return}e.data.enabledTranslation[0]===!1&&(Ll.x=kl.x),e.data.enabledTranslation[1]===!1&&(Ll.y=kl.y),e.data.enabledTranslation[2]===!1&&(Ll.z=kl.z);let a=ije(kl,Ll,e.wasOutside?0:e.data.maxDelta);if(e.currentDampingFactor>1){let s=Mf.subVectors(a,kl).divideScalar(e.currentDampingFactor);kl.add(s),t&&WF(e.object,kl),e.paused=s.length()<tje}else WF(e.object,a),e.paused=!0;(o=e.object)==null||o.dispatchEvent({type:"beginEvent",eventName:"Follow"}),e.object.dispatchEvent(rje)}},lv=new k,_b=new k,cv=new it,Ef=new Kt,Yc=new Kt,uv=new k,dv=new k,hd=new k,Bl=new k,i2=new Ya,oje=1e-6,sje={type:"requestRender"},lje={type:"changeRotation"},GF=function(){let e=new it;return function(t,r){t.parent!==null?e.multiplyMatrices(t.parent.matrixWorld,t.hiddenMatrix):e.copy(t.hiddenMatrix),r.premultiply(L7(e).invert()),t.rotation.setFromRotationMatrix(r),t.updateMatrix(),t instanceof Fa&&ic(t.parent)&&t.invalidateDownstreamBooleanData(!0)}}(),cje=class{constructor(e,t,r,i){this.id=t,this.object=r,this.paused=!1,this.currentDampingFactor=1,this.isReset=!1,this.worldQuaternion0=new Kt,this.timeoutId=null,this.delayFinished=!0,this.wasOutside=!1,this.data={...UM.defaultData,...e,...e.resetOnPointerLeave===void 0&&{resetOnPointerLeave:!1}},e.target===void 0||e.target==="cursor"||(this.target=i.find(e.target)),this.data.dampingFactor&&(this.currentDampingFactor=this.data.dampingFactor),this.object.getWorldQuaternion(this.worldQuaternion0),this.resetDampingFactor=80/this.data.resetSpeed+1}},uje=class extends lo{constructor(){super(...arguments),this.events=[],this.pairOfEventListeners=[],this.pairOfUserEventListeners=[],this.onMouseMove=e=>{if(!(Wt.length>1)){this._lastMouseEvent=e,this.eventContext.updateRaycaster(e);for(let t of this.events)t.target===void 0&&this.updateSingleEvent(t)}},this.onMouseEnter=e=>{for(let t of this.events)t.target===void 0&&(t.isReset=!1,t.currentDampingFactor=t.data.dampingFactor)},this.onMouseLeave=e=>{for(let t of this.events)t.target===void 0&&(t.data.resetOnPointerLeave&&(t.isReset=!0,t.currentDampingFactor=t.resetDampingFactor),this.updateSingleEvent(t))},this.onScroll=e=>{if(this._lastMouseEvent){let t=new PointerEvent("pointermove",{clientX:this._lastMouseEvent.clientX,clientY:this._lastMouseEvent.clientY,bubbles:!0,cancelable:!0,view:window});this.eventContext.eventElement.dispatchEvent(t)}},this.onTargetChange=e=>()=>{this.updateSingleEvent(e)},this.createUserEventListener=e=>({eventName:t,target:r})=>{if(!t||!r)return;let i=D0(t);i&&i==="LookAt"&&this.updateSingleEvent(e)}}connect(){let{page:e}=this.eventContext;if(e.traverseEntity(i=>{var a,o;let n=(a=i.data)==null?void 0:a.events.find(s=>s.data.type==="LookAt"&&!s.data.disabled);n&&(!e.data.globalPhysics.usePhysics||((o=i.dataPatched.physics)==null?void 0:o.rigidBody)!=="dynamic")&&this.events.push(new cje(n.data,n.id,i,e))}),!this.events.length)return;let{domElement:t,eventElement:r}=this.eventContext;this.domEventsNeeded.clear(),vo&&(this.domEventsNeeded.add("pointerdown"),t.addEventListener("pointerdown",this.onMouseMove)),this.domEventsNeeded.add("pointermove"),r.addEventListener("pointermove",this.onMouseMove),this.eventContext.useWindowEvents?r.addEventListener("scroll",this.onScroll):(t.addEventListener("pointerenter",this.onMouseEnter),t.addEventListener("pointerleave",this.onMouseLeave));for(let i of this.events){if(i.target!==void 0){let o=this.onTargetChange(i),s=i.target;this.pairOfEventListeners.push([s,o]),s.addEventListener("requestRender",o)}let n=this.createUserEventListener(i),a=i.object;this.pairOfUserEventListeners.push([a,n]),a.addEventListener("userEvent",n)}}disconnect(){if(!this.events.length)return;let{domElement:e,eventElement:t}=this.eventContext;this.domEventsNeeded.clear(),vo&&e.removeEventListener("pointerdown",this.onMouseMove),t.removeEventListener("pointermove",this.onMouseMove),e.removeEventListener("pointerenter",this.onMouseEnter),e.removeEventListener("pointerleave",this.onMouseLeave),t.removeEventListener("scroll",this.onScroll);for(let[r,i]of this.pairOfEventListeners)r.removeEventListener("requestRender",i);for(let[r,i]of this.pairOfUserEventListeners)r.removeEventListener("userEvent",i);for(let r of this.events)r.paused=!0,r.isReset=!1}onAnimationFrameDamping(){for(let e of this.events)e.paused||this.updateSingleEvent(e)}updateSingleEvent(e){var h;let{tilt:t,axis:r,distance:i,plane:n,limitDistance:a,enabledRotation:o,limitDistanceEnabled:s}=e.data,{getCamera:l,raycaster:c}=this.eventContext,{object:u,target:d}=e;if(u.getWorldPosition(uv),!e.isReset)if(e.target)e.target.getWorldPosition(dv);else{if(n==="custom"?(l().getWorldDirection(_b),_b.negate(),i2.setFromNormalAndCoplanarPoint(_b,uv)):(n==="xy"?lv.set(0,0,1):n==="xz"?lv.set(0,1,0):n==="yz"&&lv.set(1,0,0),i2.setFromNormalAndCoplanarPoint(lv,uv)),!c.ray.intersectPlane(i2,dv))return;i>0&&(n==="custom"||n===void 0)&&dv.addScaledVector(_b,i)}if(e.isReset||(d?t==="target"?hd.copy(d.up).applyMatrix4(cv.extractRotation(d.matrixWorld)).normalize():o.some(f=>f===!1)?(r==="x"?(Bl.set(0,0,1),o[2]===!1&&Bl.set(0,1,0)):r==="y"?(Bl.set(1,0,0),o[0]===!1&&Bl.set(0,0,1)):(Bl.set(0,1,0),o[1]===!1&&Bl.set(1,0,0)),hd.copy(Bl).applyQuaternion(e.worldQuaternion0).normalize()):hd.set(0,1,0):n==="custom"?hd.set(0,1,0):hd.copy(lv)),e.isReset)Yc.copy(e.worldQuaternion0);else if(uv.distanceTo(dv)>a&&s&&d)if(e.data.snapDelay&&(e.delayFinished=!1,typeof window<"u"&&e.timeoutId!==null&&(window.clearTimeout(e.timeoutId),e.timeoutId=null)),e.wasOutside=!0,e.data.resetAfterDistanceLimit)Yc.copy(e.worldQuaternion0),e.currentDampingFactor=e.resetDampingFactor;else return;else{if(e.wasOutside&&(e.data.snapDelay&&typeof window<"u"&&(e.timeoutId=window.setTimeout(()=>{e.delayFinished=!0,e.paused=!1,this.updateSingleEvent(e)},e.data.snapDelay*1e3)),e.currentDampingFactor=e.data.dampingFactor,e.wasOutside=!1),e.delayFinished===!1)return;dje(cv,dv,uv,hd,r,Bl),Yc.setFromRotationMatrix(cv),Ef.setFromUnitVectors(Bl.applyQuaternion(Yc),hd),o.some(f=>f===!1)&&t!=="target"&&Yc.premultiply(Ef).normalize()}e.currentDampingFactor>1?(u.updateWorldMatrix(!0,!1),Ef.setFromRotationMatrix(L7(u.matrixWorld)),Ef.slerp(Yc,1/e.currentDampingFactor),GF(u,cv.makeRotationFromQuaternion(Ef)),e.paused=8*(1-Ef.dot(Yc))<oje):(GF(u,cv.makeRotationFromQuaternion(Yc)),e.paused=!0),(h=e.object)==null||h.dispatchEvent({type:"beginEvent",eventName:"LookAt"}),u.dispatchEvent(sje),u.dispatchEvent(lje)}},Mo=new k,mn=new k,Wi=new k;function dje(e,t,r,i,n,a){let o=e.elements;Wi.subVectors(t,r),Wi.lengthSq()===0&&(Wi.z=1),Wi.normalize(),mn.crossVectors(i,Wi),mn.lengthSq()===0&&(Math.abs(i.z)===1?Wi.x+=1e-4:Wi.z+=1e-4,Wi.normalize(),mn.crossVectors(i,Wi)),mn.normalize(),Mo.crossVectors(Wi,mn),n==="x"?a.z===1?[mn,Mo,Wi]=[Wi,mn,Mo]:(mn.negate(),[mn,Wi]=[Wi,mn]):n==="y"?a.x===1?[mn,Mo,Wi]=[Mo,Wi,mn]:(mn.negate(),[Mo,Wi]=[Wi,Mo]):a.x===1&&(mn.negate(),[mn,Mo]=[Mo,mn]),o[0]=mn.x,o[4]=Mo.x,o[8]=Wi.x,o[1]=mn.y,o[5]=Mo.y,o[9]=Wi.y,o[2]=mn.z,o[6]=Mo.z,o[10]=Wi.z}var hje=class{constructor(e,t,r,i,n,a){this.id=e,this.data=t,this.object=r,this.entered=!1,this.actions=$n(t,t.actions,i,n,a,r)}disconnect(){jn(this.actions)}dispatchEnter(){this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),this.entered||(this.entered=!0,this.actions.Transition.forEach(e=>e.playFromCurrent()),this.actions.Animation.forEach(e=>e.play()),this.actions.Create.forEach(e=>e.dispatchStart()),this.actions.Particles.forEach(e=>e.dispatchBasic()),this.actions.Destroy.forEach(e=>e.dispatch()),this.actions.SwitchCamera.forEach(e=>e.playFromCurrent()),this.actions.SceneTransition.forEach(e=>e.dispatch()),this.actions.SetVariable.forEach(e=>e.checkConditions()),this.actions.SetVariable.forEach(e=>e.dispatch()),this.actions.DynamicVariablePlay.forEach(e=>e.dispatch()),this.actions.ClearLocalStorage.forEach(e=>e.dispatch()),this.actions.UserAPI.forEach(e=>e.dispatch()))}dispatchLeave(){this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),this.entered&&(this.entered=!1,this.actions.Create.forEach(e=>e.dispatchStop()),this.actions.Transition.forEach(e=>e.reverseFromCurrent()),this.actions.Particles.forEach(e=>e.reverseFromCurrent()),this.actions.SwitchCamera.forEach(e=>e.reverseFromCurrent()))}dispatchUserEvent(e){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),e?(this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.Particles.forEach(t=>t.reverseFromCurrent()),this.actions.Animation.forEach(t=>t.reverseFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.reverseFromCurrent())):(this.actions.Transition.forEach(t=>t.playFromCurrent()),this.actions.Animation.forEach(t=>t.playFromCurrent()),this.actions.Create.forEach(t=>t.dispatch()),this.actions.Particles.forEach(t=>t.dispatchBasic()),this.actions.Destroy.forEach(t=>t.dispatch()),this.actions.SwitchCamera.forEach(t=>t.playFromCurrent())),this.actions.SceneTransition.forEach(t=>t.dispatch()),this.actions.SetVariable.forEach(t=>t.checkConditions()),this.actions.SetVariable.forEach(t=>t.dispatch()),this.actions.DynamicVariablePlay.forEach(t=>t.dispatch()),this.actions.ClearLocalStorage.forEach(t=>t.dispatch()),this.actions.UserAPI.forEach(t=>t.dispatch())}},fje=class extends lo{constructor(e,t){super(e),this.eventManager=t,this.eventsPerObjects={},this.objects=[],this.objects2D=[],this._prevObjects=[],this.onMouseDown=r=>{Wt.length>1||(this.eventContext.updateRaycaster(r),this.handleMouseHoverEvent())},this.onMouseUp=r=>{Wt.length>1||this.handleMouseHoverEvent(!0)},this.onMouseMove=r=>{Wt.length>1||(this.eventContext.updateRaycaster(r),this.handleMouseHoverEvent())},this.onUserEvent=({eventName:r,target:i,reverse:n})=>{var o;if(!r||!i)return;let a=D0(r);a&&a==="MouseHover"&&(i.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),(o=this.eventsPerObjects[i.uuid])==null||o.forEach(s=>s.dispatchUserEvent(n)))}}connect(){let{page:e,sharedAssets:t}=this.eventContext,r=(n,a)=>{var o,s;if(!(!n.visible||!((o=n.data)!=null&&o.events.length))){for(let{id:l,data:c}of n.data.events)if(!c.disabled&&c.type==="MouseHover")try{let u=new hje(l,c,n,e,t,this.eventManager);this.eventsPerObjects[n.uuid]?this.eventsPerObjects[n.uuid].push(u):this.eventsPerObjects[n.uuid]=[u]}catch{}(s=this.eventsPerObjects[n.uuid])!=null&&s.length&&this.objects.push(n instanceof Vn?a:n)}};if(e.traverseEntity(n=>{var a;(n instanceof va||n instanceof Rn)&&((a=n.frame)==null||a.traverse(o=>{r(o,n)})),r(n)}),!this.objects.length)return;let{domElement:i}=this.eventContext;this.domEventsNeeded.clear(),vo&&(this.domEventsNeeded.add("pointerdown"),i.addEventListener("pointerdown",this.onMouseDown),this.domEventsNeeded.add("pointerup"),i.addEventListener("pointerup",this.onMouseUp)),this.domEventsNeeded.add("pointermove"),i.addEventListener("pointermove",this.onMouseMove),this.objects.forEach(n=>{n.addEventListener("userEvent",this.onUserEvent)})}disconnect(){if(!this.objects.length)return;let{domElement:e}=this.eventContext;this.domEventsNeeded.clear(),vo&&(e.removeEventListener("pointerdown",this.onMouseDown),e.removeEventListener("pointerup",this.onMouseUp)),e.removeEventListener("pointermove",this.onMouseMove),Object.values(this.eventsPerObjects).forEach(t=>{t.forEach(r=>{r.disconnect()})}),this.objects.forEach(t=>{t.removeEventListener("userEvent",this.onUserEvent)})}handleMouseHoverEvent(e=!1){let t=[];if(!e){let{stopRaycast:r,raycaster:i,page:n,pointerScreen:a}=this.eventContext,o=!1;if(n.uiCanvas&&(o=Xl(n,[a.x,a.y],Object.keys(this.eventsPerObjects),s=>{t.push(s)})),r&&!o){let s=tx(i,n,this.objects);t=lT(s),s.forEach(l=>{var c,u;l.object instanceof va&&Xl(l.object,[((c=l==null?void 0:l.uv)==null?void 0:c.x)??0,((u=l==null?void 0:l.uv)==null?void 0:u.y)??0],Object.keys(this.eventsPerObjects),d=>{t.push(d)})})}else this.objects.forEach(s=>{var c,u;let l=F1(i,s);l&&(t.push(s),s instanceof va&&Xl(s,[((c=l==null?void 0:l.uv)==null?void 0:c.x)??0,((u=l==null?void 0:l.uv)==null?void 0:u.y)??0],Object.keys(this.eventsPerObjects),d=>{t.push(d)}))})}this._prevObjects.length&&this._prevObjects.forEach(r=>{var i;t.includes(r)||(r.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),(i=this.eventsPerObjects[r.uuid])==null||i.forEach(n=>n.dispatchLeave()))}),t.length&&t.forEach(r=>{var i;r.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),(i=this.eventsPerObjects[r.uuid])==null||i.forEach(n=>n.dispatchEnter())}),this._prevObjects=t}},pje=class{constructor(e,t,r,i,n,a){this.id=e,this.data=t,this.object=r,this.scrollCounter=0,this.actions=$n(t,t.actions,i,n,a,r)}connect(){this.scrollCounter=0}disconnect(){jn(this.actions)}dispatch(e){this.actions.Transition.forEach(i=>{i.object.currentTransitionEvent!==this&&(i.object.currentTransitionEvent=this,i.init())});let t=e>0?1:-1;this.scrollCounter+=t,this.scrollCounter=Math.min(Math.max(this.scrollCounter,0),this.data.steps);let r=this.scrollCounter/this.data.steps;this.actions.Transition.forEach(i=>i.seek(r)),this.actions.Animation.forEach(i=>i.seek(t)),this.actions.Create.forEach(i=>i.dispatchThrottled()),this.actions.SetVariable.forEach(i=>i.checkConditions()),this.actions.SetVariable.forEach(i=>i.dispatch()),this.actions.DynamicVariablePlay.forEach(i=>i.dispatch()),this.actions.ClearLocalStorage.forEach(i=>i.dispatch()),this.actions.UserAPI.forEach(i=>i.dispatch())}dispatchUserEvent(e){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),e?(this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.Animation.forEach(t=>t.reverseFromCurrent())):(this.actions.Transition.forEach(t=>{t.playFromCurrent()}),this.actions.Animation.forEach(t=>{t.playFromCurrent()})),this.actions.Create.forEach(t=>t.dispatchThrottled()),this.actions.SetVariable.forEach(t=>t.checkConditions()),this.actions.SetVariable.forEach(t=>t.dispatch()),this.actions.DynamicVariablePlay.forEach(t=>t.dispatch()),this.actions.ClearLocalStorage.forEach(t=>t.dispatch()),this.actions.UserAPI.forEach(t=>t.dispatch())}},mje=class{constructor(e,t,r,i,n,a,o){this.id=e,this.data=t,this.object=r,this.domElement=a,this.eventManager=o,this.scrollStart=0,this.scrollEnd=0,this.actions=$n(t,t.actions,i,n,o,r)}getStickyParentElement(){let e=this.domElement;for(;e;){if(window.getComputedStyle(e).position==="sticky")return e;e=e.parentElement}return null}computeScrollBounds(){let e=this.getStickyParentElement(),t=e==null?void 0:e.parentElement,r=this.domElement.getBoundingClientRect(),i={top:r.top,bottom:r.bottom,left:r.left,right:r.right,width:r.width,height:r.height};if(t){let c=t.getBoundingClientRect(),u=window.getComputedStyle(e),d=parseFloat(u.marginTop)+parseFloat(u.marginBottom),h=parseFloat(u.top),f=parseFloat(u.bottom),p=c.height-d;if(!isNaN(h))r.top===h?(i.top+=c.top-h,i.bottom+=c.top-h):r.top<0&&(i.top-=p-r.height,i.bottom-=p-r.height);else if(!isNaN(f)){let v=document.body.clientHeight??window.innerHeight,m=window.innerWidth-(document.documentElement.clientWidth??window.innerWidth);r.bottom===v-f?(i.top+=c.top-r.height+f+m,i.bottom+=c.top-r.height+f+m):r.bottom<v-f&&(i.top-=p-r.height,i.bottom-=p-r.height)}}let n=document.body,a=document.documentElement,o=window.pageYOffset||a.scrollTop||n.scrollTop,s=a.clientTop||n.clientTop||0,l=Math.round(i.top+o-s);if(this.data.startFrom==="enter"){let c=window.innerHeight,u=i.height,d=this.data.enterAnchor,h=d==="top"?c:d==="bottom"?c-u:c-u*.5;this.scrollStart=l-h}else this.scrollStart=0;this.scrollStart+=this.data.startOffset??0,this.scrollEnd=this.scrollStart+(this.data.endAfter??400),this.box=i,this.computeScroll({x:window.scrollX,y:window.scrollY})}connect(){this.computeScrollBounds()}disconnect(){jn(this.actions)}handleResize(){this.computeScrollBounds()}get isInvalidBox(){return this.box===void 0||this.box.width===0&&this.box.height===0&&this.box.top===0&&this.box.bottom===0}computeScroll({x:e,y:t}){this.actions.Transition.forEach(n=>{n.object.currentTransitionEvent!==this&&(n.object.currentTransitionEvent=this,n.init())});let r=this.scrollEnd-this.scrollStart,i=Math.min(1,Math.max(0,(t-this.scrollStart)/r));this.actions.Transition.forEach(n=>n.seek(i)),this.actions.Animation.forEach(n=>n.seek(i)),this.actions.Create.forEach(n=>n.dispatchThrottled()),this.actions.SetVariable.forEach(n=>n.checkConditions()),this.actions.SetVariable.forEach(n=>n.dispatch()),this.actions.DynamicVariablePlay.forEach(n=>n.dispatch()),this.actions.ClearLocalStorage.forEach(n=>n.dispatch()),this.actions.UserAPI.forEach(n=>n.dispatch())}dispatch(e){this.isInvalidBox&&this.computeScrollBounds(),this.computeScroll(e)}dispatchUserEvent(e){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),e?(this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.Animation.forEach(t=>t.reverseFromCurrent())):(this.actions.Transition.forEach(t=>{t.playFromCurrent()}),this.actions.Animation.forEach(t=>{t.playFromCurrent()})),this.actions.Create.forEach(t=>t.dispatchThrottled()),this.actions.SetVariable.forEach(t=>t.checkConditions()),this.actions.SetVariable.forEach(t=>t.dispatch()),this.actions.DynamicVariablePlay.forEach(t=>t.dispatch()),this.actions.ClearLocalStorage.forEach(t=>t.dispatch()),this.actions.UserAPI.forEach(t=>t.dispatch())}},vje=class extends lo{constructor(e,t){super(e),this.managers=t,this.wheelEventsPerObject=new Map,this.scrollEventsPerObject=new Map,this.isInview=!0,this.handleResize=()=>{[...this.scrollEventsPerObject.entries()].forEach(([r,i])=>{i.forEach(n=>n.handleResize())})},this.onScroll=r=>{if(!this.isInview)return;let i={y:window.scrollY,x:window.scrollX};[...this.scrollEventsPerObject.entries()].forEach(([n,a])=>{n.dispatchEvent({type:"beginEvent",eventName:"Scroll",scroll:i}),a.forEach(o=>o.dispatch(i))})},this.onWheel=r=>{!this.isInview||r.ctrlKey||[...this.wheelEventsPerObject.entries()].forEach(([i,n])=>{i.dispatchEvent({type:"beginEvent",eventName:"Scroll",deltaY:r.deltaY}),n.forEach(a=>a.dispatch(r.deltaY))})},this.onUserEvent=({eventName:r,target:i,reverse:n})=>{var o;if(!r||!i)return;let a=D0(r);a&&a==="Scroll"&&(i.dispatchEvent({type:"beginEvent",eventName:"Scroll"}),(o=this.wheelEventsPerObject.get(i))==null||o.forEach(s=>{s.dispatchUserEvent(n)}))}}connect(){let{page:e,sharedAssets:t,domElement:r,isExport:i}=this.eventContext,n=a=>{var o,s,l;if((o=a.data)!=null&&o.events.length){for(let{id:c,data:u}of a.data.events)if(!u.disabled&&u.type==="Scroll")if(u.trigger==="load"||!i){let d=new pje(c,u,a,e,t,this.managers);this.wheelEventsPerObject.has(a)?(s=this.wheelEventsPerObject.get(a))==null||s.push(d):this.wheelEventsPerObject.set(a,[d])}else{let d=new mje(c,u,a,e,t,r,this.managers);this.scrollEventsPerObject.has(a)?(l=this.scrollEventsPerObject.get(a))==null||l.push(d):this.scrollEventsPerObject.set(a,[d])}}};e.traverseEntity(a=>{var o;(a instanceof va||a instanceof Rn)&&((o=a.frame)==null||o.traverse(s=>{n(s)})),n(a)}),this.intersectionObserver=new IntersectionObserver(a=>{let o=a[0];o&&(this.isInview=o.isIntersecting)},{root:null}),this.intersectionObserver.observe(this.eventContext.domElement),[...this.wheelEventsPerObject.entries()].forEach(([a,o])=>{o.forEach(s=>s.connect()),a.addEventListener("userEvent",this.onUserEvent)}),[...this.scrollEventsPerObject.entries()].forEach(([a,o])=>{o.forEach(s=>s.connect()),a.addEventListener("userEvent",this.onUserEvent)}),[...this.wheelEventsPerObject.values()].some(a=>a.length)&&(this.domEventsNeeded.add("wheel"),window.addEventListener("wheel",this.onWheel)),[...this.scrollEventsPerObject.values()].some(a=>a.length)&&(this.domEventsNeeded.add("scroll"),window.addEventListener("scroll",this.onScroll),window.addEventListener("resize",this.handleResize))}disconnect(){window.removeEventListener("wheel",this.onWheel),window.removeEventListener("scroll",this.onScroll),window.removeEventListener("resize",this.handleResize),this.intersectionObserver.unobserve(this.eventContext.domElement),this.domEventsNeeded.clear(),[...this.wheelEventsPerObject.entries()].forEach(([e,t])=>{t.forEach(r=>r.disconnect()),e.removeEventListener("userEvent",this.onUserEvent)}),[...this.scrollEventsPerObject.entries()].forEach(([e,t])=>{t.forEach(r=>r.disconnect()),e.removeEventListener("userEvent",this.onUserEvent)})}},gje=class{constructor(e,t,r,i,n,a){this.id=e,this.data=t,this.object=r,this.actions=$n(t,t.actions,i,n,a,r)}disconnect(){jn(this.actions)}dispatch(){this.actions.Transition.forEach(e=>{e.play()}),this.actions.Animation.forEach(e=>{e.play()}),this.actions.SwitchCamera.forEach(e=>{e.play()}),this.actions.SceneTransition.forEach(e=>{e.dispatch()}),this.actions.Reset.forEach(e=>e.dispatch()),this.actions.SetVariable.forEach(e=>e.checkConditions()),this.actions.SetVariable.forEach(e=>e.dispatch()),this.actions.DynamicVariablePlay.forEach(e=>e.dispatch()),this.actions.ClearLocalStorage.forEach(e=>e.dispatch()),this.actions.UserAPI.forEach(e=>e.dispatch()),this.actions.Create.forEach(e=>{e.dispatchFromStart()}),this.actions.Destroy.forEach(e=>{e.dispatchFromStart()})}dispatchAfter(e){this.actions.Audio.forEach(t=>{(t.interaction.data.triggerAfter??"any")===e&&(t.interaction instanceof Vd?t.interaction.audioPlayer.play():t.interaction instanceof rT&&t.interaction.dispatch())}),this.actions.Video.forEach(t=>{let r=t.interaction.data.triggerAfter??"autoplay";r===e&&(t.interaction instanceof gp?t.interaction.play(r==="autoplay"):t.interaction instanceof oT&&t.interaction.dispatch())}),this.actions.Particles.forEach(t=>{(t.data.triggerAfter??"any")===e&&t.dispatchBasic()})}dispatchUserEvent(e){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),e?(this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.Animation.forEach(t=>t.reverseFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.reverseFromCurrent())):(this.actions.Transition.forEach(t=>t.playFromCurrent()),this.actions.Animation.forEach(t=>t.playFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.playFromCurrent())),this.actions.SceneTransition.forEach(t=>t.dispatch()),this.actions.Reset.forEach(t=>t.dispatch()),this.actions.SetVariable.forEach(t=>t.checkConditions()),this.actions.SetVariable.forEach(t=>t.dispatch()),this.actions.DynamicVariablePlay.forEach(t=>t.dispatch()),this.actions.ClearLocalStorage.forEach(t=>t.dispatch()),this.actions.UserAPI.forEach(t=>t.dispatch()),this.actions.Create.forEach(t=>{t.dispatch()}),this.actions.Destroy.forEach(t=>{t.dispatch()}),this.actions.Audio.forEach(t=>{t.interaction instanceof Vd?t.interaction.audioPlayer.play():t.interaction instanceof rT&&t.interaction.dispatch()}),this.actions.Video.forEach(t=>{t.interaction instanceof gp?t.interaction.play():t.interaction instanceof oT&&t.interaction.dispatch()}),this.actions.Particles.forEach(t=>{t.dispatchBasic()})}},yje=class extends lo{constructor(e,t){super(e),this.eventManager=t,this.eventsPerObject=new Map,this.eventsAfterPerObject=new Map,this.onMouseDown=()=>{[...this.eventsAfterPerObject.entries()].forEach(([r,i])=>{r.dispatchEvent({type:"beginEvent",eventName:"Start"}),i.forEach(n=>{n.dispatchAfter("mouseDown")})})},this.onKeyDown=()=>{[...this.eventsAfterPerObject.entries()].forEach(([r,i])=>{r.dispatchEvent({type:"beginEvent",eventName:"Start"}),i.forEach(n=>{n.dispatchAfter("keyDown")})})},this.onAny=()=>{let{domElement:r,isExport:i}=this.eventContext,n=i?document:r;n.removeEventListener("pointerdown",this.onAny),n.removeEventListener("mousedown",this.onAny),document.removeEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach(([a,o])=>{a.dispatchEvent({type:"beginEvent",eventName:"Start"}),o.forEach(s=>{s.dispatchAfter("any")})})},this.onSceneTransitionAudioVideoPlay=()=>{[...this.eventsAfterPerObject.entries()].forEach(([r,i])=>{r.dispatchEvent({type:"beginEvent",eventName:"Start"}),i.forEach(n=>{n.actions.Audio.forEach(a=>{a.interaction instanceof Vd&&a.interaction.audioPlayer.play()}),n.actions.Video.forEach(a=>{let o=a.interaction.data.triggerAfter??"autoplay";a.interaction instanceof gp&&a.interaction.play(o==="autoplay")}),n.actions.Particles.forEach(a=>{a.dispatchBasic()})})})},this.onPlay=()=>{[...this.eventsAfterPerObject.entries()].forEach(([r,i])=>{r.dispatchEvent({type:"beginEvent",eventName:"Start"}),i.forEach(n=>{n.dispatchAfter("autoplay")})})},this.onUserEvent=({eventName:r,target:i,reverse:n})=>{var o,s;if(!r||!i)return;let a=D0(r);a&&a==="Start"&&(i instanceof Vn||i.dispatchEvent({type:"beginEvent",eventName:"Start"}),(o=this.eventsPerObject.get(i))==null||o.forEach(l=>{l.dispatchUserEvent(n)}),(s=this.eventsAfterPerObject.get(i))==null||s.forEach(l=>{l.dispatchUserEvent(n)}))}}connect(){let{sharedAssets:e,page:t}=this.eventContext,r=i=>{var n,a,o,s,l;if((n=i.data)!=null&&n.events.length)for(let{id:c,data:u}of i.data.events){if(u.disabled||u.type!=="Start")continue;let d=new gje(c,u,i,t,e,this.eventManager);(d.actions.Transition.length||d.actions.Animation.length||d.actions.SwitchCamera.length||d.actions.Create.length||d.actions.Destroy.length||d.actions.SceneTransition.length||d.actions.Reset.length||d.actions.SetVariable.length||d.actions.DynamicVariablePlay.length||d.actions.ClearLocalStorage.length||d.actions.UserAPI.length)&&(this.eventsPerObject.has(i)?(a=this.eventsPerObject.get(i))==null||a.push(d):this.eventsPerObject.set(i,[d])),d.actions.Audio.length&&(this.eventsAfterPerObject.has(i)?(o=this.eventsAfterPerObject.get(i))==null||o.push(d):this.eventsAfterPerObject.set(i,[d])),d.actions.Video.length&&(this.hasVideoAction=!0,this.eventsAfterPerObject.has(i)?(s=this.eventsAfterPerObject.get(i))==null||s.push(d):this.eventsAfterPerObject.set(i,[d])),d.actions.Particles.length&&(this.eventsAfterPerObject.has(i)?(l=this.eventsAfterPerObject.get(i))==null||l.push(d):this.eventsAfterPerObject.set(i,[d]))}};if(t.traverseEntity(i=>{var n;(i instanceof va||i instanceof Rn)&&((n=i.frame)==null||n.traverse(a=>{r(a)})),r(i)}),[...this.eventsAfterPerObject.values()].some(i=>i.length)){if(this.eventManager.activateCount===0){let{domElement:i,isExport:n}=this.eventContext,a=n?document:i;a.addEventListener("pointerdown",this.onMouseDown,{once:!0}),a.addEventListener("mousedown",this.onMouseDown,{once:!0}),document.addEventListener("keydown",this.onKeyDown,{once:!0}),a.addEventListener("pointerdown",this.onAny),a.addEventListener("mousedown",this.onAny),document.addEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach(([o,s])=>{o.addEventListener("userEvent",this.onUserEvent)})}else this.onSceneTransitionAudioVideoPlay();this.onPlay()}[...this.eventsPerObject.entries()].forEach(([i,n])=>{i.dispatchEvent({type:"beginEvent",eventName:"Start"}),n.forEach(a=>a.dispatch()),i.addEventListener("userEvent",this.onUserEvent)})}disconnect(){if([...this.eventsAfterPerObject.values()].some(e=>e.length)){let{domElement:e,isExport:t}=this.eventContext,r=t?document:e;r.removeEventListener("pointerdown",this.onMouseDown),r.removeEventListener("mousedown",this.onMouseDown),document.removeEventListener("keydown",this.onKeyDown),r.removeEventListener("pointerdown",this.onAny),r.removeEventListener("mousedown",this.onAny),document.removeEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach(([i,n])=>{i.removeEventListener("userEvent",this.onUserEvent),n.forEach(a=>a.disconnect())})}[...this.eventsPerObject.entries()].forEach(([e,t])=>{e.removeEventListener("userEvent",this.onUserEvent),t.forEach(r=>r.disconnect())}),this.eventsPerObject.clear(),this.eventsAfterPerObject.clear()}},bje=class{constructor(e,t,r,i,n,a){this.id=e,this.data=t,this.object=r,this.initialDisabled=!1,this.actions=$n(t,t.actions,i,n,a,r),this.target=t.target}disconnect(){jn(this.actions)}dispatch(e){this.initialDisabled||(this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),this.object.dispatchEvent({type:"beginEvent",eventName:"Collision"}),this.actions.Transition.forEach(t=>{t.data.runMode==="Toggle"?t.toggle():t.play()}),this.actions.Animation.forEach(t=>{t.data.runMode==="Toggle"?t.toggle():t.play()}),this.actions.Reset.forEach(t=>{t.dispatch()}),this.actions.Link.forEach(t=>{t.dispatch()}),this.actions.Reset.forEach(t=>{t.dispatch()}),this.actions.Create.forEach(t=>{t.dispatch()}),this.actions.Destroy.forEach(t=>{t.dispatch(e??!1)}),this.actions.SetVariable.forEach(t=>t.checkConditions()),this.actions.SetVariable.forEach(t=>t.dispatch()),this.actions.DynamicVariablePlay.forEach(t=>t.dispatch()),this.actions.Audio.forEach(t=>{t.dispatchBasic()}),this.actions.Particles.forEach(t=>{t.dispatchBasic()}),this.actions.Video.forEach(t=>{t.dispatchBasic()}),this.actions.ClearLocalStorage.forEach(t=>t.dispatch()),this.actions.UserAPI.forEach(t=>t.dispatch()))}},xje=class extends lo{constructor(e,t,r,i,n){super(e),this.sharedVariables=t,this.eventManager=r,this.needsMouse=i,this.needsRaycast=n,this.dynamicVars=[],this.variablesToWatch=[],this.prevMouseProperty=null,this.prevRaycastProperty=null,this.pauseTime=0,this.isOutOfFocus=!1,this.events=[],this.onFrame=a=>{let o=this.eventContext.sharedAssets;if(this.rafId=window.requestAnimationFrame(this.onFrame),this.isOutOfFocus)return;let s=new Date,l=[],c=[];for(let h=0;h<this.propertiesToWatch.length;h++){let{objectId:f,property:p,prevValue:v}=this.propertiesToWatch[h],m=this.eventContext.scene.find(f),g=VM.propertyPaths[p];if(g[0]==="width"||g[0]==="height"||g[0]==="depth")m=m.geometry.userData.parameters[g[0]];else for(let y=0;y<g.length;y++)m=m[g[y]];v===null?this.propertiesToWatch[h].prevValue=m instanceof k?m.clone():m:(m instanceof k?!m.equals(v):v!==m)&&(c.push({objId:f,property:p}),m instanceof k?this.propertiesToWatch[h].prevValue.copy(m):this.propertiesToWatch[h].prevValue=m)}for(let h=0;h<this.variablesToWatch.length;h++){let{id:f,prevValue:p}=this.variablesToWatch[h],v=o.getVariable(f);v!==p&&(l.push(f),this.variablesToWatch[h].prevValue=v)}for(let h=0;h<this.dynamicVars.length;h++){let{id:f,expectedTime:p,last:v,data:m,timerSeconds:g,startValue:y}=this.dynamicVars[h],b=1e3;if((m.dynamicVariableType==="timer"||m.dynamicVariableType==="stopwatch")&&m.format==="number3decimal"?b=1:m.dynamicVariableType==="counter"?b=m.updateInterval:m.dynamicVariableType==="random"&&(b=m.isStatic?1/0:m.updateInterval),p===-1){this.dynamicVars[h].last=a,this.dynamicVars[h].expectedTime=a+b;continue}if(!((o.getDynamicVariablePlayState(f)==="Stopped"||o.getDynamicVariablePlayState(f)==="Restarted")&&(this.dynamicVars[h].last=a,this.dynamicVars[h].expectedTime=a+b,m.dynamicVariableType==="counter"&&o.getVariable(f)!==y&&(o.updateVariable(f,y),this.eventManager.requestRender()),(m.dynamicVariableType==="timer"||m.dynamicVariableType==="stopwatch")&&this.dynamicVars[h].timerSeconds!==y&&(this.dynamicVars[h].timerSeconds=y,o.updateVariable(f,Oo.getFormattedTimerTime(y,m)),this.eventManager.requestRender()),o.getDynamicVariablePlayState(f)==="Restarted"&&o.setDynamicVariablePlayState(f,"Playing"),o.getDynamicVariablePlayState(f)==="Stopped"))){if(o.getDynamicVariablePlayState(f)==="Paused"){this.dynamicVars[h].deltaToExpectedTime===void 0&&(this.dynamicVars[h].deltaToExpectedTime=Math.max(this.dynamicVars[h].expectedTime-a,0)),this.dynamicVars[h].last=a-(b-this.dynamicVars[h].deltaToExpectedTime),this.dynamicVars[h].expectedTime=a+this.dynamicVars[h].deltaToExpectedTime;continue}else this.dynamicVars[h].deltaToExpectedTime=void 0;if(a>=p)if(this.dynamicVars[h].last=a,this.dynamicVars[h].expectedTime+=b,m.dynamicVariableType==="random"){let x=m.min+Math.random()*(m.max-m.min),S=m.decimals;x=Math.round(x*Math.pow(10,S))/Math.pow(10,S),o.updateVariable(f,x),l.push(f),this.eventManager.requestRender()}else if(m.dynamicVariableType==="counter"){let x=o.getVariable(f),S=o.getDynamicVariableToggleIsForward(f)??!0,w=o.getVariable(f)+m.increment*(S?1:-1);m.hasEnd&&(w=m.increment>0?St.clamp(w,y,m.endValue):St.clamp(w,m.endValue,y),w===y&&o.setDynamicVariableToggleIsForward(f,void 0),m.repeat?w===m.endValue&&(w=y):(w===y||w===m.endValue)&&o.setDynamicVariablePlayState(f,"Paused")),w!==x&&(l.push(f),o.updateVariable(f,w),this.eventManager.requestRender())}else if(m.dynamicVariableType==="time"){let x=o.getVariable(f),S=u4(s,m);if(typeof x=="object"&&"textValue"in x&&typeof S=="object"&&"textValue"in S){if(Array.isArray(x.textValue)&&Array.isArray(S.textValue)){if(x.textValue.every((w,_)=>w===S.textValue[_]))continue}else if(x.textValue===S.textValue)continue}else if(x===S)continue;o.updateVariable(f,S),l.push(f),this.eventManager.requestRender()}else{let x=na.isTextValue(m.endValue)?$F(m.endValue.textValue):m.endValue,S=o.getDynamicVariableToggleIsForward(f)??!0,w=g+(a-v)/1e3*(m.dynamicVariableType==="timer"?-1:1)*(S?1:-1);w=Math.max(w,0),m.hasEnd&&(w=m.dynamicVariableType==="stopwatch"?St.clamp(w,y,x):St.clamp(w,x,y),w===y&&o.setDynamicVariableToggleIsForward(f,void 0),m.repeat?Math.abs(w-x)<(m.format==="number3decimal"?1e-4:.1)&&(w=y):(Math.abs(w-y)<(m.format==="number3decimal"?1e-4:.1)||Math.abs(w-x)<(m.format==="number3decimal"?1e-4:.1))&&o.setDynamicVariablePlayState(f,"Paused")),w!==g&&(l.push(f),this.dynamicVars[h].timerSeconds=w,o.updateVariable(f,Oo.getFormattedTimerTime(w,m)),this.eventManager.requestRender())}}}let u=!1;o.mouseProperty!==this.prevMouseProperty&&(this.prevMouseProperty=o.mouseProperty,u=!0);let d=!1;o.raycastProperty!==this.prevRaycastProperty&&(this.prevRaycastProperty=o.raycastProperty,d=!0),this.events.forEach(h=>{(l.includes(h.data.variableId)||c.find(f=>f.objId===h.data.objectId&&f.property===h.data.property)||h.data.variableId==="mouseProperty"&&u||h.data.variableId==="raycastProperty"&&d)&&(h.dispatch(),this.eventManager.requestRender())})},this.onBlur=()=>{this.pause()},this.onFocus=()=>{this.resume()}}pause(){this.isOutOfFocus||(this.isOutOfFocus=!0,this.pauseTime=Date.now())}resume(){if(!this.isOutOfFocus)return;this.isOutOfFocus=!1;let e=Date.now()-this.pauseTime;for(let t=0;t<this.dynamicVars.length;t++)this.dynamicVars[t].last+=e,this.dynamicVars[t].expectedTime+=e}connect(){this.eventContext.page.traverseEntity(t=>{var r;(r=t.data)==null||r.events.filter(i=>i.data.type==="VariableChange"&&!i.data.disabled).forEach(i=>{this.events.push(new wje(i.id,i.data,t,this.eventContext.page,this.eventContext.sharedAssets,this.eventManager))})}),this.propertiesToWatch=this.events.filter(t=>t.data.variableId==="objectProperty"&&t.data.objectId!==null).map(t=>({objectId:t.data.objectId,property:t.data.property,prevValue:null}));let e=this.eventContext.sharedAssets;this.sharedVariables.forEach(({id:t,data:r})=>{if(!("dynamicVariableType"in r)){this.events.find(n=>n.data.variableId===t)&&this.variablesToWatch.push({id:t,prevValue:e.getVariable(t)});return}let i;if(r.dynamicVariableType==="timer"||r.dynamicVariableType==="stopwatch"){let n;if(na.isTextValue(r.value)&&Array.isArray(r.value.textValue)){let a=r.value.textValue;a.length===3?n=a[2]+a[1]*60+a[0]*3600:n=a[1]+a[0]*60}else n=r.value;i=n,this.dynamicVars.push({id:t,last:-1,expectedTime:-1,data:r,timerSeconds:n,startValue:i})}else r.dynamicVariableType==="time"&&e.updateVariable(t,u4(new Date,r)),r.dynamicVariableType==="counter"&&(i=na.isTextValue(r.value)?$F(r.value.textValue):r.value),this.dynamicVars.push({id:t,last:-1,expectedTime:-1,data:r,startValue:i})}),this.rafId=window.requestAnimationFrame(this.onFrame),window.addEventListener("blur",this.onBlur),window.addEventListener("focus",this.onFocus)}disconnect(){window.removeEventListener("blur",this.onBlur),window.removeEventListener("focus",this.onFocus),this.rafId&&(window.cancelAnimationFrame(this.rafId),this.rafId=void 0),this.events.forEach(e=>e.dispose())}},wje=class{constructor(e,t,r,i,n,a){this.id=e,this.data=t,this.object=r,this.actions=$n(t,t.actions,i,n,a,r)}dispatch(){let e=this.actions;e.Audio.forEach(t=>t.dispatchConditional()),e.Particles.forEach(t=>t.dispatchConditional()),e.Video.forEach(t=>t.dispatchConditional()),e.Create.forEach(t=>t.dispatch()),e.Destroy.forEach(t=>t.dispatch()),e.Reset.forEach(t=>t.dispatch()),e.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this),t.init()}),e.Transition.forEach(t=>t.play()),e.Animation.forEach(t=>t.play()),e.SwitchCamera.forEach(t=>t.play()),e.SceneTransition.forEach(t=>t.dispatch()),e.SetVariable.forEach(t=>t.checkConditions()),e.SetVariable.forEach(t=>t.dispatch()),e.DynamicVariablePlay.forEach(t=>t.dispatch()),e.ClearLocalStorage.forEach(t=>t.dispatch()),e.UserAPI.forEach(t=>t.dispatch())}dispose(){jn(this.actions)}};function $F(e){return e.length===3?e[2]+e[1]*60+e[0]*3600:e[1]+e[0]*60}var Sje="https://unpkg.com/@splinetool/runtime@1.9.21/build/",Cje="https://unpkg.com/@splinetool/navmesh-wasm@1.9.21/build/",_je=`
(async function() {
	const [wasmImport, wasmBinary] = await Promise.all([
		import('${Sje}' + 'navmesh.js'),
		fetch('${Cje}' + 'navmesh.wasm').then((res) => res.arrayBuffer()),
	]);
	const wasmModule = wasmImport.default;
	self.module = await wasmModule({ wasmBinary });
	postMessage('ready');
})();
`,Aje=`
(async function() {
	const [wasmImport, wasmBinary] = await Promise.all([
		import(self.location.origin + '/_libraries/navmesh.js'),
		fetch(self.location.origin + '/_libraries/navmesh.wasm').then((res) => res.arrayBuffer()),
	]);
	const wasmModule = wasmImport.default;
	self.module = await wasmModule({ wasmBinary });
	postMessage('ready');
})();
`,Mje=`

onmessage = function(messageEvent) {
	const meshData = messageEvent.data;
	const positions = meshData[0];
	const offset = meshData[1];
	const indices = meshData[2];
	const indicesLength = meshData[3];
	const parameters = meshData[4];

	const module = self.module;
	const rc = new module.rcConfig();
	rc.cs = parameters.cs;
	rc.ch = parameters.ch;
	rc.borderSize = parameters.borderSize ? parameters.borderSize : 0;
	rc.tileSize = parameters.tileSize ? parameters.tileSize : 0;
	rc.walkableSlopeAngle = parameters.walkableSlopeAngle;
	rc.walkableHeight = parameters.walkableHeight;
	rc.walkableClimb = parameters.walkableClimb;
	rc.walkableRadius = parameters.walkableRadius;
	rc.maxEdgeLen = parameters.maxEdgeLen;
	rc.maxSimplificationError = parameters.maxSimplificationError;
	rc.minRegionArea = parameters.minRegionArea;
	rc.mergeRegionArea = parameters.mergeRegionArea;
	rc.maxVertsPerPoly = parameters.maxVertsPerPoly;
	rc.detailSampleDist = parameters.detailSampleDist;
	rc.detailSampleMaxError = parameters.detailSampleMaxError;

	if (!self.navMesh) {
		self.navMesh = new module.NavMesh();
	}
	self.navMesh.build(positions, offset, indices, indicesLength, rc);

	const navmeshData = navMesh.getNavmeshData();
	const arrView = new Uint8Array(module.HEAPU8.buffer, navmeshData.dataPointer, navmeshData.size);
	const ret = new Uint8Array(navmeshData.size);
	ret.set(arrView);
	navMesh.freeNavmeshData(navmeshData);

	postMessage(ret);
}
`,Eje=.001,Tje={cs:6,ch:2,walkableSlopeAngle:90,walkableHeight:20,walkableClimb:5,walkableRadius:0,maxEdgeLen:12,maxSimplificationError:1.3,minRegionArea:8,mergeRegionArea:20,maxVertsPerPoly:6,detailSampleDist:6,detailSampleMaxError:1},V7,wr,Xn;QOe.then(e=>{V7=e,wr=new e.Vec3,Xn=new e.Vec3});var Pje=new k,Dje=class{constructor(e=!1,t=!1){this.usePhysics=e,this.isExport=t,this.onPointerDown=r=>{if(Wt.length!==1)return;let{raycaster:i,page:n}=this.eventContext;this.eventContext.updateRaycaster(r);let a=n.raycastWithClones(i);if(a.length!==0){if(this.gameControl){let o=Pje.copy(this.gameControl.colliderWorldPosition);o.y-=this.gameControl.colliderHeight/2,this.gameControl.path=this.computePath(o,a[0].point)}this.eventContext.requestRender()}},this.traverseWithPhysics=(r,i)=>n=>{var h,f,p,v,m,g,y;let a;if(n instanceof ds)if(n.objectForSample){if(n.objectForSample.dataPatched.physics.fusedBody)return;a=n.object}else return n.object.dataPatched.physics.fusedBody===!0&&n.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(n instanceof ya)a=n.object;else if(a=n,((h=a.dataPatched.cloner)==null?void 0:h.disabled)===!1&&((f=a.dataPatched.cloner)==null?void 0:f.hideBase)&&((p=a.dataPatched.physics)==null?void 0:p.fusedBody)!==!0)return!0;if(i&&!a.userData.navmesh)return;let o=a.dataPatched;if(!o.visible&&((v=o.physics)==null?void 0:v.enabled)!==!0)return!0;n.updateMatrixWorldSVD();let s=N1(o),l=a.userData.hasDestroy,c=a.userData.hasDrag,u=!1,d=!1;for(let b of o.events)b.data.disabled!==!0&&(b.data.type==="GameControl"?u=!0:b.data.type==="Follow"&&(d=!0));if(u||s||d||l||c)return!0;if(this.usePhysics&&((m=o.physics)==null?void 0:m.rigidBody)==="dynamic"){if(this.usePhysics&&((g=o.physics)!=null&&g.fusedBody))return!0}else if("geometry"in n&&n.geometry&&r.push(Yl(n.geometry,n.matrixWorld)),this.usePhysics&&((y=o.physics)==null?void 0:y.fusedBody))return n.traverseObject((b,x)=>{var _,C;if(x===0)return;let S;if(b instanceof ds)if(b.objectForSample){if(b.objectForSample.dataPatched.physics.fusedBody)return;S=b.object}else return b.object.dataPatched.physics.fusedBody===!0&&b.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(b instanceof ya)S=b.object;else if(S=b,(_=b.dataPatched.cloner)==null?void 0:_.hideBase)return!0;let w=S.dataPatched;if(!w.visible&&((C=w.physics)==null?void 0:C.enabled)!==!0)return!0;"geometry"in b&&b.geometry&&r.push(Yl(b.geometry,b.matrixWorld))}),!0},this.traverseNoPhysics=(r,i)=>n=>{let a;if(n instanceof ds)return;n instanceof ya?a=n.object:a=n;let o=a.dataPatched;if(o.physics.enabled==="visibility"?!o.visible:!o.physics.enabled)return!0;if(i&&!a.userData.navmesh)return;let s=n.geometry,l=a.userData.hasDestroy===!0,c=a.userData.hasDrag===!0;if(N1(o)||l||c||a.dataPatched.events.some(u=>u.data.disabled!==!0&&u.data.type==="GameControl"))return!0;s&&r.push(Yl(s,n.matrixWorld))},this.navmeshWasm=V7,this.navMesh=new this.navmeshWasm.NavMesh,this._workerURL=URL.createObjectURL(new Blob([(t?_je:Aje)+Mje])),this._worker=new Worker(this._workerURL)}init(e,t,r){this.gameControl=t,this.eventContext=r,this.setDefaultQueryExtent(new k().setScalar(e.ch*e.walkableRadius*1.2)),this._worker.onmessage=()=>{this.createNavMesh(r.page,e,i=>{this.buildFromNavmeshData(i.data)})},this.eventContext.renderer.domElement.addEventListener("pointerdown",this.onPointerDown)}createNavMesh(e,t,r){t.objects.forEach(l=>{var u;let c=e.scene.find(l);c.traverseEntity(d=>{d.userData.navmesh=!0}),(u=c.cloner)==null||u.traverseObject(d=>{d.userData.navmesh=!0})});let i=[],n=(this.usePhysics?this.traverseWithPhysics:this.traverseNoPhysics)(i,t.zones==="custom");if(e.traverseChildren(n),t.objects.forEach(l=>{var u;let c=e.scene.find(l);c.traverseEntity(d=>{d.userData.navmesh=void 0}),(u=c.cloner)==null||u.traverseObject(d=>{d.userData.navmesh=void 0})}),i.length===0)return!1;let a=jd(i),{positions:o,triIndices:s}=$w(a.getAttribute("position"),a.getIndex());return this._worker.postMessage([o,o.length/3,s,s.length,{...Tje,...t}]),this._worker.onmessage=r,!0}createDebugNavGeometry(){let e,t,r=this.navMesh.getDebugNavMesh(),i=r.getTriangleCount(),n=new Uint32Array(i*3),a=new Float32Array(i*3*3);for(e=0;e<i*3;e++)n[e]=e;for(e=0;e<i;e++)for(t=0;t<3;t++){let s=r.getTriangle(e).getPoint(t);a[e*9+t*3+0]=s.x,a[e*9+t*3+1]=s.y,a[e*9+t*3+2]=s.z}let o=new Ot;return o.setIndex(new qt(n,1)),o.setAttribute("position",new qt(a,3)),o}getClosestPoint(e){return wr.x=e.x,wr.y=e.y,wr.z=e.z,this.navMesh.getClosestPoint(wr)}getClosestPointToRef(e,t){wr.x=e.x,wr.y=e.y,wr.z=e.z;let r=this.navMesh.getClosestPoint(wr);t.set(r.x,r.y,r.z)}getRandomPointAround(e,t){return wr.x=e.x,wr.y=e.y,wr.z=e.z,this.navMesh.getRandomPointAround(wr,t)}getRandomPointAroundToRef(e,t,r){wr.x=e.x,wr.y=e.y,wr.z=e.z;let i=this.navMesh.getRandomPointAround(wr,t);r.set(i.x,i.y,i.z)}moveAlong(e,t){return wr.x=e.x,wr.y=e.y,wr.z=e.z,Xn.x=t.x,Xn.y=t.y,Xn.z=t.z,this.navMesh.moveAlong(wr,Xn)}moveAlongToRef(e,t,r){return wr.x=e.x,wr.y=e.y,wr.z=e.z,Xn.x=t.x,Xn.y=t.y,Xn.z=t.z,this.navMesh.moveAlong(wr,Xn)}computePath(e,t){let r=this.getClosestPoint(t);if(Xn.x=r.x,Xn.y=r.y,Xn.z=r.z,Math.sqrt(Math.pow(t.x-r.x,2)+Math.pow(t.y-r.y,2)+Math.pow(t.z-r.z,2))>this.getDefaultQueryExtent().y)return[];this.getClosestPoint(e);let i=this.navMesh.computePath(wr,Xn),n=i.getPointCount(),a=[];for(let o=0;o<n;o++){let s=i.getPoint(o);a.push(new k(s.x,s.y,s.z))}return a}createCrowd(e,t){return new Oje(this,e,t)}setDefaultQueryExtent(e){wr.x=e.x,wr.y=e.y,wr.z=e.z,this.navMesh.setDefaultQueryExtent(wr)}getDefaultQueryExtent(){return this.navMesh.getDefaultQueryExtent()}buildFromNavmeshData(e){let t=e.length*e.BYTES_PER_ELEMENT,r=this.navmeshWasm._malloc(t),i=new Uint8Array(this.navmeshWasm.HEAPU8.buffer,r,t);i.set(e);let n=new this.navmeshWasm.NavmeshData;n.dataPointer=i.byteOffset,n.size=e.length,this.navMesh.buildFromNavmeshData(n),this.navmeshWasm._free(i.byteOffset)}getNavmeshData(){let e=this.navMesh.getNavmeshData(),t=new Uint8Array(this.navmeshWasm.HEAPU8.buffer,e.dataPointer,e.size),r=new Uint8Array(e.size);return r.set(t),this.navMesh.freeNavmeshData(e),r}getDefaultQueryExtentToRef(e){let t=this.navMesh.getDefaultQueryExtent();e.set(t.x,t.y,t.z)}dispose(){var e;this.navMesh.destroy(),this._worker.terminate(),URL.revokeObjectURL(this._workerURL),(e=this.eventContext)==null||e.renderer.domElement.removeEventListener("pointerdown",this.onPointerDown)}addCylinderObstacle(e,t,r){return wr.x=e.x,wr.y=e.y,wr.z=e.z,this.navMesh.addCylinderObstacle(wr,t,r)}addBoxObstacle(e,t,r){return wr.x=e.x,wr.y=e.y,wr.z=e.z,Xn.x=t.x,Xn.y=t.y,Xn.z=t.z,this.navMesh.addBoxObstacle(wr,Xn,r)}removeObstacle(e){this.navMesh.removeObstacle(e)}isSupported(){return this.navmeshWasm!==void 0}},Oje=class{constructor(e,t,r){this.navmeshWasmWrapper=e,this.transforms=[],this.agents=new Array,this.reachRadii=new Array,this._agentDestinationArmed=new Array,this._agentDestination=new Array,this.crowd=new this.navmeshWasmWrapper.navmeshWasm.Crowd(t,r,this.navmeshWasmWrapper.navMesh.getNavMesh())}onReachTarget(e,t){}addAgent(e,t,r){let i=new this.navmeshWasmWrapper.navmeshWasm.dtCrowdAgentParams;i.radius=t.radius,i.height=t.height,i.maxAcceleration=t.maxAcceleration,i.maxSpeed=t.maxSpeed,i.collisionQueryRange=t.collisionQueryRange,i.pathOptimizationRange=t.pathOptimizationRange,i.separationWeight=t.separationWeight,i.updateFlags=7,i.obstacleAvoidanceType=0,i.queryFilterType=0,i.userData=0;let n=this.crowd.addAgent(new this.navmeshWasmWrapper.navmeshWasm.Vec3(e.x,e.y,e.z),i);return this.transforms.push(r),this.agents.push(n),this.reachRadii.push(t.reachRadius?t.reachRadius:t.radius),this._agentDestinationArmed.push(!1),this._agentDestination.push(new k(0,0,0)),n}getAgentPosition(e){return this.crowd.getAgentPosition(e)}getAgentPositionToRef(e,t){let r=this.crowd.getAgentPosition(e);t.set(r.x,r.y,r.z)}getAgentVelocity(e){return this.crowd.getAgentVelocity(e)}getAgentVelocityToRef(e,t){let r=this.crowd.getAgentVelocity(e);t.set(r.x,r.y,r.z)}getAgentNextTargetPath(e){return this.crowd.getAgentNextTargetPath(e)}getAgentNextTargetPathToRef(e,t){let r=this.crowd.getAgentNextTargetPath(e);t.set(r.x,r.y,r.z)}getAgentState(e){return this.crowd.getAgentState(e)}overOffmeshConnection(e){return this.crowd.overOffmeshConnection(e)}agentGoto(e,t){this.crowd.agentGoto(e,new this.navmeshWasmWrapper.navmeshWasm.Vec3(t.x,t.y,t.z));let r=this.agents.indexOf(e);r>-1&&(this._agentDestinationArmed[r]=!0,this._agentDestination[r].set(t.x,t.y,t.z))}agentTeleport(e,t){this.crowd.agentTeleport(e,new this.navmeshWasmWrapper.navmeshWasm.Vec3(t.x,t.y,t.z))}updateAgentParameters(e,t){let r=this.crowd.getAgentParameters(e);t.radius!==void 0&&(r.radius=t.radius),t.height!==void 0&&(r.height=t.height),t.maxAcceleration!==void 0&&(r.maxAcceleration=t.maxAcceleration),t.maxSpeed!==void 0&&(r.maxSpeed=t.maxSpeed),t.collisionQueryRange!==void 0&&(r.collisionQueryRange=t.collisionQueryRange),t.pathOptimizationRange!==void 0&&(r.pathOptimizationRange=t.pathOptimizationRange),t.separationWeight!==void 0&&(r.separationWeight=t.separationWeight),this.crowd.setAgentParameters(e,r)}removeAgent(e){this.crowd.removeAgent(e);let t=this.agents.indexOf(e);t>-1&&(this.agents.splice(t,1),this.transforms.splice(t,1),this.reachRadii.splice(t,1),this._agentDestinationArmed.splice(t,1),this._agentDestination.splice(t,1))}getAgents(){return this.agents}update(e){if(this.navmeshWasmWrapper.navMesh.update(),e<=Eje)return;let t=1/60,r=10;{let i=Math.floor(e/t);i>r&&(i=r),i<1&&(i=1);let n=e/i;for(let a=0;a<i;a++)this.crowd.update(n)}for(let i=0;i<this.agents.length;i++){let n=this.agents[i],a=this.getAgentPosition(n);if(this.transforms[i].copy(a),this._agentDestinationArmed[i]){let o=a.x-this._agentDestination[i].x,s=a.z-this._agentDestination[i].z,l=this.reachRadii[i],c=this._agentDestination[i].y-this.reachRadii[i],u=this._agentDestination[i].y+this.reachRadii[i],d=o*o+s*s;a.y>c&&a.y<u&&d<l*l&&(this.onReachTarget(n,this._agentDestination[i]),this._agentDestinationArmed[i]=!1)}}}setDefaultQueryExtent(e){let t=new this.navmeshWasmWrapper.navmeshWasm.Vec3(e.x,e.y,e.z);this.crowd.setDefaultQueryExtent(t)}getDefaultQueryExtent(){return this.crowd.getDefaultQueryExtent()}getDefaultQueryExtentToRef(e){let t=this.crowd.getDefaultQueryExtent();e.set(t.x,t.y,t.z)}getCorners(e){let t,r=this.crowd.getCorners(e),i=r.getPointCount(),n=[];for(t=0;t<i;t++){let a=r.getPoint(t);n.push(new k(a.x,a.y,a.z))}return n}dispose(){this.crowd.destroy()}};function Rje(e){let t=!1;return e.scene.objects.forEach(r=>{r.data.type==="Page"&&!t&&r.data.publish.gameControlObject&&Ug.traverseModuleInstances(e,r.id,(i,n,a)=>{for(let o of a)o.data.type==="GameControl"&&o.data.navmesh.enabled&&(t=!0)})}),t}var Ije={type:"change"},qF={type:"changeZoom"},zje={type:"changePan"},fd={type:"start"},pd={type:"end",changed:!0},kje={type:"end",changed:!1},n2=new Kt,YF=new ye,Lje=2*Math.PI,Bje=1e-8,Fje=.01,a2=new k,Ab=new ye,o2=new k,Mb=new Kt,XF=new it,Nje={type:"requestRender"},H7=class extends ca{constructor(e,t,r={isPlayMode:!1,isExport:!1}){super(),this.object=e,this.domElement=t,this.options=r,this.enabled=!0,this.useKeyEvents=!0,this.enableDamping=!1,this.enableZoom=!0,this.enableRotate=!0,this.enablePan=!0,this.autoRotate=!1,this.rotationLimitsMode=0,this.panLimitsMode=0,this.rotationSoftLimit=2,this.panSoftLimit=2,this.hoverRotatePanMode=0,this.zoomLimitsEnabled=!1,this.mouseButtons=[0,5],this.mouseButtonsPlay=[3,4,5],this.touches=[null,wo.DOLLY_ROTATE,wo.PAN],this.offset=new k,this.eye=new k,this.lastPosition=new k,this.lastQuaternion=new Kt,this.current=new ye,this.overShoot=new ye,this.overRatio=new ye,this.spherical=new Tk,this.sphericalDelta=new Tk,this.panOffset=new k,this.panLeftV=new k,this.panUpV=new k,this.panV=new k,this.rotateStart=new ye,this.rotateEnd=new ye,this.rotateDelta=new ye,this.panStart=new ye,this.panEnd=new ye,this.panDelta=new ye,this.dollyStart=new ye,this.dollyEnd=new ye,this.dollyDelta=new ye,this.rotationRangeFactor=new ye,this.panRangeFactor=new ye,this.state=-1,this.zoomChanged=!1,this.isPointerDown=!1,this.isThetaFlipped=!1,this.prevScale=0,this.scale=1,this.gesture=!1,this.timer=-1,this.timerHover=-1,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPhi=0,this.maxPhi=Math.PI,this.minTheta=-1/0,this.maxTheta=1/0,this.minH=0,this.maxH=Math.PI,this.minV=-1/0,this.maxV=1/0,this.autoRotateClockwise=!0,this.isPanOverShoot=!1,this.isRotateOverShoot=!1,this.resetHoverEffectOnPointerLeave=!1,this.hasChange=!1,this.useWindowEvents=!1,this.isTouchZoom=!0,this.autoRotateSpeed=2,this.dampingFactor=.125,this.zoomSpeed=2,this.rotateSpeed=1,this.panSpeed=1,this.hoverRotatePanStrength=.1,this.hoverRotateDamping=this.dampingFactor,this.thetaIsFree=!1,this.phiIsFree=!1,this.needsUpdate=!0,this.onCameraChange=i=>{this.object.removeEventListener("beginState",this.onBeginState),this.object.removeEventListener("completeState",this.onCompleteState),this.object.removeEventListener("cameraChange",this.onCameraChange),this.object=i.camera,this.object.addEventListener("beginState",this.onBeginState),this.object.addEventListener("completeState",this.onCompleteState),this.object.addEventListener("cameraChange",this.onCameraChange)},this.update=()=>{this.object.updateWorldMatrix(!0,!1),this.object.matrixWorld.decompose(o2,Mb,a2),this.offset.copy(o2).sub(this.target),this.spherical.setFromVector3(this.offset),this.object.isUpVectorFlipped&&(this.spherical.phi*=-1,this.spherical.theta-=Math.PI),this.autoRotate&&this.state===-1&&this.rotateLeft((this.autoRotateClockwise===!0?1:-1)*this.getAutoRotationAngle()),this.rotationLimitsMode!==0&&this.applyLimits(this.sphericalDelta,this.rotationLimitsMode,this.rotationSoftLimit,this.maxTheta,this.minTheta,this.maxPhi,this.minPhi,this.rotationRangeFactor),this.rotationLimitsMode!==2&&(this.spherical.phi+=this.sphericalDelta.phi),(this.rotationLimitsMode!==1||this.autoRotate===!0)&&(this.spherical.theta+=this.sphericalDelta.theta),this.spherical.radius*=this.scale,this.zoomLimitsEnabled&&this.object.isPerspectiveCamera&&(this.spherical.radius=Math.max(this.minDistance,Math.min(this.maxDistance,this.spherical.radius))),this.panLimitsMode!==0&&(this.target.applyQuaternion(n2.copy(Mb).invert()),this.panOffset.applyQuaternion(n2),this.applyLimits(this.panOffset,this.panLimitsMode,this.panSoftLimit,this.maxH,this.minH,this.maxV,this.minV,this.panRangeFactor),this.target.applyQuaternion(Mb),this.panOffset.applyQuaternion(Mb)),this.panLimitsMode===2&&(this.panOffset.y=0),this.panLimitsMode===1&&(this.panOffset.x=0),this.state===-1&&!this.gesture?(this.panOffset.multiplyScalar(1-this.dampingFactor),this.target.add(this.panOffset)):(this.target.add(this.panOffset),this.panOffset.set(0,0,0)),this.offset.setFromSpherical(this.spherical),o2.copy(this.target).add(this.offset),this.object.position.copy(this.target).add(this.offset),this.object.parent&&(XF.copy(this.object.parent.matrixWorld).invert(),this.object.position.applyMatrix4(XF));let i=this.spherical.phi%Lje;if(this.eye.copy(this.offset).normalize(),this.object.up.copy(Xr.DEFAULT_UP).applyAxisAngle(this.eye,this.object.angleOffsetFromUp),i>0&&i>Math.PI||i<0&&i>-Math.PI?(this.object.up.negate(),this.object.lookAt(this.target),this.object.isUpVectorFlipped=!0):(this.object.lookAt(this.target),this.object.isUpVectorFlipped=!1),this.state===-1||this.enableDamping===!0){let n=this.hoverRotatePanMode===1?this.hoverRotateDamping:this.dampingFactor;this.sphericalDelta.theta*=1-n,this.sphericalDelta.phi*=1-n}else this.sphericalDelta.set(0,0,0);return this.scale=1,this.zoomChanged||this.lastPosition.distanceToSquared(this.object.position)>Fje||8*(1-this.lastQuaternion.dot(this.object.quaternion))>Bje?(this.dispatchEvent(Ije),this.object.dispatchEvent(Nje),this.lastPosition.copy(this.object.position),this.lastQuaternion.copy(this.object.quaternion),this.zoomChanged=!1,!0):(this.isPanOverShoot=!1,this.isRotateOverShoot=!1,this.object.wasMovedBySwitchCameraAction=!1,this.sphericalDelta.set(0,0,0),this.panOffset.set(0,0,0),!1)},this.onPointerDown=i=>{this.enabled!==!1&&(i.pointerType==="touch"||i.pointerType==="pen"&&vo?this.onPointerDownTouch(i):this.onPointerDownMouse(i),this.state!==-1&&(this.isPointerDown=!0,this.dispatchEvent(fd),this.domElement.addEventListener("pointermove",this.onPointerMove),this.domElement.addEventListener("pointerup",this.onPointerUp),i.stopPropagation(),i.pointerType==="touch"||i.pointerType==="pen"&&vo||this.domElement.setPointerCapture(i.pointerId)))},this.onPointerLeave=i=>{this.resetHoverEffectOnPointerLeave&&!this.useWindowEvents?(this.hoverRotatePanMode===1?(this.sphericalDelta.theta=-this.spherical.theta,this.sphericalDelta.phi=-this.spherical.phi,a2.subVectors(this.position0,this.target0),this.spherical.setFromVector3(a2),this.sphericalDelta.theta+=this.spherical.theta,this.sphericalDelta.phi+=this.spherical.phi,this.sphericalDelta.theta/=8,this.sphericalDelta.phi/=8):this.hoverRotatePanMode===2&&this.panOffset.subVectors(this.target0,this.target).divideScalar(8),this.update()):this.pointerLeaveEvent=i},this.onPointerEnter=i=>{this.resetHoverEffectOnPointerLeave||this.pointerLeaveEvent===void 0?Ab.set(i.clientX-this.domElement.clientWidth/2,i.clientY-this.domElement.clientHeight/2):Ab.set(i.clientX-this.pointerLeaveEvent.clientX,i.clientY-this.pointerLeaveEvent.clientY),this.hoverRotatePanMode===1?(this.rotateDelta.copy(Ab).multiplyScalar(this.rotateSpeed*this.hoverRotatePanStrength).rotateAround(YF,-this.object.angleOffsetFromUp),this.rotateLeft(2*Math.PI*this.rotateDelta.x/this.domElement.clientHeight),this.rotateUp(2*Math.PI*this.rotateDelta.y/this.domElement.clientHeight),this.rotateStart.set(i.clientX,i.clientY)):this.hoverRotatePanMode===2&&(this.panDelta.copy(Ab).multiplyScalar(this.panSpeed*this.hoverRotatePanStrength),this.pan(this.panDelta.x,this.panDelta.y),this.panStart.set(i.clientX,i.clientY)),this.update()},this.onPointerMove=i=>{this.enabled!==!1&&(this.checkRaycastLock()||(i.pointerType==="touch"||i.pointerType==="pen"&&vo?this.onPointerMoveTouch(i):this.onPointerMoveMouse(i),i.stopPropagation()))},this.onPointerUp=i=>{this.isPointerDown=!1,Wt.length===0&&(this.domElement.removeEventListener("pointermove",this.onPointerMove),this.domElement.removeEventListener("pointerup",this.onPointerUp)),Wt.length>1&&i.preventDefault(),this.hasChange?this.dispatchEvent(pd):this.dispatchEvent(kje),this.state=-1,i&&(i.stopPropagation(),i.pointerType==="touch"||i.pointerType==="pen"&&vo||this.domElement.releasePointerCapture(i.pointerId))},this.onPointerDownMouse=i=>{let n;switch(this.useKeyEvents?n=this.mouseButtons[i.button]:n=this.mouseButtonsPlay[i.button],n){case 0:if(i.altKey===!0&&!i.shiftKey&&!By(i)){if(this.enableRotate===!1)return;this.handleMouseDownRotate(i),this.state=0}else if(this.key===" "){if(this.enablePan===!1)return;this.handleMouseDownPan(i),this.state=2}break;case 4:if(this.enablePan===!1)return;this.handleMouseDownPan(i),this.state=2;break;case 3:if(By(i)||i.shiftKey){if(this.enablePan===!1)return;this.handleMouseDownPan(i),this.state=2}else{if(this.enableRotate===!1)return;this.handleMouseDownRotate(i),this.state=0}break;case 5:if(By(i)||i.shiftKey){if(this.enableRotate===!1)return;this.handleMouseDownRotate(i),this.state=0}else{if(this.enablePan===!1)return;this.handleMouseDownPan(i),this.state=2}break;default:this.state=-1}},this.onPointerMoveMouse=i=>{switch(this.state){case 0:if(this.enableRotate===!1)return;this.handleMouseMoveRotate(i);break;case 1:if(this.enableZoom===!1)return;this.handleMouseMoveDolly(i);break;case 2:if(this.enablePan===!1)return;this.handleMouseMovePan(i);break}this.object.wasMovedByUser=!0},this.onPointerDownTouch=i=>{switch(Wt.length>1&&i.preventDefault(),this.touches[Wt.length-1]){case wo.ROTATE:if(this.enableRotate===!1){this.state=-1;return}this.handleTouchStartRotate(),this.state=3;break;case wo.PAN:if(this.enablePan===!1){this.state=-1;return}this.handleTouchStartPan(),this.state=4;break;case wo.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this.handleTouchStartDollyPan(),this.state=5;break;case wo.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this.handleTouchStartDollyRotate(),this.state=6;break;default:this.state=-1}},this.onPointerMoveTouch=i=>{switch(Wt.length>1&&i.preventDefault(),this.state){case 3:if(this.enableRotate===!1)return;this.handleTouchMoveRotate(i),this.update();break;case 4:if(this.enablePan===!1)return;this.handleTouchMovePan(i),this.update();break;case 5:if(this.enableZoom===!1&&this.enablePan===!1)return;this.handleTouchMoveDollyPan(i),this.update();break;case 6:if(this.enableZoom===!1&&this.enableRotate===!1)return;this.handleTouchMoveDollyRotate(i),this.update();break;default:this.state=-1}this.object.wasMovedByUser=!0},this.dispatchEndDebounced=gD(()=>this.dispatchEvent(pd),33),this.onMouseWheel=i=>{this.enabled===!1||this.enableZoom===!1&&this.enablePan===!1||this.checkRaycastLock()||(!this.options.isExport&&this.domElement.clientHeight===document.body.clientHeight&&this.domElement.clientWidth===document.body.clientWidth&&i.preventDefault(),this.dispatchEvent(fd),this.handleMouseWheel(i),this.dispatchEndDebounced(),this.object.wasMovedByUser=!0)},this.onGesture=i=>{if(i.preventDefault(),this.enabled!==!1&&!this.checkRaycastLock()&&!S0)if(i.type==="gesturechange"){if(this.enableZoom===!1||this.isTouchZoom===!1)return;this.dispatchEvent(fd),i.scale>this.prevScale?this.dollyIn(this.getZoomScale()):i.scale<this.prevScale&&this.dollyOut(this.getZoomScale()),this.prevScale=i.scale,this.update(),this.object.wasMovedByUser=!0}else this.dispatchEvent(pd)},this.onContextMenu=i=>{i.preventDefault()},this.onTouchEnd=i=>{i.preventDefault()},this.onKeyDown=i=>{this.enabled!==!1&&(this.key=i.key,i.key===" "&&this.dispatchEvent(fd))},this.onKeyUp=i=>{this.enabled!==!1&&(this.key=void 0,this.state!==-1&&i.key==="Alt"&&this.onPointerUp(Wt[0]),i.key===" "&&this.dispatchEvent(pd))},this.onPointerHover=i=>{i.pointerType!=="mouse"||this.enabled===!1||this.state!==-1||this.hoverRotatePanMode===2&&this.isPanOverShoot||this.hoverRotatePanMode===1&&this.isRotateOverShoot||(this.isPointerDown=!0,this.hoverRotatePanMode===2?this.handleMouseMovePan(i,this.hoverRotatePanStrength):this.hoverRotatePanMode===1&&this.handleMouseMoveRotate(i,this.hoverRotatePanStrength))},this.onBeginState=()=>{this.enabled=!1,this.needsUpdate=!1},this.onCompleteState=i=>{i.isfromEntity&&this.options.isPlayMode||(this.enabled=!0,this.needsUpdate=!0,this.object.updateUp(),this.object.getTarget(this.target))},this.target=this.object.getTarget(),this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.quat0=this.object.quaternion.clone(),this.isUpVectorFlipped0=this.object.isUpVectorFlipped,this.offset.copy(this.object.position).sub(this.target),this.spherical.setFromVector3(this.offset),this.object.isUpVectorFlipped&&(this.spherical.phi*=-1,this.spherical.theta-=Math.PI),this.initialSphericalRadius=this.spherical.radius,this.addEventListenersToCamera()}dispatchEvent(e){e.type==="start"?this.hasChange=!1:this.hasChange=!0,super.dispatchEvent(e)}addEventListenersToCamera(){this.object.addEventListener("beginState",this.onBeginState),this.object.addEventListener("completeState",this.onCompleteState),this.object.addEventListener("cameraChange",this.onCameraChange)}removeEventListenersFromCamera(){this.object.removeEventListener("beginState",this.onBeginState),this.object.removeEventListener("completeState",this.onCompleteState),this.object.removeEventListener("cameraChange",this.onCameraChange)}updateUseWindowEvents(e){if(window.removeEventListener("pointermove",this.onPointerHover),this.domElement.removeEventListener("pointermove",this.onPointerHover),this.useWindowEvents=e,this.hoverRotatePanMode!==0&&(this.useWindowEvents?window.addEventListener("pointermove",this.onPointerHover):this.domElement.addEventListener("pointermove",this.onPointerHover)),this.domElement.removeEventListener("pointerleave",this.onPointerLeave),this.domElement.removeEventListener("pointerenter",this.onPointerEnter),window.removeEventListener("pointerleave",this.onPointerLeave),window.removeEventListener("pointerenter",this.onPointerEnter),this.hoverRotatePanMode!==0&&!this.useWindowEvents){let t=this.useWindowEvents?window:this.domElement;t.addEventListener("pointerleave",this.onPointerLeave),t.addEventListener("pointerenter",this.onPointerEnter)}}fromJSON(e,t){this.setEnableDampingSpeed(e.enableDamping),this.enablePan=e.enablePan,this.enableZoom=e.enableZoom,this.enableRotate=e.enableRotate,this.rotationLimitsMode=e.rotationLimitsMode,this.thetaIsFree=e.rotationHorizontalOffset.min===e.rotationHorizontalOffset.max&&e.rotationHorizontalOffset.min===Math.PI,this.phiIsFree=e.rotationVerticalOffset.min===e.rotationVerticalOffset.max&&e.rotationVerticalOffset.min===Math.PI,this.panLimitsMode=e.panLimitsMode,this.panSoftLimit=e.panSoftLimit,this.rotationSoftLimit=e.rotationSoftLimit,this.hoverRotatePanMode=e.hoverRotatePanMode,this.hoverRotateDamping=e.hoverRotateDamping??this.dampingFactor,this.useWindowEvents=t==="window",this.hoverRotatePanMode!==0&&(this.useWindowEvents?window.addEventListener("pointermove",this.onPointerHover):this.domElement.addEventListener("pointermove",this.onPointerHover));let r=e.hoverRotatePanStrength/100;this.hoverRotatePanStrength=r**2,this.zoomLimitsEnabled=e.zoomLimitsEnabled,this.minZoom=e.zoomLimits.min,this.maxZoom=Math.max(e.zoomLimits.min,e.zoomLimits.max),this.minDistance=1e3/e.zoomLimits.max,this.maxDistance=Math.max(this.minDistance,1e3/e.zoomLimits.min),this.autoRotate=e.autoRotate,this.autoRotateSpeed=e.autoRotateSpeed,this.autoRotateClockwise=e.autoRotateClockwise;let i=this.object.getTarget().applyQuaternion(n2.copy(this.object.quaternion).invert());this.minV=-e.panVerticalOffset.min+i.y,this.maxV=e.panVerticalOffset.max+i.y,this.minH=-e.panHorizontalOffset.min+i.x,this.maxH=e.panHorizontalOffset.max+i.x,this.panRangeFactor.set(this.maxH-this.minH,this.maxV-this.minV).divideScalar(2),this.rotationRangeFactor.setScalar(Math.PI).divideScalar(4),this.minPhi=js(this.spherical.phi-e.rotationVerticalOffset.min),this.maxPhi=js(this.spherical.phi+e.rotationVerticalOffset.max),this.minTheta=js(js(this.spherical.theta)-e.rotationHorizontalOffset.min),this.maxTheta=js(js(this.spherical.theta)+e.rotationHorizontalOffset.max),this.isThetaFlipped=this.minTheta>this.maxTheta,e.orbitTouches===1&&(this.touches[0]=wo.ROTATE),e.panTouches===1&&(this.touches[0]=wo.PAN),e.orbitTouches===2&&(this.touches[1]=wo.DOLLY_ROTATE),e.panTouches===2&&(this.touches[1]=wo.DOLLY_PAN),e.orbitTouches===3&&(this.touches[2]=wo.ROTATE),e.panTouches===3&&(this.touches[2]=wo.PAN),this.isTouchZoom=e.isTouchZoom,this.resetHoverEffectOnPointerLeave=e.resetHoverEffectOnPointerLeave??!1}connect(){if(this.domElement.addEventListener("contextmenu",this.onContextMenu),this.domElement.addEventListener("pointerdown",this.onPointerDown),this.domElement.addEventListener("wheel",this.onMouseWheel),window.addEventListener("keydown",this.onKeyDown,!1),window.addEventListener("keyup",this.onKeyUp,!1),this.domElement.addEventListener("gesturestart",this.onGesture),this.domElement.addEventListener("gesturechange",this.onGesture),this.domElement.addEventListener("gestureend",this.onGesture),this.domElement.addEventListener("touchend",this.onTouchEnd),this.hoverRotatePanMode!==0&&!this.useWindowEvents){let e=this.useWindowEvents?window:this.domElement;e.addEventListener("pointerleave",this.onPointerLeave),e.addEventListener("pointerenter",this.onPointerEnter)}this.pointerLeaveEvent=void 0}dispose(){this.removeEventListenersFromCamera(),this.domElement.removeEventListener("contextmenu",this.onContextMenu),this.domElement.removeEventListener("pointerdown",this.onPointerDown),this.domElement.removeEventListener("wheel",this.onMouseWheel),window.removeEventListener("keydown",this.onKeyDown,!1),window.removeEventListener("keyup",this.onKeyUp,!1),this.domElement.removeEventListener("pointermove",this.onPointerHover),window.removeEventListener("pointermove",this.onPointerHover),this.domElement.removeEventListener("gesturestart",this.onGesture),this.domElement.removeEventListener("gesturechange",this.onGesture),this.domElement.removeEventListener("gestureend",this.onGesture),this.domElement.removeEventListener("touchend",this.onTouchEnd),this.domElement.removeEventListener("pointerleave",this.onPointerLeave),this.domElement.removeEventListener("pointerenter",this.onPointerEnter),window.removeEventListener("pointerleave",this.onPointerLeave),window.removeEventListener("pointerenter",this.onPointerEnter),this.domElement.removeEventListener("pointermove",this.onPointerMove),this.domElement.removeEventListener("pointerup",this.onPointerUp)}applyLimits(e,t,r,i,n,a,o,s){this.overShoot.set(0,0);let l,c,u;e instanceof k?(l=e.x,c=e.y,this.current.set(this.target.x,this.target.y),u=!0):(l=e.theta,c=e.phi,this.current.set(js(this.spherical.theta),js(this.spherical.phi)),u=!1),r===0&&(this.current.x+=l,this.current.y+=c),(t===3||t===2)&&(!u&&this.isThetaFlipped?this.current.x>i&&this.current.x<0?this.overShoot.x=i-this.current.x:this.current.x<n&&this.current.x>0&&(this.overShoot.x=n-this.current.x):this.current.x>i?this.overShoot.x=i-this.current.x:this.current.x<n&&(this.overShoot.x=n-this.current.x)),(t===3||t===1)&&(this.current.y>a?this.overShoot.y=a-this.current.y:this.current.y<o&&(this.overShoot.y=o-this.current.y)),u||(this.overShoot.x=js(this.overShoot.x),this.overShoot.y=js(this.overShoot.y)),r!==0?(this.overRatio.copy(this.overShoot).divide(s),this.overRatio.x=Math.min(Math.abs(this.overRatio.x),1),this.overRatio.y=Math.min(Math.abs(this.overRatio.y),1),r===1&&(this.overRatio.x=KF(Math.abs(this.overRatio.x)),this.overRatio.y=KF(Math.abs(this.overRatio.y))),this.isPointerDown||r===1?r===2&&(this.overRatio.x>.9&&!this.thetaIsFree||this.overRatio.y>.9&&!this.phiIsFree)?this.isPointerDown=!1:(l*this.overShoot.x<0&&!this.thetaIsFree&&(l*=1-this.overRatio.x),c*this.overShoot.y<0&&!this.phiIsFree&&(c*=1-this.overRatio.y)):r===2&&(!u&&(this.overRatio.x>.002&&!this.thetaIsFree||this.overRatio.y>.002&&!this.phiIsFree)||u&&(Math.abs(this.overShoot.x)>2||Math.abs(this.overShoot.y)>2)?(this.thetaIsFree||(l=this.overShoot.x*.05),this.phiIsFree||(c=this.overShoot.y*.05),u?this.isPanOverShoot=!0:this.isRotateOverShoot=!0):u?this.isPanOverShoot=!1:this.isRotateOverShoot=!1)):(l+=this.overShoot.x,c+=this.overShoot.y),e instanceof k?(e.x=l,e.y=c):(this.thetaIsFree||(e.theta=l),this.phiIsFree||(e.phi=c))}setEnableDampingSpeed(e){this.enableDamping=e,this.rotateSpeed=e===!0?.2:1}stopDamping(){this.sphericalDelta.theta=0,this.sphericalDelta.phi=0}getAutoRotationAngle(){return 2*Math.PI/60/60*this.autoRotateSpeed}getZoomScale(){return Math.pow(.95,this.zoomSpeed)}rotateLeft(e){this.sphericalDelta.theta-=e}rotateUp(e){this.sphericalDelta.phi-=e}panLeft(e,t){this.panLeftV.setFromMatrixColumn(t,0),this.panLeftV.multiplyScalar(-e),this.panOffset.add(this.panLeftV)}panUp(e,t){this.panUpV.setFromMatrixColumn(t,1),this.panUpV.multiplyScalar(e),this.panOffset.add(this.panUpV)}pan(e,t){let r=this.domElement;if(r&&this.object.isPerspectiveCamera){let i=this.object.position;this.panV.copy(i).sub(this.target);let n=this.panV.length();n*=Math.tan(this.object.fov/2*Math.PI/180),this.panLeft(2*e*n/r.clientHeight,this.object.matrixWorld),this.panUp(2*t*n/r.clientHeight,this.object.matrixWorld)}else r&&this.object.isOrthographicCamera&&(this.panLeft(e*(this.object.right-this.object.left)/this.object.zoom/r.clientWidth,this.object.matrixWorld),this.panUp(t*(this.object.top-this.object.bottom)/this.object.zoom/r.clientHeight,this.object.matrixWorld));this.dispatchEvent(zje)}dollyOut(e){this.object.isPerspectiveCamera?this.scale/=e:this.object.isOrthographicCamera&&(this.object.zoom*=e,this.zoomLimitsEnabled&&(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom))),this.object.updateProjectionMatrix(),this.zoomChanged=!0),this.dispatchEvent(qF)}dollyIn(e){this.object.isPerspectiveCamera?this.scale*=e:this.object.isOrthographicCamera&&(this.object.zoom/=e,this.zoomLimitsEnabled&&(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom))),this.object.updateProjectionMatrix(),this.zoomChanged=!0),this.dispatchEvent(qF)}zoomOut(e=this.getZoomScale()){this.dispatchEvent(fd),this.dollyOut(e),this.dispatchEvent(pd)}zoomIn(e=this.getZoomScale()){this.dispatchEvent(fd),this.dollyIn(e),this.dispatchEvent(pd)}setZoom(e){if(this.dispatchEvent(fd),this.object.isPerspectiveCamera){let t=this.initialSphericalRadius/e/this.spherical.radius;this.scale=t}else this.object.isOrthographicCamera&&(this.object.zoom=e,this.zoomLimitsEnabled&&(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom))),this.object.updateProjectionMatrix(),this.zoomChanged=!0);this.dispatchEvent(pd)}handleMouseDownRotate(e){this.rotateStart.set(e.clientX,e.clientY)}handleMouseDownDolly(e){this.dollyStart.set(e.clientX,e.clientY)}handleMouseDownPan(e){this.panStart.set(e.clientX,e.clientY)}handleMouseMoveRotate(e,t=1){e.movementX!==void 0?this.rotateDelta.set(e.movementX,e.movementY):(this.rotateEnd.set(e.clientX,e.clientY),this.rotateDelta.subVectors(this.rotateEnd,this.rotateStart),this.rotateStart.copy(this.rotateEnd)),this.rotateDelta.multiplyScalar(this.rotateSpeed*t).rotateAround(YF,-this.object.angleOffsetFromUp);let r=this.domElement,i=this.useWindowEvents?window.innerHeight:r.clientHeight,n=2*Math.PI*this.rotateDelta.x/i,a=2*Math.PI*this.rotateDelta.y/i;this.rotateLeft(n),this.rotateUp(a),this.update()}handleMouseMoveDolly(e){this.dollyEnd.set(e.clientX,e.clientY),this.dollyDelta.subVectors(this.dollyEnd,this.dollyStart),this.dollyDelta.y>0?this.dollyOut(this.getZoomScale()):this.dollyDelta.y<0&&this.dollyIn(this.getZoomScale()),this.dollyStart.copy(this.dollyEnd),this.update()}handleMouseMovePan(e,t=1){e.movementX!==void 0?this.panDelta.set(e.movementX,e.movementY):(this.panEnd.set(e.clientX,e.clientY),this.panDelta.subVectors(this.panEnd,this.panStart),this.panStart.copy(this.panEnd)),this.panDelta.multiplyScalar(this.panSpeed*t),this.pan(this.panDelta.x,this.panDelta.y),this.update()}handleMouseWheel(e){if(GOe===!1&&By(e)===!1&&qOe(e)===!0){if(this.enablePan===!1)return;this.gesture?(this.panDelta.set(-e.deltaX,-e.deltaY).multiplyScalar(this.panSpeed),this.panDelta.x=Math.min(Math.abs(this.panDelta.x),100)*(this.panDelta.x<0?-1:1),this.panDelta.y=Math.min(Math.abs(this.panDelta.y),100)*(this.panDelta.y<0?-1:1),e.altKey?this.pan(0,this.panDelta.y):e.shiftKey?this.pan(this.panDelta.x,0):this.pan(this.panDelta.x,this.panDelta.y),this.update()):(this.gesture=!0,this.isPointerDown=!0),window.clearTimeout(this.timer),this.timer=window.setTimeout(()=>{this.gesture=!1,this.isPointerDown=!1},30)}else{if(this.enableZoom===!1||this.gesture)return;e.deltaY===0?e.deltaX<0?this.dollyIn(this.getZoomScale()):e.deltaX>0&&this.dollyOut(this.getZoomScale()):e.deltaY<0?this.dollyIn(this.getZoomScale()):e.deltaY>0&&this.dollyOut(this.getZoomScale()),this.update(),this.gesture=!1,this.isPointerDown=!1}}handleTouchStartRotate(){if(Wt.length===2){let e=.5*(Wt[0].pageX+Wt[1].pageX),t=.5*(Wt[0].pageY+Wt[1].pageY);this.rotateStart.set(e,t)}else this.rotateStart.set(Wt[0].pageX,Wt[0].pageY)}handleTouchStartPan(){if(Wt.length===2){let e=.5*(Wt[0].pageX+Wt[1].pageX),t=.5*(Wt[0].pageY+Wt[1].pageY);this.panStart.set(e,t)}else this.panStart.set(Wt[0].pageX,Wt[0].pageY)}handleTouchStartDolly(){let e=Wt[0].pageX-Wt[1].pageX,t=Wt[0].pageY-Wt[1].pageY,r=Math.sqrt(e*e+t*t);this.dollyStart.set(0,r)}handleTouchStartDollyPan(){this.enableZoom&&this.isTouchZoom===!0&&this.handleTouchStartDolly(),this.enablePan&&this.handleTouchStartPan()}handleTouchStartDollyRotate(){this.enableZoom&&this.isTouchZoom===!0&&this.handleTouchStartDolly(),this.enableRotate&&this.handleTouchStartRotate()}handleTouchMoveRotate(e){if(Wt.length===2){let r=XC(e),i=.5*(e.pageX+r.x),n=.5*(e.pageY+r.y);this.rotateEnd.set(i,n)}else{if(e.pointerId!==Wt[0].pointerId)return;this.rotateEnd.set(e.pageX,e.pageY)}this.rotateDelta.subVectors(this.rotateEnd,this.rotateStart).multiplyScalar(this.rotateSpeed);let t=this.domElement;t&&(this.rotateLeft(2*Math.PI*this.rotateDelta.x/t.clientHeight),this.rotateUp(2*Math.PI*this.rotateDelta.y/t.clientHeight)),this.rotateStart.copy(this.rotateEnd)}handleTouchMovePan(e){if(Wt.length===2){let t=XC(e),r=.5*(e.pageX+t.x),i=.5*(e.pageY+t.y);this.panEnd.set(r,i)}else{if(e.pointerId!==Wt[0].pointerId)return;this.panEnd.set(e.pageX,e.pageY)}this.panDelta.subVectors(this.panEnd,this.panStart).multiplyScalar(this.panSpeed),this.pan(this.panDelta.x,this.panDelta.y),this.panStart.copy(this.panEnd)}handleTouchMoveDolly(e){let t=XC(e),r=e.pageX-t.x,i=e.pageY-t.y,n=Math.sqrt(r*r+i*i);this.dollyEnd.set(0,n),this.dollyDelta.set(0,Math.pow(this.dollyEnd.y/this.dollyStart.y,this.zoomSpeed)),this.dollyOut(this.dollyDelta.y),this.dollyStart.copy(this.dollyEnd)}handleTouchMoveDollyPan(e){this.enableZoom&&this.isTouchZoom===!0&&this.handleTouchMoveDolly(e),this.enablePan&&this.handleTouchMovePan(e)}handleTouchMoveDollyRotate(e){this.enableZoom&&this.isTouchZoom===!0&&this.handleTouchMoveDolly(e),this.enableRotate&&this.handleTouchMoveRotate(e)}checkRaycastLock(){var e;if(this.object.data.raycastLock){if(this.options.isPlayMode)return!1;{let t=(e=this.options)==null?void 0:e.showCameraLock;return t&&t(),!0}}else return!1}};function js(e){let t=Math.PI*2;for(;e<=-Math.PI;)e+=t;for(;e>Math.PI;)e-=t;return e}function KF(e){return 1-Math.pow(1-e,4)}var QF=class{constructor(e,t,r,i,n,a){this.id=e,this.data=t,this.object=r,this.page=i,this.currentIntersectedObjects=[],this.actions=$n(t,t.actions,i,n,a,r),this.target=t.target,this.triggeringObjects=[];for(let o of t.triggeringObjects){let s=i.scene.find(o);s&&this.triggeringObjects.push(s)}}isValidTriggeringObject(e){return this.target==="all"?!0:this.triggeringObjects.some(t=>t===e||t.isAncestorOf(e.uuid)||e.isAncestorOf(t.uuid))}disconnect(){jn(this.actions)}dispatch(){this.object.destroyedInAction||(this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),this.object.dispatchEvent({type:"beginEvent",eventName:"Trigger"}),this.actions.Transition.forEach(e=>{e.data.runMode==="Toggle"?e.toggle():e.play()}),this.actions.SwitchCamera.forEach(e=>{e.data.runMode==="Toggle"?e.toggle():e.play()}),this.actions.Link.forEach(e=>{e.dispatch()}),this.actions.Reset.forEach(e=>{e.dispatch()}),this.actions.Create.forEach(e=>{e.dispatch()}),this.actions.Destroy.forEach(e=>{e.dispatch(!1)}),this.actions.Audio.forEach(e=>{e.dispatchBasic()}),this.actions.Particles.forEach(e=>{e.dispatchBasic()}),this.actions.Video.forEach(e=>{e.dispatchBasic()}),this.actions.SceneTransition.forEach(e=>{e.dispatch()}),this.actions.SetVariable.forEach(e=>e.checkConditions()),this.actions.SetVariable.forEach(e=>e.dispatch()),this.actions.DynamicVariablePlay.forEach(e=>e.dispatch()),this.actions.ClearLocalStorage.forEach(e=>e.dispatch()),this.actions.UserAPI.forEach(e=>e.dispatch()))}},Tr;JOe.then(e=>Tr=e);var rn=new k,is=new Kt,Xc=new k,s2=new bn(0,0,0,"YXZ"),ZF=new bn(0,0,0,"XYZ"),ns=new k,l2=new k,c2=new k(1,1,1),Tf=new Kt,Eb=new it,JF=new it,Uje={type:"updateMatrix"},e5=new Kt,u2=new ao,cT={type:"beginEvent",eventName:"Collision"},jje={type:"beginEvent",eventName:"Trigger"};function Vje(e){if(Ug.physicsEnabled(e.scene.objects))return!0;let t=!1;return e.scene.objects.traverse((r,i)=>{if(i.events){if(Array.isArray(i.events)){for(let n of i.events)if(n.data.disabled!==!0&&n.data.type==="GameControl"&&n.data.collisionEnabled){t=!0;break}}else for(let n of Object.values(i.events))if(n.disabled!==!0&&n.type==="GameControl"&&n.collisionEnabled){t=!0;break}}}),t}var N1=e=>e.states.some(t=>t.data.position!==void 0||t.data.rotation!==void 0||t.data.hiddenMatrix!==void 0||t.data.cloner!==void 0||t.data.pathSnapping!==void 0),Hje=class{constructor(e){this.eventContext=e,this.isEnabled=!1,this.gameControl=null,this.joysticks=[],this.joystickToGameControls=[],this.sharedGameControlGlobals={entitiesWithTransformAnim:[],entityToCollisionEvents:{},colliderToEntity:new Map,triggers:[],gamePads:[],createdObjects:[],nCreatedPerAction:{}},this.sensorToTriggerEvent={},this.eventManager=void 0,this.needsCollisionDetection=!1,this.initializationCounter=-1,this.rigidBodyToMesh=new Map,this.nActiveRigidBodies=0,this.collisionEvents=[],this.isExport=!1,this.processRigidBody=t=>{if(t.bodyType()!==Tr.RigidBodyType.Dynamic)return;t.isSleeping()||this.nActiveRigidBodies++;let[r,i,n]=this.rigidBodyToMesh.get(t.handle);if(rn.copy(t.translation()).multiplyScalar(this.pixelsPerMeter),is.copy(t.rotation()),r.matrixWorld.compose(rn,is,i),r.hasNonUniformScale&&r.matrixWorld.multiply(r.shearScale),r.dispatchEvent(Uje),n){let a=r.cloner;if(a&&a.objectForSample===void 0){a.matrixWorld.copy(r.matrixWorld);for(let o of a.children)o.updateMatrixWorld(!0)}for(let o of r.children)o.updateMatrixWorld(!0)}},this.accumulator=0,this.handleCollisionEvents=(t,r,i)=>{var o,s,l,c;if(i===!1)return;let n,a;if(this.sensorToTriggerEvent[t]?(n=this.sensorToTriggerEvent[t],a=this.sharedGameControlGlobals.colliderToEntity.get(r)):this.sensorToTriggerEvent[r]&&(n=this.sensorToTriggerEvent[r],a=this.sharedGameControlGlobals.colliderToEntity.get(t)),n&&a&&n.isValidTriggeringObject(a)){n.dispatch();return}for(let u=this.sharedGameControlGlobals.createdObjects.length-1;u>=0;u--){let d=this.sharedGameControlGlobals.createdObjects[u];if(d.userData.hasCollisionDestroy&&(((o=d.rigidBody)==null?void 0:o.collider(0).handle)===t||((s=d.rigidBody)==null?void 0:s.collider(0).handle)===r)){this.sharedGameControlGlobals.createdObjects.splice(u,1),d.removeFromParent(),requestAnimationFrame(()=>{var h;return(h=this.sharedGameControlGlobals.rapierWorld)==null?void 0:h.removeRigidBody(d.rigidBody)});break}}if(((l=this.gameControl)==null?void 0:l.object)!==void 0&&this.gameControl.object===this.sharedGameControlGlobals.colliderToEntity.get(t)){let u=this.sharedGameControlGlobals.colliderToEntity.get(r),d=this.sharedGameControlGlobals.entityToCollisionEvents[u.uuid];if(d===void 0)return;for(let h of d)h.data.target==="character"&&this.dispatchCollisionEvent(h,u,r)}else if(((c=this.gameControl)==null?void 0:c.object)!==void 0&&this.gameControl.object===this.sharedGameControlGlobals.colliderToEntity.get(r)){let u=this.sharedGameControlGlobals.colliderToEntity.get(t),d=this.sharedGameControlGlobals.entityToCollisionEvents[u.uuid];if(d===void 0)return;for(let h of d)h.data.target==="character"&&this.dispatchCollisionEvent(h,u,t)}else{let u=this.sharedGameControlGlobals.colliderToEntity.get(t),d=this.sharedGameControlGlobals.entityToCollisionEvents[u.uuid];if(d!==void 0)for(let p of d)p.data.target==="scene"&&this.dispatchCollisionEvent(p,u,t);let h=this.sharedGameControlGlobals.colliderToEntity.get(r),f=this.sharedGameControlGlobals.entityToCollisionEvents[h==null?void 0:h.uuid];if(f!==void 0)for(let p of f)p.data.target==="scene"&&this.dispatchCollisionEvent(p,h,r)}},this.isExport=e.isExport,this.sharedAssets=e.sharedAssets,this.renderer=e.renderer,this.requestRender=e.requestRender,this.domElement=this.renderer.domElement,this.pixelsPerMeter=z7,this.gravity=this.page.data.globalPhysics.gravity}get page(){return this.eventContext.page}attachVRControllers(e){e.forEach(t=>{t.addEventListener("connected",r=>{"gamepad"in r.data&&"axes"in r.data.gamepad&&this.sharedGameControlGlobals.gamePads.push(r.data.gamepad)})})}markIsDestroyTarget(){this.page.traverseVisibleEntity(e=>{var r,i;let t=e.dataPatched;for(let n of t.events){if(n.data.disabled===!0)continue;let a=(i=(r=n.data.actions)==null?void 0:r.find(o=>o.data.type==="Destroy"))==null?void 0:i.data;if(a)for(let o of a.objects){let s=this.page.scene.find(o);s&&(s.userData.hasDestroy=!0)}}})}markIsDragObject(){this.page.traverseVisibleEntity(e=>{let t=e.dataPatched;for(let r of t.events)if(!(r.data.disabled===!0||r.data.type!=="DragDrop"))for(let i of r.data.objects){let n=this.page.scene.find(i);n&&(n.userData.hasDrag=!0)}})}initBVH(){let e=[];if(this.page.traverseChildren(t=>{var c,u;let r,i=t instanceof Yb,n=t instanceof Kb;if(t instanceof ds||i||n)return;t instanceof ya?r=t.object:r=t;let a=r.dataPatched;if(((c=a.physics)==null?void 0:c.enabled)==="visibility"?!a.visible:!((u=a.physics)!=null&&u.enabled))return!0;let o=t.geometry,s=r.userData.hasDestroy===!0,l=r.userData.hasDrag===!0;if(N1(a)||s||l||r.dataPatched.events.some(d=>d.data.disabled!==!0&&d.data.type==="GameControl"))return t.updateMatrixWorldSVD(),this.addBoundsTree(t),!0;o&&e.push(Yl(o,t.matrixWorld))}),e.length>0){let t=jd(e,!1);this.sharedGameControlGlobals.staticMeshBVH=new Kv(t)}}addRigidBody(e,t,r){let i=[],n="geometry"in e?e.geometry:void 0,a=t.dataPatched;if((n==null?void 0:n.getAttribute("position"))!==void 0&&i.push(Yl(n,e.shearScale)),a.physics.fusedBody){let o=this.gatherChildrenGeom(e,i);e.traverseObject(o),e.children.forEach(l=>l.updateMatrixWorld(!0));let s=e.cloner;s&&s.objectForSample===void 0&&a.physics.rigidBody==="dynamic"&&(s.traverseObject(o),s.children.forEach(l=>l.updateMatrixWorld(!0)))}if(i.length>0){let o,s=!r.fromCreate&&a.physics.rigidBody==="dynamic"||r.fromCreate&&r.dynamic;s?(o=Tr.RigidBodyDesc.dynamic(),o.setLinearDamping(a.physics.damping).setAngularDamping(a.physics.damping).setAdditionalMass(1e-9).setGravityScale(a.physics.gravityScale).enabledRotations(...a.physics.enabledRotation).enabledTranslations(...a.physics.enabledTranslation)):(r.hasTransformAnim||r.hasFollow||r.hasDrag)&&!r.fromCreate?(o=Tr.RigidBodyDesc.kinematicPositionBased(),this.sharedGameControlGlobals.entitiesWithTransformAnim.push(e)):o=Tr.RigidBodyDesc.fixed();let l=jd(i);(e.hasNonUniformScale?e.matrixWorldRigid:e.matrixWorld).decompose(rn,is,Xc),e.position0=rn.clone().divideScalar(this.pixelsPerMeter),e.rotation0=is.clone(),rn.divideScalar(this.pixelsPerMeter),o.setTranslation(rn.x,rn.y,rn.z).setRotation(is),n?l==null||l.scale(1/this.pixelsPerMeter,1/this.pixelsPerMeter,1/this.pixelsPerMeter):l==null||l.scale(Xc.x/this.pixelsPerMeter,Xc.y/this.pixelsPerMeter,Xc.z/this.pixelsPerMeter);let c=this.sharedGameControlGlobals.rapierWorld.createRigidBody(o);s&&this.rigidBodyToMesh.set(c.handle,[e,Xc.clone(),a.physics.fusedBody]);let u=!(a.geometry===void 0||a.geometry.type==="SubdivGeometry"||a.geometry.type==="NonParametricGeometry"||a.geometry.type==="BooleanGeometry"||a.geometry.type==="VectorGeometry"||a.geometry.type==="StarGeometry"||a.geometry.type==="RectangleGeometry"||a.geometry.type==="EllipseGeometry"||a.geometry.type==="TriangleGeometry"||a.geometry.type==="TorusGeometry"||a.geometry.type==="HelixGeometry");try{this.addCollider(c,a.physics,l,t,u)}catch{try{this.addCollider(c,a.physics,l,t,!1)}catch(d){console.error(d)}}e.rigidBody=c}}addBoundsTree(e){var r,i;let t=[];if(((r=e.geometry)==null?void 0:r.getAttribute("position"))!==void 0&&((i=e.geometry)==null?void 0:i.getAttribute("position").count)>0&&t.push(Yl(e.geometry,e.shearScale)),e.traverseObject(this.gatherChildrenGeom(e,t)),e.children.forEach(n=>n.updateMatrixWorld(!0)),t.length>0){let n=jd(t,!1);e.bvhGeometry=n,n.getAttribute("position").count>0&&(e.bvhGeometry.boundsTree=new Kv(n),this.sharedGameControlGlobals.entitiesWithTransformAnim.push(e))}}addCollider(e,t,r,i,n=!0){var s,l;if((r==null?void 0:r.getAttribute("position").count)===0||((s=r==null?void 0:r.getIndex())==null?void 0:s.count)===0)return;let a;r&&(t.colliderType==="trimesh"?a=Tr.ColliderDesc.trimesh(r.getAttribute("position").array,r.getIndex().array):a=Tr.ColliderDesc.convexMesh(r.getAttribute("position").array,n?r.getIndex().array:void 0)),a.setFrictionCombineRule(Tr.CoefficientCombineRule.Average).setRestitutionCombineRule(Tr.CoefficientCombineRule.Average).setDensity(t.density).setFriction(t.friction).setRestitution(t.restitution);let o=this.sharedGameControlGlobals.rapierWorld.createCollider(a,e);this.sharedGameControlGlobals.colliderToEntity.set(o.handle,i),(l=this.sharedGameControlGlobals.entityToCollisionEvents[i.uuid])!=null&&l.some(c=>c.target==="scene")&&o.setActiveEvents(Tr.ActiveEvents.COLLISION_EVENTS)}gatherChildrenGeom(e,t){return(r,i)=>{var s;if(i===0)return;let n;if(r instanceof ds)if(r.objectForSample){if(r.objectForSample.dataPatched.physics.fusedBody)return;n=r.object}else return r.object.dataPatched.physics.fusedBody===!0&&r.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(r instanceof ya)n=r.object;else if(n=r,(s=n.dataPatched.cloner)==null?void 0:s.hideBase)return!0;let a=n.dataPatched;if(a.physics.enabled==="visibility"?!a.visible:!a.physics.enabled)return!0;i===1?e.hasNonUniformScale?r.matrixWorld.multiplyMatrices(e.shearScale,r.hiddenMatrix):r.matrixWorld.copy(r.hiddenMatrix):r.matrixWorld.multiplyMatrices(r.parent.matrixWorld,r.hiddenMatrix),r.matrixWorld.multiply(r.matrix);let o=r.geometry;(o==null?void 0:o.getAttribute("position"))!==void 0&&t.push(Yl(o,r.matrixWorld))}}activate(e){var h,f;if(this.isEnabled)return;this.isEnabled=!0,this.eventManager=e,this.usePhysics=this.page.data.globalPhysics.usePhysics;let t=this.page.playCamera,r=!1,i=5,n=8,a=9,o="drag",s=this.page.data.publish.gameControlObject,l=s!==null?this.page.find(s):null,c=null;if(l)for(let p of l.data.events){if(p.data.disabled||p.data.type!=="GameControl")continue;let v=l;for(;this.usePhysics&&((h=v=v.parent)==null?void 0:h.parent)!==null;)(f=v.data.physics)==null||f.fusedBody;p.data.collisionEnabled&&(this.needsCollisionDetection=!0),c===null&&(c=p.data)}if(this.page.traverseEntity(p=>{for(let v of p.dataPatched.events)if(v.data.disabled===!1&&v.data.type==="Trigger")return this.needsCollisionDetection=!0,!0}),l&&c&&(l.data.visible===!0||l.data.physics.enabled===!0)){r=r||c.camera===t.uuid||l.uuid===t.uuid;let p=new k7(l,this.renderer.domElement,c,this.eventContext.page.data.globalPhysics,this,l.uuid!==t.uuid&&c.camera===t.uuid,t,this.page,this.sharedAssets);this.gameControl=p,i=c.joystickPosLoc,n=c.joystickRotLoc,a=c.jumpTouchButtonLoc,o=c.rotByTouch,vo&&c.touchControl&&(this.joystickToGameControls[i]="pos",c.moveMode==="walk"&&(this.joystickToGameControls[a]="jmp"),o==="joystick"&&(this.joystickToGameControls[n]="rot"))}if(this.gameControl&&this.gameControl.data.navmesh.enabled){let p=this.gameControl.data;if(!this.navigationMeshWrapper){this.navigationMeshWrapper=new Dje(this.usePhysics,this.isExport);let v;p.collider.type==="sphere"?v=p.collider.radius*2:v=p.collider.height,v=Math.floor(v/p.navmesh.ch-1),this.navigationMeshWrapper.init({...p.navmesh,walkableHeight:v},this.gameControl,this.eventContext)}}if(r===!1){let{enableRotate:p,enablePan:v,enableZoom:m,autoRotate:g,hoverRotatePanMode:y}=this.eventManager.publish.orbitControls;(p||v||m||g||y!==0)&&(this.orbitControls=new H7(t,this.renderer.domElement,{isExport:this.isExport,isPlayMode:!0}),this.orbitControls.addEventListener("change",this.requestRender),this.orbitControls.addEventListener("end",this.requestRender),this.orbitControls.addEventListener("start",this.requestRender),this.orbitControls.fromJSON(this.eventManager.publish.orbitControls,this.eventManager.publish.mouseEventTarget),this.orbitControls.useKeyEvents=!1,this.orbitControls.addEventListenersToCamera(),this.orbitControls.connect(),this.orbitControls.update())}let u=this.renderer.domElement.width/this.renderer.getPixelRatio(),d=this.renderer.domElement.height/this.renderer.getPixelRatio();this.joystickToGameControls.forEach((p,v)=>{let m=document.body.appendChild(document.createElement("div")),[g,y,b]=this.eventManager.eventContext.publish.joystickSizeAndXYOffset[v],x=(u-5*g)/4+g,S={},w=p==="jmp",_=w?0:g;v<10?(v<5?S.top=_/2:S.bottom=_/2,S.left=_/2+v%5*x):v===10?(S.left=_/2,S.top=d/2):(S.right=_/2,S.top=d/2),S.top?S.top-=y[1]:S.bottom+=y[1],S.left?S.left+=y[0]:S.right-=y[0];for(let M in S)S[M]+="px";if(w){let M=m.appendChild(document.createElement("div"));Object.assign(M.style,S,{position:"absolute",width:g+"px",height:g+"px",backgroundColor:`rgba(255,255,255,${b==="show"?.4:0})`,zIndex:"9999",borderRadius:g+"px",border:b==="show"?"solid 2px rgba(0, 0, 0, .1)":"none",display:"flex",alignItems:"center",justifyContent:"center",touchAction:"none"});let P=g/16*16*.4;b==="show"&&(M.innerHTML=`
						<svg width="${P}" height="${g*.4}" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
							<path d="M2 10L8 4L14 10" stroke="black" stroke-opacity="40%" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
						</svg>
					`),M.addEventListener("pointerdown",()=>{this.gameControl.movementState.jump=1,this.requestRender()}),M.addEventListener("touchend",T=>T.preventDefault()),this.joysticks[v]=[void 0,m];return}let C={zone:m,mode:"static",position:S,size:g};b==="hide"&&(C.restOpacity=0);let A=JNe.create(C);A.on("move",(M,P)=>{let T=this.gameControl;p==="pos"?P.force<.2?T.moveForce=0:(T.movementState.movePosZ=Math.sin(-P.angle.radian),T.movementState.movePosX=Math.cos(-P.angle.radian),P.force>1.2?T.movementState.run=1:T.movementState.run=0,P.force<.3?T.moveForce=(P.force-.2)/.1:T.moveForce=1):p==="rot"&&(P.force<.2?T.rotForce=0:(T.movementState.rotPosX=P.vector.y,T.movementState.rotPosY=-P.vector.x,P.force<.3?T.rotForce=(P.force-.2)/.1:T.rotForce=1)),this.requestRender()}),A.on("end",(M,P)=>{let T=this.gameControl;p==="pos"?(T.movementState.movePosZ=0,T.movementState.movePosX=0,T.moveForce=1):p==="rot"&&(T.movementState.rotPosX=0,T.movementState.rotPosY=0,T.rotForce=1)}),this.joysticks[v]=[A,m]}),this.markIsDestroyTarget(),this.markIsDragObject(),this.rebuildBVH(),this.initializationCounter++,window.setTimeout(()=>{this.collisionEvents.forEach(p=>p.initialDisabled=!1)},80)}initPhysics(){var o;(o=this.sharedGameControlGlobals.rapierWorld)==null||o.free(),this.sharedGameControlGlobals.rapierWorld=new Tr.World(new Tr.Vector3(0,this.gravity,0)),this.events=new Tr.EventQueue(!0);let e=[],t=[];if(this.page.traverseChildren(s=>{var g,y,b,x;let l;if(s instanceof ds)if(s.objectForSample){if(s.objectForSample.dataPatched.physics.fusedBody)return;l=s.object}else return s.object.dataPatched.physics.fusedBody===!0&&s.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(s instanceof ya)l=s.object;else{if(s instanceof Kb||s instanceof Yb)return;if(l=s,((g=l.dataPatched.cloner)==null?void 0:g.disabled)===!1&&((y=l.dataPatched.cloner)==null?void 0:y.hideBase)&&((b=l.dataPatched.physics)==null?void 0:b.fusedBody)!==!0)return!0}let c=l.dataPatched,u;for(let S of c.events)S.data.disabled!==!0&&S.data.type==="GameControl"&&(u=S.data);if(!c.physics||(c.physics.enabled==="visibility"?!c.visible:!c.physics.enabled))return!0;s.updateMatrixWorldSVD();let d=N1(c),h=!1,f=l.userData.hasDestroy,p=l.userData.hasDrag,v=!1;for(let S of c.events)if(S.data.disabled!==!0){if(S.data.type==="Collision"){h=!0;let w=new bje(S.id,S.data,l,this.page,this.sharedAssets,this.eventManager);w.initialDisabled=!0,this.collisionEvents.push(w),this.sharedGameControlGlobals.entityToCollisionEvents[l.uuid]&&this.sharedGameControlGlobals.entityToCollisionEvents[l.uuid].every(_=>_.id!==S.id)?this.sharedGameControlGlobals.entityToCollisionEvents[l.uuid].push(w):this.sharedGameControlGlobals.entityToCollisionEvents[l.uuid]=[w]}else if(S.data.type==="Follow"){v=!0;let w=S.data.target;s.traverseVisible(_=>{_.userData.isFollowingObj=w})}}c.physics.rigidBody==="dynamic"&&c.physics.fusedBody===!1&&(s.matrixWorldFusedFalse=s.matrixWorld.clone());let m=s.geometry;if(u!==void 0){let S=Tr.RigidBodyDesc.kinematicPositionBased();(s.hasNonUniformScale?s.matrixWorldRigid:s.matrixWorld).decompose(rn,is,Xc),s.position0=rn.clone().divideScalar(this.pixelsPerMeter),s.rotation0=is.clone(),rn.divideScalar(this.pixelsPerMeter),S.setTranslation(rn.x,rn.y,rn.z).setRotation(is);let w=this.sharedGameControlGlobals.rapierWorld.createRigidBody(S);s.rigidBody=w;let _;u.collider.type==="sphere"?_=Tr.ColliderDesc.ball(u.collider.radius/this.pixelsPerMeter):u.collider.type==="capsule"?_=Tr.ColliderDesc.capsule((u.collider.height/2-u.collider.radius)/this.pixelsPerMeter,u.collider.radius/this.pixelsPerMeter):_=Tr.ColliderDesc.cuboid(u.collider.width/this.pixelsPerMeter/2,u.collider.height/this.pixelsPerMeter/2,u.collider.depth/this.pixelsPerMeter/2),_.setFrictionCombineRule(Tr.CoefficientCombineRule.Average).setRestitutionCombineRule(Tr.CoefficientCombineRule.Average).setDensity(c.physics.density).setFriction(c.physics.friction).setRestitution(c.physics.restitution);let C=this.sharedGameControlGlobals.rapierWorld.createCollider(_,w);this.sharedGameControlGlobals.colliderToEntity.set(C.handle,l),rn.fromArray(u.collider.position).multiply(Xc.setFromMatrixScale(l.matrixWorld)).divideScalar(this.pixelsPerMeter),C.setTranslationWrtParent(rn);let A=new Kt().setFromEuler(new bn().setFromVector3(new k().fromArray(u.collider.rotation)));C.setRotationWrtParent(A),C.setActiveEvents(Tr.ActiveEvents.COLLISION_EVENTS),this.generateSensorColliderDescs(l,!0)}else c.physics.rigidBody==="dynamic"||d||v||f||p||h?(this.addRigidBody(s,l,{hasFollow:v,hasTransformAnim:d,hasDrag:p}),this.generateSensorColliderDescs(l,c.physics.fusedBody)):(m&&e.push(Yl(m,s.matrixWorld)),c.physics.fusedBody&&s.traverseObject((S,w)=>{var M;if(w===0)return;let _;if(S instanceof ds)if(S.objectForSample){if(S.objectForSample.dataPatched.physics.fusedBody)return;_=S.object}else return S.object.dataPatched.physics.fusedBody===!0&&S.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else{if(S instanceof Kb||S instanceof Yb)return;if(S instanceof ya)_=S.object;else if(_=S,(M=_.dataPatched.cloner)==null?void 0:M.hideBase)return!0}let C=_.dataPatched;if(C.physics.enabled==="visibility"?!C.visible:!C.physics.enabled)return!0;let A=S.geometry;(A==null?void 0:A.getAttribute("position"))!==void 0&&e.push(Yl(A,S.matrixWorld))}),this.generateSensorColliderDescs(l,c.physics.fusedBody,t));if(((x=c.physics)==null?void 0:x.fusedBody)===!0||u)return!0}),e.length===0)return;let r=jd(e);r.scale(1/this.pixelsPerMeter,1/this.pixelsPerMeter,1/this.pixelsPerMeter);let i=Tr.RigidBodyDesc.fixed(),n=this.sharedGameControlGlobals.rapierWorld.createRigidBody(i),a=Tr.ColliderDesc.trimesh(r.getAttribute("position").array,r.getIndex().array).setFrictionCombineRule(Tr.CoefficientCombineRule.Multiply).setRestitutionCombineRule(Tr.CoefficientCombineRule.Multiply).setFriction(1).setRestitution(1);this.sharedGameControlGlobals.rapierWorld.createCollider(a,n);for(let[s,l]of t){let c=this.sharedGameControlGlobals.rapierWorld.createCollider(s,n);this.sensorToTriggerEvent[c.handle]=l}}updatePositions(){return this.nActiveRigidBodies=0,this.sharedGameControlGlobals.rapierWorld.forEachRigidBody(this.processRigidBody),this.nActiveRigidBodies>0}rebuildBVH(){this.usePhysics?this.initPhysics():(this.page.traverseEntity(e=>{for(let t of e.dataPatched.events)if(t.data.type==="Trigger"&&t.data.disabled!==!0){let r=new QF(t.id,t.data,e,this.page,this.sharedAssets,this.eventManager),i=new it().compose(ns.fromArray(t.data.position),Tf.setFromEuler(ZF.fromArray(t.data.rotation)),c2);if(t.data.triggerZone==="box"){let n=new Ji;n.min.fromArray(t.data.size).multiplyScalar(-.5),n.max.fromArray(t.data.size).multiplyScalar(.5),this.sharedGameControlGlobals.triggers.push([n,i,e,r])}else this.sharedGameControlGlobals.triggers.push([t.data.radius,i,e,r])}}),this.needsCollisionDetection&&this.initBVH())}disconnectEvents(){this.collisionEvents.forEach(e=>e.disconnect()),this.sharedGameControlGlobals.triggers.forEach(e=>e[3].disconnect()),this.sharedGameControlGlobals.triggers.length=0}deactivate(){var e,t,r,i;if(this.isEnabled){this.isEnabled=!1,this.page.traverse(n=>{let a=n;a.matrixWorldFusedFalse&&(a.matrixWorldFusedFalse=void 0),a.rigidBody&&(a.rigidBody=void 0),a.position0&&(a.position0=void 0),a.rotation0&&(a.rotation0=void 0)}),(e=this.sharedGameControlGlobals.rapierWorld)==null||e.free(),this.sharedGameControlGlobals.rapierWorld=void 0,this.sharedGameControlGlobals.staticMeshBVH=void 0,this.accumulator=0,this.sharedGameControlGlobals.entitiesWithTransformAnim=[],this.disconnectEvents(),(t=this.gameControl)==null||t.reset(),(r=this.gameControl)==null||r.dispose(),this.gameControl=null,this.initializationCounter=-1,this.joysticks.forEach(([n,a])=>{n==null||n.destroy(),a.remove()}),this.joystickToGameControls=[],this.joysticks=[],this.orbitControls&&(this.orbitControls.dispose(),this.orbitControls=void 0),(i=this.navigationMeshWrapper)==null||i.dispose(),this.navigationMeshWrapper=void 0;for(let n of Object.values(this.sharedGameControlGlobals.entityToCollisionEvents))n.forEach(a=>a.disconnect());this.sharedGameControlGlobals.entityToCollisionEvents={},this.page.updateMatrixWorld(!0)}}update(e,t,r){if(!this.isEnabled)return!0;let i=!0;if(this.orbitControls!==void 0&&this.orbitControls.needsUpdate&&(i=!this.orbitControls.update()),this.initializationCounter>=0&&this.initializationCounter<2?(this.initializationCounter++,i=!1):this.initializationCounter===2&&this.gameControl&&(i=!this.gameControl.update(e,t,r)&&i),this.usePhysics===!1&&this.checkTrigger(),this.usePhysics){let n=.016666666666666666;if(e===0)i=this.stepPhysics()&&i;else{let a=e/1e3;a<n&&a>n*.55&&(a=n),this.accumulator+=a;let o=performance.now(),s=0,l=6;for(;this.accumulator>=n&&s<l&&(i=this.stepPhysics()&&i,this.accumulator-=n,s++,!(performance.now()-o>n*1e3)););this.accumulator=this.accumulator%n}}return i}stepPhysics(){var e;for(let t of this.sharedGameControlGlobals.entitiesWithTransformAnim){(t.hasNonUniformScale?t.matrixWorldRigid:t.matrixWorld).decompose(rn,is,Xc),s2.setFromQuaternion(is);let r=t;r.prevR===void 0?(r.prevR=s2.clone(),r.prevT=rn.clone()):(r.prevR.copy(s2),r.prevT.copy(rn)),t.rigidBody&&(t.rigidBody.setNextKinematicTranslation(rn.divideScalar(this.pixelsPerMeter)),t.rigidBody.setNextKinematicRotation(is))}return this.sharedGameControlGlobals.rapierWorld.step(this.events),(e=this.events)==null||e.drainCollisionEvents(this.handleCollisionEvents),!this.updatePositions()}dispatchCollisionEvent(e,t,r){var a;let i=((a=this.sharedGameControlGlobals.rapierWorld)==null?void 0:a.getCollider(r))._parent,n;if(t.cloner){for(let o of t.cloner.children)if(o.rigidBody===i){n=o;break}}e.dispatch(n),t.dispatchEvent(cT)}updateUseWindowEvents(e){var t;(t=this.orbitControls)==null||t.updateUseWindowEvents(e)}generateSensorColliderDescs(e,t,r){let i=JF.copy(e.matrixWorld).invert();e.traverseEntity((n,a)=>{if(t===!1&&a===1)return!0;for(let o of n.dataPatched.events)if(o.data.type==="Trigger"&&o.data.disabled!==!0){let s=new QF(o.id,o.data,n,this.page,this.sharedAssets,this.eventManager),l;if(o.data.triggerZone==="box"?l=Tr.ColliderDesc.cuboid(...o.data.size.map(c=>c/(2*this.pixelsPerMeter))):l=Tr.ColliderDesc.ball(o.data.radius/this.pixelsPerMeter),l.setDensity(0).setSensor(!0).setActiveEvents(Tr.ActiveEvents.COLLISION_EVENTS),ns.fromArray(o.data.position),Tf.setFromEuler(ZF.fromArray(o.data.rotation)),Eb.compose(ns,Tf,c2).premultiply(n.matrixWorld),r?(Eb.decompose(ns,Tf,l2),l.setActiveCollisionTypes(Tr.ActiveCollisionTypes.KINEMATIC_FIXED|Tr.ActiveCollisionTypes.DYNAMIC_FIXED)):(Eb.premultiply(i).decompose(ns,Tf,l2),e.rigidBody.bodyType()===Tr.RigidBodyType.Dynamic||(e.rigidBody.bodyType()===Tr.RigidBodyType.Fixed?l.setActiveCollisionTypes(Tr.ActiveCollisionTypes.KINEMATIC_FIXED|Tr.ActiveCollisionTypes.DYNAMIC_FIXED):l.setActiveCollisionTypes(Tr.ActiveCollisionTypes.KINEMATIC_KINEMATIC|Tr.ActiveCollisionTypes.DYNAMIC_KINEMATIC))),ns.divideScalar(this.pixelsPerMeter),l.setTranslation(ns.x,ns.y,ns.z),l.setRotation(Tf),r)r.push([l,s]);else{let c=this.sharedGameControlGlobals.rapierWorld.createCollider(l,e.rigidBody);this.sensorToTriggerEvent[c.handle]=s}}})}checkTrigger(){let e;for(let t=0;t<this.sharedGameControlGlobals.triggers.length;t++){let[r,i,n,a]=this.sharedGameControlGlobals.triggers[t];for(let o=0;o<this.sharedGameControlGlobals.entitiesWithTransformAnim.length;o++){let s=this.sharedGameControlGlobals.entitiesWithTransformAnim[o];if(n===s||a.isValidTriggeringObject(_r.is(s)?s:s.object)===!1)continue;let l=JF.copy(n.matrixWorld).decompose(ns,e5,l2).compose(ns,e5,c2).multiply(i),c=Eb.copy(s.matrixWorld).invert().multiply(l);r instanceof Ji?e=s.bvhGeometry.boundsTree.intersectsBox(r,c):(u2.radius=r,u2.center.setFromMatrixPosition(c),e=s.bvhGeometry.boundsTree.intersectsSphere(u2)),e?a.currentIntersectedObjects.indexOf(s)===-1&&(a.currentIntersectedObjects.push(s),a.dispatch(),n.dispatchEvent(jje)):a.currentIntersectedObjects=a.currentIntersectedObjects.filter(u=>u!==s)}}}};function Wje(e){let t=this._clip.duration,r=this._clip.start??0,i=this.loop,n=this.time+e,a=this._loopCount,o=i===NP;if(e===0)return a===-1?n:o&&(a&1)===1?t-(n-r):n;if(i===ZV){a===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(n>=t)n=t;else if(n<0)n=0;else{this.time=n;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=n,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(a===-1&&(e>=0?(a=0,this._setEndings(!0,this.repetitions===0,o)):this._setEndings(this.repetitions===0,!0,o)),n>=t||n<r){let s=Math.floor((n-r)/(t-r));n-=(t-r)*s,a+=Math.abs(s);let l=this.repetitions-a;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,o||(n=e>0?t:r,this.repetitions===1&&(n=t)),this.time=n,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(l===1){let c=e<0;this._setEndings(c,!c,o)}else this._setEndings(!1,!1,o);this._loopCount=a,this.time=n,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:s})}}else this.time=n;if(o&&(a&1)===1)return t-(n-r)}return n}var t5=!1,Gje=class{constructor(e,t,r,i){this.scene=e,this.requestRender=t,this.updateDisplayProgress=r,this.animationInspectorState=i,this.clipIdToAction={},this.activeClip=null,this.needsUpdate=!1,this.addClip=n=>{n.data.type==="Empty"&&n.data.animations&&n.data.animations.forEach((a,o)=>{let s=a[0]+"/";if(Array.isArray(n.identity)?s+=n.identity[0]:s+=n.uuid,this.clipIdToAction[s])return;let l=wM.parse(JSON.parse(a[2]));n.animations[o]=l;let c=this.mixer.clipAction(l,n);t5===!1&&(Object.getPrototypeOf(c)._updateTime=Wje,t5=!0),c.clampWhenFinished=!0,this.clipIdToAction[s]=c})},this.mixer=new u2e(e),this.scene.traverseEntity(this.addClip)}deleteClip(e,t){let r=this.scene.find(t);if(!r)return;let i=r.animations.find(a=>a.uuid===e);if(!i)return;let n=this.clipIdToAction[e];!n||(n.stop(),this.mixer.uncacheClip(i),delete this.clipIdToAction[e],r.animations=r.animations.filter(a=>a.uuid!==e))}get isPlaying(){return Object.values(this.clipIdToAction).some(e=>e.isRunning())}playFromInspector(e){this.mixer.stopAllAction();let t=this.clipIdToAction[e];!t||(t.play(),this.activeClip=t.getClip(),this.requestRender())}onExitPlayMode(){Object.values(this.clipIdToAction).forEach(e=>{e.repetitions=1/0,e.loop=JV}),this.mixer.stopAllAction(),this.requestRender()}play(e){let t=e.clipId+"/"+e.object,r=this.clipIdToAction[t];if(r)return e&&(e.repeat>=0&&(r.repetitions=e.repeat+1),e.direction==="pingpong"&&e.repeat!==0&&(r.loop=NP)),r.play(),r.paused=!1,this.requestRender(),r}resumeFromInspector(e){let t=this.clipIdToAction[e];!t||(t.play(),t.paused=!1,this.requestRender())}pauseFromInspector(e){let t=this.clipIdToAction[e];!t||(t.paused=!0)}stop(){this.mixer.stopAllAction(),this.requestRender()}update(e){var t;if(this.needsUpdate)this.needsUpdate=!1;else if(this.isPlaying===!1||(t=this.animationInspectorState)!=null&&t.isScrubbing)return;this.mixer.update(e/1e3),this.activeClip&&this.updateDisplayProgress(Math.round(this.mixer.time/this.activeClip.duration*(this.maxFrames-1)%(this.maxFrames-1))),this.requestRender()}get maxFrames(){return M7(this.activeClip??void 0)}setProgressFromInspector(e,t){if(!this.clipIdToAction[t])return;this.activeClip!==this.clipIdToAction[t].getClip()&&this.playFromInspector(t);let r=this.clipIdToAction[t].paused;this.clipIdToAction[t].paused=!1,this.mixer.setTime(Math.min(e/(this.maxFrames-1),.9999)*this.activeClip.duration),this.requestRender(),r&&(this.clipIdToAction[t].paused=!0)}},d2=new WeakMap,$je=class extends y0{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,r,i){let n=new SM(this.manager);n.setPath(this.path),n.setResponseType("arraybuffer"),n.setRequestHeader(this.requestHeader),n.setWithCredentials(this.withCredentials),n.load(e,a=>{this.decodeDracoFile(a,t).catch(i)},r,i)}decodeDracoFile(e,t,r,i){let n={attributeIDs:r||this.defaultAttributeIDs,attributeTypes:i||this.defaultAttributeTypes,useUniqueIDs:!!r};return this.decodeGeometry(e,n).then(t)}decodeGeometry(e,t){let r=JSON.stringify(t);if(d2.has(e)){let s=d2.get(e);if(s.key===r)return s.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let i,n=this.workerNextTaskID++,a=e.byteLength,o=this._getWorker(n,a).then(s=>(i=s,new Promise((l,c)=>{i._callbacks[n]={resolve:l,reject:c},i.postMessage({type:"decode",id:n,taskConfig:t,buffer:e},[e])}))).then(s=>this._createGeometry(s.geometry));return o.catch(()=>!0).then(()=>{i&&n&&this._releaseTask(i,n)}),d2.set(e,{key:r,promise:o}),o}_createGeometry(e){let t=new Ot;e.index&&t.setIndex(new qt(e.index.array,1));for(let r=0;r<e.attributes.length;r++){let i=e.attributes[r],n=i.name,a=i.array,o=i.itemSize;t.setAttribute(n,new qt(a,o))}return t}_loadLibrary(e,t){let r=new SM(this.manager);return r.setPath(this.decoderPath),r.setResponseType(t),r.setWithCredentials(this.withCredentials),new Promise((i,n)=>{r.load(e,i,void 0,n)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;let e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(r=>{let i=r[0];e||(this.decoderConfig.wasmBinary=r[1]);let n=qje.toString(),a=["/* draco decoder */",i,"","/* worker */",n.substring(n.indexOf("{")+1,n.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([a]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){let i=new Worker(this.workerSourceURL);i._callbacks={},i._taskCosts={},i._taskLoad=0,i.postMessage({type:"init",decoderConfig:this.decoderConfig}),i.onmessage=function(n){let a=n.data;switch(a.type){case"decode":i._callbacks[a.id].resolve(a);break;case"error":i._callbacks[a.id].reject(a);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+a.type+'"')}},this.workerPool.push(i)}else this.workerPool.sort(function(i,n){return i._taskLoad>n._taskLoad?-1:1});let r=this.workerPool[this.workerPool.length-1];return r._taskCosts[e]=t,r._taskLoad+=t,r})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this.workerSourceURL!==""&&URL.revokeObjectURL(this.workerSourceURL),this}};function qje(){let e,t;onmessage=function(o){let s=o.data;switch(s.type){case"init":e=s.decoderConfig,t=new Promise(function(u){e.onModuleLoaded=function(d){u({draco:d})},DracoDecoderModule(e)});break;case"decode":let l=s.buffer,c=s.taskConfig;t.then(u=>{let d=u.draco,h=new d.Decoder,f=new d.DecoderBuffer;f.Init(new Int8Array(l),l.byteLength);try{let p=r(d,h,f,c),v=p.attributes.map(m=>m.array.buffer);p.index&&v.push(p.index.array.buffer),self.postMessage({type:"decode",id:s.id,geometry:p},v)}catch(p){console.error(p),self.postMessage({type:"error",id:s.id,error:p.message})}finally{d.destroy(f),d.destroy(h)}});break}};function r(o,s,l,c){let u=c.attributeIDs,d=c.attributeTypes,h,f,p=s.GetEncodedGeometryType(l);if(p===o.TRIANGULAR_MESH)h=new o.Mesh,f=s.DecodeBufferToMesh(l,h);else if(p===o.POINT_CLOUD)h=new o.PointCloud,f=s.DecodeBufferToPointCloud(l,h);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!f.ok()||h.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+f.error_msg());let v={index:null,attributes:[]};for(let m in u){let g=self[d[m]],y,b;if(c.useUniqueIDs)b=u[m],y=s.GetAttributeByUniqueId(h,b);else{if(b=s.GetAttributeId(h,o[u[m]]),b===-1)continue;y=s.GetAttribute(h,b)}v.attributes.push(n(o,s,h,m,g,y))}return p===o.TRIANGULAR_MESH&&(v.index=i(o,s,h)),o.destroy(h),v}function i(o,s,l){let c=l.num_faces()*3,u=c*4,d=o._malloc(u);s.GetTrianglesUInt32Array(l,u,d);let h=new Uint32Array(o.HEAPF32.buffer,d,c).slice();return o._free(d),{array:h,itemSize:1}}function n(o,s,l,c,u,d){let h=d.num_components(),f=l.num_points()*h,p=f*u.BYTES_PER_ELEMENT,v=a(o,u),m=o._malloc(p);s.GetAttributeDataArrayForAllPoints(l,d,v,p,m);let g=new u(o.HEAPF32.buffer,m,f).slice();return o._free(m),{name:c,array:g,itemSize:h}}function a(o,s){switch(s){case Float32Array:return o.DT_FLOAT32;case Int8Array:return o.DT_INT8;case Int16Array:return o.DT_INT16;case Int32Array:return o.DT_INT32;case Uint8Array:return o.DT_UINT8;case Uint16Array:return o.DT_UINT16;case Uint32Array:return o.DT_UINT32}}}var bu;function Yje(){return bu||(bu=new $je,bu.setDecoderPath("https://www.gstatic.com/draco/versioned/decoders/1.5.2/").preload()),bu.decoderPending}async function Xje(e){if(bu){let t={attributeIDs:bu.defaultAttributeIDs,attributeTypes:bu.defaultAttributeTypes,useUniqueIDs:!1},r;try{r=await bu.decodeGeometry(new Int8Array(e).buffer,t)}catch(i){console.error(i)}if(r)return{index:r.index?{array:r.index.array}:void 0,attributes:Object.entries(r.attributes).map(([i,n])=>({name:i,itemSize:n.itemSize,array:n.array}))}}return null}async function Kje(e,t){let[r,i]=LH(BM.deserialize(new Uint8Array(e)));return sW(r),i.result().data}function Qje(e){let t=[];return e.scene.objects.traverse((r,i)=>{i.type==="Mesh"&&i.geometry.type==="NonParametricGeometry"&&i.geometry.data.draco!==void 0&&t.push(i)}),t}async function Zje(e){for(let t of e){let r=await Xje(t.geometry.data.draco);if(r){let i=t.geometry.data;r.index&&(i.index={array:r.index.array,itemSize:1,normalized:!1,type:"Uint32Array"});let n={};r.attributes.forEach(({name:a,array:o,itemSize:s})=>{n[a]={array:o,itemSize:s,type:"Float32Array",normalized:!1}}),i.attributes=n,i.draco=void 0}}}var Jje=class{constructor(){this._clickCount=0,this._lastTime=0,this._lastPosition=[0,0],this._delay=500,this._distance=2,this._onMouseDown=e=>{let t=[e.clientX,e.clientY],r=new Date().getTime();if(this._clickCount>0){let i=t[0]-this._lastPosition[0],n=t[1]-this._lastPosition[1];Math.sqrt(i*i+n*n)>this._distance&&(this._clickCount=0)}this._lastPosition=t,this._clickCount=r-this._lastTime>this._delay?1:this._clickCount+1,this._lastTime=r},this._onMouseUp=e=>{}}start(e,t=500,r=2){this._target&&this.stop(),this.reset(),this._delay=t,this._distance=r,this._target=e,this._target.addEventListener("pointerdown",this._onMouseDown,!1),this._target.addEventListener("pointerup",this._onMouseUp,!1)}stop(){this._target&&(this._target.removeEventListener("pointerdown",this._onMouseDown,!1),this._target.removeEventListener("pointerup",this._onMouseUp,!1),this._target=void 0)}get clickCount(){return this._clickCount}reset(){this._clickCount=0,this._lastTime=0,this._lastPosition=[0,0]}},eVe=class{constructor(e,t,r,i,n,a,o,s){this.eventId=e,this.id=t,this.data=r,this.dataEvent=i,this.object=n,this.stage=!1,this.actions=$n(i,r.actions,a,o,s,n)}disconnect(){jn(this.actions)}dispatchIn(){this.actions.Audio.forEach(e=>e.dispatchBasic()),this.actions.Particles.forEach(e=>e.dispatchBasic()),this.actions.Video.forEach(e=>e.dispatchBasic()),this.actions.Create.forEach(e=>e.dispatch()),this.actions.Destroy.forEach(e=>e.dispatch()),this.actions.Reset.forEach(e=>e.dispatch()),this.actions.Link.forEach(e=>e.dispatch()),this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),this.actions.Transition.forEach(e=>e.toggle()),this.actions.Animation.forEach(e=>e.play()),this.actions.SwitchCamera.forEach(e=>e.play()),this.actions.SceneTransition.forEach(e=>e.dispatch()),this.actions.SetVariable.forEach(e=>e.checkConditions()),this.actions.SetVariable.forEach(e=>e.dispatch()),this.actions.DynamicVariablePlay.forEach(e=>e.dispatch()),this.actions.ClearLocalStorage.forEach(e=>e.dispatch()),this.actions.UserAPI.forEach(e=>e.dispatch())}dispatchOut(){this.actions.Transition.forEach(e=>{e.toggle()})}},tVe=class extends lo{constructor(e,t){super(e),this.eventManager=t,this.breakpoints=[],this.resize=(r,i)=>{this.breakpoints.forEach(n=>{let a=jM.deviceToSize(n.data.size),o=n.dataEvent.orientation==="horizontal"?r:i,s;switch(n.data.operator){case"<":s=o<a[0];break;case">":s=o>a[0];break;case"<>":s=o>a[0]&&o<a[1];break}n.stage!==s&&(n.stage=s,n.stage?n.dispatchIn():n.dispatchOut())})},this.onResizeObserver=new ResizeObserver(r=>{for(let i of r){let{width:n,height:a}=i.contentRect;this.resize(n,a)}})}connect(){let{page:e,sharedAssets:t,domElement:r}=this.eventContext;this.onResizeObserver.observe(r);let i=n=>{var a;if(!(!n.visible||!((a=n.data)!=null&&a.events.length)))for(let{data:o,id:s}of n.data.events)o.disabled||o.type==="Resize"&&o.breakpoints.forEach(({data:l,id:c})=>{try{let u=new eVe(s,c,l,o,n,e,t,this.eventManager);this.breakpoints.push(u)}catch{}})};e.traverseEntity(n=>{var a;(n instanceof va||n instanceof Rn)&&((a=n.frame)==null||a.traverse(o=>{i(o)})),i(n)})}disconnect(){this.onResizeObserver.disconnect(),this.breakpoints.forEach(e=>{e.disconnect()}),this.breakpoints=[]}},rVe=class extends lo{constructor(e,t){super(e),this.eventManager=t,this.userAPIs={},this.events=[],this.onSuccess=({userAPIId:r})=>{this.events.forEach(i=>{i.data.userAPIId===r&&i.dispatchSuccess()})},this.onError=({userAPIId:r})=>{this.events.forEach(i=>{i.data.userAPIId===r&&i.dispatchError()})},this.userAPIs=e.sharedAssets.getUserAPIs()}connect(){this.eventContext.page.traverseEntity(e=>{var t;(t=e.data)==null||t.events.filter(r=>r.data.type==="API"&&!r.data.disabled).forEach(r=>{this.events.push(new iVe(r.id,r.data,e,this.eventContext.page,this.eventContext.sharedAssets,this.eventManager))})}),Object.entries(this.userAPIs).forEach(([e,t])=>{t.on("success",this.onSuccess),t.on("error",this.onError),t.autostart&&t.callUserAPI(this.eventContext.sharedAssets)})}disconnect(){Object.entries(this.userAPIs).forEach(([e,t])=>{t.off("success",this.onSuccess),t.off("error",this.onError)})}},iVe=class{constructor(e,t,r,i,n,a){this.id=e,this.data=t,this.object=r,this.successActions=$n(t,t.successActions,i,n,a,r),this.errorActions=$n(t,t.errorActions,i,n,a,r)}dispatchSuccess(){this.dispatchActions(this.successActions)}dispatchError(){this.dispatchActions(this.errorActions)}dispatchActions(e){e.Audio.forEach(t=>t.dispatchConditional()),e.Particles.forEach(t=>t.dispatchConditional()),e.Video.forEach(t=>t.dispatchConditional()),e.Create.forEach(t=>t.dispatch()),e.Destroy.forEach(t=>t.dispatch()),e.Reset.forEach(t=>t.dispatch()),e.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this),t.init()}),e.Transition.forEach(t=>t.play()),e.Animation.forEach(t=>t.play()),e.SwitchCamera.forEach(t=>t.play()),e.SceneTransition.forEach(t=>t.dispatch()),e.SetVariable.forEach(t=>t.checkConditions()),e.SetVariable.forEach(t=>t.dispatch()),e.DynamicVariablePlay.forEach(t=>t.dispatch()),e.ClearLocalStorage.forEach(t=>t.dispatch()),e.UserAPI.forEach(t=>t.dispatch())}},nVe=class extends lo{constructor(e,t){super(e),this.eventManager=t,this.userWebhooks={},this.events=[],this.onMessage=({userWebhookId:r})=>{this.events.forEach(i=>{i.data.userWebhookId===r&&i.dispatch()})},this.userWebhooks=e.sharedAssets.getUserWebhooks()}connect(){this.eventContext.page.traverseEntity(e=>{var t;(t=e.data)==null||t.events.filter(r=>r.data.type==="WEBHOOK"&&!r.data.disabled).forEach(r=>{this.events.push(new aVe(r.id,r.data,e,this.eventContext.page,this.eventContext.sharedAssets,this.eventManager))})}),Object.entries(this.userWebhooks).forEach(([e,t])=>{t.connect(),t.on("message",this.onMessage)})}disconnect(){Object.entries(this.userWebhooks).forEach(([e,t])=>{t.off("message",this.onMessage),t.disconnect()})}},aVe=class{constructor(e,t,r,i,n,a){this.id=e,this.data=t,this.object=r,this.actions=$n(t,t.actions,i,n,a,r)}dispatch(){let e=this.actions;e.Audio.forEach(t=>t.dispatchConditional()),e.Particles.forEach(t=>t.dispatchConditional()),e.Video.forEach(t=>t.dispatchConditional()),e.Create.forEach(t=>t.dispatch()),e.Destroy.forEach(t=>t.dispatch()),e.Reset.forEach(t=>t.dispatch()),e.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this),t.init()}),e.Transition.forEach(t=>t.play()),e.Animation.forEach(t=>t.play()),e.SwitchCamera.forEach(t=>t.play()),e.SceneTransition.forEach(t=>t.dispatch()),e.SetVariable.forEach(t=>t.checkConditions()),e.SetVariable.forEach(t=>t.dispatch()),e.DynamicVariablePlay.forEach(t=>t.dispatch()),e.ClearLocalStorage.forEach(t=>t.dispatch()),e.UserAPI.forEach(t=>t.dispatch())}};function oVe(){let e=document.createElement("textarea");return e.style.position="fixed",e.style.top="200px",e.style.left="400px",e.style.zIndex="-1",e.style.border="1px solid rgba(255,0,0,0.5)",e.style.width="10px",e.style.height="500px",e.style.color="white",e.style.opacity="0.5",e.style.background="transparent",e.style.display="none",e.style.margin="0px",e.style.padding="0px",e.style.boxSizing="content-box",e.style.pointerEvents="none",e}var sVe=new k(0,0,1),r5=new k,i5=new k,n5=new cn,lVe=class{constructor(e,t,r,i,n){this.containerScene=e,this.raycaster=t,this.sharedAssets=r,this.requestRender=i,this.onExit=n,this.htmlInput=null,this.virtualInput=null,this.helper=new z9,this.doubleClickHandler=new Jje,this.isDragging=!1,this.plane=new Ya,this.caretInterval=0,this.planeIntersection=new k,this.projected=new ye,this._lastIndex=0,this._isFirstDragMove=!1,this.selectionOnDragStart=0,this.onTextMaterialChanged=()=>{var o;let a=(o=this.virtualInput)==null?void 0:o.data;if(this.virtualInput!==void 0&&a){let s=a.material,l=typeof s=="string"?this.sharedAssets.data.materials[s]:s,c=S5e(l,this.sharedAssets);this.helper.setCaretColor(c)}},this.stopAnimateTextCursor=()=>{clearInterval(this.caretInterval),this.helper&&(this.helper.caretMesh.visible=!1)},this.startAnimateTextCursor=()=>{this.stopAnimateTextCursor(),this.helper&&(this.helper.caretMesh.visible=!0,this.caretInterval=setInterval(()=>{this.helper&&(this.helper.caretMesh.visible=!this.helper.caretMesh.visible),this.requestRender()},600))},this.handleCaretUpdate=a=>{if(!this.htmlInput||!this.virtualInput)return;let o=this.helper,s=(a==null?void 0:a.key)==="ArrowLeft"||(a==null?void 0:a.key)==="ArrowRight",l=(a==null?void 0:a.key)==="ArrowUp"||(a==null?void 0:a.key)==="ArrowDown";this.htmlInput.selectionStart===this.htmlInput.selectionEnd?(o.setCaretPosition(this.htmlInput.selectionStart,{horizontalKeyMove:s,verticalKeyMove:l}),this.startAnimateTextCursor()):o.setSelection(this.htmlInput.selectionStart,this.htmlInput.selectionEnd),this.requestRender()},this.containerScene.add(this.helper)}createInput(){return this.htmlInput=oVe(),this.htmlInput}connect(){}disconnect(){var e;this.stopAnimateTextCursor(),this.helper.hide(),(e=this.htmlInput)==null||e.remove(),this.doubleClickHandler.stop()}handleMouseDown(){var a;if(!this.htmlInput||!this.virtualInput)return!0;this.getPointOnPlane();let e=this.doubleClickHandler.clickCount,{index:t,lineIndex:r,characterIndex:i}=this.helper.getSelectionFromPosition(this.projected.x,this.projected.y,e>1?"inside":"previous")??{index:0,lineIndex:0,characterIndex:0};((a=this.virtualInput)==null?void 0:a.wrappedText[r][Math.max(0,i-1)])===`
`&&(t--,i--),this._lastIndex=t,this._isFirstDragMove=!0;let n=this.checkClickedObject();if(e===1){if(n===null)return this.onExit(this.virtualInput),!0;this.selectionOnDragStart=t,this.isDragging=!0,this.setInputSelection(t)}else n===this.virtualInput&&(e===2?this.selectClosestWord(r,i):e>2&&(this.setInputSelection(0,this.htmlInput.value.length),this.doubleClickHandler.reset()))}handleMouseUp(){this.applyRangeToTextInput(),this.isDragging=!1,this._isFirstDragMove=!1}handleMouseMove(){!this.virtualInput||(this._isFirstDragMove&&this.doubleClickHandler.clickCount>1&&(this.selectionOnDragStart=this._lastIndex,this.isDragging=!0,this.setInputSelection(this._lastIndex)),this._isFirstDragMove=!1,this.getPointOnPlane(),this.applyRangeToTextInput())}focus(e){var t;if(this.virtualInput=e,this.updateTextInputStyles(),this.htmlInput)if(e){let r=(t=this.data)==null?void 0:t.geometry.text;this.htmlInput.value=typeof r=="string"?"":(r==null?void 0:r.textValue.toString())??""}else this.htmlInput.value=""}blur(){}get data(){let{virtualInput:e}=this;if(e)return e.dataPatched}applyRangeToTextInput(){var n;if(!this.isDragging||!this.virtualInput||!this.htmlInput)return;let e=this.selectionOnDragStart,{index:t,lineIndex:r,characterIndex:i}=this.helper.getSelectionFromPosition(this.projected.x,this.projected.y,this.doubleClickHandler.clickCount>2?"inside":"previous")??{index:0};r!==void 0&&i!==void 0&&((n=this.virtualInput)==null?void 0:n.wrappedText[r][i-1])===`
`&&t--,this.htmlInput.setSelectionRange(Math.min(e,t),Math.max(e,t))}checkClickedObject(){if(this.virtualInput){let e=this.raycaster.intersectObject(this.virtualInput,!1);if(e.length>0){let t=e[0];if(t.object instanceof n3)return t.object}}return null}selectClosestWord(e,t){if(!this.virtualInput)return;let r=this.virtualInput.wrappedText,i=r[e],n=t+1,a=t;i[t]!==" "&&(n=this.findNextCharOccurence(i,t,"forward"," "),a=this.findNextCharOccurence(i,t,"backward"," "),a>0&&a++,n>=i.length-1&&e===r.length-1&&n++);let o=this.helper,s=o.getGlobalIndexFromLineAndCharIndexes(r,e,a),l=o.getGlobalIndexFromLineAndCharIndexes(r,e,n);this.setInputSelection(s,l)}findNextCharOccurence(e,t,r,i=" "){let n=Math.max(0,e.length-1),a=r==="forward"?n:0,o=r==="forward"?1:-1,s=Math.max(Math.min(t,n),0);for(;s!==a;)if(s+=o,e.charAt(s)===i)return s;return a}getPointOnPlane(){var t;let e=(t=this.virtualInput)==null?void 0:t.data;if(!(!this.virtualInput||!e)&&this.raycaster.ray.intersectsPlane(this.plane)){this.planeIntersection===null&&(this.planeIntersection=new k);let r=this.raycaster.ray.intersectPlane(this.plane,this.planeIntersection);if(r){this.planeIntersection.copy(this.virtualInput.worldToLocal(r));let i=typeof e.geometry.width=="number"?e.geometry.width:1,n=typeof e.geometry.height=="number"?e.geometry.height:1;this.projected.set(r.x+i*.5,r.y-n*.5)}}}updatePlane(){var t;let e=(t=this.virtualInput)==null?void 0:t.data;this.virtualInput&&e&&(n5.getNormalMatrix(this.virtualInput.matrixWorld),r5.copy(sVe).applyMatrix3(n5).normalize(),this.virtualInput.localToWorld(i5.set(0,0,e.geometry.depth)),this.plane.setFromNormalAndCoplanarPoint(r5,i5))}setInputSelection(e,t=e){var r;(r=this.htmlInput)==null||r.setSelectionRange(e,t),setTimeout(()=>{var i;(i=this.htmlInput)==null||i.focus()})}updateTextInputStyles(){var t;let e=(t=this.virtualInput)==null?void 0:t.data;this.virtualInput&&e&&this.htmlInput&&(this.htmlInput.style.fontSize=e.geometry.fontSize+"px",this.htmlInput.style.letterSpacing=e.geometry.letterSpacing*e.geometry.fontSize+"px",this.htmlInput.style.lineHeight=e.geometry.fontSize*e.geometry.lineHeight+"px",this.htmlInput.style.width=e.geometry.width+"px",this.htmlInput.style.height=e.geometry.height+"px",this.htmlInput.style.textAlign=cVe(e.geometry.horizontalAlign))}};function cVe(e){return e===4?"justify":e===2?"right":e===3?"center":"left"}var W7=(e,t)=>{if(typeof e=="string"){let r=t.data(e);if(r)return W7(r.value,t)}return na.getDisplayedValue(e)};function a5(e,t){let r=e.text,i="";if(typeof r=="string"){let n=t.variables.data(i);n&&(i=W7(n.value,t.variables))}else i=r.textValue.toString();return i}var uVe=class extends lo{constructor(e,t){super(e),this.eventManager=t,this._textInputs=[],this.sceneHelpers=new ll,this.helper=new z9,this._onMouseDownFocusIn=r=>{if(Wt.length>1)return;this.eventContext.updateRaycaster(r);let i=null;if(this.eventContext.raycaster){for(let n of this._textInputs)if(this.eventContext.raycaster.intersectObject(n,!0).length>0){i=n;break}}this.focusOnTextInput(i),this._onCaretUpdate(),this._onMouseUp(),this.textInputManager.doubleClickHandler.start(this.eventContext.domElement),this.textInputManager.doubleClickHandler._onMouseDown(r),this._onMouseDown(r)},this.onExit=()=>{let{virtualInput:r}=this.textInputManager;if(r===null)return;let i=this.textInputManager.htmlInput;this.helper.hide(),i==null||i.setSelectionRange(i.value.length,i.value.length),this.eventManager.controlsManager.orbitControls&&(this.eventManager.controlsManager.orbitControls.enabled=!0);let{domElement:n}=this.eventContext;n.removeEventListener("pointerdown",this._onMouseDown,!1),n.removeEventListener("pointerup",this._onMouseUp,!1),n.removeEventListener("pointermove",this._onMouseMove,!1),window.removeEventListener("keydown",this._onKeyPress),this.textInputManager.doubleClickHandler.reset(),n.addEventListener("pointerdown",this._onMouseDownFocusIn),this.eventContext.renderer.sceneHelpersOnTop=void 0,this.eventContext.renderer.pipeline.disableHelpers()},this._onMouseDown=r=>{this.eventContext.updateRaycaster(r),this.textInputManager.handleMouseDown(),this.textInputManager.virtualInput&&this.eventContext.raycaster.intersectObject(this.textInputManager.virtualInput,!0).length>0&&this.eventManager.controlsManager.orbitControls&&(this.eventManager.controlsManager.orbitControls.enabled=!1)},this._onMouseUp=()=>{this.textInputManager.handleMouseUp(),this.eventManager.controlsManager.orbitControls&&!this.eventManager.controlsManager.orbitControls.enabled&&(this.eventManager.controlsManager.orbitControls.enabled=!0)},this._onMouseMove=r=>{this.eventContext.updateRaycaster(r),this.textInputManager.handleMouseMove()},this._onTextEdit=r=>{let{htmlInput:i,virtualInput:n,helper:a}=this.textInputManager;if(!i||!n)return;let o=i.value;n.textGeometry.setText(o).then(()=>{this.eventContext.requestRender()});let s=n.data;a.update();let l=s.geometry.text;if(typeof l=="string"){let c=l;this.eventContext.sharedAssets.updateVariable(c,{textValue:o})}this.textInputManager.updateTextInputStyles(),this._onCaretUpdate()},this._onCaretUpdate=r=>{this.textInputManager.handleCaretUpdate(r)},this._onKeyPress=r=>{r.key==="Escape"&&this.onExit()},this.textInputManager=new lVe(this.sceneHelpers,e.raycaster,e.sharedAssets,e.requestRender,this.onExit)}connect(){let e=[];if(this.eventContext.scene.traverseEntity(i=>{i instanceof n3&&e.push(i)}),this._textInputs=e,e.length===0)return;let{domElement:t}=this.eventContext;t.addEventListener("pointerdown",this._onMouseDownFocusIn),this.textInputManager.connect();let r=this.textInputManager.createInput();document.body.appendChild(r),r.style.display="none",r.addEventListener("keyup",this._onCaretUpdate),r.addEventListener("keydown",this._onCaretUpdate),r.addEventListener("beforeinput",this._onCaretUpdate),r.addEventListener("paste",this._onCaretUpdate),r.addEventListener("cut",this._onCaretUpdate),r.addEventListener("select",this._onCaretUpdate),r.addEventListener("selectstart",this._onCaretUpdate)}disconnect(){let e=this.textInputManager.htmlInput,{domElement:t}=this.eventContext;t.removeEventListener("pointerdown",this._onMouseDownFocusIn),e==null||e.removeEventListener("keyup",this._onCaretUpdate),e==null||e.removeEventListener("keydown",this._onCaretUpdate),e==null||e.removeEventListener("beforeinput",this._onCaretUpdate),e==null||e.removeEventListener("paste",this._onCaretUpdate),e==null||e.removeEventListener("cut",this._onCaretUpdate),e==null||e.removeEventListener("select",this._onCaretUpdate),e==null||e.removeEventListener("selectstart",this._onCaretUpdate),this._textInputs.forEach(r=>{let i=a5(r.data.geometry,this.eventContext.sharedAssets.data);r.textGeometry.setText(i)}),t.removeEventListener("pointerdown",this._onMouseDown,!1),t.removeEventListener("pointerup",this._onMouseUp,!1),t.removeEventListener("pointermove",this._onMouseMove,!1),window.addEventListener("keydown",this._onKeyPress),this.eventContext.renderer.sceneHelpersOnTop=void 0,this.eventContext.renderer.pipeline.disableHelpers(),this.textInputManager.disconnect()}focusOnTextInput(e){this.textInputManager.focus(e),this.textInputManager.onTextMaterialChanged();let t=this.textInputManager.htmlInput;if(!t||e===null)return;this.textInputManager.updateTextInputStyles(),this.eventContext.renderer.sceneHelpersOnTop=this.sceneHelpers,this.eventContext.renderer.pipeline.enableHelpers(),this.textInputManager.isDragging=!1;let r=a5(e.textGeometry.userData.parameters,this.eventContext.sharedAssets.data);t.value=r,t.setSelectionRange(0,0),this.textInputManager.helper.show(e),t.style.display="block",t.addEventListener("input",this._onTextEdit),this.textInputManager.updatePlane();let{domElement:i}=this.eventContext;i.removeEventListener("pointerdown",this._onMouseDownFocusIn),i.addEventListener("pointerdown",this._onMouseDown,!1),i.addEventListener("pointerup",this._onMouseUp,!1),i.addEventListener("pointermove",this._onMouseMove,!1),window.addEventListener("keydown",this._onKeyPress)}},dVe=class{constructor(e,t,r,i,n){this.publish=e,this.controlsManager=t,this.animationControls=r,this.eventContext=i,this.sharedVariables=n,this.isEnabled=!1,this.activateCount=0,this.needsMouse=!1,this.needsRaycast=!1,this.onTouchMovePreventScroll=a=>{let o=window.parent!==window,s=document.documentElement.scrollHeight>document.documentElement.clientHeight||document.documentElement.scrollWidth>document.documentElement.clientWidth;(a.touches.length>1||this.preventTouchScroll||o===!1&&s===!1)&&a.preventDefault()},this.onMouseWheelPreventScroll=a=>{this.preventScroll&&a.preventDefault()},this.onMouseMove=a=>{this.eventContext.sharedAssets.mouseProperty={...this.getMousePosition(a),pressed:a.buttons>0}},this.onMouseDown=a=>{this.eventContext.sharedAssets.mouseProperty={...this.getMousePosition(a),pressed:!0}},this.onMouseUp=a=>{this.eventContext.sharedAssets.mouseProperty={...this.getMousePosition(a),pressed:!1}},this.getMousePosition=a=>{var c;let{domRect:o}=this.eventContext,{pageX:s,pageY:l}=((c=a.touches)==null?void 0:c.length)>0?a.touches[0]:a;return{x:s-(o.left+window.scrollX),y:l-(o.top+window.scrollY)}},this.stopRaycast=e.stopRaycast,this.preventScroll=e.preventScroll,this.preventTouchScroll=e.preventTouchScroll,this.hideCursor=e.hideCursor,this.requestRender=i.requestRender}activate(){if(this.isEnabled)return;this.isEnabled=!0,this.initializeActionsDependentStates(),this.needsMouse&&(this.eventContext.domElement.addEventListener("pointermove",this.onMouseMove),this.eventContext.domElement.addEventListener("pointerdown",this.onMouseDown)),this.handlers={Spline:new V6e(this.eventContext),VariableChange:new xje(this.eventContext,this.sharedVariables,this,this.needsMouse,this.needsRaycast),API:new rVe(this.eventContext,this),WEBHOOK:new nVe(this.eventContext,this),Conditional:new X6e(this.eventContext,this),Start:new yje(this.eventContext,this),Basic:new W6e(this.eventContext,this,this.needsRaycast),MouseHover:new fje(this.eventContext,this),Scroll:new vje(this.eventContext,this),Follow:new aje(this.eventContext,this),DragDrop:new eje(this.eventContext,this),LookAt:new uje(this.eventContext),Resize:new tVe(this.eventContext,this),Textfields:new uVe(this.eventContext,this)};let{page:e,domElement:t}=this.eventContext;this.hideCursor&&(t.style.cursor="none"),e.traverseEntity(r=>{r.addEventListener("requestRender",this.requestRender)}),Object.values(this.handlers).forEach(r=>r.connect()),t.addEventListener("wheel",this.onMouseWheelPreventScroll),t.addEventListener("touchmove",this.onTouchMovePreventScroll),this.activateCount++}deactivate(){var r;if(!this.isEnabled)return;this.isEnabled=!1,this.eventContext.domElement.removeEventListener("pointermove",this.onMouseMove),this.eventContext.domElement.removeEventListener("pointerdown",this.onMouseDown),this.eventContext.domElement.removeEventListener("pointerup",this.onMouseUp),this.eventContext.sharedAssets.mouseProperty=null,this.eventContext.sharedAssets.raycastProperty=null;let{page:e,domElement:t}=this.eventContext;t.style.cursor="",Object.values(this.handlers).forEach(i=>i.disconnect()),(r=this.controlsManager.gameControl)==null||r.disposeActions(),this.controlsManager.disconnectEvents(),e.traverseEntity(i=>{i.removeEventListener("requestRender",this.requestRender),i.destroyedInAction=!1}),t.removeEventListener("touchmove",this.onTouchMovePreventScroll),t.removeEventListener("wheel",this.onMouseWheelPreventScroll),this.animationControls.onExitPlayMode()}get isPaused(){return this.isEnabled}pause(){this.deactivate()}resume(){this.activate()}reset(){this.deactivate(),this.activate(),this.controlsManager.page.updateMatrixWorld(!0),this.controlsManager.rebuildBVH()}updateUseWindowEvents(e){let t=this.isEnabled;t&&this.deactivate(),this.eventContext.useWindowEvents=e,t&&this.activate()}initializeActionsDependentStates(){let e=this.eventContext.sharedAssets;e.resetDynamicVariablePlayState();let t=r=>{if(r.data.type==="Conditional"&&(r.data.ifActions.forEach(t),r.data.elseActions.forEach(t)),r.data.type==="Conditional"||r.data.type==="SetVariable")for(let i of r.data.type==="Conditional"?r.data.condition:r.data.expression)"id"in i&&Array.isArray(i.id)&&(i.id[0]==="mouse"&&(this.needsMouse=!0),i.id[0]==="raycast"&&(this.needsRaycast=!0));r.data.type==="DynamicVariablePlay"&&r.data.variableId!==""&&(r.data.mode==="Play"||r.data.mode==="PlayPause"||r.data.mode==="Toggle")&&e.setDynamicVariablePlayState(r.data.variableId,"Stopped")};this.eventContext.page.traverseEntity(r=>{var i;if((i=r.data)!=null&&i.events.length)for(let n of r.data.events)if(n.data.type==="VariableChange"&&(n.data.variableId==="mouseProperty"&&(this.needsMouse=!0),n.data.variableId==="raycastProperty"&&(this.needsRaycast=!0)),n.data.type==="Conditional")for(let a of["inActions","outActions"])n.data[a].forEach(t);else if(n.data.type==="DragDrop")for(let a of["drag","drop"])n.data.dragDropActions[a].forEach(t);else if(n.data.type==="GameControl")for(let a of["idle","move","jump","run"])n.data.gameActions[a].forEach(t);else if(n.data.type==="Resize")for(let a of n.data.breakpoints)a.data.actions.forEach(t);else n.data.type==="LookAt"||n.data.type==="API"||n.data.actions.forEach(t)})}},hVe=class{constructor(e,t,r,i,n){this._aspect=1,this.enableResponsive=!1,this._renderer=e,this._camera=t,this._frameSize=new ye().copy(r),this._editorSize=new ye().copy(i),this._aspect=t.aspect,this._fov=n??t.fov}set frameSize(e){this._frameSize.copy(e)}updateRenderer(){!this._renderer||this._renderer.setSize(this._frameSize.x,this._frameSize.y)}updateViewport(){if(!this._renderer||!this._camera||this._camera.cameraType!=="PerspectiveCamera")return;let e=this._frameSize.x,t=this._frameSize.y,r=this._editorSize.y;this._aspect=e/t,t<=r&&(this._camera.zoom*=r/t),this._renderer.setViewport(0,0,e,t)}updateCamera(e=!0){if(this._camera)if(this._camera.cameraType==="PerspectiveCamera"){let t=this._frameSize.y,r=this._editorSize.y,i=this._fov;if(e&&t>r){let n=fVe(t,1080,2160,1,15)/100;i*=t/r,i*=1-n}this._camera.aspect=this._aspect,this._camera.fov=i,this._camera.updateProjectionMatrix()}else this._camera.setViewplaneSize(this._frameSize.x,this._frameSize.y,this.enableResponsive)}setCamera(e){this._camera=e,this._aspect=e.aspect,this._fov=e.fov}revert(){let e=window.innerWidth,t=window.innerHeight;this._renderer&&(this._renderer.setViewport(0,0,e,t),this._renderer.setSize(e,t)),this._camera&&(this._camera.aspect=e/t,this._camera.fov=this._fov,this._camera.setViewplaneSize(e,t,this.enableResponsive),this._camera.updateProjectionMatrix())}};function fVe(e,t,r,i,n){return(e-t)/(r-t)*(n-i)+i}var pVe=class{get sharedAssets(){return this.shared}constructor(e,t={},r=!0){this.shared=new qD(e.shared,t,!0,r),this.scene=new s3(e.scene,this.sharedAssets),this.shared.setEntityOpContext({scene:this.scene,shared:this.shared})}reset(e,t){this.scene.clearScene(),this.sharedAssets.reset(e.shared),this.scene.resetAfterClear(e.scene,this.sharedAssets)}resetPersonalCameraFromDocumentData(){for(let e of this.scene.children)e instanceof Rn&&!e.uiScene&&e.personalCamera.updateState(e.data.camera,{scene:this.scene,shared:this.shared})}dispose(){this.scene.dispose(),this.shared.dispose()}gc(){this.shared.geometryCache.startGc(),this.shared.geometryCache2.startGc(),this.scene.traverseEntity(e=>{e instanceof ba&&e.markGeometryAsReachable(this.shared)}),this.shared.geometryCache.endGc(),this.shared.geometryCache2.endGc()}},mVe=class{constructor({x:e=10,y:t=10}){this._startTime=0;let r=document.getElementById("spe-perfs");r?this.element=r:(this.element=document.createElement("div"),document.body.appendChild(this.element),this.element.style.position="absolute",this.element.style.zIndex="10000",this.element.style.fontFamily="monospace",this.element.style.background="black",this.element.style.color="white",this.element.style.padding="10px",this.element.style.opacity="0.5",this.element.style.fontSize="11px",this.element.setAttribute("id","spe-perfs")),this.element.style.left=`${e}px`,this.element.style.top=`${t}px`}dispose(){var e;(e=this.element.parentElement)==null||e.removeChild(this.element)}start(){this._startTime=performance.now()}end(){let e=performance.now()-this._startTime;this.element.innerHTML=e.toFixed(3)+" ms"}};function vVe(e){let t;if(e.index)for(let r=0;r<e.index.array.length;r+=3)t=e.index.array[r],e.index.array[r]=e.index.array[r+2],e.index.array[r+2]=t}function tg(e){return e instanceof Yg?"SubdivObject":e.geometry.type==="NonParametricGeometry"?"NonParametric":"Mesh"}function gVe(e,t){let r={};return e.traverseEntity(i=>{var l;if(!i.visible||!(i instanceof Fa)||i.type!=="Mesh"||Array.isArray(i.material)||i.states&&Object.keys(i.states).length)return;let n=i.parent;for(;n;){if(n instanceof Fa&&i.states&&Object.keys(i.states).length)return;n=n.parent}let a=i.material.uuid,o=t.shared.materials[a];if(o){if(!ia.isMergable(o))return}else{let c=(l=t.scene.objects.get(i.uuid))==null?void 0:l.data;if(c&&"material"in c&&typeof c.material!="string"){if(!ia.isMergable(c.material))return;a=ia.getHash(c.material)}}r[a]||(r[a]={});let s=r[a][tg(i)];if(s){if(s.push(i),i.cloner)for(let c of i.cloner.children)s.push(c)}else if(r[a][tg(i)]=[i],i.cloner)for(let c of i.cloner.children)r[a][tg(i)].push(c)}),r}function yVe(e){let t=0;return Object.values(e).forEach(r=>{Object.values(r).forEach(i=>{let n=i.length;n>t&&(t=n)})}),t}function bVe(e,t){let r=gVe(t,e),i=yVe(r),n=new Array(i),a=0,o=new Array(i),s=0,l=new Array(i),c=0,u=new Array(i),d=0;for(let[h,f]of Object.entries(r))for(let p of Object.values(f)){if(s=0,c=0,p.forEach(m=>{m instanceof Fa&&(o[s++]=m.geometry.clone(),l[c++]=m)}),c<2)continue;for(let m=0;m<c;m++)l[m].updateWorldMatrix(!0,!1),o[m].applyMatrix4(l[m].matrixWorld),l[m].matrixWorld.determinant()<0&&vVe(o[m]);let v=jd(o.slice(0,s),!1);if(v){let m;switch(h){case"SubdivObject":{console.warn("Turning subdiv object into mesh"),m=new Oi(v,l[0].material);break}default:{m=new Oi(v,l[0].material);break}}m.castShadow=l[0].castShadow,m.receiveShadow=l[0].receiveShadow,t.add(m);let g=y=>{d=0;for(let b of y)b.children&&g(b.children),b instanceof Fa&&(Array.isArray(b.material)||r[b.material.uuid]&&r[b.material.uuid][tg(b)]&&r[b.material.uuid][tg(b)].length>1||(u[d++]=b));for(let b=0;b<d;b++)t.attach(u[b])};for(let y=0;y<c;y++){let b=l[y];g(b.children),n[a++]=b}}}for(let h=0;h<a;h++)n[h].removeFromParent()}var xVe=Ac(Yye(),1),wVe=new ye;function SVe(e){let t="The Spline Runtime only accepts .splinecode files that are generated from Spline export panel.";e.endsWith(".spline")?console.warn(t+" The .spline files are only meant to be used by the Editor."):e.endsWith(".splinecode")||console.warn(t)}var CVe=class{constructor(e,{renderOnDemand:t,renderMode:r="auto"}={}){this._viewportMode=1,this._viewportWidth=window.innerWidth,this._viewportHeight=window.innerHeight,this._proxyObjectCache=new Map,this._variablesCache=new Map,this._isPaused=!1,this._renderRequested=!1,this._skipRender=!1,this.time=performance.now(),this.dt=0,this.currentTAAFrame=0,this.disposed=!1,this._requestRenderAutoMode=()=>{this._skipRender=!1},this.requestRender=()=>{this._renderRequested=!0},this.render=i=>{var n,a,o,s,l,c,u,d,h,f,p,v,m;if(this.time=i,this._lastTime&&(this.dt=this.time-this._lastTime),this._lastTime=this.time,(n=this._perfs)==null||n.start(),!this._renderer){(a=this._perfs)==null||a.end();return}if(!this._isPaused&&(this.renderMode==="manual"&&!this._renderRequested||this.renderMode==="auto"&&this._skipRender)){(o=this._perfs)==null||o.end();return}if(this._renderRequested=!1,this._skipRender=!0,this._controls&&(this._skipRender=this._controls.update(this.dt)),this._eventManager&&((s=this._eventManager.handlers)!=null&&s.Start.hasVideoAction||(l=this._eventManager.handlers)!=null&&l.Basic.hasVideoAction||(c=this._eventManager.handlers)!=null&&c.Conditional.hasVideoAction)&&(this._skipRender=!1),(u=this._animationControls)==null||u.update(this.dt),this._skipRender?(this.currentTAAFrame++,this.currentTAAFrame<32?this._skipRender=!1:this.currentTAAFrame=0):this.currentTAAFrame=0,(d=this._scene)==null||d.traverseVisibleEntity(g=>{g.type==="ParticleSystem"&&(g.update(this.dt),this._skipRender=!1)}),this._scene&&this._scene.activeCamera!==this._camera&&(this._camera=this._scene.activeCamera),(h=this._eventManager)!=null&&h.isEnabled&&(((f=this._eventManager.handlers)==null?void 0:f.Follow).onAnimationFrameDamping(),((p=this._eventManager.handlers)==null?void 0:p.LookAt).onAnimationFrameDamping(),((v=this._eventManager.handlers)==null?void 0:v.DragDrop).onAnimationFrameDamping()),this._scene&&this._camera){if(this._scene.pathConstraints.applyConstraints(this._scene),this._renderer.sceneTransitionTimeRemaining>0){this._renderer.sceneTransitionTimeRemaining-=this.dt;let g=1-this._renderer.sceneTransitionTimeRemaining/this._renderer.sceneTransitionDuration;this._renderer.pipeline.sceneTransitionPass.uniforms.mixRatio.value=g,this._skipRender=!1}else this._renderer.pipeline.sceneTransitionFromTexture=null;this._renderer.renderSplineScene(this._scene,this._camera)}this.canvas.dispatchEvent(this._renderedEvent),(m=this._perfs)==null||m.end()},this._resize=i=>{var n,a,o,s,l,c,u,d,h,f;if(this._renderer){if(this._viewportMode===1&&this._frameView&&(this._frameView.frameSize=wVe.set(this._viewportWidth,this._viewportHeight)),i){let p=this._viewportWidth,v=this._viewportHeight;this._renderer.setSize(p-1,v-1,!1),this._renderer.setSize(p,v,!1)}else this._renderer.setSize(this._viewportWidth,this._viewportHeight,!1);if(this._camera=(n=this._scene)==null?void 0:n.activeCamera,(u=this._scene)==null||u.updateViewPlaneSize(((o=(a=this._frameView)==null?void 0:a.frameSize)==null?void 0:o.x)??this._viewportWidth,((l=(s=this._frameView)==null?void 0:s.frameSize)==null?void 0:l.y)??this._viewportHeight,((c=this._frameView)==null?void 0:c.enableResponsive)??!1),this._camera){let p=Object.values(((d=this._data)==null?void 0:d.frames)??{})[0].preset??"fullscreen";(h=this._frameView)==null||h.setCamera(this._camera),(f=this._frameView)==null||f.updateCamera(p!=="fullscreen"),this._camera.cameraType==="PerspectiveCamera"&&(this._camera.aspect=this._viewportWidth/this._viewportHeight),this._camera.updateProjectionMatrix()}this.eventManager&&(this.eventManager.eventContext.domRect=this.canvas.getBoundingClientRect()),this._requestRenderAutoMode()}},this._debouncedResize=gD(this._resize,10),this._onScroll=i=>{this.eventManager&&(this.eventManager.eventContext.domRect=this.canvas.getBoundingClientRect())},this.canvas=e,this.renderMode=t?"auto":r,this._renderedEvent=new CustomEvent("rendered",{bubbles:!0}),Object.defineProperty(this._renderedEvent,"target",{writable:!1,value:this}),window.location.search.includes("perfs")&&(this._perfs=new mVe({x:10,y:10})),XOe(e)}async load(e,t,r){SVe(e),this.disposed=!1;let i=await(await fetch(e,r)).arrayBuffer();await this.start(i,{variables:t})}async start(e,{interactive:t=!0,variables:r}={}){var l,c,u,d;if(this.disposed)return;let i=await Kje(e);this._data=i;let n=Qje(i);i.version&&(0,xVe.default)(i.version,"1.9.21")>0&&console.warn("Your .splinecode file is more recent than the library. Please upgrade @splinetool/runtime to the latest version."),await Promise.all([n.length&&Yje(),D4(i)&&kke(),NBe(i)&&Oke(),Ug.physicsEnabled(i.scene.objects)&&eRe(),M4(i)&&vBe(),aF(i)&&jNe(),pBe(i)&&fBe(),K4(i)&&z5e(),Rje(i)&&ZOe()].filter(Boolean)),n.length&&await Zje(n),(l=this._eventManager)==null||l.deactivate(),(c=this._controls)==null||c.deactivate(),(u=this._scene)==null||u.dispose();let a=new pVe(i);if(a.resetPersonalCameraFromDocumentData(),this._scene=a.scene,this._sharedAssetsManager=a.sharedAssets,this._camera=this._scene.activeCamera,window.location.search.includes("merge-geometries")){let h=performance.now();bVe(i,a.scene);let f=performance.now();console.log("Merged geometries in ",f-h," ms")}D4(i)&&this._scene.traverse(h=>{ic(h)&&h.recomputeBoolean()}),this._sharedAssetsManager.setRequestRender(()=>{var h;this._requestRenderAutoMode(),(h=this._scene)==null||h.traverse(f=>{f instanceof ds&&f.pendingMediaLoad&&f.update()})}),(d=this._scene)==null||d.traverse(h=>{h.type==="ParticleSystem"&&(h.wakeUp(),h.data.autoPlay?h.start():h.stop())});let o=Object.keys(i.shared.fonts).map(h=>this._sharedAssetsManager.getFont(h).loadingPromise);if(Promise.all(o).then(()=>{a.scene.markNeedsUpdateRendererDirty(),this._requestRenderAutoMode()}),M4(i)&&Vje(i)&&await Promise.all(o),K4(i)){let h=[];this._scene.traverseEntity(f=>{(f instanceof va||f instanceof Rn)&&f.uiCanvas&&h.push(f.uiCanvas)}),await Promise.all(h.map(f=>f.promise))}this._scene.rewriteEventsBeforeGoToPlayMode(),x3(this._scene.activePage,this._sharedAssetsManager),this._renderer||(this._renderer=new x5e({canvas:this.canvas,antialias:!1,alpha:!0,stencil:!1,depth:!1,powerPreference:"high-performance"}),this._renderer.hdTransmission=i.scene.publish.hdTransmission===!0,this._renderer.setPixelRatio(window.devicePixelRatio),this._renderer.pipeline.enableUIOverlay(),this._renderer.pipeline.addEventListener("smaaloaded",this._requestRenderAutoMode)),aF(i)&&this._scene.initializeSplatViewer(),i.scene.blueNoiseTextureData!==void 0&&this._renderer.pipeline.updateBlueNoiseTexture(i.scene.blueNoiseTextureData);let s=Object.values(i.frames)[0];if(this._frameView?this._frameView.setCamera(this._camera):(s.preset==="fullscreen"?(this._viewportMode=1,this.canvas.style.display="block",this.canvas.parentElement&&(this._viewportWidth=this.canvas.parentElement.clientWidth||300,this.canvas.style.width="100%"),this.canvas.parentElement&&(this._viewportHeight=this.canvas.parentElement.clientHeight||150,this.canvas.style.height="100%")):(this._viewportMode=2,this._viewportWidth=s.size[0],this._viewportHeight=s.size[1],this.canvas.style.width=`${this._viewportWidth}px`,this.canvas.style.height=`${this._viewportHeight}px`),this._renderer.setSize(this._viewportWidth,this._viewportHeight,!1),this._frameView=new hVe(this._renderer,this._camera,new ye(this._viewportWidth,this._viewportHeight),new ye(window.innerWidth,window.innerHeight)),this._frameView.enableResponsive=(s.allowResponsive??!1)&&s.preset==="fullscreen"),t){let h=new U6e(this._renderer,this.data.scene.publish,this._scene,()=>this._scene.activeCamera,this._sharedAssetsManager,this._requestRenderAutoMode,!0,s);this._scene.updateMatrixWorld(!0),this._controls=new Hje(h),this._animationControls=new Gje(this._scene,this._requestRenderAutoMode),this._eventManager=new dVe(i.scene.publish,this._controls,this._animationControls,h,i.shared.variables),this._eventManager.activate(),this._controls.activate(this._eventManager)}this._resize(),this._scene.activePage.data.postprocessing.depthOfField.enabled&&Promise.all(this._sharedAssetsManager.getImageLoadPromises()).then(()=>{this._resize(!0)}),r!==void 0&&this.setVariables(r),this.dt===0&&(this.render(performance.now()),setTimeout(()=>{var h;(h=this._renderer)==null||h.setAnimationLoop(this.render)},0)),this._resizeObserverTimeout=setTimeout(()=>{!this._resizeObserver&&this.canvas.parentElement&&(this._resizeObserver=new ResizeObserver(()=>{this._viewportWidth=this.canvas.clientWidth,this._viewportHeight=this.canvas.clientHeight,this._debouncedResize()}),this._resizeObserver.observe(this.canvas.parentElement))},300),document.addEventListener("scroll",this._onScroll)}setVariables(e){if(this._data!==void 0){let t=Object.entries(e);for(let[r,i]of t)this.setVariable(r,i)}}setVariable(e,t){var i;let r=this._getVariableByName(e);if(r&&!("dynamicVariableType"in r.data)){let n=t;typeof r.data.value=="number"?n=typeof t=="number"?t:typeof t=="boolean"?t===!0?1:0:parseFloat(t):typeof r.data.value=="boolean"?n=typeof t=="number"?!!t:typeof t=="boolean"?t:t.toLocaleLowerCase()==="false"?!1:!!t:typeof r.data.value!="string"&&r.data.value.textValue!==void 0&&(n=t.toString());let a=typeof n=="string"?{textValue:n}:n;(i=this._sharedAssetsManager)==null||i.updateVariable(r.id,a),this.requestRender(),this._requestRenderAutoMode()}else r===void 0?console.warn(`No variable named ${e} was found in your Spline file. Make sure to create it from Spline editor.`):"dynamicVariableType"in r.data&&console.warn(`Dynamic variables like ${e} cannot be updated from code.`)}getVariables(){let e={};return this._data&&this._data.shared.variables.forEach(t=>{e[t.data.name]===void 0&&(e[t.data.name]=this._getVariableValue(this._sharedAssetsManager.getVariable(t.id)))}),e}getVariable(e){let t=this._getVariableByName(e);if(t){let r=this._sharedAssetsManager.getVariable(t.id);return this._getVariableValue(r)}}_getVariableValue(e){return typeof e!="string"&&na.isTextValue(e)?na.getDisplayedValue(e):e}_getVariableByName(e){if(this._data){if(this._variablesCache.has(e))return this._variablesCache.get(e);let t=this._data.shared.variables.find(r=>r.data.name===e);return t&&this._variablesCache.set(e,t),t}}findObjectById(e){var r;let t=(r=this._scene)==null?void 0:r.getObjectByProperty("uuid",e);return this._createProxyObject(t)}findObjectByName(e){var r;let t=(r=this._scene)==null?void 0:r.getObjectByName(e);return this._createProxyObject(t)}getAllObjects(){var t;let e=[];return(t=this._scene)==null||t.traverseEntity(r=>{if(r.uuid!==gm&&!this._scene.isInvisibleObjects(r)&&!(r instanceof Rn)){let i=this._createProxyObject(r);i&&e.push(i)}}),e}getSplineEvents(){var e,t;return((t=(e=this._eventManager)==null?void 0:e.handlers)==null?void 0:t.Spline).splineEvents}emitEvent(e,t){var r;(r=this.findObjectById(t)||this.findObjectByName(t))==null||r.emitEvent(e)}emitEventReverse(e,t){var r;(r=this.findObjectById(t)||this.findObjectByName(t))==null||r.emitEventReverse(e)}addEventListener(e,t){this.canvas.addEventListener(e,t)}removeEventListener(e,t){this.canvas.removeEventListener(e,t)}setZoom(e){var t,r;((t=this._controls)==null?void 0:t.orbitControls)instanceof H7&&((r=this._controls)==null||r.orbitControls.setZoom(e))}get eventManager(){return this._eventManager}get controls(){return this._controls}setSize(e,t){this._viewportWidth=e,this._viewportHeight=t,this._viewportMode=2,this._resize()}setBackgroundColor(e){var o;let{r:t,g:r,b:i,a:n}={r:0,g:0,b:0,a:1},a=new sa(t,r,i,n);try{a.setStyle(e)}catch{console.error("This is not a valid css color",e)}(o=this._scene)==null||o.activePage.setBackgroundColor(a),this._requestRenderAutoMode()}dispose(){var e,t,r,i,n,a,o;this.disposed=!0,(e=this._eventManager)==null||e.deactivate(),(t=this._scene)==null||t.dispose(),(r=this._sharedAssetsManager)==null||r.dispose(),this._proxyObjectCache.forEach(s=>{Fk.unsubscribe(s)}),this._variablesCache.clear(),(i=this._renderer)==null||i.setAnimationLoop(null),(n=this._renderer)==null||n.dispose(),this._renderer=void 0,(a=this._sharedAssetsManager)==null||a.dispose(),this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=void 0),this._resizeObserverTimeout!==void 0&&clearTimeout(this._resizeObserverTimeout),this.canvas.style.width="",this.canvas.style.height="",this.canvas.removeAttribute("width"),this.canvas.removeAttribute("height"),this._frameView&&(this._frameView=void 0),(o=this._controls)==null||o.deactivate(),this.dt=0,KOe(this.canvas),document.removeEventListener("scroll",this._onScroll)}get isStopped(){return this._isPaused}stop(){var e,t,r;this._isPaused||((e=this._renderer)==null||e.setAnimationLoop(null),this._isPaused=!0,(t=this._eventManager)==null||t.pause(),(r=this._controls)!=null&&r.orbitControls&&(this._controls.orbitControls.enabled=!1))}play(){var e,t,r;!this._isPaused||(this._isPaused=!1,(e=this._eventManager)==null||e.resume(),(t=this._controls)!=null&&t.orbitControls&&(this._controls.orbitControls.enabled=!0),(r=this._renderer)==null||r.setAnimationLoop(this.render))}setGlobalEvents(e){var t;(t=this._eventManager)==null||t.updateUseWindowEvents(e)}get data(){return this._data}_createProxyObject(e){var n;if(e==null)return;if(this._proxyObjectCache.has(e.uuid))return this._proxyObjectCache.get(e.uuid);let t;e.traverseAncestors(a=>{a instanceof Rn&&(t=a.name)});let r={name:e.name,uuid:e.uuid,visible:e.visible,intensity:e.intensity,position:e.position,rotation:e.rotation,scale:e.scale,type:e.data.type,page:t,parentUuid:e.parent instanceof Rn||e instanceof s3||(n=e.parent)==null?void 0:n.uuid,emitEvent(a){e.dispatchEvent({type:"userEvent",eventName:a})},emitEventReverse(a){e.dispatchEvent({type:"userEvent",eventName:a,reverse:!0})}},i=Fk(r,(a,o)=>{var s;typeof e[a]!="object"&&((s=Object.getOwnPropertyDescriptor(e,a))!=null&&s.writable)&&(e[a]=o),this._requestRenderAutoMode(),e.updateMatrix()});return this._proxyObjectCache.set(e.uuid,i),i}setUIWasmUrl(e){h9.skiaWasmUrl=e}};const _Ve={class:"w-full h-full"},AVe=je({__name:"Spline",props:{url:{type:String,default:""},class:{type:String,default:""}},setup(e,{emit:t}){const r=e,i=t,n=me(),a=()=>{const o=new CVe(n.value);o.load(r.url).then(()=>{i("loaded",o)})};return Or(async()=>{a()}),(o,s)=>(ht(),Pt("div",_Ve,[st("canvas",{class:Bo(["canvas-3d",r.class]),ref_key:"ref3d",ref:n},null,2)]))}}),MVe={class:"main"},EVe={class:"container"},TVe={class:"content"},PVe=je({__name:"WaterCard",props:{to:{type:String,default:"/"},header:{type:String,default:"01"},title:{type:String,default:"Read More"},color:{type:String,default:"#ff0f5b"},class:{type:String,default:""}},setup(e){const t=e;return(r,i)=>{const n=Gu("RouterLink");return ht(),Pt("div",MVe,[st("div",EVe,[st("div",{class:Bo(["drop size-72 3xl:size-96 shadow-fancy-1",t.class]),style:yp(`--clr:${t.color};`)},[st("div",TVe,[st("h2",null,vi(t.header),1),st("p",null,[gs(r.$slots,"default",{},void 0,!0)]),Le(n,{to:t.to},{default:Je(()=>[Lr(vi(t.title),1)]),_:1},8,["to"])])],6)])])}}}),o5=xl(PVe,[["__scopeId","data-v-4236aaae"]]),DVe={class:"fixed z-10 top-0 left-0 right-0 h-[8vh] pt-3 px-3 shadow-sm"},OVe={class:"fixed flex flex-col py-16 md:flex-row inset-0 w-svw h-svh bg-fancy-gradient"},RVe={class:"flex flex-col flex-1"},IVe={class:"flex-1 flex justify-center items-center"},zVe={class:"flex-1 flex justify-center items-center"},kVe={class:"flex-1 hidden md:flex justify-center items-center"},LVe={class:"size-[32rem]"},BVe=je({__name:"HomeView",setup(e){const t=me(!1),r=me(""),i=()=>{window.matchMedia("(min-width: 1920px)").matches?r.value="3xl":window.matchMedia("(min-width: 1536px)").matches?r.value="2xl":window.matchMedia("(min-width: 1280px)").matches?r.value="xl":window.matchMedia("(min-width: 1024px)").matches?r.value="lg":window.matchMedia("(min-width: 768px)").matches?r.value="md":r.value="sm"};Or(()=>{i(),window.addEventListener("resize",i)}),Qg(()=>{window.removeEventListener("resize",i)});const n=a=>{console.log("spline loaded",a),a._camera.zoom=1,setTimeout(()=>{t.value=!0},500)};return(a,o)=>(ht(),Pt(mr,null,[st("div",DVe,[Le(bw)]),st("div",OVe,[st("div",RVe,[st("div",IVe,[Le(o5,{to:"/annotator",title:"Annotator",class:Bo("rounded-fancy-1")},{default:Je(()=>[Lr(" Clinical Description Annotator ")]),_:1})]),st("div",zVe,[Le(o5,{to:"/fhir",header:"02",title:"DigitalTWINs",class:Bo("rounded-fancy-2"),color:"#01b4ff"},{default:Je(()=>[Lr(" DigitalTWINs on FHIR ")]),_:1})])]),st("div",kVe,[io(st("div",LVe,[Le(AVe,{url:"https://prod.spline.design/82UMsxlOWfp8t2zQ/scene.splinecode",onLoaded:n,class:Bo("rounded-fancy-4 shadow-fancy-2 hover:rounded-full transition-all duration-500 ease-in-out")})],512),[[nh,t.value]])])])],64))}}),FVe=je({__name:"WorkflowView",setup(e){var u;const t=u0(),r=me(t.query.name),{root:i}=bl(cc()),n=me("Annotate"),a=me(0),o=me(0),s=me();s.value=(u=i.value)==null?void 0:u.children.filter(d=>d.name===r.value)[0];const l=s.value.children.filter(d=>{if(d.kind==="file"&&d.name.endsWith(".cwl"))return d});console.log("workflowDirectoryHandle",s.value),q0e(s.value.children[0]).then(d=>{console.log("data",d.steps);const h=Object.keys(d.steps);console.log("keys",h)});const c=d=>{n.value==="Annotate"?n.value="Submit":n.value="Annotate"};return(d,h)=>(ht(),Ci(Kj,{title:"Workflow Annotator",avatar:ze(Yj),annotator:n.value,subtitle:"Add descriptions for workflow",onUpdateAnnotator:c},{default:Je(()=>[Le(ze(np),{label:"Number of workflows",value:ze(l).length},null,8,["value"]),Le(ze(np),{label:"Number of goals",value:a.value},null,8,["value"]),Le(ze(np),{label:"Number of actions",value:o.value},null,8,["value"])]),_:1},8,["avatar","annotator"]))}}),s5=$ue({history:wue("/DigitalTWINonFHIRFrontend/"),routes:[{path:"/",name:"home",component:BVe},{path:"/annotator",name:"index-annotator",component:ume},{path:"/annotator",component:kpe,children:[{path:"/annotator",name:"home-annotator",component:Wpe},{path:"/measurements",name:"measurements",component:Rye},{path:"/workflow",name:"workflow",component:FVe},{path:"/primary/test",name:"annotatortest",component:Iye}]},{path:"/fhir",component:Uhe,children:[{path:"/fhir",name:"home-fhir",component:Que},{path:"/fhir/measurements",name:"fhir-measurements",component:Ppe,children:[{path:"/fhir/measurements/patients",name:"fhir-patients",component:Ipe}]}]},{path:"/error",name:"error",component:()=>Cc(()=>import("./index-9kxZT7cM.js"),[])}]});function NVe(e){e.use(s5).use(Vce),e.config.errorHandler=(t,r,i)=>{console.error("Global Error:",t,i),console.log("Instance:",r),s5.push("/error")}}const G7=Pq(zce);NVe(G7);G7.mount("#app");export{ci as B,Cre as E,_re as I,Bi as N,Ere as S,Pre as W,he as a,je as b,oe as c,$r as d,bt as e,re as f,Dr as g,E as h,Ze as i,Pt as j,Le as k,ze as l,Lr as m,a0 as n,ht as o,Eae as p,Gu as r,vr as u,Je as w};
