(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function r(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(n){if(n.ep)return;n.ep=!0;const a=r(n);fetch(n.href,a)}})();/**
* @vue/shared v3.4.31
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function AE(e,t){const r=new Set(e.split(","));return i=>r.has(i)}const xi={},If=[],Mo=()=>{},f9=()=>!1,d1=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),ME=e=>e.startsWith("onUpdate:"),Xi=Object.assign,EE=(e,t)=>{const r=e.indexOf(t);r>-1&&e.splice(r,1)},p9=Object.prototype.hasOwnProperty,Lr=(e,t)=>p9.call(e,t),Qt=Array.isArray,zf=e=>u1(e)==="[object Map]",nF=e=>u1(e)==="[object Set]",dr=e=>typeof e=="function",Ki=e=>typeof e=="string",Ed=e=>typeof e=="symbol",gi=e=>e!==null&&typeof e=="object",aF=e=>(gi(e)||dr(e))&&dr(e.then)&&dr(e.catch),oF=Object.prototype.toString,u1=e=>oF.call(e),m9=e=>u1(e).slice(8,-1),sF=e=>u1(e)==="[object Object]",TE=e=>Ki(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,sv=AE(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),h1=e=>{const t=Object.create(null);return r=>t[r]||(t[r]=e(r))},v9=/-(\w)/g,rl=h1(e=>e.replace(v9,(t,r)=>r?r.toUpperCase():"")),g9=/\B([A-Z])/g,Dp=h1(e=>e.replace(g9,"-$1").toLowerCase()),f1=h1(e=>e.charAt(0).toUpperCase()+e.slice(1)),ww=h1(e=>e?`on${f1(e)}`:""),gd=(e,t)=>!Object.is(e,t),Sw=(e,...t)=>{for(let r=0;r<e.length;r++)e[r](...t)},lF=(e,t,r,i=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:i,value:r})},y9=e=>{const t=parseFloat(e);return isNaN(t)?e:t},b9=e=>{const t=Ki(e)?Number(e):NaN;return isNaN(t)?e:t};let zD;const cF=()=>zD||(zD=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function tp(e){if(Qt(e)){const t={};for(let r=0;r<e.length;r++){const i=e[r],n=Ki(i)?C9(i):tp(i);if(n)for(const a in n)t[a]=n[a]}return t}else if(Ki(e)||gi(e))return e}const x9=/;(?![^(]*\))/g,w9=/:([^]+)/,S9=/\/\*[^]*?\*\//g;function C9(e){const t={};return e.replace(S9,"").split(x9).forEach(r=>{if(r){const i=r.split(w9);i.length>1&&(t[i[0].trim()]=i[1].trim())}}),t}function Do(e){let t="";if(Ki(e))t=e;else if(Qt(e))for(let r=0;r<e.length;r++){const i=Do(e[r]);i&&(t+=i+" ")}else if(gi(e))for(const r in e)e[r]&&(t+=r+" ");return t.trim()}const _9="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",A9=AE(_9);function dF(e){return!!e||e===""}const uF=e=>!!(e&&e.__v_isRef===!0),mi=e=>Ki(e)?e:e==null?"":Qt(e)||gi(e)&&(e.toString===oF||!dr(e.toString))?uF(e)?mi(e.value):JSON.stringify(e,hF,2):String(e),hF=(e,t)=>uF(t)?hF(e,t.value):zf(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((r,[i,n],a)=>(r[Cw(i,a)+" =>"]=n,r),{})}:nF(t)?{[`Set(${t.size})`]:[...t.values()].map(r=>Cw(r))}:Ed(t)?Cw(t):gi(t)&&!Qt(t)&&!sF(t)?String(t):t,Cw=(e,t="")=>{var r;return Ed(e)?`Symbol(${(r=e.description)!=null?r:t})`:e};/**
* @vue/reactivity v3.4.31
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let ao;class fF{constructor(t=!1){this.detached=t,this._active=!0,this.effects=[],this.cleanups=[],this.parent=ao,!t&&ao&&(this.index=(ao.scopes||(ao.scopes=[])).push(this)-1)}get active(){return this._active}run(t){if(this._active){const r=ao;try{return ao=this,t()}finally{ao=r}}}on(){ao=this}off(){ao=this.parent}stop(t){if(this._active){let r,i;for(r=0,i=this.effects.length;r<i;r++)this.effects[r].stop();for(r=0,i=this.cleanups.length;r<i;r++)this.cleanups[r]();if(this.scopes)for(r=0,i=this.scopes.length;r<i;r++)this.scopes[r].stop(!0);if(!this.detached&&this.parent&&!t){const n=this.parent.scopes.pop();n&&n!==this&&(this.parent.scopes[this.index]=n,n.index=this.index)}this.parent=void 0,this._active=!1}}}function pF(e){return new fF(e)}function M9(e,t=ao){t&&t.active&&t.effects.push(e)}function mF(){return ao}function E9(e){ao&&ao.cleanups.push(e)}let Ru;class PE{constructor(t,r,i,n){this.fn=t,this.trigger=r,this.scheduler=i,this.active=!0,this.deps=[],this._dirtyLevel=4,this._trackId=0,this._runnings=0,this._shouldSchedule=!1,this._depsLength=0,M9(this,n)}get dirty(){if(this._dirtyLevel===2||this._dirtyLevel===3){this._dirtyLevel=1,Td();for(let t=0;t<this._depsLength;t++){const r=this.deps[t];if(r.computed&&(T9(r.computed),this._dirtyLevel>=4))break}this._dirtyLevel===1&&(this._dirtyLevel=0),Pd()}return this._dirtyLevel>=4}set dirty(t){this._dirtyLevel=t?4:0}run(){if(this._dirtyLevel=0,!this.active)return this.fn();let t=ld,r=Ru;try{return ld=!0,Ru=this,this._runnings++,kD(this),this.fn()}finally{LD(this),this._runnings--,Ru=r,ld=t}}stop(){this.active&&(kD(this),LD(this),this.onStop&&this.onStop(),this.active=!1)}}function T9(e){return e.value}function kD(e){e._trackId++,e._depsLength=0}function LD(e){if(e.deps.length>e._depsLength){for(let t=e._depsLength;t<e.deps.length;t++)vF(e.deps[t],e);e.deps.length=e._depsLength}}function vF(e,t){const r=e.get(t);r!==void 0&&t._trackId!==r&&(e.delete(t),e.size===0&&e.cleanup())}let ld=!0,R_=0;const gF=[];function Td(){gF.push(ld),ld=!1}function Pd(){const e=gF.pop();ld=e===void 0?!0:e}function DE(){R_++}function OE(){for(R_--;!R_&&I_.length;)I_.shift()()}function yF(e,t,r){if(t.get(e)!==e._trackId){t.set(e,e._trackId);const i=e.deps[e._depsLength];i!==t?(i&&vF(i,e),e.deps[e._depsLength++]=t):e._depsLength++}}const I_=[];function bF(e,t,r){DE();for(const i of e.keys()){let n;i._dirtyLevel<t&&(n??(n=e.get(i)===i._trackId))&&(i._shouldSchedule||(i._shouldSchedule=i._dirtyLevel===0),i._dirtyLevel=t),i._shouldSchedule&&(n??(n=e.get(i)===i._trackId))&&(i.trigger(),(!i._runnings||i.allowRecurse)&&i._dirtyLevel!==2&&(i._shouldSchedule=!1,i.scheduler&&I_.push(i.scheduler)))}OE()}const xF=(e,t)=>{const r=new Map;return r.cleanup=e,r.computed=t,r},Ob=new WeakMap,Iu=Symbol(""),z_=Symbol("");function Xa(e,t,r){if(ld&&Ru){let i=Ob.get(e);i||Ob.set(e,i=new Map);let n=i.get(r);n||i.set(r,n=xF(()=>i.delete(r))),yF(Ru,n)}}function Xl(e,t,r,i,n,a){const o=Ob.get(e);if(!o)return;let s=[];if(t==="clear")s=[...o.values()];else if(r==="length"&&Qt(e)){const l=Number(i);o.forEach((c,d)=>{(d==="length"||!Ed(d)&&d>=l)&&s.push(c)})}else switch(r!==void 0&&s.push(o.get(r)),t){case"add":Qt(e)?TE(r)&&s.push(o.get("length")):(s.push(o.get(Iu)),zf(e)&&s.push(o.get(z_)));break;case"delete":Qt(e)||(s.push(o.get(Iu)),zf(e)&&s.push(o.get(z_)));break;case"set":zf(e)&&s.push(o.get(Iu));break}DE();for(const l of s)l&&bF(l,4);OE()}function P9(e,t){const r=Ob.get(e);return r&&r.get(t)}const D9=AE("__proto__,__v_isRef,__isVue"),wF=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(Ed)),BD=O9();function O9(){const e={};return["includes","indexOf","lastIndexOf"].forEach(t=>{e[t]=function(...r){const i=wr(this);for(let a=0,o=this.length;a<o;a++)Xa(i,"get",a+"");const n=i[t](...r);return n===-1||n===!1?i[t](...r.map(wr)):n}}),["push","pop","shift","unshift","splice"].forEach(t=>{e[t]=function(...r){Td(),DE();const i=wr(this)[t].apply(this,r);return OE(),Pd(),i}}),e}function R9(e){Ed(e)||(e=String(e));const t=wr(this);return Xa(t,"has",e),t.hasOwnProperty(e)}class SF{constructor(t=!1,r=!1){this._isReadonly=t,this._isShallow=r}get(t,r,i){const n=this._isReadonly,a=this._isShallow;if(r==="__v_isReactive")return!n;if(r==="__v_isReadonly")return n;if(r==="__v_isShallow")return a;if(r==="__v_raw")return i===(n?a?G9:MF:a?AF:_F).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(i)?t:void 0;const o=Qt(t);if(!n){if(o&&Lr(BD,r))return Reflect.get(BD,r,i);if(r==="hasOwnProperty")return R9}const s=Reflect.get(t,r,i);return(Ed(r)?wF.has(r):D9(r))||(n||Xa(t,"get",r),a)?s:Qi(s)?o&&TE(r)?s:s.value:gi(s)?n?rp(s):Dd(s):s}}class CF extends SF{constructor(t=!1){super(!1,t)}set(t,r,i,n){let a=t[r];if(!this._isShallow){const l=Lv(a);if(!Rb(i)&&!Lv(i)&&(a=wr(a),i=wr(i)),!Qt(t)&&Qi(a)&&!Qi(i))return l?!1:(a.value=i,!0)}const o=Qt(t)&&TE(r)?Number(r)<t.length:Lr(t,r),s=Reflect.set(t,r,i,n);return t===wr(n)&&(o?gd(i,a)&&Xl(t,"set",r,i):Xl(t,"add",r,i)),s}deleteProperty(t,r){const i=Lr(t,r);t[r];const n=Reflect.deleteProperty(t,r);return n&&i&&Xl(t,"delete",r,void 0),n}has(t,r){const i=Reflect.has(t,r);return(!Ed(r)||!wF.has(r))&&Xa(t,"has",r),i}ownKeys(t){return Xa(t,"iterate",Qt(t)?"length":Iu),Reflect.ownKeys(t)}}class I9 extends SF{constructor(t=!1){super(!0,t)}set(t,r){return!0}deleteProperty(t,r){return!0}}const z9=new CF,k9=new I9,L9=new CF(!0);const RE=e=>e,p1=e=>Reflect.getPrototypeOf(e);function o0(e,t,r=!1,i=!1){e=e.__v_raw;const n=wr(e),a=wr(t);r||(gd(t,a)&&Xa(n,"get",t),Xa(n,"get",a));const{has:o}=p1(n),s=i?RE:r?LE:Bv;if(o.call(n,t))return s(e.get(t));if(o.call(n,a))return s(e.get(a));e!==n&&e.get(t)}function s0(e,t=!1){const r=this.__v_raw,i=wr(r),n=wr(e);return t||(gd(e,n)&&Xa(i,"has",e),Xa(i,"has",n)),e===n?r.has(e):r.has(e)||r.has(n)}function l0(e,t=!1){return e=e.__v_raw,!t&&Xa(wr(e),"iterate",Iu),Reflect.get(e,"size",e)}function FD(e){e=wr(e);const t=wr(this);return p1(t).has.call(t,e)||(t.add(e),Xl(t,"add",e,e)),this}function ND(e,t){t=wr(t);const r=wr(this),{has:i,get:n}=p1(r);let a=i.call(r,e);a||(e=wr(e),a=i.call(r,e));const o=n.call(r,e);return r.set(e,t),a?gd(t,o)&&Xl(r,"set",e,t):Xl(r,"add",e,t),this}function UD(e){const t=wr(this),{has:r,get:i}=p1(t);let n=r.call(t,e);n||(e=wr(e),n=r.call(t,e)),i&&i.call(t,e);const a=t.delete(e);return n&&Xl(t,"delete",e,void 0),a}function jD(){const e=wr(this),t=e.size!==0,r=e.clear();return t&&Xl(e,"clear",void 0,void 0),r}function c0(e,t){return function(i,n){const a=this,o=a.__v_raw,s=wr(o),l=t?RE:e?LE:Bv;return!e&&Xa(s,"iterate",Iu),o.forEach((c,d)=>i.call(n,l(c),l(d),a))}}function d0(e,t,r){return function(...i){const n=this.__v_raw,a=wr(n),o=zf(a),s=e==="entries"||e===Symbol.iterator&&o,l=e==="keys"&&o,c=n[e](...i),d=r?RE:t?LE:Bv;return!t&&Xa(a,"iterate",l?z_:Iu),{next(){const{value:u,done:h}=c.next();return h?{value:u,done:h}:{value:s?[d(u[0]),d(u[1])]:d(u),done:h}},[Symbol.iterator](){return this}}}}function vc(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function B9(){const e={get(a){return o0(this,a)},get size(){return l0(this)},has:s0,add:FD,set:ND,delete:UD,clear:jD,forEach:c0(!1,!1)},t={get(a){return o0(this,a,!1,!0)},get size(){return l0(this)},has:s0,add:FD,set:ND,delete:UD,clear:jD,forEach:c0(!1,!0)},r={get(a){return o0(this,a,!0)},get size(){return l0(this,!0)},has(a){return s0.call(this,a,!0)},add:vc("add"),set:vc("set"),delete:vc("delete"),clear:vc("clear"),forEach:c0(!0,!1)},i={get(a){return o0(this,a,!0,!0)},get size(){return l0(this,!0)},has(a){return s0.call(this,a,!0)},add:vc("add"),set:vc("set"),delete:vc("delete"),clear:vc("clear"),forEach:c0(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(a=>{e[a]=d0(a,!1,!1),r[a]=d0(a,!0,!1),t[a]=d0(a,!1,!0),i[a]=d0(a,!0,!0)}),[e,r,t,i]}const[F9,N9,U9,j9]=B9();function IE(e,t){const r=t?e?j9:U9:e?N9:F9;return(i,n,a)=>n==="__v_isReactive"?!e:n==="__v_isReadonly"?e:n==="__v_raw"?i:Reflect.get(Lr(r,n)&&n in i?r:i,n,a)}const V9={get:IE(!1,!1)},H9={get:IE(!1,!0)},W9={get:IE(!0,!1)};const _F=new WeakMap,AF=new WeakMap,MF=new WeakMap,G9=new WeakMap;function $9(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function q9(e){return e.__v_skip||!Object.isExtensible(e)?0:$9(m9(e))}function Dd(e){return Lv(e)?e:zE(e,!1,z9,V9,_F)}function EF(e){return zE(e,!1,L9,H9,AF)}function rp(e){return zE(e,!0,k9,W9,MF)}function zE(e,t,r,i,n){if(!gi(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const a=n.get(e);if(a)return a;const o=q9(e);if(o===0)return e;const s=new Proxy(e,o===2?i:r);return n.set(e,s),s}function cd(e){return Lv(e)?cd(e.__v_raw):!!(e&&e.__v_isReactive)}function Lv(e){return!!(e&&e.__v_isReadonly)}function Rb(e){return!!(e&&e.__v_isShallow)}function lv(e){return e?!!e.__v_raw:!1}function wr(e){const t=e&&e.__v_raw;return t?wr(t):e}function kE(e){return Object.isExtensible(e)&&lF(e,"__v_skip",!0),e}const Bv=e=>gi(e)?Dd(e):e,LE=e=>gi(e)?rp(e):e;class TF{constructor(t,r,i,n){this.getter=t,this._setter=r,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this.effect=new PE(()=>t(this._value),()=>ib(this,this.effect._dirtyLevel===2?2:3)),this.effect.computed=this,this.effect.active=this._cacheable=!n,this.__v_isReadonly=i}get value(){const t=wr(this);return(!t._cacheable||t.effect.dirty)&&gd(t._value,t._value=t.effect.run())&&ib(t,4),PF(t),t.effect._dirtyLevel>=2&&ib(t,2),t._value}set value(t){this._setter(t)}get _dirty(){return this.effect.dirty}set _dirty(t){this.effect.dirty=t}}function Y9(e,t,r=!1){let i,n;const a=dr(e);return a?(i=e,n=Mo):(i=e.get,n=e.set),new TF(i,n,a||!n,r)}function PF(e){var t;ld&&Ru&&(e=wr(e),yF(Ru,(t=e.dep)!=null?t:e.dep=xF(()=>e.dep=void 0,e instanceof TF?e:void 0)))}function ib(e,t=4,r,i){e=wr(e);const n=e.dep;n&&bF(n,t)}function Qi(e){return!!(e&&e.__v_isRef===!0)}function ge(e){return OF(e,!1)}function DF(e){return OF(e,!0)}function OF(e,t){return Qi(e)?e:new X9(e,t)}class X9{constructor(t,r){this.__v_isShallow=r,this.dep=void 0,this.__v_isRef=!0,this._rawValue=r?t:wr(t),this._value=r?t:Bv(t)}get value(){return PF(this),this._value}set value(t){const r=this.__v_isShallow||Rb(t)||Lv(t);t=r?t:wr(t),gd(t,this._rawValue)&&(this._rawValue,this._rawValue=t,this._value=r?t:Bv(t),ib(this,4))}}function ke(e){return Qi(e)?e.value:e}const K9={get:(e,t,r)=>ke(Reflect.get(e,t,r)),set:(e,t,r,i)=>{const n=e[t];return Qi(n)&&!Qi(r)?(n.value=r,!0):Reflect.set(e,t,r,i)}};function RF(e){return cd(e)?e:new Proxy(e,K9)}function IF(e){const t=Qt(e)?new Array(e.length):{};for(const r in e)t[r]=zF(e,r);return t}class Q9{constructor(t,r,i){this._object=t,this._key=r,this._defaultValue=i,this.__v_isRef=!0}get value(){const t=this._object[this._key];return t===void 0?this._defaultValue:t}set value(t){this._object[this._key]=t}get dep(){return P9(wr(this._object),this._key)}}class Z9{constructor(t){this._getter=t,this.__v_isRef=!0,this.__v_isReadonly=!0}get value(){return this._getter()}}function pt(e,t,r){return Qi(e)?e:dr(e)?new Z9(e):gi(e)&&arguments.length>1?zF(e,t,r):ge(e)}function zF(e,t,r){const i=e[t];return Qi(i)?i:new Q9(e,t,r)}/**
* @vue/runtime-core v3.4.31
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function dd(e,t,r,i){try{return i?e(...i):e()}catch(n){m1(n,t,r)}}function Oo(e,t,r,i){if(dr(e)){const n=dd(e,t,r,i);return n&&aF(n)&&n.catch(a=>{m1(a,t,r)}),n}if(Qt(e)){const n=[];for(let a=0;a<e.length;a++)n.push(Oo(e[a],t,r,i));return n}}function m1(e,t,r,i=!0){const n=t?t.vnode:null;if(t){let a=t.parent;const o=t.proxy,s=`https://vuejs.org/error-reference/#runtime-${r}`;for(;a;){const c=a.ec;if(c){for(let d=0;d<c.length;d++)if(c[d](e,o,s)===!1)return}a=a.parent}const l=t.appContext.config.errorHandler;if(l){Td(),dd(l,null,10,[e,o,s]),Pd();return}}J9(e,r,n,i)}function J9(e,t,r,i=!0){console.error(e)}let Fv=!1,k_=!1;const ua=[];let Us=0;const kf=[];let Uc=null,cu=0;const kF=Promise.resolve();let BE=null;function ra(e){const t=BE||kF;return e?t.then(this?e.bind(this):e):t}function e7(e){let t=Us+1,r=ua.length;for(;t<r;){const i=t+r>>>1,n=ua[i],a=Nv(n);a<e||a===e&&n.pre?t=i+1:r=i}return t}function FE(e){(!ua.length||!ua.includes(e,Fv&&e.allowRecurse?Us+1:Us))&&(e.id==null?ua.push(e):ua.splice(e7(e.id),0,e),LF())}function LF(){!Fv&&!k_&&(k_=!0,BE=kF.then(FF))}function t7(e){const t=ua.indexOf(e);t>Us&&ua.splice(t,1)}function r7(e){Qt(e)?kf.push(...e):(!Uc||!Uc.includes(e,e.allowRecurse?cu+1:cu))&&kf.push(e),LF()}function VD(e,t,r=Fv?Us+1:0){for(;r<ua.length;r++){const i=ua[r];if(i&&i.pre){if(e&&i.id!==e.uid)continue;ua.splice(r,1),r--,i()}}}function BF(e){if(kf.length){const t=[...new Set(kf)].sort((r,i)=>Nv(r)-Nv(i));if(kf.length=0,Uc){Uc.push(...t);return}for(Uc=t,cu=0;cu<Uc.length;cu++){const r=Uc[cu];r.active!==!1&&r()}Uc=null,cu=0}}const Nv=e=>e.id==null?1/0:e.id,i7=(e,t)=>{const r=Nv(e)-Nv(t);if(r===0){if(e.pre&&!t.pre)return-1;if(t.pre&&!e.pre)return 1}return r};function FF(e){k_=!1,Fv=!0,ua.sort(i7);try{for(Us=0;Us<ua.length;Us++){const t=ua[Us];t&&t.active!==!1&&dd(t,null,14)}}finally{Us=0,ua.length=0,BF(),Fv=!1,BE=null,(ua.length||kf.length)&&FF()}}function n7(e,t,...r){if(e.isUnmounted)return;const i=e.vnode.props||xi;let n=r;const a=t.startsWith("update:"),o=a&&t.slice(7);if(o&&o in i){const d=`${o==="modelValue"?"model":o}Modifiers`,{number:u,trim:h}=i[d]||xi;h&&(n=r.map(f=>Ki(f)?f.trim():f)),u&&(n=r.map(y9))}let s,l=i[s=ww(t)]||i[s=ww(rl(t))];!l&&a&&(l=i[s=ww(Dp(t))]),l&&Oo(l,e,6,n);const c=i[s+"Once"];if(c){if(!e.emitted)e.emitted={};else if(e.emitted[s])return;e.emitted[s]=!0,Oo(c,e,6,n)}}function NF(e,t,r=!1){const i=t.emitsCache,n=i.get(e);if(n!==void 0)return n;const a=e.emits;let o={},s=!1;if(!dr(e)){const l=c=>{const d=NF(c,t,!0);d&&(s=!0,Xi(o,d))};!r&&t.mixins.length&&t.mixins.forEach(l),e.extends&&l(e.extends),e.mixins&&e.mixins.forEach(l)}return!a&&!s?(gi(e)&&i.set(e,null),null):(Qt(a)?a.forEach(l=>o[l]=null):Xi(o,a),gi(e)&&i.set(e,o),o)}function v1(e,t){return!e||!d1(t)?!1:(t=t.slice(2).replace(/Once$/,""),Lr(e,t[0].toLowerCase()+t.slice(1))||Lr(e,Dp(t))||Lr(e,t))}let yn=null,g1=null;function Ib(e){const t=yn;return yn=e,g1=e&&e.type.__scopeId||null,t}function NE(e){g1=e}function UE(){g1=null}function tt(e,t=yn,r){if(!t||e._n)return e;const i=(...n)=>{i._d&&i3(-1);const a=Ib(t);let o;try{o=e(...n)}finally{Ib(a),i._d&&i3(1)}return o};return i._n=!0,i._c=!0,i._d=!0,i}function _w(e){const{type:t,vnode:r,proxy:i,withProxy:n,propsOptions:[a],slots:o,attrs:s,emit:l,render:c,renderCache:d,props:u,data:h,setupState:f,ctx:p,inheritAttrs:v}=e,m=Ib(e);let g,y;try{if(r.shapeFlag&4){const x=n||i,S=x;g=Bs(c.call(S,x,d,u,f,h,p)),y=s}else{const x=t;g=Bs(x.length>1?x(u,{attrs:s,slots:o,emit:l}):x(u,null)),y=t.props?s:a7(s)}}catch(x){hv.length=0,m1(x,e,1),g=Be(On)}let b=g;if(y&&v!==!1){const x=Object.keys(y),{shapeFlag:S}=b;x.length&&S&7&&(a&&x.some(ME)&&(y=o7(y,a)),b=nl(b,y,!1,!0))}return r.dirs&&(b=nl(b,null,!1,!0),b.dirs=b.dirs?b.dirs.concat(r.dirs):r.dirs),r.transition&&(b.transition=r.transition),g=b,Ib(m),g}const a7=e=>{let t;for(const r in e)(r==="class"||r==="style"||d1(r))&&((t||(t={}))[r]=e[r]);return t},o7=(e,t)=>{const r={};for(const i in e)(!ME(i)||!(i.slice(9)in t))&&(r[i]=e[i]);return r};function s7(e,t,r){const{props:i,children:n,component:a}=e,{props:o,children:s,patchFlag:l}=t,c=a.emitsOptions;if(t.dirs||t.transition)return!0;if(r&&l>=0){if(l&1024)return!0;if(l&16)return i?HD(i,o,c):!!o;if(l&8){const d=t.dynamicProps;for(let u=0;u<d.length;u++){const h=d[u];if(o[h]!==i[h]&&!v1(c,h))return!0}}}else return(n||s)&&(!s||!s.$stable)?!0:i===o?!1:i?o?HD(i,o,c):!0:!!o;return!1}function HD(e,t,r){const i=Object.keys(t);if(i.length!==Object.keys(e).length)return!0;for(let n=0;n<i.length;n++){const a=i[n];if(t[a]!==e[a]&&!v1(r,a))return!0}return!1}function l7({vnode:e,parent:t},r){for(;t;){const i=t.subTree;if(i.suspense&&i.suspense.activeBranch===e&&(i.el=e.el),i===e)(e=t.vnode).el=r,t=t.parent;else break}}const c7="components";function Od(e,t){return u7(c7,e,!0,t)||e}const d7=Symbol.for("v-ndc");function u7(e,t,r=!0,i=!1){const n=yn||Rn;if(n){const a=n.type;{const s=iG(a,!1);if(s&&(s===t||s===rl(t)||s===f1(rl(t))))return a}const o=WD(n[e]||a[e],t)||WD(n.appContext[e],t);return!o&&i?a:o}}function WD(e,t){return e&&(e[t]||e[rl(t)]||e[f1(rl(t))])}const h7=e=>e.__isSuspense;function f7(e,t){t&&t.pendingBranch?Qt(e)?t.effects.push(...e):t.effects.push(e):r7(e)}function y1(e,t,r=Rn,i=!1){if(r){const n=r[e]||(r[e]=[]),a=t.__weh||(t.__weh=(...o)=>{Td();const s=Pg(r),l=Oo(t,r,e,o);return s(),Pd(),l});return i?n.unshift(a):n.push(a),a}}const sc=e=>(t,r=Rn)=>{(!w1||e==="sp")&&y1(e,(...i)=>t(...i),r)},Mg=sc("bm"),Or=sc("m"),p7=sc("bu"),UF=sc("u"),na=sc("bum"),Eg=sc("um"),m7=sc("sp"),v7=sc("rtg"),g7=sc("rtc");function y7(e,t=Rn){y1("ec",e,t)}function Ka(e,t){if(yn===null)return e;const r=S1(yn),i=e.dirs||(e.dirs=[]);for(let n=0;n<t.length;n++){let[a,o,s,l=xi]=t[n];a&&(dr(a)&&(a={mounted:a,updated:a}),a.deep&&qc(o),i.push({dir:a,instance:r,value:o,oldValue:void 0,arg:s,modifiers:l}))}return e}function Vd(e,t,r,i){const n=e.dirs,a=t&&t.dirs;for(let o=0;o<n.length;o++){const s=n[o];a&&(s.oldValue=a[o].value);let l=s.dir[i];l&&(Td(),Oo(l,r,8,[e.el,s,e,t]),Pd())}}function cs(e,t,r,i){let n;const a=r;if(Qt(e)||Ki(e)){n=new Array(e.length);for(let o=0,s=e.length;o<s;o++)n[o]=t(e[o],o,void 0,a)}else if(typeof e=="number"){n=new Array(e);for(let o=0;o<e;o++)n[o]=t(o+1,o,void 0,a)}else if(gi(e))if(e[Symbol.iterator])n=Array.from(e,(o,s)=>t(o,s,void 0,a));else{const o=Object.keys(e);n=new Array(o.length);for(let s=0,l=o.length;s<l;s++){const c=o[s];n[s]=t(e[c],c,s,a)}}else n=[];return n}function b7(e,t){for(let r=0;r<t.length;r++){const i=t[r];if(Qt(i))for(let n=0;n<i.length;n++)e[i[n].name]=i[n].fn;else i&&(e[i.name]=i.key?(...n)=>{const a=i.fn(...n);return a&&(a.key=i.key),a}:i.fn)}return e}/*! #__NO_SIDE_EFFECTS__ */function Ve(e,t){return dr(e)?Xi({name:e.name},t,{setup:e}):e}const cv=e=>!!e.type.__asyncLoader;function il(e,t,r={},i,n){if(yn.isCE||yn.parent&&cv(yn.parent)&&yn.parent.isCE)return t!=="default"&&(r.name=t),Be("slot",r,i);let a=e[t];a&&a._c&&(a._d=!1),ft();const o=a&&jF(a(r)),s=Ei(pr,{key:r.key||o&&o.key||`_${t}`},o||[],o&&e._===1?64:-2);return!n&&s.scopeId&&(s.slotScopeIds=[s.scopeId+"-s"]),a&&a._c&&(a._d=!0),s}function jF(e){return e.some(t=>Vv(t)?!(t.type===On||t.type===pr&&!jF(t.children)):!0)?e:null}const L_=e=>e?c5(e)?S1(e):L_(e.parent):null,dv=Xi(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>L_(e.parent),$root:e=>L_(e.root),$emit:e=>e.emit,$options:e=>jE(e),$forceUpdate:e=>e.f||(e.f=()=>{e.effect.dirty=!0,FE(e.update)}),$nextTick:e=>e.n||(e.n=ra.bind(e.proxy)),$watch:e=>U7.bind(e)}),Aw=(e,t)=>e!==xi&&!e.__isScriptSetup&&Lr(e,t),x7={get({_:e},t){if(t==="__v_skip")return!0;const{ctx:r,setupState:i,data:n,props:a,accessCache:o,type:s,appContext:l}=e;let c;if(t[0]!=="$"){const f=o[t];if(f!==void 0)switch(f){case 1:return i[t];case 2:return n[t];case 4:return r[t];case 3:return a[t]}else{if(Aw(i,t))return o[t]=1,i[t];if(n!==xi&&Lr(n,t))return o[t]=2,n[t];if((c=e.propsOptions[0])&&Lr(c,t))return o[t]=3,a[t];if(r!==xi&&Lr(r,t))return o[t]=4,r[t];B_&&(o[t]=0)}}const d=dv[t];let u,h;if(d)return t==="$attrs"&&Xa(e.attrs,"get",""),d(e);if((u=s.__cssModules)&&(u=u[t]))return u;if(r!==xi&&Lr(r,t))return o[t]=4,r[t];if(h=l.config.globalProperties,Lr(h,t))return h[t]},set({_:e},t,r){const{data:i,setupState:n,ctx:a}=e;return Aw(n,t)?(n[t]=r,!0):i!==xi&&Lr(i,t)?(i[t]=r,!0):Lr(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(a[t]=r,!0)},has({_:{data:e,setupState:t,accessCache:r,ctx:i,appContext:n,propsOptions:a}},o){let s;return!!r[o]||e!==xi&&Lr(e,o)||Aw(t,o)||(s=a[0])&&Lr(s,o)||Lr(i,o)||Lr(dv,o)||Lr(n.config.globalProperties,o)},defineProperty(e,t,r){return r.get!=null?e._.accessCache[t]=0:Lr(r,"value")&&this.set(e,t,r.value,null),Reflect.defineProperty(e,t,r)}};function GD(e){return Qt(e)?e.reduce((t,r)=>(t[r]=null,t),{}):e}let B_=!0;function w7(e){const t=jE(e),r=e.proxy,i=e.ctx;B_=!1,t.beforeCreate&&$D(t.beforeCreate,e,"bc");const{data:n,computed:a,methods:o,watch:s,provide:l,inject:c,created:d,beforeMount:u,mounted:h,beforeUpdate:f,updated:p,activated:v,deactivated:m,beforeDestroy:g,beforeUnmount:y,destroyed:b,unmounted:x,render:S,renderTracked:w,renderTriggered:_,errorCaptured:C,serverPrefetch:A,expose:M,inheritAttrs:P,components:T,directives:R,filters:z}=t;if(c&&S7(c,i,null),o)for(const N in o){const U=o[N];dr(U)&&(i[N]=U.bind(r))}if(n){const N=n.call(r,r);gi(N)&&(e.data=Dd(N))}if(B_=!0,a)for(const N in a){const U=a[N],ie=dr(U)?U.bind(r,r):dr(U.get)?U.get.bind(r,r):Mo,te=!dr(U)&&dr(U.set)?U.set.bind(r):Mo,X=re({get:ie,set:te});Object.defineProperty(i,N,{enumerable:!0,configurable:!0,get:()=>X.value,set:W=>X.value=W})}if(s)for(const N in s)VF(s[N],i,r,N);if(l){const N=dr(l)?l.call(r):l;Reflect.ownKeys(N).forEach(U=>{br(U,N[U])})}d&&$D(d,e,"c");function H(N,U){Qt(U)?U.forEach(ie=>N(ie.bind(r))):U&&N(U.bind(r))}if(H(Mg,u),H(Or,h),H(p7,f),H(UF,p),H(GE,v),H($E,m),H(y7,C),H(g7,w),H(v7,_),H(na,y),H(Eg,x),H(m7,A),Qt(M))if(M.length){const N=e.exposed||(e.exposed={});M.forEach(U=>{Object.defineProperty(N,U,{get:()=>r[U],set:ie=>r[U]=ie})})}else e.exposed||(e.exposed={});S&&e.render===Mo&&(e.render=S),P!=null&&(e.inheritAttrs=P),T&&(e.components=T),R&&(e.directives=R)}function S7(e,t,r=Mo){Qt(e)&&(e=F_(e));for(const i in e){const n=e[i];let a;gi(n)?"default"in n?a=_t(n.from||i,n.default,!0):a=_t(n.from||i):a=_t(n),Qi(a)?Object.defineProperty(t,i,{enumerable:!0,configurable:!0,get:()=>a.value,set:o=>a.value=o}):t[i]=a}}function $D(e,t,r){Oo(Qt(e)?e.map(i=>i.bind(t.proxy)):e.bind(t.proxy),t,r)}function VF(e,t,r,i){const n=i.includes(".")?JF(r,i):()=>r[i];if(Ki(e)){const a=t[e];dr(a)&&tr(n,a)}else if(dr(e))tr(n,e.bind(r));else if(gi(e))if(Qt(e))e.forEach(a=>VF(a,t,r,i));else{const a=dr(e.handler)?e.handler.bind(r):t[e.handler];dr(a)&&tr(n,a,e)}}function jE(e){const t=e.type,{mixins:r,extends:i}=t,{mixins:n,optionsCache:a,config:{optionMergeStrategies:o}}=e.appContext,s=a.get(t);let l;return s?l=s:!n.length&&!r&&!i?l=t:(l={},n.length&&n.forEach(c=>zb(l,c,o,!0)),zb(l,t,o)),gi(t)&&a.set(t,l),l}function zb(e,t,r,i=!1){const{mixins:n,extends:a}=t;a&&zb(e,a,r,!0),n&&n.forEach(o=>zb(e,o,r,!0));for(const o in t)if(!(i&&o==="expose")){const s=C7[o]||r&&r[o];e[o]=s?s(e[o],t[o]):t[o]}return e}const C7={data:qD,props:YD,emits:YD,methods:qm,computed:qm,beforeCreate:Sa,created:Sa,beforeMount:Sa,mounted:Sa,beforeUpdate:Sa,updated:Sa,beforeDestroy:Sa,beforeUnmount:Sa,destroyed:Sa,unmounted:Sa,activated:Sa,deactivated:Sa,errorCaptured:Sa,serverPrefetch:Sa,components:qm,directives:qm,watch:A7,provide:qD,inject:_7};function qD(e,t){return t?e?function(){return Xi(dr(e)?e.call(this,this):e,dr(t)?t.call(this,this):t)}:t:e}function _7(e,t){return qm(F_(e),F_(t))}function F_(e){if(Qt(e)){const t={};for(let r=0;r<e.length;r++)t[e[r]]=e[r];return t}return e}function Sa(e,t){return e?[...new Set([].concat(e,t))]:t}function qm(e,t){return e?Xi(Object.create(null),e,t):t}function YD(e,t){return e?Qt(e)&&Qt(t)?[...new Set([...e,...t])]:Xi(Object.create(null),GD(e),GD(t??{})):t}function A7(e,t){if(!e)return t;if(!t)return e;const r=Xi(Object.create(null),e);for(const i in t)r[i]=Sa(e[i],t[i]);return r}function HF(){return{app:null,config:{isNativeTag:f9,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let M7=0;function E7(e,t){return function(i,n=null){dr(i)||(i=Xi({},i)),n!=null&&!gi(n)&&(n=null);const a=HF(),o=new WeakSet;let s=!1;const l=a.app={_uid:M7++,_component:i,_props:n,_container:null,_context:a,_instance:null,version:aG,get config(){return a.config},set config(c){},use(c,...d){return o.has(c)||(c&&dr(c.install)?(o.add(c),c.install(l,...d)):dr(c)&&(o.add(c),c(l,...d))),l},mixin(c){return a.mixins.includes(c)||a.mixins.push(c),l},component(c,d){return d?(a.components[c]=d,l):a.components[c]},directive(c,d){return d?(a.directives[c]=d,l):a.directives[c]},mount(c,d,u){if(!s){const h=Be(i,n);return h.appContext=a,u===!0?u="svg":u===!1&&(u=void 0),d&&t?t(h,c):e(h,c,u),s=!0,l._container=c,c.__vue_app__=l,S1(h.component)}},unmount(){s&&(e(null,l._container),delete l._container.__vue_app__)},provide(c,d){return a.provides[c]=d,l},runWithContext(c){const d=Lf;Lf=l;try{return c()}finally{Lf=d}}};return l}}let Lf=null;function br(e,t){if(Rn){let r=Rn.provides;const i=Rn.parent&&Rn.parent.provides;i===r&&(r=Rn.provides=Object.create(i)),r[e]=t}}function _t(e,t,r=!1){const i=Rn||yn;if(i||Lf){const n=i?i.parent==null?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides:Lf._context.provides;if(n&&e in n)return n[e];if(arguments.length>1)return r&&dr(t)?t.call(i&&i.proxy):t}}function T7(){return!!(Rn||yn||Lf)}const WF={},GF=()=>Object.create(WF),$F=e=>Object.getPrototypeOf(e)===WF;function P7(e,t,r,i=!1){const n={},a=GF();e.propsDefaults=Object.create(null),qF(e,t,n,a);for(const o in e.propsOptions[0])o in n||(n[o]=void 0);r?e.props=i?n:EF(n):e.type.props?e.props=n:e.props=a,e.attrs=a}function D7(e,t,r,i){const{props:n,attrs:a,vnode:{patchFlag:o}}=e,s=wr(n),[l]=e.propsOptions;let c=!1;if((i||o>0)&&!(o&16)){if(o&8){const d=e.vnode.dynamicProps;for(let u=0;u<d.length;u++){let h=d[u];if(v1(e.emitsOptions,h))continue;const f=t[h];if(l)if(Lr(a,h))f!==a[h]&&(a[h]=f,c=!0);else{const p=rl(h);n[p]=N_(l,s,p,f,e,!1)}else f!==a[h]&&(a[h]=f,c=!0)}}}else{qF(e,t,n,a)&&(c=!0);let d;for(const u in s)(!t||!Lr(t,u)&&((d=Dp(u))===u||!Lr(t,d)))&&(l?r&&(r[u]!==void 0||r[d]!==void 0)&&(n[u]=N_(l,s,u,void 0,e,!0)):delete n[u]);if(a!==s)for(const u in a)(!t||!Lr(t,u))&&(delete a[u],c=!0)}c&&Xl(e.attrs,"set","")}function qF(e,t,r,i){const[n,a]=e.propsOptions;let o=!1,s;if(t)for(let l in t){if(sv(l))continue;const c=t[l];let d;n&&Lr(n,d=rl(l))?!a||!a.includes(d)?r[d]=c:(s||(s={}))[d]=c:v1(e.emitsOptions,l)||(!(l in i)||c!==i[l])&&(i[l]=c,o=!0)}if(a){const l=wr(r),c=s||xi;for(let d=0;d<a.length;d++){const u=a[d];r[u]=N_(n,l,u,c[u],e,!Lr(c,u))}}return o}function N_(e,t,r,i,n,a){const o=e[r];if(o!=null){const s=Lr(o,"default");if(s&&i===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&dr(l)){const{propsDefaults:c}=n;if(r in c)i=c[r];else{const d=Pg(n);i=c[r]=l.call(null,t),d()}}else i=l}o[0]&&(a&&!s?i=!1:o[1]&&(i===""||i===Dp(r))&&(i=!0))}return i}function YF(e,t,r=!1){const i=t.propsCache,n=i.get(e);if(n)return n;const a=e.props,o={},s=[];let l=!1;if(!dr(e)){const d=u=>{l=!0;const[h,f]=YF(u,t,!0);Xi(o,h),f&&s.push(...f)};!r&&t.mixins.length&&t.mixins.forEach(d),e.extends&&d(e.extends),e.mixins&&e.mixins.forEach(d)}if(!a&&!l)return gi(e)&&i.set(e,If),If;if(Qt(a))for(let d=0;d<a.length;d++){const u=rl(a[d]);XD(u)&&(o[u]=xi)}else if(a)for(const d in a){const u=rl(d);if(XD(u)){const h=a[d],f=o[u]=Qt(h)||dr(h)?{type:h}:Xi({},h);if(f){const p=ZD(Boolean,f.type),v=ZD(String,f.type);f[0]=p>-1,f[1]=v<0||p<v,(p>-1||Lr(f,"default"))&&s.push(u)}}}const c=[o,s];return gi(e)&&i.set(e,c),c}function XD(e){return e[0]!=="$"&&!sv(e)}function KD(e){return e===null?"null":typeof e=="function"?e.name||"":typeof e=="object"&&e.constructor&&e.constructor.name||""}function QD(e,t){return KD(e)===KD(t)}function ZD(e,t){return Qt(t)?t.findIndex(r=>QD(r,e)):dr(t)&&QD(t,e)?0:-1}const XF=e=>e[0]==="_"||e==="$stable",VE=e=>Qt(e)?e.map(Bs):[Bs(e)],O7=(e,t,r)=>{if(t._n)return t;const i=tt((...n)=>VE(t(...n)),r);return i._c=!1,i},KF=(e,t,r)=>{const i=e._ctx;for(const n in e){if(XF(n))continue;const a=e[n];if(dr(a))t[n]=O7(n,a,i);else if(a!=null){const o=VE(a);t[n]=()=>o}}},QF=(e,t)=>{const r=VE(t);e.slots.default=()=>r},R7=(e,t)=>{const r=e.slots=GF();if(e.vnode.shapeFlag&32){const i=t._;i?(Xi(r,t),lF(r,"_",i,!0)):KF(t,r)}else t&&QF(e,t)},I7=(e,t,r)=>{const{vnode:i,slots:n}=e;let a=!0,o=xi;if(i.shapeFlag&32){const s=t._;s?r&&s===1?a=!1:(Xi(n,t),!r&&s===1&&delete n._):(a=!t.$stable,KF(t,n)),o=t}else t&&(QF(e,t),o={default:1});if(a)for(const s in n)!XF(s)&&o[s]==null&&delete n[s]};function U_(e,t,r,i,n=!1){if(Qt(e)){e.forEach((h,f)=>U_(h,t&&(Qt(t)?t[f]:t),r,i,n));return}if(cv(i)&&!n)return;const a=i.shapeFlag&4?S1(i.component):i.el,o=n?null:a,{i:s,r:l}=e,c=t&&t.r,d=s.refs===xi?s.refs={}:s.refs,u=s.setupState;if(c!=null&&c!==l&&(Ki(c)?(d[c]=null,Lr(u,c)&&(u[c]=null)):Qi(c)&&(c.value=null)),dr(l))dd(l,s,12,[o,d]);else{const h=Ki(l),f=Qi(l);if(h||f){const p=()=>{if(e.f){const v=h?Lr(u,l)?u[l]:d[l]:l.value;n?Qt(v)&&EE(v,a):Qt(v)?v.includes(a)||v.push(a):h?(d[l]=[a],Lr(u,l)&&(u[l]=d[l])):(l.value=[a],e.k&&(d[e.k]=l.value))}else h?(d[l]=o,Lr(u,l)&&(u[l]=o)):f&&(l.value=o,e.k&&(d[e.k]=o))};o?(p.id=-1,Fa(p,r)):p()}}}const Fa=f7;function z7(e){return k7(e)}function k7(e,t){const r=cF();r.__VUE__=!0;const{insert:i,remove:n,patchProp:a,createElement:o,createText:s,createComment:l,setText:c,setElementText:d,parentNode:u,nextSibling:h,setScopeId:f=Mo,insertStaticContent:p}=e,v=(G,Z,ue,Se=null,we=null,_e=null,Ee=void 0,fe=null,B=!!Z.dynamicChildren)=>{if(G===Z)return;G&&!du(G,Z)&&(Se=Q(G),W(G,we,_e,!0),G=null),Z.patchFlag===-2&&(B=!1,Z.dynamicChildren=null);const{type:D,ref:I,shapeFlag:O}=Z;switch(D){case Tg:m(G,Z,ue,Se);break;case On:g(G,Z,ue,Se);break;case nb:G==null&&y(Z,ue,Se,Ee);break;case pr:T(G,Z,ue,Se,we,_e,Ee,fe,B);break;default:O&1?S(G,Z,ue,Se,we,_e,Ee,fe,B):O&6?R(G,Z,ue,Se,we,_e,Ee,fe,B):(O&64||O&128)&&D.process(G,Z,ue,Se,we,_e,Ee,fe,B,de)}I!=null&&we&&U_(I,G&&G.ref,_e,Z||G,!Z)},m=(G,Z,ue,Se)=>{if(G==null)i(Z.el=s(Z.children),ue,Se);else{const we=Z.el=G.el;Z.children!==G.children&&c(we,Z.children)}},g=(G,Z,ue,Se)=>{G==null?i(Z.el=l(Z.children||""),ue,Se):Z.el=G.el},y=(G,Z,ue,Se)=>{[G.el,G.anchor]=p(G.children,Z,ue,Se,G.el,G.anchor)},b=({el:G,anchor:Z},ue,Se)=>{let we;for(;G&&G!==Z;)we=h(G),i(G,ue,Se),G=we;i(Z,ue,Se)},x=({el:G,anchor:Z})=>{let ue;for(;G&&G!==Z;)ue=h(G),n(G),G=ue;n(Z)},S=(G,Z,ue,Se,we,_e,Ee,fe,B)=>{Z.type==="svg"?Ee="svg":Z.type==="math"&&(Ee="mathml"),G==null?w(Z,ue,Se,we,_e,Ee,fe,B):A(G,Z,we,_e,Ee,fe,B)},w=(G,Z,ue,Se,we,_e,Ee,fe)=>{let B,D;const{props:I,shapeFlag:O,transition:j,dirs:L}=G;if(B=G.el=o(G.type,_e,I&&I.is,I),O&8?d(B,G.children):O&16&&C(G.children,B,null,Se,we,Mw(G,_e),Ee,fe),L&&Vd(G,null,Se,"created"),_(B,G,G.scopeId,Ee,Se),I){for(const We in I)We!=="value"&&!sv(We)&&a(B,We,null,I[We],_e,G.children,Se,we,ee);"value"in I&&a(B,"value",null,I.value,_e),(D=I.onVnodeBeforeMount)&&xs(D,Se,G)}L&&Vd(G,null,Se,"beforeMount");const Ae=L7(we,j);Ae&&j.beforeEnter(B),i(B,Z,ue),((D=I&&I.onVnodeMounted)||Ae||L)&&Fa(()=>{D&&xs(D,Se,G),Ae&&j.enter(B),L&&Vd(G,null,Se,"mounted")},we)},_=(G,Z,ue,Se,we)=>{if(ue&&f(G,ue),Se)for(let _e=0;_e<Se.length;_e++)f(G,Se[_e]);if(we){let _e=we.subTree;if(Z===_e){const Ee=we.vnode;_(G,Ee,Ee.scopeId,Ee.slotScopeIds,we.parent)}}},C=(G,Z,ue,Se,we,_e,Ee,fe,B=0)=>{for(let D=B;D<G.length;D++){const I=G[D]=fe?Vc(G[D]):Bs(G[D]);v(null,I,Z,ue,Se,we,_e,Ee,fe)}},A=(G,Z,ue,Se,we,_e,Ee)=>{const fe=Z.el=G.el;let{patchFlag:B,dynamicChildren:D,dirs:I}=Z;B|=G.patchFlag&16;const O=G.props||xi,j=Z.props||xi;let L;if(ue&&Hd(ue,!1),(L=j.onVnodeBeforeUpdate)&&xs(L,ue,Z,G),I&&Vd(Z,G,ue,"beforeUpdate"),ue&&Hd(ue,!0),D?M(G.dynamicChildren,D,fe,ue,Se,Mw(Z,we),_e):Ee||U(G,Z,fe,null,ue,Se,Mw(Z,we),_e,!1),B>0){if(B&16)P(fe,Z,O,j,ue,Se,we);else if(B&2&&O.class!==j.class&&a(fe,"class",null,j.class,we),B&4&&a(fe,"style",O.style,j.style,we),B&8){const Ae=Z.dynamicProps;for(let We=0;We<Ae.length;We++){const je=Ae[We],ze=O[je],Je=j[je];(Je!==ze||je==="value")&&a(fe,je,ze,Je,we,G.children,ue,Se,ee)}}B&1&&G.children!==Z.children&&d(fe,Z.children)}else!Ee&&D==null&&P(fe,Z,O,j,ue,Se,we);((L=j.onVnodeUpdated)||I)&&Fa(()=>{L&&xs(L,ue,Z,G),I&&Vd(Z,G,ue,"updated")},Se)},M=(G,Z,ue,Se,we,_e,Ee)=>{for(let fe=0;fe<Z.length;fe++){const B=G[fe],D=Z[fe],I=B.el&&(B.type===pr||!du(B,D)||B.shapeFlag&70)?u(B.el):ue;v(B,D,I,null,Se,we,_e,Ee,!0)}},P=(G,Z,ue,Se,we,_e,Ee)=>{if(ue!==Se){if(ue!==xi)for(const fe in ue)!sv(fe)&&!(fe in Se)&&a(G,fe,ue[fe],null,Ee,Z.children,we,_e,ee);for(const fe in Se){if(sv(fe))continue;const B=Se[fe],D=ue[fe];B!==D&&fe!=="value"&&a(G,fe,D,B,Ee,Z.children,we,_e,ee)}"value"in Se&&a(G,"value",ue.value,Se.value,Ee)}},T=(G,Z,ue,Se,we,_e,Ee,fe,B)=>{const D=Z.el=G?G.el:s(""),I=Z.anchor=G?G.anchor:s("");let{patchFlag:O,dynamicChildren:j,slotScopeIds:L}=Z;L&&(fe=fe?fe.concat(L):L),G==null?(i(D,ue,Se),i(I,ue,Se),C(Z.children||[],ue,I,we,_e,Ee,fe,B)):O>0&&O&64&&j&&G.dynamicChildren?(M(G.dynamicChildren,j,ue,we,_e,Ee,fe),(Z.key!=null||we&&Z===we.subTree)&&HE(G,Z,!0)):U(G,Z,ue,I,we,_e,Ee,fe,B)},R=(G,Z,ue,Se,we,_e,Ee,fe,B)=>{Z.slotScopeIds=fe,G==null?Z.shapeFlag&512?we.ctx.activate(Z,ue,Se,Ee,B):z(Z,ue,Se,we,_e,Ee,B):F(G,Z,B)},z=(G,Z,ue,Se,we,_e,Ee)=>{const fe=G.component=Z7(G,Se,we);if(b1(G)&&(fe.ctx.renderer=de),J7(fe),fe.asyncDep){if(we&&we.registerDep(fe,H,Ee),!G.el){const B=fe.subTree=Be(On);g(null,B,Z,ue)}}else H(fe,G,Z,ue,we,_e,Ee)},F=(G,Z,ue)=>{const Se=Z.component=G.component;if(s7(G,Z,ue))if(Se.asyncDep&&!Se.asyncResolved){N(Se,Z,ue);return}else Se.next=Z,t7(Se.update),Se.effect.dirty=!0,Se.update();else Z.el=G.el,Se.vnode=Z},H=(G,Z,ue,Se,we,_e,Ee)=>{const fe=()=>{if(G.isMounted){let{next:I,bu:O,u:j,parent:L,vnode:Ae}=G;{const nt=ZF(G);if(nt){I&&(I.el=Ae.el,N(G,I,Ee)),nt.asyncDep.then(()=>{G.isUnmounted||fe()});return}}let We=I,je;Hd(G,!1),I?(I.el=Ae.el,N(G,I,Ee)):I=Ae,O&&Sw(O),(je=I.props&&I.props.onVnodeBeforeUpdate)&&xs(je,L,I,Ae),Hd(G,!0);const ze=_w(G),Je=G.subTree;G.subTree=ze,v(Je,ze,u(Je.el),Q(Je),G,we,_e),I.el=ze.el,We===null&&l7(G,ze.el),j&&Fa(j,we),(je=I.props&&I.props.onVnodeUpdated)&&Fa(()=>xs(je,L,I,Ae),we)}else{let I;const{el:O,props:j}=Z,{bm:L,m:Ae,parent:We}=G,je=cv(Z);if(Hd(G,!1),L&&Sw(L),!je&&(I=j&&j.onVnodeBeforeMount)&&xs(I,We,Z),Hd(G,!0),O&&Ce){const ze=()=>{G.subTree=_w(G),Ce(O,G.subTree,G,we,null)};je?Z.type.__asyncLoader().then(()=>!G.isUnmounted&&ze()):ze()}else{const ze=G.subTree=_w(G);v(null,ze,ue,Se,G,we,_e),Z.el=ze.el}if(Ae&&Fa(Ae,we),!je&&(I=j&&j.onVnodeMounted)){const ze=Z;Fa(()=>xs(I,We,ze),we)}(Z.shapeFlag&256||We&&cv(We.vnode)&&We.vnode.shapeFlag&256)&&G.a&&Fa(G.a,we),G.isMounted=!0,Z=ue=Se=null}},B=G.effect=new PE(fe,Mo,()=>FE(D),G.scope),D=G.update=()=>{B.dirty&&B.run()};D.id=G.uid,Hd(G,!0),D()},N=(G,Z,ue)=>{Z.component=G;const Se=G.vnode.props;G.vnode=Z,G.next=null,D7(G,Z.props,Se,ue),I7(G,Z.children,ue),Td(),VD(G),Pd()},U=(G,Z,ue,Se,we,_e,Ee,fe,B=!1)=>{const D=G&&G.children,I=G?G.shapeFlag:0,O=Z.children,{patchFlag:j,shapeFlag:L}=Z;if(j>0){if(j&128){te(D,O,ue,Se,we,_e,Ee,fe,B);return}else if(j&256){ie(D,O,ue,Se,we,_e,Ee,fe,B);return}}L&8?(I&16&&ee(D,we,_e),O!==D&&d(ue,O)):I&16?L&16?te(D,O,ue,Se,we,_e,Ee,fe,B):ee(D,we,_e,!0):(I&8&&d(ue,""),L&16&&C(O,ue,Se,we,_e,Ee,fe,B))},ie=(G,Z,ue,Se,we,_e,Ee,fe,B)=>{G=G||If,Z=Z||If;const D=G.length,I=Z.length,O=Math.min(D,I);let j;for(j=0;j<O;j++){const L=Z[j]=B?Vc(Z[j]):Bs(Z[j]);v(G[j],L,ue,null,we,_e,Ee,fe,B)}D>I?ee(G,we,_e,!0,!1,O):C(Z,ue,Se,we,_e,Ee,fe,B,O)},te=(G,Z,ue,Se,we,_e,Ee,fe,B)=>{let D=0;const I=Z.length;let O=G.length-1,j=I-1;for(;D<=O&&D<=j;){const L=G[D],Ae=Z[D]=B?Vc(Z[D]):Bs(Z[D]);if(du(L,Ae))v(L,Ae,ue,null,we,_e,Ee,fe,B);else break;D++}for(;D<=O&&D<=j;){const L=G[O],Ae=Z[j]=B?Vc(Z[j]):Bs(Z[j]);if(du(L,Ae))v(L,Ae,ue,null,we,_e,Ee,fe,B);else break;O--,j--}if(D>O){if(D<=j){const L=j+1,Ae=L<I?Z[L].el:Se;for(;D<=j;)v(null,Z[D]=B?Vc(Z[D]):Bs(Z[D]),ue,Ae,we,_e,Ee,fe,B),D++}}else if(D>j)for(;D<=O;)W(G[D],we,_e,!0),D++;else{const L=D,Ae=D,We=new Map;for(D=Ae;D<=j;D++){const se=Z[D]=B?Vc(Z[D]):Bs(Z[D]);se.key!=null&&We.set(se.key,D)}let je,ze=0;const Je=j-Ae+1;let nt=!1,lt=0;const dt=new Array(Je);for(D=0;D<Je;D++)dt[D]=0;for(D=L;D<=O;D++){const se=G[D];if(ze>=Je){W(se,we,_e,!0);continue}let Le;if(se.key!=null)Le=We.get(se.key);else for(je=Ae;je<=j;je++)if(dt[je-Ae]===0&&du(se,Z[je])){Le=je;break}Le===void 0?W(se,we,_e,!0):(dt[Le-Ae]=D+1,Le>=lt?lt=Le:nt=!0,v(se,Z[Le],ue,null,we,_e,Ee,fe,B),ze++)}const vt=nt?B7(dt):If;for(je=vt.length-1,D=Je-1;D>=0;D--){const se=Ae+D,Le=Z[se],Ye=se+1<I?Z[se+1].el:Se;dt[D]===0?v(null,Le,ue,Ye,we,_e,Ee,fe,B):nt&&(je<0||D!==vt[je]?X(Le,ue,Ye,2):je--)}}},X=(G,Z,ue,Se,we=null)=>{const{el:_e,type:Ee,transition:fe,children:B,shapeFlag:D}=G;if(D&6){X(G.component.subTree,Z,ue,Se);return}if(D&128){G.suspense.move(Z,ue,Se);return}if(D&64){Ee.move(G,Z,ue,de);return}if(Ee===pr){i(_e,Z,ue);for(let O=0;O<B.length;O++)X(B[O],Z,ue,Se);i(G.anchor,Z,ue);return}if(Ee===nb){b(G,Z,ue);return}if(Se!==2&&D&1&&fe)if(Se===0)fe.beforeEnter(_e),i(_e,Z,ue),Fa(()=>fe.enter(_e),we);else{const{leave:O,delayLeave:j,afterLeave:L}=fe,Ae=()=>i(_e,Z,ue),We=()=>{O(_e,()=>{Ae(),L&&L()})};j?j(_e,Ae,We):We()}else i(_e,Z,ue)},W=(G,Z,ue,Se=!1,we=!1)=>{const{type:_e,props:Ee,ref:fe,children:B,dynamicChildren:D,shapeFlag:I,patchFlag:O,dirs:j,memoIndex:L}=G;if(O===-2&&(we=!1),fe!=null&&U_(fe,null,ue,G,!0),L!=null&&(Z.renderCache[L]=void 0),I&256){Z.ctx.deactivate(G);return}const Ae=I&1&&j,We=!cv(G);let je;if(We&&(je=Ee&&Ee.onVnodeBeforeUnmount)&&xs(je,Z,G),I&6)le(G.component,ue,Se);else{if(I&128){G.suspense.unmount(ue,Se);return}Ae&&Vd(G,null,Z,"beforeUnmount"),I&64?G.type.remove(G,Z,ue,de,Se):D&&(_e!==pr||O>0&&O&64)?ee(D,Z,ue,!1,!0):(_e===pr&&O&384||!we&&I&16)&&ee(B,Z,ue),Se&&q(G)}(We&&(je=Ee&&Ee.onVnodeUnmounted)||Ae)&&Fa(()=>{je&&xs(je,Z,G),Ae&&Vd(G,null,Z,"unmounted")},ue)},q=G=>{const{type:Z,el:ue,anchor:Se,transition:we}=G;if(Z===pr){$(ue,Se);return}if(Z===nb){x(G);return}const _e=()=>{n(ue),we&&!we.persisted&&we.afterLeave&&we.afterLeave()};if(G.shapeFlag&1&&we&&!we.persisted){const{leave:Ee,delayLeave:fe}=we,B=()=>Ee(ue,_e);fe?fe(G.el,_e,B):B()}else _e()},$=(G,Z)=>{let ue;for(;G!==Z;)ue=h(G),n(G),G=ue;n(Z)},le=(G,Z,ue)=>{const{bum:Se,scope:we,update:_e,subTree:Ee,um:fe,m:B,a:D}=G;JD(B),JD(D),Se&&Sw(Se),we.stop(),_e&&(_e.active=!1,W(Ee,G,Z,ue)),fe&&Fa(fe,Z),Fa(()=>{G.isUnmounted=!0},Z),Z&&Z.pendingBranch&&!Z.isUnmounted&&G.asyncDep&&!G.asyncResolved&&G.suspenseId===Z.pendingId&&(Z.deps--,Z.deps===0&&Z.resolve())},ee=(G,Z,ue,Se=!1,we=!1,_e=0)=>{for(let Ee=_e;Ee<G.length;Ee++)W(G[Ee],Z,ue,Se,we)},Q=G=>G.shapeFlag&6?Q(G.component.subTree):G.shapeFlag&128?G.suspense.next():h(G.anchor||G.el);let ne=!1;const V=(G,Z,ue)=>{G==null?Z._vnode&&W(Z._vnode,null,null,!0):v(Z._vnode||null,G,Z,null,null,null,ue),ne||(ne=!0,VD(),BF(),ne=!1),Z._vnode=G},de={p:v,um:W,m:X,r:q,mt:z,mc:C,pc:U,pbc:M,n:Q,o:e};let me,Ce;return{render:V,hydrate:me,createApp:E7(V,me)}}function Mw({type:e,props:t},r){return r==="svg"&&e==="foreignObject"||r==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:r}function Hd({effect:e,update:t},r){e.allowRecurse=t.allowRecurse=r}function L7(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function HE(e,t,r=!1){const i=e.children,n=t.children;if(Qt(i)&&Qt(n))for(let a=0;a<i.length;a++){const o=i[a];let s=n[a];s.shapeFlag&1&&!s.dynamicChildren&&((s.patchFlag<=0||s.patchFlag===32)&&(s=n[a]=Vc(n[a]),s.el=o.el),!r&&s.patchFlag!==-2&&HE(o,s)),s.type===Tg&&(s.el=o.el)}}function B7(e){const t=e.slice(),r=[0];let i,n,a,o,s;const l=e.length;for(i=0;i<l;i++){const c=e[i];if(c!==0){if(n=r[r.length-1],e[n]<c){t[i]=n,r.push(i);continue}for(a=0,o=r.length-1;a<o;)s=a+o>>1,e[r[s]]<c?a=s+1:o=s;c<e[r[a]]&&(a>0&&(t[i]=r[a-1]),r[a]=i)}}for(a=r.length,o=r[a-1];a-- >0;)r[a]=o,o=t[o];return r}function ZF(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:ZF(t)}function JD(e){if(e)for(let t=0;t<e.length;t++)e[t].active=!1}const F7=Symbol.for("v-scx"),N7=()=>_t(F7);function Qa(e,t){return WE(e,null,t)}const u0={};function tr(e,t,r){return WE(e,t,r)}function WE(e,t,{immediate:r,deep:i,flush:n,once:a,onTrack:o,onTrigger:s}=xi){if(t&&a){const w=t;t=(..._)=>{w(..._),S()}}const l=Rn,c=w=>i===!0?w:qc(w,i===!1?1:void 0);let d,u=!1,h=!1;if(Qi(e)?(d=()=>e.value,u=Rb(e)):cd(e)?(d=()=>c(e),u=!0):Qt(e)?(h=!0,u=e.some(w=>cd(w)||Rb(w)),d=()=>e.map(w=>{if(Qi(w))return w.value;if(cd(w))return c(w);if(dr(w))return dd(w,l,2)})):dr(e)?t?d=()=>dd(e,l,2):d=()=>(f&&f(),Oo(e,l,3,[p])):d=Mo,t&&i){const w=d;d=()=>qc(w())}let f,p=w=>{f=b.onStop=()=>{dd(w,l,4),f=b.onStop=void 0}},v;if(w1)if(p=Mo,t?r&&Oo(t,l,3,[d(),h?[]:void 0,p]):d(),n==="sync"){const w=N7();v=w.__watcherHandles||(w.__watcherHandles=[])}else return Mo;let m=h?new Array(e.length).fill(u0):u0;const g=()=>{if(!(!b.active||!b.dirty))if(t){const w=b.run();(i||u||(h?w.some((_,C)=>gd(_,m[C])):gd(w,m)))&&(f&&f(),Oo(t,l,3,[w,m===u0?void 0:h&&m[0]===u0?[]:m,p]),m=w)}else b.run()};g.allowRecurse=!!t;let y;n==="sync"?y=g:n==="post"?y=()=>Fa(g,l&&l.suspense):(g.pre=!0,l&&(g.id=l.uid),y=()=>FE(g));const b=new PE(d,Mo,y),x=mF(),S=()=>{b.stop(),x&&EE(x.effects,b)};return t?r?g():m=b.run():n==="post"?Fa(b.run.bind(b),l&&l.suspense):b.run(),v&&v.push(S),S}function U7(e,t,r){const i=this.proxy,n=Ki(e)?e.includes(".")?JF(i,e):()=>i[e]:e.bind(i,i);let a;dr(t)?a=t:(a=t.handler,r=t);const o=Pg(this),s=WE(n,a.bind(i),r);return o(),s}function JF(e,t){const r=t.split(".");return()=>{let i=e;for(let n=0;n<r.length&&i;n++)i=i[r[n]];return i}}function qc(e,t=1/0,r){if(t<=0||!gi(e)||e.__v_skip||(r=r||new Set,r.has(e)))return e;if(r.add(e),t--,Qi(e))qc(e.value,t,r);else if(Qt(e))for(let i=0;i<e.length;i++)qc(e[i],t,r);else if(nF(e)||zf(e))e.forEach(i=>{qc(i,t,r)});else if(sF(e)){for(const i in e)qc(e[i],t,r);for(const i of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,i)&&qc(e[i],t,r)}return e}const b1=e=>e.type.__isKeepAlive;function GE(e,t){e5(e,"a",t)}function $E(e,t){e5(e,"da",t)}function e5(e,t,r=Rn){const i=e.__wdc||(e.__wdc=()=>{let n=r;for(;n;){if(n.isDeactivated)return;n=n.parent}return e()});if(y1(t,i,r),r){let n=r.parent;for(;n&&n.parent;)b1(n.parent.vnode)&&j7(i,t,r,n),n=n.parent}}function j7(e,t,r,i){const n=y1(t,e,i,!0);Eg(()=>{EE(i[t],n)},r)}const jc=Symbol("_leaveCb"),h0=Symbol("_enterCb");function t5(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Or(()=>{e.isMounted=!0}),na(()=>{e.isUnmounting=!0}),e}const ho=[Function,Array],r5={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:ho,onEnter:ho,onAfterEnter:ho,onEnterCancelled:ho,onBeforeLeave:ho,onLeave:ho,onAfterLeave:ho,onLeaveCancelled:ho,onBeforeAppear:ho,onAppear:ho,onAfterAppear:ho,onAppearCancelled:ho},i5=e=>{const t=e.subTree;return t.component?i5(t.component):t},V7={name:"BaseTransition",props:r5,setup(e,{slots:t}){const r=lh(),i=t5();return()=>{const n=t.default&&qE(t.default(),!0);if(!n||!n.length)return;let a=n[0];if(n.length>1){for(const h of n)if(h.type!==On){a=h;break}}const o=wr(e),{mode:s}=o;if(i.isLeaving)return Ew(a);const l=e3(a);if(!l)return Ew(a);let c=Uv(l,o,i,r,h=>c=h);ip(l,c);const d=r.subTree,u=d&&e3(d);if(u&&u.type!==On&&!du(l,u)&&i5(r).type!==On){const h=Uv(u,o,i,r);if(ip(u,h),s==="out-in"&&l.type!==On)return i.isLeaving=!0,h.afterLeave=()=>{i.isLeaving=!1,r.update.active!==!1&&(r.effect.dirty=!0,r.update())},Ew(a);s==="in-out"&&l.type!==On&&(h.delayLeave=(f,p,v)=>{const m=n5(i,u);m[String(u.key)]=u,f[jc]=()=>{p(),f[jc]=void 0,delete c.delayedLeave},c.delayedLeave=v})}return a}}},H7=V7;function n5(e,t){const{leavingVNodes:r}=e;let i=r.get(t.type);return i||(i=Object.create(null),r.set(t.type,i)),i}function Uv(e,t,r,i,n){const{appear:a,mode:o,persisted:s=!1,onBeforeEnter:l,onEnter:c,onAfterEnter:d,onEnterCancelled:u,onBeforeLeave:h,onLeave:f,onAfterLeave:p,onLeaveCancelled:v,onBeforeAppear:m,onAppear:g,onAfterAppear:y,onAppearCancelled:b}=t,x=String(e.key),S=n5(r,e),w=(A,M)=>{A&&Oo(A,i,9,M)},_=(A,M)=>{const P=M[1];w(A,M),Qt(A)?A.every(T=>T.length<=1)&&P():A.length<=1&&P()},C={mode:o,persisted:s,beforeEnter(A){let M=l;if(!r.isMounted)if(a)M=m||l;else return;A[jc]&&A[jc](!0);const P=S[x];P&&du(e,P)&&P.el[jc]&&P.el[jc](),w(M,[A])},enter(A){let M=c,P=d,T=u;if(!r.isMounted)if(a)M=g||c,P=y||d,T=b||u;else return;let R=!1;const z=A[h0]=F=>{R||(R=!0,F?w(T,[A]):w(P,[A]),C.delayedLeave&&C.delayedLeave(),A[h0]=void 0)};M?_(M,[A,z]):z()},leave(A,M){const P=String(e.key);if(A[h0]&&A[h0](!0),r.isUnmounting)return M();w(h,[A]);let T=!1;const R=A[jc]=z=>{T||(T=!0,M(),z?w(v,[A]):w(p,[A]),A[jc]=void 0,S[P]===e&&delete S[P])};S[P]=e,f?_(f,[A,R]):R()},clone(A){const M=Uv(A,t,r,i,n);return n&&n(M),M}};return C}function Ew(e){if(b1(e))return e=nl(e),e.children=null,e}function e3(e){if(!b1(e))return e;const{shapeFlag:t,children:r}=e;if(r){if(t&16)return r[0];if(t&32&&dr(r.default))return r.default()}}function ip(e,t){e.shapeFlag&6&&e.component?ip(e.component.subTree,t):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function qE(e,t=!1,r){let i=[],n=0;for(let a=0;a<e.length;a++){let o=e[a];const s=r==null?o.key:String(r)+String(o.key!=null?o.key:a);o.type===pr?(o.patchFlag&128&&n++,i=i.concat(qE(o.children,t,s))):(t||o.type!==On)&&i.push(s!=null?nl(o,{key:s}):o)}if(n>1)for(let a=0;a<i.length;a++)i[a].patchFlag=-2;return i}const W7=e=>e.__isTeleport,uv=e=>e&&(e.disabled||e.disabled===""),t3=e=>typeof SVGElement<"u"&&e instanceof SVGElement,r3=e=>typeof MathMLElement=="function"&&e instanceof MathMLElement,j_=(e,t)=>{const r=e&&e.to;return Ki(r)?t?t(r):null:r},G7={name:"Teleport",__isTeleport:!0,process(e,t,r,i,n,a,o,s,l,c){const{mc:d,pc:u,pbc:h,o:{insert:f,querySelector:p,createText:v,createComment:m}}=c,g=uv(t.props);let{shapeFlag:y,children:b,dynamicChildren:x}=t;if(e==null){const S=t.el=v(""),w=t.anchor=v("");f(S,r,i),f(w,r,i);const _=t.target=j_(t.props,p),C=t.targetAnchor=v("");_&&(f(C,_),o==="svg"||t3(_)?o="svg":(o==="mathml"||r3(_))&&(o="mathml"));const A=(M,P)=>{y&16&&d(b,M,P,n,a,o,s,l)};g?A(r,w):_&&A(_,C)}else{t.el=e.el;const S=t.anchor=e.anchor,w=t.target=e.target,_=t.targetAnchor=e.targetAnchor,C=uv(e.props),A=C?r:w,M=C?S:_;if(o==="svg"||t3(w)?o="svg":(o==="mathml"||r3(w))&&(o="mathml"),x?(h(e.dynamicChildren,x,A,n,a,o,s),HE(e,t,!0)):l||u(e,t,A,M,n,a,o,s,!1),g)C?t.props&&e.props&&t.props.to!==e.props.to&&(t.props.to=e.props.to):f0(t,r,S,c,1);else if((t.props&&t.props.to)!==(e.props&&e.props.to)){const P=t.target=j_(t.props,p);P&&f0(t,P,null,c,0)}else C&&f0(t,w,_,c,1)}o5(t)},remove(e,t,r,{um:i,o:{remove:n}},a){const{shapeFlag:o,children:s,anchor:l,targetAnchor:c,target:d,props:u}=e;if(d&&n(c),a&&n(l),o&16){const h=a||!uv(u);for(let f=0;f<s.length;f++){const p=s[f];i(p,t,r,h,!!p.dynamicChildren)}}},move:f0,hydrate:$7};function f0(e,t,r,{o:{insert:i},m:n},a=2){a===0&&i(e.targetAnchor,t,r);const{el:o,anchor:s,shapeFlag:l,children:c,props:d}=e,u=a===2;if(u&&i(o,t,r),(!u||uv(d))&&l&16)for(let h=0;h<c.length;h++)n(c[h],t,r,2);u&&i(s,t,r)}function $7(e,t,r,i,n,a,{o:{nextSibling:o,parentNode:s,querySelector:l}},c){const d=t.target=j_(t.props,l);if(d){const u=d._lpa||d.firstChild;if(t.shapeFlag&16)if(uv(t.props))t.anchor=c(o(e),t,s(e),r,i,n,a),t.targetAnchor=u;else{t.anchor=o(e);let h=u;for(;h;)if(h=o(h),h&&h.nodeType===8&&h.data==="teleport anchor"){t.targetAnchor=h,d._lpa=t.targetAnchor&&o(t.targetAnchor);break}c(u,t,d,r,i,n,a)}o5(t)}return t.anchor&&o(t.anchor)}const a5=G7;function o5(e){const t=e.ctx;if(t&&t.ut){let r=e.children[0].el;for(;r&&r!==e.targetAnchor;)r.nodeType===1&&r.setAttribute("data-v-owner",t.uid),r=r.nextSibling;t.ut()}}const pr=Symbol.for("v-fgt"),Tg=Symbol.for("v-txt"),On=Symbol.for("v-cmt"),nb=Symbol.for("v-stc"),hv=[];let ts=null;function ft(e=!1){hv.push(ts=e?null:[])}function q7(){hv.pop(),ts=hv[hv.length-1]||null}let jv=1;function i3(e){jv+=e}function s5(e){return e.dynamicChildren=jv>0?ts||If:null,q7(),jv>0&&ts&&ts.push(e),e}function Pt(e,t,r,i,n,a){return s5(st(e,t,r,i,n,a,!0))}function Ei(e,t,r,i,n){return s5(Be(e,t,r,i,n,!0))}function Vv(e){return e?e.__v_isVNode===!0:!1}function du(e,t){return e.type===t.type&&e.key===t.key}const l5=({key:e})=>e??null,ab=({ref:e,ref_key:t,ref_for:r})=>(typeof e=="number"&&(e=""+e),e!=null?Ki(e)||Qi(e)||dr(e)?{i:yn,r:e,k:t,f:!!r}:e:null);function st(e,t=null,r=null,i=0,n=null,a=e===pr?0:1,o=!1,s=!1){const l={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&l5(t),ref:t&&ab(t),scopeId:g1,slotScopeIds:null,children:r,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:a,patchFlag:i,dynamicProps:n,dynamicChildren:null,appContext:null,ctx:yn};return s?(YE(l,r),a&128&&e.normalize(l)):r&&(l.shapeFlag|=Ki(r)?8:16),jv>0&&!o&&ts&&(l.patchFlag>0||a&6)&&l.patchFlag!==32&&ts.push(l),l}const Be=Y7;function Y7(e,t=null,r=null,i=0,n=null,a=!1){if((!e||e===d7)&&(e=On),Vv(e)){const s=nl(e,t,!0);return r&&YE(s,r),jv>0&&!a&&ts&&(s.shapeFlag&6?ts[ts.indexOf(e)]=s:ts.push(s)),s.patchFlag=-2,s}if(nG(e)&&(e=e.__vccOpts),t){t=X7(t);let{class:s,style:l}=t;s&&!Ki(s)&&(t.class=Do(s)),gi(l)&&(lv(l)&&!Qt(l)&&(l=Xi({},l)),t.style=tp(l))}const o=Ki(e)?1:h7(e)?128:W7(e)?64:gi(e)?4:dr(e)?2:0;return st(e,t,r,i,n,o,a,!0)}function X7(e){return e?lv(e)||$F(e)?Xi({},e):e:null}function nl(e,t,r=!1,i=!1){const{props:n,ref:a,patchFlag:o,children:s,transition:l}=e,c=t?Rd(n||{},t):n,d={__v_isVNode:!0,__v_skip:!0,type:e.type,props:c,key:c&&l5(c),ref:t&&t.ref?r&&a?Qt(a)?a.concat(ab(t)):[a,ab(t)]:ab(t):a,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:s,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==pr?o===-1?16:o|16:o,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:l,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&nl(e.ssContent),ssFallback:e.ssFallback&&nl(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return l&&i&&ip(d,l.clone(d)),d}function Pr(e=" ",t=0){return Be(Tg,null,e,t)}function x1(e,t){const r=Be(nb,null,e);return r.staticCount=t,r}function Na(e="",t=!1){return t?(ft(),Ei(On,null,e)):Be(On,null,e)}function Bs(e){return e==null||typeof e=="boolean"?Be(On):Qt(e)?Be(pr,null,e.slice()):typeof e=="object"?Vc(e):Be(Tg,null,String(e))}function Vc(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:nl(e)}function YE(e,t){let r=0;const{shapeFlag:i}=e;if(t==null)t=null;else if(Qt(t))r=16;else if(typeof t=="object")if(i&65){const n=t.default;n&&(n._c&&(n._d=!1),YE(e,n()),n._c&&(n._d=!0));return}else{r=32;const n=t._;!n&&!$F(t)?t._ctx=yn:n===3&&yn&&(yn.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else dr(t)?(t={default:t,_ctx:yn},r=32):(t=String(t),i&64?(r=16,t=[Pr(t)]):r=8);e.children=t,e.shapeFlag|=r}function Rd(...e){const t={};for(let r=0;r<e.length;r++){const i=e[r];for(const n in i)if(n==="class")t.class!==i.class&&(t.class=Do([t.class,i.class]));else if(n==="style")t.style=tp([t.style,i.style]);else if(d1(n)){const a=t[n],o=i[n];o&&a!==o&&!(Qt(a)&&a.includes(o))&&(t[n]=a?[].concat(a,o):o)}else n!==""&&(t[n]=i[n])}return t}function xs(e,t,r,i=null){Oo(e,t,7,[r,i])}const K7=HF();let Q7=0;function Z7(e,t,r){const i=e.type,n=(t?t.appContext:e.appContext)||K7,a={uid:Q7++,vnode:e,type:i,parent:t,appContext:n,root:null,next:null,subTree:null,effect:null,update:null,scope:new fF(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(n.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:YF(i,n),emitsOptions:NF(i,n),emit:null,emitted:null,propsDefaults:xi,inheritAttrs:i.inheritAttrs,ctx:xi,data:xi,props:xi,attrs:xi,slots:xi,refs:xi,setupState:xi,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:r,suspenseId:r?r.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return a.ctx={_:a},a.root=t?t.root:a,a.emit=n7.bind(null,a),e.ce&&e.ce(a),a}let Rn=null;const lh=()=>Rn||yn;let kb,V_;{const e=cF(),t=(r,i)=>{let n;return(n=e[r])||(n=e[r]=[]),n.push(i),a=>{n.length>1?n.forEach(o=>o(a)):n[0](a)}};kb=t("__VUE_INSTANCE_SETTERS__",r=>Rn=r),V_=t("__VUE_SSR_SETTERS__",r=>w1=r)}const Pg=e=>{const t=Rn;return kb(e),e.scope.on(),()=>{e.scope.off(),kb(t)}},n3=()=>{Rn&&Rn.scope.off(),kb(null)};function c5(e){return e.vnode.shapeFlag&4}let w1=!1;function J7(e,t=!1){t&&V_(t);const{props:r,children:i}=e.vnode,n=c5(e);P7(e,r,n,t),R7(e,i);const a=n?eG(e,t):void 0;return t&&V_(!1),a}function eG(e,t){const r=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,x7);const{setup:i}=r;if(i){const n=e.setupContext=i.length>1?rG(e):null,a=Pg(e);Td();const o=dd(i,e,0,[e.props,n]);if(Pd(),a(),aF(o)){if(o.then(n3,n3),t)return o.then(s=>{a3(e,s,t)}).catch(s=>{m1(s,e,0)});e.asyncDep=o}else a3(e,o,t)}else d5(e,t)}function a3(e,t,r){dr(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:gi(t)&&(e.setupState=RF(t)),d5(e,r)}let o3;function d5(e,t,r){const i=e.type;if(!e.render){if(!t&&o3&&!i.render){const n=i.template||jE(e).template;if(n){const{isCustomElement:a,compilerOptions:o}=e.appContext.config,{delimiters:s,compilerOptions:l}=i,c=Xi(Xi({isCustomElement:a,delimiters:s},o),l);i.render=o3(n,c)}}e.render=i.render||Mo}{const n=Pg(e);Td();try{w7(e)}finally{Pd(),n()}}}const tG={get(e,t){return Xa(e,"get",""),e[t]}};function rG(e){const t=r=>{e.exposed=r||{}};return{attrs:new Proxy(e.attrs,tG),slots:e.slots,emit:e.emit,expose:t}}function S1(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(RF(kE(e.exposed)),{get(t,r){if(r in t)return t[r];if(r in dv)return dv[r](e)},has(t,r){return r in t||r in dv}})):e.proxy}function iG(e,t=!0){return dr(e)?e.displayName||e.name:e.name||t&&e.__name}function nG(e){return dr(e)&&"__vccOpts"in e}const re=(e,t)=>Y9(e,t,w1);function E(e,t,r){const i=arguments.length;return i===2?gi(t)&&!Qt(t)?Vv(t)?Be(e,null,[t]):Be(e,t):Be(e,null,t):(i>3?r=Array.prototype.slice.call(arguments,2):i===3&&Vv(r)&&(r=[r]),Be(e,t,r))}const aG="3.4.31";/**
* @vue/runtime-dom v3.4.31
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const oG="http://www.w3.org/2000/svg",sG="http://www.w3.org/1998/Math/MathML",Il=typeof document<"u"?document:null,s3=Il&&Il.createElement("template"),lG={insert:(e,t,r)=>{t.insertBefore(e,r||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,r,i)=>{const n=t==="svg"?Il.createElementNS(oG,e):t==="mathml"?Il.createElementNS(sG,e):r?Il.createElement(e,{is:r}):Il.createElement(e);return e==="select"&&i&&i.multiple!=null&&n.setAttribute("multiple",i.multiple),n},createText:e=>Il.createTextNode(e),createComment:e=>Il.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Il.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,r,i,n,a){const o=r?r.previousSibling:t.lastChild;if(n&&(n===a||n.nextSibling))for(;t.insertBefore(n.cloneNode(!0),r),!(n===a||!(n=n.nextSibling)););else{s3.innerHTML=i==="svg"?`<svg>${e}</svg>`:i==="mathml"?`<math>${e}</math>`:e;const s=s3.content;if(i==="svg"||i==="mathml"){const l=s.firstChild;for(;l.firstChild;)s.appendChild(l.firstChild);s.removeChild(l)}t.insertBefore(s,r)}return[o?o.nextSibling:t.firstChild,r?r.previousSibling:t.lastChild]}},gc="transition",om="animation",np=Symbol("_vtc"),Da=(e,{slots:t})=>E(H7,h5(e),t);Da.displayName="Transition";const u5={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},cG=Da.props=Xi({},r5,u5),Wd=(e,t=[])=>{Qt(e)?e.forEach(r=>r(...t)):e&&e(...t)},l3=e=>e?Qt(e)?e.some(t=>t.length>1):e.length>1:!1;function h5(e){const t={};for(const T in e)T in u5||(t[T]=e[T]);if(e.css===!1)return t;const{name:r="v",type:i,duration:n,enterFromClass:a=`${r}-enter-from`,enterActiveClass:o=`${r}-enter-active`,enterToClass:s=`${r}-enter-to`,appearFromClass:l=a,appearActiveClass:c=o,appearToClass:d=s,leaveFromClass:u=`${r}-leave-from`,leaveActiveClass:h=`${r}-leave-active`,leaveToClass:f=`${r}-leave-to`}=e,p=dG(n),v=p&&p[0],m=p&&p[1],{onBeforeEnter:g,onEnter:y,onEnterCancelled:b,onLeave:x,onLeaveCancelled:S,onBeforeAppear:w=g,onAppear:_=y,onAppearCancelled:C=b}=t,A=(T,R,z)=>{Fc(T,R?d:s),Fc(T,R?c:o),z&&z()},M=(T,R)=>{T._isLeaving=!1,Fc(T,u),Fc(T,f),Fc(T,h),R&&R()},P=T=>(R,z)=>{const F=T?_:y,H=()=>A(R,T,z);Wd(F,[R,H]),c3(()=>{Fc(R,T?l:a),Pl(R,T?d:s),l3(F)||d3(R,i,v,H)})};return Xi(t,{onBeforeEnter(T){Wd(g,[T]),Pl(T,a),Pl(T,o)},onBeforeAppear(T){Wd(w,[T]),Pl(T,l),Pl(T,c)},onEnter:P(!1),onAppear:P(!0),onLeave(T,R){T._isLeaving=!0;const z=()=>M(T,R);Pl(T,u),Pl(T,h),p5(),c3(()=>{T._isLeaving&&(Fc(T,u),Pl(T,f),l3(x)||d3(T,i,m,z))}),Wd(x,[T,z])},onEnterCancelled(T){A(T,!1),Wd(b,[T])},onAppearCancelled(T){A(T,!0),Wd(C,[T])},onLeaveCancelled(T){M(T),Wd(S,[T])}})}function dG(e){if(e==null)return null;if(gi(e))return[Tw(e.enter),Tw(e.leave)];{const t=Tw(e);return[t,t]}}function Tw(e){return b9(e)}function Pl(e,t){t.split(/\s+/).forEach(r=>r&&e.classList.add(r)),(e[np]||(e[np]=new Set)).add(t)}function Fc(e,t){t.split(/\s+/).forEach(i=>i&&e.classList.remove(i));const r=e[np];r&&(r.delete(t),r.size||(e[np]=void 0))}function c3(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let uG=0;function d3(e,t,r,i){const n=e._endId=++uG,a=()=>{n===e._endId&&i()};if(r)return setTimeout(a,r);const{type:o,timeout:s,propCount:l}=f5(e,t);if(!o)return i();const c=o+"end";let d=0;const u=()=>{e.removeEventListener(c,h),a()},h=f=>{f.target===e&&++d>=l&&u()};setTimeout(()=>{d<l&&u()},s+1),e.addEventListener(c,h)}function f5(e,t){const r=window.getComputedStyle(e),i=p=>(r[p]||"").split(", "),n=i(`${gc}Delay`),a=i(`${gc}Duration`),o=u3(n,a),s=i(`${om}Delay`),l=i(`${om}Duration`),c=u3(s,l);let d=null,u=0,h=0;t===gc?o>0&&(d=gc,u=o,h=a.length):t===om?c>0&&(d=om,u=c,h=l.length):(u=Math.max(o,c),d=u>0?o>c?gc:om:null,h=d?d===gc?a.length:l.length:0);const f=d===gc&&/\b(transform|all)(,|$)/.test(i(`${gc}Property`).toString());return{type:d,timeout:u,propCount:h,hasTransform:f}}function u3(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((r,i)=>h3(r)+h3(e[i])))}function h3(e){return e==="auto"?0:Number(e.slice(0,-1).replace(",","."))*1e3}function p5(){return document.body.offsetHeight}function hG(e,t,r){const i=e[np];i&&(t=(t?[t,...i]:[...i]).join(" ")),t==null?e.removeAttribute("class"):r?e.setAttribute("class",t):e.className=t}const Lb=Symbol("_vod"),m5=Symbol("_vsh"),Gu={beforeMount(e,{value:t},{transition:r}){e[Lb]=e.style.display==="none"?"":e.style.display,r&&t?r.beforeEnter(e):sm(e,t)},mounted(e,{value:t},{transition:r}){r&&t&&r.enter(e)},updated(e,{value:t,oldValue:r},{transition:i}){!t!=!r&&(i?t?(i.beforeEnter(e),sm(e,!0),i.enter(e)):i.leave(e,()=>{sm(e,!1)}):sm(e,t))},beforeUnmount(e,{value:t}){sm(e,t)}};function sm(e,t){e.style.display=t?e[Lb]:"none",e[m5]=!t}const fG=Symbol(""),pG=/(^|;)\s*display\s*:/;function mG(e,t,r){const i=e.style,n=Ki(r);let a=!1;if(r&&!n){if(t)if(Ki(t))for(const o of t.split(";")){const s=o.slice(0,o.indexOf(":")).trim();r[s]==null&&ob(i,s,"")}else for(const o in t)r[o]==null&&ob(i,o,"");for(const o in r)o==="display"&&(a=!0),ob(i,o,r[o])}else if(n){if(t!==r){const o=i[fG];o&&(r+=";"+o),i.cssText=r,a=pG.test(r)}}else t&&e.removeAttribute("style");Lb in e&&(e[Lb]=a?i.display:"",e[m5]&&(i.display="none"))}const f3=/\s*!important$/;function ob(e,t,r){if(Qt(r))r.forEach(i=>ob(e,t,i));else if(r==null&&(r=""),t.startsWith("--"))e.setProperty(t,r);else{const i=vG(e,t);f3.test(r)?e.setProperty(Dp(i),r.replace(f3,""),"important"):e[i]=r}}const p3=["Webkit","Moz","ms"],Pw={};function vG(e,t){const r=Pw[t];if(r)return r;let i=rl(t);if(i!=="filter"&&i in e)return Pw[t]=i;i=f1(i);for(let n=0;n<p3.length;n++){const a=p3[n]+i;if(a in e)return Pw[t]=a}return t}const m3="http://www.w3.org/1999/xlink";function v3(e,t,r,i,n,a=A9(t)){i&&t.startsWith("xlink:")?r==null?e.removeAttributeNS(m3,t.slice(6,t.length)):e.setAttributeNS(m3,t,r):r==null||a&&!dF(r)?e.removeAttribute(t):e.setAttribute(t,a?"":Ed(r)?String(r):r)}function gG(e,t,r,i,n,a,o){if(t==="innerHTML"||t==="textContent"){i&&o(i,n,a),e[t]=r??"";return}const s=e.tagName;if(t==="value"&&s!=="PROGRESS"&&!s.includes("-")){const c=s==="OPTION"?e.getAttribute("value")||"":e.value,d=r==null?"":String(r);(c!==d||!("_value"in e))&&(e.value=d),r==null&&e.removeAttribute(t),e._value=r;return}let l=!1;if(r===""||r==null){const c=typeof e[t];c==="boolean"?r=dF(r):r==null&&c==="string"?(r="",l=!0):c==="number"&&(r=0,l=!0)}try{e[t]=r}catch{}l&&e.removeAttribute(t)}function yG(e,t,r,i){e.addEventListener(t,r,i)}function bG(e,t,r,i){e.removeEventListener(t,r,i)}const g3=Symbol("_vei");function xG(e,t,r,i,n=null){const a=e[g3]||(e[g3]={}),o=a[t];if(i&&o)o.value=i;else{const[s,l]=wG(t);if(i){const c=a[t]=_G(i,n);yG(e,s,c,l)}else o&&(bG(e,s,o,l),a[t]=void 0)}}const y3=/(?:Once|Passive|Capture)$/;function wG(e){let t;if(y3.test(e)){t={};let i;for(;i=e.match(y3);)e=e.slice(0,e.length-i[0].length),t[i[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):Dp(e.slice(2)),t]}let Dw=0;const SG=Promise.resolve(),CG=()=>Dw||(SG.then(()=>Dw=0),Dw=Date.now());function _G(e,t){const r=i=>{if(!i._vts)i._vts=Date.now();else if(i._vts<=r.attached)return;Oo(AG(i,r.value),t,5,[i])};return r.value=e,r.attached=CG(),r}function AG(e,t){if(Qt(t)){const r=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{r.call(e),e._stopped=!0},t.map(i=>n=>!n._stopped&&i&&i(n))}else return t}const b3=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,MG=(e,t,r,i,n,a,o,s,l)=>{const c=n==="svg";t==="class"?hG(e,i,c):t==="style"?mG(e,r,i):d1(t)?ME(t)||xG(e,t,r,i,o):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):EG(e,t,i,c))?(gG(e,t,i,a,o,s,l),!e.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&v3(e,t,i,c,o,t!=="value")):(t==="true-value"?e._trueValue=i:t==="false-value"&&(e._falseValue=i),v3(e,t,i,c))};function EG(e,t,r,i){if(i)return!!(t==="innerHTML"||t==="textContent"||t in e&&b3(t)&&dr(r));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const n=e.tagName;if(n==="IMG"||n==="VIDEO"||n==="CANVAS"||n==="SOURCE")return!1}return b3(t)&&Ki(r)?!1:t in e}const v5=new WeakMap,g5=new WeakMap,Bb=Symbol("_moveCb"),x3=Symbol("_enterCb"),y5={name:"TransitionGroup",props:Xi({},cG,{tag:String,moveClass:String}),setup(e,{slots:t}){const r=lh(),i=t5();let n,a;return UF(()=>{if(!n.length)return;const o=e.moveClass||`${e.name||"v"}-move`;if(!RG(n[0].el,r.vnode.el,o))return;n.forEach(PG),n.forEach(DG);const s=n.filter(OG);p5(),s.forEach(l=>{const c=l.el,d=c.style;Pl(c,o),d.transform=d.webkitTransform=d.transitionDuration="";const u=c[Bb]=h=>{h&&h.target!==c||(!h||/transform$/.test(h.propertyName))&&(c.removeEventListener("transitionend",u),c[Bb]=null,Fc(c,o))};c.addEventListener("transitionend",u)})}),()=>{const o=wr(e),s=h5(o);let l=o.tag||pr;if(n=[],a)for(let c=0;c<a.length;c++){const d=a[c];d.el&&d.el instanceof Element&&(n.push(d),ip(d,Uv(d,s,i,r)),v5.set(d,d.el.getBoundingClientRect()))}a=t.default?qE(t.default()):[];for(let c=0;c<a.length;c++){const d=a[c];d.key!=null&&ip(d,Uv(d,s,i,r))}return Be(l,null,a)}}},TG=e=>delete e.mode;y5.props;const b5=y5;function PG(e){const t=e.el;t[Bb]&&t[Bb](),t[x3]&&t[x3]()}function DG(e){g5.set(e,e.el.getBoundingClientRect())}function OG(e){const t=v5.get(e),r=g5.get(e),i=t.left-r.left,n=t.top-r.top;if(i||n){const a=e.el.style;return a.transform=a.webkitTransform=`translate(${i}px,${n}px)`,a.transitionDuration="0s",e}}function RG(e,t,r){const i=e.cloneNode(),n=e[np];n&&n.forEach(s=>{s.split(/\s+/).forEach(l=>l&&i.classList.remove(l))}),r.split(/\s+/).forEach(s=>s&&i.classList.add(s)),i.style.display="none";const a=t.nodeType===1?t:t.parentNode;a.appendChild(i);const{hasTransform:o}=f5(i);return a.removeChild(i),o}const IG=["ctrl","shift","alt","meta"],zG={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>IG.some(r=>e[`${r}Key`]&&!t.includes(r))},Af=(e,t)=>{const r=e._withMods||(e._withMods={}),i=t.join(".");return r[i]||(r[i]=(n,...a)=>{for(let o=0;o<t.length;o++){const s=zG[t[o]];if(s&&s(n,t))return}return e(n,...a)})},kG=Xi({patchProp:MG},lG);let w3;function LG(){return w3||(w3=z7(kG))}const BG=(...e)=>{const t=LG().createApp(...e),{mount:r}=t;return t.mount=i=>{const n=NG(i);if(!n)return;const a=t._component;!dr(a)&&!a.render&&!a.template&&(a.template=n.innerHTML),n.innerHTML="";const o=r(n,!1,FG(n));return n instanceof Element&&(n.removeAttribute("v-cloak"),n.setAttribute("data-v-app","")),o},t};function FG(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function NG(e){return Ki(e)?document.querySelector(e):e}let Fb=[];const x5=new WeakMap;function UG(){Fb.forEach(e=>e(...x5.get(e))),Fb=[]}function w5(e,...t){x5.set(e,t),!Fb.includes(e)&&Fb.push(e)===1&&requestAnimationFrame(UG)}function yd(e,t){let{target:r}=e;for(;r;){if(r.dataset&&r.dataset[t]!==void 0)return!0;r=r.parentElement}return!1}function Jl(e){return e.composedPath()[0]||null}function rn(e){return typeof e=="string"?e.endsWith("px")?Number(e.slice(0,e.length-2)):Number(e):e}function gu(e){if(e!=null)return typeof e=="number"?`${e}px`:e.endsWith("px")?e:`${e}px`}function Eo(e,t){const r=e.trim().split(/\s+/g),i={top:r[0]};switch(r.length){case 1:i.right=r[0],i.bottom=r[0],i.left=r[0];break;case 2:i.right=r[1],i.left=r[1],i.bottom=r[0];break;case 3:i.right=r[1],i.bottom=r[2],i.left=r[1];break;case 4:i.right=r[1],i.bottom=r[2],i.left=r[3];break;default:throw new Error("[seemly/getMargin]:"+e+" is not a valid value.")}return t===void 0?i:i[t]}function S5(e,t){const[r,i]=e.split(" ");return{row:r,col:i||r}}const S3={black:"#000",silver:"#C0C0C0",gray:"#808080",white:"#FFF",maroon:"#800000",red:"#F00",purple:"#800080",fuchsia:"#F0F",green:"#008000",lime:"#0F0",olive:"#808000",yellow:"#FF0",navy:"#000080",blue:"#00F",teal:"#008080",aqua:"#0FF",transparent:"#0000"},Op="^\\s*",Rp="\\s*$",yu="\\s*((\\.\\d+)|(\\d+(\\.\\d*)?))\\s*",bu="([0-9A-Fa-f])",xu="([0-9A-Fa-f]{2})",jG=new RegExp(`${Op}rgb\\s*\\(${yu},${yu},${yu}\\)${Rp}`),VG=new RegExp(`${Op}rgba\\s*\\(${yu},${yu},${yu},${yu}\\)${Rp}`),HG=new RegExp(`${Op}#${bu}${bu}${bu}${Rp}`),WG=new RegExp(`${Op}#${xu}${xu}${xu}${Rp}`),GG=new RegExp(`${Op}#${bu}${bu}${bu}${bu}${Rp}`),$G=new RegExp(`${Op}#${xu}${xu}${xu}${xu}${Rp}`);function La(e){return parseInt(e,16)}function $u(e){try{let t;if(t=WG.exec(e))return[La(t[1]),La(t[2]),La(t[3]),1];if(t=jG.exec(e))return[ca(t[1]),ca(t[5]),ca(t[9]),1];if(t=VG.exec(e))return[ca(t[1]),ca(t[5]),ca(t[9]),fv(t[13])];if(t=HG.exec(e))return[La(t[1]+t[1]),La(t[2]+t[2]),La(t[3]+t[3]),1];if(t=$G.exec(e))return[La(t[1]),La(t[2]),La(t[3]),fv(La(t[4])/255)];if(t=GG.exec(e))return[La(t[1]+t[1]),La(t[2]+t[2]),La(t[3]+t[3]),fv(La(t[4]+t[4])/255)];if(e in S3)return $u(S3[e]);throw new Error(`[seemly/rgba]: Invalid color value ${e}.`)}catch(t){throw t}}function qG(e){return e>1?1:e<0?0:e}function H_(e,t,r,i){return`rgba(${ca(e)}, ${ca(t)}, ${ca(r)}, ${qG(i)})`}function Ow(e,t,r,i,n){return ca((e*t*(1-i)+r*i)/n)}function Xs(e,t){Array.isArray(e)||(e=$u(e)),Array.isArray(t)||(t=$u(t));const r=e[3],i=t[3],n=fv(r+i-r*i);return H_(Ow(e[0],r,t[0],i,n),Ow(e[1],r,t[1],i,n),Ow(e[2],r,t[2],i,n),n)}function Yt(e,t){const[r,i,n,a=1]=Array.isArray(e)?e:$u(e);return t.alpha?H_(r,i,n,t.alpha):H_(r,i,n,a)}function p0(e,t){const[r,i,n,a=1]=Array.isArray(e)?e:$u(e),{lightness:o=1,alpha:s=1}=t;return YG([r*o,i*o,n*o,a*s])}function fv(e){const t=Math.round(Number(e)*100)/100;return t>1?1:t<0?0:t}function ca(e){const t=Math.round(Number(e));return t>255?255:t<0?0:t}function YG(e){const[t,r,i]=e;return 3 in e?`rgba(${ca(t)}, ${ca(r)}, ${ca(i)}, ${fv(e[3])})`:`rgba(${ca(t)}, ${ca(r)}, ${ca(i)}, 1)`}function qu(e=8){return Math.random().toString(16).slice(2,2+e)}function C5(e,t="default",r=[]){const n=e.$slots[t];return n===void 0?r:n()}function pv(e,t=[],r){const i={};return t.forEach(n=>{i[n]=e[n]}),Object.assign(i,r)}function _5(e,t=[],r){const i={};return Object.getOwnPropertyNames(e).forEach(a=>{t.includes(a)||(i[a]=e[a])}),Object.assign(i,r)}function ud(e,t=!0,r=[]){return e.forEach(i=>{if(i!==null){if(typeof i!="object"){(typeof i=="string"||typeof i=="number")&&r.push(Pr(String(i)));return}if(Array.isArray(i)){ud(i,t,r);return}if(i.type===pr){if(i.children===null)return;Array.isArray(i.children)&&ud(i.children,t,r)}else{if(i.type===On&&t)return;r.push(i)}}}),r}function ct(e,...t){if(Array.isArray(e))e.forEach(r=>ct(r,...t));else return e(...t)}function Hv(e){return Object.keys(e)}const kn=(e,...t)=>typeof e=="function"?e(...t):typeof e=="string"?Pr(e):typeof e=="number"?Pr(String(e)):null;function Yu(e,t){console.error(`[naive/${e}]: ${t}`)}function C1(e,t){throw new Error(`[naive/${e}]: ${t}`)}function W_(e){switch(typeof e){case"string":return e||void 0;case"number":return String(e);default:return}}function G_(e,t="default",r=void 0){const i=e[t];if(!i)return Yu("getFirstSlotVNode",`slot[${t}] is empty`),null;const n=ud(i(r));return n.length===1?n[0]:(Yu("getFirstSlotVNode",`slot[${t}] should have exactly one child`),null)}function XG(e){return t=>{t?e.value=t.$el:e.value=null}}function Dg(e){return e.some(t=>Vv(t)?!(t.type===On||t.type===pr&&!Dg(t.children)):!0)?e:null}function Sr(e,t){return e&&Dg(e())||t()}function $_(e,t,r){return e&&Dg(e(t))||r(t)}function ei(e,t){const r=e&&Dg(e());return t(r||null)}function Bf(e){return!(e&&Dg(e()))}function Rw(e){const t=e.filter(r=>r!==void 0);if(t.length!==0)return t.length===1?t[0]:r=>{e.forEach(i=>{i&&i(r)})}}const q_=Ve({render(){var e,t;return(t=(e=this.$slots).default)===null||t===void 0?void 0:t.call(e)}}),KG=/^(\d|\.)+$/,C3=/(\d|\.)+/;function os(e,{c:t=1,offset:r=0,attachPx:i=!0}={}){if(typeof e=="number"){const n=(e+r)*t;return n===0?"0":`${n}px`}else if(typeof e=="string")if(KG.test(e)){const n=(Number(e)+r)*t;return i?n===0?"0":`${n}px`:`${n}`}else{const n=C3.exec(e);return n?e.replace(C3,String((Number(n[0])+r)*t)):e}return e}function Wv(e){return e.replace(/#|\(|\)|,|\s|\./g,"_")}function QG(e){const{left:t,right:r,top:i,bottom:n}=Eo(e);return`${i} ${r} ${n} ${t}`}function ZG(e){let t=0;for(let r=0;r<e.length;++r)e[r]==="&"&&++t;return t}const A5=/\s*,(?![^(]*\))\s*/g,JG=/\s+/g;function e$(e,t){const r=[];return t.split(A5).forEach(i=>{let n=ZG(i);if(n){if(n===1){e.forEach(o=>{r.push(i.replace("&",o))});return}}else{e.forEach(o=>{r.push((o&&o+" ")+i)});return}let a=[i];for(;n--;){const o=[];a.forEach(s=>{e.forEach(l=>{o.push(s.replace("&",l))})}),a=o}a.forEach(o=>r.push(o))}),r}function t$(e,t){const r=[];return t.split(A5).forEach(i=>{e.forEach(n=>{r.push((n&&n+" ")+i)})}),r}function r$(e){let t=[""];return e.forEach(r=>{r=r&&r.trim(),r&&(r.includes("&")?t=e$(t,r):t=t$(t,r))}),t.join(", ").replace(JG," ")}function _3(e){if(!e)return;const t=e.parentElement;t&&t.removeChild(e)}function _1(e,t){return(t??document.head).querySelector(`style[cssr-id="${e}"]`)}function i$(e){const t=document.createElement("style");return t.setAttribute("cssr-id",e),t}function m0(e){return e?/^\s*@(s|m)/.test(e):!1}const n$=/[A-Z]/g;function M5(e){return e.replace(n$,t=>"-"+t.toLowerCase())}function a$(e,t="  "){return typeof e=="object"&&e!==null?` {
`+Object.entries(e).map(r=>t+`  ${M5(r[0])}: ${r[1]};`).join(`
`)+`
`+t+"}":`: ${e};`}function o$(e,t,r){return typeof e=="function"?e({context:t.context,props:r}):e}function A3(e,t,r,i){if(!t)return"";const n=o$(t,r,i);if(!n)return"";if(typeof n=="string")return`${e} {
${n}
}`;const a=Object.keys(n);if(a.length===0)return r.config.keepEmptyBlock?e+` {
}`:"";const o=e?[e+" {"]:[];return a.forEach(s=>{const l=n[s];if(s==="raw"){o.push(`
`+l+`
`);return}s=M5(s),l!=null&&o.push(`  ${s}${a$(l)}`)}),e&&o.push("}"),o.join(`
`)}function Y_(e,t,r){e&&e.forEach(i=>{if(Array.isArray(i))Y_(i,t,r);else if(typeof i=="function"){const n=i(t);Array.isArray(n)?Y_(n,t,r):n&&r(n)}else i&&r(i)})}function E5(e,t,r,i,n){const a=e.$;let o="";if(!a||typeof a=="string")m0(a)?o=a:t.push(a);else if(typeof a=="function"){const c=a({context:i.context,props:n});m0(c)?o=c:t.push(c)}else if(a.before&&a.before(i.context),!a.$||typeof a.$=="string")m0(a.$)?o=a.$:t.push(a.$);else if(a.$){const c=a.$({context:i.context,props:n});m0(c)?o=c:t.push(c)}const s=r$(t),l=A3(s,e.props,i,n);o?r.push(`${o} {`):l.length&&r.push(l),e.children&&Y_(e.children,{context:i.context,props:n},c=>{if(typeof c=="string"){const d=A3(s,{raw:c},i,n);r.push(d)}else E5(c,t,r,i,n)}),t.pop(),o&&r.push("}"),a&&a.after&&a.after(i.context)}function s$(e,t,r){const i=[];return E5(e,[],i,t,r),i.join(`

`)}function X_(e){for(var t=0,r,i=0,n=e.length;n>=4;++i,n-=4)r=e.charCodeAt(i)&255|(e.charCodeAt(++i)&255)<<8|(e.charCodeAt(++i)&255)<<16|(e.charCodeAt(++i)&255)<<24,r=(r&65535)*1540483477+((r>>>16)*59797<<16),r^=r>>>24,t=(r&65535)*1540483477+((r>>>16)*59797<<16)^(t&65535)*1540483477+((t>>>16)*59797<<16);switch(n){case 3:t^=(e.charCodeAt(i+2)&255)<<16;case 2:t^=(e.charCodeAt(i+1)&255)<<8;case 1:t^=e.charCodeAt(i)&255,t=(t&65535)*1540483477+((t>>>16)*59797<<16)}return t^=t>>>13,t=(t&65535)*1540483477+((t>>>16)*59797<<16),((t^t>>>15)>>>0).toString(36)}typeof window<"u"&&(window.__cssrContext={});function l$(e,t,r,i){const{els:n}=t;if(r===void 0)n.forEach(_3),t.els=[];else{const a=_1(r,i);a&&n.includes(a)&&(_3(a),t.els=n.filter(o=>o!==a))}}function M3(e,t){e.push(t)}function c$(e,t,r,i,n,a,o,s,l){let c;if(r===void 0&&(c=t.render(i),r=X_(c)),l){l.adapter(r,c??t.render(i));return}s===void 0&&(s=document.head);const d=_1(r,s);if(d!==null&&!a)return d;const u=d??i$(r);if(c===void 0&&(c=t.render(i)),u.textContent=c,d!==null)return d;if(o){const h=s.querySelector(`meta[name="${o}"]`);if(h)return s.insertBefore(u,h),M3(t.els,u),u}return n?s.insertBefore(u,s.querySelector("style, link")):s.appendChild(u),M3(t.els,u),u}function d$(e){return s$(this,this.instance,e)}function u$(e={}){const{id:t,ssr:r,props:i,head:n=!1,force:a=!1,anchorMetaName:o,parent:s}=e;return c$(this.instance,this,t,i,n,a,o,s,r)}function h$(e={}){const{id:t,parent:r}=e;l$(this.instance,this,t,r)}const v0=function(e,t,r,i){return{instance:e,$:t,props:r,children:i,els:[],render:d$,mount:u$,unmount:h$}},f$=function(e,t,r,i){return Array.isArray(t)?v0(e,{$:null},null,t):Array.isArray(r)?v0(e,t,null,r):Array.isArray(i)?v0(e,t,r,i):v0(e,t,r,null)};function T5(e={}){const t={c:(...r)=>f$(t,...r),use:(r,...i)=>r.install(t,...i),find:_1,context:{},config:e};return t}function p$(e,t){if(e===void 0)return!1;if(t){const{context:{ids:r}}=t;return r.has(e)}return _1(e)!==null}function m$(e){let t=".",r="__",i="--",n;if(e){let p=e.blockPrefix;p&&(t=p),p=e.elementPrefix,p&&(r=p),p=e.modifierPrefix,p&&(i=p)}const a={install(p){n=p.c;const v=p.context;v.bem={},v.bem.b=null,v.bem.els=null}};function o(p){let v,m;return{before(g){v=g.bem.b,m=g.bem.els,g.bem.els=null},after(g){g.bem.b=v,g.bem.els=m},$({context:g,props:y}){return p=typeof p=="string"?p:p({context:g,props:y}),g.bem.b=p,`${(y==null?void 0:y.bPrefix)||t}${g.bem.b}`}}}function s(p){let v;return{before(m){v=m.bem.els},after(m){m.bem.els=v},$({context:m,props:g}){return p=typeof p=="string"?p:p({context:m,props:g}),m.bem.els=p.split(",").map(y=>y.trim()),m.bem.els.map(y=>`${(g==null?void 0:g.bPrefix)||t}${m.bem.b}${r}${y}`).join(", ")}}}function l(p){return{$({context:v,props:m}){p=typeof p=="string"?p:p({context:v,props:m});const g=p.split(",").map(x=>x.trim());function y(x){return g.map(S=>`&${(m==null?void 0:m.bPrefix)||t}${v.bem.b}${x!==void 0?`${r}${x}`:""}${i}${S}`).join(", ")}const b=v.bem.els;return b!==null?y(b[0]):y()}}}function c(p){return{$({context:v,props:m}){p=typeof p=="string"?p:p({context:v,props:m});const g=v.bem.els;return`&:not(${(m==null?void 0:m.bPrefix)||t}${v.bem.b}${g!==null&&g.length>0?`${r}${g[0]}`:""}${i}${p})`}}}return Object.assign(a,{cB:(...p)=>n(o(p[0]),p[1],p[2]),cE:(...p)=>n(s(p[0]),p[1],p[2]),cM:(...p)=>n(l(p[0]),p[1],p[2]),cNotM:(...p)=>n(c(p[0]),p[1],p[2])}),a}const v$="n",Nb=`.${v$}-`,g$="__",y$="--",P5=T5(),D5=m$({blockPrefix:Nb,elementPrefix:g$,modifierPrefix:y$});P5.use(D5);const{c:ve,find:ANe}=P5,{cB:oe,cE:he,cM:xe,cNotM:yr}=D5;function O5(e){return ve(({props:{bPrefix:t}})=>`${t||Nb}modal, ${t||Nb}drawer`,[e])}function R5(e){return ve(({props:{bPrefix:t}})=>`${t||Nb}popover`,[e])}const b$=(...e)=>ve(">",[oe(...e)]);function Ze(e,t){return e+(t==="default"?"":t.replace(/^[a-z]/,r=>r.toUpperCase()))}let Iw;function x$(){return Iw===void 0&&(Iw=navigator.userAgent.includes("Node.js")||navigator.userAgent.includes("jsdom")),Iw}const Id=typeof document<"u"&&typeof window<"u",w$=new WeakSet;function Gv(e){w$.add(e)}function S$(e,t,r){var i;const n=_t(e,null);if(n===null)return;const a=(i=lh())===null||i===void 0?void 0:i.proxy;tr(r,o),o(r.value),na(()=>{o(void 0,r.value)});function o(c,d){if(!n)return;const u=n[t];d!==void 0&&s(u,d),c!==void 0&&l(u,c)}function s(c,d){c[d]||(c[d]=[]),c[d].splice(c[d].findIndex(u=>u===a),1)}function l(c,d){c[d]||(c[d]=[]),~c[d].findIndex(u=>u===a)||c[d].push(a)}}function C$(e,t,r){const i=ge(e.value);let n=null;return tr(e,a=>{n!==null&&window.clearTimeout(n),a===!0?r&&!r.value?i.value=!0:n=window.setTimeout(()=>{i.value=!0},t):i.value=!1}),i}function _$(e){const t=ge(!!e.value);if(t.value)return rp(t);const r=tr(e,i=>{i&&(t.value=!0,r())});return rp(t)}function $i(e){const t=re(e),r=ge(t.value);return tr(t,i=>{r.value=i}),typeof e=="function"?r:{__v_isRef:!0,get value(){return r.value},set value(i){e.set(i)}}}function A$(){return lh()!==null}const M$=typeof window<"u";let Ff,mv;const E$=()=>{var e,t;Ff=M$?(t=(e=document)===null||e===void 0?void 0:e.fonts)===null||t===void 0?void 0:t.ready:void 0,mv=!1,Ff!==void 0?Ff.then(()=>{mv=!0}):mv=!0};E$();function I5(e){if(mv)return;let t=!1;Or(()=>{mv||Ff==null||Ff.then(()=>{t||e()})}),na(()=>{t=!0})}function sb(e){return e.composedPath()[0]}const T$={mousemoveoutside:new WeakMap,clickoutside:new WeakMap};function P$(e,t,r){if(e==="mousemoveoutside"){const i=n=>{t.contains(sb(n))||r(n)};return{mousemove:i,touchstart:i}}else if(e==="clickoutside"){let i=!1;const n=o=>{i=!t.contains(sb(o))},a=o=>{i&&(t.contains(sb(o))||r(o))};return{mousedown:n,mouseup:a,touchstart:n,touchend:a}}return console.error(`[evtd/create-trap-handler]: name \`${e}\` is invalid. This could be a bug of evtd.`),{}}function z5(e,t,r){const i=T$[e];let n=i.get(t);n===void 0&&i.set(t,n=new WeakMap);let a=n.get(r);return a===void 0&&n.set(r,a=P$(e,t,r)),a}function D$(e,t,r,i){if(e==="mousemoveoutside"||e==="clickoutside"){const n=z5(e,t,r);return Object.keys(n).forEach(a=>{Ni(a,document,n[a],i)}),!0}return!1}function O$(e,t,r,i){if(e==="mousemoveoutside"||e==="clickoutside"){const n=z5(e,t,r);return Object.keys(n).forEach(a=>{wi(a,document,n[a],i)}),!0}return!1}function R$(){if(typeof window>"u")return{on:()=>{},off:()=>{}};const e=new WeakMap,t=new WeakMap;function r(){e.set(this,!0)}function i(){e.set(this,!0),t.set(this,!0)}function n(_,C,A){const M=_[C];return _[C]=function(){return A.apply(_,arguments),M.apply(_,arguments)},_}function a(_,C){_[C]=Event.prototype[C]}const o=new WeakMap,s=Object.getOwnPropertyDescriptor(Event.prototype,"currentTarget");function l(){var _;return(_=o.get(this))!==null&&_!==void 0?_:null}function c(_,C){s!==void 0&&Object.defineProperty(_,"currentTarget",{configurable:!0,enumerable:!0,get:C??s.get})}const d={bubble:{},capture:{}},u={};function h(){const _=function(C){const{type:A,eventPhase:M,bubbles:P}=C,T=sb(C);if(M===2)return;const R=M===1?"capture":"bubble";let z=T;const F=[];for(;z===null&&(z=window),F.push(z),z!==window;)z=z.parentNode||null;const H=d.capture[A],N=d.bubble[A];if(n(C,"stopPropagation",r),n(C,"stopImmediatePropagation",i),c(C,l),R==="capture"){if(H===void 0)return;for(let U=F.length-1;U>=0&&!e.has(C);--U){const ie=F[U],te=H.get(ie);if(te!==void 0){o.set(C,ie);for(const X of te){if(t.has(C))break;X(C)}}if(U===0&&!P&&N!==void 0){const X=N.get(ie);if(X!==void 0)for(const W of X){if(t.has(C))break;W(C)}}}}else if(R==="bubble"){if(N===void 0)return;for(let U=0;U<F.length&&!e.has(C);++U){const ie=F[U],te=N.get(ie);if(te!==void 0){o.set(C,ie);for(const X of te){if(t.has(C))break;X(C)}}}}a(C,"stopPropagation"),a(C,"stopImmediatePropagation"),c(C)};return _.displayName="evtdUnifiedHandler",_}function f(){const _=function(C){const{type:A,eventPhase:M}=C;if(M!==2)return;const P=u[A];P!==void 0&&P.forEach(T=>T(C))};return _.displayName="evtdUnifiedWindowEventHandler",_}const p=h(),v=f();function m(_,C){const A=d[_];return A[C]===void 0&&(A[C]=new Map,window.addEventListener(C,p,_==="capture")),A[C]}function g(_){return u[_]===void 0&&(u[_]=new Set,window.addEventListener(_,v)),u[_]}function y(_,C){let A=_.get(C);return A===void 0&&_.set(C,A=new Set),A}function b(_,C,A,M){const P=d[C][A];if(P!==void 0){const T=P.get(_);if(T!==void 0&&T.has(M))return!0}return!1}function x(_,C){const A=u[_];return!!(A!==void 0&&A.has(C))}function S(_,C,A,M){let P;if(typeof M=="object"&&M.once===!0?P=H=>{w(_,C,P,M),A(H)}:P=A,D$(_,C,P,M))return;const R=M===!0||typeof M=="object"&&M.capture===!0?"capture":"bubble",z=m(R,_),F=y(z,C);if(F.has(P)||F.add(P),C===window){const H=g(_);H.has(P)||H.add(P)}}function w(_,C,A,M){if(O$(_,C,A,M))return;const T=M===!0||typeof M=="object"&&M.capture===!0,R=T?"capture":"bubble",z=m(R,_),F=y(z,C);if(C===window&&!b(C,T?"bubble":"capture",_,A)&&x(_,A)){const N=u[_];N.delete(A),N.size===0&&(window.removeEventListener(_,v),u[_]=void 0)}F.has(A)&&F.delete(A),F.size===0&&z.delete(C),z.size===0&&(window.removeEventListener(_,p,R==="capture"),d[R][_]=void 0)}return{on:S,off:w}}const{on:Ni,off:wi}=R$();function Un(e,t){return tr(e,r=>{r!==void 0&&(t.value=r)}),re(()=>e.value===void 0?t.value:e.value)}function zd(){const e=ge(!1);return Or(()=>{e.value=!0}),rp(e)}function ap(e,t){return re(()=>{for(const r of t)if(e[r]!==void 0)return e[r];return e[t[t.length-1]]})}const I$=(typeof window>"u"?!1:/iPad|iPhone|iPod/.test(navigator.platform)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1)&&!window.MSStream;function z$(){return I$}function XE(e={},t){const r=Dd({ctrl:!1,command:!1,win:!1,shift:!1,tab:!1}),{keydown:i,keyup:n}=e,a=l=>{switch(l.key){case"Control":r.ctrl=!0;break;case"Meta":r.command=!0,r.win=!0;break;case"Shift":r.shift=!0;break;case"Tab":r.tab=!0;break}i!==void 0&&Object.keys(i).forEach(c=>{if(c!==l.key)return;const d=i[c];if(typeof d=="function")d(l);else{const{stop:u=!1,prevent:h=!1}=d;u&&l.stopPropagation(),h&&l.preventDefault(),d.handler(l)}})},o=l=>{switch(l.key){case"Control":r.ctrl=!1;break;case"Meta":r.command=!1,r.win=!1;break;case"Shift":r.shift=!1;break;case"Tab":r.tab=!1;break}n!==void 0&&Object.keys(n).forEach(c=>{if(c!==l.key)return;const d=n[c];if(typeof d=="function")d(l);else{const{stop:u=!1,prevent:h=!1}=d;u&&l.stopPropagation(),h&&l.preventDefault(),d.handler(l)}})},s=()=>{(t===void 0||t.value)&&(Ni("keydown",document,a),Ni("keyup",document,o)),t!==void 0&&tr(t,l=>{l?(Ni("keydown",document,a),Ni("keyup",document,o)):(wi("keydown",document,a),wi("keyup",document,o))})};return A$()?(Mg(s),na(()=>{(t===void 0||t.value)&&(wi("keydown",document,a),wi("keyup",document,o))})):s(),rp(r)}const KE="n-internal-select-menu",k5="n-internal-select-menu-body",QE="n-modal-body",ZE="n-drawer-body",A1="n-popover-body",L5="__disabled__";function jn(e){const t=_t(QE,null),r=_t(ZE,null),i=_t(A1,null),n=_t(k5,null),a=ge();if(typeof document<"u"){a.value=document.fullscreenElement;const o=()=>{a.value=document.fullscreenElement};Or(()=>{Ni("fullscreenchange",document,o)}),na(()=>{wi("fullscreenchange",document,o)})}return $i(()=>{var o;const{to:s}=e;return s!==void 0?s===!1?L5:s===!0?a.value||"body":s:t!=null&&t.value?(o=t.value.$el)!==null&&o!==void 0?o:t.value:r!=null&&r.value?r.value:i!=null&&i.value?i.value:n!=null&&n.value?n.value:s??(a.value||"body")})}jn.tdkey=L5;jn.propTo={type:[String,Object,Boolean],default:void 0};let E3=!1;function k$(){if(Id&&window.CSS&&!E3&&(E3=!0,"registerProperty"in(window==null?void 0:window.CSS)))try{CSS.registerProperty({name:"--n-color-start",syntax:"<color>",inherits:!1,initialValue:"#0000"}),CSS.registerProperty({name:"--n-color-end",syntax:"<color>",inherits:!1,initialValue:"#0000"})}catch{}}function K_(e,t,r="default"){const i=t[r];if(i===void 0)throw new Error(`[vueuc/${e}]: slot[${r}] is empty.`);return i()}function Q_(e,t=!0,r=[]){return e.forEach(i=>{if(i!==null){if(typeof i!="object"){(typeof i=="string"||typeof i=="number")&&r.push(Pr(String(i)));return}if(Array.isArray(i)){Q_(i,t,r);return}if(i.type===pr){if(i.children===null)return;Array.isArray(i.children)&&Q_(i.children,t,r)}else i.type!==On&&r.push(i)}}),r}function T3(e,t,r="default"){const i=t[r];if(i===void 0)throw new Error(`[vueuc/${e}]: slot[${r}] is empty.`);const n=Q_(i());if(n.length===1)return n[0];throw new Error(`[vueuc/${e}]: slot[${r}] should have exactly one child.`)}let yc=null;function B5(){if(yc===null&&(yc=document.getElementById("v-binder-view-measurer"),yc===null)){yc=document.createElement("div"),yc.id="v-binder-view-measurer";const{style:e}=yc;e.position="fixed",e.left="0",e.right="0",e.top="0",e.bottom="0",e.pointerEvents="none",e.visibility="hidden",document.body.appendChild(yc)}return yc.getBoundingClientRect()}function L$(e,t){const r=B5();return{top:t,left:e,height:0,width:0,right:r.width-e,bottom:r.height-t}}function zw(e){const t=e.getBoundingClientRect(),r=B5();return{left:t.left-r.left,top:t.top-r.top,bottom:r.height+r.top-t.bottom,right:r.width+r.left-t.right,width:t.width,height:t.height}}function B$(e){return e.nodeType===9?null:e.parentNode}function F5(e){if(e===null)return null;const t=B$(e);if(t===null)return null;if(t.nodeType===9)return document;if(t.nodeType===1){const{overflow:r,overflowX:i,overflowY:n}=getComputedStyle(t);if(/(auto|scroll|overlay)/.test(r+n+i))return t}return F5(t)}const ch=Ve({name:"Binder",props:{syncTargetWithParent:Boolean,syncTarget:{type:Boolean,default:!0}},setup(e){var t;br("VBinder",(t=lh())===null||t===void 0?void 0:t.proxy);const r=_t("VBinder",null),i=ge(null),n=g=>{i.value=g,r&&e.syncTargetWithParent&&r.setTargetRef(g)};let a=[];const o=()=>{let g=i.value;for(;g=F5(g),g!==null;)a.push(g);for(const y of a)Ni("scroll",y,u,!0)},s=()=>{for(const g of a)wi("scroll",g,u,!0);a=[]},l=new Set,c=g=>{l.size===0&&o(),l.has(g)||l.add(g)},d=g=>{l.has(g)&&l.delete(g),l.size===0&&s()},u=()=>{w5(h)},h=()=>{l.forEach(g=>g())},f=new Set,p=g=>{f.size===0&&Ni("resize",window,m),f.has(g)||f.add(g)},v=g=>{f.has(g)&&f.delete(g),f.size===0&&wi("resize",window,m)},m=()=>{f.forEach(g=>g())};return na(()=>{wi("resize",window,m),s()}),{targetRef:i,setTargetRef:n,addScrollListener:c,removeScrollListener:d,addResizeListener:p,removeResizeListener:v}},render(){return K_("binder",this.$slots)}}),dh=Ve({name:"Target",setup(){const{setTargetRef:e,syncTarget:t}=_t("VBinder");return{syncTarget:t,setTargetDirective:{mounted:e,updated:e}}},render(){const{syncTarget:e,setTargetDirective:t}=this;return e?Ka(T3("follower",this.$slots),[[t]]):T3("follower",this.$slots)}}),Th="@@mmoContext",F$={mounted(e,{value:t}){e[Th]={handler:void 0},typeof t=="function"&&(e[Th].handler=t,Ni("mousemoveoutside",e,t))},updated(e,{value:t}){const r=e[Th];typeof t=="function"?r.handler?r.handler!==t&&(wi("mousemoveoutside",e,r.handler),r.handler=t,Ni("mousemoveoutside",e,t)):(e[Th].handler=t,Ni("mousemoveoutside",e,t)):r.handler&&(wi("mousemoveoutside",e,r.handler),r.handler=void 0)},unmounted(e){const{handler:t}=e[Th];t&&wi("mousemoveoutside",e,t),e[Th].handler=void 0}},Ph="@@coContext",bd={mounted(e,{value:t,modifiers:r}){e[Ph]={handler:void 0},typeof t=="function"&&(e[Ph].handler=t,Ni("clickoutside",e,t,{capture:r.capture}))},updated(e,{value:t,modifiers:r}){const i=e[Ph];typeof t=="function"?i.handler?i.handler!==t&&(wi("clickoutside",e,i.handler,{capture:r.capture}),i.handler=t,Ni("clickoutside",e,t,{capture:r.capture})):(e[Ph].handler=t,Ni("clickoutside",e,t,{capture:r.capture})):i.handler&&(wi("clickoutside",e,i.handler,{capture:r.capture}),i.handler=void 0)},unmounted(e,{modifiers:t}){const{handler:r}=e[Ph];r&&wi("clickoutside",e,r,{capture:t.capture}),e[Ph].handler=void 0}};function N$(e,t){console.error(`[vdirs/${e}]: ${t}`)}class U${constructor(){this.elementZIndex=new Map,this.nextZIndex=2e3}get elementCount(){return this.elementZIndex.size}ensureZIndex(t,r){const{elementZIndex:i}=this;if(r!==void 0){t.style.zIndex=`${r}`,i.delete(t);return}const{nextZIndex:n}=this;i.has(t)&&i.get(t)+1===this.nextZIndex||(t.style.zIndex=`${n}`,i.set(t,n),this.nextZIndex=n+1,this.squashState())}unregister(t,r){const{elementZIndex:i}=this;i.has(t)?i.delete(t):r===void 0&&N$("z-index-manager/unregister-element","Element not found when unregistering."),this.squashState()}squashState(){const{elementCount:t}=this;t||(this.nextZIndex=2e3),this.nextZIndex-t>2500&&this.rearrange()}rearrange(){const t=Array.from(this.elementZIndex.entries());t.sort((r,i)=>r[1]-i[1]),this.nextZIndex=2e3,t.forEach(r=>{const i=r[0],n=this.nextZIndex++;`${n}`!==i.style.zIndex&&(i.style.zIndex=`${n}`)})}}const kw=new U$,Dh="@@ziContext",N5={mounted(e,t){const{value:r={}}=t,{zIndex:i,enabled:n}=r;e[Dh]={enabled:!!n,initialized:!1},n&&(kw.ensureZIndex(e,i),e[Dh].initialized=!0)},updated(e,t){const{value:r={}}=t,{zIndex:i,enabled:n}=r,a=e[Dh].enabled;n&&!a&&(kw.ensureZIndex(e,i),e[Dh].initialized=!0),e[Dh].enabled=!!n},unmounted(e,t){if(!e[Dh].initialized)return;const{value:r={}}=t,{zIndex:i}=r;kw.unregister(e,i)}},j$="@css-render/vue3-ssr";function V$(e,t){return`<style cssr-id="${e}">
${t}
</style>`}function H$(e,t,r){const{styles:i,ids:n}=r;n.has(e)||i!==null&&(n.add(e),i.push(V$(e,t)))}const W$=typeof document<"u";function kd(){if(W$)return;const e=_t(j$,null);if(e!==null)return{adapter:(t,r)=>H$(t,r,e),context:e}}function P3(e,t){console.error(`[vueuc/${e}]: ${t}`)}const{c:$s}=T5(),M1="vueuc-style";function D3(e){return e&-e}class G${constructor(t,r){this.l=t,this.min=r;const i=new Array(t+1);for(let n=0;n<t+1;++n)i[n]=0;this.ft=i}add(t,r){if(r===0)return;const{l:i,ft:n}=this;for(t+=1;t<=i;)n[t]+=r,t+=D3(t)}get(t){return this.sum(t+1)-this.sum(t)}sum(t){if(t===void 0&&(t=this.l),t<=0)return 0;const{ft:r,min:i,l:n}=this;if(t>n)throw new Error("[FinweckTree.sum]: `i` is larger than length.");let a=t*i;for(;t>0;)a+=r[t],t-=D3(t);return a}getBound(t){let r=0,i=this.l;for(;i>r;){const n=Math.floor((r+i)/2),a=this.sum(n);if(a>t){i=n;continue}else if(a<t){if(r===n)return this.sum(r+1)<=t?r+1:n;r=n}else return n}return r}}function O3(e){return typeof e=="string"?document.querySelector(e):e()}const $$=Ve({name:"LazyTeleport",props:{to:{type:[String,Object],default:void 0},disabled:Boolean,show:{type:Boolean,required:!0}},setup(e){return{showTeleport:_$(pt(e,"show")),mergedTo:re(()=>{const{to:t}=e;return t??"body"})}},render(){return this.showTeleport?this.disabled?K_("lazy-teleport",this.$slots):E(a5,{disabled:this.disabled,to:this.mergedTo},K_("lazy-teleport",this.$slots)):null}}),g0={top:"bottom",bottom:"top",left:"right",right:"left"},R3={start:"end",center:"center",end:"start"},Lw={top:"height",bottom:"height",left:"width",right:"width"},q$={"bottom-start":"top left",bottom:"top center","bottom-end":"top right","top-start":"bottom left",top:"bottom center","top-end":"bottom right","right-start":"top left",right:"center left","right-end":"bottom left","left-start":"top right",left:"center right","left-end":"bottom right"},Y$={"bottom-start":"bottom left",bottom:"bottom center","bottom-end":"bottom right","top-start":"top left",top:"top center","top-end":"top right","right-start":"top right",right:"center right","right-end":"bottom right","left-start":"top left",left:"center left","left-end":"bottom left"},X$={"bottom-start":"right","bottom-end":"left","top-start":"right","top-end":"left","right-start":"bottom","right-end":"top","left-start":"bottom","left-end":"top"},I3={top:!0,bottom:!1,left:!0,right:!1},z3={top:"end",bottom:"start",left:"end",right:"start"};function K$(e,t,r,i,n,a){if(!n||a)return{placement:e,top:0,left:0};const[o,s]=e.split("-");let l=s??"center",c={top:0,left:0};const d=(f,p,v)=>{let m=0,g=0;const y=r[f]-t[p]-t[f];return y>0&&i&&(v?g=I3[p]?y:-y:m=I3[p]?y:-y),{left:m,top:g}},u=o==="left"||o==="right";if(l!=="center"){const f=X$[e],p=g0[f],v=Lw[f];if(r[v]>t[v]){if(t[f]+t[v]<r[v]){const m=(r[v]-t[v])/2;t[f]<m||t[p]<m?t[f]<t[p]?(l=R3[s],c=d(v,p,u)):c=d(v,f,u):l="center"}}else r[v]<t[v]&&t[p]<0&&t[f]>t[p]&&(l=R3[s])}else{const f=o==="bottom"||o==="top"?"left":"top",p=g0[f],v=Lw[f],m=(r[v]-t[v])/2;(t[f]<m||t[p]<m)&&(t[f]>t[p]?(l=z3[f],c=d(v,f,u)):(l=z3[p],c=d(v,p,u)))}let h=o;return t[o]<r[Lw[o]]&&t[o]<t[g0[o]]&&(h=g0[o]),{placement:l!=="center"?`${h}-${l}`:h,left:c.left,top:c.top}}function Q$(e,t){return t?Y$[e]:q$[e]}function Z$(e,t,r,i,n,a){if(a)switch(e){case"bottom-start":return{top:`${Math.round(r.top-t.top+r.height)}px`,left:`${Math.round(r.left-t.left)}px`,transform:"translateY(-100%)"};case"bottom-end":return{top:`${Math.round(r.top-t.top+r.height)}px`,left:`${Math.round(r.left-t.left+r.width)}px`,transform:"translateX(-100%) translateY(-100%)"};case"top-start":return{top:`${Math.round(r.top-t.top)}px`,left:`${Math.round(r.left-t.left)}px`,transform:""};case"top-end":return{top:`${Math.round(r.top-t.top)}px`,left:`${Math.round(r.left-t.left+r.width)}px`,transform:"translateX(-100%)"};case"right-start":return{top:`${Math.round(r.top-t.top)}px`,left:`${Math.round(r.left-t.left+r.width)}px`,transform:"translateX(-100%)"};case"right-end":return{top:`${Math.round(r.top-t.top+r.height)}px`,left:`${Math.round(r.left-t.left+r.width)}px`,transform:"translateX(-100%) translateY(-100%)"};case"left-start":return{top:`${Math.round(r.top-t.top)}px`,left:`${Math.round(r.left-t.left)}px`,transform:""};case"left-end":return{top:`${Math.round(r.top-t.top+r.height)}px`,left:`${Math.round(r.left-t.left)}px`,transform:"translateY(-100%)"};case"top":return{top:`${Math.round(r.top-t.top)}px`,left:`${Math.round(r.left-t.left+r.width/2)}px`,transform:"translateX(-50%)"};case"right":return{top:`${Math.round(r.top-t.top+r.height/2)}px`,left:`${Math.round(r.left-t.left+r.width)}px`,transform:"translateX(-100%) translateY(-50%)"};case"left":return{top:`${Math.round(r.top-t.top+r.height/2)}px`,left:`${Math.round(r.left-t.left)}px`,transform:"translateY(-50%)"};case"bottom":default:return{top:`${Math.round(r.top-t.top+r.height)}px`,left:`${Math.round(r.left-t.left+r.width/2)}px`,transform:"translateX(-50%) translateY(-100%)"}}switch(e){case"bottom-start":return{top:`${Math.round(r.top-t.top+r.height+i)}px`,left:`${Math.round(r.left-t.left+n)}px`,transform:""};case"bottom-end":return{top:`${Math.round(r.top-t.top+r.height+i)}px`,left:`${Math.round(r.left-t.left+r.width+n)}px`,transform:"translateX(-100%)"};case"top-start":return{top:`${Math.round(r.top-t.top+i)}px`,left:`${Math.round(r.left-t.left+n)}px`,transform:"translateY(-100%)"};case"top-end":return{top:`${Math.round(r.top-t.top+i)}px`,left:`${Math.round(r.left-t.left+r.width+n)}px`,transform:"translateX(-100%) translateY(-100%)"};case"right-start":return{top:`${Math.round(r.top-t.top+i)}px`,left:`${Math.round(r.left-t.left+r.width+n)}px`,transform:""};case"right-end":return{top:`${Math.round(r.top-t.top+r.height+i)}px`,left:`${Math.round(r.left-t.left+r.width+n)}px`,transform:"translateY(-100%)"};case"left-start":return{top:`${Math.round(r.top-t.top+i)}px`,left:`${Math.round(r.left-t.left+n)}px`,transform:"translateX(-100%)"};case"left-end":return{top:`${Math.round(r.top-t.top+r.height+i)}px`,left:`${Math.round(r.left-t.left+n)}px`,transform:"translateX(-100%) translateY(-100%)"};case"top":return{top:`${Math.round(r.top-t.top+i)}px`,left:`${Math.round(r.left-t.left+r.width/2+n)}px`,transform:"translateY(-100%) translateX(-50%)"};case"right":return{top:`${Math.round(r.top-t.top+r.height/2+i)}px`,left:`${Math.round(r.left-t.left+r.width+n)}px`,transform:"translateY(-50%)"};case"left":return{top:`${Math.round(r.top-t.top+r.height/2+i)}px`,left:`${Math.round(r.left-t.left+n)}px`,transform:"translateY(-50%) translateX(-100%)"};case"bottom":default:return{top:`${Math.round(r.top-t.top+r.height+i)}px`,left:`${Math.round(r.left-t.left+r.width/2+n)}px`,transform:"translateX(-50%)"}}}const J$=$s([$s(".v-binder-follower-container",{position:"absolute",left:"0",right:"0",top:"0",height:"0",pointerEvents:"none",zIndex:"auto"}),$s(".v-binder-follower-content",{position:"absolute",zIndex:"auto"},[$s("> *",{pointerEvents:"all"})])]),uh=Ve({name:"Follower",inheritAttrs:!1,props:{show:Boolean,enabled:{type:Boolean,default:void 0},placement:{type:String,default:"bottom"},syncTrigger:{type:Array,default:["resize","scroll"]},to:[String,Object],flip:{type:Boolean,default:!0},internalShift:Boolean,x:Number,y:Number,width:String,minWidth:String,containerClass:String,teleportDisabled:Boolean,zindexable:{type:Boolean,default:!0},zIndex:Number,overlap:Boolean},setup(e){const t=_t("VBinder"),r=$i(()=>e.enabled!==void 0?e.enabled:e.show),i=ge(null),n=ge(null),a=()=>{const{syncTrigger:h}=e;h.includes("scroll")&&t.addScrollListener(l),h.includes("resize")&&t.addResizeListener(l)},o=()=>{t.removeScrollListener(l),t.removeResizeListener(l)};Or(()=>{r.value&&(l(),a())});const s=kd();J$.mount({id:"vueuc/binder",head:!0,anchorMetaName:M1,ssr:s}),na(()=>{o()}),I5(()=>{r.value&&l()});const l=()=>{if(!r.value)return;const h=i.value;if(h===null)return;const f=t.targetRef,{x:p,y:v,overlap:m}=e,g=p!==void 0&&v!==void 0?L$(p,v):zw(f);h.style.setProperty("--v-target-width",`${Math.round(g.width)}px`),h.style.setProperty("--v-target-height",`${Math.round(g.height)}px`);const{width:y,minWidth:b,placement:x,internalShift:S,flip:w}=e;h.setAttribute("v-placement",x),m?h.setAttribute("v-overlap",""):h.removeAttribute("v-overlap");const{style:_}=h;y==="target"?_.width=`${g.width}px`:y!==void 0?_.width=y:_.width="",b==="target"?_.minWidth=`${g.width}px`:b!==void 0?_.minWidth=b:_.minWidth="";const C=zw(h),A=zw(n.value),{left:M,top:P,placement:T}=K$(x,g,C,S,w,m),R=Q$(T,m),{left:z,top:F,transform:H}=Z$(T,A,g,P,M,m);h.setAttribute("v-placement",T),h.style.setProperty("--v-offset-left",`${Math.round(M)}px`),h.style.setProperty("--v-offset-top",`${Math.round(P)}px`),h.style.transform=`translateX(${z}) translateY(${F}) ${H}`,h.style.setProperty("--v-transform-origin",R),h.style.transformOrigin=R};tr(r,h=>{h?(a(),c()):o()});const c=()=>{ra().then(l).catch(h=>console.error(h))};["placement","x","y","internalShift","flip","width","overlap","minWidth"].forEach(h=>{tr(pt(e,h),l)}),["teleportDisabled"].forEach(h=>{tr(pt(e,h),c)}),tr(pt(e,"syncTrigger"),h=>{h.includes("resize")?t.addResizeListener(l):t.removeResizeListener(l),h.includes("scroll")?t.addScrollListener(l):t.removeScrollListener(l)});const d=zd(),u=$i(()=>{const{to:h}=e;if(h!==void 0)return h;d.value});return{VBinder:t,mergedEnabled:r,offsetContainerRef:n,followerRef:i,mergedTo:u,syncPosition:l}},render(){return E($$,{show:this.show,to:this.mergedTo,disabled:this.teleportDisabled},{default:()=>{var e,t;const r=E("div",{class:["v-binder-follower-container",this.containerClass],ref:"offsetContainerRef"},[E("div",{class:"v-binder-follower-content",ref:"followerRef"},(t=(e=this.$slots).default)===null||t===void 0?void 0:t.call(e))]);return this.zindexable?Ka(r,[[N5,{enabled:this.mergedEnabled,zIndex:this.zIndex}]]):r}})}});var zu=[],eq=function(){return zu.some(function(e){return e.activeTargets.length>0})},tq=function(){return zu.some(function(e){return e.skippedTargets.length>0})},k3="ResizeObserver loop completed with undelivered notifications.",rq=function(){var e;typeof ErrorEvent=="function"?e=new ErrorEvent("error",{message:k3}):(e=document.createEvent("Event"),e.initEvent("error",!1,!1),e.message=k3),window.dispatchEvent(e)},$v;(function(e){e.BORDER_BOX="border-box",e.CONTENT_BOX="content-box",e.DEVICE_PIXEL_CONTENT_BOX="device-pixel-content-box"})($v||($v={}));var ku=function(e){return Object.freeze(e)},iq=function(){function e(t,r){this.inlineSize=t,this.blockSize=r,ku(this)}return e}(),U5=function(){function e(t,r,i,n){return this.x=t,this.y=r,this.width=i,this.height=n,this.top=this.y,this.left=this.x,this.bottom=this.top+this.height,this.right=this.left+this.width,ku(this)}return e.prototype.toJSON=function(){var t=this,r=t.x,i=t.y,n=t.top,a=t.right,o=t.bottom,s=t.left,l=t.width,c=t.height;return{x:r,y:i,top:n,right:a,bottom:o,left:s,width:l,height:c}},e.fromRect=function(t){return new e(t.x,t.y,t.width,t.height)},e}(),JE=function(e){return e instanceof SVGElement&&"getBBox"in e},j5=function(e){if(JE(e)){var t=e.getBBox(),r=t.width,i=t.height;return!r&&!i}var n=e,a=n.offsetWidth,o=n.offsetHeight;return!(a||o||e.getClientRects().length)},L3=function(e){var t;if(e instanceof Element)return!0;var r=(t=e==null?void 0:e.ownerDocument)===null||t===void 0?void 0:t.defaultView;return!!(r&&e instanceof r.Element)},nq=function(e){switch(e.tagName){case"INPUT":if(e.type!=="image")break;case"VIDEO":case"AUDIO":case"EMBED":case"OBJECT":case"CANVAS":case"IFRAME":case"IMG":return!0}return!1},vv=typeof window<"u"?window:{},y0=new WeakMap,B3=/auto|scroll/,aq=/^tb|vertical/,oq=/msie|trident/i.test(vv.navigator&&vv.navigator.userAgent),ws=function(e){return parseFloat(e||"0")},Nf=function(e,t,r){return e===void 0&&(e=0),t===void 0&&(t=0),r===void 0&&(r=!1),new iq((r?t:e)||0,(r?e:t)||0)},F3=ku({devicePixelContentBoxSize:Nf(),borderBoxSize:Nf(),contentBoxSize:Nf(),contentRect:new U5(0,0,0,0)}),V5=function(e,t){if(t===void 0&&(t=!1),y0.has(e)&&!t)return y0.get(e);if(j5(e))return y0.set(e,F3),F3;var r=getComputedStyle(e),i=JE(e)&&e.ownerSVGElement&&e.getBBox(),n=!oq&&r.boxSizing==="border-box",a=aq.test(r.writingMode||""),o=!i&&B3.test(r.overflowY||""),s=!i&&B3.test(r.overflowX||""),l=i?0:ws(r.paddingTop),c=i?0:ws(r.paddingRight),d=i?0:ws(r.paddingBottom),u=i?0:ws(r.paddingLeft),h=i?0:ws(r.borderTopWidth),f=i?0:ws(r.borderRightWidth),p=i?0:ws(r.borderBottomWidth),v=i?0:ws(r.borderLeftWidth),m=u+c,g=l+d,y=v+f,b=h+p,x=s?e.offsetHeight-b-e.clientHeight:0,S=o?e.offsetWidth-y-e.clientWidth:0,w=n?m+y:0,_=n?g+b:0,C=i?i.width:ws(r.width)-w-S,A=i?i.height:ws(r.height)-_-x,M=C+m+S+y,P=A+g+x+b,T=ku({devicePixelContentBoxSize:Nf(Math.round(C*devicePixelRatio),Math.round(A*devicePixelRatio),a),borderBoxSize:Nf(M,P,a),contentBoxSize:Nf(C,A,a),contentRect:new U5(u,l,C,A)});return y0.set(e,T),T},H5=function(e,t,r){var i=V5(e,r),n=i.borderBoxSize,a=i.contentBoxSize,o=i.devicePixelContentBoxSize;switch(t){case $v.DEVICE_PIXEL_CONTENT_BOX:return o;case $v.BORDER_BOX:return n;default:return a}},sq=function(){function e(t){var r=V5(t);this.target=t,this.contentRect=r.contentRect,this.borderBoxSize=ku([r.borderBoxSize]),this.contentBoxSize=ku([r.contentBoxSize]),this.devicePixelContentBoxSize=ku([r.devicePixelContentBoxSize])}return e}(),W5=function(e){if(j5(e))return 1/0;for(var t=0,r=e.parentNode;r;)t+=1,r=r.parentNode;return t},lq=function(){var e=1/0,t=[];zu.forEach(function(o){if(o.activeTargets.length!==0){var s=[];o.activeTargets.forEach(function(c){var d=new sq(c.target),u=W5(c.target);s.push(d),c.lastReportedSize=H5(c.target,c.observedBox),u<e&&(e=u)}),t.push(function(){o.callback.call(o.observer,s,o.observer)}),o.activeTargets.splice(0,o.activeTargets.length)}});for(var r=0,i=t;r<i.length;r++){var n=i[r];n()}return e},N3=function(e){zu.forEach(function(r){r.activeTargets.splice(0,r.activeTargets.length),r.skippedTargets.splice(0,r.skippedTargets.length),r.observationTargets.forEach(function(n){n.isActive()&&(W5(n.target)>e?r.activeTargets.push(n):r.skippedTargets.push(n))})})},cq=function(){var e=0;for(N3(e);eq();)e=lq(),N3(e);return tq()&&rq(),e>0},Bw,G5=[],dq=function(){return G5.splice(0).forEach(function(e){return e()})},uq=function(e){if(!Bw){var t=0,r=document.createTextNode(""),i={characterData:!0};new MutationObserver(function(){return dq()}).observe(r,i),Bw=function(){r.textContent="".concat(t?t--:t++)}}G5.push(e),Bw()},hq=function(e){uq(function(){requestAnimationFrame(e)})},lb=0,fq=function(){return!!lb},pq=250,mq={attributes:!0,characterData:!0,childList:!0,subtree:!0},U3=["resize","load","transitionend","animationend","animationstart","animationiteration","keyup","keydown","mouseup","mousedown","mouseover","mouseout","blur","focus"],j3=function(e){return e===void 0&&(e=0),Date.now()+e},Fw=!1,vq=function(){function e(){var t=this;this.stopped=!0,this.listener=function(){return t.schedule()}}return e.prototype.run=function(t){var r=this;if(t===void 0&&(t=pq),!Fw){Fw=!0;var i=j3(t);hq(function(){var n=!1;try{n=cq()}finally{if(Fw=!1,t=i-j3(),!fq())return;n?r.run(1e3):t>0?r.run(t):r.start()}})}},e.prototype.schedule=function(){this.stop(),this.run()},e.prototype.observe=function(){var t=this,r=function(){return t.observer&&t.observer.observe(document.body,mq)};document.body?r():vv.addEventListener("DOMContentLoaded",r)},e.prototype.start=function(){var t=this;this.stopped&&(this.stopped=!1,this.observer=new MutationObserver(this.listener),this.observe(),U3.forEach(function(r){return vv.addEventListener(r,t.listener,!0)}))},e.prototype.stop=function(){var t=this;this.stopped||(this.observer&&this.observer.disconnect(),U3.forEach(function(r){return vv.removeEventListener(r,t.listener,!0)}),this.stopped=!0)},e}(),Z_=new vq,V3=function(e){!lb&&e>0&&Z_.start(),lb+=e,!lb&&Z_.stop()},gq=function(e){return!JE(e)&&!nq(e)&&getComputedStyle(e).display==="inline"},yq=function(){function e(t,r){this.target=t,this.observedBox=r||$v.CONTENT_BOX,this.lastReportedSize={inlineSize:0,blockSize:0}}return e.prototype.isActive=function(){var t=H5(this.target,this.observedBox,!0);return gq(this.target)&&(this.lastReportedSize=t),this.lastReportedSize.inlineSize!==t.inlineSize||this.lastReportedSize.blockSize!==t.blockSize},e}(),bq=function(){function e(t,r){this.activeTargets=[],this.skippedTargets=[],this.observationTargets=[],this.observer=t,this.callback=r}return e}(),b0=new WeakMap,H3=function(e,t){for(var r=0;r<e.length;r+=1)if(e[r].target===t)return r;return-1},x0=function(){function e(){}return e.connect=function(t,r){var i=new bq(t,r);b0.set(t,i)},e.observe=function(t,r,i){var n=b0.get(t),a=n.observationTargets.length===0;H3(n.observationTargets,r)<0&&(a&&zu.push(n),n.observationTargets.push(new yq(r,i&&i.box)),V3(1),Z_.schedule())},e.unobserve=function(t,r){var i=b0.get(t),n=H3(i.observationTargets,r),a=i.observationTargets.length===1;n>=0&&(a&&zu.splice(zu.indexOf(i),1),i.observationTargets.splice(n,1),V3(-1))},e.disconnect=function(t){var r=this,i=b0.get(t);i.observationTargets.slice().forEach(function(n){return r.unobserve(t,n.target)}),i.activeTargets.splice(0,i.activeTargets.length)},e}(),xq=function(){function e(t){if(arguments.length===0)throw new TypeError("Failed to construct 'ResizeObserver': 1 argument required, but only 0 present.");if(typeof t!="function")throw new TypeError("Failed to construct 'ResizeObserver': The callback provided as parameter 1 is not a function.");x0.connect(this,t)}return e.prototype.observe=function(t,r){if(arguments.length===0)throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!L3(t))throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': parameter 1 is not of type 'Element");x0.observe(this,t,r)},e.prototype.unobserve=function(t){if(arguments.length===0)throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!L3(t))throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': parameter 1 is not of type 'Element");x0.unobserve(this,t)},e.prototype.disconnect=function(){x0.disconnect(this)},e.toString=function(){return"function ResizeObserver () { [polyfill code] }"},e}();class wq{constructor(){this.handleResize=this.handleResize.bind(this),this.observer=new(typeof window<"u"&&window.ResizeObserver||xq)(this.handleResize),this.elHandlersMap=new Map}handleResize(t){for(const r of t){const i=this.elHandlersMap.get(r.target);i!==void 0&&i(r)}}registerHandler(t,r){this.elHandlersMap.set(t,r),this.observer.observe(t)}unregisterHandler(t){this.elHandlersMap.has(t)&&(this.elHandlersMap.delete(t),this.observer.unobserve(t))}}const Ub=new wq,Ks=Ve({name:"ResizeObserver",props:{onResize:Function},setup(e){let t=!1;const r=lh().proxy;function i(n){const{onResize:a}=e;a!==void 0&&a(n)}Or(()=>{const n=r.$el;if(n===void 0){P3("resize-observer","$el does not exist.");return}if(n.nextElementSibling!==n.nextSibling&&n.nodeType===3&&n.nodeValue!==""){P3("resize-observer","$el can not be observed (it may be a text node).");return}n.nextElementSibling!==null&&(Ub.registerHandler(n.nextElementSibling,i),t=!0)}),na(()=>{t&&Ub.unregisterHandler(r.$el.nextElementSibling)})},render(){return il(this.$slots,"default")}});let w0;function Sq(){return typeof document>"u"?!1:(w0===void 0&&("matchMedia"in window?w0=window.matchMedia("(pointer:coarse)").matches:w0=!1),w0)}let Nw;function W3(){return typeof document>"u"?1:(Nw===void 0&&(Nw="chrome"in window?window.devicePixelRatio:1),Nw)}const Cq=$s(".v-vl",{maxHeight:"inherit",height:"100%",overflow:"auto",minWidth:"1px"},[$s("&:not(.v-vl--show-scrollbar)",{scrollbarWidth:"none"},[$s("&::-webkit-scrollbar, &::-webkit-scrollbar-track-piece, &::-webkit-scrollbar-thumb",{width:0,height:0,display:"none"})])]),qv=Ve({name:"VirtualList",inheritAttrs:!1,props:{showScrollbar:{type:Boolean,default:!0},items:{type:Array,default:()=>[]},itemSize:{type:Number,required:!0},itemResizable:Boolean,itemsStyle:[String,Object],visibleItemsTag:{type:[String,Object],default:"div"},visibleItemsProps:Object,ignoreItemResize:Boolean,onScroll:Function,onWheel:Function,onResize:Function,defaultScrollKey:[Number,String],defaultScrollIndex:Number,keyField:{type:String,default:"key"},paddingTop:{type:[Number,String],default:0},paddingBottom:{type:[Number,String],default:0}},setup(e){const t=kd();Cq.mount({id:"vueuc/virtual-list",head:!0,anchorMetaName:M1,ssr:t}),Or(()=>{const{defaultScrollIndex:P,defaultScrollKey:T}=e;P!=null?p({index:P}):T!=null&&p({key:T})});let r=!1,i=!1;GE(()=>{if(r=!1,!i){i=!0;return}p({top:u.value,left:d})}),$E(()=>{r=!0,i||(i=!0)});const n=re(()=>{const P=new Map,{keyField:T}=e;return e.items.forEach((R,z)=>{P.set(R[T],z)}),P}),a=ge(null),o=ge(void 0),s=new Map,l=re(()=>{const{items:P,itemSize:T,keyField:R}=e,z=new G$(P.length,T);return P.forEach((F,H)=>{const N=F[R],U=s.get(N);U!==void 0&&z.add(H,U)}),z}),c=ge(0);let d=0;const u=ge(0),h=$i(()=>Math.max(l.value.getBound(u.value-rn(e.paddingTop))-1,0)),f=re(()=>{const{value:P}=o;if(P===void 0)return[];const{items:T,itemSize:R}=e,z=h.value,F=Math.min(z+Math.ceil(P/R+1),T.length-1),H=[];for(let N=z;N<=F;++N)H.push(T[N]);return H}),p=(P,T)=>{if(typeof P=="number"){y(P,T,"auto");return}const{left:R,top:z,index:F,key:H,position:N,behavior:U,debounce:ie=!0}=P;if(R!==void 0||z!==void 0)y(R,z,U);else if(F!==void 0)g(F,U,ie);else if(H!==void 0){const te=n.value.get(H);te!==void 0&&g(te,U,ie)}else N==="bottom"?y(0,Number.MAX_SAFE_INTEGER,U):N==="top"&&y(0,0,U)};let v,m=null;function g(P,T,R){const{value:z}=l,F=z.sum(P)+rn(e.paddingTop);if(!R)a.value.scrollTo({left:0,top:F,behavior:T});else{v=P,m!==null&&window.clearTimeout(m),m=window.setTimeout(()=>{v=void 0,m=null},16);const{scrollTop:H,offsetHeight:N}=a.value;if(F>H){const U=z.get(P);F+U<=H+N||a.value.scrollTo({left:0,top:F+U-N,behavior:T})}else a.value.scrollTo({left:0,top:F,behavior:T})}}function y(P,T,R){a.value.scrollTo({left:P,top:T,behavior:R})}function b(P,T){var R,z,F;if(r||e.ignoreItemResize||M(T.target))return;const{value:H}=l,N=n.value.get(P),U=H.get(N),ie=(F=(z=(R=T.borderBoxSize)===null||R===void 0?void 0:R[0])===null||z===void 0?void 0:z.blockSize)!==null&&F!==void 0?F:T.contentRect.height;if(ie===U)return;ie-e.itemSize===0?s.delete(P):s.set(P,ie-e.itemSize);const X=ie-U;if(X===0)return;H.add(N,X);const W=a.value;if(W!=null){if(v===void 0){const q=H.sum(N);W.scrollTop>q&&W.scrollBy(0,X)}else if(N<v)W.scrollBy(0,X);else if(N===v){const q=H.sum(N);ie+q>W.scrollTop+W.offsetHeight&&W.scrollBy(0,X)}A()}c.value++}const x=!Sq();let S=!1;function w(P){var T;(T=e.onScroll)===null||T===void 0||T.call(e,P),(!x||!S)&&A()}function _(P){var T;if((T=e.onWheel)===null||T===void 0||T.call(e,P),x){const R=a.value;if(R!=null){if(P.deltaX===0&&(R.scrollTop===0&&P.deltaY<=0||R.scrollTop+R.offsetHeight>=R.scrollHeight&&P.deltaY>=0))return;P.preventDefault(),R.scrollTop+=P.deltaY/W3(),R.scrollLeft+=P.deltaX/W3(),A(),S=!0,w5(()=>{S=!1})}}}function C(P){if(r||M(P.target)||P.contentRect.height===o.value)return;o.value=P.contentRect.height;const{onResize:T}=e;T!==void 0&&T(P)}function A(){const{value:P}=a;P!=null&&(u.value=P.scrollTop,d=P.scrollLeft)}function M(P){let T=P;for(;T!==null;){if(T.style.display==="none")return!0;T=T.parentElement}return!1}return{listHeight:o,listStyle:{overflow:"auto"},keyToIndex:n,itemsStyle:re(()=>{const{itemResizable:P}=e,T=gu(l.value.sum());return c.value,[e.itemsStyle,{boxSizing:"content-box",height:P?"":T,minHeight:P?T:"",paddingTop:gu(e.paddingTop),paddingBottom:gu(e.paddingBottom)}]}),visibleItemsStyle:re(()=>(c.value,{transform:`translateY(${gu(l.value.sum(h.value))})`})),viewportItems:f,listElRef:a,itemsElRef:ge(null),scrollTo:p,handleListResize:C,handleListScroll:w,handleListWheel:_,handleItemResize:b}},render(){const{itemResizable:e,keyField:t,keyToIndex:r,visibleItemsTag:i}=this;return E(Ks,{onResize:this.handleListResize},{default:()=>{var n,a;return E("div",Rd(this.$attrs,{class:["v-vl",this.showScrollbar&&"v-vl--show-scrollbar"],onScroll:this.handleListScroll,onWheel:this.handleListWheel,ref:"listElRef"}),[this.items.length!==0?E("div",{ref:"itemsElRef",class:"v-vl-items",style:this.itemsStyle},[E(i,Object.assign({class:"v-vl-visible-items",style:this.visibleItemsStyle},this.visibleItemsProps),{default:()=>this.viewportItems.map(o=>{const s=o[t],l=r.get(s),c=this.$slots.default({item:o,index:l})[0];return e?E(Ks,{key:s,onResize:d=>this.handleItemResize(s,d)},{default:()=>c}):(c.key=s,c)})})]):(a=(n=this.$slots).empty)===null||a===void 0?void 0:a.call(n)])}})}}),_q=$s(".v-x-scroll",{overflow:"auto",scrollbarWidth:"none"},[$s("&::-webkit-scrollbar",{width:0,height:0})]),Aq=Ve({name:"XScroll",props:{disabled:Boolean,onScroll:Function},setup(){const e=ge(null);function t(n){!(n.currentTarget.offsetWidth<n.currentTarget.scrollWidth)||n.deltaY===0||(n.currentTarget.scrollLeft+=n.deltaY+n.deltaX,n.preventDefault())}const r=kd();return _q.mount({id:"vueuc/x-scroll",head:!0,anchorMetaName:M1,ssr:r}),Object.assign({selfRef:e,handleWheel:t},{scrollTo(...n){var a;(a=e.value)===null||a===void 0||a.scrollTo(...n)}})},render(){return E("div",{ref:"selfRef",onScroll:this.onScroll,onWheel:this.disabled?void 0:this.handleWheel,class:"v-x-scroll"},this.$slots)}}),ml="v-hidden",Mq=$s("[v-hidden]",{display:"none!important"}),J_=Ve({name:"Overflow",props:{getCounter:Function,getTail:Function,updateCounter:Function,onUpdateCount:Function,onUpdateOverflow:Function},setup(e,{slots:t}){const r=ge(null),i=ge(null);function n(o){const{value:s}=r,{getCounter:l,getTail:c}=e;let d;if(l!==void 0?d=l():d=i.value,!s||!d)return;d.hasAttribute(ml)&&d.removeAttribute(ml);const{children:u}=s;if(o.showAllItemsBeforeCalculate)for(const b of u)b.hasAttribute(ml)&&b.removeAttribute(ml);const h=s.offsetWidth,f=[],p=t.tail?c==null?void 0:c():null;let v=p?p.offsetWidth:0,m=!1;const g=s.children.length-(t.tail?1:0);for(let b=0;b<g-1;++b){if(b<0)continue;const x=u[b];if(m){x.hasAttribute(ml)||x.setAttribute(ml,"");continue}else x.hasAttribute(ml)&&x.removeAttribute(ml);const S=x.offsetWidth;if(v+=S,f[b]=S,v>h){const{updateCounter:w}=e;for(let _=b;_>=0;--_){const C=g-1-_;w!==void 0?w(C):d.textContent=`${C}`;const A=d.offsetWidth;if(v-=f[_],v+A<=h||_===0){m=!0,b=_-1,p&&(b===-1?(p.style.maxWidth=`${h-A}px`,p.style.boxSizing="border-box"):p.style.maxWidth="");const{onUpdateCount:M}=e;M&&M(C);break}}}}const{onUpdateOverflow:y}=e;m?y!==void 0&&y(!0):(y!==void 0&&y(!1),d.setAttribute(ml,""))}const a=kd();return Mq.mount({id:"vueuc/overflow",head:!0,anchorMetaName:M1,ssr:a}),Or(()=>n({showAllItemsBeforeCalculate:!1})),{selfRef:r,counterRef:i,sync:n}},render(){const{$slots:e}=this;return ra(()=>this.sync({showAllItemsBeforeCalculate:!1})),E("div",{class:"v-overflow",ref:"selfRef"},[il(e,"default"),e.counter?e.counter():E("span",{style:{display:"inline-block"},ref:"counterRef"}),e.tail?e.tail():null])}});function $5(e){return e instanceof HTMLElement}function q5(e){for(let t=0;t<e.childNodes.length;t++){const r=e.childNodes[t];if($5(r)&&(X5(r)||q5(r)))return!0}return!1}function Y5(e){for(let t=e.childNodes.length-1;t>=0;t--){const r=e.childNodes[t];if($5(r)&&(X5(r)||Y5(r)))return!0}return!1}function X5(e){if(!Eq(e))return!1;try{e.focus({preventScroll:!0})}catch{}return document.activeElement===e}function Eq(e){if(e.tabIndex>0||e.tabIndex===0&&e.getAttribute("tabIndex")!==null)return!0;if(e.getAttribute("disabled"))return!1;switch(e.nodeName){case"A":return!!e.href&&e.rel!=="ignore";case"INPUT":return e.type!=="hidden"&&e.type!=="file";case"BUTTON":case"SELECT":case"TEXTAREA":return!0;default:return!1}}let lm=[];const Tq=Ve({name:"FocusTrap",props:{disabled:Boolean,active:Boolean,autoFocus:{type:Boolean,default:!0},onEsc:Function,initialFocusTo:String,finalFocusTo:String,returnFocusOnDeactivated:{type:Boolean,default:!0}},setup(e){const t=qu(),r=ge(null),i=ge(null);let n=!1,a=!1;const o=typeof document>"u"?null:document.activeElement;function s(){return lm[lm.length-1]===t}function l(m){var g;m.code==="Escape"&&s()&&((g=e.onEsc)===null||g===void 0||g.call(e,m))}Or(()=>{tr(()=>e.active,m=>{m?(u(),Ni("keydown",document,l)):(wi("keydown",document,l),n&&h())},{immediate:!0})}),na(()=>{wi("keydown",document,l),n&&h()});function c(m){if(!a&&s()){const g=d();if(g===null||g.contains(Jl(m)))return;f("first")}}function d(){const m=r.value;if(m===null)return null;let g=m;for(;g=g.nextSibling,!(g===null||g instanceof Element&&g.tagName==="DIV"););return g}function u(){var m;if(!e.disabled){if(lm.push(t),e.autoFocus){const{initialFocusTo:g}=e;g===void 0?f("first"):(m=O3(g))===null||m===void 0||m.focus({preventScroll:!0})}n=!0,document.addEventListener("focus",c,!0)}}function h(){var m;if(e.disabled||(document.removeEventListener("focus",c,!0),lm=lm.filter(y=>y!==t),s()))return;const{finalFocusTo:g}=e;g!==void 0?(m=O3(g))===null||m===void 0||m.focus({preventScroll:!0}):e.returnFocusOnDeactivated&&o instanceof HTMLElement&&(a=!0,o.focus({preventScroll:!0}),a=!1)}function f(m){if(s()&&e.active){const g=r.value,y=i.value;if(g!==null&&y!==null){const b=d();if(b==null||b===y){a=!0,g.focus({preventScroll:!0}),a=!1;return}a=!0;const x=m==="first"?q5(b):Y5(b);a=!1,x||(a=!0,g.focus({preventScroll:!0}),a=!1)}}}function p(m){if(a)return;const g=d();g!==null&&(m.relatedTarget!==null&&g.contains(m.relatedTarget)?f("last"):f("first"))}function v(m){a||(m.relatedTarget!==null&&m.relatedTarget===r.value?f("last"):f("first"))}return{focusableStartRef:r,focusableEndRef:i,focusableStyle:"position: absolute; height: 0; width: 0;",handleStartFocus:p,handleEndFocus:v}},render(){const{default:e}=this.$slots;if(e===void 0)return null;if(this.disabled)return e();const{active:t,focusableStyle:r}=this;return E(pr,null,[E("div",{"aria-hidden":"true",tabindex:t?"0":"-1",ref:"focusableStartRef",style:r,onFocus:this.handleStartFocus}),e(),E("div",{"aria-hidden":"true",style:r,ref:"focusableEndRef",tabindex:t?"0":"-1",onFocus:this.handleEndFocus})])}});function K5(e,t){t&&(Or(()=>{const{value:r}=e;r&&Ub.registerHandler(r,t)}),na(()=>{const{value:r}=e;r&&Ub.unregisterHandler(r)}))}function eT(e){const t={isDeactivated:!1};let r=!1;return GE(()=>{if(t.isDeactivated=!1,!r){r=!0;return}e()}),$E(()=>{t.isDeactivated=!0,r||(r=!0)}),t}const jb="n-form-item";function cl(e,{defaultSize:t="medium",mergedSize:r,mergedDisabled:i}={}){const n=_t(jb,null);br(jb,null);const a=re(r?()=>r(n):()=>{const{size:l}=e;if(l)return l;if(n){const{mergedSize:c}=n;if(c.value!==void 0)return c.value}return t}),o=re(i?()=>i(n):()=>{const{disabled:l}=e;return l!==void 0?l:n?n.disabled.value:!1}),s=re(()=>{const{status:l}=e;return l||(n==null?void 0:n.mergedValidationStatus.value)});return na(()=>{n&&n.restoreValidation()}),{mergedSizeRef:a,mergedDisabledRef:o,mergedStatusRef:s,nTriggerFormBlur(){n&&n.handleContentBlur()},nTriggerFormChange(){n&&n.handleContentChange()},nTriggerFormFocus(){n&&n.handleContentFocus()},nTriggerFormInput(){n&&n.handleContentInput()}}}var Q5=typeof global=="object"&&global&&global.Object===Object&&global,Pq=typeof self=="object"&&self&&self.Object===Object&&self,ms=Q5||Pq||Function("return this")(),xd=ms.Symbol,Z5=Object.prototype,Dq=Z5.hasOwnProperty,Oq=Z5.toString,cm=xd?xd.toStringTag:void 0;function Rq(e){var t=Dq.call(e,cm),r=e[cm];try{e[cm]=void 0;var i=!0}catch{}var n=Oq.call(e);return i&&(t?e[cm]=r:delete e[cm]),n}var Iq=Object.prototype,zq=Iq.toString;function kq(e){return zq.call(e)}var Lq="[object Null]",Bq="[object Undefined]",G3=xd?xd.toStringTag:void 0;function hh(e){return e==null?e===void 0?Bq:Lq:G3&&G3 in Object(e)?Rq(e):kq(e)}function wd(e){return e!=null&&typeof e=="object"}var Fq="[object Symbol]";function E1(e){return typeof e=="symbol"||wd(e)&&hh(e)==Fq}function J5(e,t){for(var r=-1,i=e==null?0:e.length,n=Array(i);++r<i;)n[r]=t(e[r],r,e);return n}var Lo=Array.isArray,Nq=1/0,$3=xd?xd.prototype:void 0,q3=$3?$3.toString:void 0;function eN(e){if(typeof e=="string")return e;if(Lo(e))return J5(e,eN)+"";if(E1(e))return q3?q3.call(e):"";var t=e+"";return t=="0"&&1/e==-Nq?"-0":t}var Uq=/\s/;function jq(e){for(var t=e.length;t--&&Uq.test(e.charAt(t)););return t}var Vq=/^\s+/;function Hq(e){return e&&e.slice(0,jq(e)+1).replace(Vq,"")}function Bo(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Y3=NaN,Wq=/^[-+]0x[0-9a-f]+$/i,Gq=/^0b[01]+$/i,$q=/^0o[0-7]+$/i,qq=parseInt;function X3(e){if(typeof e=="number")return e;if(E1(e))return Y3;if(Bo(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=Bo(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=Hq(e);var r=Gq.test(e);return r||$q.test(e)?qq(e.slice(2),r?2:8):Wq.test(e)?Y3:+e}function tT(e){return e}var Yq="[object AsyncFunction]",Xq="[object Function]",Kq="[object GeneratorFunction]",Qq="[object Proxy]";function rT(e){if(!Bo(e))return!1;var t=hh(e);return t==Xq||t==Kq||t==Yq||t==Qq}var Uw=ms["__core-js_shared__"],K3=function(){var e=/[^.]+$/.exec(Uw&&Uw.keys&&Uw.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function Zq(e){return!!K3&&K3 in e}var Jq=Function.prototype,eY=Jq.toString;function fh(e){if(e!=null){try{return eY.call(e)}catch{}try{return e+""}catch{}}return""}var tY=/[\\^$.*+?()[\]{}|]/g,rY=/^\[object .+?Constructor\]$/,iY=Function.prototype,nY=Object.prototype,aY=iY.toString,oY=nY.hasOwnProperty,sY=RegExp("^"+aY.call(oY).replace(tY,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function lY(e){if(!Bo(e)||Zq(e))return!1;var t=rT(e)?sY:rY;return t.test(fh(e))}function cY(e,t){return e==null?void 0:e[t]}function ph(e,t){var r=cY(e,t);return lY(r)?r:void 0}var e2=ph(ms,"WeakMap"),Q3=Object.create,dY=function(){function e(){}return function(t){if(!Bo(t))return{};if(Q3)return Q3(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}();function uY(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}function hY(e,t){var r=-1,i=e.length;for(t||(t=Array(i));++r<i;)t[r]=e[r];return t}var fY=800,pY=16,mY=Date.now;function vY(e){var t=0,r=0;return function(){var i=mY(),n=pY-(i-r);if(r=i,n>0){if(++t>=fY)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}function gY(e){return function(){return e}}var Vb=function(){try{var e=ph(Object,"defineProperty");return e({},"",{}),e}catch{}}(),yY=Vb?function(e,t){return Vb(e,"toString",{configurable:!0,enumerable:!1,value:gY(t),writable:!0})}:tT,bY=vY(yY),xY=9007199254740991,wY=/^(?:0|[1-9]\d*)$/;function iT(e,t){var r=typeof e;return t=t??xY,!!t&&(r=="number"||r!="symbol"&&wY.test(e))&&e>-1&&e%1==0&&e<t}function nT(e,t,r){t=="__proto__"&&Vb?Vb(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}function Og(e,t){return e===t||e!==e&&t!==t}var SY=Object.prototype,CY=SY.hasOwnProperty;function _Y(e,t,r){var i=e[t];(!(CY.call(e,t)&&Og(i,r))||r===void 0&&!(t in e))&&nT(e,t,r)}function AY(e,t,r,i){var n=!r;r||(r={});for(var a=-1,o=t.length;++a<o;){var s=t[a],l=void 0;l===void 0&&(l=e[s]),n?nT(r,s,l):_Y(r,s,l)}return r}var Z3=Math.max;function MY(e,t,r){return t=Z3(t===void 0?e.length-1:t,0),function(){for(var i=arguments,n=-1,a=Z3(i.length-t,0),o=Array(a);++n<a;)o[n]=i[t+n];n=-1;for(var s=Array(t+1);++n<t;)s[n]=i[n];return s[t]=r(o),uY(e,this,s)}}function EY(e,t){return bY(MY(e,t,tT),e+"")}var TY=9007199254740991;function aT(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=TY}function Ip(e){return e!=null&&aT(e.length)&&!rT(e)}function PY(e,t,r){if(!Bo(r))return!1;var i=typeof t;return(i=="number"?Ip(r)&&iT(t,r.length):i=="string"&&t in r)?Og(r[t],e):!1}function DY(e){return EY(function(t,r){var i=-1,n=r.length,a=n>1?r[n-1]:void 0,o=n>2?r[2]:void 0;for(a=e.length>3&&typeof a=="function"?(n--,a):void 0,o&&PY(r[0],r[1],o)&&(a=n<3?void 0:a,n=1),t=Object(t);++i<n;){var s=r[i];s&&e(t,s,i,a)}return t})}var OY=Object.prototype;function oT(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||OY;return e===r}function RY(e,t){for(var r=-1,i=Array(e);++r<e;)i[r]=t(r);return i}var IY="[object Arguments]";function J3(e){return wd(e)&&hh(e)==IY}var tN=Object.prototype,zY=tN.hasOwnProperty,kY=tN.propertyIsEnumerable,Hb=J3(function(){return arguments}())?J3:function(e){return wd(e)&&zY.call(e,"callee")&&!kY.call(e,"callee")};function LY(){return!1}var rN=typeof exports=="object"&&exports&&!exports.nodeType&&exports,eO=rN&&typeof module=="object"&&module&&!module.nodeType&&module,BY=eO&&eO.exports===rN,tO=BY?ms.Buffer:void 0,FY=tO?tO.isBuffer:void 0,Wb=FY||LY,NY="[object Arguments]",UY="[object Array]",jY="[object Boolean]",VY="[object Date]",HY="[object Error]",WY="[object Function]",GY="[object Map]",$Y="[object Number]",qY="[object Object]",YY="[object RegExp]",XY="[object Set]",KY="[object String]",QY="[object WeakMap]",ZY="[object ArrayBuffer]",JY="[object DataView]",eX="[object Float32Array]",tX="[object Float64Array]",rX="[object Int8Array]",iX="[object Int16Array]",nX="[object Int32Array]",aX="[object Uint8Array]",oX="[object Uint8ClampedArray]",sX="[object Uint16Array]",lX="[object Uint32Array]",yi={};yi[eX]=yi[tX]=yi[rX]=yi[iX]=yi[nX]=yi[aX]=yi[oX]=yi[sX]=yi[lX]=!0;yi[NY]=yi[UY]=yi[ZY]=yi[jY]=yi[JY]=yi[VY]=yi[HY]=yi[WY]=yi[GY]=yi[$Y]=yi[qY]=yi[YY]=yi[XY]=yi[KY]=yi[QY]=!1;function cX(e){return wd(e)&&aT(e.length)&&!!yi[hh(e)]}function dX(e){return function(t){return e(t)}}var iN=typeof exports=="object"&&exports&&!exports.nodeType&&exports,gv=iN&&typeof module=="object"&&module&&!module.nodeType&&module,uX=gv&&gv.exports===iN,jw=uX&&Q5.process,rO=function(){try{var e=gv&&gv.require&&gv.require("util").types;return e||jw&&jw.binding&&jw.binding("util")}catch{}}(),iO=rO&&rO.isTypedArray,sT=iO?dX(iO):cX,hX=Object.prototype,fX=hX.hasOwnProperty;function nN(e,t){var r=Lo(e),i=!r&&Hb(e),n=!r&&!i&&Wb(e),a=!r&&!i&&!n&&sT(e),o=r||i||n||a,s=o?RY(e.length,String):[],l=s.length;for(var c in e)(t||fX.call(e,c))&&!(o&&(c=="length"||n&&(c=="offset"||c=="parent")||a&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||iT(c,l)))&&s.push(c);return s}function aN(e,t){return function(r){return e(t(r))}}var pX=aN(Object.keys,Object),mX=Object.prototype,vX=mX.hasOwnProperty;function gX(e){if(!oT(e))return pX(e);var t=[];for(var r in Object(e))vX.call(e,r)&&r!="constructor"&&t.push(r);return t}function lT(e){return Ip(e)?nN(e):gX(e)}function yX(e){var t=[];if(e!=null)for(var r in Object(e))t.push(r);return t}var bX=Object.prototype,xX=bX.hasOwnProperty;function wX(e){if(!Bo(e))return yX(e);var t=oT(e),r=[];for(var i in e)i=="constructor"&&(t||!xX.call(e,i))||r.push(i);return r}function oN(e){return Ip(e)?nN(e,!0):wX(e)}var SX=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,CX=/^\w*$/;function cT(e,t){if(Lo(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||E1(e)?!0:CX.test(e)||!SX.test(e)||t!=null&&e in Object(t)}var Yv=ph(Object,"create");function _X(){this.__data__=Yv?Yv(null):{},this.size=0}function AX(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var MX="__lodash_hash_undefined__",EX=Object.prototype,TX=EX.hasOwnProperty;function PX(e){var t=this.__data__;if(Yv){var r=t[e];return r===MX?void 0:r}return TX.call(t,e)?t[e]:void 0}var DX=Object.prototype,OX=DX.hasOwnProperty;function RX(e){var t=this.__data__;return Yv?t[e]!==void 0:OX.call(t,e)}var IX="__lodash_hash_undefined__";function zX(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=Yv&&t===void 0?IX:t,this}function Xu(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}Xu.prototype.clear=_X;Xu.prototype.delete=AX;Xu.prototype.get=PX;Xu.prototype.has=RX;Xu.prototype.set=zX;function kX(){this.__data__=[],this.size=0}function T1(e,t){for(var r=e.length;r--;)if(Og(e[r][0],t))return r;return-1}var LX=Array.prototype,BX=LX.splice;function FX(e){var t=this.__data__,r=T1(t,e);if(r<0)return!1;var i=t.length-1;return r==i?t.pop():BX.call(t,r,1),--this.size,!0}function NX(e){var t=this.__data__,r=T1(t,e);return r<0?void 0:t[r][1]}function UX(e){return T1(this.__data__,e)>-1}function jX(e,t){var r=this.__data__,i=T1(r,e);return i<0?(++this.size,r.push([e,t])):r[i][1]=t,this}function lc(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}lc.prototype.clear=kX;lc.prototype.delete=FX;lc.prototype.get=NX;lc.prototype.has=UX;lc.prototype.set=jX;var Xv=ph(ms,"Map");function VX(){this.size=0,this.__data__={hash:new Xu,map:new(Xv||lc),string:new Xu}}function HX(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function P1(e,t){var r=e.__data__;return HX(t)?r[typeof t=="string"?"string":"hash"]:r.map}function WX(e){var t=P1(this,e).delete(e);return this.size-=t?1:0,t}function GX(e){return P1(this,e).get(e)}function $X(e){return P1(this,e).has(e)}function qX(e,t){var r=P1(this,e),i=r.size;return r.set(e,t),this.size+=r.size==i?0:1,this}function cc(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}cc.prototype.clear=VX;cc.prototype.delete=WX;cc.prototype.get=GX;cc.prototype.has=$X;cc.prototype.set=qX;var YX="Expected a function";function dT(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(YX);var r=function(){var i=arguments,n=t?t.apply(this,i):i[0],a=r.cache;if(a.has(n))return a.get(n);var o=e.apply(this,i);return r.cache=a.set(n,o)||a,o};return r.cache=new(dT.Cache||cc),r}dT.Cache=cc;var XX=500;function KX(e){var t=dT(e,function(i){return r.size===XX&&r.clear(),i}),r=t.cache;return t}var QX=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ZX=/\\(\\)?/g,JX=KX(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(QX,function(r,i,n,a){t.push(n?a.replace(ZX,"$1"):i||r)}),t});function sN(e){return e==null?"":eN(e)}function lN(e,t){return Lo(e)?e:cT(e,t)?[e]:JX(sN(e))}var eK=1/0;function D1(e){if(typeof e=="string"||E1(e))return e;var t=e+"";return t=="0"&&1/e==-eK?"-0":t}function cN(e,t){t=lN(t,e);for(var r=0,i=t.length;e!=null&&r<i;)e=e[D1(t[r++])];return r&&r==i?e:void 0}function uT(e,t,r){var i=e==null?void 0:cN(e,t);return i===void 0?r:i}function tK(e,t){for(var r=-1,i=t.length,n=e.length;++r<i;)e[n+r]=t[r];return e}var dN=aN(Object.getPrototypeOf,Object),rK="[object Object]",iK=Function.prototype,nK=Object.prototype,uN=iK.toString,aK=nK.hasOwnProperty,oK=uN.call(Object);function sK(e){if(!wd(e)||hh(e)!=rK)return!1;var t=dN(e);if(t===null)return!0;var r=aK.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&uN.call(r)==oK}function lK(e,t,r){var i=-1,n=e.length;t<0&&(t=-t>n?0:n+t),r=r>n?n:r,r<0&&(r+=n),n=t>r?0:r-t>>>0,t>>>=0;for(var a=Array(n);++i<n;)a[i]=e[i+t];return a}function cK(e,t,r){var i=e.length;return r=r===void 0?i:r,!t&&r>=i?e:lK(e,t,r)}var dK="\\ud800-\\udfff",uK="\\u0300-\\u036f",hK="\\ufe20-\\ufe2f",fK="\\u20d0-\\u20ff",pK=uK+hK+fK,mK="\\ufe0e\\ufe0f",vK="\\u200d",gK=RegExp("["+vK+dK+pK+mK+"]");function hN(e){return gK.test(e)}function yK(e){return e.split("")}var fN="\\ud800-\\udfff",bK="\\u0300-\\u036f",xK="\\ufe20-\\ufe2f",wK="\\u20d0-\\u20ff",SK=bK+xK+wK,CK="\\ufe0e\\ufe0f",_K="["+fN+"]",t2="["+SK+"]",r2="\\ud83c[\\udffb-\\udfff]",AK="(?:"+t2+"|"+r2+")",pN="[^"+fN+"]",mN="(?:\\ud83c[\\udde6-\\uddff]){2}",vN="[\\ud800-\\udbff][\\udc00-\\udfff]",MK="\\u200d",gN=AK+"?",yN="["+CK+"]?",EK="(?:"+MK+"(?:"+[pN,mN,vN].join("|")+")"+yN+gN+")*",TK=yN+gN+EK,PK="(?:"+[pN+t2+"?",t2,mN,vN,_K].join("|")+")",DK=RegExp(r2+"(?="+r2+")|"+PK+TK,"g");function OK(e){return e.match(DK)||[]}function RK(e){return hN(e)?OK(e):yK(e)}function IK(e){return function(t){t=sN(t);var r=hN(t)?RK(t):void 0,i=r?r[0]:t.charAt(0),n=r?cK(r,1).join(""):t.slice(1);return i[e]()+n}}var zK=IK("toUpperCase");function kK(){this.__data__=new lc,this.size=0}function LK(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}function BK(e){return this.__data__.get(e)}function FK(e){return this.__data__.has(e)}var NK=200;function UK(e,t){var r=this.__data__;if(r instanceof lc){var i=r.__data__;if(!Xv||i.length<NK-1)return i.push([e,t]),this.size=++r.size,this;r=this.__data__=new cc(i)}return r.set(e,t),this.size=r.size,this}function Qs(e){var t=this.__data__=new lc(e);this.size=t.size}Qs.prototype.clear=kK;Qs.prototype.delete=LK;Qs.prototype.get=BK;Qs.prototype.has=FK;Qs.prototype.set=UK;var bN=typeof exports=="object"&&exports&&!exports.nodeType&&exports,nO=bN&&typeof module=="object"&&module&&!module.nodeType&&module,jK=nO&&nO.exports===bN,aO=jK?ms.Buffer:void 0;aO&&aO.allocUnsafe;function VK(e,t){return e.slice()}function HK(e,t){for(var r=-1,i=e==null?0:e.length,n=0,a=[];++r<i;){var o=e[r];t(o,r,e)&&(a[n++]=o)}return a}function WK(){return[]}var GK=Object.prototype,$K=GK.propertyIsEnumerable,oO=Object.getOwnPropertySymbols,qK=oO?function(e){return e==null?[]:(e=Object(e),HK(oO(e),function(t){return $K.call(e,t)}))}:WK;function YK(e,t,r){var i=t(e);return Lo(e)?i:tK(i,r(e))}function sO(e){return YK(e,lT,qK)}var i2=ph(ms,"DataView"),n2=ph(ms,"Promise"),a2=ph(ms,"Set"),lO="[object Map]",XK="[object Object]",cO="[object Promise]",dO="[object Set]",uO="[object WeakMap]",hO="[object DataView]",KK=fh(i2),QK=fh(Xv),ZK=fh(n2),JK=fh(a2),eQ=fh(e2),Hc=hh;(i2&&Hc(new i2(new ArrayBuffer(1)))!=hO||Xv&&Hc(new Xv)!=lO||n2&&Hc(n2.resolve())!=cO||a2&&Hc(new a2)!=dO||e2&&Hc(new e2)!=uO)&&(Hc=function(e){var t=hh(e),r=t==XK?e.constructor:void 0,i=r?fh(r):"";if(i)switch(i){case KK:return hO;case QK:return lO;case ZK:return cO;case JK:return dO;case eQ:return uO}return t});var Gb=ms.Uint8Array;function tQ(e){var t=new e.constructor(e.byteLength);return new Gb(t).set(new Gb(e)),t}function rQ(e,t){var r=tQ(e.buffer);return new e.constructor(r,e.byteOffset,e.length)}function iQ(e){return typeof e.constructor=="function"&&!oT(e)?dY(dN(e)):{}}var nQ="__lodash_hash_undefined__";function aQ(e){return this.__data__.set(e,nQ),this}function oQ(e){return this.__data__.has(e)}function $b(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new cc;++t<r;)this.add(e[t])}$b.prototype.add=$b.prototype.push=aQ;$b.prototype.has=oQ;function sQ(e,t){for(var r=-1,i=e==null?0:e.length;++r<i;)if(t(e[r],r,e))return!0;return!1}function lQ(e,t){return e.has(t)}var cQ=1,dQ=2;function xN(e,t,r,i,n,a){var o=r&cQ,s=e.length,l=t.length;if(s!=l&&!(o&&l>s))return!1;var c=a.get(e),d=a.get(t);if(c&&d)return c==t&&d==e;var u=-1,h=!0,f=r&dQ?new $b:void 0;for(a.set(e,t),a.set(t,e);++u<s;){var p=e[u],v=t[u];if(i)var m=o?i(v,p,u,t,e,a):i(p,v,u,e,t,a);if(m!==void 0){if(m)continue;h=!1;break}if(f){if(!sQ(t,function(g,y){if(!lQ(f,y)&&(p===g||n(p,g,r,i,a)))return f.push(y)})){h=!1;break}}else if(!(p===v||n(p,v,r,i,a))){h=!1;break}}return a.delete(e),a.delete(t),h}function uQ(e){var t=-1,r=Array(e.size);return e.forEach(function(i,n){r[++t]=[n,i]}),r}function hQ(e){var t=-1,r=Array(e.size);return e.forEach(function(i){r[++t]=i}),r}var fQ=1,pQ=2,mQ="[object Boolean]",vQ="[object Date]",gQ="[object Error]",yQ="[object Map]",bQ="[object Number]",xQ="[object RegExp]",wQ="[object Set]",SQ="[object String]",CQ="[object Symbol]",_Q="[object ArrayBuffer]",AQ="[object DataView]",fO=xd?xd.prototype:void 0,Vw=fO?fO.valueOf:void 0;function MQ(e,t,r,i,n,a,o){switch(r){case AQ:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case _Q:return!(e.byteLength!=t.byteLength||!a(new Gb(e),new Gb(t)));case mQ:case vQ:case bQ:return Og(+e,+t);case gQ:return e.name==t.name&&e.message==t.message;case xQ:case SQ:return e==t+"";case yQ:var s=uQ;case wQ:var l=i&fQ;if(s||(s=hQ),e.size!=t.size&&!l)return!1;var c=o.get(e);if(c)return c==t;i|=pQ,o.set(e,t);var d=xN(s(e),s(t),i,n,a,o);return o.delete(e),d;case CQ:if(Vw)return Vw.call(e)==Vw.call(t)}return!1}var EQ=1,TQ=Object.prototype,PQ=TQ.hasOwnProperty;function DQ(e,t,r,i,n,a){var o=r&EQ,s=sO(e),l=s.length,c=sO(t),d=c.length;if(l!=d&&!o)return!1;for(var u=l;u--;){var h=s[u];if(!(o?h in t:PQ.call(t,h)))return!1}var f=a.get(e),p=a.get(t);if(f&&p)return f==t&&p==e;var v=!0;a.set(e,t),a.set(t,e);for(var m=o;++u<l;){h=s[u];var g=e[h],y=t[h];if(i)var b=o?i(y,g,h,t,e,a):i(g,y,h,e,t,a);if(!(b===void 0?g===y||n(g,y,r,i,a):b)){v=!1;break}m||(m=h=="constructor")}if(v&&!m){var x=e.constructor,S=t.constructor;x!=S&&"constructor"in e&&"constructor"in t&&!(typeof x=="function"&&x instanceof x&&typeof S=="function"&&S instanceof S)&&(v=!1)}return a.delete(e),a.delete(t),v}var OQ=1,pO="[object Arguments]",mO="[object Array]",S0="[object Object]",RQ=Object.prototype,vO=RQ.hasOwnProperty;function IQ(e,t,r,i,n,a){var o=Lo(e),s=Lo(t),l=o?mO:Hc(e),c=s?mO:Hc(t);l=l==pO?S0:l,c=c==pO?S0:c;var d=l==S0,u=c==S0,h=l==c;if(h&&Wb(e)){if(!Wb(t))return!1;o=!0,d=!1}if(h&&!d)return a||(a=new Qs),o||sT(e)?xN(e,t,r,i,n,a):MQ(e,t,l,r,i,n,a);if(!(r&OQ)){var f=d&&vO.call(e,"__wrapped__"),p=u&&vO.call(t,"__wrapped__");if(f||p){var v=f?e.value():e,m=p?t.value():t;return a||(a=new Qs),n(v,m,r,i,a)}}return h?(a||(a=new Qs),DQ(e,t,r,i,n,a)):!1}function hT(e,t,r,i,n){return e===t?!0:e==null||t==null||!wd(e)&&!wd(t)?e!==e&&t!==t:IQ(e,t,r,i,hT,n)}var zQ=1,kQ=2;function LQ(e,t,r,i){var n=r.length,a=n;if(e==null)return!a;for(e=Object(e);n--;){var o=r[n];if(o[2]?o[1]!==e[o[0]]:!(o[0]in e))return!1}for(;++n<a;){o=r[n];var s=o[0],l=e[s],c=o[1];if(o[2]){if(l===void 0&&!(s in e))return!1}else{var d=new Qs,u;if(!(u===void 0?hT(c,l,zQ|kQ,i,d):u))return!1}}return!0}function wN(e){return e===e&&!Bo(e)}function BQ(e){for(var t=lT(e),r=t.length;r--;){var i=t[r],n=e[i];t[r]=[i,n,wN(n)]}return t}function SN(e,t){return function(r){return r==null?!1:r[e]===t&&(t!==void 0||e in Object(r))}}function FQ(e){var t=BQ(e);return t.length==1&&t[0][2]?SN(t[0][0],t[0][1]):function(r){return r===e||LQ(r,e,t)}}function NQ(e,t){return e!=null&&t in Object(e)}function UQ(e,t,r){t=lN(t,e);for(var i=-1,n=t.length,a=!1;++i<n;){var o=D1(t[i]);if(!(a=e!=null&&r(e,o)))break;e=e[o]}return a||++i!=n?a:(n=e==null?0:e.length,!!n&&aT(n)&&iT(o,n)&&(Lo(e)||Hb(e)))}function jQ(e,t){return e!=null&&UQ(e,t,NQ)}var VQ=1,HQ=2;function WQ(e,t){return cT(e)&&wN(t)?SN(D1(e),t):function(r){var i=uT(r,e);return i===void 0&&i===t?jQ(r,e):hT(t,i,VQ|HQ)}}function GQ(e){return function(t){return t==null?void 0:t[e]}}function $Q(e){return function(t){return cN(t,e)}}function qQ(e){return cT(e)?GQ(D1(e)):$Q(e)}function YQ(e){return typeof e=="function"?e:e==null?tT:typeof e=="object"?Lo(e)?WQ(e[0],e[1]):FQ(e):qQ(e)}function XQ(e){return function(t,r,i){for(var n=-1,a=Object(t),o=i(t),s=o.length;s--;){var l=o[++n];if(r(a[l],l,a)===!1)break}return t}}var CN=XQ();function KQ(e,t){return e&&CN(e,t,lT)}function QQ(e,t){return function(r,i){if(r==null)return r;if(!Ip(r))return e(r,i);for(var n=r.length,a=-1,o=Object(r);++a<n&&i(o[a],a,o)!==!1;);return r}}var ZQ=QQ(KQ),Hw=function(){return ms.Date.now()},JQ="Expected a function",eZ=Math.max,tZ=Math.min;function rZ(e,t,r){var i,n,a,o,s,l,c=0,d=!1,u=!1,h=!0;if(typeof e!="function")throw new TypeError(JQ);t=X3(t)||0,Bo(r)&&(d=!!r.leading,u="maxWait"in r,a=u?eZ(X3(r.maxWait)||0,t):a,h="trailing"in r?!!r.trailing:h);function f(w){var _=i,C=n;return i=n=void 0,c=w,o=e.apply(C,_),o}function p(w){return c=w,s=setTimeout(g,t),d?f(w):o}function v(w){var _=w-l,C=w-c,A=t-_;return u?tZ(A,a-C):A}function m(w){var _=w-l,C=w-c;return l===void 0||_>=t||_<0||u&&C>=a}function g(){var w=Hw();if(m(w))return y(w);s=setTimeout(g,v(w))}function y(w){return s=void 0,h&&i?f(w):(i=n=void 0,o)}function b(){s!==void 0&&clearTimeout(s),c=0,i=l=n=s=void 0}function x(){return s===void 0?o:y(Hw())}function S(){var w=Hw(),_=m(w);if(i=arguments,n=this,l=w,_){if(s===void 0)return p(l);if(u)return clearTimeout(s),s=setTimeout(g,t),f(l)}return s===void 0&&(s=setTimeout(g,t)),o}return S.cancel=b,S.flush=x,S}function o2(e,t,r){(r!==void 0&&!Og(e[t],r)||r===void 0&&!(t in e))&&nT(e,t,r)}function iZ(e){return wd(e)&&Ip(e)}function s2(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}function nZ(e){return AY(e,oN(e))}function aZ(e,t,r,i,n,a,o){var s=s2(e,r),l=s2(t,r),c=o.get(l);if(c){o2(e,r,c);return}var d=a?a(s,l,r+"",e,t,o):void 0,u=d===void 0;if(u){var h=Lo(l),f=!h&&Wb(l),p=!h&&!f&&sT(l);d=l,h||f||p?Lo(s)?d=s:iZ(s)?d=hY(s):f?(u=!1,d=VK(l)):p?(u=!1,d=rQ(l)):d=[]:sK(l)||Hb(l)?(d=s,Hb(s)?d=nZ(s):(!Bo(s)||rT(s))&&(d=iQ(l))):u=!1}u&&(o.set(l,d),n(d,l,i,a,o),o.delete(l)),o2(e,r,d)}function _N(e,t,r,i,n){e!==t&&CN(t,function(a,o){if(n||(n=new Qs),Bo(a))aZ(e,t,o,r,_N,i,n);else{var s=i?i(s2(e,o),a,o+"",e,t,n):void 0;s===void 0&&(s=a),o2(e,o,s)}},oN)}function oZ(e,t){var r=-1,i=Ip(e)?Array(e.length):[];return ZQ(e,function(n,a,o){i[++r]=t(n,a,o)}),i}function sZ(e,t){var r=Lo(e)?J5:oZ;return r(e,YQ(t))}var C0=DY(function(e,t,r){_N(e,t,r)}),lZ="Expected a function";function Ww(e,t,r){var i=!0,n=!0;if(typeof e!="function")throw new TypeError(lZ);return Bo(r)&&(i="leading"in r?!!r.leading:i,n="trailing"in r?!!r.trailing:n),rZ(e,t,{leading:i,maxWait:t,trailing:n})}const Ld={fontFamily:'v-sans, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',fontFamilyMono:"v-mono, SFMono-Regular, Menlo, Consolas, Courier, monospace",fontWeight:"400",fontWeightStrong:"500",cubicBezierEaseInOut:"cubic-bezier(.4, 0, .2, 1)",cubicBezierEaseOut:"cubic-bezier(0, 0, .2, 1)",cubicBezierEaseIn:"cubic-bezier(.4, 0, 1, 1)",borderRadius:"3px",borderRadiusSmall:"2px",fontSize:"14px",fontSizeMini:"12px",fontSizeTiny:"12px",fontSizeSmall:"14px",fontSizeMedium:"14px",fontSizeLarge:"15px",fontSizeHuge:"16px",lineHeight:"1.6",heightMini:"16px",heightTiny:"22px",heightSmall:"28px",heightMedium:"34px",heightLarge:"40px",heightHuge:"46px"},{fontSize:cZ,fontFamily:dZ,lineHeight:uZ}=Ld,AN=ve("body",`
 margin: 0;
 font-size: ${cZ};
 font-family: ${dZ};
 line-height: ${uZ};
 -webkit-text-size-adjust: 100%;
 -webkit-tap-highlight-color: transparent;
`,[ve("input",`
 font-family: inherit;
 font-size: inherit;
 `)]),mh="n-config-provider",Kv="naive-ui-style";function bt(e,t,r,i,n,a){const o=kd(),s=_t(mh,null);if(r){const c=()=>{const d=a==null?void 0:a.value;r.mount({id:d===void 0?t:d+t,head:!0,props:{bPrefix:d?`.${d}-`:void 0},anchorMetaName:Kv,ssr:o}),s!=null&&s.preflightStyleDisabled||AN.mount({id:"n-global",head:!0,anchorMetaName:Kv,ssr:o})};o?c():Mg(c)}return re(()=>{var c;const{theme:{common:d,self:u,peers:h={}}={},themeOverrides:f={},builtinThemeOverrides:p={}}=n,{common:v,peers:m}=f,{common:g=void 0,[e]:{common:y=void 0,self:b=void 0,peers:x={}}={}}=(s==null?void 0:s.mergedThemeRef.value)||{},{common:S=void 0,[e]:w={}}=(s==null?void 0:s.mergedThemeOverridesRef.value)||{},{common:_,peers:C={}}=w,A=C0({},d||y||g||i.common,S,_,v),M=C0((c=u||b||i.self)===null||c===void 0?void 0:c(A),p,w,f);return{common:A,self:M,peers:C0({},i.peers,x,h),peerOverrides:C0({},p.peers,C,m)}})}bt.props={theme:Object,themeOverrides:Object,builtinThemeOverrides:Object};const hZ="n";function mr(e={},t={defaultBordered:!0}){const r=_t(mh,null);return{inlineThemeDisabled:r==null?void 0:r.inlineThemeDisabled,mergedRtlRef:r==null?void 0:r.mergedRtlRef,mergedComponentPropsRef:r==null?void 0:r.mergedComponentPropsRef,mergedBreakpointsRef:r==null?void 0:r.mergedBreakpointsRef,mergedBorderedRef:re(()=>{var i,n;const{bordered:a}=e;return a!==void 0?a:(n=(i=r==null?void 0:r.mergedBorderedRef.value)!==null&&i!==void 0?i:t.defaultBordered)!==null&&n!==void 0?n:!0}),mergedClsPrefixRef:r?r.mergedClsPrefixRef:DF(hZ),namespaceRef:re(()=>r==null?void 0:r.mergedNamespaceRef.value)}}const fZ={name:"en-US",global:{undo:"Undo",redo:"Redo",confirm:"Confirm",clear:"Clear"},Popconfirm:{positiveText:"Confirm",negativeText:"Cancel"},Cascader:{placeholder:"Please Select",loading:"Loading",loadingRequiredMessage:e=>`Please load all ${e}'s descendants before checking it.`},Time:{dateFormat:"yyyy-MM-dd",dateTimeFormat:"yyyy-MM-dd HH:mm:ss"},DatePicker:{yearFormat:"yyyy",monthFormat:"MMM",dayFormat:"eeeeee",yearTypeFormat:"yyyy",monthTypeFormat:"yyyy-MM",dateFormat:"yyyy-MM-dd",dateTimeFormat:"yyyy-MM-dd HH:mm:ss",quarterFormat:"yyyy-qqq",weekFormat:"yyyy-w",clear:"Clear",now:"Now",confirm:"Confirm",selectTime:"Select Time",selectDate:"Select Date",datePlaceholder:"Select Date",datetimePlaceholder:"Select Date and Time",monthPlaceholder:"Select Month",yearPlaceholder:"Select Year",quarterPlaceholder:"Select Quarter",weekPlaceholder:"Select Week",startDatePlaceholder:"Start Date",endDatePlaceholder:"End Date",startDatetimePlaceholder:"Start Date and Time",endDatetimePlaceholder:"End Date and Time",startMonthPlaceholder:"Start Month",endMonthPlaceholder:"End Month",monthBeforeYear:!0,firstDayOfWeek:6,today:"Today"},DataTable:{checkTableAll:"Select all in the table",uncheckTableAll:"Unselect all in the table",confirm:"Confirm",clear:"Clear"},LegacyTransfer:{sourceTitle:"Source",targetTitle:"Target"},Transfer:{selectAll:"Select all",unselectAll:"Unselect all",clearAll:"Clear",total:e=>`Total ${e} items`,selected:e=>`${e} items selected`},Empty:{description:"No Data"},Select:{placeholder:"Please Select"},TimePicker:{placeholder:"Select Time",positiveText:"OK",negativeText:"Cancel",now:"Now",clear:"Clear"},Pagination:{goto:"Goto",selectionSuffix:"page"},DynamicTags:{add:"Add"},Log:{loading:"Loading"},Input:{placeholder:"Please Input"},InputNumber:{placeholder:"Please Input"},DynamicInput:{create:"Create"},ThemeEditor:{title:"Theme Editor",clearAllVars:"Clear All Variables",clearSearch:"Clear Search",filterCompName:"Filter Component Name",filterVarName:"Filter Variable Name",import:"Import",export:"Export",restore:"Reset to Default"},Image:{tipPrevious:"Previous picture (←)",tipNext:"Next picture (→)",tipCounterclockwise:"Counterclockwise",tipClockwise:"Clockwise",tipZoomOut:"Zoom out",tipZoomIn:"Zoom in",tipDownload:"Download",tipClose:"Close (Esc)",tipOriginalSize:"Zoom to original size"}};function Gw(e){return function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.width?String(t.width):e.defaultWidth,i=e.formats[r]||e.formats[e.defaultWidth];return i}}function Bt(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}function al(e){"@babel/helpers - typeof";return al=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},al(e)}function rr(e){Bt(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||al(e)==="object"&&t==="[object Date]"?new Date(e.getTime()):typeof e=="number"||t==="[object Number]"?new Date(e):((typeof e=="string"||t==="[object String]")&&typeof console<"u"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(new Error().stack)),new Date(NaN))}function qr(e){if(e===null||e===!0||e===!1)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}var pZ={};function vh(){return pZ}function Ku(e,t){var r,i,n,a,o,s,l,c;Bt(1,arguments);var d=vh(),u=qr((r=(i=(n=(a=t==null?void 0:t.weekStartsOn)!==null&&a!==void 0?a:t==null||(o=t.locale)===null||o===void 0||(s=o.options)===null||s===void 0?void 0:s.weekStartsOn)!==null&&n!==void 0?n:d.weekStartsOn)!==null&&i!==void 0?i:(l=d.locale)===null||l===void 0||(c=l.options)===null||c===void 0?void 0:c.weekStartsOn)!==null&&r!==void 0?r:0);if(!(u>=0&&u<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var h=rr(e),f=h.getUTCDay(),p=(f<u?7:0)+f-u;return h.setUTCDate(h.getUTCDate()-p),h.setUTCHours(0,0,0,0),h}function dm(e){return function(t,r){var i=r!=null&&r.context?String(r.context):"standalone",n;if(i==="formatting"&&e.formattingValues){var a=e.defaultFormattingWidth||e.defaultWidth,o=r!=null&&r.width?String(r.width):a;n=e.formattingValues[o]||e.formattingValues[a]}else{var s=e.defaultWidth,l=r!=null&&r.width?String(r.width):e.defaultWidth;n=e.values[l]||e.values[s]}var c=e.argumentCallback?e.argumentCallback(t):t;return n[c]}}function um(e){return function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=r.width,n=i&&e.matchPatterns[i]||e.matchPatterns[e.defaultMatchWidth],a=t.match(n);if(!a)return null;var o=a[0],s=i&&e.parsePatterns[i]||e.parsePatterns[e.defaultParseWidth],l=Array.isArray(s)?vZ(s,function(u){return u.test(o)}):mZ(s,function(u){return u.test(o)}),c;c=e.valueCallback?e.valueCallback(l):l,c=r.valueCallback?r.valueCallback(c):c;var d=t.slice(o.length);return{value:c,rest:d}}}function mZ(e,t){for(var r in e)if(e.hasOwnProperty(r)&&t(e[r]))return r}function vZ(e,t){for(var r=0;r<e.length;r++)if(t(e[r]))return r}function gZ(e){return function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=t.match(e.matchPattern);if(!i)return null;var n=i[0],a=t.match(e.parsePattern);if(!a)return null;var o=e.valueCallback?e.valueCallback(a[0]):a[0];o=r.valueCallback?r.valueCallback(o):o;var s=t.slice(n.length);return{value:o,rest:s}}}var yZ={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},bZ=function(t,r,i){var n,a=yZ[t];return typeof a=="string"?n=a:r===1?n=a.one:n=a.other.replace("{{count}}",r.toString()),i!=null&&i.addSuffix?i.comparison&&i.comparison>0?"in "+n:n+" ago":n},xZ={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},wZ={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},SZ={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},CZ={date:Gw({formats:xZ,defaultWidth:"full"}),time:Gw({formats:wZ,defaultWidth:"full"}),dateTime:Gw({formats:SZ,defaultWidth:"full"})},_Z={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},AZ=function(t,r,i,n){return _Z[t]},MZ={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},EZ={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},TZ={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},PZ={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},DZ={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},OZ={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},RZ=function(t,r){var i=Number(t),n=i%100;if(n>20||n<10)switch(n%10){case 1:return i+"st";case 2:return i+"nd";case 3:return i+"rd"}return i+"th"},IZ={ordinalNumber:RZ,era:dm({values:MZ,defaultWidth:"wide"}),quarter:dm({values:EZ,defaultWidth:"wide",argumentCallback:function(t){return t-1}}),month:dm({values:TZ,defaultWidth:"wide"}),day:dm({values:PZ,defaultWidth:"wide"}),dayPeriod:dm({values:DZ,defaultWidth:"wide",formattingValues:OZ,defaultFormattingWidth:"wide"})},zZ=/^(\d+)(th|st|nd|rd)?/i,kZ=/\d+/i,LZ={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},BZ={any:[/^b/i,/^(a|c)/i]},FZ={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},NZ={any:[/1/i,/2/i,/3/i,/4/i]},UZ={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},jZ={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},VZ={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},HZ={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},WZ={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},GZ={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},$Z={ordinalNumber:gZ({matchPattern:zZ,parsePattern:kZ,valueCallback:function(t){return parseInt(t,10)}}),era:um({matchPatterns:LZ,defaultMatchWidth:"wide",parsePatterns:BZ,defaultParseWidth:"any"}),quarter:um({matchPatterns:FZ,defaultMatchWidth:"wide",parsePatterns:NZ,defaultParseWidth:"any",valueCallback:function(t){return t+1}}),month:um({matchPatterns:UZ,defaultMatchWidth:"wide",parsePatterns:jZ,defaultParseWidth:"any"}),day:um({matchPatterns:VZ,defaultMatchWidth:"wide",parsePatterns:HZ,defaultParseWidth:"any"}),dayPeriod:um({matchPatterns:WZ,defaultMatchWidth:"any",parsePatterns:GZ,defaultParseWidth:"any"})},fT={code:"en-US",formatDistance:bZ,formatLong:CZ,formatRelative:AZ,localize:IZ,match:$Z,options:{weekStartsOn:0,firstWeekContainsDate:1}};const qZ={name:"en-US",locale:fT};function _0(e,t){Bt(2,arguments);var r=rr(e),i=qr(t);return isNaN(i)?new Date(NaN):(i&&r.setDate(r.getDate()+i),r)}function qn(e,t){Bt(2,arguments);var r=rr(e),i=qr(t);if(isNaN(i))return new Date(NaN);if(!i)return r;var n=r.getDate(),a=new Date(r.getTime());a.setMonth(r.getMonth()+i+1,0);var o=a.getDate();return n>=o?a:(r.setFullYear(a.getFullYear(),a.getMonth(),n),r)}function YZ(e,t){Bt(2,arguments);var r=rr(e).getTime(),i=qr(t);return new Date(r+i)}function l2(e,t){var r,i,n,a,o,s,l,c;Bt(1,arguments);var d=vh(),u=qr((r=(i=(n=(a=t==null?void 0:t.weekStartsOn)!==null&&a!==void 0?a:t==null||(o=t.locale)===null||o===void 0||(s=o.options)===null||s===void 0?void 0:s.weekStartsOn)!==null&&n!==void 0?n:d.weekStartsOn)!==null&&i!==void 0?i:(l=d.locale)===null||l===void 0||(c=l.options)===null||c===void 0?void 0:c.weekStartsOn)!==null&&r!==void 0?r:0);if(!(u>=0&&u<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var h=rr(e),f=h.getDay(),p=(f<u?7:0)+f-u;return h.setDate(h.getDate()-p),h.setHours(0,0,0,0),h}function MN(e){var t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),e.getTime()-t.getTime()}function qb(e){Bt(1,arguments);var t=rr(e);return t.setHours(0,0,0,0),t}function XZ(e,t){Bt(2,arguments);var r=qr(t),i=r*3;return qn(e,i)}function c2(e,t){Bt(2,arguments);var r=qr(t);return qn(e,r*12)}var KZ=6e4,QZ=36e5,ZZ=1e3;function JZ(e,t){Bt(2,arguments);var r=qb(e),i=qb(t);return r.getTime()===i.getTime()}function eJ(e){return Bt(1,arguments),e instanceof Date||al(e)==="object"&&Object.prototype.toString.call(e)==="[object Date]"}function To(e){if(Bt(1,arguments),!eJ(e)&&typeof e!="number")return!1;var t=rr(e);return!isNaN(Number(t))}function tJ(e){Bt(1,arguments);var t=rr(e),r=Math.floor(t.getMonth()/3)+1;return r}function rJ(e){Bt(1,arguments);var t=rr(e);return t.setSeconds(0,0),t}function Qv(e){Bt(1,arguments);var t=rr(e),r=t.getMonth(),i=r-r%3;return t.setMonth(i,1),t.setHours(0,0,0,0),t}function zl(e){Bt(1,arguments);var t=rr(e);return t.setDate(1),t.setHours(0,0,0,0),t}function pT(e){Bt(1,arguments);var t=rr(e),r=new Date(0);return r.setFullYear(t.getFullYear(),0,1),r.setHours(0,0,0,0),r}function EN(e,t){Bt(2,arguments);var r=qr(t);return YZ(e,-r)}var iJ=864e5;function nJ(e){Bt(1,arguments);var t=rr(e),r=t.getTime();t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0);var i=t.getTime(),n=r-i;return Math.floor(n/iJ)+1}function op(e){Bt(1,arguments);var t=1,r=rr(e),i=r.getUTCDay(),n=(i<t?7:0)+i-t;return r.setUTCDate(r.getUTCDate()-n),r.setUTCHours(0,0,0,0),r}function TN(e){Bt(1,arguments);var t=rr(e),r=t.getUTCFullYear(),i=new Date(0);i.setUTCFullYear(r+1,0,4),i.setUTCHours(0,0,0,0);var n=op(i),a=new Date(0);a.setUTCFullYear(r,0,4),a.setUTCHours(0,0,0,0);var o=op(a);return t.getTime()>=n.getTime()?r+1:t.getTime()>=o.getTime()?r:r-1}function aJ(e){Bt(1,arguments);var t=TN(e),r=new Date(0);r.setUTCFullYear(t,0,4),r.setUTCHours(0,0,0,0);var i=op(r);return i}var oJ=6048e5;function PN(e){Bt(1,arguments);var t=rr(e),r=op(t).getTime()-aJ(t).getTime();return Math.round(r/oJ)+1}function mT(e,t){var r,i,n,a,o,s,l,c;Bt(1,arguments);var d=rr(e),u=d.getUTCFullYear(),h=vh(),f=qr((r=(i=(n=(a=t==null?void 0:t.firstWeekContainsDate)!==null&&a!==void 0?a:t==null||(o=t.locale)===null||o===void 0||(s=o.options)===null||s===void 0?void 0:s.firstWeekContainsDate)!==null&&n!==void 0?n:h.firstWeekContainsDate)!==null&&i!==void 0?i:(l=h.locale)===null||l===void 0||(c=l.options)===null||c===void 0?void 0:c.firstWeekContainsDate)!==null&&r!==void 0?r:1);if(!(f>=1&&f<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var p=new Date(0);p.setUTCFullYear(u+1,0,f),p.setUTCHours(0,0,0,0);var v=Ku(p,t),m=new Date(0);m.setUTCFullYear(u,0,f),m.setUTCHours(0,0,0,0);var g=Ku(m,t);return d.getTime()>=v.getTime()?u+1:d.getTime()>=g.getTime()?u:u-1}function sJ(e,t){var r,i,n,a,o,s,l,c;Bt(1,arguments);var d=vh(),u=qr((r=(i=(n=(a=t==null?void 0:t.firstWeekContainsDate)!==null&&a!==void 0?a:t==null||(o=t.locale)===null||o===void 0||(s=o.options)===null||s===void 0?void 0:s.firstWeekContainsDate)!==null&&n!==void 0?n:d.firstWeekContainsDate)!==null&&i!==void 0?i:(l=d.locale)===null||l===void 0||(c=l.options)===null||c===void 0?void 0:c.firstWeekContainsDate)!==null&&r!==void 0?r:1),h=mT(e,t),f=new Date(0);f.setUTCFullYear(h,0,u),f.setUTCHours(0,0,0,0);var p=Ku(f,t);return p}var lJ=6048e5;function DN(e,t){Bt(1,arguments);var r=rr(e),i=Ku(r,t).getTime()-sJ(r,t).getTime();return Math.round(i/lJ)+1}function Qr(e,t){for(var r=e<0?"-":"",i=Math.abs(e).toString();i.length<t;)i="0"+i;return r+i}var bc={y:function(t,r){var i=t.getUTCFullYear(),n=i>0?i:1-i;return Qr(r==="yy"?n%100:n,r.length)},M:function(t,r){var i=t.getUTCMonth();return r==="M"?String(i+1):Qr(i+1,2)},d:function(t,r){return Qr(t.getUTCDate(),r.length)},a:function(t,r){var i=t.getUTCHours()/12>=1?"pm":"am";switch(r){case"a":case"aa":return i.toUpperCase();case"aaa":return i;case"aaaaa":return i[0];case"aaaa":default:return i==="am"?"a.m.":"p.m."}},h:function(t,r){return Qr(t.getUTCHours()%12||12,r.length)},H:function(t,r){return Qr(t.getUTCHours(),r.length)},m:function(t,r){return Qr(t.getUTCMinutes(),r.length)},s:function(t,r){return Qr(t.getUTCSeconds(),r.length)},S:function(t,r){var i=r.length,n=t.getUTCMilliseconds(),a=Math.floor(n*Math.pow(10,i-3));return Qr(a,r.length)}},Oh={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},cJ={G:function(t,r,i){var n=t.getUTCFullYear()>0?1:0;switch(r){case"G":case"GG":case"GGG":return i.era(n,{width:"abbreviated"});case"GGGGG":return i.era(n,{width:"narrow"});case"GGGG":default:return i.era(n,{width:"wide"})}},y:function(t,r,i){if(r==="yo"){var n=t.getUTCFullYear(),a=n>0?n:1-n;return i.ordinalNumber(a,{unit:"year"})}return bc.y(t,r)},Y:function(t,r,i,n){var a=mT(t,n),o=a>0?a:1-a;if(r==="YY"){var s=o%100;return Qr(s,2)}return r==="Yo"?i.ordinalNumber(o,{unit:"year"}):Qr(o,r.length)},R:function(t,r){var i=TN(t);return Qr(i,r.length)},u:function(t,r){var i=t.getUTCFullYear();return Qr(i,r.length)},Q:function(t,r,i){var n=Math.ceil((t.getUTCMonth()+1)/3);switch(r){case"Q":return String(n);case"QQ":return Qr(n,2);case"Qo":return i.ordinalNumber(n,{unit:"quarter"});case"QQQ":return i.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return i.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return i.quarter(n,{width:"wide",context:"formatting"})}},q:function(t,r,i){var n=Math.ceil((t.getUTCMonth()+1)/3);switch(r){case"q":return String(n);case"qq":return Qr(n,2);case"qo":return i.ordinalNumber(n,{unit:"quarter"});case"qqq":return i.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return i.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return i.quarter(n,{width:"wide",context:"standalone"})}},M:function(t,r,i){var n=t.getUTCMonth();switch(r){case"M":case"MM":return bc.M(t,r);case"Mo":return i.ordinalNumber(n+1,{unit:"month"});case"MMM":return i.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return i.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return i.month(n,{width:"wide",context:"formatting"})}},L:function(t,r,i){var n=t.getUTCMonth();switch(r){case"L":return String(n+1);case"LL":return Qr(n+1,2);case"Lo":return i.ordinalNumber(n+1,{unit:"month"});case"LLL":return i.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return i.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return i.month(n,{width:"wide",context:"standalone"})}},w:function(t,r,i,n){var a=DN(t,n);return r==="wo"?i.ordinalNumber(a,{unit:"week"}):Qr(a,r.length)},I:function(t,r,i){var n=PN(t);return r==="Io"?i.ordinalNumber(n,{unit:"week"}):Qr(n,r.length)},d:function(t,r,i){return r==="do"?i.ordinalNumber(t.getUTCDate(),{unit:"date"}):bc.d(t,r)},D:function(t,r,i){var n=nJ(t);return r==="Do"?i.ordinalNumber(n,{unit:"dayOfYear"}):Qr(n,r.length)},E:function(t,r,i){var n=t.getUTCDay();switch(r){case"E":case"EE":case"EEE":return i.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return i.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return i.day(n,{width:"short",context:"formatting"});case"EEEE":default:return i.day(n,{width:"wide",context:"formatting"})}},e:function(t,r,i,n){var a=t.getUTCDay(),o=(a-n.weekStartsOn+8)%7||7;switch(r){case"e":return String(o);case"ee":return Qr(o,2);case"eo":return i.ordinalNumber(o,{unit:"day"});case"eee":return i.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return i.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return i.day(a,{width:"short",context:"formatting"});case"eeee":default:return i.day(a,{width:"wide",context:"formatting"})}},c:function(t,r,i,n){var a=t.getUTCDay(),o=(a-n.weekStartsOn+8)%7||7;switch(r){case"c":return String(o);case"cc":return Qr(o,r.length);case"co":return i.ordinalNumber(o,{unit:"day"});case"ccc":return i.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return i.day(a,{width:"narrow",context:"standalone"});case"cccccc":return i.day(a,{width:"short",context:"standalone"});case"cccc":default:return i.day(a,{width:"wide",context:"standalone"})}},i:function(t,r,i){var n=t.getUTCDay(),a=n===0?7:n;switch(r){case"i":return String(a);case"ii":return Qr(a,r.length);case"io":return i.ordinalNumber(a,{unit:"day"});case"iii":return i.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return i.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return i.day(n,{width:"short",context:"formatting"});case"iiii":default:return i.day(n,{width:"wide",context:"formatting"})}},a:function(t,r,i){var n=t.getUTCHours(),a=n/12>=1?"pm":"am";switch(r){case"a":case"aa":return i.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return i.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return i.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return i.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(t,r,i){var n=t.getUTCHours(),a;switch(n===12?a=Oh.noon:n===0?a=Oh.midnight:a=n/12>=1?"pm":"am",r){case"b":case"bb":return i.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return i.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return i.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return i.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(t,r,i){var n=t.getUTCHours(),a;switch(n>=17?a=Oh.evening:n>=12?a=Oh.afternoon:n>=4?a=Oh.morning:a=Oh.night,r){case"B":case"BB":case"BBB":return i.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return i.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return i.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(t,r,i){if(r==="ho"){var n=t.getUTCHours()%12;return n===0&&(n=12),i.ordinalNumber(n,{unit:"hour"})}return bc.h(t,r)},H:function(t,r,i){return r==="Ho"?i.ordinalNumber(t.getUTCHours(),{unit:"hour"}):bc.H(t,r)},K:function(t,r,i){var n=t.getUTCHours()%12;return r==="Ko"?i.ordinalNumber(n,{unit:"hour"}):Qr(n,r.length)},k:function(t,r,i){var n=t.getUTCHours();return n===0&&(n=24),r==="ko"?i.ordinalNumber(n,{unit:"hour"}):Qr(n,r.length)},m:function(t,r,i){return r==="mo"?i.ordinalNumber(t.getUTCMinutes(),{unit:"minute"}):bc.m(t,r)},s:function(t,r,i){return r==="so"?i.ordinalNumber(t.getUTCSeconds(),{unit:"second"}):bc.s(t,r)},S:function(t,r){return bc.S(t,r)},X:function(t,r,i,n){var a=n._originalDate||t,o=a.getTimezoneOffset();if(o===0)return"Z";switch(r){case"X":return yO(o);case"XXXX":case"XX":return iu(o);case"XXXXX":case"XXX":default:return iu(o,":")}},x:function(t,r,i,n){var a=n._originalDate||t,o=a.getTimezoneOffset();switch(r){case"x":return yO(o);case"xxxx":case"xx":return iu(o);case"xxxxx":case"xxx":default:return iu(o,":")}},O:function(t,r,i,n){var a=n._originalDate||t,o=a.getTimezoneOffset();switch(r){case"O":case"OO":case"OOO":return"GMT"+gO(o,":");case"OOOO":default:return"GMT"+iu(o,":")}},z:function(t,r,i,n){var a=n._originalDate||t,o=a.getTimezoneOffset();switch(r){case"z":case"zz":case"zzz":return"GMT"+gO(o,":");case"zzzz":default:return"GMT"+iu(o,":")}},t:function(t,r,i,n){var a=n._originalDate||t,o=Math.floor(a.getTime()/1e3);return Qr(o,r.length)},T:function(t,r,i,n){var a=n._originalDate||t,o=a.getTime();return Qr(o,r.length)}};function gO(e,t){var r=e>0?"-":"+",i=Math.abs(e),n=Math.floor(i/60),a=i%60;if(a===0)return r+String(n);var o=t;return r+String(n)+o+Qr(a,2)}function yO(e,t){if(e%60===0){var r=e>0?"-":"+";return r+Qr(Math.abs(e)/60,2)}return iu(e,t)}function iu(e,t){var r=t||"",i=e>0?"-":"+",n=Math.abs(e),a=Qr(Math.floor(n/60),2),o=Qr(n%60,2);return i+a+r+o}var bO=function(t,r){switch(t){case"P":return r.date({width:"short"});case"PP":return r.date({width:"medium"});case"PPP":return r.date({width:"long"});case"PPPP":default:return r.date({width:"full"})}},ON=function(t,r){switch(t){case"p":return r.time({width:"short"});case"pp":return r.time({width:"medium"});case"ppp":return r.time({width:"long"});case"pppp":default:return r.time({width:"full"})}},dJ=function(t,r){var i=t.match(/(P+)(p+)?/)||[],n=i[1],a=i[2];if(!a)return bO(t,r);var o;switch(n){case"P":o=r.dateTime({width:"short"});break;case"PP":o=r.dateTime({width:"medium"});break;case"PPP":o=r.dateTime({width:"long"});break;case"PPPP":default:o=r.dateTime({width:"full"});break}return o.replace("{{date}}",bO(n,r)).replace("{{time}}",ON(a,r))},d2={p:ON,P:dJ},uJ=["D","DD"],hJ=["YY","YYYY"];function RN(e){return uJ.indexOf(e)!==-1}function IN(e){return hJ.indexOf(e)!==-1}function Yb(e,t,r){if(e==="YYYY")throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(t,"`) for formatting years to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(e==="YY")throw new RangeError("Use `yy` instead of `YY` (in `".concat(t,"`) for formatting years to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(e==="D")throw new RangeError("Use `d` instead of `D` (in `".concat(t,"`) for formatting days of the month to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(e==="DD")throw new RangeError("Use `dd` instead of `DD` (in `".concat(t,"`) for formatting days of the month to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"))}var fJ=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,pJ=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,mJ=/^'([^]*?)'?$/,vJ=/''/g,gJ=/[a-zA-Z]/;function ai(e,t,r){var i,n,a,o,s,l,c,d,u,h,f,p,v,m,g,y,b,x;Bt(2,arguments);var S=String(t),w=vh(),_=(i=(n=r==null?void 0:r.locale)!==null&&n!==void 0?n:w.locale)!==null&&i!==void 0?i:fT,C=qr((a=(o=(s=(l=r==null?void 0:r.firstWeekContainsDate)!==null&&l!==void 0?l:r==null||(c=r.locale)===null||c===void 0||(d=c.options)===null||d===void 0?void 0:d.firstWeekContainsDate)!==null&&s!==void 0?s:w.firstWeekContainsDate)!==null&&o!==void 0?o:(u=w.locale)===null||u===void 0||(h=u.options)===null||h===void 0?void 0:h.firstWeekContainsDate)!==null&&a!==void 0?a:1);if(!(C>=1&&C<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var A=qr((f=(p=(v=(m=r==null?void 0:r.weekStartsOn)!==null&&m!==void 0?m:r==null||(g=r.locale)===null||g===void 0||(y=g.options)===null||y===void 0?void 0:y.weekStartsOn)!==null&&v!==void 0?v:w.weekStartsOn)!==null&&p!==void 0?p:(b=w.locale)===null||b===void 0||(x=b.options)===null||x===void 0?void 0:x.weekStartsOn)!==null&&f!==void 0?f:0);if(!(A>=0&&A<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!_.localize)throw new RangeError("locale must contain localize property");if(!_.formatLong)throw new RangeError("locale must contain formatLong property");var M=rr(e);if(!To(M))throw new RangeError("Invalid time value");var P=MN(M),T=EN(M,P),R={firstWeekContainsDate:C,weekStartsOn:A,locale:_,_originalDate:M},z=S.match(pJ).map(function(F){var H=F[0];if(H==="p"||H==="P"){var N=d2[H];return N(F,_.formatLong)}return F}).join("").match(fJ).map(function(F){if(F==="''")return"'";var H=F[0];if(H==="'")return yJ(F);var N=cJ[H];if(N)return!(r!=null&&r.useAdditionalWeekYearTokens)&&IN(F)&&Yb(F,t,String(e)),!(r!=null&&r.useAdditionalDayOfYearTokens)&&RN(F)&&Yb(F,t,String(e)),N(T,F,_.localize,R);if(H.match(gJ))throw new RangeError("Format string contains an unescaped latin alphabet character `"+H+"`");return F}).join("");return z}function yJ(e){var t=e.match(mJ);return t?t[1].replace(vJ,"'"):e}function bJ(e,t){if(e==null)throw new TypeError("assign requires that input parameter not be null or undefined");for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}function wo(e){Bt(1,arguments);var t=rr(e),r=t.getDate();return r}function xJ(e){Bt(1,arguments);var t=rr(e),r=t.getDay();return r}function wJ(e){Bt(1,arguments);var t=rr(e),r=t.getFullYear(),i=t.getMonth(),n=new Date(0);return n.setFullYear(r,i+1,0),n.setHours(0,0,0,0),n.getDate()}function Yc(e){Bt(1,arguments);var t=rr(e),r=t.getHours();return r}function SJ(e){Bt(1,arguments);var t=rr(e),r=t.getMilliseconds();return r}function Xb(e){Bt(1,arguments);var t=rr(e),r=t.getMinutes();return r}function fi(e){Bt(1,arguments);var t=rr(e),r=t.getMonth();return r}function Kb(e){Bt(1,arguments);var t=rr(e),r=t.getSeconds();return r}function gt(e){Bt(1,arguments);var t=rr(e),r=t.getTime();return r}function Ai(e){return Bt(1,arguments),rr(e).getFullYear()}function xO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}function CJ(e,t){if(e){if(typeof e=="string")return xO(e,t);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?xO(e,t):void 0}}function wO(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=CJ(e))||t){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(c){throw c},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var c=r.next();return o=c.done,c},e:function(c){s=!0,a=c},f:function(){try{o||r.return==null||r.return()}finally{if(s)throw a}}}}function Et(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u2(e,t){return u2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},u2(e,t)}function Br(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u2(e,t)}function Qb(e){return Qb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Qb(e)}function zN(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(zN=function(){return!!e})()}function _J(e,t){if(t&&(al(t)=="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Et(e)}function Fr(e){var t=zN();return function(){var r,i=Qb(e);if(t){var n=Qb(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return _J(this,r)}}function Rr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function AJ(e,t){if(al(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(al(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kN(e){var t=AJ(e,"string");return al(t)=="symbol"?t:t+""}function MJ(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,kN(i.key),i)}}function Ir(e,t,r){return t&&MJ(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Mt(e,t,r){return(t=kN(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var EJ=10,LN=function(){function e(){Rr(this,e),Mt(this,"priority",void 0),Mt(this,"subPriority",0)}return Ir(e,[{key:"validate",value:function(r,i){return!0}}]),e}(),TJ=function(e){Br(r,e);var t=Fr(r);function r(i,n,a,o,s){var l;return Rr(this,r),l=t.call(this),l.value=i,l.validateValue=n,l.setValue=a,l.priority=o,s&&(l.subPriority=s),l}return Ir(r,[{key:"validate",value:function(n,a){return this.validateValue(n,this.value,a)}},{key:"set",value:function(n,a,o){return this.setValue(n,a,this.value,o)}}]),r}(LN),PJ=function(e){Br(r,e);var t=Fr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"priority",EJ),Mt(Et(i),"subPriority",-1),i}return Ir(r,[{key:"set",value:function(n,a){if(a.timestampIsSet)return n;var o=new Date(0);return o.setFullYear(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate()),o.setHours(n.getUTCHours(),n.getUTCMinutes(),n.getUTCSeconds(),n.getUTCMilliseconds()),o}}]),r}(LN),Wr=function(){function e(){Rr(this,e),Mt(this,"incompatibleTokens",void 0),Mt(this,"priority",void 0),Mt(this,"subPriority",void 0)}return Ir(e,[{key:"run",value:function(r,i,n,a){var o=this.parse(r,i,n,a);return o?{setter:new TJ(o.value,this.validate,this.set,this.priority,this.subPriority),rest:o.rest}:null}},{key:"validate",value:function(r,i,n){return!0}}]),e}(),DJ=function(e){Br(r,e);var t=Fr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"priority",140),Mt(Et(i),"incompatibleTokens",["R","u","t","T"]),i}return Ir(r,[{key:"parse",value:function(n,a,o){switch(a){case"G":case"GG":case"GGG":return o.era(n,{width:"abbreviated"})||o.era(n,{width:"narrow"});case"GGGGG":return o.era(n,{width:"narrow"});case"GGGG":default:return o.era(n,{width:"wide"})||o.era(n,{width:"abbreviated"})||o.era(n,{width:"narrow"})}}},{key:"set",value:function(n,a,o){return a.era=o,n.setUTCFullYear(o,0,1),n.setUTCHours(0,0,0,0),n}}]),r}(Wr),Wi={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},js={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function Gi(e,t){return e&&{value:t(e.value),rest:e.rest}}function Ti(e,t){var r=t.match(e);return r?{value:parseInt(r[0],10),rest:t.slice(r[0].length)}:null}function Vs(e,t){var r=t.match(e);if(!r)return null;if(r[0]==="Z")return{value:0,rest:t.slice(1)};var i=r[1]==="+"?1:-1,n=r[2]?parseInt(r[2],10):0,a=r[3]?parseInt(r[3],10):0,o=r[5]?parseInt(r[5],10):0;return{value:i*(n*QZ+a*KZ+o*ZZ),rest:t.slice(r[0].length)}}function BN(e){return Ti(Wi.anyDigitsSigned,e)}function Ui(e,t){switch(e){case 1:return Ti(Wi.singleDigit,t);case 2:return Ti(Wi.twoDigits,t);case 3:return Ti(Wi.threeDigits,t);case 4:return Ti(Wi.fourDigits,t);default:return Ti(new RegExp("^\\d{1,"+e+"}"),t)}}function Zb(e,t){switch(e){case 1:return Ti(Wi.singleDigitSigned,t);case 2:return Ti(Wi.twoDigitsSigned,t);case 3:return Ti(Wi.threeDigitsSigned,t);case 4:return Ti(Wi.fourDigitsSigned,t);default:return Ti(new RegExp("^-?\\d{1,"+e+"}"),t)}}function vT(e){switch(e){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function FN(e,t){var r=t>0,i=r?t:1-t,n;if(i<=50)n=e||100;else{var a=i+50,o=Math.floor(a/100)*100,s=e>=a%100;n=e+o-(s?100:0)}return r?n:1-n}function NN(e){return e%400===0||e%4===0&&e%100!==0}var OJ=function(e){Br(r,e);var t=Fr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"priority",130),Mt(Et(i),"incompatibleTokens",["Y","R","u","w","I","i","e","c","t","T"]),i}return Ir(r,[{key:"parse",value:function(n,a,o){var s=function(c){return{year:c,isTwoDigitYear:a==="yy"}};switch(a){case"y":return Gi(Ui(4,n),s);case"yo":return Gi(o.ordinalNumber(n,{unit:"year"}),s);default:return Gi(Ui(a.length,n),s)}}},{key:"validate",value:function(n,a){return a.isTwoDigitYear||a.year>0}},{key:"set",value:function(n,a,o){var s=n.getUTCFullYear();if(o.isTwoDigitYear){var l=FN(o.year,s);return n.setUTCFullYear(l,0,1),n.setUTCHours(0,0,0,0),n}var c=!("era"in a)||a.era===1?o.year:1-o.year;return n.setUTCFullYear(c,0,1),n.setUTCHours(0,0,0,0),n}}]),r}(Wr),RJ=function(e){Br(r,e);var t=Fr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"priority",130),Mt(Et(i),"incompatibleTokens",["y","R","u","Q","q","M","L","I","d","D","i","t","T"]),i}return Ir(r,[{key:"parse",value:function(n,a,o){var s=function(c){return{year:c,isTwoDigitYear:a==="YY"}};switch(a){case"Y":return Gi(Ui(4,n),s);case"Yo":return Gi(o.ordinalNumber(n,{unit:"year"}),s);default:return Gi(Ui(a.length,n),s)}}},{key:"validate",value:function(n,a){return a.isTwoDigitYear||a.year>0}},{key:"set",value:function(n,a,o,s){var l=mT(n,s);if(o.isTwoDigitYear){var c=FN(o.year,l);return n.setUTCFullYear(c,0,s.firstWeekContainsDate),n.setUTCHours(0,0,0,0),Ku(n,s)}var d=!("era"in a)||a.era===1?o.year:1-o.year;return n.setUTCFullYear(d,0,s.firstWeekContainsDate),n.setUTCHours(0,0,0,0),Ku(n,s)}}]),r}(Wr),IJ=function(e){Br(r,e);var t=Fr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"priority",130),Mt(Et(i),"incompatibleTokens",["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]),i}return Ir(r,[{key:"parse",value:function(n,a){return Zb(a==="R"?4:a.length,n)}},{key:"set",value:function(n,a,o){var s=new Date(0);return s.setUTCFullYear(o,0,4),s.setUTCHours(0,0,0,0),op(s)}}]),r}(Wr),zJ=function(e){Br(r,e);var t=Fr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"priority",130),Mt(Et(i),"incompatibleTokens",["G","y","Y","R","w","I","i","e","c","t","T"]),i}return Ir(r,[{key:"parse",value:function(n,a){return Zb(a==="u"?4:a.length,n)}},{key:"set",value:function(n,a,o){return n.setUTCFullYear(o,0,1),n.setUTCHours(0,0,0,0),n}}]),r}(Wr),kJ=function(e){Br(r,e);var t=Fr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"priority",120),Mt(Et(i),"incompatibleTokens",["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]),i}return Ir(r,[{key:"parse",value:function(n,a,o){switch(a){case"Q":case"QQ":return Ui(a.length,n);case"Qo":return o.ordinalNumber(n,{unit:"quarter"});case"QQQ":return o.quarter(n,{width:"abbreviated",context:"formatting"})||o.quarter(n,{width:"narrow",context:"formatting"});case"QQQQQ":return o.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return o.quarter(n,{width:"wide",context:"formatting"})||o.quarter(n,{width:"abbreviated",context:"formatting"})||o.quarter(n,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(n,a){return a>=1&&a<=4}},{key:"set",value:function(n,a,o){return n.setUTCMonth((o-1)*3,1),n.setUTCHours(0,0,0,0),n}}]),r}(Wr),LJ=function(e){Br(r,e);var t=Fr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"priority",120),Mt(Et(i),"incompatibleTokens",["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]),i}return Ir(r,[{key:"parse",value:function(n,a,o){switch(a){case"q":case"qq":return Ui(a.length,n);case"qo":return o.ordinalNumber(n,{unit:"quarter"});case"qqq":return o.quarter(n,{width:"abbreviated",context:"standalone"})||o.quarter(n,{width:"narrow",context:"standalone"});case"qqqqq":return o.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return o.quarter(n,{width:"wide",context:"standalone"})||o.quarter(n,{width:"abbreviated",context:"standalone"})||o.quarter(n,{width:"narrow",context:"standalone"})}}},{key:"validate",value:function(n,a){return a>=1&&a<=4}},{key:"set",value:function(n,a,o){return n.setUTCMonth((o-1)*3,1),n.setUTCHours(0,0,0,0),n}}]),r}(Wr),BJ=function(e){Br(r,e);var t=Fr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"incompatibleTokens",["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]),Mt(Et(i),"priority",110),i}return Ir(r,[{key:"parse",value:function(n,a,o){var s=function(c){return c-1};switch(a){case"M":return Gi(Ti(Wi.month,n),s);case"MM":return Gi(Ui(2,n),s);case"Mo":return Gi(o.ordinalNumber(n,{unit:"month"}),s);case"MMM":return o.month(n,{width:"abbreviated",context:"formatting"})||o.month(n,{width:"narrow",context:"formatting"});case"MMMMM":return o.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return o.month(n,{width:"wide",context:"formatting"})||o.month(n,{width:"abbreviated",context:"formatting"})||o.month(n,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(n,a){return a>=0&&a<=11}},{key:"set",value:function(n,a,o){return n.setUTCMonth(o,1),n.setUTCHours(0,0,0,0),n}}]),r}(Wr),FJ=function(e){Br(r,e);var t=Fr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"priority",110),Mt(Et(i),"incompatibleTokens",["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]),i}return Ir(r,[{key:"parse",value:function(n,a,o){var s=function(c){return c-1};switch(a){case"L":return Gi(Ti(Wi.month,n),s);case"LL":return Gi(Ui(2,n),s);case"Lo":return Gi(o.ordinalNumber(n,{unit:"month"}),s);case"LLL":return o.month(n,{width:"abbreviated",context:"standalone"})||o.month(n,{width:"narrow",context:"standalone"});case"LLLLL":return o.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return o.month(n,{width:"wide",context:"standalone"})||o.month(n,{width:"abbreviated",context:"standalone"})||o.month(n,{width:"narrow",context:"standalone"})}}},{key:"validate",value:function(n,a){return a>=0&&a<=11}},{key:"set",value:function(n,a,o){return n.setUTCMonth(o,1),n.setUTCHours(0,0,0,0),n}}]),r}(Wr);function NJ(e,t,r){Bt(2,arguments);var i=rr(e),n=qr(t),a=DN(i,r)-n;return i.setUTCDate(i.getUTCDate()-a*7),i}var UJ=function(e){Br(r,e);var t=Fr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"priority",100),Mt(Et(i),"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","i","t","T"]),i}return Ir(r,[{key:"parse",value:function(n,a,o){switch(a){case"w":return Ti(Wi.week,n);case"wo":return o.ordinalNumber(n,{unit:"week"});default:return Ui(a.length,n)}}},{key:"validate",value:function(n,a){return a>=1&&a<=53}},{key:"set",value:function(n,a,o,s){return Ku(NJ(n,o,s),s)}}]),r}(Wr);function jJ(e,t){Bt(2,arguments);var r=rr(e),i=qr(t),n=PN(r)-i;return r.setUTCDate(r.getUTCDate()-n*7),r}var VJ=function(e){Br(r,e);var t=Fr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"priority",100),Mt(Et(i),"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]),i}return Ir(r,[{key:"parse",value:function(n,a,o){switch(a){case"I":return Ti(Wi.week,n);case"Io":return o.ordinalNumber(n,{unit:"week"});default:return Ui(a.length,n)}}},{key:"validate",value:function(n,a){return a>=1&&a<=53}},{key:"set",value:function(n,a,o){return op(jJ(n,o))}}]),r}(Wr),HJ=[31,28,31,30,31,30,31,31,30,31,30,31],WJ=[31,29,31,30,31,30,31,31,30,31,30,31],GJ=function(e){Br(r,e);var t=Fr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"priority",90),Mt(Et(i),"subPriority",1),Mt(Et(i),"incompatibleTokens",["Y","R","q","Q","w","I","D","i","e","c","t","T"]),i}return Ir(r,[{key:"parse",value:function(n,a,o){switch(a){case"d":return Ti(Wi.date,n);case"do":return o.ordinalNumber(n,{unit:"date"});default:return Ui(a.length,n)}}},{key:"validate",value:function(n,a){var o=n.getUTCFullYear(),s=NN(o),l=n.getUTCMonth();return s?a>=1&&a<=WJ[l]:a>=1&&a<=HJ[l]}},{key:"set",value:function(n,a,o){return n.setUTCDate(o),n.setUTCHours(0,0,0,0),n}}]),r}(Wr),$J=function(e){Br(r,e);var t=Fr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"priority",90),Mt(Et(i),"subpriority",1),Mt(Et(i),"incompatibleTokens",["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]),i}return Ir(r,[{key:"parse",value:function(n,a,o){switch(a){case"D":case"DD":return Ti(Wi.dayOfYear,n);case"Do":return o.ordinalNumber(n,{unit:"date"});default:return Ui(a.length,n)}}},{key:"validate",value:function(n,a){var o=n.getUTCFullYear(),s=NN(o);return s?a>=1&&a<=366:a>=1&&a<=365}},{key:"set",value:function(n,a,o){return n.setUTCMonth(0,o),n.setUTCHours(0,0,0,0),n}}]),r}(Wr);function gT(e,t,r){var i,n,a,o,s,l,c,d;Bt(2,arguments);var u=vh(),h=qr((i=(n=(a=(o=r==null?void 0:r.weekStartsOn)!==null&&o!==void 0?o:r==null||(s=r.locale)===null||s===void 0||(l=s.options)===null||l===void 0?void 0:l.weekStartsOn)!==null&&a!==void 0?a:u.weekStartsOn)!==null&&n!==void 0?n:(c=u.locale)===null||c===void 0||(d=c.options)===null||d===void 0?void 0:d.weekStartsOn)!==null&&i!==void 0?i:0);if(!(h>=0&&h<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var f=rr(e),p=qr(t),v=f.getUTCDay(),m=p%7,g=(m+7)%7,y=(g<h?7:0)+p-v;return f.setUTCDate(f.getUTCDate()+y),f}var qJ=function(e){Br(r,e);var t=Fr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"priority",90),Mt(Et(i),"incompatibleTokens",["D","i","e","c","t","T"]),i}return Ir(r,[{key:"parse",value:function(n,a,o){switch(a){case"E":case"EE":case"EEE":return o.day(n,{width:"abbreviated",context:"formatting"})||o.day(n,{width:"short",context:"formatting"})||o.day(n,{width:"narrow",context:"formatting"});case"EEEEE":return o.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return o.day(n,{width:"short",context:"formatting"})||o.day(n,{width:"narrow",context:"formatting"});case"EEEE":default:return o.day(n,{width:"wide",context:"formatting"})||o.day(n,{width:"abbreviated",context:"formatting"})||o.day(n,{width:"short",context:"formatting"})||o.day(n,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(n,a){return a>=0&&a<=6}},{key:"set",value:function(n,a,o,s){return n=gT(n,o,s),n.setUTCHours(0,0,0,0),n}}]),r}(Wr),YJ=function(e){Br(r,e);var t=Fr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"priority",90),Mt(Et(i),"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]),i}return Ir(r,[{key:"parse",value:function(n,a,o,s){var l=function(d){var u=Math.floor((d-1)/7)*7;return(d+s.weekStartsOn+6)%7+u};switch(a){case"e":case"ee":return Gi(Ui(a.length,n),l);case"eo":return Gi(o.ordinalNumber(n,{unit:"day"}),l);case"eee":return o.day(n,{width:"abbreviated",context:"formatting"})||o.day(n,{width:"short",context:"formatting"})||o.day(n,{width:"narrow",context:"formatting"});case"eeeee":return o.day(n,{width:"narrow",context:"formatting"});case"eeeeee":return o.day(n,{width:"short",context:"formatting"})||o.day(n,{width:"narrow",context:"formatting"});case"eeee":default:return o.day(n,{width:"wide",context:"formatting"})||o.day(n,{width:"abbreviated",context:"formatting"})||o.day(n,{width:"short",context:"formatting"})||o.day(n,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(n,a){return a>=0&&a<=6}},{key:"set",value:function(n,a,o,s){return n=gT(n,o,s),n.setUTCHours(0,0,0,0),n}}]),r}(Wr),XJ=function(e){Br(r,e);var t=Fr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"priority",90),Mt(Et(i),"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]),i}return Ir(r,[{key:"parse",value:function(n,a,o,s){var l=function(d){var u=Math.floor((d-1)/7)*7;return(d+s.weekStartsOn+6)%7+u};switch(a){case"c":case"cc":return Gi(Ui(a.length,n),l);case"co":return Gi(o.ordinalNumber(n,{unit:"day"}),l);case"ccc":return o.day(n,{width:"abbreviated",context:"standalone"})||o.day(n,{width:"short",context:"standalone"})||o.day(n,{width:"narrow",context:"standalone"});case"ccccc":return o.day(n,{width:"narrow",context:"standalone"});case"cccccc":return o.day(n,{width:"short",context:"standalone"})||o.day(n,{width:"narrow",context:"standalone"});case"cccc":default:return o.day(n,{width:"wide",context:"standalone"})||o.day(n,{width:"abbreviated",context:"standalone"})||o.day(n,{width:"short",context:"standalone"})||o.day(n,{width:"narrow",context:"standalone"})}}},{key:"validate",value:function(n,a){return a>=0&&a<=6}},{key:"set",value:function(n,a,o,s){return n=gT(n,o,s),n.setUTCHours(0,0,0,0),n}}]),r}(Wr);function KJ(e,t){Bt(2,arguments);var r=qr(t);r%7===0&&(r=r-7);var i=1,n=rr(e),a=n.getUTCDay(),o=r%7,s=(o+7)%7,l=(s<i?7:0)+r-a;return n.setUTCDate(n.getUTCDate()+l),n}var QJ=function(e){Br(r,e);var t=Fr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"priority",90),Mt(Et(i),"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]),i}return Ir(r,[{key:"parse",value:function(n,a,o){var s=function(c){return c===0?7:c};switch(a){case"i":case"ii":return Ui(a.length,n);case"io":return o.ordinalNumber(n,{unit:"day"});case"iii":return Gi(o.day(n,{width:"abbreviated",context:"formatting"})||o.day(n,{width:"short",context:"formatting"})||o.day(n,{width:"narrow",context:"formatting"}),s);case"iiiii":return Gi(o.day(n,{width:"narrow",context:"formatting"}),s);case"iiiiii":return Gi(o.day(n,{width:"short",context:"formatting"})||o.day(n,{width:"narrow",context:"formatting"}),s);case"iiii":default:return Gi(o.day(n,{width:"wide",context:"formatting"})||o.day(n,{width:"abbreviated",context:"formatting"})||o.day(n,{width:"short",context:"formatting"})||o.day(n,{width:"narrow",context:"formatting"}),s)}}},{key:"validate",value:function(n,a){return a>=1&&a<=7}},{key:"set",value:function(n,a,o){return n=KJ(n,o),n.setUTCHours(0,0,0,0),n}}]),r}(Wr),ZJ=function(e){Br(r,e);var t=Fr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"priority",80),Mt(Et(i),"incompatibleTokens",["b","B","H","k","t","T"]),i}return Ir(r,[{key:"parse",value:function(n,a,o){switch(a){case"a":case"aa":case"aaa":return o.dayPeriod(n,{width:"abbreviated",context:"formatting"})||o.dayPeriod(n,{width:"narrow",context:"formatting"});case"aaaaa":return o.dayPeriod(n,{width:"narrow",context:"formatting"});case"aaaa":default:return o.dayPeriod(n,{width:"wide",context:"formatting"})||o.dayPeriod(n,{width:"abbreviated",context:"formatting"})||o.dayPeriod(n,{width:"narrow",context:"formatting"})}}},{key:"set",value:function(n,a,o){return n.setUTCHours(vT(o),0,0,0),n}}]),r}(Wr),JJ=function(e){Br(r,e);var t=Fr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"priority",80),Mt(Et(i),"incompatibleTokens",["a","B","H","k","t","T"]),i}return Ir(r,[{key:"parse",value:function(n,a,o){switch(a){case"b":case"bb":case"bbb":return o.dayPeriod(n,{width:"abbreviated",context:"formatting"})||o.dayPeriod(n,{width:"narrow",context:"formatting"});case"bbbbb":return o.dayPeriod(n,{width:"narrow",context:"formatting"});case"bbbb":default:return o.dayPeriod(n,{width:"wide",context:"formatting"})||o.dayPeriod(n,{width:"abbreviated",context:"formatting"})||o.dayPeriod(n,{width:"narrow",context:"formatting"})}}},{key:"set",value:function(n,a,o){return n.setUTCHours(vT(o),0,0,0),n}}]),r}(Wr),eee=function(e){Br(r,e);var t=Fr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"priority",80),Mt(Et(i),"incompatibleTokens",["a","b","t","T"]),i}return Ir(r,[{key:"parse",value:function(n,a,o){switch(a){case"B":case"BB":case"BBB":return o.dayPeriod(n,{width:"abbreviated",context:"formatting"})||o.dayPeriod(n,{width:"narrow",context:"formatting"});case"BBBBB":return o.dayPeriod(n,{width:"narrow",context:"formatting"});case"BBBB":default:return o.dayPeriod(n,{width:"wide",context:"formatting"})||o.dayPeriod(n,{width:"abbreviated",context:"formatting"})||o.dayPeriod(n,{width:"narrow",context:"formatting"})}}},{key:"set",value:function(n,a,o){return n.setUTCHours(vT(o),0,0,0),n}}]),r}(Wr),tee=function(e){Br(r,e);var t=Fr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"priority",70),Mt(Et(i),"incompatibleTokens",["H","K","k","t","T"]),i}return Ir(r,[{key:"parse",value:function(n,a,o){switch(a){case"h":return Ti(Wi.hour12h,n);case"ho":return o.ordinalNumber(n,{unit:"hour"});default:return Ui(a.length,n)}}},{key:"validate",value:function(n,a){return a>=1&&a<=12}},{key:"set",value:function(n,a,o){var s=n.getUTCHours()>=12;return s&&o<12?n.setUTCHours(o+12,0,0,0):!s&&o===12?n.setUTCHours(0,0,0,0):n.setUTCHours(o,0,0,0),n}}]),r}(Wr),ree=function(e){Br(r,e);var t=Fr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"priority",70),Mt(Et(i),"incompatibleTokens",["a","b","h","K","k","t","T"]),i}return Ir(r,[{key:"parse",value:function(n,a,o){switch(a){case"H":return Ti(Wi.hour23h,n);case"Ho":return o.ordinalNumber(n,{unit:"hour"});default:return Ui(a.length,n)}}},{key:"validate",value:function(n,a){return a>=0&&a<=23}},{key:"set",value:function(n,a,o){return n.setUTCHours(o,0,0,0),n}}]),r}(Wr),iee=function(e){Br(r,e);var t=Fr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"priority",70),Mt(Et(i),"incompatibleTokens",["h","H","k","t","T"]),i}return Ir(r,[{key:"parse",value:function(n,a,o){switch(a){case"K":return Ti(Wi.hour11h,n);case"Ko":return o.ordinalNumber(n,{unit:"hour"});default:return Ui(a.length,n)}}},{key:"validate",value:function(n,a){return a>=0&&a<=11}},{key:"set",value:function(n,a,o){var s=n.getUTCHours()>=12;return s&&o<12?n.setUTCHours(o+12,0,0,0):n.setUTCHours(o,0,0,0),n}}]),r}(Wr),nee=function(e){Br(r,e);var t=Fr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"priority",70),Mt(Et(i),"incompatibleTokens",["a","b","h","H","K","t","T"]),i}return Ir(r,[{key:"parse",value:function(n,a,o){switch(a){case"k":return Ti(Wi.hour24h,n);case"ko":return o.ordinalNumber(n,{unit:"hour"});default:return Ui(a.length,n)}}},{key:"validate",value:function(n,a){return a>=1&&a<=24}},{key:"set",value:function(n,a,o){var s=o<=24?o%24:o;return n.setUTCHours(s,0,0,0),n}}]),r}(Wr),aee=function(e){Br(r,e);var t=Fr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"priority",60),Mt(Et(i),"incompatibleTokens",["t","T"]),i}return Ir(r,[{key:"parse",value:function(n,a,o){switch(a){case"m":return Ti(Wi.minute,n);case"mo":return o.ordinalNumber(n,{unit:"minute"});default:return Ui(a.length,n)}}},{key:"validate",value:function(n,a){return a>=0&&a<=59}},{key:"set",value:function(n,a,o){return n.setUTCMinutes(o,0,0),n}}]),r}(Wr),oee=function(e){Br(r,e);var t=Fr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"priority",50),Mt(Et(i),"incompatibleTokens",["t","T"]),i}return Ir(r,[{key:"parse",value:function(n,a,o){switch(a){case"s":return Ti(Wi.second,n);case"so":return o.ordinalNumber(n,{unit:"second"});default:return Ui(a.length,n)}}},{key:"validate",value:function(n,a){return a>=0&&a<=59}},{key:"set",value:function(n,a,o){return n.setUTCSeconds(o,0),n}}]),r}(Wr),see=function(e){Br(r,e);var t=Fr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"priority",30),Mt(Et(i),"incompatibleTokens",["t","T"]),i}return Ir(r,[{key:"parse",value:function(n,a){var o=function(l){return Math.floor(l*Math.pow(10,-a.length+3))};return Gi(Ui(a.length,n),o)}},{key:"set",value:function(n,a,o){return n.setUTCMilliseconds(o),n}}]),r}(Wr),lee=function(e){Br(r,e);var t=Fr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"priority",10),Mt(Et(i),"incompatibleTokens",["t","T","x"]),i}return Ir(r,[{key:"parse",value:function(n,a){switch(a){case"X":return Vs(js.basicOptionalMinutes,n);case"XX":return Vs(js.basic,n);case"XXXX":return Vs(js.basicOptionalSeconds,n);case"XXXXX":return Vs(js.extendedOptionalSeconds,n);case"XXX":default:return Vs(js.extended,n)}}},{key:"set",value:function(n,a,o){return a.timestampIsSet?n:new Date(n.getTime()-o)}}]),r}(Wr),cee=function(e){Br(r,e);var t=Fr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"priority",10),Mt(Et(i),"incompatibleTokens",["t","T","X"]),i}return Ir(r,[{key:"parse",value:function(n,a){switch(a){case"x":return Vs(js.basicOptionalMinutes,n);case"xx":return Vs(js.basic,n);case"xxxx":return Vs(js.basicOptionalSeconds,n);case"xxxxx":return Vs(js.extendedOptionalSeconds,n);case"xxx":default:return Vs(js.extended,n)}}},{key:"set",value:function(n,a,o){return a.timestampIsSet?n:new Date(n.getTime()-o)}}]),r}(Wr),dee=function(e){Br(r,e);var t=Fr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"priority",40),Mt(Et(i),"incompatibleTokens","*"),i}return Ir(r,[{key:"parse",value:function(n){return BN(n)}},{key:"set",value:function(n,a,o){return[new Date(o*1e3),{timestampIsSet:!0}]}}]),r}(Wr),uee=function(e){Br(r,e);var t=Fr(r);function r(){var i;Rr(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return i=t.call.apply(t,[this].concat(a)),Mt(Et(i),"priority",20),Mt(Et(i),"incompatibleTokens","*"),i}return Ir(r,[{key:"parse",value:function(n){return BN(n)}},{key:"set",value:function(n,a,o){return[new Date(o),{timestampIsSet:!0}]}}]),r}(Wr),hee={G:new DJ,y:new OJ,Y:new RJ,R:new IJ,u:new zJ,Q:new kJ,q:new LJ,M:new BJ,L:new FJ,w:new UJ,I:new VJ,d:new GJ,D:new $J,E:new qJ,e:new YJ,c:new XJ,i:new QJ,a:new ZJ,b:new JJ,B:new eee,h:new tee,H:new ree,K:new iee,k:new nee,m:new aee,s:new oee,S:new see,X:new lee,x:new cee,t:new dee,T:new uee},fee=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,pee=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,mee=/^'([^]*?)'?$/,vee=/''/g,gee=/\S/,yee=/[a-zA-Z]/;function bee(e,t,r,i){var n,a,o,s,l,c,d,u,h,f,p,v,m,g,y,b,x,S;Bt(3,arguments);var w=String(e),_=String(t),C=vh(),A=(n=(a=i==null?void 0:i.locale)!==null&&a!==void 0?a:C.locale)!==null&&n!==void 0?n:fT;if(!A.match)throw new RangeError("locale must contain match property");var M=qr((o=(s=(l=(c=i==null?void 0:i.firstWeekContainsDate)!==null&&c!==void 0?c:i==null||(d=i.locale)===null||d===void 0||(u=d.options)===null||u===void 0?void 0:u.firstWeekContainsDate)!==null&&l!==void 0?l:C.firstWeekContainsDate)!==null&&s!==void 0?s:(h=C.locale)===null||h===void 0||(f=h.options)===null||f===void 0?void 0:f.firstWeekContainsDate)!==null&&o!==void 0?o:1);if(!(M>=1&&M<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var P=qr((p=(v=(m=(g=i==null?void 0:i.weekStartsOn)!==null&&g!==void 0?g:i==null||(y=i.locale)===null||y===void 0||(b=y.options)===null||b===void 0?void 0:b.weekStartsOn)!==null&&m!==void 0?m:C.weekStartsOn)!==null&&v!==void 0?v:(x=C.locale)===null||x===void 0||(S=x.options)===null||S===void 0?void 0:S.weekStartsOn)!==null&&p!==void 0?p:0);if(!(P>=0&&P<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(_==="")return w===""?rr(r):new Date(NaN);var T={firstWeekContainsDate:M,weekStartsOn:P,locale:A},R=[new PJ],z=_.match(pee).map(function(ne){var V=ne[0];if(V in d2){var de=d2[V];return de(ne,A.formatLong)}return ne}).join("").match(fee),F=[],H=wO(z),N;try{var U=function(){var V=N.value;!(i!=null&&i.useAdditionalWeekYearTokens)&&IN(V)&&Yb(V,_,e),!(i!=null&&i.useAdditionalDayOfYearTokens)&&RN(V)&&Yb(V,_,e);var de=V[0],me=hee[de];if(me){var Ce=me.incompatibleTokens;if(Array.isArray(Ce)){var G=F.find(function(ue){return Ce.includes(ue.token)||ue.token===de});if(G)throw new RangeError("The format string mustn't contain `".concat(G.fullToken,"` and `").concat(V,"` at the same time"))}else if(me.incompatibleTokens==="*"&&F.length>0)throw new RangeError("The format string mustn't contain `".concat(V,"` and any other token at the same time"));F.push({token:de,fullToken:V});var Z=me.run(w,V,A.match,T);if(!Z)return{v:new Date(NaN)};R.push(Z.setter),w=Z.rest}else{if(de.match(yee))throw new RangeError("Format string contains an unescaped latin alphabet character `"+de+"`");if(V==="''"?V="'":de==="'"&&(V=xee(V)),w.indexOf(V)===0)w=w.slice(V.length);else return{v:new Date(NaN)}}};for(H.s();!(N=H.n()).done;){var ie=U();if(al(ie)==="object")return ie.v}}catch(ne){H.e(ne)}finally{H.f()}if(w.length>0&&gee.test(w))return new Date(NaN);var te=R.map(function(ne){return ne.priority}).sort(function(ne,V){return V-ne}).filter(function(ne,V,de){return de.indexOf(ne)===V}).map(function(ne){return R.filter(function(V){return V.priority===ne}).sort(function(V,de){return de.subPriority-V.subPriority})}).map(function(ne){return ne[0]}),X=rr(r);if(isNaN(X.getTime()))return new Date(NaN);var W=EN(X,MN(X)),q={},$=wO(te),le;try{for($.s();!(le=$.n()).done;){var ee=le.value;if(!ee.validate(W,T))return new Date(NaN);var Q=ee.set(W,q,T);Array.isArray(Q)?(W=Q[0],bJ(q,Q[1])):W=Q}}catch(ne){$.e(ne)}finally{$.f()}return W}function xee(e){return e.match(mee)[1].replace(vee,"'")}function wee(e){Bt(1,arguments);var t=rr(e);return t.setMinutes(0,0,0),t}function See(e,t,r){Bt(2,arguments);var i=l2(e,r),n=l2(t,r);return i.getTime()===n.getTime()}function Rg(e,t){Bt(2,arguments);var r=rr(e),i=rr(t);return r.getFullYear()===i.getFullYear()&&r.getMonth()===i.getMonth()}function UN(e,t){Bt(2,arguments);var r=Qv(e),i=Qv(t);return r.getTime()===i.getTime()}function yT(e){Bt(1,arguments);var t=rr(e);return t.setMilliseconds(0),t}function jN(e,t){Bt(2,arguments);var r=rr(e),i=rr(t);return r.getFullYear()===i.getFullYear()}function bT(e,t){Bt(2,arguments);var r=rr(e),i=qr(t),n=r.getFullYear(),a=r.getDate(),o=new Date(0);o.setFullYear(n,i,15),o.setHours(0,0,0,0);var s=wJ(o);return r.setMonth(i,Math.min(a,s)),r}function Yn(e,t){if(Bt(2,arguments),al(t)!=="object"||t===null)throw new RangeError("values parameter must be an object");var r=rr(e);return isNaN(r.getTime())?new Date(NaN):(t.year!=null&&r.setFullYear(t.year),t.month!=null&&(r=bT(r,t.month)),t.date!=null&&r.setDate(qr(t.date)),t.hours!=null&&r.setHours(qr(t.hours)),t.minutes!=null&&r.setMinutes(qr(t.minutes)),t.seconds!=null&&r.setSeconds(qr(t.seconds)),t.milliseconds!=null&&r.setMilliseconds(qr(t.milliseconds)),r)}function Gd(e,t){Bt(2,arguments);var r=rr(e),i=qr(t);return r.setHours(i),r}function $w(e,t){Bt(2,arguments);var r=rr(e),i=qr(t);return r.setMinutes(i),r}function Cee(e,t){Bt(2,arguments);var r=rr(e),i=qr(t),n=Math.floor(r.getMonth()/3)+1,a=i-n;return bT(r,r.getMonth()+a*3)}function qw(e,t){Bt(2,arguments);var r=rr(e),i=qr(t);return r.setSeconds(i),r}function SO(e,t){Bt(2,arguments);var r=rr(e),i=qr(t);return isNaN(r.getTime())?new Date(NaN):(r.setFullYear(i),r)}function dc(e){const{mergedLocaleRef:t,mergedDateLocaleRef:r}=_t(mh,null)||{},i=re(()=>{var a,o;return(o=(a=t==null?void 0:t.value)===null||a===void 0?void 0:a[e])!==null&&o!==void 0?o:fZ[e]});return{dateLocaleRef:re(()=>{var a;return(a=r==null?void 0:r.value)!==null&&a!==void 0?a:qZ}),localeRef:i}}function gh(e,t,r){if(!t)return;const i=kd(),n=_t(mh,null),a=()=>{const o=r.value;t.mount({id:o===void 0?e:o+e,head:!0,anchorMetaName:Kv,props:{bPrefix:o?`.${o}-`:void 0},ssr:i}),n!=null&&n.preflightStyleDisabled||AN.mount({id:"n-global",head:!0,anchorMetaName:Kv,ssr:i})};i?a():Mg(a)}function Dr(e,t,r,i){var n;r||C1("useThemeClass","cssVarsRef is not passed");const a=(n=_t(mh,null))===null||n===void 0?void 0:n.mergedThemeHashRef,o=ge(""),s=kd();let l;const c=`__${e}`,d=()=>{let u=c;const h=t?t.value:void 0,f=a==null?void 0:a.value;f&&(u+="-"+f),h&&(u+="-"+h);const{themeOverrides:p,builtinThemeOverrides:v}=i;p&&(u+="-"+X_(JSON.stringify(p))),v&&(u+="-"+X_(JSON.stringify(v))),o.value=u,l=()=>{const m=r.value;let g="";for(const y in m)g+=`${y}: ${m[y]};`;ve(`.${u}`,g).mount({id:u,ssr:s}),l=void 0}};return Qa(()=>{d()}),{themeClass:o,onRender:()=>{l==null||l()}}}function Ja(e,t,r){if(!t)return;const i=kd(),n=re(()=>{const{value:o}=t;if(!o)return;const s=o[e];if(s)return s}),a=()=>{Qa(()=>{const{value:o}=r,s=`${o}${e}Rtl`;if(p$(s,i))return;const{value:l}=n;l&&l.style.mount({id:s,head:!0,anchorMetaName:Kv,props:{bPrefix:o?`.${o}-`:void 0},ssr:i})})};return i?a():Mg(a),n}const h2=Ve({name:"Add",render(){return E("svg",{width:"512",height:"512",viewBox:"0 0 512 512",fill:"none",xmlns:"http://www.w3.org/2000/svg"},E("path",{d:"M256 112V400M400 256H112",stroke:"currentColor","stroke-width":"32","stroke-linecap":"round","stroke-linejoin":"round"}))}}),_ee=Ve({name:"ArrowDown",render(){return E("svg",{viewBox:"0 0 28 28",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},E("g",{stroke:"none","stroke-width":"1","fill-rule":"evenodd"},E("g",{"fill-rule":"nonzero"},E("path",{d:"M23.7916,15.2664 C24.0788,14.9679 24.0696,14.4931 23.7711,14.206 C23.4726,13.9188 22.9978,13.928 22.7106,14.2265 L14.7511,22.5007 L14.7511,3.74792 C14.7511,3.33371 14.4153,2.99792 14.0011,2.99792 C13.5869,2.99792 13.2511,3.33371 13.2511,3.74793 L13.2511,22.4998 L5.29259,14.2265 C5.00543,13.928 4.53064,13.9188 4.23213,14.206 C3.93361,14.4931 3.9244,14.9679 4.21157,15.2664 L13.2809,24.6944 C13.6743,25.1034 14.3289,25.1034 14.7223,24.6944 L23.7916,15.2664 Z"}))))}}),Aee=Ve({name:"ArrowUp",render(){return E("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},E("g",{fill:"none"},E("path",{d:"M3.13 9.163a.5.5 0 1 0 .74.674L9.5 3.67V17.5a.5.5 0 0 0 1 0V3.672l5.63 6.165a.5.5 0 0 0 .738-.674l-6.315-6.916a.746.746 0 0 0-.632-.24a.746.746 0 0 0-.476.24L3.131 9.163z",fill:"currentColor"})))}});function uc(e,t){return Ve({name:zK(e),setup(){var r;const i=(r=_t(mh,null))===null||r===void 0?void 0:r.mergedIconsRef;return()=>{var n;const a=(n=i==null?void 0:i.value)===null||n===void 0?void 0:n[e];return a?a():t}}})}const sp=Ve({name:"Backward",render(){return E("svg",{viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},E("path",{d:"M12.2674 15.793C11.9675 16.0787 11.4927 16.0672 11.2071 15.7673L6.20572 10.5168C5.9298 10.2271 5.9298 9.7719 6.20572 9.48223L11.2071 4.23177C11.4927 3.93184 11.9675 3.92031 12.2674 4.206C12.5673 4.49169 12.5789 4.96642 12.2932 5.26634L7.78458 9.99952L12.2932 14.7327C12.5789 15.0326 12.5673 15.5074 12.2674 15.793Z",fill:"currentColor"}))}}),CO=uc("date",E("svg",{width:"28px",height:"28px",viewBox:"0 0 28 28",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},E("g",{stroke:"none","stroke-width":"1","fill-rule":"evenodd"},E("g",{"fill-rule":"nonzero"},E("path",{d:"M21.75,3 C23.5449254,3 25,4.45507456 25,6.25 L25,21.75 C25,23.5449254 23.5449254,25 21.75,25 L6.25,25 C4.45507456,25 3,23.5449254 3,21.75 L3,6.25 C3,4.45507456 4.45507456,3 6.25,3 L21.75,3 Z M23.5,9.503 L4.5,9.503 L4.5,21.75 C4.5,22.7164983 5.28350169,23.5 6.25,23.5 L21.75,23.5 C22.7164983,23.5 23.5,22.7164983 23.5,21.75 L23.5,9.503 Z M21.75,4.5 L6.25,4.5 C5.28350169,4.5 4.5,5.28350169 4.5,6.25 L4.5,8.003 L23.5,8.003 L23.5,6.25 C23.5,5.28350169 22.7164983,4.5 21.75,4.5 Z"}))))),Mee=Ve({name:"Checkmark",render(){return E("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16"},E("g",{fill:"none"},E("path",{d:"M14.046 3.486a.75.75 0 0 1-.032 1.06l-7.93 7.474a.85.85 0 0 1-1.188-.022l-2.68-2.72a.75.75 0 1 1 1.068-1.053l2.234 2.267l7.468-7.038a.75.75 0 0 1 1.06.032z",fill:"currentColor"})))}}),VN=Ve({name:"ChevronRight",render(){return E("svg",{viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},E("path",{d:"M5.64645 3.14645C5.45118 3.34171 5.45118 3.65829 5.64645 3.85355L9.79289 8L5.64645 12.1464C5.45118 12.3417 5.45118 12.6583 5.64645 12.8536C5.84171 13.0488 6.15829 13.0488 6.35355 12.8536L10.8536 8.35355C11.0488 8.15829 11.0488 7.84171 10.8536 7.64645L6.35355 3.14645C6.15829 2.95118 5.84171 2.95118 5.64645 3.14645Z",fill:"currentColor"}))}}),Eee=uc("close",E("svg",{viewBox:"0 0 12 12",version:"1.1",xmlns:"http://www.w3.org/2000/svg","aria-hidden":!0},E("g",{stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},E("g",{fill:"currentColor","fill-rule":"nonzero"},E("path",{d:"M2.08859116,2.2156945 L2.14644661,2.14644661 C2.32001296,1.97288026 2.58943736,1.95359511 2.7843055,2.08859116 L2.85355339,2.14644661 L6,5.293 L9.14644661,2.14644661 C9.34170876,1.95118446 9.65829124,1.95118446 9.85355339,2.14644661 C10.0488155,2.34170876 10.0488155,2.65829124 9.85355339,2.85355339 L6.707,6 L9.85355339,9.14644661 C10.0271197,9.32001296 10.0464049,9.58943736 9.91140884,9.7843055 L9.85355339,9.85355339 C9.67998704,10.0271197 9.41056264,10.0464049 9.2156945,9.91140884 L9.14644661,9.85355339 L6,6.707 L2.85355339,9.85355339 C2.65829124,10.0488155 2.34170876,10.0488155 2.14644661,9.85355339 C1.95118446,9.65829124 1.95118446,9.34170876 2.14644661,9.14644661 L5.293,6 L2.14644661,2.85355339 C1.97288026,2.67998704 1.95359511,2.41056264 2.08859116,2.2156945 L2.14644661,2.14644661 L2.08859116,2.2156945 Z"}))))),Tee=Ve({name:"Eye",render(){return E("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},E("path",{d:"M255.66 112c-77.94 0-157.89 45.11-220.83 135.33a16 16 0 0 0-.27 17.77C82.92 340.8 161.8 400 255.66 400c92.84 0 173.34-59.38 221.79-135.25a16.14 16.14 0 0 0 0-17.47C428.89 172.28 347.8 112 255.66 112z",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"}),E("circle",{cx:"256",cy:"256",r:"80",fill:"none",stroke:"currentColor","stroke-miterlimit":"10","stroke-width":"32"}))}}),Pee=Ve({name:"EyeOff",render(){return E("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},E("path",{d:"M432 448a15.92 15.92 0 0 1-11.31-4.69l-352-352a16 16 0 0 1 22.62-22.62l352 352A16 16 0 0 1 432 448z",fill:"currentColor"}),E("path",{d:"M255.66 384c-41.49 0-81.5-12.28-118.92-36.5c-34.07-22-64.74-53.51-88.7-91v-.08c19.94-28.57 41.78-52.73 65.24-72.21a2 2 0 0 0 .14-2.94L93.5 161.38a2 2 0 0 0-2.71-.12c-24.92 21-48.05 46.76-69.08 76.92a31.92 31.92 0 0 0-.64 35.54c26.41 41.33 60.4 76.14 98.28 100.65C162 402 207.9 416 255.66 416a239.13 239.13 0 0 0 75.8-12.58a2 2 0 0 0 .77-3.31l-21.58-21.58a4 4 0 0 0-3.83-1a204.8 204.8 0 0 1-51.16 6.47z",fill:"currentColor"}),E("path",{d:"M490.84 238.6c-26.46-40.92-60.79-75.68-99.27-100.53C349 110.55 302 96 255.66 96a227.34 227.34 0 0 0-74.89 12.83a2 2 0 0 0-.75 3.31l21.55 21.55a4 4 0 0 0 3.88 1a192.82 192.82 0 0 1 50.21-6.69c40.69 0 80.58 12.43 118.55 37c34.71 22.4 65.74 53.88 89.76 91a.13.13 0 0 1 0 .16a310.72 310.72 0 0 1-64.12 72.73a2 2 0 0 0-.15 2.95l19.9 19.89a2 2 0 0 0 2.7.13a343.49 343.49 0 0 0 68.64-78.48a32.2 32.2 0 0 0-.1-34.78z",fill:"currentColor"}),E("path",{d:"M256 160a95.88 95.88 0 0 0-21.37 2.4a2 2 0 0 0-1 3.38l112.59 112.56a2 2 0 0 0 3.38-1A96 96 0 0 0 256 160z",fill:"currentColor"}),E("path",{d:"M165.78 233.66a2 2 0 0 0-3.38 1a96 96 0 0 0 115 115a2 2 0 0 0 1-3.38z",fill:"currentColor"}))}}),Dee=Ve({name:"Empty",render(){return E("svg",{viewBox:"0 0 28 28",fill:"none",xmlns:"http://www.w3.org/2000/svg"},E("path",{d:"M26 7.5C26 11.0899 23.0899 14 19.5 14C15.9101 14 13 11.0899 13 7.5C13 3.91015 15.9101 1 19.5 1C23.0899 1 26 3.91015 26 7.5ZM16.8536 4.14645C16.6583 3.95118 16.3417 3.95118 16.1464 4.14645C15.9512 4.34171 15.9512 4.65829 16.1464 4.85355L18.7929 7.5L16.1464 10.1464C15.9512 10.3417 15.9512 10.6583 16.1464 10.8536C16.3417 11.0488 16.6583 11.0488 16.8536 10.8536L19.5 8.20711L22.1464 10.8536C22.3417 11.0488 22.6583 11.0488 22.8536 10.8536C23.0488 10.6583 23.0488 10.3417 22.8536 10.1464L20.2071 7.5L22.8536 4.85355C23.0488 4.65829 23.0488 4.34171 22.8536 4.14645C22.6583 3.95118 22.3417 3.95118 22.1464 4.14645L19.5 6.79289L16.8536 4.14645Z",fill:"currentColor"}),E("path",{d:"M25 22.75V12.5991C24.5572 13.0765 24.053 13.4961 23.5 13.8454V16H17.5L17.3982 16.0068C17.0322 16.0565 16.75 16.3703 16.75 16.75C16.75 18.2688 15.5188 19.5 14 19.5C12.4812 19.5 11.25 18.2688 11.25 16.75L11.2432 16.6482C11.1935 16.2822 10.8797 16 10.5 16H4.5V7.25C4.5 6.2835 5.2835 5.5 6.25 5.5H12.2696C12.4146 4.97463 12.6153 4.47237 12.865 4H6.25C4.45507 4 3 5.45507 3 7.25V22.75C3 24.5449 4.45507 26 6.25 26H21.75C23.5449 26 25 24.5449 25 22.75ZM4.5 22.75V17.5H9.81597L9.85751 17.7041C10.2905 19.5919 11.9808 21 14 21L14.215 20.9947C16.2095 20.8953 17.842 19.4209 18.184 17.5H23.5V22.75C23.5 23.7165 22.7165 24.5 21.75 24.5H6.25C5.2835 24.5 4.5 23.7165 4.5 22.75Z",fill:"currentColor"}))}}),Oee=uc("error",E("svg",{viewBox:"0 0 48 48",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},E("g",{stroke:"none","stroke-width":"1","fill-rule":"evenodd"},E("g",{"fill-rule":"nonzero"},E("path",{d:"M24,4 C35.045695,4 44,12.954305 44,24 C44,35.045695 35.045695,44 24,44 C12.954305,44 4,35.045695 4,24 C4,12.954305 12.954305,4 24,4 Z M17.8838835,16.1161165 L17.7823881,16.0249942 C17.3266086,15.6583353 16.6733914,15.6583353 16.2176119,16.0249942 L16.1161165,16.1161165 L16.0249942,16.2176119 C15.6583353,16.6733914 15.6583353,17.3266086 16.0249942,17.7823881 L16.1161165,17.8838835 L22.233,24 L16.1161165,30.1161165 L16.0249942,30.2176119 C15.6583353,30.6733914 15.6583353,31.3266086 16.0249942,31.7823881 L16.1161165,31.8838835 L16.2176119,31.9750058 C16.6733914,32.3416647 17.3266086,32.3416647 17.7823881,31.9750058 L17.8838835,31.8838835 L24,25.767 L30.1161165,31.8838835 L30.2176119,31.9750058 C30.6733914,32.3416647 31.3266086,32.3416647 31.7823881,31.9750058 L31.8838835,31.8838835 L31.9750058,31.7823881 C32.3416647,31.3266086 32.3416647,30.6733914 31.9750058,30.2176119 L31.8838835,30.1161165 L25.767,24 L31.8838835,17.8838835 L31.9750058,17.7823881 C32.3416647,17.3266086 32.3416647,16.6733914 31.9750058,16.2176119 L31.8838835,16.1161165 L31.7823881,16.0249942 C31.3266086,15.6583353 30.6733914,15.6583353 30.2176119,16.0249942 L30.1161165,16.1161165 L24,22.233 L17.8838835,16.1161165 L17.7823881,16.0249942 L17.8838835,16.1161165 Z"}))))),lp=Ve({name:"FastBackward",render(){return E("svg",{viewBox:"0 0 20 20",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},E("g",{stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},E("g",{fill:"currentColor","fill-rule":"nonzero"},E("path",{d:"M8.73171,16.7949 C9.03264,17.0795 9.50733,17.0663 9.79196,16.7654 C10.0766,16.4644 10.0634,15.9897 9.76243,15.7051 L4.52339,10.75 L17.2471,10.75 C17.6613,10.75 17.9971,10.4142 17.9971,10 C17.9971,9.58579 17.6613,9.25 17.2471,9.25 L4.52112,9.25 L9.76243,4.29275 C10.0634,4.00812 10.0766,3.53343 9.79196,3.2325 C9.50733,2.93156 9.03264,2.91834 8.73171,3.20297 L2.31449,9.27241 C2.14819,9.4297 2.04819,9.62981 2.01448,9.8386 C2.00308,9.89058 1.99707,9.94459 1.99707,10 C1.99707,10.0576 2.00356,10.1137 2.01585,10.1675 C2.05084,10.3733 2.15039,10.5702 2.31449,10.7254 L8.73171,16.7949 Z"}))))}}),cp=Ve({name:"FastForward",render(){return E("svg",{viewBox:"0 0 20 20",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},E("g",{stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},E("g",{fill:"currentColor","fill-rule":"nonzero"},E("path",{d:"M11.2654,3.20511 C10.9644,2.92049 10.4897,2.93371 10.2051,3.23464 C9.92049,3.53558 9.93371,4.01027 10.2346,4.29489 L15.4737,9.25 L2.75,9.25 C2.33579,9.25 2,9.58579 2,10.0000012 C2,10.4142 2.33579,10.75 2.75,10.75 L15.476,10.75 L10.2346,15.7073 C9.93371,15.9919 9.92049,16.4666 10.2051,16.7675 C10.4897,17.0684 10.9644,17.0817 11.2654,16.797 L17.6826,10.7276 C17.8489,10.5703 17.9489,10.3702 17.9826,10.1614 C17.994,10.1094 18,10.0554 18,10.0000012 C18,9.94241 17.9935,9.88633 17.9812,9.83246 C17.9462,9.62667 17.8467,9.42976 17.6826,9.27455 L11.2654,3.20511 Z"}))))}}),dp=Ve({name:"Forward",render(){return E("svg",{viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},E("path",{d:"M7.73271 4.20694C8.03263 3.92125 8.50737 3.93279 8.79306 4.23271L13.7944 9.48318C14.0703 9.77285 14.0703 10.2281 13.7944 10.5178L8.79306 15.7682C8.50737 16.0681 8.03263 16.0797 7.73271 15.794C7.43279 15.5083 7.42125 15.0336 7.70694 14.7336L12.2155 10.0005L7.70694 5.26729C7.42125 4.96737 7.43279 4.49264 7.73271 4.20694Z",fill:"currentColor"}))}}),Ree=uc("info",E("svg",{viewBox:"0 0 28 28",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},E("g",{stroke:"none","stroke-width":"1","fill-rule":"evenodd"},E("g",{"fill-rule":"nonzero"},E("path",{d:"M14,2 C20.6274,2 26,7.37258 26,14 C26,20.6274 20.6274,26 14,26 C7.37258,26 2,20.6274 2,14 C2,7.37258 7.37258,2 14,2 Z M14,11 C13.4477,11 13,11.4477 13,12 L13,12 L13,20 C13,20.5523 13.4477,21 14,21 C14.5523,21 15,20.5523 15,20 L15,20 L15,12 C15,11.4477 14.5523,11 14,11 Z M14,6.75 C13.3096,6.75 12.75,7.30964 12.75,8 C12.75,8.69036 13.3096,9.25 14,9.25 C14.6904,9.25 15.25,8.69036 15.25,8 C15.25,7.30964 14.6904,6.75 14,6.75 Z"}))))),Iee=Ve({name:"Remove",render(){return E("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},E("line",{x1:"400",y1:"256",x2:"112",y2:"256",style:`
        fill: none;
        stroke: currentColor;
        stroke-linecap: round;
        stroke-linejoin: round;
        stroke-width: 32px;
      `}))}}),zee=Ve({name:"Search",render(){return E("svg",{version:"1.1",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",style:"enable-background: new 0 0 512 512"},E("path",{d:`M443.5,420.2L336.7,312.4c20.9-26.2,33.5-59.4,33.5-95.5c0-84.5-68.5-153-153.1-153S64,132.5,64,217s68.5,153,153.1,153
  c36.6,0,70.1-12.8,96.5-34.2l106.1,107.1c3.2,3.4,7.6,5.1,11.9,5.1c4.1,0,8.2-1.5,11.3-4.5C449.5,437.2,449.7,426.8,443.5,420.2z
   M217.1,337.1c-32.1,0-62.3-12.5-85-35.2c-22.7-22.7-35.2-52.9-35.2-84.9c0-32.1,12.5-62.3,35.2-84.9c22.7-22.7,52.9-35.2,85-35.2
  c32.1,0,62.3,12.5,85,35.2c22.7,22.7,35.2,52.9,35.2,84.9c0,32.1-12.5,62.3-35.2,84.9C279.4,324.6,249.2,337.1,217.1,337.1z`}))}}),kee=uc("success",E("svg",{viewBox:"0 0 48 48",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},E("g",{stroke:"none","stroke-width":"1","fill-rule":"evenodd"},E("g",{"fill-rule":"nonzero"},E("path",{d:"M24,4 C35.045695,4 44,12.954305 44,24 C44,35.045695 35.045695,44 24,44 C12.954305,44 4,35.045695 4,24 C4,12.954305 12.954305,4 24,4 Z M32.6338835,17.6161165 C32.1782718,17.1605048 31.4584514,17.1301307 30.9676119,17.5249942 L30.8661165,17.6161165 L20.75,27.732233 L17.1338835,24.1161165 C16.6457281,23.6279612 15.8542719,23.6279612 15.3661165,24.1161165 C14.9105048,24.5717282 14.8801307,25.2915486 15.2749942,25.7823881 L15.3661165,25.8838835 L19.8661165,30.3838835 C20.3217282,30.8394952 21.0415486,30.8698693 21.5323881,30.4750058 L21.6338835,30.3838835 L32.6338835,19.3838835 C33.1220388,18.8957281 33.1220388,18.1042719 32.6338835,17.6161165 Z"}))))),Lee=uc("time",E("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},E("path",{d:"M256,64C150,64,64,150,64,256s86,192,192,192,192-86,192-192S362,64,256,64Z",style:`
        fill: none;
        stroke: currentColor;
        stroke-miterlimit: 10;
        stroke-width: 32px;
      `}),E("polyline",{points:"256 128 256 272 352 272",style:`
        fill: none;
        stroke: currentColor;
        stroke-linecap: round;
        stroke-linejoin: round;
        stroke-width: 32px;
      `}))),Bee=uc("warning",E("svg",{viewBox:"0 0 24 24",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},E("g",{stroke:"none","stroke-width":"1","fill-rule":"evenodd"},E("g",{"fill-rule":"nonzero"},E("path",{d:"M12,2 C17.523,2 22,6.478 22,12 C22,17.522 17.523,22 12,22 C6.477,22 2,17.522 2,12 C2,6.478 6.477,2 12,2 Z M12.0018002,15.0037242 C11.450254,15.0037242 11.0031376,15.4508407 11.0031376,16.0023869 C11.0031376,16.553933 11.450254,17.0010495 12.0018002,17.0010495 C12.5533463,17.0010495 13.0004628,16.553933 13.0004628,16.0023869 C13.0004628,15.4508407 12.5533463,15.0037242 12.0018002,15.0037242 Z M11.99964,7 C11.4868042,7.00018474 11.0642719,7.38637706 11.0066858,7.8837365 L11,8.00036004 L11.0018003,13.0012393 L11.00857,13.117858 C11.0665141,13.6151758 11.4893244,14.0010638 12.0021602,14.0008793 C12.514996,14.0006946 12.9375283,13.6145023 12.9951144,13.1171428 L13.0018002,13.0005193 L13,7.99964009 L12.9932303,7.8830214 C12.9352861,7.38570354 12.5124758,6.99981552 11.99964,7 Z"}))))),Fee=Ve({name:"ChevronDown",render(){return E("svg",{viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},E("path",{d:"M3.14645 5.64645C3.34171 5.45118 3.65829 5.45118 3.85355 5.64645L8 9.79289L12.1464 5.64645C12.3417 5.45118 12.6583 5.45118 12.8536 5.64645C13.0488 5.84171 13.0488 6.15829 12.8536 6.35355L8.35355 10.8536C8.15829 11.0488 7.84171 11.0488 7.64645 10.8536L3.14645 6.35355C2.95118 6.15829 2.95118 5.84171 3.14645 5.64645Z",fill:"currentColor"}))}}),Nee=uc("clear",E("svg",{viewBox:"0 0 16 16",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},E("g",{stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},E("g",{fill:"currentColor","fill-rule":"nonzero"},E("path",{d:"M8,2 C11.3137085,2 14,4.6862915 14,8 C14,11.3137085 11.3137085,14 8,14 C4.6862915,14 2,11.3137085 2,8 C2,4.6862915 4.6862915,2 8,2 Z M6.5343055,5.83859116 C6.33943736,5.70359511 6.07001296,5.72288026 5.89644661,5.89644661 L5.89644661,5.89644661 L5.83859116,5.9656945 C5.70359511,6.16056264 5.72288026,6.42998704 5.89644661,6.60355339 L5.89644661,6.60355339 L7.293,8 L5.89644661,9.39644661 L5.83859116,9.4656945 C5.70359511,9.66056264 5.72288026,9.92998704 5.89644661,10.1035534 L5.89644661,10.1035534 L5.9656945,10.1614088 C6.16056264,10.2964049 6.42998704,10.2771197 6.60355339,10.1035534 L6.60355339,10.1035534 L8,8.707 L9.39644661,10.1035534 L9.4656945,10.1614088 C9.66056264,10.2964049 9.92998704,10.2771197 10.1035534,10.1035534 L10.1035534,10.1035534 L10.1614088,10.0343055 C10.2964049,9.83943736 10.2771197,9.57001296 10.1035534,9.39644661 L10.1035534,9.39644661 L8.707,8 L10.1035534,6.60355339 L10.1614088,6.5343055 C10.2964049,6.33943736 10.2771197,6.07001296 10.1035534,5.89644661 L10.1035534,5.89644661 L10.0343055,5.83859116 C9.83943736,5.70359511 9.57001296,5.72288026 9.39644661,5.89644661 L9.39644661,5.89644661 L8,7.293 L6.60355339,5.89644661 Z"}))))),Uee=Ve({name:"ChevronDownFilled",render(){return E("svg",{viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},E("path",{d:"M3.20041 5.73966C3.48226 5.43613 3.95681 5.41856 4.26034 5.70041L8 9.22652L11.7397 5.70041C12.0432 5.41856 12.5177 5.43613 12.7996 5.73966C13.0815 6.0432 13.0639 6.51775 12.7603 6.7996L8.51034 10.7996C8.22258 11.0668 7.77743 11.0668 7.48967 10.7996L3.23966 6.7996C2.93613 6.51775 2.91856 6.0432 3.20041 5.73966Z",fill:"currentColor"}))}}),jee=uc("to",E("svg",{viewBox:"0 0 20 20",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},E("g",{stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},E("g",{fill:"currentColor","fill-rule":"nonzero"},E("path",{d:"M11.2654,3.20511 C10.9644,2.92049 10.4897,2.93371 10.2051,3.23464 C9.92049,3.53558 9.93371,4.01027 10.2346,4.29489 L15.4737,9.25 L2.75,9.25 C2.33579,9.25 2,9.58579 2,10.0000012 C2,10.4142 2.33579,10.75 2.75,10.75 L15.476,10.75 L10.2346,15.7073 C9.93371,15.9919 9.92049,16.4666 10.2051,16.7675 C10.4897,17.0684 10.9644,17.0817 11.2654,16.797 L17.6826,10.7276 C17.8489,10.5703 17.9489,10.3702 17.9826,10.1614 C17.994,10.1094 18,10.0554 18,10.0000012 C18,9.94241 17.9935,9.88633 17.9812,9.83246 C17.9462,9.62667 17.8467,9.42976 17.6826,9.27455 L11.2654,3.20511 Z"}))))),Vee=Ve({name:"ArrowBack",render(){return E("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},E("path",{d:"M0 0h24v24H0V0z",fill:"none"}),E("path",{d:"M19 11H7.83l4.88-4.88c.39-.39.39-1.03 0-1.42-.39-.39-1.02-.39-1.41 0l-6.59 6.59c-.39.39-.39 1.02 0 1.41l6.59 6.59c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41L7.83 13H19c.55 0 1-.45 1-1s-.45-1-1-1z"}))}}),zp=Ve({name:"BaseIconSwitchTransition",setup(e,{slots:t}){const r=zd();return()=>E(Da,{name:"icon-switch-transition",appear:r.value},t)}}),xT=Ve({name:"FadeInExpandTransition",props:{appear:Boolean,group:Boolean,mode:String,onLeave:Function,onAfterLeave:Function,onAfterEnter:Function,width:Boolean,reverse:Boolean},setup(e,{slots:t}){function r(s){e.width?s.style.maxWidth=`${s.offsetWidth}px`:s.style.maxHeight=`${s.offsetHeight}px`,s.offsetWidth}function i(s){e.width?s.style.maxWidth="0":s.style.maxHeight="0",s.offsetWidth;const{onLeave:l}=e;l&&l()}function n(s){e.width?s.style.maxWidth="":s.style.maxHeight="";const{onAfterLeave:l}=e;l&&l()}function a(s){if(s.style.transition="none",e.width){const l=s.offsetWidth;s.style.maxWidth="0",s.offsetWidth,s.style.transition="",s.style.maxWidth=`${l}px`}else if(e.reverse)s.style.maxHeight=`${s.offsetHeight}px`,s.offsetHeight,s.style.transition="",s.style.maxHeight="0";else{const l=s.offsetHeight;s.style.maxHeight="0",s.offsetWidth,s.style.transition="",s.style.maxHeight=`${l}px`}s.offsetWidth}function o(s){var l;e.width?s.style.maxWidth="":e.reverse||(s.style.maxHeight=""),(l=e.onAfterEnter)===null||l===void 0||l.call(e)}return()=>{const{group:s,width:l,appear:c,mode:d}=e,u=s?b5:Da,h={name:l?"fade-in-width-expand-transition":"fade-in-height-expand-transition",appear:c,onEnter:a,onAfterEnter:o,onBeforeLeave:r,onLeave:i,onAfterLeave:n};return s||(h.mode=d),E(u,h,t)}}}),Hee=oe("base-icon",`
 height: 1em;
 width: 1em;
 line-height: 1em;
 text-align: center;
 display: inline-block;
 position: relative;
 fill: currentColor;
 transform: translateZ(0);
`,[ve("svg",`
 height: 1em;
 width: 1em;
 `)]),Li=Ve({name:"BaseIcon",props:{role:String,ariaLabel:String,ariaDisabled:{type:Boolean,default:void 0},ariaHidden:{type:Boolean,default:void 0},clsPrefix:{type:String,required:!0},onClick:Function,onMousedown:Function,onMouseup:Function},setup(e){gh("-base-icon",Hee,pt(e,"clsPrefix"))},render(){return E("i",{class:`${this.clsPrefix}-base-icon`,onClick:this.onClick,onMousedown:this.onMousedown,onMouseup:this.onMouseup,role:this.role,"aria-label":this.ariaLabel,"aria-hidden":this.ariaHidden,"aria-disabled":this.ariaDisabled},this.$slots)}}),Wee=oe("base-close",`
 display: flex;
 align-items: center;
 justify-content: center;
 cursor: pointer;
 background-color: transparent;
 color: var(--n-close-icon-color);
 border-radius: var(--n-close-border-radius);
 height: var(--n-close-size);
 width: var(--n-close-size);
 font-size: var(--n-close-icon-size);
 outline: none;
 border: none;
 position: relative;
 padding: 0;
`,[xe("absolute",`
 height: var(--n-close-icon-size);
 width: var(--n-close-icon-size);
 `),ve("&::before",`
 content: "";
 position: absolute;
 width: var(--n-close-size);
 height: var(--n-close-size);
 left: 50%;
 top: 50%;
 transform: translateY(-50%) translateX(-50%);
 transition: inherit;
 border-radius: inherit;
 `),yr("disabled",[ve("&:hover",`
 color: var(--n-close-icon-color-hover);
 `),ve("&:hover::before",`
 background-color: var(--n-close-color-hover);
 `),ve("&:focus::before",`
 background-color: var(--n-close-color-hover);
 `),ve("&:active",`
 color: var(--n-close-icon-color-pressed);
 `),ve("&:active::before",`
 background-color: var(--n-close-color-pressed);
 `)]),xe("disabled",`
 cursor: not-allowed;
 color: var(--n-close-icon-color-disabled);
 background-color: transparent;
 `),xe("round",[ve("&::before",`
 border-radius: 50%;
 `)])]),O1=Ve({name:"BaseClose",props:{isButtonTag:{type:Boolean,default:!0},clsPrefix:{type:String,required:!0},disabled:{type:Boolean,default:void 0},focusable:{type:Boolean,default:!0},round:Boolean,onClick:Function,absolute:Boolean},setup(e){return gh("-base-close",Wee,pt(e,"clsPrefix")),()=>{const{clsPrefix:t,disabled:r,absolute:i,round:n,isButtonTag:a}=e;return E(a?"button":"div",{type:a?"button":void 0,tabindex:r||!e.focusable?-1:0,"aria-disabled":r,"aria-label":"close",role:a?void 0:"button",disabled:r,class:[`${t}-base-close`,i&&`${t}-base-close--absolute`,r&&`${t}-base-close--disabled`,n&&`${t}-base-close--round`],onMousedown:s=>{e.focusable||s.preventDefault()},onClick:e.onClick},E(Li,{clsPrefix:t},{default:()=>E(Eee,null)}))}}}),Bd=Ve({props:{onFocus:Function,onBlur:Function},setup(e){return()=>E("div",{style:"width: 0; height: 0",tabindex:0,onFocus:e.onFocus,onBlur:e.onBlur})}}),{cubicBezierEaseInOut:Gee}=Ld;function Sd({originalTransform:e="",left:t=0,top:r=0,transition:i=`all .3s ${Gee} !important`}={}){return[ve("&.icon-switch-transition-enter-from, &.icon-switch-transition-leave-to",{transform:e+" scale(0.75)",left:t,top:r,opacity:0}),ve("&.icon-switch-transition-enter-to, &.icon-switch-transition-leave-from",{transform:`scale(1) ${e}`,left:t,top:r,opacity:1}),ve("&.icon-switch-transition-enter-active, &.icon-switch-transition-leave-active",{transformOrigin:"center",position:"absolute",left:t,top:r,transition:i})]}const $ee=ve([ve("@keyframes rotator",`
 0% {
 -webkit-transform: rotate(0deg);
 transform: rotate(0deg);
 }
 100% {
 -webkit-transform: rotate(360deg);
 transform: rotate(360deg);
 }`),oe("base-loading",`
 position: relative;
 line-height: 0;
 width: 1em;
 height: 1em;
 `,[he("transition-wrapper",`
 position: absolute;
 width: 100%;
 height: 100%;
 `,[Sd()]),he("placeholder",`
 position: absolute;
 left: 50%;
 top: 50%;
 transform: translateX(-50%) translateY(-50%);
 `,[Sd({left:"50%",top:"50%",originalTransform:"translateX(-50%) translateY(-50%)"})]),he("container",`
 animation: rotator 3s linear infinite both;
 `,[he("icon",`
 height: 1em;
 width: 1em;
 `)])])]),Yw="1.6s",qee={strokeWidth:{type:Number,default:28},stroke:{type:String,default:void 0}},Ig=Ve({name:"BaseLoading",props:Object.assign({clsPrefix:{type:String,required:!0},show:{type:Boolean,default:!0},scale:{type:Number,default:1},radius:{type:Number,default:100}},qee),setup(e){gh("-base-loading",$ee,pt(e,"clsPrefix"))},render(){const{clsPrefix:e,radius:t,strokeWidth:r,stroke:i,scale:n}=this,a=t/n;return E("div",{class:`${e}-base-loading`,role:"img","aria-label":"loading"},E(zp,null,{default:()=>this.show?E("div",{key:"icon",class:`${e}-base-loading__transition-wrapper`},E("div",{class:`${e}-base-loading__container`},E("svg",{class:`${e}-base-loading__icon`,viewBox:`0 0 ${2*a} ${2*a}`,xmlns:"http://www.w3.org/2000/svg",style:{color:i}},E("g",null,E("animateTransform",{attributeName:"transform",type:"rotate",values:`0 ${a} ${a};270 ${a} ${a}`,begin:"0s",dur:Yw,fill:"freeze",repeatCount:"indefinite"}),E("circle",{class:`${e}-base-loading__icon`,fill:"none",stroke:"currentColor","stroke-width":r,"stroke-linecap":"round",cx:a,cy:a,r:t-r/2,"stroke-dasharray":5.67*t,"stroke-dashoffset":18.48*t},E("animateTransform",{attributeName:"transform",type:"rotate",values:`0 ${a} ${a};135 ${a} ${a};450 ${a} ${a}`,begin:"0s",dur:Yw,fill:"freeze",repeatCount:"indefinite"}),E("animate",{attributeName:"stroke-dashoffset",values:`${5.67*t};${1.42*t};${5.67*t}`,begin:"0s",dur:Yw,fill:"freeze",repeatCount:"indefinite"})))))):E("div",{key:"placeholder",class:`${e}-base-loading__placeholder`},this.$slots)}))}});function _O(e){return Array.isArray(e)?e:[e]}const f2={STOP:"STOP"};function HN(e,t){const r=t(e);e.children!==void 0&&r!==f2.STOP&&e.children.forEach(i=>HN(i,t))}function Yee(e,t={}){const{preserveGroup:r=!1}=t,i=[],n=r?o=>{o.isLeaf||(i.push(o.key),a(o.children))}:o=>{o.isLeaf||(o.isGroup||i.push(o.key),a(o.children))};function a(o){o.forEach(n)}return a(e),i}function Xee(e,t){const{isLeaf:r}=e;return r!==void 0?r:!t(e)}function Kee(e){return e.children}function Qee(e){return e.key}function Zee(){return!1}function Jee(e,t){const{isLeaf:r}=e;return!(r===!1&&!Array.isArray(t(e)))}function ete(e){return e.disabled===!0}function tte(e,t){return e.isLeaf===!1&&!Array.isArray(t(e))}function Xw(e){var t;return e==null?[]:Array.isArray(e)?e:(t=e.checkedKeys)!==null&&t!==void 0?t:[]}function Kw(e){var t;return e==null||Array.isArray(e)?[]:(t=e.indeterminateKeys)!==null&&t!==void 0?t:[]}function rte(e,t){const r=new Set(e);return t.forEach(i=>{r.has(i)||r.add(i)}),Array.from(r)}function ite(e,t){const r=new Set(e);return t.forEach(i=>{r.has(i)&&r.delete(i)}),Array.from(r)}function nte(e){return(e==null?void 0:e.type)==="group"}function ate(e){const t=new Map;return e.forEach((r,i)=>{t.set(r.key,i)}),r=>{var i;return(i=t.get(r))!==null&&i!==void 0?i:null}}class ote extends Error{constructor(){super(),this.message="SubtreeNotLoadedError: checking a subtree whose required nodes are not fully loaded."}}function ste(e,t,r,i){return Jb(t.concat(e),r,i,!1)}function lte(e,t){const r=new Set;return e.forEach(i=>{const n=t.treeNodeMap.get(i);if(n!==void 0){let a=n.parent;for(;a!==null&&!(a.disabled||r.has(a.key));)r.add(a.key),a=a.parent}}),r}function cte(e,t,r,i){const n=Jb(t,r,i,!1),a=Jb(e,r,i,!0),o=lte(e,r),s=[];return n.forEach(l=>{(a.has(l)||o.has(l))&&s.push(l)}),s.forEach(l=>n.delete(l)),n}function Qw(e,t){const{checkedKeys:r,keysToCheck:i,keysToUncheck:n,indeterminateKeys:a,cascade:o,leafOnly:s,checkStrategy:l,allowNotLoaded:c}=e;if(!o)return i!==void 0?{checkedKeys:rte(r,i),indeterminateKeys:Array.from(a)}:n!==void 0?{checkedKeys:ite(r,n),indeterminateKeys:Array.from(a)}:{checkedKeys:Array.from(r),indeterminateKeys:Array.from(a)};const{levelTreeNodeMap:d}=t;let u;n!==void 0?u=cte(n,r,t,c):i!==void 0?u=ste(i,r,t,c):u=Jb(r,t,c,!1);const h=l==="parent",f=l==="child"||s,p=u,v=new Set,m=Math.max.apply(null,Array.from(d.keys()));for(let g=m;g>=0;g-=1){const y=g===0,b=d.get(g);for(const x of b){if(x.isLeaf)continue;const{key:S,shallowLoaded:w}=x;if(f&&w&&x.children.forEach(M=>{!M.disabled&&!M.isLeaf&&M.shallowLoaded&&p.has(M.key)&&p.delete(M.key)}),x.disabled||!w)continue;let _=!0,C=!1,A=!0;for(const M of x.children){const P=M.key;if(!M.disabled){if(A&&(A=!1),p.has(P))C=!0;else if(v.has(P)){C=!0,_=!1;break}else if(_=!1,C)break}}_&&!A?(h&&x.children.forEach(M=>{!M.disabled&&p.has(M.key)&&p.delete(M.key)}),p.add(S)):C&&v.add(S),y&&f&&p.has(S)&&p.delete(S)}}return{checkedKeys:Array.from(p),indeterminateKeys:Array.from(v)}}function Jb(e,t,r,i){const{treeNodeMap:n,getChildren:a}=t,o=new Set,s=new Set(e);return e.forEach(l=>{const c=n.get(l);c!==void 0&&HN(c,d=>{if(d.disabled)return f2.STOP;const{key:u}=d;if(!o.has(u)&&(o.add(u),s.add(u),tte(d.rawNode,a))){if(i)return f2.STOP;if(!r)throw new ote}})}),s}function dte(e,{includeGroup:t=!1,includeSelf:r=!0},i){var n;const a=i.treeNodeMap;let o=e==null?null:(n=a.get(e))!==null&&n!==void 0?n:null;const s={keyPath:[],treeNodePath:[],treeNode:o};if(o!=null&&o.ignored)return s.treeNode=null,s;for(;o;)!o.ignored&&(t||!o.isGroup)&&s.treeNodePath.push(o),o=o.parent;return s.treeNodePath.reverse(),r||s.treeNodePath.pop(),s.keyPath=s.treeNodePath.map(l=>l.key),s}function ute(e){if(e.length===0)return null;const t=e[0];return t.isGroup||t.ignored||t.disabled?t.getNext():t}function hte(e,t){const r=e.siblings,i=r.length,{index:n}=e;return t?r[(n+1)%i]:n===r.length-1?null:r[n+1]}function AO(e,t,{loop:r=!1,includeDisabled:i=!1}={}){const n=t==="prev"?fte:hte,a={reverse:t==="prev"};let o=!1,s=null;function l(c){if(c!==null){if(c===e){if(!o)o=!0;else if(!e.disabled&&!e.isGroup){s=e;return}}else if((!c.disabled||i)&&!c.ignored&&!c.isGroup){s=c;return}if(c.isGroup){const d=wT(c,a);d!==null?s=d:l(n(c,r))}else{const d=n(c,!1);if(d!==null)l(d);else{const u=pte(c);u!=null&&u.isGroup?l(n(u,r)):r&&l(n(c,!0))}}}}return l(e),s}function fte(e,t){const r=e.siblings,i=r.length,{index:n}=e;return t?r[(n-1+i)%i]:n===0?null:r[n-1]}function pte(e){return e.parent}function wT(e,t={}){const{reverse:r=!1}=t,{children:i}=e;if(i){const{length:n}=i,a=r?n-1:0,o=r?-1:n,s=r?-1:1;for(let l=a;l!==o;l+=s){const c=i[l];if(!c.disabled&&!c.ignored)if(c.isGroup){const d=wT(c,t);if(d!==null)return d}else return c}}return null}const mte={getChild(){return this.ignored?null:wT(this)},getParent(){const{parent:e}=this;return e!=null&&e.isGroup?e.getParent():e},getNext(e={}){return AO(this,"next",e)},getPrev(e={}){return AO(this,"prev",e)}};function vte(e,t){const r=t?new Set(t):void 0,i=[];function n(a){a.forEach(o=>{i.push(o),!(o.isLeaf||!o.children||o.ignored)&&(o.isGroup||r===void 0||r.has(o.key))&&n(o.children)})}return n(e),i}function gte(e,t){const r=e.key;for(;t;){if(t.key===r)return!0;t=t.parent}return!1}function WN(e,t,r,i,n,a=null,o=0){const s=[];return e.forEach((l,c)=>{var d;const u=Object.create(i);if(u.rawNode=l,u.siblings=s,u.level=o,u.index=c,u.isFirstChild=c===0,u.isLastChild=c+1===e.length,u.parent=a,!u.ignored){const h=n(l);Array.isArray(h)&&(u.children=WN(h,t,r,i,n,u,o+1))}s.push(u),t.set(u.key,u),r.has(o)||r.set(o,[]),(d=r.get(o))===null||d===void 0||d.push(u)}),s}function Uf(e,t={}){var r;const i=new Map,n=new Map,{getDisabled:a=ete,getIgnored:o=Zee,getIsGroup:s=nte,getKey:l=Qee}=t,c=(r=t.getChildren)!==null&&r!==void 0?r:Kee,d=t.ignoreEmptyChildren?x=>{const S=c(x);return Array.isArray(S)?S.length?S:null:S}:c,u=Object.assign({get key(){return l(this.rawNode)},get disabled(){return a(this.rawNode)},get isGroup(){return s(this.rawNode)},get isLeaf(){return Xee(this.rawNode,d)},get shallowLoaded(){return Jee(this.rawNode,d)},get ignored(){return o(this.rawNode)},contains(x){return gte(this,x)}},mte),h=WN(e,i,n,u,d);function f(x){if(x==null)return null;const S=i.get(x);return S&&!S.isGroup&&!S.ignored?S:null}function p(x){if(x==null)return null;const S=i.get(x);return S&&!S.ignored?S:null}function v(x,S){const w=p(x);return w?w.getPrev(S):null}function m(x,S){const w=p(x);return w?w.getNext(S):null}function g(x){const S=p(x);return S?S.getParent():null}function y(x){const S=p(x);return S?S.getChild():null}const b={treeNodes:h,treeNodeMap:i,levelTreeNodeMap:n,maxLevel:Math.max(...n.keys()),getChildren:d,getFlattenedNodes(x){return vte(h,x)},getNode:f,getPrev:v,getNext:m,getParent:g,getChild:y,getFirstAvailableNode(){return ute(h)},getPath(x,S={}){return dte(x,S,b)},getCheckedKeys(x,S={}){const{cascade:w=!0,leafOnly:_=!1,checkStrategy:C="all",allowNotLoaded:A=!1}=S;return Qw({checkedKeys:Xw(x),indeterminateKeys:Kw(x),cascade:w,leafOnly:_,checkStrategy:C,allowNotLoaded:A},b)},check(x,S,w={}){const{cascade:_=!0,leafOnly:C=!1,checkStrategy:A="all",allowNotLoaded:M=!1}=w;return Qw({checkedKeys:Xw(S),indeterminateKeys:Kw(S),keysToCheck:x==null?[]:_O(x),cascade:_,leafOnly:C,checkStrategy:A,allowNotLoaded:M},b)},uncheck(x,S,w={}){const{cascade:_=!0,leafOnly:C=!1,checkStrategy:A="all",allowNotLoaded:M=!1}=w;return Qw({checkedKeys:Xw(S),indeterminateKeys:Kw(S),keysToUncheck:x==null?[]:_O(x),cascade:_,leafOnly:C,checkStrategy:A,allowNotLoaded:M},b)},getNonLeafKeys(x={}){return Yee(h,x)}};return b}const Vt={neutralBase:"#FFF",neutralInvertBase:"#000",neutralTextBase:"#000",neutralPopover:"#fff",neutralCard:"#fff",neutralModal:"#fff",neutralBody:"#fff",alpha1:"0.82",alpha2:"0.72",alpha3:"0.38",alpha4:"0.24",alpha5:"0.18",alphaClose:"0.6",alphaDisabled:"0.5",alphaDisabledInput:"0.02",alphaPending:"0.05",alphaTablePending:"0.02",alphaPressed:"0.07",alphaAvatar:"0.2",alphaRail:"0.14",alphaProgressRail:".08",alphaBorder:"0.12",alphaDivider:"0.06",alphaInput:"0",alphaAction:"0.02",alphaTab:"0.04",alphaScrollbar:"0.25",alphaScrollbarHover:"0.4",alphaCode:"0.05",alphaTag:"0.02",primaryHover:"#36ad6a",primaryDefault:"#18a058",primaryActive:"#0c7a43",primarySuppl:"#36ad6a",infoHover:"#4098fc",infoDefault:"#2080f0",infoActive:"#1060c9",infoSuppl:"#4098fc",errorHover:"#de576d",errorDefault:"#d03050",errorActive:"#ab1f3f",errorSuppl:"#de576d",warningHover:"#fcb040",warningDefault:"#f0a020",warningActive:"#c97c10",warningSuppl:"#fcb040",successHover:"#36ad6a",successDefault:"#18a058",successActive:"#0c7a43",successSuppl:"#36ad6a"},yte=$u(Vt.neutralBase),GN=$u(Vt.neutralInvertBase),bte="rgba("+GN.slice(0,3).join(", ")+", ";function MO(e){return bte+String(e)+")"}function oa(e){const t=Array.from(GN);return t[3]=Number(e),Xs(yte,t)}const Gr=Object.assign(Object.assign({name:"common"},Ld),{baseColor:Vt.neutralBase,primaryColor:Vt.primaryDefault,primaryColorHover:Vt.primaryHover,primaryColorPressed:Vt.primaryActive,primaryColorSuppl:Vt.primarySuppl,infoColor:Vt.infoDefault,infoColorHover:Vt.infoHover,infoColorPressed:Vt.infoActive,infoColorSuppl:Vt.infoSuppl,successColor:Vt.successDefault,successColorHover:Vt.successHover,successColorPressed:Vt.successActive,successColorSuppl:Vt.successSuppl,warningColor:Vt.warningDefault,warningColorHover:Vt.warningHover,warningColorPressed:Vt.warningActive,warningColorSuppl:Vt.warningSuppl,errorColor:Vt.errorDefault,errorColorHover:Vt.errorHover,errorColorPressed:Vt.errorActive,errorColorSuppl:Vt.errorSuppl,textColorBase:Vt.neutralTextBase,textColor1:"rgb(31, 34, 37)",textColor2:"rgb(51, 54, 57)",textColor3:"rgb(118, 124, 130)",textColorDisabled:oa(Vt.alpha4),placeholderColor:oa(Vt.alpha4),placeholderColorDisabled:oa(Vt.alpha5),iconColor:oa(Vt.alpha4),iconColorHover:p0(oa(Vt.alpha4),{lightness:.75}),iconColorPressed:p0(oa(Vt.alpha4),{lightness:.9}),iconColorDisabled:oa(Vt.alpha5),opacity1:Vt.alpha1,opacity2:Vt.alpha2,opacity3:Vt.alpha3,opacity4:Vt.alpha4,opacity5:Vt.alpha5,dividerColor:"rgb(239, 239, 245)",borderColor:"rgb(224, 224, 230)",closeIconColor:oa(Number(Vt.alphaClose)),closeIconColorHover:oa(Number(Vt.alphaClose)),closeIconColorPressed:oa(Number(Vt.alphaClose)),closeColorHover:"rgba(0, 0, 0, .09)",closeColorPressed:"rgba(0, 0, 0, .13)",clearColor:oa(Vt.alpha4),clearColorHover:p0(oa(Vt.alpha4),{lightness:.75}),clearColorPressed:p0(oa(Vt.alpha4),{lightness:.9}),scrollbarColor:MO(Vt.alphaScrollbar),scrollbarColorHover:MO(Vt.alphaScrollbarHover),scrollbarWidth:"5px",scrollbarHeight:"5px",scrollbarBorderRadius:"5px",progressRailColor:oa(Vt.alphaProgressRail),railColor:"rgb(219, 219, 223)",popoverColor:Vt.neutralPopover,tableColor:Vt.neutralCard,cardColor:Vt.neutralCard,modalColor:Vt.neutralModal,bodyColor:Vt.neutralBody,tagColor:"#eee",avatarColor:oa(Vt.alphaAvatar),invertedColor:"rgb(0, 20, 40)",inputColor:oa(Vt.alphaInput),codeColor:"rgb(244, 244, 248)",tabColor:"rgb(247, 247, 250)",actionColor:"rgb(250, 250, 252)",tableHeaderColor:"rgb(250, 250, 252)",hoverColor:"rgb(243, 243, 245)",tableColorHover:"rgba(0, 0, 100, 0.03)",tableColorStriped:"rgba(0, 0, 100, 0.02)",pressedColor:"rgb(237, 237, 239)",opacityDisabled:Vt.alphaDisabled,inputColorDisabled:"rgb(250, 250, 252)",buttonColor2:"rgba(46, 51, 56, .05)",buttonColor2Hover:"rgba(46, 51, 56, .09)",buttonColor2Pressed:"rgba(46, 51, 56, .13)",boxShadow1:"0 1px 2px -2px rgba(0, 0, 0, .08), 0 3px 6px 0 rgba(0, 0, 0, .06), 0 5px 12px 4px rgba(0, 0, 0, .04)",boxShadow2:"0 3px 6px -4px rgba(0, 0, 0, .12), 0 6px 16px 0 rgba(0, 0, 0, .08), 0 9px 28px 8px rgba(0, 0, 0, .05)",boxShadow3:"0 6px 16px -9px rgba(0, 0, 0, .08), 0 9px 28px 0 rgba(0, 0, 0, .05), 0 12px 48px 16px rgba(0, 0, 0, .03)"}),xte={iconSizeSmall:"34px",iconSizeMedium:"40px",iconSizeLarge:"46px",iconSizeHuge:"52px"},wte=e=>{const{textColorDisabled:t,iconColor:r,textColor2:i,fontSizeSmall:n,fontSizeMedium:a,fontSizeLarge:o,fontSizeHuge:s}=e;return Object.assign(Object.assign({},xte),{fontSizeSmall:n,fontSizeMedium:a,fontSizeLarge:o,fontSizeHuge:s,textColor:t,iconColor:r,extraTextColor:i})},ST={name:"Empty",common:Gr,self:wte},Ste=oe("empty",`
 display: flex;
 flex-direction: column;
 align-items: center;
 font-size: var(--n-font-size);
`,[he("icon",`
 width: var(--n-icon-size);
 height: var(--n-icon-size);
 font-size: var(--n-icon-size);
 line-height: var(--n-icon-size);
 color: var(--n-icon-color);
 transition:
 color .3s var(--n-bezier);
 `,[ve("+",[he("description",`
 margin-top: 8px;
 `)])]),he("description",`
 transition: color .3s var(--n-bezier);
 color: var(--n-text-color);
 `),he("extra",`
 text-align: center;
 transition: color .3s var(--n-bezier);
 margin-top: 12px;
 color: var(--n-extra-text-color);
 `)]),Cte=Object.assign(Object.assign({},bt.props),{description:String,showDescription:{type:Boolean,default:!0},showIcon:{type:Boolean,default:!0},size:{type:String,default:"medium"},renderIcon:Function}),$N=Ve({name:"Empty",props:Cte,setup(e){const{mergedClsPrefixRef:t,inlineThemeDisabled:r}=mr(e),i=bt("Empty","-empty",Ste,ST,e,t),{localeRef:n}=dc("Empty"),a=_t(mh,null),o=re(()=>{var d,u,h;return(d=e.description)!==null&&d!==void 0?d:(h=(u=a==null?void 0:a.mergedComponentPropsRef.value)===null||u===void 0?void 0:u.Empty)===null||h===void 0?void 0:h.description}),s=re(()=>{var d,u;return((u=(d=a==null?void 0:a.mergedComponentPropsRef.value)===null||d===void 0?void 0:d.Empty)===null||u===void 0?void 0:u.renderIcon)||(()=>E(Dee,null))}),l=re(()=>{const{size:d}=e,{common:{cubicBezierEaseInOut:u},self:{[Ze("iconSize",d)]:h,[Ze("fontSize",d)]:f,textColor:p,iconColor:v,extraTextColor:m}}=i.value;return{"--n-icon-size":h,"--n-font-size":f,"--n-bezier":u,"--n-text-color":p,"--n-icon-color":v,"--n-extra-text-color":m}}),c=r?Dr("empty",re(()=>{let d="";const{size:u}=e;return d+=u[0],d}),l,e):void 0;return{mergedClsPrefix:t,mergedRenderIcon:s,localizedDescription:re(()=>o.value||n.value.description),cssVars:r?void 0:l,themeClass:c==null?void 0:c.themeClass,onRender:c==null?void 0:c.onRender}},render(){const{$slots:e,mergedClsPrefix:t,onRender:r}=this;return r==null||r(),E("div",{class:[`${t}-empty`,this.themeClass],style:this.cssVars},this.showIcon?E("div",{class:`${t}-empty__icon`},e.icon?e.icon():E(Li,{clsPrefix:t},{default:this.mergedRenderIcon})):null,this.showDescription?E("div",{class:`${t}-empty__description`},e.default?e.default():this.localizedDescription):null,e.extra?E("div",{class:`${t}-empty__extra`},e.extra()):null)}}),_te={railInsetHorizontal:"auto 2px 4px 2px",railInsetVertical:"2px 4px 2px auto",railColor:"transparent"},Ate=e=>{const{scrollbarColor:t,scrollbarColorHover:r,scrollbarHeight:i,scrollbarWidth:n,scrollbarBorderRadius:a}=e;return Object.assign(Object.assign({},_te),{height:i,width:n,borderRadius:a,color:t,colorHover:r})},kp={name:"Scrollbar",common:Gr,self:Ate},{cubicBezierEaseInOut:EO}=Ld;function Mte({name:e="fade-in",enterDuration:t="0.2s",leaveDuration:r="0.2s",enterCubicBezier:i=EO,leaveCubicBezier:n=EO}={}){return[ve(`&.${e}-transition-enter-active`,{transition:`all ${t} ${i}!important`}),ve(`&.${e}-transition-leave-active`,{transition:`all ${r} ${n}!important`}),ve(`&.${e}-transition-enter-from, &.${e}-transition-leave-to`,{opacity:0}),ve(`&.${e}-transition-leave-from, &.${e}-transition-enter-to`,{opacity:1})]}const Ete=oe("scrollbar",`
 overflow: hidden;
 position: relative;
 z-index: auto;
 height: 100%;
 width: 100%;
`,[ve(">",[oe("scrollbar-container",`
 width: 100%;
 overflow: scroll;
 height: 100%;
 min-height: inherit;
 max-height: inherit;
 scrollbar-width: none;
 `,[ve("&::-webkit-scrollbar, &::-webkit-scrollbar-track-piece, &::-webkit-scrollbar-thumb",`
 width: 0;
 height: 0;
 display: none;
 `),ve(">",[oe("scrollbar-content",`
 box-sizing: border-box;
 min-width: 100%;
 `)])])]),ve(">, +",[oe("scrollbar-rail",`
 position: absolute;
 pointer-events: none;
 user-select: none;
 background: var(--n-scrollbar-rail-color);
 -webkit-user-select: none;
 `,[xe("horizontal",`
 inset: var(--n-scrollbar-rail-inset-horizontal);
 height: var(--n-scrollbar-height);
 `,[ve(">",[he("scrollbar",`
 height: var(--n-scrollbar-height);
 border-radius: var(--n-scrollbar-border-radius);
 right: 0;
 `)])]),xe("vertical",`
 inset: var(--n-scrollbar-rail-inset-vertical);
 width: var(--n-scrollbar-width);
 `,[ve(">",[he("scrollbar",`
 width: var(--n-scrollbar-width);
 border-radius: var(--n-scrollbar-border-radius);
 bottom: 0;
 `)])]),xe("disabled",[ve(">",[he("scrollbar","pointer-events: none;")])]),ve(">",[he("scrollbar",`
 z-index: 1;
 position: absolute;
 cursor: pointer;
 pointer-events: all;
 background-color: var(--n-scrollbar-color);
 transition: background-color .2s var(--n-scrollbar-bezier);
 `,[Mte(),ve("&:hover","background-color: var(--n-scrollbar-color-hover);")])])])])]),Tte=Object.assign(Object.assign({},bt.props),{duration:{type:Number,default:0},scrollable:{type:Boolean,default:!0},xScrollable:Boolean,trigger:{type:String,default:"hover"},useUnifiedContainer:Boolean,triggerDisplayManually:Boolean,container:Function,content:Function,containerClass:String,containerStyle:[String,Object],contentClass:[String,Array],contentStyle:[String,Object],horizontalRailStyle:[String,Object],verticalRailStyle:[String,Object],onScroll:Function,onWheel:Function,onResize:Function,internalOnUpdateScrollLeft:Function,internalHoistYRail:Boolean}),bn=Ve({name:"Scrollbar",props:Tte,inheritAttrs:!1,setup(e){const{mergedClsPrefixRef:t,inlineThemeDisabled:r,mergedRtlRef:i}=mr(e),n=Ja("Scrollbar",i,t),a=ge(null),o=ge(null),s=ge(null),l=ge(null),c=ge(null),d=ge(null),u=ge(null),h=ge(null),f=ge(null),p=ge(null),v=ge(null),m=ge(0),g=ge(0),y=ge(!1),b=ge(!1);let x=!1,S=!1,w,_,C=0,A=0,M=0,P=0;const T=z$(),R=bt("Scrollbar","-scrollbar",Ete,kp,e,t),z=re(()=>{const{value:se}=h,{value:Le}=d,{value:Ye}=p;return se===null||Le===null||Ye===null?0:Math.min(se,Ye*se/Le+rn(R.value.self.width)*1.5)}),F=re(()=>`${z.value}px`),H=re(()=>{const{value:se}=f,{value:Le}=u,{value:Ye}=v;return se===null||Le===null||Ye===null?0:Ye*se/Le+rn(R.value.self.height)*1.5}),N=re(()=>`${H.value}px`),U=re(()=>{const{value:se}=h,{value:Le}=m,{value:Ye}=d,{value:pe}=p;if(se===null||Ye===null||pe===null)return 0;{const Te=Ye-se;return Te?Le/Te*(pe-z.value):0}}),ie=re(()=>`${U.value}px`),te=re(()=>{const{value:se}=f,{value:Le}=g,{value:Ye}=u,{value:pe}=v;if(se===null||Ye===null||pe===null)return 0;{const Te=Ye-se;return Te?Le/Te*(pe-H.value):0}}),X=re(()=>`${te.value}px`),W=re(()=>{const{value:se}=h,{value:Le}=d;return se!==null&&Le!==null&&Le>se}),q=re(()=>{const{value:se}=f,{value:Le}=u;return se!==null&&Le!==null&&Le>se}),$=re(()=>{const{trigger:se}=e;return se==="none"||y.value}),le=re(()=>{const{trigger:se}=e;return se==="none"||b.value}),ee=re(()=>{const{container:se}=e;return se?se():o.value}),Q=re(()=>{const{content:se}=e;return se?se():s.value}),ne=eT(()=>{e.container||me({top:m.value,left:g.value})}),V=()=>{ne.isDeactivated||j()},de=se=>{if(ne.isDeactivated)return;const{onResize:Le}=e;Le&&Le(se),j()},me=(se,Le)=>{if(!e.scrollable)return;if(typeof se=="number"){G(se,Le??0,0,!1,"auto");return}const{left:Ye,top:pe,index:Te,elSize:ce,position:Re,behavior:$e,el:at,debounce:qt=!0}=se;(Ye!==void 0||pe!==void 0)&&G(Ye??0,pe??0,0,!1,$e),at!==void 0?G(0,at.offsetTop,at.offsetHeight,qt,$e):Te!==void 0&&ce!==void 0?G(0,Te*ce,ce,qt,$e):Re==="bottom"?G(0,Number.MAX_SAFE_INTEGER,0,!1,$e):Re==="top"&&G(0,0,0,!1,$e)},Ce=(se,Le)=>{if(!e.scrollable)return;const{value:Ye}=ee;Ye&&(typeof se=="object"?Ye.scrollBy(se):Ye.scrollBy(se,Le||0))};function G(se,Le,Ye,pe,Te){const{value:ce}=ee;if(ce){if(pe){const{scrollTop:Re,offsetHeight:$e}=ce;if(Le>Re){Le+Ye<=Re+$e||ce.scrollTo({left:se,top:Le+Ye-$e,behavior:Te});return}}ce.scrollTo({left:se,top:Le,behavior:Te})}}function Z(){Ee(),fe(),j()}function ue(){Se()}function Se(){we(),_e()}function we(){_!==void 0&&window.clearTimeout(_),_=window.setTimeout(()=>{b.value=!1},e.duration)}function _e(){w!==void 0&&window.clearTimeout(w),w=window.setTimeout(()=>{y.value=!1},e.duration)}function Ee(){w!==void 0&&window.clearTimeout(w),y.value=!0}function fe(){_!==void 0&&window.clearTimeout(_),b.value=!0}function B(se){const{onScroll:Le}=e;Le&&Le(se),D()}function D(){const{value:se}=ee;se&&(m.value=se.scrollTop,g.value=se.scrollLeft*(n!=null&&n.value?-1:1))}function I(){const{value:se}=Q;se&&(d.value=se.offsetHeight,u.value=se.offsetWidth);const{value:Le}=ee;Le&&(h.value=Le.offsetHeight,f.value=Le.offsetWidth);const{value:Ye}=c,{value:pe}=l;Ye&&(v.value=Ye.offsetWidth),pe&&(p.value=pe.offsetHeight)}function O(){const{value:se}=ee;se&&(m.value=se.scrollTop,g.value=se.scrollLeft*(n!=null&&n.value?-1:1),h.value=se.offsetHeight,f.value=se.offsetWidth,d.value=se.scrollHeight,u.value=se.scrollWidth);const{value:Le}=c,{value:Ye}=l;Le&&(v.value=Le.offsetWidth),Ye&&(p.value=Ye.offsetHeight)}function j(){e.scrollable&&(e.useUnifiedContainer?O():(I(),D()))}function L(se){var Le;return!(!((Le=a.value)===null||Le===void 0)&&Le.contains(Jl(se)))}function Ae(se){se.preventDefault(),se.stopPropagation(),S=!0,Ni("mousemove",window,We,!0),Ni("mouseup",window,je,!0),A=g.value,M=n!=null&&n.value?window.innerWidth-se.clientX:se.clientX}function We(se){if(!S)return;w!==void 0&&window.clearTimeout(w),_!==void 0&&window.clearTimeout(_);const{value:Le}=f,{value:Ye}=u,{value:pe}=H;if(Le===null||Ye===null)return;const ce=(n!=null&&n.value?window.innerWidth-se.clientX-M:se.clientX-M)*(Ye-Le)/(Le-pe),Re=Ye-Le;let $e=A+ce;$e=Math.min(Re,$e),$e=Math.max($e,0);const{value:at}=ee;if(at){at.scrollLeft=$e*(n!=null&&n.value?-1:1);const{internalOnUpdateScrollLeft:qt}=e;qt&&qt($e)}}function je(se){se.preventDefault(),se.stopPropagation(),wi("mousemove",window,We,!0),wi("mouseup",window,je,!0),S=!1,j(),L(se)&&Se()}function ze(se){se.preventDefault(),se.stopPropagation(),x=!0,Ni("mousemove",window,Je,!0),Ni("mouseup",window,nt,!0),C=m.value,P=se.clientY}function Je(se){if(!x)return;w!==void 0&&window.clearTimeout(w),_!==void 0&&window.clearTimeout(_);const{value:Le}=h,{value:Ye}=d,{value:pe}=z;if(Le===null||Ye===null)return;const ce=(se.clientY-P)*(Ye-Le)/(Le-pe),Re=Ye-Le;let $e=C+ce;$e=Math.min(Re,$e),$e=Math.max($e,0);const{value:at}=ee;at&&(at.scrollTop=$e)}function nt(se){se.preventDefault(),se.stopPropagation(),wi("mousemove",window,Je,!0),wi("mouseup",window,nt,!0),x=!1,j(),L(se)&&Se()}Qa(()=>{const{value:se}=q,{value:Le}=W,{value:Ye}=t,{value:pe}=c,{value:Te}=l;pe&&(se?pe.classList.remove(`${Ye}-scrollbar-rail--disabled`):pe.classList.add(`${Ye}-scrollbar-rail--disabled`)),Te&&(Le?Te.classList.remove(`${Ye}-scrollbar-rail--disabled`):Te.classList.add(`${Ye}-scrollbar-rail--disabled`))}),Or(()=>{e.container||j()}),na(()=>{w!==void 0&&window.clearTimeout(w),_!==void 0&&window.clearTimeout(_),wi("mousemove",window,Je,!0),wi("mouseup",window,nt,!0)});const lt=re(()=>{const{common:{cubicBezierEaseInOut:se},self:{color:Le,colorHover:Ye,height:pe,width:Te,borderRadius:ce,railInsetHorizontal:Re,railInsetVertical:$e,railColor:at}}=R.value;return{"--n-scrollbar-bezier":se,"--n-scrollbar-color":Le,"--n-scrollbar-color-hover":Ye,"--n-scrollbar-border-radius":ce,"--n-scrollbar-width":Te,"--n-scrollbar-height":pe,"--n-scrollbar-rail-inset-horizontal":Re,"--n-scrollbar-rail-inset-vertical":n!=null&&n.value?QG($e):$e,"--n-scrollbar-rail-color":at}}),dt=r?Dr("scrollbar",void 0,lt,e):void 0;return Object.assign(Object.assign({},{scrollTo:me,scrollBy:Ce,sync:j,syncUnifiedContainer:O,handleMouseEnterWrapper:Z,handleMouseLeaveWrapper:ue}),{mergedClsPrefix:t,rtlEnabled:n,containerScrollTop:m,wrapperRef:a,containerRef:o,contentRef:s,yRailRef:l,xRailRef:c,needYBar:W,needXBar:q,yBarSizePx:F,xBarSizePx:N,yBarTopPx:ie,xBarLeftPx:X,isShowXBar:$,isShowYBar:le,isIos:T,handleScroll:B,handleContentResize:V,handleContainerResize:de,handleYScrollMouseDown:ze,handleXScrollMouseDown:Ae,cssVars:r?void 0:lt,themeClass:dt==null?void 0:dt.themeClass,onRender:dt==null?void 0:dt.onRender})},render(){var e;const{$slots:t,mergedClsPrefix:r,triggerDisplayManually:i,rtlEnabled:n,internalHoistYRail:a}=this;if(!this.scrollable)return(e=t.default)===null||e===void 0?void 0:e.call(t);const o=this.trigger==="none",s=(d,u)=>E("div",{ref:"yRailRef",class:[`${r}-scrollbar-rail`,`${r}-scrollbar-rail--vertical`,d],"data-scrollbar-rail":!0,style:[u||"",this.verticalRailStyle],"aria-hidden":!0},E(o?q_:Da,o?null:{name:"fade-in-transition"},{default:()=>this.needYBar&&this.isShowYBar&&!this.isIos?E("div",{class:`${r}-scrollbar-rail__scrollbar`,style:{height:this.yBarSizePx,top:this.yBarTopPx},onMousedown:this.handleYScrollMouseDown}):null})),l=()=>{var d,u;return(d=this.onRender)===null||d===void 0||d.call(this),E("div",Rd(this.$attrs,{role:"none",ref:"wrapperRef",class:[`${r}-scrollbar`,this.themeClass,n&&`${r}-scrollbar--rtl`],style:this.cssVars,onMouseenter:i?void 0:this.handleMouseEnterWrapper,onMouseleave:i?void 0:this.handleMouseLeaveWrapper}),[this.container?(u=t.default)===null||u===void 0?void 0:u.call(t):E("div",{role:"none",ref:"containerRef",class:[`${r}-scrollbar-container`,this.containerClass],style:this.containerStyle,onScroll:this.handleScroll,onWheel:this.onWheel},E(Ks,{onResize:this.handleContentResize},{default:()=>E("div",{ref:"contentRef",role:"none",style:[{width:this.xScrollable?"fit-content":null},this.contentStyle],class:[`${r}-scrollbar-content`,this.contentClass]},t)})),a?null:s(void 0,void 0),this.xScrollable&&E("div",{ref:"xRailRef",class:[`${r}-scrollbar-rail`,`${r}-scrollbar-rail--horizontal`],style:this.horizontalRailStyle,"data-scrollbar-rail":!0,"aria-hidden":!0},E(o?q_:Da,o?null:{name:"fade-in-transition"},{default:()=>this.needXBar&&this.isShowXBar&&!this.isIos?E("div",{class:`${r}-scrollbar-rail__scrollbar`,style:{width:this.xBarSizePx,right:n?this.xBarLeftPx:void 0,left:n?void 0:this.xBarLeftPx},onMousedown:this.handleXScrollMouseDown}):null}))])},c=this.container?l():E(Ks,{onResize:this.handleContainerResize},{default:l});return a?E(pr,null,c,s(this.themeClass,this.cssVars)):c}}),qN=bn,Pte={height:"calc(var(--n-option-height) * 7.6)",paddingSmall:"4px 0",paddingMedium:"4px 0",paddingLarge:"4px 0",paddingHuge:"4px 0",optionPaddingSmall:"0 12px",optionPaddingMedium:"0 12px",optionPaddingLarge:"0 12px",optionPaddingHuge:"0 12px",loadingSize:"18px"},Dte=e=>{const{borderRadius:t,popoverColor:r,textColor3:i,dividerColor:n,textColor2:a,primaryColorPressed:o,textColorDisabled:s,primaryColor:l,opacityDisabled:c,hoverColor:d,fontSizeSmall:u,fontSizeMedium:h,fontSizeLarge:f,fontSizeHuge:p,heightSmall:v,heightMedium:m,heightLarge:g,heightHuge:y}=e;return Object.assign(Object.assign({},Pte),{optionFontSizeSmall:u,optionFontSizeMedium:h,optionFontSizeLarge:f,optionFontSizeHuge:p,optionHeightSmall:v,optionHeightMedium:m,optionHeightLarge:g,optionHeightHuge:y,borderRadius:t,color:r,groupHeaderTextColor:i,actionDividerColor:n,optionTextColor:a,optionTextColorPressed:o,optionTextColorDisabled:s,optionTextColorActive:l,optionOpacityDisabled:c,optionCheckColor:l,optionColorPending:d,optionColorActive:"rgba(0, 0, 0, 0)",optionColorActivePending:d,actionTextColor:a,loadingColor:l})},CT={name:"InternalSelectMenu",common:Gr,peers:{Scrollbar:kp,Empty:ST},self:Dte};function Ote(e,t){return E(Da,{name:"fade-in-scale-up-transition"},{default:()=>e?E(Li,{clsPrefix:t,class:`${t}-base-select-option__check`},{default:()=>E(Mee)}):null})}const TO=Ve({name:"NBaseSelectOption",props:{clsPrefix:{type:String,required:!0},tmNode:{type:Object,required:!0}},setup(e){const{valueRef:t,pendingTmNodeRef:r,multipleRef:i,valueSetRef:n,renderLabelRef:a,renderOptionRef:o,labelFieldRef:s,valueFieldRef:l,showCheckmarkRef:c,nodePropsRef:d,handleOptionClick:u,handleOptionMouseEnter:h}=_t(KE),f=$i(()=>{const{value:g}=r;return g?e.tmNode.key===g.key:!1});function p(g){const{tmNode:y}=e;y.disabled||u(g,y)}function v(g){const{tmNode:y}=e;y.disabled||h(g,y)}function m(g){const{tmNode:y}=e,{value:b}=f;y.disabled||b||h(g,y)}return{multiple:i,isGrouped:$i(()=>{const{tmNode:g}=e,{parent:y}=g;return y&&y.rawNode.type==="group"}),showCheckmark:c,nodeProps:d,isPending:f,isSelected:$i(()=>{const{value:g}=t,{value:y}=i;if(g===null)return!1;const b=e.tmNode.rawNode[l.value];if(y){const{value:x}=n;return x.has(b)}else return g===b}),labelField:s,renderLabel:a,renderOption:o,handleMouseMove:m,handleMouseEnter:v,handleClick:p}},render(){const{clsPrefix:e,tmNode:{rawNode:t},isSelected:r,isPending:i,isGrouped:n,showCheckmark:a,nodeProps:o,renderOption:s,renderLabel:l,handleClick:c,handleMouseEnter:d,handleMouseMove:u}=this,h=Ote(r,e),f=l?[l(t,r),a&&h]:[kn(t[this.labelField],t,r),a&&h],p=o==null?void 0:o(t),v=E("div",Object.assign({},p,{class:[`${e}-base-select-option`,t.class,p==null?void 0:p.class,{[`${e}-base-select-option--disabled`]:t.disabled,[`${e}-base-select-option--selected`]:r,[`${e}-base-select-option--grouped`]:n,[`${e}-base-select-option--pending`]:i,[`${e}-base-select-option--show-checkmark`]:a}],style:[(p==null?void 0:p.style)||"",t.style||""],onClick:Rw([c,p==null?void 0:p.onClick]),onMouseenter:Rw([d,p==null?void 0:p.onMouseenter]),onMousemove:Rw([u,p==null?void 0:p.onMousemove])}),E("div",{class:`${e}-base-select-option__content`},f));return t.render?t.render({node:v,option:t,selected:r}):s?s({node:v,option:t,selected:r}):v}}),PO=Ve({name:"NBaseSelectGroupHeader",props:{clsPrefix:{type:String,required:!0},tmNode:{type:Object,required:!0}},setup(){const{renderLabelRef:e,renderOptionRef:t,labelFieldRef:r,nodePropsRef:i}=_t(KE);return{labelField:r,nodeProps:i,renderLabel:e,renderOption:t}},render(){const{clsPrefix:e,renderLabel:t,renderOption:r,nodeProps:i,tmNode:{rawNode:n}}=this,a=i==null?void 0:i(n),o=t?t(n,!1):kn(n[this.labelField],n,!1),s=E("div",Object.assign({},a,{class:[`${e}-base-select-group-header`,a==null?void 0:a.class]}),o);return n.render?n.render({node:s,option:n}):r?r({node:s,option:n,selected:!1}):s}}),{cubicBezierEaseIn:DO,cubicBezierEaseOut:OO}=Ld;function Lp({transformOrigin:e="inherit",duration:t=".2s",enterScale:r=".9",originalTransform:i="",originalTransition:n=""}={}){return[ve("&.fade-in-scale-up-transition-leave-active",{transformOrigin:e,transition:`opacity ${t} ${DO}, transform ${t} ${DO} ${n&&","+n}`}),ve("&.fade-in-scale-up-transition-enter-active",{transformOrigin:e,transition:`opacity ${t} ${OO}, transform ${t} ${OO} ${n&&","+n}`}),ve("&.fade-in-scale-up-transition-enter-from, &.fade-in-scale-up-transition-leave-to",{opacity:0,transform:`${i} scale(${r})`}),ve("&.fade-in-scale-up-transition-leave-from, &.fade-in-scale-up-transition-enter-to",{opacity:1,transform:`${i} scale(1)`})]}const Rte=oe("base-select-menu",`
 line-height: 1.5;
 outline: none;
 z-index: 0;
 position: relative;
 border-radius: var(--n-border-radius);
 transition:
 background-color .3s var(--n-bezier),
 box-shadow .3s var(--n-bezier);
 background-color: var(--n-color);
`,[oe("scrollbar",`
 max-height: var(--n-height);
 `),oe("virtual-list",`
 max-height: var(--n-height);
 `),oe("base-select-option",`
 min-height: var(--n-option-height);
 font-size: var(--n-option-font-size);
 display: flex;
 align-items: center;
 `,[he("content",`
 z-index: 1;
 white-space: nowrap;
 text-overflow: ellipsis;
 overflow: hidden;
 `)]),oe("base-select-group-header",`
 min-height: var(--n-option-height);
 font-size: .93em;
 display: flex;
 align-items: center;
 `),oe("base-select-menu-option-wrapper",`
 position: relative;
 width: 100%;
 `),he("loading, empty",`
 display: flex;
 padding: 12px 32px;
 flex: 1;
 justify-content: center;
 `),he("loading",`
 color: var(--n-loading-color);
 font-size: var(--n-loading-size);
 `),he("header",`
 padding: 8px var(--n-option-padding-left);
 font-size: var(--n-option-font-size);
 transition: 
 color .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 border-bottom: 1px solid var(--n-action-divider-color);
 color: var(--n-action-text-color);
 `),he("action",`
 padding: 8px var(--n-option-padding-left);
 font-size: var(--n-option-font-size);
 transition: 
 color .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 border-top: 1px solid var(--n-action-divider-color);
 color: var(--n-action-text-color);
 `),oe("base-select-group-header",`
 position: relative;
 cursor: default;
 padding: var(--n-option-padding);
 color: var(--n-group-header-text-color);
 `),oe("base-select-option",`
 cursor: pointer;
 position: relative;
 padding: var(--n-option-padding);
 transition:
 color .3s var(--n-bezier),
 opacity .3s var(--n-bezier);
 box-sizing: border-box;
 color: var(--n-option-text-color);
 opacity: 1;
 `,[xe("show-checkmark",`
 padding-right: calc(var(--n-option-padding-right) + 20px);
 `),ve("&::before",`
 content: "";
 position: absolute;
 left: 4px;
 right: 4px;
 top: 0;
 bottom: 0;
 border-radius: var(--n-border-radius);
 transition: background-color .3s var(--n-bezier);
 `),ve("&:active",`
 color: var(--n-option-text-color-pressed);
 `),xe("grouped",`
 padding-left: calc(var(--n-option-padding-left) * 1.5);
 `),xe("pending",[ve("&::before",`
 background-color: var(--n-option-color-pending);
 `)]),xe("selected",`
 color: var(--n-option-text-color-active);
 `,[ve("&::before",`
 background-color: var(--n-option-color-active);
 `),xe("pending",[ve("&::before",`
 background-color: var(--n-option-color-active-pending);
 `)])]),xe("disabled",`
 cursor: not-allowed;
 `,[yr("selected",`
 color: var(--n-option-text-color-disabled);
 `),xe("selected",`
 opacity: var(--n-option-opacity-disabled);
 `)]),he("check",`
 font-size: 16px;
 position: absolute;
 right: calc(var(--n-option-padding-right) - 4px);
 top: calc(50% - 7px);
 color: var(--n-option-check-color);
 transition: color .3s var(--n-bezier);
 `,[Lp({enterScale:"0.5"})])])]),YN=Ve({name:"InternalSelectMenu",props:Object.assign(Object.assign({},bt.props),{clsPrefix:{type:String,required:!0},scrollable:{type:Boolean,default:!0},treeMate:{type:Object,required:!0},multiple:Boolean,size:{type:String,default:"medium"},value:{type:[String,Number,Array],default:null},autoPending:Boolean,virtualScroll:{type:Boolean,default:!0},show:{type:Boolean,default:!0},labelField:{type:String,default:"label"},valueField:{type:String,default:"value"},loading:Boolean,focusable:Boolean,renderLabel:Function,renderOption:Function,nodeProps:Function,showCheckmark:{type:Boolean,default:!0},onMousedown:Function,onScroll:Function,onFocus:Function,onBlur:Function,onKeyup:Function,onKeydown:Function,onTabOut:Function,onMouseenter:Function,onMouseleave:Function,onResize:Function,resetMenuOnOptionsChange:{type:Boolean,default:!0},inlineThemeDisabled:Boolean,onToggle:Function}),setup(e){const{mergedClsPrefixRef:t,mergedRtlRef:r}=mr(e),i=Ja("InternalSelectMenu",r,t),n=bt("InternalSelectMenu","-internal-select-menu",Rte,CT,e,pt(e,"clsPrefix")),a=ge(null),o=ge(null),s=ge(null),l=re(()=>e.treeMate.getFlattenedNodes()),c=re(()=>ate(l.value)),d=ge(null);function u(){const{treeMate:W}=e;let q=null;const{value:$}=e;$===null?q=W.getFirstAvailableNode():(e.multiple?q=W.getNode(($||[])[($||[]).length-1]):q=W.getNode($),(!q||q.disabled)&&(q=W.getFirstAvailableNode())),z(q||null)}function h(){const{value:W}=d;W&&!e.treeMate.getNode(W.key)&&(d.value=null)}let f;tr(()=>e.show,W=>{W?f=tr(()=>e.treeMate,()=>{e.resetMenuOnOptionsChange?(e.autoPending?u():h(),ra(F)):h()},{immediate:!0}):f==null||f()},{immediate:!0}),na(()=>{f==null||f()});const p=re(()=>rn(n.value.self[Ze("optionHeight",e.size)])),v=re(()=>Eo(n.value.self[Ze("padding",e.size)])),m=re(()=>e.multiple&&Array.isArray(e.value)?new Set(e.value):new Set),g=re(()=>{const W=l.value;return W&&W.length===0});function y(W){const{onToggle:q}=e;q&&q(W)}function b(W){const{onScroll:q}=e;q&&q(W)}function x(W){var q;(q=s.value)===null||q===void 0||q.sync(),b(W)}function S(){var W;(W=s.value)===null||W===void 0||W.sync()}function w(){const{value:W}=d;return W||null}function _(W,q){q.disabled||z(q,!1)}function C(W,q){q.disabled||y(q)}function A(W){var q;yd(W,"action")||(q=e.onKeyup)===null||q===void 0||q.call(e,W)}function M(W){var q;yd(W,"action")||(q=e.onKeydown)===null||q===void 0||q.call(e,W)}function P(W){var q;(q=e.onMousedown)===null||q===void 0||q.call(e,W),!e.focusable&&W.preventDefault()}function T(){const{value:W}=d;W&&z(W.getNext({loop:!0}),!0)}function R(){const{value:W}=d;W&&z(W.getPrev({loop:!0}),!0)}function z(W,q=!1){d.value=W,q&&F()}function F(){var W,q;const $=d.value;if(!$)return;const le=c.value($.key);le!==null&&(e.virtualScroll?(W=o.value)===null||W===void 0||W.scrollTo({index:le}):(q=s.value)===null||q===void 0||q.scrollTo({index:le,elSize:p.value}))}function H(W){var q,$;!((q=a.value)===null||q===void 0)&&q.contains(W.target)&&(($=e.onFocus)===null||$===void 0||$.call(e,W))}function N(W){var q,$;!((q=a.value)===null||q===void 0)&&q.contains(W.relatedTarget)||($=e.onBlur)===null||$===void 0||$.call(e,W)}br(KE,{handleOptionMouseEnter:_,handleOptionClick:C,valueSetRef:m,pendingTmNodeRef:d,nodePropsRef:pt(e,"nodeProps"),showCheckmarkRef:pt(e,"showCheckmark"),multipleRef:pt(e,"multiple"),valueRef:pt(e,"value"),renderLabelRef:pt(e,"renderLabel"),renderOptionRef:pt(e,"renderOption"),labelFieldRef:pt(e,"labelField"),valueFieldRef:pt(e,"valueField")}),br(k5,a),Or(()=>{const{value:W}=s;W&&W.sync()});const U=re(()=>{const{size:W}=e,{common:{cubicBezierEaseInOut:q},self:{height:$,borderRadius:le,color:ee,groupHeaderTextColor:Q,actionDividerColor:ne,optionTextColorPressed:V,optionTextColor:de,optionTextColorDisabled:me,optionTextColorActive:Ce,optionOpacityDisabled:G,optionCheckColor:Z,actionTextColor:ue,optionColorPending:Se,optionColorActive:we,loadingColor:_e,loadingSize:Ee,optionColorActivePending:fe,[Ze("optionFontSize",W)]:B,[Ze("optionHeight",W)]:D,[Ze("optionPadding",W)]:I}}=n.value;return{"--n-height":$,"--n-action-divider-color":ne,"--n-action-text-color":ue,"--n-bezier":q,"--n-border-radius":le,"--n-color":ee,"--n-option-font-size":B,"--n-group-header-text-color":Q,"--n-option-check-color":Z,"--n-option-color-pending":Se,"--n-option-color-active":we,"--n-option-color-active-pending":fe,"--n-option-height":D,"--n-option-opacity-disabled":G,"--n-option-text-color":de,"--n-option-text-color-active":Ce,"--n-option-text-color-disabled":me,"--n-option-text-color-pressed":V,"--n-option-padding":I,"--n-option-padding-left":Eo(I,"left"),"--n-option-padding-right":Eo(I,"right"),"--n-loading-color":_e,"--n-loading-size":Ee}}),{inlineThemeDisabled:ie}=e,te=ie?Dr("internal-select-menu",re(()=>e.size[0]),U,e):void 0,X={selfRef:a,next:T,prev:R,getPendingTmNode:w};return K5(a,e.onResize),Object.assign({mergedTheme:n,mergedClsPrefix:t,rtlEnabled:i,virtualListRef:o,scrollbarRef:s,itemSize:p,padding:v,flattenedNodes:l,empty:g,virtualListContainer(){const{value:W}=o;return W==null?void 0:W.listElRef},virtualListContent(){const{value:W}=o;return W==null?void 0:W.itemsElRef},doScroll:b,handleFocusin:H,handleFocusout:N,handleKeyUp:A,handleKeyDown:M,handleMouseDown:P,handleVirtualListResize:S,handleVirtualListScroll:x,cssVars:ie?void 0:U,themeClass:te==null?void 0:te.themeClass,onRender:te==null?void 0:te.onRender},X)},render(){const{$slots:e,virtualScroll:t,clsPrefix:r,mergedTheme:i,themeClass:n,onRender:a}=this;return a==null||a(),E("div",{ref:"selfRef",tabindex:this.focusable?0:-1,class:[`${r}-base-select-menu`,this.rtlEnabled&&`${r}-base-select-menu--rtl`,n,this.multiple&&`${r}-base-select-menu--multiple`],style:this.cssVars,onFocusin:this.handleFocusin,onFocusout:this.handleFocusout,onKeyup:this.handleKeyUp,onKeydown:this.handleKeyDown,onMousedown:this.handleMouseDown,onMouseenter:this.onMouseenter,onMouseleave:this.onMouseleave},ei(e.header,o=>o&&E("div",{class:`${r}-base-select-menu__header`,"data-header":!0,key:"header"},o)),this.loading?E("div",{class:`${r}-base-select-menu__loading`},E(Ig,{clsPrefix:r,strokeWidth:20})):this.empty?E("div",{class:`${r}-base-select-menu__empty`,"data-empty":!0},Sr(e.empty,()=>[E($N,{theme:i.peers.Empty,themeOverrides:i.peerOverrides.Empty})])):E(bn,{ref:"scrollbarRef",theme:i.peers.Scrollbar,themeOverrides:i.peerOverrides.Scrollbar,scrollable:this.scrollable,container:t?this.virtualListContainer:void 0,content:t?this.virtualListContent:void 0,onScroll:t?void 0:this.doScroll},{default:()=>t?E(qv,{ref:"virtualListRef",class:`${r}-virtual-list`,items:this.flattenedNodes,itemSize:this.itemSize,showScrollbar:!1,paddingTop:this.padding.top,paddingBottom:this.padding.bottom,onResize:this.handleVirtualListResize,onScroll:this.handleVirtualListScroll,itemResizable:!0},{default:({item:o})=>o.isGroup?E(PO,{key:o.key,clsPrefix:r,tmNode:o}):o.ignored?null:E(TO,{clsPrefix:r,key:o.key,tmNode:o})}):E("div",{class:`${r}-base-select-menu-option-wrapper`,style:{paddingTop:this.padding.top,paddingBottom:this.padding.bottom}},this.flattenedNodes.map(o=>o.isGroup?E(PO,{key:o.key,clsPrefix:r,tmNode:o}):E(TO,{clsPrefix:r,key:o.key,tmNode:o})))}),ei(e.action,o=>o&&[E("div",{class:`${r}-base-select-menu__action`,"data-action":!0,key:"action"},o),E(Bd,{onFocus:this.onTabOut,key:"focus-detector"})]))}}),Ite=oe("base-wave",`
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 border-radius: inherit;
`),zte=Ve({name:"BaseWave",props:{clsPrefix:{type:String,required:!0}},setup(e){gh("-base-wave",Ite,pt(e,"clsPrefix"));const t=ge(null),r=ge(!1);let i=null;return na(()=>{i!==null&&window.clearTimeout(i)}),{active:r,selfRef:t,play(){i!==null&&(window.clearTimeout(i),r.value=!1,i=null),ra(()=>{var n;(n=t.value)===null||n===void 0||n.offsetHeight,r.value=!0,i=window.setTimeout(()=>{r.value=!1,i=null},1e3)})}}},render(){const{clsPrefix:e}=this;return E("div",{ref:"selfRef","aria-hidden":!0,class:[`${e}-base-wave`,this.active&&`${e}-base-wave--active`]})}}),kte={space:"6px",spaceArrow:"10px",arrowOffset:"10px",arrowOffsetVertical:"10px",arrowHeight:"6px",padding:"8px 14px"},Lte=e=>{const{boxShadow2:t,popoverColor:r,textColor2:i,borderRadius:n,fontSize:a,dividerColor:o}=e;return Object.assign(Object.assign({},kte),{fontSize:a,borderRadius:n,color:r,dividerColor:o,textColor:i,boxShadow:t})},R1={name:"Popover",common:Gr,self:Lte},Zw={top:"bottom",bottom:"top",left:"right",right:"left"},dn="var(--n-arrow-height) * 1.414",Bte=ve([oe("popover",`
 transition:
 box-shadow .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
 position: relative;
 font-size: var(--n-font-size);
 color: var(--n-text-color);
 box-shadow: var(--n-box-shadow);
 word-break: break-word;
 `,[ve(">",[oe("scrollbar",`
 height: inherit;
 max-height: inherit;
 `)]),yr("raw",`
 background-color: var(--n-color);
 border-radius: var(--n-border-radius);
 `,[yr("scrollable",[yr("show-header-or-footer","padding: var(--n-padding);")])]),he("header",`
 padding: var(--n-padding);
 border-bottom: 1px solid var(--n-divider-color);
 transition: border-color .3s var(--n-bezier);
 `),he("footer",`
 padding: var(--n-padding);
 border-top: 1px solid var(--n-divider-color);
 transition: border-color .3s var(--n-bezier);
 `),xe("scrollable, show-header-or-footer",[he("content",`
 padding: var(--n-padding);
 `)])]),oe("popover-shared",`
 transform-origin: inherit;
 `,[oe("popover-arrow-wrapper",`
 position: absolute;
 overflow: hidden;
 pointer-events: none;
 `,[oe("popover-arrow",`
 transition: background-color .3s var(--n-bezier);
 position: absolute;
 display: block;
 width: calc(${dn});
 height: calc(${dn});
 box-shadow: 0 0 8px 0 rgba(0, 0, 0, .12);
 transform: rotate(45deg);
 background-color: var(--n-color);
 pointer-events: all;
 `)]),ve("&.popover-transition-enter-from, &.popover-transition-leave-to",`
 opacity: 0;
 transform: scale(.85);
 `),ve("&.popover-transition-enter-to, &.popover-transition-leave-from",`
 transform: scale(1);
 opacity: 1;
 `),ve("&.popover-transition-enter-active",`
 transition:
 box-shadow .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier),
 opacity .15s var(--n-bezier-ease-out),
 transform .15s var(--n-bezier-ease-out);
 `),ve("&.popover-transition-leave-active",`
 transition:
 box-shadow .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier),
 opacity .15s var(--n-bezier-ease-in),
 transform .15s var(--n-bezier-ease-in);
 `)]),fo("top-start",`
 top: calc(${dn} / -2);
 left: calc(${vl("top-start")} - var(--v-offset-left));
 `),fo("top",`
 top: calc(${dn} / -2);
 transform: translateX(calc(${dn} / -2)) rotate(45deg);
 left: 50%;
 `),fo("top-end",`
 top: calc(${dn} / -2);
 right: calc(${vl("top-end")} + var(--v-offset-left));
 `),fo("bottom-start",`
 bottom: calc(${dn} / -2);
 left: calc(${vl("bottom-start")} - var(--v-offset-left));
 `),fo("bottom",`
 bottom: calc(${dn} / -2);
 transform: translateX(calc(${dn} / -2)) rotate(45deg);
 left: 50%;
 `),fo("bottom-end",`
 bottom: calc(${dn} / -2);
 right: calc(${vl("bottom-end")} + var(--v-offset-left));
 `),fo("left-start",`
 left: calc(${dn} / -2);
 top: calc(${vl("left-start")} - var(--v-offset-top));
 `),fo("left",`
 left: calc(${dn} / -2);
 transform: translateY(calc(${dn} / -2)) rotate(45deg);
 top: 50%;
 `),fo("left-end",`
 left: calc(${dn} / -2);
 bottom: calc(${vl("left-end")} + var(--v-offset-top));
 `),fo("right-start",`
 right: calc(${dn} / -2);
 top: calc(${vl("right-start")} - var(--v-offset-top));
 `),fo("right",`
 right: calc(${dn} / -2);
 transform: translateY(calc(${dn} / -2)) rotate(45deg);
 top: 50%;
 `),fo("right-end",`
 right: calc(${dn} / -2);
 bottom: calc(${vl("right-end")} + var(--v-offset-top));
 `),...sZ({top:["right-start","left-start"],right:["top-end","bottom-end"],bottom:["right-end","left-end"],left:["top-start","bottom-start"]},(e,t)=>{const r=["right","left"].includes(t),i=r?"width":"height";return e.map(n=>{const a=n.split("-")[1]==="end",s=`calc((${`var(--v-target-${i}, 0px)`} - ${dn}) / 2)`,l=vl(n);return ve(`[v-placement="${n}"] >`,[oe("popover-shared",[xe("center-arrow",[oe("popover-arrow",`${t}: calc(max(${s}, ${l}) ${a?"+":"-"} var(--v-offset-${r?"left":"top"}));`)])])])})})]);function vl(e){return["top","bottom"].includes(e.split("-")[0])?"var(--n-arrow-offset)":"var(--n-arrow-offset-vertical)"}function fo(e,t){const r=e.split("-")[0],i=["top","bottom"].includes(r)?"height: var(--n-space-arrow);":"width: var(--n-space-arrow);";return ve(`[v-placement="${e}"] >`,[oe("popover-shared",`
 margin-${Zw[r]}: var(--n-space);
 `,[xe("show-arrow",`
 margin-${Zw[r]}: var(--n-space-arrow);
 `),xe("overlap",`
 margin: 0;
 `),b$("popover-arrow-wrapper",`
 right: 0;
 left: 0;
 top: 0;
 bottom: 0;
 ${r}: 100%;
 ${Zw[r]}: auto;
 ${i}
 `,[oe("popover-arrow",t)])])])}const XN=Object.assign(Object.assign({},bt.props),{to:jn.propTo,show:Boolean,trigger:String,showArrow:Boolean,delay:Number,duration:Number,raw:Boolean,arrowPointToCenter:Boolean,arrowClass:String,arrowStyle:[String,Object],arrowWrapperClass:String,arrowWrapperStyle:[String,Object],displayDirective:String,x:Number,y:Number,flip:Boolean,overlap:Boolean,placement:String,width:[Number,String],keepAliveOnHover:Boolean,scrollable:Boolean,contentClass:String,contentStyle:[Object,String],headerClass:String,headerStyle:[Object,String],footerClass:String,footerStyle:[Object,String],internalDeactivateImmediately:Boolean,animated:Boolean,onClickoutside:Function,internalTrapFocus:Boolean,internalOnAfterLeave:Function,minWidth:Number,maxWidth:Number}),KN=({arrowClass:e,arrowStyle:t,arrowWrapperClass:r,arrowWrapperStyle:i,clsPrefix:n})=>E("div",{key:"__popover-arrow__",style:i,class:[`${n}-popover-arrow-wrapper`,r]},E("div",{class:[`${n}-popover-arrow`,e],style:t})),Fte=Ve({name:"PopoverBody",inheritAttrs:!1,props:XN,setup(e,{slots:t,attrs:r}){const{namespaceRef:i,mergedClsPrefixRef:n,inlineThemeDisabled:a}=mr(e),o=bt("Popover","-popover",Bte,R1,e,n),s=ge(null),l=_t("NPopover"),c=ge(null),d=ge(e.show),u=ge(!1);Qa(()=>{const{show:_}=e;_&&!x$()&&!e.internalDeactivateImmediately&&(u.value=!0)});const h=re(()=>{const{trigger:_,onClickoutside:C}=e,A=[],{positionManuallyRef:{value:M}}=l;return M||(_==="click"&&!C&&A.push([bd,x,void 0,{capture:!0}]),_==="hover"&&A.push([F$,b])),C&&A.push([bd,x,void 0,{capture:!0}]),(e.displayDirective==="show"||e.animated&&u.value)&&A.push([Gu,e.show]),A}),f=re(()=>{const _=e.width==="trigger"?void 0:os(e.width),C=[];_&&C.push({width:_});const{maxWidth:A,minWidth:M}=e;return A&&C.push({maxWidth:os(A)}),M&&C.push({maxWidth:os(M)}),a||C.push(p.value),C}),p=re(()=>{const{common:{cubicBezierEaseInOut:_,cubicBezierEaseIn:C,cubicBezierEaseOut:A},self:{space:M,spaceArrow:P,padding:T,fontSize:R,textColor:z,dividerColor:F,color:H,boxShadow:N,borderRadius:U,arrowHeight:ie,arrowOffset:te,arrowOffsetVertical:X}}=o.value;return{"--n-box-shadow":N,"--n-bezier":_,"--n-bezier-ease-in":C,"--n-bezier-ease-out":A,"--n-font-size":R,"--n-text-color":z,"--n-color":H,"--n-divider-color":F,"--n-border-radius":U,"--n-arrow-height":ie,"--n-arrow-offset":te,"--n-arrow-offset-vertical":X,"--n-padding":T,"--n-space":M,"--n-space-arrow":P}}),v=a?Dr("popover",void 0,p,e):void 0;l.setBodyInstance({syncPosition:m}),na(()=>{l.setBodyInstance(null)}),tr(pt(e,"show"),_=>{e.animated||(_?d.value=!0:d.value=!1)});function m(){var _;(_=s.value)===null||_===void 0||_.syncPosition()}function g(_){e.trigger==="hover"&&e.keepAliveOnHover&&e.show&&l.handleMouseEnter(_)}function y(_){e.trigger==="hover"&&e.keepAliveOnHover&&l.handleMouseLeave(_)}function b(_){e.trigger==="hover"&&!S().contains(Jl(_))&&l.handleMouseMoveOutside(_)}function x(_){(e.trigger==="click"&&!S().contains(Jl(_))||e.onClickoutside)&&l.handleClickOutside(_)}function S(){return l.getTriggerElement()}br(A1,c),br(ZE,null),br(QE,null);function w(){if(v==null||v.onRender(),!(e.displayDirective==="show"||e.show||e.animated&&u.value))return null;let C;const A=l.internalRenderBodyRef.value,{value:M}=n;if(A)C=A([`${M}-popover-shared`,v==null?void 0:v.themeClass.value,e.overlap&&`${M}-popover-shared--overlap`,e.showArrow&&`${M}-popover-shared--show-arrow`,e.arrowPointToCenter&&`${M}-popover-shared--center-arrow`],c,f.value,g,y);else{const{value:P}=l.extraClassRef,{internalTrapFocus:T}=e,R=!Bf(t.header)||!Bf(t.footer),z=()=>{var F,H;const N=R?E(pr,null,ei(t.header,te=>te?E("div",{class:[`${M}-popover__header`,e.headerClass],style:e.headerStyle},te):null),ei(t.default,te=>te?E("div",{class:[`${M}-popover__content`,e.contentClass],style:e.contentStyle},t):null),ei(t.footer,te=>te?E("div",{class:[`${M}-popover__footer`,e.footerClass],style:e.footerStyle},te):null)):e.scrollable?(F=t.default)===null||F===void 0?void 0:F.call(t):E("div",{class:[`${M}-popover__content`,e.contentClass],style:e.contentStyle},t),U=e.scrollable?E(qN,{contentClass:R?void 0:`${M}-popover__content ${(H=e.contentClass)!==null&&H!==void 0?H:""}`,contentStyle:R?void 0:e.contentStyle},{default:()=>N}):N,ie=e.showArrow?KN({arrowClass:e.arrowClass,arrowStyle:e.arrowStyle,arrowWrapperClass:e.arrowWrapperClass,arrowWrapperStyle:e.arrowWrapperStyle,clsPrefix:M}):null;return[U,ie]};C=E("div",Rd({class:[`${M}-popover`,`${M}-popover-shared`,v==null?void 0:v.themeClass.value,P.map(F=>`${M}-${F}`),{[`${M}-popover--scrollable`]:e.scrollable,[`${M}-popover--show-header-or-footer`]:R,[`${M}-popover--raw`]:e.raw,[`${M}-popover-shared--overlap`]:e.overlap,[`${M}-popover-shared--show-arrow`]:e.showArrow,[`${M}-popover-shared--center-arrow`]:e.arrowPointToCenter}],ref:c,style:f.value,onKeydown:l.handleKeydown,onMouseenter:g,onMouseleave:y},r),T?E(Tq,{active:e.show,autoFocus:!0},{default:z}):z())}return Ka(C,h.value)}return{displayed:u,namespace:i,isMounted:l.isMountedRef,zIndex:l.zIndexRef,followerRef:s,adjustedTo:jn(e),followerEnabled:d,renderContentNode:w}},render(){return E(uh,{ref:"followerRef",zIndex:this.zIndex,show:this.show,enabled:this.followerEnabled,to:this.adjustedTo,x:this.x,y:this.y,flip:this.flip,placement:this.placement,containerClass:this.namespace,overlap:this.overlap,width:this.width==="trigger"?"target":void 0,teleportDisabled:this.adjustedTo===jn.tdkey},{default:()=>this.animated?E(Da,{name:"popover-transition",appear:this.isMounted,onEnter:()=>{this.followerEnabled=!0},onAfterLeave:()=>{var e;(e=this.internalOnAfterLeave)===null||e===void 0||e.call(this),this.followerEnabled=!1,this.displayed=!1}},{default:this.renderContentNode}):this.renderContentNode()})}}),Nte=Object.keys(XN),Ute={focus:["onFocus","onBlur"],click:["onClick"],hover:["onMouseenter","onMouseleave"],manual:[],nested:["onFocus","onBlur","onMouseenter","onMouseleave","onClick"]};function jte(e,t,r){Ute[t].forEach(i=>{e.props?e.props=Object.assign({},e.props):e.props={};const n=e.props[i],a=r[i];n?e.props[i]=(...o)=>{n(...o),a(...o)}:e.props[i]=a})}const I1={show:{type:Boolean,default:void 0},defaultShow:Boolean,showArrow:{type:Boolean,default:!0},trigger:{type:String,default:"hover"},delay:{type:Number,default:100},duration:{type:Number,default:100},raw:Boolean,placement:{type:String,default:"top"},x:Number,y:Number,arrowPointToCenter:Boolean,disabled:Boolean,getDisabled:Function,displayDirective:{type:String,default:"if"},arrowClass:String,arrowStyle:[String,Object],arrowWrapperClass:String,arrowWrapperStyle:[String,Object],flip:{type:Boolean,default:!0},animated:{type:Boolean,default:!0},width:{type:[Number,String],default:void 0},overlap:Boolean,keepAliveOnHover:{type:Boolean,default:!0},zIndex:Number,to:jn.propTo,scrollable:Boolean,contentClass:String,contentStyle:[Object,String],headerClass:String,headerStyle:[Object,String],footerClass:String,footerStyle:[Object,String],onClickoutside:Function,"onUpdate:show":[Function,Array],onUpdateShow:[Function,Array],internalDeactivateImmediately:Boolean,internalSyncTargetWithParent:Boolean,internalInheritedEventHandlers:{type:Array,default:()=>[]},internalTrapFocus:Boolean,internalExtraClass:{type:Array,default:()=>[]},onShow:[Function,Array],onHide:[Function,Array],arrow:{type:Boolean,default:void 0},minWidth:Number,maxWidth:Number},Vte=Object.assign(Object.assign(Object.assign({},bt.props),I1),{internalOnAfterLeave:Function,internalRenderBody:Function}),_T=Ve({name:"Popover",inheritAttrs:!1,props:Vte,__popover__:!0,setup(e){const t=zd(),r=ge(null),i=re(()=>e.show),n=ge(e.defaultShow),a=Un(i,n),o=$i(()=>e.disabled?!1:a.value),s=()=>{if(e.disabled)return!0;const{getDisabled:F}=e;return!!(F!=null&&F())},l=()=>s()?!1:a.value,c=ap(e,["arrow","showArrow"]),d=re(()=>e.overlap?!1:c.value);let u=null;const h=ge(null),f=ge(null),p=$i(()=>e.x!==void 0&&e.y!==void 0);function v(F){const{"onUpdate:show":H,onUpdateShow:N,onShow:U,onHide:ie}=e;n.value=F,H&&ct(H,F),N&&ct(N,F),F&&U&&ct(U,!0),F&&ie&&ct(ie,!1)}function m(){u&&u.syncPosition()}function g(){const{value:F}=h;F&&(window.clearTimeout(F),h.value=null)}function y(){const{value:F}=f;F&&(window.clearTimeout(F),f.value=null)}function b(){const F=s();if(e.trigger==="focus"&&!F){if(l())return;v(!0)}}function x(){const F=s();if(e.trigger==="focus"&&!F){if(!l())return;v(!1)}}function S(){const F=s();if(e.trigger==="hover"&&!F){if(y(),h.value!==null||l())return;const H=()=>{v(!0),h.value=null},{delay:N}=e;N===0?H():h.value=window.setTimeout(H,N)}}function w(){const F=s();if(e.trigger==="hover"&&!F){if(g(),f.value!==null||!l())return;const H=()=>{v(!1),f.value=null},{duration:N}=e;N===0?H():f.value=window.setTimeout(H,N)}}function _(){w()}function C(F){var H;l()&&(e.trigger==="click"&&(g(),y(),v(!1)),(H=e.onClickoutside)===null||H===void 0||H.call(e,F))}function A(){if(e.trigger==="click"&&!s()){g(),y();const F=!l();v(F)}}function M(F){e.internalTrapFocus&&F.key==="Escape"&&(g(),y(),v(!1))}function P(F){n.value=F}function T(){var F;return(F=r.value)===null||F===void 0?void 0:F.targetRef}function R(F){u=F}return br("NPopover",{getTriggerElement:T,handleKeydown:M,handleMouseEnter:S,handleMouseLeave:w,handleClickOutside:C,handleMouseMoveOutside:_,setBodyInstance:R,positionManuallyRef:p,isMountedRef:t,zIndexRef:pt(e,"zIndex"),extraClassRef:pt(e,"internalExtraClass"),internalRenderBodyRef:pt(e,"internalRenderBody")}),Qa(()=>{a.value&&s()&&v(!1)}),{binderInstRef:r,positionManually:p,mergedShowConsideringDisabledProp:o,uncontrolledShow:n,mergedShowArrow:d,getMergedShow:l,setShow:P,handleClick:A,handleMouseEnter:S,handleMouseLeave:w,handleFocus:b,handleBlur:x,syncPosition:m}},render(){var e;const{positionManually:t,$slots:r}=this;let i,n=!1;if(!t&&(r.activator?i=G_(r,"activator"):i=G_(r,"trigger"),i)){i=nl(i),i=i.type===Tg?E("span",[i]):i;const a={onClick:this.handleClick,onMouseenter:this.handleMouseEnter,onMouseleave:this.handleMouseLeave,onFocus:this.handleFocus,onBlur:this.handleBlur};if(!((e=i.type)===null||e===void 0)&&e.__popover__)n=!0,i.props||(i.props={internalSyncTargetWithParent:!0,internalInheritedEventHandlers:[]}),i.props.internalSyncTargetWithParent=!0,i.props.internalInheritedEventHandlers?i.props.internalInheritedEventHandlers=[a,...i.props.internalInheritedEventHandlers]:i.props.internalInheritedEventHandlers=[a];else{const{internalInheritedEventHandlers:o}=this,s=[a,...o],l={onBlur:c=>{s.forEach(d=>{d.onBlur(c)})},onFocus:c=>{s.forEach(d=>{d.onFocus(c)})},onClick:c=>{s.forEach(d=>{d.onClick(c)})},onMouseenter:c=>{s.forEach(d=>{d.onMouseenter(c)})},onMouseleave:c=>{s.forEach(d=>{d.onMouseleave(c)})}};jte(i,o?"nested":t?"manual":this.trigger,l)}}return E(ch,{ref:"binderInstRef",syncTarget:!n,syncTargetWithParent:this.internalSyncTargetWithParent},{default:()=>{this.mergedShowConsideringDisabledProp;const a=this.getMergedShow();return[this.internalTrapFocus&&a?Ka(E("div",{style:{position:"fixed",inset:0}}),[[N5,{enabled:a,zIndex:this.zIndex}]]):null,t?null:E(dh,null,{default:()=>i}),E(Fte,pv(this.$props,Nte,Object.assign(Object.assign({},this.$attrs),{showArrow:this.mergedShowArrow,show:a})),{default:()=>{var o,s;return(s=(o=this.$slots).default)===null||s===void 0?void 0:s.call(o)},header:()=>{var o,s;return(s=(o=this.$slots).header)===null||s===void 0?void 0:s.call(o)},footer:()=>{var o,s;return(s=(o=this.$slots).footer)===null||s===void 0?void 0:s.call(o)}})]}})}}),Hte={closeIconSizeTiny:"12px",closeIconSizeSmall:"12px",closeIconSizeMedium:"14px",closeIconSizeLarge:"14px",closeSizeTiny:"16px",closeSizeSmall:"16px",closeSizeMedium:"18px",closeSizeLarge:"18px",padding:"0 7px",closeMargin:"0 0 0 4px"},Wte=e=>{const{textColor2:t,primaryColorHover:r,primaryColorPressed:i,primaryColor:n,infoColor:a,successColor:o,warningColor:s,errorColor:l,baseColor:c,borderColor:d,opacityDisabled:u,tagColor:h,closeIconColor:f,closeIconColorHover:p,closeIconColorPressed:v,borderRadiusSmall:m,fontSizeMini:g,fontSizeTiny:y,fontSizeSmall:b,fontSizeMedium:x,heightMini:S,heightTiny:w,heightSmall:_,heightMedium:C,closeColorHover:A,closeColorPressed:M,buttonColor2Hover:P,buttonColor2Pressed:T,fontWeightStrong:R}=e;return Object.assign(Object.assign({},Hte),{closeBorderRadius:m,heightTiny:S,heightSmall:w,heightMedium:_,heightLarge:C,borderRadius:m,opacityDisabled:u,fontSizeTiny:g,fontSizeSmall:y,fontSizeMedium:b,fontSizeLarge:x,fontWeightStrong:R,textColorCheckable:t,textColorHoverCheckable:t,textColorPressedCheckable:t,textColorChecked:c,colorCheckable:"#0000",colorHoverCheckable:P,colorPressedCheckable:T,colorChecked:n,colorCheckedHover:r,colorCheckedPressed:i,border:`1px solid ${d}`,textColor:t,color:h,colorBordered:"rgb(250, 250, 252)",closeIconColor:f,closeIconColorHover:p,closeIconColorPressed:v,closeColorHover:A,closeColorPressed:M,borderPrimary:`1px solid ${Yt(n,{alpha:.3})}`,textColorPrimary:n,colorPrimary:Yt(n,{alpha:.12}),colorBorderedPrimary:Yt(n,{alpha:.1}),closeIconColorPrimary:n,closeIconColorHoverPrimary:n,closeIconColorPressedPrimary:n,closeColorHoverPrimary:Yt(n,{alpha:.12}),closeColorPressedPrimary:Yt(n,{alpha:.18}),borderInfo:`1px solid ${Yt(a,{alpha:.3})}`,textColorInfo:a,colorInfo:Yt(a,{alpha:.12}),colorBorderedInfo:Yt(a,{alpha:.1}),closeIconColorInfo:a,closeIconColorHoverInfo:a,closeIconColorPressedInfo:a,closeColorHoverInfo:Yt(a,{alpha:.12}),closeColorPressedInfo:Yt(a,{alpha:.18}),borderSuccess:`1px solid ${Yt(o,{alpha:.3})}`,textColorSuccess:o,colorSuccess:Yt(o,{alpha:.12}),colorBorderedSuccess:Yt(o,{alpha:.1}),closeIconColorSuccess:o,closeIconColorHoverSuccess:o,closeIconColorPressedSuccess:o,closeColorHoverSuccess:Yt(o,{alpha:.12}),closeColorPressedSuccess:Yt(o,{alpha:.18}),borderWarning:`1px solid ${Yt(s,{alpha:.35})}`,textColorWarning:s,colorWarning:Yt(s,{alpha:.15}),colorBorderedWarning:Yt(s,{alpha:.12}),closeIconColorWarning:s,closeIconColorHoverWarning:s,closeIconColorPressedWarning:s,closeColorHoverWarning:Yt(s,{alpha:.12}),closeColorPressedWarning:Yt(s,{alpha:.18}),borderError:`1px solid ${Yt(l,{alpha:.23})}`,textColorError:l,colorError:Yt(l,{alpha:.1}),colorBorderedError:Yt(l,{alpha:.08}),closeIconColorError:l,closeIconColorHoverError:l,closeIconColorPressedError:l,closeColorHoverError:Yt(l,{alpha:.12}),closeColorPressedError:Yt(l,{alpha:.18})})},Gte={name:"Tag",common:Gr,self:Wte},$te={color:Object,type:{type:String,default:"default"},round:Boolean,size:{type:String,default:"medium"},closable:Boolean,disabled:{type:Boolean,default:void 0}},qte=oe("tag",`
 --n-close-margin: var(--n-close-margin-top) var(--n-close-margin-right) var(--n-close-margin-bottom) var(--n-close-margin-left);
 white-space: nowrap;
 position: relative;
 box-sizing: border-box;
 cursor: default;
 display: inline-flex;
 align-items: center;
 flex-wrap: nowrap;
 padding: var(--n-padding);
 border-radius: var(--n-border-radius);
 color: var(--n-text-color);
 background-color: var(--n-color);
 transition: 
 border-color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier),
 box-shadow .3s var(--n-bezier),
 opacity .3s var(--n-bezier);
 line-height: 1;
 height: var(--n-height);
 font-size: var(--n-font-size);
`,[xe("strong",`
 font-weight: var(--n-font-weight-strong);
 `),he("border",`
 pointer-events: none;
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 border-radius: inherit;
 border: var(--n-border);
 transition: border-color .3s var(--n-bezier);
 `),he("icon",`
 display: flex;
 margin: 0 4px 0 0;
 color: var(--n-text-color);
 transition: color .3s var(--n-bezier);
 font-size: var(--n-avatar-size-override);
 `),he("avatar",`
 display: flex;
 margin: 0 6px 0 0;
 `),he("close",`
 margin: var(--n-close-margin);
 transition:
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
 `),xe("round",`
 padding: 0 calc(var(--n-height) / 3);
 border-radius: calc(var(--n-height) / 2);
 `,[he("icon",`
 margin: 0 4px 0 calc((var(--n-height) - 8px) / -2);
 `),he("avatar",`
 margin: 0 6px 0 calc((var(--n-height) - 8px) / -2);
 `),xe("closable",`
 padding: 0 calc(var(--n-height) / 4) 0 calc(var(--n-height) / 3);
 `)]),xe("icon, avatar",[xe("round",`
 padding: 0 calc(var(--n-height) / 3) 0 calc(var(--n-height) / 2);
 `)]),xe("disabled",`
 cursor: not-allowed !important;
 opacity: var(--n-opacity-disabled);
 `),xe("checkable",`
 cursor: pointer;
 box-shadow: none;
 color: var(--n-text-color-checkable);
 background-color: var(--n-color-checkable);
 `,[yr("disabled",[ve("&:hover","background-color: var(--n-color-hover-checkable);",[yr("checked","color: var(--n-text-color-hover-checkable);")]),ve("&:active","background-color: var(--n-color-pressed-checkable);",[yr("checked","color: var(--n-text-color-pressed-checkable);")])]),xe("checked",`
 color: var(--n-text-color-checked);
 background-color: var(--n-color-checked);
 `,[yr("disabled",[ve("&:hover","background-color: var(--n-color-checked-hover);"),ve("&:active","background-color: var(--n-color-checked-pressed);")])])])]),Yte=Object.assign(Object.assign(Object.assign({},bt.props),$te),{bordered:{type:Boolean,default:void 0},checked:Boolean,checkable:Boolean,strong:Boolean,triggerClickOnClose:Boolean,onClose:[Array,Function],onMouseenter:Function,onMouseleave:Function,"onUpdate:checked":Function,onUpdateChecked:Function,internalCloseFocusable:{type:Boolean,default:!0},internalCloseIsButtonTag:{type:Boolean,default:!0},onCheckedChange:Function}),QN="n-tag",Jw=Ve({name:"Tag",props:Yte,setup(e){const t=ge(null),{mergedBorderedRef:r,mergedClsPrefixRef:i,inlineThemeDisabled:n,mergedRtlRef:a}=mr(e),o=bt("Tag","-tag",qte,Gte,e,i);br(QN,{roundRef:pt(e,"round")});function s(f){if(!e.disabled&&e.checkable){const{checked:p,onCheckedChange:v,onUpdateChecked:m,"onUpdate:checked":g}=e;m&&m(!p),g&&g(!p),v&&v(!p)}}function l(f){if(e.triggerClickOnClose||f.stopPropagation(),!e.disabled){const{onClose:p}=e;p&&ct(p,f)}}const c={setTextContent(f){const{value:p}=t;p&&(p.textContent=f)}},d=Ja("Tag",a,i),u=re(()=>{const{type:f,size:p,color:{color:v,textColor:m}={}}=e,{common:{cubicBezierEaseInOut:g},self:{padding:y,closeMargin:b,borderRadius:x,opacityDisabled:S,textColorCheckable:w,textColorHoverCheckable:_,textColorPressedCheckable:C,textColorChecked:A,colorCheckable:M,colorHoverCheckable:P,colorPressedCheckable:T,colorChecked:R,colorCheckedHover:z,colorCheckedPressed:F,closeBorderRadius:H,fontWeightStrong:N,[Ze("colorBordered",f)]:U,[Ze("closeSize",p)]:ie,[Ze("closeIconSize",p)]:te,[Ze("fontSize",p)]:X,[Ze("height",p)]:W,[Ze("color",f)]:q,[Ze("textColor",f)]:$,[Ze("border",f)]:le,[Ze("closeIconColor",f)]:ee,[Ze("closeIconColorHover",f)]:Q,[Ze("closeIconColorPressed",f)]:ne,[Ze("closeColorHover",f)]:V,[Ze("closeColorPressed",f)]:de}}=o.value,me=Eo(b);return{"--n-font-weight-strong":N,"--n-avatar-size-override":`calc(${W} - 8px)`,"--n-bezier":g,"--n-border-radius":x,"--n-border":le,"--n-close-icon-size":te,"--n-close-color-pressed":de,"--n-close-color-hover":V,"--n-close-border-radius":H,"--n-close-icon-color":ee,"--n-close-icon-color-hover":Q,"--n-close-icon-color-pressed":ne,"--n-close-icon-color-disabled":ee,"--n-close-margin-top":me.top,"--n-close-margin-right":me.right,"--n-close-margin-bottom":me.bottom,"--n-close-margin-left":me.left,"--n-close-size":ie,"--n-color":v||(r.value?U:q),"--n-color-checkable":M,"--n-color-checked":R,"--n-color-checked-hover":z,"--n-color-checked-pressed":F,"--n-color-hover-checkable":P,"--n-color-pressed-checkable":T,"--n-font-size":X,"--n-height":W,"--n-opacity-disabled":S,"--n-padding":y,"--n-text-color":m||$,"--n-text-color-checkable":w,"--n-text-color-checked":A,"--n-text-color-hover-checkable":_,"--n-text-color-pressed-checkable":C}}),h=n?Dr("tag",re(()=>{let f="";const{type:p,size:v,color:{color:m,textColor:g}={}}=e;return f+=p[0],f+=v[0],m&&(f+=`a${Wv(m)}`),g&&(f+=`b${Wv(g)}`),r.value&&(f+="c"),f}),u,e):void 0;return Object.assign(Object.assign({},c),{rtlEnabled:d,mergedClsPrefix:i,contentRef:t,mergedBordered:r,handleClick:s,handleCloseClick:l,cssVars:n?void 0:u,themeClass:h==null?void 0:h.themeClass,onRender:h==null?void 0:h.onRender})},render(){var e,t;const{mergedClsPrefix:r,rtlEnabled:i,closable:n,color:{borderColor:a}={},round:o,onRender:s,$slots:l}=this;s==null||s();const c=ei(l.avatar,u=>u&&E("div",{class:`${r}-tag__avatar`},u)),d=ei(l.icon,u=>u&&E("div",{class:`${r}-tag__icon`},u));return E("div",{class:[`${r}-tag`,this.themeClass,{[`${r}-tag--rtl`]:i,[`${r}-tag--strong`]:this.strong,[`${r}-tag--disabled`]:this.disabled,[`${r}-tag--checkable`]:this.checkable,[`${r}-tag--checked`]:this.checkable&&this.checked,[`${r}-tag--round`]:o,[`${r}-tag--avatar`]:c,[`${r}-tag--icon`]:d,[`${r}-tag--closable`]:n}],style:this.cssVars,onClick:this.handleClick,onMouseenter:this.onMouseenter,onMouseleave:this.onMouseleave},d||c,E("span",{class:`${r}-tag__content`,ref:"contentRef"},(t=(e=this.$slots).default)===null||t===void 0?void 0:t.call(e)),!this.checkable&&n?E(O1,{clsPrefix:r,class:`${r}-tag__close`,disabled:this.disabled,onClick:this.handleCloseClick,focusable:this.internalCloseFocusable,round:o,isButtonTag:this.internalCloseIsButtonTag,absolute:!0}):null,!this.checkable&&this.mergedBordered?E("div",{class:`${r}-tag__border`,style:{borderColor:a}}):null)}}),Xte=oe("base-clear",`
 flex-shrink: 0;
 height: 1em;
 width: 1em;
 position: relative;
`,[ve(">",[he("clear",`
 font-size: var(--n-clear-size);
 height: 1em;
 width: 1em;
 cursor: pointer;
 color: var(--n-clear-color);
 transition: color .3s var(--n-bezier);
 display: flex;
 `,[ve("&:hover",`
 color: var(--n-clear-color-hover)!important;
 `),ve("&:active",`
 color: var(--n-clear-color-pressed)!important;
 `)]),he("placeholder",`
 display: flex;
 `),he("clear, placeholder",`
 position: absolute;
 left: 50%;
 top: 50%;
 transform: translateX(-50%) translateY(-50%);
 `,[Sd({originalTransform:"translateX(-50%) translateY(-50%)",left:"50%",top:"50%"})])])]),p2=Ve({name:"BaseClear",props:{clsPrefix:{type:String,required:!0},show:Boolean,onClear:Function},setup(e){return gh("-base-clear",Xte,pt(e,"clsPrefix")),{handleMouseDown(t){t.preventDefault()}}},render(){const{clsPrefix:e}=this;return E("div",{class:`${e}-base-clear`},E(zp,null,{default:()=>{var t,r;return this.show?E("div",{key:"dismiss",class:`${e}-base-clear__clear`,onClick:this.onClear,onMousedown:this.handleMouseDown,"data-clear":!0},Sr(this.$slots.icon,()=>[E(Li,{clsPrefix:e},{default:()=>E(Nee,null)})])):E("div",{key:"icon",class:`${e}-base-clear__placeholder`},(r=(t=this.$slots).placeholder)===null||r===void 0?void 0:r.call(t))}}))}}),ZN=Ve({name:"InternalSelectionSuffix",props:{clsPrefix:{type:String,required:!0},showArrow:{type:Boolean,default:void 0},showClear:{type:Boolean,default:void 0},loading:{type:Boolean,default:!1},onClear:Function},setup(e,{slots:t}){return()=>{const{clsPrefix:r}=e;return E(Ig,{clsPrefix:r,class:`${r}-base-suffix`,strokeWidth:24,scale:.85,show:e.loading},{default:()=>e.showArrow?E(p2,{clsPrefix:r,show:e.showClear,onClear:e.onClear},{placeholder:()=>E(Li,{clsPrefix:r,class:`${r}-base-suffix__arrow`},{default:()=>Sr(t.default,()=>[E(Fee,null)])})}):null})}}}),Kte={paddingSingle:"0 26px 0 12px",paddingMultiple:"3px 26px 0 12px",clearSize:"16px",arrowSize:"16px"},Qte=e=>{const{borderRadius:t,textColor2:r,textColorDisabled:i,inputColor:n,inputColorDisabled:a,primaryColor:o,primaryColorHover:s,warningColor:l,warningColorHover:c,errorColor:d,errorColorHover:u,borderColor:h,iconColor:f,iconColorDisabled:p,clearColor:v,clearColorHover:m,clearColorPressed:g,placeholderColor:y,placeholderColorDisabled:b,fontSizeTiny:x,fontSizeSmall:S,fontSizeMedium:w,fontSizeLarge:_,heightTiny:C,heightSmall:A,heightMedium:M,heightLarge:P}=e;return Object.assign(Object.assign({},Kte),{fontSizeTiny:x,fontSizeSmall:S,fontSizeMedium:w,fontSizeLarge:_,heightTiny:C,heightSmall:A,heightMedium:M,heightLarge:P,borderRadius:t,textColor:r,textColorDisabled:i,placeholderColor:y,placeholderColorDisabled:b,color:n,colorDisabled:a,colorActive:n,border:`1px solid ${h}`,borderHover:`1px solid ${s}`,borderActive:`1px solid ${o}`,borderFocus:`1px solid ${s}`,boxShadowHover:"none",boxShadowActive:`0 0 0 2px ${Yt(o,{alpha:.2})}`,boxShadowFocus:`0 0 0 2px ${Yt(o,{alpha:.2})}`,caretColor:o,arrowColor:f,arrowColorDisabled:p,loadingColor:o,borderWarning:`1px solid ${l}`,borderHoverWarning:`1px solid ${c}`,borderActiveWarning:`1px solid ${l}`,borderFocusWarning:`1px solid ${c}`,boxShadowHoverWarning:"none",boxShadowActiveWarning:`0 0 0 2px ${Yt(l,{alpha:.2})}`,boxShadowFocusWarning:`0 0 0 2px ${Yt(l,{alpha:.2})}`,colorActiveWarning:n,caretColorWarning:l,borderError:`1px solid ${d}`,borderHoverError:`1px solid ${u}`,borderActiveError:`1px solid ${d}`,borderFocusError:`1px solid ${u}`,boxShadowHoverError:"none",boxShadowActiveError:`0 0 0 2px ${Yt(d,{alpha:.2})}`,boxShadowFocusError:`0 0 0 2px ${Yt(d,{alpha:.2})}`,colorActiveError:n,caretColorError:d,clearColor:v,clearColorHover:m,clearColorPressed:g})},JN={name:"InternalSelection",common:Gr,peers:{Popover:R1},self:Qte},Zte=ve([oe("base-selection",`
 --n-padding-single: var(--n-padding-single-top) var(--n-padding-single-right) var(--n-padding-single-bottom) var(--n-padding-single-left);
 --n-padding-multiple: var(--n-padding-multiple-top) var(--n-padding-multiple-right) var(--n-padding-multiple-bottom) var(--n-padding-multiple-left);
 position: relative;
 z-index: auto;
 box-shadow: none;
 width: 100%;
 max-width: 100%;
 display: inline-block;
 vertical-align: bottom;
 border-radius: var(--n-border-radius);
 min-height: var(--n-height);
 line-height: 1.5;
 font-size: var(--n-font-size);
 `,[oe("base-loading",`
 color: var(--n-loading-color);
 `),oe("base-selection-tags","min-height: var(--n-height);"),he("border, state-border",`
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 pointer-events: none;
 border: var(--n-border);
 border-radius: inherit;
 transition:
 box-shadow .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 `),he("state-border",`
 z-index: 1;
 border-color: #0000;
 `),oe("base-suffix",`
 cursor: pointer;
 position: absolute;
 top: 50%;
 transform: translateY(-50%);
 right: 10px;
 `,[he("arrow",`
 font-size: var(--n-arrow-size);
 color: var(--n-arrow-color);
 transition: color .3s var(--n-bezier);
 `)]),oe("base-selection-overlay",`
 display: flex;
 align-items: center;
 white-space: nowrap;
 pointer-events: none;
 position: absolute;
 top: 0;
 right: 0;
 bottom: 0;
 left: 0;
 padding: var(--n-padding-single);
 transition: color .3s var(--n-bezier);
 `,[he("wrapper",`
 flex-basis: 0;
 flex-grow: 1;
 overflow: hidden;
 text-overflow: ellipsis;
 `)]),oe("base-selection-placeholder",`
 color: var(--n-placeholder-color);
 `,[he("inner",`
 max-width: 100%;
 overflow: hidden;
 `)]),oe("base-selection-tags",`
 cursor: pointer;
 outline: none;
 box-sizing: border-box;
 position: relative;
 z-index: auto;
 display: flex;
 padding: var(--n-padding-multiple);
 flex-wrap: wrap;
 align-items: center;
 width: 100%;
 vertical-align: bottom;
 background-color: var(--n-color);
 border-radius: inherit;
 transition:
 color .3s var(--n-bezier),
 box-shadow .3s var(--n-bezier),
 background-color .3s var(--n-bezier);
 `),oe("base-selection-label",`
 height: var(--n-height);
 display: inline-flex;
 width: 100%;
 vertical-align: bottom;
 cursor: pointer;
 outline: none;
 z-index: auto;
 box-sizing: border-box;
 position: relative;
 transition:
 color .3s var(--n-bezier),
 box-shadow .3s var(--n-bezier),
 background-color .3s var(--n-bezier);
 border-radius: inherit;
 background-color: var(--n-color);
 align-items: center;
 `,[oe("base-selection-input",`
 font-size: inherit;
 line-height: inherit;
 outline: none;
 cursor: pointer;
 box-sizing: border-box;
 border:none;
 width: 100%;
 padding: var(--n-padding-single);
 background-color: #0000;
 color: var(--n-text-color);
 transition: color .3s var(--n-bezier);
 caret-color: var(--n-caret-color);
 `,[he("content",`
 text-overflow: ellipsis;
 overflow: hidden;
 white-space: nowrap; 
 `)]),he("render-label",`
 color: var(--n-text-color);
 `)]),yr("disabled",[ve("&:hover",[he("state-border",`
 box-shadow: var(--n-box-shadow-hover);
 border: var(--n-border-hover);
 `)]),xe("focus",[he("state-border",`
 box-shadow: var(--n-box-shadow-focus);
 border: var(--n-border-focus);
 `)]),xe("active",[he("state-border",`
 box-shadow: var(--n-box-shadow-active);
 border: var(--n-border-active);
 `),oe("base-selection-label","background-color: var(--n-color-active);"),oe("base-selection-tags","background-color: var(--n-color-active);")])]),xe("disabled","cursor: not-allowed;",[he("arrow",`
 color: var(--n-arrow-color-disabled);
 `),oe("base-selection-label",`
 cursor: not-allowed;
 background-color: var(--n-color-disabled);
 `,[oe("base-selection-input",`
 cursor: not-allowed;
 color: var(--n-text-color-disabled);
 `),he("render-label",`
 color: var(--n-text-color-disabled);
 `)]),oe("base-selection-tags",`
 cursor: not-allowed;
 background-color: var(--n-color-disabled);
 `),oe("base-selection-placeholder",`
 cursor: not-allowed;
 color: var(--n-placeholder-color-disabled);
 `)]),oe("base-selection-input-tag",`
 height: calc(var(--n-height) - 6px);
 line-height: calc(var(--n-height) - 6px);
 outline: none;
 display: none;
 position: relative;
 margin-bottom: 3px;
 max-width: 100%;
 vertical-align: bottom;
 `,[he("input",`
 font-size: inherit;
 font-family: inherit;
 min-width: 1px;
 padding: 0;
 background-color: #0000;
 outline: none;
 border: none;
 max-width: 100%;
 overflow: hidden;
 width: 1em;
 line-height: inherit;
 cursor: pointer;
 color: var(--n-text-color);
 caret-color: var(--n-caret-color);
 `),he("mirror",`
 position: absolute;
 left: 0;
 top: 0;
 white-space: pre;
 visibility: hidden;
 user-select: none;
 -webkit-user-select: none;
 opacity: 0;
 `)]),["warning","error"].map(e=>xe(`${e}-status`,[he("state-border",`border: var(--n-border-${e});`),yr("disabled",[ve("&:hover",[he("state-border",`
 box-shadow: var(--n-box-shadow-hover-${e});
 border: var(--n-border-hover-${e});
 `)]),xe("active",[he("state-border",`
 box-shadow: var(--n-box-shadow-active-${e});
 border: var(--n-border-active-${e});
 `),oe("base-selection-label",`background-color: var(--n-color-active-${e});`),oe("base-selection-tags",`background-color: var(--n-color-active-${e});`)]),xe("focus",[he("state-border",`
 box-shadow: var(--n-box-shadow-focus-${e});
 border: var(--n-border-focus-${e});
 `)])])]))]),oe("base-selection-popover",`
 margin-bottom: -3px;
 display: flex;
 flex-wrap: wrap;
 margin-right: -8px;
 `),oe("base-selection-tag-wrapper",`
 max-width: 100%;
 display: inline-flex;
 padding: 0 7px 3px 0;
 `,[ve("&:last-child","padding-right: 0;"),oe("tag",`
 font-size: 14px;
 max-width: 100%;
 `,[he("content",`
 line-height: 1.25;
 text-overflow: ellipsis;
 overflow: hidden;
 `)])])]),Jte=Ve({name:"InternalSelection",props:Object.assign(Object.assign({},bt.props),{clsPrefix:{type:String,required:!0},bordered:{type:Boolean,default:void 0},active:Boolean,pattern:{type:String,default:""},placeholder:String,selectedOption:{type:Object,default:null},selectedOptions:{type:Array,default:null},labelField:{type:String,default:"label"},valueField:{type:String,default:"value"},multiple:Boolean,filterable:Boolean,clearable:Boolean,disabled:Boolean,size:{type:String,default:"medium"},loading:Boolean,autofocus:Boolean,showArrow:{type:Boolean,default:!0},inputProps:Object,focused:Boolean,renderTag:Function,onKeydown:Function,onClick:Function,onBlur:Function,onFocus:Function,onDeleteOption:Function,maxTagCount:[String,Number],ellipsisTagPopoverProps:Object,onClear:Function,onPatternInput:Function,onPatternFocus:Function,onPatternBlur:Function,renderLabel:Function,status:String,inlineThemeDisabled:Boolean,ignoreComposition:{type:Boolean,default:!0},onResize:Function}),setup(e){const{mergedClsPrefixRef:t,mergedRtlRef:r}=mr(e),i=Ja("InternalSelection",r,t),n=ge(null),a=ge(null),o=ge(null),s=ge(null),l=ge(null),c=ge(null),d=ge(null),u=ge(null),h=ge(null),f=ge(null),p=ge(!1),v=ge(!1),m=ge(!1),g=bt("InternalSelection","-internal-selection",Zte,JN,e,pt(e,"clsPrefix")),y=re(()=>e.clearable&&!e.disabled&&(m.value||e.active)),b=re(()=>e.selectedOption?e.renderTag?e.renderTag({option:e.selectedOption,handleClose:()=>{}}):e.renderLabel?e.renderLabel(e.selectedOption,!0):kn(e.selectedOption[e.labelField],e.selectedOption,!0):e.placeholder),x=re(()=>{const O=e.selectedOption;if(O)return O[e.labelField]}),S=re(()=>e.multiple?!!(Array.isArray(e.selectedOptions)&&e.selectedOptions.length):e.selectedOption!==null);function w(){var O;const{value:j}=n;if(j){const{value:L}=a;L&&(L.style.width=`${j.offsetWidth}px`,e.maxTagCount!=="responsive"&&((O=h.value)===null||O===void 0||O.sync({showAllItemsBeforeCalculate:!1})))}}function _(){const{value:O}=f;O&&(O.style.display="none")}function C(){const{value:O}=f;O&&(O.style.display="inline-block")}tr(pt(e,"active"),O=>{O||_()}),tr(pt(e,"pattern"),()=>{e.multiple&&ra(w)});function A(O){const{onFocus:j}=e;j&&j(O)}function M(O){const{onBlur:j}=e;j&&j(O)}function P(O){const{onDeleteOption:j}=e;j&&j(O)}function T(O){const{onClear:j}=e;j&&j(O)}function R(O){const{onPatternInput:j}=e;j&&j(O)}function z(O){var j;(!O.relatedTarget||!(!((j=o.value)===null||j===void 0)&&j.contains(O.relatedTarget)))&&A(O)}function F(O){var j;!((j=o.value)===null||j===void 0)&&j.contains(O.relatedTarget)||M(O)}function H(O){T(O)}function N(){m.value=!0}function U(){m.value=!1}function ie(O){!e.active||!e.filterable||O.target!==a.value&&O.preventDefault()}function te(O){P(O)}function X(O){if(O.key==="Backspace"&&!W.value&&!e.pattern.length){const{selectedOptions:j}=e;j!=null&&j.length&&te(j[j.length-1])}}const W=ge(!1);let q=null;function $(O){const{value:j}=n;if(j){const L=O.target.value;j.textContent=L,w()}e.ignoreComposition&&W.value?q=O:R(O)}function le(){W.value=!0}function ee(){W.value=!1,e.ignoreComposition&&R(q),q=null}function Q(O){var j;v.value=!0,(j=e.onPatternFocus)===null||j===void 0||j.call(e,O)}function ne(O){var j;v.value=!1,(j=e.onPatternBlur)===null||j===void 0||j.call(e,O)}function V(){var O,j;if(e.filterable)v.value=!1,(O=c.value)===null||O===void 0||O.blur(),(j=a.value)===null||j===void 0||j.blur();else if(e.multiple){const{value:L}=s;L==null||L.blur()}else{const{value:L}=l;L==null||L.blur()}}function de(){var O,j,L;e.filterable?(v.value=!1,(O=c.value)===null||O===void 0||O.focus()):e.multiple?(j=s.value)===null||j===void 0||j.focus():(L=l.value)===null||L===void 0||L.focus()}function me(){const{value:O}=a;O&&(C(),O.focus())}function Ce(){const{value:O}=a;O&&O.blur()}function G(O){const{value:j}=d;j&&j.setTextContent(`+${O}`)}function Z(){const{value:O}=u;return O}function ue(){return a.value}let Se=null;function we(){Se!==null&&window.clearTimeout(Se)}function _e(){e.active||(we(),Se=window.setTimeout(()=>{S.value&&(p.value=!0)},100))}function Ee(){we()}function fe(O){O||(we(),p.value=!1)}tr(S,O=>{O||(p.value=!1)}),Or(()=>{Qa(()=>{const O=c.value;O&&(e.disabled?O.removeAttribute("tabindex"):O.tabIndex=v.value?-1:0)})}),K5(o,e.onResize);const{inlineThemeDisabled:B}=e,D=re(()=>{const{size:O}=e,{common:{cubicBezierEaseInOut:j},self:{borderRadius:L,color:Ae,placeholderColor:We,textColor:je,paddingSingle:ze,paddingMultiple:Je,caretColor:nt,colorDisabled:lt,textColorDisabled:dt,placeholderColorDisabled:vt,colorActive:se,boxShadowFocus:Le,boxShadowActive:Ye,boxShadowHover:pe,border:Te,borderFocus:ce,borderHover:Re,borderActive:$e,arrowColor:at,arrowColorDisabled:qt,loadingColor:ir,colorActiveWarning:Fe,boxShadowFocusWarning:Ke,boxShadowActiveWarning:ut,boxShadowHoverWarning:Ft,borderWarning:ui,borderFocusWarning:_i,borderHoverWarning:Ar,borderActiveWarning:De,colorActiveError:K,boxShadowFocusError:Me,boxShadowActiveError:He,boxShadowHoverError:Oe,borderError:Ne,borderFocusError:wt,borderHoverError:Rt,borderActiveError:It,clearColor:Tt,clearColorHover:hr,clearColorPressed:Zt,clearSize:Pe,arrowSize:Qe,[Ze("height",O)]:xt,[Ze("fontSize",O)]:Mr}}=g.value,ci=Eo(ze),Nt=Eo(Je);return{"--n-bezier":j,"--n-border":Te,"--n-border-active":$e,"--n-border-focus":ce,"--n-border-hover":Re,"--n-border-radius":L,"--n-box-shadow-active":Ye,"--n-box-shadow-focus":Le,"--n-box-shadow-hover":pe,"--n-caret-color":nt,"--n-color":Ae,"--n-color-active":se,"--n-color-disabled":lt,"--n-font-size":Mr,"--n-height":xt,"--n-padding-single-top":ci.top,"--n-padding-multiple-top":Nt.top,"--n-padding-single-right":ci.right,"--n-padding-multiple-right":Nt.right,"--n-padding-single-left":ci.left,"--n-padding-multiple-left":Nt.left,"--n-padding-single-bottom":ci.bottom,"--n-padding-multiple-bottom":Nt.bottom,"--n-placeholder-color":We,"--n-placeholder-color-disabled":vt,"--n-text-color":je,"--n-text-color-disabled":dt,"--n-arrow-color":at,"--n-arrow-color-disabled":qt,"--n-loading-color":ir,"--n-color-active-warning":Fe,"--n-box-shadow-focus-warning":Ke,"--n-box-shadow-active-warning":ut,"--n-box-shadow-hover-warning":Ft,"--n-border-warning":ui,"--n-border-focus-warning":_i,"--n-border-hover-warning":Ar,"--n-border-active-warning":De,"--n-color-active-error":K,"--n-box-shadow-focus-error":Me,"--n-box-shadow-active-error":He,"--n-box-shadow-hover-error":Oe,"--n-border-error":Ne,"--n-border-focus-error":wt,"--n-border-hover-error":Rt,"--n-border-active-error":It,"--n-clear-size":Pe,"--n-clear-color":Tt,"--n-clear-color-hover":hr,"--n-clear-color-pressed":Zt,"--n-arrow-size":Qe}}),I=B?Dr("internal-selection",re(()=>e.size[0]),D,e):void 0;return{mergedTheme:g,mergedClearable:y,mergedClsPrefix:t,rtlEnabled:i,patternInputFocused:v,filterablePlaceholder:b,label:x,selected:S,showTagsPanel:p,isComposing:W,counterRef:d,counterWrapperRef:u,patternInputMirrorRef:n,patternInputRef:a,selfRef:o,multipleElRef:s,singleElRef:l,patternInputWrapperRef:c,overflowRef:h,inputTagElRef:f,handleMouseDown:ie,handleFocusin:z,handleClear:H,handleMouseEnter:N,handleMouseLeave:U,handleDeleteOption:te,handlePatternKeyDown:X,handlePatternInputInput:$,handlePatternInputBlur:ne,handlePatternInputFocus:Q,handleMouseEnterCounter:_e,handleMouseLeaveCounter:Ee,handleFocusout:F,handleCompositionEnd:ee,handleCompositionStart:le,onPopoverUpdateShow:fe,focus:de,focusInput:me,blur:V,blurInput:Ce,updateCounter:G,getCounter:Z,getTail:ue,renderLabel:e.renderLabel,cssVars:B?void 0:D,themeClass:I==null?void 0:I.themeClass,onRender:I==null?void 0:I.onRender}},render(){const{status:e,multiple:t,size:r,disabled:i,filterable:n,maxTagCount:a,bordered:o,clsPrefix:s,ellipsisTagPopoverProps:l,onRender:c,renderTag:d,renderLabel:u}=this;c==null||c();const h=a==="responsive",f=typeof a=="number",p=h||f,v=E(q_,null,{default:()=>E(ZN,{clsPrefix:s,loading:this.loading,showArrow:this.showArrow,showClear:this.mergedClearable&&this.selected,onClear:this.handleClear},{default:()=>{var g,y;return(y=(g=this.$slots).arrow)===null||y===void 0?void 0:y.call(g)}})});let m;if(t){const{labelField:g}=this,y=R=>E("div",{class:`${s}-base-selection-tag-wrapper`,key:R.value},d?d({option:R,handleClose:()=>{this.handleDeleteOption(R)}}):E(Jw,{size:r,closable:!R.disabled,disabled:i,onClose:()=>{this.handleDeleteOption(R)},internalCloseIsButtonTag:!1,internalCloseFocusable:!1},{default:()=>u?u(R,!0):kn(R[g],R,!0)})),b=()=>(f?this.selectedOptions.slice(0,a):this.selectedOptions).map(y),x=n?E("div",{class:`${s}-base-selection-input-tag`,ref:"inputTagElRef",key:"__input-tag__"},E("input",Object.assign({},this.inputProps,{ref:"patternInputRef",tabindex:-1,disabled:i,value:this.pattern,autofocus:this.autofocus,class:`${s}-base-selection-input-tag__input`,onBlur:this.handlePatternInputBlur,onFocus:this.handlePatternInputFocus,onKeydown:this.handlePatternKeyDown,onInput:this.handlePatternInputInput,onCompositionstart:this.handleCompositionStart,onCompositionend:this.handleCompositionEnd})),E("span",{ref:"patternInputMirrorRef",class:`${s}-base-selection-input-tag__mirror`},this.pattern)):null,S=h?()=>E("div",{class:`${s}-base-selection-tag-wrapper`,ref:"counterWrapperRef"},E(Jw,{size:r,ref:"counterRef",onMouseenter:this.handleMouseEnterCounter,onMouseleave:this.handleMouseLeaveCounter,disabled:i})):void 0;let w;if(f){const R=this.selectedOptions.length-a;R>0&&(w=E("div",{class:`${s}-base-selection-tag-wrapper`,key:"__counter__"},E(Jw,{size:r,ref:"counterRef",onMouseenter:this.handleMouseEnterCounter,disabled:i},{default:()=>`+${R}`})))}const _=h?n?E(J_,{ref:"overflowRef",updateCounter:this.updateCounter,getCounter:this.getCounter,getTail:this.getTail,style:{width:"100%",display:"flex",overflow:"hidden"}},{default:b,counter:S,tail:()=>x}):E(J_,{ref:"overflowRef",updateCounter:this.updateCounter,getCounter:this.getCounter,style:{width:"100%",display:"flex",overflow:"hidden"}},{default:b,counter:S}):f&&w?b().concat(w):b(),C=p?()=>E("div",{class:`${s}-base-selection-popover`},h?b():this.selectedOptions.map(y)):void 0,A=p?Object.assign({show:this.showTagsPanel,trigger:"hover",overlap:!0,placement:"top",width:"trigger",onUpdateShow:this.onPopoverUpdateShow,theme:this.mergedTheme.peers.Popover,themeOverrides:this.mergedTheme.peerOverrides.Popover},l):null,P=(this.selected?!1:this.active?!this.pattern&&!this.isComposing:!0)?E("div",{class:`${s}-base-selection-placeholder ${s}-base-selection-overlay`},E("div",{class:`${s}-base-selection-placeholder__inner`},this.placeholder)):null,T=n?E("div",{ref:"patternInputWrapperRef",class:`${s}-base-selection-tags`},_,h?null:x,v):E("div",{ref:"multipleElRef",class:`${s}-base-selection-tags`,tabindex:i?void 0:0},_,v);m=E(pr,null,p?E(_T,Object.assign({},A,{scrollable:!0,style:"max-height: calc(var(--v-target-height) * 6.6);"}),{trigger:()=>T,default:C}):T,P)}else if(n){const g=this.pattern||this.isComposing,y=this.active?!g:!this.selected,b=this.active?!1:this.selected;m=E("div",{ref:"patternInputWrapperRef",class:`${s}-base-selection-label`,title:this.patternInputFocused?void 0:W_(this.label)},E("input",Object.assign({},this.inputProps,{ref:"patternInputRef",class:`${s}-base-selection-input`,value:this.active?this.pattern:"",placeholder:"",readonly:i,disabled:i,tabindex:-1,autofocus:this.autofocus,onFocus:this.handlePatternInputFocus,onBlur:this.handlePatternInputBlur,onInput:this.handlePatternInputInput,onCompositionstart:this.handleCompositionStart,onCompositionend:this.handleCompositionEnd})),b?E("div",{class:`${s}-base-selection-label__render-label ${s}-base-selection-overlay`,key:"input"},E("div",{class:`${s}-base-selection-overlay__wrapper`},d?d({option:this.selectedOption,handleClose:()=>{}}):u?u(this.selectedOption,!0):kn(this.label,this.selectedOption,!0))):null,y?E("div",{class:`${s}-base-selection-placeholder ${s}-base-selection-overlay`,key:"placeholder"},E("div",{class:`${s}-base-selection-overlay__wrapper`},this.filterablePlaceholder)):null,v)}else m=E("div",{ref:"singleElRef",class:`${s}-base-selection-label`,tabindex:this.disabled?void 0:0},this.label!==void 0?E("div",{class:`${s}-base-selection-input`,title:W_(this.label),key:"input"},E("div",{class:`${s}-base-selection-input__content`},d?d({option:this.selectedOption,handleClose:()=>{}}):u?u(this.selectedOption,!0):kn(this.label,this.selectedOption,!0))):E("div",{class:`${s}-base-selection-placeholder ${s}-base-selection-overlay`,key:"placeholder"},E("div",{class:`${s}-base-selection-placeholder__inner`},this.placeholder)),v);return E("div",{ref:"selfRef",class:[`${s}-base-selection`,this.rtlEnabled&&`${s}-base-selection--rtl`,this.themeClass,e&&`${s}-base-selection--${e}-status`,{[`${s}-base-selection--active`]:this.active,[`${s}-base-selection--selected`]:this.selected||this.active&&this.pattern,[`${s}-base-selection--disabled`]:this.disabled,[`${s}-base-selection--multiple`]:this.multiple,[`${s}-base-selection--focus`]:this.focused}],style:this.cssVars,onClick:this.onClick,onMouseenter:this.handleMouseEnter,onMouseleave:this.handleMouseLeave,onKeydown:this.onKeydown,onFocusin:this.handleFocusin,onFocusout:this.handleFocusout,onMousedown:this.handleMouseDown},m,o?E("div",{class:`${s}-base-selection__border`}):null,o?E("div",{class:`${s}-base-selection__state-border`}):null)}}),{cubicBezierEaseInOut:xc}=Ld;function ere({duration:e=".2s",delay:t=".1s"}={}){return[ve("&.fade-in-width-expand-transition-leave-from, &.fade-in-width-expand-transition-enter-to",{opacity:1}),ve("&.fade-in-width-expand-transition-leave-to, &.fade-in-width-expand-transition-enter-from",`
 opacity: 0!important;
 margin-left: 0!important;
 margin-right: 0!important;
 `),ve("&.fade-in-width-expand-transition-leave-active",`
 overflow: hidden;
 transition:
 opacity ${e} ${xc},
 max-width ${e} ${xc} ${t},
 margin-left ${e} ${xc} ${t},
 margin-right ${e} ${xc} ${t};
 `),ve("&.fade-in-width-expand-transition-enter-active",`
 overflow: hidden;
 transition:
 opacity ${e} ${xc} ${t},
 max-width ${e} ${xc},
 margin-left ${e} ${xc},
 margin-right ${e} ${xc};
 `)]}const{cubicBezierEaseInOut:Ss,cubicBezierEaseOut:tre,cubicBezierEaseIn:rre}=Ld;function eU({overflow:e="hidden",duration:t=".3s",originalTransition:r="",leavingDelay:i="0s",foldPadding:n=!1,enterToProps:a=void 0,leaveToProps:o=void 0,reverse:s=!1}={}){const l=s?"leave":"enter",c=s?"enter":"leave";return[ve(`&.fade-in-height-expand-transition-${c}-from,
 &.fade-in-height-expand-transition-${l}-to`,Object.assign(Object.assign({},a),{opacity:1})),ve(`&.fade-in-height-expand-transition-${c}-to,
 &.fade-in-height-expand-transition-${l}-from`,Object.assign(Object.assign({},o),{opacity:0,marginTop:"0 !important",marginBottom:"0 !important",paddingTop:n?"0 !important":void 0,paddingBottom:n?"0 !important":void 0})),ve(`&.fade-in-height-expand-transition-${c}-active`,`
 overflow: ${e};
 transition:
 max-height ${t} ${Ss} ${i},
 opacity ${t} ${tre} ${i},
 margin-top ${t} ${Ss} ${i},
 margin-bottom ${t} ${Ss} ${i},
 padding-top ${t} ${Ss} ${i},
 padding-bottom ${t} ${Ss} ${i}
 ${r?","+r:""}
 `),ve(`&.fade-in-height-expand-transition-${l}-active`,`
 overflow: ${e};
 transition:
 max-height ${t} ${Ss},
 opacity ${t} ${rre},
 margin-top ${t} ${Ss},
 margin-bottom ${t} ${Ss},
 padding-top ${t} ${Ss},
 padding-bottom ${t} ${Ss}
 ${r?","+r:""}
 `)]}function ex(e){return e.type==="group"}function tU(e){return e.type==="ignored"}function eS(e,t){try{return!!(1+t.toString().toLowerCase().indexOf(e.trim().toLowerCase()))}catch{return!1}}function rU(e,t){return{getIsGroup:ex,getIgnored:tU,getKey(i){return ex(i)?i.name||i.key||"key-required":i[e]},getChildren(i){return i[t]}}}function ire(e,t,r,i){if(!t)return e;function n(a){if(!Array.isArray(a))return[];const o=[];for(const s of a)if(ex(s)){const l=n(s[i]);l.length&&o.push(Object.assign({},s,{[i]:l}))}else{if(tU(s))continue;t(r,s)&&o.push(s)}return o}return n(e)}function nre(e,t,r){const i=new Map;return e.forEach(n=>{ex(n)?n[r].forEach(a=>{i.set(a[t],a)}):i.set(n[t],n)}),i}const are=Id&&"chrome"in window;Id&&navigator.userAgent.includes("Firefox");const iU=Id&&navigator.userAgent.includes("Safari")&&!are,ore={paddingTiny:"0 8px",paddingSmall:"0 10px",paddingMedium:"0 12px",paddingLarge:"0 14px",clearSize:"16px"},sre=e=>{const{textColor2:t,textColor3:r,textColorDisabled:i,primaryColor:n,primaryColorHover:a,inputColor:o,inputColorDisabled:s,borderColor:l,warningColor:c,warningColorHover:d,errorColor:u,errorColorHover:h,borderRadius:f,lineHeight:p,fontSizeTiny:v,fontSizeSmall:m,fontSizeMedium:g,fontSizeLarge:y,heightTiny:b,heightSmall:x,heightMedium:S,heightLarge:w,actionColor:_,clearColor:C,clearColorHover:A,clearColorPressed:M,placeholderColor:P,placeholderColorDisabled:T,iconColor:R,iconColorDisabled:z,iconColorHover:F,iconColorPressed:H}=e;return Object.assign(Object.assign({},ore),{countTextColorDisabled:i,countTextColor:r,heightTiny:b,heightSmall:x,heightMedium:S,heightLarge:w,fontSizeTiny:v,fontSizeSmall:m,fontSizeMedium:g,fontSizeLarge:y,lineHeight:p,lineHeightTextarea:p,borderRadius:f,iconSize:"16px",groupLabelColor:_,groupLabelTextColor:t,textColor:t,textColorDisabled:i,textDecorationColor:t,caretColor:n,placeholderColor:P,placeholderColorDisabled:T,color:o,colorDisabled:s,colorFocus:o,groupLabelBorder:`1px solid ${l}`,border:`1px solid ${l}`,borderHover:`1px solid ${a}`,borderDisabled:`1px solid ${l}`,borderFocus:`1px solid ${a}`,boxShadowFocus:`0 0 0 2px ${Yt(n,{alpha:.2})}`,loadingColor:n,loadingColorWarning:c,borderWarning:`1px solid ${c}`,borderHoverWarning:`1px solid ${d}`,colorFocusWarning:o,borderFocusWarning:`1px solid ${d}`,boxShadowFocusWarning:`0 0 0 2px ${Yt(c,{alpha:.2})}`,caretColorWarning:c,loadingColorError:u,borderError:`1px solid ${u}`,borderHoverError:`1px solid ${h}`,colorFocusError:o,borderFocusError:`1px solid ${h}`,boxShadowFocusError:`0 0 0 2px ${Yt(u,{alpha:.2})}`,caretColorError:u,clearColor:C,clearColorHover:A,clearColorPressed:M,iconColor:R,iconColorDisabled:z,iconColorHover:F,iconColorPressed:H,suffixTextColor:t})},Bp={name:"Input",common:Gr,self:sre},nU="n-input";function lre(e){let t=0;for(const r of e)t++;return t}function A0(e){return e===""||e==null}function cre(e){const t=ge(null);function r(){const{value:a}=e;if(!(a!=null&&a.focus)){n();return}const{selectionStart:o,selectionEnd:s,value:l}=a;if(o==null||s==null){n();return}t.value={start:o,end:s,beforeText:l.slice(0,o),afterText:l.slice(s)}}function i(){var a;const{value:o}=t,{value:s}=e;if(!o||!s)return;const{value:l}=s,{start:c,beforeText:d,afterText:u}=o;let h=l.length;if(l.endsWith(u))h=l.length-u.length;else if(l.startsWith(d))h=d.length;else{const f=d[c-1],p=l.indexOf(f,c-1);p!==-1&&(h=p+1)}(a=s.setSelectionRange)===null||a===void 0||a.call(s,h,h)}function n(){t.value=null}return tr(e,n),{recordCursor:r,restoreCursor:i}}const RO=Ve({name:"InputWordCount",setup(e,{slots:t}){const{mergedValueRef:r,maxlengthRef:i,mergedClsPrefixRef:n,countGraphemesRef:a}=_t(nU),o=re(()=>{const{value:s}=r;return s===null||Array.isArray(s)?0:(a.value||lre)(s)});return()=>{const{value:s}=i,{value:l}=r;return E("span",{class:`${n.value}-input-word-count`},$_(t.default,{value:l===null||Array.isArray(l)?"":l},()=>[s===void 0?o.value:`${o.value} / ${s}`]))}}}),dre=oe("input",`
 max-width: 100%;
 cursor: text;
 line-height: 1.5;
 z-index: auto;
 outline: none;
 box-sizing: border-box;
 position: relative;
 display: inline-flex;
 border-radius: var(--n-border-radius);
 background-color: var(--n-color);
 transition: background-color .3s var(--n-bezier);
 font-size: var(--n-font-size);
 --n-padding-vertical: calc((var(--n-height) - 1.5 * var(--n-font-size)) / 2);
`,[he("input, textarea",`
 overflow: hidden;
 flex-grow: 1;
 position: relative;
 `),he("input-el, textarea-el, input-mirror, textarea-mirror, separator, placeholder",`
 box-sizing: border-box;
 font-size: inherit;
 line-height: 1.5;
 font-family: inherit;
 border: none;
 outline: none;
 background-color: #0000;
 text-align: inherit;
 transition:
 -webkit-text-fill-color .3s var(--n-bezier),
 caret-color .3s var(--n-bezier),
 color .3s var(--n-bezier),
 text-decoration-color .3s var(--n-bezier);
 `),he("input-el, textarea-el",`
 -webkit-appearance: none;
 scrollbar-width: none;
 width: 100%;
 min-width: 0;
 text-decoration-color: var(--n-text-decoration-color);
 color: var(--n-text-color);
 caret-color: var(--n-caret-color);
 background-color: transparent;
 `,[ve("&::-webkit-scrollbar, &::-webkit-scrollbar-track-piece, &::-webkit-scrollbar-thumb",`
 width: 0;
 height: 0;
 display: none;
 `),ve("&::placeholder",`
 color: #0000;
 -webkit-text-fill-color: transparent !important;
 `),ve("&:-webkit-autofill ~",[he("placeholder","display: none;")])]),xe("round",[yr("textarea","border-radius: calc(var(--n-height) / 2);")]),he("placeholder",`
 pointer-events: none;
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 overflow: hidden;
 color: var(--n-placeholder-color);
 `,[ve("span",`
 width: 100%;
 display: inline-block;
 `)]),xe("textarea",[he("placeholder","overflow: visible;")]),yr("autosize","width: 100%;"),xe("autosize",[he("textarea-el, input-el",`
 position: absolute;
 top: 0;
 left: 0;
 height: 100%;
 `)]),oe("input-wrapper",`
 overflow: hidden;
 display: inline-flex;
 flex-grow: 1;
 position: relative;
 padding-left: var(--n-padding-left);
 padding-right: var(--n-padding-right);
 `),he("input-mirror",`
 padding: 0;
 height: var(--n-height);
 line-height: var(--n-height);
 overflow: hidden;
 visibility: hidden;
 position: static;
 white-space: pre;
 pointer-events: none;
 `),he("input-el",`
 padding: 0;
 height: var(--n-height);
 line-height: var(--n-height);
 `,[ve("&[type=password]::-ms-reveal","display: none;"),ve("+",[he("placeholder",`
 display: flex;
 align-items: center; 
 `)])]),yr("textarea",[he("placeholder","white-space: nowrap;")]),he("eye",`
 display: flex;
 align-items: center;
 justify-content: center;
 transition: color .3s var(--n-bezier);
 `),xe("textarea","width: 100%;",[oe("input-word-count",`
 position: absolute;
 right: var(--n-padding-right);
 bottom: var(--n-padding-vertical);
 `),xe("resizable",[oe("input-wrapper",`
 resize: vertical;
 min-height: var(--n-height);
 `)]),he("textarea-el, textarea-mirror, placeholder",`
 height: 100%;
 padding-left: 0;
 padding-right: 0;
 padding-top: var(--n-padding-vertical);
 padding-bottom: var(--n-padding-vertical);
 word-break: break-word;
 display: inline-block;
 vertical-align: bottom;
 box-sizing: border-box;
 line-height: var(--n-line-height-textarea);
 margin: 0;
 resize: none;
 white-space: pre-wrap;
 scroll-padding-block-end: var(--n-padding-vertical);
 `),he("textarea-mirror",`
 width: 100%;
 pointer-events: none;
 overflow: hidden;
 visibility: hidden;
 position: static;
 white-space: pre-wrap;
 overflow-wrap: break-word;
 `)]),xe("pair",[he("input-el, placeholder","text-align: center;"),he("separator",`
 display: flex;
 align-items: center;
 transition: color .3s var(--n-bezier);
 color: var(--n-text-color);
 white-space: nowrap;
 `,[oe("icon",`
 color: var(--n-icon-color);
 `),oe("base-icon",`
 color: var(--n-icon-color);
 `)])]),xe("disabled",`
 cursor: not-allowed;
 background-color: var(--n-color-disabled);
 `,[he("border","border: var(--n-border-disabled);"),he("input-el, textarea-el",`
 cursor: not-allowed;
 color: var(--n-text-color-disabled);
 text-decoration-color: var(--n-text-color-disabled);
 `),he("placeholder","color: var(--n-placeholder-color-disabled);"),he("separator","color: var(--n-text-color-disabled);",[oe("icon",`
 color: var(--n-icon-color-disabled);
 `),oe("base-icon",`
 color: var(--n-icon-color-disabled);
 `)]),oe("input-word-count",`
 color: var(--n-count-text-color-disabled);
 `),he("suffix, prefix","color: var(--n-text-color-disabled);",[oe("icon",`
 color: var(--n-icon-color-disabled);
 `),oe("internal-icon",`
 color: var(--n-icon-color-disabled);
 `)])]),yr("disabled",[he("eye",`
 color: var(--n-icon-color);
 cursor: pointer;
 `,[ve("&:hover",`
 color: var(--n-icon-color-hover);
 `),ve("&:active",`
 color: var(--n-icon-color-pressed);
 `)]),ve("&:hover",[he("state-border","border: var(--n-border-hover);")]),xe("focus","background-color: var(--n-color-focus);",[he("state-border",`
 border: var(--n-border-focus);
 box-shadow: var(--n-box-shadow-focus);
 `)])]),he("border, state-border",`
 box-sizing: border-box;
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 pointer-events: none;
 border-radius: inherit;
 border: var(--n-border);
 transition:
 box-shadow .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 `),he("state-border",`
 border-color: #0000;
 z-index: 1;
 `),he("prefix","margin-right: 4px;"),he("suffix",`
 margin-left: 4px;
 `),he("suffix, prefix",`
 transition: color .3s var(--n-bezier);
 flex-wrap: nowrap;
 flex-shrink: 0;
 line-height: var(--n-height);
 white-space: nowrap;
 display: inline-flex;
 align-items: center;
 justify-content: center;
 color: var(--n-suffix-text-color);
 `,[oe("base-loading",`
 font-size: var(--n-icon-size);
 margin: 0 2px;
 color: var(--n-loading-color);
 `),oe("base-clear",`
 font-size: var(--n-icon-size);
 `,[he("placeholder",[oe("base-icon",`
 transition: color .3s var(--n-bezier);
 color: var(--n-icon-color);
 font-size: var(--n-icon-size);
 `)])]),ve(">",[oe("icon",`
 transition: color .3s var(--n-bezier);
 color: var(--n-icon-color);
 font-size: var(--n-icon-size);
 `)]),oe("base-icon",`
 font-size: var(--n-icon-size);
 `)]),oe("input-word-count",`
 pointer-events: none;
 line-height: 1.5;
 font-size: .85em;
 color: var(--n-count-text-color);
 transition: color .3s var(--n-bezier);
 margin-left: 4px;
 font-variant: tabular-nums;
 `),["warning","error"].map(e=>xe(`${e}-status`,[yr("disabled",[oe("base-loading",`
 color: var(--n-loading-color-${e})
 `),he("input-el, textarea-el",`
 caret-color: var(--n-caret-color-${e});
 `),he("state-border",`
 border: var(--n-border-${e});
 `),ve("&:hover",[he("state-border",`
 border: var(--n-border-hover-${e});
 `)]),ve("&:focus",`
 background-color: var(--n-color-focus-${e});
 `,[he("state-border",`
 box-shadow: var(--n-box-shadow-focus-${e});
 border: var(--n-border-focus-${e});
 `)]),xe("focus",`
 background-color: var(--n-color-focus-${e});
 `,[he("state-border",`
 box-shadow: var(--n-box-shadow-focus-${e});
 border: var(--n-border-focus-${e});
 `)])])]))]),ure=oe("input",[xe("disabled",[he("input-el, textarea-el",`
 -webkit-text-fill-color: var(--n-text-color-disabled);
 `)])]),hre=Object.assign(Object.assign({},bt.props),{bordered:{type:Boolean,default:void 0},type:{type:String,default:"text"},placeholder:[Array,String],defaultValue:{type:[String,Array],default:null},value:[String,Array],disabled:{type:Boolean,default:void 0},size:String,rows:{type:[Number,String],default:3},round:Boolean,minlength:[String,Number],maxlength:[String,Number],clearable:Boolean,autosize:{type:[Boolean,Object],default:!1},pair:Boolean,separator:String,readonly:{type:[String,Boolean],default:!1},passivelyActivated:Boolean,showPasswordOn:String,stateful:{type:Boolean,default:!0},autofocus:Boolean,inputProps:Object,resizable:{type:Boolean,default:!0},showCount:Boolean,loading:{type:Boolean,default:void 0},allowInput:Function,renderCount:Function,onMousedown:Function,onKeydown:Function,onKeyup:[Function,Array],onInput:[Function,Array],onFocus:[Function,Array],onBlur:[Function,Array],onClick:[Function,Array],onChange:[Function,Array],onClear:[Function,Array],countGraphemes:Function,status:String,"onUpdate:value":[Function,Array],onUpdateValue:[Function,Array],textDecoration:[String,Array],attrSize:{type:Number,default:20},onInputBlur:[Function,Array],onInputFocus:[Function,Array],onDeactivate:[Function,Array],onActivate:[Function,Array],onWrapperFocus:[Function,Array],onWrapperBlur:[Function,Array],internalDeactivateOnEnter:Boolean,internalForceFocus:Boolean,internalLoadingBeforeSuffix:{type:Boolean,default:!0},showPasswordToggle:Boolean}),cr=Ve({name:"Input",props:hre,setup(e){const{mergedClsPrefixRef:t,mergedBorderedRef:r,inlineThemeDisabled:i,mergedRtlRef:n}=mr(e),a=bt("Input","-input",dre,Bp,e,t);iU&&gh("-input-safari",ure,t);const o=ge(null),s=ge(null),l=ge(null),c=ge(null),d=ge(null),u=ge(null),h=ge(null),f=cre(h),p=ge(null),{localeRef:v}=dc("Input"),m=ge(e.defaultValue),g=pt(e,"value"),y=Un(g,m),b=cl(e),{mergedSizeRef:x,mergedDisabledRef:S,mergedStatusRef:w}=b,_=ge(!1),C=ge(!1),A=ge(!1),M=ge(!1);let P=null;const T=re(()=>{const{placeholder:De,pair:K}=e;return K?Array.isArray(De)?De:De===void 0?["",""]:[De,De]:De===void 0?[v.value.placeholder]:[De]}),R=re(()=>{const{value:De}=A,{value:K}=y,{value:Me}=T;return!De&&(A0(K)||Array.isArray(K)&&A0(K[0]))&&Me[0]}),z=re(()=>{const{value:De}=A,{value:K}=y,{value:Me}=T;return!De&&Me[1]&&(A0(K)||Array.isArray(K)&&A0(K[1]))}),F=$i(()=>e.internalForceFocus||_.value),H=$i(()=>{if(S.value||e.readonly||!e.clearable||!F.value&&!C.value)return!1;const{value:De}=y,{value:K}=F;return e.pair?!!(Array.isArray(De)&&(De[0]||De[1]))&&(C.value||K):!!De&&(C.value||K)}),N=re(()=>{const{showPasswordOn:De}=e;if(De)return De;if(e.showPasswordToggle)return"click"}),U=ge(!1),ie=re(()=>{const{textDecoration:De}=e;return De?Array.isArray(De)?De.map(K=>({textDecoration:K})):[{textDecoration:De}]:["",""]}),te=ge(void 0),X=()=>{var De,K;if(e.type==="textarea"){const{autosize:Me}=e;if(Me&&(te.value=(K=(De=p.value)===null||De===void 0?void 0:De.$el)===null||K===void 0?void 0:K.offsetWidth),!s.value||typeof Me=="boolean")return;const{paddingTop:He,paddingBottom:Oe,lineHeight:Ne}=window.getComputedStyle(s.value),wt=Number(He.slice(0,-2)),Rt=Number(Oe.slice(0,-2)),It=Number(Ne.slice(0,-2)),{value:Tt}=l;if(!Tt)return;if(Me.minRows){const hr=Math.max(Me.minRows,1),Zt=`${wt+Rt+It*hr}px`;Tt.style.minHeight=Zt}if(Me.maxRows){const hr=`${wt+Rt+It*Me.maxRows}px`;Tt.style.maxHeight=hr}}},W=re(()=>{const{maxlength:De}=e;return De===void 0?void 0:Number(De)});Or(()=>{const{value:De}=y;Array.isArray(De)||at(De)});const q=lh().proxy;function $(De,K){const{onUpdateValue:Me,"onUpdate:value":He,onInput:Oe}=e,{nTriggerFormInput:Ne}=b;Me&&ct(Me,De,K),He&&ct(He,De,K),Oe&&ct(Oe,De,K),m.value=De,Ne()}function le(De,K){const{onChange:Me}=e,{nTriggerFormChange:He}=b;Me&&ct(Me,De,K),m.value=De,He()}function ee(De){const{onBlur:K}=e,{nTriggerFormBlur:Me}=b;K&&ct(K,De),Me()}function Q(De){const{onFocus:K}=e,{nTriggerFormFocus:Me}=b;K&&ct(K,De),Me()}function ne(De){const{onClear:K}=e;K&&ct(K,De)}function V(De){const{onInputBlur:K}=e;K&&ct(K,De)}function de(De){const{onInputFocus:K}=e;K&&ct(K,De)}function me(){const{onDeactivate:De}=e;De&&ct(De)}function Ce(){const{onActivate:De}=e;De&&ct(De)}function G(De){const{onClick:K}=e;K&&ct(K,De)}function Z(De){const{onWrapperFocus:K}=e;K&&ct(K,De)}function ue(De){const{onWrapperBlur:K}=e;K&&ct(K,De)}function Se(){A.value=!0}function we(De){A.value=!1,De.target===u.value?_e(De,1):_e(De,0)}function _e(De,K=0,Me="input"){const He=De.target.value;if(at(He),De instanceof InputEvent&&!De.isComposing&&(A.value=!1),e.type==="textarea"){const{value:Ne}=p;Ne&&Ne.syncUnifiedContainer()}if(P=He,A.value)return;f.recordCursor();const Oe=Ee(He);if(Oe)if(!e.pair)Me==="input"?$(He,{source:K}):le(He,{source:K});else{let{value:Ne}=y;Array.isArray(Ne)?Ne=[Ne[0],Ne[1]]:Ne=["",""],Ne[K]=He,Me==="input"?$(Ne,{source:K}):le(Ne,{source:K})}q.$forceUpdate(),Oe||ra(f.restoreCursor)}function Ee(De){const{countGraphemes:K,maxlength:Me,minlength:He}=e;if(K){let Ne;if(Me!==void 0&&(Ne===void 0&&(Ne=K(De)),Ne>Number(Me))||He!==void 0&&(Ne===void 0&&(Ne=K(De)),Ne<Number(Me)))return!1}const{allowInput:Oe}=e;return typeof Oe=="function"?Oe(De):!0}function fe(De){V(De),De.relatedTarget===o.value&&me(),De.relatedTarget!==null&&(De.relatedTarget===d.value||De.relatedTarget===u.value||De.relatedTarget===s.value)||(M.value=!1),O(De,"blur"),h.value=null}function B(De,K){de(De),_.value=!0,M.value=!0,Ce(),O(De,"focus"),K===0?h.value=d.value:K===1?h.value=u.value:K===2&&(h.value=s.value)}function D(De){e.passivelyActivated&&(ue(De),O(De,"blur"))}function I(De){e.passivelyActivated&&(_.value=!0,Z(De),O(De,"focus"))}function O(De,K){De.relatedTarget!==null&&(De.relatedTarget===d.value||De.relatedTarget===u.value||De.relatedTarget===s.value||De.relatedTarget===o.value)||(K==="focus"?(Q(De),_.value=!0):K==="blur"&&(ee(De),_.value=!1))}function j(De,K){_e(De,K,"change")}function L(De){G(De)}function Ae(De){ne(De),We()}function We(){e.pair?($(["",""],{source:"clear"}),le(["",""],{source:"clear"})):($("",{source:"clear"}),le("",{source:"clear"}))}function je(De){const{onMousedown:K}=e;K&&K(De);const{tagName:Me}=De.target;if(Me!=="INPUT"&&Me!=="TEXTAREA"){if(e.resizable){const{value:He}=o;if(He){const{left:Oe,top:Ne,width:wt,height:Rt}=He.getBoundingClientRect(),It=14;if(Oe+wt-It<De.clientX&&De.clientX<Oe+wt&&Ne+Rt-It<De.clientY&&De.clientY<Ne+Rt)return}}De.preventDefault(),_.value||Ye()}}function ze(){var De;C.value=!0,e.type==="textarea"&&((De=p.value)===null||De===void 0||De.handleMouseEnterWrapper())}function Je(){var De;C.value=!1,e.type==="textarea"&&((De=p.value)===null||De===void 0||De.handleMouseLeaveWrapper())}function nt(){S.value||N.value==="click"&&(U.value=!U.value)}function lt(De){if(S.value)return;De.preventDefault();const K=He=>{He.preventDefault(),wi("mouseup",document,K)};if(Ni("mouseup",document,K),N.value!=="mousedown")return;U.value=!0;const Me=()=>{U.value=!1,wi("mouseup",document,Me)};Ni("mouseup",document,Me)}function dt(De){e.onKeyup&&ct(e.onKeyup,De)}function vt(De){switch(e.onKeydown&&ct(e.onKeydown,De),De.key){case"Escape":Le();break;case"Enter":se(De);break}}function se(De){var K,Me;if(e.passivelyActivated){const{value:He}=M;if(He){e.internalDeactivateOnEnter&&Le();return}De.preventDefault(),e.type==="textarea"?(K=s.value)===null||K===void 0||K.focus():(Me=d.value)===null||Me===void 0||Me.focus()}}function Le(){e.passivelyActivated&&(M.value=!1,ra(()=>{var De;(De=o.value)===null||De===void 0||De.focus()}))}function Ye(){var De,K,Me;S.value||(e.passivelyActivated?(De=o.value)===null||De===void 0||De.focus():((K=s.value)===null||K===void 0||K.focus(),(Me=d.value)===null||Me===void 0||Me.focus()))}function pe(){var De;!((De=o.value)===null||De===void 0)&&De.contains(document.activeElement)&&document.activeElement.blur()}function Te(){var De,K;(De=s.value)===null||De===void 0||De.select(),(K=d.value)===null||K===void 0||K.select()}function ce(){S.value||(s.value?s.value.focus():d.value&&d.value.focus())}function Re(){const{value:De}=o;De!=null&&De.contains(document.activeElement)&&De!==document.activeElement&&Le()}function $e(De){if(e.type==="textarea"){const{value:K}=s;K==null||K.scrollTo(De)}else{const{value:K}=d;K==null||K.scrollTo(De)}}function at(De){const{type:K,pair:Me,autosize:He}=e;if(!Me&&He)if(K==="textarea"){const{value:Oe}=l;Oe&&(Oe.textContent=(De??"")+`\r
`)}else{const{value:Oe}=c;Oe&&(De?Oe.textContent=De:Oe.innerHTML="&nbsp;")}}function qt(){X()}const ir=ge({top:"0"});function Fe(De){var K;const{scrollTop:Me}=De.target;ir.value.top=`${-Me}px`,(K=p.value)===null||K===void 0||K.syncUnifiedContainer()}let Ke=null;Qa(()=>{const{autosize:De,type:K}=e;De&&K==="textarea"?Ke=tr(y,Me=>{!Array.isArray(Me)&&Me!==P&&at(Me)}):Ke==null||Ke()});let ut=null;Qa(()=>{e.type==="textarea"?ut=tr(y,De=>{var K;!Array.isArray(De)&&De!==P&&((K=p.value)===null||K===void 0||K.syncUnifiedContainer())}):ut==null||ut()}),br(nU,{mergedValueRef:y,maxlengthRef:W,mergedClsPrefixRef:t,countGraphemesRef:pt(e,"countGraphemes")});const Ft={wrapperElRef:o,inputElRef:d,textareaElRef:s,isCompositing:A,clear:We,focus:Ye,blur:pe,select:Te,deactivate:Re,activate:ce,scrollTo:$e},ui=Ja("Input",n,t),_i=re(()=>{const{value:De}=x,{common:{cubicBezierEaseInOut:K},self:{color:Me,borderRadius:He,textColor:Oe,caretColor:Ne,caretColorError:wt,caretColorWarning:Rt,textDecorationColor:It,border:Tt,borderDisabled:hr,borderHover:Zt,borderFocus:Pe,placeholderColor:Qe,placeholderColorDisabled:xt,lineHeightTextarea:Mr,colorDisabled:ci,colorFocus:Nt,textColorDisabled:nr,boxShadowFocus:_n,iconSize:Jt,colorFocusWarning:ro,boxShadowFocusWarning:Uo,borderWarning:uo,borderFocusWarning:ka,borderHoverWarning:Y,colorFocusError:J,boxShadowFocusError:be,borderError:ae,borderFocusError:Ie,borderHoverError:ot,clearSize:jo,clearColor:im,clearColorHover:Mh,clearColorPressed:nm,iconColor:Eh,iconColorDisabled:am,suffixTextColor:e9,countTextColor:t9,countTextColorDisabled:r9,iconColorHover:i9,iconColorPressed:n9,loadingColor:a9,loadingColorError:o9,loadingColorWarning:s9,[Ze("padding",De)]:l9,[Ze("fontSize",De)]:c9,[Ze("height",De)]:d9}}=a.value,{left:u9,right:h9}=Eo(l9);return{"--n-bezier":K,"--n-count-text-color":t9,"--n-count-text-color-disabled":r9,"--n-color":Me,"--n-font-size":c9,"--n-border-radius":He,"--n-height":d9,"--n-padding-left":u9,"--n-padding-right":h9,"--n-text-color":Oe,"--n-caret-color":Ne,"--n-text-decoration-color":It,"--n-border":Tt,"--n-border-disabled":hr,"--n-border-hover":Zt,"--n-border-focus":Pe,"--n-placeholder-color":Qe,"--n-placeholder-color-disabled":xt,"--n-icon-size":Jt,"--n-line-height-textarea":Mr,"--n-color-disabled":ci,"--n-color-focus":Nt,"--n-text-color-disabled":nr,"--n-box-shadow-focus":_n,"--n-loading-color":a9,"--n-caret-color-warning":Rt,"--n-color-focus-warning":ro,"--n-box-shadow-focus-warning":Uo,"--n-border-warning":uo,"--n-border-focus-warning":ka,"--n-border-hover-warning":Y,"--n-loading-color-warning":s9,"--n-caret-color-error":wt,"--n-color-focus-error":J,"--n-box-shadow-focus-error":be,"--n-border-error":ae,"--n-border-focus-error":Ie,"--n-border-hover-error":ot,"--n-loading-color-error":o9,"--n-clear-color":im,"--n-clear-size":jo,"--n-clear-color-hover":Mh,"--n-clear-color-pressed":nm,"--n-icon-color":Eh,"--n-icon-color-hover":i9,"--n-icon-color-pressed":n9,"--n-icon-color-disabled":am,"--n-suffix-text-color":e9}}),Ar=i?Dr("input",re(()=>{const{value:De}=x;return De[0]}),_i,e):void 0;return Object.assign(Object.assign({},Ft),{wrapperElRef:o,inputElRef:d,inputMirrorElRef:c,inputEl2Ref:u,textareaElRef:s,textareaMirrorElRef:l,textareaScrollbarInstRef:p,rtlEnabled:ui,uncontrolledValue:m,mergedValue:y,passwordVisible:U,mergedPlaceholder:T,showPlaceholder1:R,showPlaceholder2:z,mergedFocus:F,isComposing:A,activated:M,showClearButton:H,mergedSize:x,mergedDisabled:S,textDecorationStyle:ie,mergedClsPrefix:t,mergedBordered:r,mergedShowPasswordOn:N,placeholderStyle:ir,mergedStatus:w,textAreaScrollContainerWidth:te,handleTextAreaScroll:Fe,handleCompositionStart:Se,handleCompositionEnd:we,handleInput:_e,handleInputBlur:fe,handleInputFocus:B,handleWrapperBlur:D,handleWrapperFocus:I,handleMouseEnter:ze,handleMouseLeave:Je,handleMouseDown:je,handleChange:j,handleClick:L,handleClear:Ae,handlePasswordToggleClick:nt,handlePasswordToggleMousedown:lt,handleWrapperKeydown:vt,handleWrapperKeyup:dt,handleTextAreaMirrorResize:qt,getTextareaScrollContainer:()=>s.value,mergedTheme:a,cssVars:i?void 0:_i,themeClass:Ar==null?void 0:Ar.themeClass,onRender:Ar==null?void 0:Ar.onRender})},render(){var e,t;const{mergedClsPrefix:r,mergedStatus:i,themeClass:n,type:a,countGraphemes:o,onRender:s}=this,l=this.$slots;return s==null||s(),E("div",{ref:"wrapperElRef",class:[`${r}-input`,n,i&&`${r}-input--${i}-status`,{[`${r}-input--rtl`]:this.rtlEnabled,[`${r}-input--disabled`]:this.mergedDisabled,[`${r}-input--textarea`]:a==="textarea",[`${r}-input--resizable`]:this.resizable&&!this.autosize,[`${r}-input--autosize`]:this.autosize,[`${r}-input--round`]:this.round&&a!=="textarea",[`${r}-input--pair`]:this.pair,[`${r}-input--focus`]:this.mergedFocus,[`${r}-input--stateful`]:this.stateful}],style:this.cssVars,tabindex:!this.mergedDisabled&&this.passivelyActivated&&!this.activated?0:void 0,onFocus:this.handleWrapperFocus,onBlur:this.handleWrapperBlur,onClick:this.handleClick,onMousedown:this.handleMouseDown,onMouseenter:this.handleMouseEnter,onMouseleave:this.handleMouseLeave,onCompositionstart:this.handleCompositionStart,onCompositionend:this.handleCompositionEnd,onKeyup:this.handleWrapperKeyup,onKeydown:this.handleWrapperKeydown},E("div",{class:`${r}-input-wrapper`},ei(l.prefix,c=>c&&E("div",{class:`${r}-input__prefix`},c)),a==="textarea"?E(bn,{ref:"textareaScrollbarInstRef",class:`${r}-input__textarea`,container:this.getTextareaScrollContainer,triggerDisplayManually:!0,useUnifiedContainer:!0,internalHoistYRail:!0},{default:()=>{var c,d;const{textAreaScrollContainerWidth:u}=this,h={width:this.autosize&&u&&`${u}px`};return E(pr,null,E("textarea",Object.assign({},this.inputProps,{ref:"textareaElRef",class:[`${r}-input__textarea-el`,(c=this.inputProps)===null||c===void 0?void 0:c.class],autofocus:this.autofocus,rows:Number(this.rows),placeholder:this.placeholder,value:this.mergedValue,disabled:this.mergedDisabled,maxlength:o?void 0:this.maxlength,minlength:o?void 0:this.minlength,readonly:this.readonly,tabindex:this.passivelyActivated&&!this.activated?-1:void 0,style:[this.textDecorationStyle[0],(d=this.inputProps)===null||d===void 0?void 0:d.style,h],onBlur:this.handleInputBlur,onFocus:f=>{this.handleInputFocus(f,2)},onInput:this.handleInput,onChange:this.handleChange,onScroll:this.handleTextAreaScroll})),this.showPlaceholder1?E("div",{class:`${r}-input__placeholder`,style:[this.placeholderStyle,h],key:"placeholder"},this.mergedPlaceholder[0]):null,this.autosize?E(Ks,{onResize:this.handleTextAreaMirrorResize},{default:()=>E("div",{ref:"textareaMirrorElRef",class:`${r}-input__textarea-mirror`,key:"mirror"})}):null)}}):E("div",{class:`${r}-input__input`},E("input",Object.assign({type:a==="password"&&this.mergedShowPasswordOn&&this.passwordVisible?"text":a},this.inputProps,{ref:"inputElRef",class:[`${r}-input__input-el`,(e=this.inputProps)===null||e===void 0?void 0:e.class],style:[this.textDecorationStyle[0],(t=this.inputProps)===null||t===void 0?void 0:t.style],tabindex:this.passivelyActivated&&!this.activated?-1:void 0,placeholder:this.mergedPlaceholder[0],disabled:this.mergedDisabled,maxlength:o?void 0:this.maxlength,minlength:o?void 0:this.minlength,value:Array.isArray(this.mergedValue)?this.mergedValue[0]:this.mergedValue,readonly:this.readonly,autofocus:this.autofocus,size:this.attrSize,onBlur:this.handleInputBlur,onFocus:c=>{this.handleInputFocus(c,0)},onInput:c=>{this.handleInput(c,0)},onChange:c=>{this.handleChange(c,0)}})),this.showPlaceholder1?E("div",{class:`${r}-input__placeholder`},E("span",null,this.mergedPlaceholder[0])):null,this.autosize?E("div",{class:`${r}-input__input-mirror`,key:"mirror",ref:"inputMirrorElRef"}," "):null),!this.pair&&ei(l.suffix,c=>c||this.clearable||this.showCount||this.mergedShowPasswordOn||this.loading!==void 0?E("div",{class:`${r}-input__suffix`},[ei(l["clear-icon-placeholder"],d=>(this.clearable||d)&&E(p2,{clsPrefix:r,show:this.showClearButton,onClear:this.handleClear},{placeholder:()=>d,icon:()=>{var u,h;return(h=(u=this.$slots)["clear-icon"])===null||h===void 0?void 0:h.call(u)}})),this.internalLoadingBeforeSuffix?null:c,this.loading!==void 0?E(ZN,{clsPrefix:r,loading:this.loading,showArrow:!1,showClear:!1,style:this.cssVars}):null,this.internalLoadingBeforeSuffix?c:null,this.showCount&&this.type!=="textarea"?E(RO,null,{default:d=>{var u;return(u=l.count)===null||u===void 0?void 0:u.call(l,d)}}):null,this.mergedShowPasswordOn&&this.type==="password"?E("div",{class:`${r}-input__eye`,onMousedown:this.handlePasswordToggleMousedown,onClick:this.handlePasswordToggleClick},this.passwordVisible?Sr(l["password-visible-icon"],()=>[E(Li,{clsPrefix:r},{default:()=>E(Tee,null)})]):Sr(l["password-invisible-icon"],()=>[E(Li,{clsPrefix:r},{default:()=>E(Pee,null)})])):null]):null)),this.pair?E("span",{class:`${r}-input__separator`},Sr(l.separator,()=>[this.separator])):null,this.pair?E("div",{class:`${r}-input-wrapper`},E("div",{class:`${r}-input__input`},E("input",{ref:"inputEl2Ref",type:this.type,class:`${r}-input__input-el`,tabindex:this.passivelyActivated&&!this.activated?-1:void 0,placeholder:this.mergedPlaceholder[1],disabled:this.mergedDisabled,maxlength:o?void 0:this.maxlength,minlength:o?void 0:this.minlength,value:Array.isArray(this.mergedValue)?this.mergedValue[1]:void 0,readonly:this.readonly,style:this.textDecorationStyle[1],onBlur:this.handleInputBlur,onFocus:c=>{this.handleInputFocus(c,1)},onInput:c=>{this.handleInput(c,1)},onChange:c=>{this.handleChange(c,1)}}),this.showPlaceholder2?E("div",{class:`${r}-input__placeholder`},E("span",null,this.mergedPlaceholder[1])):null),ei(l.suffix,c=>(this.clearable||c)&&E("div",{class:`${r}-input__suffix`},[this.clearable&&E(p2,{clsPrefix:r,show:this.showClearButton,onClear:this.handleClear},{icon:()=>{var d;return(d=l["clear-icon"])===null||d===void 0?void 0:d.call(l)},placeholder:()=>{var d;return(d=l["clear-icon-placeholder"])===null||d===void 0?void 0:d.call(l)}}),c]))):null,this.mergedBordered?E("div",{class:`${r}-input__border`}):null,this.mergedBordered?E("div",{class:`${r}-input__state-border`}):null,this.showCount&&a==="textarea"?E(RO,null,{default:c=>{var d;const{renderCount:u}=this;return u?u(c):(d=l.count)===null||d===void 0?void 0:d.call(l,c)}}):null)}});function fre(e){const{boxShadow2:t}=e;return{menuBoxShadow:t}}const pre={name:"AutoComplete",common:Gr,peers:{InternalSelectMenu:CT,Input:Bp},self:fre};function mre(e){return e.map(aU)}function aU(e){var t,r;return typeof e=="string"?{label:e,value:e}:e.type==="group"?{type:"group",label:(t=e.label)!==null&&t!==void 0?t:e.name,value:(r=e.value)!==null&&r!==void 0?r:e.name,key:e.key||e.name,children:e.children.map(n=>aU(n))}:e}const vre=ve([oe("auto-complete",`
 z-index: auto;
 position: relative;
 display: inline-flex;
 width: 100%;
 `),oe("auto-complete-menu",`
 margin: 4px 0;
 box-shadow: var(--n-menu-box-shadow);
 `,[Lp({originalTransition:"background-color .3s var(--n-bezier), box-shadow .3s var(--n-bezier)"})])]),gre=Object.assign(Object.assign({},bt.props),{to:jn.propTo,menuProps:Object,append:Boolean,bordered:{type:Boolean,default:void 0},clearable:{type:Boolean,default:void 0},defaultValue:{type:String,default:null},loading:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},placeholder:String,placement:{type:String,default:"bottom-start"},value:String,blurAfterSelect:Boolean,clearAfterSelect:Boolean,getShow:Function,showEmpty:Boolean,inputProps:Object,renderOption:Function,renderLabel:Function,size:String,options:{type:Array,default:()=>[]},zIndex:Number,status:String,"onUpdate:value":[Function,Array],onUpdateValue:[Function,Array],onSelect:[Function,Array],onBlur:[Function,Array],onFocus:[Function,Array],onInput:[Function,Array]}),M0=Ve({name:"AutoComplete",props:gre,setup(e){const{mergedBorderedRef:t,namespaceRef:r,mergedClsPrefixRef:i,inlineThemeDisabled:n}=mr(e),a=cl(e),{mergedSizeRef:o,mergedDisabledRef:s,mergedStatusRef:l}=a,c=ge(null),d=ge(null),u=ge(e.defaultValue),h=pt(e,"value"),f=Un(h,u),p=ge(!1),v=ge(!1),m=bt("AutoComplete","-auto-complete",vre,pre,e,i),g=re(()=>mre(e.options)),y=re(()=>{const{getShow:$}=e;return $?$(f.value||""):!!f.value}),b=re(()=>y.value&&p.value&&(e.showEmpty?!0:!!g.value.length)),x=re(()=>Uf(g.value,rU("value","children")));function S($){const{"onUpdate:value":le,onUpdateValue:ee,onInput:Q}=e,{nTriggerFormInput:ne,nTriggerFormChange:V}=a;ee&&ct(ee,$),le&&ct(le,$),Q&&ct(Q,$),u.value=$,ne(),V()}function w($){const{onSelect:le}=e,{nTriggerFormInput:ee,nTriggerFormChange:Q}=a;le&&ct(le,$),ee(),Q()}function _($){const{onBlur:le}=e,{nTriggerFormBlur:ee}=a;le&&ct(le,$),ee()}function C($){const{onFocus:le}=e,{nTriggerFormFocus:ee}=a;le&&ct(le,$),ee()}function A(){v.value=!0}function M(){window.setTimeout(()=>{v.value=!1},0)}function P($){var le,ee,Q;switch($.key){case"Enter":if(!v.value){const ne=(le=d.value)===null||le===void 0?void 0:le.getPendingTmNode();ne&&(T(ne.rawNode),$.preventDefault())}break;case"ArrowDown":(ee=d.value)===null||ee===void 0||ee.next();break;case"ArrowUp":(Q=d.value)===null||Q===void 0||Q.prev();break}}function T($){($==null?void 0:$.value)!==void 0&&(w($.value),e.clearAfterSelect?S(null):$.label!==void 0&&S(e.append?`${f.value}${$.label}`:$.label),p.value=!1,e.blurAfterSelect&&ie())}function R(){S(null)}function z($){p.value=!0,C($)}function F($){p.value=!1,_($)}function H($){p.value=!0,S($)}function N($){T($.rawNode)}function U($){var le;!((le=c.value)===null||le===void 0)&&le.contains(Jl($))||(p.value=!1)}function ie(){var $,le;!(($=c.value)===null||$===void 0)&&$.contains(document.activeElement)&&((le=document.activeElement)===null||le===void 0||le.blur())}const te=re(()=>{const{common:{cubicBezierEaseInOut:$},self:{menuBoxShadow:le}}=m.value;return{"--n-menu-box-shadow":le,"--n-bezier":$}}),X=n?Dr("auto-complete",void 0,te,e):void 0,W=ge(null),q={focus:()=>{var $;($=W.value)===null||$===void 0||$.focus()},blur:()=>{var $;($=W.value)===null||$===void 0||$.blur()}};return{focus:q.focus,blur:q.blur,inputInstRef:W,uncontrolledValue:u,mergedValue:f,isMounted:zd(),adjustedTo:jn(e),menuInstRef:d,triggerElRef:c,treeMate:x,mergedSize:o,mergedDisabled:s,active:b,mergedStatus:l,handleClear:R,handleFocus:z,handleBlur:F,handleInput:H,handleToggle:N,handleClickOutsideMenu:U,handleCompositionStart:A,handleCompositionEnd:M,handleKeyDown:P,mergedTheme:m,cssVars:n?void 0:te,themeClass:X==null?void 0:X.themeClass,onRender:X==null?void 0:X.onRender,mergedBordered:t,namespace:r,mergedClsPrefix:i}},render(){const{mergedClsPrefix:e}=this;return E("div",{class:`${e}-auto-complete`,ref:"triggerElRef",onKeydown:this.handleKeyDown,onCompositionstart:this.handleCompositionStart,onCompositionend:this.handleCompositionEnd},E(ch,null,{default:()=>[E(dh,null,{default:()=>{if(this.$slots.default)return G_(this.$slots,"default",{handleInput:this.handleInput,handleFocus:this.handleFocus,handleBlur:this.handleBlur,value:this.mergedValue});const{mergedTheme:r}=this;return E(cr,{ref:"inputInstRef",status:this.mergedStatus,theme:r.peers.Input,themeOverrides:r.peerOverrides.Input,bordered:this.mergedBordered,value:this.mergedValue,placeholder:this.placeholder,size:this.mergedSize,disabled:this.mergedDisabled,clearable:this.clearable,loading:this.loading,inputProps:this.inputProps,onClear:this.handleClear,onFocus:this.handleFocus,onUpdateValue:this.handleInput,onBlur:this.handleBlur},{suffix:()=>{var i,n;return(n=(i=this.$slots).suffix)===null||n===void 0?void 0:n.call(i)},prefix:()=>{var i,n;return(n=(i=this.$slots).prefix)===null||n===void 0?void 0:n.call(i)}})}}),E(uh,{show:this.active,to:this.adjustedTo,containerClass:this.namespace,zIndex:this.zIndex,teleportDisabled:this.adjustedTo===jn.tdkey,placement:this.placement,width:"target"},{default:()=>E(Da,{name:"fade-in-scale-up-transition",appear:this.isMounted},{default:()=>{var t;if((t=this.onRender)===null||t===void 0||t.call(this),!this.active)return null;const{menuProps:r}=this;return Ka(E(YN,Object.assign({},r,{clsPrefix:e,ref:"menuInstRef",theme:this.mergedTheme.peers.InternalSelectMenu,themeOverrides:this.mergedTheme.peerOverrides.InternalSelectMenu,"auto-pending":!0,class:[`${e}-auto-complete-menu`,this.themeClass,r==null?void 0:r.class],style:[r==null?void 0:r.style,this.cssVars],treeMate:this.treeMate,multiple:!1,renderLabel:this.renderLabel,renderOption:this.renderOption,size:"medium",onToggle:this.handleToggle}),{empty:()=>{var i,n;return(n=(i=this.$slots).empty)===null||n===void 0?void 0:n.call(i)}}),[[bd,this.handleClickOutsideMenu,void 0,{capture:!0}]])}})})]}))}}),yre=Id&&"loading"in document.createElement("img"),bre=(e={})=>{var t;const{root:r=null}=e;return{hash:`${e.rootMargin||"0px 0px 0px 0px"}-${Array.isArray(e.threshold)?e.threshold.join(","):(t=e.threshold)!==null&&t!==void 0?t:"0"}`,options:Object.assign(Object.assign({},e),{root:(typeof r=="string"?document.querySelector(r):r)||document.documentElement})}},tS=new WeakMap,rS=new WeakMap,iS=new WeakMap,xre=(e,t,r)=>{if(!e)return()=>{};const i=bre(t),{root:n}=i.options;let a;const o=tS.get(n);o?a=o:(a=new Map,tS.set(n,a));let s,l;a.has(i.hash)?(l=a.get(i.hash),l[1].has(e)||(s=l[0],l[1].add(e),s.observe(e))):(s=new IntersectionObserver(u=>{u.forEach(h=>{if(h.isIntersecting){const f=rS.get(h.target),p=iS.get(h.target);f&&f(),p&&(p.value=!0)}})},i.options),s.observe(e),l=[s,new Set([e])],a.set(i.hash,l));let c=!1;const d=()=>{c||(rS.delete(e),iS.delete(e),c=!0,l[1].has(e)&&(l[0].unobserve(e),l[1].delete(e)),l[1].size<=0&&a.delete(i.hash),a.size||tS.delete(n))};return rS.set(e,d),iS.set(e,r),d},wre=e=>{const{borderRadius:t,avatarColor:r,cardColor:i,fontSize:n,heightTiny:a,heightSmall:o,heightMedium:s,heightLarge:l,heightHuge:c,modalColor:d,popoverColor:u}=e;return{borderRadius:t,fontSize:n,border:`2px solid ${i}`,heightTiny:a,heightSmall:o,heightMedium:s,heightLarge:l,heightHuge:c,color:Xs(i,r),colorModal:Xs(d,r),colorPopover:Xs(u,r)}},Sre={name:"Avatar",common:Gr,self:wre},Cre="n-avatar-group",_re=oe("avatar",`
 width: var(--n-merged-size);
 height: var(--n-merged-size);
 color: #FFF;
 font-size: var(--n-font-size);
 display: inline-flex;
 position: relative;
 overflow: hidden;
 text-align: center;
 border: var(--n-border);
 border-radius: var(--n-border-radius);
 --n-merged-color: var(--n-color);
 background-color: var(--n-merged-color);
 transition:
 border-color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
`,[O5(ve("&","--n-merged-color: var(--n-color-modal);")),R5(ve("&","--n-merged-color: var(--n-color-popover);")),ve("img",`
 width: 100%;
 height: 100%;
 `),he("text",`
 white-space: nowrap;
 display: inline-block;
 position: absolute;
 left: 50%;
 top: 50%;
 `),oe("icon",`
 vertical-align: bottom;
 font-size: calc(var(--n-merged-size) - 6px);
 `),he("text","line-height: 1.25")]),Are=Object.assign(Object.assign({},bt.props),{size:[String,Number],src:String,circle:{type:Boolean,default:void 0},objectFit:String,round:{type:Boolean,default:void 0},bordered:{type:Boolean,default:void 0},onError:Function,fallbackSrc:String,intersectionObserverOptions:Object,lazy:Boolean,onLoad:Function,renderPlaceholder:Function,renderFallback:Function,imgProps:Object,color:String}),AT=Ve({name:"Avatar",props:Are,setup(e){const{mergedClsPrefixRef:t,inlineThemeDisabled:r}=mr(e),i=ge(!1);let n=null;const a=ge(null),o=ge(null),s=()=>{const{value:y}=a;if(y&&(n===null||n!==y.innerHTML)){n=y.innerHTML;const{value:b}=o;if(b){const{offsetWidth:x,offsetHeight:S}=b,{offsetWidth:w,offsetHeight:_}=y,C=.9,A=Math.min(x/w*C,S/_*C,1);y.style.transform=`translateX(-50%) translateY(-50%) scale(${A})`}}},l=_t(Cre,null),c=re(()=>{const{size:y}=e;if(y)return y;const{size:b}=l||{};return b||"medium"}),d=bt("Avatar","-avatar",_re,Sre,e,t),u=_t(QN,null),h=re(()=>{if(l)return!0;const{round:y,circle:b}=e;return y!==void 0||b!==void 0?y||b:u?u.roundRef.value:!1}),f=re(()=>l?!0:e.bordered||!1),p=re(()=>{const y=c.value,b=h.value,x=f.value,{color:S}=e,{self:{borderRadius:w,fontSize:_,color:C,border:A,colorModal:M,colorPopover:P},common:{cubicBezierEaseInOut:T}}=d.value;let R;return typeof y=="number"?R=`${y}px`:R=d.value.self[Ze("height",y)],{"--n-font-size":_,"--n-border":x?A:"none","--n-border-radius":b?"50%":w,"--n-color":S||C,"--n-color-modal":S||M,"--n-color-popover":S||P,"--n-bezier":T,"--n-merged-size":`var(--n-avatar-size-override, ${R})`}}),v=r?Dr("avatar",re(()=>{const y=c.value,b=h.value,x=f.value,{color:S}=e;let w="";return y&&(typeof y=="number"?w+=`a${y}`:w+=y[0]),b&&(w+="b"),x&&(w+="c"),S&&(w+=Wv(S)),w}),p,e):void 0,m=ge(!e.lazy);Or(()=>{if(e.lazy&&e.intersectionObserverOptions){let y;const b=Qa(()=>{y==null||y(),y=void 0,e.lazy&&(y=xre(o.value,e.intersectionObserverOptions,m))});na(()=>{b(),y==null||y()})}}),tr(()=>{var y;return e.src||((y=e.imgProps)===null||y===void 0?void 0:y.src)},()=>{i.value=!1});const g=ge(!e.lazy);return{textRef:a,selfRef:o,mergedRoundRef:h,mergedClsPrefix:t,fitTextTransform:s,cssVars:r?void 0:p,themeClass:v==null?void 0:v.themeClass,onRender:v==null?void 0:v.onRender,hasLoadError:i,shouldStartLoading:m,loaded:g,mergedOnError:y=>{if(!m.value)return;i.value=!0;const{onError:b,imgProps:{onError:x}={}}=e;b==null||b(y),x==null||x(y)},mergedOnLoad:y=>{const{onLoad:b,imgProps:{onLoad:x}={}}=e;b==null||b(y),x==null||x(y),g.value=!0}}},render(){var e,t;const{$slots:r,src:i,mergedClsPrefix:n,lazy:a,onRender:o,loaded:s,hasLoadError:l,imgProps:c={}}=this;o==null||o();let d;const u=!s&&!l&&(this.renderPlaceholder?this.renderPlaceholder():(t=(e=this.$slots).placeholder)===null||t===void 0?void 0:t.call(e));return this.hasLoadError?d=this.renderFallback?this.renderFallback():Sr(r.fallback,()=>[E("img",{src:this.fallbackSrc,style:{objectFit:this.objectFit}})]):d=ei(r.default,h=>{if(h)return E(Ks,{onResize:this.fitTextTransform},{default:()=>E("span",{ref:"textRef",class:`${n}-avatar__text`},h)});if(i||c.src){const f=this.src||c.src;return E("img",Object.assign(Object.assign({},c),{loading:yre&&!this.intersectionObserverOptions&&a?"lazy":"eager",src:a&&this.intersectionObserverOptions?this.shouldStartLoading?f:void 0:f,"data-image-src":f,onLoad:this.mergedOnLoad,onError:this.mergedOnError,style:[c.style||"",{objectFit:this.objectFit},u?{height:"0",width:"0",visibility:"hidden",position:"absolute"}:""]}))}}),E("span",{ref:"selfRef",class:[`${n}-avatar`,this.themeClass],style:this.cssVars},d,a&&u)}}),Mre={fontWeightActive:"400"},Ere=e=>{const{fontSize:t,textColor3:r,textColor2:i,borderRadius:n,buttonColor2Hover:a,buttonColor2Pressed:o}=e;return Object.assign(Object.assign({},Mre),{fontSize:t,itemLineHeight:"1.25",itemTextColor:r,itemTextColorHover:i,itemTextColorPressed:i,itemTextColorActive:i,itemBorderRadius:n,itemColorHover:a,itemColorPressed:o,separatorColor:r})},Tre={name:"Breadcrumb",common:Gr,self:Ere},Pre=oe("breadcrumb",`
 white-space: nowrap;
 cursor: default;
 line-height: var(--n-item-line-height);
`,[ve("ul",`
 list-style: none;
 padding: 0;
 margin: 0;
 `),ve("a",`
 color: inherit;
 text-decoration: inherit;
 `),oe("breadcrumb-item",`
 font-size: var(--n-font-size);
 transition: color .3s var(--n-bezier);
 display: inline-flex;
 align-items: center;
 `,[oe("icon",`
 font-size: 18px;
 vertical-align: -.2em;
 transition: color .3s var(--n-bezier);
 color: var(--n-item-text-color);
 `),ve("&:not(:last-child)",[xe("clickable",[he("link",`
 cursor: pointer;
 `,[ve("&:hover",`
 background-color: var(--n-item-color-hover);
 `),ve("&:active",`
 background-color: var(--n-item-color-pressed); 
 `)])])]),he("link",`
 padding: 4px;
 border-radius: var(--n-item-border-radius);
 transition:
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
 color: var(--n-item-text-color);
 position: relative;
 `,[ve("&:hover",`
 color: var(--n-item-text-color-hover);
 `,[oe("icon",`
 color: var(--n-item-text-color-hover);
 `)]),ve("&:active",`
 color: var(--n-item-text-color-pressed);
 `,[oe("icon",`
 color: var(--n-item-text-color-pressed);
 `)])]),he("separator",`
 margin: 0 8px;
 color: var(--n-separator-color);
 transition: color .3s var(--n-bezier);
 user-select: none;
 -webkit-user-select: none;
 `),ve("&:last-child",[he("link",`
 font-weight: var(--n-font-weight-active);
 cursor: unset;
 color: var(--n-item-text-color-active);
 `,[oe("icon",`
 color: var(--n-item-text-color-active);
 `)]),he("separator",`
 display: none;
 `)])])]),oU="n-breadcrumb",Dre=Object.assign(Object.assign({},bt.props),{separator:{type:String,default:"/"}}),Ore=Ve({name:"Breadcrumb",props:Dre,setup(e){const{mergedClsPrefixRef:t,inlineThemeDisabled:r}=mr(e),i=bt("Breadcrumb","-breadcrumb",Pre,Tre,e,t);br(oU,{separatorRef:pt(e,"separator"),mergedClsPrefixRef:t});const n=re(()=>{const{common:{cubicBezierEaseInOut:o},self:{separatorColor:s,itemTextColor:l,itemTextColorHover:c,itemTextColorPressed:d,itemTextColorActive:u,fontSize:h,fontWeightActive:f,itemBorderRadius:p,itemColorHover:v,itemColorPressed:m,itemLineHeight:g}}=i.value;return{"--n-font-size":h,"--n-bezier":o,"--n-item-text-color":l,"--n-item-text-color-hover":c,"--n-item-text-color-pressed":d,"--n-item-text-color-active":u,"--n-separator-color":s,"--n-item-color-hover":v,"--n-item-color-pressed":m,"--n-item-border-radius":p,"--n-font-weight-active":f,"--n-item-line-height":g}}),a=r?Dr("breadcrumb",void 0,n,e):void 0;return{mergedClsPrefix:t,cssVars:r?void 0:n,themeClass:a==null?void 0:a.themeClass,onRender:a==null?void 0:a.onRender}},render(){var e;return(e=this.onRender)===null||e===void 0||e.call(this),E("nav",{class:[`${this.mergedClsPrefix}-breadcrumb`,this.themeClass],style:this.cssVars,"aria-label":"Breadcrumb"},E("ul",null,this.$slots))}}),Rre=(e=Id?window:null)=>{const t=()=>{const{hash:n,host:a,hostname:o,href:s,origin:l,pathname:c,port:d,protocol:u,search:h}=(e==null?void 0:e.location)||{};return{hash:n,host:a,hostname:o,href:s,origin:l,pathname:c,port:d,protocol:u,search:h}},r=()=>{i.value=t()},i=ge(t());return Or(()=>{e&&(e.addEventListener("popstate",r),e.addEventListener("hashchange",r))}),Eg(()=>{e&&(e.removeEventListener("popstate",r),e.removeEventListener("hashchange",r))}),i},Ire={separator:String,href:String,clickable:{type:Boolean,default:!0},onClick:Function},zre=Ve({name:"BreadcrumbItem",props:Ire,setup(e,{slots:t}){const r=_t(oU,null);if(!r)return()=>null;const{separatorRef:i,mergedClsPrefixRef:n}=r,a=Rre(),o=re(()=>e.href?"a":"span"),s=re(()=>a.value.href===e.href?"location":null);return()=>{const{value:l}=n;return E("li",{class:[`${l}-breadcrumb-item`,e.clickable&&`${l}-breadcrumb-item--clickable`]},E(o.value,{class:`${l}-breadcrumb-item__link`,"aria-current":s.value,href:e.href,onClick:e.onClick},t),E("span",{class:`${l}-breadcrumb-item__separator`,"aria-hidden":"true"},Sr(t.separator,()=>{var c;return[(c=e.separator)!==null&&c!==void 0?c:i.value]})))}}});function $d(e){return Xs(e,[255,255,255,.16])}function E0(e){return Xs(e,[0,0,0,.12])}const sU="n-button-group",kre={paddingTiny:"0 6px",paddingSmall:"0 10px",paddingMedium:"0 14px",paddingLarge:"0 18px",paddingRoundTiny:"0 10px",paddingRoundSmall:"0 14px",paddingRoundMedium:"0 18px",paddingRoundLarge:"0 22px",iconMarginTiny:"6px",iconMarginSmall:"6px",iconMarginMedium:"6px",iconMarginLarge:"6px",iconSizeTiny:"14px",iconSizeSmall:"18px",iconSizeMedium:"18px",iconSizeLarge:"20px",rippleDuration:".6s"},Lre=e=>{const{heightTiny:t,heightSmall:r,heightMedium:i,heightLarge:n,borderRadius:a,fontSizeTiny:o,fontSizeSmall:s,fontSizeMedium:l,fontSizeLarge:c,opacityDisabled:d,textColor2:u,textColor3:h,primaryColorHover:f,primaryColorPressed:p,borderColor:v,primaryColor:m,baseColor:g,infoColor:y,infoColorHover:b,infoColorPressed:x,successColor:S,successColorHover:w,successColorPressed:_,warningColor:C,warningColorHover:A,warningColorPressed:M,errorColor:P,errorColorHover:T,errorColorPressed:R,fontWeight:z,buttonColor2:F,buttonColor2Hover:H,buttonColor2Pressed:N,fontWeightStrong:U}=e;return Object.assign(Object.assign({},kre),{heightTiny:t,heightSmall:r,heightMedium:i,heightLarge:n,borderRadiusTiny:a,borderRadiusSmall:a,borderRadiusMedium:a,borderRadiusLarge:a,fontSizeTiny:o,fontSizeSmall:s,fontSizeMedium:l,fontSizeLarge:c,opacityDisabled:d,colorOpacitySecondary:"0.16",colorOpacitySecondaryHover:"0.22",colorOpacitySecondaryPressed:"0.28",colorSecondary:F,colorSecondaryHover:H,colorSecondaryPressed:N,colorTertiary:F,colorTertiaryHover:H,colorTertiaryPressed:N,colorQuaternary:"#0000",colorQuaternaryHover:H,colorQuaternaryPressed:N,color:"#0000",colorHover:"#0000",colorPressed:"#0000",colorFocus:"#0000",colorDisabled:"#0000",textColor:u,textColorTertiary:h,textColorHover:f,textColorPressed:p,textColorFocus:f,textColorDisabled:u,textColorText:u,textColorTextHover:f,textColorTextPressed:p,textColorTextFocus:f,textColorTextDisabled:u,textColorGhost:u,textColorGhostHover:f,textColorGhostPressed:p,textColorGhostFocus:f,textColorGhostDisabled:u,border:`1px solid ${v}`,borderHover:`1px solid ${f}`,borderPressed:`1px solid ${p}`,borderFocus:`1px solid ${f}`,borderDisabled:`1px solid ${v}`,rippleColor:m,colorPrimary:m,colorHoverPrimary:f,colorPressedPrimary:p,colorFocusPrimary:f,colorDisabledPrimary:m,textColorPrimary:g,textColorHoverPrimary:g,textColorPressedPrimary:g,textColorFocusPrimary:g,textColorDisabledPrimary:g,textColorTextPrimary:m,textColorTextHoverPrimary:f,textColorTextPressedPrimary:p,textColorTextFocusPrimary:f,textColorTextDisabledPrimary:u,textColorGhostPrimary:m,textColorGhostHoverPrimary:f,textColorGhostPressedPrimary:p,textColorGhostFocusPrimary:f,textColorGhostDisabledPrimary:m,borderPrimary:`1px solid ${m}`,borderHoverPrimary:`1px solid ${f}`,borderPressedPrimary:`1px solid ${p}`,borderFocusPrimary:`1px solid ${f}`,borderDisabledPrimary:`1px solid ${m}`,rippleColorPrimary:m,colorInfo:y,colorHoverInfo:b,colorPressedInfo:x,colorFocusInfo:b,colorDisabledInfo:y,textColorInfo:g,textColorHoverInfo:g,textColorPressedInfo:g,textColorFocusInfo:g,textColorDisabledInfo:g,textColorTextInfo:y,textColorTextHoverInfo:b,textColorTextPressedInfo:x,textColorTextFocusInfo:b,textColorTextDisabledInfo:u,textColorGhostInfo:y,textColorGhostHoverInfo:b,textColorGhostPressedInfo:x,textColorGhostFocusInfo:b,textColorGhostDisabledInfo:y,borderInfo:`1px solid ${y}`,borderHoverInfo:`1px solid ${b}`,borderPressedInfo:`1px solid ${x}`,borderFocusInfo:`1px solid ${b}`,borderDisabledInfo:`1px solid ${y}`,rippleColorInfo:y,colorSuccess:S,colorHoverSuccess:w,colorPressedSuccess:_,colorFocusSuccess:w,colorDisabledSuccess:S,textColorSuccess:g,textColorHoverSuccess:g,textColorPressedSuccess:g,textColorFocusSuccess:g,textColorDisabledSuccess:g,textColorTextSuccess:S,textColorTextHoverSuccess:w,textColorTextPressedSuccess:_,textColorTextFocusSuccess:w,textColorTextDisabledSuccess:u,textColorGhostSuccess:S,textColorGhostHoverSuccess:w,textColorGhostPressedSuccess:_,textColorGhostFocusSuccess:w,textColorGhostDisabledSuccess:S,borderSuccess:`1px solid ${S}`,borderHoverSuccess:`1px solid ${w}`,borderPressedSuccess:`1px solid ${_}`,borderFocusSuccess:`1px solid ${w}`,borderDisabledSuccess:`1px solid ${S}`,rippleColorSuccess:S,colorWarning:C,colorHoverWarning:A,colorPressedWarning:M,colorFocusWarning:A,colorDisabledWarning:C,textColorWarning:g,textColorHoverWarning:g,textColorPressedWarning:g,textColorFocusWarning:g,textColorDisabledWarning:g,textColorTextWarning:C,textColorTextHoverWarning:A,textColorTextPressedWarning:M,textColorTextFocusWarning:A,textColorTextDisabledWarning:u,textColorGhostWarning:C,textColorGhostHoverWarning:A,textColorGhostPressedWarning:M,textColorGhostFocusWarning:A,textColorGhostDisabledWarning:C,borderWarning:`1px solid ${C}`,borderHoverWarning:`1px solid ${A}`,borderPressedWarning:`1px solid ${M}`,borderFocusWarning:`1px solid ${A}`,borderDisabledWarning:`1px solid ${C}`,rippleColorWarning:C,colorError:P,colorHoverError:T,colorPressedError:R,colorFocusError:T,colorDisabledError:P,textColorError:g,textColorHoverError:g,textColorPressedError:g,textColorFocusError:g,textColorDisabledError:g,textColorTextError:P,textColorTextHoverError:T,textColorTextPressedError:R,textColorTextFocusError:T,textColorTextDisabledError:u,textColorGhostError:P,textColorGhostHoverError:T,textColorGhostPressedError:R,textColorGhostFocusError:T,textColorGhostDisabledError:P,borderError:`1px solid ${P}`,borderHoverError:`1px solid ${T}`,borderPressedError:`1px solid ${R}`,borderFocusError:`1px solid ${T}`,borderDisabledError:`1px solid ${P}`,rippleColorError:P,waveOpacity:"0.6",fontWeight:z,fontWeightStrong:U})},zg={name:"Button",common:Gr,self:Lre},Bre=ve([oe("button",`
 margin: 0;
 font-weight: var(--n-font-weight);
 line-height: 1;
 font-family: inherit;
 padding: var(--n-padding);
 height: var(--n-height);
 font-size: var(--n-font-size);
 border-radius: var(--n-border-radius);
 color: var(--n-text-color);
 background-color: var(--n-color);
 width: var(--n-width);
 white-space: nowrap;
 outline: none;
 position: relative;
 z-index: auto;
 border: none;
 display: inline-flex;
 flex-wrap: nowrap;
 flex-shrink: 0;
 align-items: center;
 justify-content: center;
 user-select: none;
 -webkit-user-select: none;
 text-align: center;
 cursor: pointer;
 text-decoration: none;
 transition:
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 opacity .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 `,[xe("color",[he("border",{borderColor:"var(--n-border-color)"}),xe("disabled",[he("border",{borderColor:"var(--n-border-color-disabled)"})]),yr("disabled",[ve("&:focus",[he("state-border",{borderColor:"var(--n-border-color-focus)"})]),ve("&:hover",[he("state-border",{borderColor:"var(--n-border-color-hover)"})]),ve("&:active",[he("state-border",{borderColor:"var(--n-border-color-pressed)"})]),xe("pressed",[he("state-border",{borderColor:"var(--n-border-color-pressed)"})])])]),xe("disabled",{backgroundColor:"var(--n-color-disabled)",color:"var(--n-text-color-disabled)"},[he("border",{border:"var(--n-border-disabled)"})]),yr("disabled",[ve("&:focus",{backgroundColor:"var(--n-color-focus)",color:"var(--n-text-color-focus)"},[he("state-border",{border:"var(--n-border-focus)"})]),ve("&:hover",{backgroundColor:"var(--n-color-hover)",color:"var(--n-text-color-hover)"},[he("state-border",{border:"var(--n-border-hover)"})]),ve("&:active",{backgroundColor:"var(--n-color-pressed)",color:"var(--n-text-color-pressed)"},[he("state-border",{border:"var(--n-border-pressed)"})]),xe("pressed",{backgroundColor:"var(--n-color-pressed)",color:"var(--n-text-color-pressed)"},[he("state-border",{border:"var(--n-border-pressed)"})])]),xe("loading","cursor: wait;"),oe("base-wave",`
 pointer-events: none;
 top: 0;
 right: 0;
 bottom: 0;
 left: 0;
 animation-iteration-count: 1;
 animation-duration: var(--n-ripple-duration);
 animation-timing-function: var(--n-bezier-ease-out), var(--n-bezier-ease-out);
 `,[xe("active",{zIndex:1,animationName:"button-wave-spread, button-wave-opacity"})]),Id&&"MozBoxSizing"in document.createElement("div").style?ve("&::moz-focus-inner",{border:0}):null,he("border, state-border",`
 position: absolute;
 left: 0;
 top: 0;
 right: 0;
 bottom: 0;
 border-radius: inherit;
 transition: border-color .3s var(--n-bezier);
 pointer-events: none;
 `),he("border",{border:"var(--n-border)"}),he("state-border",{border:"var(--n-border)",borderColor:"#0000",zIndex:1}),he("icon",`
 margin: var(--n-icon-margin);
 margin-left: 0;
 height: var(--n-icon-size);
 width: var(--n-icon-size);
 max-width: var(--n-icon-size);
 font-size: var(--n-icon-size);
 position: relative;
 flex-shrink: 0;
 `,[oe("icon-slot",`
 height: var(--n-icon-size);
 width: var(--n-icon-size);
 position: absolute;
 left: 0;
 top: 50%;
 transform: translateY(-50%);
 display: flex;
 align-items: center;
 justify-content: center;
 `,[Sd({top:"50%",originalTransform:"translateY(-50%)"})]),ere()]),he("content",`
 display: flex;
 align-items: center;
 flex-wrap: nowrap;
 min-width: 0;
 `,[ve("~",[he("icon",{margin:"var(--n-icon-margin)",marginRight:0})])]),xe("block",`
 display: flex;
 width: 100%;
 `),xe("dashed",[he("border, state-border",{borderStyle:"dashed !important"})]),xe("disabled",{cursor:"not-allowed",opacity:"var(--n-opacity-disabled)"})]),ve("@keyframes button-wave-spread",{from:{boxShadow:"0 0 0.5px 0 var(--n-ripple-color)"},to:{boxShadow:"0 0 0.5px 4.5px var(--n-ripple-color)"}}),ve("@keyframes button-wave-opacity",{from:{opacity:"var(--n-wave-opacity)"},to:{opacity:0}})]),Fre=Object.assign(Object.assign({},bt.props),{color:String,textColor:String,text:Boolean,block:Boolean,loading:Boolean,disabled:Boolean,circle:Boolean,size:String,ghost:Boolean,round:Boolean,secondary:Boolean,tertiary:Boolean,quaternary:Boolean,strong:Boolean,focusable:{type:Boolean,default:!0},keyboard:{type:Boolean,default:!0},tag:{type:String,default:"button"},type:{type:String,default:"default"},dashed:Boolean,renderIcon:Function,iconPlacement:{type:String,default:"left"},attrType:{type:String,default:"button"},bordered:{type:Boolean,default:!0},onClick:[Function,Array],nativeFocusBehavior:{type:Boolean,default:!iU}}),li=Ve({name:"Button",props:Fre,setup(e){const t=ge(null),r=ge(null),i=ge(!1),n=$i(()=>!e.quaternary&&!e.tertiary&&!e.secondary&&!e.text&&(!e.color||e.ghost||e.dashed)&&e.bordered),a=_t(sU,{}),{mergedSizeRef:o}=cl({},{defaultSize:"medium",mergedSize:x=>{const{size:S}=e;if(S)return S;const{size:w}=a;if(w)return w;const{mergedSize:_}=x||{};return _?_.value:"medium"}}),s=re(()=>e.focusable&&!e.disabled),l=x=>{var S;s.value||x.preventDefault(),!e.nativeFocusBehavior&&(x.preventDefault(),!e.disabled&&s.value&&((S=t.value)===null||S===void 0||S.focus({preventScroll:!0})))},c=x=>{var S;if(!e.disabled&&!e.loading){const{onClick:w}=e;w&&ct(w,x),e.text||(S=r.value)===null||S===void 0||S.play()}},d=x=>{switch(x.key){case"Enter":if(!e.keyboard)return;i.value=!1}},u=x=>{switch(x.key){case"Enter":if(!e.keyboard||e.loading){x.preventDefault();return}i.value=!0}},h=()=>{i.value=!1},{inlineThemeDisabled:f,mergedClsPrefixRef:p,mergedRtlRef:v}=mr(e),m=bt("Button","-button",Bre,zg,e,p),g=Ja("Button",v,p),y=re(()=>{const x=m.value,{common:{cubicBezierEaseInOut:S,cubicBezierEaseOut:w},self:_}=x,{rippleDuration:C,opacityDisabled:A,fontWeight:M,fontWeightStrong:P}=_,T=o.value,{dashed:R,type:z,ghost:F,text:H,color:N,round:U,circle:ie,textColor:te,secondary:X,tertiary:W,quaternary:q,strong:$}=e,le={"font-weight":$?P:M};let ee={"--n-color":"initial","--n-color-hover":"initial","--n-color-pressed":"initial","--n-color-focus":"initial","--n-color-disabled":"initial","--n-ripple-color":"initial","--n-text-color":"initial","--n-text-color-hover":"initial","--n-text-color-pressed":"initial","--n-text-color-focus":"initial","--n-text-color-disabled":"initial"};const Q=z==="tertiary",ne=z==="default",V=Q?"default":z;if(H){const fe=te||N;ee={"--n-color":"#0000","--n-color-hover":"#0000","--n-color-pressed":"#0000","--n-color-focus":"#0000","--n-color-disabled":"#0000","--n-ripple-color":"#0000","--n-text-color":fe||_[Ze("textColorText",V)],"--n-text-color-hover":fe?$d(fe):_[Ze("textColorTextHover",V)],"--n-text-color-pressed":fe?E0(fe):_[Ze("textColorTextPressed",V)],"--n-text-color-focus":fe?$d(fe):_[Ze("textColorTextHover",V)],"--n-text-color-disabled":fe||_[Ze("textColorTextDisabled",V)]}}else if(F||R){const fe=te||N;ee={"--n-color":"#0000","--n-color-hover":"#0000","--n-color-pressed":"#0000","--n-color-focus":"#0000","--n-color-disabled":"#0000","--n-ripple-color":N||_[Ze("rippleColor",V)],"--n-text-color":fe||_[Ze("textColorGhost",V)],"--n-text-color-hover":fe?$d(fe):_[Ze("textColorGhostHover",V)],"--n-text-color-pressed":fe?E0(fe):_[Ze("textColorGhostPressed",V)],"--n-text-color-focus":fe?$d(fe):_[Ze("textColorGhostHover",V)],"--n-text-color-disabled":fe||_[Ze("textColorGhostDisabled",V)]}}else if(X){const fe=ne?_.textColor:Q?_.textColorTertiary:_[Ze("color",V)],B=N||fe,D=z!=="default"&&z!=="tertiary";ee={"--n-color":D?Yt(B,{alpha:Number(_.colorOpacitySecondary)}):_.colorSecondary,"--n-color-hover":D?Yt(B,{alpha:Number(_.colorOpacitySecondaryHover)}):_.colorSecondaryHover,"--n-color-pressed":D?Yt(B,{alpha:Number(_.colorOpacitySecondaryPressed)}):_.colorSecondaryPressed,"--n-color-focus":D?Yt(B,{alpha:Number(_.colorOpacitySecondaryHover)}):_.colorSecondaryHover,"--n-color-disabled":_.colorSecondary,"--n-ripple-color":"#0000","--n-text-color":B,"--n-text-color-hover":B,"--n-text-color-pressed":B,"--n-text-color-focus":B,"--n-text-color-disabled":B}}else if(W||q){const fe=ne?_.textColor:Q?_.textColorTertiary:_[Ze("color",V)],B=N||fe;W?(ee["--n-color"]=_.colorTertiary,ee["--n-color-hover"]=_.colorTertiaryHover,ee["--n-color-pressed"]=_.colorTertiaryPressed,ee["--n-color-focus"]=_.colorSecondaryHover,ee["--n-color-disabled"]=_.colorTertiary):(ee["--n-color"]=_.colorQuaternary,ee["--n-color-hover"]=_.colorQuaternaryHover,ee["--n-color-pressed"]=_.colorQuaternaryPressed,ee["--n-color-focus"]=_.colorQuaternaryHover,ee["--n-color-disabled"]=_.colorQuaternary),ee["--n-ripple-color"]="#0000",ee["--n-text-color"]=B,ee["--n-text-color-hover"]=B,ee["--n-text-color-pressed"]=B,ee["--n-text-color-focus"]=B,ee["--n-text-color-disabled"]=B}else ee={"--n-color":N||_[Ze("color",V)],"--n-color-hover":N?$d(N):_[Ze("colorHover",V)],"--n-color-pressed":N?E0(N):_[Ze("colorPressed",V)],"--n-color-focus":N?$d(N):_[Ze("colorFocus",V)],"--n-color-disabled":N||_[Ze("colorDisabled",V)],"--n-ripple-color":N||_[Ze("rippleColor",V)],"--n-text-color":te||(N?_.textColorPrimary:Q?_.textColorTertiary:_[Ze("textColor",V)]),"--n-text-color-hover":te||(N?_.textColorHoverPrimary:_[Ze("textColorHover",V)]),"--n-text-color-pressed":te||(N?_.textColorPressedPrimary:_[Ze("textColorPressed",V)]),"--n-text-color-focus":te||(N?_.textColorFocusPrimary:_[Ze("textColorFocus",V)]),"--n-text-color-disabled":te||(N?_.textColorDisabledPrimary:_[Ze("textColorDisabled",V)])};let de={"--n-border":"initial","--n-border-hover":"initial","--n-border-pressed":"initial","--n-border-focus":"initial","--n-border-disabled":"initial"};H?de={"--n-border":"none","--n-border-hover":"none","--n-border-pressed":"none","--n-border-focus":"none","--n-border-disabled":"none"}:de={"--n-border":_[Ze("border",V)],"--n-border-hover":_[Ze("borderHover",V)],"--n-border-pressed":_[Ze("borderPressed",V)],"--n-border-focus":_[Ze("borderFocus",V)],"--n-border-disabled":_[Ze("borderDisabled",V)]};const{[Ze("height",T)]:me,[Ze("fontSize",T)]:Ce,[Ze("padding",T)]:G,[Ze("paddingRound",T)]:Z,[Ze("iconSize",T)]:ue,[Ze("borderRadius",T)]:Se,[Ze("iconMargin",T)]:we,waveOpacity:_e}=_,Ee={"--n-width":ie&&!H?me:"initial","--n-height":H?"initial":me,"--n-font-size":Ce,"--n-padding":ie||H?"initial":U?Z:G,"--n-icon-size":ue,"--n-icon-margin":we,"--n-border-radius":H?"initial":ie||U?me:Se};return Object.assign(Object.assign(Object.assign(Object.assign({"--n-bezier":S,"--n-bezier-ease-out":w,"--n-ripple-duration":C,"--n-opacity-disabled":A,"--n-wave-opacity":_e},le),ee),de),Ee)}),b=f?Dr("button",re(()=>{let x="";const{dashed:S,type:w,ghost:_,text:C,color:A,round:M,circle:P,textColor:T,secondary:R,tertiary:z,quaternary:F,strong:H}=e;S&&(x+="a"),_&&(x+="b"),C&&(x+="c"),M&&(x+="d"),P&&(x+="e"),R&&(x+="f"),z&&(x+="g"),F&&(x+="h"),H&&(x+="i"),A&&(x+="j"+Wv(A)),T&&(x+="k"+Wv(T));const{value:N}=o;return x+="l"+N[0],x+="m"+w[0],x}),y,e):void 0;return{selfElRef:t,waveElRef:r,mergedClsPrefix:p,mergedFocusable:s,mergedSize:o,showBorder:n,enterPressed:i,rtlEnabled:g,handleMousedown:l,handleKeydown:u,handleBlur:h,handleKeyup:d,handleClick:c,customColorCssVars:re(()=>{const{color:x}=e;if(!x)return null;const S=$d(x);return{"--n-border-color":x,"--n-border-color-hover":S,"--n-border-color-pressed":E0(x),"--n-border-color-focus":S,"--n-border-color-disabled":x}}),cssVars:f?void 0:y,themeClass:b==null?void 0:b.themeClass,onRender:b==null?void 0:b.onRender}},render(){const{mergedClsPrefix:e,tag:t,onRender:r}=this;r==null||r();const i=ei(this.$slots.default,n=>n&&E("span",{class:`${e}-button__content`},n));return E(t,{ref:"selfElRef",class:[this.themeClass,`${e}-button`,`${e}-button--${this.type}-type`,`${e}-button--${this.mergedSize}-type`,this.rtlEnabled&&`${e}-button--rtl`,this.disabled&&`${e}-button--disabled`,this.block&&`${e}-button--block`,this.enterPressed&&`${e}-button--pressed`,!this.text&&this.dashed&&`${e}-button--dashed`,this.color&&`${e}-button--color`,this.secondary&&`${e}-button--secondary`,this.loading&&`${e}-button--loading`,this.ghost&&`${e}-button--ghost`],tabindex:this.mergedFocusable?0:-1,type:this.attrType,style:this.cssVars,disabled:this.disabled,onClick:this.handleClick,onBlur:this.handleBlur,onMousedown:this.handleMousedown,onKeyup:this.handleKeyup,onKeydown:this.handleKeydown},this.iconPlacement==="right"&&i,E(xT,{width:!0},{default:()=>ei(this.$slots.icon,n=>(this.loading||this.renderIcon||n)&&E("span",{class:`${e}-button__icon`,style:{margin:Bf(this.$slots.default)?"0":""}},E(zp,null,{default:()=>this.loading?E(Ig,{clsPrefix:e,key:"loading",class:`${e}-icon-slot`,strokeWidth:20}):E("div",{key:"icon",class:`${e}-icon-slot`,role:"none"},this.renderIcon?this.renderIcon():n)})))}),this.iconPlacement==="left"&&i,this.text?null:E(zte,{ref:"waveElRef",clsPrefix:e}),this.showBorder?E("div",{"aria-hidden":!0,class:`${e}-button__border`,style:this.customColorCssVars}):null,this.showBorder?E("div",{"aria-hidden":!0,class:`${e}-button__state-border`,style:this.customColorCssVars}):null)}}),hd=li,Mi="0!important",lU="-1px!important";function Rh(e){return xe(e+"-type",[ve("& +",[oe("button",{},[xe(e+"-type",[he("border",{borderLeftWidth:Mi}),he("state-border",{left:lU})])])])])}function Ih(e){return xe(e+"-type",[ve("& +",[oe("button",[xe(e+"-type",[he("border",{borderTopWidth:Mi}),he("state-border",{top:lU})])])])])}const Nre=oe("button-group",`
 flex-wrap: nowrap;
 display: inline-flex;
 position: relative;
`,[yr("vertical",{flexDirection:"row"},[yr("rtl",[oe("button",[ve("&:first-child:not(:last-child)",`
 margin-right: ${Mi};
 border-top-right-radius: ${Mi};
 border-bottom-right-radius: ${Mi};
 `),ve("&:last-child:not(:first-child)",`
 margin-left: ${Mi};
 border-top-left-radius: ${Mi};
 border-bottom-left-radius: ${Mi};
 `),ve("&:not(:first-child):not(:last-child)",`
 margin-left: ${Mi};
 margin-right: ${Mi};
 border-radius: ${Mi};
 `),Rh("default"),xe("ghost",[Rh("primary"),Rh("info"),Rh("success"),Rh("warning"),Rh("error")])])])]),xe("vertical",{flexDirection:"column"},[oe("button",[ve("&:first-child:not(:last-child)",`
 margin-bottom: ${Mi};
 margin-left: ${Mi};
 margin-right: ${Mi};
 border-bottom-left-radius: ${Mi};
 border-bottom-right-radius: ${Mi};
 `),ve("&:last-child:not(:first-child)",`
 margin-top: ${Mi};
 margin-left: ${Mi};
 margin-right: ${Mi};
 border-top-left-radius: ${Mi};
 border-top-right-radius: ${Mi};
 `),ve("&:not(:first-child):not(:last-child)",`
 margin: ${Mi};
 border-radius: ${Mi};
 `),Ih("default"),xe("ghost",[Ih("primary"),Ih("info"),Ih("success"),Ih("warning"),Ih("error")])])])]),Ure={size:{type:String,default:void 0},vertical:Boolean},jre=Ve({name:"ButtonGroup",props:Ure,setup(e){const{mergedClsPrefixRef:t,mergedRtlRef:r}=mr(e);return gh("-button-group",Nre,t),br(sU,e),{rtlEnabled:Ja("ButtonGroup",r,t),mergedClsPrefix:t}},render(){const{mergedClsPrefix:e}=this;return E("div",{class:[`${e}-button-group`,this.rtlEnabled&&`${e}-button-group--rtl`,this.vertical&&`${e}-button-group--vertical`],role:"group"},this.$slots)}}),tx=1901,Qu=40,Vre={date:JZ,month:Rg,year:jN,quarter:UN};function Hre(e){return(t,r)=>{const i=(e+1)%7;return See(t,r,{weekStartsOn:i})}}function Aa(e,t,r,i=0){return(r==="week"?Hre(i):Vre[r])(e,t)}function nS(e,t,r,i,n,a){return n==="date"?Wre(e,t,r,i):Gre(e,t,r,i,a)}function Wre(e,t,r,i){let n=!1,a=!1,o=!1;Array.isArray(r)&&(r[0]<e&&e<r[1]&&(n=!0),Aa(r[0],e,"date")&&(a=!0),Aa(r[1],e,"date")&&(o=!0));const s=r!==null&&(Array.isArray(r)?Aa(r[0],e,"date")||Aa(r[1],e,"date"):Aa(r,e,"date"));return{type:"date",dateObject:{date:wo(e),month:fi(e),year:Ai(e)},inCurrentMonth:Rg(e,t),isCurrentDate:Aa(i,e,"date"),inSpan:n,inSelectedWeek:!1,startOfSpan:a,endOfSpan:o,selected:s,ts:gt(e)}}function cU(e,t,r){const i=new Date(2e3,e,1).getTime();return ai(i,t,{locale:r})}function dU(e,t,r){const i=new Date(e,1,1).getTime();return ai(i,t,{locale:r})}function uU(e,t,r){const i=new Date(2e3,e*3-2,1).getTime();return ai(i,t,{locale:r})}function Gre(e,t,r,i,n){let a=!1,o=!1,s=!1;Array.isArray(r)&&(r[0]<e&&e<r[1]&&(a=!0),Aa(r[0],e,"week",n)&&(o=!0),Aa(r[1],e,"week",n)&&(s=!0));const l=r!==null&&(Array.isArray(r)?Aa(r[0],e,"week",n)||Aa(r[1],e,"week",n):Aa(r,e,"week",n));return{type:"date",dateObject:{date:wo(e),month:fi(e),year:Ai(e)},inCurrentMonth:Rg(e,t),isCurrentDate:Aa(i,e,"date"),inSpan:a,startOfSpan:o,endOfSpan:s,selected:!1,inSelectedWeek:l,ts:gt(e)}}function $re(e,t,r,{monthFormat:i}){return{type:"month",monthFormat:i,dateObject:{month:fi(e),year:Ai(e)},isCurrent:Rg(r,e),selected:t!==null&&Aa(t,e,"month"),ts:gt(e)}}function qre(e,t,r,{yearFormat:i}){return{type:"year",yearFormat:i,dateObject:{year:Ai(e)},isCurrent:jN(r,e),selected:t!==null&&Aa(t,e,"year"),ts:gt(e)}}function Yre(e,t,r,{quarterFormat:i}){return{type:"quarter",quarterFormat:i,dateObject:{quarter:tJ(e),year:Ai(e)},isCurrent:UN(r,e),selected:t!==null&&Aa(t,e,"quarter"),ts:gt(e)}}function m2(e,t,r,i,n=!1,a=!1){const o=a?"week":"date",s=fi(e);let l=gt(zl(e)),c=gt(_0(l,-1));const d=[];let u=!n;for(;xJ(c)!==i||u;)d.unshift(nS(c,e,t,r,o,i)),c=gt(_0(c,-1)),u=!1;for(;fi(l)===s;)d.push(nS(l,e,t,r,o,i)),l=gt(_0(l,1));const h=n?d.length<=28?28:d.length<=35?35:42:42;for(;d.length<h;)d.push(nS(l,e,t,r,o,i)),l=gt(_0(l,1));return d}function v2(e,t,r,i){const n=[],a=pT(e);for(let o=0;o<12;o++)n.push($re(gt(qn(a,o)),t,r,i));return n}function g2(e,t,r,i){const n=[],a=pT(e);for(let o=0;o<4;o++)n.push(Yre(gt(XZ(a,o)),t,r,i));return n}function y2(e,t,r){const i=[],n=new Date(tx,0,1);for(let a=0;a<200;a++)i.push(qre(gt(c2(n,a)),e,t,r));return i}function ja(e,t,r,i){const n=bee(e,t,r,i);return To(n)?ai(n,t,i)===e?n:new Date(NaN):n}function cb(e){if(e===void 0)return;if(typeof e=="number")return e;const[t,r,i]=e.split(":");return{hours:Number(t),minutes:Number(r),seconds:Number(i)}}function zh(e,t){return Array.isArray(e)?e[t==="start"?0:1]:null}const Xre={sizeSmall:"14px",sizeMedium:"16px",sizeLarge:"18px",labelPadding:"0 8px",labelFontWeight:"400"},Kre=e=>{const{baseColor:t,inputColorDisabled:r,cardColor:i,modalColor:n,popoverColor:a,textColorDisabled:o,borderColor:s,primaryColor:l,textColor2:c,fontSizeSmall:d,fontSizeMedium:u,fontSizeLarge:h,borderRadiusSmall:f,lineHeight:p}=e;return Object.assign(Object.assign({},Xre),{labelLineHeight:p,fontSizeSmall:d,fontSizeMedium:u,fontSizeLarge:h,borderRadius:f,color:t,colorChecked:l,colorDisabled:r,colorDisabledChecked:r,colorTableHeader:i,colorTableHeaderModal:n,colorTableHeaderPopover:a,checkMarkColor:t,checkMarkColorDisabled:o,checkMarkColorDisabledChecked:o,border:`1px solid ${s}`,borderDisabled:`1px solid ${s}`,borderDisabledChecked:`1px solid ${s}`,borderChecked:`1px solid ${l}`,borderFocus:`1px solid ${l}`,boxShadowFocus:`0 0 0 2px ${Yt(l,{alpha:.3})}`,textColor:c,textColorDisabled:o})},hU={name:"Checkbox",common:Gr,self:Kre},Qre=E("svg",{viewBox:"0 0 64 64",class:"check-icon"},E("path",{d:"M50.42,16.76L22.34,39.45l-8.1-11.46c-1.12-1.58-3.3-1.96-4.88-0.84c-1.58,1.12-1.95,3.3-0.84,4.88l10.26,14.51  c0.56,0.79,1.42,1.31,2.38,1.45c0.16,0.02,0.32,0.03,0.48,0.03c0.8,0,1.57-0.27,2.2-0.78l30.99-25.03c1.5-1.21,1.74-3.42,0.52-4.92  C54.13,15.78,51.93,15.55,50.42,16.76z"})),Zre=E("svg",{viewBox:"0 0 100 100",class:"line-icon"},E("path",{d:"M80.2,55.5H21.4c-2.8,0-5.1-2.5-5.1-5.5l0,0c0-3,2.3-5.5,5.1-5.5h58.7c2.8,0,5.1,2.5,5.1,5.5l0,0C85.2,53.1,82.9,55.5,80.2,55.5z"})),fU="n-checkbox-group",Jre={min:Number,max:Number,size:String,value:Array,defaultValue:{type:Array,default:null},disabled:{type:Boolean,default:void 0},"onUpdate:value":[Function,Array],onUpdateValue:[Function,Array],onChange:[Function,Array]},eie=Ve({name:"CheckboxGroup",props:Jre,setup(e){const{mergedClsPrefixRef:t}=mr(e),r=cl(e),{mergedSizeRef:i,mergedDisabledRef:n}=r,a=ge(e.defaultValue),o=re(()=>e.value),s=Un(o,a),l=re(()=>{var u;return((u=s.value)===null||u===void 0?void 0:u.length)||0}),c=re(()=>Array.isArray(s.value)?new Set(s.value):new Set);function d(u,h){const{nTriggerFormInput:f,nTriggerFormChange:p}=r,{onChange:v,"onUpdate:value":m,onUpdateValue:g}=e;if(Array.isArray(s.value)){const y=Array.from(s.value),b=y.findIndex(x=>x===h);u?~b||(y.push(h),g&&ct(g,y,{actionType:"check",value:h}),m&&ct(m,y,{actionType:"check",value:h}),f(),p(),a.value=y,v&&ct(v,y)):~b&&(y.splice(b,1),g&&ct(g,y,{actionType:"uncheck",value:h}),m&&ct(m,y,{actionType:"uncheck",value:h}),v&&ct(v,y),a.value=y,f(),p())}else u?(g&&ct(g,[h],{actionType:"check",value:h}),m&&ct(m,[h],{actionType:"check",value:h}),v&&ct(v,[h]),a.value=[h],f(),p()):(g&&ct(g,[],{actionType:"uncheck",value:h}),m&&ct(m,[],{actionType:"uncheck",value:h}),v&&ct(v,[]),a.value=[],f(),p())}return br(fU,{checkedCountRef:l,maxRef:pt(e,"max"),minRef:pt(e,"min"),valueSetRef:c,disabledRef:n,mergedSizeRef:i,toggleCheckbox:d}),{mergedClsPrefix:t}},render(){return E("div",{class:`${this.mergedClsPrefix}-checkbox-group`,role:"group"},this.$slots)}}),tie=ve([oe("checkbox",`
 font-size: var(--n-font-size);
 outline: none;
 cursor: pointer;
 display: inline-flex;
 flex-wrap: nowrap;
 align-items: flex-start;
 word-break: break-word;
 line-height: var(--n-size);
 --n-merged-color-table: var(--n-color-table);
 `,[xe("show-label","line-height: var(--n-label-line-height);"),ve("&:hover",[oe("checkbox-box",[he("border","border: var(--n-border-checked);")])]),ve("&:focus:not(:active)",[oe("checkbox-box",[he("border",`
 border: var(--n-border-focus);
 box-shadow: var(--n-box-shadow-focus);
 `)])]),xe("inside-table",[oe("checkbox-box",`
 background-color: var(--n-merged-color-table);
 `)]),xe("checked",[oe("checkbox-box",`
 background-color: var(--n-color-checked);
 `,[oe("checkbox-icon",[ve(".check-icon",`
 opacity: 1;
 transform: scale(1);
 `)])])]),xe("indeterminate",[oe("checkbox-box",[oe("checkbox-icon",[ve(".check-icon",`
 opacity: 0;
 transform: scale(.5);
 `),ve(".line-icon",`
 opacity: 1;
 transform: scale(1);
 `)])])]),xe("checked, indeterminate",[ve("&:focus:not(:active)",[oe("checkbox-box",[he("border",`
 border: var(--n-border-checked);
 box-shadow: var(--n-box-shadow-focus);
 `)])]),oe("checkbox-box",`
 background-color: var(--n-color-checked);
 border-left: 0;
 border-top: 0;
 `,[he("border",{border:"var(--n-border-checked)"})])]),xe("disabled",{cursor:"not-allowed"},[xe("checked",[oe("checkbox-box",`
 background-color: var(--n-color-disabled-checked);
 `,[he("border",{border:"var(--n-border-disabled-checked)"}),oe("checkbox-icon",[ve(".check-icon, .line-icon",{fill:"var(--n-check-mark-color-disabled-checked)"})])])]),oe("checkbox-box",`
 background-color: var(--n-color-disabled);
 `,[he("border",`
 border: var(--n-border-disabled);
 `),oe("checkbox-icon",[ve(".check-icon, .line-icon",`
 fill: var(--n-check-mark-color-disabled);
 `)])]),he("label",`
 color: var(--n-text-color-disabled);
 `)]),oe("checkbox-box-wrapper",`
 position: relative;
 width: var(--n-size);
 flex-shrink: 0;
 flex-grow: 0;
 user-select: none;
 -webkit-user-select: none;
 `),oe("checkbox-box",`
 position: absolute;
 left: 0;
 top: 50%;
 transform: translateY(-50%);
 height: var(--n-size);
 width: var(--n-size);
 display: inline-block;
 box-sizing: border-box;
 border-radius: var(--n-border-radius);
 background-color: var(--n-color);
 transition: background-color 0.3s var(--n-bezier);
 `,[he("border",`
 transition:
 border-color .3s var(--n-bezier),
 box-shadow .3s var(--n-bezier);
 border-radius: inherit;
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 border: var(--n-border);
 `),oe("checkbox-icon",`
 display: flex;
 align-items: center;
 justify-content: center;
 position: absolute;
 left: 1px;
 right: 1px;
 top: 1px;
 bottom: 1px;
 `,[ve(".check-icon, .line-icon",`
 width: 100%;
 fill: var(--n-check-mark-color);
 opacity: 0;
 transform: scale(0.5);
 transform-origin: center;
 transition:
 fill 0.3s var(--n-bezier),
 transform 0.3s var(--n-bezier),
 opacity 0.3s var(--n-bezier),
 border-color 0.3s var(--n-bezier);
 `),Sd({left:"1px",top:"1px"})])]),he("label",`
 color: var(--n-text-color);
 transition: color .3s var(--n-bezier);
 user-select: none;
 -webkit-user-select: none;
 padding: var(--n-label-padding);
 font-weight: var(--n-label-font-weight);
 `,[ve("&:empty",{display:"none"})])]),O5(oe("checkbox",`
 --n-merged-color-table: var(--n-color-table-modal);
 `)),R5(oe("checkbox",`
 --n-merged-color-table: var(--n-color-table-popover);
 `))]),rie=Object.assign(Object.assign({},bt.props),{size:String,checked:{type:[Boolean,String,Number],default:void 0},defaultChecked:{type:[Boolean,String,Number],default:!1},value:[String,Number],disabled:{type:Boolean,default:void 0},indeterminate:Boolean,label:String,focusable:{type:Boolean,default:!0},checkedValue:{type:[Boolean,String,Number],default:!0},uncheckedValue:{type:[Boolean,String,Number],default:!1},"onUpdate:checked":[Function,Array],onUpdateChecked:[Function,Array],privateInsideTable:Boolean,onChange:[Function,Array]}),pU=Ve({name:"Checkbox",props:rie,setup(e){const t=ge(null),{mergedClsPrefixRef:r,inlineThemeDisabled:i,mergedRtlRef:n}=mr(e),a=cl(e,{mergedSize(w){const{size:_}=e;if(_!==void 0)return _;if(l){const{value:C}=l.mergedSizeRef;if(C!==void 0)return C}if(w){const{mergedSize:C}=w;if(C!==void 0)return C.value}return"medium"},mergedDisabled(w){const{disabled:_}=e;if(_!==void 0)return _;if(l){if(l.disabledRef.value)return!0;const{maxRef:{value:C},checkedCountRef:A}=l;if(C!==void 0&&A.value>=C&&!h.value)return!0;const{minRef:{value:M}}=l;if(M!==void 0&&A.value<=M&&h.value)return!0}return w?w.disabled.value:!1}}),{mergedDisabledRef:o,mergedSizeRef:s}=a,l=_t(fU,null),c=ge(e.defaultChecked),d=pt(e,"checked"),u=Un(d,c),h=$i(()=>{if(l){const w=l.valueSetRef.value;return w&&e.value!==void 0?w.has(e.value):!1}else return u.value===e.checkedValue}),f=bt("Checkbox","-checkbox",tie,hU,e,r);function p(w){if(l&&e.value!==void 0)l.toggleCheckbox(!h.value,e.value);else{const{onChange:_,"onUpdate:checked":C,onUpdateChecked:A}=e,{nTriggerFormInput:M,nTriggerFormChange:P}=a,T=h.value?e.uncheckedValue:e.checkedValue;C&&ct(C,T,w),A&&ct(A,T,w),_&&ct(_,T,w),M(),P(),c.value=T}}function v(w){o.value||p(w)}function m(w){if(!o.value)switch(w.key){case" ":case"Enter":p(w)}}function g(w){switch(w.key){case" ":w.preventDefault()}}const y={focus:()=>{var w;(w=t.value)===null||w===void 0||w.focus()},blur:()=>{var w;(w=t.value)===null||w===void 0||w.blur()}},b=Ja("Checkbox",n,r),x=re(()=>{const{value:w}=s,{common:{cubicBezierEaseInOut:_},self:{borderRadius:C,color:A,colorChecked:M,colorDisabled:P,colorTableHeader:T,colorTableHeaderModal:R,colorTableHeaderPopover:z,checkMarkColor:F,checkMarkColorDisabled:H,border:N,borderFocus:U,borderDisabled:ie,borderChecked:te,boxShadowFocus:X,textColor:W,textColorDisabled:q,checkMarkColorDisabledChecked:$,colorDisabledChecked:le,borderDisabledChecked:ee,labelPadding:Q,labelLineHeight:ne,labelFontWeight:V,[Ze("fontSize",w)]:de,[Ze("size",w)]:me}}=f.value;return{"--n-label-line-height":ne,"--n-label-font-weight":V,"--n-size":me,"--n-bezier":_,"--n-border-radius":C,"--n-border":N,"--n-border-checked":te,"--n-border-focus":U,"--n-border-disabled":ie,"--n-border-disabled-checked":ee,"--n-box-shadow-focus":X,"--n-color":A,"--n-color-checked":M,"--n-color-table":T,"--n-color-table-modal":R,"--n-color-table-popover":z,"--n-color-disabled":P,"--n-color-disabled-checked":le,"--n-text-color":W,"--n-text-color-disabled":q,"--n-check-mark-color":F,"--n-check-mark-color-disabled":H,"--n-check-mark-color-disabled-checked":$,"--n-font-size":de,"--n-label-padding":Q}}),S=i?Dr("checkbox",re(()=>s.value[0]),x,e):void 0;return Object.assign(a,y,{rtlEnabled:b,selfRef:t,mergedClsPrefix:r,mergedDisabled:o,renderedChecked:h,mergedTheme:f,labelId:qu(),handleClick:v,handleKeyUp:m,handleKeyDown:g,cssVars:i?void 0:x,themeClass:S==null?void 0:S.themeClass,onRender:S==null?void 0:S.onRender})},render(){var e;const{$slots:t,renderedChecked:r,mergedDisabled:i,indeterminate:n,privateInsideTable:a,cssVars:o,labelId:s,label:l,mergedClsPrefix:c,focusable:d,handleKeyUp:u,handleKeyDown:h,handleClick:f}=this;(e=this.onRender)===null||e===void 0||e.call(this);const p=ei(t.default,v=>l||v?E("span",{class:`${c}-checkbox__label`,id:s},l||v):null);return E("div",{ref:"selfRef",class:[`${c}-checkbox`,this.themeClass,this.rtlEnabled&&`${c}-checkbox--rtl`,r&&`${c}-checkbox--checked`,i&&`${c}-checkbox--disabled`,n&&`${c}-checkbox--indeterminate`,a&&`${c}-checkbox--inside-table`,p&&`${c}-checkbox--show-label`],tabindex:i||!d?void 0:0,role:"checkbox","aria-checked":n?"mixed":r,"aria-labelledby":s,style:o,onKeyup:u,onKeydown:h,onClick:f,onMousedown:()=>{Ni("selectstart",window,v=>{v.preventDefault()},{once:!0})}},E("div",{class:`${c}-checkbox-box-wrapper`}," ",E("div",{class:`${c}-checkbox-box`},E(zp,null,{default:()=>this.indeterminate?E("div",{key:"indeterminate",class:`${c}-checkbox-icon`},Zre):E("div",{key:"check",class:`${c}-checkbox-icon`},Qre)}),E("div",{class:`${c}-checkbox-box__border`}))),p)}});function iie(e){const{boxShadow2:t}=e;return{menuBoxShadow:t}}const nie={name:"Select",common:Gr,peers:{InternalSelection:JN,InternalSelectMenu:CT},self:iie},aie=ve([oe("select",`
 z-index: auto;
 outline: none;
 width: 100%;
 position: relative;
 `),oe("select-menu",`
 margin: 4px 0;
 box-shadow: var(--n-menu-box-shadow);
 `,[Lp({originalTransition:"background-color .3s var(--n-bezier), box-shadow .3s var(--n-bezier)"})])]),oie=Object.assign(Object.assign({},bt.props),{to:jn.propTo,bordered:{type:Boolean,default:void 0},clearable:Boolean,clearFilterAfterSelect:{type:Boolean,default:!0},options:{type:Array,default:()=>[]},defaultValue:{type:[String,Number,Array],default:null},keyboard:{type:Boolean,default:!0},value:[String,Number,Array],placeholder:String,menuProps:Object,multiple:Boolean,size:String,filterable:Boolean,disabled:{type:Boolean,default:void 0},remote:Boolean,loading:Boolean,filter:Function,placement:{type:String,default:"bottom-start"},widthMode:{type:String,default:"trigger"},tag:Boolean,onCreate:Function,fallbackOption:{type:[Function,Boolean],default:void 0},show:{type:Boolean,default:void 0},showArrow:{type:Boolean,default:!0},maxTagCount:[Number,String],ellipsisTagPopoverProps:Object,consistentMenuWidth:{type:Boolean,default:!0},virtualScroll:{type:Boolean,default:!0},labelField:{type:String,default:"label"},valueField:{type:String,default:"value"},childrenField:{type:String,default:"children"},renderLabel:Function,renderOption:Function,renderTag:Function,"onUpdate:value":[Function,Array],inputProps:Object,nodeProps:Function,ignoreComposition:{type:Boolean,default:!0},showOnFocus:Boolean,onUpdateValue:[Function,Array],onBlur:[Function,Array],onClear:[Function,Array],onFocus:[Function,Array],onScroll:[Function,Array],onSearch:[Function,Array],onUpdateShow:[Function,Array],"onUpdate:show":[Function,Array],displayDirective:{type:String,default:"show"},resetMenuOnOptionsChange:{type:Boolean,default:!0},status:String,showCheckmark:{type:Boolean,default:!0},onChange:[Function,Array],items:Array}),sie=Ve({name:"Select",props:oie,setup(e){const{mergedClsPrefixRef:t,mergedBorderedRef:r,namespaceRef:i,inlineThemeDisabled:n}=mr(e),a=bt("Select","-select",aie,nie,e,t),o=ge(e.defaultValue),s=pt(e,"value"),l=Un(s,o),c=ge(!1),d=ge(""),u=re(()=>{const{valueField:se,childrenField:Le}=e,Ye=rU(se,Le);return Uf(T.value,Ye)}),h=re(()=>nre(M.value,e.valueField,e.childrenField)),f=ge(!1),p=Un(pt(e,"show"),f),v=ge(null),m=ge(null),g=ge(null),{localeRef:y}=dc("Select"),b=re(()=>{var se;return(se=e.placeholder)!==null&&se!==void 0?se:y.value.placeholder}),x=ap(e,["items","options"]),S=[],w=ge([]),_=ge([]),C=ge(new Map),A=re(()=>{const{fallbackOption:se}=e;if(se===void 0){const{labelField:Le,valueField:Ye}=e;return pe=>({[Le]:String(pe),[Ye]:pe})}return se===!1?!1:Le=>Object.assign(se(Le),{value:Le})}),M=re(()=>_.value.concat(w.value).concat(x.value)),P=re(()=>{const{filter:se}=e;if(se)return se;const{labelField:Le,valueField:Ye}=e;return(pe,Te)=>{if(!Te)return!1;const ce=Te[Le];if(typeof ce=="string")return eS(pe,ce);const Re=Te[Ye];return typeof Re=="string"?eS(pe,Re):typeof Re=="number"?eS(pe,String(Re)):!1}}),T=re(()=>{if(e.remote)return x.value;{const{value:se}=M,{value:Le}=d;return!Le.length||!e.filterable?se:ire(se,P.value,Le,e.childrenField)}});function R(se){const Le=e.remote,{value:Ye}=C,{value:pe}=h,{value:Te}=A,ce=[];return se.forEach(Re=>{if(pe.has(Re))ce.push(pe.get(Re));else if(Le&&Ye.has(Re))ce.push(Ye.get(Re));else if(Te){const $e=Te(Re);$e&&ce.push($e)}}),ce}const z=re(()=>{if(e.multiple){const{value:se}=l;return Array.isArray(se)?R(se):[]}return null}),F=re(()=>{const{value:se}=l;return!e.multiple&&!Array.isArray(se)?se===null?null:R([se])[0]||null:null}),H=cl(e),{mergedSizeRef:N,mergedDisabledRef:U,mergedStatusRef:ie}=H;function te(se,Le){const{onChange:Ye,"onUpdate:value":pe,onUpdateValue:Te}=e,{nTriggerFormChange:ce,nTriggerFormInput:Re}=H;Ye&&ct(Ye,se,Le),Te&&ct(Te,se,Le),pe&&ct(pe,se,Le),o.value=se,ce(),Re()}function X(se){const{onBlur:Le}=e,{nTriggerFormBlur:Ye}=H;Le&&ct(Le,se),Ye()}function W(){const{onClear:se}=e;se&&ct(se)}function q(se){const{onFocus:Le,showOnFocus:Ye}=e,{nTriggerFormFocus:pe}=H;Le&&ct(Le,se),pe(),Ye&&ne()}function $(se){const{onSearch:Le}=e;Le&&ct(Le,se)}function le(se){const{onScroll:Le}=e;Le&&ct(Le,se)}function ee(){var se;const{remote:Le,multiple:Ye}=e;if(Le){const{value:pe}=C;if(Ye){const{valueField:Te}=e;(se=z.value)===null||se===void 0||se.forEach(ce=>{pe.set(ce[Te],ce)})}else{const Te=F.value;Te&&pe.set(Te[e.valueField],Te)}}}function Q(se){const{onUpdateShow:Le,"onUpdate:show":Ye}=e;Le&&ct(Le,se),Ye&&ct(Ye,se),f.value=se}function ne(){U.value||(Q(!0),f.value=!0,e.filterable&&Je())}function V(){Q(!1)}function de(){d.value="",_.value=S}const me=ge(!1);function Ce(){e.filterable&&(me.value=!0)}function G(){e.filterable&&(me.value=!1,p.value||de())}function Z(){U.value||(p.value?e.filterable?Je():V():ne())}function ue(se){var Le,Ye;!((Ye=(Le=g.value)===null||Le===void 0?void 0:Le.selfRef)===null||Ye===void 0)&&Ye.contains(se.relatedTarget)||(c.value=!1,X(se),V())}function Se(se){q(se),c.value=!0}function we(se){c.value=!0}function _e(se){var Le;!((Le=v.value)===null||Le===void 0)&&Le.$el.contains(se.relatedTarget)||(c.value=!1,X(se),V())}function Ee(){var se;(se=v.value)===null||se===void 0||se.focus(),V()}function fe(se){var Le;p.value&&(!((Le=v.value)===null||Le===void 0)&&Le.$el.contains(Jl(se))||V())}function B(se){if(!Array.isArray(se))return[];if(A.value)return Array.from(se);{const{remote:Le}=e,{value:Ye}=h;if(Le){const{value:pe}=C;return se.filter(Te=>Ye.has(Te)||pe.has(Te))}else return se.filter(pe=>Ye.has(pe))}}function D(se){I(se.rawNode)}function I(se){if(U.value)return;const{tag:Le,remote:Ye,clearFilterAfterSelect:pe,valueField:Te}=e;if(Le&&!Ye){const{value:ce}=_,Re=ce[0]||null;if(Re){const $e=w.value;$e.length?$e.push(Re):w.value=[Re],_.value=S}}if(Ye&&C.value.set(se[Te],se),e.multiple){const ce=B(l.value),Re=ce.findIndex($e=>$e===se[Te]);if(~Re){if(ce.splice(Re,1),Le&&!Ye){const $e=O(se[Te]);~$e&&(w.value.splice($e,1),pe&&(d.value=""))}}else ce.push(se[Te]),pe&&(d.value="");te(ce,R(ce))}else{if(Le&&!Ye){const ce=O(se[Te]);~ce?w.value=[w.value[ce]]:w.value=S}ze(),V(),te(se[Te],se)}}function O(se){return w.value.findIndex(Ye=>Ye[e.valueField]===se)}function j(se){p.value||ne();const{value:Le}=se.target;d.value=Le;const{tag:Ye,remote:pe}=e;if($(Le),Ye&&!pe){if(!Le){_.value=S;return}const{onCreate:Te}=e,ce=Te?Te(Le):{[e.labelField]:Le,[e.valueField]:Le},{valueField:Re,labelField:$e}=e;x.value.some(at=>at[Re]===ce[Re]||at[$e]===ce[$e])||w.value.some(at=>at[Re]===ce[Re]||at[$e]===ce[$e])?_.value=S:_.value=[ce]}}function L(se){se.stopPropagation();const{multiple:Le}=e;!Le&&e.filterable&&V(),W(),Le?te([],[]):te(null,null)}function Ae(se){!yd(se,"action")&&!yd(se,"empty")&&se.preventDefault()}function We(se){le(se)}function je(se){var Le,Ye,pe,Te,ce;if(!e.keyboard){se.preventDefault();return}switch(se.key){case" ":if(e.filterable)break;se.preventDefault();case"Enter":if(!(!((Le=v.value)===null||Le===void 0)&&Le.isComposing)){if(p.value){const Re=(Ye=g.value)===null||Ye===void 0?void 0:Ye.getPendingTmNode();Re?D(Re):e.filterable||(V(),ze())}else if(ne(),e.tag&&me.value){const Re=_.value[0];if(Re){const $e=Re[e.valueField],{value:at}=l;e.multiple&&Array.isArray(at)&&at.some(qt=>qt===$e)||I(Re)}}}se.preventDefault();break;case"ArrowUp":if(se.preventDefault(),e.loading)return;p.value&&((pe=g.value)===null||pe===void 0||pe.prev());break;case"ArrowDown":if(se.preventDefault(),e.loading)return;p.value?(Te=g.value)===null||Te===void 0||Te.next():ne();break;case"Escape":p.value&&(Gv(se),V()),(ce=v.value)===null||ce===void 0||ce.focus();break}}function ze(){var se;(se=v.value)===null||se===void 0||se.focus()}function Je(){var se;(se=v.value)===null||se===void 0||se.focusInput()}function nt(){var se;p.value&&((se=m.value)===null||se===void 0||se.syncPosition())}ee(),tr(pt(e,"options"),ee);const lt={focus:()=>{var se;(se=v.value)===null||se===void 0||se.focus()},focusInput:()=>{var se;(se=v.value)===null||se===void 0||se.focusInput()},blur:()=>{var se;(se=v.value)===null||se===void 0||se.blur()},blurInput:()=>{var se;(se=v.value)===null||se===void 0||se.blurInput()}},dt=re(()=>{const{self:{menuBoxShadow:se}}=a.value;return{"--n-menu-box-shadow":se}}),vt=n?Dr("select",void 0,dt,e):void 0;return Object.assign(Object.assign({},lt),{mergedStatus:ie,mergedClsPrefix:t,mergedBordered:r,namespace:i,treeMate:u,isMounted:zd(),triggerRef:v,menuRef:g,pattern:d,uncontrolledShow:f,mergedShow:p,adjustedTo:jn(e),uncontrolledValue:o,mergedValue:l,followerRef:m,localizedPlaceholder:b,selectedOption:F,selectedOptions:z,mergedSize:N,mergedDisabled:U,focused:c,activeWithoutMenuOpen:me,inlineThemeDisabled:n,onTriggerInputFocus:Ce,onTriggerInputBlur:G,handleTriggerOrMenuResize:nt,handleMenuFocus:we,handleMenuBlur:_e,handleMenuTabOut:Ee,handleTriggerClick:Z,handleToggle:D,handleDeleteOption:I,handlePatternInput:j,handleClear:L,handleTriggerBlur:ue,handleTriggerFocus:Se,handleKeydown:je,handleMenuAfterLeave:de,handleMenuClickOutside:fe,handleMenuScroll:We,handleMenuKeydown:je,handleMenuMousedown:Ae,mergedTheme:a,cssVars:n?void 0:dt,themeClass:vt==null?void 0:vt.themeClass,onRender:vt==null?void 0:vt.onRender})},render(){return E("div",{class:`${this.mergedClsPrefix}-select`},E(ch,null,{default:()=>[E(dh,null,{default:()=>E(Jte,{ref:"triggerRef",inlineThemeDisabled:this.inlineThemeDisabled,status:this.mergedStatus,inputProps:this.inputProps,clsPrefix:this.mergedClsPrefix,showArrow:this.showArrow,maxTagCount:this.maxTagCount,ellipsisTagPopoverProps:this.ellipsisTagPopoverProps,bordered:this.mergedBordered,active:this.activeWithoutMenuOpen||this.mergedShow,pattern:this.pattern,placeholder:this.localizedPlaceholder,selectedOption:this.selectedOption,selectedOptions:this.selectedOptions,multiple:this.multiple,renderTag:this.renderTag,renderLabel:this.renderLabel,filterable:this.filterable,clearable:this.clearable,disabled:this.mergedDisabled,size:this.mergedSize,theme:this.mergedTheme.peers.InternalSelection,labelField:this.labelField,valueField:this.valueField,themeOverrides:this.mergedTheme.peerOverrides.InternalSelection,loading:this.loading,focused:this.focused,onClick:this.handleTriggerClick,onDeleteOption:this.handleDeleteOption,onPatternInput:this.handlePatternInput,onClear:this.handleClear,onBlur:this.handleTriggerBlur,onFocus:this.handleTriggerFocus,onKeydown:this.handleKeydown,onPatternBlur:this.onTriggerInputBlur,onPatternFocus:this.onTriggerInputFocus,onResize:this.handleTriggerOrMenuResize,ignoreComposition:this.ignoreComposition},{arrow:()=>{var e,t;return[(t=(e=this.$slots).arrow)===null||t===void 0?void 0:t.call(e)]}})}),E(uh,{ref:"followerRef",show:this.mergedShow,to:this.adjustedTo,teleportDisabled:this.adjustedTo===jn.tdkey,containerClass:this.namespace,width:this.consistentMenuWidth?"target":void 0,minWidth:"target",placement:this.placement},{default:()=>E(Da,{name:"fade-in-scale-up-transition",appear:this.isMounted,onAfterLeave:this.handleMenuAfterLeave},{default:()=>{var e,t,r;return this.mergedShow||this.displayDirective==="show"?((e=this.onRender)===null||e===void 0||e.call(this),Ka(E(YN,Object.assign({},this.menuProps,{ref:"menuRef",onResize:this.handleTriggerOrMenuResize,inlineThemeDisabled:this.inlineThemeDisabled,virtualScroll:this.consistentMenuWidth&&this.virtualScroll,class:[`${this.mergedClsPrefix}-select-menu`,this.themeClass,(t=this.menuProps)===null||t===void 0?void 0:t.class],clsPrefix:this.mergedClsPrefix,focusable:!0,labelField:this.labelField,valueField:this.valueField,autoPending:!0,nodeProps:this.nodeProps,theme:this.mergedTheme.peers.InternalSelectMenu,themeOverrides:this.mergedTheme.peerOverrides.InternalSelectMenu,treeMate:this.treeMate,multiple:this.multiple,size:"medium",renderOption:this.renderOption,renderLabel:this.renderLabel,value:this.mergedValue,style:[(r=this.menuProps)===null||r===void 0?void 0:r.style,this.cssVars],onToggle:this.handleToggle,onScroll:this.handleMenuScroll,onFocus:this.handleMenuFocus,onBlur:this.handleMenuBlur,onKeydown:this.handleMenuKeydown,onTabOut:this.handleMenuTabOut,onMousedown:this.handleMenuMousedown,show:this.mergedShow,showCheckmark:this.showCheckmark,resetMenuOnOptionsChange:this.resetMenuOnOptionsChange}),{empty:()=>{var i,n;return[(n=(i=this.$slots).empty)===null||n===void 0?void 0:n.call(i)]},header:()=>{var i,n;return[(n=(i=this.$slots).header)===null||n===void 0?void 0:n.call(i)]},action:()=>{var i,n;return[(n=(i=this.$slots).action)===null||n===void 0?void 0:n.call(i)]}}),this.displayDirective==="show"?[[Gu,this.mergedShow],[bd,this.handleMenuClickOutside,void 0,{capture:!0}]]:[[bd,this.handleMenuClickOutside,void 0,{capture:!0}]])):null}})})]}))}}),lie={padding:"8px 14px"},cie=e=>{const{borderRadius:t,boxShadow2:r,baseColor:i}=e;return Object.assign(Object.assign({},lie),{borderRadius:t,boxShadow:r,color:Xs(i,"rgba(0, 0, 0, .85)"),textColor:i})},mU={name:"Tooltip",common:Gr,peers:{Popover:R1},self:cie},die={padding:"4px 0",optionIconSizeSmall:"14px",optionIconSizeMedium:"16px",optionIconSizeLarge:"16px",optionIconSizeHuge:"18px",optionSuffixWidthSmall:"14px",optionSuffixWidthMedium:"14px",optionSuffixWidthLarge:"16px",optionSuffixWidthHuge:"16px",optionIconSuffixWidthSmall:"32px",optionIconSuffixWidthMedium:"32px",optionIconSuffixWidthLarge:"36px",optionIconSuffixWidthHuge:"36px",optionPrefixWidthSmall:"14px",optionPrefixWidthMedium:"14px",optionPrefixWidthLarge:"16px",optionPrefixWidthHuge:"16px",optionIconPrefixWidthSmall:"36px",optionIconPrefixWidthMedium:"36px",optionIconPrefixWidthLarge:"40px",optionIconPrefixWidthHuge:"40px"},uie=e=>{const{primaryColor:t,textColor2:r,dividerColor:i,hoverColor:n,popoverColor:a,invertedColor:o,borderRadius:s,fontSizeSmall:l,fontSizeMedium:c,fontSizeLarge:d,fontSizeHuge:u,heightSmall:h,heightMedium:f,heightLarge:p,heightHuge:v,textColor3:m,opacityDisabled:g}=e;return Object.assign(Object.assign({},die),{optionHeightSmall:h,optionHeightMedium:f,optionHeightLarge:p,optionHeightHuge:v,borderRadius:s,fontSizeSmall:l,fontSizeMedium:c,fontSizeLarge:d,fontSizeHuge:u,optionTextColor:r,optionTextColorHover:r,optionTextColorActive:t,optionTextColorChildActive:t,color:a,dividerColor:i,suffixColor:r,prefixColor:r,optionColorHover:n,optionColorActive:Yt(t,{alpha:.1}),groupHeaderTextColor:m,optionTextColorInverted:"#BBB",optionTextColorHoverInverted:"#FFF",optionTextColorActiveInverted:"#FFF",optionTextColorChildActiveInverted:"#FFF",colorInverted:o,dividerColorInverted:"#BBB",suffixColorInverted:"#BBB",prefixColorInverted:"#BBB",optionColorHoverInverted:t,optionColorActiveInverted:t,groupHeaderTextColorInverted:"#AAA",optionOpacityDisabled:g})},vU={name:"Dropdown",common:Gr,peers:{Popover:R1},self:uie},hie=Object.assign(Object.assign({},I1),bt.props),fie=Ve({name:"Tooltip",props:hie,__popover__:!0,setup(e){const{mergedClsPrefixRef:t}=mr(e),r=bt("Tooltip","-tooltip",void 0,mU,e,t),i=ge(null);return Object.assign(Object.assign({},{syncPosition(){i.value.syncPosition()},setShow(a){i.value.setShow(a)}}),{popoverRef:i,mergedTheme:r,popoverThemeOverrides:re(()=>r.value.self)})},render(){const{mergedTheme:e,internalExtraClass:t}=this;return E(_T,Object.assign(Object.assign({},this.$props),{theme:e.peers.Popover,themeOverrides:e.peerOverrides.Popover,builtinThemeOverrides:this.popoverThemeOverrides,internalExtraClass:t.concat("tooltip"),ref:"popoverRef"}),this.$slots)}}),gU=Ve({name:"DropdownDivider",props:{clsPrefix:{type:String,required:!0}},render(){return E("div",{class:`${this.clsPrefix}-dropdown-divider`})}}),pie=e=>{const{textColorBase:t,opacity1:r,opacity2:i,opacity3:n,opacity4:a,opacity5:o}=e;return{color:t,opacity1Depth:r,opacity2Depth:i,opacity3Depth:n,opacity4Depth:a,opacity5Depth:o}},mie={name:"Icon",common:Gr,self:pie},vie=oe("icon",`
 height: 1em;
 width: 1em;
 line-height: 1em;
 text-align: center;
 display: inline-block;
 position: relative;
 fill: currentColor;
 transform: translateZ(0);
`,[xe("color-transition",{transition:"color .3s var(--n-bezier)"}),xe("depth",{color:"var(--n-color)"},[ve("svg",{opacity:"var(--n-opacity)",transition:"opacity .3s var(--n-bezier)"})]),ve("svg",{height:"1em",width:"1em"})]),gie=Object.assign(Object.assign({},bt.props),{depth:[String,Number],size:[Number,String],color:String,component:Object}),z1=Ve({_n_icon__:!0,name:"Icon",inheritAttrs:!1,props:gie,setup(e){const{mergedClsPrefixRef:t,inlineThemeDisabled:r}=mr(e),i=bt("Icon","-icon",vie,mie,e,t),n=re(()=>{const{depth:o}=e,{common:{cubicBezierEaseInOut:s},self:l}=i.value;if(o!==void 0){const{color:c,[`opacity${o}Depth`]:d}=l;return{"--n-bezier":s,"--n-color":c,"--n-opacity":d}}return{"--n-bezier":s,"--n-color":"","--n-opacity":""}}),a=r?Dr("icon",re(()=>`${e.depth||"d"}`),n,e):void 0;return{mergedClsPrefix:t,mergedStyle:re(()=>{const{size:o,color:s}=e;return{fontSize:os(o),color:s}}),cssVars:r?void 0:n,themeClass:a==null?void 0:a.themeClass,onRender:a==null?void 0:a.onRender}},render(){var e;const{$parent:t,depth:r,mergedClsPrefix:i,component:n,onRender:a,themeClass:o}=this;return!((e=t==null?void 0:t.$options)===null||e===void 0)&&e._n_icon__&&Yu("icon","don't wrap `n-icon` inside `n-icon`"),a==null||a(),E("i",Rd(this.$attrs,{role:"img",class:[`${i}-icon`,o,{[`${i}-icon--depth`]:r,[`${i}-icon--color-transition`]:r!==void 0}],style:[this.cssVars,this.mergedStyle]}),n?E(n):this.$slots)}}),MT="n-dropdown-menu",k1="n-dropdown",IO="n-dropdown-option";function b2(e,t){return e.type==="submenu"||e.type===void 0&&e[t]!==void 0}function yie(e){return e.type==="group"}function yU(e){return e.type==="divider"}function bie(e){return e.type==="render"}const bU=Ve({name:"DropdownOption",props:{clsPrefix:{type:String,required:!0},tmNode:{type:Object,required:!0},parentKey:{type:[String,Number],default:null},placement:{type:String,default:"right-start"},props:Object,scrollable:Boolean},setup(e){const t=_t(k1),{hoverKeyRef:r,keyboardKeyRef:i,lastToggledSubmenuKeyRef:n,pendingKeyPathRef:a,activeKeyPathRef:o,animatedRef:s,mergedShowRef:l,renderLabelRef:c,renderIconRef:d,labelFieldRef:u,childrenFieldRef:h,renderOptionRef:f,nodePropsRef:p,menuPropsRef:v}=t,m=_t(IO,null),g=_t(MT),y=_t(A1),b=re(()=>e.tmNode.rawNode),x=re(()=>{const{value:N}=h;return b2(e.tmNode.rawNode,N)}),S=re(()=>{const{disabled:N}=e.tmNode;return N}),w=re(()=>{if(!x.value)return!1;const{key:N,disabled:U}=e.tmNode;if(U)return!1;const{value:ie}=r,{value:te}=i,{value:X}=n,{value:W}=a;return ie!==null?W.includes(N):te!==null?W.includes(N)&&W[W.length-1]!==N:X!==null?W.includes(N):!1}),_=re(()=>i.value===null&&!s.value),C=C$(w,300,_),A=re(()=>!!(m!=null&&m.enteringSubmenuRef.value)),M=ge(!1);br(IO,{enteringSubmenuRef:M});function P(){M.value=!0}function T(){M.value=!1}function R(){const{parentKey:N,tmNode:U}=e;U.disabled||l.value&&(n.value=N,i.value=null,r.value=U.key)}function z(){const{tmNode:N}=e;N.disabled||l.value&&r.value!==N.key&&R()}function F(N){if(e.tmNode.disabled||!l.value)return;const{relatedTarget:U}=N;U&&!yd({target:U},"dropdownOption")&&!yd({target:U},"scrollbarRail")&&(r.value=null)}function H(){const{value:N}=x,{tmNode:U}=e;l.value&&!N&&!U.disabled&&(t.doSelect(U.key,U.rawNode),t.doUpdateShow(!1))}return{labelField:u,renderLabel:c,renderIcon:d,siblingHasIcon:g.showIconRef,siblingHasSubmenu:g.hasSubmenuRef,menuProps:v,popoverBody:y,animated:s,mergedShowSubmenu:re(()=>C.value&&!A.value),rawNode:b,hasSubmenu:x,pending:$i(()=>{const{value:N}=a,{key:U}=e.tmNode;return N.includes(U)}),childActive:$i(()=>{const{value:N}=o,{key:U}=e.tmNode,ie=N.findIndex(te=>U===te);return ie===-1?!1:ie<N.length-1}),active:$i(()=>{const{value:N}=o,{key:U}=e.tmNode,ie=N.findIndex(te=>U===te);return ie===-1?!1:ie===N.length-1}),mergedDisabled:S,renderOption:f,nodeProps:p,handleClick:H,handleMouseMove:z,handleMouseEnter:R,handleMouseLeave:F,handleSubmenuBeforeEnter:P,handleSubmenuAfterEnter:T}},render(){var e,t;const{animated:r,rawNode:i,mergedShowSubmenu:n,clsPrefix:a,siblingHasIcon:o,siblingHasSubmenu:s,renderLabel:l,renderIcon:c,renderOption:d,nodeProps:u,props:h,scrollable:f}=this;let p=null;if(n){const y=(e=this.menuProps)===null||e===void 0?void 0:e.call(this,i,i.children);p=E(xU,Object.assign({},y,{clsPrefix:a,scrollable:this.scrollable,tmNodes:this.tmNode.children,parentKey:this.tmNode.key}))}const v={class:[`${a}-dropdown-option-body`,this.pending&&`${a}-dropdown-option-body--pending`,this.active&&`${a}-dropdown-option-body--active`,this.childActive&&`${a}-dropdown-option-body--child-active`,this.mergedDisabled&&`${a}-dropdown-option-body--disabled`],onMousemove:this.handleMouseMove,onMouseenter:this.handleMouseEnter,onMouseleave:this.handleMouseLeave,onClick:this.handleClick},m=u==null?void 0:u(i),g=E("div",Object.assign({class:[`${a}-dropdown-option`,m==null?void 0:m.class],"data-dropdown-option":!0},m),E("div",Rd(v,h),[E("div",{class:[`${a}-dropdown-option-body__prefix`,o&&`${a}-dropdown-option-body__prefix--show-icon`]},[c?c(i):kn(i.icon)]),E("div",{"data-dropdown-option":!0,class:`${a}-dropdown-option-body__label`},l?l(i):kn((t=i[this.labelField])!==null&&t!==void 0?t:i.title)),E("div",{"data-dropdown-option":!0,class:[`${a}-dropdown-option-body__suffix`,s&&`${a}-dropdown-option-body__suffix--has-submenu`]},this.hasSubmenu?E(z1,null,{default:()=>E(VN,null)}):null)]),this.hasSubmenu?E(ch,null,{default:()=>[E(dh,null,{default:()=>E("div",{class:`${a}-dropdown-offset-container`},E(uh,{show:this.mergedShowSubmenu,placement:this.placement,to:f&&this.popoverBody||void 0,teleportDisabled:!f},{default:()=>E("div",{class:`${a}-dropdown-menu-wrapper`},r?E(Da,{onBeforeEnter:this.handleSubmenuBeforeEnter,onAfterEnter:this.handleSubmenuAfterEnter,name:"fade-in-scale-up-transition",appear:!0},{default:()=>p}):p)}))})]}):null);return d?d({node:g,option:i}):g}}),xie=Ve({name:"DropdownGroupHeader",props:{clsPrefix:{type:String,required:!0},tmNode:{type:Object,required:!0}},setup(){const{showIconRef:e,hasSubmenuRef:t}=_t(MT),{renderLabelRef:r,labelFieldRef:i,nodePropsRef:n,renderOptionRef:a}=_t(k1);return{labelField:i,showIcon:e,hasSubmenu:t,renderLabel:r,nodeProps:n,renderOption:a}},render(){var e;const{clsPrefix:t,hasSubmenu:r,showIcon:i,nodeProps:n,renderLabel:a,renderOption:o}=this,{rawNode:s}=this.tmNode,l=E("div",Object.assign({class:`${t}-dropdown-option`},n==null?void 0:n(s)),E("div",{class:`${t}-dropdown-option-body ${t}-dropdown-option-body--group`},E("div",{"data-dropdown-option":!0,class:[`${t}-dropdown-option-body__prefix`,i&&`${t}-dropdown-option-body__prefix--show-icon`]},kn(s.icon)),E("div",{class:`${t}-dropdown-option-body__label`,"data-dropdown-option":!0},a?a(s):kn((e=s.title)!==null&&e!==void 0?e:s[this.labelField])),E("div",{class:[`${t}-dropdown-option-body__suffix`,r&&`${t}-dropdown-option-body__suffix--has-submenu`],"data-dropdown-option":!0})));return o?o({node:l,option:s}):l}}),wie=Ve({name:"NDropdownGroup",props:{clsPrefix:{type:String,required:!0},tmNode:{type:Object,required:!0},parentKey:{type:[String,Number],default:null}},render(){const{tmNode:e,parentKey:t,clsPrefix:r}=this,{children:i}=e;return E(pr,null,E(xie,{clsPrefix:r,tmNode:e,key:e.key}),i==null?void 0:i.map(n=>{const{rawNode:a}=n;return a.show===!1?null:yU(a)?E(gU,{clsPrefix:r,key:n.key}):n.isGroup?(Yu("dropdown","`group` node is not allowed to be put in `group` node."),null):E(bU,{clsPrefix:r,tmNode:n,parentKey:t,key:n.key})}))}}),Sie=Ve({name:"DropdownRenderOption",props:{tmNode:{type:Object,required:!0}},render(){const{rawNode:{render:e,props:t}}=this.tmNode;return E("div",t,[e==null?void 0:e()])}}),xU=Ve({name:"DropdownMenu",props:{scrollable:Boolean,showArrow:Boolean,arrowStyle:[String,Object],clsPrefix:{type:String,required:!0},tmNodes:{type:Array,default:()=>[]},parentKey:{type:[String,Number],default:null}},setup(e){const{renderIconRef:t,childrenFieldRef:r}=_t(k1);br(MT,{showIconRef:re(()=>{const n=t.value;return e.tmNodes.some(a=>{var o;if(a.isGroup)return(o=a.children)===null||o===void 0?void 0:o.some(({rawNode:l})=>n?n(l):l.icon);const{rawNode:s}=a;return n?n(s):s.icon})}),hasSubmenuRef:re(()=>{const{value:n}=r;return e.tmNodes.some(a=>{var o;if(a.isGroup)return(o=a.children)===null||o===void 0?void 0:o.some(({rawNode:l})=>b2(l,n));const{rawNode:s}=a;return b2(s,n)})})});const i=ge(null);return br(QE,null),br(ZE,null),br(A1,i),{bodyRef:i}},render(){const{parentKey:e,clsPrefix:t,scrollable:r}=this,i=this.tmNodes.map(n=>{const{rawNode:a}=n;return a.show===!1?null:bie(a)?E(Sie,{tmNode:n,key:n.key}):yU(a)?E(gU,{clsPrefix:t,key:n.key}):yie(a)?E(wie,{clsPrefix:t,tmNode:n,parentKey:e,key:n.key}):E(bU,{clsPrefix:t,tmNode:n,parentKey:e,key:n.key,props:a.props,scrollable:r})});return E("div",{class:[`${t}-dropdown-menu`,r&&`${t}-dropdown-menu--scrollable`],ref:"bodyRef"},r?E(qN,{contentClass:`${t}-dropdown-menu__content`},{default:()=>i}):i,this.showArrow?KN({clsPrefix:t,arrowStyle:this.arrowStyle,arrowClass:void 0,arrowWrapperClass:void 0,arrowWrapperStyle:void 0}):null)}}),Cie=oe("dropdown-menu",`
 transform-origin: var(--v-transform-origin);
 background-color: var(--n-color);
 border-radius: var(--n-border-radius);
 box-shadow: var(--n-box-shadow);
 position: relative;
 transition:
 background-color .3s var(--n-bezier),
 box-shadow .3s var(--n-bezier);
`,[Lp(),oe("dropdown-option",`
 position: relative;
 `,[ve("a",`
 text-decoration: none;
 color: inherit;
 outline: none;
 `,[ve("&::before",`
 content: "";
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 `)]),oe("dropdown-option-body",`
 display: flex;
 cursor: pointer;
 position: relative;
 height: var(--n-option-height);
 line-height: var(--n-option-height);
 font-size: var(--n-font-size);
 color: var(--n-option-text-color);
 transition: color .3s var(--n-bezier);
 `,[ve("&::before",`
 content: "";
 position: absolute;
 top: 0;
 bottom: 0;
 left: 4px;
 right: 4px;
 transition: background-color .3s var(--n-bezier);
 border-radius: var(--n-border-radius);
 `),yr("disabled",[xe("pending",`
 color: var(--n-option-text-color-hover);
 `,[he("prefix, suffix",`
 color: var(--n-option-text-color-hover);
 `),ve("&::before","background-color: var(--n-option-color-hover);")]),xe("active",`
 color: var(--n-option-text-color-active);
 `,[he("prefix, suffix",`
 color: var(--n-option-text-color-active);
 `),ve("&::before","background-color: var(--n-option-color-active);")]),xe("child-active",`
 color: var(--n-option-text-color-child-active);
 `,[he("prefix, suffix",`
 color: var(--n-option-text-color-child-active);
 `)])]),xe("disabled",`
 cursor: not-allowed;
 opacity: var(--n-option-opacity-disabled);
 `),xe("group",`
 font-size: calc(var(--n-font-size) - 1px);
 color: var(--n-group-header-text-color);
 `,[he("prefix",`
 width: calc(var(--n-option-prefix-width) / 2);
 `,[xe("show-icon",`
 width: calc(var(--n-option-icon-prefix-width) / 2);
 `)])]),he("prefix",`
 width: var(--n-option-prefix-width);
 display: flex;
 justify-content: center;
 align-items: center;
 color: var(--n-prefix-color);
 transition: color .3s var(--n-bezier);
 z-index: 1;
 `,[xe("show-icon",`
 width: var(--n-option-icon-prefix-width);
 `),oe("icon",`
 font-size: var(--n-option-icon-size);
 `)]),he("label",`
 white-space: nowrap;
 flex: 1;
 z-index: 1;
 `),he("suffix",`
 box-sizing: border-box;
 flex-grow: 0;
 flex-shrink: 0;
 display: flex;
 justify-content: flex-end;
 align-items: center;
 min-width: var(--n-option-suffix-width);
 padding: 0 8px;
 transition: color .3s var(--n-bezier);
 color: var(--n-suffix-color);
 z-index: 1;
 `,[xe("has-submenu",`
 width: var(--n-option-icon-suffix-width);
 `),oe("icon",`
 font-size: var(--n-option-icon-size);
 `)]),oe("dropdown-menu","pointer-events: all;")]),oe("dropdown-offset-container",`
 pointer-events: none;
 position: absolute;
 left: 0;
 right: 0;
 top: -4px;
 bottom: -4px;
 `)]),oe("dropdown-divider",`
 transition: background-color .3s var(--n-bezier);
 background-color: var(--n-divider-color);
 height: 1px;
 margin: 4px 0;
 `),oe("dropdown-menu-wrapper",`
 transform-origin: var(--v-transform-origin);
 width: fit-content;
 `),ve(">",[oe("scrollbar",`
 height: inherit;
 max-height: inherit;
 `)]),yr("scrollable",`
 padding: var(--n-padding);
 `),xe("scrollable",[he("content",`
 padding: var(--n-padding);
 `)])]),_ie={animated:{type:Boolean,default:!0},keyboard:{type:Boolean,default:!0},size:{type:String,default:"medium"},inverted:Boolean,placement:{type:String,default:"bottom"},onSelect:[Function,Array],options:{type:Array,default:()=>[]},menuProps:Function,showArrow:Boolean,renderLabel:Function,renderIcon:Function,renderOption:Function,nodeProps:Function,labelField:{type:String,default:"label"},keyField:{type:String,default:"key"},childrenField:{type:String,default:"children"},value:[String,Number]},Aie=Object.keys(I1),Mie=Object.assign(Object.assign(Object.assign({},I1),_ie),bt.props),Eie=Ve({name:"Dropdown",inheritAttrs:!1,props:Mie,setup(e){const t=ge(!1),r=Un(pt(e,"show"),t),i=re(()=>{const{keyField:T,childrenField:R}=e;return Uf(e.options,{getKey(z){return z[T]},getDisabled(z){return z.disabled===!0},getIgnored(z){return z.type==="divider"||z.type==="render"},getChildren(z){return z[R]}})}),n=re(()=>i.value.treeNodes),a=ge(null),o=ge(null),s=ge(null),l=re(()=>{var T,R,z;return(z=(R=(T=a.value)!==null&&T!==void 0?T:o.value)!==null&&R!==void 0?R:s.value)!==null&&z!==void 0?z:null}),c=re(()=>i.value.getPath(l.value).keyPath),d=re(()=>i.value.getPath(e.value).keyPath),u=$i(()=>e.keyboard&&r.value);XE({keydown:{ArrowUp:{prevent:!0,handler:S},ArrowRight:{prevent:!0,handler:x},ArrowDown:{prevent:!0,handler:w},ArrowLeft:{prevent:!0,handler:b},Enter:{prevent:!0,handler:_},Escape:y}},u);const{mergedClsPrefixRef:h,inlineThemeDisabled:f}=mr(e),p=bt("Dropdown","-dropdown",Cie,vU,e,h);br(k1,{labelFieldRef:pt(e,"labelField"),childrenFieldRef:pt(e,"childrenField"),renderLabelRef:pt(e,"renderLabel"),renderIconRef:pt(e,"renderIcon"),hoverKeyRef:a,keyboardKeyRef:o,lastToggledSubmenuKeyRef:s,pendingKeyPathRef:c,activeKeyPathRef:d,animatedRef:pt(e,"animated"),mergedShowRef:r,nodePropsRef:pt(e,"nodeProps"),renderOptionRef:pt(e,"renderOption"),menuPropsRef:pt(e,"menuProps"),doSelect:v,doUpdateShow:m}),tr(r,T=>{!e.animated&&!T&&g()});function v(T,R){const{onSelect:z}=e;z&&ct(z,T,R)}function m(T){const{"onUpdate:show":R,onUpdateShow:z}=e;R&&ct(R,T),z&&ct(z,T),t.value=T}function g(){a.value=null,o.value=null,s.value=null}function y(){m(!1)}function b(){A("left")}function x(){A("right")}function S(){A("up")}function w(){A("down")}function _(){const T=C();T!=null&&T.isLeaf&&r.value&&(v(T.key,T.rawNode),m(!1))}function C(){var T;const{value:R}=i,{value:z}=l;return!R||z===null?null:(T=R.getNode(z))!==null&&T!==void 0?T:null}function A(T){const{value:R}=l,{value:{getFirstAvailableNode:z}}=i;let F=null;if(R===null){const H=z();H!==null&&(F=H.key)}else{const H=C();if(H){let N;switch(T){case"down":N=H.getNext();break;case"up":N=H.getPrev();break;case"right":N=H.getChild();break;case"left":N=H.getParent();break}N&&(F=N.key)}}F!==null&&(a.value=null,o.value=F)}const M=re(()=>{const{size:T,inverted:R}=e,{common:{cubicBezierEaseInOut:z},self:F}=p.value,{padding:H,dividerColor:N,borderRadius:U,optionOpacityDisabled:ie,[Ze("optionIconSuffixWidth",T)]:te,[Ze("optionSuffixWidth",T)]:X,[Ze("optionIconPrefixWidth",T)]:W,[Ze("optionPrefixWidth",T)]:q,[Ze("fontSize",T)]:$,[Ze("optionHeight",T)]:le,[Ze("optionIconSize",T)]:ee}=F,Q={"--n-bezier":z,"--n-font-size":$,"--n-padding":H,"--n-border-radius":U,"--n-option-height":le,"--n-option-prefix-width":q,"--n-option-icon-prefix-width":W,"--n-option-suffix-width":X,"--n-option-icon-suffix-width":te,"--n-option-icon-size":ee,"--n-divider-color":N,"--n-option-opacity-disabled":ie};return R?(Q["--n-color"]=F.colorInverted,Q["--n-option-color-hover"]=F.optionColorHoverInverted,Q["--n-option-color-active"]=F.optionColorActiveInverted,Q["--n-option-text-color"]=F.optionTextColorInverted,Q["--n-option-text-color-hover"]=F.optionTextColorHoverInverted,Q["--n-option-text-color-active"]=F.optionTextColorActiveInverted,Q["--n-option-text-color-child-active"]=F.optionTextColorChildActiveInverted,Q["--n-prefix-color"]=F.prefixColorInverted,Q["--n-suffix-color"]=F.suffixColorInverted,Q["--n-group-header-text-color"]=F.groupHeaderTextColorInverted):(Q["--n-color"]=F.color,Q["--n-option-color-hover"]=F.optionColorHover,Q["--n-option-color-active"]=F.optionColorActive,Q["--n-option-text-color"]=F.optionTextColor,Q["--n-option-text-color-hover"]=F.optionTextColorHover,Q["--n-option-text-color-active"]=F.optionTextColorActive,Q["--n-option-text-color-child-active"]=F.optionTextColorChildActive,Q["--n-prefix-color"]=F.prefixColor,Q["--n-suffix-color"]=F.suffixColor,Q["--n-group-header-text-color"]=F.groupHeaderTextColor),Q}),P=f?Dr("dropdown",re(()=>`${e.size[0]}${e.inverted?"i":""}`),M,e):void 0;return{mergedClsPrefix:h,mergedTheme:p,tmNodes:n,mergedShow:r,handleAfterLeave:()=>{e.animated&&g()},doUpdateShow:m,cssVars:f?void 0:M,themeClass:P==null?void 0:P.themeClass,onRender:P==null?void 0:P.onRender}},render(){const e=(i,n,a,o,s)=>{var l;const{mergedClsPrefix:c,menuProps:d}=this;(l=this.onRender)===null||l===void 0||l.call(this);const u=(d==null?void 0:d(void 0,this.tmNodes.map(f=>f.rawNode)))||{},h={ref:XG(n),class:[i,`${c}-dropdown`,this.themeClass],clsPrefix:c,tmNodes:this.tmNodes,style:[...a,this.cssVars],showArrow:this.showArrow,arrowStyle:this.arrowStyle,scrollable:this.scrollable,onMouseenter:o,onMouseleave:s};return E(xU,Rd(this.$attrs,h,u))},{mergedTheme:t}=this,r={show:this.mergedShow,theme:t.peers.Popover,themeOverrides:t.peerOverrides.Popover,internalOnAfterLeave:this.handleAfterLeave,internalRenderBody:e,onUpdateShow:this.doUpdateShow,"onUpdate:show":void 0};return E(_T,Object.assign({},pv(this.$props,Aie),r),{trigger:()=>{var i,n;return(n=(i=this.$slots).default)===null||n===void 0?void 0:n.call(i)}})}}),Tie={itemFontSize:"12px",itemHeight:"36px",itemWidth:"52px",panelActionPadding:"8px 0"},Pie=e=>{const{popoverColor:t,textColor2:r,primaryColor:i,hoverColor:n,dividerColor:a,opacityDisabled:o,boxShadow2:s,borderRadius:l,iconColor:c,iconColorDisabled:d}=e;return Object.assign(Object.assign({},Tie),{panelColor:t,panelBoxShadow:s,panelDividerColor:a,itemTextColor:r,itemTextColorActive:i,itemColorHover:n,itemOpacityDisabled:o,itemBorderRadius:l,borderRadius:l,iconColor:c,iconColorDisabled:d})},wU={name:"TimePicker",common:Gr,peers:{Scrollbar:kp,Button:zg,Input:Bp},self:Pie},Die={itemSize:"24px",itemCellWidth:"38px",itemCellHeight:"32px",scrollItemWidth:"80px",scrollItemHeight:"40px",panelExtraFooterPadding:"8px 12px",panelActionPadding:"8px 12px",calendarTitlePadding:"0",calendarTitleHeight:"28px",arrowSize:"14px",panelHeaderPadding:"8px 12px",calendarDaysHeight:"32px",calendarTitleGridTempateColumns:"28px 28px 1fr 28px 28px",calendarLeftPaddingDate:"6px 12px 4px 12px",calendarLeftPaddingDatetime:"4px 12px",calendarLeftPaddingDaterange:"6px 12px 4px 12px",calendarLeftPaddingDatetimerange:"4px 12px",calendarLeftPaddingMonth:"0",calendarLeftPaddingYear:"0",calendarLeftPaddingQuarter:"0",calendarLeftPaddingMonthrange:"0",calendarLeftPaddingQuarterrange:"0",calendarLeftPaddingYearrange:"0",calendarLeftPaddingWeek:"6px 12px 4px 12px",calendarRightPaddingDate:"6px 12px 4px 12px",calendarRightPaddingDatetime:"4px 12px",calendarRightPaddingDaterange:"6px 12px 4px 12px",calendarRightPaddingDatetimerange:"4px 12px",calendarRightPaddingMonth:"0",calendarRightPaddingYear:"0",calendarRightPaddingQuarter:"0",calendarRightPaddingMonthrange:"0",calendarRightPaddingQuarterrange:"0",calendarRightPaddingYearrange:"0",calendarRightPaddingWeek:"0"},Oie=e=>{const{hoverColor:t,fontSize:r,textColor2:i,textColorDisabled:n,popoverColor:a,primaryColor:o,borderRadiusSmall:s,iconColor:l,iconColorDisabled:c,textColor1:d,dividerColor:u,boxShadow2:h,borderRadius:f,fontWeightStrong:p}=e;return Object.assign(Object.assign({},Die),{itemFontSize:r,calendarDaysFontSize:r,calendarTitleFontSize:r,itemTextColor:i,itemTextColorDisabled:n,itemTextColorActive:a,itemTextColorCurrent:o,itemColorIncluded:Yt(o,{alpha:.1}),itemColorHover:t,itemColorDisabled:t,itemColorActive:o,itemBorderRadius:s,panelColor:a,panelTextColor:i,arrowColor:l,calendarTitleTextColor:d,calendarTitleColorHover:t,calendarDaysTextColor:i,panelHeaderDividerColor:u,calendarDaysDividerColor:u,calendarDividerColor:u,panelActionDividerColor:u,panelBoxShadow:h,panelBorderRadius:f,calendarTitleFontWeight:p,scrollItemBorderRadius:f,iconColor:l,iconColorDisabled:c})},Rie={name:"DatePicker",common:Gr,peers:{Input:Bp,Button:zg,TimePicker:wU,Scrollbar:kp},self:Oie};function Iie(e,t){const r=re(()=>{const{isTimeDisabled:d}=e,{value:u}=t;if(!(u===null||Array.isArray(u)))return d==null?void 0:d(u)}),i=re(()=>{var d;return(d=r.value)===null||d===void 0?void 0:d.isHourDisabled}),n=re(()=>{var d;return(d=r.value)===null||d===void 0?void 0:d.isMinuteDisabled}),a=re(()=>{var d;return(d=r.value)===null||d===void 0?void 0:d.isSecondDisabled}),o=re(()=>{const{type:d,isDateDisabled:u}=e,{value:h}=t;return h===null||Array.isArray(h)||!["date","datetime"].includes(d)||!u?!1:u(h,{type:"input"})}),s=re(()=>{const{type:d}=e,{value:u}=t;if(u===null||d==="datetime"||Array.isArray(u))return!1;const h=new Date(u),f=h.getHours(),p=h.getMinutes(),v=h.getMinutes();return(i.value?i.value(f):!1)||(n.value?n.value(p,f):!1)||(a.value?a.value(v,p,f):!1)}),l=re(()=>o.value||s.value);return{isValueInvalidRef:re(()=>{const{type:d}=e;return d==="date"?o.value:d==="datetime"?l.value:!1}),isDateInvalidRef:o,isTimeInvalidRef:s,isDateTimeInvalidRef:l,isHourDisabledRef:i,isMinuteDisabledRef:n,isSecondDisabledRef:a}}function zie(e,t){const r=re(()=>{const{isTimeDisabled:u}=e,{value:h}=t;return!Array.isArray(h)||!u?[void 0,void 0]:[u==null?void 0:u(h[0],"start",h),u==null?void 0:u(h[1],"end",h)]}),i={isStartHourDisabledRef:re(()=>{var u;return(u=r.value[0])===null||u===void 0?void 0:u.isHourDisabled}),isEndHourDisabledRef:re(()=>{var u;return(u=r.value[1])===null||u===void 0?void 0:u.isHourDisabled}),isStartMinuteDisabledRef:re(()=>{var u;return(u=r.value[0])===null||u===void 0?void 0:u.isMinuteDisabled}),isEndMinuteDisabledRef:re(()=>{var u;return(u=r.value[1])===null||u===void 0?void 0:u.isMinuteDisabled}),isStartSecondDisabledRef:re(()=>{var u;return(u=r.value[0])===null||u===void 0?void 0:u.isSecondDisabled}),isEndSecondDisabledRef:re(()=>{var u;return(u=r.value[1])===null||u===void 0?void 0:u.isSecondDisabled})},n=re(()=>{const{type:u,isDateDisabled:h}=e,{value:f}=t;return f===null||!Array.isArray(f)||!["daterange","datetimerange"].includes(u)||!h?!1:h(f[0],"start",f)}),a=re(()=>{const{type:u,isDateDisabled:h}=e,{value:f}=t;return f===null||!Array.isArray(f)||!["daterange","datetimerange"].includes(u)||!h?!1:h(f[1],"end",f)}),o=re(()=>{const{type:u}=e,{value:h}=t;if(h===null||!Array.isArray(h)||u!=="datetimerange")return!1;const f=Yc(h[0]),p=Xb(h[0]),v=Kb(h[0]),{isStartHourDisabledRef:m,isStartMinuteDisabledRef:g,isStartSecondDisabledRef:y}=i;return(m.value?m.value(f):!1)||(g.value?g.value(p,f):!1)||(y.value?y.value(v,p,f):!1)}),s=re(()=>{const{type:u}=e,{value:h}=t;if(h===null||!Array.isArray(h)||u!=="datetimerange")return!1;const f=Yc(h[1]),p=Xb(h[1]),v=Kb(h[1]),{isEndHourDisabledRef:m,isEndMinuteDisabledRef:g,isEndSecondDisabledRef:y}=i;return(m.value?m.value(f):!1)||(g.value?g.value(p,f):!1)||(y.value?y.value(v,p,f):!1)}),l=re(()=>n.value||o.value),c=re(()=>a.value||s.value),d=re(()=>l.value||c.value);return Object.assign(Object.assign({},i),{isStartDateInvalidRef:n,isEndDateInvalidRef:a,isStartTimeInvalidRef:o,isEndTimeInvalidRef:s,isStartValueInvalidRef:l,isEndValueInvalidRef:c,isRangeInvalidRef:d})}const L1="n-date-picker";var kie=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function kg(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Lie(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function i(){return this instanceof i?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(i){var n=Object.getOwnPropertyDescriptor(e,i);Object.defineProperty(r,i,n.get?n:{enumerable:!0,get:function(){return e[i]}})}),r}var x2={exports:{}},SU={exports:{}};(function(e){function t(r){return r&&r.__esModule?r:{default:r}}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(SU);var Ri=SU.exports,w2={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;function r(i,n){if(i==null)throw new TypeError("assign requires that input parameter not be null or undefined");for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a]);return i}e.exports=t.default})(w2,w2.exports);var Bie=w2.exports;(function(e,t){var r=Ri.default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;var i=r(Bie);function n(a){return(0,i.default)({},a)}e.exports=t.default})(x2,x2.exports);var Fie=x2.exports;const Nie=kg(Fie);var S2={exports:{}},C2={exports:{}},_2={exports:{}},CU={exports:{}};(function(e){function t(r){"@babel/helpers - typeof";return e.exports=t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},e.exports.__esModule=!0,e.exports.default=e.exports,t(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(CU);var _U=CU.exports,A2={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;function r(i,n){if(n.length<i)throw new TypeError(i+" argument"+(i>1?"s":"")+" required, but only "+n.length+" present")}e.exports=t.default})(A2,A2.exports);var Ia=A2.exports;(function(e,t){var r=Ri.default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var i=r(_U),n=r(Ia);function a(o){return(0,n.default)(1,arguments),o instanceof Date||(0,i.default)(o)==="object"&&Object.prototype.toString.call(o)==="[object Date]"}e.exports=t.default})(_2,_2.exports);var Uie=_2.exports,M2={exports:{}};(function(e,t){var r=Ri.default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var i=r(_U),n=r(Ia);function a(o){(0,n.default)(1,arguments);var s=Object.prototype.toString.call(o);return o instanceof Date||(0,i.default)(o)==="object"&&s==="[object Date]"?new Date(o.getTime()):typeof o=="number"||s==="[object Number]"?new Date(o):((typeof o=="string"||s==="[object String]")&&typeof console<"u"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(new Error().stack)),new Date(NaN))}e.exports=t.default})(M2,M2.exports);var dl=M2.exports;(function(e,t){var r=Ri.default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var i=r(Uie),n=r(dl),a=r(Ia);function o(s){if((0,a.default)(1,arguments),!(0,i.default)(s)&&typeof s!="number")return!1;var l=(0,n.default)(s);return!isNaN(Number(l))}e.exports=t.default})(C2,C2.exports);var jie=C2.exports,E2={exports:{}},T2={exports:{}},P2={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;function r(i){if(i===null||i===!0||i===!1)return NaN;var n=Number(i);return isNaN(n)?n:n<0?Math.ceil(n):Math.floor(n)}e.exports=t.default})(P2,P2.exports);var yh=P2.exports;const Vie=kg(yh);(function(e,t){var r=Ri.default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var i=r(yh),n=r(dl),a=r(Ia);function o(s,l){(0,a.default)(2,arguments);var c=(0,n.default)(s).getTime(),d=(0,i.default)(l);return new Date(c+d)}e.exports=t.default})(T2,T2.exports);var Hie=T2.exports;(function(e,t){var r=Ri.default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var i=r(Hie),n=r(Ia),a=r(yh);function o(s,l){(0,n.default)(2,arguments);var c=(0,a.default)(l);return(0,i.default)(s,-c)}e.exports=t.default})(E2,E2.exports);var Wie=E2.exports,D2={exports:{}},O2={exports:{}};(function(e,t){var r=Ri.default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var i=r(dl),n=r(Ia),a=864e5;function o(s){(0,n.default)(1,arguments);var l=(0,i.default)(s),c=l.getTime();l.setUTCMonth(0,1),l.setUTCHours(0,0,0,0);var d=l.getTime(),u=c-d;return Math.floor(u/a)+1}e.exports=t.default})(O2,O2.exports);var Gie=O2.exports,R2={exports:{}},I2={exports:{}};(function(e,t){var r=Ri.default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var i=r(dl),n=r(Ia);function a(o){(0,n.default)(1,arguments);var s=1,l=(0,i.default)(o),c=l.getUTCDay(),d=(c<s?7:0)+c-s;return l.setUTCDate(l.getUTCDate()-d),l.setUTCHours(0,0,0,0),l}e.exports=t.default})(I2,I2.exports);var ET=I2.exports,z2={exports:{}},k2={exports:{}};(function(e,t){var r=Ri.default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var i=r(dl),n=r(Ia),a=r(ET);function o(s){(0,n.default)(1,arguments);var l=(0,i.default)(s),c=l.getUTCFullYear(),d=new Date(0);d.setUTCFullYear(c+1,0,4),d.setUTCHours(0,0,0,0);var u=(0,a.default)(d),h=new Date(0);h.setUTCFullYear(c,0,4),h.setUTCHours(0,0,0,0);var f=(0,a.default)(h);return l.getTime()>=u.getTime()?c+1:l.getTime()>=f.getTime()?c:c-1}e.exports=t.default})(k2,k2.exports);var AU=k2.exports;(function(e,t){var r=Ri.default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var i=r(AU),n=r(ET),a=r(Ia);function o(s){(0,a.default)(1,arguments);var l=(0,i.default)(s),c=new Date(0);c.setUTCFullYear(l,0,4),c.setUTCHours(0,0,0,0);var d=(0,n.default)(c);return d}e.exports=t.default})(z2,z2.exports);var $ie=z2.exports;(function(e,t){var r=Ri.default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=l;var i=r(dl),n=r(ET),a=r($ie),o=r(Ia),s=6048e5;function l(c){(0,o.default)(1,arguments);var d=(0,i.default)(c),u=(0,n.default)(d).getTime()-(0,a.default)(d).getTime();return Math.round(u/s)+1}e.exports=t.default})(R2,R2.exports);var qie=R2.exports,L2={exports:{}},B2={exports:{}},bh={};Object.defineProperty(bh,"__esModule",{value:!0});bh.getDefaultOptions=Yie;bh.setDefaultOptions=Xie;var MU={};function Yie(){return MU}function Xie(e){MU=e}(function(e,t){var r=Ri.default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=s;var i=r(dl),n=r(Ia),a=r(yh),o=bh;function s(l,c){var d,u,h,f,p,v,m,g;(0,n.default)(1,arguments);var y=(0,o.getDefaultOptions)(),b=(0,a.default)((d=(u=(h=(f=c==null?void 0:c.weekStartsOn)!==null&&f!==void 0?f:c==null||(p=c.locale)===null||p===void 0||(v=p.options)===null||v===void 0?void 0:v.weekStartsOn)!==null&&h!==void 0?h:y.weekStartsOn)!==null&&u!==void 0?u:(m=y.locale)===null||m===void 0||(g=m.options)===null||g===void 0?void 0:g.weekStartsOn)!==null&&d!==void 0?d:0);if(!(b>=0&&b<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var x=(0,i.default)(l),S=x.getUTCDay(),w=(S<b?7:0)+S-b;return x.setUTCDate(x.getUTCDate()-w),x.setUTCHours(0,0,0,0),x}e.exports=t.default})(B2,B2.exports);var TT=B2.exports,F2={exports:{}},N2={exports:{}};(function(e,t){var r=Ri.default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=l;var i=r(dl),n=r(Ia),a=r(TT),o=r(yh),s=bh;function l(c,d){var u,h,f,p,v,m,g,y;(0,n.default)(1,arguments);var b=(0,i.default)(c),x=b.getUTCFullYear(),S=(0,s.getDefaultOptions)(),w=(0,o.default)((u=(h=(f=(p=d==null?void 0:d.firstWeekContainsDate)!==null&&p!==void 0?p:d==null||(v=d.locale)===null||v===void 0||(m=v.options)===null||m===void 0?void 0:m.firstWeekContainsDate)!==null&&f!==void 0?f:S.firstWeekContainsDate)!==null&&h!==void 0?h:(g=S.locale)===null||g===void 0||(y=g.options)===null||y===void 0?void 0:y.firstWeekContainsDate)!==null&&u!==void 0?u:1);if(!(w>=1&&w<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var _=new Date(0);_.setUTCFullYear(x+1,0,w),_.setUTCHours(0,0,0,0);var C=(0,a.default)(_,d),A=new Date(0);A.setUTCFullYear(x,0,w),A.setUTCHours(0,0,0,0);var M=(0,a.default)(A,d);return b.getTime()>=C.getTime()?x+1:b.getTime()>=M.getTime()?x:x-1}e.exports=t.default})(N2,N2.exports);var EU=N2.exports;(function(e,t){var r=Ri.default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=l;var i=r(EU),n=r(Ia),a=r(TT),o=r(yh),s=bh;function l(c,d){var u,h,f,p,v,m,g,y;(0,n.default)(1,arguments);var b=(0,s.getDefaultOptions)(),x=(0,o.default)((u=(h=(f=(p=d==null?void 0:d.firstWeekContainsDate)!==null&&p!==void 0?p:d==null||(v=d.locale)===null||v===void 0||(m=v.options)===null||m===void 0?void 0:m.firstWeekContainsDate)!==null&&f!==void 0?f:b.firstWeekContainsDate)!==null&&h!==void 0?h:(g=b.locale)===null||g===void 0||(y=g.options)===null||y===void 0?void 0:y.firstWeekContainsDate)!==null&&u!==void 0?u:1),S=(0,i.default)(c,d),w=new Date(0);w.setUTCFullYear(S,0,x),w.setUTCHours(0,0,0,0);var _=(0,a.default)(w,d);return _}e.exports=t.default})(F2,F2.exports);var Kie=F2.exports;(function(e,t){var r=Ri.default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=l;var i=r(dl),n=r(TT),a=r(Kie),o=r(Ia),s=6048e5;function l(c,d){(0,o.default)(1,arguments);var u=(0,i.default)(c),h=(0,n.default)(u,d).getTime()-(0,a.default)(u,d).getTime();return Math.round(h/s)+1}e.exports=t.default})(L2,L2.exports);var Qie=L2.exports,U2={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;function r(i,n){for(var a=i<0?"-":"",o=Math.abs(i).toString();o.length<n;)o="0"+o;return a+o}e.exports=t.default})(U2,U2.exports);var TU=U2.exports,j2={exports:{}};(function(e,t){var r=Ri.default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(TU),n={y:function(s,l){var c=s.getUTCFullYear(),d=c>0?c:1-c;return(0,i.default)(l==="yy"?d%100:d,l.length)},M:function(s,l){var c=s.getUTCMonth();return l==="M"?String(c+1):(0,i.default)(c+1,2)},d:function(s,l){return(0,i.default)(s.getUTCDate(),l.length)},a:function(s,l){var c=s.getUTCHours()/12>=1?"pm":"am";switch(l){case"a":case"aa":return c.toUpperCase();case"aaa":return c;case"aaaaa":return c[0];case"aaaa":default:return c==="am"?"a.m.":"p.m."}},h:function(s,l){return(0,i.default)(s.getUTCHours()%12||12,l.length)},H:function(s,l){return(0,i.default)(s.getUTCHours(),l.length)},m:function(s,l){return(0,i.default)(s.getUTCMinutes(),l.length)},s:function(s,l){return(0,i.default)(s.getUTCSeconds(),l.length)},S:function(s,l){var c=l.length,d=s.getUTCMilliseconds(),u=Math.floor(d*Math.pow(10,c-3));return(0,i.default)(u,l.length)}},a=n;t.default=a,e.exports=t.default})(j2,j2.exports);var Zie=j2.exports;(function(e,t){var r=Ri.default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(Gie),n=r(qie),a=r(AU),o=r(Qie),s=r(EU),l=r(TU),c=r(Zie),d={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},u={G:function(g,y,b){var x=g.getUTCFullYear()>0?1:0;switch(y){case"G":case"GG":case"GGG":return b.era(x,{width:"abbreviated"});case"GGGGG":return b.era(x,{width:"narrow"});case"GGGG":default:return b.era(x,{width:"wide"})}},y:function(g,y,b){if(y==="yo"){var x=g.getUTCFullYear(),S=x>0?x:1-x;return b.ordinalNumber(S,{unit:"year"})}return c.default.y(g,y)},Y:function(g,y,b,x){var S=(0,s.default)(g,x),w=S>0?S:1-S;if(y==="YY"){var _=w%100;return(0,l.default)(_,2)}return y==="Yo"?b.ordinalNumber(w,{unit:"year"}):(0,l.default)(w,y.length)},R:function(g,y){var b=(0,a.default)(g);return(0,l.default)(b,y.length)},u:function(g,y){var b=g.getUTCFullYear();return(0,l.default)(b,y.length)},Q:function(g,y,b){var x=Math.ceil((g.getUTCMonth()+1)/3);switch(y){case"Q":return String(x);case"QQ":return(0,l.default)(x,2);case"Qo":return b.ordinalNumber(x,{unit:"quarter"});case"QQQ":return b.quarter(x,{width:"abbreviated",context:"formatting"});case"QQQQQ":return b.quarter(x,{width:"narrow",context:"formatting"});case"QQQQ":default:return b.quarter(x,{width:"wide",context:"formatting"})}},q:function(g,y,b){var x=Math.ceil((g.getUTCMonth()+1)/3);switch(y){case"q":return String(x);case"qq":return(0,l.default)(x,2);case"qo":return b.ordinalNumber(x,{unit:"quarter"});case"qqq":return b.quarter(x,{width:"abbreviated",context:"standalone"});case"qqqqq":return b.quarter(x,{width:"narrow",context:"standalone"});case"qqqq":default:return b.quarter(x,{width:"wide",context:"standalone"})}},M:function(g,y,b){var x=g.getUTCMonth();switch(y){case"M":case"MM":return c.default.M(g,y);case"Mo":return b.ordinalNumber(x+1,{unit:"month"});case"MMM":return b.month(x,{width:"abbreviated",context:"formatting"});case"MMMMM":return b.month(x,{width:"narrow",context:"formatting"});case"MMMM":default:return b.month(x,{width:"wide",context:"formatting"})}},L:function(g,y,b){var x=g.getUTCMonth();switch(y){case"L":return String(x+1);case"LL":return(0,l.default)(x+1,2);case"Lo":return b.ordinalNumber(x+1,{unit:"month"});case"LLL":return b.month(x,{width:"abbreviated",context:"standalone"});case"LLLLL":return b.month(x,{width:"narrow",context:"standalone"});case"LLLL":default:return b.month(x,{width:"wide",context:"standalone"})}},w:function(g,y,b,x){var S=(0,o.default)(g,x);return y==="wo"?b.ordinalNumber(S,{unit:"week"}):(0,l.default)(S,y.length)},I:function(g,y,b){var x=(0,n.default)(g);return y==="Io"?b.ordinalNumber(x,{unit:"week"}):(0,l.default)(x,y.length)},d:function(g,y,b){return y==="do"?b.ordinalNumber(g.getUTCDate(),{unit:"date"}):c.default.d(g,y)},D:function(g,y,b){var x=(0,i.default)(g);return y==="Do"?b.ordinalNumber(x,{unit:"dayOfYear"}):(0,l.default)(x,y.length)},E:function(g,y,b){var x=g.getUTCDay();switch(y){case"E":case"EE":case"EEE":return b.day(x,{width:"abbreviated",context:"formatting"});case"EEEEE":return b.day(x,{width:"narrow",context:"formatting"});case"EEEEEE":return b.day(x,{width:"short",context:"formatting"});case"EEEE":default:return b.day(x,{width:"wide",context:"formatting"})}},e:function(g,y,b,x){var S=g.getUTCDay(),w=(S-x.weekStartsOn+8)%7||7;switch(y){case"e":return String(w);case"ee":return(0,l.default)(w,2);case"eo":return b.ordinalNumber(w,{unit:"day"});case"eee":return b.day(S,{width:"abbreviated",context:"formatting"});case"eeeee":return b.day(S,{width:"narrow",context:"formatting"});case"eeeeee":return b.day(S,{width:"short",context:"formatting"});case"eeee":default:return b.day(S,{width:"wide",context:"formatting"})}},c:function(g,y,b,x){var S=g.getUTCDay(),w=(S-x.weekStartsOn+8)%7||7;switch(y){case"c":return String(w);case"cc":return(0,l.default)(w,y.length);case"co":return b.ordinalNumber(w,{unit:"day"});case"ccc":return b.day(S,{width:"abbreviated",context:"standalone"});case"ccccc":return b.day(S,{width:"narrow",context:"standalone"});case"cccccc":return b.day(S,{width:"short",context:"standalone"});case"cccc":default:return b.day(S,{width:"wide",context:"standalone"})}},i:function(g,y,b){var x=g.getUTCDay(),S=x===0?7:x;switch(y){case"i":return String(S);case"ii":return(0,l.default)(S,y.length);case"io":return b.ordinalNumber(S,{unit:"day"});case"iii":return b.day(x,{width:"abbreviated",context:"formatting"});case"iiiii":return b.day(x,{width:"narrow",context:"formatting"});case"iiiiii":return b.day(x,{width:"short",context:"formatting"});case"iiii":default:return b.day(x,{width:"wide",context:"formatting"})}},a:function(g,y,b){var x=g.getUTCHours(),S=x/12>=1?"pm":"am";switch(y){case"a":case"aa":return b.dayPeriod(S,{width:"abbreviated",context:"formatting"});case"aaa":return b.dayPeriod(S,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return b.dayPeriod(S,{width:"narrow",context:"formatting"});case"aaaa":default:return b.dayPeriod(S,{width:"wide",context:"formatting"})}},b:function(g,y,b){var x=g.getUTCHours(),S;switch(x===12?S=d.noon:x===0?S=d.midnight:S=x/12>=1?"pm":"am",y){case"b":case"bb":return b.dayPeriod(S,{width:"abbreviated",context:"formatting"});case"bbb":return b.dayPeriod(S,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return b.dayPeriod(S,{width:"narrow",context:"formatting"});case"bbbb":default:return b.dayPeriod(S,{width:"wide",context:"formatting"})}},B:function(g,y,b){var x=g.getUTCHours(),S;switch(x>=17?S=d.evening:x>=12?S=d.afternoon:x>=4?S=d.morning:S=d.night,y){case"B":case"BB":case"BBB":return b.dayPeriod(S,{width:"abbreviated",context:"formatting"});case"BBBBB":return b.dayPeriod(S,{width:"narrow",context:"formatting"});case"BBBB":default:return b.dayPeriod(S,{width:"wide",context:"formatting"})}},h:function(g,y,b){if(y==="ho"){var x=g.getUTCHours()%12;return x===0&&(x=12),b.ordinalNumber(x,{unit:"hour"})}return c.default.h(g,y)},H:function(g,y,b){return y==="Ho"?b.ordinalNumber(g.getUTCHours(),{unit:"hour"}):c.default.H(g,y)},K:function(g,y,b){var x=g.getUTCHours()%12;return y==="Ko"?b.ordinalNumber(x,{unit:"hour"}):(0,l.default)(x,y.length)},k:function(g,y,b){var x=g.getUTCHours();return x===0&&(x=24),y==="ko"?b.ordinalNumber(x,{unit:"hour"}):(0,l.default)(x,y.length)},m:function(g,y,b){return y==="mo"?b.ordinalNumber(g.getUTCMinutes(),{unit:"minute"}):c.default.m(g,y)},s:function(g,y,b){return y==="so"?b.ordinalNumber(g.getUTCSeconds(),{unit:"second"}):c.default.s(g,y)},S:function(g,y){return c.default.S(g,y)},X:function(g,y,b,x){var S=x._originalDate||g,w=S.getTimezoneOffset();if(w===0)return"Z";switch(y){case"X":return f(w);case"XXXX":case"XX":return p(w);case"XXXXX":case"XXX":default:return p(w,":")}},x:function(g,y,b,x){var S=x._originalDate||g,w=S.getTimezoneOffset();switch(y){case"x":return f(w);case"xxxx":case"xx":return p(w);case"xxxxx":case"xxx":default:return p(w,":")}},O:function(g,y,b,x){var S=x._originalDate||g,w=S.getTimezoneOffset();switch(y){case"O":case"OO":case"OOO":return"GMT"+h(w,":");case"OOOO":default:return"GMT"+p(w,":")}},z:function(g,y,b,x){var S=x._originalDate||g,w=S.getTimezoneOffset();switch(y){case"z":case"zz":case"zzz":return"GMT"+h(w,":");case"zzzz":default:return"GMT"+p(w,":")}},t:function(g,y,b,x){var S=x._originalDate||g,w=Math.floor(S.getTime()/1e3);return(0,l.default)(w,y.length)},T:function(g,y,b,x){var S=x._originalDate||g,w=S.getTime();return(0,l.default)(w,y.length)}};function h(m,g){var y=m>0?"-":"+",b=Math.abs(m),x=Math.floor(b/60),S=b%60;if(S===0)return y+String(x);var w=g;return y+String(x)+w+(0,l.default)(S,2)}function f(m,g){if(m%60===0){var y=m>0?"-":"+";return y+(0,l.default)(Math.abs(m)/60,2)}return p(m,g)}function p(m,g){var y=g||"",b=m>0?"-":"+",x=Math.abs(m),S=(0,l.default)(Math.floor(x/60),2),w=(0,l.default)(x%60,2);return b+S+y+w}var v=u;t.default=v,e.exports=t.default})(D2,D2.exports);var Jie=D2.exports,V2={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(l,c){switch(l){case"P":return c.date({width:"short"});case"PP":return c.date({width:"medium"});case"PPP":return c.date({width:"long"});case"PPPP":default:return c.date({width:"full"})}},i=function(l,c){switch(l){case"p":return c.time({width:"short"});case"pp":return c.time({width:"medium"});case"ppp":return c.time({width:"long"});case"pppp":default:return c.time({width:"full"})}},n=function(l,c){var d=l.match(/(P+)(p+)?/)||[],u=d[1],h=d[2];if(!h)return r(l,c);var f;switch(u){case"P":f=c.dateTime({width:"short"});break;case"PP":f=c.dateTime({width:"medium"});break;case"PPP":f=c.dateTime({width:"long"});break;case"PPPP":default:f=c.dateTime({width:"full"});break}return f.replace("{{date}}",r(u,c)).replace("{{time}}",i(h,c))},a={p:i,P:n},o=a;t.default=o,e.exports=t.default})(V2,V2.exports);var ene=V2.exports,H2={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;function r(i){var n=new Date(Date.UTC(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),i.getSeconds(),i.getMilliseconds()));return n.setUTCFullYear(i.getFullYear()),i.getTime()-n.getTime()}e.exports=t.default})(H2,H2.exports);var PU=H2.exports;const zO=kg(PU);var Lg={};Object.defineProperty(Lg,"__esModule",{value:!0});Lg.isProtectedDayOfYearToken=ine;Lg.isProtectedWeekYearToken=nne;Lg.throwProtectedError=ane;var tne=["D","DD"],rne=["YY","YYYY"];function ine(e){return tne.indexOf(e)!==-1}function nne(e){return rne.indexOf(e)!==-1}function ane(e,t,r){if(e==="YYYY")throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(t,"`) for formatting years to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(e==="YY")throw new RangeError("Use `yy` instead of `YY` (in `".concat(t,"`) for formatting years to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(e==="D")throw new RangeError("Use `d` instead of `D` (in `".concat(t,"`) for formatting days of the month to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(e==="DD")throw new RangeError("Use `dd` instead of `DD` (in `".concat(t,"`) for formatting days of the month to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"))}var W2={exports:{}},G2={exports:{}},$2={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},i=function(o,s,l){var c,d=r[o];return typeof d=="string"?c=d:s===1?c=d.one:c=d.other.replace("{{count}}",s.toString()),l!=null&&l.addSuffix?l.comparison&&l.comparison>0?"in "+c:c+" ago":c},n=i;t.default=n,e.exports=t.default})($2,$2.exports);var one=$2.exports,q2={exports:{}},Y2={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;function r(i){return function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=n.width?String(n.width):i.defaultWidth,o=i.formats[a]||i.formats[i.defaultWidth];return o}}e.exports=t.default})(Y2,Y2.exports);var sne=Y2.exports;(function(e,t){var r=Ri.default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(sne),n={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},a={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},o={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},s={date:(0,i.default)({formats:n,defaultWidth:"full"}),time:(0,i.default)({formats:a,defaultWidth:"full"}),dateTime:(0,i.default)({formats:o,defaultWidth:"full"})},l=s;t.default=l,e.exports=t.default})(q2,q2.exports);var lne=q2.exports,X2={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},i=function(o,s,l,c){return r[o]},n=i;t.default=n,e.exports=t.default})(X2,X2.exports);var cne=X2.exports,K2={exports:{}},Q2={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;function r(i){return function(n,a){var o=a!=null&&a.context?String(a.context):"standalone",s;if(o==="formatting"&&i.formattingValues){var l=i.defaultFormattingWidth||i.defaultWidth,c=a!=null&&a.width?String(a.width):l;s=i.formattingValues[c]||i.formattingValues[l]}else{var d=i.defaultWidth,u=a!=null&&a.width?String(a.width):i.defaultWidth;s=i.values[u]||i.values[d]}var h=i.argumentCallback?i.argumentCallback(n):n;return s[h]}}e.exports=t.default})(Q2,Q2.exports);var dne=Q2.exports;(function(e,t){var r=Ri.default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(dne),n={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},a={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},o={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},s={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},l={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},c={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},d=function(p,v){var m=Number(p),g=m%100;if(g>20||g<10)switch(g%10){case 1:return m+"st";case 2:return m+"nd";case 3:return m+"rd"}return m+"th"},u={ordinalNumber:d,era:(0,i.default)({values:n,defaultWidth:"wide"}),quarter:(0,i.default)({values:a,defaultWidth:"wide",argumentCallback:function(p){return p-1}}),month:(0,i.default)({values:o,defaultWidth:"wide"}),day:(0,i.default)({values:s,defaultWidth:"wide"}),dayPeriod:(0,i.default)({values:l,defaultWidth:"wide",formattingValues:c,defaultFormattingWidth:"wide"})},h=u;t.default=h,e.exports=t.default})(K2,K2.exports);var une=K2.exports,Z2={exports:{}},J2={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;function r(a){return function(o){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},l=s.width,c=l&&a.matchPatterns[l]||a.matchPatterns[a.defaultMatchWidth],d=o.match(c);if(!d)return null;var u=d[0],h=l&&a.parsePatterns[l]||a.parsePatterns[a.defaultParseWidth],f=Array.isArray(h)?n(h,function(m){return m.test(u)}):i(h,function(m){return m.test(u)}),p;p=a.valueCallback?a.valueCallback(f):f,p=s.valueCallback?s.valueCallback(p):p;var v=o.slice(u.length);return{value:p,rest:v}}}function i(a,o){for(var s in a)if(a.hasOwnProperty(s)&&o(a[s]))return s}function n(a,o){for(var s=0;s<a.length;s++)if(o(a[s]))return s}e.exports=t.default})(J2,J2.exports);var hne=J2.exports,eA={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;function r(i){return function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=n.match(i.matchPattern);if(!o)return null;var s=o[0],l=n.match(i.parsePattern);if(!l)return null;var c=i.valueCallback?i.valueCallback(l[0]):l[0];c=a.valueCallback?a.valueCallback(c):c;var d=n.slice(s.length);return{value:c,rest:d}}}e.exports=t.default})(eA,eA.exports);var fne=eA.exports;(function(e,t){var r=Ri.default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(hne),n=r(fne),a=/^(\d+)(th|st|nd|rd)?/i,o=/\d+/i,s={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},l={any:[/^b/i,/^(a|c)/i]},c={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},d={any:[/1/i,/2/i,/3/i,/4/i]},u={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},h={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},f={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},p={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},v={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},m={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},g={ordinalNumber:(0,n.default)({matchPattern:a,parsePattern:o,valueCallback:function(x){return parseInt(x,10)}}),era:(0,i.default)({matchPatterns:s,defaultMatchWidth:"wide",parsePatterns:l,defaultParseWidth:"any"}),quarter:(0,i.default)({matchPatterns:c,defaultMatchWidth:"wide",parsePatterns:d,defaultParseWidth:"any",valueCallback:function(x){return x+1}}),month:(0,i.default)({matchPatterns:u,defaultMatchWidth:"wide",parsePatterns:h,defaultParseWidth:"any"}),day:(0,i.default)({matchPatterns:f,defaultMatchWidth:"wide",parsePatterns:p,defaultParseWidth:"any"}),dayPeriod:(0,i.default)({matchPatterns:v,defaultMatchWidth:"any",parsePatterns:m,defaultParseWidth:"any"})},y=g;t.default=y,e.exports=t.default})(Z2,Z2.exports);var pne=Z2.exports;(function(e,t){var r=Ri.default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(one),n=r(lne),a=r(cne),o=r(une),s=r(pne),l={code:"en-US",formatDistance:i.default,formatLong:n.default,formatRelative:a.default,localize:o.default,match:s.default,options:{weekStartsOn:0,firstWeekContainsDate:1}},c=l;t.default=c,e.exports=t.default})(G2,G2.exports);var mne=G2.exports;(function(e,t){var r=Ri.default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(mne),n=i.default;t.default=n,e.exports=t.default})(W2,W2.exports);var vne=W2.exports;(function(e,t){var r=Ri.default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=b;var i=r(jie),n=r(Wie),a=r(dl),o=r(Jie),s=r(ene),l=r(PU),c=Lg,d=r(yh),u=r(Ia),h=bh,f=r(vne),p=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,v=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,m=/^'([^]*?)'?$/,g=/''/g,y=/[a-zA-Z]/;function b(S,w,_){var C,A,M,P,T,R,z,F,H,N,U,ie,te,X,W,q,$,le;(0,u.default)(2,arguments);var ee=String(w),Q=(0,h.getDefaultOptions)(),ne=(C=(A=_==null?void 0:_.locale)!==null&&A!==void 0?A:Q.locale)!==null&&C!==void 0?C:f.default,V=(0,d.default)((M=(P=(T=(R=_==null?void 0:_.firstWeekContainsDate)!==null&&R!==void 0?R:_==null||(z=_.locale)===null||z===void 0||(F=z.options)===null||F===void 0?void 0:F.firstWeekContainsDate)!==null&&T!==void 0?T:Q.firstWeekContainsDate)!==null&&P!==void 0?P:(H=Q.locale)===null||H===void 0||(N=H.options)===null||N===void 0?void 0:N.firstWeekContainsDate)!==null&&M!==void 0?M:1);if(!(V>=1&&V<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var de=(0,d.default)((U=(ie=(te=(X=_==null?void 0:_.weekStartsOn)!==null&&X!==void 0?X:_==null||(W=_.locale)===null||W===void 0||(q=W.options)===null||q===void 0?void 0:q.weekStartsOn)!==null&&te!==void 0?te:Q.weekStartsOn)!==null&&ie!==void 0?ie:($=Q.locale)===null||$===void 0||(le=$.options)===null||le===void 0?void 0:le.weekStartsOn)!==null&&U!==void 0?U:0);if(!(de>=0&&de<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!ne.localize)throw new RangeError("locale must contain localize property");if(!ne.formatLong)throw new RangeError("locale must contain formatLong property");var me=(0,a.default)(S);if(!(0,i.default)(me))throw new RangeError("Invalid time value");var Ce=(0,l.default)(me),G=(0,n.default)(me,Ce),Z={firstWeekContainsDate:V,weekStartsOn:de,locale:ne,_originalDate:me},ue=ee.match(v).map(function(Se){var we=Se[0];if(we==="p"||we==="P"){var _e=s.default[we];return _e(Se,ne.formatLong)}return Se}).join("").match(p).map(function(Se){if(Se==="''")return"'";var we=Se[0];if(we==="'")return x(Se);var _e=o.default[we];if(_e)return!(_!=null&&_.useAdditionalWeekYearTokens)&&(0,c.isProtectedWeekYearToken)(Se)&&(0,c.throwProtectedError)(Se,w,String(S)),!(_!=null&&_.useAdditionalDayOfYearTokens)&&(0,c.isProtectedDayOfYearToken)(Se)&&(0,c.throwProtectedError)(Se,w,String(S)),_e(G,Se,ne.localize,Z);if(we.match(y))throw new RangeError("Format string contains an unescaped latin alphabet character `"+we+"`");return Se}).join("");return ue}function x(S){var w=S.match(m);return w?w[1].replace(g,"'"):S}e.exports=t.default})(S2,S2.exports);var gne=S2.exports;const yne=kg(gne);function kO(e,t,r){var i=wne(e,r.timeZone,r.locale);return i.formatToParts?bne(i,t):xne(i,t)}function bne(e,t){for(var r=e.formatToParts(t),i=r.length-1;i>=0;--i)if(r[i].type==="timeZoneName")return r[i].value}function xne(e,t){var r=e.format(t).replace(/\u200E/g,""),i=/ [\w-+ ]+$/.exec(r);return i?i[0].substr(1):""}function wne(e,t,r){if(r&&!r.code)throw new Error("date-fns-tz error: Please set a language code on the locale object imported from date-fns, e.g. `locale.code = 'en-US'`");return new Intl.DateTimeFormat(r?[r.code,"en-US"]:void 0,{timeZone:t,timeZoneName:e})}function Sne(e,t){var r=Mne(t);return r.formatToParts?_ne(r,e):Ane(r,e)}var Cne={year:0,month:1,day:2,hour:3,minute:4,second:5};function _ne(e,t){try{for(var r=e.formatToParts(t),i=[],n=0;n<r.length;n++){var a=Cne[r[n].type];a>=0&&(i[a]=parseInt(r[n].value,10))}return i}catch(o){if(o instanceof RangeError)return[NaN];throw o}}function Ane(e,t){var r=e.format(t),i=/(\d+)\/(\d+)\/(\d+),? (\d+):(\d+):(\d+)/.exec(r);return[i[3],i[1],i[2],i[4],i[5],i[6]]}var aS={};function Mne(e){if(!aS[e]){var t=new Intl.DateTimeFormat("en-US",{hourCycle:"h23",timeZone:"America/New_York",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(new Date("2014-06-25T04:00:00.123Z")),r=t==="06/25/2014, 00:00:00"||t==="‎06‎/‎25‎/‎2014‎ ‎00‎:‎00‎:‎00";aS[e]=r?new Intl.DateTimeFormat("en-US",{hourCycle:"h23",timeZone:e,year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:e,year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}return aS[e]}function DU(e,t,r,i,n,a,o){var s=new Date(0);return s.setUTCFullYear(e,t,r),s.setUTCHours(i,n,a,o),s}var LO=36e5,Ene=6e4,oS={timezone:/([Z+-].*)$/,timezoneZ:/^(Z)$/,timezoneHH:/^([+-]\d{2})$/,timezoneHHMM:/^([+-])(\d{2}):?(\d{2})$/};function PT(e,t,r){var i,n;if(!e||(i=oS.timezoneZ.exec(e),i))return 0;var a;if(i=oS.timezoneHH.exec(e),i)return a=parseInt(i[1],10),BO(a)?-(a*LO):NaN;if(i=oS.timezoneHHMM.exec(e),i){a=parseInt(i[2],10);var o=parseInt(i[3],10);return BO(a,o)?(n=Math.abs(a)*LO+o*Ene,i[1]==="+"?-n:n):NaN}if(Dne(e)){t=new Date(t||Date.now());var s=r?t:Tne(t),l=tA(s,e),c=r?l:Pne(t,l,e);return-c}return NaN}function Tne(e){return DU(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}function tA(e,t){var r=Sne(e,t),i=DU(r[0],r[1]-1,r[2],r[3]%24,r[4],r[5],0).getTime(),n=e.getTime(),a=n%1e3;return n-=a>=0?a:1e3+a,i-n}function Pne(e,t,r){var i=e.getTime(),n=i-t,a=tA(new Date(n),r);if(t===a)return t;n-=a-t;var o=tA(new Date(n),r);return a===o?a:Math.max(a,o)}function BO(e,t){return-23<=e&&e<=23&&(t==null||0<=t&&t<=59)}var FO={};function Dne(e){if(FO[e])return!0;try{return new Intl.DateTimeFormat(void 0,{timeZone:e}),FO[e]=!0,!0}catch{return!1}}var One=60*1e3,Rne={X:function(e,t,r,i){var n=sS(i.timeZone,e);if(n===0)return"Z";switch(t){case"X":return NO(n);case"XXXX":case"XX":return vf(n);case"XXXXX":case"XXX":default:return vf(n,":")}},x:function(e,t,r,i){var n=sS(i.timeZone,e);switch(t){case"x":return NO(n);case"xxxx":case"xx":return vf(n);case"xxxxx":case"xxx":default:return vf(n,":")}},O:function(e,t,r,i){var n=sS(i.timeZone,e);switch(t){case"O":case"OO":case"OOO":return"GMT"+Ine(n,":");case"OOOO":default:return"GMT"+vf(n,":")}},z:function(e,t,r,i){switch(t){case"z":case"zz":case"zzz":return kO("short",e,i);case"zzzz":default:return kO("long",e,i)}}};function sS(e,t){var r=e?PT(e,t,!0)/One:t.getTimezoneOffset();if(Number.isNaN(r))throw new RangeError("Invalid time zone specified: "+e);return r}function rx(e,t){for(var r=e<0?"-":"",i=Math.abs(e).toString();i.length<t;)i="0"+i;return r+i}function vf(e,t){var r=t||"",i=e>0?"-":"+",n=Math.abs(e),a=rx(Math.floor(n/60),2),o=rx(Math.floor(n%60),2);return i+a+r+o}function NO(e,t){if(e%60===0){var r=e>0?"-":"+";return r+rx(Math.abs(e)/60,2)}return vf(e,t)}function Ine(e,t){var r=e>0?"-":"+",i=Math.abs(e),n=Math.floor(i/60),a=i%60;if(a===0)return r+String(n);var o=t;return r+String(n)+o+rx(a,2)}var zne=/(Z|[+-]\d{2}(?::?\d{2})?| UTC| [a-zA-Z]+\/[a-zA-Z_]+(?:\/[a-zA-Z_]+)?)$/,lS=36e5,UO=6e4,kne=2,Ma={dateTimePattern:/^([0-9W+-]+)(T| )(.*)/,datePattern:/^([0-9W+-]+)(.*)/,plainTime:/:/,YY:/^(\d{2})$/,YYY:[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],YYYY:/^(\d{4})/,YYYYY:[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],MM:/^-(\d{2})$/,DDD:/^-?(\d{3})$/,MMDD:/^-?(\d{2})-?(\d{2})$/,Www:/^-?W(\d{2})$/,WwwD:/^-?W(\d{2})-?(\d{1})$/,HH:/^(\d{2}([.,]\d*)?)$/,HHMM:/^(\d{2}):?(\d{2}([.,]\d*)?)$/,HHMMSS:/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,timeZone:zne};function OU(e,t){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");if(e===null)return new Date(NaN);var r=t||{},i=r.additionalDigits==null?kne:Vie(r.additionalDigits);if(i!==2&&i!==1&&i!==0)throw new RangeError("additionalDigits must be 0, 1 or 2");if(e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]")return new Date(e.getTime());if(typeof e=="number"||Object.prototype.toString.call(e)==="[object Number]")return new Date(e);if(!(typeof e=="string"||Object.prototype.toString.call(e)==="[object String]"))return new Date(NaN);var n=Lne(e),a=Bne(n.date,i),o=a.year,s=a.restDateString,l=Fne(s,o);if(isNaN(l))return new Date(NaN);if(l){var c=l.getTime(),d=0,u;if(n.time&&(d=Nne(n.time),isNaN(d)))return new Date(NaN);if(n.timeZone||r.timeZone){if(u=PT(n.timeZone||r.timeZone,new Date(c+d)),isNaN(u))return new Date(NaN)}else u=zO(new Date(c+d)),u=zO(new Date(c+d+u));return new Date(c+d+u)}else return new Date(NaN)}function Lne(e){var t={},r=Ma.dateTimePattern.exec(e),i;if(r?(t.date=r[1],i=r[3]):(r=Ma.datePattern.exec(e),r?(t.date=r[1],i=r[2]):(t.date=null,i=e)),i){var n=Ma.timeZone.exec(i);n?(t.time=i.replace(n[1],""),t.timeZone=n[1].trim()):t.time=i}return t}function Bne(e,t){var r=Ma.YYY[t],i=Ma.YYYYY[t],n;if(n=Ma.YYYY.exec(e)||i.exec(e),n){var a=n[1];return{year:parseInt(a,10),restDateString:e.slice(a.length)}}if(n=Ma.YY.exec(e)||r.exec(e),n){var o=n[1];return{year:parseInt(o,10)*100,restDateString:e.slice(o.length)}}return{year:null}}function Fne(e,t){if(t===null)return null;var r,i,n,a;if(e.length===0)return i=new Date(0),i.setUTCFullYear(t),i;if(r=Ma.MM.exec(e),r)return i=new Date(0),n=parseInt(r[1],10)-1,VO(t,n)?(i.setUTCFullYear(t,n),i):new Date(NaN);if(r=Ma.DDD.exec(e),r){i=new Date(0);var o=parseInt(r[1],10);return Vne(t,o)?(i.setUTCFullYear(t,0,o),i):new Date(NaN)}if(r=Ma.MMDD.exec(e),r){i=new Date(0),n=parseInt(r[1],10)-1;var s=parseInt(r[2],10);return VO(t,n,s)?(i.setUTCFullYear(t,n,s),i):new Date(NaN)}if(r=Ma.Www.exec(e),r)return a=parseInt(r[1],10)-1,HO(t,a)?jO(t,a):new Date(NaN);if(r=Ma.WwwD.exec(e),r){a=parseInt(r[1],10)-1;var l=parseInt(r[2],10)-1;return HO(t,a,l)?jO(t,a,l):new Date(NaN)}return null}function Nne(e){var t,r,i;if(t=Ma.HH.exec(e),t)return r=parseFloat(t[1].replace(",",".")),cS(r)?r%24*lS:NaN;if(t=Ma.HHMM.exec(e),t)return r=parseInt(t[1],10),i=parseFloat(t[2].replace(",",".")),cS(r,i)?r%24*lS+i*UO:NaN;if(t=Ma.HHMMSS.exec(e),t){r=parseInt(t[1],10),i=parseInt(t[2],10);var n=parseFloat(t[3].replace(",","."));return cS(r,i,n)?r%24*lS+i*UO+n*1e3:NaN}return null}function jO(e,t,r){t=t||0,r=r||0;var i=new Date(0);i.setUTCFullYear(e,0,4);var n=i.getUTCDay()||7,a=t*7+r+1-n;return i.setUTCDate(i.getUTCDate()+a),i}var Une=[31,28,31,30,31,30,31,31,30,31,30,31],jne=[31,29,31,30,31,30,31,31,30,31,30,31];function RU(e){return e%400===0||e%4===0&&e%100!==0}function VO(e,t,r){if(t<0||t>11)return!1;if(r!=null){if(r<1)return!1;var i=RU(e);if(i&&r>jne[t]||!i&&r>Une[t])return!1}return!0}function Vne(e,t){if(t<1)return!1;var r=RU(e);return!(r&&t>366||!r&&t>365)}function HO(e,t,r){return!(t<0||t>52||r!=null&&(r<0||r>6))}function cS(e,t,r){return!(e!=null&&(e<0||e>=25)||t!=null&&(t<0||t>=60)||r!=null&&(r<0||r>=60))}var Hne=/([xXOz]+)|''|'(''|[^'])+('|$)/g;function Wne(e,t,r){var i=String(t),n=r||{},a=i.match(Hne);if(a){var o=OU(n.originalDate||e,n);i=a.reduce(function(s,l){if(l[0]==="'")return s;var c=s.indexOf(l),d=s[c-1]==="'",u=s.replace(l,"'"+Rne[l[0]](o,l,null,n)+"'");return d?u.substring(0,c-1)+u.substring(c+1):u},i)}return yne(e,i,n)}function Gne(e,t,r){var i=OU(e,r),n=PT(t,i,!0),a=new Date(i.getTime()-n),o=new Date(0);return o.setFullYear(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate()),o.setHours(a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds(),a.getUTCMilliseconds()),o}function $ne(e,t,r,i){var n=Nie(i);return n.timeZone=t,n.originalDate=e,Wne(Gne(e,t),r,n)}const Ym={amHours:["00","01","02","03","04","05","06","07","08","09","10","11"],pmHours:["12","01","02","03","04","05","06","07","08","09","10","11"],hours:["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23"],minutes:["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59"],seconds:["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59"],period:["AM","PM"]};function dS(e){return`00${e}`.slice(-2)}function Xm(e,t,r){return Array.isArray(t)?(r==="am"?t.filter(i=>i<12):r==="pm"?t.filter(i=>i>=12).map(i=>i===12?12:i-12):t).map(i=>dS(i)):typeof t=="number"?r==="am"?e.filter(i=>{const n=Number(i);return n<12&&n%t===0}):r==="pm"?e.filter(i=>{const n=Number(i);return n>=12&&n%t===0}).map(i=>{const n=Number(i);return dS(n===12?12:n-12)}):e.filter(i=>Number(i)%t===0):r==="am"?e.filter(i=>Number(i)<12):r==="pm"?e.map(i=>Number(i)).filter(i=>Number(i)>=12).map(i=>dS(i===12?12:i-12)):e}function T0(e,t,r){return r?typeof r=="number"?e%r===0:r.includes(e):!0}function qne(e,t,r){const i=Xm(Ym[t],r).map(Number);let n,a;for(let o=0;o<i.length;++o){const s=i[o];if(s===e)return s;if(s>e){a=s;break}n=s}return n===void 0?(a||C1("time-picker","Please set 'hours' or 'minutes' or 'seconds' props"),a):a===void 0||a-e>e-n?n:a}function Yne(e){return Yc(e)<12?"am":"pm"}const IU="n-time-picker",P0=Ve({name:"TimePickerPanelCol",props:{clsPrefix:{type:String,required:!0},data:{type:Array,required:!0},activeValue:{type:Number,default:null},onItemClick:Function},render(){const{activeValue:e,onItemClick:t,clsPrefix:r}=this;return this.data.map(i=>{const{label:n,disabled:a,value:o}=i,s=e===o;return E("div",{key:n,"data-active":s?"":null,class:[`${r}-time-picker-col__item`,s&&`${r}-time-picker-col__item--active`,a&&`${r}-time-picker-col__item--disabled`],onClick:t&&!a?()=>{t(o)}:void 0},n)})}}),Xne={actions:{type:Array,default:()=>["now","confirm"]},showHour:{type:Boolean,default:!0},showMinute:{type:Boolean,default:!0},showSecond:{type:Boolean,default:!0},showPeriod:{type:Boolean,default:!0},isHourInvalid:Boolean,isMinuteInvalid:Boolean,isSecondInvalid:Boolean,isAmPmInvalid:Boolean,isValueInvalid:Boolean,hourValue:{type:Number,default:null},minuteValue:{type:Number,default:null},secondValue:{type:Number,default:null},amPmValue:{type:String,default:null},isHourDisabled:Function,isMinuteDisabled:Function,isSecondDisabled:Function,onHourClick:{type:Function,required:!0},onMinuteClick:{type:Function,required:!0},onSecondClick:{type:Function,required:!0},onAmPmClick:{type:Function,required:!0},onNowClick:Function,clearText:String,nowText:String,confirmText:String,transitionDisabled:Boolean,onClearClick:Function,onConfirmClick:Function,onFocusin:Function,onFocusout:Function,onFocusDetectorFocus:Function,onKeydown:Function,hours:[Number,Array],minutes:[Number,Array],seconds:[Number,Array],use12Hours:Boolean},Kne=Ve({name:"TimePickerPanel",props:Xne,setup(e){const{mergedThemeRef:t,mergedClsPrefixRef:r}=_t(IU),i=re(()=>{const{isHourDisabled:s,hours:l,use12Hours:c,amPmValue:d}=e;if(c){const u=d??Yne(Date.now());return Xm(Ym.hours,l,u).map(h=>{const f=Number(h),p=u==="pm"&&f!==12?f+12:f;return{label:h,value:p,disabled:s?s(p):!1}})}else return Xm(Ym.hours,l).map(u=>({label:u,value:Number(u),disabled:s?s(Number(u)):!1}))}),n=re(()=>{const{isMinuteDisabled:s,minutes:l}=e;return Xm(Ym.minutes,l).map(c=>({label:c,value:Number(c),disabled:s?s(Number(c),e.hourValue):!1}))}),a=re(()=>{const{isSecondDisabled:s,seconds:l}=e;return Xm(Ym.seconds,l).map(c=>({label:c,value:Number(c),disabled:s?s(Number(c),e.minuteValue,e.hourValue):!1}))}),o=re(()=>{const{isHourDisabled:s}=e;let l=!0,c=!0;for(let d=0;d<12;++d)if(!(s!=null&&s(d))){l=!1;break}for(let d=12;d<24;++d)if(!(s!=null&&s(d))){c=!1;break}return[{label:"AM",value:"am",disabled:l},{label:"PM",value:"pm",disabled:c}]});return{mergedTheme:t,mergedClsPrefix:r,hours:i,minutes:n,seconds:a,amPm:o,hourScrollRef:ge(null),minuteScrollRef:ge(null),secondScrollRef:ge(null),amPmScrollRef:ge(null)}},render(){var e,t,r,i;const{mergedClsPrefix:n,mergedTheme:a}=this;return E("div",{tabindex:0,class:`${n}-time-picker-panel`,onFocusin:this.onFocusin,onFocusout:this.onFocusout,onKeydown:this.onKeydown},E("div",{class:`${n}-time-picker-cols`},this.showHour?E("div",{class:[`${n}-time-picker-col`,this.isHourInvalid&&`${n}-time-picker-col--invalid`,this.transitionDisabled&&`${n}-time-picker-col--transition-disabled`]},E(bn,{ref:"hourScrollRef",theme:a.peers.Scrollbar,themeOverrides:a.peerOverrides.Scrollbar},{default:()=>[E(P0,{clsPrefix:n,data:this.hours,activeValue:this.hourValue,onItemClick:this.onHourClick}),E("div",{class:`${n}-time-picker-col__padding`})]})):null,this.showMinute?E("div",{class:[`${n}-time-picker-col`,this.transitionDisabled&&`${n}-time-picker-col--transition-disabled`,this.isMinuteInvalid&&`${n}-time-picker-col--invalid`]},E(bn,{ref:"minuteScrollRef",theme:a.peers.Scrollbar,themeOverrides:a.peerOverrides.Scrollbar},{default:()=>[E(P0,{clsPrefix:n,data:this.minutes,activeValue:this.minuteValue,onItemClick:this.onMinuteClick}),E("div",{class:`${n}-time-picker-col__padding`})]})):null,this.showSecond?E("div",{class:[`${n}-time-picker-col`,this.isSecondInvalid&&`${n}-time-picker-col--invalid`,this.transitionDisabled&&`${n}-time-picker-col--transition-disabled`]},E(bn,{ref:"secondScrollRef",theme:a.peers.Scrollbar,themeOverrides:a.peerOverrides.Scrollbar},{default:()=>[E(P0,{clsPrefix:n,data:this.seconds,activeValue:this.secondValue,onItemClick:this.onSecondClick}),E("div",{class:`${n}-time-picker-col__padding`})]})):null,this.use12Hours?E("div",{class:[`${n}-time-picker-col`,this.isAmPmInvalid&&`${n}-time-picker-col--invalid`,this.transitionDisabled&&`${n}-time-picker-col--transition-disabled`]},E(bn,{ref:"amPmScrollRef",theme:a.peers.Scrollbar,themeOverrides:a.peerOverrides.Scrollbar},{default:()=>[E(P0,{clsPrefix:n,data:this.amPm,activeValue:this.amPmValue,onItemClick:this.onAmPmClick}),E("div",{class:`${n}-time-picker-col__padding`})]})):null),!((e=this.actions)===null||e===void 0)&&e.length?E("div",{class:`${n}-time-picker-actions`},!((t=this.actions)===null||t===void 0)&&t.includes("clear")?E(li,{theme:a.peers.Button,themeOverrides:a.peerOverrides.Button,size:"tiny",onClick:this.onClearClick},{default:()=>this.clearText}):null,!((r=this.actions)===null||r===void 0)&&r.includes("now")?E(li,{size:"tiny",theme:a.peers.Button,themeOverrides:a.peerOverrides.Button,onClick:this.onNowClick},{default:()=>this.nowText}):null,!((i=this.actions)===null||i===void 0)&&i.includes("confirm")?E(li,{size:"tiny",type:"primary",class:`${n}-time-picker-actions__confirm`,theme:a.peers.Button,themeOverrides:a.peerOverrides.Button,disabled:this.isValueInvalid,onClick:this.onConfirmClick},{default:()=>this.confirmText}):null):null,E(Bd,{onFocus:this.onFocusDetectorFocus}))}}),Qne=ve([oe("time-picker",`
 z-index: auto;
 position: relative;
 `,[oe("time-picker-icon",`
 color: var(--n-icon-color-override);
 transition: color .3s var(--n-bezier);
 `),xe("disabled",[oe("time-picker-icon",`
 color: var(--n-icon-color-disabled-override);
 `)])]),oe("time-picker-panel",`
 transition:
 box-shadow .3s var(--n-bezier),
 background-color .3s var(--n-bezier);
 outline: none;
 font-size: var(--n-item-font-size);
 border-radius: var(--n-border-radius);
 margin: 4px 0;
 min-width: 104px;
 overflow: hidden;
 background-color: var(--n-panel-color);
 box-shadow: var(--n-panel-box-shadow);
 `,[Lp(),oe("time-picker-actions",`
 padding: var(--n-panel-action-padding);
 align-items: center;
 display: flex;
 justify-content: space-evenly;
 `),oe("time-picker-cols",`
 height: calc(var(--n-item-height) * 6);
 display: flex;
 position: relative;
 transition: border-color .3s var(--n-bezier);
 border-bottom: 1px solid var(--n-panel-divider-color);
 `),oe("time-picker-col",`
 flex-grow: 1;
 min-width: var(--n-item-width);
 height: calc(var(--n-item-height) * 6);
 flex-direction: column;
 transition: box-shadow .3s var(--n-bezier);
 `,[xe("transition-disabled",[he("item","transition: none;",[ve("&::before","transition: none;")])]),he("padding",`
 height: calc(var(--n-item-height) * 5);
 `),ve("&:first-child","min-width: calc(var(--n-item-width) + 4px);",[he("item",[ve("&::before","left: 4px;")])]),he("item",`
 cursor: pointer;
 height: var(--n-item-height);
 display: flex;
 align-items: center;
 justify-content: center;
 transition: 
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 opacity .3s var(--n-bezier),
 text-decoration-color .3s var(--n-bezier);
 background: #0000;
 text-decoration-color: #0000;
 color: var(--n-item-text-color);
 z-index: 0;
 box-sizing: border-box;
 padding-top: 4px;
 position: relative;
 `,[ve("&::before",`
 content: "";
 transition: background-color .3s var(--n-bezier);
 z-index: -1;
 position: absolute;
 left: 0;
 right: 4px;
 top: 4px;
 bottom: 0;
 border-radius: var(--n-item-border-radius);
 `),yr("disabled",[ve("&:hover::before",`
 background-color: var(--n-item-color-hover);
 `)]),xe("active",`
 color: var(--n-item-text-color-active);
 `,[ve("&::before",`
 background-color: var(--n-item-color-hover);
 `)]),xe("disabled",`
 opacity: var(--n-item-opacity-disabled);
 cursor: not-allowed;
 `)]),xe("invalid",[he("item",[xe("active",`
 text-decoration: line-through;
 text-decoration-color: var(--n-item-text-color-active);
 `)])])])])]);function uS(e,t){return e===void 0?!0:Array.isArray(e)?e.every(r=>r>=0&&r<=t):e>=0&&e<=t}const Zne=Object.assign(Object.assign({},bt.props),{to:jn.propTo,bordered:{type:Boolean,default:void 0},actions:Array,defaultValue:{type:Number,default:null},defaultFormattedValue:String,placeholder:String,placement:{type:String,default:"bottom-start"},value:Number,format:{type:String,default:"HH:mm:ss"},valueFormat:String,formattedValue:String,isHourDisabled:Function,size:String,isMinuteDisabled:Function,isSecondDisabled:Function,inputReadonly:Boolean,clearable:Boolean,status:String,"onUpdate:value":[Function,Array],onUpdateValue:[Function,Array],"onUpdate:show":[Function,Array],onUpdateShow:[Function,Array],onUpdateFormattedValue:[Function,Array],"onUpdate:formattedValue":[Function,Array],onBlur:[Function,Array],onConfirm:[Function,Array],onClear:Function,onFocus:[Function,Array],timeZone:String,showIcon:{type:Boolean,default:!0},disabled:{type:Boolean,default:void 0},show:{type:Boolean,default:void 0},hours:{type:[Number,Array],validator:e=>uS(e,23)},minutes:{type:[Number,Array],validator:e=>uS(e,59)},seconds:{type:[Number,Array],validator:e=>uS(e,59)},use12Hours:Boolean,stateful:{type:Boolean,default:!0},onChange:[Function,Array]}),rA=Ve({name:"TimePicker",props:Zne,setup(e){const{mergedBorderedRef:t,mergedClsPrefixRef:r,namespaceRef:i,inlineThemeDisabled:n}=mr(e),{localeRef:a,dateLocaleRef:o}=dc("TimePicker"),s=cl(e),{mergedSizeRef:l,mergedDisabledRef:c,mergedStatusRef:d}=s,u=bt("TimePicker","-time-picker",Qne,wU,e,r),h=XE(),f=ge(null),p=ge(null),v=re(()=>({locale:o.value.locale}));function m(Fe){return Fe===null?null:ja(Fe,e.valueFormat||e.format,new Date,v.value).getTime()}const{defaultValue:g,defaultFormattedValue:y}=e,b=ge(y!==void 0?m(y):g),x=re(()=>{const{formattedValue:Fe}=e;if(Fe!==void 0)return m(Fe);const{value:Ke}=e;return Ke!==void 0?Ke:b.value}),S=re(()=>{const{timeZone:Fe}=e;return Fe?(Ke,ut,Ft)=>$ne(Ke,Fe,ut,Ft):(Ke,ut,Ft)=>ai(Ke,ut,Ft)}),w=ge("");tr(()=>e.timeZone,()=>{const Fe=x.value;w.value=Fe===null?"":S.value(Fe,e.format,v.value)},{immediate:!0});const _=ge(!1),C=pt(e,"show"),A=Un(C,_),M=ge(x.value),P=ge(!1),T=re(()=>a.value.clear),R=re(()=>a.value.now),z=re(()=>e.placeholder!==void 0?e.placeholder:a.value.placeholder),F=re(()=>a.value.negativeText),H=re(()=>a.value.positiveText),N=re(()=>/H|h|K|k/.test(e.format)),U=re(()=>e.format.includes("m")),ie=re(()=>e.format.includes("s")),te=re(()=>{const{isHourDisabled:Fe}=e;return ee.value===null?!1:T0(ee.value,"hours",e.hours)?Fe?Fe(ee.value):!1:!0}),X=re(()=>{const{value:Fe}=Q,{value:Ke}=ee;if(Fe===null||Ke===null)return!1;if(!T0(Fe,"minutes",e.minutes))return!0;const{isMinuteDisabled:ut}=e;return ut?ut(Fe,Ke):!1}),W=re(()=>{const{value:Fe}=Q,{value:Ke}=ee,{value:ut}=ne;if(ut===null||Fe===null||Ke===null)return!1;if(!T0(ut,"seconds",e.seconds))return!0;const{isSecondDisabled:Ft}=e;return Ft?Ft(ut,Fe,Ke):!1}),q=re(()=>te.value||X.value||W.value),$=re(()=>e.format.length+4),le=re(()=>{const{value:Fe}=x;return Fe===null?null:Yc(Fe)<12?"am":"pm"}),ee=re(()=>{const{value:Fe}=x;return Fe===null?null:Number(S.value(Fe,"HH",v.value))}),Q=re(()=>{const{value:Fe}=x;return Fe===null?null:Number(S.value(Fe,"mm",v.value))}),ne=re(()=>{const{value:Fe}=x;return Fe===null?null:Number(S.value(Fe,"ss",v.value))});function V(Fe,Ke){const{onUpdateFormattedValue:ut,"onUpdate:formattedValue":Ft}=e;ut&&ct(ut,Fe,Ke),Ft&&ct(Ft,Fe,Ke)}function de(Fe){return Fe===null?null:S.value(Fe,e.valueFormat||e.format)}function me(Fe){const{onUpdateValue:Ke,"onUpdate:value":ut,onChange:Ft}=e,{nTriggerFormChange:ui,nTriggerFormInput:_i}=s,Ar=de(Fe);Ke&&ct(Ke,Fe,Ar),ut&&ct(ut,Fe,Ar),Ft&&ct(Ft,Fe,Ar),V(Ar,Fe),b.value=Fe,ui(),_i()}function Ce(Fe){const{onFocus:Ke}=e,{nTriggerFormFocus:ut}=s;Ke&&ct(Ke,Fe),ut()}function G(Fe){const{onBlur:Ke}=e,{nTriggerFormBlur:ut}=s;Ke&&ct(Ke,Fe),ut()}function Z(){const{onConfirm:Fe}=e;Fe&&ct(Fe,x.value,de(x.value))}function ue(Fe){var Ke;Fe.stopPropagation(),me(null),L(null),(Ke=e.onClear)===null||Ke===void 0||Ke.call(e)}function Se(){se({returnFocus:!0})}function we(){me(null),L(null),se({returnFocus:!0})}function _e(Fe){Fe.key==="Escape"&&A.value&&Gv(Fe)}function Ee(Fe){var Ke;switch(Fe.key){case"Escape":A.value&&(Gv(Fe),se({returnFocus:!0}));break;case"Tab":h.shift&&Fe.target===((Ke=p.value)===null||Ke===void 0?void 0:Ke.$el)&&(Fe.preventDefault(),se({returnFocus:!0}));break}}function fe(){P.value=!0,ra(()=>{P.value=!1})}function B(Fe){c.value||yd(Fe,"clear")||A.value||dt()}function D(Fe){typeof Fe!="string"&&(x.value===null?me(gt(Gd(wee(new Date),Fe))):me(gt(Gd(x.value,Fe))))}function I(Fe){typeof Fe!="string"&&(x.value===null?me(gt($w(rJ(new Date),Fe))):me(gt($w(x.value,Fe))))}function O(Fe){typeof Fe!="string"&&(x.value===null?me(gt(qw(yT(new Date),Fe))):me(gt(qw(x.value,Fe))))}function j(Fe){const{value:Ke}=x;if(Ke===null){const ut=new Date,Ft=Yc(ut);Fe==="pm"&&Ft<12?me(gt(Gd(ut,Ft+12))):Fe==="am"&&Ft>=12&&me(gt(Gd(ut,Ft-12))),me(gt(ut))}else{const ut=Yc(Ke);Fe==="pm"&&ut<12?me(gt(Gd(Ke,ut+12))):Fe==="am"&&ut>=12&&me(gt(Gd(Ke,ut-12)))}}function L(Fe){Fe===void 0&&(Fe=x.value),Fe===null?w.value="":w.value=S.value(Fe,e.format,v.value)}function Ae(Fe){lt(Fe)||Ce(Fe)}function We(Fe){var Ke;if(!lt(Fe))if(A.value){const ut=(Ke=p.value)===null||Ke===void 0?void 0:Ke.$el;ut!=null&&ut.contains(Fe.relatedTarget)||(L(),G(Fe),se({returnFocus:!1}))}else L(),G(Fe)}function je(){c.value||A.value||dt()}function ze(){c.value||(L(),se({returnFocus:!1}))}function Je(){if(!p.value)return;const{hourScrollRef:Fe,minuteScrollRef:Ke,secondScrollRef:ut,amPmScrollRef:Ft}=p.value;[Fe,Ke,ut,Ft].forEach(ui=>{var _i;if(!ui)return;const Ar=(_i=ui.contentRef)===null||_i===void 0?void 0:_i.querySelector("[data-active]");Ar&&ui.scrollTo({top:Ar.offsetTop})})}function nt(Fe){_.value=Fe;const{onUpdateShow:Ke,"onUpdate:show":ut}=e;Ke&&ct(Ke,Fe),ut&&ct(ut,Fe)}function lt(Fe){var Ke,ut,Ft;return!!(!((ut=(Ke=f.value)===null||Ke===void 0?void 0:Ke.wrapperElRef)===null||ut===void 0)&&ut.contains(Fe.relatedTarget)||!((Ft=p.value)===null||Ft===void 0)&&Ft.$el.contains(Fe.relatedTarget))}function dt(){M.value=x.value,nt(!0),ra(Je)}function vt(Fe){var Ke,ut;A.value&&!(!((ut=(Ke=f.value)===null||Ke===void 0?void 0:Ke.wrapperElRef)===null||ut===void 0)&&ut.contains(Jl(Fe)))&&se({returnFocus:!1})}function se({returnFocus:Fe}){var Ke;A.value&&(nt(!1),Fe&&((Ke=f.value)===null||Ke===void 0||Ke.focus()))}function Le(Fe){if(Fe===""){me(null);return}const Ke=ja(Fe,e.format,new Date,v.value);if(w.value=Fe,To(Ke)){const{value:ut}=x;if(ut!==null){const Ft=Yn(ut,{hours:Yc(Ke),minutes:Xb(Ke),seconds:Kb(Ke),milliseconds:SJ(Ke)});me(gt(Ft))}else me(gt(Ke))}}function Ye(){me(M.value),nt(!1)}function pe(){const Fe=new Date,Ke={hours:Yc,minutes:Xb,seconds:Kb},[ut,Ft,ui]=["hours","minutes","seconds"].map(Ar=>!e[Ar]||T0(Ke[Ar](Fe),Ar,e[Ar])?Ke[Ar](Fe):qne(Ke[Ar](Fe),Ar,e[Ar])),_i=qw($w(Gd(x.value?x.value:gt(Fe),ut),Ft),ui);me(gt(_i))}function Te(){L(),Z(),se({returnFocus:!0})}function ce(Fe){lt(Fe)||(L(),G(Fe),se({returnFocus:!1}))}tr(x,Fe=>{L(Fe),fe(),ra(Je)}),tr(A,()=>{q.value&&me(M.value)}),br(IU,{mergedThemeRef:u,mergedClsPrefixRef:r});const Re={focus:()=>{var Fe;(Fe=f.value)===null||Fe===void 0||Fe.focus()},blur:()=>{var Fe;(Fe=f.value)===null||Fe===void 0||Fe.blur()}},$e=re(()=>{const{common:{cubicBezierEaseInOut:Fe},self:{iconColor:Ke,iconColorDisabled:ut}}=u.value;return{"--n-icon-color-override":Ke,"--n-icon-color-disabled-override":ut,"--n-bezier":Fe}}),at=n?Dr("time-picker-trigger",void 0,$e,e):void 0,qt=re(()=>{const{self:{panelColor:Fe,itemTextColor:Ke,itemTextColorActive:ut,itemColorHover:Ft,panelDividerColor:ui,panelBoxShadow:_i,itemOpacityDisabled:Ar,borderRadius:De,itemFontSize:K,itemWidth:Me,itemHeight:He,panelActionPadding:Oe,itemBorderRadius:Ne},common:{cubicBezierEaseInOut:wt}}=u.value;return{"--n-bezier":wt,"--n-border-radius":De,"--n-item-color-hover":Ft,"--n-item-font-size":K,"--n-item-height":He,"--n-item-opacity-disabled":Ar,"--n-item-text-color":Ke,"--n-item-text-color-active":ut,"--n-item-width":Me,"--n-panel-action-padding":Oe,"--n-panel-box-shadow":_i,"--n-panel-color":Fe,"--n-panel-divider-color":ui,"--n-item-border-radius":Ne}}),ir=n?Dr("time-picker",void 0,qt,e):void 0;return{focus:Re.focus,blur:Re.blur,mergedStatus:d,mergedBordered:t,mergedClsPrefix:r,namespace:i,uncontrolledValue:b,mergedValue:x,isMounted:zd(),inputInstRef:f,panelInstRef:p,adjustedTo:jn(e),mergedShow:A,localizedClear:T,localizedNow:R,localizedPlaceholder:z,localizedNegativeText:F,localizedPositiveText:H,hourInFormat:N,minuteInFormat:U,secondInFormat:ie,mergedAttrSize:$,displayTimeString:w,mergedSize:l,mergedDisabled:c,isValueInvalid:q,isHourInvalid:te,isMinuteInvalid:X,isSecondInvalid:W,transitionDisabled:P,hourValue:ee,minuteValue:Q,secondValue:ne,amPmValue:le,handleInputKeydown:_e,handleTimeInputFocus:Ae,handleTimeInputBlur:We,handleNowClick:pe,handleConfirmClick:Te,handleTimeInputUpdateValue:Le,handleMenuFocusOut:ce,handleCancelClick:Ye,handleClickOutside:vt,handleTimeInputActivate:je,handleTimeInputDeactivate:ze,handleHourClick:D,handleMinuteClick:I,handleSecondClick:O,handleAmPmClick:j,handleTimeInputClear:ue,handleFocusDetectorFocus:Se,handleMenuKeydown:Ee,handleTriggerClick:B,mergedTheme:u,triggerCssVars:n?void 0:$e,triggerThemeClass:at==null?void 0:at.themeClass,triggerOnRender:at==null?void 0:at.onRender,cssVars:n?void 0:qt,themeClass:ir==null?void 0:ir.themeClass,onRender:ir==null?void 0:ir.onRender,clearSelectedValue:we}},render(){const{mergedClsPrefix:e,$slots:t,triggerOnRender:r}=this;return r==null||r(),E("div",{class:[`${e}-time-picker`,this.triggerThemeClass],style:this.triggerCssVars},E(ch,null,{default:()=>[E(dh,null,{default:()=>E(cr,{ref:"inputInstRef",status:this.mergedStatus,value:this.displayTimeString,bordered:this.mergedBordered,passivelyActivated:!0,attrSize:this.mergedAttrSize,theme:this.mergedTheme.peers.Input,themeOverrides:this.mergedTheme.peerOverrides.Input,stateful:this.stateful,size:this.mergedSize,placeholder:this.localizedPlaceholder,clearable:this.clearable,disabled:this.mergedDisabled,textDecoration:this.isValueInvalid?"line-through":void 0,onFocus:this.handleTimeInputFocus,onBlur:this.handleTimeInputBlur,onActivate:this.handleTimeInputActivate,onDeactivate:this.handleTimeInputDeactivate,onUpdateValue:this.handleTimeInputUpdateValue,onClear:this.handleTimeInputClear,internalDeactivateOnEnter:!0,internalForceFocus:this.mergedShow,readonly:this.inputReadonly||this.mergedDisabled,onClick:this.handleTriggerClick,onKeydown:this.handleInputKeydown},this.showIcon?{[this.clearable?"clear-icon-placeholder":"suffix"]:()=>E(Li,{clsPrefix:e,class:`${e}-time-picker-icon`},{default:()=>t.icon?t.icon():E(Lee,null)})}:null)}),E(uh,{teleportDisabled:this.adjustedTo===jn.tdkey,show:this.mergedShow,to:this.adjustedTo,containerClass:this.namespace,placement:this.placement},{default:()=>E(Da,{name:"fade-in-scale-up-transition",appear:this.isMounted},{default:()=>{var i;return this.mergedShow?((i=this.onRender)===null||i===void 0||i.call(this),Ka(E(Kne,{ref:"panelInstRef",actions:this.actions,class:this.themeClass,style:this.cssVars,seconds:this.seconds,minutes:this.minutes,hours:this.hours,transitionDisabled:this.transitionDisabled,hourValue:this.hourValue,showHour:this.hourInFormat,isHourInvalid:this.isHourInvalid,isHourDisabled:this.isHourDisabled,minuteValue:this.minuteValue,showMinute:this.minuteInFormat,isMinuteInvalid:this.isMinuteInvalid,isMinuteDisabled:this.isMinuteDisabled,secondValue:this.secondValue,amPmValue:this.amPmValue,showSecond:this.secondInFormat,isSecondInvalid:this.isSecondInvalid,isSecondDisabled:this.isSecondDisabled,isValueInvalid:this.isValueInvalid,clearText:this.localizedClear,nowText:this.localizedNow,confirmText:this.localizedPositiveText,use12Hours:this.use12Hours,onFocusout:this.handleMenuFocusOut,onKeydown:this.handleMenuKeydown,onHourClick:this.handleHourClick,onMinuteClick:this.handleMinuteClick,onSecondClick:this.handleSecondClick,onAmPmClick:this.handleAmPmClick,onNowClick:this.handleNowClick,onConfirmClick:this.handleConfirmClick,onClearClick:this.clearSelectedValue,onFocusDetectorFocus:this.handleFocusDetectorFocus}),[[bd,this.handleClickOutside,void 0,{capture:!0}]])):null}})})]}))}}),Jne="HH:mm:ss",zU={active:Boolean,dateFormat:String,timerPickerFormat:{type:String,value:Jne},value:{type:[Array,Number],default:null},shortcuts:Object,defaultTime:[Number,String,Array],onClear:Function,onConfirm:Function,onClose:Function,onTabOut:Function,onUpdateValue:{type:Function,required:!0},themeClass:String,onRender:Function,panel:Boolean,onNextMonth:Function,onPrevMonth:Function,onNextYear:Function,onPrevYear:Function};function kU(e){const{dateLocaleRef:t,timePickerSizeRef:r,timePickerPropsRef:i,localeRef:n,mergedClsPrefixRef:a,mergedThemeRef:o}=_t(L1),s=re(()=>({locale:t.value.locale})),l=ge(null),c=XE();function d(){const{onClear:T}=e;T&&T()}function u(){const{onConfirm:T,value:R}=e;T&&T(R)}function h(T,R){const{onUpdateValue:z}=e;z(T,R)}function f(T=!1){const{onClose:R}=e;R&&R(T)}function p(){const{onTabOut:T}=e;T&&T()}function v(){h(null,!0),f(!0),d()}function m(){p()}function g(){(e.active||e.panel)&&ra(()=>{const{value:T}=l;if(!T)return;const R=T.querySelectorAll("[data-n-date]");R.forEach(z=>{z.classList.add("transition-disabled")}),T.offsetWidth,R.forEach(z=>{z.classList.remove("transition-disabled")})})}function y(T){T.key==="Tab"&&T.target===l.value&&c.shift&&(T.preventDefault(),p())}function b(T){const{value:R}=l;c.tab&&T.target===R&&(R!=null&&R.contains(T.relatedTarget))&&p()}let x=null,S=!1;function w(){x=e.value,S=!0}function _(){S=!1}function C(){S&&(h(x,!1),S=!1)}function A(T){return typeof T=="function"?T():T}const M=ge(!1);function P(){M.value=!M.value}return{mergedTheme:o,mergedClsPrefix:a,dateFnsOptions:s,timePickerSize:r,timePickerProps:i,selfRef:l,locale:n,doConfirm:u,doClose:f,doUpdateValue:h,doTabOut:p,handleClearClick:v,handleFocusDetectorFocus:m,disableTransitionOneTick:g,handlePanelKeyDown:y,handlePanelFocus:b,cachePendingValue:w,clearPendingValue:_,restorePendingValue:C,getShortcutValue:A,handleShortcutMouseleave:C,showMonthYearPanel:M,handleOpenQuickSelectMonthPanel:P}}const DT=Object.assign(Object.assign({},zU),{defaultCalendarStartTime:Number,actions:{type:Array,default:()=>["now","clear","confirm"]}});function OT(e,t){var r;const i=kU(e),{isValueInvalidRef:n,isDateDisabledRef:a,isDateInvalidRef:o,isTimeInvalidRef:s,isDateTimeInvalidRef:l,isHourDisabledRef:c,isMinuteDisabledRef:d,isSecondDisabledRef:u,localeRef:h,firstDayOfWeekRef:f,datePickerSlots:p,yearFormatRef:v,monthFormatRef:m,quarterFormatRef:g}=_t(L1),y={isValueInvalid:n,isDateDisabled:a,isDateInvalid:o,isTimeInvalid:s,isDateTimeInvalid:l,isHourDisabled:c,isMinuteDisabled:d,isSecondDisabled:u},b=re(()=>e.dateFormat||h.value.dateFormat),x=ge(e.value===null||Array.isArray(e.value)?"":ai(e.value,b.value)),S=ge(e.value===null||Array.isArray(e.value)?(r=e.defaultCalendarStartTime)!==null&&r!==void 0?r:Date.now():e.value),w=ge(null),_=ge(null),C=ge(null),A=ge(Date.now()),M=re(()=>{var O;return m2(S.value,e.value,A.value,(O=f.value)!==null&&O!==void 0?O:h.value.firstDayOfWeek,!1,t==="week")}),P=re(()=>{const{value:O}=e;return v2(S.value,Array.isArray(O)?null:O,A.value,{monthFormat:m.value})}),T=re(()=>{const{value:O}=e;return y2(Array.isArray(O)?null:O,A.value,{yearFormat:v.value})}),R=re(()=>{const{value:O}=e;return g2(S.value,Array.isArray(O)?null:O,A.value,{quarterFormat:g.value})}),z=re(()=>M.value.slice(0,7).map(O=>{const{ts:j}=O;return ai(j,h.value.dayFormat,i.dateFnsOptions.value)})),F=re(()=>ai(S.value,h.value.monthFormat,i.dateFnsOptions.value)),H=re(()=>ai(S.value,h.value.yearFormat,i.dateFnsOptions.value));tr(S,(O,j)=>{(t==="date"||t==="datetime")&&(Rg(O,j)||i.disableTransitionOneTick())}),tr(re(()=>e.value),O=>{O!==null&&!Array.isArray(O)?(x.value=ai(O,b.value,i.dateFnsOptions.value),S.value=O):x.value=""});function N(O){var j;if(t==="datetime")return gt(yT(O));if(t==="month")return gt(zl(O));if(t==="year")return gt(pT(O));if(t==="quarter")return gt(Qv(O));if(t==="week"){const L=(((j=f.value)!==null&&j!==void 0?j:h.value.firstDayOfWeek)+1)%7;return gt(l2(O,{weekStartsOn:L}))}return gt(qb(O))}function U(O,j){const{isDateDisabled:{value:L}}=y;return L?L(O,j):!1}function ie(O){const j=ja(O,b.value,new Date,i.dateFnsOptions.value);if(To(j)){if(e.value===null)i.doUpdateValue(gt(N(Date.now())),e.panel);else if(!Array.isArray(e.value)){const L=Yn(e.value,{year:Ai(j),month:fi(j),date:wo(j)});i.doUpdateValue(gt(N(gt(L))),e.panel)}}else x.value=O}function te(){const O=ja(x.value,b.value,new Date,i.dateFnsOptions.value);if(To(O)){if(e.value===null)i.doUpdateValue(gt(N(Date.now())),!1);else if(!Array.isArray(e.value)){const j=Yn(e.value,{year:Ai(O),month:fi(O),date:wo(O)});i.doUpdateValue(gt(N(gt(j))),!1)}}else V()}function X(){i.doUpdateValue(null,!0),x.value="",i.doClose(!0),i.handleClearClick()}function W(){i.doUpdateValue(gt(N(Date.now())),!0);const O=Date.now();S.value=O,i.doClose(!0),e.panel&&(t==="month"||t==="quarter"||t==="year")&&(i.disableTransitionOneTick(),D(O))}const q=ge(null);function $(O){O.type==="date"&&t==="week"&&(q.value=N(gt(O.ts)))}function le(O){return O.type==="date"&&t==="week"?N(gt(O.ts))===q.value:!1}function ee(O){if(U(O.ts,O.type==="date"?{type:"date",year:O.dateObject.year,month:O.dateObject.month,date:O.dateObject.date}:O.type==="month"?{type:"month",year:O.dateObject.year,month:O.dateObject.month}:O.type==="year"?{type:"year",year:O.dateObject.year}:{type:"quarter",year:O.dateObject.year,quarter:O.dateObject.quarter}))return;let j;if(e.value!==null&&!Array.isArray(e.value)?j=e.value:j=Date.now(),t==="datetime"&&e.defaultTime!==null&&!Array.isArray(e.defaultTime)){const L=cb(e.defaultTime);L&&(j=gt(Yn(j,L)))}switch(j=gt(O.type==="quarter"&&O.dateObject.quarter?Cee(SO(j,O.dateObject.year),O.dateObject.quarter):Yn(j,O.dateObject)),i.doUpdateValue(N(j),e.panel||t==="date"||t==="week"||t==="year"),t){case"date":case"week":i.doClose();break;case"year":e.panel&&i.disableTransitionOneTick(),i.doClose();break;case"month":i.disableTransitionOneTick(),D(j);break;case"quarter":i.disableTransitionOneTick(),D(j);break}}function Q(O,j){let L;e.value!==null&&!Array.isArray(e.value)?L=e.value:L=Date.now(),L=gt(O.type==="month"?bT(L,O.dateObject.month):SO(L,O.dateObject.year)),j(L),D(L)}function ne(O){S.value=O}function V(O){if(e.value===null||Array.isArray(e.value)){x.value="";return}O===void 0&&(O=e.value),x.value=ai(O,b.value,i.dateFnsOptions.value)}function de(){y.isDateInvalid.value||y.isTimeInvalid.value||(i.doConfirm(),me())}function me(){e.active&&i.doClose()}function Ce(){var O;S.value=gt(c2(S.value,1)),(O=e.onNextYear)===null||O===void 0||O.call(e)}function G(){var O;S.value=gt(c2(S.value,-1)),(O=e.onPrevYear)===null||O===void 0||O.call(e)}function Z(){var O;S.value=gt(qn(S.value,1)),(O=e.onNextMonth)===null||O===void 0||O.call(e)}function ue(){var O;S.value=gt(qn(S.value,-1)),(O=e.onPrevMonth)===null||O===void 0||O.call(e)}function Se(){const{value:O}=w;return(O==null?void 0:O.listElRef)||null}function we(){const{value:O}=w;return(O==null?void 0:O.itemsElRef)||null}function _e(O){var j;(j=_.value)===null||j===void 0||j.sync()}function Ee(O){O!==null&&i.doUpdateValue(O,e.panel)}function fe(O){i.cachePendingValue();const j=i.getShortcutValue(O);typeof j=="number"&&i.doUpdateValue(j,!1)}function B(O){const j=i.getShortcutValue(O);typeof j=="number"&&(i.doUpdateValue(j,e.panel),i.clearPendingValue(),de())}function D(O){const{value:j}=e;if(C.value){const L=fi(O===void 0?j===null?Date.now():j:O);C.value.scrollTo({top:L*Qu})}if(w.value){const L=Ai(O===void 0?j===null?Date.now():j:O)-tx;w.value.scrollTo({top:L*Qu})}}const I={monthScrollbarRef:C,yearScrollbarRef:_,yearVlRef:w};return Object.assign(Object.assign(Object.assign(Object.assign({dateArray:M,monthArray:P,yearArray:T,quarterArray:R,calendarYear:H,calendarMonth:F,weekdays:z,mergedIsDateDisabled:U,nextYear:Ce,prevYear:G,nextMonth:Z,prevMonth:ue,handleNowClick:W,handleConfirmClick:de,handleSingleShortcutMouseenter:fe,handleSingleShortcutClick:B},y),i),I),{handleDateClick:ee,handleDateInputBlur:te,handleDateInput:ie,handleDateMouseEnter:$,isWeekHovered:le,handleTimePickerChange:Ee,clearSelectedDateTime:X,virtualListContainer:Se,virtualListContent:we,handleVirtualListScroll:_e,timePickerSize:i.timePickerSize,dateInputValue:x,datePickerSlots:p,handleQuickMonthClick:Q,justifyColumnsScrollState:D,calendarValue:S,onUpdateCalendarValue:ne})}const LU=Ve({name:"MonthPanel",props:Object.assign(Object.assign({},DT),{type:{type:String,required:!0},useAsQuickJump:Boolean}),setup(e){const t=OT(e,e.type),{dateLocaleRef:r}=dc("DatePicker"),i=o=>{switch(o.type){case"year":return dU(o.dateObject.year,o.yearFormat,r.value.locale);case"month":return cU(o.dateObject.month,o.monthFormat,r.value.locale);case"quarter":return uU(o.dateObject.quarter,o.quarterFormat,r.value.locale)}},{useAsQuickJump:n}=e,a=(o,s,l)=>{const{mergedIsDateDisabled:c,handleDateClick:d,handleQuickMonthClick:u}=t;return E("div",{"data-n-date":!0,key:s,class:[`${l}-date-panel-month-calendar__picker-col-item`,o.isCurrent&&`${l}-date-panel-month-calendar__picker-col-item--current`,o.selected&&`${l}-date-panel-month-calendar__picker-col-item--selected`,!n&&c(o.ts,o.type==="year"?{type:"year",year:o.dateObject.year}:o.type==="month"?{type:"month",year:o.dateObject.year,month:o.dateObject.month}:o.type==="quarter"?{type:"month",year:o.dateObject.year,month:o.dateObject.quarter}:null)&&`${l}-date-panel-month-calendar__picker-col-item--disabled`],onClick:()=>{n?u(o,h=>{e.onUpdateValue(h,!1)}):d(o)}},i(o))};return Or(()=>{t.justifyColumnsScrollState()}),Object.assign(Object.assign({},t),{renderItem:a})},render(){const{mergedClsPrefix:e,mergedTheme:t,shortcuts:r,actions:i,renderItem:n,type:a,onRender:o}=this;return o==null||o(),E("div",{ref:"selfRef",tabindex:0,class:[`${e}-date-panel`,`${e}-date-panel--month`,!this.panel&&`${e}-date-panel--shadow`,this.themeClass],onFocus:this.handlePanelFocus,onKeydown:this.handlePanelKeyDown},E("div",{class:`${e}-date-panel-month-calendar`},E(bn,{ref:"yearScrollbarRef",class:`${e}-date-panel-month-calendar__picker-col`,theme:t.peers.Scrollbar,themeOverrides:t.peerOverrides.Scrollbar,container:this.virtualListContainer,content:this.virtualListContent,horizontalRailStyle:{zIndex:1},verticalRailStyle:{zIndex:1}},{default:()=>E(qv,{ref:"yearVlRef",items:this.yearArray,itemSize:Qu,showScrollbar:!1,keyField:"ts",onScroll:this.handleVirtualListScroll,paddingBottom:4},{default:({item:s,index:l})=>n(s,l,e)})}),a==="month"||a==="quarter"?E("div",{class:`${e}-date-panel-month-calendar__picker-col`},E(bn,{ref:"monthScrollbarRef",theme:t.peers.Scrollbar,themeOverrides:t.peerOverrides.Scrollbar},{default:()=>[(a==="month"?this.monthArray:this.quarterArray).map((s,l)=>n(s,l,e)),E("div",{class:`${e}-date-panel-${a}-calendar__padding`})]})):null),this.datePickerSlots.footer?E("div",{class:`${e}-date-panel-footer`},{default:this.datePickerSlots.footer}):null,i!=null&&i.length||r?E("div",{class:`${e}-date-panel-actions`},E("div",{class:`${e}-date-panel-actions__prefix`},r&&Object.keys(r).map(s=>{const l=r[s];return Array.isArray(l)?null:E(hd,{size:"tiny",onMouseenter:()=>{this.handleSingleShortcutMouseenter(l)},onClick:()=>{this.handleSingleShortcutClick(l)},onMouseleave:()=>{this.handleShortcutMouseleave()}},{default:()=>s})})),E("div",{class:`${e}-date-panel-actions__suffix`},i!=null&&i.includes("clear")?E(li,{theme:t.peers.Button,themeOverrides:t.peerOverrides.Button,size:"tiny",onClick:this.handleClearClick},{default:()=>this.locale.clear}):null,i!=null&&i.includes("now")?E(li,{theme:t.peers.Button,themeOverrides:t.peerOverrides.Button,size:"tiny",onClick:this.handleNowClick},{default:()=>this.locale.now}):null,i!=null&&i.includes("confirm")?E(li,{theme:t.peers.Button,themeOverrides:t.peerOverrides.Button,size:"tiny",type:"primary",disabled:this.isDateInvalid,onClick:this.handleConfirmClick},{default:()=>this.locale.confirm}):null)):null,E(Bd,{onFocus:this.handleFocusDetectorFocus}))}}),up=Ve({props:{mergedClsPrefix:{type:String,required:!0},value:Number,monthBeforeYear:{type:Boolean,required:!0},calendarMonth:{type:String,required:!0},calendarYear:{type:String,required:!0},onUpdateValue:{type:Function,required:!0}},setup(){const e=ge(null),t=ge(null),r=ge(!1);function i(a){var o;r.value&&!(!((o=e.value)===null||o===void 0)&&o.contains(Jl(a)))&&(r.value=!1)}function n(){r.value=!r.value}return{show:r,triggerRef:e,monthPanelRef:t,handleHeaderClick:n,handleClickOutside:i}},render(){const{handleClickOutside:e,mergedClsPrefix:t}=this;return E("div",{class:`${t}-date-panel-month__month-year`,ref:"triggerRef"},E(ch,null,{default:()=>[E(dh,null,{default:()=>E("div",{class:[`${t}-date-panel-month__text`,this.show&&`${t}-date-panel-month__text--active`],onClick:this.handleHeaderClick},this.monthBeforeYear?[this.calendarMonth," ",this.calendarYear]:[this.calendarYear," ",this.calendarMonth])}),E(uh,{show:this.show,teleportDisabled:!0},{default:()=>E(Da,{name:"fade-in-scale-up-transition",appear:!0},{default:()=>this.show?Ka(E(LU,{ref:"monthPanelRef",onUpdateValue:this.onUpdateValue,actions:[],type:"month",key:"month",useAsQuickJump:!0,value:this.value}),[[bd,e,void 0,{capture:!0}]]):null})})]}))}}),eae=Ve({name:"DateTimePanel",props:DT,setup(e){return OT(e,"datetime")},render(){var e,t,r,i;const{mergedClsPrefix:n,mergedTheme:a,shortcuts:o,timePickerProps:s,onRender:l,$slots:c}=this;return l==null||l(),E("div",{ref:"selfRef",tabindex:0,class:[`${n}-date-panel`,`${n}-date-panel--datetime`,!this.panel&&`${n}-date-panel--shadow`,this.themeClass],onKeydown:this.handlePanelKeyDown,onFocus:this.handlePanelFocus},E("div",{class:`${n}-date-panel-header`},E(cr,{value:this.dateInputValue,theme:a.peers.Input,themeOverrides:a.peerOverrides.Input,stateful:!1,size:this.timePickerSize,class:`${n}-date-panel-date-input`,textDecoration:this.isDateInvalid?"line-through":"",placeholder:this.locale.selectDate,onBlur:this.handleDateInputBlur,onUpdateValue:this.handleDateInput}),E(rA,Object.assign({size:this.timePickerSize,placeholder:this.locale.selectTime,format:this.timerPickerFormat},Array.isArray(s)?void 0:s,{showIcon:!1,to:!1,theme:a.peers.TimePicker,themeOverrides:a.peerOverrides.TimePicker,value:Array.isArray(this.value)?null:this.value,isHourDisabled:this.isHourDisabled,isMinuteDisabled:this.isMinuteDisabled,isSecondDisabled:this.isSecondDisabled,onUpdateValue:this.handleTimePickerChange,stateful:!1}))),E("div",{class:`${n}-date-panel-calendar`},E("div",{class:`${n}-date-panel-month`},E("div",{class:`${n}-date-panel-month__fast-prev`,onClick:this.prevYear},Sr(c["prev-year"],()=>[E(lp,null)])),E("div",{class:`${n}-date-panel-month__prev`,onClick:this.prevMonth},Sr(c["prev-month"],()=>[E(sp,null)])),E(up,{monthBeforeYear:this.locale.monthBeforeYear,value:this.calendarValue,onUpdateValue:this.onUpdateCalendarValue,mergedClsPrefix:n,calendarMonth:this.calendarMonth,calendarYear:this.calendarYear}),E("div",{class:`${n}-date-panel-month__next`,onClick:this.nextMonth},Sr(c["next-month"],()=>[E(dp,null)])),E("div",{class:`${n}-date-panel-month__fast-next`,onClick:this.nextYear},Sr(c["next-year"],()=>[E(cp,null)]))),E("div",{class:`${n}-date-panel-weekdays`},this.weekdays.map(d=>E("div",{key:d,class:`${n}-date-panel-weekdays__day`},d))),E("div",{class:`${n}-date-panel-dates`},this.dateArray.map((d,u)=>E("div",{"data-n-date":!0,key:u,class:[`${n}-date-panel-date`,{[`${n}-date-panel-date--current`]:d.isCurrentDate,[`${n}-date-panel-date--selected`]:d.selected,[`${n}-date-panel-date--excluded`]:!d.inCurrentMonth,[`${n}-date-panel-date--disabled`]:this.mergedIsDateDisabled(d.ts,{type:"date",year:d.dateObject.year,month:d.dateObject.month,date:d.dateObject.date})}],onClick:()=>{this.handleDateClick(d)}},E("div",{class:`${n}-date-panel-date__trigger`}),d.dateObject.date,d.isCurrentDate?E("div",{class:`${n}-date-panel-date__sup`}):null)))),this.datePickerSlots.footer?E("div",{class:`${n}-date-panel-footer`},this.datePickerSlots.footer()):null,!((e=this.actions)===null||e===void 0)&&e.length||o?E("div",{class:`${n}-date-panel-actions`},E("div",{class:`${n}-date-panel-actions__prefix`},o&&Object.keys(o).map(d=>{const u=o[d];return Array.isArray(u)?null:E(hd,{size:"tiny",onMouseenter:()=>{this.handleSingleShortcutMouseenter(u)},onClick:()=>{this.handleSingleShortcutClick(u)},onMouseleave:()=>{this.handleShortcutMouseleave()}},{default:()=>d})})),E("div",{class:`${n}-date-panel-actions__suffix`},!((t=this.actions)===null||t===void 0)&&t.includes("clear")?E(li,{theme:a.peers.Button,themeOverrides:a.peerOverrides.Button,size:"tiny",onClick:this.clearSelectedDateTime},{default:()=>this.locale.clear}):null,!((r=this.actions)===null||r===void 0)&&r.includes("now")?E(li,{theme:a.peers.Button,themeOverrides:a.peerOverrides.Button,size:"tiny",onClick:this.handleNowClick},{default:()=>this.locale.now}):null,!((i=this.actions)===null||i===void 0)&&i.includes("confirm")?E(li,{theme:a.peers.Button,themeOverrides:a.peerOverrides.Button,size:"tiny",type:"primary",disabled:this.isDateInvalid,onClick:this.handleConfirmClick},{default:()=>this.locale.confirm}):null)):null,E(Bd,{onFocus:this.handleFocusDetectorFocus}))}}),RT=Object.assign(Object.assign({},zU),{defaultCalendarStartTime:Number,defaultCalendarEndTime:Number,bindCalendarMonths:Boolean,actions:{type:Array,default:()=>["clear","confirm"]}});function IT(e,t){var r,i;const{isDateDisabledRef:n,isStartHourDisabledRef:a,isEndHourDisabledRef:o,isStartMinuteDisabledRef:s,isEndMinuteDisabledRef:l,isStartSecondDisabledRef:c,isEndSecondDisabledRef:d,isStartDateInvalidRef:u,isEndDateInvalidRef:h,isStartTimeInvalidRef:f,isEndTimeInvalidRef:p,isStartValueInvalidRef:v,isEndValueInvalidRef:m,isRangeInvalidRef:g,localeRef:y,rangesRef:b,closeOnSelectRef:x,updateValueOnCloseRef:S,firstDayOfWeekRef:w,datePickerSlots:_,monthFormatRef:C,yearFormatRef:A,quarterFormatRef:M}=_t(L1),P={isDateDisabled:n,isStartHourDisabled:a,isEndHourDisabled:o,isStartMinuteDisabled:s,isEndMinuteDisabled:l,isStartSecondDisabled:c,isEndSecondDisabled:d,isStartDateInvalid:u,isEndDateInvalid:h,isStartTimeInvalid:f,isEndTimeInvalid:p,isStartValueInvalid:v,isEndValueInvalid:m,isRangeInvalid:g},T=kU(e),R=ge(null),z=ge(null),F=ge(null),H=ge(null),N=ge(null),U=ge(null),ie=ge(null),te=ge(null),{value:X}=e,W=(r=e.defaultCalendarStartTime)!==null&&r!==void 0?r:Array.isArray(X)&&typeof X[0]=="number"?X[0]:Date.now(),q=ge(W),$=ge((i=e.defaultCalendarEndTime)!==null&&i!==void 0?i:Array.isArray(X)&&typeof X[1]=="number"?X[1]:gt(qn(W,1)));je(!0);const le=ge(Date.now()),ee=ge(!1),Q=ge(0),ne=re(()=>e.dateFormat||y.value.dateFormat),V=ge(Array.isArray(X)?ai(X[0],ne.value,T.dateFnsOptions.value):""),de=ge(Array.isArray(X)?ai(X[1],ne.value,T.dateFnsOptions.value):""),me=re(()=>ee.value?"end":"start"),Ce=re(()=>{var Pe;return m2(q.value,e.value,le.value,(Pe=w.value)!==null&&Pe!==void 0?Pe:y.value.firstDayOfWeek)}),G=re(()=>{var Pe;return m2($.value,e.value,le.value,(Pe=w.value)!==null&&Pe!==void 0?Pe:y.value.firstDayOfWeek)}),Z=re(()=>Ce.value.slice(0,7).map(Pe=>{const{ts:Qe}=Pe;return ai(Qe,y.value.dayFormat,T.dateFnsOptions.value)})),ue=re(()=>ai(q.value,y.value.monthFormat,T.dateFnsOptions.value)),Se=re(()=>ai($.value,y.value.monthFormat,T.dateFnsOptions.value)),we=re(()=>ai(q.value,y.value.yearFormat,T.dateFnsOptions.value)),_e=re(()=>ai($.value,y.value.yearFormat,T.dateFnsOptions.value)),Ee=re(()=>{const{value:Pe}=e;return Array.isArray(Pe)?Pe[0]:null}),fe=re(()=>{const{value:Pe}=e;return Array.isArray(Pe)?Pe[1]:null}),B=re(()=>{const{shortcuts:Pe}=e;return Pe||b.value}),D=re(()=>y2(zh(e.value,"start"),le.value,{yearFormat:A.value})),I=re(()=>y2(zh(e.value,"end"),le.value,{yearFormat:A.value})),O=re(()=>{const Pe=zh(e.value,"start");return g2(Pe??Date.now(),Pe,le.value,{quarterFormat:M.value})}),j=re(()=>{const Pe=zh(e.value,"end");return g2(Pe??Date.now(),Pe,le.value,{quarterFormat:M.value})}),L=re(()=>{const Pe=zh(e.value,"start");return v2(Pe??Date.now(),Pe,le.value,{monthFormat:C.value})}),Ae=re(()=>{const Pe=zh(e.value,"end");return v2(Pe??Date.now(),Pe,le.value,{monthFormat:C.value})});tr(re(()=>e.value),Pe=>{if(Pe!==null&&Array.isArray(Pe)){const[Qe,xt]=Pe;V.value=ai(Qe,ne.value,T.dateFnsOptions.value),de.value=ai(xt,ne.value,T.dateFnsOptions.value),ee.value||ce(Pe)}else V.value="",de.value=""});function We(Pe,Qe){(t==="daterange"||t==="datetimerange")&&(Ai(Pe)!==Ai(Qe)||fi(Pe)!==fi(Qe))&&T.disableTransitionOneTick()}tr(q,We),tr($,We);function je(Pe){const Qe=zl(q.value),xt=zl($.value);(e.bindCalendarMonths||Qe>=xt)&&(Pe?$.value=gt(qn(Qe,1)):q.value=gt(qn(xt,-1)))}function ze(){q.value=gt(qn(q.value,12)),je(!0)}function Je(){q.value=gt(qn(q.value,-12)),je(!0)}function nt(){q.value=gt(qn(q.value,1)),je(!0)}function lt(){q.value=gt(qn(q.value,-1)),je(!0)}function dt(){$.value=gt(qn($.value,12)),je(!1)}function vt(){$.value=gt(qn($.value,-12)),je(!1)}function se(){$.value=gt(qn($.value,1)),je(!1)}function Le(){$.value=gt(qn($.value,-1)),je(!1)}function Ye(Pe){q.value=Pe,je(!0)}function pe(Pe){$.value=Pe,je(!1)}function Te(Pe){const Qe=n.value;if(!Qe)return!1;if(!Array.isArray(e.value)||me.value==="start")return Qe(Pe,"start",null);{const{value:xt}=Q;return Pe<Q.value?Qe(Pe,"start",[xt,xt]):Qe(Pe,"end",[xt,xt])}}function ce(Pe){if(Pe===null)return;const[Qe,xt]=Pe;q.value=Qe,zl(xt)<=zl(Qe)?$.value=gt(zl(qn(Qe,1))):$.value=gt(zl(xt))}function Re(Pe){if(!ee.value)ee.value=!0,Q.value=Pe.ts,Ke(Pe.ts,Pe.ts,"done");else{ee.value=!1;const{value:Qe}=e;e.panel&&Array.isArray(Qe)?Ke(Qe[0],Qe[1],"done"):x.value&&t==="daterange"&&(S.value?qt():at())}}function $e(Pe){if(ee.value){if(Te(Pe.ts))return;Pe.ts>=Q.value?Ke(Q.value,Pe.ts,"wipPreview"):Ke(Pe.ts,Q.value,"wipPreview")}}function at(){g.value||(T.doConfirm(),qt())}function qt(){ee.value=!1,e.active&&T.doClose()}function ir(Pe){typeof Pe!="number"&&(Pe=gt(Pe)),e.value===null?T.doUpdateValue([Pe,Pe],e.panel):Array.isArray(e.value)&&T.doUpdateValue([Pe,Math.max(e.value[1],Pe)],e.panel)}function Fe(Pe){typeof Pe!="number"&&(Pe=gt(Pe)),e.value===null?T.doUpdateValue([Pe,Pe],e.panel):Array.isArray(e.value)&&T.doUpdateValue([Math.min(e.value[0],Pe),Pe],e.panel)}function Ke(Pe,Qe,xt){if(typeof Pe!="number"&&(Pe=gt(Pe)),xt!=="shortcutPreview"){let Mr,ci;if(t==="datetimerange"){const{defaultTime:Nt}=e;Array.isArray(Nt)?(Mr=cb(Nt[0]),ci=cb(Nt[1])):(Mr=cb(Nt),ci=Mr)}Mr&&(Pe=gt(Yn(Pe,Mr))),ci&&(Qe=gt(Yn(Qe,ci)))}T.doUpdateValue([Pe,Qe],e.panel&&xt==="done")}function ut(Pe){return gt(t==="datetimerange"?yT(Pe):t==="monthrange"?zl(Pe):qb(Pe))}function Ft(Pe){const Qe=ja(Pe,ne.value,new Date,T.dateFnsOptions.value);if(To(Qe))if(e.value){if(Array.isArray(e.value)){const xt=Yn(e.value[0],{year:Ai(Qe),month:fi(Qe),date:wo(Qe)});ir(ut(gt(xt)))}}else{const xt=Yn(new Date,{year:Ai(Qe),month:fi(Qe),date:wo(Qe)});ir(ut(gt(xt)))}else V.value=Pe}function ui(Pe){const Qe=ja(Pe,ne.value,new Date,T.dateFnsOptions.value);if(To(Qe)){if(e.value===null){const xt=Yn(new Date,{year:Ai(Qe),month:fi(Qe),date:wo(Qe)});Fe(ut(gt(xt)))}else if(Array.isArray(e.value)){const xt=Yn(e.value[1],{year:Ai(Qe),month:fi(Qe),date:wo(Qe)});Fe(ut(gt(xt)))}}else de.value=Pe}function _i(){const Pe=ja(V.value,ne.value,new Date,T.dateFnsOptions.value),{value:Qe}=e;if(To(Pe)){if(Qe===null){const xt=Yn(new Date,{year:Ai(Pe),month:fi(Pe),date:wo(Pe)});ir(ut(gt(xt)))}else if(Array.isArray(Qe)){const xt=Yn(Qe[0],{year:Ai(Pe),month:fi(Pe),date:wo(Pe)});ir(ut(gt(xt)))}}else De()}function Ar(){const Pe=ja(de.value,ne.value,new Date,T.dateFnsOptions.value),{value:Qe}=e;if(To(Pe)){if(Qe===null){const xt=Yn(new Date,{year:Ai(Pe),month:fi(Pe),date:wo(Pe)});Fe(ut(gt(xt)))}else if(Array.isArray(Qe)){const xt=Yn(Qe[1],{year:Ai(Pe),month:fi(Pe),date:wo(Pe)});Fe(ut(gt(xt)))}}else De()}function De(Pe){const{value:Qe}=e;if(Qe===null||!Array.isArray(Qe)){V.value="",de.value="";return}Pe===void 0&&(Pe=Qe),V.value=ai(Pe[0],ne.value,T.dateFnsOptions.value),de.value=ai(Pe[1],ne.value,T.dateFnsOptions.value)}function K(Pe){Pe!==null&&ir(Pe)}function Me(Pe){Pe!==null&&Fe(Pe)}function He(Pe){T.cachePendingValue();const Qe=T.getShortcutValue(Pe);Array.isArray(Qe)&&Ke(Qe[0],Qe[1],"shortcutPreview")}function Oe(Pe){const Qe=T.getShortcutValue(Pe);Array.isArray(Qe)&&(Ke(Qe[0],Qe[1],"done"),T.clearPendingValue(),at())}function Ne(Pe,Qe){const xt=Pe===void 0?e.value:Pe;if(Pe===void 0||Qe==="start"){if(ie.value){const Mr=Array.isArray(xt)?fi(xt[0]):fi(Date.now());ie.value.scrollTo({debounce:!1,index:Mr,elSize:Qu})}if(N.value){const Mr=(Array.isArray(xt)?Ai(xt[0]):Ai(Date.now()))-tx;N.value.scrollTo({index:Mr,debounce:!1})}}if(Pe===void 0||Qe==="end"){if(te.value){const Mr=Array.isArray(xt)?fi(xt[1]):fi(Date.now());te.value.scrollTo({debounce:!1,index:Mr,elSize:Qu})}if(U.value){const Mr=(Array.isArray(xt)?Ai(xt[1]):Ai(Date.now()))-tx;U.value.scrollTo({index:Mr,debounce:!1})}}}function wt(Pe,Qe){const{value:xt}=e,Mr=!Array.isArray(xt),ci=Pe.type==="year"&&t!=="yearrange"?Mr?Yn(Pe.ts,{month:fi(t==="quarterrange"?Qv(new Date):new Date)}).valueOf():Yn(Pe.ts,{month:fi(t==="quarterrange"?Qv(xt[Qe==="start"?0:1]):xt[Qe==="start"?0:1])}).valueOf():Pe.ts;if(Mr){const _n=ut(ci),Jt=[_n,_n];T.doUpdateValue(Jt,e.panel),Ne(Jt,"start"),Ne(Jt,"end"),T.disableTransitionOneTick();return}const Nt=[xt[0],xt[1]];let nr=!1;switch(Qe==="start"?(Nt[0]=ut(ci),Nt[0]>Nt[1]&&(Nt[1]=Nt[0],nr=!0)):(Nt[1]=ut(ci),Nt[0]>Nt[1]&&(Nt[0]=Nt[1],nr=!0)),T.doUpdateValue(Nt,e.panel),t){case"monthrange":case"quarterrange":T.disableTransitionOneTick(),nr?(Ne(Nt,"start"),Ne(Nt,"end")):Ne(Nt,Qe);break;case"yearrange":T.disableTransitionOneTick(),Ne(Nt,"start"),Ne(Nt,"end")}}function Rt(){var Pe;(Pe=F.value)===null||Pe===void 0||Pe.sync()}function It(){var Pe;(Pe=H.value)===null||Pe===void 0||Pe.sync()}function Tt(Pe){var Qe,xt;return Pe==="start"?((Qe=N.value)===null||Qe===void 0?void 0:Qe.listElRef)||null:((xt=U.value)===null||xt===void 0?void 0:xt.listElRef)||null}function hr(Pe){var Qe,xt;return Pe==="start"?((Qe=N.value)===null||Qe===void 0?void 0:Qe.itemsElRef)||null:((xt=U.value)===null||xt===void 0?void 0:xt.itemsElRef)||null}const Zt={startYearVlRef:N,endYearVlRef:U,startMonthScrollbarRef:ie,endMonthScrollbarRef:te,startYearScrollbarRef:F,endYearScrollbarRef:H};return Object.assign(Object.assign(Object.assign(Object.assign({startDatesElRef:R,endDatesElRef:z,handleDateClick:Re,handleColItemClick:wt,handleDateMouseEnter:$e,handleConfirmClick:at,startCalendarPrevYear:Je,startCalendarPrevMonth:lt,startCalendarNextYear:ze,startCalendarNextMonth:nt,endCalendarPrevYear:vt,endCalendarPrevMonth:Le,endCalendarNextMonth:se,endCalendarNextYear:dt,mergedIsDateDisabled:Te,changeStartEndTime:Ke,ranges:b,startCalendarMonth:ue,startCalendarYear:we,endCalendarMonth:Se,endCalendarYear:_e,weekdays:Z,startDateArray:Ce,endDateArray:G,startYearArray:D,startMonthArray:L,startQuarterArray:O,endYearArray:I,endMonthArray:Ae,endQuarterArray:j,isSelecting:ee,handleRangeShortcutMouseenter:He,handleRangeShortcutClick:Oe},T),P),Zt),{startDateDisplayString:V,endDateInput:de,timePickerSize:T.timePickerSize,startTimeValue:Ee,endTimeValue:fe,datePickerSlots:_,shortcuts:B,startCalendarDateTime:q,endCalendarDateTime:$,justifyColumnsScrollState:Ne,handleFocusDetectorFocus:T.handleFocusDetectorFocus,handleStartTimePickerChange:K,handleEndTimePickerChange:Me,handleStartDateInput:Ft,handleStartDateInputBlur:_i,handleEndDateInput:ui,handleEndDateInputBlur:Ar,handleStartYearVlScroll:Rt,handleEndYearVlScroll:It,virtualListContainer:Tt,virtualListContent:hr,onUpdateStartCalendarValue:Ye,onUpdateEndCalendarValue:pe})}const tae=Ve({name:"DateTimeRangePanel",props:RT,setup(e){return IT(e,"datetimerange")},render(){var e,t,r;const{mergedClsPrefix:i,mergedTheme:n,shortcuts:a,timePickerProps:o,onRender:s,$slots:l}=this;return s==null||s(),E("div",{ref:"selfRef",tabindex:0,class:[`${i}-date-panel`,`${i}-date-panel--datetimerange`,!this.panel&&`${i}-date-panel--shadow`,this.themeClass],onKeydown:this.handlePanelKeyDown,onFocus:this.handlePanelFocus},E("div",{class:`${i}-date-panel-header`},E(cr,{value:this.startDateDisplayString,theme:n.peers.Input,themeOverrides:n.peerOverrides.Input,size:this.timePickerSize,stateful:!1,class:`${i}-date-panel-date-input`,textDecoration:this.isStartValueInvalid?"line-through":"",placeholder:this.locale.selectDate,onBlur:this.handleStartDateInputBlur,onUpdateValue:this.handleStartDateInput}),E(rA,Object.assign({placeholder:this.locale.selectTime,format:this.timerPickerFormat,size:this.timePickerSize},Array.isArray(o)?o[0]:o,{value:this.startTimeValue,to:!1,showIcon:!1,disabled:this.isSelecting,theme:n.peers.TimePicker,themeOverrides:n.peerOverrides.TimePicker,stateful:!1,isHourDisabled:this.isStartHourDisabled,isMinuteDisabled:this.isStartMinuteDisabled,isSecondDisabled:this.isStartSecondDisabled,onUpdateValue:this.handleStartTimePickerChange})),E(cr,{value:this.endDateInput,theme:n.peers.Input,themeOverrides:n.peerOverrides.Input,stateful:!1,size:this.timePickerSize,class:`${i}-date-panel-date-input`,textDecoration:this.isEndValueInvalid?"line-through":"",placeholder:this.locale.selectDate,onBlur:this.handleEndDateInputBlur,onUpdateValue:this.handleEndDateInput}),E(rA,Object.assign({placeholder:this.locale.selectTime,format:this.timerPickerFormat,size:this.timePickerSize},Array.isArray(o)?o[1]:o,{disabled:this.isSelecting,showIcon:!1,theme:n.peers.TimePicker,themeOverrides:n.peerOverrides.TimePicker,to:!1,stateful:!1,value:this.endTimeValue,isHourDisabled:this.isEndHourDisabled,isMinuteDisabled:this.isEndMinuteDisabled,isSecondDisabled:this.isEndSecondDisabled,onUpdateValue:this.handleEndTimePickerChange}))),E("div",{ref:"startDatesElRef",class:`${i}-date-panel-calendar ${i}-date-panel-calendar--start`},E("div",{class:`${i}-date-panel-month`},E("div",{class:`${i}-date-panel-month__fast-prev`,onClick:this.startCalendarPrevYear},Sr(l["prev-year"],()=>[E(lp,null)])),E("div",{class:`${i}-date-panel-month__prev`,onClick:this.startCalendarPrevMonth},Sr(l["prev-month"],()=>[E(sp,null)])),E(up,{monthBeforeYear:this.locale.monthBeforeYear,value:this.startCalendarDateTime,onUpdateValue:this.onUpdateStartCalendarValue,mergedClsPrefix:i,calendarMonth:this.startCalendarMonth,calendarYear:this.startCalendarYear}),E("div",{class:`${i}-date-panel-month__next`,onClick:this.startCalendarNextMonth},Sr(l["next-month"],()=>[E(dp,null)])),E("div",{class:`${i}-date-panel-month__fast-next`,onClick:this.startCalendarNextYear},Sr(l["next-year"],()=>[E(cp,null)]))),E("div",{class:`${i}-date-panel-weekdays`},this.weekdays.map(c=>E("div",{key:c,class:`${i}-date-panel-weekdays__day`},c))),E("div",{class:`${i}-date-panel__divider`}),E("div",{class:`${i}-date-panel-dates`},this.startDateArray.map((c,d)=>{const u=this.mergedIsDateDisabled(c.ts);return E("div",{"data-n-date":!0,key:d,class:[`${i}-date-panel-date`,{[`${i}-date-panel-date--excluded`]:!c.inCurrentMonth,[`${i}-date-panel-date--current`]:c.isCurrentDate,[`${i}-date-panel-date--selected`]:c.selected,[`${i}-date-panel-date--covered`]:c.inSpan,[`${i}-date-panel-date--start`]:c.startOfSpan,[`${i}-date-panel-date--end`]:c.endOfSpan,[`${i}-date-panel-date--disabled`]:u}],onClick:u?void 0:()=>{this.handleDateClick(c)},onMouseenter:u?void 0:()=>{this.handleDateMouseEnter(c)}},E("div",{class:`${i}-date-panel-date__trigger`}),c.dateObject.date,c.isCurrentDate?E("div",{class:`${i}-date-panel-date__sup`}):null)}))),E("div",{class:`${i}-date-panel__vertical-divider`}),E("div",{ref:"endDatesElRef",class:`${i}-date-panel-calendar ${i}-date-panel-calendar--end`},E("div",{class:`${i}-date-panel-month`},E("div",{class:`${i}-date-panel-month__fast-prev`,onClick:this.endCalendarPrevYear},Sr(l["prev-year"],()=>[E(lp,null)])),E("div",{class:`${i}-date-panel-month__prev`,onClick:this.endCalendarPrevMonth},Sr(l["prev-month"],()=>[E(sp,null)])),E(up,{monthBeforeYear:this.locale.monthBeforeYear,value:this.endCalendarDateTime,onUpdateValue:this.onUpdateEndCalendarValue,mergedClsPrefix:i,calendarMonth:this.endCalendarMonth,calendarYear:this.endCalendarYear}),E("div",{class:`${i}-date-panel-month__next`,onClick:this.endCalendarNextMonth},Sr(l["next-month"],()=>[E(dp,null)])),E("div",{class:`${i}-date-panel-month__fast-next`,onClick:this.endCalendarNextYear},Sr(l["next-year"],()=>[E(cp,null)]))),E("div",{class:`${i}-date-panel-weekdays`},this.weekdays.map(c=>E("div",{key:c,class:`${i}-date-panel-weekdays__day`},c))),E("div",{class:`${i}-date-panel__divider`}),E("div",{class:`${i}-date-panel-dates`},this.endDateArray.map((c,d)=>{const u=this.mergedIsDateDisabled(c.ts);return E("div",{"data-n-date":!0,key:d,class:[`${i}-date-panel-date`,{[`${i}-date-panel-date--excluded`]:!c.inCurrentMonth,[`${i}-date-panel-date--current`]:c.isCurrentDate,[`${i}-date-panel-date--selected`]:c.selected,[`${i}-date-panel-date--covered`]:c.inSpan,[`${i}-date-panel-date--start`]:c.startOfSpan,[`${i}-date-panel-date--end`]:c.endOfSpan,[`${i}-date-panel-date--disabled`]:u}],onClick:u?void 0:()=>{this.handleDateClick(c)},onMouseenter:u?void 0:()=>{this.handleDateMouseEnter(c)}},E("div",{class:`${i}-date-panel-date__trigger`}),c.dateObject.date,c.isCurrentDate?E("div",{class:`${i}-date-panel-date__sup`}):null)}))),this.datePickerSlots.footer?E("div",{class:`${i}-date-panel-footer`},this.datePickerSlots.footer()):null,!((e=this.actions)===null||e===void 0)&&e.length||a?E("div",{class:`${i}-date-panel-actions`},E("div",{class:`${i}-date-panel-actions__prefix`},a&&Object.keys(a).map(c=>{const d=a[c];return Array.isArray(d)||typeof d=="function"?E(hd,{size:"tiny",onMouseenter:()=>{this.handleRangeShortcutMouseenter(d)},onClick:()=>{this.handleRangeShortcutClick(d)},onMouseleave:()=>{this.handleShortcutMouseleave()}},{default:()=>c}):null})),E("div",{class:`${i}-date-panel-actions__suffix`},!((t=this.actions)===null||t===void 0)&&t.includes("clear")?E(li,{theme:n.peers.Button,themeOverrides:n.peerOverrides.Button,size:"tiny",onClick:this.handleClearClick},{default:()=>this.locale.clear}):null,!((r=this.actions)===null||r===void 0)&&r.includes("confirm")?E(li,{theme:n.peers.Button,themeOverrides:n.peerOverrides.Button,size:"tiny",type:"primary",disabled:this.isRangeInvalid||this.isSelecting,onClick:this.handleConfirmClick},{default:()=>this.locale.confirm}):null)):null,E(Bd,{onFocus:this.handleFocusDetectorFocus}))}}),rae=Ve({name:"DatePanel",props:Object.assign(Object.assign({},DT),{type:{type:String,required:!0}}),setup(e){return OT(e,e.type)},render(){var e,t,r;const{mergedClsPrefix:i,mergedTheme:n,shortcuts:a,onRender:o,$slots:s,type:l}=this;return o==null||o(),E("div",{ref:"selfRef",tabindex:0,class:[`${i}-date-panel`,`${i}-date-panel--${l}`,!this.panel&&`${i}-date-panel--shadow`,this.themeClass],onFocus:this.handlePanelFocus,onKeydown:this.handlePanelKeyDown},E("div",{class:`${i}-date-panel-calendar`},E("div",{class:`${i}-date-panel-month`},E("div",{class:`${i}-date-panel-month__fast-prev`,onClick:this.prevYear},Sr(s["prev-year"],()=>[E(lp,null)])),E("div",{class:`${i}-date-panel-month__prev`,onClick:this.prevMonth},Sr(s["prev-month"],()=>[E(sp,null)])),E(up,{monthBeforeYear:this.locale.monthBeforeYear,value:this.calendarValue,onUpdateValue:this.onUpdateCalendarValue,mergedClsPrefix:i,calendarMonth:this.calendarMonth,calendarYear:this.calendarYear}),E("div",{class:`${i}-date-panel-month__next`,onClick:this.nextMonth},Sr(s["next-month"],()=>[E(dp,null)])),E("div",{class:`${i}-date-panel-month__fast-next`,onClick:this.nextYear},Sr(s["next-year"],()=>[E(cp,null)]))),E("div",{class:`${i}-date-panel-weekdays`},this.weekdays.map(c=>E("div",{key:c,class:`${i}-date-panel-weekdays__day`},c))),E("div",{class:`${i}-date-panel-dates`},this.dateArray.map((c,d)=>E("div",{"data-n-date":!0,key:d,class:[`${i}-date-panel-date`,{[`${i}-date-panel-date--current`]:c.isCurrentDate,[`${i}-date-panel-date--selected`]:c.selected,[`${i}-date-panel-date--excluded`]:!c.inCurrentMonth,[`${i}-date-panel-date--disabled`]:this.mergedIsDateDisabled(c.ts,{type:"date",year:c.dateObject.year,month:c.dateObject.month,date:c.dateObject.date}),[`${i}-date-panel-date--week-hovered`]:this.isWeekHovered(c),[`${i}-date-panel-date--week-selected`]:c.inSelectedWeek}],onClick:()=>{this.handleDateClick(c)},onMouseenter:()=>{this.handleDateMouseEnter(c)}},E("div",{class:`${i}-date-panel-date__trigger`}),c.dateObject.date,c.isCurrentDate?E("div",{class:`${i}-date-panel-date__sup`}):null)))),this.datePickerSlots.footer?E("div",{class:`${i}-date-panel-footer`},this.datePickerSlots.footer()):null,!((e=this.actions)===null||e===void 0)&&e.length||a?E("div",{class:`${i}-date-panel-actions`},E("div",{class:`${i}-date-panel-actions__prefix`},a&&Object.keys(a).map(c=>{const d=a[c];return Array.isArray(d)?null:E(hd,{size:"tiny",onMouseenter:()=>{this.handleSingleShortcutMouseenter(d)},onClick:()=>{this.handleSingleShortcutClick(d)},onMouseleave:()=>{this.handleShortcutMouseleave()}},{default:()=>c})})),E("div",{class:`${i}-date-panel-actions__suffix`},!((t=this.actions)===null||t===void 0)&&t.includes("clear")?E(li,{theme:n.peers.Button,themeOverrides:n.peerOverrides.Button,size:"tiny",onClick:this.handleClearClick},{default:()=>this.locale.clear}):null,!((r=this.actions)===null||r===void 0)&&r.includes("now")?E(li,{theme:n.peers.Button,themeOverrides:n.peerOverrides.Button,size:"tiny",onClick:this.handleNowClick},{default:()=>this.locale.now}):null)):null,E(Bd,{onFocus:this.handleFocusDetectorFocus}))}}),iae=Ve({name:"DateRangePanel",props:RT,setup(e){return IT(e,"daterange")},render(){var e,t,r;const{mergedClsPrefix:i,mergedTheme:n,shortcuts:a,onRender:o,$slots:s}=this;return o==null||o(),E("div",{ref:"selfRef",tabindex:0,class:[`${i}-date-panel`,`${i}-date-panel--daterange`,!this.panel&&`${i}-date-panel--shadow`,this.themeClass],onKeydown:this.handlePanelKeyDown,onFocus:this.handlePanelFocus},E("div",{ref:"startDatesElRef",class:`${i}-date-panel-calendar ${i}-date-panel-calendar--start`},E("div",{class:`${i}-date-panel-month`},E("div",{class:`${i}-date-panel-month__fast-prev`,onClick:this.startCalendarPrevYear},Sr(s["prev-year"],()=>[E(lp,null)])),E("div",{class:`${i}-date-panel-month__prev`,onClick:this.startCalendarPrevMonth},Sr(s["prev-month"],()=>[E(sp,null)])),E(up,{monthBeforeYear:this.locale.monthBeforeYear,value:this.startCalendarDateTime,onUpdateValue:this.onUpdateStartCalendarValue,mergedClsPrefix:i,calendarMonth:this.startCalendarMonth,calendarYear:this.startCalendarYear}),E("div",{class:`${i}-date-panel-month__next`,onClick:this.startCalendarNextMonth},Sr(s["next-month"],()=>[E(dp,null)])),E("div",{class:`${i}-date-panel-month__fast-next`,onClick:this.startCalendarNextYear},Sr(s["next-year"],()=>[E(cp,null)]))),E("div",{class:`${i}-date-panel-weekdays`},this.weekdays.map(l=>E("div",{key:l,class:`${i}-date-panel-weekdays__day`},l))),E("div",{class:`${i}-date-panel__divider`}),E("div",{class:`${i}-date-panel-dates`},this.startDateArray.map((l,c)=>E("div",{"data-n-date":!0,key:c,class:[`${i}-date-panel-date`,{[`${i}-date-panel-date--excluded`]:!l.inCurrentMonth,[`${i}-date-panel-date--current`]:l.isCurrentDate,[`${i}-date-panel-date--selected`]:l.selected,[`${i}-date-panel-date--covered`]:l.inSpan,[`${i}-date-panel-date--start`]:l.startOfSpan,[`${i}-date-panel-date--end`]:l.endOfSpan,[`${i}-date-panel-date--disabled`]:this.mergedIsDateDisabled(l.ts)}],onClick:()=>{this.handleDateClick(l)},onMouseenter:()=>{this.handleDateMouseEnter(l)}},E("div",{class:`${i}-date-panel-date__trigger`}),l.dateObject.date,l.isCurrentDate?E("div",{class:`${i}-date-panel-date__sup`}):null)))),E("div",{class:`${i}-date-panel__vertical-divider`}),E("div",{ref:"endDatesElRef",class:`${i}-date-panel-calendar ${i}-date-panel-calendar--end`},E("div",{class:`${i}-date-panel-month`},E("div",{class:`${i}-date-panel-month__fast-prev`,onClick:this.endCalendarPrevYear},Sr(s["prev-year"],()=>[E(lp,null)])),E("div",{class:`${i}-date-panel-month__prev`,onClick:this.endCalendarPrevMonth},Sr(s["prev-month"],()=>[E(sp,null)])),E(up,{monthBeforeYear:this.locale.monthBeforeYear,value:this.endCalendarDateTime,onUpdateValue:this.onUpdateEndCalendarValue,mergedClsPrefix:i,calendarMonth:this.endCalendarMonth,calendarYear:this.endCalendarYear}),E("div",{class:`${i}-date-panel-month__next`,onClick:this.endCalendarNextMonth},Sr(s["next-month"],()=>[E(dp,null)])),E("div",{class:`${i}-date-panel-month__fast-next`,onClick:this.endCalendarNextYear},Sr(s["next-year"],()=>[E(cp,null)]))),E("div",{class:`${i}-date-panel-weekdays`},this.weekdays.map(l=>E("div",{key:l,class:`${i}-date-panel-weekdays__day`},l))),E("div",{class:`${i}-date-panel__divider`}),E("div",{class:`${i}-date-panel-dates`},this.endDateArray.map((l,c)=>E("div",{"data-n-date":!0,key:c,class:[`${i}-date-panel-date`,{[`${i}-date-panel-date--excluded`]:!l.inCurrentMonth,[`${i}-date-panel-date--current`]:l.isCurrentDate,[`${i}-date-panel-date--selected`]:l.selected,[`${i}-date-panel-date--covered`]:l.inSpan,[`${i}-date-panel-date--start`]:l.startOfSpan,[`${i}-date-panel-date--end`]:l.endOfSpan,[`${i}-date-panel-date--disabled`]:this.mergedIsDateDisabled(l.ts)}],onClick:()=>{this.handleDateClick(l)},onMouseenter:()=>{this.handleDateMouseEnter(l)}},E("div",{class:`${i}-date-panel-date__trigger`}),l.dateObject.date,l.isCurrentDate?E("div",{class:`${i}-date-panel-date__sup`}):null)))),this.datePickerSlots.footer?E("div",{class:`${i}-date-panel-footer`},this.datePickerSlots.footer()):null,!((e=this.actions)===null||e===void 0)&&e.length||a?E("div",{class:`${i}-date-panel-actions`},E("div",{class:`${i}-date-panel-actions__prefix`},a&&Object.keys(a).map(l=>{const c=a[l];return Array.isArray(c)||typeof c=="function"?E(hd,{size:"tiny",onMouseenter:()=>{this.handleRangeShortcutMouseenter(c)},onClick:()=>{this.handleRangeShortcutClick(c)},onMouseleave:()=>{this.handleShortcutMouseleave()}},{default:()=>l}):null})),E("div",{class:`${i}-date-panel-actions__suffix`},!((t=this.actions)===null||t===void 0)&&t.includes("clear")?E(li,{theme:n.peers.Button,themeOverrides:n.peerOverrides.Button,size:"tiny",onClick:this.handleClearClick},{default:()=>this.locale.clear}):null,!((r=this.actions)===null||r===void 0)&&r.includes("confirm")?E(li,{theme:n.peers.Button,themeOverrides:n.peerOverrides.Button,size:"tiny",type:"primary",disabled:this.isRangeInvalid||this.isSelecting,onClick:this.handleConfirmClick},{default:()=>this.locale.confirm}):null)):null,E(Bd,{onFocus:this.handleFocusDetectorFocus}))}}),nae=Ve({name:"MonthRangePanel",props:Object.assign(Object.assign({},RT),{type:{type:String,required:!0}}),setup(e){const t=IT(e,e.type),{dateLocaleRef:r}=dc("DatePicker"),i=(n,a,o,s)=>{const{handleColItemClick:l}=t;return E("div",{"data-n-date":!0,key:a,class:[`${o}-date-panel-month-calendar__picker-col-item`,n.isCurrent&&`${o}-date-panel-month-calendar__picker-col-item--current`,n.selected&&`${o}-date-panel-month-calendar__picker-col-item--selected`,!1],onClick:()=>{l(n,s)}},n.type==="month"?cU(n.dateObject.month,n.monthFormat,r.value.locale):n.type==="quarter"?uU(n.dateObject.quarter,n.quarterFormat,r.value.locale):dU(n.dateObject.year,n.yearFormat,r.value.locale))};return Or(()=>{t.justifyColumnsScrollState()}),Object.assign(Object.assign({},t),{renderItem:i})},render(){var e,t,r;const{mergedClsPrefix:i,mergedTheme:n,shortcuts:a,type:o,renderItem:s,onRender:l}=this;return l==null||l(),E("div",{ref:"selfRef",tabindex:0,class:[`${i}-date-panel`,`${i}-date-panel--daterange`,!this.panel&&`${i}-date-panel--shadow`,this.themeClass],onKeydown:this.handlePanelKeyDown,onFocus:this.handlePanelFocus},E("div",{ref:"startDatesElRef",class:`${i}-date-panel-calendar ${i}-date-panel-calendar--start`},E("div",{class:`${i}-date-panel-month-calendar`},E(bn,{ref:"startYearScrollbarRef",class:`${i}-date-panel-month-calendar__picker-col`,theme:n.peers.Scrollbar,themeOverrides:n.peerOverrides.Scrollbar,container:()=>this.virtualListContainer("start"),content:()=>this.virtualListContent("start"),horizontalRailStyle:{zIndex:1},verticalRailStyle:{zIndex:1}},{default:()=>E(qv,{ref:"startYearVlRef",items:this.startYearArray,itemSize:Qu,showScrollbar:!1,keyField:"ts",onScroll:this.handleStartYearVlScroll,paddingBottom:4},{default:({item:c,index:d})=>s(c,d,i,"start")})}),o==="monthrange"||o==="quarterrange"?E("div",{class:`${i}-date-panel-month-calendar__picker-col`},E(bn,{ref:"startMonthScrollbarRef",theme:n.peers.Scrollbar,themeOverrides:n.peerOverrides.Scrollbar},{default:()=>[(o==="monthrange"?this.startMonthArray:this.startQuarterArray).map((c,d)=>s(c,d,i,"start")),o==="monthrange"&&E("div",{class:`${i}-date-panel-month-calendar__padding`})]})):null)),E("div",{class:`${i}-date-panel__vertical-divider`}),E("div",{ref:"endDatesElRef",class:`${i}-date-panel-calendar ${i}-date-panel-calendar--end`},E("div",{class:`${i}-date-panel-month-calendar`},E(bn,{ref:"endYearScrollbarRef",class:`${i}-date-panel-month-calendar__picker-col`,theme:n.peers.Scrollbar,themeOverrides:n.peerOverrides.Scrollbar,container:()=>this.virtualListContainer("end"),content:()=>this.virtualListContent("end"),horizontalRailStyle:{zIndex:1},verticalRailStyle:{zIndex:1}},{default:()=>E(qv,{ref:"endYearVlRef",items:this.endYearArray,itemSize:Qu,showScrollbar:!1,keyField:"ts",onScroll:this.handleEndYearVlScroll,paddingBottom:4},{default:({item:c,index:d})=>s(c,d,i,"end")})}),o==="monthrange"||o==="quarterrange"?E("div",{class:`${i}-date-panel-month-calendar__picker-col`},E(bn,{ref:"endMonthScrollbarRef",theme:n.peers.Scrollbar,themeOverrides:n.peerOverrides.Scrollbar},{default:()=>[(o==="monthrange"?this.endMonthArray:this.endQuarterArray).map((c,d)=>s(c,d,i,"end")),o==="monthrange"&&E("div",{class:`${i}-date-panel-month-calendar__padding`})]})):null)),this.datePickerSlots.footer?E("div",{class:`${i}-date-panel-footer`},il(this.datePickerSlots,"footer")):null,!((e=this.actions)===null||e===void 0)&&e.length||a?E("div",{class:`${i}-date-panel-actions`},E("div",{class:`${i}-date-panel-actions__prefix`},a&&Object.keys(a).map(c=>{const d=a[c];return Array.isArray(d)||typeof d=="function"?E(hd,{size:"tiny",onMouseenter:()=>{this.handleRangeShortcutMouseenter(d)},onClick:()=>{this.handleRangeShortcutClick(d)},onMouseleave:()=>{this.handleShortcutMouseleave()}},{default:()=>c}):null})),E("div",{class:`${i}-date-panel-actions__suffix`},!((t=this.actions)===null||t===void 0)&&t.includes("clear")?E(hd,{theme:n.peers.Button,themeOverrides:n.peerOverrides.Button,size:"tiny",onClick:this.handleClearClick},{default:()=>this.locale.clear}):null,!((r=this.actions)===null||r===void 0)&&r.includes("confirm")?E(hd,{theme:n.peers.Button,themeOverrides:n.peerOverrides.Button,size:"tiny",type:"primary",disabled:this.isRangeInvalid,onClick:this.handleConfirmClick},{default:()=>this.locale.confirm}):null)):null,E(Bd,{onFocus:this.handleFocusDetectorFocus}))}}),aae=ve([oe("date-picker",`
 position: relative;
 z-index: auto;
 `,[oe("date-picker-icon",`
 color: var(--n-icon-color-override);
 transition: color .3s var(--n-bezier);
 `),oe("icon",`
 color: var(--n-icon-color-override);
 transition: color .3s var(--n-bezier);
 `),xe("disabled",[oe("date-picker-icon",`
 color: var(--n-icon-color-disabled-override);
 `),oe("icon",`
 color: var(--n-icon-color-disabled-override);
 `)])]),oe("date-panel",`
 width: fit-content;
 outline: none;
 margin: 4px 0;
 display: grid;
 grid-template-columns: 0fr;
 border-radius: var(--n-panel-border-radius);
 background-color: var(--n-panel-color);
 color: var(--n-panel-text-color);
 user-select: none;
 `,[Lp(),xe("shadow",`
 box-shadow: var(--n-panel-box-shadow);
 `),oe("date-panel-calendar",{padding:"var(--n-calendar-left-padding)",display:"grid",gridTemplateColumns:"1fr",gridArea:"left-calendar"},[xe("end",{padding:"var(--n-calendar-right-padding)",gridArea:"right-calendar"})]),oe("date-panel-month-calendar",{display:"flex",gridArea:"left-calendar"},[he("picker-col",`
 min-width: var(--n-scroll-item-width);
 height: calc(var(--n-scroll-item-height) * 6);
 user-select: none;
 -webkit-user-select: none;
 `,[ve("&:first-child",`
 min-width: calc(var(--n-scroll-item-width) + 4px);
 `,[he("picker-col-item",[ve("&::before","left: 4px;")])]),he("padding",`
 height: calc(var(--n-scroll-item-height) * 5)
 `)]),he("picker-col-item",`
 z-index: 0;
 cursor: pointer;
 height: var(--n-scroll-item-height);
 box-sizing: border-box;
 padding-top: 4px;
 display: flex;
 align-items: center;
 justify-content: center;
 position: relative;
 transition: 
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier);
 background: #0000;
 color: var(--n-item-text-color);
 `,[ve("&::before",`
 z-index: -1;
 content: "";
 position: absolute;
 left: 0;
 right: 4px;
 top: 4px;
 bottom: 0;
 border-radius: var(--n-scroll-item-border-radius);
 transition: 
 background-color .3s var(--n-bezier);
 `),yr("disabled",[ve("&:hover::before",`
 background-color: var(--n-item-color-hover);
 `),xe("selected",`
 color: var(--n-item-color-active);
 `,[ve("&::before","background-color: var(--n-item-color-hover);")])]),xe("disabled",`
 color: var(--n-item-text-color-disabled);
 cursor: not-allowed;
 `,[xe("selected",[ve("&::before",`
 background-color: var(--n-item-color-disabled);
 `)])])])]),xe("date",{gridTemplateAreas:`
 "left-calendar"
 "footer"
 "action"
 `}),xe("week",{gridTemplateAreas:`
 "left-calendar"
 "footer"
 "action"
 `}),xe("daterange",{gridTemplateAreas:`
 "left-calendar divider right-calendar"
 "footer footer footer"
 "action action action"
 `}),xe("datetime",{gridTemplateAreas:`
 "header"
 "left-calendar"
 "footer"
 "action"
 `}),xe("datetimerange",{gridTemplateAreas:`
 "header header header"
 "left-calendar divider right-calendar"
 "footer footer footer"
 "action action action"
 `}),xe("month",{gridTemplateAreas:`
 "left-calendar"
 "footer"
 "action"
 `}),oe("date-panel-footer",{gridArea:"footer"}),oe("date-panel-actions",{gridArea:"action"}),oe("date-panel-header",{gridArea:"header"}),oe("date-panel-header",`
 box-sizing: border-box;
 width: 100%;
 align-items: center;
 padding: var(--n-panel-header-padding);
 display: flex;
 justify-content: space-between;
 border-bottom: 1px solid var(--n-panel-header-divider-color);
 `,[ve(">",[ve("*:not(:last-child)",{marginRight:"10px"}),ve("*",{flex:1,width:0}),oe("time-picker",{zIndex:1})])]),oe("date-panel-month",`
 box-sizing: border-box;
 display: grid;
 grid-template-columns: var(--n-calendar-title-grid-template-columns);
 align-items: center;
 justify-items: center;
 padding: var(--n-calendar-title-padding);
 height: var(--n-calendar-title-height);
 `,[he("prev, next, fast-prev, fast-next",`
 line-height: 0;
 cursor: pointer;
 width: var(--n-arrow-size);
 height: var(--n-arrow-size);
 color: var(--n-arrow-color);
 `),he("month-year",`
 user-select: none;
 -webkit-user-select: none;
 flex-grow: 1;
 position: relative;
 `,[he("text",`
 font-size: var(--n-calendar-title-font-size);
 line-height: var(--n-calendar-title-font-size);
 font-weight: var(--n-calendar-title-font-weight);
 padding: 6px 8px;
 text-align: center;
 color: var(--n-calendar-title-text-color);
 cursor: pointer;
 transition: background-color .3s var(--n-bezier);
 border-radius: var(--n-panel-border-radius);
 `,[xe("active",`
 background-color: var(--n-calendar-title-color-hover);
 `),ve("&:hover",`
 background-color: var(--n-calendar-title-color-hover);
 `)])])]),oe("date-panel-weekdays",`
 display: grid;
 margin: auto;
 grid-template-columns: repeat(7, var(--n-item-cell-width));
 grid-template-rows: repeat(1, var(--n-item-cell-height));
 align-items: center;
 justify-items: center;
 margin-bottom: 4px;
 border-bottom: 1px solid var(--n-calendar-days-divider-color);
 `,[he("day",`
 user-select: none;
 -webkit-user-select: none;
 line-height: 15px;
 width: var(--n-item-size);
 text-align: center;
 font-size: var(--n-calendar-days-font-size);
 color: var(--n-item-text-color);
 `)]),oe("date-panel-dates",`
 margin: auto;
 display: grid;
 grid-template-columns: repeat(7, var(--n-item-cell-width));
 grid-template-rows: repeat(6, var(--n-item-cell-height));
 align-items: center;
 justify-items: center;
 flex-wrap: wrap;
 `,[oe("date-panel-date",`
 user-select: none;
 -webkit-user-select: none;
 position: relative;
 width: var(--n-item-size);
 height: var(--n-item-size);
 line-height: var(--n-item-size);
 text-align: center;
 font-size: var(--n-item-font-size);
 border-radius: var(--n-item-border-radius);
 z-index: 0;
 cursor: pointer;
 transition:
 background-color .2s var(--n-bezier),
 color .2s var(--n-bezier);
 `,[he("trigger",`
 position: absolute;
 left: calc(var(--n-item-size) / 2 - var(--n-item-cell-width) / 2);
 top: calc(var(--n-item-size) / 2 - var(--n-item-cell-height) / 2);
 width: var(--n-item-cell-width);
 height: var(--n-item-cell-height);
 `),xe("current",[he("sup",`
 position: absolute;
 top: 2px;
 right: 2px;
 content: "";
 height: 4px;
 width: 4px;
 border-radius: 2px;
 background-color: var(--n-item-color-active);
 transition:
 background-color .2s var(--n-bezier);
 `)]),ve("&::after",`
 content: "";
 z-index: -1;
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 border-radius: inherit;
 transition: background-color .3s var(--n-bezier);
 `),xe("covered, start, end",[yr("excluded",[ve("&::before",`
 content: "";
 z-index: -2;
 position: absolute;
 left: calc((var(--n-item-size) - var(--n-item-cell-width)) / 2);
 right: calc((var(--n-item-size) - var(--n-item-cell-width)) / 2);
 top: 0;
 bottom: 0;
 background-color: var(--n-item-color-included);
 `),ve("&:nth-child(7n + 1)::before",{borderTopLeftRadius:"var(--n-item-border-radius)",borderBottomLeftRadius:"var(--n-item-border-radius)"}),ve("&:nth-child(7n + 7)::before",{borderTopRightRadius:"var(--n-item-border-radius)",borderBottomRightRadius:"var(--n-item-border-radius)"})])]),xe("selected",{color:"var(--n-item-text-color-active)"},[ve("&::after",{backgroundColor:"var(--n-item-color-active)"}),xe("start",[ve("&::before",{left:"50%"})]),xe("end",[ve("&::before",{right:"50%"})]),he("sup",{backgroundColor:"var(--n-panel-color)"})]),xe("excluded",{color:"var(--n-item-text-color-disabled)"},[xe("selected",[ve("&::after",{backgroundColor:"var(--n-item-color-disabled)"})])]),xe("disabled",{cursor:"not-allowed",color:"var(--n-item-text-color-disabled)"},[xe("covered",[ve("&::before",{backgroundColor:"var(--n-item-color-disabled)"})]),xe("selected",[ve("&::before",{backgroundColor:"var(--n-item-color-disabled)"}),ve("&::after",{backgroundColor:"var(--n-item-color-disabled)"})])]),xe("week-hovered",[ve("&::before",`
 background-color: var(--n-item-color-included);
 `),ve("&:nth-child(7n + 1)::before",`
 border-top-left-radius: var(--n-item-border-radius);
 border-bottom-left-radius: var(--n-item-border-radius);
 `),ve("&:nth-child(7n + 7)::before",`
 border-top-right-radius: var(--n-item-border-radius);
 border-bottom-right-radius: var(--n-item-border-radius);
 `)]),xe("week-selected",`
 color: var(--n-item-text-color-active)
 `,[ve("&::before",`
 background-color: var(--n-item-color-active);
 `),ve("&:nth-child(7n + 1)::before",`
 border-top-left-radius: var(--n-item-border-radius);
 border-bottom-left-radius: var(--n-item-border-radius);
 `),ve("&:nth-child(7n + 7)::before",`
 border-top-right-radius: var(--n-item-border-radius);
 border-bottom-right-radius: var(--n-item-border-radius);
 `)])])]),yr("week",[oe("date-panel-dates",[oe("date-panel-date",[yr("disabled",[yr("selected",[ve("&:hover",`
 background-color: var(--n-item-color-hover);
 `)])])])])]),xe("week",[oe("date-panel-dates",[oe("date-panel-date",[ve("&::before",`
 content: "";
 z-index: -2;
 position: absolute;
 left: calc((var(--n-item-size) - var(--n-item-cell-width)) / 2);
 right: calc((var(--n-item-size) - var(--n-item-cell-width)) / 2);
 top: 0;
 bottom: 0;
 transition: background-color .3s var(--n-bezier);
 `)])])]),he("vertical-divider",`
 grid-area: divider;
 height: 100%;
 width: 1px;
 background-color: var(--n-calendar-divider-color);
 `),oe("date-panel-footer",`
 border-top: 1px solid var(--n-panel-action-divider-color);
 padding: var(--n-panel-extra-footer-padding);
 `),oe("date-panel-actions",`
 flex: 1;
 padding: var(--n-panel-action-padding);
 display: flex;
 align-items: center;
 justify-content: space-between;
 border-top: 1px solid var(--n-panel-action-divider-color);
 `,[he("prefix, suffix",`
 display: flex;
 margin-bottom: -8px;
 `),he("suffix",`
 align-self: flex-end;
 `),he("prefix",`
 flex-wrap: wrap;
 `),oe("button",`
 margin-bottom: 8px;
 `,[ve("&:not(:last-child)",`
 margin-right: 8px;
 `)])])]),ve("[data-n-date].transition-disabled",{transition:"none !important"},[ve("&::before, &::after",{transition:"none !important"})])]),oae=Object.assign(Object.assign({},bt.props),{to:jn.propTo,bordered:{type:Boolean,default:void 0},clearable:Boolean,updateValueOnClose:Boolean,defaultValue:[Number,Array],defaultFormattedValue:[String,Array],defaultTime:[Number,String,Array],disabled:{type:Boolean,default:void 0},placement:{type:String,default:"bottom-start"},value:[Number,Array],formattedValue:[String,Array],size:String,type:{type:String,default:"date"},valueFormat:String,separator:String,placeholder:String,startPlaceholder:String,endPlaceholder:String,format:String,dateFormat:String,timerPickerFormat:String,actions:Array,shortcuts:Object,isDateDisabled:Function,isTimeDisabled:Function,show:{type:Boolean,default:void 0},panel:Boolean,ranges:Object,firstDayOfWeek:Number,inputReadonly:Boolean,closeOnSelect:Boolean,status:String,timePickerProps:[Object,Array],onClear:Function,onConfirm:Function,defaultCalendarStartTime:Number,defaultCalendarEndTime:Number,bindCalendarMonths:Boolean,monthFormat:{type:String,default:"M"},yearFormat:{type:String,default:"y"},quarterFormat:{type:String,default:"'Q'Q"},"onUpdate:show":[Function,Array],onUpdateShow:[Function,Array],"onUpdate:formattedValue":[Function,Array],onUpdateFormattedValue:[Function,Array],"onUpdate:value":[Function,Array],onUpdateValue:[Function,Array],onFocus:[Function,Array],onBlur:[Function,Array],onNextMonth:Function,onPrevMonth:Function,onNextYear:Function,onPrevYear:Function,onChange:[Function,Array]}),hS=Ve({name:"DatePicker",props:oae,setup(e,{slots:t}){var r;const{localeRef:i,dateLocaleRef:n}=dc("DatePicker"),a=cl(e),{mergedSizeRef:o,mergedDisabledRef:s,mergedStatusRef:l}=a,{mergedComponentPropsRef:c,mergedClsPrefixRef:d,mergedBorderedRef:u,namespaceRef:h,inlineThemeDisabled:f}=mr(e),p=ge(null),v=ge(null),m=ge(null),g=ge(!1),y=pt(e,"show"),b=Un(y,g),x=re(()=>({locale:n.value.locale})),S=re(()=>{const{format:ce}=e;if(ce)return ce;switch(e.type){case"date":case"daterange":return i.value.dateFormat;case"datetime":case"datetimerange":return i.value.dateTimeFormat;case"year":case"yearrange":return i.value.yearTypeFormat;case"month":case"monthrange":return i.value.monthTypeFormat;case"quarter":case"quarterrange":return i.value.quarterFormat;case"week":return i.value.weekFormat}}),w=re(()=>{var ce;return(ce=e.valueFormat)!==null&&ce!==void 0?ce:S.value});function _(ce){if(ce===null)return null;const{value:Re}=w,{value:$e}=x;return Array.isArray(ce)?[ja(ce[0],Re,new Date,$e).getTime(),ja(ce[1],Re,new Date,$e).getTime()]:ja(ce,Re,new Date,$e).getTime()}const{defaultFormattedValue:C,defaultValue:A}=e,M=ge((r=C!==void 0?_(C):A)!==null&&r!==void 0?r:null),P=re(()=>{const{formattedValue:ce}=e;return ce!==void 0?_(ce):e.value}),T=Un(P,M),R=ge(null);Qa(()=>{R.value=T.value});const z=ge(""),F=ge(""),H=ge(""),N=bt("DatePicker","-date-picker",aae,Rie,e,d),U=re(()=>{var ce,Re;return((Re=(ce=c==null?void 0:c.value)===null||ce===void 0?void 0:ce.DatePicker)===null||Re===void 0?void 0:Re.timePickerSize)||"small"}),ie=re(()=>["daterange","datetimerange","monthrange","quarterrange","yearrange"].includes(e.type)),te=re(()=>{const{placeholder:ce}=e;if(ce===void 0){const{type:Re}=e;switch(Re){case"date":return i.value.datePlaceholder;case"datetime":return i.value.datetimePlaceholder;case"month":return i.value.monthPlaceholder;case"year":return i.value.yearPlaceholder;case"quarter":return i.value.quarterPlaceholder;case"week":return i.value.weekPlaceholder;default:return""}}else return ce}),X=re(()=>e.startPlaceholder===void 0?e.type==="daterange"?i.value.startDatePlaceholder:e.type==="datetimerange"?i.value.startDatetimePlaceholder:e.type==="monthrange"?i.value.startMonthPlaceholder:"":e.startPlaceholder),W=re(()=>e.endPlaceholder===void 0?e.type==="daterange"?i.value.endDatePlaceholder:e.type==="datetimerange"?i.value.endDatetimePlaceholder:e.type==="monthrange"?i.value.endMonthPlaceholder:"":e.endPlaceholder),q=re(()=>{const{actions:ce,type:Re,clearable:$e}=e;if(ce===null)return[];if(ce!==void 0)return ce;const at=$e?["clear"]:[];switch(Re){case"date":case"week":return at.push("now"),at;case"datetime":return at.push("now","confirm"),at;case"daterange":return at.push("confirm"),at;case"datetimerange":return at.push("confirm"),at;case"month":return at.push("now","confirm"),at;case"year":return at.push("now"),at;case"quarter":return at.push("now","confirm"),at;case"monthrange":case"yearrange":case"quarterrange":return at.push("confirm"),at;default:{Yu("date-picker","The type is wrong, n-date-picker's type only supports `date`, `datetime`, `daterange` and `datetimerange`.");break}}});function $(ce){if(ce===null)return null;if(Array.isArray(ce)){const{value:Re}=w,{value:$e}=x;return[ai(ce[0],Re,$e),ai(ce[1],Re,x.value)]}else return ai(ce,w.value,x.value)}function le(ce){R.value=ce}function ee(ce,Re){const{"onUpdate:formattedValue":$e,onUpdateFormattedValue:at}=e;$e&&ct($e,ce,Re),at&&ct(at,ce,Re)}function Q(ce,Re){const{"onUpdate:value":$e,onUpdateValue:at,onChange:qt}=e,{nTriggerFormChange:ir,nTriggerFormInput:Fe}=a,Ke=$(ce);Re.doConfirm&&V(ce,Ke),at&&ct(at,ce,Ke),$e&&ct($e,ce,Ke),qt&&ct(qt,ce,Ke),M.value=ce,ee(Ke,ce),ir(),Fe()}function ne(){const{onClear:ce}=e;ce==null||ce()}function V(ce,Re){const{onConfirm:$e}=e;$e&&$e(ce,Re)}function de(ce){const{onFocus:Re}=e,{nTriggerFormFocus:$e}=a;Re&&ct(Re,ce),$e()}function me(ce){const{onBlur:Re}=e,{nTriggerFormBlur:$e}=a;Re&&ct(Re,ce),$e()}function Ce(ce){const{"onUpdate:show":Re,onUpdateShow:$e}=e;Re&&ct(Re,ce),$e&&ct($e,ce),g.value=ce}function G(ce){ce.key==="Escape"&&b.value&&(Gv(ce),lt({returnFocus:!0}))}function Z(ce){ce.key==="Escape"&&b.value&&Gv(ce)}function ue(){var ce;Ce(!1),(ce=m.value)===null||ce===void 0||ce.deactivate(),ne()}function Se(){var ce;(ce=m.value)===null||ce===void 0||ce.deactivate(),ne()}function we(){lt({returnFocus:!0})}function _e(ce){var Re;b.value&&!(!((Re=v.value)===null||Re===void 0)&&Re.contains(Jl(ce)))&&lt({returnFocus:!1})}function Ee(ce){lt({returnFocus:!0,disableUpdateOnClose:ce})}function fe(ce,Re){Re?Q(ce,{doConfirm:!1}):le(ce)}function B(){const ce=R.value;Q(Array.isArray(ce)?[ce[0],ce[1]]:ce,{doConfirm:!0})}function D(){const{value:ce}=R;ie.value?(Array.isArray(ce)||ce===null)&&O(ce):Array.isArray(ce)||I(ce)}function I(ce){ce===null?z.value="":z.value=ai(ce,S.value,x.value)}function O(ce){if(ce===null)F.value="",H.value="";else{const Re=x.value;F.value=ai(ce[0],S.value,Re),H.value=ai(ce[1],S.value,Re)}}function j(){b.value||nt()}function L(ce){var Re;!((Re=p.value)===null||Re===void 0)&&Re.$el.contains(ce.relatedTarget)||(me(ce),D(),lt({returnFocus:!1}))}function Ae(){s.value||(D(),lt({returnFocus:!1}))}function We(ce){if(ce===""){Q(null,{doConfirm:!1}),R.value=null,z.value="";return}const Re=ja(ce,S.value,new Date,x.value);To(Re)?(Q(gt(Re),{doConfirm:!1}),D()):z.value=ce}function je(ce,{source:Re}){if(ce[0]===""&&ce[1]===""){Q(null,{doConfirm:!1}),R.value=null,F.value="",H.value="";return}const[$e,at]=ce,qt=ja($e,S.value,new Date,x.value),ir=ja(at,S.value,new Date,x.value);if(To(qt)&&To(ir)){let Fe=gt(qt),Ke=gt(ir);ir<qt&&(Re===0?Ke=Fe:Fe=Ke),Q([Fe,Ke],{doConfirm:!1}),D()}else[F.value,H.value]=ce}function ze(ce){s.value||yd(ce,"clear")||b.value||nt()}function Je(ce){s.value||de(ce)}function nt(){s.value||b.value||Ce(!0)}function lt({returnFocus:ce,disableUpdateOnClose:Re}){var $e;b.value&&(Ce(!1),e.type!=="date"&&e.updateValueOnClose&&!Re&&B(),ce&&(($e=m.value)===null||$e===void 0||$e.focus()))}tr(R,()=>{D()}),D(),tr(b,ce=>{ce||(R.value=T.value)});const dt=Iie(e,R),vt=zie(e,R);br(L1,Object.assign(Object.assign(Object.assign({mergedClsPrefixRef:d,mergedThemeRef:N,timePickerSizeRef:U,localeRef:i,dateLocaleRef:n,firstDayOfWeekRef:pt(e,"firstDayOfWeek"),isDateDisabledRef:pt(e,"isDateDisabled"),rangesRef:pt(e,"ranges"),timePickerPropsRef:pt(e,"timePickerProps"),closeOnSelectRef:pt(e,"closeOnSelect"),updateValueOnCloseRef:pt(e,"updateValueOnClose"),monthFormatRef:pt(e,"monthFormat"),yearFormatRef:pt(e,"yearFormat"),quarterFormatRef:pt(e,"quarterFormat")},dt),vt),{datePickerSlots:t}));const se={focus:()=>{var ce;(ce=m.value)===null||ce===void 0||ce.focus()},blur:()=>{var ce;(ce=m.value)===null||ce===void 0||ce.blur()}},Le=re(()=>{const{common:{cubicBezierEaseInOut:ce},self:{iconColor:Re,iconColorDisabled:$e}}=N.value;return{"--n-bezier":ce,"--n-icon-color-override":Re,"--n-icon-color-disabled-override":$e}}),Ye=f?Dr("date-picker-trigger",void 0,Le,e):void 0,pe=re(()=>{const{type:ce}=e,{common:{cubicBezierEaseInOut:Re},self:{calendarTitleFontSize:$e,calendarDaysFontSize:at,itemFontSize:qt,itemTextColor:ir,itemColorDisabled:Fe,itemColorIncluded:Ke,itemColorHover:ut,itemColorActive:Ft,itemBorderRadius:ui,itemTextColorDisabled:_i,itemTextColorActive:Ar,panelColor:De,panelTextColor:K,arrowColor:Me,calendarTitleTextColor:He,panelActionDividerColor:Oe,panelHeaderDividerColor:Ne,calendarDaysDividerColor:wt,panelBoxShadow:Rt,panelBorderRadius:It,calendarTitleFontWeight:Tt,panelExtraFooterPadding:hr,panelActionPadding:Zt,itemSize:Pe,itemCellWidth:Qe,itemCellHeight:xt,scrollItemWidth:Mr,scrollItemHeight:ci,calendarTitlePadding:Nt,calendarTitleHeight:nr,calendarDaysHeight:_n,calendarDaysTextColor:Jt,arrowSize:ro,panelHeaderPadding:Uo,calendarDividerColor:uo,calendarTitleGridTempateColumns:ka,iconColor:Y,iconColorDisabled:J,scrollItemBorderRadius:be,calendarTitleColorHover:ae,[Ze("calendarLeftPadding",ce)]:Ie,[Ze("calendarRightPadding",ce)]:ot}}=N.value;return{"--n-bezier":Re,"--n-panel-border-radius":It,"--n-panel-color":De,"--n-panel-box-shadow":Rt,"--n-panel-text-color":K,"--n-panel-header-padding":Uo,"--n-panel-header-divider-color":Ne,"--n-calendar-left-padding":Ie,"--n-calendar-right-padding":ot,"--n-calendar-title-color-hover":ae,"--n-calendar-title-height":nr,"--n-calendar-title-padding":Nt,"--n-calendar-title-font-size":$e,"--n-calendar-title-font-weight":Tt,"--n-calendar-title-text-color":He,"--n-calendar-title-grid-template-columns":ka,"--n-calendar-days-height":_n,"--n-calendar-days-divider-color":wt,"--n-calendar-days-font-size":at,"--n-calendar-days-text-color":Jt,"--n-calendar-divider-color":uo,"--n-panel-action-padding":Zt,"--n-panel-extra-footer-padding":hr,"--n-panel-action-divider-color":Oe,"--n-item-font-size":qt,"--n-item-border-radius":ui,"--n-item-size":Pe,"--n-item-cell-width":Qe,"--n-item-cell-height":xt,"--n-item-text-color":ir,"--n-item-color-included":Ke,"--n-item-color-disabled":Fe,"--n-item-color-hover":ut,"--n-item-color-active":Ft,"--n-item-text-color-disabled":_i,"--n-item-text-color-active":Ar,"--n-scroll-item-width":Mr,"--n-scroll-item-height":ci,"--n-scroll-item-border-radius":be,"--n-arrow-size":ro,"--n-arrow-color":Me,"--n-icon-color":Y,"--n-icon-color-disabled":J}}),Te=f?Dr("date-picker",re(()=>e.type),pe,e):void 0;return Object.assign(Object.assign({},se),{mergedStatus:l,mergedClsPrefix:d,mergedBordered:u,namespace:h,uncontrolledValue:M,pendingValue:R,panelInstRef:p,triggerElRef:v,inputInstRef:m,isMounted:zd(),displayTime:z,displayStartTime:F,displayEndTime:H,mergedShow:b,adjustedTo:jn(e),isRange:ie,localizedStartPlaceholder:X,localizedEndPlaceholder:W,mergedSize:o,mergedDisabled:s,localizedPlacehoder:te,isValueInvalid:dt.isValueInvalidRef,isStartValueInvalid:vt.isStartValueInvalidRef,isEndValueInvalid:vt.isEndValueInvalidRef,handleInputKeydown:Z,handleClickOutside:_e,handleKeydown:G,handleClear:ue,handlePanelClear:Se,handleTriggerClick:ze,handleInputActivate:j,handleInputDeactivate:Ae,handleInputFocus:Je,handleInputBlur:L,handlePanelTabOut:we,handlePanelClose:Ee,handleRangeUpdateValue:je,handleSingleUpdateValue:We,handlePanelUpdateValue:fe,handlePanelConfirm:B,mergedTheme:N,actions:q,triggerCssVars:f?void 0:Le,triggerThemeClass:Ye==null?void 0:Ye.themeClass,triggerOnRender:Ye==null?void 0:Ye.onRender,cssVars:f?void 0:pe,themeClass:Te==null?void 0:Te.themeClass,onRender:Te==null?void 0:Te.onRender,onNextMonth:e.onNextMonth,onPrevMonth:e.onPrevMonth,onNextYear:e.onNextYear,onPrevYear:e.onPrevYear})},render(){const{clearable:e,triggerOnRender:t,mergedClsPrefix:r,$slots:i}=this,n={onUpdateValue:this.handlePanelUpdateValue,onTabOut:this.handlePanelTabOut,onClose:this.handlePanelClose,onClear:this.handlePanelClear,onKeydown:this.handleKeydown,onConfirm:this.handlePanelConfirm,ref:"panelInstRef",value:this.pendingValue,active:this.mergedShow,actions:this.actions,shortcuts:this.shortcuts,style:this.cssVars,defaultTime:this.defaultTime,themeClass:this.themeClass,panel:this.panel,onRender:this.onRender,onNextMonth:this.onNextMonth,onPrevMonth:this.onPrevMonth,onNextYear:this.onNextYear,onPrevYear:this.onPrevYear,timerPickerFormat:this.timerPickerFormat},a=()=>{const{type:s}=this;return s==="datetime"?E(eae,Object.assign({},n,{defaultCalendarStartTime:this.defaultCalendarStartTime}),i):s==="daterange"?E(iae,Object.assign({},n,{defaultCalendarStartTime:this.defaultCalendarStartTime,defaultCalendarEndTime:this.defaultCalendarEndTime,bindCalendarMonths:this.bindCalendarMonths}),i):s==="datetimerange"?E(tae,Object.assign({},n,{defaultCalendarStartTime:this.defaultCalendarStartTime,defaultCalendarEndTime:this.defaultCalendarEndTime,bindCalendarMonths:this.bindCalendarMonths}),i):s==="month"||s==="year"||s==="quarter"?E(LU,Object.assign({},n,{type:s,key:s})):s==="monthrange"||s==="yearrange"||s==="quarterrange"?E(nae,Object.assign({},n,{type:s})):E(rae,Object.assign({},n,{type:s,defaultCalendarStartTime:this.defaultCalendarStartTime}),i)};if(this.panel)return a();t==null||t();const o={bordered:this.mergedBordered,size:this.mergedSize,passivelyActivated:!0,disabled:this.mergedDisabled,readonly:this.inputReadonly||this.mergedDisabled,clearable:e,onClear:this.handleClear,onClick:this.handleTriggerClick,onKeydown:this.handleInputKeydown,onActivate:this.handleInputActivate,onDeactivate:this.handleInputDeactivate,onFocus:this.handleInputFocus,onBlur:this.handleInputBlur};return E("div",{ref:"triggerElRef",class:[`${r}-date-picker`,this.mergedDisabled&&`${r}-date-picker--disabled`,this.isRange&&`${r}-date-picker--range`,this.triggerThemeClass],style:this.triggerCssVars,onKeydown:this.handleKeydown},E(ch,null,{default:()=>[E(dh,null,{default:()=>this.isRange?E(cr,Object.assign({ref:"inputInstRef",status:this.mergedStatus,value:[this.displayStartTime,this.displayEndTime],placeholder:[this.localizedStartPlaceholder,this.localizedEndPlaceholder],textDecoration:[this.isStartValueInvalid?"line-through":"",this.isEndValueInvalid?"line-through":""],pair:!0,onUpdateValue:this.handleRangeUpdateValue,theme:this.mergedTheme.peers.Input,themeOverrides:this.mergedTheme.peerOverrides.Input,internalForceFocus:this.mergedShow,internalDeactivateOnEnter:!0},o),{separator:()=>this.separator===void 0?Sr(i.separator,()=>[E(Li,{clsPrefix:r,class:`${r}-date-picker-icon`},{default:()=>E(jee,null)})]):this.separator,[e?"clear-icon-placeholder":"suffix"]:()=>Sr(i["date-icon"],()=>[E(Li,{clsPrefix:r,class:`${r}-date-picker-icon`},{default:()=>E(CO,null)})])}):E(cr,Object.assign({ref:"inputInstRef",status:this.mergedStatus,value:this.displayTime,placeholder:this.localizedPlacehoder,textDecoration:this.isValueInvalid&&!this.isRange?"line-through":"",onUpdateValue:this.handleSingleUpdateValue,theme:this.mergedTheme.peers.Input,themeOverrides:this.mergedTheme.peerOverrides.Input,internalForceFocus:this.mergedShow,internalDeactivateOnEnter:!0},o),{[e?"clear-icon-placeholder":"suffix"]:()=>E(Li,{clsPrefix:r,class:`${r}-date-picker-icon`},{default:()=>Sr(i["date-icon"],()=>[E(CO,null)])})})}),E(uh,{show:this.mergedShow,containerClass:this.namespace,to:this.adjustedTo,teleportDisabled:this.adjustedTo===jn.tdkey,placement:this.placement},{default:()=>E(Da,{name:"fade-in-scale-up-transition",appear:this.isMounted},{default:()=>this.mergedShow?Ka(a(),[[bd,this.handleClickOutside,void 0,{capture:!0}]]):null})})]}))}}),sae=e=>{const{textColor1:t,dividerColor:r,fontWeightStrong:i}=e;return{textColor:t,color:r,fontWeight:i}},lae={name:"Divider",common:Gr,self:sae},cae=oe("divider",`
 position: relative;
 display: flex;
 width: 100%;
 box-sizing: border-box;
 font-size: 16px;
 color: var(--n-text-color);
 transition:
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier);
`,[yr("vertical",`
 margin-top: 24px;
 margin-bottom: 24px;
 `,[yr("no-title",`
 display: flex;
 align-items: center;
 `)]),he("title",`
 display: flex;
 align-items: center;
 margin-left: 12px;
 margin-right: 12px;
 white-space: nowrap;
 font-weight: var(--n-font-weight);
 `),xe("title-position-left",[he("line",[xe("left",{width:"28px"})])]),xe("title-position-right",[he("line",[xe("right",{width:"28px"})])]),xe("dashed",[he("line",`
 background-color: #0000;
 height: 0px;
 width: 100%;
 border-style: dashed;
 border-width: 1px 0 0;
 `)]),xe("vertical",`
 display: inline-block;
 height: 1em;
 margin: 0 8px;
 vertical-align: middle;
 width: 1px;
 `),he("line",`
 border: none;
 transition: background-color .3s var(--n-bezier), border-color .3s var(--n-bezier);
 height: 1px;
 width: 100%;
 margin: 0;
 `),yr("dashed",[he("line",{backgroundColor:"var(--n-color)"})]),xe("dashed",[he("line",{borderColor:"var(--n-color)"})]),xe("vertical",{backgroundColor:"var(--n-color)"})]),dae=Object.assign(Object.assign({},bt.props),{titlePlacement:{type:String,default:"center"},dashed:Boolean,vertical:Boolean}),WO=Ve({name:"Divider",props:dae,setup(e){const{mergedClsPrefixRef:t,inlineThemeDisabled:r}=mr(e),i=bt("Divider","-divider",cae,lae,e,t),n=re(()=>{const{common:{cubicBezierEaseInOut:o},self:{color:s,textColor:l,fontWeight:c}}=i.value;return{"--n-bezier":o,"--n-color":s,"--n-text-color":l,"--n-font-weight":c}}),a=r?Dr("divider",void 0,n,e):void 0;return{mergedClsPrefix:t,cssVars:r?void 0:n,themeClass:a==null?void 0:a.themeClass,onRender:a==null?void 0:a.onRender}},render(){var e;const{$slots:t,titlePlacement:r,vertical:i,dashed:n,cssVars:a,mergedClsPrefix:o}=this;return(e=this.onRender)===null||e===void 0||e.call(this),E("div",{role:"separator",class:[`${o}-divider`,this.themeClass,{[`${o}-divider--vertical`]:i,[`${o}-divider--no-title`]:!t.default,[`${o}-divider--dashed`]:n,[`${o}-divider--title-position-${r}`]:t.default&&r}],style:a},i?null:E("div",{class:`${o}-divider__line ${o}-divider__line--left`}),!i&&t.default?E(pr,null,E("div",{class:`${o}-divider__title`},this.$slots),E("div",{class:`${o}-divider__line ${o}-divider__line--right`})):null)}}),uae={actionMargin:"0 0 0 20px",actionMarginRtl:"0 20px 0 0"},hae=()=>uae,fae={name:"DynamicInput",common:Gr,peers:{Input:Bp,Button:zg},self:hae},zT="n-dynamic-input",pae=Ve({name:"DynamicInputInputPreset",props:{clsPrefix:{type:String,required:!0},value:{type:String,default:""},disabled:Boolean,parentPath:String,path:String,onUpdateValue:{type:Function,required:!0}},setup(){const{mergedThemeRef:e,placeholderRef:t}=_t(zT);return{mergedTheme:e,placeholder:t}},render(){const{mergedTheme:e,placeholder:t,value:r,clsPrefix:i,onUpdateValue:n,disabled:a}=this;return E("div",{class:`${i}-dynamic-input-preset-input`},E(cr,{theme:e.peers.Input,"theme-overrides":e.peerOverrides.Input,value:r,placeholder:t,onUpdateValue:n,disabled:a}))}}),mae=Ve({name:"DynamicInputPairPreset",props:{clsPrefix:{type:String,required:!0},value:{type:Object,default:()=>({key:"",value:""})},disabled:Boolean,parentPath:String,path:String,onUpdateValue:{type:Function,required:!0}},setup(e){const{mergedThemeRef:t,keyPlaceholderRef:r,valuePlaceholderRef:i}=_t(zT);return{mergedTheme:t,keyPlaceholder:r,valuePlaceholder:i,handleKeyInput(n){e.onUpdateValue({key:n,value:e.value.value})},handleValueInput(n){e.onUpdateValue({key:e.value.key,value:n})}}},render(){const{mergedTheme:e,keyPlaceholder:t,valuePlaceholder:r,value:i,clsPrefix:n,disabled:a}=this;return E("div",{class:`${n}-dynamic-input-preset-pair`},E(cr,{theme:e.peers.Input,"theme-overrides":e.peerOverrides.Input,value:i.key,class:`${n}-dynamic-input-pair-input`,placeholder:t,onUpdateValue:this.handleKeyInput,disabled:a}),E(cr,{theme:e.peers.Input,"theme-overrides":e.peerOverrides.Input,value:i.value,class:`${n}-dynamic-input-pair-input`,placeholder:r,onUpdateValue:this.handleValueInput,disabled:a}))}}),vae=oe("dynamic-input",{width:"100%"},[oe("dynamic-input-item",`
 margin-bottom: 10px;
 display: flex;
 flex-wrap: nowrap;
 `,[oe("dynamic-input-preset-input",{flex:1,alignItems:"center"}),oe("dynamic-input-preset-pair",`
 flex: 1;
 display: flex;
 align-items: center;
 `,[oe("dynamic-input-pair-input",[ve("&:first-child",{"margin-right":"12px"})])]),he("action",`
 align-self: flex-start;
 display: flex;
 justify-content: flex-end;
 flex-shrink: 0;
 flex-grow: 0;
 margin: var(--action-margin);
 `,[xe("icon",{cursor:"pointer"})]),ve("&:last-child",{marginBottom:0})]),oe("form-item",`
 padding-top: 0 !important;
 margin-right: 0 !important;
 `,[oe("form-item-blank",{paddingTop:"0 !important"})])]),D0=new WeakMap,gae=Object.assign(Object.assign({},bt.props),{max:Number,min:{type:Number,default:0},value:Array,defaultValue:{type:Array,default:()=>[]},preset:{type:String,default:"input"},keyField:String,itemClass:String,itemStyle:[String,Object],keyPlaceholder:{type:String,default:""},valuePlaceholder:{type:String,default:""},placeholder:{type:String,default:""},disabled:Boolean,showSortButton:Boolean,createButtonProps:Object,onCreate:Function,onRemove:Function,"onUpdate:value":[Function,Array],onUpdateValue:[Function,Array],onClear:Function,onInput:[Function,Array]}),yae=Ve({name:"DynamicInput",props:gae,setup(e,{slots:t}){const{mergedComponentPropsRef:r,mergedClsPrefixRef:i,mergedRtlRef:n,inlineThemeDisabled:a}=mr(),o=_t(jb,null),s=ge(e.defaultValue),l=pt(e,"value"),c=Un(l,s),d=bt("DynamicInput","-dynamic-input",vae,fae,e,i),u=re(()=>{const{value:A}=c;if(Array.isArray(A)){const{max:M}=e;return M!==void 0&&A.length>=M}return!1}),h=re(()=>{const{value:A}=c;return Array.isArray(A)?A.length<=e.min:!0}),f=re(()=>{var A,M;return(M=(A=r==null?void 0:r.value)===null||A===void 0?void 0:A.DynamicInput)===null||M===void 0?void 0:M.buttonSize});function p(A){const{onInput:M,"onUpdate:value":P,onUpdateValue:T}=e;M&&ct(M,A),P&&ct(P,A),T&&ct(T,A),s.value=A}function v(A,M){if(A==null||typeof A!="object")return M;const P=lv(A)?wr(A):A;let T=D0.get(P);return T===void 0&&D0.set(P,T=qu()),T}function m(A,M){const{value:P}=c,T=Array.from(P??[]),R=T[A];if(T[A]=M,R&&M&&typeof R=="object"&&typeof M=="object"){const z=lv(R)?wr(R):R,F=lv(M)?wr(M):M,H=D0.get(z);H!==void 0&&D0.set(F,H)}p(T)}function g(){y(-1)}function y(A){const{value:M}=c,{onCreate:P}=e,T=Array.from(M??[]);if(P)T.splice(A+1,0,P(A+1)),p(T);else if(t.default)T.splice(A+1,0,null),p(T);else switch(e.preset){case"input":T.splice(A+1,0,""),p(T);break;case"pair":T.splice(A+1,0,{key:"",value:""}),p(T);break}}function b(A){const{value:M}=c;if(!Array.isArray(M))return;const{min:P}=e;if(M.length<=P)return;const{onRemove:T}=e;T&&T(A);const R=Array.from(M);R.splice(A,1),p(R)}function x(A,M,P){if(M<0||P<0||M>=A.length||P>=A.length||M===P)return;const T=A[M];A[M]=A[P],A[P]=T}function S(A,M){const{value:P}=c;if(!Array.isArray(P))return;const T=Array.from(P);A==="up"&&x(T,M,M-1),A==="down"&&x(T,M,M+1),p(T)}br(zT,{mergedThemeRef:d,keyPlaceholderRef:pt(e,"keyPlaceholder"),valuePlaceholderRef:pt(e,"valuePlaceholder"),placeholderRef:pt(e,"placeholder")});const w=Ja("DynamicInput",n,i),_=re(()=>{const{self:{actionMargin:A,actionMarginRtl:M}}=d.value;return{"--action-margin":A,"--action-margin-rtl":M}}),C=a?Dr("dynamic-input",void 0,_,e):void 0;return{locale:dc("DynamicInput").localeRef,rtlEnabled:w,buttonSize:f,mergedClsPrefix:i,NFormItem:o,uncontrolledValue:s,mergedValue:c,insertionDisabled:u,removeDisabled:h,handleCreateClick:g,ensureKey:v,handleValueChange:m,remove:b,move:S,createItem:y,mergedTheme:d,cssVars:a?void 0:_,themeClass:C==null?void 0:C.themeClass,onRender:C==null?void 0:C.onRender}},render(){const{$slots:e,itemClass:t,buttonSize:r,mergedClsPrefix:i,mergedValue:n,locale:a,mergedTheme:o,keyField:s,itemStyle:l,preset:c,showSortButton:d,NFormItem:u,ensureKey:h,handleValueChange:f,remove:p,createItem:v,move:m,onRender:g,disabled:y}=this;return g==null||g(),E("div",{class:[`${i}-dynamic-input`,this.rtlEnabled&&`${i}-dynamic-input--rtl`,this.themeClass],style:this.cssVars},!Array.isArray(n)||n.length===0?E(li,Object.assign({block:!0,ghost:!0,dashed:!0,size:r},this.createButtonProps,{disabled:this.insertionDisabled||y,theme:o.peers.Button,themeOverrides:o.peerOverrides.Button,onClick:this.handleCreateClick}),{default:()=>Sr(e["create-button-default"],()=>[a.create]),icon:()=>Sr(e["create-button-icon"],()=>[E(Li,{clsPrefix:i},{default:()=>E(h2,null)})])}):n.map((b,x)=>E("div",{key:s?b[s]:h(b,x),"data-key":s?b[s]:h(b,x),class:[`${i}-dynamic-input-item`,t],style:l},$_(e.default,{value:n[x],index:x},()=>[c==="input"?E(pae,{disabled:y,clsPrefix:i,value:n[x],parentPath:u?u.path.value:void 0,path:u!=null&&u.path.value?`${u.path.value}[${x}]`:void 0,onUpdateValue:S=>{f(x,S)}}):c==="pair"?E(mae,{disabled:y,clsPrefix:i,value:n[x],parentPath:u?u.path.value:void 0,path:u!=null&&u.path.value?`${u.path.value}[${x}]`:void 0,onUpdateValue:S=>{f(x,S)}}):null]),$_(e.action,{value:n[x],index:x,create:v,remove:p,move:m},()=>[E("div",{class:`${i}-dynamic-input-item__action`},E(jre,{size:r},{default:()=>[E(li,{disabled:this.removeDisabled||y,theme:o.peers.Button,themeOverrides:o.peerOverrides.Button,circle:!0,onClick:()=>{p(x)}},{icon:()=>E(Li,{clsPrefix:i},{default:()=>E(Iee,null)})}),E(li,{disabled:this.insertionDisabled||y,circle:!0,theme:o.peers.Button,themeOverrides:o.peerOverrides.Button,onClick:()=>{v(x)}},{icon:()=>E(Li,{clsPrefix:i},{default:()=>E(h2,null)})}),d?E(li,{disabled:x===0||y,circle:!0,theme:o.peers.Button,themeOverrides:o.peerOverrides.Button,onClick:()=>{m("up",x)}},{icon:()=>E(Li,{clsPrefix:i},{default:()=>E(Aee,null)})}):null,d?E(li,{disabled:x===n.length-1||y,circle:!0,theme:o.peers.Button,themeOverrides:o.peerOverrides.Button,onClick:()=>{m("down",x)}},{icon:()=>E(Li,{clsPrefix:i},{default:()=>E(_ee,null)})}):null]}))]))))}}),bae={gapSmall:"4px 8px",gapMedium:"8px 12px",gapLarge:"12px 16px"},xae=()=>bae,wae={name:"Space",self:xae};let fS;const Sae=()=>{if(!Id)return!0;if(fS===void 0){const e=document.createElement("div");e.style.display="flex",e.style.flexDirection="column",e.style.rowGap="1px",e.appendChild(document.createElement("div")),e.appendChild(document.createElement("div")),document.body.appendChild(e);const t=e.scrollHeight===1;return document.body.removeChild(e),fS=t}return fS},Cae=Object.assign(Object.assign({},bt.props),{align:String,justify:{type:String,default:"start"},inline:Boolean,vertical:Boolean,reverse:Boolean,size:{type:[String,Number,Array],default:"medium"},wrapItem:{type:Boolean,default:!0},itemClass:String,itemStyle:[String,Object],wrap:{type:Boolean,default:!0},internalUseGap:{type:Boolean,default:void 0}}),_ae=Ve({name:"Space",props:Cae,setup(e){const{mergedClsPrefixRef:t,mergedRtlRef:r}=mr(e),i=bt("Space","-space",void 0,wae,e,t),n=Ja("Space",r,t);return{useGap:Sae(),rtlEnabled:n,mergedClsPrefix:t,margin:re(()=>{const{size:a}=e;if(Array.isArray(a))return{horizontal:a[0],vertical:a[1]};if(typeof a=="number")return{horizontal:a,vertical:a};const{self:{[Ze("gap",a)]:o}}=i.value,{row:s,col:l}=S5(o);return{horizontal:rn(l),vertical:rn(s)}})}},render(){const{vertical:e,reverse:t,align:r,inline:i,justify:n,itemClass:a,itemStyle:o,margin:s,wrap:l,mergedClsPrefix:c,rtlEnabled:d,useGap:u,wrapItem:h,internalUseGap:f}=this,p=ud(C5(this),!1);if(!p.length)return null;const v=`${s.horizontal}px`,m=`${s.horizontal/2}px`,g=`${s.vertical}px`,y=`${s.vertical/2}px`,b=p.length-1,x=n.startsWith("space-");return E("div",{role:"none",class:[`${c}-space`,d&&`${c}-space--rtl`],style:{display:i?"inline-flex":"flex",flexDirection:e&&!t?"column":e&&t?"column-reverse":!e&&t?"row-reverse":"row",justifyContent:["start","end"].includes(n)?"flex-"+n:n,flexWrap:!l||e?"nowrap":"wrap",marginTop:u||e?"":`-${y}`,marginBottom:u||e?"":`-${y}`,alignItems:r,gap:u?`${s.vertical}px ${s.horizontal}px`:""}},!h&&(u||f)?p:p.map((S,w)=>S.type===On?S:E("div",{role:"none",class:a,style:[o,{maxWidth:"100%"},u?"":e?{marginBottom:w!==b?g:""}:d?{marginLeft:x?n==="space-between"&&w===b?"":m:w!==b?v:"",marginRight:x?n==="space-between"&&w===0?"":m:"",paddingTop:y,paddingBottom:y}:{marginRight:x?n==="space-between"&&w===b?"":m:w!==b?v:"",marginLeft:x?n==="space-between"&&w===0?"":m:"",paddingTop:y,paddingBottom:y}]},S)))}}),Aae={gapSmall:"4px 8px",gapMedium:"8px 12px",gapLarge:"12px 16px"},Mae=()=>Aae,Eae={name:"Flex",self:Mae},Tae=Object.assign(Object.assign({},bt.props),{align:String,justify:{type:String,default:"start"},inline:Boolean,vertical:Boolean,reverse:Boolean,size:{type:[String,Number,Array],default:"medium"},wrap:{type:Boolean,default:!0}}),Lu=Ve({name:"Flex",props:Tae,setup(e){const{mergedClsPrefixRef:t,mergedRtlRef:r}=mr(e),i=bt("Flex","-flex",void 0,Eae,e,t);return{rtlEnabled:Ja("Flex",r,t),mergedClsPrefix:t,margin:re(()=>{const{size:a}=e;if(Array.isArray(a))return{horizontal:a[0],vertical:a[1]};if(typeof a=="number")return{horizontal:a,vertical:a};const{self:{[Ze("gap",a)]:o}}=i.value,{row:s,col:l}=S5(o);return{horizontal:rn(l),vertical:rn(s)}})}},render(){const{vertical:e,reverse:t,align:r,inline:i,justify:n,margin:a,wrap:o,mergedClsPrefix:s,rtlEnabled:l}=this,c=ud(C5(this),!1);return c.length?E("div",{role:"none",class:[`${s}-flex`,l&&`${s}-flex--rtl`],style:{display:i?"inline-flex":"flex",flexDirection:e&&!t?"column":e&&t?"column-reverse":!e&&t?"row-reverse":"row",justifyContent:n,flexWrap:!o||e?"nowrap":"wrap",alignItems:r,gap:`${a.vertical}px ${a.horizontal}px`}},c):null}}),Pae={feedbackPadding:"4px 0 0 2px",feedbackHeightSmall:"24px",feedbackHeightMedium:"24px",feedbackHeightLarge:"26px",feedbackFontSizeSmall:"13px",feedbackFontSizeMedium:"14px",feedbackFontSizeLarge:"14px",labelFontSizeLeftSmall:"14px",labelFontSizeLeftMedium:"14px",labelFontSizeLeftLarge:"15px",labelFontSizeTopSmall:"13px",labelFontSizeTopMedium:"14px",labelFontSizeTopLarge:"14px",labelHeightSmall:"24px",labelHeightMedium:"26px",labelHeightLarge:"28px",labelPaddingVertical:"0 0 6px 2px",labelPaddingHorizontal:"0 12px 0 0",labelTextAlignVertical:"left",labelTextAlignHorizontal:"right",labelFontWeight:"400"},Dae=e=>{const{heightSmall:t,heightMedium:r,heightLarge:i,textColor1:n,errorColor:a,warningColor:o,lineHeight:s,textColor3:l}=e;return Object.assign(Object.assign({},Pae),{blankHeightSmall:t,blankHeightMedium:r,blankHeightLarge:i,lineHeight:s,labelTextColor:n,asteriskColor:a,feedbackTextColorError:a,feedbackTextColorWarning:o,feedbackTextColor:l})},BU={name:"Form",common:Gr,self:Dae},Oae=oe("form",[xe("inline",`
 width: 100%;
 display: inline-flex;
 align-items: flex-start;
 align-content: space-around;
 `,[oe("form-item",{width:"auto",marginRight:"18px"},[ve("&:last-child",{marginRight:0})])])]),Bg="n-form",FU="n-form-item-insts";var Rae=function(e,t,r,i){function n(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function s(d){try{c(i.next(d))}catch(u){o(u)}}function l(d){try{c(i.throw(d))}catch(u){o(u)}}function c(d){d.done?a(d.value):n(d.value).then(s,l)}c((i=i.apply(e,t||[])).next())})};const Iae=Object.assign(Object.assign({},bt.props),{inline:Boolean,labelWidth:[Number,String],labelAlign:String,labelPlacement:{type:String,default:"top"},model:{type:Object,default:()=>{}},rules:Object,disabled:Boolean,size:String,showRequireMark:{type:Boolean,default:void 0},requireMarkPlacement:String,showFeedback:{type:Boolean,default:!0},onSubmit:{type:Function,default:e=>{e.preventDefault()}},showLabel:{type:Boolean,default:void 0},validateMessages:Object}),zae=Ve({name:"Form",props:Iae,setup(e){const{mergedClsPrefixRef:t}=mr(e);bt("Form","-form",Oae,BU,e,t);const r={},i=ge(void 0),n=l=>{const c=i.value;(c===void 0||l>=c)&&(i.value=l)};function a(l){return Rae(this,arguments,void 0,function*(c,d=()=>!0){return yield new Promise((u,h)=>{const f=[];for(const p of Hv(r)){const v=r[p];for(const m of v)m.path&&f.push(m.internalValidate(null,d))}Promise.all(f).then(p=>{const v=p.some(y=>!y.valid),m=[],g=[];p.forEach(y=>{var b,x;!((b=y.errors)===null||b===void 0)&&b.length&&m.push(y.errors),!((x=y.warnings)===null||x===void 0)&&x.length&&g.push(y.warnings)}),c&&c(m.length?m:void 0,{warnings:g.length?g:void 0}),v?h(m.length?m:void 0):u({warnings:g.length?g:void 0})})})})}function o(){for(const l of Hv(r)){const c=r[l];for(const d of c)d.restoreValidation()}}return br(Bg,{props:e,maxChildLabelWidthRef:i,deriveMaxChildLabelWidth:n}),br(FU,{formItems:r}),Object.assign({validate:a,restoreValidation:o},{mergedClsPrefix:t})},render(){const{mergedClsPrefix:e}=this;return E("form",{class:[`${e}-form`,this.inline&&`${e}-form--inline`],onSubmit:this.onSubmit},this.$slots)}});function wu(){return wu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},wu.apply(this,arguments)}function kae(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Zv(e,t)}function iA(e){return iA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},iA(e)}function Zv(e,t){return Zv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,n){return i.__proto__=n,i},Zv(e,t)}function Lae(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function db(e,t,r){return Lae()?db=Reflect.construct.bind():db=function(n,a,o){var s=[null];s.push.apply(s,a);var l=Function.bind.apply(n,s),c=new l;return o&&Zv(c,o.prototype),c},db.apply(null,arguments)}function Bae(e){return Function.toString.call(e).indexOf("[native code]")!==-1}function nA(e){var t=typeof Map=="function"?new Map:void 0;return nA=function(i){if(i===null||!Bae(i))return i;if(typeof i!="function")throw new TypeError("Super expression must either be null or a function");if(typeof t<"u"){if(t.has(i))return t.get(i);t.set(i,n)}function n(){return db(i,arguments,iA(this).constructor)}return n.prototype=Object.create(i.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),Zv(n,i)},nA(e)}var Fae=/%[sdj%]/g,Nae=function(){};function aA(e){if(!e||!e.length)return null;var t={};return e.forEach(function(r){var i=r.field;t[i]=t[i]||[],t[i].push(r)}),t}function so(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];var n=0,a=r.length;if(typeof e=="function")return e.apply(null,r);if(typeof e=="string"){var o=e.replace(Fae,function(s){if(s==="%%")return"%";if(n>=a)return s;switch(s){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch{return"[Circular]"}break;default:return s}});return o}return e}function Uae(e){return e==="string"||e==="url"||e==="hex"||e==="email"||e==="date"||e==="pattern"}function xn(e,t){return!!(e==null||t==="array"&&Array.isArray(e)&&!e.length||Uae(t)&&typeof e=="string"&&!e)}function jae(e,t,r){var i=[],n=0,a=e.length;function o(s){i.push.apply(i,s||[]),n++,n===a&&r(i)}e.forEach(function(s){t(s,o)})}function GO(e,t,r){var i=0,n=e.length;function a(o){if(o&&o.length){r(o);return}var s=i;i=i+1,s<n?t(e[s],a):r([])}a([])}function Vae(e){var t=[];return Object.keys(e).forEach(function(r){t.push.apply(t,e[r]||[])}),t}var $O=function(e){kae(t,e);function t(r,i){var n;return n=e.call(this,"Async Validation Error")||this,n.errors=r,n.fields=i,n}return t}(nA(Error));function Hae(e,t,r,i,n){if(t.first){var a=new Promise(function(h,f){var p=function(g){return i(g),g.length?f(new $O(g,aA(g))):h(n)},v=Vae(e);GO(v,r,p)});return a.catch(function(h){return h}),a}var o=t.firstFields===!0?Object.keys(e):t.firstFields||[],s=Object.keys(e),l=s.length,c=0,d=[],u=new Promise(function(h,f){var p=function(m){if(d.push.apply(d,m),c++,c===l)return i(d),d.length?f(new $O(d,aA(d))):h(n)};s.length||(i(d),h(n)),s.forEach(function(v){var m=e[v];o.indexOf(v)!==-1?GO(m,r,p):jae(m,r,p)})});return u.catch(function(h){return h}),u}function Wae(e){return!!(e&&e.message!==void 0)}function Gae(e,t){for(var r=e,i=0;i<t.length;i++){if(r==null)return r;r=r[t[i]]}return r}function qO(e,t){return function(r){var i;return e.fullFields?i=Gae(t,e.fullFields):i=t[r.field||e.fullField],Wae(r)?(r.field=r.field||e.fullField,r.fieldValue=i,r):{message:typeof r=="function"?r():r,fieldValue:i,field:r.field||e.fullField}}}function YO(e,t){if(t){for(var r in t)if(t.hasOwnProperty(r)){var i=t[r];typeof i=="object"&&typeof e[r]=="object"?e[r]=wu({},e[r],i):e[r]=i}}return e}var NU=function(t,r,i,n,a,o){t.required&&(!i.hasOwnProperty(t.field)||xn(r,o||t.type))&&n.push(so(a.messages.required,t.fullField))},$ae=function(t,r,i,n,a){(/^\s+$/.test(r)||r==="")&&n.push(so(a.messages.whitespace,t.fullField))},O0,qae=function(){if(O0)return O0;var e="[a-fA-F\\d:]",t=function(x){return x&&x.includeBoundaries?"(?:(?<=\\s|^)(?="+e+")|(?<="+e+")(?=\\s|$))":""},r="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",i="[a-fA-F\\d]{1,4}",n=(`
(?:
(?:`+i+":){7}(?:"+i+`|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:`+i+":){6}(?:"+r+"|:"+i+`|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:`+i+":){5}(?::"+r+"|(?::"+i+`){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:`+i+":){4}(?:(?::"+i+"){0,1}:"+r+"|(?::"+i+`){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:`+i+":){3}(?:(?::"+i+"){0,2}:"+r+"|(?::"+i+`){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:`+i+":){2}(?:(?::"+i+"){0,3}:"+r+"|(?::"+i+`){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:`+i+":){1}(?:(?::"+i+"){0,4}:"+r+"|(?::"+i+`){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::`+i+"){0,5}:"+r+"|(?::"+i+`){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`).replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),a=new RegExp("(?:^"+r+"$)|(?:^"+n+"$)"),o=new RegExp("^"+r+"$"),s=new RegExp("^"+n+"$"),l=function(x){return x&&x.exact?a:new RegExp("(?:"+t(x)+r+t(x)+")|(?:"+t(x)+n+t(x)+")","g")};l.v4=function(b){return b&&b.exact?o:new RegExp(""+t(b)+r+t(b),"g")},l.v6=function(b){return b&&b.exact?s:new RegExp(""+t(b)+n+t(b),"g")};var c="(?:(?:[a-z]+:)?//)",d="(?:\\S+(?::\\S*)?@)?",u=l.v4().source,h=l.v6().source,f="(?:(?:[a-z\\u00a1-\\uffff0-9][-_]*)*[a-z\\u00a1-\\uffff0-9]+)",p="(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*",v="(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))",m="(?::\\d{2,5})?",g='(?:[/?#][^\\s"]*)?',y="(?:"+c+"|www\\.)"+d+"(?:localhost|"+u+"|"+h+"|"+f+p+v+")"+m+g;return O0=new RegExp("(?:^"+y+"$)","i"),O0},XO={email:/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+\.)+[a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]{2,}))$/,hex:/^#?([a-f0-9]{6}|[a-f0-9]{3})$/i},Km={integer:function(t){return Km.number(t)&&parseInt(t,10)===t},float:function(t){return Km.number(t)&&!Km.integer(t)},array:function(t){return Array.isArray(t)},regexp:function(t){if(t instanceof RegExp)return!0;try{return!!new RegExp(t)}catch{return!1}},date:function(t){return typeof t.getTime=="function"&&typeof t.getMonth=="function"&&typeof t.getYear=="function"&&!isNaN(t.getTime())},number:function(t){return isNaN(t)?!1:typeof t=="number"},object:function(t){return typeof t=="object"&&!Km.array(t)},method:function(t){return typeof t=="function"},email:function(t){return typeof t=="string"&&t.length<=320&&!!t.match(XO.email)},url:function(t){return typeof t=="string"&&t.length<=2048&&!!t.match(qae())},hex:function(t){return typeof t=="string"&&!!t.match(XO.hex)}},Yae=function(t,r,i,n,a){if(t.required&&r===void 0){NU(t,r,i,n,a);return}var o=["integer","float","array","regexp","object","method","email","number","date","url","hex"],s=t.type;o.indexOf(s)>-1?Km[s](r)||n.push(so(a.messages.types[s],t.fullField,t.type)):s&&typeof r!==t.type&&n.push(so(a.messages.types[s],t.fullField,t.type))},Xae=function(t,r,i,n,a){var o=typeof t.len=="number",s=typeof t.min=="number",l=typeof t.max=="number",c=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,d=r,u=null,h=typeof r=="number",f=typeof r=="string",p=Array.isArray(r);if(h?u="number":f?u="string":p&&(u="array"),!u)return!1;p&&(d=r.length),f&&(d=r.replace(c,"_").length),o?d!==t.len&&n.push(so(a.messages[u].len,t.fullField,t.len)):s&&!l&&d<t.min?n.push(so(a.messages[u].min,t.fullField,t.min)):l&&!s&&d>t.max?n.push(so(a.messages[u].max,t.fullField,t.max)):s&&l&&(d<t.min||d>t.max)&&n.push(so(a.messages[u].range,t.fullField,t.min,t.max))},kh="enum",Kae=function(t,r,i,n,a){t[kh]=Array.isArray(t[kh])?t[kh]:[],t[kh].indexOf(r)===-1&&n.push(so(a.messages[kh],t.fullField,t[kh].join(", ")))},Qae=function(t,r,i,n,a){if(t.pattern){if(t.pattern instanceof RegExp)t.pattern.lastIndex=0,t.pattern.test(r)||n.push(so(a.messages.pattern.mismatch,t.fullField,r,t.pattern));else if(typeof t.pattern=="string"){var o=new RegExp(t.pattern);o.test(r)||n.push(so(a.messages.pattern.mismatch,t.fullField,r,t.pattern))}}},_r={required:NU,whitespace:$ae,type:Yae,range:Xae,enum:Kae,pattern:Qae},Zae=function(t,r,i,n,a){var o=[],s=t.required||!t.required&&n.hasOwnProperty(t.field);if(s){if(xn(r,"string")&&!t.required)return i();_r.required(t,r,n,o,a,"string"),xn(r,"string")||(_r.type(t,r,n,o,a),_r.range(t,r,n,o,a),_r.pattern(t,r,n,o,a),t.whitespace===!0&&_r.whitespace(t,r,n,o,a))}i(o)},Jae=function(t,r,i,n,a){var o=[],s=t.required||!t.required&&n.hasOwnProperty(t.field);if(s){if(xn(r)&&!t.required)return i();_r.required(t,r,n,o,a),r!==void 0&&_r.type(t,r,n,o,a)}i(o)},eoe=function(t,r,i,n,a){var o=[],s=t.required||!t.required&&n.hasOwnProperty(t.field);if(s){if(r===""&&(r=void 0),xn(r)&&!t.required)return i();_r.required(t,r,n,o,a),r!==void 0&&(_r.type(t,r,n,o,a),_r.range(t,r,n,o,a))}i(o)},toe=function(t,r,i,n,a){var o=[],s=t.required||!t.required&&n.hasOwnProperty(t.field);if(s){if(xn(r)&&!t.required)return i();_r.required(t,r,n,o,a),r!==void 0&&_r.type(t,r,n,o,a)}i(o)},roe=function(t,r,i,n,a){var o=[],s=t.required||!t.required&&n.hasOwnProperty(t.field);if(s){if(xn(r)&&!t.required)return i();_r.required(t,r,n,o,a),xn(r)||_r.type(t,r,n,o,a)}i(o)},ioe=function(t,r,i,n,a){var o=[],s=t.required||!t.required&&n.hasOwnProperty(t.field);if(s){if(xn(r)&&!t.required)return i();_r.required(t,r,n,o,a),r!==void 0&&(_r.type(t,r,n,o,a),_r.range(t,r,n,o,a))}i(o)},noe=function(t,r,i,n,a){var o=[],s=t.required||!t.required&&n.hasOwnProperty(t.field);if(s){if(xn(r)&&!t.required)return i();_r.required(t,r,n,o,a),r!==void 0&&(_r.type(t,r,n,o,a),_r.range(t,r,n,o,a))}i(o)},aoe=function(t,r,i,n,a){var o=[],s=t.required||!t.required&&n.hasOwnProperty(t.field);if(s){if(r==null&&!t.required)return i();_r.required(t,r,n,o,a,"array"),r!=null&&(_r.type(t,r,n,o,a),_r.range(t,r,n,o,a))}i(o)},ooe=function(t,r,i,n,a){var o=[],s=t.required||!t.required&&n.hasOwnProperty(t.field);if(s){if(xn(r)&&!t.required)return i();_r.required(t,r,n,o,a),r!==void 0&&_r.type(t,r,n,o,a)}i(o)},soe="enum",loe=function(t,r,i,n,a){var o=[],s=t.required||!t.required&&n.hasOwnProperty(t.field);if(s){if(xn(r)&&!t.required)return i();_r.required(t,r,n,o,a),r!==void 0&&_r[soe](t,r,n,o,a)}i(o)},coe=function(t,r,i,n,a){var o=[],s=t.required||!t.required&&n.hasOwnProperty(t.field);if(s){if(xn(r,"string")&&!t.required)return i();_r.required(t,r,n,o,a),xn(r,"string")||_r.pattern(t,r,n,o,a)}i(o)},doe=function(t,r,i,n,a){var o=[],s=t.required||!t.required&&n.hasOwnProperty(t.field);if(s){if(xn(r,"date")&&!t.required)return i();if(_r.required(t,r,n,o,a),!xn(r,"date")){var l;r instanceof Date?l=r:l=new Date(r),_r.type(t,l,n,o,a),l&&_r.range(t,l.getTime(),n,o,a)}}i(o)},uoe=function(t,r,i,n,a){var o=[],s=Array.isArray(r)?"array":typeof r;_r.required(t,r,n,o,a,s),i(o)},pS=function(t,r,i,n,a){var o=t.type,s=[],l=t.required||!t.required&&n.hasOwnProperty(t.field);if(l){if(xn(r,o)&&!t.required)return i();_r.required(t,r,n,s,a,o),xn(r,o)||_r.type(t,r,n,s,a)}i(s)},hoe=function(t,r,i,n,a){var o=[],s=t.required||!t.required&&n.hasOwnProperty(t.field);if(s){if(xn(r)&&!t.required)return i();_r.required(t,r,n,o,a)}i(o)},yv={string:Zae,method:Jae,number:eoe,boolean:toe,regexp:roe,integer:ioe,float:noe,array:aoe,object:ooe,enum:loe,pattern:coe,date:doe,url:pS,hex:pS,email:pS,required:uoe,any:hoe};function oA(){return{default:"Validation error on field %s",required:"%s is required",enum:"%s must be one of %s",whitespace:"%s cannot be empty",date:{format:"%s date %s is invalid for format %s",parse:"%s date could not be parsed, %s is invalid ",invalid:"%s date %s is invalid"},types:{string:"%s is not a %s",method:"%s is not a %s (function)",array:"%s is not an %s",object:"%s is not an %s",number:"%s is not a %s",date:"%s is not a %s",boolean:"%s is not a %s",integer:"%s is not an %s",float:"%s is not a %s",regexp:"%s is not a valid %s",email:"%s is not a valid %s",url:"%s is not a valid %s",hex:"%s is not a valid %s"},string:{len:"%s must be exactly %s characters",min:"%s must be at least %s characters",max:"%s cannot be longer than %s characters",range:"%s must be between %s and %s characters"},number:{len:"%s must equal %s",min:"%s cannot be less than %s",max:"%s cannot be greater than %s",range:"%s must be between %s and %s"},array:{len:"%s must be exactly %s in length",min:"%s cannot be less than %s in length",max:"%s cannot be greater than %s in length",range:"%s must be between %s and %s in length"},pattern:{mismatch:"%s value %s does not match pattern %s"},clone:function(){var t=JSON.parse(JSON.stringify(this));return t.clone=this.clone,t}}}var sA=oA(),hp=function(){function e(r){this.rules=null,this._messages=sA,this.define(r)}var t=e.prototype;return t.define=function(i){var n=this;if(!i)throw new Error("Cannot configure a schema with no rules");if(typeof i!="object"||Array.isArray(i))throw new Error("Rules must be an object");this.rules={},Object.keys(i).forEach(function(a){var o=i[a];n.rules[a]=Array.isArray(o)?o:[o]})},t.messages=function(i){return i&&(this._messages=YO(oA(),i)),this._messages},t.validate=function(i,n,a){var o=this;n===void 0&&(n={}),a===void 0&&(a=function(){});var s=i,l=n,c=a;if(typeof l=="function"&&(c=l,l={}),!this.rules||Object.keys(this.rules).length===0)return c&&c(null,s),Promise.resolve(s);function d(v){var m=[],g={};function y(x){if(Array.isArray(x)){var S;m=(S=m).concat.apply(S,x)}else m.push(x)}for(var b=0;b<v.length;b++)y(v[b]);m.length?(g=aA(m),c(m,g)):c(null,s)}if(l.messages){var u=this.messages();u===sA&&(u=oA()),YO(u,l.messages),l.messages=u}else l.messages=this.messages();var h={},f=l.keys||Object.keys(this.rules);f.forEach(function(v){var m=o.rules[v],g=s[v];m.forEach(function(y){var b=y;typeof b.transform=="function"&&(s===i&&(s=wu({},s)),g=s[v]=b.transform(g)),typeof b=="function"?b={validator:b}:b=wu({},b),b.validator=o.getValidationMethod(b),b.validator&&(b.field=v,b.fullField=b.fullField||v,b.type=o.getType(b),h[v]=h[v]||[],h[v].push({rule:b,value:g,source:s,field:v}))})});var p={};return Hae(h,l,function(v,m){var g=v.rule,y=(g.type==="object"||g.type==="array")&&(typeof g.fields=="object"||typeof g.defaultField=="object");y=y&&(g.required||!g.required&&v.value),g.field=v.field;function b(w,_){return wu({},_,{fullField:g.fullField+"."+w,fullFields:g.fullFields?[].concat(g.fullFields,[w]):[w]})}function x(w){w===void 0&&(w=[]);var _=Array.isArray(w)?w:[w];!l.suppressWarning&&_.length&&e.warning("async-validator:",_),_.length&&g.message!==void 0&&(_=[].concat(g.message));var C=_.map(qO(g,s));if(l.first&&C.length)return p[g.field]=1,m(C);if(!y)m(C);else{if(g.required&&!v.value)return g.message!==void 0?C=[].concat(g.message).map(qO(g,s)):l.error&&(C=[l.error(g,so(l.messages.required,g.field))]),m(C);var A={};g.defaultField&&Object.keys(v.value).map(function(T){A[T]=g.defaultField}),A=wu({},A,v.rule.fields);var M={};Object.keys(A).forEach(function(T){var R=A[T],z=Array.isArray(R)?R:[R];M[T]=z.map(b.bind(null,T))});var P=new e(M);P.messages(l.messages),v.rule.options&&(v.rule.options.messages=l.messages,v.rule.options.error=l.error),P.validate(v.value,v.rule.options||l,function(T){var R=[];C&&C.length&&R.push.apply(R,C),T&&T.length&&R.push.apply(R,T),m(R.length?R:null)})}}var S;if(g.asyncValidator)S=g.asyncValidator(g,v.value,x,v.source,l);else if(g.validator){try{S=g.validator(g,v.value,x,v.source,l)}catch(w){console.error==null||console.error(w),l.suppressValidatorError||setTimeout(function(){throw w},0),x(w.message)}S===!0?x():S===!1?x(typeof g.message=="function"?g.message(g.fullField||g.field):g.message||(g.fullField||g.field)+" fails"):S instanceof Array?x(S):S instanceof Error&&x(S.message)}S&&S.then&&S.then(function(){return x()},function(w){return x(w)})},function(v){d(v)},s)},t.getType=function(i){if(i.type===void 0&&i.pattern instanceof RegExp&&(i.type="pattern"),typeof i.validator!="function"&&i.type&&!yv.hasOwnProperty(i.type))throw new Error(so("Unknown rule type %s",i.type));return i.type||"string"},t.getValidationMethod=function(i){if(typeof i.validator=="function")return i.validator;var n=Object.keys(i),a=n.indexOf("message");return a!==-1&&n.splice(a,1),n.length===1&&n[0]==="required"?yv.required:yv[this.getType(i)]||void 0},e}();hp.register=function(t,r){if(typeof r!="function")throw new Error("Cannot register a validator by type, validator is not a function");yv[t]=r};hp.warning=Nae;hp.messages=sA;hp.validators=yv;function foe(e){const t=_t(Bg,null);return{mergedSize:re(()=>e.size!==void 0?e.size:(t==null?void 0:t.props.size)!==void 0?t.props.size:"medium")}}function poe(e){const t=_t(Bg,null),r=re(()=>{const{labelPlacement:p}=e;return p!==void 0?p:t!=null&&t.props.labelPlacement?t.props.labelPlacement:"top"}),i=re(()=>r.value==="left"&&(e.labelWidth==="auto"||(t==null?void 0:t.props.labelWidth)==="auto")),n=re(()=>{if(r.value==="top")return;const{labelWidth:p}=e;if(p!==void 0&&p!=="auto")return os(p);if(i.value){const v=t==null?void 0:t.maxChildLabelWidthRef.value;return v!==void 0?os(v):void 0}if((t==null?void 0:t.props.labelWidth)!==void 0)return os(t.props.labelWidth)}),a=re(()=>{const{labelAlign:p}=e;if(p)return p;if(t!=null&&t.props.labelAlign)return t.props.labelAlign}),o=re(()=>{var p;return[(p=e.labelProps)===null||p===void 0?void 0:p.style,e.labelStyle,{width:n.value}]}),s=re(()=>{const{showRequireMark:p}=e;return p!==void 0?p:t==null?void 0:t.props.showRequireMark}),l=re(()=>{const{requireMarkPlacement:p}=e;return p!==void 0?p:(t==null?void 0:t.props.requireMarkPlacement)||"right"}),c=ge(!1),d=ge(!1),u=re(()=>{const{validationStatus:p}=e;if(p!==void 0)return p;if(c.value)return"error";if(d.value)return"warning"}),h=re(()=>{const{showFeedback:p}=e;return p!==void 0?p:(t==null?void 0:t.props.showFeedback)!==void 0?t.props.showFeedback:!0}),f=re(()=>{const{showLabel:p}=e;return p!==void 0?p:(t==null?void 0:t.props.showLabel)!==void 0?t.props.showLabel:!0});return{validationErrored:c,validationWarned:d,mergedLabelStyle:o,mergedLabelPlacement:r,mergedLabelAlign:a,mergedShowRequireMark:s,mergedRequireMarkPlacement:l,mergedValidationStatus:u,mergedShowFeedback:h,mergedShowLabel:f,isAutoLabelWidth:i}}function moe(e){const t=_t(Bg,null),r=re(()=>{const{rulePath:o}=e;if(o!==void 0)return o;const{path:s}=e;if(s!==void 0)return s}),i=re(()=>{const o=[],{rule:s}=e;if(s!==void 0&&(Array.isArray(s)?o.push(...s):o.push(s)),t){const{rules:l}=t.props,{value:c}=r;if(l!==void 0&&c!==void 0){const d=uT(l,c);d!==void 0&&(Array.isArray(d)?o.push(...d):o.push(d))}}return o}),n=re(()=>i.value.some(o=>o.required)),a=re(()=>n.value||e.required);return{mergedRules:i,mergedRequired:a}}const{cubicBezierEaseInOut:KO}=Ld;function voe({name:e="fade-down",fromOffset:t="-4px",enterDuration:r=".3s",leaveDuration:i=".3s",enterCubicBezier:n=KO,leaveCubicBezier:a=KO}={}){return[ve(`&.${e}-transition-enter-from, &.${e}-transition-leave-to`,{opacity:0,transform:`translateY(${t})`}),ve(`&.${e}-transition-enter-to, &.${e}-transition-leave-from`,{opacity:1,transform:"translateY(0)"}),ve(`&.${e}-transition-leave-active`,{transition:`opacity ${i} ${a}, transform ${i} ${a}`}),ve(`&.${e}-transition-enter-active`,{transition:`opacity ${r} ${n}, transform ${r} ${n}`})]}const goe=oe("form-item",`
 display: grid;
 line-height: var(--n-line-height);
`,[oe("form-item-label",`
 grid-area: label;
 align-items: center;
 line-height: 1.25;
 text-align: var(--n-label-text-align);
 font-size: var(--n-label-font-size);
 min-height: var(--n-label-height);
 padding: var(--n-label-padding);
 color: var(--n-label-text-color);
 transition: color .3s var(--n-bezier);
 box-sizing: border-box;
 font-weight: var(--n-label-font-weight);
 `,[he("asterisk",`
 white-space: nowrap;
 user-select: none;
 -webkit-user-select: none;
 color: var(--n-asterisk-color);
 transition: color .3s var(--n-bezier);
 `),he("asterisk-placeholder",`
 grid-area: mark;
 user-select: none;
 -webkit-user-select: none;
 visibility: hidden; 
 `)]),oe("form-item-blank",`
 grid-area: blank;
 min-height: var(--n-blank-height);
 `),xe("auto-label-width",[oe("form-item-label","white-space: nowrap;")]),xe("left-labelled",`
 grid-template-areas:
 "label blank"
 "label feedback";
 grid-template-columns: auto minmax(0, 1fr);
 grid-template-rows: auto 1fr;
 align-items: flex-start;
 `,[oe("form-item-label",`
 display: grid;
 grid-template-columns: 1fr auto;
 min-height: var(--n-blank-height);
 height: auto;
 box-sizing: border-box;
 flex-shrink: 0;
 flex-grow: 0;
 `,[xe("reverse-columns-space",`
 grid-template-columns: auto 1fr;
 `),xe("left-mark",`
 grid-template-areas:
 "mark text"
 ". text";
 `),xe("right-mark",`
 grid-template-areas: 
 "text mark"
 "text .";
 `),xe("right-hanging-mark",`
 grid-template-areas: 
 "text mark"
 "text .";
 `),he("text",`
 grid-area: text; 
 `),he("asterisk",`
 grid-area: mark; 
 align-self: end;
 `)])]),xe("top-labelled",`
 grid-template-areas:
 "label"
 "blank"
 "feedback";
 grid-template-rows: minmax(var(--n-label-height), auto) 1fr;
 grid-template-columns: minmax(0, 100%);
 `,[xe("no-label",`
 grid-template-areas:
 "blank"
 "feedback";
 grid-template-rows: 1fr;
 `),oe("form-item-label",`
 display: flex;
 align-items: flex-start;
 justify-content: var(--n-label-text-align);
 `)]),oe("form-item-blank",`
 box-sizing: border-box;
 display: flex;
 align-items: center;
 position: relative;
 `),oe("form-item-feedback-wrapper",`
 grid-area: feedback;
 box-sizing: border-box;
 min-height: var(--n-feedback-height);
 font-size: var(--n-feedback-font-size);
 line-height: 1.25;
 transform-origin: top left;
 `,[ve("&:not(:empty)",`
 padding: var(--n-feedback-padding);
 `),oe("form-item-feedback",{transition:"color .3s var(--n-bezier)",color:"var(--n-feedback-text-color)"},[xe("warning",{color:"var(--n-feedback-text-color-warning)"}),xe("error",{color:"var(--n-feedback-text-color-error)"}),voe({fromOffset:"-3px",enterDuration:".3s",leaveDuration:".2s"})])])]);var QO=function(e,t,r,i){function n(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function s(d){try{c(i.next(d))}catch(u){o(u)}}function l(d){try{c(i.throw(d))}catch(u){o(u)}}function c(d){d.done?a(d.value):n(d.value).then(s,l)}c((i=i.apply(e,t||[])).next())})};const yoe=Object.assign(Object.assign({},bt.props),{label:String,labelWidth:[Number,String],labelStyle:[String,Object],labelAlign:String,labelPlacement:String,path:String,first:Boolean,rulePath:String,required:Boolean,showRequireMark:{type:Boolean,default:void 0},requireMarkPlacement:String,showFeedback:{type:Boolean,default:void 0},rule:[Object,Array],size:String,ignorePathChange:Boolean,validationStatus:String,feedback:String,feedbackClass:String,feedbackStyle:[String,Object],showLabel:{type:Boolean,default:void 0},labelProps:Object});function ZO(e,t){return(...r)=>{try{const i=e(...r);return!t&&(typeof i=="boolean"||i instanceof Error||Array.isArray(i))||i!=null&&i.then?i:(i===void 0||Yu("form-item/validate",`You return a ${typeof i} typed value in the validator method, which is not recommended. Please use `+(t?"`Promise`":"`boolean`, `Error` or `Promise`")+" typed value instead."),!0)}catch(i){Yu("form-item/validate","An error is catched in the validation, so the validation won't be done. Your callback in `validate` method of `n-form` or `n-form-item` won't be called in this validation."),console.error(i);return}}}const vr=Ve({name:"FormItem",props:yoe,setup(e){S$(FU,"formItems",pt(e,"path"));const{mergedClsPrefixRef:t,inlineThemeDisabled:r}=mr(e),i=_t(Bg,null),n=foe(e),a=poe(e),{validationErrored:o,validationWarned:s}=a,{mergedRequired:l,mergedRules:c}=moe(e),{mergedSize:d}=n,{mergedLabelPlacement:u,mergedLabelAlign:h,mergedRequireMarkPlacement:f}=a,p=ge([]),v=ge(qu()),m=i?pt(i.props,"disabled"):ge(!1),g=bt("Form","-form-item",goe,BU,e,t);tr(pt(e,"path"),()=>{e.ignorePathChange||y()});function y(){p.value=[],o.value=!1,s.value=!1,e.feedback&&(v.value=qu())}function b(){C("blur")}function x(){C("change")}function S(){C("focus")}function w(){C("input")}function _(z,F){return QO(this,void 0,void 0,function*(){let H,N,U,ie;return typeof z=="string"?(H=z,N=F):z!==null&&typeof z=="object"&&(H=z.trigger,N=z.callback,U=z.shouldRuleBeApplied,ie=z.options),yield new Promise((te,X)=>{C(H,U,ie).then(({valid:W,errors:q,warnings:$})=>{W?(N&&N(void 0,{warnings:$}),te({warnings:$})):(N&&N(q,{warnings:$}),X(q))})})})}const C=(...z)=>QO(this,[...z],void 0,function*(F=null,H=()=>!0,N={suppressWarning:!0}){const{path:U}=e;N?N.first||(N.first=e.first):N={};const{value:ie}=c,te=i?uT(i.props.model,U||""):void 0,X={},W={},q=(F?ie.filter(Ce=>Array.isArray(Ce.trigger)?Ce.trigger.includes(F):Ce.trigger===F):ie).filter(H).map((Ce,G)=>{const Z=Object.assign({},Ce);if(Z.validator&&(Z.validator=ZO(Z.validator,!1)),Z.asyncValidator&&(Z.asyncValidator=ZO(Z.asyncValidator,!0)),Z.renderMessage){const ue=`__renderMessage__${G}`;W[ue]=Z.message,Z.message=ue,X[ue]=Z.renderMessage}return Z}),$=q.filter(Ce=>Ce.level!=="warning"),le=q.filter(Ce=>Ce.level==="warning"),ee=U??"__n_no_path__",Q=new hp({[ee]:$}),ne=new hp({[ee]:le}),{validateMessages:V}=(i==null?void 0:i.props)||{};V&&(Q.messages(V),ne.messages(V));const de=Ce=>{p.value=Ce.map(G=>{const Z=(G==null?void 0:G.message)||"";return{key:Z,render:()=>Z.startsWith("__renderMessage__")?X[Z]():Z}}),Ce.forEach(G=>{var Z;!((Z=G.message)===null||Z===void 0)&&Z.startsWith("__renderMessage__")&&(G.message=W[G.message])})},me={valid:!0,errors:void 0,warnings:void 0};if($.length){const Ce=yield new Promise(G=>{Q.validate({[ee]:te},N,G)});Ce!=null&&Ce.length&&(o.value=!0,me.valid=!1,me.errors=Ce,de(Ce))}if(le.length&&!me.errors){const Ce=yield new Promise(G=>{ne.validate({[ee]:te},N,G)});Ce!=null&&Ce.length&&(de(Ce),s.value=!0,me.warnings=Ce)}return $.length+le.length>0&&!me.errors&&!me.warnings&&y(),me});br(jb,{path:pt(e,"path"),disabled:m,mergedSize:n.mergedSize,mergedValidationStatus:a.mergedValidationStatus,restoreValidation:y,handleContentBlur:b,handleContentChange:x,handleContentFocus:S,handleContentInput:w});const A={validate:_,restoreValidation:y,internalValidate:C},M=ge(null);Or(()=>{if(!a.isAutoLabelWidth.value)return;const z=M.value;if(z!==null){const F=z.style.whiteSpace;z.style.whiteSpace="nowrap",z.style.width="",i==null||i.deriveMaxChildLabelWidth(Number(getComputedStyle(z).width.slice(0,-2))),z.style.whiteSpace=F}});const P=re(()=>{var z;const{value:F}=d,{value:H}=u,N=H==="top"?"vertical":"horizontal",{common:{cubicBezierEaseInOut:U},self:{labelTextColor:ie,asteriskColor:te,lineHeight:X,feedbackTextColor:W,feedbackTextColorWarning:q,feedbackTextColorError:$,feedbackPadding:le,labelFontWeight:ee,[Ze("labelHeight",F)]:Q,[Ze("blankHeight",F)]:ne,[Ze("feedbackFontSize",F)]:V,[Ze("feedbackHeight",F)]:de,[Ze("labelPadding",N)]:me,[Ze("labelTextAlign",N)]:Ce,[Ze(Ze("labelFontSize",H),F)]:G}}=g.value;let Z=(z=h.value)!==null&&z!==void 0?z:Ce;return H==="top"&&(Z=Z==="right"?"flex-end":"flex-start"),{"--n-bezier":U,"--n-line-height":X,"--n-blank-height":ne,"--n-label-font-size":G,"--n-label-text-align":Z,"--n-label-height":Q,"--n-label-padding":me,"--n-label-font-weight":ee,"--n-asterisk-color":te,"--n-label-text-color":ie,"--n-feedback-padding":le,"--n-feedback-font-size":V,"--n-feedback-height":de,"--n-feedback-text-color":W,"--n-feedback-text-color-warning":q,"--n-feedback-text-color-error":$}}),T=r?Dr("form-item",re(()=>{var z;return`${d.value[0]}${u.value[0]}${((z=h.value)===null||z===void 0?void 0:z[0])||""}`}),P,e):void 0,R=re(()=>u.value==="left"&&f.value==="left"&&h.value==="left");return Object.assign(Object.assign(Object.assign(Object.assign({labelElementRef:M,mergedClsPrefix:t,mergedRequired:l,feedbackId:v,renderExplains:p,reverseColSpace:R},a),n),A),{cssVars:r?void 0:P,themeClass:T==null?void 0:T.themeClass,onRender:T==null?void 0:T.onRender})},render(){const{$slots:e,mergedClsPrefix:t,mergedShowLabel:r,mergedShowRequireMark:i,mergedRequireMarkPlacement:n,onRender:a}=this,o=i!==void 0?i:this.mergedRequired;a==null||a();const s=()=>{const l=this.$slots.label?this.$slots.label():this.label;if(!l)return null;const c=E("span",{class:`${t}-form-item-label__text`},l),d=o?E("span",{class:`${t}-form-item-label__asterisk`},n!=="left"?" *":"* "):n==="right-hanging"&&E("span",{class:`${t}-form-item-label__asterisk-placeholder`}," *"),{labelProps:u}=this;return E("label",Object.assign({},u,{class:[u==null?void 0:u.class,`${t}-form-item-label`,`${t}-form-item-label--${n}-mark`,this.reverseColSpace&&`${t}-form-item-label--reverse-columns-space`],style:this.mergedLabelStyle,ref:"labelElementRef"}),n==="left"?[d,c]:[c,d])};return E("div",{class:[`${t}-form-item`,this.themeClass,`${t}-form-item--${this.mergedSize}-size`,`${t}-form-item--${this.mergedLabelPlacement}-labelled`,this.isAutoLabelWidth&&`${t}-form-item--auto-label-width`,!r&&`${t}-form-item--no-label`],style:this.cssVars},r&&s(),E("div",{class:[`${t}-form-item-blank`,this.mergedValidationStatus&&`${t}-form-item-blank--${this.mergedValidationStatus}`]},e),this.mergedShowFeedback?E("div",{key:this.feedbackId,style:this.feedbackStyle,class:[`${t}-form-item-feedback-wrapper`,this.feedbackClass]},E(Da,{name:"fade-down-transition",mode:"out-in"},{default:()=>{const{mergedValidationStatus:l}=this;return ei(e.feedback,c=>{var d;const{feedback:u}=this,h=c||u?E("div",{key:"__feedback__",class:`${t}-form-item-feedback__line`},c||u):this.renderExplains.length?(d=this.renderExplains)===null||d===void 0?void 0:d.map(({key:f,render:p})=>E("div",{key:f,class:`${t}-form-item-feedback__line`},p())):null;return h?l==="warning"?E("div",{key:"controlled-warning",class:`${t}-form-item-feedback ${t}-form-item-feedback--warning`},h):l==="error"?E("div",{key:"controlled-error",class:`${t}-form-item-feedback ${t}-form-item-feedback--error`},h):l==="success"?E("div",{key:"controlled-success",class:`${t}-form-item-feedback ${t}-form-item-feedback--success`},h):E("div",{key:"controlled-default",class:`${t}-form-item-feedback`},h):null})}})):null)}}),boe={margin:"0 0 8px 0",padding:"10px 20px",maxWidth:"720px",minWidth:"420px",iconMargin:"0 10px 0 0",closeMargin:"0 0 0 10px",closeSize:"20px",closeIconSize:"16px",iconSize:"20px",fontSize:"14px"},xoe=e=>{const{textColor2:t,closeIconColor:r,closeIconColorHover:i,closeIconColorPressed:n,infoColor:a,successColor:o,errorColor:s,warningColor:l,popoverColor:c,boxShadow2:d,primaryColor:u,lineHeight:h,borderRadius:f,closeColorHover:p,closeColorPressed:v}=e;return Object.assign(Object.assign({},boe),{closeBorderRadius:f,textColor:t,textColorInfo:t,textColorSuccess:t,textColorError:t,textColorWarning:t,textColorLoading:t,color:c,colorInfo:c,colorSuccess:c,colorError:c,colorWarning:c,colorLoading:c,boxShadow:d,boxShadowInfo:d,boxShadowSuccess:d,boxShadowError:d,boxShadowWarning:d,boxShadowLoading:d,iconColor:t,iconColorInfo:a,iconColorSuccess:o,iconColorWarning:l,iconColorError:s,iconColorLoading:u,closeColorHover:p,closeColorPressed:v,closeIconColor:r,closeIconColorHover:i,closeIconColorPressed:n,closeColorHoverInfo:p,closeColorPressedInfo:v,closeIconColorInfo:r,closeIconColorHoverInfo:i,closeIconColorPressedInfo:n,closeColorHoverSuccess:p,closeColorPressedSuccess:v,closeIconColorSuccess:r,closeIconColorHoverSuccess:i,closeIconColorPressedSuccess:n,closeColorHoverError:p,closeColorPressedError:v,closeIconColorError:r,closeIconColorHoverError:i,closeIconColorPressedError:n,closeColorHoverWarning:p,closeColorPressedWarning:v,closeIconColorWarning:r,closeIconColorHoverWarning:i,closeIconColorPressedWarning:n,closeColorHoverLoading:p,closeColorPressedLoading:v,closeIconColorLoading:r,closeIconColorHoverLoading:i,closeIconColorPressedLoading:n,loadingColor:u,lineHeight:h,borderRadius:f})},woe={name:"Message",common:Gr,self:xoe},Soe=e=>{const{primaryColor:t,successColor:r,warningColor:i,errorColor:n,infoColor:a,fontWeightStrong:o}=e;return{fontWeight:o,rotate:"252deg",colorStartPrimary:Yt(t,{alpha:.6}),colorEndPrimary:t,colorStartInfo:Yt(a,{alpha:.6}),colorEndInfo:a,colorStartWarning:Yt(i,{alpha:.6}),colorEndWarning:i,colorStartError:Yt(n,{alpha:.6}),colorEndError:n,colorStartSuccess:Yt(r,{alpha:.6}),colorEndSuccess:r}},Coe={name:"GradientText",common:Gr,self:Soe},_oe=e=>{const{baseColor:t,textColor2:r,bodyColor:i,cardColor:n,dividerColor:a,actionColor:o,scrollbarColor:s,scrollbarColorHover:l,invertedColor:c}=e;return{textColor:r,textColorInverted:"#FFF",color:i,colorEmbedded:o,headerColor:n,headerColorInverted:c,footerColor:o,footerColorInverted:c,headerBorderColor:a,headerBorderColorInverted:c,footerBorderColor:a,footerBorderColorInverted:c,siderBorderColor:a,siderBorderColorInverted:c,siderColor:n,siderColorInverted:c,siderToggleButtonBorder:`1px solid ${a}`,siderToggleButtonColor:t,siderToggleButtonIconColor:r,siderToggleButtonIconColorInverted:r,siderToggleBarColor:Xs(i,s),siderToggleBarColorHover:Xs(i,l),__invertScrollbar:"true"}},B1={name:"Layout",common:Gr,peers:{Scrollbar:kp},self:_oe};function Aoe(e,t,r,i){return{itemColorHoverInverted:"#0000",itemColorActiveInverted:t,itemColorActiveHoverInverted:t,itemColorActiveCollapsedInverted:t,itemTextColorInverted:e,itemTextColorHoverInverted:r,itemTextColorChildActiveInverted:r,itemTextColorChildActiveHoverInverted:r,itemTextColorActiveInverted:r,itemTextColorActiveHoverInverted:r,itemTextColorHorizontalInverted:e,itemTextColorHoverHorizontalInverted:r,itemTextColorChildActiveHorizontalInverted:r,itemTextColorChildActiveHoverHorizontalInverted:r,itemTextColorActiveHorizontalInverted:r,itemTextColorActiveHoverHorizontalInverted:r,itemIconColorInverted:e,itemIconColorHoverInverted:r,itemIconColorActiveInverted:r,itemIconColorActiveHoverInverted:r,itemIconColorChildActiveInverted:r,itemIconColorChildActiveHoverInverted:r,itemIconColorCollapsedInverted:e,itemIconColorHorizontalInverted:e,itemIconColorHoverHorizontalInverted:r,itemIconColorActiveHorizontalInverted:r,itemIconColorActiveHoverHorizontalInverted:r,itemIconColorChildActiveHorizontalInverted:r,itemIconColorChildActiveHoverHorizontalInverted:r,arrowColorInverted:e,arrowColorHoverInverted:r,arrowColorActiveInverted:r,arrowColorActiveHoverInverted:r,arrowColorChildActiveInverted:r,arrowColorChildActiveHoverInverted:r,groupTextColorInverted:i}}const Moe=e=>{const{borderRadius:t,textColor3:r,primaryColor:i,textColor2:n,textColor1:a,fontSize:o,dividerColor:s,hoverColor:l,primaryColorHover:c}=e;return Object.assign({borderRadius:t,color:"#0000",groupTextColor:r,itemColorHover:l,itemColorActive:Yt(i,{alpha:.1}),itemColorActiveHover:Yt(i,{alpha:.1}),itemColorActiveCollapsed:Yt(i,{alpha:.1}),itemTextColor:n,itemTextColorHover:n,itemTextColorActive:i,itemTextColorActiveHover:i,itemTextColorChildActive:i,itemTextColorChildActiveHover:i,itemTextColorHorizontal:n,itemTextColorHoverHorizontal:c,itemTextColorActiveHorizontal:i,itemTextColorActiveHoverHorizontal:i,itemTextColorChildActiveHorizontal:i,itemTextColorChildActiveHoverHorizontal:i,itemIconColor:a,itemIconColorHover:a,itemIconColorActive:i,itemIconColorActiveHover:i,itemIconColorChildActive:i,itemIconColorChildActiveHover:i,itemIconColorCollapsed:a,itemIconColorHorizontal:a,itemIconColorHoverHorizontal:c,itemIconColorActiveHorizontal:i,itemIconColorActiveHoverHorizontal:i,itemIconColorChildActiveHorizontal:i,itemIconColorChildActiveHoverHorizontal:i,itemHeight:"42px",arrowColor:n,arrowColorHover:n,arrowColorActive:i,arrowColorActiveHover:i,arrowColorChildActive:i,arrowColorChildActiveHover:i,colorInverted:"#0000",borderColorHorizontal:"#0000",fontSize:o,dividerColor:s},Aoe("#BBB",i,"#FFF","#AAA"))},Eoe={name:"Menu",common:Gr,peers:{Tooltip:mU,Dropdown:vU},self:Moe},Toe={titleFontSize:"18px",backSize:"22px"};function Poe(e){const{textColor1:t,textColor2:r,textColor3:i,fontSize:n,fontWeightStrong:a,primaryColorHover:o,primaryColorPressed:s}=e;return Object.assign(Object.assign({},Toe),{titleFontWeight:a,fontSize:n,titleTextColor:t,backColor:r,backColorHover:o,backColorPressed:s,subtitleTextColor:i})}const Doe={name:"PageHeader",common:Gr,self:Poe},Ooe=e=>{const{textColor2:t,textColor3:r,fontSize:i,fontWeight:n}=e;return{labelFontSize:i,labelFontWeight:n,valueFontWeight:n,valueFontSize:"24px",labelTextColor:r,valuePrefixTextColor:t,valueSuffixTextColor:t,valueTextColor:t}},Roe={name:"Statistic",common:Gr,self:Ooe},Ioe={buttonHeightSmall:"14px",buttonHeightMedium:"18px",buttonHeightLarge:"22px",buttonWidthSmall:"14px",buttonWidthMedium:"18px",buttonWidthLarge:"22px",buttonWidthPressedSmall:"20px",buttonWidthPressedMedium:"24px",buttonWidthPressedLarge:"28px",railHeightSmall:"18px",railHeightMedium:"22px",railHeightLarge:"26px",railWidthSmall:"32px",railWidthMedium:"40px",railWidthLarge:"48px"},zoe=e=>{const{primaryColor:t,opacityDisabled:r,borderRadius:i,textColor3:n}=e;return Object.assign(Object.assign({},Ioe),{iconColor:n,textColor:"white",loadingColor:t,opacityDisabled:r,railColor:"rgba(0, 0, 0, .14)",railColorActive:t,buttonBoxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.3), inset 0 0 1px 0 rgba(0, 0, 0, 0.05)",buttonColor:"#FFF",railBorderRadiusSmall:i,railBorderRadiusMedium:i,railBorderRadiusLarge:i,buttonBorderRadiusSmall:i,buttonBorderRadiusMedium:i,buttonBorderRadiusLarge:i,boxShadowFocus:`0 0 0 2px ${Yt(t,{alpha:.2})}`})},koe={name:"Switch",common:Gr,self:zoe},Loe={tabFontSizeSmall:"14px",tabFontSizeMedium:"14px",tabFontSizeLarge:"16px",tabGapSmallLine:"36px",tabGapMediumLine:"36px",tabGapLargeLine:"36px",tabGapSmallLineVertical:"8px",tabGapMediumLineVertical:"8px",tabGapLargeLineVertical:"8px",tabPaddingSmallLine:"6px 0",tabPaddingMediumLine:"10px 0",tabPaddingLargeLine:"14px 0",tabPaddingVerticalSmallLine:"6px 12px",tabPaddingVerticalMediumLine:"8px 16px",tabPaddingVerticalLargeLine:"10px 20px",tabGapSmallBar:"36px",tabGapMediumBar:"36px",tabGapLargeBar:"36px",tabGapSmallBarVertical:"8px",tabGapMediumBarVertical:"8px",tabGapLargeBarVertical:"8px",tabPaddingSmallBar:"4px 0",tabPaddingMediumBar:"6px 0",tabPaddingLargeBar:"10px 0",tabPaddingVerticalSmallBar:"6px 12px",tabPaddingVerticalMediumBar:"8px 16px",tabPaddingVerticalLargeBar:"10px 20px",tabGapSmallCard:"4px",tabGapMediumCard:"4px",tabGapLargeCard:"4px",tabGapSmallCardVertical:"4px",tabGapMediumCardVertical:"4px",tabGapLargeCardVertical:"4px",tabPaddingSmallCard:"8px 16px",tabPaddingMediumCard:"10px 20px",tabPaddingLargeCard:"12px 24px",tabPaddingSmallSegment:"4px 0",tabPaddingMediumSegment:"6px 0",tabPaddingLargeSegment:"8px 0",tabPaddingVerticalLargeSegment:"0 8px",tabPaddingVerticalSmallCard:"8px 12px",tabPaddingVerticalMediumCard:"10px 16px",tabPaddingVerticalLargeCard:"12px 20px",tabPaddingVerticalSmallSegment:"0 4px",tabPaddingVerticalMediumSegment:"0 6px",tabGapSmallSegment:"0",tabGapMediumSegment:"0",tabGapLargeSegment:"0",tabGapSmallSegmentVertical:"0",tabGapMediumSegmentVertical:"0",tabGapLargeSegmentVertical:"0",panePaddingSmall:"8px 0 0 0",panePaddingMedium:"12px 0 0 0",panePaddingLarge:"16px 0 0 0",closeSize:"18px",closeIconSize:"14px"},Boe=e=>{const{textColor2:t,primaryColor:r,textColorDisabled:i,closeIconColor:n,closeIconColorHover:a,closeIconColorPressed:o,closeColorHover:s,closeColorPressed:l,tabColor:c,baseColor:d,dividerColor:u,fontWeight:h,textColor1:f,borderRadius:p,fontSize:v,fontWeightStrong:m}=e;return Object.assign(Object.assign({},Loe),{colorSegment:c,tabFontSizeCard:v,tabTextColorLine:f,tabTextColorActiveLine:r,tabTextColorHoverLine:r,tabTextColorDisabledLine:i,tabTextColorSegment:f,tabTextColorActiveSegment:t,tabTextColorHoverSegment:t,tabTextColorDisabledSegment:i,tabTextColorBar:f,tabTextColorActiveBar:r,tabTextColorHoverBar:r,tabTextColorDisabledBar:i,tabTextColorCard:f,tabTextColorHoverCard:f,tabTextColorActiveCard:r,tabTextColorDisabledCard:i,barColor:r,closeIconColor:n,closeIconColorHover:a,closeIconColorPressed:o,closeColorHover:s,closeColorPressed:l,closeBorderRadius:p,tabColor:c,tabColorSegment:d,tabBorderColor:u,tabFontWeightActive:h,tabFontWeight:h,tabBorderRadius:p,paneTextColor:t,fontWeightStrong:m})},Foe={name:"Tabs",common:Gr,self:Boe},Noe={extraFontSizeSmall:"12px",extraFontSizeMedium:"12px",extraFontSizeLarge:"14px",titleFontSizeSmall:"14px",titleFontSizeMedium:"16px",titleFontSizeLarge:"16px",closeSize:"20px",closeIconSize:"16px",headerHeightSmall:"44px",headerHeightMedium:"44px",headerHeightLarge:"50px"},Uoe=e=>{const{fontWeight:t,fontSizeLarge:r,fontSizeMedium:i,fontSizeSmall:n,heightLarge:a,heightMedium:o,borderRadius:s,cardColor:l,tableHeaderColor:c,textColor1:d,textColorDisabled:u,textColor2:h,textColor3:f,borderColor:p,hoverColor:v,closeColorHover:m,closeColorPressed:g,closeIconColor:y,closeIconColorHover:b,closeIconColorPressed:x}=e;return Object.assign(Object.assign({},Noe),{itemHeightSmall:o,itemHeightMedium:o,itemHeightLarge:a,fontSizeSmall:n,fontSizeMedium:i,fontSizeLarge:r,borderRadius:s,dividerColor:p,borderColor:p,listColor:l,headerColor:Xs(l,c),titleTextColor:d,titleTextColorDisabled:u,extraTextColor:f,extraTextColorDisabled:u,itemTextColor:h,itemTextColorDisabled:u,itemColorPending:v,titleFontWeight:t,closeColorHover:m,closeColorPressed:g,closeIconColor:y,closeIconColorHover:b,closeIconColorPressed:x})},joe={name:"Transfer",common:Gr,peers:{Checkbox:hU,Scrollbar:kp,Input:Bp,Empty:ST,Button:zg},self:Uoe},Voe={headerFontSize1:"30px",headerFontSize2:"22px",headerFontSize3:"18px",headerFontSize4:"16px",headerFontSize5:"16px",headerFontSize6:"16px",headerMargin1:"28px 0 20px 0",headerMargin2:"28px 0 20px 0",headerMargin3:"28px 0 20px 0",headerMargin4:"28px 0 18px 0",headerMargin5:"28px 0 18px 0",headerMargin6:"28px 0 18px 0",headerPrefixWidth1:"16px",headerPrefixWidth2:"16px",headerPrefixWidth3:"12px",headerPrefixWidth4:"12px",headerPrefixWidth5:"12px",headerPrefixWidth6:"12px",headerBarWidth1:"4px",headerBarWidth2:"4px",headerBarWidth3:"3px",headerBarWidth4:"3px",headerBarWidth5:"3px",headerBarWidth6:"3px",pMargin:"16px 0 16px 0",liMargin:".25em 0 0 0",olPadding:"0 0 0 2em",ulPadding:"0 0 0 2em"},Hoe=e=>{const{primaryColor:t,textColor2:r,borderColor:i,lineHeight:n,fontSize:a,borderRadiusSmall:o,dividerColor:s,fontWeightStrong:l,textColor1:c,textColor3:d,infoColor:u,warningColor:h,errorColor:f,successColor:p,codeColor:v}=e;return Object.assign(Object.assign({},Voe),{aTextColor:t,blockquoteTextColor:r,blockquotePrefixColor:i,blockquoteLineHeight:n,blockquoteFontSize:a,codeBorderRadius:o,liTextColor:r,liLineHeight:n,liFontSize:a,hrColor:s,headerFontWeight:l,headerTextColor:c,pTextColor:r,pTextColor1Depth:c,pTextColor2Depth:r,pTextColor3Depth:d,pLineHeight:n,pFontSize:a,headerBarColor:t,headerBarColorPrimary:t,headerBarColorInfo:u,headerBarColorError:f,headerBarColorWarning:h,headerBarColorSuccess:p,textColor:r,textColor1Depth:c,textColor2Depth:r,textColor3Depth:d,textColorPrimary:t,textColorInfo:u,textColorSuccess:p,textColorWarning:h,textColorError:f,codeTextColor:r,codeColor:v,codeBorder:"1px solid #0000"})},UU={name:"Typography",common:Gr,self:Hoe},Woe=oe("gradient-text",`
 display: inline-block;
 font-weight: var(--n-font-weight);
 -webkit-background-clip: text;
 background-clip: text;
 color: #0000;
 white-space: nowrap;
 background-image: linear-gradient(var(--n-rotate), var(--n-color-start) 0%, var(--n-color-end) 100%);
 transition:
 --n-color-start .3s var(--n-bezier),
 --n-color-end .3s var(--n-bezier);
`),Goe=Object.assign(Object.assign({},bt.props),{size:[String,Number],fontSize:[String,Number],type:{type:String,default:"primary"},color:[Object,String],gradient:[Object,String]}),jU=Ve({name:"GradientText",props:Goe,setup(e){k$();const{mergedClsPrefixRef:t,inlineThemeDisabled:r}=mr(e),i=re(()=>{const{type:c}=e;return c==="danger"?"error":c}),n=re(()=>{let c=e.size||e.fontSize;return c&&(c=os(c)),c||void 0}),a=re(()=>{const c=e.color||e.gradient;if(typeof c=="string")return c;if(c){const d=c.deg||0,u=c.from,h=c.to;return`linear-gradient(${d}deg, ${u} 0%, ${h} 100%)`}}),o=bt("GradientText","-gradient-text",Woe,Coe,e,t),s=re(()=>{const{value:c}=i,{common:{cubicBezierEaseInOut:d},self:{rotate:u,[Ze("colorStart",c)]:h,[Ze("colorEnd",c)]:f,fontWeight:p}}=o.value;return{"--n-bezier":d,"--n-rotate":u,"--n-color-start":h,"--n-color-end":f,"--n-font-weight":p}}),l=r?Dr("gradient-text",re(()=>i.value[0]),s,e):void 0;return{mergedClsPrefix:t,compatibleType:i,styleFontSize:n,styleBgImage:a,cssVars:r?void 0:s,themeClass:l==null?void 0:l.themeClass,onRender:l==null?void 0:l.onRender}},render(){const{mergedClsPrefix:e,onRender:t}=this;return t==null||t(),E("span",{class:[`${e}-gradient-text`,`${e}-gradient-text--${this.compatibleType}-type`,this.themeClass],style:[{fontSize:this.styleFontSize,backgroundImage:this.styleBgImage},this.cssVars]},this.$slots)}}),VU="n-layout-sider",F1={type:String,default:"static"},$oe=oe("layout",`
 color: var(--n-text-color);
 background-color: var(--n-color);
 box-sizing: border-box;
 position: relative;
 z-index: auto;
 flex: auto;
 overflow: hidden;
 transition:
 box-shadow .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
`,[oe("layout-scroll-container",`
 overflow-x: hidden;
 box-sizing: border-box;
 height: 100%;
 `),xe("absolute-positioned",`
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 `)]),qoe={embedded:Boolean,position:F1,nativeScrollbar:{type:Boolean,default:!0},scrollbarProps:Object,onScroll:Function,contentClass:String,contentStyle:{type:[String,Object],default:""},hasSider:Boolean,siderPlacement:{type:String,default:"left"}},HU="n-layout";function Yoe(e){return Ve({name:"Layout",props:Object.assign(Object.assign({},bt.props),qoe),setup(t){const r=ge(null),i=ge(null),{mergedClsPrefixRef:n,inlineThemeDisabled:a}=mr(t),o=bt("Layout","-layout",$oe,B1,t,n);function s(v,m){if(t.nativeScrollbar){const{value:g}=r;g&&(m===void 0?g.scrollTo(v):g.scrollTo(v,m))}else{const{value:g}=i;g&&g.scrollTo(v,m)}}br(HU,t);let l=0,c=0;const d=v=>{var m;const g=v.target;l=g.scrollLeft,c=g.scrollTop,(m=t.onScroll)===null||m===void 0||m.call(t,v)};eT(()=>{if(t.nativeScrollbar){const v=r.value;v&&(v.scrollTop=c,v.scrollLeft=l)}});const u={display:"flex",flexWrap:"nowrap",width:"100%",flexDirection:"row"},h={scrollTo:s},f=re(()=>{const{common:{cubicBezierEaseInOut:v},self:m}=o.value;return{"--n-bezier":v,"--n-color":t.embedded?m.colorEmbedded:m.color,"--n-text-color":m.textColor}}),p=a?Dr("layout",re(()=>t.embedded?"e":""),f,t):void 0;return Object.assign({mergedClsPrefix:n,scrollableElRef:r,scrollbarInstRef:i,hasSiderStyle:u,mergedTheme:o,handleNativeElScroll:d,cssVars:a?void 0:f,themeClass:p==null?void 0:p.themeClass,onRender:p==null?void 0:p.onRender},h)},render(){var t;const{mergedClsPrefix:r,hasSider:i}=this;(t=this.onRender)===null||t===void 0||t.call(this);const n=i?this.hasSiderStyle:void 0,a=[this.themeClass,e,`${r}-layout`,`${r}-layout--${this.position}-positioned`];return E("div",{class:a,style:this.cssVars},this.nativeScrollbar?E("div",{ref:"scrollableElRef",class:[`${r}-layout-scroll-container`,this.contentClass],style:[this.contentStyle,n],onScroll:this.handleNativeElScroll},this.$slots):E(bn,Object.assign({},this.scrollbarProps,{onScroll:this.onScroll,ref:"scrollbarInstRef",theme:this.mergedTheme.peers.Scrollbar,themeOverrides:this.mergedTheme.peerOverrides.Scrollbar,contentClass:this.contentClass,contentStyle:[this.contentStyle,n]}),this.$slots))}})}const jf=Yoe(!1),Xoe=oe("layout-header",`
 transition:
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 box-shadow .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 box-sizing: border-box;
 width: 100%;
 background-color: var(--n-color);
 color: var(--n-text-color);
`,[xe("absolute-positioned",`
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 `),xe("bordered",`
 border-bottom: solid 1px var(--n-border-color);
 `)]),Koe={position:F1,inverted:Boolean,bordered:{type:Boolean,default:!1}},WU=Ve({name:"LayoutHeader",props:Object.assign(Object.assign({},bt.props),Koe),setup(e){const{mergedClsPrefixRef:t,inlineThemeDisabled:r}=mr(e),i=bt("Layout","-layout-header",Xoe,B1,e,t),n=re(()=>{const{common:{cubicBezierEaseInOut:o},self:s}=i.value,l={"--n-bezier":o};return e.inverted?(l["--n-color"]=s.headerColorInverted,l["--n-text-color"]=s.textColorInverted,l["--n-border-color"]=s.headerBorderColorInverted):(l["--n-color"]=s.headerColor,l["--n-text-color"]=s.textColor,l["--n-border-color"]=s.headerBorderColor),l}),a=r?Dr("layout-header",re(()=>e.inverted?"a":"b"),n,e):void 0;return{mergedClsPrefix:t,cssVars:r?void 0:n,themeClass:a==null?void 0:a.themeClass,onRender:a==null?void 0:a.onRender}},render(){var e;const{mergedClsPrefix:t}=this;return(e=this.onRender)===null||e===void 0||e.call(this),E("div",{class:[`${t}-layout-header`,this.themeClass,this.position&&`${t}-layout-header--${this.position}-positioned`,this.bordered&&`${t}-layout-header--bordered`],style:this.cssVars},this.$slots)}}),Qoe=oe("layout-footer",`
 transition:
 box-shadow .3s var(--n-bezier),
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 color: var(--n-text-color);
 background-color: var(--n-color);
 box-sizing: border-box;
`,[xe("absolute-positioned",`
 position: absolute;
 left: 0;
 right: 0;
 bottom: 0;
 `),xe("bordered",`
 border-top: solid 1px var(--n-border-color);
 `)]),Zoe=Object.assign(Object.assign({},bt.props),{inverted:Boolean,position:F1,bordered:Boolean}),GU=Ve({name:"LayoutFooter",props:Zoe,setup(e){const{mergedClsPrefixRef:t,inlineThemeDisabled:r}=mr(e),i=bt("Layout","-layout-footer",Qoe,B1,e,t),n=re(()=>{const{common:{cubicBezierEaseInOut:o},self:s}=i.value,l={"--n-bezier":o};return e.inverted?(l["--n-color"]=s.footerColorInverted,l["--n-text-color"]=s.textColorInverted,l["--n-border-color"]=s.footerBorderColorInverted):(l["--n-color"]=s.footerColor,l["--n-text-color"]=s.textColor,l["--n-border-color"]=s.footerBorderColor),l}),a=r?Dr("layout-footer",re(()=>e.inverted?"a":"b"),n,e):void 0;return{mergedClsPrefix:t,cssVars:r?void 0:n,themeClass:a==null?void 0:a.themeClass,onRender:a==null?void 0:a.onRender}},render(){var e;const{mergedClsPrefix:t}=this;return(e=this.onRender)===null||e===void 0||e.call(this),E("div",{class:[`${t}-layout-footer`,this.themeClass,this.position&&`${t}-layout-footer--${this.position}-positioned`,this.bordered&&`${t}-layout-footer--bordered`],style:this.cssVars},this.$slots)}}),Joe=oe("layout-sider",`
 flex-shrink: 0;
 box-sizing: border-box;
 position: relative;
 z-index: 1;
 color: var(--n-text-color);
 transition:
 color .3s var(--n-bezier),
 border-color .3s var(--n-bezier),
 min-width .3s var(--n-bezier),
 max-width .3s var(--n-bezier),
 transform .3s var(--n-bezier),
 background-color .3s var(--n-bezier);
 background-color: var(--n-color);
 display: flex;
 justify-content: flex-end;
`,[xe("bordered",[he("border",`
 content: "";
 position: absolute;
 top: 0;
 bottom: 0;
 width: 1px;
 background-color: var(--n-border-color);
 transition: background-color .3s var(--n-bezier);
 `)]),he("left-placement",[xe("bordered",[he("border",`
 right: 0;
 `)])]),xe("right-placement",`
 justify-content: flex-start;
 `,[xe("bordered",[he("border",`
 left: 0;
 `)]),xe("collapsed",[oe("layout-toggle-button",[oe("base-icon",`
 transform: rotate(180deg);
 `)]),oe("layout-toggle-bar",[ve("&:hover",[he("top",{transform:"rotate(-12deg) scale(1.15) translateY(-2px)"}),he("bottom",{transform:"rotate(12deg) scale(1.15) translateY(2px)"})])])]),oe("layout-toggle-button",`
 left: 0;
 transform: translateX(-50%) translateY(-50%);
 `,[oe("base-icon",`
 transform: rotate(0);
 `)]),oe("layout-toggle-bar",`
 left: -28px;
 transform: rotate(180deg);
 `,[ve("&:hover",[he("top",{transform:"rotate(12deg) scale(1.15) translateY(-2px)"}),he("bottom",{transform:"rotate(-12deg) scale(1.15) translateY(2px)"})])])]),xe("collapsed",[oe("layout-toggle-bar",[ve("&:hover",[he("top",{transform:"rotate(-12deg) scale(1.15) translateY(-2px)"}),he("bottom",{transform:"rotate(12deg) scale(1.15) translateY(2px)"})])]),oe("layout-toggle-button",[oe("base-icon",`
 transform: rotate(0);
 `)])]),oe("layout-toggle-button",`
 transition:
 color .3s var(--n-bezier),
 right .3s var(--n-bezier),
 left .3s var(--n-bezier),
 border-color .3s var(--n-bezier),
 background-color .3s var(--n-bezier);
 cursor: pointer;
 width: 24px;
 height: 24px;
 position: absolute;
 top: 50%;
 right: 0;
 border-radius: 50%;
 display: flex;
 align-items: center;
 justify-content: center;
 font-size: 18px;
 color: var(--n-toggle-button-icon-color);
 border: var(--n-toggle-button-border);
 background-color: var(--n-toggle-button-color);
 box-shadow: 0 2px 4px 0px rgba(0, 0, 0, .06);
 transform: translateX(50%) translateY(-50%);
 z-index: 1;
 `,[oe("base-icon",`
 transition: transform .3s var(--n-bezier);
 transform: rotate(180deg);
 `)]),oe("layout-toggle-bar",`
 cursor: pointer;
 height: 72px;
 width: 32px;
 position: absolute;
 top: calc(50% - 36px);
 right: -28px;
 `,[he("top, bottom",`
 position: absolute;
 width: 4px;
 border-radius: 2px;
 height: 38px;
 left: 14px;
 transition: 
 background-color .3s var(--n-bezier),
 transform .3s var(--n-bezier);
 `),he("bottom",`
 position: absolute;
 top: 34px;
 `),ve("&:hover",[he("top",{transform:"rotate(12deg) scale(1.15) translateY(-2px)"}),he("bottom",{transform:"rotate(-12deg) scale(1.15) translateY(2px)"})]),he("top, bottom",{backgroundColor:"var(--n-toggle-bar-color)"}),ve("&:hover",[he("top, bottom",{backgroundColor:"var(--n-toggle-bar-color-hover)"})])]),he("border",`
 position: absolute;
 top: 0;
 right: 0;
 bottom: 0;
 width: 1px;
 transition: background-color .3s var(--n-bezier);
 `),oe("layout-sider-scroll-container",`
 flex-grow: 1;
 flex-shrink: 0;
 box-sizing: border-box;
 height: 100%;
 opacity: 0;
 transition: opacity .3s var(--n-bezier);
 max-width: 100%;
 `),xe("show-content",[oe("layout-sider-scroll-container",{opacity:1})]),xe("absolute-positioned",`
 position: absolute;
 left: 0;
 top: 0;
 bottom: 0;
 `)]),ese=Ve({name:"LayoutToggleButton",props:{clsPrefix:{type:String,required:!0},onClick:Function},render(){const{clsPrefix:e}=this;return E("div",{class:`${e}-layout-toggle-button`,onClick:this.onClick},E(Li,{clsPrefix:e},{default:()=>E(VN,null)}))}}),tse=Ve({props:{clsPrefix:{type:String,required:!0},onClick:Function},render(){const{clsPrefix:e}=this;return E("div",{onClick:this.onClick,class:`${e}-layout-toggle-bar`},E("div",{class:`${e}-layout-toggle-bar__top`}),E("div",{class:`${e}-layout-toggle-bar__bottom`}))}}),rse={position:F1,bordered:Boolean,collapsedWidth:{type:Number,default:48},width:{type:[Number,String],default:272},contentClass:String,contentStyle:{type:[String,Object],default:""},collapseMode:{type:String,default:"transform"},collapsed:{type:Boolean,default:void 0},defaultCollapsed:Boolean,showCollapsedContent:{type:Boolean,default:!0},showTrigger:{type:[Boolean,String],default:!1},nativeScrollbar:{type:Boolean,default:!0},inverted:Boolean,scrollbarProps:Object,triggerClass:String,triggerStyle:[String,Object],collapsedTriggerClass:String,collapsedTriggerStyle:[String,Object],"onUpdate:collapsed":[Function,Array],onUpdateCollapsed:[Function,Array],onAfterEnter:Function,onAfterLeave:Function,onExpand:[Function,Array],onCollapse:[Function,Array],onScroll:Function},ise=Ve({name:"LayoutSider",props:Object.assign(Object.assign({},bt.props),rse),setup(e){const t=_t(HU),r=ge(null),i=ge(null),n=re(()=>os(l.value?e.collapsedWidth:e.width)),a=re(()=>e.collapseMode!=="transform"?{}:{minWidth:os(e.width)}),o=re(()=>t?t.siderPlacement:"left"),s=ge(e.defaultCollapsed),l=Un(pt(e,"collapsed"),s);function c(S,w){if(e.nativeScrollbar){const{value:_}=r;_&&(w===void 0?_.scrollTo(S):_.scrollTo(S,w))}else{const{value:_}=i;_&&_.scrollTo(S,w)}}function d(){const{"onUpdate:collapsed":S,onUpdateCollapsed:w,onExpand:_,onCollapse:C}=e,{value:A}=l;w&&ct(w,!A),S&&ct(S,!A),s.value=!A,A?_&&ct(_):C&&ct(C)}let u=0,h=0;const f=S=>{var w;const _=S.target;u=_.scrollLeft,h=_.scrollTop,(w=e.onScroll)===null||w===void 0||w.call(e,S)};eT(()=>{if(e.nativeScrollbar){const S=r.value;S&&(S.scrollTop=h,S.scrollLeft=u)}}),br(VU,{collapsedRef:l,collapseModeRef:pt(e,"collapseMode")});const{mergedClsPrefixRef:p,inlineThemeDisabled:v}=mr(e),m=bt("Layout","-layout-sider",Joe,B1,e,p);function g(S){var w,_;S.propertyName==="max-width"&&(l.value?(w=e.onAfterLeave)===null||w===void 0||w.call(e):(_=e.onAfterEnter)===null||_===void 0||_.call(e))}const y={scrollTo:c},b=re(()=>{const{common:{cubicBezierEaseInOut:S},self:w}=m.value,{siderToggleButtonColor:_,siderToggleButtonBorder:C,siderToggleBarColor:A,siderToggleBarColorHover:M}=w,P={"--n-bezier":S,"--n-toggle-button-color":_,"--n-toggle-button-border":C,"--n-toggle-bar-color":A,"--n-toggle-bar-color-hover":M};return e.inverted?(P["--n-color"]=w.siderColorInverted,P["--n-text-color"]=w.textColorInverted,P["--n-border-color"]=w.siderBorderColorInverted,P["--n-toggle-button-icon-color"]=w.siderToggleButtonIconColorInverted,P.__invertScrollbar=w.__invertScrollbar):(P["--n-color"]=w.siderColor,P["--n-text-color"]=w.textColor,P["--n-border-color"]=w.siderBorderColor,P["--n-toggle-button-icon-color"]=w.siderToggleButtonIconColor),P}),x=v?Dr("layout-sider",re(()=>e.inverted?"a":"b"),b,e):void 0;return Object.assign({scrollableElRef:r,scrollbarInstRef:i,mergedClsPrefix:p,mergedTheme:m,styleMaxWidth:n,mergedCollapsed:l,scrollContainerStyle:a,siderPlacement:o,handleNativeElScroll:f,handleTransitionend:g,handleTriggerClick:d,inlineThemeDisabled:v,cssVars:b,themeClass:x==null?void 0:x.themeClass,onRender:x==null?void 0:x.onRender},y)},render(){var e;const{mergedClsPrefix:t,mergedCollapsed:r,showTrigger:i}=this;return(e=this.onRender)===null||e===void 0||e.call(this),E("aside",{class:[`${t}-layout-sider`,this.themeClass,`${t}-layout-sider--${this.position}-positioned`,`${t}-layout-sider--${this.siderPlacement}-placement`,this.bordered&&`${t}-layout-sider--bordered`,r&&`${t}-layout-sider--collapsed`,(!r||this.showCollapsedContent)&&`${t}-layout-sider--show-content`],onTransitionend:this.handleTransitionend,style:[this.inlineThemeDisabled?void 0:this.cssVars,{maxWidth:this.styleMaxWidth,width:os(this.width)}]},this.nativeScrollbar?E("div",{class:[`${t}-layout-sider-scroll-container`,this.contentClass],onScroll:this.handleNativeElScroll,style:[this.scrollContainerStyle,{overflow:"auto"},this.contentStyle],ref:"scrollableElRef"},this.$slots):E(bn,Object.assign({},this.scrollbarProps,{onScroll:this.onScroll,ref:"scrollbarInstRef",style:this.scrollContainerStyle,contentStyle:this.contentStyle,contentClass:this.contentClass,theme:this.mergedTheme.peers.Scrollbar,themeOverrides:this.mergedTheme.peerOverrides.Scrollbar,builtinThemeOverrides:this.inverted&&this.cssVars.__invertScrollbar==="true"?{colorHover:"rgba(255, 255, 255, .4)",color:"rgba(255, 255, 255, .3)"}:void 0}),this.$slots),i?i==="bar"?E(tse,{clsPrefix:t,class:r?this.collapsedTriggerClass:this.triggerClass,style:r?this.collapsedTriggerStyle:this.triggerStyle,onClick:this.handleTriggerClick}):E(ese,{clsPrefix:t,class:r?this.collapsedTriggerClass:this.triggerClass,style:r?this.collapsedTriggerStyle:this.triggerStyle,onClick:this.handleTriggerClick}):null,this.bordered?E("div",{class:`${t}-layout-sider__border`}):null)}}),Fg="n-menu",kT="n-submenu",LT="n-menu-item-group",R0=8;function BT(e){const t=_t(Fg),{props:r,mergedCollapsedRef:i}=t,n=_t(kT,null),a=_t(LT,null),o=re(()=>r.mode==="horizontal"),s=re(()=>o.value?r.dropdownPlacement:"tmNodes"in e?"right-start":"right"),l=re(()=>{var h;return Math.max((h=r.collapsedIconSize)!==null&&h!==void 0?h:r.iconSize,r.iconSize)}),c=re(()=>{var h;return!o.value&&e.root&&i.value&&(h=r.collapsedIconSize)!==null&&h!==void 0?h:r.iconSize}),d=re(()=>{if(o.value)return;const{collapsedWidth:h,indent:f,rootIndent:p}=r,{root:v,isGroup:m}=e,g=p===void 0?f:p;return v?i.value?h/2-l.value/2:g:a&&typeof a.paddingLeftRef.value=="number"?f/2+a.paddingLeftRef.value:n&&typeof n.paddingLeftRef.value=="number"?(m?f/2:f)+n.paddingLeftRef.value:0}),u=re(()=>{const{collapsedWidth:h,indent:f,rootIndent:p}=r,{value:v}=l,{root:m}=e;return o.value||!m||!i.value?R0:(p===void 0?f:p)+v+R0-(h+v)/2});return{dropdownPlacement:s,activeIconSize:c,maxIconSize:l,paddingLeft:d,iconMarginRight:u,NMenu:t,NSubmenu:n}}const FT={internalKey:{type:[String,Number],required:!0},root:Boolean,isGroup:Boolean,level:{type:Number,required:!0},title:[String,Function],extra:[String,Function]},$U=Object.assign(Object.assign({},FT),{tmNode:{type:Object,required:!0},tmNodes:{type:Array,required:!0}}),nse=Ve({name:"MenuOptionGroup",props:$U,setup(e){br(kT,null);const t=BT(e);br(LT,{paddingLeftRef:t.paddingLeft});const{mergedClsPrefixRef:r,props:i}=_t(Fg);return function(){const{value:n}=r,a=t.paddingLeft.value,{nodeProps:o}=i,s=o==null?void 0:o(e.tmNode.rawNode);return E("div",{class:`${n}-menu-item-group`,role:"group"},E("div",Object.assign({},s,{class:[`${n}-menu-item-group-title`,s==null?void 0:s.class],style:[(s==null?void 0:s.style)||"",a!==void 0?`padding-left: ${a}px;`:""]}),kn(e.title),e.extra?E(pr,null," ",kn(e.extra)):null),E("div",null,e.tmNodes.map(l=>NT(l,i))))}}}),qU=Ve({name:"MenuOptionContent",props:{collapsed:Boolean,disabled:Boolean,title:[String,Function],icon:Function,extra:[String,Function],showArrow:Boolean,childActive:Boolean,hover:Boolean,paddingLeft:Number,selected:Boolean,maxIconSize:{type:Number,required:!0},activeIconSize:{type:Number,required:!0},iconMarginRight:{type:Number,required:!0},clsPrefix:{type:String,required:!0},onClick:Function,tmNode:{type:Object,required:!0},isEllipsisPlaceholder:Boolean},setup(e){const{props:t}=_t(Fg);return{menuProps:t,style:re(()=>{const{paddingLeft:r}=e;return{paddingLeft:r&&`${r}px`}}),iconStyle:re(()=>{const{maxIconSize:r,activeIconSize:i,iconMarginRight:n}=e;return{width:`${r}px`,height:`${r}px`,fontSize:`${i}px`,marginRight:`${n}px`}})}},render(){const{clsPrefix:e,tmNode:t,menuProps:{renderIcon:r,renderLabel:i,renderExtra:n,expandIcon:a}}=this,o=r?r(t.rawNode):kn(this.icon);return E("div",{onClick:s=>{var l;(l=this.onClick)===null||l===void 0||l.call(this,s)},role:"none",class:[`${e}-menu-item-content`,{[`${e}-menu-item-content--selected`]:this.selected,[`${e}-menu-item-content--collapsed`]:this.collapsed,[`${e}-menu-item-content--child-active`]:this.childActive,[`${e}-menu-item-content--disabled`]:this.disabled,[`${e}-menu-item-content--hover`]:this.hover}],style:this.style},o&&E("div",{class:`${e}-menu-item-content__icon`,style:this.iconStyle,role:"none"},[o]),E("div",{class:`${e}-menu-item-content-header`,role:"none"},this.isEllipsisPlaceholder?this.title:i?i(t.rawNode):kn(this.title),this.extra||n?E("span",{class:`${e}-menu-item-content-header__extra`}," ",n?n(t.rawNode):kn(this.extra)):null),this.showArrow?E(Li,{ariaHidden:!0,class:`${e}-menu-item-content__arrow`,clsPrefix:e},{default:()=>a?a(t.rawNode):E(Uee,null)}):null)}}),YU=Object.assign(Object.assign({},FT),{rawNodes:{type:Array,default:()=>[]},tmNodes:{type:Array,default:()=>[]},tmNode:{type:Object,required:!0},disabled:Boolean,icon:Function,onClick:Function,domId:String,virtualChildActive:{type:Boolean,default:void 0},isEllipsisPlaceholder:Boolean}),lA=Ve({name:"Submenu",props:YU,setup(e){const t=BT(e),{NMenu:r,NSubmenu:i}=t,{props:n,mergedCollapsedRef:a,mergedThemeRef:o}=r,s=re(()=>{const{disabled:h}=e;return i!=null&&i.mergedDisabledRef.value||n.disabled?!0:h}),l=ge(!1);br(kT,{paddingLeftRef:t.paddingLeft,mergedDisabledRef:s}),br(LT,null);function c(){const{onClick:h}=e;h&&h()}function d(){s.value||(a.value||r.toggleExpand(e.internalKey),c())}function u(h){l.value=h}return{menuProps:n,mergedTheme:o,doSelect:r.doSelect,inverted:r.invertedRef,isHorizontal:r.isHorizontalRef,mergedClsPrefix:r.mergedClsPrefixRef,maxIconSize:t.maxIconSize,activeIconSize:t.activeIconSize,iconMarginRight:t.iconMarginRight,dropdownPlacement:t.dropdownPlacement,dropdownShow:l,paddingLeft:t.paddingLeft,mergedDisabled:s,mergedValue:r.mergedValueRef,childActive:$i(()=>{var h;return(h=e.virtualChildActive)!==null&&h!==void 0?h:r.activePathRef.value.includes(e.internalKey)}),collapsed:re(()=>n.mode==="horizontal"?!1:a.value?!0:!r.mergedExpandedKeysRef.value.includes(e.internalKey)),dropdownEnabled:re(()=>!s.value&&(n.mode==="horizontal"||a.value)),handlePopoverShowChange:u,handleClick:d}},render(){var e;const{mergedClsPrefix:t,menuProps:{renderIcon:r,renderLabel:i}}=this,n=()=>{const{isHorizontal:o,paddingLeft:s,collapsed:l,mergedDisabled:c,maxIconSize:d,activeIconSize:u,title:h,childActive:f,icon:p,handleClick:v,menuProps:{nodeProps:m},dropdownShow:g,iconMarginRight:y,tmNode:b,mergedClsPrefix:x,isEllipsisPlaceholder:S,extra:w}=this,_=m==null?void 0:m(b.rawNode);return E("div",Object.assign({},_,{class:[`${x}-menu-item`,_==null?void 0:_.class],role:"menuitem"}),E(qU,{tmNode:b,paddingLeft:s,collapsed:l,disabled:c,iconMarginRight:y,maxIconSize:d,activeIconSize:u,title:h,extra:w,showArrow:!o,childActive:f,clsPrefix:x,icon:p,hover:g,onClick:v,isEllipsisPlaceholder:S}))},a=()=>E(xT,null,{default:()=>{const{tmNodes:o,collapsed:s}=this;return s?null:E("div",{class:`${t}-submenu-children`,role:"menu"},o.map(l=>NT(l,this.menuProps)))}});return this.root?E(Eie,Object.assign({size:"large",trigger:"hover"},(e=this.menuProps)===null||e===void 0?void 0:e.dropdownProps,{themeOverrides:this.mergedTheme.peerOverrides.Dropdown,theme:this.mergedTheme.peers.Dropdown,builtinThemeOverrides:{fontSizeLarge:"14px",optionIconSizeLarge:"18px"},value:this.mergedValue,disabled:!this.dropdownEnabled,placement:this.dropdownPlacement,keyField:this.menuProps.keyField,labelField:this.menuProps.labelField,childrenField:this.menuProps.childrenField,onUpdateShow:this.handlePopoverShowChange,options:this.rawNodes,onSelect:this.doSelect,inverted:this.inverted,renderIcon:r,renderLabel:i}),{default:()=>E("div",{class:`${t}-submenu`,role:"menu","aria-expanded":!this.collapsed,id:this.domId},n(),this.isHorizontal?null:a())}):E("div",{class:`${t}-submenu`,role:"menu","aria-expanded":!this.collapsed,id:this.domId},n(),a())}}),XU=Object.assign(Object.assign({},FT),{tmNode:{type:Object,required:!0},disabled:Boolean,icon:Function,onClick:Function}),ase=Ve({name:"MenuOption",props:XU,setup(e){const t=BT(e),{NSubmenu:r,NMenu:i}=t,{props:n,mergedClsPrefixRef:a,mergedCollapsedRef:o}=i,s=r?r.mergedDisabledRef:{value:!1},l=re(()=>s.value||e.disabled);function c(u){const{onClick:h}=e;h&&h(u)}function d(u){l.value||(i.doSelect(e.internalKey,e.tmNode.rawNode),c(u))}return{mergedClsPrefix:a,dropdownPlacement:t.dropdownPlacement,paddingLeft:t.paddingLeft,iconMarginRight:t.iconMarginRight,maxIconSize:t.maxIconSize,activeIconSize:t.activeIconSize,mergedTheme:i.mergedThemeRef,menuProps:n,dropdownEnabled:$i(()=>e.root&&o.value&&n.mode!=="horizontal"&&!l.value),selected:$i(()=>i.mergedValueRef.value===e.internalKey),mergedDisabled:l,handleClick:d}},render(){const{mergedClsPrefix:e,mergedTheme:t,tmNode:r,menuProps:{renderLabel:i,nodeProps:n}}=this,a=n==null?void 0:n(r.rawNode);return E("div",Object.assign({},a,{role:"menuitem",class:[`${e}-menu-item`,a==null?void 0:a.class]}),E(fie,{theme:t.peers.Tooltip,themeOverrides:t.peerOverrides.Tooltip,trigger:"hover",placement:this.dropdownPlacement,disabled:!this.dropdownEnabled||this.title===void 0,internalExtraClass:["menu-tooltip"]},{default:()=>i?i(r.rawNode):kn(this.title),trigger:()=>E(qU,{tmNode:r,clsPrefix:e,paddingLeft:this.paddingLeft,iconMarginRight:this.iconMarginRight,maxIconSize:this.maxIconSize,activeIconSize:this.activeIconSize,selected:this.selected,title:this.title,extra:this.extra,disabled:this.mergedDisabled,icon:this.icon,onClick:this.handleClick})}))}}),ose=Ve({name:"MenuDivider",setup(){const e=_t(Fg),{mergedClsPrefixRef:t,isHorizontalRef:r}=e;return()=>r.value?null:E("div",{class:`${t.value}-menu-divider`})}}),sse=Hv($U),lse=Hv(XU),cse=Hv(YU);function cA(e){return e.type==="divider"||e.type==="render"}function dse(e){return e.type==="divider"}function NT(e,t){const{rawNode:r}=e,{show:i}=r;if(i===!1)return null;if(cA(r))return dse(r)?E(ose,Object.assign({key:e.key},r.props)):null;const{labelField:n}=t,{key:a,level:o,isGroup:s}=e,l=Object.assign(Object.assign({},r),{title:r.title||r[n],extra:r.titleExtra||r.extra,key:a,internalKey:a,level:o,root:o===0,isGroup:s});return e.children?e.isGroup?E(nse,pv(l,sse,{tmNode:e,tmNodes:e.children,key:a})):E(lA,pv(l,cse,{key:a,rawNodes:r[t.childrenField],tmNodes:e.children,tmNode:e})):E(ase,pv(l,lse,{key:a,tmNode:e}))}const JO=[ve("&::before","background-color: var(--n-item-color-hover);"),he("arrow",`
 color: var(--n-arrow-color-hover);
 `),he("icon",`
 color: var(--n-item-icon-color-hover);
 `),oe("menu-item-content-header",`
 color: var(--n-item-text-color-hover);
 `,[ve("a",`
 color: var(--n-item-text-color-hover);
 `),he("extra",`
 color: var(--n-item-text-color-hover);
 `)])],eR=[he("icon",`
 color: var(--n-item-icon-color-hover-horizontal);
 `),oe("menu-item-content-header",`
 color: var(--n-item-text-color-hover-horizontal);
 `,[ve("a",`
 color: var(--n-item-text-color-hover-horizontal);
 `),he("extra",`
 color: var(--n-item-text-color-hover-horizontal);
 `)])],use=ve([oe("menu",`
 background-color: var(--n-color);
 color: var(--n-item-text-color);
 overflow: hidden;
 transition: background-color .3s var(--n-bezier);
 box-sizing: border-box;
 font-size: var(--n-font-size);
 padding-bottom: 6px;
 `,[xe("horizontal",`
 max-width: 100%;
 width: 100%;
 display: flex;
 overflow: hidden;
 padding-bottom: 0;
 `,[oe("submenu","margin: 0;"),oe("menu-item","margin: 0;"),oe("menu-item-content",`
 padding: 0 20px;
 border-bottom: 2px solid #0000;
 `,[ve("&::before","display: none;"),xe("selected","border-bottom: 2px solid var(--n-border-color-horizontal)")]),oe("menu-item-content",[xe("selected",[he("icon","color: var(--n-item-icon-color-active-horizontal);"),oe("menu-item-content-header",`
 color: var(--n-item-text-color-active-horizontal);
 `,[ve("a","color: var(--n-item-text-color-active-horizontal);"),he("extra","color: var(--n-item-text-color-active-horizontal);")])]),xe("child-active",`
 border-bottom: 2px solid var(--n-border-color-horizontal);
 `,[oe("menu-item-content-header",`
 color: var(--n-item-text-color-child-active-horizontal);
 `,[ve("a",`
 color: var(--n-item-text-color-child-active-horizontal);
 `),he("extra",`
 color: var(--n-item-text-color-child-active-horizontal);
 `)]),he("icon",`
 color: var(--n-item-icon-color-child-active-horizontal);
 `)]),yr("disabled",[yr("selected, child-active",[ve("&:focus-within",eR)]),xe("selected",[qd(null,[he("icon","color: var(--n-item-icon-color-active-hover-horizontal);"),oe("menu-item-content-header",`
 color: var(--n-item-text-color-active-hover-horizontal);
 `,[ve("a","color: var(--n-item-text-color-active-hover-horizontal);"),he("extra","color: var(--n-item-text-color-active-hover-horizontal);")])])]),xe("child-active",[qd(null,[he("icon","color: var(--n-item-icon-color-child-active-hover-horizontal);"),oe("menu-item-content-header",`
 color: var(--n-item-text-color-child-active-hover-horizontal);
 `,[ve("a","color: var(--n-item-text-color-child-active-hover-horizontal);"),he("extra","color: var(--n-item-text-color-child-active-hover-horizontal);")])])]),qd("border-bottom: 2px solid var(--n-border-color-horizontal);",eR)]),oe("menu-item-content-header",[ve("a","color: var(--n-item-text-color-horizontal);")])])]),yr("responsive",[oe("menu-item-content-header",`
 overflow: hidden;
 text-overflow: ellipsis;
 `)]),xe("collapsed",[oe("menu-item-content",[xe("selected",[ve("&::before",`
 background-color: var(--n-item-color-active-collapsed) !important;
 `)]),oe("menu-item-content-header","opacity: 0;"),he("arrow","opacity: 0;"),he("icon","color: var(--n-item-icon-color-collapsed);")])]),oe("menu-item",`
 height: var(--n-item-height);
 margin-top: 6px;
 position: relative;
 `),oe("menu-item-content",`
 box-sizing: border-box;
 line-height: 1.75;
 height: 100%;
 display: grid;
 grid-template-areas: "icon content arrow";
 grid-template-columns: auto 1fr auto;
 align-items: center;
 cursor: pointer;
 position: relative;
 padding-right: 18px;
 transition:
 background-color .3s var(--n-bezier),
 padding-left .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 `,[ve("> *","z-index: 1;"),ve("&::before",`
 z-index: auto;
 content: "";
 background-color: #0000;
 position: absolute;
 left: 8px;
 right: 8px;
 top: 0;
 bottom: 0;
 pointer-events: none;
 border-radius: var(--n-border-radius);
 transition: background-color .3s var(--n-bezier);
 `),xe("disabled",`
 opacity: .45;
 cursor: not-allowed;
 `),xe("collapsed",[he("arrow","transform: rotate(0);")]),xe("selected",[ve("&::before","background-color: var(--n-item-color-active);"),he("arrow","color: var(--n-arrow-color-active);"),he("icon","color: var(--n-item-icon-color-active);"),oe("menu-item-content-header",`
 color: var(--n-item-text-color-active);
 `,[ve("a","color: var(--n-item-text-color-active);"),he("extra","color: var(--n-item-text-color-active);")])]),xe("child-active",[oe("menu-item-content-header",`
 color: var(--n-item-text-color-child-active);
 `,[ve("a",`
 color: var(--n-item-text-color-child-active);
 `),he("extra",`
 color: var(--n-item-text-color-child-active);
 `)]),he("arrow",`
 color: var(--n-arrow-color-child-active);
 `),he("icon",`
 color: var(--n-item-icon-color-child-active);
 `)]),yr("disabled",[yr("selected, child-active",[ve("&:focus-within",JO)]),xe("selected",[qd(null,[he("arrow","color: var(--n-arrow-color-active-hover);"),he("icon","color: var(--n-item-icon-color-active-hover);"),oe("menu-item-content-header",`
 color: var(--n-item-text-color-active-hover);
 `,[ve("a","color: var(--n-item-text-color-active-hover);"),he("extra","color: var(--n-item-text-color-active-hover);")])])]),xe("child-active",[qd(null,[he("arrow","color: var(--n-arrow-color-child-active-hover);"),he("icon","color: var(--n-item-icon-color-child-active-hover);"),oe("menu-item-content-header",`
 color: var(--n-item-text-color-child-active-hover);
 `,[ve("a","color: var(--n-item-text-color-child-active-hover);"),he("extra","color: var(--n-item-text-color-child-active-hover);")])])]),xe("selected",[qd(null,[ve("&::before","background-color: var(--n-item-color-active-hover);")])]),qd(null,JO)]),he("icon",`
 grid-area: icon;
 color: var(--n-item-icon-color);
 transition:
 color .3s var(--n-bezier),
 font-size .3s var(--n-bezier),
 margin-right .3s var(--n-bezier);
 box-sizing: content-box;
 display: inline-flex;
 align-items: center;
 justify-content: center;
 `),he("arrow",`
 grid-area: arrow;
 font-size: 16px;
 color: var(--n-arrow-color);
 transform: rotate(180deg);
 opacity: 1;
 transition:
 color .3s var(--n-bezier),
 transform 0.2s var(--n-bezier),
 opacity 0.2s var(--n-bezier);
 `),oe("menu-item-content-header",`
 grid-area: content;
 transition:
 color .3s var(--n-bezier),
 opacity .3s var(--n-bezier);
 opacity: 1;
 white-space: nowrap;
 color: var(--n-item-text-color);
 `,[ve("a",`
 outline: none;
 text-decoration: none;
 transition: color .3s var(--n-bezier);
 color: var(--n-item-text-color);
 `,[ve("&::before",`
 content: "";
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 `)]),he("extra",`
 font-size: .93em;
 color: var(--n-group-text-color);
 transition: color .3s var(--n-bezier);
 `)])]),oe("submenu",`
 cursor: pointer;
 position: relative;
 margin-top: 6px;
 `,[oe("menu-item-content",`
 height: var(--n-item-height);
 `),oe("submenu-children",`
 overflow: hidden;
 padding: 0;
 `,[eU({duration:".2s"})])]),oe("menu-item-group",[oe("menu-item-group-title",`
 margin-top: 6px;
 color: var(--n-group-text-color);
 cursor: default;
 font-size: .93em;
 height: 36px;
 display: flex;
 align-items: center;
 transition:
 padding-left .3s var(--n-bezier),
 color .3s var(--n-bezier);
 `)])]),oe("menu-tooltip",[ve("a",`
 color: inherit;
 text-decoration: none;
 `)]),oe("menu-divider",`
 transition: background-color .3s var(--n-bezier);
 background-color: var(--n-divider-color);
 height: 1px;
 margin: 6px 18px;
 `)]);function qd(e,t){return[xe("hover",e,t),ve("&:hover",e,t)]}const hse=Object.assign(Object.assign({},bt.props),{options:{type:Array,default:()=>[]},collapsed:{type:Boolean,default:void 0},collapsedWidth:{type:Number,default:48},iconSize:{type:Number,default:20},collapsedIconSize:{type:Number,default:24},rootIndent:Number,indent:{type:Number,default:32},labelField:{type:String,default:"label"},keyField:{type:String,default:"key"},childrenField:{type:String,default:"children"},disabledField:{type:String,default:"disabled"},defaultExpandAll:Boolean,defaultExpandedKeys:Array,expandedKeys:Array,value:[String,Number],defaultValue:{type:[String,Number],default:null},mode:{type:String,default:"vertical"},watchProps:{type:Array,default:void 0},disabled:Boolean,show:{type:Boolean,default:!0},inverted:Boolean,"onUpdate:expandedKeys":[Function,Array],onUpdateExpandedKeys:[Function,Array],onUpdateValue:[Function,Array],"onUpdate:value":[Function,Array],expandIcon:Function,renderIcon:Function,renderLabel:Function,renderExtra:Function,dropdownProps:Object,accordion:Boolean,nodeProps:Function,dropdownPlacement:{type:String,default:"bottom"},responsive:Boolean,items:Array,onOpenNamesChange:[Function,Array],onSelect:[Function,Array],onExpandedNamesChange:[Function,Array],expandedNames:Array,defaultExpandedNames:Array}),fse=Ve({name:"Menu",props:hse,setup(e){const{mergedClsPrefixRef:t,inlineThemeDisabled:r}=mr(e),i=bt("Menu","-menu",use,Eoe,e,t),n=_t(VU,null),a=re(()=>{var X;const{collapsed:W}=e;if(W!==void 0)return W;if(n){const{collapseModeRef:q,collapsedRef:$}=n;if(q.value==="width")return(X=$.value)!==null&&X!==void 0?X:!1}return!1}),o=re(()=>{const{keyField:X,childrenField:W,disabledField:q}=e;return Uf(e.items||e.options,{getIgnored($){return cA($)},getChildren($){return $[W]},getDisabled($){return $[q]},getKey($){var le;return(le=$[X])!==null&&le!==void 0?le:$.name}})}),s=re(()=>new Set(o.value.treeNodes.map(X=>X.key))),{watchProps:l}=e,c=ge(null);l!=null&&l.includes("defaultValue")?Qa(()=>{c.value=e.defaultValue}):c.value=e.defaultValue;const d=pt(e,"value"),u=Un(d,c),h=ge([]),f=()=>{h.value=e.defaultExpandAll?o.value.getNonLeafKeys():e.defaultExpandedNames||e.defaultExpandedKeys||o.value.getPath(u.value,{includeSelf:!1}).keyPath};l!=null&&l.includes("defaultExpandedKeys")?Qa(f):f();const p=ap(e,["expandedNames","expandedKeys"]),v=Un(p,h),m=re(()=>o.value.treeNodes),g=re(()=>o.value.getPath(u.value).keyPath);br(Fg,{props:e,mergedCollapsedRef:a,mergedThemeRef:i,mergedValueRef:u,mergedExpandedKeysRef:v,activePathRef:g,mergedClsPrefixRef:t,isHorizontalRef:re(()=>e.mode==="horizontal"),invertedRef:pt(e,"inverted"),doSelect:y,toggleExpand:x});function y(X,W){const{"onUpdate:value":q,onUpdateValue:$,onSelect:le}=e;$&&ct($,X,W),q&&ct(q,X,W),le&&ct(le,X,W),c.value=X}function b(X){const{"onUpdate:expandedKeys":W,onUpdateExpandedKeys:q,onExpandedNamesChange:$,onOpenNamesChange:le}=e;W&&ct(W,X),q&&ct(q,X),$&&ct($,X),le&&ct(le,X),h.value=X}function x(X){const W=Array.from(v.value),q=W.findIndex($=>$===X);if(~q)W.splice(q,1);else{if(e.accordion&&s.value.has(X)){const $=W.findIndex(le=>s.value.has(le));$>-1&&W.splice($,1)}W.push(X)}b(W)}const S=X=>{const W=o.value.getPath(X??u.value,{includeSelf:!1}).keyPath;if(!W.length)return;const q=Array.from(v.value),$=new Set([...q,...W]);e.accordion&&s.value.forEach(le=>{$.has(le)&&!W.includes(le)&&$.delete(le)}),b(Array.from($))},w=re(()=>{const{inverted:X}=e,{common:{cubicBezierEaseInOut:W},self:q}=i.value,{borderRadius:$,borderColorHorizontal:le,fontSize:ee,itemHeight:Q,dividerColor:ne}=q,V={"--n-divider-color":ne,"--n-bezier":W,"--n-font-size":ee,"--n-border-color-horizontal":le,"--n-border-radius":$,"--n-item-height":Q};return X?(V["--n-group-text-color"]=q.groupTextColorInverted,V["--n-color"]=q.colorInverted,V["--n-item-text-color"]=q.itemTextColorInverted,V["--n-item-text-color-hover"]=q.itemTextColorHoverInverted,V["--n-item-text-color-active"]=q.itemTextColorActiveInverted,V["--n-item-text-color-child-active"]=q.itemTextColorChildActiveInverted,V["--n-item-text-color-child-active-hover"]=q.itemTextColorChildActiveInverted,V["--n-item-text-color-active-hover"]=q.itemTextColorActiveHoverInverted,V["--n-item-icon-color"]=q.itemIconColorInverted,V["--n-item-icon-color-hover"]=q.itemIconColorHoverInverted,V["--n-item-icon-color-active"]=q.itemIconColorActiveInverted,V["--n-item-icon-color-active-hover"]=q.itemIconColorActiveHoverInverted,V["--n-item-icon-color-child-active"]=q.itemIconColorChildActiveInverted,V["--n-item-icon-color-child-active-hover"]=q.itemIconColorChildActiveHoverInverted,V["--n-item-icon-color-collapsed"]=q.itemIconColorCollapsedInverted,V["--n-item-text-color-horizontal"]=q.itemTextColorHorizontalInverted,V["--n-item-text-color-hover-horizontal"]=q.itemTextColorHoverHorizontalInverted,V["--n-item-text-color-active-horizontal"]=q.itemTextColorActiveHorizontalInverted,V["--n-item-text-color-child-active-horizontal"]=q.itemTextColorChildActiveHorizontalInverted,V["--n-item-text-color-child-active-hover-horizontal"]=q.itemTextColorChildActiveHoverHorizontalInverted,V["--n-item-text-color-active-hover-horizontal"]=q.itemTextColorActiveHoverHorizontalInverted,V["--n-item-icon-color-horizontal"]=q.itemIconColorHorizontalInverted,V["--n-item-icon-color-hover-horizontal"]=q.itemIconColorHoverHorizontalInverted,V["--n-item-icon-color-active-horizontal"]=q.itemIconColorActiveHorizontalInverted,V["--n-item-icon-color-active-hover-horizontal"]=q.itemIconColorActiveHoverHorizontalInverted,V["--n-item-icon-color-child-active-horizontal"]=q.itemIconColorChildActiveHorizontalInverted,V["--n-item-icon-color-child-active-hover-horizontal"]=q.itemIconColorChildActiveHoverHorizontalInverted,V["--n-arrow-color"]=q.arrowColorInverted,V["--n-arrow-color-hover"]=q.arrowColorHoverInverted,V["--n-arrow-color-active"]=q.arrowColorActiveInverted,V["--n-arrow-color-active-hover"]=q.arrowColorActiveHoverInverted,V["--n-arrow-color-child-active"]=q.arrowColorChildActiveInverted,V["--n-arrow-color-child-active-hover"]=q.arrowColorChildActiveHoverInverted,V["--n-item-color-hover"]=q.itemColorHoverInverted,V["--n-item-color-active"]=q.itemColorActiveInverted,V["--n-item-color-active-hover"]=q.itemColorActiveHoverInverted,V["--n-item-color-active-collapsed"]=q.itemColorActiveCollapsedInverted):(V["--n-group-text-color"]=q.groupTextColor,V["--n-color"]=q.color,V["--n-item-text-color"]=q.itemTextColor,V["--n-item-text-color-hover"]=q.itemTextColorHover,V["--n-item-text-color-active"]=q.itemTextColorActive,V["--n-item-text-color-child-active"]=q.itemTextColorChildActive,V["--n-item-text-color-child-active-hover"]=q.itemTextColorChildActiveHover,V["--n-item-text-color-active-hover"]=q.itemTextColorActiveHover,V["--n-item-icon-color"]=q.itemIconColor,V["--n-item-icon-color-hover"]=q.itemIconColorHover,V["--n-item-icon-color-active"]=q.itemIconColorActive,V["--n-item-icon-color-active-hover"]=q.itemIconColorActiveHover,V["--n-item-icon-color-child-active"]=q.itemIconColorChildActive,V["--n-item-icon-color-child-active-hover"]=q.itemIconColorChildActiveHover,V["--n-item-icon-color-collapsed"]=q.itemIconColorCollapsed,V["--n-item-text-color-horizontal"]=q.itemTextColorHorizontal,V["--n-item-text-color-hover-horizontal"]=q.itemTextColorHoverHorizontal,V["--n-item-text-color-active-horizontal"]=q.itemTextColorActiveHorizontal,V["--n-item-text-color-child-active-horizontal"]=q.itemTextColorChildActiveHorizontal,V["--n-item-text-color-child-active-hover-horizontal"]=q.itemTextColorChildActiveHoverHorizontal,V["--n-item-text-color-active-hover-horizontal"]=q.itemTextColorActiveHoverHorizontal,V["--n-item-icon-color-horizontal"]=q.itemIconColorHorizontal,V["--n-item-icon-color-hover-horizontal"]=q.itemIconColorHoverHorizontal,V["--n-item-icon-color-active-horizontal"]=q.itemIconColorActiveHorizontal,V["--n-item-icon-color-active-hover-horizontal"]=q.itemIconColorActiveHoverHorizontal,V["--n-item-icon-color-child-active-horizontal"]=q.itemIconColorChildActiveHorizontal,V["--n-item-icon-color-child-active-hover-horizontal"]=q.itemIconColorChildActiveHoverHorizontal,V["--n-arrow-color"]=q.arrowColor,V["--n-arrow-color-hover"]=q.arrowColorHover,V["--n-arrow-color-active"]=q.arrowColorActive,V["--n-arrow-color-active-hover"]=q.arrowColorActiveHover,V["--n-arrow-color-child-active"]=q.arrowColorChildActive,V["--n-arrow-color-child-active-hover"]=q.arrowColorChildActiveHover,V["--n-item-color-hover"]=q.itemColorHover,V["--n-item-color-active"]=q.itemColorActive,V["--n-item-color-active-hover"]=q.itemColorActiveHover,V["--n-item-color-active-collapsed"]=q.itemColorActiveCollapsed),V}),_=r?Dr("menu",re(()=>e.inverted?"a":"b"),w,e):void 0,C=qu(),A=ge(null),M=ge(null);let P=!0;const T=()=>{var X;P?P=!1:(X=A.value)===null||X===void 0||X.sync({showAllItemsBeforeCalculate:!0})};function R(){return document.getElementById(C)}const z=ge(-1);function F(X){z.value=e.options.length-X}function H(X){X||(z.value=-1)}const N=re(()=>{const X=z.value;return{children:X===-1?[]:e.options.slice(X)}}),U=re(()=>{const{childrenField:X,disabledField:W,keyField:q}=e;return Uf([N.value],{getIgnored($){return cA($)},getChildren($){return $[X]},getDisabled($){return $[W]},getKey($){var le;return(le=$[q])!==null&&le!==void 0?le:$.name}})}),ie=re(()=>Uf([{}]).treeNodes[0]);function te(){var X;if(z.value===-1)return E(lA,{root:!0,level:0,key:"__ellpisisGroupPlaceholder__",internalKey:"__ellpisisGroupPlaceholder__",title:"···",tmNode:ie.value,domId:C,isEllipsisPlaceholder:!0});const W=U.value.treeNodes[0],q=g.value,$=!!(!((X=W.children)===null||X===void 0)&&X.some(le=>q.includes(le.key)));return E(lA,{level:0,root:!0,key:"__ellpisisGroup__",internalKey:"__ellpisisGroup__",title:"···",virtualChildActive:$,tmNode:W,domId:C,rawNodes:W.rawNode.children||[],tmNodes:W.children||[],isEllipsisPlaceholder:!0})}return{mergedClsPrefix:t,controlledExpandedKeys:p,uncontrolledExpanededKeys:h,mergedExpandedKeys:v,uncontrolledValue:c,mergedValue:u,activePath:g,tmNodes:m,mergedTheme:i,mergedCollapsed:a,cssVars:r?void 0:w,themeClass:_==null?void 0:_.themeClass,overflowRef:A,counterRef:M,updateCounter:()=>{},onResize:T,onUpdateOverflow:H,onUpdateCount:F,renderCounter:te,getCounter:R,onRender:_==null?void 0:_.onRender,showOption:S,deriveResponsiveState:T}},render(){const{mergedClsPrefix:e,mode:t,themeClass:r,onRender:i}=this;i==null||i();const n=()=>this.tmNodes.map(l=>NT(l,this.$props)),o=t==="horizontal"&&this.responsive,s=()=>E("div",{role:t==="horizontal"?"menubar":"menu",class:[`${e}-menu`,r,`${e}-menu--${t}`,o&&`${e}-menu--responsive`,this.mergedCollapsed&&`${e}-menu--collapsed`],style:this.cssVars},o?E(J_,{ref:"overflowRef",onUpdateOverflow:this.onUpdateOverflow,getCounter:this.getCounter,onUpdateCount:this.onUpdateCount,updateCounter:this.updateCounter,style:{width:"100%",display:"flex",overflow:"hidden"}},{default:n,counter:this.renderCounter}):n());return o?E(Ks,{onResize:this.onResize},{default:s}):s()}}),KU={icon:Function,type:{type:String,default:"info"},content:[String,Number,Function],showIcon:{type:Boolean,default:!0},closable:Boolean,keepAliveOnHover:Boolean,onClose:Function,onMouseenter:Function,onMouseleave:Function},QU="n-message-api",ZU="n-message-provider",pse=ve([oe("message-wrapper",`
 margin: var(--n-margin);
 z-index: 0;
 transform-origin: top center;
 display: flex;
 `,[eU({overflow:"visible",originalTransition:"transform .3s var(--n-bezier)",enterToProps:{transform:"scale(1)"},leaveToProps:{transform:"scale(0.85)"}})]),oe("message",`
 box-sizing: border-box;
 display: flex;
 align-items: center;
 transition:
 color .3s var(--n-bezier),
 box-shadow .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 opacity .3s var(--n-bezier),
 transform .3s var(--n-bezier),
 margin-bottom .3s var(--n-bezier);
 padding: var(--n-padding);
 border-radius: var(--n-border-radius);
 flex-wrap: nowrap;
 overflow: hidden;
 max-width: var(--n-max-width);
 color: var(--n-text-color);
 background-color: var(--n-color);
 box-shadow: var(--n-box-shadow);
 `,[he("content",`
 display: inline-block;
 line-height: var(--n-line-height);
 font-size: var(--n-font-size);
 `),he("icon",`
 position: relative;
 margin: var(--n-icon-margin);
 height: var(--n-icon-size);
 width: var(--n-icon-size);
 font-size: var(--n-icon-size);
 flex-shrink: 0;
 `,[["default","info","success","warning","error","loading"].map(e=>xe(`${e}-type`,[ve("> *",`
 color: var(--n-icon-color-${e});
 transition: color .3s var(--n-bezier);
 `)])),ve("> *",`
 position: absolute;
 left: 0;
 top: 0;
 right: 0;
 bottom: 0;
 `,[Sd()])]),he("close",`
 margin: var(--n-close-margin);
 transition:
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
 flex-shrink: 0;
 `,[ve("&:hover",`
 color: var(--n-close-icon-color-hover);
 `),ve("&:active",`
 color: var(--n-close-icon-color-pressed);
 `)])]),oe("message-container",`
 z-index: 6000;
 position: fixed;
 height: 0;
 overflow: visible;
 display: flex;
 flex-direction: column;
 align-items: center;
 `,[xe("top",`
 top: 12px;
 left: 0;
 right: 0;
 `),xe("top-left",`
 top: 12px;
 left: 12px;
 right: 0;
 align-items: flex-start;
 `),xe("top-right",`
 top: 12px;
 left: 0;
 right: 12px;
 align-items: flex-end;
 `),xe("bottom",`
 bottom: 4px;
 left: 0;
 right: 0;
 justify-content: flex-end;
 `),xe("bottom-left",`
 bottom: 4px;
 left: 12px;
 right: 0;
 justify-content: flex-end;
 align-items: flex-start;
 `),xe("bottom-right",`
 bottom: 4px;
 left: 0;
 right: 12px;
 justify-content: flex-end;
 align-items: flex-end;
 `)])]),mse={info:()=>E(Ree,null),success:()=>E(kee,null),warning:()=>E(Bee,null),error:()=>E(Oee,null),default:()=>null},vse=Ve({name:"Message",props:Object.assign(Object.assign({},KU),{render:Function}),setup(e){const{inlineThemeDisabled:t,mergedRtlRef:r}=mr(e),{props:i,mergedClsPrefixRef:n}=_t(ZU),a=Ja("Message",r,n),o=bt("Message","-message",pse,woe,i,n),s=re(()=>{const{type:c}=e,{common:{cubicBezierEaseInOut:d},self:{padding:u,margin:h,maxWidth:f,iconMargin:p,closeMargin:v,closeSize:m,iconSize:g,fontSize:y,lineHeight:b,borderRadius:x,iconColorInfo:S,iconColorSuccess:w,iconColorWarning:_,iconColorError:C,iconColorLoading:A,closeIconSize:M,closeBorderRadius:P,[Ze("textColor",c)]:T,[Ze("boxShadow",c)]:R,[Ze("color",c)]:z,[Ze("closeColorHover",c)]:F,[Ze("closeColorPressed",c)]:H,[Ze("closeIconColor",c)]:N,[Ze("closeIconColorPressed",c)]:U,[Ze("closeIconColorHover",c)]:ie}}=o.value;return{"--n-bezier":d,"--n-margin":h,"--n-padding":u,"--n-max-width":f,"--n-font-size":y,"--n-icon-margin":p,"--n-icon-size":g,"--n-close-icon-size":M,"--n-close-border-radius":P,"--n-close-size":m,"--n-close-margin":v,"--n-text-color":T,"--n-color":z,"--n-box-shadow":R,"--n-icon-color-info":S,"--n-icon-color-success":w,"--n-icon-color-warning":_,"--n-icon-color-error":C,"--n-icon-color-loading":A,"--n-close-color-hover":F,"--n-close-color-pressed":H,"--n-close-icon-color":N,"--n-close-icon-color-pressed":U,"--n-close-icon-color-hover":ie,"--n-line-height":b,"--n-border-radius":x}}),l=t?Dr("message",re(()=>e.type[0]),s,{}):void 0;return{mergedClsPrefix:n,rtlEnabled:a,messageProviderProps:i,handleClose(){var c;(c=e.onClose)===null||c===void 0||c.call(e)},cssVars:t?void 0:s,themeClass:l==null?void 0:l.themeClass,onRender:l==null?void 0:l.onRender,placement:i.placement}},render(){const{render:e,type:t,closable:r,content:i,mergedClsPrefix:n,cssVars:a,themeClass:o,onRender:s,icon:l,handleClose:c,showIcon:d}=this;s==null||s();let u;return E("div",{class:[`${n}-message-wrapper`,o],onMouseenter:this.onMouseenter,onMouseleave:this.onMouseleave,style:[{alignItems:this.placement.startsWith("top")?"flex-start":"flex-end"},a]},e?e(this.$props):E("div",{class:[`${n}-message ${n}-message--${t}-type`,this.rtlEnabled&&`${n}-message--rtl`]},(u=gse(l,t,n))&&d?E("div",{class:`${n}-message__icon ${n}-message__icon--${t}-type`},E(zp,null,{default:()=>u})):null,E("div",{class:`${n}-message__content`},kn(i)),r?E(O1,{clsPrefix:n,class:`${n}-message__close`,onClick:c,absolute:!0}):null))}});function gse(e,t,r){if(typeof e=="function")return e();{const i=t==="loading"?E(Ig,{clsPrefix:r,strokeWidth:24,scale:.85}):mse[t]();return i?E(Li,{clsPrefix:r,key:t},{default:()=>i}):null}}const yse=Ve({name:"MessageEnvironment",props:Object.assign(Object.assign({},KU),{duration:{type:Number,default:3e3},onAfterLeave:Function,onLeave:Function,internalKey:{type:String,required:!0},onInternalAfterLeave:Function,onHide:Function,onAfterHide:Function}),setup(e){let t=null;const r=ge(!0);Or(()=>{i()});function i(){const{duration:d}=e;d&&(t=window.setTimeout(o,d))}function n(d){d.currentTarget===d.target&&t!==null&&(window.clearTimeout(t),t=null)}function a(d){d.currentTarget===d.target&&i()}function o(){const{onHide:d}=e;r.value=!1,t&&(window.clearTimeout(t),t=null),d&&d()}function s(){const{onClose:d}=e;d&&d(),o()}function l(){const{onAfterLeave:d,onInternalAfterLeave:u,onAfterHide:h,internalKey:f}=e;d&&d(),u&&u(f),h&&h()}function c(){o()}return{show:r,hide:o,handleClose:s,handleAfterLeave:l,handleMouseleave:a,handleMouseenter:n,deactivate:c}},render(){return E(xT,{appear:!0,onAfterLeave:this.handleAfterLeave,onLeave:this.onLeave},{default:()=>[this.show?E(vse,{content:this.content,type:this.type,icon:this.icon,showIcon:this.showIcon,closable:this.closable,onClose:this.handleClose,onMouseenter:this.keepAliveOnHover?this.handleMouseenter:void 0,onMouseleave:this.keepAliveOnHover?this.handleMouseleave:void 0}):null]})}}),bse=Object.assign(Object.assign({},bt.props),{to:[String,Object],duration:{type:Number,default:3e3},keepAliveOnHover:Boolean,max:Number,placement:{type:String,default:"top"},closable:Boolean,containerClass:String,containerStyle:[String,Object]}),xse=Ve({name:"MessageProvider",props:bse,setup(e){const{mergedClsPrefixRef:t}=mr(e),r=ge([]),i=ge({}),n={create(l,c){return a(l,Object.assign({type:"default"},c))},info(l,c){return a(l,Object.assign(Object.assign({},c),{type:"info"}))},success(l,c){return a(l,Object.assign(Object.assign({},c),{type:"success"}))},warning(l,c){return a(l,Object.assign(Object.assign({},c),{type:"warning"}))},error(l,c){return a(l,Object.assign(Object.assign({},c),{type:"error"}))},loading(l,c){return a(l,Object.assign(Object.assign({},c),{type:"loading"}))},destroyAll:s};br(ZU,{props:e,mergedClsPrefixRef:t}),br(QU,n);function a(l,c){const d=qu(),u=Dd(Object.assign(Object.assign({},c),{content:l,key:d,destroy:()=>{var f;(f=i.value[d])===null||f===void 0||f.hide()}})),{max:h}=e;return h&&r.value.length>=h&&r.value.shift(),r.value.push(u),u}function o(l){r.value.splice(r.value.findIndex(c=>c.key===l),1),delete i.value[l]}function s(){Object.values(i.value).forEach(l=>{l.hide()})}return Object.assign({mergedClsPrefix:t,messageRefs:i,messageList:r,handleAfterLeave:o},n)},render(){var e,t,r;return E(pr,null,(t=(e=this.$slots).default)===null||t===void 0?void 0:t.call(e),this.messageList.length?E(a5,{to:(r=this.to)!==null&&r!==void 0?r:"body"},E("div",{class:[`${this.mergedClsPrefix}-message-container`,`${this.mergedClsPrefix}-message-container--${this.placement}`,this.containerClass],key:"message-container",style:this.containerStyle},this.messageList.map(i=>E(yse,Object.assign({ref:n=>{n&&(this.messageRefs[i.key]=n)},internalKey:i.key,onInternalAfterLeave:this.handleAfterLeave},_5(i,["destroy"],void 0),{duration:i.duration===void 0?this.duration:i.duration,keepAliveOnHover:i.keepAliveOnHover===void 0?this.keepAliveOnHover:i.keepAliveOnHover,closable:i.closable===void 0?this.closable:i.closable}))))):null)}});function UT(){const e=_t(QU,null);return e===null&&C1("use-message","No outer <n-message-provider /> founded. See prerequisite in https://www.naiveui.com/en-US/os-theme/components/message for more details. If you want to use `useMessage` outside setup, please check https://www.naiveui.com/zh-CN/os-theme/components/message#Q-&-A."),e}const wse=ve([oe("page-header-header",`
 margin-bottom: 20px;
 `),oe("page-header",`
 display: flex;
 align-items: center;
 justify-content: space-between;
 line-height: 1.5;
 font-size: var(--n-font-size);
 `,[he("main",`
 display: flex;
 flex-wrap: nowrap;
 align-items: center;
 `),he("back",`
 display: flex;
 margin-right: 16px;
 font-size: var(--n-back-size);
 cursor: pointer;
 color: var(--n-back-color);
 transition: color .3s var(--n-bezier);
 `,[ve("&:hover","color: var(--n-back-color-hover);"),ve("&:active","color: var(--n-back-color-pressed);")]),he("avatar",`
 display: flex;
 margin-right: 12px
 `),he("title",`
 margin-right: 16px;
 transition: color .3s var(--n-bezier);
 font-size: var(--n-title-font-size);
 font-weight: var(--n-title-font-weight);
 color: var(--n-title-text-color);
 `),he("subtitle",`
 font-size: 14px;
 transition: color .3s var(--n-bezier);
 color: var(--n-subtitle-text-color);
 `)]),oe("page-header-content",`
 font-size: var(--n-font-size);
 `,[ve("&:not(:first-child)","margin-top: 20px;")]),oe("page-header-footer",`
 font-size: var(--n-font-size);
 `,[ve("&:not(:first-child)","margin-top: 20px;")])]),Sse=Object.assign(Object.assign({},bt.props),{title:String,subtitle:String,extra:String,onBack:Function}),Cse=Ve({name:"PageHeader",props:Sse,setup(e){const{mergedClsPrefixRef:t,mergedRtlRef:r,inlineThemeDisabled:i}=mr(e),n=bt("PageHeader","-page-header",wse,Doe,e,t),a=Ja("PageHeader",r,t),o=re(()=>{const{self:{titleTextColor:l,subtitleTextColor:c,backColor:d,fontSize:u,titleFontSize:h,backSize:f,titleFontWeight:p,backColorHover:v,backColorPressed:m},common:{cubicBezierEaseInOut:g}}=n.value;return{"--n-title-text-color":l,"--n-title-font-size":h,"--n-title-font-weight":p,"--n-font-size":u,"--n-back-size":f,"--n-subtitle-text-color":c,"--n-back-color":d,"--n-back-color-hover":v,"--n-back-color-pressed":m,"--n-bezier":g}}),s=i?Dr("page-header",void 0,o,e):void 0;return{rtlEnabled:a,mergedClsPrefix:t,cssVars:i?void 0:o,themeClass:s==null?void 0:s.themeClass,onRender:s==null?void 0:s.onRender}},render(){var e;const{onBack:t,title:r,subtitle:i,extra:n,mergedClsPrefix:a,cssVars:o,$slots:s}=this;(e=this.onRender)===null||e===void 0||e.call(this);const{title:l,subtitle:c,extra:d,default:u,header:h,avatar:f,footer:p,back:v}=s,m=t,g=r||l,y=i||c,b=n||d;return E("div",{style:o,class:[`${a}-page-header-wrapper`,this.themeClass,this.rtlEnabled&&`${a}-page-header-wrapper--rtl`]},h?E("div",{class:`${a}-page-header-header`,key:"breadcrumb"},h()):null,(m||f||g||y||b)&&E("div",{class:`${a}-page-header`,key:"header"},E("div",{class:`${a}-page-header__main`,key:"back"},m?E("div",{class:`${a}-page-header__back`,onClick:t},v?v():E(Li,{clsPrefix:a},{default:()=>E(Vee,null)})):null,f?E("div",{class:`${a}-page-header__avatar`},f()):null,g?E("div",{class:`${a}-page-header__title`,key:"title"},r||l()):null,y?E("div",{class:`${a}-page-header__subtitle`,key:"subtitle"},i||c()):null),b?E("div",{class:`${a}-page-header__extra`},n||d()):null),u?E("div",{class:`${a}-page-header-content`,key:"content"},u()):null,p?E("div",{class:`${a}-page-header-footer`,key:"footer"},p()):null)}}),_se=Object.assign(Object.assign({},bt.props),{trigger:String,xScrollable:Boolean,onScroll:Function,contentClass:String,contentStyle:[Object,String],size:Number}),Ase=Ve({name:"Scrollbar",props:_se,setup(){const e=ge(null);return Object.assign(Object.assign({},{scrollTo:(...r)=>{var i;(i=e.value)===null||i===void 0||i.scrollTo(r[0],r[1])},scrollBy:(...r)=>{var i;(i=e.value)===null||i===void 0||i.scrollBy(r[0],r[1])}}),{scrollbarInstRef:e})},render(){return E(bn,Object.assign({ref:"scrollbarInstRef"},this.$props),this.$slots)}}),Mse=oe("statistic",[he("label",`
 font-weight: var(--n-label-font-weight);
 transition: .3s color var(--n-bezier);
 font-size: var(--n-label-font-size);
 color: var(--n-label-text-color);
 `),oe("statistic-value",`
 margin-top: 4px;
 font-weight: var(--n-value-font-weight);
 `,[he("prefix",`
 margin: 0 4px 0 0;
 font-size: var(--n-value-font-size);
 transition: .3s color var(--n-bezier);
 color: var(--n-value-prefix-text-color);
 `,[oe("icon",{verticalAlign:"-0.125em"})]),he("content",`
 font-size: var(--n-value-font-size);
 transition: .3s color var(--n-bezier);
 color: var(--n-value-text-color);
 `),he("suffix",`
 margin: 0 0 0 4px;
 font-size: var(--n-value-font-size);
 transition: .3s color var(--n-bezier);
 color: var(--n-value-suffix-text-color);
 `,[oe("icon",{verticalAlign:"-0.125em"})])])]),Ese=Object.assign(Object.assign({},bt.props),{tabularNums:Boolean,label:String,value:[String,Number]}),mS=Ve({name:"Statistic",props:Ese,setup(e){const{mergedClsPrefixRef:t,inlineThemeDisabled:r,mergedRtlRef:i}=mr(e),n=bt("Statistic","-statistic",Mse,Roe,e,t),a=Ja("Statistic",i,t),o=re(()=>{const{self:{labelFontWeight:l,valueFontSize:c,valueFontWeight:d,valuePrefixTextColor:u,labelTextColor:h,valueSuffixTextColor:f,valueTextColor:p,labelFontSize:v},common:{cubicBezierEaseInOut:m}}=n.value;return{"--n-bezier":m,"--n-label-font-size":v,"--n-label-font-weight":l,"--n-label-text-color":h,"--n-value-font-weight":d,"--n-value-font-size":c,"--n-value-prefix-text-color":u,"--n-value-suffix-text-color":f,"--n-value-text-color":p}}),s=r?Dr("statistic",void 0,o,e):void 0;return{rtlEnabled:a,mergedClsPrefix:t,cssVars:r?void 0:o,themeClass:s==null?void 0:s.themeClass,onRender:s==null?void 0:s.onRender}},render(){var e;const{mergedClsPrefix:t,$slots:{default:r,label:i,prefix:n,suffix:a}}=this;return(e=this.onRender)===null||e===void 0||e.call(this),E("div",{class:[`${t}-statistic`,this.themeClass,this.rtlEnabled&&`${t}-statistic--rtl`],style:this.cssVars},ei(i,o=>E("div",{class:`${t}-statistic__label`},this.label||o)),E("div",{class:`${t}-statistic-value`,style:{fontVariantNumeric:this.tabularNums?"tabular-nums":""}},ei(n,o=>o&&E("span",{class:`${t}-statistic-value__prefix`},o)),this.value!==void 0?E("span",{class:`${t}-statistic-value__content`},this.value):ei(r,o=>o&&E("span",{class:`${t}-statistic-value__content`},o)),ei(a,o=>o&&E("span",{class:`${t}-statistic-value__suffix`},o))))}}),Tse=oe("switch",`
 height: var(--n-height);
 min-width: var(--n-width);
 vertical-align: middle;
 user-select: none;
 -webkit-user-select: none;
 display: inline-flex;
 outline: none;
 justify-content: center;
 align-items: center;
`,[he("children-placeholder",`
 height: var(--n-rail-height);
 display: flex;
 flex-direction: column;
 overflow: hidden;
 pointer-events: none;
 visibility: hidden;
 `),he("rail-placeholder",`
 display: flex;
 flex-wrap: none;
 `),he("button-placeholder",`
 width: calc(1.75 * var(--n-rail-height));
 height: var(--n-rail-height);
 `),oe("base-loading",`
 position: absolute;
 top: 50%;
 left: 50%;
 transform: translateX(-50%) translateY(-50%);
 font-size: calc(var(--n-button-width) - 4px);
 color: var(--n-loading-color);
 transition: color .3s var(--n-bezier);
 `,[Sd({left:"50%",top:"50%",originalTransform:"translateX(-50%) translateY(-50%)"})]),he("checked, unchecked",`
 transition: color .3s var(--n-bezier);
 color: var(--n-text-color);
 box-sizing: border-box;
 position: absolute;
 white-space: nowrap;
 top: 0;
 bottom: 0;
 display: flex;
 align-items: center;
 line-height: 1;
 `),he("checked",`
 right: 0;
 padding-right: calc(1.25 * var(--n-rail-height) - var(--n-offset));
 `),he("unchecked",`
 left: 0;
 justify-content: flex-end;
 padding-left: calc(1.25 * var(--n-rail-height) - var(--n-offset));
 `),ve("&:focus",[he("rail",`
 box-shadow: var(--n-box-shadow-focus);
 `)]),xe("round",[he("rail","border-radius: calc(var(--n-rail-height) / 2);",[he("button","border-radius: calc(var(--n-button-height) / 2);")])]),yr("disabled",[yr("icon",[xe("rubber-band",[xe("pressed",[he("rail",[he("button","max-width: var(--n-button-width-pressed);")])]),he("rail",[ve("&:active",[he("button","max-width: var(--n-button-width-pressed);")])]),xe("active",[xe("pressed",[he("rail",[he("button","left: calc(100% - var(--n-offset) - var(--n-button-width-pressed));")])]),he("rail",[ve("&:active",[he("button","left: calc(100% - var(--n-offset) - var(--n-button-width-pressed));")])])])])])]),xe("active",[he("rail",[he("button","left: calc(100% - var(--n-button-width) - var(--n-offset))")])]),he("rail",`
 overflow: hidden;
 height: var(--n-rail-height);
 min-width: var(--n-rail-width);
 border-radius: var(--n-rail-border-radius);
 cursor: pointer;
 position: relative;
 transition:
 opacity .3s var(--n-bezier),
 background .3s var(--n-bezier),
 box-shadow .3s var(--n-bezier);
 background-color: var(--n-rail-color);
 `,[he("button-icon",`
 color: var(--n-icon-color);
 transition: color .3s var(--n-bezier);
 font-size: calc(var(--n-button-height) - 4px);
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 display: flex;
 justify-content: center;
 align-items: center;
 line-height: 1;
 `,[Sd()]),he("button",`
 align-items: center; 
 top: var(--n-offset);
 left: var(--n-offset);
 height: var(--n-button-height);
 width: var(--n-button-width-pressed);
 max-width: var(--n-button-width);
 border-radius: var(--n-button-border-radius);
 background-color: var(--n-button-color);
 box-shadow: var(--n-button-box-shadow);
 box-sizing: border-box;
 cursor: inherit;
 content: "";
 position: absolute;
 transition:
 background-color .3s var(--n-bezier),
 left .3s var(--n-bezier),
 opacity .3s var(--n-bezier),
 max-width .3s var(--n-bezier),
 box-shadow .3s var(--n-bezier);
 `)]),xe("active",[he("rail","background-color: var(--n-rail-color-active);")]),xe("loading",[he("rail",`
 cursor: wait;
 `)]),xe("disabled",[he("rail",`
 cursor: not-allowed;
 opacity: .5;
 `)])]),Pse=Object.assign(Object.assign({},bt.props),{size:{type:String,default:"medium"},value:{type:[String,Number,Boolean],default:void 0},loading:Boolean,defaultValue:{type:[String,Number,Boolean],default:!1},disabled:{type:Boolean,default:void 0},round:{type:Boolean,default:!0},"onUpdate:value":[Function,Array],onUpdateValue:[Function,Array],checkedValue:{type:[String,Number,Boolean],default:!0},uncheckedValue:{type:[String,Number,Boolean],default:!1},railStyle:Function,rubberBand:{type:Boolean,default:!0},onChange:[Function,Array]});let hm;const tR=Ve({name:"Switch",props:Pse,setup(e){hm===void 0&&(typeof CSS<"u"?typeof CSS.supports<"u"?hm=CSS.supports("width","max(1px)"):hm=!1:hm=!0);const{mergedClsPrefixRef:t,inlineThemeDisabled:r}=mr(e),i=bt("Switch","-switch",Tse,koe,e,t),n=cl(e),{mergedSizeRef:a,mergedDisabledRef:o}=n,s=ge(e.defaultValue),l=pt(e,"value"),c=Un(l,s),d=re(()=>c.value===e.checkedValue),u=ge(!1),h=ge(!1),f=re(()=>{const{railStyle:C}=e;if(C)return C({focused:h.value,checked:d.value})});function p(C){const{"onUpdate:value":A,onChange:M,onUpdateValue:P}=e,{nTriggerFormInput:T,nTriggerFormChange:R}=n;A&&ct(A,C),P&&ct(P,C),M&&ct(M,C),s.value=C,T(),R()}function v(){const{nTriggerFormFocus:C}=n;C()}function m(){const{nTriggerFormBlur:C}=n;C()}function g(){e.loading||o.value||(c.value!==e.checkedValue?p(e.checkedValue):p(e.uncheckedValue))}function y(){h.value=!0,v()}function b(){h.value=!1,m(),u.value=!1}function x(C){e.loading||o.value||C.key===" "&&(c.value!==e.checkedValue?p(e.checkedValue):p(e.uncheckedValue),u.value=!1)}function S(C){e.loading||o.value||C.key===" "&&(C.preventDefault(),u.value=!0)}const w=re(()=>{const{value:C}=a,{self:{opacityDisabled:A,railColor:M,railColorActive:P,buttonBoxShadow:T,buttonColor:R,boxShadowFocus:z,loadingColor:F,textColor:H,iconColor:N,[Ze("buttonHeight",C)]:U,[Ze("buttonWidth",C)]:ie,[Ze("buttonWidthPressed",C)]:te,[Ze("railHeight",C)]:X,[Ze("railWidth",C)]:W,[Ze("railBorderRadius",C)]:q,[Ze("buttonBorderRadius",C)]:$},common:{cubicBezierEaseInOut:le}}=i.value;let ee,Q,ne;return hm?(ee=`calc((${X} - ${U}) / 2)`,Q=`max(${X}, ${U})`,ne=`max(${W}, calc(${W} + ${U} - ${X}))`):(ee=gu((rn(X)-rn(U))/2),Q=gu(Math.max(rn(X),rn(U))),ne=rn(X)>rn(U)?W:gu(rn(W)+rn(U)-rn(X))),{"--n-bezier":le,"--n-button-border-radius":$,"--n-button-box-shadow":T,"--n-button-color":R,"--n-button-width":ie,"--n-button-width-pressed":te,"--n-button-height":U,"--n-height":Q,"--n-offset":ee,"--n-opacity-disabled":A,"--n-rail-border-radius":q,"--n-rail-color":M,"--n-rail-color-active":P,"--n-rail-height":X,"--n-rail-width":W,"--n-width":ne,"--n-box-shadow-focus":z,"--n-loading-color":F,"--n-text-color":H,"--n-icon-color":N}}),_=r?Dr("switch",re(()=>a.value[0]),w,e):void 0;return{handleClick:g,handleBlur:b,handleFocus:y,handleKeyup:x,handleKeydown:S,mergedRailStyle:f,pressed:u,mergedClsPrefix:t,mergedValue:c,checked:d,mergedDisabled:o,cssVars:r?void 0:w,themeClass:_==null?void 0:_.themeClass,onRender:_==null?void 0:_.onRender}},render(){const{mergedClsPrefix:e,mergedDisabled:t,checked:r,mergedRailStyle:i,onRender:n,$slots:a}=this;n==null||n();const{checked:o,unchecked:s,icon:l,"checked-icon":c,"unchecked-icon":d}=a,u=!(Bf(l)&&Bf(c)&&Bf(d));return E("div",{role:"switch","aria-checked":r,class:[`${e}-switch`,this.themeClass,u&&`${e}-switch--icon`,r&&`${e}-switch--active`,t&&`${e}-switch--disabled`,this.round&&`${e}-switch--round`,this.loading&&`${e}-switch--loading`,this.pressed&&`${e}-switch--pressed`,this.rubberBand&&`${e}-switch--rubber-band`],tabindex:this.mergedDisabled?void 0:0,style:this.cssVars,onClick:this.handleClick,onFocus:this.handleFocus,onBlur:this.handleBlur,onKeyup:this.handleKeyup,onKeydown:this.handleKeydown},E("div",{class:`${e}-switch__rail`,"aria-hidden":"true",style:i},ei(o,h=>ei(s,f=>h||f?E("div",{"aria-hidden":!0,class:`${e}-switch__children-placeholder`},E("div",{class:`${e}-switch__rail-placeholder`},E("div",{class:`${e}-switch__button-placeholder`}),h),E("div",{class:`${e}-switch__rail-placeholder`},E("div",{class:`${e}-switch__button-placeholder`}),f)):null)),E("div",{class:`${e}-switch__button`},ei(l,h=>ei(c,f=>ei(d,p=>E(zp,null,{default:()=>this.loading?E(Ig,{key:"loading",clsPrefix:e,strokeWidth:20}):this.checked&&(f||h)?E("div",{class:`${e}-switch__button-icon`,key:f?"checked-icon":"icon"},f||h):!this.checked&&(p||h)?E("div",{class:`${e}-switch__button-icon`,key:p?"unchecked-icon":"icon"},p||h):null})))),ei(o,h=>h&&E("div",{key:"checked",class:`${e}-switch__checked`},h)),ei(s,h=>h&&E("div",{key:"unchecked",class:`${e}-switch__unchecked`},h)))))}}),jT="n-tabs",JU={tab:[String,Number,Object,Function],name:{type:[String,Number],required:!0},disabled:Boolean,displayDirective:{type:String,default:"if"},closable:{type:Boolean,default:void 0},tabProps:Object,label:[String,Number,Object,Function]},ix=Ve({__TAB_PANE__:!0,name:"TabPane",alias:["TabPanel"],props:JU,setup(e){const t=_t(jT,null);return t||C1("tab-pane","`n-tab-pane` must be placed inside `n-tabs`."),{style:t.paneStyleRef,class:t.paneClassRef,mergedClsPrefix:t.mergedClsPrefixRef}},render(){return E("div",{class:[`${this.mergedClsPrefix}-tab-pane`,this.class],style:this.style},this.$slots)}}),Dse=Object.assign({internalLeftPadded:Boolean,internalAddable:Boolean,internalCreatedByPane:Boolean},_5(JU,["displayDirective"])),dA=Ve({__TAB__:!0,inheritAttrs:!1,name:"Tab",props:Dse,setup(e){const{mergedClsPrefixRef:t,valueRef:r,typeRef:i,closableRef:n,tabStyleRef:a,addTabStyleRef:o,tabClassRef:s,addTabClassRef:l,tabChangeIdRef:c,onBeforeLeaveRef:d,triggerRef:u,handleAdd:h,activateTab:f,handleClose:p}=_t(jT);return{trigger:u,mergedClosable:re(()=>{if(e.internalAddable)return!1;const{closable:v}=e;return v===void 0?n.value:v}),style:a,addStyle:o,tabClass:s,addTabClass:l,clsPrefix:t,value:r,type:i,handleClose(v){v.stopPropagation(),!e.disabled&&p(e.name)},activateTab(){if(e.disabled)return;if(e.internalAddable){h();return}const{name:v}=e,m=++c.id;if(v!==r.value){const{value:g}=d;g?Promise.resolve(g(e.name,r.value)).then(y=>{y&&c.id===m&&f(v)}):f(v)}}}},render(){const{internalAddable:e,clsPrefix:t,name:r,disabled:i,label:n,tab:a,value:o,mergedClosable:s,trigger:l,$slots:{default:c}}=this,d=n??a;return E("div",{class:`${t}-tabs-tab-wrapper`},this.internalLeftPadded?E("div",{class:`${t}-tabs-tab-pad`}):null,E("div",Object.assign({key:r,"data-name":r,"data-disabled":i?!0:void 0},Rd({class:[`${t}-tabs-tab`,o===r&&`${t}-tabs-tab--active`,i&&`${t}-tabs-tab--disabled`,s&&`${t}-tabs-tab--closable`,e&&`${t}-tabs-tab--addable`,e?this.addTabClass:this.tabClass],onClick:l==="click"?this.activateTab:void 0,onMouseenter:l==="hover"?this.activateTab:void 0,style:e?this.addStyle:this.style},this.internalCreatedByPane?this.tabProps||{}:this.$attrs)),E("span",{class:`${t}-tabs-tab__label`},e?E(pr,null,E("div",{class:`${t}-tabs-tab__height-placeholder`}," "),E(Li,{clsPrefix:t},{default:()=>E(h2,null)})):c?c():typeof d=="object"?d:kn(d??r)),s&&this.type==="card"?E(O1,{clsPrefix:t,class:`${t}-tabs-tab__close`,onClick:this.handleClose,disabled:i}):null))}}),Ose=oe("tabs",`
 box-sizing: border-box;
 width: 100%;
 display: flex;
 flex-direction: column;
 transition:
 background-color .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
`,[xe("segment-type",[oe("tabs-rail",[ve("&.transition-disabled",[oe("tabs-capsule",`
 transition: none;
 `)])])]),xe("top",[oe("tab-pane",`
 padding: var(--n-pane-padding-top) var(--n-pane-padding-right) var(--n-pane-padding-bottom) var(--n-pane-padding-left);
 `)]),xe("left",[oe("tab-pane",`
 padding: var(--n-pane-padding-right) var(--n-pane-padding-bottom) var(--n-pane-padding-left) var(--n-pane-padding-top);
 `)]),xe("left, right",`
 flex-direction: row;
 `,[oe("tabs-bar",`
 width: 2px;
 right: 0;
 transition:
 top .2s var(--n-bezier),
 max-height .2s var(--n-bezier),
 background-color .3s var(--n-bezier);
 `),oe("tabs-tab",`
 padding: var(--n-tab-padding-vertical); 
 `)]),xe("right",`
 flex-direction: row-reverse;
 `,[oe("tab-pane",`
 padding: var(--n-pane-padding-left) var(--n-pane-padding-top) var(--n-pane-padding-right) var(--n-pane-padding-bottom);
 `),oe("tabs-bar",`
 left: 0;
 `)]),xe("bottom",`
 flex-direction: column-reverse;
 justify-content: flex-end;
 `,[oe("tab-pane",`
 padding: var(--n-pane-padding-bottom) var(--n-pane-padding-right) var(--n-pane-padding-top) var(--n-pane-padding-left);
 `),oe("tabs-bar",`
 top: 0;
 `)]),oe("tabs-rail",`
 position: relative;
 padding: 3px;
 border-radius: var(--n-tab-border-radius);
 width: 100%;
 background-color: var(--n-color-segment);
 transition: background-color .3s var(--n-bezier);
 display: flex;
 align-items: center;
 `,[oe("tabs-capsule",`
 border-radius: var(--n-tab-border-radius);
 position: absolute;
 pointer-events: none;
 background-color: var(--n-tab-color-segment);
 box-shadow: 0 1px 3px 0 rgba(0, 0, 0, .08);
 transition: transform 0.3s var(--n-bezier);
 `),oe("tabs-tab-wrapper",`
 flex-basis: 0;
 flex-grow: 1;
 display: flex;
 align-items: center;
 justify-content: center;
 `,[oe("tabs-tab",`
 overflow: hidden;
 border-radius: var(--n-tab-border-radius);
 width: 100%;
 display: flex;
 align-items: center;
 justify-content: center;
 `,[xe("active",`
 font-weight: var(--n-font-weight-strong);
 color: var(--n-tab-text-color-active);
 `),ve("&:hover",`
 color: var(--n-tab-text-color-hover);
 `)])])]),xe("flex",[oe("tabs-nav",`
 width: 100%;
 position: relative;
 `,[oe("tabs-wrapper",`
 width: 100%;
 `,[oe("tabs-tab",`
 margin-right: 0;
 `)])])]),oe("tabs-nav",`
 box-sizing: border-box;
 line-height: 1.5;
 display: flex;
 transition: border-color .3s var(--n-bezier);
 `,[he("prefix, suffix",`
 display: flex;
 align-items: center;
 `),he("prefix","padding-right: 16px;"),he("suffix","padding-left: 16px;")]),xe("top, bottom",[oe("tabs-nav-scroll-wrapper",[ve("&::before",`
 top: 0;
 bottom: 0;
 left: 0;
 width: 20px;
 `),ve("&::after",`
 top: 0;
 bottom: 0;
 right: 0;
 width: 20px;
 `),xe("shadow-start",[ve("&::before",`
 box-shadow: inset 10px 0 8px -8px rgba(0, 0, 0, .12);
 `)]),xe("shadow-end",[ve("&::after",`
 box-shadow: inset -10px 0 8px -8px rgba(0, 0, 0, .12);
 `)])])]),xe("left, right",[oe("tabs-nav-scroll-content",`
 flex-direction: column;
 `),oe("tabs-nav-scroll-wrapper",[ve("&::before",`
 top: 0;
 left: 0;
 right: 0;
 height: 20px;
 `),ve("&::after",`
 bottom: 0;
 left: 0;
 right: 0;
 height: 20px;
 `),xe("shadow-start",[ve("&::before",`
 box-shadow: inset 0 10px 8px -8px rgba(0, 0, 0, .12);
 `)]),xe("shadow-end",[ve("&::after",`
 box-shadow: inset 0 -10px 8px -8px rgba(0, 0, 0, .12);
 `)])])]),oe("tabs-nav-scroll-wrapper",`
 flex: 1;
 position: relative;
 overflow: hidden;
 `,[oe("tabs-nav-y-scroll",`
 height: 100%;
 width: 100%;
 overflow-y: auto; 
 scrollbar-width: none;
 `,[ve("&::-webkit-scrollbar",`
 width: 0;
 height: 0;
 `)]),ve("&::before, &::after",`
 transition: box-shadow .3s var(--n-bezier);
 pointer-events: none;
 content: "";
 position: absolute;
 z-index: 1;
 `)]),oe("tabs-nav-scroll-content",`
 display: flex;
 position: relative;
 min-width: 100%;
 min-height: 100%;
 width: fit-content;
 box-sizing: border-box;
 `),oe("tabs-wrapper",`
 display: inline-flex;
 flex-wrap: nowrap;
 position: relative;
 `),oe("tabs-tab-wrapper",`
 display: flex;
 flex-wrap: nowrap;
 flex-shrink: 0;
 flex-grow: 0;
 `),oe("tabs-tab",`
 cursor: pointer;
 white-space: nowrap;
 flex-wrap: nowrap;
 display: inline-flex;
 align-items: center;
 color: var(--n-tab-text-color);
 font-size: var(--n-tab-font-size);
 background-clip: padding-box;
 padding: var(--n-tab-padding);
 transition:
 box-shadow .3s var(--n-bezier),
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 `,[xe("disabled",{cursor:"not-allowed"}),he("close",`
 margin-left: 6px;
 transition:
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
 `),he("label",`
 display: flex;
 align-items: center;
 z-index: 1;
 `)]),oe("tabs-bar",`
 position: absolute;
 bottom: 0;
 height: 2px;
 border-radius: 1px;
 background-color: var(--n-bar-color);
 transition:
 left .2s var(--n-bezier),
 max-width .2s var(--n-bezier),
 opacity .3s var(--n-bezier),
 background-color .3s var(--n-bezier);
 `,[ve("&.transition-disabled",`
 transition: none;
 `),xe("disabled",`
 background-color: var(--n-tab-text-color-disabled)
 `)]),oe("tabs-pane-wrapper",`
 position: relative;
 overflow: hidden;
 transition: max-height .2s var(--n-bezier);
 `),oe("tab-pane",`
 color: var(--n-pane-text-color);
 width: 100%;
 transition:
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 opacity .2s var(--n-bezier);
 left: 0;
 right: 0;
 top: 0;
 `,[ve("&.next-transition-leave-active, &.prev-transition-leave-active, &.next-transition-enter-active, &.prev-transition-enter-active",`
 transition:
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 transform .2s var(--n-bezier),
 opacity .2s var(--n-bezier);
 `),ve("&.next-transition-leave-active, &.prev-transition-leave-active",`
 position: absolute;
 `),ve("&.next-transition-enter-from, &.prev-transition-leave-to",`
 transform: translateX(32px);
 opacity: 0;
 `),ve("&.next-transition-leave-to, &.prev-transition-enter-from",`
 transform: translateX(-32px);
 opacity: 0;
 `),ve("&.next-transition-leave-from, &.next-transition-enter-to, &.prev-transition-leave-from, &.prev-transition-enter-to",`
 transform: translateX(0);
 opacity: 1;
 `)]),oe("tabs-tab-pad",`
 box-sizing: border-box;
 width: var(--n-tab-gap);
 flex-grow: 0;
 flex-shrink: 0;
 `),xe("line-type, bar-type",[oe("tabs-tab",`
 font-weight: var(--n-tab-font-weight);
 box-sizing: border-box;
 vertical-align: bottom;
 `,[ve("&:hover",{color:"var(--n-tab-text-color-hover)"}),xe("active",`
 color: var(--n-tab-text-color-active);
 font-weight: var(--n-tab-font-weight-active);
 `),xe("disabled",{color:"var(--n-tab-text-color-disabled)"})])]),oe("tabs-nav",[xe("line-type",[xe("top",[he("prefix, suffix",`
 border-bottom: 1px solid var(--n-tab-border-color);
 `),oe("tabs-nav-scroll-content",`
 border-bottom: 1px solid var(--n-tab-border-color);
 `),oe("tabs-bar",`
 bottom: -1px;
 `)]),xe("left",[he("prefix, suffix",`
 border-right: 1px solid var(--n-tab-border-color);
 `),oe("tabs-nav-scroll-content",`
 border-right: 1px solid var(--n-tab-border-color);
 `),oe("tabs-bar",`
 right: -1px;
 `)]),xe("right",[he("prefix, suffix",`
 border-left: 1px solid var(--n-tab-border-color);
 `),oe("tabs-nav-scroll-content",`
 border-left: 1px solid var(--n-tab-border-color);
 `),oe("tabs-bar",`
 left: -1px;
 `)]),xe("bottom",[he("prefix, suffix",`
 border-top: 1px solid var(--n-tab-border-color);
 `),oe("tabs-nav-scroll-content",`
 border-top: 1px solid var(--n-tab-border-color);
 `),oe("tabs-bar",`
 top: -1px;
 `)]),he("prefix, suffix",`
 transition: border-color .3s var(--n-bezier);
 `),oe("tabs-nav-scroll-content",`
 transition: border-color .3s var(--n-bezier);
 `),oe("tabs-bar",`
 border-radius: 0;
 `)]),xe("card-type",[he("prefix, suffix",`
 transition: border-color .3s var(--n-bezier);
 border-bottom: 1px solid var(--n-tab-border-color);
 `),oe("tabs-pad",`
 flex-grow: 1;
 transition: border-color .3s var(--n-bezier);
 `),oe("tabs-tab-pad",`
 transition: border-color .3s var(--n-bezier);
 `),oe("tabs-tab",`
 font-weight: var(--n-tab-font-weight);
 border: 1px solid var(--n-tab-border-color);
 background-color: var(--n-tab-color);
 box-sizing: border-box;
 position: relative;
 vertical-align: bottom;
 display: flex;
 justify-content: space-between;
 font-size: var(--n-tab-font-size);
 color: var(--n-tab-text-color);
 `,[xe("addable",`
 padding-left: 8px;
 padding-right: 8px;
 font-size: 16px;
 `,[he("height-placeholder",`
 width: 0;
 font-size: var(--n-tab-font-size);
 `),yr("disabled",[ve("&:hover",`
 color: var(--n-tab-text-color-hover);
 `)])]),xe("closable","padding-right: 8px;"),xe("active",`
 background-color: #0000;
 font-weight: var(--n-tab-font-weight-active);
 color: var(--n-tab-text-color-active);
 `),xe("disabled","color: var(--n-tab-text-color-disabled);")]),oe("tabs-scroll-padding","border-bottom: 1px solid var(--n-tab-border-color);")]),xe("left, right",[oe("tabs-wrapper",`
 flex-direction: column;
 `,[oe("tabs-tab-wrapper",`
 flex-direction: column;
 `,[oe("tabs-tab-pad",`
 height: var(--n-tab-gap-vertical);
 width: 100%;
 `)])])]),xe("top",[xe("card-type",[oe("tabs-tab",`
 border-top-left-radius: var(--n-tab-border-radius);
 border-top-right-radius: var(--n-tab-border-radius);
 `,[xe("active",`
 border-bottom: 1px solid #0000;
 `)]),oe("tabs-tab-pad",`
 border-bottom: 1px solid var(--n-tab-border-color);
 `),oe("tabs-pad",`
 border-bottom: 1px solid var(--n-tab-border-color);
 `)])]),xe("left",[xe("card-type",[oe("tabs-tab",`
 border-top-left-radius: var(--n-tab-border-radius);
 border-bottom-left-radius: var(--n-tab-border-radius);
 `,[xe("active",`
 border-right: 1px solid #0000;
 `)]),oe("tabs-tab-pad",`
 border-right: 1px solid var(--n-tab-border-color);
 `),oe("tabs-pad",`
 border-right: 1px solid var(--n-tab-border-color);
 `)])]),xe("right",[xe("card-type",[oe("tabs-tab",`
 border-top-right-radius: var(--n-tab-border-radius);
 border-bottom-right-radius: var(--n-tab-border-radius);
 `,[xe("active",`
 border-left: 1px solid #0000;
 `)]),oe("tabs-tab-pad",`
 border-left: 1px solid var(--n-tab-border-color);
 `),oe("tabs-pad",`
 border-left: 1px solid var(--n-tab-border-color);
 `)])]),xe("bottom",[xe("card-type",[oe("tabs-tab",`
 border-bottom-left-radius: var(--n-tab-border-radius);
 border-bottom-right-radius: var(--n-tab-border-radius);
 `,[xe("active",`
 border-top: 1px solid #0000;
 `)]),oe("tabs-tab-pad",`
 border-top: 1px solid var(--n-tab-border-color);
 `),oe("tabs-pad",`
 border-top: 1px solid var(--n-tab-border-color);
 `)])])])]),Rse=Object.assign(Object.assign({},bt.props),{value:[String,Number],defaultValue:[String,Number],trigger:{type:String,default:"click"},type:{type:String,default:"bar"},closable:Boolean,justifyContent:String,size:{type:String,default:"medium"},placement:{type:String,default:"top"},tabStyle:[String,Object],tabClass:String,addTabStyle:[String,Object],addTabClass:String,barWidth:Number,paneClass:String,paneStyle:[String,Object],paneWrapperClass:String,paneWrapperStyle:[String,Object],addable:[Boolean,Object],tabsPadding:{type:Number,default:0},animated:Boolean,onBeforeLeave:Function,onAdd:Function,"onUpdate:value":[Function,Array],onUpdateValue:[Function,Array],onClose:[Function,Array],labelSize:String,activeName:[String,Number],onActiveNameChange:[Function,Array]}),e6=Ve({name:"Tabs",props:Rse,setup(e,{slots:t}){var r,i,n,a;const{mergedClsPrefixRef:o,inlineThemeDisabled:s}=mr(e),l=bt("Tabs","-tabs",Ose,Foe,e,o),c=ge(null),d=ge(null),u=ge(null),h=ge(null),f=ge(null),p=ge(null),v=ge(!0),m=ge(!0),g=ap(e,["labelSize","size"]),y=ap(e,["activeName","value"]),b=ge((i=(r=y.value)!==null&&r!==void 0?r:e.defaultValue)!==null&&i!==void 0?i:t.default?(a=(n=ud(t.default())[0])===null||n===void 0?void 0:n.props)===null||a===void 0?void 0:a.name:null),x=Un(y,b),S={id:0},w=re(()=>{if(!(!e.justifyContent||e.type==="card"))return{display:"flex",justifyContent:e.justifyContent}});tr(x,()=>{S.id=0,P(),T()});function _(){var fe;const{value:B}=x;return B===null?null:(fe=c.value)===null||fe===void 0?void 0:fe.querySelector(`[data-name="${B}"]`)}function C(fe){if(e.type==="card")return;const{value:B}=d;if(!B)return;const D=B.style.opacity==="0";if(fe){const I=`${o.value}-tabs-bar--disabled`,{barWidth:O,placement:j}=e;if(fe.dataset.disabled==="true"?B.classList.add(I):B.classList.remove(I),["top","bottom"].includes(j)){if(M(["top","maxHeight","height"]),typeof O=="number"&&fe.offsetWidth>=O){const L=Math.floor((fe.offsetWidth-O)/2)+fe.offsetLeft;B.style.left=`${L}px`,B.style.maxWidth=`${O}px`}else B.style.left=`${fe.offsetLeft}px`,B.style.maxWidth=`${fe.offsetWidth}px`;B.style.width="8192px",D&&(B.style.transition="none"),B.offsetWidth,D&&(B.style.transition="",B.style.opacity="1")}else{if(M(["left","maxWidth","width"]),typeof O=="number"&&fe.offsetHeight>=O){const L=Math.floor((fe.offsetHeight-O)/2)+fe.offsetTop;B.style.top=`${L}px`,B.style.maxHeight=`${O}px`}else B.style.top=`${fe.offsetTop}px`,B.style.maxHeight=`${fe.offsetHeight}px`;B.style.height="8192px",D&&(B.style.transition="none"),B.offsetHeight,D&&(B.style.transition="",B.style.opacity="1")}}}function A(){if(e.type==="card")return;const{value:fe}=d;fe&&(fe.style.opacity="0")}function M(fe){const{value:B}=d;if(B)for(const D of fe)B.style[D]=""}function P(){if(e.type==="card")return;const fe=_();fe?C(fe):A()}function T(fe){var B;const D=(B=f.value)===null||B===void 0?void 0:B.$el;if(!D)return;const I=_();if(!I)return;const{scrollLeft:O,offsetWidth:j}=D,{offsetLeft:L,offsetWidth:Ae}=I;O>L?D.scrollTo({top:0,left:L,behavior:"smooth"}):L+Ae>O+j&&D.scrollTo({top:0,left:L+Ae-j,behavior:"smooth"})}const R=ge(null);let z=0,F=null;function H(fe){const B=R.value;if(B){z=fe.getBoundingClientRect().height;const D=`${z}px`,I=()=>{B.style.height=D,B.style.maxHeight=D};F?(I(),F(),F=null):F=I}}function N(fe){const B=R.value;if(B){const D=fe.getBoundingClientRect().height,I=()=>{document.body.offsetHeight,B.style.maxHeight=`${D}px`,B.style.height=`${Math.max(z,D)}px`};F?(F(),F=null,I()):F=I}}function U(){const fe=R.value;if(fe){fe.style.maxHeight="",fe.style.height="";const{paneWrapperStyle:B}=e;if(typeof B=="string")fe.style.cssText=B;else if(B){const{maxHeight:D,height:I}=B;D!==void 0&&(fe.style.maxHeight=D),I!==void 0&&(fe.style.height=I)}}}const ie={value:[]},te=ge("next");function X(fe){const B=x.value;let D="next";for(const I of ie.value){if(I===B)break;if(I===fe){D="prev";break}}te.value=D,W(fe)}function W(fe){const{onActiveNameChange:B,onUpdateValue:D,"onUpdate:value":I}=e;B&&ct(B,fe),D&&ct(D,fe),I&&ct(I,fe),b.value=fe}function q(fe){const{onClose:B}=e;B&&ct(B,fe)}function $(){const{value:fe}=d;if(!fe)return;const B="transition-disabled";fe.classList.add(B),P(),fe.classList.remove(B)}const le=ge(null);function ee({transitionDisabled:fe}){const B=c.value;if(!B)return;fe&&B.classList.add("transition-disabled");const D=_();D&&le.value&&(le.value.style.width=`${D.offsetWidth}px`,le.value.style.height=`${D.offsetHeight}px`,le.value.style.transform=`translateX(${D.offsetLeft-rn(getComputedStyle(B).paddingLeft)}px)`,fe&&le.value.offsetWidth),fe&&B.classList.remove("transition-disabled")}tr([x],()=>{e.type==="segment"&&ra(()=>{ee({transitionDisabled:!1})})}),Or(()=>{e.type==="segment"&&ee({transitionDisabled:!0})});let Q=0;function ne(fe){var B;if(fe.contentRect.width===0&&fe.contentRect.height===0||Q===fe.contentRect.width)return;Q=fe.contentRect.width;const{type:D}=e;if((D==="line"||D==="bar")&&$(),D!=="segment"){const{placement:I}=e;Z((I==="top"||I==="bottom"?(B=f.value)===null||B===void 0?void 0:B.$el:p.value)||null)}}const V=Ww(ne,64);tr([()=>e.justifyContent,()=>e.size],()=>{ra(()=>{const{type:fe}=e;(fe==="line"||fe==="bar")&&$()})});const de=ge(!1);function me(fe){var B;const{target:D,contentRect:{width:I}}=fe,O=D.parentElement.offsetWidth;if(!de.value)O<I&&(de.value=!0);else{const{value:j}=h;if(!j)return;O-I>j.$el.offsetWidth&&(de.value=!1)}Z(((B=f.value)===null||B===void 0?void 0:B.$el)||null)}const Ce=Ww(me,64);function G(){const{onAdd:fe}=e;fe&&fe(),ra(()=>{const B=_(),{value:D}=f;!B||!D||D.scrollTo({left:B.offsetLeft,top:0,behavior:"smooth"})})}function Z(fe){if(!fe)return;const{placement:B}=e;if(B==="top"||B==="bottom"){const{scrollLeft:D,scrollWidth:I,offsetWidth:O}=fe;v.value=D<=0,m.value=D+O>=I}else{const{scrollTop:D,scrollHeight:I,offsetHeight:O}=fe;v.value=D<=0,m.value=D+O>=I}}const ue=Ww(fe=>{Z(fe.target)},64);br(jT,{triggerRef:pt(e,"trigger"),tabStyleRef:pt(e,"tabStyle"),tabClassRef:pt(e,"tabClass"),addTabStyleRef:pt(e,"addTabStyle"),addTabClassRef:pt(e,"addTabClass"),paneClassRef:pt(e,"paneClass"),paneStyleRef:pt(e,"paneStyle"),mergedClsPrefixRef:o,typeRef:pt(e,"type"),closableRef:pt(e,"closable"),valueRef:x,tabChangeIdRef:S,onBeforeLeaveRef:pt(e,"onBeforeLeave"),activateTab:X,handleClose:q,handleAdd:G}),I5(()=>{P(),T()}),Qa(()=>{const{value:fe}=u;if(!fe)return;const{value:B}=o,D=`${B}-tabs-nav-scroll-wrapper--shadow-start`,I=`${B}-tabs-nav-scroll-wrapper--shadow-end`;v.value?fe.classList.remove(D):fe.classList.add(D),m.value?fe.classList.remove(I):fe.classList.add(I)});const Se={syncBarPosition:()=>{P()}},we=()=>{ee({transitionDisabled:!0})},_e=re(()=>{const{value:fe}=g,{type:B}=e,D={card:"Card",bar:"Bar",line:"Line",segment:"Segment"}[B],I=`${fe}${D}`,{self:{barColor:O,closeIconColor:j,closeIconColorHover:L,closeIconColorPressed:Ae,tabColor:We,tabBorderColor:je,paneTextColor:ze,tabFontWeight:Je,tabBorderRadius:nt,tabFontWeightActive:lt,colorSegment:dt,fontWeightStrong:vt,tabColorSegment:se,closeSize:Le,closeIconSize:Ye,closeColorHover:pe,closeColorPressed:Te,closeBorderRadius:ce,[Ze("panePadding",fe)]:Re,[Ze("tabPadding",I)]:$e,[Ze("tabPaddingVertical",I)]:at,[Ze("tabGap",I)]:qt,[Ze("tabGap",`${I}Vertical`)]:ir,[Ze("tabTextColor",B)]:Fe,[Ze("tabTextColorActive",B)]:Ke,[Ze("tabTextColorHover",B)]:ut,[Ze("tabTextColorDisabled",B)]:Ft,[Ze("tabFontSize",fe)]:ui},common:{cubicBezierEaseInOut:_i}}=l.value;return{"--n-bezier":_i,"--n-color-segment":dt,"--n-bar-color":O,"--n-tab-font-size":ui,"--n-tab-text-color":Fe,"--n-tab-text-color-active":Ke,"--n-tab-text-color-disabled":Ft,"--n-tab-text-color-hover":ut,"--n-pane-text-color":ze,"--n-tab-border-color":je,"--n-tab-border-radius":nt,"--n-close-size":Le,"--n-close-icon-size":Ye,"--n-close-color-hover":pe,"--n-close-color-pressed":Te,"--n-close-border-radius":ce,"--n-close-icon-color":j,"--n-close-icon-color-hover":L,"--n-close-icon-color-pressed":Ae,"--n-tab-color":We,"--n-tab-font-weight":Je,"--n-tab-font-weight-active":lt,"--n-tab-padding":$e,"--n-tab-padding-vertical":at,"--n-tab-gap":qt,"--n-tab-gap-vertical":ir,"--n-pane-padding-left":Eo(Re,"left"),"--n-pane-padding-right":Eo(Re,"right"),"--n-pane-padding-top":Eo(Re,"top"),"--n-pane-padding-bottom":Eo(Re,"bottom"),"--n-font-weight-strong":vt,"--n-tab-color-segment":se}}),Ee=s?Dr("tabs",re(()=>`${g.value[0]}${e.type[0]}`),_e,e):void 0;return Object.assign({mergedClsPrefix:o,mergedValue:x,renderedNames:new Set,segmentCapsuleElRef:le,tabsPaneWrapperRef:R,tabsElRef:c,barElRef:d,addTabInstRef:h,xScrollInstRef:f,scrollWrapperElRef:u,addTabFixed:de,tabWrapperStyle:w,handleNavResize:V,mergedSize:g,handleScroll:ue,handleTabsResize:Ce,cssVars:s?void 0:_e,themeClass:Ee==null?void 0:Ee.themeClass,animationDirection:te,renderNameListRef:ie,yScrollElRef:p,handleSegmentResize:we,onAnimationBeforeLeave:H,onAnimationEnter:N,onAnimationAfterEnter:U,onRender:Ee==null?void 0:Ee.onRender},Se)},render(){const{mergedClsPrefix:e,type:t,placement:r,addTabFixed:i,addable:n,mergedSize:a,renderNameListRef:o,onRender:s,paneWrapperClass:l,paneWrapperStyle:c,$slots:{default:d,prefix:u,suffix:h}}=this;s==null||s();const f=d?ud(d()).filter(S=>S.type.__TAB_PANE__===!0):[],p=d?ud(d()).filter(S=>S.type.__TAB__===!0):[],v=!p.length,m=t==="card",g=t==="segment",y=!m&&!g&&this.justifyContent;o.value=[];const b=()=>{const S=E("div",{style:this.tabWrapperStyle,class:[`${e}-tabs-wrapper`]},y?null:E("div",{class:`${e}-tabs-scroll-padding`,style:{width:`${this.tabsPadding}px`}}),v?f.map((w,_)=>(o.value.push(w.props.name),vS(E(dA,Object.assign({},w.props,{internalCreatedByPane:!0,internalLeftPadded:_!==0&&(!y||y==="center"||y==="start"||y==="end")}),w.children?{default:w.children.tab}:void 0)))):p.map((w,_)=>(o.value.push(w.props.name),vS(_!==0&&!y?nR(w):w))),!i&&n&&m?iR(n,(v?f.length:p.length)!==0):null,y?null:E("div",{class:`${e}-tabs-scroll-padding`,style:{width:`${this.tabsPadding}px`}}));return E("div",{ref:"tabsElRef",class:`${e}-tabs-nav-scroll-content`},m&&n?E(Ks,{onResize:this.handleTabsResize},{default:()=>S}):S,m?E("div",{class:`${e}-tabs-pad`}):null,m?null:E("div",{ref:"barElRef",class:`${e}-tabs-bar`}))},x=g?"top":r;return E("div",{class:[`${e}-tabs`,this.themeClass,`${e}-tabs--${t}-type`,`${e}-tabs--${a}-size`,y&&`${e}-tabs--flex`,`${e}-tabs--${x}`],style:this.cssVars},E("div",{class:[`${e}-tabs-nav--${t}-type`,`${e}-tabs-nav--${x}`,`${e}-tabs-nav`]},ei(u,S=>S&&E("div",{class:`${e}-tabs-nav__prefix`},S)),g?E(Ks,{onResize:this.handleSegmentResize},{default:()=>E("div",{class:`${e}-tabs-rail`,ref:"tabsElRef"},E("div",{class:`${e}-tabs-capsule`,ref:"segmentCapsuleElRef"},E("div",{class:`${e}-tabs-wrapper`},E("div",{class:`${e}-tabs-tab`}))),v?f.map((S,w)=>(o.value.push(S.props.name),E(dA,Object.assign({},S.props,{internalCreatedByPane:!0,internalLeftPadded:w!==0}),S.children?{default:S.children.tab}:void 0))):p.map((S,w)=>(o.value.push(S.props.name),w===0?S:nR(S))))}):E(Ks,{onResize:this.handleNavResize},{default:()=>E("div",{class:`${e}-tabs-nav-scroll-wrapper`,ref:"scrollWrapperElRef"},["top","bottom"].includes(x)?E(Aq,{ref:"xScrollInstRef",onScroll:this.handleScroll},{default:b}):E("div",{class:`${e}-tabs-nav-y-scroll`,onScroll:this.handleScroll,ref:"yScrollElRef"},b()))}),i&&n&&m?iR(n,!0):null,ei(h,S=>S&&E("div",{class:`${e}-tabs-nav__suffix`},S))),v&&(this.animated&&(x==="top"||x==="bottom")?E("div",{ref:"tabsPaneWrapperRef",style:c,class:[`${e}-tabs-pane-wrapper`,l]},rR(f,this.mergedValue,this.renderedNames,this.onAnimationBeforeLeave,this.onAnimationEnter,this.onAnimationAfterEnter,this.animationDirection)):rR(f,this.mergedValue,this.renderedNames)))}});function rR(e,t,r,i,n,a,o){const s=[];return e.forEach(l=>{const{name:c,displayDirective:d,"display-directive":u}=l.props,h=p=>d===p||u===p,f=t===c;if(l.key!==void 0&&(l.key=c),f||h("show")||h("show:lazy")&&r.has(c)){r.has(c)||r.add(c);const p=!h("if");s.push(p?Ka(l,[[Gu,f]]):l)}}),o?E(b5,{name:`${o}-transition`,onBeforeLeave:i,onEnter:n,onAfterEnter:a},{default:()=>s}):s}function iR(e,t){return E(dA,{ref:"addTabInstRef",key:"__addable",name:"__addable",internalCreatedByPane:!0,internalAddable:!0,internalLeftPadded:t,disabled:typeof e=="object"&&e.disabled})}function nR(e){const t=nl(e);return t.props?t.props.internalLeftPadded=!0:t.props={internalLeftPadded:!0},t}function vS(e){return Array.isArray(e.dynamicProps)?e.dynamicProps.includes("internalLeftPadded")||e.dynamicProps.push("internalLeftPadded"):e.dynamicProps=["internalLeftPadded"],e}const Ng="n-transfer",aR=Ve({name:"TransferHeader",props:{size:{type:String,required:!0},selectAllText:String,clearText:String,source:Boolean,onCheckedAll:Function,onClearAll:Function,title:String},setup(e){const{targetOptionsRef:t,canNotSelectAnythingRef:r,canBeClearedRef:i,allCheckedRef:n,mergedThemeRef:a,disabledRef:o,mergedClsPrefixRef:s,srcOptionsLengthRef:l}=_t(Ng),{localeRef:c}=dc("Transfer");return()=>{const{source:d,onClearAll:u,onCheckedAll:h,selectAllText:f,clearText:p}=e,{value:v}=a,{value:m}=s,{value:g}=c,y=e.size==="large"?"small":"tiny",{title:b}=e;return E("div",{class:`${m}-transfer-list-header`},b&&E("div",{class:`${m}-transfer-list-header__title`},b),d&&E(li,{class:`${m}-transfer-list-header__button`,theme:v.peers.Button,themeOverrides:v.peerOverrides.Button,size:y,tertiary:!0,onClick:n.value?u:h,disabled:r.value||o.value},{default:()=>n.value?p||g.unselectAll:f||g.selectAll}),!d&&i.value&&E(li,{class:`${m}-transfer-list-header__button`,theme:v.peers.Button,themeOverrides:v.peerOverrides.Button,size:y,tertiary:!0,onClick:u,disabled:o.value},{default:()=>g.clearAll}),E("div",{class:`${m}-transfer-list-header__extra`},d?g.total(l.value):g.selected(t.value.length)))}}}),oR=Ve({name:"NTransferListItem",props:{source:Boolean,label:{type:String,required:!0},value:{type:[String,Number],required:!0},disabled:Boolean,option:{type:Object,required:!0}},setup(e){const{targetValueSetRef:t,mergedClsPrefixRef:r,mergedThemeRef:i,handleItemCheck:n,renderSourceLabelRef:a,renderTargetLabelRef:o,showSelectedRef:s}=_t(Ng),l=$i(()=>t.value.has(e.value));function c(){e.disabled||n(!l.value,e.value)}return{mergedClsPrefix:r,mergedTheme:i,checked:l,showSelected:s,renderSourceLabel:a,renderTargetLabel:o,handleClick:c}},render(){const{disabled:e,mergedTheme:t,mergedClsPrefix:r,label:i,checked:n,source:a,renderSourceLabel:o,renderTargetLabel:s}=this;return E("div",{class:[`${r}-transfer-list-item`,e&&`${r}-transfer-list-item--disabled`,a?`${r}-transfer-list-item--source`:`${r}-transfer-list-item--target`],onClick:a?this.handleClick:void 0},E("div",{class:`${r}-transfer-list-item__background`}),a&&this.showSelected&&E("div",{class:`${r}-transfer-list-item__checkbox`},E(pU,{theme:t.peers.Checkbox,themeOverrides:t.peerOverrides.Checkbox,disabled:e,checked:n})),E("div",{class:`${r}-transfer-list-item__label`,title:W_(i)},a?o?o({option:this.option}):i:s?s({option:this.option}):i),!a&&!e&&E(O1,{focusable:!1,class:`${r}-transfer-list-item__close`,clsPrefix:r,onClick:this.handleClick}))}}),sR=Ve({name:"TransferList",props:{virtualScroll:{type:Boolean,required:!0},itemSize:{type:Number,required:!0},options:{type:Array,required:!0},disabled:{type:Boolean,required:!0},source:Boolean},setup(){const{mergedThemeRef:e,mergedClsPrefixRef:t}=_t(Ng),r=ge(null),i=ge(null);function n(){var s;(s=r.value)===null||s===void 0||s.sync()}function a(){const{value:s}=i;if(!s)return null;const{listElRef:l}=s;return l}function o(){const{value:s}=i;if(!s)return null;const{itemsElRef:l}=s;return l}return{mergedTheme:e,mergedClsPrefix:t,scrollerInstRef:r,vlInstRef:i,syncVLScroller:n,scrollContainer:a,scrollContent:o}},render(){const{mergedTheme:e,options:t}=this;if(t.length===0)return E($N,{theme:e.peers.Empty,themeOverrides:e.peerOverrides.Empty});const{mergedClsPrefix:r,virtualScroll:i,source:n,disabled:a,syncVLScroller:o}=this;return E(bn,{ref:"scrollerInstRef",theme:e.peers.Scrollbar,themeOverrides:e.peerOverrides.Scrollbar,container:i?this.scrollContainer:void 0,content:i?this.scrollContent:void 0},{default:()=>i?E(qv,{ref:"vlInstRef",style:{height:"100%"},class:`${r}-transfer-list-content`,items:this.options,itemSize:this.itemSize,showScrollbar:!1,onResize:o,onScroll:o,keyField:"value"},{default:({item:s})=>{const{source:l,disabled:c}=this;return E(oR,{source:l,key:s.value,value:s.value,disabled:s.disabled||c,label:s.label,option:s})}}):E("div",{class:`${r}-transfer-list-content`},t.map(s=>E(oR,{source:n,key:s.value,value:s.value,disabled:s.disabled||a,label:s.label,option:s})))})}}),lR=Ve({name:"TransferFilter",props:{value:String,placeholder:String,disabled:Boolean,onUpdateValue:{type:Function,required:!0}},setup(){const{mergedThemeRef:e,mergedClsPrefixRef:t}=_t(Ng);return{mergedClsPrefix:t,mergedTheme:e}},render(){const{mergedTheme:e,mergedClsPrefix:t}=this;return E("div",{class:`${t}-transfer-filter`},E(cr,{value:this.value,onUpdateValue:this.onUpdateValue,disabled:this.disabled,placeholder:this.placeholder,theme:e.peers.Input,themeOverrides:e.peerOverrides.Input,clearable:!0,size:"small"},{"clear-icon-placeholder":()=>E(Li,{clsPrefix:t},{default:()=>E(zee,null)})}))}});function Ise(e){const t=ge(e.defaultValue),r=Un(pt(e,"value"),t),i=re(()=>{const x=new Map;return(e.options||[]).forEach(S=>x.set(S.value,S)),x}),n=re(()=>new Set(r.value||[])),a=re(()=>{const x=i.value,S=[];return(r.value||[]).forEach(w=>{const _=x.get(w);_&&S.push(_)}),S}),o=ge(""),s=ge(""),l=re(()=>e.sourceFilterable||!!e.filterable),c=re(()=>{const{showSelected:x,options:S,filter:w}=e;return l.value?S.filter(_=>w(o.value,_,"source")&&(x||!n.value.has(_.value))):x?S:S.filter(_=>!n.value.has(_.value))}),d=re(()=>{if(!e.targetFilterable)return a.value;const{filter:x}=e;return a.value.filter(S=>x(s.value,S,"target"))}),u=re(()=>{const{value:x}=r;return x===null?new Set:new Set(x)}),h=re(()=>{const x=new Set(u.value);return c.value.forEach(S=>{!S.disabled&&!x.has(S.value)&&x.add(S.value)}),x}),f=re(()=>{const x=new Set(u.value);return c.value.forEach(S=>{!S.disabled&&x.has(S.value)&&x.delete(S.value)}),x}),p=re(()=>{const x=new Set(u.value);return d.value.forEach(S=>{S.disabled||x.delete(S.value)}),x}),v=re(()=>c.value.every(x=>x.disabled)),m=re(()=>{if(!c.value.length)return!1;const x=u.value;return c.value.every(S=>S.disabled||x.has(S.value))}),g=re(()=>d.value.some(x=>!x.disabled));function y(x){o.value=x??""}function b(x){s.value=x??""}return{uncontrolledValueRef:t,mergedValueRef:r,targetValueSetRef:n,valueSetForCheckAllRef:h,valueSetForUncheckAllRef:f,valueSetForClearRef:p,filteredTgtOptionsRef:d,filteredSrcOptionsRef:c,targetOptionsRef:a,canNotSelectAnythingRef:v,canBeClearedRef:g,allCheckedRef:m,srcPatternRef:o,tgtPatternRef:s,mergedSrcFilterableRef:l,handleSrcFilterUpdateValue:y,handleTgtFilterUpdateValue:b}}const zse=oe("transfer",`
 width: 100%;
 font-size: var(--n-font-size);
 height: 300px;
 display: flex;
 flex-wrap: nowrap;
 word-break: break-word;
`,[xe("disabled",[oe("transfer-list",[oe("transfer-list-header",[he("title",`
 color: var(--n-header-text-color-disabled);
 `),he("extra",`
 color: var(--n-header-extra-text-color-disabled);
 `)])])]),oe("transfer-list",`
 flex: 1;
 min-width: 0;
 height: inherit;
 display: flex;
 flex-direction: column;
 background-clip: padding-box;
 position: relative;
 transition: background-color .3s var(--n-bezier);
 background-color: var(--n-list-color);
 `,[xe("source",`
 border-top-left-radius: var(--n-border-radius);
 border-bottom-left-radius: var(--n-border-radius);
 `,[he("border","border-right: 1px solid var(--n-divider-color);")]),xe("target",`
 border-top-right-radius: var(--n-border-radius);
 border-bottom-right-radius: var(--n-border-radius);
 `,[he("border","border-left: none;")]),he("border",`
 padding: 0 12px;
 border: 1px solid var(--n-border-color);
 transition: border-color .3s var(--n-bezier);
 pointer-events: none;
 border-radius: inherit;
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 `),oe("transfer-list-header",`
 min-height: var(--n-header-height);
 box-sizing: border-box;
 display: flex;
 padding: 12px 12px 10px 12px;
 align-items: center;
 background-clip: padding-box;
 border-radius: inherit;
 border-bottom-left-radius: 0;
 border-bottom-right-radius: 0;
 line-height: 1.5;
 transition:
 border-color .3s var(--n-bezier),
 background-color .3s var(--n-bezier);
 `,[ve("> *:not(:first-child)",`
 margin-left: 8px;
 `),he("title",`
 flex: 1;
 min-width: 0;
 line-height: 1.5;
 font-size: var(--n-header-font-size);
 font-weight: var(--n-header-font-weight);
 transition: color .3s var(--n-bezier);
 color: var(--n-header-text-color);
 `),he("button",`
 position: relative;
 `),he("extra",`
 transition: color .3s var(--n-bezier);
 font-size: var(--n-extra-font-size);
 margin-right: 0;
 white-space: nowrap;
 color: var(--n-header-extra-text-color);
 `)]),oe("transfer-list-body",`
 flex-basis: 0;
 flex-grow: 1;
 box-sizing: border-box;
 position: relative;
 display: flex;
 flex-direction: column;
 border-radius: inherit;
 border-top-left-radius: 0;
 border-top-right-radius: 0;
 `,[oe("transfer-filter",`
 padding: 4px 12px 8px 12px;
 box-sizing: border-box;
 transition:
 border-color .3s var(--n-bezier),
 background-color .3s var(--n-bezier);
 `),oe("transfer-list-flex-container",`
 flex: 1;
 position: relative;
 `,[oe("scrollbar",`
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 height: unset;
 `),oe("empty",`
 position: absolute;
 left: 50%;
 top: 50%;
 transform: translateY(-50%) translateX(-50%);
 `),oe("transfer-list-content",`
 padding: 0;
 margin: 0;
 position: relative;
 `,[oe("transfer-list-item",`
 padding: 0 12px;
 min-height: var(--n-item-height);
 display: flex;
 align-items: center;
 color: var(--n-item-text-color);
 position: relative;
 transition: color .3s var(--n-bezier);
 `,[he("background",`
 position: absolute;
 left: 4px;
 right: 4px;
 top: 0;
 bottom: 0;
 border-radius: var(--n-border-radius);
 transition: background-color .3s var(--n-bezier);
 `),he("checkbox",`
 position: relative;
 margin-right: 8px;
 `),he("close",`
 opacity: 0;
 pointer-events: none;
 position: relative;
 transition:
 opacity .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
 `),he("label",`
 position: relative;
 min-width: 0;
 flex-grow: 1;
 `),xe("source","cursor: pointer;"),xe("disabled",`
 cursor: not-allowed;
 color: var(--n-item-text-color-disabled);
 `),yr("disabled",[ve("&:hover",[he("background","background-color: var(--n-item-color-pending);"),he("close",`
 opacity: 1;
 pointer-events: all;
 `)])])])])])])])]),kse=Object.assign(Object.assign({},bt.props),{value:Array,defaultValue:{type:Array,default:null},options:{type:Array,default:()=>[]},disabled:{type:Boolean,default:void 0},virtualScroll:Boolean,sourceTitle:String,selectAllText:String,clearText:String,targetTitle:String,filterable:{type:Boolean,default:void 0},sourceFilterable:Boolean,targetFilterable:Boolean,showSelected:{type:Boolean,default:!0},sourceFilterPlaceholder:String,targetFilterPlaceholder:String,filter:{type:Function,default:(e,t)=>e?~(""+t.label).toLowerCase().indexOf((""+e).toLowerCase()):!0},size:String,renderSourceLabel:Function,renderTargetLabel:Function,renderSourceList:Function,renderTargetList:Function,"onUpdate:value":[Function,Array],onUpdateValue:[Function,Array],onChange:[Function,Array]}),Lse=Ve({name:"Transfer",props:kse,setup(e){const{mergedClsPrefixRef:t}=mr(e),r=bt("Transfer","-transfer",zse,joe,e,t),i=cl(e),{mergedSizeRef:n,mergedDisabledRef:a}=i,o=re(()=>{const{value:z}=n,{self:{[Ze("itemHeight",z)]:F}}=r.value;return rn(F)}),{uncontrolledValueRef:s,mergedValueRef:l,targetValueSetRef:c,valueSetForCheckAllRef:d,valueSetForUncheckAllRef:u,valueSetForClearRef:h,filteredTgtOptionsRef:f,filteredSrcOptionsRef:p,targetOptionsRef:v,canNotSelectAnythingRef:m,canBeClearedRef:g,allCheckedRef:y,srcPatternRef:b,tgtPatternRef:x,mergedSrcFilterableRef:S,handleSrcFilterUpdateValue:w,handleTgtFilterUpdateValue:_}=Ise(e);function C(z){const{onUpdateValue:F,"onUpdate:value":H,onChange:N}=e,{nTriggerFormInput:U,nTriggerFormChange:ie}=i;F&&ct(F,z),H&&ct(H,z),N&&ct(N,z),s.value=z,U(),ie()}function A(){C([...d.value])}function M(){C([...u.value])}function P(){C([...h.value])}function T(z,F){C(z?(l.value||[]).concat(F):(l.value||[]).filter(H=>H!==F))}function R(z){C(z)}return br(Ng,{targetValueSetRef:c,mergedClsPrefixRef:t,disabledRef:a,mergedThemeRef:r,targetOptionsRef:v,canNotSelectAnythingRef:m,canBeClearedRef:g,allCheckedRef:y,srcOptionsLengthRef:re(()=>e.options.length),handleItemCheck:T,renderSourceLabelRef:pt(e,"renderSourceLabel"),renderTargetLabelRef:pt(e,"renderTargetLabel"),showSelectedRef:pt(e,"showSelected")}),{mergedClsPrefix:t,mergedDisabled:a,itemSize:o,isMounted:zd(),mergedTheme:r,filteredSrcOpts:p,filteredTgtOpts:f,srcPattern:b,tgtPattern:x,mergedSize:n,mergedSrcFilterable:S,handleSrcFilterUpdateValue:w,handleTgtFilterUpdateValue:_,handleSourceCheckAll:A,handleSourceUncheckAll:M,handleTargetClearAll:P,handleItemCheck:T,handleChecked:R,cssVars:re(()=>{const{value:z}=n,{common:{cubicBezierEaseInOut:F},self:{borderRadius:H,borderColor:N,listColor:U,titleTextColor:ie,titleTextColorDisabled:te,extraTextColor:X,itemTextColor:W,itemColorPending:q,itemTextColorDisabled:$,titleFontWeight:le,closeColorHover:ee,closeColorPressed:Q,closeIconColor:ne,closeIconColorHover:V,closeIconColorPressed:de,closeIconSize:me,closeSize:Ce,dividerColor:G,extraTextColorDisabled:Z,[Ze("extraFontSize",z)]:ue,[Ze("fontSize",z)]:Se,[Ze("titleFontSize",z)]:we,[Ze("itemHeight",z)]:_e,[Ze("headerHeight",z)]:Ee}}=r.value;return{"--n-bezier":F,"--n-border-color":N,"--n-border-radius":H,"--n-extra-font-size":ue,"--n-font-size":Se,"--n-header-font-size":we,"--n-header-extra-text-color":X,"--n-header-extra-text-color-disabled":Z,"--n-header-font-weight":le,"--n-header-text-color":ie,"--n-header-text-color-disabled":te,"--n-item-color-pending":q,"--n-item-height":_e,"--n-item-text-color":W,"--n-item-text-color-disabled":$,"--n-list-color":U,"--n-header-height":Ee,"--n-close-size":Ce,"--n-close-icon-size":me,"--n-close-color-hover":ee,"--n-close-color-pressed":Q,"--n-close-icon-color":ne,"--n-close-icon-color-hover":V,"--n-close-icon-color-pressed":de,"--n-divider-color":G}})}},render(){const{mergedClsPrefix:e,renderSourceList:t,renderTargetList:r,mergedTheme:i,mergedSrcFilterable:n,targetFilterable:a}=this;return E("div",{class:[`${e}-transfer`,this.mergedDisabled&&`${e}-transfer--disabled`],style:this.cssVars},E("div",{class:`${e}-transfer-list ${e}-transfer-list--source`},E(aR,{source:!0,selectAllText:this.selectAllText,clearText:this.clearText,title:this.sourceTitle,onCheckedAll:this.handleSourceCheckAll,onClearAll:this.handleSourceUncheckAll,size:this.mergedSize}),E("div",{class:`${e}-transfer-list-body`},n?E(lR,{onUpdateValue:this.handleSrcFilterUpdateValue,value:this.srcPattern,disabled:this.mergedDisabled,placeholder:this.sourceFilterPlaceholder}):null,E("div",{class:`${e}-transfer-list-flex-container`},t?E(bn,{theme:i.peers.Scrollbar,themeOverrides:i.peerOverrides.Scrollbar},{default:()=>t({onCheck:this.handleChecked,checkedOptions:this.filteredTgtOpts,pattern:this.srcPattern})}):E(sR,{source:!0,options:this.filteredSrcOpts,disabled:this.mergedDisabled,virtualScroll:this.virtualScroll,itemSize:this.itemSize}))),E("div",{class:`${e}-transfer-list__border`})),E("div",{class:`${e}-transfer-list ${e}-transfer-list--target`},E(aR,{onClearAll:this.handleTargetClearAll,size:this.mergedSize,title:this.targetTitle}),E("div",{class:`${e}-transfer-list-body`},a?E(lR,{onUpdateValue:this.handleTgtFilterUpdateValue,value:this.tgtPattern,disabled:this.mergedDisabled,placeholder:this.sourceFilterPlaceholder}):null,E("div",{class:`${e}-transfer-list-flex-container`},r?E(bn,{theme:i.peers.Scrollbar,themeOverrides:i.peerOverrides.Scrollbar},{default:()=>r({onCheck:this.handleChecked,checkedOptions:this.filteredTgtOpts,pattern:this.tgtPattern})}):E(sR,{options:this.filteredTgtOpts,disabled:this.mergedDisabled,virtualScroll:this.virtualScroll,itemSize:this.itemSize}))),E("div",{class:`${e}-transfer-list__border`})))}}),Bse=oe("h",`
 font-size: var(--n-font-size);
 font-weight: var(--n-font-weight);
 margin: var(--n-margin);
 transition: color .3s var(--n-bezier);
 color: var(--n-text-color);
`,[ve("&:first-child",{marginTop:0}),xe("prefix-bar",{position:"relative",paddingLeft:"var(--n-prefix-width)"},[xe("align-text",{paddingLeft:0},[ve("&::before",{left:"calc(-1 * var(--n-prefix-width))"})]),ve("&::before",`
 content: "";
 width: var(--n-bar-width);
 border-radius: calc(var(--n-bar-width) / 2);
 transition: background-color .3s var(--n-bezier);
 left: 0;
 top: 0;
 bottom: 0;
 position: absolute;
 `),ve("&::before",{backgroundColor:"var(--n-bar-color)"})])]),Fse=Object.assign(Object.assign({},bt.props),{type:{type:String,default:"default"},prefix:String,alignText:Boolean}),t6=e=>Ve({name:`H${e}`,props:Fse,setup(t){const{mergedClsPrefixRef:r,inlineThemeDisabled:i}=mr(t),n=bt("Typography","-h",Bse,UU,t,r),a=re(()=>{const{type:s}=t,{common:{cubicBezierEaseInOut:l},self:{headerFontWeight:c,headerTextColor:d,[Ze("headerPrefixWidth",e)]:u,[Ze("headerFontSize",e)]:h,[Ze("headerMargin",e)]:f,[Ze("headerBarWidth",e)]:p,[Ze("headerBarColor",s)]:v}}=n.value;return{"--n-bezier":l,"--n-font-size":h,"--n-margin":f,"--n-bar-color":v,"--n-bar-width":p,"--n-font-weight":c,"--n-text-color":d,"--n-prefix-width":u}}),o=i?Dr(`h${e}`,re(()=>t.type[0]),a,t):void 0;return{mergedClsPrefix:r,cssVars:i?void 0:a,themeClass:o==null?void 0:o.themeClass,onRender:o==null?void 0:o.onRender}},render(){var t;const{prefix:r,alignText:i,mergedClsPrefix:n,cssVars:a,$slots:o}=this;return(t=this.onRender)===null||t===void 0||t.call(this),E(`h${e}`,{class:[`${n}-h`,`${n}-h${e}`,this.themeClass,{[`${n}-h--prefix-bar`]:r,[`${n}-h--align-text`]:i}],style:a},o)}}),cR=t6("3"),uA=t6("6"),Nse=oe("text",`
 transition: color .3s var(--n-bezier);
 color: var(--n-text-color);
`,[xe("strong",`
 font-weight: var(--n-font-weight-strong);
 `),xe("italic",{fontStyle:"italic"}),xe("underline",{textDecoration:"underline"}),xe("code",`
 line-height: 1.4;
 display: inline-block;
 font-family: var(--n-font-famliy-mono);
 transition: 
 color .3s var(--n-bezier),
 border-color .3s var(--n-bezier),
 background-color .3s var(--n-bezier);
 box-sizing: border-box;
 padding: .05em .35em 0 .35em;
 border-radius: var(--n-code-border-radius);
 font-size: .9em;
 color: var(--n-code-text-color);
 background-color: var(--n-code-color);
 border: var(--n-code-border);
 `)]),Use=Object.assign(Object.assign({},bt.props),{code:Boolean,type:{type:String,default:"default"},delete:Boolean,strong:Boolean,italic:Boolean,underline:Boolean,depth:[String,Number],tag:String,as:{type:String,validator:()=>!0,default:void 0}}),uu=Ve({name:"Text",props:Use,setup(e){const{mergedClsPrefixRef:t,inlineThemeDisabled:r}=mr(e),i=bt("Typography","-text",Nse,UU,e,t),n=re(()=>{const{depth:o,type:s}=e,l=s==="default"?o===void 0?"textColor":`textColor${o}Depth`:Ze("textColor",s),{common:{fontWeightStrong:c,fontFamilyMono:d,cubicBezierEaseInOut:u},self:{codeTextColor:h,codeBorderRadius:f,codeColor:p,codeBorder:v,[l]:m}}=i.value;return{"--n-bezier":u,"--n-text-color":m,"--n-font-weight-strong":c,"--n-font-famliy-mono":d,"--n-code-border-radius":f,"--n-code-text-color":h,"--n-code-color":p,"--n-code-border":v}}),a=r?Dr("text",re(()=>`${e.type[0]}${e.depth||""}`),n,e):void 0;return{mergedClsPrefix:t,compitableTag:ap(e,["as","tag"]),cssVars:r?void 0:n,themeClass:a==null?void 0:a.themeClass,onRender:a==null?void 0:a.onRender}},render(){var e,t,r;const{mergedClsPrefix:i}=this;(e=this.onRender)===null||e===void 0||e.call(this);const n=[`${i}-text`,this.themeClass,{[`${i}-text--code`]:this.code,[`${i}-text--delete`]:this.delete,[`${i}-text--strong`]:this.strong,[`${i}-text--italic`]:this.italic,[`${i}-text--underline`]:this.underline}],a=(r=(t=this.$slots).default)===null||r===void 0?void 0:r.call(t);return this.code?E("code",{class:n,style:this.cssVars},this.delete?E("del",null,a):a):this.delete?E("del",{class:n,style:this.cssVars},a):E(this.compitableTag||"span",{class:n,style:this.cssVars},a)}}),jse=Ve({__name:"App",setup(e){return(t,r)=>{const i=Od("RouterView");return ft(),Ei(ke(xse),null,{default:tt(()=>[Be(i)]),_:1})}}});var Vse=!1;/*!
 * pinia v2.1.7
 * (c) 2023 Eduardo San Martin Morote
 * @license MIT
 */let r6;const N1=e=>r6=e,i6=Symbol();function hA(e){return e&&typeof e=="object"&&Object.prototype.toString.call(e)==="[object Object]"&&typeof e.toJSON!="function"}var bv;(function(e){e.direct="direct",e.patchObject="patch object",e.patchFunction="patch function"})(bv||(bv={}));function Hse(){const e=pF(!0),t=e.run(()=>ge({}));let r=[],i=[];const n=kE({install(a){N1(n),n._a=a,a.provide(i6,n),a.config.globalProperties.$pinia=n,i.forEach(o=>r.push(o)),i=[]},use(a){return!this._a&&!Vse?i.push(a):r.push(a),this},_p:r,_a:null,_e:e,_s:new Map,state:t});return n}const n6=()=>{};function dR(e,t,r,i=n6){e.push(t);const n=()=>{const a=e.indexOf(t);a>-1&&(e.splice(a,1),i())};return!r&&mF()&&E9(n),n}function Lh(e,...t){e.slice().forEach(r=>{r(...t)})}const Wse=e=>e();function fA(e,t){e instanceof Map&&t instanceof Map&&t.forEach((r,i)=>e.set(i,r)),e instanceof Set&&t instanceof Set&&t.forEach(e.add,e);for(const r in t){if(!t.hasOwnProperty(r))continue;const i=t[r],n=e[r];hA(n)&&hA(i)&&e.hasOwnProperty(r)&&!Qi(i)&&!cd(i)?e[r]=fA(n,i):e[r]=i}return e}const Gse=Symbol();function $se(e){return!hA(e)||!e.hasOwnProperty(Gse)}const{assign:Nc}=Object;function qse(e){return!!(Qi(e)&&e.effect)}function Yse(e,t,r,i){const{state:n,actions:a,getters:o}=t,s=r.state.value[e];let l;function c(){s||(r.state.value[e]=n?n():{});const d=IF(r.state.value[e]);return Nc(d,a,Object.keys(o||{}).reduce((u,h)=>(u[h]=kE(re(()=>{N1(r);const f=r._s.get(e);return o[h].call(f,f)})),u),{}))}return l=a6(e,c,t,r,i,!0),l}function a6(e,t,r={},i,n,a){let o;const s=Nc({actions:{}},r),l={deep:!0};let c,d,u=[],h=[],f;const p=i.state.value[e];!a&&!p&&(i.state.value[e]={}),ge({});let v;function m(C){let A;c=d=!1,typeof C=="function"?(C(i.state.value[e]),A={type:bv.patchFunction,storeId:e,events:f}):(fA(i.state.value[e],C),A={type:bv.patchObject,payload:C,storeId:e,events:f});const M=v=Symbol();ra().then(()=>{v===M&&(c=!0)}),d=!0,Lh(u,A,i.state.value[e])}const g=a?function(){const{state:A}=r,M=A?A():{};this.$patch(P=>{Nc(P,M)})}:n6;function y(){o.stop(),u=[],h=[],i._s.delete(e)}function b(C,A){return function(){N1(i);const M=Array.from(arguments),P=[],T=[];function R(H){P.push(H)}function z(H){T.push(H)}Lh(h,{args:M,name:C,store:S,after:R,onError:z});let F;try{F=A.apply(this&&this.$id===e?this:S,M)}catch(H){throw Lh(T,H),H}return F instanceof Promise?F.then(H=>(Lh(P,H),H)).catch(H=>(Lh(T,H),Promise.reject(H))):(Lh(P,F),F)}}const x={_p:i,$id:e,$onAction:dR.bind(null,h),$patch:m,$reset:g,$subscribe(C,A={}){const M=dR(u,C,A.detached,()=>P()),P=o.run(()=>tr(()=>i.state.value[e],T=>{(A.flush==="sync"?d:c)&&C({storeId:e,type:bv.direct,events:f},T)},Nc({},l,A)));return M},$dispose:y},S=Dd(x);i._s.set(e,S);const _=(i._a&&i._a.runWithContext||Wse)(()=>i._e.run(()=>(o=pF()).run(t)));for(const C in _){const A=_[C];if(Qi(A)&&!qse(A)||cd(A))a||(p&&$se(A)&&(Qi(A)?A.value=p[C]:fA(A,p[C])),i.state.value[e][C]=A);else if(typeof A=="function"){const M=b(C,A);_[C]=M,s.actions[C]=A}}return Nc(S,_),Nc(wr(S),_),Object.defineProperty(S,"$state",{get:()=>i.state.value[e],set:C=>{m(A=>{Nc(A,C)})}}),i._p.forEach(C=>{Nc(S,o.run(()=>C({store:S,app:i._a,pinia:i,options:s})))}),p&&a&&r.hydrate&&r.hydrate(S.$state,p),c=!0,d=!0,S}function o6(e,t,r){let i,n;const a=typeof t=="function";typeof e=="string"?(i=e,n=a?r:t):(n=e,i=e.id);function o(s,l){const c=T7();return s=s||(c?_t(i6,null):null),s&&N1(s),s=r6,s._s.has(i)||(a?a6(i,t,n,s):Yse(i,n,s)),s._s.get(i)}return o.$id=i,o}function Fd(e){{e=wr(e);const t={};for(const r in e){const i=e[r];(Qi(i)||cd(i))&&(t[r]=pt(e,r))}return t}}const Xse=Hse();/*!
  * vue-router v4.4.0
  * (c) 2024 Eduardo San Martin Morote
  * @license MIT
  */const gf=typeof document<"u";function Kse(e){return e.__esModule||e[Symbol.toStringTag]==="Module"}const Jr=Object.assign;function gS(e,t){const r={};for(const i in t){const n=t[i];r[i]=ds(n)?n.map(e):e(n)}return r}const xv=()=>{},ds=Array.isArray,s6=/#/g,Qse=/&/g,Zse=/\//g,Jse=/=/g,ele=/\?/g,l6=/\+/g,tle=/%5B/g,rle=/%5D/g,c6=/%5E/g,ile=/%60/g,d6=/%7B/g,nle=/%7C/g,u6=/%7D/g,ale=/%20/g;function VT(e){return encodeURI(""+e).replace(nle,"|").replace(tle,"[").replace(rle,"]")}function ole(e){return VT(e).replace(d6,"{").replace(u6,"}").replace(c6,"^")}function pA(e){return VT(e).replace(l6,"%2B").replace(ale,"+").replace(s6,"%23").replace(Qse,"%26").replace(ile,"`").replace(d6,"{").replace(u6,"}").replace(c6,"^")}function sle(e){return pA(e).replace(Jse,"%3D")}function lle(e){return VT(e).replace(s6,"%23").replace(ele,"%3F")}function cle(e){return e==null?"":lle(e).replace(Zse,"%2F")}function Jv(e){try{return decodeURIComponent(""+e)}catch{}return""+e}const dle=/\/$/,ule=e=>e.replace(dle,"");function yS(e,t,r="/"){let i,n={},a="",o="";const s=t.indexOf("#");let l=t.indexOf("?");return s<l&&s>=0&&(l=-1),l>-1&&(i=t.slice(0,l),a=t.slice(l+1,s>-1?s:t.length),n=e(a)),s>-1&&(i=i||t.slice(0,s),o=t.slice(s,t.length)),i=mle(i??t,r),{fullPath:i+(a&&"?")+a+o,path:i,query:n,hash:Jv(o)}}function hle(e,t){const r=t.query?e(t.query):"";return t.path+(r&&"?")+r+(t.hash||"")}function uR(e,t){return!t||!e.toLowerCase().startsWith(t.toLowerCase())?e:e.slice(t.length)||"/"}function fle(e,t,r){const i=t.matched.length-1,n=r.matched.length-1;return i>-1&&i===n&&fp(t.matched[i],r.matched[n])&&h6(t.params,r.params)&&e(t.query)===e(r.query)&&t.hash===r.hash}function fp(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function h6(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(!ple(e[r],t[r]))return!1;return!0}function ple(e,t){return ds(e)?hR(e,t):ds(t)?hR(t,e):e===t}function hR(e,t){return ds(t)?e.length===t.length&&e.every((r,i)=>r===t[i]):e.length===1&&e[0]===t}function mle(e,t){if(e.startsWith("/"))return e;if(!e)return t;const r=t.split("/"),i=e.split("/"),n=i[i.length-1];(n===".."||n===".")&&i.push("");let a=r.length-1,o,s;for(o=0;o<i.length;o++)if(s=i[o],s!==".")if(s==="..")a>1&&a--;else break;return r.slice(0,a).join("/")+"/"+i.slice(o).join("/")}const wc={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var eg;(function(e){e.pop="pop",e.push="push"})(eg||(eg={}));var wv;(function(e){e.back="back",e.forward="forward",e.unknown=""})(wv||(wv={}));function vle(e){if(!e)if(gf){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),ule(e)}const gle=/^[^#]+#/;function yle(e,t){return e.replace(gle,"#")+t}function ble(e,t){const r=document.documentElement.getBoundingClientRect(),i=e.getBoundingClientRect();return{behavior:t.behavior,left:i.left-r.left-(t.left||0),top:i.top-r.top-(t.top||0)}}const U1=()=>({left:window.scrollX,top:window.scrollY});function xle(e){let t;if("el"in e){const r=e.el,i=typeof r=="string"&&r.startsWith("#"),n=typeof r=="string"?i?document.getElementById(r.slice(1)):document.querySelector(r):r;if(!n)return;t=ble(n,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.scrollX,t.top!=null?t.top:window.scrollY)}function fR(e,t){return(history.state?history.state.position-t:-1)+e}const mA=new Map;function wle(e,t){mA.set(e,t)}function Sle(e){const t=mA.get(e);return mA.delete(e),t}let Cle=()=>location.protocol+"//"+location.host;function f6(e,t){const{pathname:r,search:i,hash:n}=t,a=e.indexOf("#");if(a>-1){let s=n.includes(e.slice(a))?e.slice(a).length:1,l=n.slice(s);return l[0]!=="/"&&(l="/"+l),uR(l,"")}return uR(r,e)+i+n}function _le(e,t,r,i){let n=[],a=[],o=null;const s=({state:h})=>{const f=f6(e,location),p=r.value,v=t.value;let m=0;if(h){if(r.value=f,t.value=h,o&&o===p){o=null;return}m=v?h.position-v.position:0}else i(f);n.forEach(g=>{g(r.value,p,{delta:m,type:eg.pop,direction:m?m>0?wv.forward:wv.back:wv.unknown})})};function l(){o=r.value}function c(h){n.push(h);const f=()=>{const p=n.indexOf(h);p>-1&&n.splice(p,1)};return a.push(f),f}function d(){const{history:h}=window;h.state&&h.replaceState(Jr({},h.state,{scroll:U1()}),"")}function u(){for(const h of a)h();a=[],window.removeEventListener("popstate",s),window.removeEventListener("beforeunload",d)}return window.addEventListener("popstate",s),window.addEventListener("beforeunload",d,{passive:!0}),{pauseListeners:l,listen:c,destroy:u}}function pR(e,t,r,i=!1,n=!1){return{back:e,current:t,forward:r,replaced:i,position:window.history.length,scroll:n?U1():null}}function Ale(e){const{history:t,location:r}=window,i={value:f6(e,r)},n={value:t.state};n.value||a(i.value,{back:null,current:i.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function a(l,c,d){const u=e.indexOf("#"),h=u>-1?(r.host&&document.querySelector("base")?e:e.slice(u))+l:Cle()+e+l;try{t[d?"replaceState":"pushState"](c,"",h),n.value=c}catch(f){console.error(f),r[d?"replace":"assign"](h)}}function o(l,c){const d=Jr({},t.state,pR(n.value.back,l,n.value.forward,!0),c,{position:n.value.position});a(l,d,!0),i.value=l}function s(l,c){const d=Jr({},n.value,t.state,{forward:l,scroll:U1()});a(d.current,d,!0);const u=Jr({},pR(i.value,l,null),{position:d.position+1},c);a(l,u,!1),i.value=l}return{location:i,state:n,push:s,replace:o}}function Mle(e){e=vle(e);const t=Ale(e),r=_le(e,t.state,t.location,t.replace);function i(a,o=!0){o||r.pauseListeners(),history.go(a)}const n=Jr({location:"",base:e,go:i,createHref:yle.bind(null,e)},t,r);return Object.defineProperty(n,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(n,"state",{enumerable:!0,get:()=>t.state.value}),n}function Ele(e){return typeof e=="string"||e&&typeof e=="object"}function p6(e){return typeof e=="string"||typeof e=="symbol"}const m6=Symbol("");var mR;(function(e){e[e.aborted=4]="aborted",e[e.cancelled=8]="cancelled",e[e.duplicated=16]="duplicated"})(mR||(mR={}));function pp(e,t){return Jr(new Error,{type:e,[m6]:!0},t)}function gl(e,t){return e instanceof Error&&m6 in e&&(t==null||!!(e.type&t))}const vR="[^/]+?",Tle={sensitive:!1,strict:!1,start:!0,end:!0},Ple=/[.+*?^${}()[\]/\\]/g;function Dle(e,t){const r=Jr({},Tle,t),i=[];let n=r.start?"^":"";const a=[];for(const c of e){const d=c.length?[]:[90];r.strict&&!c.length&&(n+="/");for(let u=0;u<c.length;u++){const h=c[u];let f=40+(r.sensitive?.25:0);if(h.type===0)u||(n+="/"),n+=h.value.replace(Ple,"\\$&"),f+=40;else if(h.type===1){const{value:p,repeatable:v,optional:m,regexp:g}=h;a.push({name:p,repeatable:v,optional:m});const y=g||vR;if(y!==vR){f+=10;try{new RegExp(`(${y})`)}catch(x){throw new Error(`Invalid custom RegExp for param "${p}" (${y}): `+x.message)}}let b=v?`((?:${y})(?:/(?:${y}))*)`:`(${y})`;u||(b=m&&c.length<2?`(?:/${b})`:"/"+b),m&&(b+="?"),n+=b,f+=20,m&&(f+=-8),v&&(f+=-20),y===".*"&&(f+=-50)}d.push(f)}i.push(d)}if(r.strict&&r.end){const c=i.length-1;i[c][i[c].length-1]+=.7000000000000001}r.strict||(n+="/?"),r.end?n+="$":r.strict&&(n+="(?:/|$)");const o=new RegExp(n,r.sensitive?"":"i");function s(c){const d=c.match(o),u={};if(!d)return null;for(let h=1;h<d.length;h++){const f=d[h]||"",p=a[h-1];u[p.name]=f&&p.repeatable?f.split("/"):f}return u}function l(c){let d="",u=!1;for(const h of e){(!u||!d.endsWith("/"))&&(d+="/"),u=!1;for(const f of h)if(f.type===0)d+=f.value;else if(f.type===1){const{value:p,repeatable:v,optional:m}=f,g=p in c?c[p]:"";if(ds(g)&&!v)throw new Error(`Provided param "${p}" is an array but it is not repeatable (* or + modifiers)`);const y=ds(g)?g.join("/"):g;if(!y)if(m)h.length<2&&(d.endsWith("/")?d=d.slice(0,-1):u=!0);else throw new Error(`Missing required param "${p}"`);d+=y}}return d||"/"}return{re:o,score:i,keys:a,parse:s,stringify:l}}function Ole(e,t){let r=0;for(;r<e.length&&r<t.length;){const i=t[r]-e[r];if(i)return i;r++}return e.length<t.length?e.length===1&&e[0]===80?-1:1:e.length>t.length?t.length===1&&t[0]===80?1:-1:0}function v6(e,t){let r=0;const i=e.score,n=t.score;for(;r<i.length&&r<n.length;){const a=Ole(i[r],n[r]);if(a)return a;r++}if(Math.abs(n.length-i.length)===1){if(gR(i))return 1;if(gR(n))return-1}return n.length-i.length}function gR(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const Rle={type:0,value:""},Ile=/[a-zA-Z0-9_]/;function zle(e){if(!e)return[[]];if(e==="/")return[[Rle]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(f){throw new Error(`ERR (${r})/"${c}": ${f}`)}let r=0,i=r;const n=[];let a;function o(){a&&n.push(a),a=[]}let s=0,l,c="",d="";function u(){c&&(r===0?a.push({type:0,value:c}):r===1||r===2||r===3?(a.length>1&&(l==="*"||l==="+")&&t(`A repeatable param (${c}) must be alone in its segment. eg: '/:ids+.`),a.push({type:1,value:c,regexp:d,repeatable:l==="*"||l==="+",optional:l==="*"||l==="?"})):t("Invalid state to consume buffer"),c="")}function h(){c+=l}for(;s<e.length;){if(l=e[s++],l==="\\"&&r!==2){i=r,r=4;continue}switch(r){case 0:l==="/"?(c&&u(),o()):l===":"?(u(),r=1):h();break;case 4:h(),r=i;break;case 1:l==="("?r=2:Ile.test(l)?h():(u(),r=0,l!=="*"&&l!=="?"&&l!=="+"&&s--);break;case 2:l===")"?d[d.length-1]=="\\"?d=d.slice(0,-1)+l:r=3:d+=l;break;case 3:u(),r=0,l!=="*"&&l!=="?"&&l!=="+"&&s--,d="";break;default:t("Unknown state");break}}return r===2&&t(`Unfinished custom RegExp for param "${c}"`),u(),o(),n}function kle(e,t,r){const i=Dle(zle(e.path),r),n=Jr(i,{record:e,parent:t,children:[],alias:[]});return t&&!n.record.aliasOf==!t.record.aliasOf&&t.children.push(n),n}function Lle(e,t){const r=[],i=new Map;t=xR({strict:!1,end:!0,sensitive:!1},t);function n(u){return i.get(u)}function a(u,h,f){const p=!f,v=Ble(u);v.aliasOf=f&&f.record;const m=xR(t,u),g=[v];if("alias"in u){const x=typeof u.alias=="string"?[u.alias]:u.alias;for(const S of x)g.push(Jr({},v,{components:f?f.record.components:v.components,path:S,aliasOf:f?f.record:v}))}let y,b;for(const x of g){const{path:S}=x;if(h&&S[0]!=="/"){const w=h.record.path,_=w[w.length-1]==="/"?"":"/";x.path=h.record.path+(S&&_+S)}if(y=kle(x,h,m),f?f.alias.push(y):(b=b||y,b!==y&&b.alias.push(y),p&&u.name&&!bR(y)&&o(u.name)),g6(y)&&l(y),v.children){const w=v.children;for(let _=0;_<w.length;_++)a(w[_],y,f&&f.children[_])}f=f||y}return b?()=>{o(b)}:xv}function o(u){if(p6(u)){const h=i.get(u);h&&(i.delete(u),r.splice(r.indexOf(h),1),h.children.forEach(o),h.alias.forEach(o))}else{const h=r.indexOf(u);h>-1&&(r.splice(h,1),u.record.name&&i.delete(u.record.name),u.children.forEach(o),u.alias.forEach(o))}}function s(){return r}function l(u){const h=Ule(u,r);r.splice(h,0,u),u.record.name&&!bR(u)&&i.set(u.record.name,u)}function c(u,h){let f,p={},v,m;if("name"in u&&u.name){if(f=i.get(u.name),!f)throw pp(1,{location:u});m=f.record.name,p=Jr(yR(h.params,f.keys.filter(b=>!b.optional).concat(f.parent?f.parent.keys.filter(b=>b.optional):[]).map(b=>b.name)),u.params&&yR(u.params,f.keys.map(b=>b.name))),v=f.stringify(p)}else if(u.path!=null)v=u.path,f=r.find(b=>b.re.test(v)),f&&(p=f.parse(v),m=f.record.name);else{if(f=h.name?i.get(h.name):r.find(b=>b.re.test(h.path)),!f)throw pp(1,{location:u,currentLocation:h});m=f.record.name,p=Jr({},h.params,u.params),v=f.stringify(p)}const g=[];let y=f;for(;y;)g.unshift(y.record),y=y.parent;return{name:m,path:v,params:p,matched:g,meta:Nle(g)}}e.forEach(u=>a(u));function d(){r.length=0,i.clear()}return{addRoute:a,resolve:c,removeRoute:o,clearRoutes:d,getRoutes:s,getRecordMatcher:n}}function yR(e,t){const r={};for(const i of t)i in e&&(r[i]=e[i]);return r}function Ble(e){return{path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:void 0,beforeEnter:e.beforeEnter,props:Fle(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}}}function Fle(e){const t={},r=e.props||!1;if("component"in e)t.default=r;else for(const i in e.components)t[i]=typeof r=="object"?r[i]:r;return t}function bR(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function Nle(e){return e.reduce((t,r)=>Jr(t,r.meta),{})}function xR(e,t){const r={};for(const i in e)r[i]=i in t?t[i]:e[i];return r}function Ule(e,t){let r=0,i=t.length;for(;r!==i;){const a=r+i>>1;v6(e,t[a])<0?i=a:r=a+1}const n=jle(e);return n&&(i=t.lastIndexOf(n,i-1)),i}function jle(e){let t=e;for(;t=t.parent;)if(g6(t)&&v6(e,t)===0)return t}function g6({record:e}){return!!(e.name||e.components&&Object.keys(e.components).length||e.redirect)}function Vle(e){const t={};if(e===""||e==="?")return t;const i=(e[0]==="?"?e.slice(1):e).split("&");for(let n=0;n<i.length;++n){const a=i[n].replace(l6," "),o=a.indexOf("="),s=Jv(o<0?a:a.slice(0,o)),l=o<0?null:Jv(a.slice(o+1));if(s in t){let c=t[s];ds(c)||(c=t[s]=[c]),c.push(l)}else t[s]=l}return t}function wR(e){let t="";for(let r in e){const i=e[r];if(r=sle(r),i==null){i!==void 0&&(t+=(t.length?"&":"")+r);continue}(ds(i)?i.map(a=>a&&pA(a)):[i&&pA(i)]).forEach(a=>{a!==void 0&&(t+=(t.length?"&":"")+r,a!=null&&(t+="="+a))})}return t}function Hle(e){const t={};for(const r in e){const i=e[r];i!==void 0&&(t[r]=ds(i)?i.map(n=>n==null?null:""+n):i==null?i:""+i)}return t}const Wle=Symbol(""),SR=Symbol(""),j1=Symbol(""),HT=Symbol(""),vA=Symbol("");function fm(){let e=[];function t(i){return e.push(i),()=>{const n=e.indexOf(i);n>-1&&e.splice(n,1)}}function r(){e=[]}return{add:t,list:()=>e.slice(),reset:r}}function Wc(e,t,r,i,n,a=o=>o()){const o=i&&(i.enterCallbacks[n]=i.enterCallbacks[n]||[]);return()=>new Promise((s,l)=>{const c=h=>{h===!1?l(pp(4,{from:r,to:t})):h instanceof Error?l(h):Ele(h)?l(pp(2,{from:t,to:h})):(o&&i.enterCallbacks[n]===o&&typeof h=="function"&&o.push(h),s())},d=a(()=>e.call(i&&i.instances[n],t,r,c));let u=Promise.resolve(d);e.length<3&&(u=u.then(c)),u.catch(h=>l(h))})}function bS(e,t,r,i,n=a=>a()){const a=[];for(const o of e)for(const s in o.components){let l=o.components[s];if(!(t!=="beforeRouteEnter"&&!o.instances[s]))if(Gle(l)){const d=(l.__vccOpts||l)[t];d&&a.push(Wc(d,r,i,o,s,n))}else{let c=l();a.push(()=>c.then(d=>{if(!d)return Promise.reject(new Error(`Couldn't resolve component "${s}" at "${o.path}"`));const u=Kse(d)?d.default:d;o.components[s]=u;const f=(u.__vccOpts||u)[t];return f&&Wc(f,r,i,o,s,n)()}))}}return a}function Gle(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function CR(e){const t=_t(j1),r=_t(HT),i=re(()=>{const l=ke(e.to);return t.resolve(l)}),n=re(()=>{const{matched:l}=i.value,{length:c}=l,d=l[c-1],u=r.matched;if(!d||!u.length)return-1;const h=u.findIndex(fp.bind(null,d));if(h>-1)return h;const f=_R(l[c-2]);return c>1&&_R(d)===f&&u[u.length-1].path!==f?u.findIndex(fp.bind(null,l[c-2])):h}),a=re(()=>n.value>-1&&Yle(r.params,i.value.params)),o=re(()=>n.value>-1&&n.value===r.matched.length-1&&h6(r.params,i.value.params));function s(l={}){return qle(l)?t[ke(e.replace)?"replace":"push"](ke(e.to)).catch(xv):Promise.resolve()}return{route:i,href:re(()=>i.value.href),isActive:a,isExactActive:o,navigate:s}}const $le=Ve({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:CR,setup(e,{slots:t}){const r=Dd(CR(e)),{options:i}=_t(j1),n=re(()=>({[AR(e.activeClass,i.linkActiveClass,"router-link-active")]:r.isActive,[AR(e.exactActiveClass,i.linkExactActiveClass,"router-link-exact-active")]:r.isExactActive}));return()=>{const a=t.default&&t.default(r);return e.custom?a:E("a",{"aria-current":r.isExactActive?e.ariaCurrentValue:null,href:r.href,onClick:r.navigate,class:n.value},a)}}}),y6=$le;function qle(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function Yle(e,t){for(const r in t){const i=t[r],n=e[r];if(typeof i=="string"){if(i!==n)return!1}else if(!ds(n)||n.length!==i.length||i.some((a,o)=>a!==n[o]))return!1}return!0}function _R(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const AR=(e,t,r)=>e??t??r,Xle=Ve({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:r}){const i=_t(vA),n=re(()=>e.route||i.value),a=_t(SR,0),o=re(()=>{let c=ke(a);const{matched:d}=n.value;let u;for(;(u=d[c])&&!u.components;)c++;return c}),s=re(()=>n.value.matched[o.value]);br(SR,re(()=>o.value+1)),br(Wle,s),br(vA,n);const l=ge();return tr(()=>[l.value,s.value,e.name],([c,d,u],[h,f,p])=>{d&&(d.instances[u]=c,f&&f!==d&&c&&c===h&&(d.leaveGuards.size||(d.leaveGuards=f.leaveGuards),d.updateGuards.size||(d.updateGuards=f.updateGuards))),c&&d&&(!f||!fp(d,f)||!h)&&(d.enterCallbacks[u]||[]).forEach(v=>v(c))},{flush:"post"}),()=>{const c=n.value,d=e.name,u=s.value,h=u&&u.components[d];if(!h)return MR(r.default,{Component:h,route:c});const f=u.props[d],p=f?f===!0?c.params:typeof f=="function"?f(c):f:null,m=E(h,Jr({},p,t,{onVnodeUnmounted:g=>{g.component.isUnmounted&&(u.instances[d]=null)},ref:l}));return MR(r.default,{Component:m,route:c})||m}}});function MR(e,t){if(!e)return null;const r=e(t);return r.length===1?r[0]:r}const Kle=Xle;function Qle(e){const t=Lle(e.routes,e),r=e.parseQuery||Vle,i=e.stringifyQuery||wR,n=e.history,a=fm(),o=fm(),s=fm(),l=DF(wc);let c=wc;gf&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const d=gS.bind(null,Q=>""+Q),u=gS.bind(null,cle),h=gS.bind(null,Jv);function f(Q,ne){let V,de;return p6(Q)?(V=t.getRecordMatcher(Q),de=ne):de=Q,t.addRoute(de,V)}function p(Q){const ne=t.getRecordMatcher(Q);ne&&t.removeRoute(ne)}function v(){return t.getRoutes().map(Q=>Q.record)}function m(Q){return!!t.getRecordMatcher(Q)}function g(Q,ne){if(ne=Jr({},ne||l.value),typeof Q=="string"){const Z=yS(r,Q,ne.path),ue=t.resolve({path:Z.path},ne),Se=n.createHref(Z.fullPath);return Jr(Z,ue,{params:h(ue.params),hash:Jv(Z.hash),redirectedFrom:void 0,href:Se})}let V;if(Q.path!=null)V=Jr({},Q,{path:yS(r,Q.path,ne.path).path});else{const Z=Jr({},Q.params);for(const ue in Z)Z[ue]==null&&delete Z[ue];V=Jr({},Q,{params:u(Z)}),ne.params=u(ne.params)}const de=t.resolve(V,ne),me=Q.hash||"";de.params=d(h(de.params));const Ce=hle(i,Jr({},Q,{hash:ole(me),path:de.path})),G=n.createHref(Ce);return Jr({fullPath:Ce,hash:me,query:i===wR?Hle(Q.query):Q.query||{}},de,{redirectedFrom:void 0,href:G})}function y(Q){return typeof Q=="string"?yS(r,Q,l.value.path):Jr({},Q)}function b(Q,ne){if(c!==Q)return pp(8,{from:ne,to:Q})}function x(Q){return _(Q)}function S(Q){return x(Jr(y(Q),{replace:!0}))}function w(Q){const ne=Q.matched[Q.matched.length-1];if(ne&&ne.redirect){const{redirect:V}=ne;let de=typeof V=="function"?V(Q):V;return typeof de=="string"&&(de=de.includes("?")||de.includes("#")?de=y(de):{path:de},de.params={}),Jr({query:Q.query,hash:Q.hash,params:de.path!=null?{}:Q.params},de)}}function _(Q,ne){const V=c=g(Q),de=l.value,me=Q.state,Ce=Q.force,G=Q.replace===!0,Z=w(V);if(Z)return _(Jr(y(Z),{state:typeof Z=="object"?Jr({},me,Z.state):me,force:Ce,replace:G}),ne||V);const ue=V;ue.redirectedFrom=ne;let Se;return!Ce&&fle(i,de,V)&&(Se=pp(16,{to:ue,from:de}),X(de,de,!0,!1)),(Se?Promise.resolve(Se):M(ue,de)).catch(we=>gl(we)?gl(we,2)?we:te(we):U(we,ue,de)).then(we=>{if(we){if(gl(we,2))return _(Jr({replace:G},y(we.to),{state:typeof we.to=="object"?Jr({},me,we.to.state):me,force:Ce}),ne||ue)}else we=T(ue,de,!0,G,me);return P(ue,de,we),we})}function C(Q,ne){const V=b(Q,ne);return V?Promise.reject(V):Promise.resolve()}function A(Q){const ne=$.values().next().value;return ne&&typeof ne.runWithContext=="function"?ne.runWithContext(Q):Q()}function M(Q,ne){let V;const[de,me,Ce]=Zle(Q,ne);V=bS(de.reverse(),"beforeRouteLeave",Q,ne);for(const Z of de)Z.leaveGuards.forEach(ue=>{V.push(Wc(ue,Q,ne))});const G=C.bind(null,Q,ne);return V.push(G),ee(V).then(()=>{V=[];for(const Z of a.list())V.push(Wc(Z,Q,ne));return V.push(G),ee(V)}).then(()=>{V=bS(me,"beforeRouteUpdate",Q,ne);for(const Z of me)Z.updateGuards.forEach(ue=>{V.push(Wc(ue,Q,ne))});return V.push(G),ee(V)}).then(()=>{V=[];for(const Z of Ce)if(Z.beforeEnter)if(ds(Z.beforeEnter))for(const ue of Z.beforeEnter)V.push(Wc(ue,Q,ne));else V.push(Wc(Z.beforeEnter,Q,ne));return V.push(G),ee(V)}).then(()=>(Q.matched.forEach(Z=>Z.enterCallbacks={}),V=bS(Ce,"beforeRouteEnter",Q,ne,A),V.push(G),ee(V))).then(()=>{V=[];for(const Z of o.list())V.push(Wc(Z,Q,ne));return V.push(G),ee(V)}).catch(Z=>gl(Z,8)?Z:Promise.reject(Z))}function P(Q,ne,V){s.list().forEach(de=>A(()=>de(Q,ne,V)))}function T(Q,ne,V,de,me){const Ce=b(Q,ne);if(Ce)return Ce;const G=ne===wc,Z=gf?history.state:{};V&&(de||G?n.replace(Q.fullPath,Jr({scroll:G&&Z&&Z.scroll},me)):n.push(Q.fullPath,me)),l.value=Q,X(Q,ne,V,G),te()}let R;function z(){R||(R=n.listen((Q,ne,V)=>{if(!le.listening)return;const de=g(Q),me=w(de);if(me){_(Jr(me,{replace:!0}),de).catch(xv);return}c=de;const Ce=l.value;gf&&wle(fR(Ce.fullPath,V.delta),U1()),M(de,Ce).catch(G=>gl(G,12)?G:gl(G,2)?(_(G.to,de).then(Z=>{gl(Z,20)&&!V.delta&&V.type===eg.pop&&n.go(-1,!1)}).catch(xv),Promise.reject()):(V.delta&&n.go(-V.delta,!1),U(G,de,Ce))).then(G=>{G=G||T(de,Ce,!1),G&&(V.delta&&!gl(G,8)?n.go(-V.delta,!1):V.type===eg.pop&&gl(G,20)&&n.go(-1,!1)),P(de,Ce,G)}).catch(xv)}))}let F=fm(),H=fm(),N;function U(Q,ne,V){te(Q);const de=H.list();return de.length?de.forEach(me=>me(Q,ne,V)):console.error(Q),Promise.reject(Q)}function ie(){return N&&l.value!==wc?Promise.resolve():new Promise((Q,ne)=>{F.add([Q,ne])})}function te(Q){return N||(N=!Q,z(),F.list().forEach(([ne,V])=>Q?V(Q):ne()),F.reset()),Q}function X(Q,ne,V,de){const{scrollBehavior:me}=e;if(!gf||!me)return Promise.resolve();const Ce=!V&&Sle(fR(Q.fullPath,0))||(de||!V)&&history.state&&history.state.scroll||null;return ra().then(()=>me(Q,ne,Ce)).then(G=>G&&xle(G)).catch(G=>U(G,Q,ne))}const W=Q=>n.go(Q);let q;const $=new Set,le={currentRoute:l,listening:!0,addRoute:f,removeRoute:p,clearRoutes:t.clearRoutes,hasRoute:m,getRoutes:v,resolve:g,options:e,push:x,replace:S,go:W,back:()=>W(-1),forward:()=>W(1),beforeEach:a.add,beforeResolve:o.add,afterEach:s.add,onError:H.add,isReady:ie,install(Q){const ne=this;Q.component("RouterLink",y6),Q.component("RouterView",Kle),Q.config.globalProperties.$router=ne,Object.defineProperty(Q.config.globalProperties,"$route",{enumerable:!0,get:()=>ke(l)}),gf&&!q&&l.value===wc&&(q=!0,x(n.location).catch(me=>{}));const V={};for(const me in wc)Object.defineProperty(V,me,{get:()=>l.value[me],enumerable:!0});Q.provide(j1,ne),Q.provide(HT,EF(V)),Q.provide(vA,l);const de=Q.unmount;$.add(Q),Q.unmount=function(){$.delete(Q),$.size<1&&(c=wc,R&&R(),R=null,l.value=wc,q=!1,N=!1),de()}}};function ee(Q){return Q.reduce((ne,V)=>ne.then(()=>A(V)),Promise.resolve())}return le}function Zle(e,t){const r=[],i=[],n=[],a=Math.max(t.matched.length,e.matched.length);for(let o=0;o<a;o++){const s=t.matched[o];s&&(e.matched.find(c=>fp(c,s))?i.push(s):r.push(s));const l=e.matched[o];l&&(t.matched.find(c=>fp(c,l))||n.push(l))}return[r,i,n]}function Jle(){return _t(j1)}function WT(e){return _t(HT)}const Zu=o6("folderPicker",()=>{const{root:e,folderPicker:t,folderDrop:r}=ece();return{root:e,folderPicker:t,folderDrop:r}});function ece(){const e=ge(),t=async n=>{if(n.kind==="file")return n;n.children=[];const a=n.entries();for await(const o of a)n.children.push(await t(o[1]));return n};return{root:e,folderPicker:async n=>{try{if(!window.showDirectoryPicker){alert("Your browser is not support showDirectoryPicker");return}const a=await window.showDirectoryPicker();e.value=await t(a),e.value.category=n}catch(a){console.log(a)}},folderDrop:async(n,a)=>{try{if(n.kind==="file"){const o=await n.getAsFileSystemHandle();e.value=await t(o),e.value.category=a}}catch(o){console.log(o)}}}}const tce={class:"text-3xl font-bold underline"},rce=Ve({__name:"FHIRView",setup(e){const{root:t}=Fd(Zu());return console.log("test",t),(r,i)=>(ft(),Pt("div",tce," sda "))}}),ice="/DigitalTWINonFHIRFrontend/assets/logo-CcfZXeu8.png",nce=["src"],ace=Ve({__name:"AppLayoutHeader",setup(e){const t=ge(window.innerWidth),r=()=>{t.value=window.innerWidth};return Or(()=>{window.addEventListener("resize",r)}),Eg(()=>{window.removeEventListener("resize",r)}),(i,n)=>{const a=Od("RouterLink");return ft(),Ei(ke(Lu),{justify:"space-between",align:"center",style:{height:"100%",padding:"2px 20px"}},{default:tt(()=>[Be(a,{to:"/"},{default:tt(()=>[Be(ke(Lu),{class:"cursor-pointer"},{default:tt(()=>[Be(ke(AT),{size:"medium",src:"4.png"}),Be(ke(jU),{type:"info",class:"select-none"},{default:tt(()=>[Pr(" DigitalTWINs on FHIR ")]),_:1})]),_:1})]),_:1}),Ka(Be(ke(Lu),null,{default:tt(()=>[st("img",{class:"logo",src:ke(ice),alt:""},null,8,nce)]),_:1},512),[[Gu,t.value>699]])]),_:1})}}}),ul=(e,t)=>{const r=e.__vccOpts||e;for(const[i,n]of t)r[i]=n;return r},V1=ul(ace,[["__scopeId","data-v-1b84c3b1"]]),oce={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},sce=st("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M256 112v288"},null,-1),lce=st("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M400 256H112"},null,-1),cce=[sce,lce],dce=Ve({name:"AddOutline",render:function(t,r){return ft(),Pt("svg",oce,cce)}}),uce={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},hce=st("path",{d:"M256 160c16-63.16 76.43-95.41 208-96a15.94 15.94 0 0 1 16 16v288a16 16 0 0 1-16 16c-128 0-177.45 25.81-208 64c-30.37-38-80-64-208-64c-9.88 0-16-8.05-16-17.93V80a15.94 15.94 0 0 1 16-16c131.57.59 192 32.84 208 96z",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),fce=st("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M256 160v288"},null,-1),pce=[hce,fce],mce=Ve({name:"BookOutline",render:function(t,r){return ft(),Pt("svg",uce,pce)}}),vce={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},gce=st("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"48",d:"M328 112L184 256l144 144"},null,-1),yce=[gce],bce=Ve({name:"ChevronBackOutline",render:function(t,r){return ft(),Pt("svg",vce,yce)}}),xce={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},wce=st("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"48",d:"M184 112l144 144l-144 144"},null,-1),Sce=[wce],Cce=Ve({name:"ChevronForwardOutline",render:function(t,r){return ft(),Pt("svg",xce,Sce)}}),_ce={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Ace=st("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M368 368L144 144"},null,-1),Mce=st("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M368 144L144 368"},null,-1),Ece=[Ace,Mce],Tce=Ve({name:"CloseOutline",render:function(t,r){return ft(),Pt("svg",_ce,Ece)}}),Pce={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Dce=st("path",{d:"M456.7 242.27l-26.08-4.2a8 8 0 0 1-6.6-6.82c-.5-3.2-1-6.41-1.7-9.51a8.08 8.08 0 0 1 3.9-8.62l23.09-12.82a8.05 8.05 0 0 0 3.9-9.92l-4-11a7.94 7.94 0 0 0-9.4-5l-25.89 5a8 8 0 0 1-8.59-4.11q-2.25-4.2-4.8-8.41a8.16 8.16 0 0 1 .7-9.52l17.29-19.94a8 8 0 0 0 .3-10.62l-7.49-9a7.88 7.88 0 0 0-10.5-1.51l-22.69 13.63a8 8 0 0 1-9.39-.9c-2.4-2.11-4.9-4.21-7.4-6.22a8 8 0 0 1-2.5-9.11l9.4-24.75A8 8 0 0 0 365 78.77l-10.2-5.91a8 8 0 0 0-10.39 2.21l-16.64 20.84a7.15 7.15 0 0 1-8.5 2.5s-5.6-2.3-9.8-3.71A8 8 0 0 1 304 87l.4-26.45a8.07 8.07 0 0 0-6.6-8.42l-11.59-2a8.07 8.07 0 0 0-9.1 5.61l-8.6 25.05a8 8 0 0 1-7.79 5.41h-9.8a8.07 8.07 0 0 1-7.79-5.41l-8.6-25.05a8.07 8.07 0 0 0-9.1-5.61l-11.59 2a8.07 8.07 0 0 0-6.6 8.42l.4 26.45a8 8 0 0 1-5.49 7.71c-2.3.9-7.3 2.81-9.7 3.71c-2.8 1-6.1.2-8.8-2.91l-16.51-20.34A8 8 0 0 0 156.75 73l-10.2 5.91a7.94 7.94 0 0 0-3.3 10.09l9.4 24.75a8.06 8.06 0 0 1-2.5 9.11c-2.5 2-5 4.11-7.4 6.22a8 8 0 0 1-9.39.9L111 116.14a8 8 0 0 0-10.5 1.51l-7.49 9a8 8 0 0 0 .3 10.62l17.29 19.94a8 8 0 0 1 .7 9.52q-2.55 4-4.8 8.41a8.11 8.11 0 0 1-8.59 4.11l-25.89-5a8 8 0 0 0-9.4 5l-4 11a8.05 8.05 0 0 0 3.9 9.92L85.58 213a7.94 7.94 0 0 1 3.9 8.62c-.6 3.2-1.2 6.31-1.7 9.51a8.08 8.08 0 0 1-6.6 6.82l-26.08 4.2a8.09 8.09 0 0 0-7.1 7.92v11.72a7.86 7.86 0 0 0 7.1 7.92l26.08 4.2a8 8 0 0 1 6.6 6.82c.5 3.2 1 6.41 1.7 9.51a8.08 8.08 0 0 1-3.9 8.62L62.49 311.7a8.05 8.05 0 0 0-3.9 9.92l4 11a7.94 7.94 0 0 0 9.4 5l25.89-5a8 8 0 0 1 8.59 4.11q2.25 4.2 4.8 8.41a8.16 8.16 0 0 1-.7 9.52l-17.29 19.96a8 8 0 0 0-.3 10.62l7.49 9a7.88 7.88 0 0 0 10.5 1.51l22.69-13.63a8 8 0 0 1 9.39.9c2.4 2.11 4.9 4.21 7.4 6.22a8 8 0 0 1 2.5 9.11l-9.4 24.75a8 8 0 0 0 3.3 10.12l10.2 5.91a8 8 0 0 0 10.39-2.21l16.79-20.64c2.1-2.6 5.5-3.7 8.2-2.6c3.4 1.4 5.7 2.2 9.9 3.61a8 8 0 0 1 5.49 7.71l-.4 26.45a8.07 8.07 0 0 0 6.6 8.42l11.59 2a8.07 8.07 0 0 0 9.1-5.61l8.6-25a8 8 0 0 1 7.79-5.41h9.8a8.07 8.07 0 0 1 7.79 5.41l8.6 25a8.07 8.07 0 0 0 9.1 5.61l11.59-2a8.07 8.07 0 0 0 6.6-8.42l-.4-26.45a8 8 0 0 1 5.49-7.71c4.2-1.41 7-2.51 9.6-3.51s5.8-1 8.3 2.1l17 20.94A8 8 0 0 0 355 439l10.2-5.91a7.93 7.93 0 0 0 3.3-10.12l-9.4-24.75a8.08 8.08 0 0 1 2.5-9.12c2.5-2 5-4.1 7.4-6.21a8 8 0 0 1 9.39-.9L401 395.66a8 8 0 0 0 10.5-1.51l7.49-9a8 8 0 0 0-.3-10.62l-17.29-19.94a8 8 0 0 1-.7-9.52q2.55-4.05 4.8-8.41a8.11 8.11 0 0 1 8.59-4.11l25.89 5a8 8 0 0 0 9.4-5l4-11a8.05 8.05 0 0 0-3.9-9.92l-23.09-12.82a7.94 7.94 0 0 1-3.9-8.62c.6-3.2 1.2-6.31 1.7-9.51a8.08 8.08 0 0 1 6.6-6.82l26.08-4.2a8.09 8.09 0 0 0 7.1-7.92V250a8.25 8.25 0 0 0-7.27-7.73zM256 112a143.82 143.82 0 0 1 139.38 108.12A16 16 0 0 1 379.85 240H274.61a16 16 0 0 1-13.91-8.09l-52.1-91.71a16 16 0 0 1 9.85-23.39A146.94 146.94 0 0 1 256 112zM112 256a144 144 0 0 1 43.65-103.41a16 16 0 0 1 25.17 3.47L233.06 248a16 16 0 0 1 0 15.87l-52.67 91.7a16 16 0 0 1-25.18 3.36A143.94 143.94 0 0 1 112 256zm144 144a146.9 146.9 0 0 1-38.19-4.95a16 16 0 0 1-9.76-23.44l52.58-91.55a16 16 0 0 1 13.88-8H379.9a16 16 0 0 1 15.52 19.88A143.84 143.84 0 0 1 256 400z",fill:"currentColor"},null,-1),Oce=[Dce],Rce=Ve({name:"CogOutline",render:function(t,r){return ft(),Pt("svg",Pce,Oce)}}),Ice={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},zce=st("path",{d:"M416 221.25V416a48 48 0 0 1-48 48H144a48 48 0 0 1-48-48V96a48 48 0 0 1 48-48h98.75a32 32 0 0 1 22.62 9.37l141.26 141.26a32 32 0 0 1 9.37 22.62z",fill:"none",stroke:"currentColor","stroke-linejoin":"round","stroke-width":"32"},null,-1),kce=st("path",{d:"M256 56v120a32 32 0 0 0 32 32h120",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),Lce=[zce,kce],Bce=Ve({name:"DocumentOutline",render:function(t,r){return ft(),Pt("svg",Ice,Lce)}}),Fce={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Nce=x1('<path d="M464 256c0-114.87-93.13-208-208-208S48 141.13 48 256s93.13 208 208 208s208-93.13 208-208z" fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="32"></path><path d="M445.57 172.14c-16.06.1-14.48 29.73-34.49 15.75c-7.43-5.18-12-12.71-21.33-15c-8.15-2-16.5.08-24.55 1.47c-9.15 1.58-20 2.29-26.94 9.22c-6.71 6.67-10.26 15.62-17.4 22.33c-13.81 13-19.64 27.19-10.7 45.57c8.6 17.67 26.59 27.26 46 26c19.07-1.27 38.88-12.33 38.33 15.38c-.2 9.8 1.85 16.6 4.86 25.71c2.79 8.4 2.6 16.54 3.24 25.21c1.18 16.2 4.16 34.36 12.2 48.67l15-21.16c1.85-2.62 5.72-6.29 6.64-9.38c1.63-5.47-1.58-14.87-1.95-21s-.19-12.34-1.13-18.47c-1.32-8.59-6.4-16.64-7.1-25.13c-1.29-15.81 1.6-28.43-10.58-41.65c-11.76-12.75-29-15.81-45.47-13.22c-8.3 1.3-41.71 6.64-28.3-12.33c2.65-3.73 7.28-6.79 10.26-10.34c2.59-3.09 4.84-8.77 7.88-11.18s17-5.18 21-3.95s8.17 7 11.64 9.56a49.89 49.89 0 0 0 21.81 9.36c13.66 2 42.22-5.94 42-23.46c-.04-8.4-7.84-20.1-10.92-27.96z" fill="currentColor"></path><path d="M287.45 316.3c-5.33-22.44-35.82-29.94-52.26-42.11c-9.45-7-17.86-17.81-30.27-18.69c-5.72-.41-10.51.83-16.18-.64c-5.2-1.34-9.28-4.14-14.82-3.41c-10.35 1.36-16.88 12.42-28 10.92c-10.55-1.42-21.42-13.76-23.82-23.81c-3.08-12.92 7.14-17.11 18.09-18.26c4.57-.48 9.7-1 14.09.67c5.78 2.15 8.51 7.81 13.7 10.67c9.73 5.33 11.7-3.19 10.21-11.83c-2.23-12.94-4.83-18.22 6.71-27.12c8-6.14 14.84-10.58 13.56-21.61c-.76-6.48-4.31-9.41-1-15.86c2.51-4.91 9.4-9.34 13.89-12.27c11.59-7.56 49.65-7 34.1-28.16c-4.57-6.21-13-17.31-21-18.83c-10-1.89-14.44 9.27-21.41 14.19c-7.2 5.09-21.22 10.87-28.43 3c-9.7-10.59 6.43-14.07 10-21.46s-8.27-21.36-14.61-24.9l-29.81 33.43a41.52 41.52 0 0 0 8.34 31.86c5.93 7.63 15.37 10.08 15.8 20.5c.42 10-1.14 15.12-7.68 22.15c-2.83 3-4.83 7.26-7.71 10.07c-3.53 3.43-2.22 2.38-7.73 3.32c-10.36 1.75-19.18 4.45-29.19 7.21C95.34 199.94 93.8 172.69 86.2 162l-25 20.19c-.27 3.31 4.1 9.4 5.29 13c6.83 20.57 20.61 36.48 29.51 56.16c9.37 20.84 34.53 15.06 45.64 33.32c9.86 16.2-.67 36.71 6.71 53.67c5.36 12.31 18 15 26.72 24c8.91 9.09 8.72 21.53 10.08 33.36a305.22 305.22 0 0 0 7.45 41.28c1.21 4.69 2.32 10.89 5.53 14.76c2.2 2.66 9.75 4.95 6.7 5.83c4.26.7 11.85 4.68 15.4 1.76c4.68-3.84 3.43-15.66 4.24-21c2.43-15.9 10.39-31.45 21.13-43.35c10.61-11.74 25.15-19.69 34.11-33c8.73-12.98 11.36-30.49 7.74-45.68zm-33.39 26.32c-6 10.71-19.36 17.88-27.95 26.39c-2.33 2.31-7.29 10.31-10.21 8.58c-2.09-1.24-2.8-11.62-3.57-14a61.17 61.17 0 0 0-21.71-29.95c-3.13-2.37-10.89-5.45-12.68-8.7c-2-3.53-.2-11.86-.13-15.7c.11-5.6-2.44-14.91-1.06-20c1.6-5.87-1.48-2.33 3.77-3.49c2.77-.62 14.21 1.39 17.66 2.11c5.48 1.14 8.5 4.55 12.82 8c11.36 9.11 23.87 16.16 36.6 23.14c9.86 5.46 12.76 12.37 6.46 23.62z" fill="currentColor"></path><path d="M184.46 67.09c4.74 4.63 9.2 10.11 16.27 10.57c6.69.45 13-3.17 18.84 1.38c6.48 5 11.15 11.33 19.75 12.89c8.32 1.51 17.13-3.35 19.19-11.86c2-8.11-2.31-16.93-2.57-25.07c0-1.13.61-6.15-.17-7c-.58-.64-5.42.08-6.16.1q-8.13.24-16.22 1.12a207.1 207.1 0 0 0-57.18 14.65c2.43 1.68 5.48 2.35 8.25 3.22z" fill="currentColor"></path><path d="M356.4 123.27c8.49 0 17.11-3.8 14.37-13.62c-2.3-8.23-6.22-17.16-15.76-12.72c-6.07 2.82-14.67 10-15.38 17.12c-.81 8.08 11.11 9.22 16.77 9.22z" fill="currentColor"></path><path d="M349.62 166.24c8.67 5.19 21.53 2.75 28.07-4.66c5.11-5.8 8.12-15.87 17.31-15.86a15.4 15.4 0 0 1 10.82 4.41c3.8 3.93 3.05 7.62 3.86 12.54c1.81 11.05 13.66.63 16.75-3.65c2-2.79 4.71-6.93 3.8-10.56c-.84-3.39-4.8-7-6.56-10.11c-5.14-9-9.37-19.47-17.07-26.74c-7.41-7-16.52-6.19-23.55 1.08c-5.76 6-12.45 10.75-16.39 18.05c-2.78 5.13-5.91 7.58-11.54 8.91c-3.1.73-6.64 1-9.24 3.08c-7.24 5.7-3.12 19.39 3.74 23.51z" fill="currentColor"></path>',6),Uce=[Nce],jce=Ve({name:"EarthOutline",render:function(t,r){return ft(),Pt("svg",Fce,Uce)}}),Vce={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Hce=st("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M413.66 246.1H386a2 2 0 0 1-2-2v-77.24A38.86 38.86 0 0 0 345.14 128H267.9a2 2 0 0 1-2-2V98.34c0-27.14-21.5-49.86-48.64-50.33a49.53 49.53 0 0 0-50.4 49.51V126a2 2 0 0 1-2 2H87.62A39.74 39.74 0 0 0 48 167.62V238a2 2 0 0 0 2 2h26.91c29.37 0 53.68 25.48 54.09 54.85c.42 29.87-23.51 57.15-53.29 57.15H50a2 2 0 0 0-2 2v70.38A39.74 39.74 0 0 0 87.62 464H158a2 2 0 0 0 2-2v-20.93c0-30.28 24.75-56.35 55-57.06c30.1-.7 57 20.31 57 50.28V462a2 2 0 0 0 2 2h71.14A38.86 38.86 0 0 0 384 425.14v-78a2 2 0 0 1 2-2h28.48c27.63 0 49.52-22.67 49.52-50.4s-23.2-48.64-50.34-48.64z"},null,-1),Wce=[Hce],Gce=Ve({name:"ExtensionPuzzleOutline",render:function(t,r){return ft(),Pt("svg",Vce,Wce)}}),$ce={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},qce=st("path",{d:"M64 192v-72a40 40 0 0 1 40-40h75.89a40 40 0 0 1 22.19 6.72l27.84 18.56a40 40 0 0 0 22.19 6.72H408a40 40 0 0 1 40 40v40",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),Yce=st("path",{d:"M479.9 226.55L463.68 392a40 40 0 0 1-39.93 40H88.25a40 40 0 0 1-39.93-40L32.1 226.55A32 32 0 0 1 64 192h384.1a32 32 0 0 1 31.8 34.55z",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),Xce=[qce,Yce],Kce=Ve({name:"FolderOpenOutline",render:function(t,r){return ft(),Pt("svg",$ce,Xce)}}),Qce={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Zce=st("path",{d:"M440 432H72a40 40 0 0 1-40-40V120a40 40 0 0 1 40-40h75.89a40 40 0 0 1 22.19 6.72l27.84 18.56a40 40 0 0 0 22.19 6.72H440a40 40 0 0 1 40 40v240a40 40 0 0 1-40 40z",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),Jce=st("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M32 192h448"},null,-1),ede=[Zce,Jce],tde=Ve({name:"FolderOutline",render:function(t,r){return ft(),Pt("svg",Qce,ede)}}),rde={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},ide=x1('<path d="M467.51 248.83c-18.4-83.18-45.69-136.24-89.43-149.17A91.5 91.5 0 0 0 352 96c-26.89 0-48.11 16-96 16s-69.15-16-96-16a99.09 99.09 0 0 0-27.2 3.66C89 112.59 61.94 165.7 43.33 248.83c-19 84.91-15.56 152 21.58 164.88c26 9 49.25-9.61 71.27-37c25-31.2 55.79-40.8 119.82-40.8s93.62 9.6 118.66 40.8c22 27.41 46.11 45.79 71.42 37.16c41.02-14.01 40.44-79.13 21.43-165.04z" fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="32"></path><circle cx="292" cy="224" r="20" fill="currentColor"></circle><path d="M336 288a20 20 0 1 1 20-19.95A20 20 0 0 1 336 288z" fill="currentColor"></path><circle cx="336" cy="180" r="20" fill="currentColor"></circle><circle cx="380" cy="224" r="20" fill="currentColor"></circle><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M160 176v96"></path><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M208 224h-96"></path>',7),nde=[ide],ade=Ve({name:"GameControllerOutline",render:function(t,r){return ft(),Pt("svg",rde,nde)}}),ode={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},sde=st("rect",{x:"48",y:"48",width:"176",height:"176",rx:"20",ry:"20",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),lde=st("rect",{x:"288",y:"48",width:"176",height:"176",rx:"20",ry:"20",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),cde=st("rect",{x:"48",y:"288",width:"176",height:"176",rx:"20",ry:"20",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),dde=st("rect",{x:"288",y:"288",width:"176",height:"176",rx:"20",ry:"20",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),ude=[sde,lde,cde,dde],hde=Ve({name:"GridOutline",render:function(t,r){return ft(),Pt("svg",ode,ude)}}),fde={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},pde=st("rect",{x:"48",y:"96",width:"416",height:"304",rx:"32.14",ry:"32.14",fill:"none",stroke:"currentColor","stroke-linejoin":"round","stroke-width":"32"},null,-1),mde=st("path",{stroke:"currentColor","stroke-linecap":"round","stroke-miterlimit":"10","stroke-width":"32",d:"M16 416h480",fill:"currentColor"},null,-1),vde=[pde,mde],gde=Ve({name:"LaptopOutline",render:function(t,r){return ft(),Pt("svg",fde,vde)}}),yde={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},bde=x1('<rect x="32" y="96" width="64" height="368" rx="16" ry="16" fill="none" stroke="currentColor" stroke-linejoin="round" stroke-width="32"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M112 224h128"></path><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M112 400h128"></path><rect x="112" y="160" width="128" height="304" rx="16" ry="16" fill="none" stroke="currentColor" stroke-linejoin="round" stroke-width="32"></rect><rect x="256" y="48" width="96" height="416" rx="16" ry="16" fill="none" stroke="currentColor" stroke-linejoin="round" stroke-width="32"></rect><path d="M422.46 96.11l-40.4 4.25c-11.12 1.17-19.18 11.57-17.93 23.1l34.92 321.59c1.26 11.53 11.37 20 22.49 18.84l40.4-4.25c11.12-1.17 19.18-11.57 17.93-23.1L445 115c-1.31-11.58-11.42-20.06-22.54-18.89z" fill="none" stroke="currentColor" stroke-linejoin="round" stroke-width="32"></path>',6),xde=[bde],wde=Ve({name:"LibraryOutline",render:function(t,r){return ft(),Pt("svg",yde,xde)}}),Sde={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Cde=st("path",{d:"M344 144c-3.92 52.87-44 96-88 96s-84.15-43.12-88-96c-4-55 35-96 88-96s92 42 88 96z",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),_de=st("path",{d:"M256 304c-87 0-175.3 48-191.64 138.6C62.39 453.52 68.57 464 80 464h352c11.44 0 17.62-10.48 15.65-21.4C431.3 352 343 304 256 304z",fill:"none",stroke:"currentColor","stroke-miterlimit":"10","stroke-width":"32"},null,-1),Ade=[Cde,_de],Mde=Ve({name:"PersonOutline",render:function(t,r){return ft(),Pt("svg",Sde,Ade)}}),Ede={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Tde=st("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M400 256H112"},null,-1),Pde=[Tde],Dde=Ve({name:"RemoveOutline",render:function(t,r){return ft(),Pt("svg",Ede,Pde)}}),Ode={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Rde=st("path",{d:"M461.81 53.81a4.4 4.4 0 0 0-3.3-3.39c-54.38-13.3-180 34.09-248.13 102.17a294.9 294.9 0 0 0-33.09 39.08c-21-1.9-42-.3-59.88 7.5c-50.49 22.2-65.18 80.18-69.28 105.07a9 9 0 0 0 9.8 10.4l81.07-8.9a180.29 180.29 0 0 0 1.1 18.3a18.15 18.15 0 0 0 5.3 11.09l31.39 31.39a18.15 18.15 0 0 0 11.1 5.3a179.91 179.91 0 0 0 18.19 1.1l-8.89 81a9 9 0 0 0 10.39 9.79c24.9-4 83-18.69 105.07-69.17c7.8-17.9 9.4-38.79 7.6-59.69a293.91 293.91 0 0 0 39.19-33.09c68.38-68 115.47-190.86 102.37-247.95zM298.66 213.67a42.7 42.7 0 1 1 60.38 0a42.65 42.65 0 0 1-60.38 0z",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),Ide=st("path",{d:"M109.64 352a45.06 45.06 0 0 0-26.35 12.84C65.67 382.52 64 448 64 448s65.52-1.67 83.15-19.31A44.73 44.73 0 0 0 160 402.32",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),zde=[Rde,Ide],kde=Ve({name:"RocketOutline",render:function(t,r){return ft(),Pt("svg",Ode,zde)}}),Lde={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Bde=st("path",{d:"M398.57 80H113.43v16S87.51 272 256 272S398.57 96 398.57 96z",fill:"none",stroke:"currentColor","stroke-linejoin":"round","stroke-width":"32"},null,-1),Fde=st("path",{fill:"none",stroke:"currentColor","stroke-linejoin":"round","stroke-width":"32",d:"M256 272v160"},null,-1),Nde=st("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M352 432H160"},null,-1),Ude=st("path",{fill:"none",stroke:"currentColor","stroke-linejoin":"round","stroke-width":"32",d:"M112 160h288"},null,-1),jde=[Bde,Fde,Nde,Ude],Vde=Ve({name:"WineOutline",render:function(t,r){return ft(),Pt("svg",Lde,jde)}});function Ug(){return{BookIcon:mce,PersonIcon:Mde,WineIcon:Vde,EarthIcon:jce,CogIcon:Rce,RocketIcon:kde,LaptopIcon:gde,LibraryIcon:wde,GameControllerIcon:ade,ExtensionPuzzleIcon:Gce,FolderIcon:tde,FolderOpenIcon:Kce,DocumentIcon:Bce,GridIcon:hde,AddIcon:dce,CloseIcon:Tce,RemoveIcon:Dde,ChevronBackIcon:bce,ChevronForwardIcon:Cce}}const b6=Ve({__name:"AppLayoutFooter",setup(e){const{EarthIcon:t}=Ug();return(r,i)=>(ft(),Ei(ke(Lu),{justify:"center",align:"center",style:{height:"100%",padding:"5px 0px"}},{default:tt(()=>[Be(ke(z1),{size:"20"},{default:tt(()=>[Be(ke(t))]),_:1}),Be(ke(jU),{type:"error"},{default:tt(()=>[Pr(" Auckland Bioengineering Institute ")]),_:1})]),_:1}))}}),x6=Ve({__name:"AppLayoutSider",props:{width:{default:240},menuOptions:{default:()=>[]}},setup(e){const r=Dd(e),{menuOptions:i,width:n}=IF(r);return(a,o)=>(ft(),Ei(ke(ise),{"collapse-mode":"width","collapsed-width":60,width:ke(n),"native-scrollbar":!1,bordered:"","show-trigger":"bar",class:"bg-transparent shadow-sm"},{default:tt(()=>[Be(ke(fse),{"collapsed-width":64,"collapsed-icon-size":22,options:ke(i)},null,8,["options"])]),_:1},8,["width"]))}});function w6(){return{renderIcon:r=>()=>E(z1,null,{default:()=>E(r)}),generateRouterLabel:(r,i,n,a)=>E(y6,{to:{name:r,params:n||{},query:a||{}}},{default:()=>i})}}const Hde=Ve({__name:"AppLayoutFHIR",setup(e){const{renderIcon:t,generateRouterLabel:r}=w6(),{CogIcon:i,LaptopIcon:n,GameControllerIcon:a,RocketIcon:o,LibraryIcon:s}=Ug(),l=[{label:()=>r("home-annotator","Go Annotator"),key:"overall",icon:t(n)},{label:()=>r("fhir-measurements","Measurements"),key:"primary-measurements",disabled:!1,icon:t(s),children:[{label:()=>r("fhir-patients","Patients"),key:"patients",icon:t(i)}]},{label:"Workflow",key:"Workflow",icon:t(o),children:[{label:"Workflow Tools",key:"tools",icon:t(i)},{label:"Workflow process",key:"process",icon:t(a)}]}];return(c,d)=>{const u=Od("router-view");return ft(),Ei(ke(jf),{style:{height:"100vh"}},{default:tt(()=>[Be(ke(WU),{bordered:"",style:{height:"8vh"}},{default:tt(()=>[Be(V1)]),_:1}),Be(ke(jf),{position:"absolute",style:{top:"8vh",bottom:"5vh"},"has-sider":"",onDragover:d[0]||(d[0]=Af(()=>{},["prevent"])),onDrop:d[1]||(d[1]=h=>h.preventDefault())},{default:tt(()=>[Be(x6,{"menu-options":l}),Be(ke(jf),{"content-style":"padding: 10px 50px;","native-scrollbar":!1},{default:tt(()=>[Be(u)]),_:1})]),_:1}),Be(ke(GU),{position:"absolute",style:{height:"5vh"},bordered:""},{default:tt(()=>[Be(b6)]),_:1})]),_:1})}}});function S6(e,t){return function(){return e.apply(t,arguments)}}const{toString:Wde}=Object.prototype,{getPrototypeOf:GT}=Object,H1=(e=>t=>{const r=Wde.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),vs=e=>(e=e.toLowerCase(),t=>H1(t)===e),W1=e=>t=>typeof t===e,{isArray:Fp}=Array,tg=W1("undefined");function Gde(e){return e!==null&&!tg(e)&&e.constructor!==null&&!tg(e.constructor)&&Ro(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const C6=vs("ArrayBuffer");function $de(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&C6(e.buffer),t}const qde=W1("string"),Ro=W1("function"),_6=W1("number"),G1=e=>e!==null&&typeof e=="object",Yde=e=>e===!0||e===!1,ub=e=>{if(H1(e)!=="object")return!1;const t=GT(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},Xde=vs("Date"),Kde=vs("File"),Qde=vs("Blob"),Zde=vs("FileList"),Jde=e=>G1(e)&&Ro(e.pipe),eue=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||Ro(e.append)&&((t=H1(e))==="formdata"||t==="object"&&Ro(e.toString)&&e.toString()==="[object FormData]"))},tue=vs("URLSearchParams"),[rue,iue,nue,aue]=["ReadableStream","Request","Response","Headers"].map(vs),oue=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function jg(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let i,n;if(typeof e!="object"&&(e=[e]),Fp(e))for(i=0,n=e.length;i<n;i++)t.call(null,e[i],i,e);else{const a=r?Object.getOwnPropertyNames(e):Object.keys(e),o=a.length;let s;for(i=0;i<o;i++)s=a[i],t.call(null,e[s],s,e)}}function A6(e,t){t=t.toLowerCase();const r=Object.keys(e);let i=r.length,n;for(;i-- >0;)if(n=r[i],t===n.toLowerCase())return n;return null}const M6=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,E6=e=>!tg(e)&&e!==M6;function gA(){const{caseless:e}=E6(this)&&this||{},t={},r=(i,n)=>{const a=e&&A6(t,n)||n;ub(t[a])&&ub(i)?t[a]=gA(t[a],i):ub(i)?t[a]=gA({},i):Fp(i)?t[a]=i.slice():t[a]=i};for(let i=0,n=arguments.length;i<n;i++)arguments[i]&&jg(arguments[i],r);return t}const sue=(e,t,r,{allOwnKeys:i}={})=>(jg(t,(n,a)=>{r&&Ro(n)?e[a]=S6(n,r):e[a]=n},{allOwnKeys:i}),e),lue=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),cue=(e,t,r,i)=>{e.prototype=Object.create(t.prototype,i),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},due=(e,t,r,i)=>{let n,a,o;const s={};if(t=t||{},e==null)return t;do{for(n=Object.getOwnPropertyNames(e),a=n.length;a-- >0;)o=n[a],(!i||i(o,e,t))&&!s[o]&&(t[o]=e[o],s[o]=!0);e=r!==!1&&GT(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},uue=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const i=e.indexOf(t,r);return i!==-1&&i===r},hue=e=>{if(!e)return null;if(Fp(e))return e;let t=e.length;if(!_6(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},fue=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&GT(Uint8Array)),pue=(e,t)=>{const i=(e&&e[Symbol.iterator]).call(e);let n;for(;(n=i.next())&&!n.done;){const a=n.value;t.call(e,a[0],a[1])}},mue=(e,t)=>{let r;const i=[];for(;(r=e.exec(t))!==null;)i.push(r);return i},vue=vs("HTMLFormElement"),gue=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,i,n){return i.toUpperCase()+n}),ER=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),yue=vs("RegExp"),T6=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),i={};jg(r,(n,a)=>{let o;(o=t(n,a,e))!==!1&&(i[a]=o||n)}),Object.defineProperties(e,i)},bue=e=>{T6(e,(t,r)=>{if(Ro(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const i=e[r];if(Ro(i)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},xue=(e,t)=>{const r={},i=n=>{n.forEach(a=>{r[a]=!0})};return Fp(e)?i(e):i(String(e).split(t)),r},wue=()=>{},Sue=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t,xS="abcdefghijklmnopqrstuvwxyz",TR="0123456789",P6={DIGIT:TR,ALPHA:xS,ALPHA_DIGIT:xS+xS.toUpperCase()+TR},Cue=(e=16,t=P6.ALPHA_DIGIT)=>{let r="";const{length:i}=t;for(;e--;)r+=t[Math.random()*i|0];return r};function _ue(e){return!!(e&&Ro(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const Aue=e=>{const t=new Array(10),r=(i,n)=>{if(G1(i)){if(t.indexOf(i)>=0)return;if(!("toJSON"in i)){t[n]=i;const a=Fp(i)?[]:{};return jg(i,(o,s)=>{const l=r(o,n+1);!tg(l)&&(a[s]=l)}),t[n]=void 0,a}}return i};return r(e,0)},Mue=vs("AsyncFunction"),Eue=e=>e&&(G1(e)||Ro(e))&&Ro(e.then)&&Ro(e.catch),Xe={isArray:Fp,isArrayBuffer:C6,isBuffer:Gde,isFormData:eue,isArrayBufferView:$de,isString:qde,isNumber:_6,isBoolean:Yde,isObject:G1,isPlainObject:ub,isReadableStream:rue,isRequest:iue,isResponse:nue,isHeaders:aue,isUndefined:tg,isDate:Xde,isFile:Kde,isBlob:Qde,isRegExp:yue,isFunction:Ro,isStream:Jde,isURLSearchParams:tue,isTypedArray:fue,isFileList:Zde,forEach:jg,merge:gA,extend:sue,trim:oue,stripBOM:lue,inherits:cue,toFlatObject:due,kindOf:H1,kindOfTest:vs,endsWith:uue,toArray:hue,forEachEntry:pue,matchAll:mue,isHTMLForm:vue,hasOwnProperty:ER,hasOwnProp:ER,reduceDescriptors:T6,freezeMethods:bue,toObjectSet:xue,toCamelCase:gue,noop:wue,toFiniteNumber:Sue,findKey:A6,global:M6,isContextDefined:E6,ALPHABET:P6,generateString:Cue,isSpecCompliantForm:_ue,toJSONObject:Aue,isAsyncFn:Mue,isThenable:Eue};function fr(e,t,r,i,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),i&&(this.request=i),n&&(this.response=n)}Xe.inherits(fr,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Xe.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const D6=fr.prototype,O6={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{O6[e]={value:e}});Object.defineProperties(fr,O6);Object.defineProperty(D6,"isAxiosError",{value:!0});fr.from=(e,t,r,i,n,a)=>{const o=Object.create(D6);return Xe.toFlatObject(e,o,function(l){return l!==Error.prototype},s=>s!=="isAxiosError"),fr.call(o,e.message,t,r,i,n),o.cause=e,o.name=e.name,a&&Object.assign(o,a),o};const Tue=null;function yA(e){return Xe.isPlainObject(e)||Xe.isArray(e)}function R6(e){return Xe.endsWith(e,"[]")?e.slice(0,-2):e}function PR(e,t,r){return e?e.concat(t).map(function(n,a){return n=R6(n),!r&&a?"["+n+"]":n}).join(r?".":""):t}function Pue(e){return Xe.isArray(e)&&!e.some(yA)}const Due=Xe.toFlatObject(Xe,{},null,function(t){return/^is[A-Z]/.test(t)});function $1(e,t,r){if(!Xe.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=Xe.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(v,m){return!Xe.isUndefined(m[v])});const i=r.metaTokens,n=r.visitor||d,a=r.dots,o=r.indexes,l=(r.Blob||typeof Blob<"u"&&Blob)&&Xe.isSpecCompliantForm(t);if(!Xe.isFunction(n))throw new TypeError("visitor must be a function");function c(p){if(p===null)return"";if(Xe.isDate(p))return p.toISOString();if(!l&&Xe.isBlob(p))throw new fr("Blob is not supported. Use a Buffer instead.");return Xe.isArrayBuffer(p)||Xe.isTypedArray(p)?l&&typeof Blob=="function"?new Blob([p]):Buffer.from(p):p}function d(p,v,m){let g=p;if(p&&!m&&typeof p=="object"){if(Xe.endsWith(v,"{}"))v=i?v:v.slice(0,-2),p=JSON.stringify(p);else if(Xe.isArray(p)&&Pue(p)||(Xe.isFileList(p)||Xe.endsWith(v,"[]"))&&(g=Xe.toArray(p)))return v=R6(v),g.forEach(function(b,x){!(Xe.isUndefined(b)||b===null)&&t.append(o===!0?PR([v],x,a):o===null?v:v+"[]",c(b))}),!1}return yA(p)?!0:(t.append(PR(m,v,a),c(p)),!1)}const u=[],h=Object.assign(Due,{defaultVisitor:d,convertValue:c,isVisitable:yA});function f(p,v){if(!Xe.isUndefined(p)){if(u.indexOf(p)!==-1)throw Error("Circular reference detected in "+v.join("."));u.push(p),Xe.forEach(p,function(g,y){(!(Xe.isUndefined(g)||g===null)&&n.call(t,g,Xe.isString(y)?y.trim():y,v,h))===!0&&f(g,v?v.concat(y):[y])}),u.pop()}}if(!Xe.isObject(e))throw new TypeError("data must be an object");return f(e),t}function DR(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(i){return t[i]})}function $T(e,t){this._pairs=[],e&&$1(e,this,t)}const I6=$T.prototype;I6.append=function(t,r){this._pairs.push([t,r])};I6.toString=function(t){const r=t?function(i){return t.call(this,i,DR)}:DR;return this._pairs.map(function(n){return r(n[0])+"="+r(n[1])},"").join("&")};function Oue(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function z6(e,t,r){if(!t)return e;const i=r&&r.encode||Oue,n=r&&r.serialize;let a;if(n?a=n(t,r):a=Xe.isURLSearchParams(t)?t.toString():new $T(t,r).toString(i),a){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+a}return e}class OR{constructor(){this.handlers=[]}use(t,r,i){return this.handlers.push({fulfilled:t,rejected:r,synchronous:i?i.synchronous:!1,runWhen:i?i.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){Xe.forEach(this.handlers,function(i){i!==null&&t(i)})}}const k6={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Rue=typeof URLSearchParams<"u"?URLSearchParams:$T,Iue=typeof FormData<"u"?FormData:null,zue=typeof Blob<"u"?Blob:null,kue={isBrowser:!0,classes:{URLSearchParams:Rue,FormData:Iue,Blob:zue},protocols:["http","https","file","blob","url","data"]},qT=typeof window<"u"&&typeof document<"u",Lue=(e=>qT&&["ReactNative","NativeScript","NS"].indexOf(e)<0)(typeof navigator<"u"&&navigator.product),Bue=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Fue=qT&&window.location.href||"http://localhost",Nue=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:qT,hasStandardBrowserEnv:Lue,hasStandardBrowserWebWorkerEnv:Bue,origin:Fue},Symbol.toStringTag,{value:"Module"})),ss={...Nue,...kue};function Uue(e,t){return $1(e,new ss.classes.URLSearchParams,Object.assign({visitor:function(r,i,n,a){return ss.isNode&&Xe.isBuffer(r)?(this.append(i,r.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)}},t))}function jue(e){return Xe.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function Vue(e){const t={},r=Object.keys(e);let i;const n=r.length;let a;for(i=0;i<n;i++)a=r[i],t[a]=e[a];return t}function L6(e){function t(r,i,n,a){let o=r[a++];if(o==="__proto__")return!0;const s=Number.isFinite(+o),l=a>=r.length;return o=!o&&Xe.isArray(n)?n.length:o,l?(Xe.hasOwnProp(n,o)?n[o]=[n[o],i]:n[o]=i,!s):((!n[o]||!Xe.isObject(n[o]))&&(n[o]=[]),t(r,i,n[o],a)&&Xe.isArray(n[o])&&(n[o]=Vue(n[o])),!s)}if(Xe.isFormData(e)&&Xe.isFunction(e.entries)){const r={};return Xe.forEachEntry(e,(i,n)=>{t(jue(i),n,r,0)}),r}return null}function Hue(e,t,r){if(Xe.isString(e))try{return(t||JSON.parse)(e),Xe.trim(e)}catch(i){if(i.name!=="SyntaxError")throw i}return(r||JSON.stringify)(e)}const Vg={transitional:k6,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const i=r.getContentType()||"",n=i.indexOf("application/json")>-1,a=Xe.isObject(t);if(a&&Xe.isHTMLForm(t)&&(t=new FormData(t)),Xe.isFormData(t))return n?JSON.stringify(L6(t)):t;if(Xe.isArrayBuffer(t)||Xe.isBuffer(t)||Xe.isStream(t)||Xe.isFile(t)||Xe.isBlob(t)||Xe.isReadableStream(t))return t;if(Xe.isArrayBufferView(t))return t.buffer;if(Xe.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let s;if(a){if(i.indexOf("application/x-www-form-urlencoded")>-1)return Uue(t,this.formSerializer).toString();if((s=Xe.isFileList(t))||i.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return $1(s?{"files[]":t}:t,l&&new l,this.formSerializer)}}return a||n?(r.setContentType("application/json",!1),Hue(t)):t}],transformResponse:[function(t){const r=this.transitional||Vg.transitional,i=r&&r.forcedJSONParsing,n=this.responseType==="json";if(Xe.isResponse(t)||Xe.isReadableStream(t))return t;if(t&&Xe.isString(t)&&(i&&!this.responseType||n)){const o=!(r&&r.silentJSONParsing)&&n;try{return JSON.parse(t)}catch(s){if(o)throw s.name==="SyntaxError"?fr.from(s,fr.ERR_BAD_RESPONSE,this,null,this.response):s}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ss.classes.FormData,Blob:ss.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Xe.forEach(["delete","get","head","post","put","patch"],e=>{Vg.headers[e]={}});const Wue=Xe.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Gue=e=>{const t={};let r,i,n;return e&&e.split(`
`).forEach(function(o){n=o.indexOf(":"),r=o.substring(0,n).trim().toLowerCase(),i=o.substring(n+1).trim(),!(!r||t[r]&&Wue[r])&&(r==="set-cookie"?t[r]?t[r].push(i):t[r]=[i]:t[r]=t[r]?t[r]+", "+i:i)}),t},RR=Symbol("internals");function pm(e){return e&&String(e).trim().toLowerCase()}function hb(e){return e===!1||e==null?e:Xe.isArray(e)?e.map(hb):String(e)}function $ue(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;for(;i=r.exec(e);)t[i[1]]=i[2];return t}const que=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function wS(e,t,r,i,n){if(Xe.isFunction(i))return i.call(this,t,r);if(n&&(t=r),!!Xe.isString(t)){if(Xe.isString(i))return t.indexOf(i)!==-1;if(Xe.isRegExp(i))return i.test(t)}}function Yue(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,i)=>r.toUpperCase()+i)}function Xue(e,t){const r=Xe.toCamelCase(" "+t);["get","set","has"].forEach(i=>{Object.defineProperty(e,i+r,{value:function(n,a,o){return this[i].call(this,t,n,a,o)},configurable:!0})})}class Ya{constructor(t){t&&this.set(t)}set(t,r,i){const n=this;function a(s,l,c){const d=pm(l);if(!d)throw new Error("header name must be a non-empty string");const u=Xe.findKey(n,d);(!u||n[u]===void 0||c===!0||c===void 0&&n[u]!==!1)&&(n[u||l]=hb(s))}const o=(s,l)=>Xe.forEach(s,(c,d)=>a(c,d,l));if(Xe.isPlainObject(t)||t instanceof this.constructor)o(t,r);else if(Xe.isString(t)&&(t=t.trim())&&!que(t))o(Gue(t),r);else if(Xe.isHeaders(t))for(const[s,l]of t.entries())a(l,s,i);else t!=null&&a(r,t,i);return this}get(t,r){if(t=pm(t),t){const i=Xe.findKey(this,t);if(i){const n=this[i];if(!r)return n;if(r===!0)return $ue(n);if(Xe.isFunction(r))return r.call(this,n,i);if(Xe.isRegExp(r))return r.exec(n);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=pm(t),t){const i=Xe.findKey(this,t);return!!(i&&this[i]!==void 0&&(!r||wS(this,this[i],i,r)))}return!1}delete(t,r){const i=this;let n=!1;function a(o){if(o=pm(o),o){const s=Xe.findKey(i,o);s&&(!r||wS(i,i[s],s,r))&&(delete i[s],n=!0)}}return Xe.isArray(t)?t.forEach(a):a(t),n}clear(t){const r=Object.keys(this);let i=r.length,n=!1;for(;i--;){const a=r[i];(!t||wS(this,this[a],a,t,!0))&&(delete this[a],n=!0)}return n}normalize(t){const r=this,i={};return Xe.forEach(this,(n,a)=>{const o=Xe.findKey(i,a);if(o){r[o]=hb(n),delete r[a];return}const s=t?Yue(a):String(a).trim();s!==a&&delete r[a],r[s]=hb(n),i[s]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return Xe.forEach(this,(i,n)=>{i!=null&&i!==!1&&(r[n]=t&&Xe.isArray(i)?i.join(", "):i)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const i=new this(t);return r.forEach(n=>i.set(n)),i}static accessor(t){const i=(this[RR]=this[RR]={accessors:{}}).accessors,n=this.prototype;function a(o){const s=pm(o);i[s]||(Xue(n,o),i[s]=!0)}return Xe.isArray(t)?t.forEach(a):a(t),this}}Ya.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Xe.reduceDescriptors(Ya.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(i){this[r]=i}}});Xe.freezeMethods(Ya);function SS(e,t){const r=this||Vg,i=t||r,n=Ya.from(i.headers);let a=i.data;return Xe.forEach(e,function(s){a=s.call(r,a,n.normalize(),t?t.status:void 0)}),n.normalize(),a}function B6(e){return!!(e&&e.__CANCEL__)}function Np(e,t,r){fr.call(this,e??"canceled",fr.ERR_CANCELED,t,r),this.name="CanceledError"}Xe.inherits(Np,fr,{__CANCEL__:!0});function F6(e,t,r){const i=r.config.validateStatus;!r.status||!i||i(r.status)?e(r):t(new fr("Request failed with status code "+r.status,[fr.ERR_BAD_REQUEST,fr.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function Kue(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function Que(e,t){e=e||10;const r=new Array(e),i=new Array(e);let n=0,a=0,o;return t=t!==void 0?t:1e3,function(l){const c=Date.now(),d=i[a];o||(o=c),r[n]=l,i[n]=c;let u=a,h=0;for(;u!==n;)h+=r[u++],u=u%e;if(n=(n+1)%e,n===a&&(a=(a+1)%e),c-o<t)return;const f=d&&c-d;return f?Math.round(h*1e3/f):void 0}}function Zue(e,t){let r=0;const i=1e3/t;let n=null;return function(){const o=this===!0,s=Date.now();if(o||s-r>i)return n&&(clearTimeout(n),n=null),r=s,e.apply(null,arguments);n||(n=setTimeout(()=>(n=null,r=Date.now(),e.apply(null,arguments)),i-(s-r)))}}const nx=(e,t,r=3)=>{let i=0;const n=Que(50,250);return Zue(a=>{const o=a.loaded,s=a.lengthComputable?a.total:void 0,l=o-i,c=n(l),d=o<=s;i=o;const u={loaded:o,total:s,progress:s?o/s:void 0,bytes:l,rate:c||void 0,estimated:c&&s&&d?(s-o)/c:void 0,event:a,lengthComputable:s!=null};u[t?"download":"upload"]=!0,e(u)},r)},Jue=ss.hasStandardBrowserEnv?function(){const t=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a");let i;function n(a){let o=a;return t&&(r.setAttribute("href",o),o=r.href),r.setAttribute("href",o),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:r.pathname.charAt(0)==="/"?r.pathname:"/"+r.pathname}}return i=n(window.location.href),function(o){const s=Xe.isString(o)?n(o):o;return s.protocol===i.protocol&&s.host===i.host}}():function(){return function(){return!0}}(),ehe=ss.hasStandardBrowserEnv?{write(e,t,r,i,n,a){const o=[e+"="+encodeURIComponent(t)];Xe.isNumber(r)&&o.push("expires="+new Date(r).toGMTString()),Xe.isString(i)&&o.push("path="+i),Xe.isString(n)&&o.push("domain="+n),a===!0&&o.push("secure"),document.cookie=o.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function the(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function rhe(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function N6(e,t){return e&&!the(t)?rhe(e,t):t}const IR=e=>e instanceof Ya?{...e}:e;function Ju(e,t){t=t||{};const r={};function i(c,d,u){return Xe.isPlainObject(c)&&Xe.isPlainObject(d)?Xe.merge.call({caseless:u},c,d):Xe.isPlainObject(d)?Xe.merge({},d):Xe.isArray(d)?d.slice():d}function n(c,d,u){if(Xe.isUndefined(d)){if(!Xe.isUndefined(c))return i(void 0,c,u)}else return i(c,d,u)}function a(c,d){if(!Xe.isUndefined(d))return i(void 0,d)}function o(c,d){if(Xe.isUndefined(d)){if(!Xe.isUndefined(c))return i(void 0,c)}else return i(void 0,d)}function s(c,d,u){if(u in t)return i(c,d);if(u in e)return i(void 0,c)}const l={url:a,method:a,data:a,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:s,headers:(c,d)=>n(IR(c),IR(d),!0)};return Xe.forEach(Object.keys(Object.assign({},e,t)),function(d){const u=l[d]||n,h=u(e[d],t[d],d);Xe.isUndefined(h)&&u!==s||(r[d]=h)}),r}const U6=e=>{const t=Ju({},e);let{data:r,withXSRFToken:i,xsrfHeaderName:n,xsrfCookieName:a,headers:o,auth:s}=t;t.headers=o=Ya.from(o),t.url=z6(N6(t.baseURL,t.url),e.params,e.paramsSerializer),s&&o.set("Authorization","Basic "+btoa((s.username||"")+":"+(s.password?unescape(encodeURIComponent(s.password)):"")));let l;if(Xe.isFormData(r)){if(ss.hasStandardBrowserEnv||ss.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((l=o.getContentType())!==!1){const[c,...d]=l?l.split(";").map(u=>u.trim()).filter(Boolean):[];o.setContentType([c||"multipart/form-data",...d].join("; "))}}if(ss.hasStandardBrowserEnv&&(i&&Xe.isFunction(i)&&(i=i(t)),i||i!==!1&&Jue(t.url))){const c=n&&a&&ehe.read(a);c&&o.set(n,c)}return t},ihe=typeof XMLHttpRequest<"u",nhe=ihe&&function(e){return new Promise(function(r,i){const n=U6(e);let a=n.data;const o=Ya.from(n.headers).normalize();let{responseType:s}=n,l;function c(){n.cancelToken&&n.cancelToken.unsubscribe(l),n.signal&&n.signal.removeEventListener("abort",l)}let d=new XMLHttpRequest;d.open(n.method.toUpperCase(),n.url,!0),d.timeout=n.timeout;function u(){if(!d)return;const f=Ya.from("getAllResponseHeaders"in d&&d.getAllResponseHeaders()),v={data:!s||s==="text"||s==="json"?d.responseText:d.response,status:d.status,statusText:d.statusText,headers:f,config:e,request:d};F6(function(g){r(g),c()},function(g){i(g),c()},v),d=null}"onloadend"in d?d.onloadend=u:d.onreadystatechange=function(){!d||d.readyState!==4||d.status===0&&!(d.responseURL&&d.responseURL.indexOf("file:")===0)||setTimeout(u)},d.onabort=function(){d&&(i(new fr("Request aborted",fr.ECONNABORTED,n,d)),d=null)},d.onerror=function(){i(new fr("Network Error",fr.ERR_NETWORK,n,d)),d=null},d.ontimeout=function(){let p=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded";const v=n.transitional||k6;n.timeoutErrorMessage&&(p=n.timeoutErrorMessage),i(new fr(p,v.clarifyTimeoutError?fr.ETIMEDOUT:fr.ECONNABORTED,n,d)),d=null},a===void 0&&o.setContentType(null),"setRequestHeader"in d&&Xe.forEach(o.toJSON(),function(p,v){d.setRequestHeader(v,p)}),Xe.isUndefined(n.withCredentials)||(d.withCredentials=!!n.withCredentials),s&&s!=="json"&&(d.responseType=n.responseType),typeof n.onDownloadProgress=="function"&&d.addEventListener("progress",nx(n.onDownloadProgress,!0)),typeof n.onUploadProgress=="function"&&d.upload&&d.upload.addEventListener("progress",nx(n.onUploadProgress)),(n.cancelToken||n.signal)&&(l=f=>{d&&(i(!f||f.type?new Np(null,e,d):f),d.abort(),d=null)},n.cancelToken&&n.cancelToken.subscribe(l),n.signal&&(n.signal.aborted?l():n.signal.addEventListener("abort",l)));const h=Kue(n.url);if(h&&ss.protocols.indexOf(h)===-1){i(new fr("Unsupported protocol "+h+":",fr.ERR_BAD_REQUEST,e));return}d.send(a||null)})},ahe=(e,t)=>{let r=new AbortController,i;const n=function(l){if(!i){i=!0,o();const c=l instanceof Error?l:this.reason;r.abort(c instanceof fr?c:new Np(c instanceof Error?c.message:c))}};let a=t&&setTimeout(()=>{n(new fr(`timeout ${t} of ms exceeded`,fr.ETIMEDOUT))},t);const o=()=>{e&&(a&&clearTimeout(a),a=null,e.forEach(l=>{l&&(l.removeEventListener?l.removeEventListener("abort",n):l.unsubscribe(n))}),e=null)};e.forEach(l=>l&&l.addEventListener&&l.addEventListener("abort",n));const{signal:s}=r;return s.unsubscribe=o,[s,()=>{a&&clearTimeout(a),a=null}]},ohe=function*(e,t){let r=e.byteLength;if(!t||r<t){yield e;return}let i=0,n;for(;i<r;)n=i+t,yield e.slice(i,n),i=n},she=async function*(e,t,r){for await(const i of e)yield*ohe(ArrayBuffer.isView(i)?i:await r(String(i)),t)},zR=(e,t,r,i,n)=>{const a=she(e,t,n);let o=0;return new ReadableStream({type:"bytes",async pull(s){const{done:l,value:c}=await a.next();if(l){s.close(),i();return}let d=c.byteLength;r&&r(o+=d),s.enqueue(new Uint8Array(c))},cancel(s){return i(s),a.return()}},{highWaterMark:2})},kR=(e,t)=>{const r=e!=null;return i=>setTimeout(()=>t({lengthComputable:r,total:e,loaded:i}))},q1=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",j6=q1&&typeof ReadableStream=="function",bA=q1&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),lhe=j6&&(()=>{let e=!1;const t=new Request(ss.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t})(),LR=64*1024,xA=j6&&!!(()=>{try{return Xe.isReadableStream(new Response("").body)}catch{}})(),ax={stream:xA&&(e=>e.body)};q1&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!ax[t]&&(ax[t]=Xe.isFunction(e[t])?r=>r[t]():(r,i)=>{throw new fr(`Response type '${t}' is not supported`,fr.ERR_NOT_SUPPORT,i)})})})(new Response);const che=async e=>{if(e==null)return 0;if(Xe.isBlob(e))return e.size;if(Xe.isSpecCompliantForm(e))return(await new Request(e).arrayBuffer()).byteLength;if(Xe.isArrayBufferView(e))return e.byteLength;if(Xe.isURLSearchParams(e)&&(e=e+""),Xe.isString(e))return(await bA(e)).byteLength},dhe=async(e,t)=>{const r=Xe.toFiniteNumber(e.getContentLength());return r??che(t)},uhe=q1&&(async e=>{let{url:t,method:r,data:i,signal:n,cancelToken:a,timeout:o,onDownloadProgress:s,onUploadProgress:l,responseType:c,headers:d,withCredentials:u="same-origin",fetchOptions:h}=U6(e);c=c?(c+"").toLowerCase():"text";let[f,p]=n||a||o?ahe([n,a],o):[],v,m;const g=()=>{!v&&setTimeout(()=>{f&&f.unsubscribe()}),v=!0};let y;try{if(l&&lhe&&r!=="get"&&r!=="head"&&(y=await dhe(d,i))!==0){let w=new Request(t,{method:"POST",body:i,duplex:"half"}),_;Xe.isFormData(i)&&(_=w.headers.get("content-type"))&&d.setContentType(_),w.body&&(i=zR(w.body,LR,kR(y,nx(l)),null,bA))}Xe.isString(u)||(u=u?"cors":"omit"),m=new Request(t,{...h,signal:f,method:r.toUpperCase(),headers:d.normalize().toJSON(),body:i,duplex:"half",withCredentials:u});let b=await fetch(m);const x=xA&&(c==="stream"||c==="response");if(xA&&(s||x)){const w={};["status","statusText","headers"].forEach(C=>{w[C]=b[C]});const _=Xe.toFiniteNumber(b.headers.get("content-length"));b=new Response(zR(b.body,LR,s&&kR(_,nx(s,!0)),x&&g,bA),w)}c=c||"text";let S=await ax[Xe.findKey(ax,c)||"text"](b,e);return!x&&g(),p&&p(),await new Promise((w,_)=>{F6(w,_,{data:S,headers:Ya.from(b.headers),status:b.status,statusText:b.statusText,config:e,request:m})})}catch(b){throw g(),b&&b.name==="TypeError"&&/fetch/i.test(b.message)?Object.assign(new fr("Network Error",fr.ERR_NETWORK,e,m),{cause:b.cause||b}):fr.from(b,b&&b.code,e,m)}}),wA={http:Tue,xhr:nhe,fetch:uhe};Xe.forEach(wA,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const BR=e=>`- ${e}`,hhe=e=>Xe.isFunction(e)||e===null||e===!1,V6={getAdapter:e=>{e=Xe.isArray(e)?e:[e];const{length:t}=e;let r,i;const n={};for(let a=0;a<t;a++){r=e[a];let o;if(i=r,!hhe(r)&&(i=wA[(o=String(r)).toLowerCase()],i===void 0))throw new fr(`Unknown adapter '${o}'`);if(i)break;n[o||"#"+a]=i}if(!i){const a=Object.entries(n).map(([s,l])=>`adapter ${s} `+(l===!1?"is not supported by the environment":"is not available in the build"));let o=t?a.length>1?`since :
`+a.map(BR).join(`
`):" "+BR(a[0]):"as no adapter specified";throw new fr("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return i},adapters:wA};function CS(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Np(null,e)}function FR(e){return CS(e),e.headers=Ya.from(e.headers),e.data=SS.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),V6.getAdapter(e.adapter||Vg.adapter)(e).then(function(i){return CS(e),i.data=SS.call(e,e.transformResponse,i),i.headers=Ya.from(i.headers),i},function(i){return B6(i)||(CS(e),i&&i.response&&(i.response.data=SS.call(e,e.transformResponse,i.response),i.response.headers=Ya.from(i.response.headers))),Promise.reject(i)})}const H6="1.7.2",YT={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{YT[e]=function(i){return typeof i===e||"a"+(t<1?"n ":" ")+e}});const NR={};YT.transitional=function(t,r,i){function n(a,o){return"[Axios v"+H6+"] Transitional option '"+a+"'"+o+(i?". "+i:"")}return(a,o,s)=>{if(t===!1)throw new fr(n(o," has been removed"+(r?" in "+r:"")),fr.ERR_DEPRECATED);return r&&!NR[o]&&(NR[o]=!0,console.warn(n(o," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(a,o,s):!0}};function fhe(e,t,r){if(typeof e!="object")throw new fr("options must be an object",fr.ERR_BAD_OPTION_VALUE);const i=Object.keys(e);let n=i.length;for(;n-- >0;){const a=i[n],o=t[a];if(o){const s=e[a],l=s===void 0||o(s,a,e);if(l!==!0)throw new fr("option "+a+" must be "+l,fr.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new fr("Unknown option "+a,fr.ERR_BAD_OPTION)}}const SA={assertOptions:fhe,validators:YT},Sc=SA.validators;class Bu{constructor(t){this.defaults=t,this.interceptors={request:new OR,response:new OR}}async request(t,r){try{return await this._request(t,r)}catch(i){if(i instanceof Error){let n;Error.captureStackTrace?Error.captureStackTrace(n={}):n=new Error;const a=n.stack?n.stack.replace(/^.+\n/,""):"";try{i.stack?a&&!String(i.stack).endsWith(a.replace(/^.+\n.+\n/,""))&&(i.stack+=`
`+a):i.stack=a}catch{}}throw i}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=Ju(this.defaults,r);const{transitional:i,paramsSerializer:n,headers:a}=r;i!==void 0&&SA.assertOptions(i,{silentJSONParsing:Sc.transitional(Sc.boolean),forcedJSONParsing:Sc.transitional(Sc.boolean),clarifyTimeoutError:Sc.transitional(Sc.boolean)},!1),n!=null&&(Xe.isFunction(n)?r.paramsSerializer={serialize:n}:SA.assertOptions(n,{encode:Sc.function,serialize:Sc.function},!0)),r.method=(r.method||this.defaults.method||"get").toLowerCase();let o=a&&Xe.merge(a.common,a[r.method]);a&&Xe.forEach(["delete","get","head","post","put","patch","common"],p=>{delete a[p]}),r.headers=Ya.concat(o,a);const s=[];let l=!0;this.interceptors.request.forEach(function(v){typeof v.runWhen=="function"&&v.runWhen(r)===!1||(l=l&&v.synchronous,s.unshift(v.fulfilled,v.rejected))});const c=[];this.interceptors.response.forEach(function(v){c.push(v.fulfilled,v.rejected)});let d,u=0,h;if(!l){const p=[FR.bind(this),void 0];for(p.unshift.apply(p,s),p.push.apply(p,c),h=p.length,d=Promise.resolve(r);u<h;)d=d.then(p[u++],p[u++]);return d}h=s.length;let f=r;for(u=0;u<h;){const p=s[u++],v=s[u++];try{f=p(f)}catch(m){v.call(this,m);break}}try{d=FR.call(this,f)}catch(p){return Promise.reject(p)}for(u=0,h=c.length;u<h;)d=d.then(c[u++],c[u++]);return d}getUri(t){t=Ju(this.defaults,t);const r=N6(t.baseURL,t.url);return z6(r,t.params,t.paramsSerializer)}}Xe.forEach(["delete","get","head","options"],function(t){Bu.prototype[t]=function(r,i){return this.request(Ju(i||{},{method:t,url:r,data:(i||{}).data}))}});Xe.forEach(["post","put","patch"],function(t){function r(i){return function(a,o,s){return this.request(Ju(s||{},{method:t,headers:i?{"Content-Type":"multipart/form-data"}:{},url:a,data:o}))}}Bu.prototype[t]=r(),Bu.prototype[t+"Form"]=r(!0)});class XT{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(a){r=a});const i=this;this.promise.then(n=>{if(!i._listeners)return;let a=i._listeners.length;for(;a-- >0;)i._listeners[a](n);i._listeners=null}),this.promise.then=n=>{let a;const o=new Promise(s=>{i.subscribe(s),a=s}).then(n);return o.cancel=function(){i.unsubscribe(a)},o},t(function(a,o,s){i.reason||(i.reason=new Np(a,o,s),r(i.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}static source(){let t;return{token:new XT(function(n){t=n}),cancel:t}}}function phe(e){return function(r){return e.apply(null,r)}}function mhe(e){return Xe.isObject(e)&&e.isAxiosError===!0}const CA={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(CA).forEach(([e,t])=>{CA[t]=e});function W6(e){const t=new Bu(e),r=S6(Bu.prototype.request,t);return Xe.extend(r,Bu.prototype,t,{allOwnKeys:!0}),Xe.extend(r,t,null,{allOwnKeys:!0}),r.create=function(n){return W6(Ju(e,n))},r}const Ci=W6(Vg);Ci.Axios=Bu;Ci.CanceledError=Np;Ci.CancelToken=XT;Ci.isCancel=B6;Ci.VERSION=H6;Ci.toFormData=$1;Ci.AxiosError=fr;Ci.Cancel=Ci.CanceledError;Ci.all=function(t){return Promise.all(t)};Ci.spread=phe;Ci.isAxiosError=mhe;Ci.mergeConfig=Ju;Ci.AxiosHeaders=Ya;Ci.formToJSON=e=>L6(Xe.isHTMLForm(e)?new FormData(e):e);Ci.getAdapter=V6.getAdapter;Ci.HttpStatusCode=CA;Ci.default=Ci;const vhe="http://127.0.0.1:5535";Ci.defaults.baseURL=vhe;Ci.interceptors.request.use(e=>e);Ci.interceptors.response.use(e=>e,e=>Promise.reject(e));const ghe={get(e,t){return new Promise((r,i)=>{Ci.get(e,{params:t}).then(n=>{r(n.data)}).catch(n=>{i(n)})})},getBlob(e,t){return new Promise((r,i)=>{Ci.get(e,{params:t,responseType:"blob"}).then(n=>{r(n.data)}).catch(n=>{i(n)})})},post(e,t){return new Promise((r,i)=>{Ci.post(e,t).then(n=>{r(n.data)}).catch(n=>{i(n)})})}};async function yhe(){return ghe.get("/patients")}const _A=o6("patientsInfo",()=>{const e=ge();return{patients:e,getPatients:async()=>{e.value=await yhe()}}}),bhe={class:"c_card_container"},xhe=x1('<input type="radio" name="select" id="c_card_slide_1" checked hidden><input type="radio" name="select" id="c_card_slide_2" hidden><input type="radio" name="select" id="c_card_slide_3" hidden><div class="c_card_slider"><label for="c_card_slide_1" class="c_card_slide c_card_slide-1"></label><label for="c_card_slide_2" class="c_card_slide c_card_slide-2"></label><label for="c_card_slide_3" class="c_card_slide c_card_slide-3"></label></div>',4),whe={class:"c_card_img"},She=["src"],Che={class:"c_card_content"},_he={class:"c_card_title"},Ahe={class:"c_card_text"},Mhe=Ve({__name:"Card",props:{data:{}},setup(e){const t=e;return(r,i)=>(ft(),Pt("div",bhe,[xhe,(ft(!0),Pt(pr,null,cs(t.data,(n,a)=>(ft(),Ei(ke(Lu),{align:"center",class:Do(["c_card_detail","c_card_detail-"+(a+1)]),key:a},{default:tt(()=>[st("div",whe,[st("img",{src:n.icon,alt:"none"},null,8,She)]),st("div",Che,[st("div",_he,mi(n.title),1),st("div",Ahe,[Be(ke(Ase),{class:"","content-class":"c_card_scrollbar"},{default:tt(()=>[il(r.$slots,"card-slot-"+a)]),_:2},1024)])])]),_:2},1032,["class"]))),128))]))}}),Ehe="/DigitalTWINonFHIRFrontend/assets/1-D_sLrbLA.png",The="/DigitalTWINonFHIRFrontend/assets/2-B5wpaswG.png",G6="/DigitalTWINonFHIRFrontend/assets/3-3UDdDhFK.png",Phe=e=>(NE("data-v-981ba0bf"),e=e(),UE(),e),Dhe={class:"m-card"},Ohe=Phe(()=>st("br",null,null,-1)),Rhe=Ve({__name:"MeasurementsView",setup(e){const{patients:t}=Fd(_A()),r=ge([{title:"Patients",icon:Ehe,text:"波雅·汉库克，日本漫画《航海王》及其衍生作品中的角色。人称：海贼女帝。 是位于无风带九蛇岛的海贼国家亚马逊·百合王国的现任皇帝，同时也是九蛇海贼团的现任船长。 其绝世的容颜被世人评价为“世界第一美女”."},{title:"Observations",icon:The,text:"妮可·罗宾，日本漫画《航海王》及其衍生作品中的角色，草帽一伙的考古学家，出生在西海的考古学之岛“奥哈拉”，年仅8岁就被悬赏千万的奥哈拉幸存者。 “花花果实”能力者，能让身体的任何部位像开花一样绽放在视线范围内的任何有形体的事物上并作出攻击或其他用途。"},{title:"ImagingStudy",icon:G6,text:"娜美，日本漫画《航海王》及衍生作品中的女主角。 草帽一伙航海士，草帽大船团大干部之一，人称“小贼猫”，悬赏金3亿6600万贝里。 小时候为了救回家乡被迫加入了阿龙一伙。 从橘子镇开始和草帽一伙合作，在路飞打倒了阿龙后正式加入了草帽一伙。"}]);return Or(async()=>{console.log("Measurements: ",t.value)}),(i,n)=>{const a=Od("router-view");return ft(),Pt(pr,null,[st("div",Dhe,[Be(Mhe,{data:r.value},b7({_:2},[cs(ke(t),(o,s)=>({name:`card-slot-${s}`,fn:tt(()=>[st("div",null,'"Resource Type: " '+mi(o.resourceType),1),st("div",null,'"Id: " '+mi(o.id),1),st("div",null,'"uuid: " '+mi(o.identifier[0].value),1),st("div",null,'"GP: " '+mi(o.generalPractitioner[0].display),1),st("div",null,'"Name: " '+mi(o.name?o.name[0].text:"none"),1),Ohe])}))]),1032,["data"])]),Be(a)],64)}}}),Ihe=ul(Rhe,[["__scopeId","data-v-981ba0bf"]]),zhe=e=>(NE("data-v-5a36638d"),e=e(),UE(),e),khe=zhe(()=>st("br",null,null,-1)),Lhe=Ve({__name:"Patients",setup(e){const{patients:t}=Fd(_A()),{getPatients:r}=_A();return Or(async()=>{await r()}),(i,n)=>(ft(),Pt(pr,null,[(ft(!0),Pt(pr,null,cs(ke(t),(a,o)=>(ft(),Pt("div",{key:o},[st("div",null,'"Resource Type: " '+mi(a.resourceType),1),st("div",null,'"Id: " '+mi(a.id),1),st("div",null,'"uuid: " '+mi(a.identifier[0].value),1),st("div",null,'"GP: " '+mi(a.generalPractitioner[0].display),1),st("div",null,'"Name: " '+mi(a.name?a.name[0].text:"none"),1),khe]))),128)),Be(ke(Lu),{class:"container"},{default:tt(()=>[Be(ke(li),null,{default:tt(()=>[Pr("Oops!")]),_:1}),Be(ke(li),null,{default:tt(()=>[Pr("Oops!")]),_:1}),Be(ke(li),null,{default:tt(()=>[Pr("Oops!")]),_:1}),Be(ke(Lu),null,{default:tt(()=>[Pr("Long! Long! Cross the line!sadcsacsacsadcascacdsacsacsadcsadcdascda")]),_:1})]),_:1})],64))}}),Bhe=ul(Lhe,[["__scopeId","data-v-5a36638d"]]),Fhe=Ve({__name:"AppLayoutAnnotator",setup(e){const{renderIcon:t,generateRouterLabel:r}=w6(),{FolderIcon:i,FolderOpenIcon:n,DocumentIcon:a,GridIcon:o}=Ug(),s=WT(),{root:l}=Fd(Zu()),c=ge([{label:()=>r("home-fhir","Home")}]);Or(()=>{var v;if(l&&((v=l.value)!=null&&v.children)){const m=s.query.category;console.log("query",m),console.log("root",l.value.category),p(l.value)}});const d=v=>{var m;switch(v){case"primary":if(((m=l.value)==null?void 0:m.category)==="Measurements")return()=>r("measurements",v,void 0,{name:v});break;default:return v}},u=(v,m=null)=>m?{label:d(v),key:v,icon:t(i),children:[...f(m)]}:{label:d(v),key:v,icon:t(i),children:[]},h=v=>({label:v,key:v,icon:t(a)}),f=v=>{const m=v.filter(b=>b.kind==="directory"),g=v.filter(b=>b.kind==="file"),y=[];for(let b of m){const x=u(b.name,b.children);y.push(x)}return g.forEach(b=>{const x=h(b.name);y.push(x)}),y},p=v=>{c.value=[{label:()=>r("home-annotator",v.name,void 0,{category:v.category}),key:v.name,icon:t(o)},...f(v.children)]};return tr(l,()=>{var v;l&&((v=l.value)!=null&&v.children)&&p(l.value)}),(v,m)=>{const g=Od("router-view");return ft(),Ei(ke(jf),{class:"flex flex-col bg-gradient-to-r from-zinc-100 to-neutral-300 h-screen"},{default:tt(()=>[Be(ke(WU),{class:"bg-transparent h-[8vh] mt-auto shadow-sm"},{default:tt(()=>[Be(V1)]),_:1}),Be(ke(jf),{class:"flex-1 h-[87vh] bg-transparent","has-sider":"",onDragover:m[0]||(m[0]=Af(()=>{},["prevent"])),onDrop:m[1]||(m[1]=y=>y.preventDefault())},{default:tt(()=>[ke(l)?(ft(),Ei(x6,{key:0,"menu-options":c.value,width:320},null,8,["menu-options"])):Na("",!0),Be(ke(jf),{"native-scrollbar":!1,class:"bg-transparent"},{default:tt(()=>[Be(g)]),_:1})]),_:1}),Be(ke(GU),{class:"h-[5vh] mt-auto bg-transparent footer"},{default:tt(()=>[Be(b6)]),_:1})]),_:1})}}}),Nhe=ul(Fhe,[["__scopeId","data-v-a0f3d115"]]),Uhe="data:image/svg+xml,%3csvg%20width='40'%20height='40'%20viewBox='0%200%2040%2040'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3crect%20width='40'%20height='40'%20rx='20'%20fill='%23daf2e9'/%3e%3cpath%20d='M16.6665%2023.3333L19.9998%2020M19.9998%2020L23.3332%2023.3333M19.9998%2020V27.5M26.6665%2023.9524C27.6844%2023.1117%2028.3332%2021.8399%2028.3332%2020.4167C28.3332%2017.8854%2026.2811%2015.8333%2023.7498%2015.8333C23.5677%2015.8333%2023.3974%2015.7383%2023.3049%2015.5814C22.2182%2013.7374%2020.2119%2012.5%2017.9165%2012.5C14.4647%2012.5%2011.6665%2015.2982%2011.6665%2018.75C11.6665%2020.4718%2012.3627%2022.0309%2013.489%2023.1613'%20stroke='%2324AE7C'%20stroke-width='1.66667'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",jhe=e=>(NE("data-v-3bf125bc"),e=e(),UE(),e),Vhe={className:"file-upload_label"},Hhe=jhe(()=>st("p",{className:"text-14-regular"},[st("span",{className:"text-orange-500"}," Click to upload "),Pr(" or drag and drop ")],-1)),Whe={class:"font-bold"},Ghe=Ve({__name:"DropZone",props:{category:{}},emits:["onChange"],setup(e,{emit:t}){const r=e,i=ge(!1),{root:n}=Fd(Zu()),{folderPicker:a,folderDrop:o}=Zu(),s=t,l=async(h,f)=>{f==="drop"?await c(h):f==="click"&&await d();try{s("onChange",n.value)}catch(p){console.log(p)}};Or(()=>{});const c=async h=>{u();const f=h.dataTransfer.items[0];await o(f,r.category)},d=async()=>{await a(r.category)},u=()=>{i.value=!i.value};return(h,f)=>(ft(),Pt("div",{onDragenter:Af(u,["prevent"]),onDragleave:Af(u,["prevent"]),onDragover:f[0]||(f[0]=Af(()=>{},["prevent"])),onDrop:f[1]||(f[1]=Af(p=>l(p,"drop"),["prevent"])),onClick:f[2]||(f[2]=p=>l(p,"click")),class:Do([{"active-dropzone":i.value},"w-3/5 h-2/5 md:h-80 file-upload ease-in-out duration-300"])},[Be(ke(AT),{round:"",class:"animate-bounce",size:40,src:ke(Uhe)},null,8,["src"]),st("div",Vhe,[Hhe,st("p",Whe," SPARC "+mi(!!r.category&&r.category)+" SDS dataset ",1)])],34))}}),$he=ul(Ghe,[["__scopeId","data-v-3bf125bc"]]),qhe={class:"w-full h-[87vh] flex flex-col justify-center items-center"},Yhe=Ve({__name:"AnnotatorView",setup(e){const r=WT().query.category,i=Array.isArray(r)?r[0]:r,n=i&&["Measurements","Workflow","Workflow tool","Workflow tool process"].includes(i)?i:void 0,a=ge(),o=s=>{a.value=s};return(s,l)=>(ft(),Pt("div",qhe,[Be($he,{category:ke(n),onOnChange:o},null,8,["category"])]))}}),Xhe="/DigitalTWINonFHIRFrontend/assets/img1-DoEQ1efq.png",Khe="/DigitalTWINonFHIRFrontend/assets/img2-BDXwOCVw.png",Qhe="/DigitalTWINonFHIRFrontend/assets/img3-BaOpn34h.png",Zhe="/DigitalTWINonFHIRFrontend/assets/img4-Cb-ehCEj.png",Jhe={class:"bg-box"},efe={class:"carousel main"},tfe={class:"item"},rfe=["src"],ife={class:"item"},nfe=["src"],afe={class:"item"},ofe=["src"],sfe={class:"item"},lfe=["src"],cfe={class:"box-info"},dfe={class:"navigation"},ufe=Ve({__name:"Carousel",setup(e){const{ChevronBackIcon:t,ChevronForwardIcon:r}=Ug(),i=ge([{title:"Primary Measurements Annotator",description:"Lorem ipsum dolor sit amet consectetur adipisicing elit. Sit temporibus voluptate iure ullam commodi cupiditate eaque similique non id perferendis odit, ex corrupti tenetur optio molestias unde rerum! Ratione, consequuntur.",link:{name:"home-annotator",query:{category:"Measurements"}}},{title:"Workflow Annotator",description:"Lorem ipsum dolor sit amet consectetur adipisicing elit. Sit temporibus voluptate iure ullam commodi cupiditate eaque similique non id perferendis odit, ex corrupti tenetur optio molestias unde rerum! Ratione, consequuntur.",link:{name:"home-annotator",query:{category:"Workflow"}}},{title:"Workflow Tool Annotator",description:"Lorem ipsum dolor sit amet consectetur adipisicing elit. Sit temporibus voluptate iure ullam commodi cupiditate eaque similique non id perferendis odit, ex corrupti tenetur optio molestias unde rerum! Ratione, consequuntur.",link:{name:"home-annotator",query:{category:"Workflow tool"}}},{title:"Workflow Tool Process Annotator",description:"Lorem ipsum dolor sit amet consectetur adipisicing elit. Sit temporibus voluptate iure ullam commodi cupiditate eaque similique non id perferendis odit, ex corrupti tenetur optio molestias unde rerum! Ratione, consequuntur.",link:{name:"home-annotator",query:{category:"Workflow tool process"}}}]),n=ge(0),a=ge(document.querySelectorAll(".bg")),o=()=>{n.value<3?n.value+=1:n.value=0},s=()=>{n.value>0?n.value-=1:n.value=3};return Qa(()=>{a.value.forEach((l,c)=>{l.classList.toggle("active",c===n.value)})}),(l,c)=>{const d=Od("router-link");return ft(),Pt(pr,null,[st("div",Jhe,[(ft(),Pt(pr,null,cs([1,2,3,4],(u,h)=>st("div",{key:h,class:Do([{active:h===n.value},"bg"])},null,2)),64))]),st("div",efe,[st("div",{class:"list-img",style:tp({transform:`translateY(${n.value*-100}%)`})},[st("div",tfe,[st("img",{src:ke(Xhe),alt:""},null,8,rfe)]),st("div",ife,[st("img",{src:ke(Khe),alt:""},null,8,nfe)]),st("div",afe,[st("img",{src:ke(Qhe),alt:""},null,8,ofe)]),st("div",sfe,[st("img",{src:ke(Zhe),alt:""},null,8,lfe)])],4),st("div",cfe,[st("div",{class:"list-info",style:tp({transform:`translateY(${n.value*-25}%)`})},[(ft(!0),Pt(pr,null,cs(i.value,(u,h)=>(ft(),Pt("div",{key:h,class:"info"},[st("h2",null,mi(u.title),1),st("p",null,mi(u.description),1),Be(d,{class:"btn",to:u.link},{default:tt(()=>[Pr("Let's go")]),_:2},1032,["to"])]))),128))],4)]),st("div",dfe,[st("span",{class:"prev-btn",onClick:s},[Be(ke(t))]),st("span",{class:"next-btn",onClick:o},[Be(ke(r))])])])],64)}}}),hfe=ul(ufe,[["__scopeId","data-v-3faeb3b5"]]),ffe={class:"fixed top-0 left-0 right-0 h-[8vh] pt-3 px-3 shadow-sm z-50"},pfe=Ve({__name:"index",setup(e){const{root:t}=Fd(Zu());return Or(()=>{t&&(t.value=void 0)}),(r,i)=>(ft(),Pt("div",null,[st("div",ffe,[Be(V1)]),Be(hfe)]))}}),mfe={class:"flex flex-row justify-around"},vfe={key:1},gfe={className:"justify-items-end text-dark-600 xl:text-left"},yfe=Ve({__name:"PageSummary",props:{breadcrumbs:Array,avatar:String,title:String,subtitle:String,footer:String},setup(e){return UT(),(t,r)=>{const i=Od("RouterLink");return ft(),Ei(ke(Cse),{subtitle:e.subtitle,class:"page-header-bg"},{avatar:tt(()=>[Be(ke(AT),{src:e.avatar},null,8,["src"])]),title:tt(()=>[st("span",null,mi(e.title),1)]),header:tt(()=>[Be(ke(Ore),null,{default:tt(()=>[(ft(!0),Pt(pr,null,cs(e.breadcrumbs,(n,a)=>(ft(),Ei(ke(zre),{key:a},{default:tt(()=>[n!=="primary"?(ft(),Ei(i,{key:0,to:"/primary/test"},{default:tt(()=>[Pr(mi(n),1)]),_:2},1024)):(ft(),Pt("span",vfe,mi(n),1))]),_:2},1024))),128))]),_:1})]),extra:tt(()=>[il(t.$slots,"extra",{},void 0,!0)]),footer:tt(()=>[st("p",gfe,mi(e.footer),1)]),default:tt(()=>[st("div",mfe,[il(t.$slots,"default",{},void 0,!0)])]),_:3},8,["subtitle"])}}}),bfe=ul(yfe,[["__scopeId","data-v-6f639b76"]]),xfe=Ve({__name:"FormTab",setup(e){return(t,r)=>(ft(),Ei(ke(e6),{type:"segment",animated:""},{default:tt(()=>[Be(ke(ix),{name:"Observation",tab:"Observation"},{default:tt(()=>[il(t.$slots,"observation")]),_:3}),Be(ke(ix),{name:"ImagingStudy",tab:"ImagingStudy"},{default:tt(()=>[il(t.$slots,"imagingstudy")]),_:3})]),_:3}))}});var $6={exports:{}};const wfe={},Sfe=Object.freeze(Object.defineProperty({__proto__:null,default:wfe},Symbol.toStringTag,{value:"Module"})),Cfe=Lie(Sfe);/*! dicom-parser - 1.8.12 - 2023-02-20 | (c) 2017 Chris Hafey | https://github.com/cornerstonejs/dicomParser */(function(e,t){(function(r,i){e.exports=i(Cfe)})(kie,function(r){return n=[function(o,s){o.exports=r},function(o,s,l){l.r(s),l.d(s,"isStringVr",function(){return d}),l.d(s,"isPrivateTag",function(){return u}),l.d(s,"parsePN",function(){return h}),l.d(s,"parseTM",function(){return f}),l.d(s,"parseDA",function(){return v}),l.d(s,"explicitElementToString",function(){return m}),l.d(s,"explicitDataSetToJS",function(){return g}),l.d(s,"createJPEGBasicOffsetTable",function(){return x}),l.d(s,"parseDicomDataSetExplicit",function(){return W}),l.d(s,"parseDicomDataSetImplicit",function(){return q}),l.d(s,"readFixedString",function(){return C}),l.d(s,"alloc",function(){return $}),l.d(s,"version",function(){return le}),l.d(s,"bigEndianByteArrayParser",function(){return ee}),l.d(s,"ByteStream",function(){return V}),l.d(s,"sharedCopy",function(){return Q}),l.d(s,"DataSet",function(){return P}),l.d(s,"findAndSetUNElementLength",function(){return _}),l.d(s,"findEndOfEncapsulatedElement",function(){return w}),l.d(s,"findItemDelimitationItemAndSetElementLength",function(){return T}),l.d(s,"littleEndianByteArrayParser",function(){return de}),l.d(s,"parseDicom",function(){return G}),l.d(s,"readDicomElementExplicit",function(){return X}),l.d(s,"readDicomElementImplicit",function(){return z}),l.d(s,"readEncapsulatedImageFrame",function(){return _e}),l.d(s,"readEncapsulatedPixelData",function(){return fe}),l.d(s,"readEncapsulatedPixelDataFromFragments",function(){return ue}),l.d(s,"readPart10Header",function(){return me}),l.d(s,"readSequenceItemsExplicit",function(){return ie}),l.d(s,"readSequenceItemsImplicit",function(){return N}),l.d(s,"readSequenceItem",function(){return F}),l.d(s,"readTag",function(){return S});var c={AE:!0,AS:!0,AT:!1,CS:!0,DA:!0,DS:!0,DT:!0,FL:!1,FD:!1,IS:!0,LO:!0,LT:!0,OB:!1,OD:!1,OF:!1,OW:!1,PN:!0,SH:!0,SL:!1,SQ:!1,SS:!1,ST:!0,TM:!0,UI:!0,UL:!1,UN:void 0,UR:!0,US:!1,UT:!0},d=function(B){return c[B]},u=function(B){if(B=parseInt(B[4],16),isNaN(B))throw"dicomParser.isPrivateTag: cannot parse last character of group";return B%2==1},h=function(B){if(B!==void 0)return B=B.split("^"),{familyName:B[0],givenName:B[1],middleName:B[2],prefix:B[3],suffix:B[4]}};function f(B,D){if(2<=B.length){var I=parseInt(B.substring(0,2),10),O=4<=B.length?parseInt(B.substring(2,4),10):void 0,j=6<=B.length?parseInt(B.substring(4,6),10):void 0,L=8<=B.length?B.substring(7,13):void 0,L=L?parseInt(L,10)*Math.pow(10,6-L.length):void 0;if(D&&(isNaN(I)||O!==void 0&&isNaN(O)||j!==void 0&&isNaN(j)||L!==void 0&&isNaN(L)||I<0||23<I||O&&(O<0||59<O)||j&&(j<0||59<j)||L&&(L<0||999999<L)))throw"invalid TM '".concat(B,"'");return{hours:I,minutes:O,seconds:j,fractionalSeconds:L}}if(D)throw"invalid TM '".concat(B,"'")}function p(B,D,I){return!isNaN(I)&&0<D&&D<=12&&0<B&&B<=function(O,j){switch(O){case 2:return j%4==0&&j%100||j%400==0?29:28;case 9:case 4:case 6:case 11:return 30;default:return 31}}(D,I)}function v(B,D){if(B&&B.length===8){var I=parseInt(B.substring(0,4),10),O=parseInt(B.substring(4,6),10),j=parseInt(B.substring(6,8),10);if(D&&p(j,O,I)!==!0)throw"invalid DA '".concat(B,"'");return{year:I,month:O,day:j}}if(D)throw"invalid DA '".concat(B,"'")}function m(B,D){if(B===void 0||D===void 0)throw"dicomParser.explicitElementToString: missing required parameters";if(D.vr===void 0)throw"dicomParser.explicitElementToString: cannot convert implicit element to string";var I,O=D.vr,j=D.tag;function L(We,je){for(var ze="",Je=0;Je<We;Je++)Je!==0&&(ze+="/"),ze+=je.call(B,j,Je).toString();return ze}if(d(O)===!0)I=B.string(j);else{if(O==="AT"){var Ae=B.uint32(j);return Ae===void 0?void 0:"x".concat((Ae=Ae<0?4294967295+Ae+1:Ae).toString(16).toUpperCase())}O==="US"?I=L(D.length/2,B.uint16):O==="SS"?I=L(D.length/2,B.int16):O==="UL"?I=L(D.length/4,B.uint32):O==="SL"?I=L(D.length/4,B.int32):O==="FD"?I=L(D.length/8,B.double):O==="FL"&&(I=L(D.length/4,B.float))}return I}function g(B,D){if(B===void 0)throw"dicomParser.explicitDataSetToJS: missing required parameter dataSet";D=D||{omitPrivateAttibutes:!0,maxElementLength:128};var I,O={};for(I in B.elements){var j=B.elements[I];if(D.omitPrivateAttibutes!==!0||!u(I))if(j.items){for(var L=[],Ae=0;Ae<j.items.length;Ae++)L.push(g(j.items[Ae].dataSet,D));O[I]=L}else{var We=void 0;j.length<D.maxElementLength&&(We=m(B,j)),O[I]=We!==void 0?We:{dataOffset:j.dataOffset,length:j.length}}}return O}function y(B,D){return B.byteArray[D]===255&&B.byteArray[D+1]===217}function b(B,D,I){for(var O,j,L=I;L<D.fragments.length;L++)if(O=B,j=L,j=D.fragments[j],!(!y(O,j.position+j.length-2)&&!y(O,j.position+j.length-3)))return L}function x(B,D,I){if(B===void 0)throw"dicomParser.createJPEGBasicOffsetTable: missing required parameter dataSet";if(D===void 0)throw"dicomParser.createJPEGBasicOffsetTable: missing required parameter pixelDataElement";if(D.tag!=="x7fe00010")throw"dicomParser.createJPEGBasicOffsetTable: parameter 'pixelDataElement' refers to non pixel data tag (expected tag = x7fe00010'";if(D.encapsulatedPixelData!==!0||D.hadUndefinedLength!==!0||D.basicOffsetTable===void 0||D.fragments===void 0||D.fragments.length<=0)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(I&&I.length<=0)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'fragments' must not be zero length";I=I||D.fragments;for(var O=[],j=0;;){O.push(D.fragments[j].offset);var L=b(B,D,j);if(L===void 0||L===D.fragments.length-1)return O;j=L+1}}function S(I){if(I===void 0)throw"dicomParser.readTag: missing required parameter 'byteStream'";var D=256*I.readUint16()*256,I=I.readUint16();return"x".concat("00000000".concat((D+I).toString(16)).substr(-8))}function w(B,D,I){if(B===void 0)throw"dicomParser.findEndOfEncapsulatedElement: missing required parameter 'byteStream'";if(D===void 0)throw"dicomParser.findEndOfEncapsulatedElement: missing required parameter 'element'";if(D.encapsulatedPixelData=!0,D.basicOffsetTable=[],D.fragments=[],S(B)!=="xfffee000")throw"dicomParser.findEndOfEncapsulatedElement: basic offset table not found";for(var O=B.readUint32()/4,j=0;j<O;j++){var L=B.readUint32();D.basicOffsetTable.push(L)}for(var Ae=B.position;B.position<B.byteArray.length;){var We=S(B),je=B.readUint32();if(We==="xfffee0dd")return B.seek(je),void(D.length=B.position-D.dataOffset);if(We!=="xfffee000")return I&&I.push("unexpected tag ".concat(We," while searching for end of pixel data element with undefined length")),je>B.byteArray.length-B.position&&(je=B.byteArray.length-B.position),D.fragments.push({offset:B.position-Ae-8,position:B.position,length:je}),B.seek(je),void(D.length=B.position-D.dataOffset);D.fragments.push({offset:B.position-Ae-8,position:B.position,length:je}),B.seek(je)}I&&I.push("pixel data element ".concat(D.tag," missing sequence delimiter tag xfffee0dd"))}function _(B,D){if(B===void 0)throw"dicomParser.findAndSetUNElementLength: missing required parameter 'byteStream'";for(var I=B.byteArray.length-8;B.position<=I;)if(B.readUint16()===65534){var O=B.readUint16();if(O===57565)return B.readUint32()!==0&&B.warnings("encountered non zero length following item delimiter at position ".concat(B.position-4," while reading element of undefined length with tag ").concat(D.tag)),void(D.length=B.position-D.dataOffset)}D.length=B.byteArray.length-D.dataOffset,B.seek(B.byteArray.length-B.position)}function C(B,D,I){if(I<0)throw"dicomParser.readFixedString - length cannot be less than 0";if(D+I>B.length)throw"dicomParser.readFixedString: attempt to read past end of buffer";for(var O,j="",L=0;L<I;L++){if((O=B[D+L])===0)return D+=I,j;j+=String.fromCharCode(O)}return j}function A(B,D){for(var I=0;I<D.length;I++){var O=D[I];O.enumerable=O.enumerable||!1,O.configurable=!0,"value"in O&&(O.writable=!0),Object.defineProperty(B,O.key,O)}}function M(B,D){return B.parser!==void 0?B.parser:D}var P=function(){function B(O,j,L){(function(Ae,We){if(!(Ae instanceof We))throw new TypeError("Cannot call a class as a function")})(this,B),this.byteArrayParser=O,this.byteArray=j,this.elements=L}var D,I;return D=B,(I=[{key:"uint16",value:function(O,j){if(O=this.elements[O],j=j!==void 0?j:0,O&&O.length!==0)return M(O,this.byteArrayParser).readUint16(this.byteArray,O.dataOffset+2*j)}},{key:"int16",value:function(O,j){if(O=this.elements[O],j=j!==void 0?j:0,O&&O.length!==0)return M(O,this.byteArrayParser).readInt16(this.byteArray,O.dataOffset+2*j)}},{key:"uint32",value:function(O,j){if(O=this.elements[O],j=j!==void 0?j:0,O&&O.length!==0)return M(O,this.byteArrayParser).readUint32(this.byteArray,O.dataOffset+4*j)}},{key:"int32",value:function(O,j){if(O=this.elements[O],j=j!==void 0?j:0,O&&O.length!==0)return M(O,this.byteArrayParser).readInt32(this.byteArray,O.dataOffset+4*j)}},{key:"float",value:function(O,j){if(O=this.elements[O],j=j!==void 0?j:0,O&&O.length!==0)return M(O,this.byteArrayParser).readFloat(this.byteArray,O.dataOffset+4*j)}},{key:"double",value:function(O,j){if(O=this.elements[O],j=j!==void 0?j:0,O&&O.length!==0)return M(O,this.byteArrayParser).readDouble(this.byteArray,O.dataOffset+8*j)}},{key:"numStringValues",value:function(O){if(O=this.elements[O],O&&0<O.length)return O=C(this.byteArray,O.dataOffset,O.length).match(/\\/g),O===null?1:O.length+1}},{key:"string",value:function(O,j){if(O=this.elements[O],O&&O.Value)return O.Value;if(O&&0<O.length)return O=C(this.byteArray,O.dataOffset,O.length),0<=j?O.split("\\")[j].trim():O.trim()}},{key:"text",value:function(O,j){if(O=this.elements[O],O&&0<O.length)return O=C(this.byteArray,O.dataOffset,O.length),0<=j?O.split("\\")[j].replace(/ +$/,""):O.replace(/ +$/,"")}},{key:"floatString",value:function(O,j){var L=this.elements[O];if(L&&0<L.length&&(j=this.string(O,j=j!==void 0?j:0),j!==void 0))return parseFloat(j)}},{key:"intString",value:function(O,j){var L=this.elements[O];if(L&&0<L.length&&(j=this.string(O,j=j!==void 0?j:0),j!==void 0))return parseInt(j)}},{key:"attributeTag",value:function(O){var j=this.elements[O];if(j&&j.length===4){var L=M(j,this.byteArrayParser).readUint16,O=this.byteArray,j=j.dataOffset;return"x".concat("00000000".concat((256*L(O,j)*256+L(O,j+2)).toString(16)).substr(-8))}}}])&&A(D.prototype,I),Object.defineProperty(D,"prototype",{writable:!1}),B}();function T(B,D){if(B===void 0)throw"dicomParser.readDicomElementImplicit: missing required parameter 'byteStream'";for(var I=B.byteArray.length-8;B.position<=I;)if(B.readUint16()===65534){var O=B.readUint16();if(O===57357)return B.readUint32()!==0&&B.warnings("encountered non zero length following item delimiter at position ".concat(B.position-4," while reading element of undefined length with tag ").concat(D.tag)),void(D.length=B.position-D.dataOffset)}D.length=B.byteArray.length-D.dataOffset,B.seek(B.byteArray.length-B.position)}var R=function(B,D){return B.vr!==void 0?B.vr==="SQ":D.position+4<=D.byteArray.length?(B=S(D),D.seek(-4),B==="xfffee000"||B==="xfffee0dd"):(D.warnings.push("eof encountered before finding sequence item tag or sequence delimiter tag in peeking to determine VR"),!1)};function z(B,D,I){if(B===void 0)throw"dicomParser.readDicomElementImplicit: missing required parameter 'byteStream'";var O=S(B),O={tag:O,vr:I!==void 0?I(O):void 0,length:B.readUint32(),dataOffset:B.position};return O.length===4294967295&&(O.hadUndefinedLength=!0),O.tag===D||(!R(O,B)||u(O.tag)&&!O.hadUndefinedLength?O.hadUndefinedLength?T(B,O):B.seek(O.length):(N(B,O,I),u(O.tag)&&(O.items=void 0))),O}function F(B){if(B===void 0)throw"dicomParser.readSequenceItem: missing required parameter 'byteStream'";var D={tag:S(B),length:B.readUint32(),dataOffset:B.position};if(D.tag!=="xfffee000")throw"dicomParser.readSequenceItem: item tag (FFFE,E000) not found at offset ".concat(B.position);return D}function H(B,D){var I=F(B);return I.length===4294967295?(I.hadUndefinedLength=!0,I.dataSet=function(O,j){for(var L={};O.position<O.byteArray.length;){var Ae=z(O,void 0,j);if((L[Ae.tag]=Ae).tag==="xfffee00d")return new P(O.byteArrayParser,O.byteArray,L)}return O.warnings.push("eof encountered before finding sequence item delimiter in sequence item of undefined length"),new P(O.byteArrayParser,O.byteArray,L)}(B,D),I.length=B.position-I.dataOffset):(I.dataSet=new P(B.byteArrayParser,B.byteArray,{}),q(I.dataSet,B,B.position+I.length,{vrCallback:D})),I}function N(B,D,I){if(B===void 0)throw"dicomParser.readSequenceItemsImplicit: missing required parameter 'byteStream'";if(D===void 0)throw"dicomParser.readSequenceItemsImplicit: missing required parameter 'element'";D.items=[],(D.length===4294967295?function(O,j,L){for(;O.position+4<=O.byteArray.length;){var Ae=S(O);if(O.seek(-4),Ae==="xfffee0dd")return j.length=O.position-j.dataOffset,O.seek(8);Ae=H(O,L),j.items.push(Ae)}O.warnings.push("eof encountered before finding sequence delimiter in sequence of undefined length"),j.length=O.byteArray.length-j.dataOffset}:function(O,j,L){for(var Ae=j.dataOffset+j.length;O.position<Ae;){var We=H(O,L);j.items.push(We)}})(B,D,I)}function U(B,D){var I=F(B);return I.length===4294967295?(I.hadUndefinedLength=!0,I.dataSet=function(O,j){for(var L={};O.position<O.byteArray.length;){var Ae=X(O,j);if((L[Ae.tag]=Ae).tag==="xfffee00d")return new P(O.byteArrayParser,O.byteArray,L)}return j.push("eof encountered before finding item delimiter tag while reading sequence item of undefined length"),new P(O.byteArrayParser,O.byteArray,L)}(B,D),I.length=B.position-I.dataOffset):(I.dataSet=new P(B.byteArrayParser,B.byteArray,{}),W(I.dataSet,B,B.position+I.length)),I}function ie(B,D,I){if(B===void 0)throw"dicomParser.readSequenceItemsExplicit: missing required parameter 'byteStream'";if(D===void 0)throw"dicomParser.readSequenceItemsExplicit: missing required parameter 'element'";D.items=[],(D.length===4294967295?function(O,j,L){for(;O.position+4<=O.byteArray.length;){var Ae=S(O);if(O.seek(-4),Ae==="xfffee0dd")return j.length=O.position-j.dataOffset,O.seek(8);Ae=U(O,L),j.items.push(Ae)}L.push("eof encountered before finding sequence delimitation tag while reading sequence of undefined length"),j.length=O.position-j.dataOffset}:function(O,j,L){for(var Ae=j.dataOffset+j.length;O.position<Ae;){var We=U(O,L);j.items.push(We)}})(B,D,I)}var te=function(B){return B==="OB"||B==="OD"||B==="OL"||B==="OW"||B==="SQ"||B==="OF"||B==="UC"||B==="UR"||B==="UT"||B==="UN"?4:2};function X(B,D,I){if(B===void 0)throw"dicomParser.readDicomElementExplicit: missing required parameter 'byteStream'";var O={tag:S(B),vr:B.readFixedString(2)};return te(O.vr)===2?O.length=B.readUint16():(B.seek(2),O.length=B.readUint32()),O.dataOffset=B.position,O.length===4294967295&&(O.hadUndefinedLength=!0),O.tag===I||(O.vr==="SQ"?ie(B,O,D):O.length===4294967295?O.tag==="x7fe00010"?w(B,O,D):(O.vr==="UN"?N:T)(B,O):B.seek(O.length)),O}function W(B,D,I){var O=3<arguments.length&&arguments[3]!==void 0?arguments[3]:{};if(I=I===void 0?D.byteArray.length:I,D===void 0)throw"dicomParser.parseDicomDataSetExplicit: missing required parameter 'byteStream'";if(I<D.position||I>D.byteArray.length)throw"dicomParser.parseDicomDataSetExplicit: invalid value for parameter 'maxP osition'";for(var j=B.elements;D.position<I;){var L=X(D,B.warnings,O.untilTag);if((j[L.tag]=L).tag===O.untilTag)return}if(D.position>I)throw"dicomParser:parseDicomDataSetExplicit: buffer overrun"}function q(B,D,I){var O=3<arguments.length&&arguments[3]!==void 0?arguments[3]:{};if(I=I===void 0?B.byteArray.length:I,D===void 0)throw"dicomParser.parseDicomDataSetImplicit: missing required parameter 'byteStream'";if(I<D.position||I>D.byteArray.length)throw"dicomParser.parseDicomDataSetImplicit: invalid value for parameter 'maxPosition'";for(var j=B.elements;D.position<I;){var L=z(D,O.untilTag,O.vrCallback);if((j[L.tag]=L).tag===O.untilTag)return}}function $(B,D){if(typeof Buffer<"u"&&B instanceof Buffer)return Buffer.alloc(D);if(B instanceof Uint8Array)return new Uint8Array(D);throw"dicomParser.alloc: unknown type for byteArray"}var le="1.8.12",ee={readUint16:function(B,D){if(D<0)throw"bigEndianByteArrayParser.readUint16: position cannot be less than 0";if(D+2>B.length)throw"bigEndianByteArrayParser.readUint16: attempt to read past end of buffer";return(B[D]<<8)+B[D+1]},readInt16:function(B,D){if(D<0)throw"bigEndianByteArrayParser.readInt16: position cannot be less than 0";if(D+2>B.length)throw"bigEndianByteArrayParser.readInt16: attempt to read past end of buffer";return D=(B[D]<<8)+B[D+1],D=32768&D?D-65535-1:D},readUint32:function(B,D){if(D<0)throw"bigEndianByteArrayParser.readUint32: position cannot be less than 0";if(D+4>B.length)throw"bigEndianByteArrayParser.readUint32: attempt to read past end of buffer";return 256*(256*(256*B[D]+B[D+1])+B[D+2])+B[D+3]},readInt32:function(B,D){if(D<0)throw"bigEndianByteArrayParser.readInt32: position cannot be less than 0";if(D+4>B.length)throw"bigEndianByteArrayParser.readInt32: attempt to read past end of buffer";return(B[D]<<24)+(B[D+1]<<16)+(B[D+2]<<8)+B[D+3]},readFloat:function(B,D){if(D<0)throw"bigEndianByteArrayParser.readFloat: position cannot be less than 0";if(D+4>B.length)throw"bigEndianByteArrayParser.readFloat: attempt to read past end of buffer";var I=new Uint8Array(4);return I[3]=B[D],I[2]=B[D+1],I[1]=B[D+2],I[0]=B[D+3],new Float32Array(I.buffer)[0]},readDouble:function(B,D){if(D<0)throw"bigEndianByteArrayParser.readDouble: position cannot be less than 0";if(D+8>B.length)throw"bigEndianByteArrayParser.readDouble: attempt to read past end of buffer";var I=new Uint8Array(8);return I[7]=B[D],I[6]=B[D+1],I[5]=B[D+2],I[4]=B[D+3],I[3]=B[D+4],I[2]=B[D+5],I[1]=B[D+6],I[0]=B[D+7],new Float64Array(I.buffer)[0]}};function Q(B,D,I){if(typeof Buffer<"u"&&B instanceof Buffer)return B.slice(D,D+I);if(B instanceof Uint8Array)return new Uint8Array(B.buffer,B.byteOffset+D,I);throw"dicomParser.from: unknown type for byteArray"}function ne(B,D){for(var I=0;I<D.length;I++){var O=D[I];O.enumerable=O.enumerable||!1,O.configurable=!0,"value"in O&&(O.writable=!0),Object.defineProperty(B,O.key,O)}}var V=function(){function B(O,j,L){if(function(Ae,We){if(!(Ae instanceof We))throw new TypeError("Cannot call a class as a function")}(this,B),O===void 0)throw"dicomParser.ByteStream: missing required parameter 'byteArrayParser'";if(j===void 0)throw"dicomParser.ByteStream: missing required parameter 'byteArray'";if(!(j instanceof Uint8Array)&&(typeof Buffer>"u"||!(j instanceof Buffer)))throw"dicomParser.ByteStream: parameter byteArray is not of type Uint8Array or Buffer";if(L<0)throw"dicomParser.ByteStream: parameter 'position' cannot be less than 0";if(L>=j.length)throw"dicomParser.ByteStream: parameter 'position' cannot be greater than or equal to 'byteArray' length";this.byteArrayParser=O,this.byteArray=j,this.position=L||0,this.warnings=[]}var D,I;return D=B,(I=[{key:"seek",value:function(O){if(this.position+O<0)throw"dicomParser.ByteStream.prototype.seek: cannot seek to position < 0";this.position+=O}},{key:"readByteStream",value:function(O){if(this.position+O>this.byteArray.length)throw"dicomParser.ByteStream.prototype.readByteStream: readByteStream - buffer overread";var j=Q(this.byteArray,this.position,O);return this.position+=O,new B(this.byteArrayParser,j)}},{key:"getSize",value:function(){return this.byteArray.length}},{key:"readUint16",value:function(){var O=this.byteArrayParser.readUint16(this.byteArray,this.position);return this.position+=2,O}},{key:"readUint32",value:function(){var O=this.byteArrayParser.readUint32(this.byteArray,this.position);return this.position+=4,O}},{key:"readFixedString",value:function(O){var j=C(this.byteArray,this.position,O);return this.position+=O,j}}])&&ne(D.prototype,I),Object.defineProperty(D,"prototype",{writable:!1}),B}(),de={readUint16:function(B,D){if(D<0)throw"littleEndianByteArrayParser.readUint16: position cannot be less than 0";if(D+2>B.length)throw"littleEndianByteArrayParser.readUint16: attempt to read past end of buffer";return B[D]+256*B[D+1]},readInt16:function(B,D){if(D<0)throw"littleEndianByteArrayParser.readInt16: position cannot be less than 0";if(D+2>B.length)throw"littleEndianByteArrayParser.readInt16: attempt to read past end of buffer";return D=B[D]+(B[D+1]<<8),D=32768&D?D-65535-1:D},readUint32:function(B,D){if(D<0)throw"littleEndianByteArrayParser.readUint32: position cannot be less than 0";if(D+4>B.length)throw"littleEndianByteArrayParser.readUint32: attempt to read past end of buffer";return B[D]+256*B[D+1]+256*B[D+2]*256+256*B[D+3]*256*256},readInt32:function(B,D){if(D<0)throw"littleEndianByteArrayParser.readInt32: position cannot be less than 0";if(D+4>B.length)throw"littleEndianByteArrayParser.readInt32: attempt to read past end of buffer";return B[D]+(B[D+1]<<8)+(B[D+2]<<16)+(B[D+3]<<24)},readFloat:function(B,D){if(D<0)throw"littleEndianByteArrayParser.readFloat: position cannot be less than 0";if(D+4>B.length)throw"littleEndianByteArrayParser.readFloat: attempt to read past end of buffer";var I=new Uint8Array(4);return I[0]=B[D],I[1]=B[D+1],I[2]=B[D+2],I[3]=B[D+3],new Float32Array(I.buffer)[0]},readDouble:function(B,D){if(D<0)throw"littleEndianByteArrayParser.readDouble: position cannot be less than 0";if(D+8>B.length)throw"littleEndianByteArrayParser.readDouble: attempt to read past end of buffer";var I=new Uint8Array(8);return I[0]=B[D],I[1]=B[D+1],I[2]=B[D+2],I[3]=B[D+3],I[4]=B[D+4],I[5]=B[D+5],I[6]=B[D+6],I[7]=B[D+7],new Float64Array(I.buffer)[0]}};function me(B){var D=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};if(B===void 0)throw"dicomParser.readPart10Header: missing required parameter 'byteArray'";var I=D.TransferSyntaxUID,O=new V(de,B);return function(){var j=function(){if(O.getSize()<=132&&I)return!1;if(O.seek(128),O.readFixedString(4)==="DICM")return!0;if(!(D||{}).TransferSyntaxUID)throw"dicomParser.readPart10Header: DICM prefix not found at location 132 - this is not a valid DICOM P10 file.";return O.seek(0),!1}(),L=[],Ae={};if(!j)return O.position=0,{elements:{x00020010:{tag:"x00020010",vr:"UI",Value:I}},warnings:L};for(;O.position<O.byteArray.length;){var We=O.position,je=X(O,L);if("x0002ffff"<je.tag){O.position=We;break}je.parser=de,Ae[je.tag]=je}return(j=new P(O.byteArrayParser,O.byteArray,Ae)).warnings=O.warnings,j.position=O.position,j}()}var Ce="1.2.840.10008.1.2.2";function G(B){var D=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};if(B===void 0)throw new Error("dicomParser.parseDicom: missing required parameter 'byteArray'");var I,O=function(L){if(L.elements.x00020010===void 0)throw new Error("dicomParser.parseDicom: missing required meta header attribute 0002,0010");return L=L.elements.x00020010,L&&L.Value||C(B,L.dataOffset,L.length)};function j(je){var We=O(je),Ae=We!=="1.2.840.10008.1.2",We=function(ze,Je){var nt=Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]";if(ze!=="1.2.840.10008.1.2.1.99")return new V(ze===Ce?ee:de,B,Je);if(D&&D.inflater)return ze=D.inflater(B,Je),new V(de,ze,0);if(nt==!0){var lt=l(0),dt=Q(B,Je,B.length-Je),lt=lt.inflateRawSync(dt),dt=$(B,lt.length+Je);return B.copy(dt,0,0,Je),lt.copy(dt,Je),new V(de,dt,0)}if(typeof pako>"u")throw"dicomParser.parseDicom: no inflater available to handle deflate transfer syntax";return lt=B.slice(Je),dt=pako.inflateRaw(lt),(lt=$(B,dt.length+Je)).set(B.slice(0,Je),0),lt.set(dt,Je),new V(de,lt,0)}(We,je.position),je=new P(We.byteArrayParser,We.byteArray,{});je.warnings=We.warnings;try{(Ae?W:q)(je,We,We.byteArray.length,D)}catch(ze){throw{exception:ze,dataSet:je}}return je}return function(L,Ae){for(var We in L.elements)L.elements.hasOwnProperty(We)&&(Ae.elements[We]=L.elements[We]);return L.warnings!==void 0&&(Ae.warnings=L.warnings.concat(Ae.warnings)),Ae}(I=me(B,D),j(I))}var Z=function(B,D,I){for(var O=0,j=D;j<D+I;j++)O+=B[j].length;return O};function ue(B,Ae,I,O,j){if(j=j||Ae.fragments,B===void 0)throw"dicomParser.readEncapsulatedPixelDataFromFragments: missing required parameter 'dataSet'";if(Ae===void 0)throw"dicomParser.readEncapsulatedPixelDataFromFragments: missing required parameter 'pixelDataElement'";if(I===void 0)throw"dicomParser.readEncapsulatedPixelDataFromFragments: missing required parameter 'startFragmentIndex'";if((O=O||1)===void 0)throw"dicomParser.readEncapsulatedPixelDataFromFragments: missing required parameter 'numFragments'";if(Ae.tag!=="x7fe00010")throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'pixelDataElement' refers to non pixel data tag (expected tag = x7fe00010";if(Ae.encapsulatedPixelData!==!0||Ae.hadUndefinedLength!==!0||Ae.basicOffsetTable===void 0||Ae.fragments===void 0||Ae.fragments.length<=0)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(I<0)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'startFragmentIndex' must be >= 0";if(I>=Ae.fragments.length)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'startFragmentIndex' must be < number of fragments";if(O<1)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'numFragments' must be > 0";if(I+O>Ae.fragments.length)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'startFragment' + 'numFragments' < number of fragments";var L=new V(B.byteArrayParser,B.byteArray,Ae.dataOffset),Ae=F(L);if(Ae.tag!=="xfffee000")throw"dicomParser.readEncapsulatedPixelData: missing basic offset table xfffee000";L.seek(Ae.length);var We=L.position;if(O===1)return Q(L.byteArray,We+j[I].offset+8,j[I].length);for(var Ae=Z(j,I,O),je=$(L.byteArray,Ae),ze=0,Je=I;Je<I+O;Je++)for(var nt=We+j[Je].offset+8,lt=0;lt<j[Je].length;lt++)je[ze++]=L.byteArray[nt++];return je}var Se=function(B,D){for(var I=0;I<B.length;I++)if(B[I].offset===D)return I},we=function(B,D,I,O){if(B===D.length-1)return I.length-O;for(var j=D[B+1],L=O+1;L<I.length;L++)if(I[L].offset===j)return L-O;throw"dicomParser.calculateNumberOfFragmentsForFrame: could not find fragment with offset matching basic offset table"};function _e(B,D,I,O,j){if(O=O||D.basicOffsetTable,j=j||D.fragments,B===void 0)throw"dicomParser.readEncapsulatedImageFrame: missing required parameter 'dataSet'";if(D===void 0)throw"dicomParser.readEncapsulatedImageFrame: missing required parameter 'pixelDataElement'";if(I===void 0)throw"dicomParser.readEncapsulatedImageFrame: missing required parameter 'frameIndex'";if(O===void 0)throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' does not have basicOffsetTable";if(D.tag!=="x7fe00010")throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' refers to non pixel data tag (expected tag = x7fe00010)";if(D.encapsulatedPixelData!==!0)throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(D.hadUndefinedLength!==!0)throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' refers to pixel data element that does not have undefined length";if(D.fragments===void 0)throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' refers to pixel data element that does not have fragments";if(O.length===0)throw"dicomParser.readEncapsulatedImageFrame: basicOffsetTable has zero entries";if(I<0)throw"dicomParser.readEncapsulatedImageFrame: parameter 'frameIndex' must be >= 0";if(I>=O.length)throw"dicomParser.readEncapsulatedImageFrame: parameter 'frameIndex' must be < basicOffsetTable.length";var L=O[I],L=Se(j,L);if(L===void 0)throw"dicomParser.readEncapsulatedImageFrame: unable to find fragment that matches basic offset table entry";return ue(B,D,L,we(I,O,j,L),j)}var Ee=!1;function fe(B,D,I){if(Ee||(Ee=!0,console&&console.log&&console.log("WARNING: dicomParser.readEncapsulatedPixelData() has been deprecated")),B===void 0)throw"dicomParser.readEncapsulatedPixelData: missing required parameter 'dataSet'";if(D===void 0)throw"dicomParser.readEncapsulatedPixelData: missing required parameter 'element'";if(I===void 0)throw"dicomParser.readEncapsulatedPixelData: missing required parameter 'frame'";if(D.tag!=="x7fe00010")throw"dicomParser.readEncapsulatedPixelData: parameter 'element' refers to non pixel data tag (expected tag = x7fe00010)";if(D.encapsulatedPixelData!==!0||D.hadUndefinedLength!==!0||D.basicOffsetTable===void 0||D.fragments===void 0)throw"dicomParser.readEncapsulatedPixelData: parameter 'element' refers to pixel data element that does not have encapsulated pixel data";if(I<0)throw"dicomParser.readEncapsulatedPixelData: parameter 'frame' must be >= 0";return D.basicOffsetTable.length!==0?_e(B,D,I):ue(B,D,0,D.fragments.length)}s.default={isStringVr:d,isPrivateTag:u,parsePN:h,parseTM:f,parseDA:v,explicitElementToString:m,explicitDataSetToJS:g,createJPEGBasicOffsetTable:x,parseDicomDataSetExplicit:W,parseDicomDataSetImplicit:q,readFixedString:C,alloc:$,version:le,bigEndianByteArrayParser:ee,ByteStream:V,sharedCopy:Q,DataSet:P,findAndSetUNElementLength:_,findEndOfEncapsulatedElement:w,findItemDelimitationItemAndSetElementLength:T,littleEndianByteArrayParser:de,parseDicom:G,readDicomElementExplicit:X,readDicomElementImplicit:z,readEncapsulatedImageFrame:_e,readEncapsulatedPixelData:fe,readEncapsulatedPixelDataFromFragments:ue,readPart10Header:me,readSequenceItemsExplicit:ie,readSequenceItemsImplicit:N,readSequenceItem:F,readTag:S,LEI:"1.2.840.10008.1.2",LEE:"1.2.840.10008.1.2.1"}}],a={},i.m=n,i.c=a,i.d=function(o,s,l){i.o(o,s)||Object.defineProperty(o,s,{enumerable:!0,get:l})},i.r=function(o){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})},i.t=function(o,s){if(1&s&&(o=i(o)),8&s||4&s&&typeof o=="object"&&o&&o.__esModule)return o;var l=Object.create(null);if(i.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:o}),2&s&&typeof o!="string")for(var c in o)i.d(l,c,(function(d){return o[d]}).bind(null,c));return l},i.n=function(o){var s=o&&o.__esModule?function(){return o.default}:function(){return o};return i.d(s,"a",s),s},i.o=function(o,s){return Object.prototype.hasOwnProperty.call(o,s)},i.p="",i(i.s=1);function i(o){if(a[o])return a[o].exports;var s=a[o]={i:o,l:!1,exports:{}};return n[o].call(s.exports,s,s.exports,i),s.l=!0,s.exports}var n,a})})($6);var _fe=$6.exports;const Afe=kg(_fe);function gs(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function eh(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}const q6=6048e5,Mfe=864e5;let Efe={};function Y1(){return Efe}function rg(e,t){var s,l,c,d;const r=Y1(),i=(t==null?void 0:t.weekStartsOn)??((l=(s=t==null?void 0:t.locale)==null?void 0:s.options)==null?void 0:l.weekStartsOn)??r.weekStartsOn??((d=(c=r.locale)==null?void 0:c.options)==null?void 0:d.weekStartsOn)??0,n=gs(e),a=n.getDay(),o=(a<i?7:0)+a-i;return n.setDate(n.getDate()-o),n.setHours(0,0,0,0),n}function ox(e){return rg(e,{weekStartsOn:1})}function Y6(e){const t=gs(e),r=t.getFullYear(),i=eh(e,0);i.setFullYear(r+1,0,4),i.setHours(0,0,0,0);const n=ox(i),a=eh(e,0);a.setFullYear(r,0,4),a.setHours(0,0,0,0);const o=ox(a);return t.getTime()>=n.getTime()?r+1:t.getTime()>=o.getTime()?r:r-1}function UR(e){const t=gs(e);return t.setHours(0,0,0,0),t}function jR(e){const t=gs(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function Tfe(e,t){const r=UR(e),i=UR(t),n=+r-jR(r),a=+i-jR(i);return Math.round((n-a)/Mfe)}function Pfe(e){const t=Y6(e),r=eh(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),ox(r)}function Dfe(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function Ofe(e){if(!Dfe(e)&&typeof e!="number")return!1;const t=gs(e);return!isNaN(Number(t))}function Rfe(e){const t=gs(e),r=eh(e,0);return r.setFullYear(t.getFullYear(),0,1),r.setHours(0,0,0,0),r}const Ife={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},zfe=(e,t,r)=>{let i;const n=Ife[e];return typeof n=="string"?i=n:t===1?i=n.one:i=n.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+i:i+" ago":i};function _S(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const kfe={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Lfe={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Bfe={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Ffe={date:_S({formats:kfe,defaultWidth:"full"}),time:_S({formats:Lfe,defaultWidth:"full"}),dateTime:_S({formats:Bfe,defaultWidth:"full"})},Nfe={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Ufe=(e,t,r,i)=>Nfe[e];function mm(e){return(t,r)=>{const i=r!=null&&r.context?String(r.context):"standalone";let n;if(i==="formatting"&&e.formattingValues){const o=e.defaultFormattingWidth||e.defaultWidth,s=r!=null&&r.width?String(r.width):o;n=e.formattingValues[s]||e.formattingValues[o]}else{const o=e.defaultWidth,s=r!=null&&r.width?String(r.width):e.defaultWidth;n=e.values[s]||e.values[o]}const a=e.argumentCallback?e.argumentCallback(t):t;return n[a]}}const jfe={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Vfe={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Hfe={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Wfe={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Gfe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},$fe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},qfe=(e,t)=>{const r=Number(e),i=r%100;if(i>20||i<10)switch(i%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},Yfe={ordinalNumber:qfe,era:mm({values:jfe,defaultWidth:"wide"}),quarter:mm({values:Vfe,defaultWidth:"wide",argumentCallback:e=>e-1}),month:mm({values:Hfe,defaultWidth:"wide"}),day:mm({values:Wfe,defaultWidth:"wide"}),dayPeriod:mm({values:Gfe,defaultWidth:"wide",formattingValues:$fe,defaultFormattingWidth:"wide"})};function vm(e){return(t,r={})=>{const i=r.width,n=i&&e.matchPatterns[i]||e.matchPatterns[e.defaultMatchWidth],a=t.match(n);if(!a)return null;const o=a[0],s=i&&e.parsePatterns[i]||e.parsePatterns[e.defaultParseWidth],l=Array.isArray(s)?Kfe(s,u=>u.test(o)):Xfe(s,u=>u.test(o));let c;c=e.valueCallback?e.valueCallback(l):l,c=r.valueCallback?r.valueCallback(c):c;const d=t.slice(o.length);return{value:c,rest:d}}}function Xfe(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function Kfe(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function Qfe(e){return(t,r={})=>{const i=t.match(e.matchPattern);if(!i)return null;const n=i[0],a=t.match(e.parsePattern);if(!a)return null;let o=e.valueCallback?e.valueCallback(a[0]):a[0];o=r.valueCallback?r.valueCallback(o):o;const s=t.slice(n.length);return{value:o,rest:s}}}const Zfe=/^(\d+)(th|st|nd|rd)?/i,Jfe=/\d+/i,epe={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},tpe={any:[/^b/i,/^(a|c)/i]},rpe={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},ipe={any:[/1/i,/2/i,/3/i,/4/i]},npe={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},ape={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},ope={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},spe={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},lpe={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},cpe={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},dpe={ordinalNumber:Qfe({matchPattern:Zfe,parsePattern:Jfe,valueCallback:e=>parseInt(e,10)}),era:vm({matchPatterns:epe,defaultMatchWidth:"wide",parsePatterns:tpe,defaultParseWidth:"any"}),quarter:vm({matchPatterns:rpe,defaultMatchWidth:"wide",parsePatterns:ipe,defaultParseWidth:"any",valueCallback:e=>e+1}),month:vm({matchPatterns:npe,defaultMatchWidth:"wide",parsePatterns:ape,defaultParseWidth:"any"}),day:vm({matchPatterns:ope,defaultMatchWidth:"wide",parsePatterns:spe,defaultParseWidth:"any"}),dayPeriod:vm({matchPatterns:lpe,defaultMatchWidth:"any",parsePatterns:cpe,defaultParseWidth:"any"})},upe={code:"en-US",formatDistance:zfe,formatLong:Ffe,formatRelative:Ufe,localize:Yfe,match:dpe,options:{weekStartsOn:0,firstWeekContainsDate:1}};function hpe(e){const t=gs(e);return Tfe(t,Rfe(t))+1}function fpe(e){const t=gs(e),r=+ox(t)-+Pfe(t);return Math.round(r/q6)+1}function X6(e,t){var d,u,h,f;const r=gs(e),i=r.getFullYear(),n=Y1(),a=(t==null?void 0:t.firstWeekContainsDate)??((u=(d=t==null?void 0:t.locale)==null?void 0:d.options)==null?void 0:u.firstWeekContainsDate)??n.firstWeekContainsDate??((f=(h=n.locale)==null?void 0:h.options)==null?void 0:f.firstWeekContainsDate)??1,o=eh(e,0);o.setFullYear(i+1,0,a),o.setHours(0,0,0,0);const s=rg(o,t),l=eh(e,0);l.setFullYear(i,0,a),l.setHours(0,0,0,0);const c=rg(l,t);return r.getTime()>=s.getTime()?i+1:r.getTime()>=c.getTime()?i:i-1}function ppe(e,t){var s,l,c,d;const r=Y1(),i=(t==null?void 0:t.firstWeekContainsDate)??((l=(s=t==null?void 0:t.locale)==null?void 0:s.options)==null?void 0:l.firstWeekContainsDate)??r.firstWeekContainsDate??((d=(c=r.locale)==null?void 0:c.options)==null?void 0:d.firstWeekContainsDate)??1,n=X6(e,t),a=eh(e,0);return a.setFullYear(n,0,i),a.setHours(0,0,0,0),rg(a,t)}function mpe(e,t){const r=gs(e),i=+rg(r,t)-+ppe(r,t);return Math.round(i/q6)+1}function Zr(e,t){const r=e<0?"-":"",i=Math.abs(e).toString().padStart(t,"0");return r+i}const Cc={y(e,t){const r=e.getFullYear(),i=r>0?r:1-r;return Zr(t==="yy"?i%100:i,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):Zr(r+1,2)},d(e,t){return Zr(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return Zr(e.getHours()%12||12,t.length)},H(e,t){return Zr(e.getHours(),t.length)},m(e,t){return Zr(e.getMinutes(),t.length)},s(e,t){return Zr(e.getSeconds(),t.length)},S(e,t){const r=t.length,i=e.getMilliseconds(),n=Math.trunc(i*Math.pow(10,r-3));return Zr(n,t.length)}},Bh={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},VR={G:function(e,t,r){const i=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(i,{width:"abbreviated"});case"GGGGG":return r.era(i,{width:"narrow"});case"GGGG":default:return r.era(i,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const i=e.getFullYear(),n=i>0?i:1-i;return r.ordinalNumber(n,{unit:"year"})}return Cc.y(e,t)},Y:function(e,t,r,i){const n=X6(e,i),a=n>0?n:1-n;if(t==="YY"){const o=a%100;return Zr(o,2)}return t==="Yo"?r.ordinalNumber(a,{unit:"year"}):Zr(a,t.length)},R:function(e,t){const r=Y6(e);return Zr(r,t.length)},u:function(e,t){const r=e.getFullYear();return Zr(r,t.length)},Q:function(e,t,r){const i=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(i);case"QQ":return Zr(i,2);case"Qo":return r.ordinalNumber(i,{unit:"quarter"});case"QQQ":return r.quarter(i,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(i,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(i,{width:"wide",context:"formatting"})}},q:function(e,t,r){const i=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(i);case"qq":return Zr(i,2);case"qo":return r.ordinalNumber(i,{unit:"quarter"});case"qqq":return r.quarter(i,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(i,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(i,{width:"wide",context:"standalone"})}},M:function(e,t,r){const i=e.getMonth();switch(t){case"M":case"MM":return Cc.M(e,t);case"Mo":return r.ordinalNumber(i+1,{unit:"month"});case"MMM":return r.month(i,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(i,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(i,{width:"wide",context:"formatting"})}},L:function(e,t,r){const i=e.getMonth();switch(t){case"L":return String(i+1);case"LL":return Zr(i+1,2);case"Lo":return r.ordinalNumber(i+1,{unit:"month"});case"LLL":return r.month(i,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(i,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(i,{width:"wide",context:"standalone"})}},w:function(e,t,r,i){const n=mpe(e,i);return t==="wo"?r.ordinalNumber(n,{unit:"week"}):Zr(n,t.length)},I:function(e,t,r){const i=fpe(e);return t==="Io"?r.ordinalNumber(i,{unit:"week"}):Zr(i,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):Cc.d(e,t)},D:function(e,t,r){const i=hpe(e);return t==="Do"?r.ordinalNumber(i,{unit:"dayOfYear"}):Zr(i,t.length)},E:function(e,t,r){const i=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(i,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(i,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(i,{width:"short",context:"formatting"});case"EEEE":default:return r.day(i,{width:"wide",context:"formatting"})}},e:function(e,t,r,i){const n=e.getDay(),a=(n-i.weekStartsOn+8)%7||7;switch(t){case"e":return String(a);case"ee":return Zr(a,2);case"eo":return r.ordinalNumber(a,{unit:"day"});case"eee":return r.day(n,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(n,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(n,{width:"short",context:"formatting"});case"eeee":default:return r.day(n,{width:"wide",context:"formatting"})}},c:function(e,t,r,i){const n=e.getDay(),a=(n-i.weekStartsOn+8)%7||7;switch(t){case"c":return String(a);case"cc":return Zr(a,t.length);case"co":return r.ordinalNumber(a,{unit:"day"});case"ccc":return r.day(n,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(n,{width:"narrow",context:"standalone"});case"cccccc":return r.day(n,{width:"short",context:"standalone"});case"cccc":default:return r.day(n,{width:"wide",context:"standalone"})}},i:function(e,t,r){const i=e.getDay(),n=i===0?7:i;switch(t){case"i":return String(n);case"ii":return Zr(n,t.length);case"io":return r.ordinalNumber(n,{unit:"day"});case"iii":return r.day(i,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(i,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(i,{width:"short",context:"formatting"});case"iiii":default:return r.day(i,{width:"wide",context:"formatting"})}},a:function(e,t,r){const n=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})}},b:function(e,t,r){const i=e.getHours();let n;switch(i===12?n=Bh.noon:i===0?n=Bh.midnight:n=i/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})}},B:function(e,t,r){const i=e.getHours();let n;switch(i>=17?n=Bh.evening:i>=12?n=Bh.afternoon:i>=4?n=Bh.morning:n=Bh.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let i=e.getHours()%12;return i===0&&(i=12),r.ordinalNumber(i,{unit:"hour"})}return Cc.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):Cc.H(e,t)},K:function(e,t,r){const i=e.getHours()%12;return t==="Ko"?r.ordinalNumber(i,{unit:"hour"}):Zr(i,t.length)},k:function(e,t,r){let i=e.getHours();return i===0&&(i=24),t==="ko"?r.ordinalNumber(i,{unit:"hour"}):Zr(i,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):Cc.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):Cc.s(e,t)},S:function(e,t){return Cc.S(e,t)},X:function(e,t,r){const i=e.getTimezoneOffset();if(i===0)return"Z";switch(t){case"X":return WR(i);case"XXXX":case"XX":return nu(i);case"XXXXX":case"XXX":default:return nu(i,":")}},x:function(e,t,r){const i=e.getTimezoneOffset();switch(t){case"x":return WR(i);case"xxxx":case"xx":return nu(i);case"xxxxx":case"xxx":default:return nu(i,":")}},O:function(e,t,r){const i=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+HR(i,":");case"OOOO":default:return"GMT"+nu(i,":")}},z:function(e,t,r){const i=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+HR(i,":");case"zzzz":default:return"GMT"+nu(i,":")}},t:function(e,t,r){const i=Math.trunc(e.getTime()/1e3);return Zr(i,t.length)},T:function(e,t,r){const i=e.getTime();return Zr(i,t.length)}};function HR(e,t=""){const r=e>0?"-":"+",i=Math.abs(e),n=Math.trunc(i/60),a=i%60;return a===0?r+String(n):r+String(n)+t+Zr(a,2)}function WR(e,t){return e%60===0?(e>0?"-":"+")+Zr(Math.abs(e)/60,2):nu(e,t)}function nu(e,t=""){const r=e>0?"-":"+",i=Math.abs(e),n=Zr(Math.trunc(i/60),2),a=Zr(i%60,2);return r+n+t+a}const GR=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},K6=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},vpe=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],i=r[1],n=r[2];if(!n)return GR(e,t);let a;switch(i){case"P":a=t.dateTime({width:"short"});break;case"PP":a=t.dateTime({width:"medium"});break;case"PPP":a=t.dateTime({width:"long"});break;case"PPPP":default:a=t.dateTime({width:"full"});break}return a.replace("{{date}}",GR(i,t)).replace("{{time}}",K6(n,t))},gpe={p:K6,P:vpe},ype=/^D+$/,bpe=/^Y+$/,xpe=["D","DD","YY","YYYY"];function wpe(e){return ype.test(e)}function Spe(e){return bpe.test(e)}function Cpe(e,t,r){const i=_pe(e,t,r);if(console.warn(i),xpe.includes(e))throw new RangeError(i)}function _pe(e,t,r){const i=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${i} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const Ape=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Mpe=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Epe=/^'([^]*?)'?$/,Tpe=/''/g,Ppe=/[a-zA-Z]/;function Sv(e,t,r){var d,u,h,f;const i=Y1(),n=i.locale??upe,a=i.firstWeekContainsDate??((u=(d=i.locale)==null?void 0:d.options)==null?void 0:u.firstWeekContainsDate)??1,o=i.weekStartsOn??((f=(h=i.locale)==null?void 0:h.options)==null?void 0:f.weekStartsOn)??0,s=gs(e);if(!Ofe(s))throw new RangeError("Invalid time value");let l=t.match(Mpe).map(p=>{const v=p[0];if(v==="p"||v==="P"){const m=gpe[v];return m(p,n.formatLong)}return p}).join("").match(Ape).map(p=>{if(p==="''")return{isToken:!1,value:"'"};const v=p[0];if(v==="'")return{isToken:!1,value:Dpe(p)};if(VR[v])return{isToken:!0,value:p};if(v.match(Ppe))throw new RangeError("Format string contains an unescaped latin alphabet character `"+v+"`");return{isToken:!1,value:p}});n.localize.preprocessor&&(l=n.localize.preprocessor(s,l));const c={firstWeekContainsDate:a,weekStartsOn:o,locale:n};return l.map(p=>{if(!p.isToken)return p.value;const v=p.value;(Spe(v)||wpe(v))&&Cpe(v,t,String(e));const m=VR[v[0]];return m(s,v,n.localize,c)}).join("")}function Dpe(e){const t=e.match(Epe);return t?t[1].replace(Tpe,"'"):e}const $R=e=>new Promise(async(t,r)=>{try{const n=await(await e.getFile()).arrayBuffer(),a=new Uint8Array(n),o=Afe.parseDicom(a);t(o)}catch(i){throw r(`Error reading DICOM file: ${i}`),new Error(`Error reading DICOM file: ${i}`)}}),Ope={BREAST:{system:"http://snomed.info/sct",code:"76752008",display:"Breast"}},Rpe={"1.2.840.10008.5.1.4.1.1.1":"Computed Radiography Image Storage","1.2.840.10008.5.1.4.1.1.2":"CT Image Storage","1.2.840.10008.5.1.4.1.1.3.1":"Ultrasound Multi-frame Image Storage","1.2.840.10008.5.1.4.1.1.4":"MR Image Storage"},qR=e=>{const t=new Date,r=Sv(t,"yyyy-MM-dd HH:mm:ss");Sv(t,"HH:mm:ss");const i=Sv(t,"yyyy-MM-dd");let n={};switch(e){case"valueQuantity":n={valueQuantity:{value:"",comparator:"",unit:"",system:"http://unitsofmeasure.org",code:""}};break;case"valueCodeableConcept":n={valueCodeableConcept:{coding:[{system:"",code:"",display:""}],text:""}};break;case"valueString":n={valueString:""};break;case"valueBoolean":n={valueBoolean:""};break;case"valueInteger":n={valueInteger:""};break;case"valueRange":n={valueRange:{low:"",high:""}};break;case"valueRatio":n={valueRatio:{numerator:{value:"",comparator:"",unit:"",system:"http://unitsofmeasure.org",code:""},denominator:{value:"",comparator:"",unit:"",system:"http://unitsofmeasure.org",code:""}}};break;case"valueSampledData":n={valueSampledData:{origin:"",period:"",factor:"",lowerLimit:"",upperLimit:"",dimensions:"",data:""}};break;case"valueTime":n={valueTime:i};break;case"valueDateTime":n={valueDateTime:r};break;case"valuePeriod":n={valuePeriod:{start:"",end:""}};break;default:n={valueQuantity:{value:"",comparator:"",unit:"",system:"http://unitsofmeasure.org",code:""}};break}return n},Ipe=[{label:"valueQuantity",value:"valueQuantity"},{label:"valueCodeableConcept",value:"valueCodeableConcept"},{label:"valueString",value:"valueString"},{label:"valueBoolean",value:"valueBoolean"},{label:"valueInteger",value:"valueInteger"},{label:"valueRange",value:"valueRange"},{label:"valueRatio",value:"valueRatio"},{label:"valueSampledData",value:"valueSampledData"},{label:"valueTime",value:"valueTime"},{label:"valueDateTime",value:"valueDateTime"},{label:"valuePeriod",value:"valuePeriod"}],AS={value:{required:!0,validator(e,t){return Number.isNaN(Number(t))?new Error("Value is required Number"):!0},trigger:"blur"},unit:{required:!0,message:"Please input the unit for the value",trigger:["input","blur"]},system:{required:!0,validator(e,t){return t?!0:new Error("Unit system is required")},trigger:"blur"},code:{required:!0,validator(e,t){return t?!0:new Error("Unit code is required")},trigger:"blur"},comparator:{required:!1,validator(e,t){return t&&t!=="<"&&t!=="<="&&t!==">="&&t!==">"?new Error("Comparator must be <, <=, >=, or >"):!0},trigger:"blur"}},zpe={valueQuantity:AS,valueString:{required:!0,validator(e,t){return t?!0:new Error("Value is required String")},trigger:"blur"},valueBoolean:{required:!0,validator(e,t){return t!=="true"&&t!=="false"?new Error("Value is required Boolean"):!0},trigger:"blur"},valueRange:{low:{required:!1,validator(e,t){return Number.isNaN(Number(t))?new Error("Low is required Number"):!0},trigger:"blur"},high:{required:!1,validator(e,t){return Number.isNaN(Number(t))?new Error("High is required Number"):!0},trigger:"blur"}},valueRatio:{numerator:AS,denominator:AS},valueSampledData:{origin:{required:!0,validator(e,t){return t?!0:new Error("Origin is required")},trigger:"blur"},period:{required:!0,validator(e,t){return Number.isNaN(Number(t))?new Error("Period is required Number"):!0},trigger:"blur"},factor:{required:!1,validator(e,t){return Number.isNaN(Number(t))?new Error("Factor is required Number"):!0},trigger:"blur"},lowerLimit:{required:!1,validator(e,t){return Number.isNaN(Number(t))?new Error("Lower Limit is required Number"):!0},trigger:"blur"},upperLimit:{required:!1,validator(e,t){return Number.isNaN(Number(t))?new Error("Upper Limit is required Number"):!0},trigger:"blur"},dimensions:{required:!0,validator(e,t){return Number.isNaN(Number(t))?new Error("Dimensions is required Number"):!0},trigger:"blur"},data:{required:!1,validator(e,t){return typeof t!="string"?new Error("Data is required String"):!0},trigger:"blur"}}},kpe={observation:{value:zpe,code:{required:!0,validator(e,t){return t?!0:new Error("Observation Code is required")},trigger:"blur"},codeSystem:{required:!0,validator(e,t){return t?!0:new Error("Observation codeSystem is required")},trigger:"blur"}}};var Gn=[];for(var MS=0;MS<256;++MS)Gn.push((MS+256).toString(16).slice(1));function Lpe(e,t=0){return(Gn[e[t+0]]+Gn[e[t+1]]+Gn[e[t+2]]+Gn[e[t+3]]+"-"+Gn[e[t+4]]+Gn[e[t+5]]+"-"+Gn[e[t+6]]+Gn[e[t+7]]+"-"+Gn[e[t+8]]+Gn[e[t+9]]+"-"+Gn[e[t+10]]+Gn[e[t+11]]+Gn[e[t+12]]+Gn[e[t+13]]+Gn[e[t+14]]+Gn[e[t+15]]).toLowerCase()}var I0,Bpe=new Uint8Array(16);function Fpe(){if(!I0&&(I0=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!I0))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return I0(Bpe)}var Npe=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const YR={randomUUID:Npe};function Q6(e,t,r){if(YR.randomUUID&&!t&&!e)return YR.randomUUID();e=e||{};var i=e.random||(e.rng||Fpe)();if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,t){r=r||0;for(var n=0;n<16;++n)t[r+n]=i[n];return t}return Lpe(i)}const Upe={class:"flex flex-col md:flex-row px-11 pb-2 pt-1 shadow-md m-2 shadow-zinc-400 rounded-md bg-gradient-to-r from-zinc-300 via-gray-200 to-stone-400"},jpe={key:0,class:"observation-form-item"},Vpe={key:1,class:"observation-form-item"},Hpe={style:{display:"flex","align-items":"center",width:"100%"}},Wpe={key:2,class:"observation-form-item"},Gpe={key:3,class:"observation-form-item"},$pe={key:4,class:"observation-form-item"},qpe={key:5,class:"observation-form-item"},Ype={key:6,class:"observation-form-item w-full"},Xpe={key:7,class:"observation-form-item"},Kpe={key:8,class:"observation-form-item"},Qpe={key:9,class:"observation-form-item"},Zpe={key:10,class:"observation-form-item"},Jpe={class:"observation-form-item"},XR=Ve({__name:"FormObservation",props:{disabled:Boolean,selectedObservationValueType:String,filledData:Object,belongTo:{type:Array,default:()=>[]}},setup(e,{emit:t}){const r=e;tr(()=>r.belongTo,w=>{o.value||(u.value.belongTo=w)});const i=t,{AddIcon:n,CloseIcon:a}=Ug(),o=ge(!1),s=ge("#10b981"),l=ge(!1),c=ge(),d=UT(),u=ge({operation:"add",belongTo:r.belongTo,observationValueType:r.selectedObservationValueType?r.selectedObservationValueType:"valueQuantity",observation:{value:r.selectedObservationValueType?qR(r.selectedObservationValueType):{valueQuantity:{value:"",comparator:"",unit:"",system:"http://unitsofmeasure.org",code:""}},code:"",display:"",codeSystem:""}}),h=()=>{d.success("Successfully picked a period!")},f=w=>{u.value.observation.value.valuePeriod.start=Sv(w[0],"yyyy-MM-dd HH:mm:ss"),u.value.observation.value.valuePeriod.end=Sv(w[1],"yyyy-MM-dd HH:mm:ss")},p=()=>(u.value.observation.value.valueCodeableConcept.coding.push({code:"",system:"",display:""}),u.value.observation.value.valueCodeableConcept.coding[u.value.observation.value.valueCodeableConcept.coding.length-1]),v=w=>{u.value.observation.value=qR(w)};Or(()=>{r.filledData&&m()});const m=()=>{o.value=r.disabled,s.value="#f43f5e",u.value.observation=r.filledData,u.value.observationValueType==="valueCodeableConcept"?l.value=!0:l.value=!1,u.value.observationValueType==="valuePeriod"&&(c.value=[new Date(u.value.observation.value.valuePeriod.start),new Date(u.value.observation.value.valuePeriod.end)])},g=["http://loinc.org","http://snomed.info/sct","http://dicom.nema.org/resources/ontology/DCM"].map(w=>({label:w,value:w})),y=["http://unitsofmeasure.org"].map(w=>({label:w,value:w})),b=ge("large"),x=ge(null),S=w=>{var _;if(w.preventDefault(),o.value){u.value.operation="remove",i("updateObservation",u.value);return}(_=x.value)==null||_.validate(C=>{C?(console.log(C),d.error("Invalid")):(d.success("Valid"),u.value.operation="add",u.value.observationValueType==="valueCodeableConcept"&&(u.value.observation.value.valueCodeableConcept.coding=u.value.observation.value.valueCodeableConcept.coding.filter(A=>A.code!==""&&A.system!=="")),i("updateObservation",u.value),u.value={operation:"add",belongTo:r.belongTo,observationValueType:"valueQuantity",observation:{value:{valueQuantity:{value:"",comparator:"",unit:"",system:"http://unitsofmeasure.org",code:""}},code:"",display:"",codeSystem:""}})})};return(w,_)=>(ft(),Pt("div",Upe,[Be(ke(zae),{ref_key:"formRef",ref:x,inline:"","label-width":520,model:u.value,rules:ke(kpe),size:b.value,disabled:o.value,class:"flex flex-col flex-wrap mt-2 mr-auto ob-align-content-start"},{default:tt(()=>[Be(ke(vr),{label:"ValueType",class:"border shadow-fancy-2 border-zinc-300 rounded-lg px-3"},{default:tt(()=>[Be(ke(sie),{value:u.value.observationValueType,"onUpdate:value":[_[0]||(_[0]=C=>u.value.observationValueType=C),v],options:ke(Ipe),class:"w-full md:w-96"},null,8,["value","options"])]),_:1}),u.value.observationValueType==="valueQuantity"?(ft(),Pt("div",jpe,[Be(ke(vr),{label:"Value",path:"observation.value.valueQuantity.value"},{default:tt(()=>[Be(ke(cr),{value:u.value.observation.value.valueQuantity.value,"onUpdate:value":_[1]||(_[1]=C=>u.value.observation.value.valueQuantity.value=C),placeholder:"Numerical value (with implicit precision)"},null,8,["value"])]),_:1}),Be(ke(vr),{label:"Unit",path:"observation.value.valueQuantity.unit"},{default:tt(()=>[Be(ke(cr),{value:u.value.observation.value.valueQuantity.unit,"onUpdate:value":_[2]||(_[2]=C=>u.value.observation.value.valueQuantity.unit=C),placeholder:"Unit representation"},null,8,["value"])]),_:1}),Be(ke(vr),{label:"Unit Code",path:"observation.value.valueQuantity.code"},{default:tt(()=>[Be(ke(cr),{value:u.value.observation.value.valueQuantity.code,"onUpdate:value":_[3]||(_[3]=C=>u.value.observation.value.valueQuantity.code=C),placeholder:"Coded form of the unit"},null,8,["value"])]),_:1}),Be(ke(vr),{label:"Unit System",path:"observation.value.valueQuantity.system"},{default:tt(()=>[Be(ke(M0),{value:u.value.observation.value.valueQuantity.system,"onUpdate:value":_[4]||(_[4]=C=>u.value.observation.value.valueQuantity.system=C),placeholder:"System that defines coded unit form",options:ke(y),append:!1},null,8,["value","options"])]),_:1}),Be(ke(vr),{label:"Comparator (Optional)",path:"observation.value.valueQuantity.comparator"},{default:tt(()=>[Be(ke(cr),{value:u.value.observation.value.valueQuantity.comparator,"onUpdate:value":_[5]||(_[5]=C=>u.value.observation.value.valueQuantity.comparator=C),placeholder:"< | <= | >= | >"},null,8,["value"])]),_:1})])):Na("",!0),u.value.observationValueType==="valueCodeableConcept"&&!r.filledData?(ft(),Pt("div",Vpe,[Be(ke(yae),{value:u.value.observation.value.valueCodeableConcept.coding,"onUpdate:value":_[6]||(_[6]=C=>u.value.observation.value.valueCodeableConcept.coding=C),"on-create":p},{"create-button-default":tt(()=>[Pr(" Add whatever you want ")]),default:tt(({value:C})=>[st("div",Hpe,[Be(ke(vr),{label:"Code"},{default:tt(()=>[Be(ke(cr),{value:C.code,"onUpdate:value":A=>C.code=A,type:"text",placeholder:"code"},null,8,["value","onUpdate:value"])]),_:2},1024),Be(ke(vr),{label:"System",class:"ml-2"},{default:tt(()=>[Be(ke(cr),{value:C.system,"onUpdate:value":A=>C.system=A,type:"text",placeholder:"system for code"},null,8,["value","onUpdate:value"])]),_:2},1024),Be(ke(vr),{label:"Display (Optional)",class:"ml-2"},{default:tt(()=>[Be(ke(cr),{value:C.display,"onUpdate:value":A=>C.display=A,type:"text",placeholder:"discription"},null,8,["value","onUpdate:value"])]),_:2},1024)])]),_:1},8,["value"]),Be(ke(vr),{label:"Text"},{default:tt(()=>[Be(ke(cr),{value:u.value.observation.value.valueCodeableConcept.text,"onUpdate:value":_[7]||(_[7]=C=>u.value.observation.value.valueCodeableConcept.text=C),type:"text"},null,8,["value"])]),_:1})])):Na("",!0),u.value.observationValueType==="valueCodeableConcept"&&r.filledData&&l.value?(ft(),Pt("div",Wpe,[(ft(!0),Pt(pr,null,cs(u.value.observation.value.valueCodeableConcept.coding,C=>(ft(),Pt("div",{style:{display:"flex","align-items":"center",width:"100%"},key:ke(Q6)()},[Be(ke(vr),{label:"Code"},{default:tt(()=>[Be(ke(cr),{value:C.code,"onUpdate:value":A=>C.code=A,type:"text"},null,8,["value","onUpdate:value"])]),_:2},1024),Be(ke(vr),{label:"System",class:"ml-2"},{default:tt(()=>[Be(ke(cr),{value:C.system,"onUpdate:value":A=>C.system=A,type:"text"},null,8,["value","onUpdate:value"])]),_:2},1024),Be(ke(vr),{label:"Display (Optional)",class:"ml-2"},{default:tt(()=>[Be(ke(cr),{value:C.display,"onUpdate:value":A=>C.display=A,type:"text"},null,8,["value","onUpdate:value"])]),_:2},1024)]))),128)),Be(ke(vr),{label:"Text"},{default:tt(()=>[Be(ke(cr),{value:u.value.observation.value.valueCodeableConcept.text,"onUpdate:value":_[8]||(_[8]=C=>u.value.observation.value.valueCodeableConcept.text=C),type:"text"},null,8,["value"])]),_:1})])):Na("",!0),u.value.observationValueType==="valueString"?(ft(),Pt("div",Gpe,[Be(ke(vr),{label:"Value",path:"observation.value.valueString"},{default:tt(()=>[Be(ke(cr),{value:u.value.observation.value.valueString,"onUpdate:value":_[9]||(_[9]=C=>u.value.observation.value.valueString=C),placeholder:"String value",type:"text"},null,8,["value"])]),_:1})])):Na("",!0),u.value.observationValueType==="valueBoolean"?(ft(),Pt("div",$pe,[Be(ke(vr),{label:"Value",path:"observation.value.valueBoolean"},{default:tt(()=>[Be(ke(cr),{value:u.value.observation.value.valueBoolean,"onUpdate:value":_[10]||(_[10]=C=>u.value.observation.value.valueBoolean=C),placeholder:"Boolean value"},null,8,["value"])]),_:1})])):Na("",!0),u.value.observationValueType==="valueRange"?(ft(),Pt("div",qpe,[Be(ke(vr),{label:"Low Value",path:"observation.value.valueRange.low"},{default:tt(()=>[Be(ke(cr),{value:u.value.observation.value.valueRange.low,"onUpdate:value":_[11]||(_[11]=C=>u.value.observation.value.valueRange.low=C),placeholder:"Number value"},null,8,["value"])]),_:1}),Be(ke(vr),{label:"High Value",path:"observation.value.valueRange.high"},{default:tt(()=>[Be(ke(cr),{value:u.value.observation.value.valueRange.high,"onUpdate:value":_[12]||(_[12]=C=>u.value.observation.value.valueRange.high=C),placeholder:"Number value"},null,8,["value"])]),_:1})])):Na("",!0),u.value.observationValueType==="valueRatio"?(ft(),Pt("div",Ype,[Be(ke(e6),{"default-value":"numerator",size:"large","justify-content":"space-evenly"},{default:tt(()=>[Be(ke(ix),{name:"numerator",tab:"Ratio numerator"},{default:tt(()=>[Be(ke(vr),{label:"Value",path:"observation.value.valueRatio.numerator.value"},{default:tt(()=>[Be(ke(cr),{value:u.value.observation.value.valueRatio.numerator.value,"onUpdate:value":_[13]||(_[13]=C=>u.value.observation.value.valueRatio.numerator.value=C),placeholder:"Numerical value (with implicit precision)"},null,8,["value"])]),_:1}),Be(ke(vr),{label:"Unit",path:"observation.value.valueRatio.numerator.unit"},{default:tt(()=>[Be(ke(cr),{value:u.value.observation.value.valueRatio.numerator.unit,"onUpdate:value":_[14]||(_[14]=C=>u.value.observation.value.valueRatio.numerator.unit=C),placeholder:"Unit representation"},null,8,["value"])]),_:1}),Be(ke(vr),{label:"Unit Code",path:"observation.value.valueRatio.numerator.code"},{default:tt(()=>[Be(ke(cr),{value:u.value.observation.value.valueRatio.numerator.code,"onUpdate:value":_[15]||(_[15]=C=>u.value.observation.value.valueRatio.numerator.code=C),placeholder:"Coded form of the unit"},null,8,["value"])]),_:1}),Be(ke(vr),{label:"Unit System",path:"observation.value.valueRatio.numerator.system"},{default:tt(()=>[Be(ke(M0),{value:u.value.observation.value.valueRatio.numerator.system,"onUpdate:value":_[16]||(_[16]=C=>u.value.observation.value.valueRatio.numerator.system=C),placeholder:"System that defines coded unit form",options:ke(y),append:!1},null,8,["value","options"])]),_:1}),Be(ke(vr),{label:"Comparator (Optional)",path:"observation.value.valueRatio.numerator.comparator"},{default:tt(()=>[Be(ke(cr),{value:u.value.observation.value.valueRatio.numerator.comparator,"onUpdate:value":_[17]||(_[17]=C=>u.value.observation.value.valueRatio.numerator.comparator=C),placeholder:"< | <= | >= | >"},null,8,["value"])]),_:1})]),_:1}),Be(ke(ix),{name:"denominator",tab:"Ratio denominator"},{default:tt(()=>[Be(ke(vr),{label:"Value",path:"observation.value.valueRatio.denominator.value"},{default:tt(()=>[Be(ke(cr),{value:u.value.observation.value.valueRatio.denominator.value,"onUpdate:value":_[18]||(_[18]=C=>u.value.observation.value.valueRatio.denominator.value=C),placeholder:"Numerical value (with implicit precision)"},null,8,["value"])]),_:1}),Be(ke(vr),{label:"Unit",path:"observation.value.valueRatio.denominator.unit"},{default:tt(()=>[Be(ke(cr),{value:u.value.observation.value.valueRatio.denominator.unit,"onUpdate:value":_[19]||(_[19]=C=>u.value.observation.value.valueRatio.denominator.unit=C),placeholder:"Unit representation"},null,8,["value"])]),_:1}),Be(ke(vr),{label:"Unit Code",path:"observation.value.valueRatio.denominator.code"},{default:tt(()=>[Be(ke(cr),{value:u.value.observation.value.valueRatio.denominator.code,"onUpdate:value":_[20]||(_[20]=C=>u.value.observation.value.valueRatio.denominator.code=C),placeholder:"Coded form of the unit"},null,8,["value"])]),_:1}),Be(ke(vr),{label:"Unit System",path:"observation.value.valueRatio.denominator.system"},{default:tt(()=>[Be(ke(M0),{value:u.value.observation.value.valueRatio.denominator.system,"onUpdate:value":_[21]||(_[21]=C=>u.value.observation.value.valueRatio.denominator.system=C),placeholder:"System that defines coded unit form",options:ke(y),append:!1},null,8,["value","options"])]),_:1}),Be(ke(vr),{label:"Comparator (Optional)",path:"observation.value.valueQuantity.comparator"},{default:tt(()=>[Be(ke(cr),{value:u.value.observation.value.valueRatio.denominator.comparator,"onUpdate:value":_[22]||(_[22]=C=>u.value.observation.value.valueRatio.denominator.comparator=C),placeholder:"< | <= | >= | >"},null,8,["value"])]),_:1})]),_:1})]),_:1})])):Na("",!0),u.value.observationValueType==="valueSampledData"?(ft(),Pt("div",Xpe,[Be(ke(vr),{label:"Origin",path:"observation.value.valueSampledData.origin"},{default:tt(()=>[Be(ke(cr),{value:u.value.observation.value.valueSampledData.origin,"onUpdate:value":_[23]||(_[23]=C=>u.value.observation.value.valueSampledData.origin=C),placeholder:"Zero value and units"},null,8,["value"])]),_:1}),Be(ke(vr),{label:"Period",path:"observation.value.valueSampledData.period"},{default:tt(()=>[Be(ke(cr),{value:u.value.observation.value.valueSampledData.period,"onUpdate:value":_[24]||(_[24]=C=>u.value.observation.value.valueSampledData.period=C),placeholder:"Number of milliseconds between samples"},null,8,["value"])]),_:1}),Be(ke(vr),{label:"Factor (Optional)",path:"observation.value.valueSampledData.factor"},{default:tt(()=>[Be(ke(cr),{value:u.value.observation.value.valueSampledData.factor,"onUpdate:value":_[25]||(_[25]=C=>u.value.observation.value.valueSampledData.factor=C),placeholder:"Multiply data by this before adding to origin"},null,8,["value"])]),_:1}),Be(ke(vr),{label:"Lower Limit (Optional)",path:"observation.value.valueSampledData.lowerLimit"},{default:tt(()=>[Be(ke(cr),{value:u.value.observation.value.valueSampledData.lowerLimit,"onUpdate:value":_[26]||(_[26]=C=>u.value.observation.value.valueSampledData.lowerLimit=C),placeholder:"Lower limit of detection"},null,8,["value"])]),_:1}),Be(ke(vr),{label:"Upper Limit (Optional)",path:"observation.value.valueSampledData.upperLimit"},{default:tt(()=>[Be(ke(cr),{value:u.value.observation.value.valueSampledData.upperLimit,"onUpdate:value":_[27]||(_[27]=C=>u.value.observation.value.valueSampledData.upperLimit=C),placeholder:"Upper limit of detection"},null,8,["value"])]),_:1}),Be(ke(vr),{label:"Dimensions",path:"observation.value.valueSampledData.dimensions"},{default:tt(()=>[Be(ke(cr),{value:u.value.observation.value.valueSampledData.dimensions,"onUpdate:value":_[28]||(_[28]=C=>u.value.observation.value.valueSampledData.dimensions=C),placeholder:"Number of sample points at each time point"},null,8,["value"])]),_:1}),Be(ke(vr),{label:"Data (Optional)",path:"observation.value.valueSampledData.data"},{default:tt(()=>[Be(ke(cr),{value:u.value.observation.value.valueSampledData.data,"onUpdate:value":_[29]||(_[29]=C=>u.value.observation.value.valueSampledData.data=C),placeholder:"Decimal values with spaces, or `E` | `U` | `L`"},null,8,["value"])]),_:1})])):Na("",!0),u.value.observationValueType==="valueTime"?(ft(),Pt("div",Kpe,[Be(ke(vr),{label:"Date",path:"observation.value.valueTime"},{default:tt(()=>[Be(ke(hS),{"formatted-value":u.value.observation.value.valueTime,"onUpdate:formattedValue":_[30]||(_[30]=C=>u.value.observation.value.valueTime=C),"value-format":"yyyy-MM-dd",type:"date",clearable:""},null,8,["formatted-value"])]),_:1})])):Na("",!0),u.value.observationValueType==="valueDateTime"?(ft(),Pt("div",Qpe,[Be(ke(vr),{label:"DateTime",path:"observation.value.valueDateTime"},{default:tt(()=>[Be(ke(hS),{"formatted-value":u.value.observation.value.valueDateTime,"onUpdate:formattedValue":_[31]||(_[31]=C=>u.value.observation.value.valueDateTime=C),"value-format":"yyyy-MM-dd HH:mm:ss",type:"datetime",clearable:""},null,8,["formatted-value"])]),_:1})])):Na("",!0),u.value.observationValueType==="valuePeriod"?(ft(),Pt("div",Zpe,[Be(ke(hS),{value:c.value,"onUpdate:value":_[32]||(_[32]=C=>c.value=C),disabled:e.disabled,type:"datetimerange",onBlur:h,onConfirm:f},null,8,["value","disabled"])])):Na("",!0),st("div",Jpe,[Be(ke(vr),{label:"Observation Code",path:"observation.code"},{default:tt(()=>[Be(ke(cr),{value:u.value.observation.code,"onUpdate:value":_[33]||(_[33]=C=>u.value.observation.code=C),placeholder:"code for observation"},null,8,["value"])]),_:1}),Be(ke(vr),{label:"Display",path:"observation.display"},{default:tt(()=>[Be(ke(cr),{value:u.value.observation.display,"onUpdate:value":_[34]||(_[34]=C=>u.value.observation.display=C),placeholder:"display for observation code"},null,8,["value"])]),_:1}),Be(ke(vr),{label:"Observation Code System",path:"observation.codeSystem"},{default:tt(()=>[Be(ke(M0),{value:u.value.observation.codeSystem,"onUpdate:value":_[35]||(_[35]=C=>u.value.observation.codeSystem=C),placeholder:"Input code system",options:ke(g),append:!1},null,8,["value","options"])]),_:1})])]),_:1},8,["model","rules","size","disabled"]),Be(ke(li),{onClick:S,class:Do(["md:my-auto md:ml-10 my-3 rounded-md",o.value?"shadow-fancy-3":"shadow-fancy-4"]),strong:"",color:s.value},{icon:tt(()=>[Be(ke(z1),null,{default:tt(()=>[o.value?(ft(),Ei(ke(a),{key:1})):(ft(),Ei(ke(n),{key:0}))]),_:1})]),_:1},8,["class","color"])]))}}),eme=Ve({__name:"Observation",props:{formDescription:Object,patients:{type:Array,default:()=>[]}},setup(e,{emit:t}){const r=e,i=t,n=ge(!0),a=ge([]),o=re(()=>[...new Set(a.value)]);tr(()=>r.patients,c=>{c.length>0&&l()}),Or(()=>{r.formDescription&&l()});const s=c=>{c.operation==="add"?c.belongTo.forEach(d=>{const u=r.formDescription.patients.findIndex(h=>h.name===d);r.formDescription.patients[u].observations.push(c)}):c.operation==="remove"&&c.belongTo.forEach(d=>{const u=r.formDescription.patients.findIndex(h=>h.name===d);r.formDescription.patients[u].observations=r.formDescription.patients[u].observations.filter(h=>JSON.stringify(h.observation)!==JSON.stringify(c.observation))}),l(),i("updateObservation",r.formDescription)},l=()=>{if(n.value=!1,a.value=[],r.patients.length===1)r.formDescription.patients.forEach(c=>{r.patients.includes(c.name)&&c.observations.forEach(d=>{a.value.push(JSON.stringify(Object.assign(d.observation,{observationValueType:d.observationValueType})))})});else if(r.patients.length>1){let c=[];r.formDescription.patients.forEach(d=>{r.patients.includes(d.name)&&c.push(d.observations)}),a.value=c.reduce((d,u)=>d.filter(h=>u.map(f=>JSON.stringify(f.observation)).includes(JSON.stringify(h.observation)))).map(d=>JSON.stringify(Object.assign(d.observation,{observationValueType:d.observationValueType})))}else a.value=[];n.value=!0};return(c,d)=>(ft(),Pt("div",null,[Be(XR,{belongTo:e.patients,onUpdateObservation:s},null,8,["belongTo"]),n.value?(ft(!0),Pt(pr,{key:0},cs(o.value,u=>(ft(),Ei(XR,{key:ke(Q6)(),belongTo:e.patients,selectedObservationValueType:JSON.parse(u).observationValueType,filledData:JSON.parse(u),disabled:"",onUpdateObservation:s},null,8,["belongTo","selectedObservationValueType","filledData"]))),128)):Na("",!0)]))}}),tme={class:"my-2 py-1 bg-stone-50 rounded-md border-solid border-2 border-zinc-300 shadow-md"},rme={class:"flex flex-row justify-start px-2 pb-2"},ime=Ve({__name:"ImagingStudySeries",props:{patient:String,patientDirectoryHandle:Object,selectedSamples:{type:Array,default:()=>[]},selectedPatientsSamples:{type:Object,required:!0}},emits:["update:selectedPatientsSamples"],setup(e,{emit:t}){const r=e,i=ge([]),n=ge([]),a=t;Or(()=>{n.value=r.patientDirectoryHandle?r.patientDirectoryHandle.children.map(c=>({label:c.name,value:c.name})):[],i.value=[...r.selectedSamples],i.value.length===0&&s()});const o=c=>{r.selectedPatientsSamples[r.patient]=c.map(d=>d.toString()),a("update:selectedPatientsSamples",r.selectedPatientsSamples)},s=()=>{var c;(c=r.patientDirectoryHandle)==null||c.children.forEach(async d=>{if(d.kind==="directory"){for(const u of d.children)if(u.kind==="file"){l(u).then(h=>{h&&(i.value.push(d.name),o(i.value))});return}}})};async function l(c){const d=await c.getFile(),u=new FileReader;return new Promise((h,f)=>{u.onloadend=()=>{const p=new DataView(u.result),v=p.getUint8(128)===68&&p.getUint8(129)===73&&p.getUint8(130)===67&&p.getUint8(131)===77;h(v)},u.onerror=f,u.readAsArrayBuffer(d.slice(0,132))})}return(c,d)=>(ft(),Pt("div",tme,[Be(ke(uA),{prefix:"bar","align-text":"",type:"success"},{default:tt(()=>[Be(ke(uu),{type:"info",class:"pl-3"},{default:tt(()=>[Pr(" Please select MRI samples for the patient: "),Be(ke(uu),{class:"pl-3",type:"error"},{default:tt(()=>[Pr(mi(r.patient),1)]),_:1})]),_:1})]),_:1}),st("div",rme,[Be(ke(Lse),{value:i.value,"onUpdate:value":[d[0]||(d[0]=u=>i.value=u),o],"virtual-scroll":"",options:n.value,"source-filterable":"","target-filterable":""},null,8,["value","options"])])]))}}),nme={},ame={class:"generate my-5"};function ome(e,t){return ft(),Pt("button",ame,[il(e.$slots,"default",{},void 0,!0)])}const sme=ul(nme,[["render",ome],["__scopeId","data-v-89ca8621"]]),lme={class:"flex flex-col pb-5"},cme=Ve({__name:"ImagingStudy",props:{formDescription:Object,patientsDirectoryHandle:Object,patients:{type:Array,default:()=>[]}},setup(e,{emit:t}){const r=e,i=t,n=UT(),a=ge({});Or(()=>{r.patients.forEach(f=>{d(f)})}),tr(()=>r.patients,f=>{f.forEach(p=>{d(p)})});const o=re(()=>r.patients.length<=3?r.patients:r.patients.slice(0,3)),s=()=>{var f;for(let p in a.value){const v=(f=r.formDescription)==null?void 0:f.patients.findIndex(m=>m.name===p);if(v!==void 0){r.formDescription.patients[v].imagingStudy.series=[];for(let m of a.value[p])l(p,m).then(g=>{r.formDescription.patients[v].imagingStudy.series.push(g),i("updateImagingStudy",r.formDescription)}).catch(g=>{n.error(`The folder ${m} includes non-dcm files. Errors: `+g)})}}i("updateImagingStudy",r.formDescription)},l=(f,p)=>new Promise((v,m)=>{var b,x,S,w,_;const g=(w=(S=(x=(b=r.patientsDirectoryHandle)==null?void 0:b.children)==null?void 0:x.find(C=>C.name===f))==null?void 0:S.children)==null?void 0:w.find(C=>C.name===p),y=(_=g==null?void 0:g.children)==null?void 0:_.find(C=>C.name.endsWith(".dcm"));$R(y).then(C=>{var T;const A=C.string("x0020000e"),M=C.string("x00180015"),P={uid:A,name:p,endpointUrl:"",numberOfInstances:(T=g==null?void 0:g.children)==null?void 0:T.length,instances:[]};if(M){const R=Ope[M];R&&(P.bodySite=R)}c(g).then(R=>{P.instances=R,v(P)}).catch(R=>{m(R)})}).catch(C=>{m(C)})}),c=f=>new Promise((p,v)=>{const g=f.children.map(y=>$R(y));Promise.all(g).then(y=>{const b=y.map(x=>({uid:x.string("x00080018"),sopClassUid:x.string("x00080016"),sopClassName:Rpe[x.string("x00080016")],number:x.string("x00200013")}));p(b)}).catch(y=>{v(y)})}),d=f=>{var v,m,g;const p=(v=r.formDescription)==null?void 0:v.patients.findIndex(y=>y.name===f);p!==void 0&&!((m=r.formDescription)!=null&&m.patients[p].imagingStudy)&&(r.formDescription.patients[p].imagingStudy={endpointUrl:"",path:(g=r.formDescription)==null?void 0:g.patients[p].path,series:[]}),a.value[f]||(a.value[f]=u(f))},u=f=>{if(r.formDescription){const p=r.formDescription.patients.findIndex(v=>v.name===f);if(r.formDescription.patients[p].imagingStudy.series.length>=1)return r.formDescription.patients[p].imagingStudy.series.map(v=>v.name)}return[]},h=f=>{var p;return(p=r.patientsDirectoryHandle)!=null&&p.children?Array.from(r.patientsDirectoryHandle.children).find(v=>v.name===f):void 0};return(f,p)=>(ft(),Pt("div",lme,[(ft(!0),Pt(pr,null,cs(e.patients,v=>(ft(),Ei(ime,{key:v,patient:v,"patient-directory-handle":h(v),"selected-samples":a.value[v],"selected-patients-samples":a.value,"onUpdate:selectedPatientsSamples":p[0]||(p[0]=m=>a.value=m)},null,8,["patient","patient-directory-handle","selected-samples","selected-patients-samples"]))),128)),Be(sme,{onClick:s},{default:tt(()=>[Be(ke(uu),{class:"p-1 text-lg subpixel-antialiased font-semibold text-zinc-900"},{default:tt(()=>[Pr(" Generate "),e.patients.length>1?(ft(),Ei(ke(uu),{key:0,class:"text-zinc-900"},{default:tt(()=>[Pr("ImagingStudies")]),_:1})):(ft(),Ei(ke(uu),{key:1,class:"text-zinc-900"},{default:tt(()=>[Pr("ImagingStudy")]),_:1})),Pr(" for selecting patients: "),(ft(!0),Pt(pr,null,cs(o.value,(v,m)=>(ft(),Ei(ke(uu),{key:m,class:"mx-1 text-gray-500"},{default:tt(()=>[Pr(mi(v),1)]),_:2},1024))),128)),e.patients.length>3?(ft(),Ei(ke(uu),{key:2,class:"mx-1 text-gray-500"},{default:tt(()=>[Pr("...")]),_:1})):Na("",!0)]),_:1})]),_:1})]))}}),dme={class:"p-3 m-3"},ume={class:"p-3 m-3"},hme={class:"p-3 m-3"},fme={class:"my-1 p-2 rounded-md shadow-fancy-inner"},pme=Ve({__name:"PrimaryView",setup(e){var _,C,A;const{root:t}=Fd(Zu()),r=WT(),i=Jle(),n=ge(r.query.name),a=[(_=t.value)==null?void 0:_.name,n.value],o=ge(),s=ge(0),l=ge(0),c=ge("Annotate"),d=ge([]),u=ge(!1),h=ge(!1),f=ge({dataset:{id:"",uuid:"",name:(C=t.value)==null?void 0:C.name,path:"/"},patients:[]}),p=ge({dataset:{id:"",uuid:"",name:(A=t.value)==null?void 0:A.name,path:"/"},patients:[]}),v=ge(!1),m=({focused:M,checked:P})=>{const T={};return P?(T.background="#a1a1aa",M&&(T.boxShadow="0 0 0 2px #a1a1aa40")):(T.background="#38bdf8",M&&(T.boxShadow="0 0 0 2px #38bdf840")),T},g=()=>{c.value==="Annotate"?c.value="Submit":c.value="Annotate"},y=M=>{h.value=!0,setTimeout(()=>{u.value=M,h.value=!1},1e3)};tr(u,M=>{S("imagingstudy")}),Or(()=>{var M;o.value=(M=t.value)==null?void 0:M.children.filter(P=>P.name===n.value)[0],!o.value||!o.value.children?i.push("/"):o.value.children.forEach(P=>{var T,R;P.kind==="directory"&&(s.value+=P.children.length,p.value.patients.push({id:"",uuid:"",name:P.name,path:((T=t.value)==null?void 0:T.name)+"/"+P.name,observations:[],imagingStudy:null}),f.value.patients.push({id:"",uuid:"",name:P.name,path:((R=t.value)==null?void 0:R.name)+"/"+P.name,observations:[],imagingStudy:null}),P.children.forEach(z=>{z.kind==="directory"&&z.children.forEach(F=>{F.kind==="file"&&F.name.endsWith(".dcm")&&(l.value+=1)})}))})}),tr(d,M=>{M.length>0?M.length===f.value.patients.length&&(v.value=!0):v.value=!1});const b=M=>{S("observation")},x=M=>{S("imagingstudy")},S=M=>{p.value.patients.forEach(P=>{var R;const T=f.value.patients.findIndex(z=>z.name===P.name);M==="observation"&&(P.observations=[],f.value.patients[T].observations.forEach(z=>{P.observations.push(z.observation)})),M==="imagingstudy"&&(u.value?P.imagingStudy=f.value.patients[T].imagingStudy:P.imagingStudy={...f.value.patients[T].imagingStudy,series:(R=f.value.patients[T].imagingStudy)==null?void 0:R.series.map(z=>({...z,instances:[]}))})})},w=M=>{M?d.value=f.value.patients.map(P=>P.name):d.value=[]};return(M,P)=>(ft(),Pt(pr,null,[Be(bfe,{breadcrumbs:a,avatar:ke(G6),title:"Annotator",subtitle:"Add clinic descriptions for patients",footer:"© 2024 Clinic Description Annotator"},{extra:tt(()=>[Be(ke(_ae),null,{default:tt(()=>[Be(ke(li),{strong:"",ghost:"",class:"w-[100px]",color:c.value==="Annotate"?"#ff69b4":"#22c55e",onClick:g},{default:tt(()=>[Pr(mi(c.value),1)]),_:1},8,["color"])]),_:1})]),default:tt(()=>{var T;return[Be(ke(mS),{label:"Number of patients",value:(T=o.value)==null?void 0:T.children.length},null,8,["value"]),Be(ke(mS),{label:"Number of samples",value:s.value},null,8,["value"]),Be(ke(mS),{label:"Number of dicoms",value:l.value},null,8,["value"])]}),_:1},8,["avatar"]),Ka(st("div",null,[st("div",dme,[Be(ke(cR),null,{default:tt(()=>[Pr("Select Patients:")]),_:1}),Be(ke(tR),{value:v.value,"onUpdate:value":[P[0]||(P[0]=T=>v.value=T),w]},{checked:tt(()=>[Pr(" Selected All Patients ")]),unchecked:tt(()=>[Pr(" Deselected All Patients ")]),_:1},8,["value"]),Be(ke(eie),{value:d.value,"onUpdate:value":P[1]||(P[1]=T=>d.value=T),class:"flex flex-row flex-wrap justify-start w-full"},{default:tt(()=>{var T;return[(ft(!0),Pt(pr,null,cs((T=o.value)==null?void 0:T.children,(R,z)=>(ft(),Ei(ke(pU),{key:z,value:R.name,label:R.name,size:"large",class:"checkbox-item"},null,8,["value","label"]))),128))]}),_:1},8,["value"]),Be(ke(WO))])],512),[[Gu,c.value!=="Annotate"]]),Ka(st("div",null,[st("div",ume,[Be(xfe,null,{observation:tt(()=>[Be(ke(uA),null,{default:tt(()=>[Pr("Add Observations for selected patients:")]),_:1}),Be(eme,{patients:d.value,formDescription:f.value,onUpdateObservation:b},null,8,["patients","formDescription"])]),imagingstudy:tt(()=>[Be(ke(uA),null,{default:tt(()=>[Pr("Generating ImagingStudy for selected patients:")]),_:1}),Be(cme,{patients:d.value,formDescription:f.value,patientsDirectoryHandle:o.value,onUpdateImagingStudy:x},null,8,["patients","formDescription","patientsDirectoryHandle"])]),_:1}),Be(ke(WO))])],512),[[Gu,d.value.length>0&&c.value!=="Annotate"]]),st("div",null,[st("div",hme,[Be(ke(cR),null,{default:tt(()=>[Pr("Measurements:")]),_:1}),Be(ke(tR),{"rubber-band":!1,"rail-style":m,value:u.value,loading:h.value,"onUpdate:value":y},{checked:tt(()=>[Pr(" Back to normal Measurements ")]),unchecked:tt(()=>[Pr(" Show Measurements Details ")]),_:1},8,["value","loading"]),st("pre",fme,mi(JSON.stringify(p.value,null,2)),1)])])],64))}}),mme=ul(pme,[["__scopeId","data-v-3f054a17"]]),vme=Ve({__name:"testaaa",setup(e){const{root:t}=Fd(Zu());return console.log("test",t),(r,i)=>(ft(),Pt("div",null," test "+mi(ke(t)),1))}}),gme="modulepreload",yme=function(e){return"/DigitalTWINonFHIRFrontend/"+e},KR={},Nd=function(t,r,i){let n=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));n=Promise.all(r.map(s=>{if(s=yme(s),s in KR)return;KR[s]=!0;const l=s.endsWith(".css"),c=l?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${s}"]${c}`))return;const d=document.createElement("link");if(d.rel=l?"stylesheet":gme,l||(d.as="script",d.crossOrigin=""),d.href=s,o&&d.setAttribute("nonce",o),document.head.appendChild(d),l)return new Promise((u,h)=>{d.addEventListener("load",u),d.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${s}`)))})}))}return n.then(()=>t()).catch(a=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a})};var bme=Object.create,X1=Object.defineProperty,xme=Object.getOwnPropertyDescriptor,wme=Object.getOwnPropertyNames,Sme=Object.getPrototypeOf,Cme=Object.prototype.hasOwnProperty,_me=(e,t,r)=>t in e?X1(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,hc=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Ame=(e,t)=>{for(var r in t)X1(e,r,{get:t[r],enumerable:!0})},Mme=(e,t,r,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of wme(t))!Cme.call(e,n)&&n!==r&&X1(e,n,{get:()=>t[n],enumerable:!(i=xme(t,n))||i.enumerable});return e},fc=(e,t,r)=>(r=e!=null?bme(Sme(e)):{},Mme(t||!e||!e.__esModule?X1(r,"default",{value:e,enumerable:!0}):r,e)),Qm=(e,t,r)=>(_me(e,typeof t!="symbol"?t+"":t,r),r),Eme=hc((e,t)=>{(function(r,i){typeof e=="object"?t.exports=i():typeof define=="function"&&define.amd?define(i):r.Alea=i()})(e,function(){return r.importState=function(n){var a=new r;return a.importState(n),a},r;function r(){return function(n){var a=0,o=0,s=0,l=1;n.length==0&&(n=[+new Date]);var c=i();a=c(" "),o=c(" "),s=c(" ");for(var d=0;d<n.length;d++)a-=c(n[d]),a<0&&(a+=1),o-=c(n[d]),o<0&&(o+=1),s-=c(n[d]),s<0&&(s+=1);c=null;var u=function(){var h=2091639*a+l*23283064365386963e-26;return a=o,o=s,s=h-(l=h|0)};return u.next=u,u.uint32=function(){return u()*4294967296},u.fract53=function(){return u()+(u()*2097152|0)*11102230246251565e-32},u.version="Alea 0.9",u.args=n,u.exportState=function(){return[a,o,s,l]},u.importState=function(h){a=+h[0]||0,o=+h[1]||0,s=+h[2]||0,l=+h[3]||0},u}(Array.prototype.slice.call(arguments))}function i(){var n=4022871197,a=function(o){o=o.toString();for(var s=0;s<o.length;s++){n+=o.charCodeAt(s);var l=.02519603282416938*n;n=l>>>0,l-=n,l*=n,n=l>>>0,l-=n,n+=l*4294967296}return(n>>>0)*23283064365386963e-26};return a.version="Mash 0.9",a}})}),Z6=hc((e,t)=>{(function(r,i){typeof e=="object"&&typeof t<"u"?i(e):typeof define=="function"&&define.amd?define(["exports"],i):i((r=typeof globalThis<"u"?globalThis:r||self).SVDJS={})})(e,function(r){r.SVD=function(i,n,a,o,s){if(n=n===void 0||n,a=a===void 0||a,s=1e-64/(o=o||Math.pow(2,-52)),!i)throw new TypeError("Matrix a is not defined");var l,c,d,u,h,f,p,v,m,g,y,b,x=i[0].length,S=i.length;if(S<x)throw new TypeError("Invalid matrix: m < n");for(var w=[],_=[],C=[],A=n==="f"?S:x,M=g=p=0;M<S;M++)_[M]=new Array(A).fill(0);for(M=0;M<x;M++)C[M]=new Array(x).fill(0);var P,T=new Array(x).fill(0);for(M=0;M<S;M++)for(l=0;l<x;l++)_[M][l]=i[M][l];for(M=0;M<x;M++){for(w[M]=p,m=0,d=M+1,l=M;l<S;l++)m+=Math.pow(_[l][M],2);if(m<s)p=0;else for(v=(f=_[M][M])*(p=f<0?Math.sqrt(m):-Math.sqrt(m))-m,_[M][M]=f-p,l=d;l<x;l++){for(m=0,c=M;c<S;c++)m+=_[c][M]*_[c][l];for(f=m/v,c=M;c<S;c++)_[c][l]=_[c][l]+f*_[c][M]}for(T[M]=p,m=0,l=d;l<x;l++)m+=Math.pow(_[M][l],2);if(m<s)p=0;else{for(v=(f=_[M][M+1])*(p=f<0?Math.sqrt(m):-Math.sqrt(m))-m,_[M][M+1]=f-p,l=d;l<x;l++)w[l]=_[M][l]/v;for(l=d;l<S;l++){for(m=0,c=d;c<x;c++)m+=_[l][c]*_[M][c];for(c=d;c<x;c++)_[l][c]=_[l][c]+m*w[c]}}g<(y=Math.abs(T[M])+Math.abs(w[M]))&&(g=y)}if(a)for(M=x-1;0<=M;M--){if(p!==0){for(v=_[M][M+1]*p,l=d;l<x;l++)C[l][M]=_[M][l]/v;for(l=d;l<x;l++){for(m=0,c=d;c<x;c++)m+=_[M][c]*C[c][l];for(c=d;c<x;c++)C[c][l]=C[c][l]+m*C[c][M]}}for(l=d;l<x;l++)C[M][l]=0,C[l][M]=0;C[M][M]=1,p=w[M],d=M}if(n){if(n==="f")for(M=x;M<S;M++){for(l=x;l<S;l++)_[M][l]=0;_[M][M]=1}for(M=x-1;0<=M;M--){for(d=M+1,p=T[M],l=d;l<A;l++)_[M][l]=0;if(p!==0){for(v=_[M][M]*p,l=d;l<A;l++){for(m=0,c=d;c<S;c++)m+=_[c][M]*_[c][l];for(f=m/v,c=M;c<S;c++)_[c][l]=_[c][l]+f*_[c][M]}for(l=M;l<S;l++)_[l][M]=_[l][M]/p}else for(l=M;l<S;l++)_[l][M]=0;_[M][M]=_[M][M]+1}}for(o*=g,c=x-1;0<=c;c--)for(var R=0;R<50;R++){for(P=!1,d=c;0<=d;d--){if(Math.abs(w[d])<=o){P=!0;break}if(Math.abs(T[d-1])<=o)break}if(!P){for(h=0,u=d-(m=1),M=d;M<c+1&&(f=m*w[M],w[M]=h*w[M],!(Math.abs(f)<=o));M++)if(p=T[M],T[M]=Math.sqrt(f*f+p*p),h=p/(v=T[M]),m=-f/v,n)for(l=0;l<S;l++)y=_[l][u],b=_[l][M],_[l][u]=y*h+b*m,_[l][M]=-y*m+b*h}if(b=T[c],d===c){if(b<0&&(T[c]=-b,a))for(l=0;l<x;l++)C[l][c]=-C[l][c];break}for(g=T[d],f=(((y=T[c-1])-b)*(y+b)+((p=w[c-1])-(v=w[c]))*(p+v))/(2*v*y),p=Math.sqrt(f*f+1),f=((g-b)*(g+b)+v*(y/(f<0?f-p:f+p)-v))/g,M=d+(m=h=1);M<c+1;M++){if(p=w[M],y=T[M],v=m*p,p*=h,b=Math.sqrt(f*f+v*v),f=g*(h=f/(w[M-1]=b))+p*(m=v/b),p=-g*m+p*h,v=y*m,y*=h,a)for(l=0;l<x;l++)g=C[l][M-1],b=C[l][M],C[l][M-1]=g*h+b*m,C[l][M]=-g*m+b*h;if(b=Math.sqrt(f*f+v*v),f=(h=f/(T[M-1]=b))*p+(m=v/b)*y,g=-m*p+h*y,n)for(l=0;l<S;l++)y=_[l][M-1],b=_[l][M],_[l][M-1]=y*h+b*m,_[l][M]=-y*m+b*h}w[d]=0,w[c]=f,T[c]=g}for(M=0;M<x;M++)T[M]<o&&(T[M]=0);return{u:_,q:T,v:C}},r.VERSION="1.1.1",Object.defineProperty(r,"__esModule",{value:!0})})}),Tme=hc((e,t)=>{(function(r,i){typeof e=="object"&&typeof t<"u"?t.exports=i():typeof define=="function"&&define.amd?define(i):(r=r||self,r.TinyQueue=i())})(e,function(){var r=function(n,a){if(n===void 0&&(n=[]),a===void 0&&(a=i),this.data=n,this.length=this.data.length,this.compare=a,this.length>0)for(var o=(this.length>>1)-1;o>=0;o--)this._down(o)};r.prototype.push=function(n){this.data.push(n),this.length++,this._up(this.length-1)},r.prototype.pop=function(){if(this.length!==0){var n=this.data[0],a=this.data.pop();return this.length--,this.length>0&&(this.data[0]=a,this._down(0)),n}},r.prototype.peek=function(){return this.data[0]},r.prototype._up=function(n){for(var a=this,o=a.data,s=a.compare,l=o[n];n>0;){var c=n-1>>1,d=o[c];if(s(l,d)>=0)break;o[n]=d,n=c}o[n]=l},r.prototype._down=function(n){for(var a=this,o=a.data,s=a.compare,l=this.length>>1,c=o[n];n<l;){var d=(n<<1)+1,u=o[d],h=d+1;if(h<this.length&&s(o[h],u)<0&&(d=h,u=o[h]),s(u,c)>=0)break;o[n]=u,n=d}o[n]=c};function i(n,a){return n<a?-1:n>a?1:0}return r})}),Pme=hc((e,t)=>{var r=Tme();r.default&&(r=r.default),t.exports=i,t.exports.default=i;function i(c,d,u){d=d||1;for(var h,f,p,v,m=0;m<c[0].length;m++){var g=c[0][m];(!m||g[0]<h)&&(h=g[0]),(!m||g[1]<f)&&(f=g[1]),(!m||g[0]>p)&&(p=g[0]),(!m||g[1]>v)&&(v=g[1])}var y=p-h,b=v-f,x=Math.min(y,b),S=x/2;if(x===0){var w=[h,f];return w.distance=0,w}for(var _=new r(void 0,n),C=h;C<p;C+=x)for(var A=f;A<v;A+=x)_.push(new a(C+S,A+S,S,c));var M=s(c),P=new a(h+y/2,f+b/2,0,c);P.d>M.d&&(M=P);for(var T=_.length;_.length;){var R=_.pop();R.d>M.d&&(M=R,u&&console.log("found best %d after %d probes",Math.round(1e4*R.d)/1e4,T)),!(R.max-M.d<=d)&&(S=R.h/2,_.push(new a(R.x-S,R.y-S,S,c)),_.push(new a(R.x+S,R.y-S,S,c)),_.push(new a(R.x-S,R.y+S,S,c)),_.push(new a(R.x+S,R.y+S,S,c)),T+=4)}u&&(console.log("num probes: "+T),console.log("best distance: "+M.d));var z=[M.x,M.y];return z.distance=M.d,z}function n(c,d){return d.max-c.max}function a(c,d,u,h){this.x=c,this.y=d,this.h=u,this.d=o(c,d,h),this.max=this.d+this.h*Math.SQRT2}function o(c,d,u){for(var h=!1,f=1/0,p=0;p<u.length;p++)for(var v=u[p],m=0,g=v.length,y=g-1;m<g;y=m++){var b=v[m],x=v[y];b[1]>d!=x[1]>d&&c<(x[0]-b[0])*(d-b[1])/(x[1]-b[1])+b[0]&&(h=!h),f=Math.min(f,l(c,d,b,x))}return f===0?0:(h?1:-1)*Math.sqrt(f)}function s(c){for(var d=0,u=0,h=0,f=c[0],p=0,v=f.length,m=v-1;p<v;m=p++){var g=f[p],y=f[m],b=g[0]*y[1]-y[0]*g[1];u+=(g[0]+y[0])*b,h+=(g[1]+y[1])*b,d+=b*3}return d===0?new a(f[0][0],f[0][1],0,c):new a(u/d,h/d,0,c)}function l(c,d,u,h){var f=u[0],p=u[1],v=h[0]-f,m=h[1]-p;if(v!==0||m!==0){var g=((c-f)*v+(d-p)*m)/(v*v+m*m);g>1?(f=h[0],p=h[1]):g>0&&(f+=v*g,p+=m*g)}return v=c-f,m=d-p,v*v+m*m}}),Dme=hc((e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=r;function r(i){if(i===null||i===!0||i===!1)return NaN;var n=Number(i);return isNaN(n)?n:n<0?Math.ceil(n):Math.floor(n)}t.exports=e.default}),Ome=hc((e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=r;function r(i){var n=new Date(Date.UTC(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),i.getSeconds(),i.getMilliseconds()));return n.setUTCFullYear(i.getFullYear()),i.getTime()-n.getTime()}t.exports=e.default}),Rme=hc((e,t)=>{function r(a,o){function s(){this.constructor=a}s.prototype=o.prototype,a.prototype=new s}function i(a,o,s,l){this.message=a,this.expected=o,this.found=s,this.location=l,this.name="SyntaxError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,i)}r(i,Error),i.buildMessage=function(a,o){var s={literal:function(p){return'"'+c(p.text)+'"'},class:function(p){var v="",m;for(m=0;m<p.parts.length;m++)v+=p.parts[m]instanceof Array?d(p.parts[m][0])+"-"+d(p.parts[m][1]):d(p.parts[m]);return"["+(p.inverted?"^":"")+v+"]"},any:function(p){return"any character"},end:function(p){return"end of input"},other:function(p){return p.description}};function l(p){return p.charCodeAt(0).toString(16).toUpperCase()}function c(p){return p.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(v){return"\\x0"+l(v)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(v){return"\\x"+l(v)})}function d(p){return p.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(v){return"\\x0"+l(v)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(v){return"\\x"+l(v)})}function u(p){return s[p.type](p)}function h(p){var v=new Array(p.length),m,g;for(m=0;m<p.length;m++)v[m]=u(p[m]);if(v.sort(),v.length>0){for(m=1,g=1;m<v.length;m++)v[m-1]!==v[m]&&(v[g]=v[m],g++);v.length=g}switch(v.length){case 1:return v[0];case 2:return v[0]+" or "+v[1];default:return v.slice(0,-1).join(", ")+", or "+v[v.length-1]}}function f(p){return p?'"'+c(p)+'"':"end of input"}return"Expected "+h(a)+" but "+f(o)+" found."};function n(a,o){o=o!==void 0?o:{};var s={},l={svg_path:Ye},c=Ye,d=function(Y){if(!Y)return[];for(var J=[],be=0;be<Y.length;be++)J=J.concat.apply(J,Y[be]);var ae=J[0];return ae&&ae.code=="m"&&(delete ae.relative,ae.code="M"),J},u=function(Y,J){return ro(Y,J)},h=/^[Mm]/,f=nt(["M","m"],!1,!1),p=function(Y,J,be){var ae=ka(Y,[J]);return be&&(ae=ae.concat(ka(Y=="M"?"L":"l",be[1]))),ae},v=/^[Zz]/,m=nt(["Z","z"],!1,!1),g=function(){return ka("Z")},y=/^[Ll]/,b=nt(["L","l"],!1,!1),x=function(Y,J){return ka(Y,J)},S=/^[Hh]/,w=nt(["H","h"],!1,!1),_=function(Y,J){return ka(Y,J.map(function(be){return{x:be}}))},C=/^[Vv]/,A=nt(["V","v"],!1,!1),M=function(Y,J){return ka(Y,J.map(function(be){return{y:be}}))},P=/^[Cc]/,T=nt(["C","c"],!1,!1),R=function(Y,J,be){return{x1:Y.x,y1:Y.y,x2:J.x,y2:J.y,x:be.x,y:be.y}},z=/^[Ss]/,F=nt(["S","s"],!1,!1),H=function(Y,J){return{x2:Y.x,y2:Y.y,x:J.x,y:J.y}},N=/^[Qq]/,U=nt(["Q","q"],!1,!1),ie=function(Y,J){return{x1:Y.x,y1:Y.y,x:J.x,y:J.y}},te=/^[Tt]/,X=nt(["T","t"],!1,!1),W=/^[Aa]/,q=nt(["A","a"],!1,!1),$=function(Y,J,be,ae,Ie,ot){return{rx:Y,ry:J,xAxisRotation:be,largeArc:ae,sweep:Ie,x:ot.x,y:ot.y}},le=function(Y,J){return{x:Y,y:J}},ee=function(Y){return Y*1},Q=function(Y){return Y.join("")*1},ne=/^[01]/,V=nt(["0","1"],!1,!1),de=function(Y){return Y=="1"},me=function(){return""},Ce=",",G=Je(",",!1),Z=function(Y){return Y.join("")},ue=".",Se=Je(".",!1),we=/^[eE]/,_e=nt(["e","E"],!1,!1),Ee=/^[+\-]/,fe=nt(["+","-"],!1,!1),B=/^[0-9]/,D=nt([["0","9"]],!1,!1),I=function(Y){return Y.join("")},O=/^[ \t\n\r]/,j=nt([" ","	",`
`,"\r"],!1,!1),L=0,Ae=[{line:1,column:1}],We=0,je=[],ze;if("startRule"in o){if(!(o.startRule in l))throw new Error(`Can't start parsing from rule "`+o.startRule+'".');c=l[o.startRule]}function Je(Y,J){return{type:"literal",text:Y,ignoreCase:J}}function nt(Y,J,be){return{type:"class",parts:Y,inverted:J,ignoreCase:be}}function lt(){return{type:"end"}}function dt(Y){var J=Ae[Y],be;if(J)return J;for(be=Y-1;!Ae[be];)be--;for(J=Ae[be],J={line:J.line,column:J.column};be<Y;)a.charCodeAt(be)===10?(J.line++,J.column=1):J.column++,be++;return Ae[Y]=J,J}function vt(Y,J){var be=dt(Y),ae=dt(J);return{start:{offset:Y,line:be.line,column:be.column},end:{offset:J,line:ae.line,column:ae.column}}}function se(Y){L<We||(L>We&&(We=L,je=[]),je.push(Y))}function Le(Y,J,be){return new i(i.buildMessage(Y,J),Y,J,be)}function Ye(){var Y,J,be,ae,Ie;for(Y=L,J=[],be=Jt();be!==s;)J.push(be),be=Jt();if(J!==s)if(be=pe(),be===s&&(be=null),be!==s){for(ae=[],Ie=Jt();Ie!==s;)ae.push(Ie),Ie=Jt();ae!==s?(J=d(be),Y=J):(L=Y,Y=s)}else L=Y,Y=s;else L=Y,Y=s;return Y}function pe(){var Y,J,be,ae,Ie,ot;if(Y=L,J=Te(),J!==s){for(be=[],ae=L,Ie=[],ot=Jt();ot!==s;)Ie.push(ot),ot=Jt();for(Ie!==s?(ot=Te(),ot!==s?(Ie=[Ie,ot],ae=Ie):(L=ae,ae=s)):(L=ae,ae=s);ae!==s;){for(be.push(ae),ae=L,Ie=[],ot=Jt();ot!==s;)Ie.push(ot),ot=Jt();Ie!==s?(ot=Te(),ot!==s?(Ie=[Ie,ot],ae=Ie):(L=ae,ae=s)):(L=ae,ae=s)}be!==s?(J=u(J,be),Y=J):(L=Y,Y=s)}else L=Y,Y=s;return Y}function Te(){var Y,J,be,ae,Ie,ot;if(Y=L,J=Re(),J!==s){for(be=[],ae=L,Ie=[],ot=Jt();ot!==s;)Ie.push(ot),ot=Jt();for(Ie!==s?(ot=ce(),ot!==s?(Ie=[Ie,ot],ae=Ie):(L=ae,ae=s)):(L=ae,ae=s);ae!==s;){for(be.push(ae),ae=L,Ie=[],ot=Jt();ot!==s;)Ie.push(ot),ot=Jt();Ie!==s?(ot=ce(),ot!==s?(Ie=[Ie,ot],ae=Ie):(L=ae,ae=s)):(L=ae,ae=s)}be!==s?(J=u(J,be),Y=J):(L=Y,Y=s)}else L=Y,Y=s;return Y}function ce(){var Y;return Y=$e(),Y===s&&(Y=at(),Y===s&&(Y=ir(),Y===s&&(Y=Ke(),Y===s&&(Y=ut(),Y===s&&(Y=_i(),Y===s&&(Y=K(),Y===s&&(Y=Oe(),Y===s&&(Y=wt())))))))),Y}function Re(){var Y,J,be,ae,Ie,ot,jo;if(Y=L,h.test(a.charAt(L))?(J=a.charAt(L),L++):(J=s,se(f)),J!==s){for(be=[],ae=Jt();ae!==s;)be.push(ae),ae=Jt();be!==s?(ae=Tt(),ae!==s?(Ie=L,ot=Qe(),ot===s&&(ot=null),ot!==s?(jo=qt(),jo!==s?(ot=[ot,jo],Ie=ot):(L=Ie,Ie=s)):(L=Ie,Ie=s),Ie===s&&(Ie=null),Ie!==s?(J=p(J,ae,Ie),Y=J):(L=Y,Y=s)):(L=Y,Y=s)):(L=Y,Y=s)}else L=Y,Y=s;return Y}function $e(){var Y,J;return Y=L,v.test(a.charAt(L))?(J=a.charAt(L),L++):(J=s,se(m)),J!==s&&(J=g()),Y=J,Y}function at(){var Y,J,be,ae;if(Y=L,y.test(a.charAt(L))?(J=a.charAt(L),L++):(J=s,se(b)),J!==s){for(be=[],ae=Jt();ae!==s;)be.push(ae),ae=Jt();be!==s?(ae=qt(),ae!==s?(J=x(J,ae),Y=J):(L=Y,Y=s)):(L=Y,Y=s)}else L=Y,Y=s;return Y}function qt(){var Y,J,be,ae,Ie,ot;if(Y=L,J=Tt(),J!==s){for(be=[],ae=L,Ie=Qe(),Ie===s&&(Ie=null),Ie!==s?(ot=Tt(),ot!==s?(Ie=[Ie,ot],ae=Ie):(L=ae,ae=s)):(L=ae,ae=s);ae!==s;)be.push(ae),ae=L,Ie=Qe(),Ie===s&&(Ie=null),Ie!==s?(ot=Tt(),ot!==s?(Ie=[Ie,ot],ae=Ie):(L=ae,ae=s)):(L=ae,ae=s);be!==s?(J=u(J,be),Y=J):(L=Y,Y=s)}else L=Y,Y=s;return Y}function ir(){var Y,J,be,ae;if(Y=L,S.test(a.charAt(L))?(J=a.charAt(L),L++):(J=s,se(w)),J!==s){for(be=[],ae=Jt();ae!==s;)be.push(ae),ae=Jt();be!==s?(ae=Fe(),ae!==s?(J=_(J,ae),Y=J):(L=Y,Y=s)):(L=Y,Y=s)}else L=Y,Y=s;return Y}function Fe(){var Y,J,be,ae,Ie,ot;if(Y=L,J=Zt(),J!==s){for(be=[],ae=L,Ie=Qe(),Ie===s&&(Ie=null),Ie!==s?(ot=Zt(),ot!==s?(Ie=[Ie,ot],ae=Ie):(L=ae,ae=s)):(L=ae,ae=s);ae!==s;)be.push(ae),ae=L,Ie=Qe(),Ie===s&&(Ie=null),Ie!==s?(ot=Zt(),ot!==s?(Ie=[Ie,ot],ae=Ie):(L=ae,ae=s)):(L=ae,ae=s);be!==s?(J=u(J,be),Y=J):(L=Y,Y=s)}else L=Y,Y=s;return Y}function Ke(){var Y,J,be,ae;if(Y=L,C.test(a.charAt(L))?(J=a.charAt(L),L++):(J=s,se(A)),J!==s){for(be=[],ae=Jt();ae!==s;)be.push(ae),ae=Jt();be!==s?(ae=Fe(),ae!==s?(J=M(J,ae),Y=J):(L=Y,Y=s)):(L=Y,Y=s)}else L=Y,Y=s;return Y}function ut(){var Y,J,be,ae;if(Y=L,P.test(a.charAt(L))?(J=a.charAt(L),L++):(J=s,se(T)),J!==s){for(be=[],ae=Jt();ae!==s;)be.push(ae),ae=Jt();be!==s?(ae=Ft(),ae!==s?(J=x(J,ae),Y=J):(L=Y,Y=s)):(L=Y,Y=s)}else L=Y,Y=s;return Y}function Ft(){var Y,J,be,ae,Ie,ot;if(Y=L,J=ui(),J!==s){for(be=[],ae=L,Ie=Qe(),Ie===s&&(Ie=null),Ie!==s?(ot=ui(),ot!==s?(Ie=[Ie,ot],ae=Ie):(L=ae,ae=s)):(L=ae,ae=s);ae!==s;)be.push(ae),ae=L,Ie=Qe(),Ie===s&&(Ie=null),Ie!==s?(ot=ui(),ot!==s?(Ie=[Ie,ot],ae=Ie):(L=ae,ae=s)):(L=ae,ae=s);be!==s?(J=u(J,be),Y=J):(L=Y,Y=s)}else L=Y,Y=s;return Y}function ui(){var Y,J,be,ae,Ie,ot;return Y=L,J=Tt(),J!==s?(be=Qe(),be===s&&(be=null),be!==s?(ae=Tt(),ae!==s?(Ie=Qe(),Ie===s&&(Ie=null),Ie!==s?(ot=Tt(),ot!==s?(J=R(J,ae,ot),Y=J):(L=Y,Y=s)):(L=Y,Y=s)):(L=Y,Y=s)):(L=Y,Y=s)):(L=Y,Y=s),Y}function _i(){var Y,J,be,ae;if(Y=L,z.test(a.charAt(L))?(J=a.charAt(L),L++):(J=s,se(F)),J!==s){for(be=[],ae=Jt();ae!==s;)be.push(ae),ae=Jt();be!==s?(ae=Ar(),ae!==s?(J=x(J,ae),Y=J):(L=Y,Y=s)):(L=Y,Y=s)}else L=Y,Y=s;return Y}function Ar(){var Y,J,be,ae,Ie,ot;if(Y=L,J=De(),J!==s){for(be=[],ae=L,Ie=Qe(),Ie===s&&(Ie=null),Ie!==s?(ot=De(),ot!==s?(Ie=[Ie,ot],ae=Ie):(L=ae,ae=s)):(L=ae,ae=s);ae!==s;)be.push(ae),ae=L,Ie=Qe(),Ie===s&&(Ie=null),Ie!==s?(ot=De(),ot!==s?(Ie=[Ie,ot],ae=Ie):(L=ae,ae=s)):(L=ae,ae=s);be!==s?(J=u(J,be),Y=J):(L=Y,Y=s)}else L=Y,Y=s;return Y}function De(){var Y,J,be,ae;return Y=L,J=Tt(),J!==s?(be=Qe(),be===s&&(be=null),be!==s?(ae=Tt(),ae!==s?(J=H(J,ae),Y=J):(L=Y,Y=s)):(L=Y,Y=s)):(L=Y,Y=s),Y}function K(){var Y,J,be,ae;if(Y=L,N.test(a.charAt(L))?(J=a.charAt(L),L++):(J=s,se(U)),J!==s){for(be=[],ae=Jt();ae!==s;)be.push(ae),ae=Jt();be!==s?(ae=Me(),ae!==s?(J=x(J,ae),Y=J):(L=Y,Y=s)):(L=Y,Y=s)}else L=Y,Y=s;return Y}function Me(){var Y,J,be,ae,Ie,ot;if(Y=L,J=He(),J!==s){for(be=[],ae=L,Ie=Qe(),Ie===s&&(Ie=null),Ie!==s?(ot=He(),ot!==s?(Ie=[Ie,ot],ae=Ie):(L=ae,ae=s)):(L=ae,ae=s);ae!==s;)be.push(ae),ae=L,Ie=Qe(),Ie===s&&(Ie=null),Ie!==s?(ot=He(),ot!==s?(Ie=[Ie,ot],ae=Ie):(L=ae,ae=s)):(L=ae,ae=s);be!==s?(J=u(J,be),Y=J):(L=Y,Y=s)}else L=Y,Y=s;return Y}function He(){var Y,J,be,ae;return Y=L,J=Tt(),J!==s?(be=Qe(),be===s&&(be=null),be!==s?(ae=Tt(),ae!==s?(J=ie(J,ae),Y=J):(L=Y,Y=s)):(L=Y,Y=s)):(L=Y,Y=s),Y}function Oe(){var Y,J,be,ae;if(Y=L,te.test(a.charAt(L))?(J=a.charAt(L),L++):(J=s,se(X)),J!==s){for(be=[],ae=Jt();ae!==s;)be.push(ae),ae=Jt();be!==s?(ae=Ne(),ae!==s?(J=x(J,ae),Y=J):(L=Y,Y=s)):(L=Y,Y=s)}else L=Y,Y=s;return Y}function Ne(){var Y,J,be,ae,Ie,ot;if(Y=L,J=Tt(),J!==s){for(be=[],ae=L,Ie=Qe(),Ie===s&&(Ie=null),Ie!==s?(ot=Tt(),ot!==s?(Ie=[Ie,ot],ae=Ie):(L=ae,ae=s)):(L=ae,ae=s);ae!==s;)be.push(ae),ae=L,Ie=Qe(),Ie===s&&(Ie=null),Ie!==s?(ot=Tt(),ot!==s?(Ie=[Ie,ot],ae=Ie):(L=ae,ae=s)):(L=ae,ae=s);be!==s?(J=u(J,be),Y=J):(L=Y,Y=s)}else L=Y,Y=s;return Y}function wt(){var Y,J,be,ae;if(Y=L,W.test(a.charAt(L))?(J=a.charAt(L),L++):(J=s,se(q)),J!==s){for(be=[],ae=Jt();ae!==s;)be.push(ae),ae=Jt();be!==s?(ae=Rt(),ae!==s?(J=x(J,ae),Y=J):(L=Y,Y=s)):(L=Y,Y=s)}else L=Y,Y=s;return Y}function Rt(){var Y,J,be,ae,Ie,ot;if(Y=L,J=It(),J!==s){for(be=[],ae=L,Ie=Qe(),Ie===s&&(Ie=null),Ie!==s?(ot=It(),ot!==s?(Ie=[Ie,ot],ae=Ie):(L=ae,ae=s)):(L=ae,ae=s);ae!==s;)be.push(ae),ae=L,Ie=Qe(),Ie===s&&(Ie=null),Ie!==s?(ot=It(),ot!==s?(Ie=[Ie,ot],ae=Ie):(L=ae,ae=s)):(L=ae,ae=s);be!==s?(J=u(J,be),Y=J):(L=Y,Y=s)}else L=Y,Y=s;return Y}function It(){var Y,J,be,ae,Ie,ot,jo,im,Mh,nm,Eh,am;return Y=L,J=hr(),J!==s?(be=Qe(),be===s&&(be=null),be!==s?(ae=hr(),ae!==s?(Ie=Qe(),Ie===s&&(Ie=null),Ie!==s?(ot=Zt(),ot!==s?(jo=Qe(),jo!==s?(im=Pe(),im!==s?(Mh=Qe(),Mh===s&&(Mh=null),Mh!==s?(nm=Pe(),nm!==s?(Eh=Qe(),Eh===s&&(Eh=null),Eh!==s?(am=Tt(),am!==s?(J=$(J,ae,ot,im,nm,am),Y=J):(L=Y,Y=s)):(L=Y,Y=s)):(L=Y,Y=s)):(L=Y,Y=s)):(L=Y,Y=s)):(L=Y,Y=s)):(L=Y,Y=s)):(L=Y,Y=s)):(L=Y,Y=s)):(L=Y,Y=s)):(L=Y,Y=s),Y}function Tt(){var Y,J,be,ae;return Y=L,J=Zt(),J!==s?(be=Qe(),be===s&&(be=null),be!==s?(ae=Zt(),ae!==s?(J=le(J,ae),Y=J):(L=Y,Y=s)):(L=Y,Y=s)):(L=Y,Y=s),Y}function hr(){var Y,J;return Y=L,J=Mr(),J===s&&(J=_n()),J!==s&&(J=ee(J)),Y=J,Y}function Zt(){var Y,J,be,ae;return Y=L,J=L,be=nr(),be===s&&(be=null),be!==s?(ae=Mr(),ae!==s?(be=[be,ae],J=be):(L=J,J=s)):(L=J,J=s),J===s&&(J=L,be=nr(),be===s&&(be=null),be!==s?(ae=_n(),ae!==s?(be=[be,ae],J=be):(L=J,J=s)):(L=J,J=s)),J!==s&&(J=Q(J)),Y=J,Y}function Pe(){var Y,J;return Y=L,ne.test(a.charAt(L))?(J=a.charAt(L),L++):(J=s,se(V)),J!==s&&(J=de(J)),Y=J,Y}function Qe(){var Y,J,be,ae,Ie;if(Y=L,J=[],be=Jt(),be!==s)for(;be!==s;)J.push(be),be=Jt();else J=s;if(J!==s)if(be=xt(),be===s&&(be=null),be!==s){for(ae=[],Ie=Jt();Ie!==s;)ae.push(Ie),Ie=Jt();ae!==s?(J=[J,be,ae],Y=J):(L=Y,Y=s)}else L=Y,Y=s;else L=Y,Y=s;if(Y===s){if(Y=L,J=L,be=xt(),be!==s){for(ae=[],Ie=Jt();Ie!==s;)ae.push(Ie),Ie=Jt();ae!==s?(be=[be,ae],J=be):(L=J,J=s)}else L=J,J=s;J!==s&&(J=me()),Y=J}return Y}function xt(){var Y;return a.charCodeAt(L)===44?(Y=Ce,L++):(Y=s,se(G)),Y}function Mr(){var Y,J,be,ae;return Y=L,J=L,be=ci(),be!==s?(ae=Nt(),ae===s&&(ae=null),ae!==s?(be=[be,ae],J=be):(L=J,J=s)):(L=J,J=s),J===s&&(J=L,be=_n(),be!==s?(ae=Nt(),ae!==s?(be=[be,ae],J=be):(L=J,J=s)):(L=J,J=s)),J!==s&&(J=Z(J)),Y=J,Y}function ci(){var Y,J,be,ae,Ie;return Y=L,J=L,be=_n(),be===s&&(be=null),be!==s?(a.charCodeAt(L)===46?(ae=ue,L++):(ae=s,se(Se)),ae!==s?(Ie=_n(),Ie!==s?(be=[be,ae,Ie],J=be):(L=J,J=s)):(L=J,J=s)):(L=J,J=s),J===s&&(J=L,be=_n(),be!==s?(a.charCodeAt(L)===46?(ae=ue,L++):(ae=s,se(Se)),ae!==s?(be=[be,ae],J=be):(L=J,J=s)):(L=J,J=s)),J!==s&&(J=Z(J)),Y=J,Y}function Nt(){var Y,J,be,ae,Ie;return Y=L,J=L,we.test(a.charAt(L))?(be=a.charAt(L),L++):(be=s,se(_e)),be!==s?(ae=nr(),ae===s&&(ae=null),ae!==s?(Ie=_n(),Ie!==s?(be=[be,ae,Ie],J=be):(L=J,J=s)):(L=J,J=s)):(L=J,J=s),J!==s&&(J=Z(J)),Y=J,Y}function nr(){var Y;return Ee.test(a.charAt(L))?(Y=a.charAt(L),L++):(Y=s,se(fe)),Y}function _n(){var Y,J,be;if(Y=L,J=[],B.test(a.charAt(L))?(be=a.charAt(L),L++):(be=s,se(D)),be!==s)for(;be!==s;)J.push(be),B.test(a.charAt(L))?(be=a.charAt(L),L++):(be=s,se(D));else J=s;return J!==s&&(J=I(J)),Y=J,Y}function Jt(){var Y,J;return Y=L,O.test(a.charAt(L))?(J=a.charAt(L),L++):(J=s,se(j)),J!==s&&(J=me()),Y=J,Y}function ro(Y,J){if(!J)return[Y];for(var be=[Y],ae=0,Ie=J.length;ae<Ie;ae++)be[ae+1]=J[ae][1];return be}var Uo={m:"moveto",l:"lineto",h:"horizontal lineto",v:"vertical lineto",c:"curveto",s:"smooth curveto",q:"quadratic curveto",t:"smooth quadratic curveto",a:"elliptical arc",z:"closepath"};for(var uo in Uo)Uo[uo.toUpperCase()]=Uo[uo];function ka(Y,J){J||(J=[{}]);for(var be=J.length;be--;){var ae={code:Y,command:Uo[Y]};Y==Y.toLowerCase()&&(ae.relative=!0);for(var Ie in J[be])ae[Ie]=J[be][Ie];J[be]=ae}return J}if(ze=c(),ze!==s&&L===a.length)return ze;throw ze!==s&&L<a.length&&se(lt()),Le(je,We<a.length?a.charAt(We):null,We<a.length?vt(We,We+1):vt(We,We))}t.exports={SyntaxError:i,parse:n}}),J6=hc((e,t)=>{var r=Rme().parse;r.parseSVG=r,r.makeAbsolute=i,t.exports=r;function i(n){var a,o={x:0,y:0},s={x:"x0",y:"y0",x1:"x0",y1:"y0",x2:"x0",y2:"y0"};return n.forEach(function(l){l.command==="moveto"&&(a=l),l.x0=o.x,l.y0=o.y;for(var c in s)c in l&&(l[c]+=l.relative?l[s[c]]:0);"x"in l||(l.x=o.x),"y"in l||(l.y=o.y),l.relative=!1,l.code=l.code.toUpperCase(),l.command=="closepath"&&(l.x=a.x,l.y=a.y),o=l}),n}}),Ime=hc((e,t)=>{t.exports=function(r,i){for(var n=r.split("."),a=i.split("."),o=0;o<3;o++){var s=Number(n[o]),l=Number(a[o]);if(s>l)return 1;if(l>s)return-1;if(!isNaN(s)&&isNaN(l))return 1;if(isNaN(s)&&!isNaN(l))return-1}return 0}}),Up="149",po={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},zme=0,QR=1,kme=2,KT=1,Lme=2,Zm=3,us=0,Ln=1,fa=2,ln=0,Fu=1,ZR=2,JR=3,eI=4,Bme=5,yf=100,Fme=101,Nme=102,tI=103,rI=104,Ume=200,jme=201,Vme=202,Hme=203,ej=204,tj=205,Wme=206,Gme=207,$me=208,qme=209,Yme=210,Xme=0,Kme=1,Qme=2,AA=3,Zme=4,Jme=5,eve=6,tve=7,rj=0,rve=1,ive=2,Zs=0,nve=1,ave=2,ove=3,sve=4,lve=5,ij=300,th=301,rh=302,MA=303,EA=304,Hg=306,Hl=1e3,Si=1001,TA=1002,Hr=1003,iI=1004,ES=1005,ur=1006,cve=1007,mp=1008,ga=1009,dve=1010,uve=1011,nj=1012,hve=1013,Wl=1014,on=1015,ec=1016,fve=1017,pve=1018,Nu=1020,mve=1021,In=1023,vve=1024,gve=1025,Uu=1026,ih=1027,yve=1028,bve=1029,sx=1030,xve=1031,aj=1033,TS=33776,PS=33777,DS=33778,OS=33779,nI=35840,aI=35841,oI=35842,sI=35843,wve=36196,lI=37492,cI=37496,dI=37808,uI=37809,hI=37810,fI=37811,pI=37812,mI=37813,vI=37814,gI=37815,yI=37816,bI=37817,xI=37818,wI=37819,SI=37820,CI=37821,RS=36492,Sve=36283,_I=36284,AI=36285,MI=36286,oj=2200,sj=2201,QT=2202,lx=2300,cx=2301,IS=2302,Mf=2400,Ef=2401,dx=2402,ZT=2500,Cve=2501,hs=3e3,sr=3001,pc=3200,lj=3201,_ve=0,Ave=1,ks="srgb",ux="srgb-linear",zS=7680,Mve=519,PA=35044,Eve=35048,EI="300 es",DA=1035,aa=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});let r=this._listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(t)===-1&&r[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;let r=this._listeners;return r[e]!==void 0&&r[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;let r=this._listeners[e];if(r!==void 0){let i=r.indexOf(t);i!==-1&&r.splice(i,1)}}dispatchEvent(e){if(this._listeners===void 0)return;let t=this._listeners[e.type];if(t!==void 0){e.target=this;let r=t.slice(0);for(let i=0,n=r.length;i<n;i++)r[i].call(this,e);e.target=null}}},sa=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],TI=1234567,Cv=Math.PI/180,ig=180/Math.PI;function Io(){let e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,r=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(sa[e&255]+sa[e>>8&255]+sa[e>>16&255]+sa[e>>24&255]+"-"+sa[t&255]+sa[t>>8&255]+"-"+sa[t>>16&15|64]+sa[t>>24&255]+"-"+sa[r&63|128]+sa[r>>8&255]+"-"+sa[r>>16&255]+sa[r>>24&255]+sa[i&255]+sa[i>>8&255]+sa[i>>16&255]+sa[i>>24&255]).toLowerCase()}function nn(e,t,r){return Math.max(t,Math.min(r,e))}function JT(e,t){return(e%t+t)%t}function Tve(e,t,r,i,n){return i+(e-t)*(n-i)/(r-t)}function Pve(e,t,r){return e!==t?(r-e)/(t-e):0}function _v(e,t,r){return(1-r)*e+r*t}function Dve(e,t,r,i){return _v(e,t,1-Math.exp(-r*i))}function Ove(e,t=1){return t-Math.abs(JT(e,t*2)-t)}function Rve(e,t,r){return e<=t?0:e>=r?1:(e=(e-t)/(r-t),e*e*(3-2*e))}function Ive(e,t,r){return e<=t?0:e>=r?1:(e=(e-t)/(r-t),e*e*e*(e*(e*6-15)+10))}function zve(e,t){return e+Math.floor(Math.random()*(t-e+1))}function kve(e,t){return e+Math.random()*(t-e)}function Lve(e){return e*(.5-Math.random())}function Bve(e){e!==void 0&&(TI=e);let t=TI+=1831565813;return t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61),((t^t>>>14)>>>0)/4294967296}function Fve(e){return e*Cv}function Nve(e){return e*ig}function OA(e){return(e&e-1)===0&&e!==0}function cj(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))}function hx(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}function Uve(e,t,r,i,n){let a=Math.cos,o=Math.sin,s=a(r/2),l=o(r/2),c=a((t+i)/2),d=o((t+i)/2),u=a((t-i)/2),h=o((t-i)/2),f=a((i-t)/2),p=o((i-t)/2);switch(n){case"XYX":e.set(s*d,l*u,l*h,s*c);break;case"YZY":e.set(l*h,s*d,l*u,s*c);break;case"ZXZ":e.set(l*u,l*h,s*d,s*c);break;case"XZX":e.set(s*d,l*p,l*f,s*c);break;case"YXY":e.set(l*f,s*d,l*p,s*c);break;case"ZYZ":e.set(l*p,l*f,s*d,s*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+n)}}function Gl(e,t){switch(t.constructor){case Float32Array:return e;case Uint16Array:return e/65535;case Uint8Array:return e/255;case Int16Array:return Math.max(e/32767,-1);case Int8Array:return Math.max(e/127,-1);default:throw new Error("Invalid component type.")}}function di(e,t){switch(t.constructor){case Float32Array:return e;case Uint16Array:return Math.round(e*65535);case Uint8Array:return Math.round(e*255);case Int16Array:return Math.round(e*32767);case Int8Array:return Math.round(e*127);default:throw new Error("Invalid component type.")}}var St=Object.freeze({__proto__:null,DEG2RAD:Cv,RAD2DEG:ig,ceilPowerOfTwo:cj,clamp:nn,damp:Dve,degToRad:Fve,denormalize:Gl,euclideanModulo:JT,floorPowerOfTwo:hx,generateUUID:Io,inverseLerp:Pve,isPowerOfTwo:OA,lerp:_v,mapLinear:Tve,normalize:di,pingpong:Ove,radToDeg:Nve,randFloat:kve,randFloatSpread:Lve,randInt:zve,seededRandom:Bve,setQuaternionFromProperEuler:Uve,smootherstep:Ive,smoothstep:Rve}),ye=class{constructor(e=0,t=0){ye.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){let t=this.x,r=this.y,i=e.elements;return this.x=i[0]*t+i[3]*r+i[6],this.y=i[1]*t+i[4]*r+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){let r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,r=this.y-e.y;return t*t+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){let r=Math.cos(t),i=Math.sin(t),n=this.x-e.x,a=this.y-e.y;return this.x=n*r-a*i+e.x,this.y=n*i+a*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}},sn=class{constructor(){sn.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(e,t,r,i,n,a,o,s,l){let c=this.elements;return c[0]=e,c[1]=i,c[2]=o,c[3]=t,c[4]=n,c[5]=s,c[6]=r,c[7]=a,c[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){let t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],this}extractBasis(e,t,r){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){let t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let r=e.elements,i=t.elements,n=this.elements,a=r[0],o=r[3],s=r[6],l=r[1],c=r[4],d=r[7],u=r[2],h=r[5],f=r[8],p=i[0],v=i[3],m=i[6],g=i[1],y=i[4],b=i[7],x=i[2],S=i[5],w=i[8];return n[0]=a*p+o*g+s*x,n[3]=a*v+o*y+s*S,n[6]=a*m+o*b+s*w,n[1]=l*p+c*g+d*x,n[4]=l*v+c*y+d*S,n[7]=l*m+c*b+d*w,n[2]=u*p+h*g+f*x,n[5]=u*v+h*y+f*S,n[8]=u*m+h*b+f*w,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){let e=this.elements,t=e[0],r=e[1],i=e[2],n=e[3],a=e[4],o=e[5],s=e[6],l=e[7],c=e[8];return t*a*c-t*o*l-r*n*c+r*o*s+i*n*l-i*a*s}invert(){let e=this.elements,t=e[0],r=e[1],i=e[2],n=e[3],a=e[4],o=e[5],s=e[6],l=e[7],c=e[8],d=c*a-o*l,u=o*s-c*n,h=l*n-a*s,f=t*d+r*u+i*h;if(f===0)return this.set(0,0,0,0,0,0,0,0,0);let p=1/f;return e[0]=d*p,e[1]=(i*l-c*r)*p,e[2]=(o*r-i*a)*p,e[3]=u*p,e[4]=(c*t-i*s)*p,e[5]=(i*n-o*t)*p,e[6]=h*p,e[7]=(r*s-l*t)*p,e[8]=(a*t-r*n)*p,this}transpose(){let e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){let t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,r,i,n,a,o){let s=Math.cos(n),l=Math.sin(n);return this.set(r*s,r*l,-r*(s*a+l*o)+a+e,-i*l,i*s,-i*(-l*a+s*o)+o+t,0,0,1),this}scale(e,t){return this.premultiply(kS.makeScale(e,t)),this}rotate(e){return this.premultiply(kS.makeRotation(-e)),this}translate(e,t){return this.premultiply(kS.makeTranslation(e,t)),this}makeTranslation(e,t){return this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){let t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,r,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){let t=this.elements,r=e.elements;for(let i=0;i<9;i++)if(t[i]!==r[i])return!1;return!0}fromArray(e,t=0){for(let r=0;r<9;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){let r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}clone(){return new this.constructor().fromArray(this.elements)}},kS=new sn;function dj(e){for(let t=e.length-1;t>=0;--t)if(e[t]>=65535)return!0;return!1}var jve={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function z0(e,t){return new jve[e](t)}function ng(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}function ju(e){return e<.04045?e*.0773993808:Math.pow(e*.9478672986+.0521327014,2.4)}function fb(e){return e<.0031308?e*12.92:1.055*Math.pow(e,.41666)-.055}var LS={[ks]:{[ux]:ju},[ux]:{[ks]:fb}},ya={legacyMode:!0,get workingColorSpace(){return ux},set workingColorSpace(e){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(e,t,r){if(this.legacyMode||t===r||!t||!r)return e;if(LS[t]&&LS[t][r]!==void 0){let i=LS[t][r];return e.r=i(e.r),e.g=i(e.g),e.b=i(e.b),e}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(e,t){return this.convert(e,this.workingColorSpace,t)},toWorkingColorSpace:function(e,t){return this.convert(e,t,this.workingColorSpace)}},uj={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},un={r:0,g:0,b:0},Vo={h:0,s:0,l:0},k0={h:0,s:0,l:0};function BS(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*6*r:r<1/2?t:r<2/3?e+(t-e)*6*(2/3-r):e}function L0(e,t){return t.r=e.r,t.g=e.g,t.b=e.b,t}var Lt=class{constructor(e,t,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,t===void 0&&r===void 0?this.set(e):this.setRGB(e,t,r)}set(e){return e&&e.isColor?this.copy(e):typeof e=="number"?this.setHex(e):typeof e=="string"&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=ks){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,ya.toWorkingColorSpace(this,t),this}setRGB(e,t,r,i=ya.workingColorSpace){return this.r=e,this.g=t,this.b=r,ya.toWorkingColorSpace(this,i),this}setHSL(e,t,r,i=ya.workingColorSpace){if(e=JT(e,1),t=nn(t,0,1),r=nn(r,0,1),t===0)this.r=this.g=this.b=r;else{let n=r<=.5?r*(1+t):r+t-r*t,a=2*r-n;this.r=BS(a,n,e+1/3),this.g=BS(a,n,e),this.b=BS(a,n,e-1/3)}return ya.toWorkingColorSpace(this,i),this}setStyle(e,t=ks){function r(n){n!==void 0&&parseFloat(n)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let i;if(i=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){let n,a=i[1],o=i[2];switch(a){case"rgb":case"rgba":if(n=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return this.r=Math.min(255,parseInt(n[1],10))/255,this.g=Math.min(255,parseInt(n[2],10))/255,this.b=Math.min(255,parseInt(n[3],10))/255,ya.toWorkingColorSpace(this,t),r(n[4]),this;if(n=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return this.r=Math.min(100,parseInt(n[1],10))/100,this.g=Math.min(100,parseInt(n[2],10))/100,this.b=Math.min(100,parseInt(n[3],10))/100,ya.toWorkingColorSpace(this,t),r(n[4]),this;break;case"hsl":case"hsla":if(n=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o)){let s=parseFloat(n[1])/360,l=parseFloat(n[2])/100,c=parseFloat(n[3])/100;return r(n[4]),this.setHSL(s,l,c,t)}break}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(e)){let n=i[1],a=n.length;if(a===3)return this.r=parseInt(n.charAt(0)+n.charAt(0),16)/255,this.g=parseInt(n.charAt(1)+n.charAt(1),16)/255,this.b=parseInt(n.charAt(2)+n.charAt(2),16)/255,ya.toWorkingColorSpace(this,t),this;if(a===6)return this.r=parseInt(n.charAt(0)+n.charAt(1),16)/255,this.g=parseInt(n.charAt(2)+n.charAt(3),16)/255,this.b=parseInt(n.charAt(4)+n.charAt(5),16)/255,ya.toWorkingColorSpace(this,t),this}return e&&e.length>0?this.setColorName(e,t):this}setColorName(e,t=ks){let r=uj[e.toLowerCase()];return r!==void 0?this.setHex(r,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=ju(e.r),this.g=ju(e.g),this.b=ju(e.b),this}copyLinearToSRGB(e){return this.r=fb(e.r),this.g=fb(e.g),this.b=fb(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=ks){return ya.fromWorkingColorSpace(L0(this,un),e),nn(un.r*255,0,255)<<16^nn(un.g*255,0,255)<<8^nn(un.b*255,0,255)<<0}getHexString(e=ks){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=ya.workingColorSpace){ya.fromWorkingColorSpace(L0(this,un),t);let r=un.r,i=un.g,n=un.b,a=Math.max(r,i,n),o=Math.min(r,i,n),s,l,c=(o+a)/2;if(o===a)s=0,l=0;else{let d=a-o;switch(l=c<=.5?d/(a+o):d/(2-a-o),a){case r:s=(i-n)/d+(i<n?6:0);break;case i:s=(n-r)/d+2;break;case n:s=(r-i)/d+4;break}s/=6}return e.h=s,e.s=l,e.l=c,e}getRGB(e,t=ya.workingColorSpace){return ya.fromWorkingColorSpace(L0(this,un),t),e.r=un.r,e.g=un.g,e.b=un.b,e}getStyle(e=ks){return ya.fromWorkingColorSpace(L0(this,un),e),e!==ks?`color(${e} ${un.r} ${un.g} ${un.b})`:`rgb(${un.r*255|0},${un.g*255|0},${un.b*255|0})`}offsetHSL(e,t,r){return this.getHSL(Vo),Vo.h+=e,Vo.s+=t,Vo.l+=r,this.setHSL(Vo.h,Vo.s,Vo.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,r){return this.r=e.r+(t.r-e.r)*r,this.g=e.g+(t.g-e.g)*r,this.b=e.b+(t.b-e.b)*r,this}lerpHSL(e,t){this.getHSL(Vo),e.getHSL(k0);let r=_v(Vo.h,k0.h,t),i=_v(Vo.s,k0.s,t),n=_v(Vo.l,k0.l,t);return this.setHSL(r,i,n),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};Lt.NAMES=uj;var Fh,hj=class{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{Fh===void 0&&(Fh=ng("canvas")),Fh.width=e.width,Fh.height=e.height;let r=Fh.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),t=Fh}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){let t=ng("canvas");t.width=e.width,t.height=e.height;let r=t.getContext("2d");r.drawImage(e,0,0,e.width,e.height);let i=r.getImageData(0,0,e.width,e.height),n=i.data;for(let a=0;a<n.length;a++)n[a]=ju(n[a]/255)*255;return r.putImageData(i,0,0),t}else if(e.data){let t=e.data.slice(0);for(let r=0;r<t.length;r++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[r]=Math.floor(ju(t[r]/255)*255):t[r]=ju(t[r]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}},fj=class{constructor(e=null){this.isSource=!0,this.uuid=Io(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){let t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];let r={uuid:this.uuid,url:""},i=this.data;if(i!==null){let n;if(Array.isArray(i)){n=[];for(let a=0,o=i.length;a<o;a++)i[a].isDataTexture?n.push(FS(i[a].image)):n.push(FS(i[a]))}else n=FS(i);r.url=n}return t||(e.images[this.uuid]=r),r}};function FS(e){return typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap?hj.getDataURL(e):e.data?{data:Array.from(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}var Vve=0,Oi=class extends aa{constructor(e=Oi.DEFAULT_IMAGE,t=Oi.DEFAULT_MAPPING,r=Si,i=Si,n=ur,a=mp,o=In,s=ga,l=Oi.DEFAULT_ANISOTROPY,c=hs){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Vve++}),this.uuid=Io(),this.name="",this.source=new fj(e),this.mipmaps=[],this.mapping=t,this.wrapS=r,this.wrapT=i,this.magFilter=n,this.minFilter=a,this.anisotropy=l,this.format=o,this.internalFormat=null,this.type=s,this.offset=new ye(0,0),this.repeat=new ye(1,1),this.center=new ye(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new sn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=c,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){let t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];let r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),t||(e.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==ij)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Hl:e.x=e.x-Math.floor(e.x);break;case Si:e.x=e.x<0?0:1;break;case TA:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Hl:e.y=e.y-Math.floor(e.y);break;case Si:e.y=e.y<0?0:1;break;case TA:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}};Oi.DEFAULT_IMAGE=null;Oi.DEFAULT_MAPPING=ij;Oi.DEFAULT_ANISOTROPY=1;var Kt=class{constructor(e=0,t=0,r=0,i=1){Kt.prototype.isVector4=!0,this.x=e,this.y=t,this.z=r,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,r,i){return this.x=e,this.y=t,this.z=r,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){let t=this.x,r=this.y,i=this.z,n=this.w,a=e.elements;return this.x=a[0]*t+a[4]*r+a[8]*i+a[12]*n,this.y=a[1]*t+a[5]*r+a[9]*i+a[13]*n,this.z=a[2]*t+a[6]*r+a[10]*i+a[14]*n,this.w=a[3]*t+a[7]*r+a[11]*i+a[15]*n,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);let t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,r,i,n,a=e.elements,o=a[0],s=a[4],l=a[8],c=a[1],d=a[5],u=a[9],h=a[2],f=a[6],p=a[10];if(Math.abs(s-c)<.01&&Math.abs(l-h)<.01&&Math.abs(u-f)<.01){if(Math.abs(s+c)<.1&&Math.abs(l+h)<.1&&Math.abs(u+f)<.1&&Math.abs(o+d+p-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;let m=(o+1)/2,g=(d+1)/2,y=(p+1)/2,b=(s+c)/4,x=(l+h)/4,S=(u+f)/4;return m>g&&m>y?m<.01?(r=0,i=.707106781,n=.707106781):(r=Math.sqrt(m),i=b/r,n=x/r):g>y?g<.01?(r=.707106781,i=0,n=.707106781):(i=Math.sqrt(g),r=b/i,n=S/i):y<.01?(r=.707106781,i=.707106781,n=0):(n=Math.sqrt(y),r=x/n,i=S/n),this.set(r,i,n,t),this}let v=Math.sqrt((f-u)*(f-u)+(l-h)*(l-h)+(c-s)*(c-s));return Math.abs(v)<.001&&(v=1),this.x=(f-u)/v,this.y=(l-h)/v,this.z=(c-s)/v,this.w=Math.acos((o+d+p-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){let r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this.w=e.w+(t.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}},Ur=class extends aa{constructor(e=1,t=1,r={}){super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Kt(0,0,e,t),this.scissorTest=!1,this.viewport=new Kt(0,0,e,t);let i={width:e,height:t,depth:1};this.texture=new Oi(i,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=r.generateMipmaps!==void 0?r.generateMipmaps:!1,this.texture.internalFormat=r.internalFormat!==void 0?r.internalFormat:null,this.texture.minFilter=r.minFilter!==void 0?r.minFilter:ur,this.depthBuffer=r.depthBuffer!==void 0?r.depthBuffer:!0,this.stencilBuffer=r.stencilBuffer!==void 0?r.stencilBuffer:!1,this.depthTexture=r.depthTexture!==void 0?r.depthTexture:null,this.samples=r.samples!==void 0?r.samples:0}setSize(e,t,r=1){(this.width!==e||this.height!==t||this.depth!==r)&&(this.width=e,this.height=t,this.depth=r,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=r,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;let t=Object.assign({},e.texture.image);return this.texture.source=new fj(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}},pj=class extends Oi{constructor(e=null,t=1,r=1,i=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:r,depth:i},this.magFilter=Hr,this.minFilter=Hr,this.wrapR=Si,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},Hve=class extends Oi{constructor(e=null,t=1,r=1,i=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:r,depth:i},this.magFilter=Hr,this.minFilter=Hr,this.wrapR=Si,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},Wve=class extends Ur{constructor(e=1,t=1,r=1,i={}){super(e,t,i),this.isWebGLMultipleRenderTargets=!0;let n=this.texture;this.texture=[];for(let a=0;a<r;a++)this.texture[a]=n.clone(),this.texture[a].isRenderTargetTexture=!0}setSize(e,t,r=1){if(this.width!==e||this.height!==t||this.depth!==r){this.width=e,this.height=t,this.depth=r;for(let i=0,n=this.texture.length;i<n;i++)this.texture[i].image.width=e,this.texture[i].image.height=t,this.texture[i].image.depth=r;this.dispose()}return this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t),this}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.texture.length=0;for(let t=0,r=e.texture.length;t<r;t++)this.texture[t]=e.texture[t].clone(),this.texture[t].isRenderTargetTexture=!0;return this}},Xt=class{constructor(e=0,t=0,r=0,i=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=r,this._w=i}static slerpFlat(e,t,r,i,n,a,o){let s=r[i+0],l=r[i+1],c=r[i+2],d=r[i+3],u=n[a+0],h=n[a+1],f=n[a+2],p=n[a+3];if(o===0){e[t+0]=s,e[t+1]=l,e[t+2]=c,e[t+3]=d;return}if(o===1){e[t+0]=u,e[t+1]=h,e[t+2]=f,e[t+3]=p;return}if(d!==p||s!==u||l!==h||c!==f){let v=1-o,m=s*u+l*h+c*f+d*p,g=m>=0?1:-1,y=1-m*m;if(y>Number.EPSILON){let x=Math.sqrt(y),S=Math.atan2(x,m*g);v=Math.sin(v*S)/x,o=Math.sin(o*S)/x}let b=o*g;if(s=s*v+u*b,l=l*v+h*b,c=c*v+f*b,d=d*v+p*b,v===1-o){let x=1/Math.sqrt(s*s+l*l+c*c+d*d);s*=x,l*=x,c*=x,d*=x}}e[t]=s,e[t+1]=l,e[t+2]=c,e[t+3]=d}static multiplyQuaternionsFlat(e,t,r,i,n,a){let o=r[i],s=r[i+1],l=r[i+2],c=r[i+3],d=n[a],u=n[a+1],h=n[a+2],f=n[a+3];return e[t]=o*f+c*d+s*h-l*u,e[t+1]=s*f+c*u+l*d-o*h,e[t+2]=l*f+c*h+o*u-s*d,e[t+3]=c*f-o*d-s*u-l*h,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,r,i){return this._x=e,this._y=t,this._z=r,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){let r=e._x,i=e._y,n=e._z,a=e._order,o=Math.cos,s=Math.sin,l=o(r/2),c=o(i/2),d=o(n/2),u=s(r/2),h=s(i/2),f=s(n/2);switch(a){case"XYZ":this._x=u*c*d+l*h*f,this._y=l*h*d-u*c*f,this._z=l*c*f+u*h*d,this._w=l*c*d-u*h*f;break;case"YXZ":this._x=u*c*d+l*h*f,this._y=l*h*d-u*c*f,this._z=l*c*f-u*h*d,this._w=l*c*d+u*h*f;break;case"ZXY":this._x=u*c*d-l*h*f,this._y=l*h*d+u*c*f,this._z=l*c*f+u*h*d,this._w=l*c*d-u*h*f;break;case"ZYX":this._x=u*c*d-l*h*f,this._y=l*h*d+u*c*f,this._z=l*c*f-u*h*d,this._w=l*c*d+u*h*f;break;case"YZX":this._x=u*c*d+l*h*f,this._y=l*h*d+u*c*f,this._z=l*c*f-u*h*d,this._w=l*c*d-u*h*f;break;case"XZY":this._x=u*c*d-l*h*f,this._y=l*h*d-u*c*f,this._z=l*c*f+u*h*d,this._w=l*c*d+u*h*f;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return t!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,t){let r=t/2,i=Math.sin(r);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){let t=e.elements,r=t[0],i=t[4],n=t[8],a=t[1],o=t[5],s=t[9],l=t[2],c=t[6],d=t[10],u=r+o+d;if(u>0){let h=.5/Math.sqrt(u+1);this._w=.25/h,this._x=(c-s)*h,this._y=(n-l)*h,this._z=(a-i)*h}else if(r>o&&r>d){let h=2*Math.sqrt(1+r-o-d);this._w=(c-s)/h,this._x=.25*h,this._y=(i+a)/h,this._z=(n+l)/h}else if(o>d){let h=2*Math.sqrt(1+o-r-d);this._w=(n-l)/h,this._x=(i+a)/h,this._y=.25*h,this._z=(s+c)/h}else{let h=2*Math.sqrt(1+d-r-o);this._w=(a-i)/h,this._x=(n+l)/h,this._y=(s+c)/h,this._z=.25*h}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let r=e.dot(t)+1;return r<Number.EPSILON?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(nn(this.dot(e),-1,1)))}rotateTowards(e,t){let r=this.angleTo(e);if(r===0)return this;let i=Math.min(1,t/r);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){let r=e._x,i=e._y,n=e._z,a=e._w,o=t._x,s=t._y,l=t._z,c=t._w;return this._x=r*c+a*o+i*l-n*s,this._y=i*c+a*s+n*o-r*l,this._z=n*c+a*l+r*s-i*o,this._w=a*c-r*o-i*s-n*l,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);let r=this._x,i=this._y,n=this._z,a=this._w,o=a*e._w+r*e._x+i*e._y+n*e._z;if(o<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),o>=1)return this._w=a,this._x=r,this._y=i,this._z=n,this;let s=1-o*o;if(s<=Number.EPSILON){let h=1-t;return this._w=h*a+t*this._w,this._x=h*r+t*this._x,this._y=h*i+t*this._y,this._z=h*n+t*this._z,this.normalize(),this._onChangeCallback(),this}let l=Math.sqrt(s),c=Math.atan2(l,o),d=Math.sin((1-t)*c)/l,u=Math.sin(t*c)/l;return this._w=a*d+this._w*u,this._x=r*d+this._x*u,this._y=i*d+this._y*u,this._z=n*d+this._z*u,this._onChangeCallback(),this}slerpQuaternions(e,t,r){return this.copy(e).slerp(t,r)}random(){let e=Math.random(),t=Math.sqrt(1-e),r=Math.sqrt(e),i=2*Math.PI*Math.random(),n=2*Math.PI*Math.random();return this.set(t*Math.cos(i),r*Math.sin(n),r*Math.cos(n),t*Math.sin(i))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}},k=class{constructor(e=0,t=0,r=0){k.prototype.isVector3=!0,this.x=e,this.y=t,this.z=r}set(e,t,r){return r===void 0&&(r=this.z),this.x=e,this.y=t,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(PI.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(PI.setFromAxisAngle(e,t))}applyMatrix3(e){let t=this.x,r=this.y,i=this.z,n=e.elements;return this.x=n[0]*t+n[3]*r+n[6]*i,this.y=n[1]*t+n[4]*r+n[7]*i,this.z=n[2]*t+n[5]*r+n[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){let t=this.x,r=this.y,i=this.z,n=e.elements,a=1/(n[3]*t+n[7]*r+n[11]*i+n[15]);return this.x=(n[0]*t+n[4]*r+n[8]*i+n[12])*a,this.y=(n[1]*t+n[5]*r+n[9]*i+n[13])*a,this.z=(n[2]*t+n[6]*r+n[10]*i+n[14])*a,this}applyQuaternion(e){let t=this.x,r=this.y,i=this.z,n=e.x,a=e.y,o=e.z,s=e.w,l=s*t+a*i-o*r,c=s*r+o*t-n*i,d=s*i+n*r-a*t,u=-n*t-a*r-o*i;return this.x=l*s+u*-n+c*-o-d*-a,this.y=c*s+u*-a+d*-n-l*-o,this.z=d*s+u*-o+l*-a-c*-n,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){let t=this.x,r=this.y,i=this.z,n=e.elements;return this.x=n[0]*t+n[4]*r+n[8]*i,this.y=n[1]*t+n[5]*r+n[9]*i,this.z=n[2]*t+n[6]*r+n[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){let r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){let r=e.x,i=e.y,n=e.z,a=t.x,o=t.y,s=t.z;return this.x=i*s-n*o,this.y=n*a-r*s,this.z=r*o-i*a,this}projectOnVector(e){let t=e.lengthSq();if(t===0)return this.set(0,0,0);let r=e.dot(this)/t;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return NS.copy(this).projectOnVector(e),this.sub(NS)}reflect(e){return this.sub(NS.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){let t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;let r=this.dot(e)/t;return Math.acos(nn(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,r=this.y-e.y,i=this.z-e.z;return t*t+r*r+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,r){let i=Math.sin(t)*e;return this.x=i*Math.sin(r),this.y=Math.cos(t)*e,this.z=i*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,r){return this.x=e*Math.sin(t),this.y=r,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){let t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){let t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=r,this.z=i,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){let e=(Math.random()-.5)*2,t=Math.random()*Math.PI*2,r=Math.sqrt(1-e**2);return this.x=r*Math.cos(t),this.y=r*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}},NS=new k,PI=new Xt,Zi=class{constructor(e=new k(1/0,1/0,1/0),t=new k(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,r=1/0,i=1/0,n=-1/0,a=-1/0,o=-1/0;for(let s=0,l=e.length;s<l;s+=3){let c=e[s],d=e[s+1],u=e[s+2];c<t&&(t=c),d<r&&(r=d),u<i&&(i=u),c>n&&(n=c),d>a&&(a=d),u>o&&(o=u)}return this.min.set(t,r,i),this.max.set(n,a,o),this}setFromBufferAttribute(e){let t=1/0,r=1/0,i=1/0,n=-1/0,a=-1/0,o=-1/0;for(let s=0,l=e.count;s<l;s++){let c=e.getX(s),d=e.getY(s),u=e.getZ(s);c<t&&(t=c),d<r&&(r=d),u<i&&(i=u),c>n&&(n=c),d>a&&(a=d),u>o&&(o=u)}return this.min.set(t,r,i),this.max.set(n,a,o),this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let r=Yd.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);let r=e.geometry;if(r!==void 0)if(t&&r.attributes!=null&&r.attributes.position!==void 0){let n=r.attributes.position;for(let a=0,o=n.count;a<o;a++)Yd.fromBufferAttribute(n,a).applyMatrix4(e.matrixWorld),this.expandByPoint(Yd)}else r.boundingBox===null&&r.computeBoundingBox(),US.copy(r.boundingBox),US.applyMatrix4(e.matrixWorld),this.union(US);let i=e.children;for(let n=0,a=i.length;n<a;n++)this.expandByObject(i[n],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Yd),Yd.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,r;return e.normal.x>0?(t=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),t<=-e.constant&&r>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(gm),B0.subVectors(this.max,gm),Nh.subVectors(e.a,gm),Uh.subVectors(e.b,gm),jh.subVectors(e.c,gm),_c.subVectors(Uh,Nh),Ac.subVectors(jh,Uh),Xd.subVectors(Nh,jh);let t=[0,-_c.z,_c.y,0,-Ac.z,Ac.y,0,-Xd.z,Xd.y,_c.z,0,-_c.x,Ac.z,0,-Ac.x,Xd.z,0,-Xd.x,-_c.y,_c.x,0,-Ac.y,Ac.x,0,-Xd.y,Xd.x,0];return!jS(t,Nh,Uh,jh,B0)||(t=[1,0,0,0,1,0,0,0,1],!jS(t,Nh,Uh,jh,B0))?!1:(F0.crossVectors(_c,Ac),t=[F0.x,F0.y,F0.z],jS(t,Nh,Uh,jh,B0))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return Yd.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=this.getSize(Yd).length()*.5,e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(yl[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),yl[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),yl[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),yl[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),yl[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),yl[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),yl[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),yl[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(yl),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}},yl=[new k,new k,new k,new k,new k,new k,new k,new k],Yd=new k,US=new Zi,Nh=new k,Uh=new k,jh=new k,_c=new k,Ac=new k,Xd=new k,gm=new k,B0=new k,F0=new k,Kd=new k;function jS(e,t,r,i,n){for(let a=0,o=e.length-3;a<=o;a+=3){Kd.fromArray(e,a);let s=n.x*Math.abs(Kd.x)+n.y*Math.abs(Kd.y)+n.z*Math.abs(Kd.z),l=t.dot(Kd),c=r.dot(Kd),d=i.dot(Kd);if(Math.max(-Math.max(l,c,d),Math.min(l,c,d))>s)return!1}return!0}var Gve=new Zi,ym=new k,VS=new k,Za=class{constructor(e=new k,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){let r=this.center;t!==void 0?r.copy(t):Gve.setFromPoints(e).getCenter(r);let i=0;for(let n=0,a=e.length;n<a;n++)i=Math.max(i,r.distanceToSquared(e[n]));return this.radius=Math.sqrt(i),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){let t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){let r=this.center.distanceToSquared(e);return t.copy(e),r>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;ym.subVectors(e,this.center);let t=ym.lengthSq();if(t>this.radius*this.radius){let r=Math.sqrt(t),i=(r-this.radius)*.5;this.center.addScaledVector(ym,i/r),this.radius+=i}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(VS.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(ym.copy(e.center).add(VS)),this.expandByPoint(ym.copy(e.center).sub(VS))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}},bl=new k,HS=new k,N0=new k,Mc=new k,WS=new k,U0=new k,GS=new k,jp=class{constructor(e=new k,t=new k(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,bl)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);let r=t.dot(this.direction);return r<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(r).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){let t=bl.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(bl.copy(this.direction).multiplyScalar(t).add(this.origin),bl.distanceToSquared(e))}distanceSqToSegment(e,t,r,i){HS.copy(e).add(t).multiplyScalar(.5),N0.copy(t).sub(e).normalize(),Mc.copy(this.origin).sub(HS);let n=e.distanceTo(t)*.5,a=-this.direction.dot(N0),o=Mc.dot(this.direction),s=-Mc.dot(N0),l=Mc.lengthSq(),c=Math.abs(1-a*a),d,u,h,f;if(c>0)if(d=a*s-o,u=a*o-s,f=n*c,d>=0)if(u>=-f)if(u<=f){let p=1/c;d*=p,u*=p,h=d*(d+a*u+2*o)+u*(a*d+u+2*s)+l}else u=n,d=Math.max(0,-(a*u+o)),h=-d*d+u*(u+2*s)+l;else u=-n,d=Math.max(0,-(a*u+o)),h=-d*d+u*(u+2*s)+l;else u<=-f?(d=Math.max(0,-(-a*n+o)),u=d>0?-n:Math.min(Math.max(-n,-s),n),h=-d*d+u*(u+2*s)+l):u<=f?(d=0,u=Math.min(Math.max(-n,-s),n),h=u*(u+2*s)+l):(d=Math.max(0,-(a*n+o)),u=d>0?n:Math.min(Math.max(-n,-s),n),h=-d*d+u*(u+2*s)+l);else u=a>0?-n:n,d=Math.max(0,-(a*u+o)),h=-d*d+u*(u+2*s)+l;return r&&r.copy(this.direction).multiplyScalar(d).add(this.origin),i&&i.copy(N0).multiplyScalar(u).add(HS),h}intersectSphere(e,t){bl.subVectors(e.center,this.origin);let r=bl.dot(this.direction),i=bl.dot(bl)-r*r,n=e.radius*e.radius;if(i>n)return null;let a=Math.sqrt(n-i),o=r-a,s=r+a;return o<0&&s<0?null:o<0?this.at(s,t):this.at(o,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){let t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;let r=-(this.origin.dot(e.normal)+e.constant)/t;return r>=0?r:null}intersectPlane(e,t){let r=this.distanceToPlane(e);return r===null?null:this.at(r,t)}intersectsPlane(e){let t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let r,i,n,a,o,s,l=1/this.direction.x,c=1/this.direction.y,d=1/this.direction.z,u=this.origin;return l>=0?(r=(e.min.x-u.x)*l,i=(e.max.x-u.x)*l):(r=(e.max.x-u.x)*l,i=(e.min.x-u.x)*l),c>=0?(n=(e.min.y-u.y)*c,a=(e.max.y-u.y)*c):(n=(e.max.y-u.y)*c,a=(e.min.y-u.y)*c),r>a||n>i||((n>r||isNaN(r))&&(r=n),(a<i||isNaN(i))&&(i=a),d>=0?(o=(e.min.z-u.z)*d,s=(e.max.z-u.z)*d):(o=(e.max.z-u.z)*d,s=(e.min.z-u.z)*d),r>s||o>i)||((o>r||r!==r)&&(r=o),(s<i||i!==i)&&(i=s),i<0)?null:this.at(r>=0?r:i,t)}intersectsBox(e){return this.intersectBox(e,bl)!==null}intersectTriangle(e,t,r,i,n){WS.subVectors(t,e),U0.subVectors(r,e),GS.crossVectors(WS,U0);let a=this.direction.dot(GS),o;if(a>0){if(i)return null;o=1}else if(a<0)o=-1,a=-a;else return null;Mc.subVectors(this.origin,e);let s=o*this.direction.dot(U0.crossVectors(Mc,U0));if(s<0)return null;let l=o*this.direction.dot(WS.cross(Mc));if(l<0||s+l>a)return null;let c=-o*Mc.dot(GS);return c<0?null:this.at(c/a,n)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}},it=class{constructor(){it.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(e,t,r,i,n,a,o,s,l,c,d,u,h,f,p,v){let m=this.elements;return m[0]=e,m[4]=t,m[8]=r,m[12]=i,m[1]=n,m[5]=a,m[9]=o,m[13]=s,m[2]=l,m[6]=c,m[10]=d,m[14]=u,m[3]=h,m[7]=f,m[11]=p,m[15]=v,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new it().fromArray(this.elements)}copy(e){let t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],this}copyPosition(e){let t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this}setFromMatrix3(e){let t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,r){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this}extractRotation(e){let t=this.elements,r=e.elements,i=1/Vh.setFromMatrixColumn(e,0).length(),n=1/Vh.setFromMatrixColumn(e,1).length(),a=1/Vh.setFromMatrixColumn(e,2).length();return t[0]=r[0]*i,t[1]=r[1]*i,t[2]=r[2]*i,t[3]=0,t[4]=r[4]*n,t[5]=r[5]*n,t[6]=r[6]*n,t[7]=0,t[8]=r[8]*a,t[9]=r[9]*a,t[10]=r[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){let t=this.elements,r=e.x,i=e.y,n=e.z,a=Math.cos(r),o=Math.sin(r),s=Math.cos(i),l=Math.sin(i),c=Math.cos(n),d=Math.sin(n);if(e.order==="XYZ"){let u=a*c,h=a*d,f=o*c,p=o*d;t[0]=s*c,t[4]=-s*d,t[8]=l,t[1]=h+f*l,t[5]=u-p*l,t[9]=-o*s,t[2]=p-u*l,t[6]=f+h*l,t[10]=a*s}else if(e.order==="YXZ"){let u=s*c,h=s*d,f=l*c,p=l*d;t[0]=u+p*o,t[4]=f*o-h,t[8]=a*l,t[1]=a*d,t[5]=a*c,t[9]=-o,t[2]=h*o-f,t[6]=p+u*o,t[10]=a*s}else if(e.order==="ZXY"){let u=s*c,h=s*d,f=l*c,p=l*d;t[0]=u-p*o,t[4]=-a*d,t[8]=f+h*o,t[1]=h+f*o,t[5]=a*c,t[9]=p-u*o,t[2]=-a*l,t[6]=o,t[10]=a*s}else if(e.order==="ZYX"){let u=a*c,h=a*d,f=o*c,p=o*d;t[0]=s*c,t[4]=f*l-h,t[8]=u*l+p,t[1]=s*d,t[5]=p*l+u,t[9]=h*l-f,t[2]=-l,t[6]=o*s,t[10]=a*s}else if(e.order==="YZX"){let u=a*s,h=a*l,f=o*s,p=o*l;t[0]=s*c,t[4]=p-u*d,t[8]=f*d+h,t[1]=d,t[5]=a*c,t[9]=-o*c,t[2]=-l*c,t[6]=h*d+f,t[10]=u-p*d}else if(e.order==="XZY"){let u=a*s,h=a*l,f=o*s,p=o*l;t[0]=s*c,t[4]=-d,t[8]=l*c,t[1]=u*d+p,t[5]=a*c,t[9]=h*d-f,t[2]=f*d-h,t[6]=o*c,t[10]=p*d+u}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose($ve,e,qve)}lookAt(e,t,r){let i=this.elements;return io.subVectors(e,t),io.lengthSq()===0&&(io.z=1),io.normalize(),Ec.crossVectors(r,io),Ec.lengthSq()===0&&(Math.abs(r.z)===1?io.x+=1e-4:io.z+=1e-4,io.normalize(),Ec.crossVectors(r,io)),Ec.normalize(),j0.crossVectors(io,Ec),i[0]=Ec.x,i[4]=j0.x,i[8]=io.x,i[1]=Ec.y,i[5]=j0.y,i[9]=io.y,i[2]=Ec.z,i[6]=j0.z,i[10]=io.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let r=e.elements,i=t.elements,n=this.elements,a=r[0],o=r[4],s=r[8],l=r[12],c=r[1],d=r[5],u=r[9],h=r[13],f=r[2],p=r[6],v=r[10],m=r[14],g=r[3],y=r[7],b=r[11],x=r[15],S=i[0],w=i[4],_=i[8],C=i[12],A=i[1],M=i[5],P=i[9],T=i[13],R=i[2],z=i[6],F=i[10],H=i[14],N=i[3],U=i[7],ie=i[11],te=i[15];return n[0]=a*S+o*A+s*R+l*N,n[4]=a*w+o*M+s*z+l*U,n[8]=a*_+o*P+s*F+l*ie,n[12]=a*C+o*T+s*H+l*te,n[1]=c*S+d*A+u*R+h*N,n[5]=c*w+d*M+u*z+h*U,n[9]=c*_+d*P+u*F+h*ie,n[13]=c*C+d*T+u*H+h*te,n[2]=f*S+p*A+v*R+m*N,n[6]=f*w+p*M+v*z+m*U,n[10]=f*_+p*P+v*F+m*ie,n[14]=f*C+p*T+v*H+m*te,n[3]=g*S+y*A+b*R+x*N,n[7]=g*w+y*M+b*z+x*U,n[11]=g*_+y*P+b*F+x*ie,n[15]=g*C+y*T+b*H+x*te,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){let e=this.elements,t=e[0],r=e[4],i=e[8],n=e[12],a=e[1],o=e[5],s=e[9],l=e[13],c=e[2],d=e[6],u=e[10],h=e[14],f=e[3],p=e[7],v=e[11],m=e[15];return f*(+n*s*d-i*l*d-n*o*u+r*l*u+i*o*h-r*s*h)+p*(+t*s*h-t*l*u+n*a*u-i*a*h+i*l*c-n*s*c)+v*(+t*l*d-t*o*h-n*a*d+r*a*h+n*o*c-r*l*c)+m*(-i*o*c-t*s*d+t*o*u+i*a*d-r*a*u+r*s*c)}transpose(){let e=this.elements,t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,r){let i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=t,i[14]=r),this}invert(){let e=this.elements,t=e[0],r=e[1],i=e[2],n=e[3],a=e[4],o=e[5],s=e[6],l=e[7],c=e[8],d=e[9],u=e[10],h=e[11],f=e[12],p=e[13],v=e[14],m=e[15],g=d*v*l-p*u*l+p*s*h-o*v*h-d*s*m+o*u*m,y=f*u*l-c*v*l-f*s*h+a*v*h+c*s*m-a*u*m,b=c*p*l-f*d*l+f*o*h-a*p*h-c*o*m+a*d*m,x=f*d*s-c*p*s-f*o*u+a*p*u+c*o*v-a*d*v,S=t*g+r*y+i*b+n*x;if(S===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let w=1/S;return e[0]=g*w,e[1]=(p*u*n-d*v*n-p*i*h+r*v*h+d*i*m-r*u*m)*w,e[2]=(o*v*n-p*s*n+p*i*l-r*v*l-o*i*m+r*s*m)*w,e[3]=(d*s*n-o*u*n-d*i*l+r*u*l+o*i*h-r*s*h)*w,e[4]=y*w,e[5]=(c*v*n-f*u*n+f*i*h-t*v*h-c*i*m+t*u*m)*w,e[6]=(f*s*n-a*v*n-f*i*l+t*v*l+a*i*m-t*s*m)*w,e[7]=(a*u*n-c*s*n+c*i*l-t*u*l-a*i*h+t*s*h)*w,e[8]=b*w,e[9]=(f*d*n-c*p*n-f*r*h+t*p*h+c*r*m-t*d*m)*w,e[10]=(a*p*n-f*o*n+f*r*l-t*p*l-a*r*m+t*o*m)*w,e[11]=(c*o*n-a*d*n-c*r*l+t*d*l+a*r*h-t*o*h)*w,e[12]=x*w,e[13]=(c*p*i-f*d*i+f*r*u-t*p*u-c*r*v+t*d*v)*w,e[14]=(f*o*i-a*p*i-f*r*s+t*p*s+a*r*v-t*o*v)*w,e[15]=(a*d*i-c*o*i+c*r*s-t*d*s-a*r*u+t*o*u)*w,this}scale(e){let t=this.elements,r=e.x,i=e.y,n=e.z;return t[0]*=r,t[4]*=i,t[8]*=n,t[1]*=r,t[5]*=i,t[9]*=n,t[2]*=r,t[6]*=i,t[10]*=n,t[3]*=r,t[7]*=i,t[11]*=n,this}getMaxScaleOnAxis(){let e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,r,i))}makeTranslation(e,t,r){return this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this}makeRotationX(e){let t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this}makeRotationY(e){let t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this}makeRotationZ(e){let t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){let r=Math.cos(t),i=Math.sin(t),n=1-r,a=e.x,o=e.y,s=e.z,l=n*a,c=n*o;return this.set(l*a+r,l*o-i*s,l*s+i*o,0,l*o+i*s,c*o+r,c*s-i*a,0,l*s-i*o,c*s+i*a,n*s*s+r,0,0,0,0,1),this}makeScale(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,t,r,i,n,a){return this.set(1,r,n,0,e,1,a,0,t,i,1,0,0,0,0,1),this}compose(e,t,r){let i=this.elements,n=t._x,a=t._y,o=t._z,s=t._w,l=n+n,c=a+a,d=o+o,u=n*l,h=n*c,f=n*d,p=a*c,v=a*d,m=o*d,g=s*l,y=s*c,b=s*d,x=r.x,S=r.y,w=r.z;return i[0]=(1-(p+m))*x,i[1]=(h+b)*x,i[2]=(f-y)*x,i[3]=0,i[4]=(h-b)*S,i[5]=(1-(u+m))*S,i[6]=(v+g)*S,i[7]=0,i[8]=(f+y)*w,i[9]=(v-g)*w,i[10]=(1-(u+p))*w,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}decompose(e,t,r){let i=this.elements,n=Vh.set(i[0],i[1],i[2]).length(),a=Vh.set(i[4],i[5],i[6]).length(),o=Vh.set(i[8],i[9],i[10]).length();this.determinant()<0&&(n=-n),e.x=i[12],e.y=i[13],e.z=i[14],Ho.copy(this);let s=1/n,l=1/a,c=1/o;return Ho.elements[0]*=s,Ho.elements[1]*=s,Ho.elements[2]*=s,Ho.elements[4]*=l,Ho.elements[5]*=l,Ho.elements[6]*=l,Ho.elements[8]*=c,Ho.elements[9]*=c,Ho.elements[10]*=c,t.setFromRotationMatrix(Ho),r.x=n,r.y=a,r.z=o,this}makePerspective(e,t,r,i,n,a){let o=this.elements,s=2*n/(t-e),l=2*n/(r-i),c=(t+e)/(t-e),d=(r+i)/(r-i),u=-(a+n)/(a-n),h=-2*a*n/(a-n);return o[0]=s,o[4]=0,o[8]=c,o[12]=0,o[1]=0,o[5]=l,o[9]=d,o[13]=0,o[2]=0,o[6]=0,o[10]=u,o[14]=h,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this}makeOrthographic(e,t,r,i,n,a){let o=this.elements,s=1/(t-e),l=1/(r-i),c=1/(a-n),d=(t+e)*s,u=(r+i)*l,h=(a+n)*c;return o[0]=2*s,o[4]=0,o[8]=0,o[12]=-d,o[1]=0,o[5]=2*l,o[9]=0,o[13]=-u,o[2]=0,o[6]=0,o[10]=-2*c,o[14]=-h,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this}equals(e){let t=this.elements,r=e.elements;for(let i=0;i<16;i++)if(t[i]!==r[i])return!1;return!0}fromArray(e,t=0){for(let r=0;r<16;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){let r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e}},Vh=new k,Ho=new it,$ve=new k(0,0,0),qve=new k(1,1,1),Ec=new k,j0=new k,io=new k,DI=new it,OI=new Xt,vn=class{constructor(e=0,t=0,r=0,i=vn.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=r,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,r,i=this._order){return this._x=e,this._y=t,this._z=r,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,r=!0){let i=e.elements,n=i[0],a=i[4],o=i[8],s=i[1],l=i[5],c=i[9],d=i[2],u=i[6],h=i[10];switch(t){case"XYZ":this._y=Math.asin(nn(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-c,h),this._z=Math.atan2(-a,n)):(this._x=Math.atan2(u,l),this._z=0);break;case"YXZ":this._x=Math.asin(-nn(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(o,h),this._z=Math.atan2(s,l)):(this._y=Math.atan2(-d,n),this._z=0);break;case"ZXY":this._x=Math.asin(nn(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(-d,h),this._z=Math.atan2(-a,l)):(this._y=0,this._z=Math.atan2(s,n));break;case"ZYX":this._y=Math.asin(-nn(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(u,h),this._z=Math.atan2(s,n)):(this._x=0,this._z=Math.atan2(-a,l));break;case"YZX":this._z=Math.asin(nn(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-d,n)):(this._x=0,this._y=Math.atan2(o,h));break;case"XZY":this._z=Math.asin(-nn(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(u,l),this._y=Math.atan2(o,n)):(this._x=Math.atan2(-c,h),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,r===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,r){return DI.makeRotationFromQuaternion(e),this.setFromRotationMatrix(DI,t,r)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return OI.setFromEuler(this),this.setFromQuaternion(OI,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}};vn.DEFAULT_ORDER="XYZ";var eP=class{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}},Yve=0,RI=new k,Hh=new Xt,xl=new it,V0=new k,bm=new k,Xve=new k,Kve=new Xt,II=new k(1,0,0),zI=new k(0,1,0),kI=new k(0,0,1),Qve={type:"added"},LI={type:"removed"},Yr=class extends aa{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Yve++}),this.uuid=Io(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Yr.DEFAULT_UP.clone();let e=new k,t=new vn,r=new Xt,i=new k(1,1,1);function n(){r.setFromEuler(t,!1)}function a(){t.setFromQuaternion(r,void 0,!1)}t._onChange(n),r._onChange(a),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new it},normalMatrix:{value:new sn}}),this.matrix=new it,this.matrixWorld=new it,this.matrixAutoUpdate=Yr.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=Yr.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new eP,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return Hh.setFromAxisAngle(e,t),this.quaternion.multiply(Hh),this}rotateOnWorldAxis(e,t){return Hh.setFromAxisAngle(e,t),this.quaternion.premultiply(Hh),this}rotateX(e){return this.rotateOnAxis(II,e)}rotateY(e){return this.rotateOnAxis(zI,e)}rotateZ(e){return this.rotateOnAxis(kI,e)}translateOnAxis(e,t){return RI.copy(e).applyQuaternion(this.quaternion),this.position.add(RI.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(II,e)}translateY(e){return this.translateOnAxis(zI,e)}translateZ(e){return this.translateOnAxis(kI,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(xl.copy(this.matrixWorld).invert())}lookAt(e,t,r){e.isVector3?V0.copy(e):V0.set(e,t,r);let i=this.parent;this.updateWorldMatrix(!0,!1),bm.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?xl.lookAt(bm,V0,this.up):xl.lookAt(V0,bm,this.up),this.quaternion.setFromRotationMatrix(xl),i&&(xl.extractRotation(i.matrixWorld),Hh.setFromRotationMatrix(xl),this.quaternion.premultiply(Hh.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(Qve)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}let t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(LI)),this}removeFromParent(){let e=this.parent;return e!==null&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){let t=this.children[e];t.parent=null,t.dispatchEvent(LI)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),xl.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),xl.multiply(e.parent.matrixWorld)),e.applyMatrix4(xl),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let r=0,i=this.children.length;r<i;r++){let n=this.children[r].getObjectByProperty(e,t);if(n!==void 0)return n}}getObjectsByProperty(e,t){let r=[];this[e]===t&&r.push(this);for(let i=0,n=this.children.length;i<n;i++){let a=this.children[i].getObjectsByProperty(e,t);a.length>0&&(r=r.concat(a))}return r}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(bm,e,Xve),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(bm,Kve,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);let t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);let t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);let t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].traverseVisible(e)}traverseAncestors(e){let t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);let t=this.children;for(let r=0,i=t.length;r<i;r++){let n=t[r];(n.matrixWorldAutoUpdate===!0||e===!0)&&n.updateMatrixWorld(e)}}updateWorldMatrix(e,t){let r=this.parent;if(e===!0&&r!==null&&r.matrixWorldAutoUpdate===!0&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){let i=this.children;for(let n=0,a=i.length;n<a;n++){let o=i[n];o.matrixWorldAutoUpdate===!0&&o.updateWorldMatrix(!1,!0)}}}toJSON(e){let t=e===void 0||typeof e=="string",r={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});let i={};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.castShadow===!0&&(i.castShadow=!0),this.receiveShadow===!0&&(i.receiveShadow=!0),this.visible===!1&&(i.visible=!1),this.frustumCulled===!1&&(i.frustumCulled=!1),this.renderOrder!==0&&(i.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(i.instanceColor=this.instanceColor.toJSON()));function n(o,s){return o[s.uuid]===void 0&&(o[s.uuid]=s.toJSON(e)),s.uuid}if(this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(i.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=n(e.geometries,this.geometry);let o=this.geometry.parameters;if(o!==void 0&&o.shapes!==void 0){let s=o.shapes;if(Array.isArray(s))for(let l=0,c=s.length;l<c;l++){let d=s[l];n(e.shapes,d)}else n(e.shapes,s)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(n(e.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){let o=[];for(let s=0,l=this.material.length;s<l;s++)o.push(n(e.materials,this.material[s]));i.material=o}else i.material=n(e.materials,this.material);if(this.children.length>0){i.children=[];for(let o=0;o<this.children.length;o++)i.children.push(this.children[o].toJSON(e).object)}if(this.animations.length>0){i.animations=[];for(let o=0;o<this.animations.length;o++){let s=this.animations[o];i.animations.push(n(e.animations,s))}}if(t){let o=a(e.geometries),s=a(e.materials),l=a(e.textures),c=a(e.images),d=a(e.shapes),u=a(e.skeletons),h=a(e.animations),f=a(e.nodes);o.length>0&&(r.geometries=o),s.length>0&&(r.materials=s),l.length>0&&(r.textures=l),c.length>0&&(r.images=c),d.length>0&&(r.shapes=d),u.length>0&&(r.skeletons=u),h.length>0&&(r.animations=h),f.length>0&&(r.nodes=f)}return r.object=i,r;function a(o){let s=[];for(let l in o){let c=o[l];delete c.metadata,s.push(c)}return s}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let r=0;r<e.children.length;r++){let i=e.children[r];this.add(i.clone())}return this}};Yr.DEFAULT_UP=new k(0,1,0);Yr.DEFAULT_MATRIX_AUTO_UPDATE=!0;Yr.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;var Wo=new k,wl=new k,$S=new k,Sl=new k,Wh=new k,Gh=new k,BI=new k,qS=new k,YS=new k,XS=new k,Zn=class{constructor(e=new k,t=new k,r=new k){this.a=e,this.b=t,this.c=r}static getNormal(e,t,r,i){i.subVectors(r,t),Wo.subVectors(e,t),i.cross(Wo);let n=i.lengthSq();return n>0?i.multiplyScalar(1/Math.sqrt(n)):i.set(0,0,0)}static getBarycoord(e,t,r,i,n){Wo.subVectors(i,t),wl.subVectors(r,t),$S.subVectors(e,t);let a=Wo.dot(Wo),o=Wo.dot(wl),s=Wo.dot($S),l=wl.dot(wl),c=wl.dot($S),d=a*l-o*o;if(d===0)return n.set(-2,-1,-1);let u=1/d,h=(l*s-o*c)*u,f=(a*c-o*s)*u;return n.set(1-h-f,f,h)}static containsPoint(e,t,r,i){return this.getBarycoord(e,t,r,i,Sl),Sl.x>=0&&Sl.y>=0&&Sl.x+Sl.y<=1}static getUV(e,t,r,i,n,a,o,s){return this.getBarycoord(e,t,r,i,Sl),s.set(0,0),s.addScaledVector(n,Sl.x),s.addScaledVector(a,Sl.y),s.addScaledVector(o,Sl.z),s}static isFrontFacing(e,t,r,i){return Wo.subVectors(r,t),wl.subVectors(e,t),Wo.cross(wl).dot(i)<0}set(e,t,r){return this.a.copy(e),this.b.copy(t),this.c.copy(r),this}setFromPointsAndIndices(e,t,r,i){return this.a.copy(e[t]),this.b.copy(e[r]),this.c.copy(e[i]),this}setFromAttributeAndIndices(e,t,r,i){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,r),this.c.fromBufferAttribute(e,i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Wo.subVectors(this.c,this.b),wl.subVectors(this.a,this.b),Wo.cross(wl).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Zn.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Zn.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,r,i,n){return Zn.getUV(e,this.a,this.b,this.c,t,r,i,n)}containsPoint(e){return Zn.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Zn.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){let r=this.a,i=this.b,n=this.c,a,o;Wh.subVectors(i,r),Gh.subVectors(n,r),qS.subVectors(e,r);let s=Wh.dot(qS),l=Gh.dot(qS);if(s<=0&&l<=0)return t.copy(r);YS.subVectors(e,i);let c=Wh.dot(YS),d=Gh.dot(YS);if(c>=0&&d<=c)return t.copy(i);let u=s*d-c*l;if(u<=0&&s>=0&&c<=0)return a=s/(s-c),t.copy(r).addScaledVector(Wh,a);XS.subVectors(e,n);let h=Wh.dot(XS),f=Gh.dot(XS);if(f>=0&&h<=f)return t.copy(n);let p=h*l-s*f;if(p<=0&&l>=0&&f<=0)return o=l/(l-f),t.copy(r).addScaledVector(Gh,o);let v=c*f-h*d;if(v<=0&&d-c>=0&&h-f>=0)return BI.subVectors(n,i),o=(d-c)/(d-c+(h-f)),t.copy(i).addScaledVector(BI,o);let m=1/(v+p+u);return a=p*m,o=u*m,t.copy(r).addScaledVector(Wh,a).addScaledVector(Gh,o)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}},Zve=0,Wg=class extends aa{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:Zve++}),this.uuid=Io(),this.name="",this.type="Material",this.blending=Fu,this.side=us,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=ej,this.blendDst=tj,this.blendEquation=yf,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=AA,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Mve,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=zS,this.stencilZFail=zS,this.stencilZPass=zS,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(let t in e){let r=e[t];if(r===void 0){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}let i=this[t];if(i===void 0){console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.");continue}i&&i.isColor?i.set(r):i&&i.isVector3&&r&&r.isVector3?i.copy(r):this[t]=r}}toJSON(e){let t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});let r={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),this.roughness!==void 0&&(r.roughness=this.roughness),this.metalness!==void 0&&(r.metalness=this.metalness),this.sheen!==void 0&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(r.shininess=this.shininess),this.clearcoat!==void 0&&(r.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(r.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(r.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(r.combine=this.combine)),this.envMapIntensity!==void 0&&(r.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(r.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(r.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(r.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(r.size=this.size),this.shadowSide!==null&&(r.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==Fu&&(r.blending=this.blending),this.side!==us&&(r.side=this.side),this.vertexColors&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),this.transparent===!0&&(r.transparent=this.transparent),r.depthFunc=this.depthFunc,r.depthTest=this.depthTest,r.depthWrite=this.depthWrite,r.colorWrite=this.colorWrite,r.stencilWrite=this.stencilWrite,r.stencilWriteMask=this.stencilWriteMask,r.stencilFunc=this.stencilFunc,r.stencilRef=this.stencilRef,r.stencilFuncMask=this.stencilFuncMask,r.stencilFail=this.stencilFail,r.stencilZFail=this.stencilZFail,r.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(r.rotation=this.rotation),this.polygonOffset===!0&&(r.polygonOffset=!0),this.polygonOffsetFactor!==0&&(r.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(r.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(r.linewidth=this.linewidth),this.dashSize!==void 0&&(r.dashSize=this.dashSize),this.gapSize!==void 0&&(r.gapSize=this.gapSize),this.scale!==void 0&&(r.scale=this.scale),this.dithering===!0&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(r.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(r.premultipliedAlpha=this.premultipliedAlpha),this.forceSinglePass===!0&&(r.forceSinglePass=this.forceSinglePass),this.wireframe===!0&&(r.wireframe=this.wireframe),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(r.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(r.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(r.flatShading=this.flatShading),this.visible===!1&&(r.visible=!1),this.toneMapped===!1&&(r.toneMapped=!1),this.fog===!1&&(r.fog=!1),Object.keys(this.userData).length>0&&(r.userData=this.userData);function i(n){let a=[];for(let o in n){let s=n[o];delete s.metadata,a.push(s)}return a}if(t){let n=i(e.textures),a=i(e.images);n.length>0&&(r.textures=n),a.length>0&&(r.images=a)}return r}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;let t=e.clippingPlanes,r=null;if(t!==null){let i=t.length;r=new Array(i);for(let n=0;n!==i;++n)r[n]=t[n].clone()}return this.clippingPlanes=r,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}},tc=class extends Wg{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Lt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=rj,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}},en=new k,H0=new ye,$t=class{constructor(e,t,r=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=r,this.usage=PA,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,r){e*=this.itemSize,r*=t.itemSize;for(let i=0,n=this.itemSize;i<n;i++)this.array[e+i]=t.array[r+i];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,r=this.count;t<r;t++)H0.fromBufferAttribute(this,t),H0.applyMatrix3(e),this.setXY(t,H0.x,H0.y);else if(this.itemSize===3)for(let t=0,r=this.count;t<r;t++)en.fromBufferAttribute(this,t),en.applyMatrix3(e),this.setXYZ(t,en.x,en.y,en.z);return this}applyMatrix4(e){for(let t=0,r=this.count;t<r;t++)en.fromBufferAttribute(this,t),en.applyMatrix4(e),this.setXYZ(t,en.x,en.y,en.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)en.fromBufferAttribute(this,t),en.applyNormalMatrix(e),this.setXYZ(t,en.x,en.y,en.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)en.fromBufferAttribute(this,t),en.transformDirection(e),this.setXYZ(t,en.x,en.y,en.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Gl(t,this.array)),t}setX(e,t){return this.normalized&&(t=di(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Gl(t,this.array)),t}setY(e,t){return this.normalized&&(t=di(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Gl(t,this.array)),t}setZ(e,t){return this.normalized&&(t=di(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Gl(t,this.array)),t}setW(e,t){return this.normalized&&(t=di(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,r){return e*=this.itemSize,this.normalized&&(t=di(t,this.array),r=di(r,this.array)),this.array[e+0]=t,this.array[e+1]=r,this}setXYZ(e,t,r,i){return e*=this.itemSize,this.normalized&&(t=di(t,this.array),r=di(r,this.array),i=di(i,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=i,this}setXYZW(e,t,r,i,n){return e*=this.itemSize,this.normalized&&(t=di(t,this.array),r=di(r,this.array),i=di(i,this.array),n=di(n,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=i,this.array[e+3]=n,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){let e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==PA&&(e.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(e.updateRange=this.updateRange),e}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}},mj=class extends $t{constructor(e,t,r){super(new Uint16Array(e),t,r)}},Vf=class extends $t{constructor(e,t,r){super(new Uint32Array(e),t,r)}},yt=class extends $t{constructor(e,t,r){super(new Float32Array(e),t,r)}},Jve=0,mo=new it,KS=new Yr,$h=new k,no=new Zi,xm=new Zi,An=new k,Ot=class extends aa{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Jve++}),this.uuid=Io(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(dj(e)?Vf:mj)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,r=0){this.groups.push({start:e,count:t,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){let t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);let r=this.attributes.normal;if(r!==void 0){let n=new sn().getNormalMatrix(e);r.applyNormalMatrix(n),r.needsUpdate=!0}let i=this.attributes.tangent;return i!==void 0&&(i.transformDirection(e),i.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return mo.makeRotationFromQuaternion(e),this.applyMatrix4(mo),this}rotateX(e){return mo.makeRotationX(e),this.applyMatrix4(mo),this}rotateY(e){return mo.makeRotationY(e),this.applyMatrix4(mo),this}rotateZ(e){return mo.makeRotationZ(e),this.applyMatrix4(mo),this}translate(e,t,r){return mo.makeTranslation(e,t,r),this.applyMatrix4(mo),this}scale(e,t,r){return mo.makeScale(e,t,r),this.applyMatrix4(mo),this}lookAt(e){return KS.lookAt(e),KS.updateMatrix(),this.applyMatrix4(KS.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter($h).negate(),this.translate($h.x,$h.y,$h.z),this}setFromPoints(e){let t=[];for(let r=0,i=e.length;r<i;r++){let n=e[r];t.push(n.x,n.y,n.z||0)}return this.setAttribute("position",new yt(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Zi);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new k(-1/0,-1/0,-1/0),new k(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let r=0,i=t.length;r<i;r++){let n=t[r];no.setFromBufferAttribute(n),this.morphTargetsRelative?(An.addVectors(this.boundingBox.min,no.min),this.boundingBox.expandByPoint(An),An.addVectors(this.boundingBox.max,no.max),this.boundingBox.expandByPoint(An)):(this.boundingBox.expandByPoint(no.min),this.boundingBox.expandByPoint(no.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Za);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new k,1/0);return}if(e){let r=this.boundingSphere.center;if(no.setFromBufferAttribute(e),t)for(let n=0,a=t.length;n<a;n++){let o=t[n];xm.setFromBufferAttribute(o),this.morphTargetsRelative?(An.addVectors(no.min,xm.min),no.expandByPoint(An),An.addVectors(no.max,xm.max),no.expandByPoint(An)):(no.expandByPoint(xm.min),no.expandByPoint(xm.max))}no.getCenter(r);let i=0;for(let n=0,a=e.count;n<a;n++)An.fromBufferAttribute(e,n),i=Math.max(i,r.distanceToSquared(An));if(t)for(let n=0,a=t.length;n<a;n++){let o=t[n],s=this.morphTargetsRelative;for(let l=0,c=o.count;l<c;l++)An.fromBufferAttribute(o,l),s&&($h.fromBufferAttribute(e,l),An.add($h)),i=Math.max(i,r.distanceToSquared(An))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){let e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}let r=e.array,i=t.position.array,n=t.normal.array,a=t.uv.array,o=i.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new $t(new Float32Array(4*o),4));let s=this.getAttribute("tangent").array,l=[],c=[];for(let A=0;A<o;A++)l[A]=new k,c[A]=new k;let d=new k,u=new k,h=new k,f=new ye,p=new ye,v=new ye,m=new k,g=new k;function y(A,M,P){d.fromArray(i,A*3),u.fromArray(i,M*3),h.fromArray(i,P*3),f.fromArray(a,A*2),p.fromArray(a,M*2),v.fromArray(a,P*2),u.sub(d),h.sub(d),p.sub(f),v.sub(f);let T=1/(p.x*v.y-v.x*p.y);!isFinite(T)||(m.copy(u).multiplyScalar(v.y).addScaledVector(h,-p.y).multiplyScalar(T),g.copy(h).multiplyScalar(p.x).addScaledVector(u,-v.x).multiplyScalar(T),l[A].add(m),l[M].add(m),l[P].add(m),c[A].add(g),c[M].add(g),c[P].add(g))}let b=this.groups;b.length===0&&(b=[{start:0,count:r.length}]);for(let A=0,M=b.length;A<M;++A){let P=b[A],T=P.start,R=P.count;for(let z=T,F=T+R;z<F;z+=3)y(r[z+0],r[z+1],r[z+2])}let x=new k,S=new k,w=new k,_=new k;function C(A){w.fromArray(n,A*3),_.copy(w);let M=l[A];x.copy(M),x.sub(w.multiplyScalar(w.dot(M))).normalize(),S.crossVectors(_,M);let P=S.dot(c[A])<0?-1:1;s[A*4]=x.x,s[A*4+1]=x.y,s[A*4+2]=x.z,s[A*4+3]=P}for(let A=0,M=b.length;A<M;++A){let P=b[A],T=P.start,R=P.count;for(let z=T,F=T+R;z<F;z+=3)C(r[z+0]),C(r[z+1]),C(r[z+2])}}computeVertexNormals(){let e=this.index,t=this.getAttribute("position");if(t!==void 0){let r=this.getAttribute("normal");if(r===void 0)r=new $t(new Float32Array(t.count*3),3),this.setAttribute("normal",r);else for(let u=0,h=r.count;u<h;u++)r.setXYZ(u,0,0,0);let i=new k,n=new k,a=new k,o=new k,s=new k,l=new k,c=new k,d=new k;if(e)for(let u=0,h=e.count;u<h;u+=3){let f=e.getX(u+0),p=e.getX(u+1),v=e.getX(u+2);i.fromBufferAttribute(t,f),n.fromBufferAttribute(t,p),a.fromBufferAttribute(t,v),c.subVectors(a,n),d.subVectors(i,n),c.cross(d),o.fromBufferAttribute(r,f),s.fromBufferAttribute(r,p),l.fromBufferAttribute(r,v),o.add(c),s.add(c),l.add(c),r.setXYZ(f,o.x,o.y,o.z),r.setXYZ(p,s.x,s.y,s.z),r.setXYZ(v,l.x,l.y,l.z)}else for(let u=0,h=t.count;u<h;u+=3)i.fromBufferAttribute(t,u+0),n.fromBufferAttribute(t,u+1),a.fromBufferAttribute(t,u+2),c.subVectors(a,n),d.subVectors(i,n),c.cross(d),r.setXYZ(u+0,c.x,c.y,c.z),r.setXYZ(u+1,c.x,c.y,c.z),r.setXYZ(u+2,c.x,c.y,c.z);this.normalizeNormals(),r.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeBufferGeometries() instead."),this}normalizeNormals(){let e=this.attributes.normal;for(let t=0,r=e.count;t<r;t++)An.fromBufferAttribute(e,t),An.normalize(),e.setXYZ(t,An.x,An.y,An.z)}toNonIndexed(){function e(o,s){let l=o.array,c=o.itemSize,d=o.normalized,u=new l.constructor(s.length*c),h=0,f=0;for(let p=0,v=s.length;p<v;p++){o.isInterleavedBufferAttribute?h=s[p]*o.data.stride+o.offset:h=s[p]*c;for(let m=0;m<c;m++)u[f++]=l[h++]}return new $t(u,c,d)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;let t=new Ot,r=this.index.array,i=this.attributes;for(let o in i){let s=i[o],l=e(s,r);t.setAttribute(o,l)}let n=this.morphAttributes;for(let o in n){let s=[],l=n[o];for(let c=0,d=l.length;c<d;c++){let u=l[c],h=e(u,r);s.push(h)}t.morphAttributes[o]=s}t.morphTargetsRelative=this.morphTargetsRelative;let a=this.groups;for(let o=0,s=a.length;o<s;o++){let l=a[o];t.addGroup(l.start,l.count,l.materialIndex)}return t}toJSON(){let e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){let s=this.parameters;for(let l in s)s[l]!==void 0&&(e[l]=s[l]);return e}e.data={attributes:{}};let t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});let r=this.attributes;for(let s in r){let l=r[s];e.data.attributes[s]=l.toJSON(e.data)}let i={},n=!1;for(let s in this.morphAttributes){let l=this.morphAttributes[s],c=[];for(let d=0,u=l.length;d<u;d++){let h=l[d];c.push(h.toJSON(e.data))}c.length>0&&(i[s]=c,n=!0)}n&&(e.data.morphAttributes=i,e.data.morphTargetsRelative=this.morphTargetsRelative);let a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));let o=this.boundingSphere;return o!==null&&(e.data.boundingSphere={center:o.center.toArray(),radius:o.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;let t={};this.name=e.name;let r=e.index;r!==null&&this.setIndex(r.clone(t));let i=e.attributes;for(let l in i){let c=i[l];this.setAttribute(l,c.clone(t))}let n=e.morphAttributes;for(let l in n){let c=[],d=n[l];for(let u=0,h=d.length;u<h;u++)c.push(d[u].clone(t));this.morphAttributes[l]=c}this.morphTargetsRelative=e.morphTargetsRelative;let a=e.groups;for(let l=0,c=a.length;l<c;l++){let d=a[l];this.addGroup(d.start,d.count,d.materialIndex)}let o=e.boundingBox;o!==null&&(this.boundingBox=o.clone());let s=e.boundingSphere;return s!==null&&(this.boundingSphere=s.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,e.parameters!==void 0&&(this.parameters=Object.assign({},e.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}},FI=new it,qh=new jp,QS=new Za,wm=new k,Sm=new k,Cm=new k,ZS=new k,W0=new k,G0=new ye,$0=new ye,q0=new ye,JS=new k,Y0=new k,Di=class extends Yr{constructor(e=new Ot,t=new tc){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){let e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){let r=e[t[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let i=0,n=r.length;i<n;i++){let a=r[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=i}}}}getVertexPosition(e,t){let r=this.geometry,i=r.attributes.position,n=r.morphAttributes.position,a=r.morphTargetsRelative;t.fromBufferAttribute(i,e);let o=this.morphTargetInfluences;if(n&&o){W0.set(0,0,0);for(let s=0,l=n.length;s<l;s++){let c=o[s],d=n[s];c!==0&&(ZS.fromBufferAttribute(d,e),a?W0.addScaledVector(ZS,c):W0.addScaledVector(ZS.sub(t),c))}t.add(W0)}return this.isSkinnedMesh&&this.boneTransform(e,t),t}raycast(e,t){let r=this.geometry,i=this.material,n=this.matrixWorld;if(i===void 0||(r.boundingSphere===null&&r.computeBoundingSphere(),QS.copy(r.boundingSphere),QS.applyMatrix4(n),e.ray.intersectsSphere(QS)===!1)||(FI.copy(n).invert(),qh.copy(e.ray).applyMatrix4(FI),r.boundingBox!==null&&qh.intersectsBox(r.boundingBox)===!1))return;let a,o=r.index,s=r.attributes.position,l=r.attributes.uv,c=r.attributes.uv2,d=r.groups,u=r.drawRange;if(o!==null)if(Array.isArray(i))for(let h=0,f=d.length;h<f;h++){let p=d[h],v=i[p.materialIndex],m=Math.max(p.start,u.start),g=Math.min(o.count,Math.min(p.start+p.count,u.start+u.count));for(let y=m,b=g;y<b;y+=3){let x=o.getX(y),S=o.getX(y+1),w=o.getX(y+2);a=X0(this,v,e,qh,l,c,x,S,w),a&&(a.faceIndex=Math.floor(y/3),a.face.materialIndex=p.materialIndex,t.push(a))}}else{let h=Math.max(0,u.start),f=Math.min(o.count,u.start+u.count);for(let p=h,v=f;p<v;p+=3){let m=o.getX(p),g=o.getX(p+1),y=o.getX(p+2);a=X0(this,i,e,qh,l,c,m,g,y),a&&(a.faceIndex=Math.floor(p/3),t.push(a))}}else if(s!==void 0)if(Array.isArray(i))for(let h=0,f=d.length;h<f;h++){let p=d[h],v=i[p.materialIndex],m=Math.max(p.start,u.start),g=Math.min(s.count,Math.min(p.start+p.count,u.start+u.count));for(let y=m,b=g;y<b;y+=3){let x=y,S=y+1,w=y+2;a=X0(this,v,e,qh,l,c,x,S,w),a&&(a.faceIndex=Math.floor(y/3),a.face.materialIndex=p.materialIndex,t.push(a))}}else{let h=Math.max(0,u.start),f=Math.min(s.count,u.start+u.count);for(let p=h,v=f;p<v;p+=3){let m=p,g=p+1,y=p+2;a=X0(this,i,e,qh,l,c,m,g,y),a&&(a.faceIndex=Math.floor(p/3),t.push(a))}}}};function ege(e,t,r,i,n,a,o,s){let l;if(t.side===Ln?l=i.intersectTriangle(o,a,n,!0,s):l=i.intersectTriangle(n,a,o,t.side===us,s),l===null)return null;Y0.copy(s),Y0.applyMatrix4(e.matrixWorld);let c=r.ray.origin.distanceTo(Y0);return c<r.near||c>r.far?null:{distance:c,point:Y0.clone(),object:e}}function X0(e,t,r,i,n,a,o,s,l){e.getVertexPosition(o,wm),e.getVertexPosition(s,Sm),e.getVertexPosition(l,Cm);let c=ege(e,t,r,i,wm,Sm,Cm,JS);if(c){n&&(G0.fromBufferAttribute(n,o),$0.fromBufferAttribute(n,s),q0.fromBufferAttribute(n,l),c.uv=Zn.getUV(JS,wm,Sm,Cm,G0,$0,q0,new ye)),a&&(G0.fromBufferAttribute(a,o),$0.fromBufferAttribute(a,s),q0.fromBufferAttribute(a,l),c.uv2=Zn.getUV(JS,wm,Sm,Cm,G0,$0,q0,new ye));let d={a:o,b:s,c:l,normal:new k,materialIndex:0};Zn.getNormal(wm,Sm,Cm,d.normal),c.face=d}return c}var fs=class extends Ot{constructor(e=1,t=1,r=1,i=1,n=1,a=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:i,heightSegments:n,depthSegments:a};let o=this;i=Math.floor(i),n=Math.floor(n),a=Math.floor(a);let s=[],l=[],c=[],d=[],u=0,h=0;f("z","y","x",-1,-1,r,t,e,a,n,0),f("z","y","x",1,-1,r,t,-e,a,n,1),f("x","z","y",1,1,e,r,t,i,a,2),f("x","z","y",1,-1,e,r,-t,i,a,3),f("x","y","z",1,-1,e,t,r,i,n,4),f("x","y","z",-1,-1,e,t,-r,i,n,5),this.setIndex(s),this.setAttribute("position",new yt(l,3)),this.setAttribute("normal",new yt(c,3)),this.setAttribute("uv",new yt(d,2));function f(p,v,m,g,y,b,x,S,w,_,C){let A=b/w,M=x/_,P=b/2,T=x/2,R=S/2,z=w+1,F=_+1,H=0,N=0,U=new k;for(let ie=0;ie<F;ie++){let te=ie*M-T;for(let X=0;X<z;X++){let W=X*A-P;U[p]=W*g,U[v]=te*y,U[m]=R,l.push(U.x,U.y,U.z),U[p]=0,U[v]=0,U[m]=S>0?1:-1,c.push(U.x,U.y,U.z),d.push(X/w),d.push(1-ie/_),H+=1}}for(let ie=0;ie<_;ie++)for(let te=0;te<w;te++){let X=u+te+z*ie,W=u+te+z*(ie+1),q=u+(te+1)+z*(ie+1),$=u+(te+1)+z*ie;s.push(X,W,$),s.push(W,q,$),N+=6}o.addGroup(h,N,C),h+=N,u+=H}}static fromJSON(e){return new fs(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}};function vp(e){let t={};for(let r in e){t[r]={};for(let i in e[r]){let n=e[r][i];n&&(n.isColor||n.isMatrix3||n.isMatrix4||n.isVector2||n.isVector3||n.isVector4||n.isTexture||n.isQuaternion)?t[r][i]=n.clone():Array.isArray(n)?t[r][i]=n.slice():t[r][i]=n}}return t}function Ca(e){let t={};for(let r=0;r<e.length;r++){let i=vp(e[r]);for(let n in i)t[n]=i[n]}return t}function tge(e){let t=[];for(let r=0;r<e.length;r++)t.push(e[r].clone());return t}function vj(e){return e.getRenderTarget()===null&&e.outputEncoding===sr?ks:ux}var Vp={clone:vp,merge:Ca},rge=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,ige=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,jr=class extends Wg{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=rge,this.fragmentShader=ige,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=vp(e.uniforms),this.uniformsGroups=tge(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){let t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(let i in this.uniforms){let n=this.uniforms[i].value;n&&n.isTexture?t.uniforms[i]={type:"t",value:n.toJSON(e).uuid}:n&&n.isColor?t.uniforms[i]={type:"c",value:n.getHex()}:n&&n.isVector2?t.uniforms[i]={type:"v2",value:n.toArray()}:n&&n.isVector3?t.uniforms[i]={type:"v3",value:n.toArray()}:n&&n.isVector4?t.uniforms[i]={type:"v4",value:n.toArray()}:n&&n.isMatrix3?t.uniforms[i]={type:"m3",value:n.toArray()}:n&&n.isMatrix4?t.uniforms[i]={type:"m4",value:n.toArray()}:t.uniforms[i]={value:n}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;let r={};for(let i in this.extensions)this.extensions[i]===!0&&(r[i]=!0);return Object.keys(r).length>0&&(t.extensions=r),t}},xh=class extends Yr{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new it,this.projectionMatrix=new it,this.projectionMatrixInverse=new it}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);let t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}},da=class extends xh{constructor(e=50,t=1,r=.1,i=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=r,this.far=i,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){let t=.5*this.getFilmHeight()/e;this.fov=ig*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){let e=Math.tan(Cv*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return ig*2*Math.atan(Math.tan(Cv*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,r,i,n,a){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=i,this.view.width=n,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=this.near,t=e*Math.tan(Cv*.5*this.fov)/this.zoom,r=2*t,i=this.aspect*r,n=-.5*i,a=this.view;if(this.view!==null&&this.view.enabled){let s=a.fullWidth,l=a.fullHeight;n+=a.offsetX*i/s,t-=a.offsetY*r/l,i*=a.width/s,r*=a.height/l}let o=this.filmOffset;o!==0&&(n+=e*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(n,n+i,t,t-r,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}},Yh=-90,Xh=1,nge=class extends Yr{constructor(e,t,r){super(),this.type="CubeCamera",this.renderTarget=r;let i=new da(Yh,Xh,e,t);i.layers=this.layers,i.up.set(0,1,0),i.lookAt(1,0,0),this.add(i);let n=new da(Yh,Xh,e,t);n.layers=this.layers,n.up.set(0,1,0),n.lookAt(-1,0,0),this.add(n);let a=new da(Yh,Xh,e,t);a.layers=this.layers,a.up.set(0,0,-1),a.lookAt(0,1,0),this.add(a);let o=new da(Yh,Xh,e,t);o.layers=this.layers,o.up.set(0,0,1),o.lookAt(0,-1,0),this.add(o);let s=new da(Yh,Xh,e,t);s.layers=this.layers,s.up.set(0,1,0),s.lookAt(0,0,1),this.add(s);let l=new da(Yh,Xh,e,t);l.layers=this.layers,l.up.set(0,1,0),l.lookAt(0,0,-1),this.add(l)}update(e,t){this.parent===null&&this.updateMatrixWorld();let r=this.renderTarget,[i,n,a,o,s,l]=this.children,c=e.getRenderTarget(),d=e.toneMapping,u=e.xr.enabled;e.toneMapping=Zs,e.xr.enabled=!1;let h=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0),e.render(t,i),e.setRenderTarget(r,1),e.render(t,n),e.setRenderTarget(r,2),e.render(t,a),e.setRenderTarget(r,3),e.render(t,o),e.setRenderTarget(r,4),e.render(t,s),r.texture.generateMipmaps=h,e.setRenderTarget(r,5),e.render(t,l),e.setRenderTarget(c),e.toneMapping=d,e.xr.enabled=u,r.texture.needsPMREMUpdate=!0}},tP=class extends Oi{constructor(e,t,r,i,n,a,o,s,l,c){e=e!==void 0?e:[],t=t!==void 0?t:th,super(e,t,r,i,n,a,o,s,l,c),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}},age=class extends Ur{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;let r={width:e,height:e,depth:1},i=[r,r,r,r,r,r];this.texture=new tP(i,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:ur}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;let r={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},i=new fs(5,5,5),n=new jr({name:"CubemapFromEquirect",uniforms:vp(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:Ln,blending:ln});n.uniforms.tEquirect.value=t;let a=new Di(i,n),o=t.minFilter;return t.minFilter===mp&&(t.minFilter=ur),new nge(1,10,this).update(e,a),t.minFilter=o,a.geometry.dispose(),a.material.dispose(),this}clear(e,t,r,i){let n=e.getRenderTarget();for(let a=0;a<6;a++)e.setRenderTarget(this,a),e.clear(t,r,i);e.setRenderTarget(n)}},eC=new k,oge=new k,sge=new sn,Va=class{constructor(e=new k(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,r,i){return this.normal.set(e,t,r),this.constant=i,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,r){let i=eC.subVectors(r,t).cross(oge.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){let e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){let r=e.delta(eC),i=this.normal.dot(r);if(i===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;let n=-(e.start.dot(this.normal)+this.constant)/i;return n<0||n>1?null:t.copy(r).multiplyScalar(n).add(e.start)}intersectsLine(e){let t=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return t<0&&r>0||r<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){let r=t||sge.getNormalMatrix(e),i=this.coplanarPoint(eC).applyMatrix4(e),n=this.normal.applyMatrix3(r).normalize();return this.constant=-i.dot(n),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}},Kh=new Za,K0=new k,rP=class{constructor(e=new Va,t=new Va,r=new Va,i=new Va,n=new Va,a=new Va){this.planes=[e,t,r,i,n,a]}set(e,t,r,i,n,a){let o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(r),o[3].copy(i),o[4].copy(n),o[5].copy(a),this}copy(e){let t=this.planes;for(let r=0;r<6;r++)t[r].copy(e.planes[r]);return this}setFromProjectionMatrix(e){let t=this.planes,r=e.elements,i=r[0],n=r[1],a=r[2],o=r[3],s=r[4],l=r[5],c=r[6],d=r[7],u=r[8],h=r[9],f=r[10],p=r[11],v=r[12],m=r[13],g=r[14],y=r[15];return t[0].setComponents(o-i,d-s,p-u,y-v).normalize(),t[1].setComponents(o+i,d+s,p+u,y+v).normalize(),t[2].setComponents(o+n,d+l,p+h,y+m).normalize(),t[3].setComponents(o-n,d-l,p-h,y-m).normalize(),t[4].setComponents(o-a,d-c,p-f,y-g).normalize(),t[5].setComponents(o+a,d+c,p+f,y+g).normalize(),this}intersectsObject(e){let t=e.geometry;return t.boundingSphere===null&&t.computeBoundingSphere(),Kh.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(Kh)}intersectsSprite(e){return Kh.center.set(0,0,0),Kh.radius=.7071067811865476,Kh.applyMatrix4(e.matrixWorld),this.intersectsSphere(Kh)}intersectsSphere(e){let t=this.planes,r=e.center,i=-e.radius;for(let n=0;n<6;n++)if(t[n].distanceToPoint(r)<i)return!1;return!0}intersectsBox(e){let t=this.planes;for(let r=0;r<6;r++){let i=t[r];if(K0.x=i.normal.x>0?e.max.x:e.min.x,K0.y=i.normal.y>0?e.max.y:e.min.y,K0.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(K0)<0)return!1}return!0}containsPoint(e){let t=this.planes;for(let r=0;r<6;r++)if(t[r].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}};function gj(){let e=null,t=!1,r=null,i=null;function n(a,o){r(a,o),i=e.requestAnimationFrame(n)}return{start:function(){t!==!0&&r!==null&&(i=e.requestAnimationFrame(n),t=!0)},stop:function(){e.cancelAnimationFrame(i),t=!1},setAnimationLoop:function(a){r=a},setContext:function(a){e=a}}}function lge(e,t){let r=t.isWebGL2,i=new WeakMap;function n(c,d){let u=c.array,h=c.usage,f=e.createBuffer();e.bindBuffer(d,f),e.bufferData(d,u,h),c.onUploadCallback();let p;if(u instanceof Float32Array)p=5126;else if(u instanceof Uint16Array)if(c.isFloat16BufferAttribute)if(r)p=5131;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else p=5123;else if(u instanceof Int16Array)p=5122;else if(u instanceof Uint32Array)p=5125;else if(u instanceof Int32Array)p=5124;else if(u instanceof Int8Array)p=5120;else if(u instanceof Uint8Array)p=5121;else if(u instanceof Uint8ClampedArray)p=5121;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+u);return{buffer:f,type:p,bytesPerElement:u.BYTES_PER_ELEMENT,version:c.version}}function a(c,d,u){let h=d.array,f=d.updateRange;e.bindBuffer(u,c),f.count===-1?e.bufferSubData(u,0,h):(r?e.bufferSubData(u,f.offset*h.BYTES_PER_ELEMENT,h,f.offset,f.count):e.bufferSubData(u,f.offset*h.BYTES_PER_ELEMENT,h.subarray(f.offset,f.offset+f.count)),f.count=-1),d.onUploadCallback()}function o(c){return c.isInterleavedBufferAttribute&&(c=c.data),i.get(c)}function s(c){c.isInterleavedBufferAttribute&&(c=c.data);let d=i.get(c);d&&(e.deleteBuffer(d.buffer),i.delete(c))}function l(c,d){if(c.isGLBufferAttribute){let h=i.get(c);(!h||h.version<c.version)&&i.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version});return}c.isInterleavedBufferAttribute&&(c=c.data);let u=i.get(c);u===void 0?i.set(c,n(c,d)):u.version<c.version&&(a(u.buffer,c,d),u.version=c.version)}return{get:o,remove:s,update:l}}var rc=class extends Ot{constructor(e=1,t=1,r=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:i};let n=e/2,a=t/2,o=Math.floor(r),s=Math.floor(i),l=o+1,c=s+1,d=e/o,u=t/s,h=[],f=[],p=[],v=[];for(let m=0;m<c;m++){let g=m*u-a;for(let y=0;y<l;y++){let b=y*d-n;f.push(b,-g,0),p.push(0,0,1),v.push(y/o),v.push(1-m/s)}}for(let m=0;m<s;m++)for(let g=0;g<o;g++){let y=g+l*m,b=g+l*(m+1),x=g+1+l*(m+1),S=g+1+l*m;h.push(y,b,S),h.push(b,x,S)}this.setIndex(h),this.setAttribute("position",new yt(f,3)),this.setAttribute("normal",new yt(p,3)),this.setAttribute("uv",new yt(v,2))}static fromJSON(e){return new rc(e.width,e.height,e.widthSegments,e.heightSegments)}},cge=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,dge=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,uge=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,hge=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,fge=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,pge=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,mge="vec3 transformed = vec3( position );",vge=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,gge=`vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( V * D );
}
#ifdef USE_IRIDESCENCE
	vec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = mix( F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif`,yge=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			 return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float R21 = R12;
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,bge=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = dFdx( surf_pos.xyz );
		vec3 vSigmaY = dFdy( surf_pos.xyz );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,xge=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,wge=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,Sge=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,Cge=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,_ge=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,Age=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,Mge=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,Ege=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,Tge=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,Pge=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_v0 0.339
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_v1 0.276
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_v4 0.046
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_v5 0.016
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_v6 0.0038
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,Dge=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,Oge=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,Rge=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,Ige=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,zge=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,kge="gl_FragColor = linearToOutputTexel( gl_FragColor );",Lge=`vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,Bge=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,Fge=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,Nge=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,Uge=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,jge=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,Vge=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,Hge=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,Wge=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,Gge=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,$ge=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,qge=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vUv2 );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,Yge=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,Xge=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,Kge=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,Qge=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( PHYSICALLY_CORRECT_LIGHTS )
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#else
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,Zge=`#if defined( USE_ENVMAP )
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
#endif`,Jge=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,e0e=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,t0e=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,r0e=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,i0e=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULARINTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;
		#endif
		#ifdef USE_SPECULARCOLORMAP
			specularColorFactor *= texture2D( specularColorMap, vUv ).rgb;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEENCOLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEENROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;
	#endif
#endif`,n0e=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
	#endif
	#ifdef USE_IRIDESCENCE
		reflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );
	#else
		reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,a0e=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometry.viewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,o0e=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry.normal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,s0e=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,l0e=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,c0e=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,d0e=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,u0e=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,h0e=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,f0e=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,p0e=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,m0e=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,v0e=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,g0e=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,y0e=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,b0e=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,x0e=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,w0e=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,S0e=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,C0e=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,_0e=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,A0e=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,M0e=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,E0e=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );
		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );
	}
#endif`,T0e=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,P0e=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );
	#endif
#endif`,D0e=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,O0e=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,R0e=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha + 0.1;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,I0e=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,z0e=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,k0e=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,L0e=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,B0e=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,F0e=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,N0e=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,U0e=`#if NUM_SPOT_LIGHT_COORDS > 0
  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
  uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,j0e=`#if NUM_SPOT_LIGHT_COORDS > 0
  uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,V0e=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,H0e=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,W0e=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,G0e=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;
	mat4 getBoneMatrix( const in float i ) {
		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );
		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );
		y = dy * ( y + 0.5 );
		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
		mat4 bone = mat4( v1, v2, v3, v4 );
		return bone;
	}
#endif`,$0e=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,q0e=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,Y0e=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,X0e=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,K0e=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,Q0e=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,Z0e=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmission = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );
#endif`,J0e=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		#ifdef texture2DLodEXT
			return texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#else
			return texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#endif
	}
	vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return radiance;
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance * radiance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );
	}
#endif`,eye=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,tye=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,rye=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,iye=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,nye=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,aye=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,oye=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,sye=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,lye=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,cye=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,dye=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,uye=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,hye=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,fye=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,pye=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,mye=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,vye=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,gye=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,yye=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,bye=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,xye=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,wye=`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,Sye=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Cye=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,_ye=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Aye=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,Mye=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Eye=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,Tye=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,Pye=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Dye=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Oye=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,Rye=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULARINTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
	#ifdef USE_SPECULARCOLORMAP
		uniform sampler2D specularColorMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEENCOLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEENROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;
	#endif
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Iye=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,zye=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,kye=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,Lye=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Bye=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Fye=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,Nye=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Uye=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,lr={alphamap_fragment:cge,alphamap_pars_fragment:dge,alphatest_fragment:uge,alphatest_pars_fragment:hge,aomap_fragment:fge,aomap_pars_fragment:pge,begin_vertex:mge,beginnormal_vertex:vge,bsdfs:gge,iridescence_fragment:yge,bumpmap_pars_fragment:bge,clipping_planes_fragment:xge,clipping_planes_pars_fragment:wge,clipping_planes_pars_vertex:Sge,clipping_planes_vertex:Cge,color_fragment:_ge,color_pars_fragment:Age,color_pars_vertex:Mge,color_vertex:Ege,common:Tge,cube_uv_reflection_fragment:Pge,defaultnormal_vertex:Dge,displacementmap_pars_vertex:Oge,displacementmap_vertex:Rge,emissivemap_fragment:Ige,emissivemap_pars_fragment:zge,encodings_fragment:kge,encodings_pars_fragment:Lge,envmap_fragment:Bge,envmap_common_pars_fragment:Fge,envmap_pars_fragment:Nge,envmap_pars_vertex:Uge,envmap_physical_pars_fragment:Zge,envmap_vertex:jge,fog_vertex:Vge,fog_pars_vertex:Hge,fog_fragment:Wge,fog_pars_fragment:Gge,gradientmap_pars_fragment:$ge,lightmap_fragment:qge,lightmap_pars_fragment:Yge,lights_lambert_fragment:Xge,lights_lambert_pars_fragment:Kge,lights_pars_begin:Qge,lights_toon_fragment:Jge,lights_toon_pars_fragment:e0e,lights_phong_fragment:t0e,lights_phong_pars_fragment:r0e,lights_physical_fragment:i0e,lights_physical_pars_fragment:n0e,lights_fragment_begin:a0e,lights_fragment_maps:o0e,lights_fragment_end:s0e,logdepthbuf_fragment:l0e,logdepthbuf_pars_fragment:c0e,logdepthbuf_pars_vertex:d0e,logdepthbuf_vertex:u0e,map_fragment:h0e,map_pars_fragment:f0e,map_particle_fragment:p0e,map_particle_pars_fragment:m0e,metalnessmap_fragment:v0e,metalnessmap_pars_fragment:g0e,morphcolor_vertex:y0e,morphnormal_vertex:b0e,morphtarget_pars_vertex:x0e,morphtarget_vertex:w0e,normal_fragment_begin:S0e,normal_fragment_maps:C0e,normal_pars_fragment:_0e,normal_pars_vertex:A0e,normal_vertex:M0e,normalmap_pars_fragment:E0e,clearcoat_normal_fragment_begin:T0e,clearcoat_normal_fragment_maps:P0e,clearcoat_pars_fragment:D0e,iridescence_pars_fragment:O0e,output_fragment:R0e,packing:I0e,premultiplied_alpha_fragment:z0e,project_vertex:k0e,dithering_fragment:L0e,dithering_pars_fragment:B0e,roughnessmap_fragment:F0e,roughnessmap_pars_fragment:N0e,shadowmap_pars_fragment:U0e,shadowmap_pars_vertex:j0e,shadowmap_vertex:V0e,shadowmask_pars_fragment:H0e,skinbase_vertex:W0e,skinning_pars_vertex:G0e,skinning_vertex:$0e,skinnormal_vertex:q0e,specularmap_fragment:Y0e,specularmap_pars_fragment:X0e,tonemapping_fragment:K0e,tonemapping_pars_fragment:Q0e,transmission_fragment:Z0e,transmission_pars_fragment:J0e,uv_pars_fragment:eye,uv_pars_vertex:tye,uv_vertex:rye,uv2_pars_fragment:iye,uv2_pars_vertex:nye,uv2_vertex:aye,worldpos_vertex:oye,background_vert:sye,background_frag:lye,backgroundCube_vert:cye,backgroundCube_frag:dye,cube_vert:uye,cube_frag:hye,depth_vert:fye,depth_frag:pye,distanceRGBA_vert:mye,distanceRGBA_frag:vye,equirect_vert:gye,equirect_frag:yye,linedashed_vert:bye,linedashed_frag:xye,meshbasic_vert:wye,meshbasic_frag:Sye,meshlambert_vert:Cye,meshlambert_frag:_ye,meshmatcap_vert:Aye,meshmatcap_frag:Mye,meshnormal_vert:Eye,meshnormal_frag:Tye,meshphong_vert:Pye,meshphong_frag:Dye,meshphysical_vert:Oye,meshphysical_frag:Rye,meshtoon_vert:Iye,meshtoon_frag:zye,points_vert:kye,points_frag:Lye,shadow_vert:Bye,shadow_frag:Fye,sprite_vert:Nye,sprite_frag:Uye},ht={common:{diffuse:{value:new Lt(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new sn},uv2Transform:{value:new sn},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new ye(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Lt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Lt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new sn}},sprite:{diffuse:{value:new Lt(16777215)},opacity:{value:1},center:{value:new ye(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new sn}}},Fs={basic:{uniforms:Ca([ht.common,ht.specularmap,ht.envmap,ht.aomap,ht.lightmap,ht.fog]),vertexShader:lr.meshbasic_vert,fragmentShader:lr.meshbasic_frag},lambert:{uniforms:Ca([ht.common,ht.specularmap,ht.envmap,ht.aomap,ht.lightmap,ht.emissivemap,ht.bumpmap,ht.normalmap,ht.displacementmap,ht.fog,ht.lights,{emissive:{value:new Lt(0)}}]),vertexShader:lr.meshlambert_vert,fragmentShader:lr.meshlambert_frag},phong:{uniforms:Ca([ht.common,ht.specularmap,ht.envmap,ht.aomap,ht.lightmap,ht.emissivemap,ht.bumpmap,ht.normalmap,ht.displacementmap,ht.fog,ht.lights,{emissive:{value:new Lt(0)},specular:{value:new Lt(1118481)},shininess:{value:30}}]),vertexShader:lr.meshphong_vert,fragmentShader:lr.meshphong_frag},standard:{uniforms:Ca([ht.common,ht.envmap,ht.aomap,ht.lightmap,ht.emissivemap,ht.bumpmap,ht.normalmap,ht.displacementmap,ht.roughnessmap,ht.metalnessmap,ht.fog,ht.lights,{emissive:{value:new Lt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:lr.meshphysical_vert,fragmentShader:lr.meshphysical_frag},toon:{uniforms:Ca([ht.common,ht.aomap,ht.lightmap,ht.emissivemap,ht.bumpmap,ht.normalmap,ht.displacementmap,ht.gradientmap,ht.fog,ht.lights,{emissive:{value:new Lt(0)}}]),vertexShader:lr.meshtoon_vert,fragmentShader:lr.meshtoon_frag},matcap:{uniforms:Ca([ht.common,ht.bumpmap,ht.normalmap,ht.displacementmap,ht.fog,{matcap:{value:null}}]),vertexShader:lr.meshmatcap_vert,fragmentShader:lr.meshmatcap_frag},points:{uniforms:Ca([ht.points,ht.fog]),vertexShader:lr.points_vert,fragmentShader:lr.points_frag},dashed:{uniforms:Ca([ht.common,ht.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:lr.linedashed_vert,fragmentShader:lr.linedashed_frag},depth:{uniforms:Ca([ht.common,ht.displacementmap]),vertexShader:lr.depth_vert,fragmentShader:lr.depth_frag},normal:{uniforms:Ca([ht.common,ht.bumpmap,ht.normalmap,ht.displacementmap,{opacity:{value:1}}]),vertexShader:lr.meshnormal_vert,fragmentShader:lr.meshnormal_frag},sprite:{uniforms:Ca([ht.sprite,ht.fog]),vertexShader:lr.sprite_vert,fragmentShader:lr.sprite_frag},background:{uniforms:{uvTransform:{value:new sn},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:lr.background_vert,fragmentShader:lr.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:lr.backgroundCube_vert,fragmentShader:lr.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:lr.cube_vert,fragmentShader:lr.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:lr.equirect_vert,fragmentShader:lr.equirect_frag},distanceRGBA:{uniforms:Ca([ht.common,ht.displacementmap,{referencePosition:{value:new k},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:lr.distanceRGBA_vert,fragmentShader:lr.distanceRGBA_frag},shadow:{uniforms:Ca([ht.lights,ht.fog,{color:{value:new Lt(0)},opacity:{value:1}}]),vertexShader:lr.shadow_vert,fragmentShader:lr.shadow_frag}};Fs.physical={uniforms:Ca([Fs.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new ye(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new Lt(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new ye},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new Lt(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new Lt(1,1,1)},specularColorMap:{value:null}}]),vertexShader:lr.meshphysical_vert,fragmentShader:lr.meshphysical_frag};var Q0={r:0,b:0,g:0};function jye(e,t,r,i,n,a,o){let s=new Lt(0),l=a===!0?0:1,c,d,u=null,h=0,f=null;function p(m,g){let y=!1,b=g.isScene===!0?g.background:null;b&&b.isTexture&&(b=(g.backgroundBlurriness>0?r:t).get(b));let x=e.xr,S=x.getSession&&x.getSession();S&&S.environmentBlendMode==="additive"&&(b=null),b===null?v(s,l):b&&b.isColor&&(v(b,1),y=!0),(e.autoClear||y)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),b&&(b.isCubeTexture||b.mapping===Hg)?(d===void 0&&(d=new Di(new fs(1,1,1),new jr({name:"BackgroundCubeMaterial",uniforms:vp(Fs.backgroundCube.uniforms),vertexShader:Fs.backgroundCube.vertexShader,fragmentShader:Fs.backgroundCube.fragmentShader,side:Ln,depthTest:!1,depthWrite:!1,fog:!1})),d.geometry.deleteAttribute("normal"),d.geometry.deleteAttribute("uv"),d.onBeforeRender=function(w,_,C){this.matrixWorld.copyPosition(C.matrixWorld)},Object.defineProperty(d.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),n.update(d)),d.material.uniforms.envMap.value=b,d.material.uniforms.flipEnvMap.value=b.isCubeTexture&&b.isRenderTargetTexture===!1?-1:1,d.material.uniforms.backgroundBlurriness.value=g.backgroundBlurriness,d.material.uniforms.backgroundIntensity.value=g.backgroundIntensity,d.material.toneMapped=b.encoding!==sr,(u!==b||h!==b.version||f!==e.toneMapping)&&(d.material.needsUpdate=!0,u=b,h=b.version,f=e.toneMapping),d.layers.enableAll(),m.unshift(d,d.geometry,d.material,0,0,null)):b&&b.isTexture&&(c===void 0&&(c=new Di(new rc(2,2),new jr({name:"BackgroundMaterial",uniforms:vp(Fs.background.uniforms),vertexShader:Fs.background.vertexShader,fragmentShader:Fs.background.fragmentShader,side:us,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),n.update(c)),c.material.uniforms.t2D.value=b,c.material.uniforms.backgroundIntensity.value=g.backgroundIntensity,c.material.toneMapped=b.encoding!==sr,b.matrixAutoUpdate===!0&&b.updateMatrix(),c.material.uniforms.uvTransform.value.copy(b.matrix),(u!==b||h!==b.version||f!==e.toneMapping)&&(c.material.needsUpdate=!0,u=b,h=b.version,f=e.toneMapping),c.layers.enableAll(),m.unshift(c,c.geometry,c.material,0,0,null))}function v(m,g){m.getRGB(Q0,vj(e)),i.buffers.color.setClear(Q0.r,Q0.g,Q0.b,g,o)}return{getClearColor:function(){return s},setClearColor:function(m,g=1){s.set(m),l=g,v(s,l)},getClearAlpha:function(){return l},setClearAlpha:function(m){l=m,v(s,l)},render:p}}function Vye(e,t,r,i){let n=e.getParameter(34921),a=i.isWebGL2?null:t.get("OES_vertex_array_object"),o=i.isWebGL2||a!==null,s={},l=m(null),c=l,d=!1;function u(z,F,H,N,U){let ie=!1;if(o){let te=v(N,H,F);c!==te&&(c=te,f(c.object)),ie=g(z,N,H,U),ie&&y(z,N,H,U)}else{let te=F.wireframe===!0;(c.geometry!==N.id||c.program!==H.id||c.wireframe!==te)&&(c.geometry=N.id,c.program=H.id,c.wireframe=te,ie=!0)}U!==null&&r.update(U,34963),(ie||d)&&(d=!1,C(z,F,H,N),U!==null&&e.bindBuffer(34963,r.get(U).buffer))}function h(){return i.isWebGL2?e.createVertexArray():a.createVertexArrayOES()}function f(z){return i.isWebGL2?e.bindVertexArray(z):a.bindVertexArrayOES(z)}function p(z){return i.isWebGL2?e.deleteVertexArray(z):a.deleteVertexArrayOES(z)}function v(z,F,H){let N=H.wireframe===!0,U=s[z.id];U===void 0&&(U={},s[z.id]=U);let ie=U[F.id];ie===void 0&&(ie={},U[F.id]=ie);let te=ie[N];return te===void 0&&(te=m(h()),ie[N]=te),te}function m(z){let F=[],H=[],N=[];for(let U=0;U<n;U++)F[U]=0,H[U]=0,N[U]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:F,enabledAttributes:H,attributeDivisors:N,object:z,attributes:{},index:null}}function g(z,F,H,N){let U=c.attributes,ie=F.attributes,te=0,X=H.getAttributes();for(let W in X)if(X[W].location>=0){let q=U[W],$=ie[W];if($===void 0&&(W==="instanceMatrix"&&z.instanceMatrix&&($=z.instanceMatrix),W==="instanceColor"&&z.instanceColor&&($=z.instanceColor)),q===void 0||q.attribute!==$||$&&q.data!==$.data)return!0;te++}return c.attributesNum!==te||c.index!==N}function y(z,F,H,N){let U={},ie=F.attributes,te=0,X=H.getAttributes();for(let W in X)if(X[W].location>=0){let q=ie[W];q===void 0&&(W==="instanceMatrix"&&z.instanceMatrix&&(q=z.instanceMatrix),W==="instanceColor"&&z.instanceColor&&(q=z.instanceColor));let $={};$.attribute=q,q&&q.data&&($.data=q.data),U[W]=$,te++}c.attributes=U,c.attributesNum=te,c.index=N}function b(){let z=c.newAttributes;for(let F=0,H=z.length;F<H;F++)z[F]=0}function x(z){S(z,0)}function S(z,F){let H=c.newAttributes,N=c.enabledAttributes,U=c.attributeDivisors;H[z]=1,N[z]===0&&(e.enableVertexAttribArray(z),N[z]=1),U[z]!==F&&((i.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](z,F),U[z]=F)}function w(){let z=c.newAttributes,F=c.enabledAttributes;for(let H=0,N=F.length;H<N;H++)F[H]!==z[H]&&(e.disableVertexAttribArray(H),F[H]=0)}function _(z,F,H,N,U,ie){i.isWebGL2===!0&&(H===5124||H===5125)?e.vertexAttribIPointer(z,F,H,U,ie):e.vertexAttribPointer(z,F,H,N,U,ie)}function C(z,F,H,N){if(i.isWebGL2===!1&&(z.isInstancedMesh||N.isInstancedBufferGeometry)&&t.get("ANGLE_instanced_arrays")===null)return;b();let U=N.attributes,ie=H.getAttributes(),te=F.defaultAttributeValues;for(let X in ie){let W=ie[X];if(W.location>=0){let q=U[X];if(q===void 0&&(X==="instanceMatrix"&&z.instanceMatrix&&(q=z.instanceMatrix),X==="instanceColor"&&z.instanceColor&&(q=z.instanceColor)),q!==void 0){let $=q.normalized,le=q.itemSize,ee=r.get(q);if(ee===void 0)continue;let Q=ee.buffer,ne=ee.type,V=ee.bytesPerElement;if(q.isInterleavedBufferAttribute){let de=q.data,me=de.stride,Ce=q.offset;if(de.isInstancedInterleavedBuffer){for(let G=0;G<W.locationSize;G++)S(W.location+G,de.meshPerAttribute);z.isInstancedMesh!==!0&&N._maxInstanceCount===void 0&&(N._maxInstanceCount=de.meshPerAttribute*de.count)}else for(let G=0;G<W.locationSize;G++)x(W.location+G);e.bindBuffer(34962,Q);for(let G=0;G<W.locationSize;G++)_(W.location+G,le/W.locationSize,ne,$,me*V,(Ce+le/W.locationSize*G)*V)}else{if(q.isInstancedBufferAttribute){for(let de=0;de<W.locationSize;de++)S(W.location+de,q.meshPerAttribute);z.isInstancedMesh!==!0&&N._maxInstanceCount===void 0&&(N._maxInstanceCount=q.meshPerAttribute*q.count)}else for(let de=0;de<W.locationSize;de++)x(W.location+de);e.bindBuffer(34962,Q);for(let de=0;de<W.locationSize;de++)_(W.location+de,le/W.locationSize,ne,$,le*V,le/W.locationSize*de*V)}}else if(te!==void 0){let $=te[X];if($!==void 0)switch($.length){case 2:e.vertexAttrib2fv(W.location,$);break;case 3:e.vertexAttrib3fv(W.location,$);break;case 4:e.vertexAttrib4fv(W.location,$);break;default:e.vertexAttrib1fv(W.location,$)}}}}w()}function A(){T();for(let z in s){let F=s[z];for(let H in F){let N=F[H];for(let U in N)p(N[U].object),delete N[U];delete F[H]}delete s[z]}}function M(z){if(s[z.id]===void 0)return;let F=s[z.id];for(let H in F){let N=F[H];for(let U in N)p(N[U].object),delete N[U];delete F[H]}delete s[z.id]}function P(z){for(let F in s){let H=s[F];if(H[z.id]===void 0)continue;let N=H[z.id];for(let U in N)p(N[U].object),delete N[U];delete H[z.id]}}function T(){R(),d=!0,c!==l&&(c=l,f(c.object))}function R(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:u,reset:T,resetDefaultState:R,dispose:A,releaseStatesOfGeometry:M,releaseStatesOfProgram:P,initAttributes:b,enableAttribute:x,disableUnusedAttributes:w}}function Hye(e,t,r,i){let n=i.isWebGL2,a;function o(c){a=c}function s(c,d){e.drawArrays(a,c,d),r.update(d,a,1)}function l(c,d,u){if(u===0)return;let h,f;if(n)h=e,f="drawArraysInstanced";else if(h=t.get("ANGLE_instanced_arrays"),f="drawArraysInstancedANGLE",h===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}h[f](a,c,d,u),r.update(d,a,u)}this.setMode=o,this.render=s,this.renderInstances=l}function Wye(e,t,r){let i;function n(){if(i!==void 0)return i;if(t.has("EXT_texture_filter_anisotropic")===!0){let _=t.get("EXT_texture_filter_anisotropic");i=e.getParameter(_.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i}function a(_){if(_==="highp"){if(e.getShaderPrecisionFormat(35633,36338).precision>0&&e.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";_="mediump"}return _==="mediump"&&e.getShaderPrecisionFormat(35633,36337).precision>0&&e.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}let o=typeof WebGL2RenderingContext<"u"&&e instanceof WebGL2RenderingContext,s=r.precision!==void 0?r.precision:"highp",l=a(s);l!==s&&(console.warn("THREE.WebGLRenderer:",s,"not supported, using",l,"instead."),s=l);let c=o||t.has("WEBGL_draw_buffers"),d=r.logarithmicDepthBuffer===!0,u=e.getParameter(34930),h=e.getParameter(35660),f=e.getParameter(3379),p=e.getParameter(34076),v=e.getParameter(34921),m=e.getParameter(36347),g=e.getParameter(36348),y=e.getParameter(36349),b=h>0,x=o||t.has("OES_texture_float"),S=b&&x,w=o?e.getParameter(36183):0;return{isWebGL2:o,drawBuffers:c,getMaxAnisotropy:n,getMaxPrecision:a,precision:s,logarithmicDepthBuffer:d,maxTextures:u,maxVertexTextures:h,maxTextureSize:f,maxCubemapSize:p,maxAttributes:v,maxVertexUniforms:m,maxVaryings:g,maxFragmentUniforms:y,vertexTextures:b,floatFragmentTextures:x,floatVertexTextures:S,maxSamples:w}}function Gye(e){let t=this,r=null,i=0,n=!1,a=!1,o=new Va,s=new sn,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(u,h){let f=u.length!==0||h||i!==0||n;return n=h,i=u.length,f},this.beginShadows=function(){a=!0,d(null)},this.endShadows=function(){a=!1},this.setGlobalState=function(u,h){r=d(u,h,0)},this.setState=function(u,h,f){let p=u.clippingPlanes,v=u.clipIntersection,m=u.clipShadows,g=e.get(u);if(!n||p===null||p.length===0||a&&!m)a?d(null):c();else{let y=a?0:i,b=y*4,x=g.clippingState||null;l.value=x,x=d(p,h,b,f);for(let S=0;S!==b;++S)x[S]=r[S];g.clippingState=x,this.numIntersection=v?this.numPlanes:0,this.numPlanes+=y}};function c(){l.value!==r&&(l.value=r,l.needsUpdate=i>0),t.numPlanes=i,t.numIntersection=0}function d(u,h,f,p){let v=u!==null?u.length:0,m=null;if(v!==0){if(m=l.value,p!==!0||m===null){let g=f+v*4,y=h.matrixWorldInverse;s.getNormalMatrix(y),(m===null||m.length<g)&&(m=new Float32Array(g));for(let b=0,x=f;b!==v;++b,x+=4)o.copy(u[b]).applyMatrix4(y,s),o.normal.toArray(m,x),m[x+3]=o.constant}l.value=m,l.needsUpdate=!0}return t.numPlanes=v,t.numIntersection=0,m}}function $ye(e){let t=new WeakMap;function r(o,s){return s===MA?o.mapping=th:s===EA&&(o.mapping=rh),o}function i(o){if(o&&o.isTexture&&o.isRenderTargetTexture===!1){let s=o.mapping;if(s===MA||s===EA)if(t.has(o)){let l=t.get(o).texture;return r(l,o.mapping)}else{let l=o.image;if(l&&l.height>0){let c=new age(l.height/2);return c.fromEquirectangularTexture(e,o),t.set(o,c),o.addEventListener("dispose",n),r(c.texture,o.mapping)}else return null}}return o}function n(o){let s=o.target;s.removeEventListener("dispose",n);let l=t.get(s);l!==void 0&&(t.delete(s),l.dispose())}function a(){t=new WeakMap}return{get:i,dispose:a}}var K1=class extends xh{constructor(e=-1,t=1,r=1,i=-1,n=.1,a=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=r,this.bottom=i,this.near=n,this.far=a,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,r,i,n,a){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=i,this.view.width=n,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,i=(this.top+this.bottom)/2,n=r-e,a=r+e,o=i+t,s=i-t;if(this.view!==null&&this.view.enabled){let l=(this.right-this.left)/this.view.fullWidth/this.zoom,c=(this.top-this.bottom)/this.view.fullHeight/this.zoom;n+=l*this.view.offsetX,a=n+l*this.view.width,o-=c*this.view.offsetY,s=o-c*this.view.height}this.projectionMatrix.makeOrthographic(n,a,o,s,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}},Tf=4,NI=[.125,.215,.35,.446,.526,.582],hu=20,tC=new K1,UI=new Lt,rC=null,au=(1+Math.sqrt(5))/2,Qh=1/au,jI=[new k(1,1,1),new k(-1,1,1),new k(1,1,-1),new k(-1,1,-1),new k(0,au,Qh),new k(0,au,-Qh),new k(Qh,0,au),new k(-Qh,0,au),new k(au,Qh,0),new k(-au,Qh,0)],VI=class{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,r=.1,i=100){rC=this._renderer.getRenderTarget(),this._setSize(256);let n=this._allocateTargets();return n.depthBuffer=!0,this._sceneToCubeUV(e,r,i,n),t>0&&this._blur(n,0,0,t),this._applyPMREM(n),this._cleanup(n),n}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=GI(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=WI(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(rC),e.scissorTest=!1,Z0(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===th||e.mapping===rh?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),rC=this._renderer.getRenderTarget();let r=t||this._allocateTargets();return this._textureToCubeUV(e,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(){let e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,r={magFilter:ur,minFilter:ur,generateMipmaps:!1,type:ec,format:In,encoding:hs,depthBuffer:!1},i=HI(e,t,r);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=HI(e,t,r);let{_lodMax:n}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=qye(n)),this._blurMaterial=Yye(n,e,t)}return i}_compileMaterial(e){let t=new Di(this._lodPlanes[0],e);this._renderer.compile(t,tC)}_sceneToCubeUV(e,t,r,i){let n=new da(90,1,t,r),a=[1,-1,1,1,1,1],o=[1,1,1,-1,-1,-1],s=this._renderer,l=s.autoClear,c=s.toneMapping;s.getClearColor(UI),s.toneMapping=Zs,s.autoClear=!1;let d=new tc({name:"PMREM.Background",side:Ln,depthWrite:!1,depthTest:!1}),u=new Di(new fs,d),h=!1,f=e.background;f?f.isColor&&(d.color.copy(f),e.background=null,h=!0):(d.color.copy(UI),h=!0);for(let p=0;p<6;p++){let v=p%3;v===0?(n.up.set(0,a[p],0),n.lookAt(o[p],0,0)):v===1?(n.up.set(0,0,a[p]),n.lookAt(0,o[p],0)):(n.up.set(0,a[p],0),n.lookAt(0,0,o[p]));let m=this._cubeSize;Z0(i,v*m,p>2?m:0,m,m),s.setRenderTarget(i),h&&s.render(u,n),s.render(e,n)}u.geometry.dispose(),u.material.dispose(),s.toneMapping=c,s.autoClear=l,e.background=f}_textureToCubeUV(e,t){let r=this._renderer,i=e.mapping===th||e.mapping===rh;i?(this._cubemapMaterial===null&&(this._cubemapMaterial=GI()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=WI());let n=i?this._cubemapMaterial:this._equirectMaterial,a=new Di(this._lodPlanes[0],n),o=n.uniforms;o.envMap.value=e;let s=this._cubeSize;Z0(t,0,0,3*s,2*s),r.setRenderTarget(t),r.render(a,tC)}_applyPMREM(e){let t=this._renderer,r=t.autoClear;t.autoClear=!1;for(let i=1;i<this._lodPlanes.length;i++){let n=Math.sqrt(this._sigmas[i]*this._sigmas[i]-this._sigmas[i-1]*this._sigmas[i-1]),a=jI[(i-1)%jI.length];this._blur(e,i-1,i,n,a)}t.autoClear=r}_blur(e,t,r,i,n){let a=this._pingPongRenderTarget;this._halfBlur(e,a,t,r,i,"latitudinal",n),this._halfBlur(a,e,r,r,i,"longitudinal",n)}_halfBlur(e,t,r,i,n,a,o){let s=this._renderer,l=this._blurMaterial;a!=="latitudinal"&&a!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");let c=3,d=new Di(this._lodPlanes[i],l),u=l.uniforms,h=this._sizeLods[r]-1,f=isFinite(n)?Math.PI/(2*h):2*Math.PI/(2*hu-1),p=n/f,v=isFinite(n)?1+Math.floor(c*p):hu;v>hu&&console.warn(`sigmaRadians, ${n}, is too large and will clip, as it requested ${v} samples when the maximum is set to ${hu}`);let m=[],g=0;for(let w=0;w<hu;++w){let _=w/p,C=Math.exp(-_*_/2);m.push(C),w===0?g+=C:w<v&&(g+=2*C)}for(let w=0;w<m.length;w++)m[w]=m[w]/g;u.envMap.value=e.texture,u.samples.value=v,u.weights.value=m,u.latitudinal.value=a==="latitudinal",o&&(u.poleAxis.value=o);let{_lodMax:y}=this;u.dTheta.value=f,u.mipInt.value=y-r;let b=this._sizeLods[i],x=3*b*(i>y-Tf?i-y+Tf:0),S=4*(this._cubeSize-b);Z0(t,x,S,3*b,2*b),s.setRenderTarget(t),s.render(d,tC)}};function qye(e){let t=[],r=[],i=[],n=e,a=e-Tf+1+NI.length;for(let o=0;o<a;o++){let s=Math.pow(2,n);r.push(s);let l=1/s;o>e-Tf?l=NI[o-e+Tf-1]:o===0&&(l=0),i.push(l);let c=1/(s-2),d=-c,u=1+c,h=[d,d,u,d,u,u,d,d,u,u,d,u],f=6,p=6,v=3,m=2,g=1,y=new Float32Array(v*p*f),b=new Float32Array(m*p*f),x=new Float32Array(g*p*f);for(let w=0;w<f;w++){let _=w%3*2/3-1,C=w>2?0:-1,A=[_,C,0,_+2/3,C,0,_+2/3,C+1,0,_,C,0,_+2/3,C+1,0,_,C+1,0];y.set(A,v*p*w),b.set(h,m*p*w);let M=[w,w,w,w,w,w];x.set(M,g*p*w)}let S=new Ot;S.setAttribute("position",new $t(y,v)),S.setAttribute("uv",new $t(b,m)),S.setAttribute("faceIndex",new $t(x,g)),t.push(S),n>Tf&&n--}return{lodPlanes:t,sizeLods:r,sigmas:i}}function HI(e,t,r){let i=new Ur(e,t,r);return i.texture.mapping=Hg,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function Z0(e,t,r,i,n){e.viewport.set(t,r,i,n),e.scissor.set(t,r,i,n)}function Yye(e,t,r){let i=new Float32Array(hu),n=new k(0,1,0);return new jr({name:"SphericalGaussianBlur",defines:{n:hu,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/r,CUBEUV_MAX_MIP:`${e}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:n}},vertexShader:iP(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:ln,depthTest:!1,depthWrite:!1})}function WI(){return new jr({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:iP(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:ln,depthTest:!1,depthWrite:!1})}function GI(){return new jr({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:iP(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:ln,depthTest:!1,depthWrite:!1})}function iP(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function Xye(e){let t=new WeakMap,r=null;function i(s){if(s&&s.isTexture){let l=s.mapping,c=l===MA||l===EA,d=l===th||l===rh;if(c||d)if(s.isRenderTargetTexture&&s.needsPMREMUpdate===!0){s.needsPMREMUpdate=!1;let u=t.get(s);return r===null&&(r=new VI(e)),u=c?r.fromEquirectangular(s,u):r.fromCubemap(s,u),t.set(s,u),u.texture}else{if(t.has(s))return t.get(s).texture;{let u=s.image;if(c&&u&&u.height>0||d&&u&&n(u)){r===null&&(r=new VI(e));let h=c?r.fromEquirectangular(s):r.fromCubemap(s);return t.set(s,h),s.addEventListener("dispose",a),h.texture}else return null}}}return s}function n(s){let l=0,c=6;for(let d=0;d<c;d++)s[d]!==void 0&&l++;return l===c}function a(s){let l=s.target;l.removeEventListener("dispose",a);let c=t.get(l);c!==void 0&&(t.delete(l),c.dispose())}function o(){t=new WeakMap,r!==null&&(r.dispose(),r=null)}return{get:i,dispose:o}}function Kye(e){let t={};function r(i){if(t[i]!==void 0)return t[i];let n;switch(i){case"WEBGL_depth_texture":n=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":n=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:n=e.getExtension(i)}return t[i]=n,n}return{has:function(i){return r(i)!==null},init:function(i){i.isWebGL2?r("EXT_color_buffer_float"):(r("WEBGL_depth_texture"),r("OES_texture_float"),r("OES_texture_half_float"),r("OES_texture_half_float_linear"),r("OES_standard_derivatives"),r("OES_element_index_uint"),r("OES_vertex_array_object"),r("ANGLE_instanced_arrays")),r("OES_texture_float_linear"),r("EXT_color_buffer_half_float"),r("WEBGL_multisampled_render_to_texture")},get:function(i){let n=r(i);return n===null&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),n}}}function Qye(e,t,r,i){let n={},a=new WeakMap;function o(u){let h=u.target;h.index!==null&&t.remove(h.index);for(let p in h.attributes)t.remove(h.attributes[p]);h.removeEventListener("dispose",o),delete n[h.id];let f=a.get(h);f&&(t.remove(f),a.delete(h)),i.releaseStatesOfGeometry(h),h.isInstancedBufferGeometry===!0&&delete h._maxInstanceCount,r.memory.geometries--}function s(u,h){return n[h.id]===!0||(h.addEventListener("dispose",o),n[h.id]=!0,r.memory.geometries++),h}function l(u){let h=u.attributes;for(let p in h)t.update(h[p],34962);let f=u.morphAttributes;for(let p in f){let v=f[p];for(let m=0,g=v.length;m<g;m++)t.update(v[m],34962)}}function c(u){let h=[],f=u.index,p=u.attributes.position,v=0;if(f!==null){let y=f.array;v=f.version;for(let b=0,x=y.length;b<x;b+=3){let S=y[b+0],w=y[b+1],_=y[b+2];h.push(S,w,w,_,_,S)}}else{let y=p.array;v=p.version;for(let b=0,x=y.length/3-1;b<x;b+=3){let S=b+0,w=b+1,_=b+2;h.push(S,w,w,_,_,S)}}let m=new(dj(h)?Vf:mj)(h,1);m.version=v;let g=a.get(u);g&&t.remove(g),a.set(u,m)}function d(u){let h=a.get(u);if(h){let f=u.index;f!==null&&h.version<f.version&&c(u)}else c(u);return a.get(u)}return{get:s,update:l,getWireframeAttribute:d}}function Zye(e,t,r,i){let n=i.isWebGL2,a;function o(h){a=h}let s,l;function c(h){s=h.type,l=h.bytesPerElement}function d(h,f){e.drawElements(a,f,s,h*l),r.update(f,a,1)}function u(h,f,p){if(p===0)return;let v,m;if(n)v=e,m="drawElementsInstanced";else if(v=t.get("ANGLE_instanced_arrays"),m="drawElementsInstancedANGLE",v===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}v[m](a,f,s,h*l,p),r.update(f,a,p)}this.setMode=o,this.setIndex=c,this.render=d,this.renderInstances=u}function Jye(e){let t={geometries:0,textures:0},r={frame:0,calls:0,triangles:0,points:0,lines:0};function i(a,o,s){switch(r.calls++,o){case 4:r.triangles+=s*(a/3);break;case 1:r.lines+=s*(a/2);break;case 3:r.lines+=s*(a-1);break;case 2:r.lines+=s*a;break;case 0:r.points+=s*a;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function n(){r.frame++,r.calls=0,r.triangles=0,r.points=0,r.lines=0}return{memory:t,render:r,programs:null,autoReset:!0,reset:n,update:i}}function ebe(e,t){return e[0]-t[0]}function tbe(e,t){return Math.abs(t[1])-Math.abs(e[1])}function rbe(e,t,r){let i={},n=new Float32Array(8),a=new WeakMap,o=new Kt,s=[];for(let c=0;c<8;c++)s[c]=[c,0];function l(c,d,u,h){let f=c.morphTargetInfluences;if(t.isWebGL2===!0){let p=d.morphAttributes.position||d.morphAttributes.normal||d.morphAttributes.color,v=p!==void 0?p.length:0,m=a.get(d);if(m===void 0||m.count!==v){let b=function(){z.dispose(),a.delete(d),d.removeEventListener("dispose",b)};m!==void 0&&m.texture.dispose();let x=d.morphAttributes.position!==void 0,S=d.morphAttributes.normal!==void 0,w=d.morphAttributes.color!==void 0,_=d.morphAttributes.position||[],C=d.morphAttributes.normal||[],A=d.morphAttributes.color||[],M=0;x===!0&&(M=1),S===!0&&(M=2),w===!0&&(M=3);let P=d.attributes.position.count*M,T=1;P>t.maxTextureSize&&(T=Math.ceil(P/t.maxTextureSize),P=t.maxTextureSize);let R=new Float32Array(P*T*4*v),z=new pj(R,P,T,v);z.type=on,z.needsUpdate=!0;let F=M*4;for(let H=0;H<v;H++){let N=_[H],U=C[H],ie=A[H],te=P*T*4*H;for(let X=0;X<N.count;X++){let W=X*F;x===!0&&(o.fromBufferAttribute(N,X),R[te+W+0]=o.x,R[te+W+1]=o.y,R[te+W+2]=o.z,R[te+W+3]=0),S===!0&&(o.fromBufferAttribute(U,X),R[te+W+4]=o.x,R[te+W+5]=o.y,R[te+W+6]=o.z,R[te+W+7]=0),w===!0&&(o.fromBufferAttribute(ie,X),R[te+W+8]=o.x,R[te+W+9]=o.y,R[te+W+10]=o.z,R[te+W+11]=ie.itemSize===4?o.w:1)}}m={count:v,texture:z,size:new ye(P,T)},a.set(d,m),d.addEventListener("dispose",b)}let g=0;for(let b=0;b<f.length;b++)g+=f[b];let y=d.morphTargetsRelative?1:1-g;h.getUniforms().setValue(e,"morphTargetBaseInfluence",y),h.getUniforms().setValue(e,"morphTargetInfluences",f),h.getUniforms().setValue(e,"morphTargetsTexture",m.texture,r),h.getUniforms().setValue(e,"morphTargetsTextureSize",m.size)}else{let p=f===void 0?0:f.length,v=i[d.id];if(v===void 0||v.length!==p){v=[];for(let x=0;x<p;x++)v[x]=[x,0];i[d.id]=v}for(let x=0;x<p;x++){let S=v[x];S[0]=x,S[1]=f[x]}v.sort(tbe);for(let x=0;x<8;x++)x<p&&v[x][1]?(s[x][0]=v[x][0],s[x][1]=v[x][1]):(s[x][0]=Number.MAX_SAFE_INTEGER,s[x][1]=0);s.sort(ebe);let m=d.morphAttributes.position,g=d.morphAttributes.normal,y=0;for(let x=0;x<8;x++){let S=s[x],w=S[0],_=S[1];w!==Number.MAX_SAFE_INTEGER&&_?(m&&d.getAttribute("morphTarget"+x)!==m[w]&&d.setAttribute("morphTarget"+x,m[w]),g&&d.getAttribute("morphNormal"+x)!==g[w]&&d.setAttribute("morphNormal"+x,g[w]),n[x]=_,y+=_):(m&&d.hasAttribute("morphTarget"+x)===!0&&d.deleteAttribute("morphTarget"+x),g&&d.hasAttribute("morphNormal"+x)===!0&&d.deleteAttribute("morphNormal"+x),n[x]=0)}let b=d.morphTargetsRelative?1:1-y;h.getUniforms().setValue(e,"morphTargetBaseInfluence",b),h.getUniforms().setValue(e,"morphTargetInfluences",n)}}return{update:l}}function ibe(e,t,r,i){let n=new WeakMap;function a(l){let c=i.render.frame,d=l.geometry,u=t.get(l,d);return n.get(u)!==c&&(t.update(u),n.set(u,c)),l.isInstancedMesh&&(l.hasEventListener("dispose",s)===!1&&l.addEventListener("dispose",s),r.update(l.instanceMatrix,34962),l.instanceColor!==null&&r.update(l.instanceColor,34962)),u}function o(){n=new WeakMap}function s(l){let c=l.target;c.removeEventListener("dispose",s),r.remove(c.instanceMatrix),c.instanceColor!==null&&r.remove(c.instanceColor)}return{update:a,dispose:o}}var yj=new Oi,bj=new pj,xj=new Hve,wj=new tP,$I=[],qI=[],YI=new Float32Array(16),XI=new Float32Array(9),KI=new Float32Array(4);function Hp(e,t,r){let i=e[0];if(i<=0||i>0)return e;let n=t*r,a=$I[n];if(a===void 0&&(a=new Float32Array(n),$I[n]=a),t!==0){i.toArray(a,0);for(let o=1,s=0;o!==t;++o)s+=r,e[o].toArray(a,s)}return a}function wn(e,t){if(e.length!==t.length)return!1;for(let r=0,i=e.length;r<i;r++)if(e[r]!==t[r])return!1;return!0}function Sn(e,t){for(let r=0,i=t.length;r<i;r++)e[r]=t[r]}function Q1(e,t){let r=qI[t];r===void 0&&(r=new Int32Array(t),qI[t]=r);for(let i=0;i!==t;++i)r[i]=e.allocateTextureUnit();return r}function nbe(e,t){let r=this.cache;r[0]!==t&&(e.uniform1f(this.addr,t),r[0]=t)}function abe(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y)&&(e.uniform2f(this.addr,t.x,t.y),r[0]=t.x,r[1]=t.y);else{if(wn(r,t))return;e.uniform2fv(this.addr,t),Sn(r,t)}}function obe(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z)&&(e.uniform3f(this.addr,t.x,t.y,t.z),r[0]=t.x,r[1]=t.y,r[2]=t.z);else if(t.r!==void 0)(r[0]!==t.r||r[1]!==t.g||r[2]!==t.b)&&(e.uniform3f(this.addr,t.r,t.g,t.b),r[0]=t.r,r[1]=t.g,r[2]=t.b);else{if(wn(r,t))return;e.uniform3fv(this.addr,t),Sn(r,t)}}function sbe(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z||r[3]!==t.w)&&(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=t.w);else{if(wn(r,t))return;e.uniform4fv(this.addr,t),Sn(r,t)}}function lbe(e,t){let r=this.cache,i=t.elements;if(i===void 0){if(wn(r,t))return;e.uniformMatrix2fv(this.addr,!1,t),Sn(r,t)}else{if(wn(r,i))return;KI.set(i),e.uniformMatrix2fv(this.addr,!1,KI),Sn(r,i)}}function cbe(e,t){let r=this.cache,i=t.elements;if(i===void 0){if(wn(r,t))return;e.uniformMatrix3fv(this.addr,!1,t),Sn(r,t)}else{if(wn(r,i))return;XI.set(i),e.uniformMatrix3fv(this.addr,!1,XI),Sn(r,i)}}function dbe(e,t){let r=this.cache,i=t.elements;if(i===void 0){if(wn(r,t))return;e.uniformMatrix4fv(this.addr,!1,t),Sn(r,t)}else{if(wn(r,i))return;YI.set(i),e.uniformMatrix4fv(this.addr,!1,YI),Sn(r,i)}}function ube(e,t){let r=this.cache;r[0]!==t&&(e.uniform1i(this.addr,t),r[0]=t)}function hbe(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y)&&(e.uniform2i(this.addr,t.x,t.y),r[0]=t.x,r[1]=t.y);else{if(wn(r,t))return;e.uniform2iv(this.addr,t),Sn(r,t)}}function fbe(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z)&&(e.uniform3i(this.addr,t.x,t.y,t.z),r[0]=t.x,r[1]=t.y,r[2]=t.z);else{if(wn(r,t))return;e.uniform3iv(this.addr,t),Sn(r,t)}}function pbe(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z||r[3]!==t.w)&&(e.uniform4i(this.addr,t.x,t.y,t.z,t.w),r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=t.w);else{if(wn(r,t))return;e.uniform4iv(this.addr,t),Sn(r,t)}}function mbe(e,t){let r=this.cache;r[0]!==t&&(e.uniform1ui(this.addr,t),r[0]=t)}function vbe(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y)&&(e.uniform2ui(this.addr,t.x,t.y),r[0]=t.x,r[1]=t.y);else{if(wn(r,t))return;e.uniform2uiv(this.addr,t),Sn(r,t)}}function gbe(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z)&&(e.uniform3ui(this.addr,t.x,t.y,t.z),r[0]=t.x,r[1]=t.y,r[2]=t.z);else{if(wn(r,t))return;e.uniform3uiv(this.addr,t),Sn(r,t)}}function ybe(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z||r[3]!==t.w)&&(e.uniform4ui(this.addr,t.x,t.y,t.z,t.w),r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=t.w);else{if(wn(r,t))return;e.uniform4uiv(this.addr,t),Sn(r,t)}}function bbe(e,t,r){let i=this.cache,n=r.allocateTextureUnit();i[0]!==n&&(e.uniform1i(this.addr,n),i[0]=n),r.setTexture2D(t||yj,n)}function xbe(e,t,r){let i=this.cache,n=r.allocateTextureUnit();i[0]!==n&&(e.uniform1i(this.addr,n),i[0]=n),r.setTexture3D(t||xj,n)}function wbe(e,t,r){let i=this.cache,n=r.allocateTextureUnit();i[0]!==n&&(e.uniform1i(this.addr,n),i[0]=n),r.setTextureCube(t||wj,n)}function Sbe(e,t,r){let i=this.cache,n=r.allocateTextureUnit();i[0]!==n&&(e.uniform1i(this.addr,n),i[0]=n),r.setTexture2DArray(t||bj,n)}function Cbe(e){switch(e){case 5126:return nbe;case 35664:return abe;case 35665:return obe;case 35666:return sbe;case 35674:return lbe;case 35675:return cbe;case 35676:return dbe;case 5124:case 35670:return ube;case 35667:case 35671:return hbe;case 35668:case 35672:return fbe;case 35669:case 35673:return pbe;case 5125:return mbe;case 36294:return vbe;case 36295:return gbe;case 36296:return ybe;case 35678:case 36198:case 36298:case 36306:case 35682:return bbe;case 35679:case 36299:case 36307:return xbe;case 35680:case 36300:case 36308:case 36293:return wbe;case 36289:case 36303:case 36311:case 36292:return Sbe}}function _be(e,t){e.uniform1fv(this.addr,t)}function Abe(e,t){let r=Hp(t,this.size,2);e.uniform2fv(this.addr,r)}function Mbe(e,t){let r=Hp(t,this.size,3);e.uniform3fv(this.addr,r)}function Ebe(e,t){let r=Hp(t,this.size,4);e.uniform4fv(this.addr,r)}function Tbe(e,t){let r=Hp(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,r)}function Pbe(e,t){let r=Hp(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,r)}function Dbe(e,t){let r=Hp(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,r)}function Obe(e,t){e.uniform1iv(this.addr,t)}function Rbe(e,t){e.uniform2iv(this.addr,t)}function Ibe(e,t){e.uniform3iv(this.addr,t)}function zbe(e,t){e.uniform4iv(this.addr,t)}function kbe(e,t){e.uniform1uiv(this.addr,t)}function Lbe(e,t){e.uniform2uiv(this.addr,t)}function Bbe(e,t){e.uniform3uiv(this.addr,t)}function Fbe(e,t){e.uniform4uiv(this.addr,t)}function Nbe(e,t,r){let i=this.cache,n=t.length,a=Q1(r,n);wn(i,a)||(e.uniform1iv(this.addr,a),Sn(i,a));for(let o=0;o!==n;++o)r.setTexture2D(t[o]||yj,a[o])}function Ube(e,t,r){let i=this.cache,n=t.length,a=Q1(r,n);wn(i,a)||(e.uniform1iv(this.addr,a),Sn(i,a));for(let o=0;o!==n;++o)r.setTexture3D(t[o]||xj,a[o])}function jbe(e,t,r){let i=this.cache,n=t.length,a=Q1(r,n);wn(i,a)||(e.uniform1iv(this.addr,a),Sn(i,a));for(let o=0;o!==n;++o)r.setTextureCube(t[o]||wj,a[o])}function Vbe(e,t,r){let i=this.cache,n=t.length,a=Q1(r,n);wn(i,a)||(e.uniform1iv(this.addr,a),Sn(i,a));for(let o=0;o!==n;++o)r.setTexture2DArray(t[o]||bj,a[o])}function Hbe(e){switch(e){case 5126:return _be;case 35664:return Abe;case 35665:return Mbe;case 35666:return Ebe;case 35674:return Tbe;case 35675:return Pbe;case 35676:return Dbe;case 5124:case 35670:return Obe;case 35667:case 35671:return Rbe;case 35668:case 35672:return Ibe;case 35669:case 35673:return zbe;case 5125:return kbe;case 36294:return Lbe;case 36295:return Bbe;case 36296:return Fbe;case 35678:case 36198:case 36298:case 36306:case 35682:return Nbe;case 35679:case 36299:case 36307:return Ube;case 35680:case 36300:case 36308:case 36293:return jbe;case 36289:case 36303:case 36311:case 36292:return Vbe}}var Wbe=class{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.setValue=Cbe(t.type)}},Gbe=class{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.size=t.size,this.setValue=Hbe(t.type)}},$be=class{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,r){let i=this.seq;for(let n=0,a=i.length;n!==a;++n){let o=i[n];o.setValue(e,t[o.id],r)}}},iC=/(\w+)(\])?(\[|\.)?/g;function QI(e,t){e.seq.push(t),e.map[t.id]=t}function qbe(e,t,r){let i=e.name,n=i.length;for(iC.lastIndex=0;;){let a=iC.exec(i),o=iC.lastIndex,s=a[1],l=a[2]==="]",c=a[3];if(l&&(s=s|0),c===void 0||c==="["&&o+2===n){QI(r,c===void 0?new Wbe(s,e,t):new Gbe(s,e,t));break}else{let d=r.map[s];d===void 0&&(d=new $be(s),QI(r,d)),r=d}}}var pb=class{constructor(e,t){this.seq=[],this.map={};let r=e.getProgramParameter(t,35718);for(let i=0;i<r;++i){let n=e.getActiveUniform(t,i),a=e.getUniformLocation(t,n.name);qbe(n,a,this)}}setValue(e,t,r,i){let n=this.map[t];n!==void 0&&n.setValue(e,r,i)}setOptional(e,t,r){let i=t[r];i!==void 0&&this.setValue(e,r,i)}static upload(e,t,r,i){for(let n=0,a=t.length;n!==a;++n){let o=t[n],s=r[o.id];s.needsUpdate!==!1&&o.setValue(e,s.value,i)}}static seqWithValue(e,t){let r=[];for(let i=0,n=e.length;i!==n;++i){let a=e[i];a.id in t&&r.push(a)}return r}};function ZI(e,t,r){let i=e.createShader(t);return e.shaderSource(i,r),e.compileShader(i),i}var Ybe=0;function Xbe(e,t){let r=e.split(`
`),i=[],n=Math.max(t-6,0),a=Math.min(t+6,r.length);for(let o=n;o<a;o++){let s=o+1;i.push(`${s===t?">":" "} ${s}: ${r[o]}`)}return i.join(`
`)}function Kbe(e){switch(e){case hs:return["Linear","( value )"];case sr:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",e),["Linear","( value )"]}}function JI(e,t,r){let i=e.getShaderParameter(t,35713),n=e.getShaderInfoLog(t).trim();if(i&&n==="")return"";let a=/ERROR: 0:(\d+)/.exec(n);if(a){let o=parseInt(a[1]);return r.toUpperCase()+`

`+n+`

`+Xbe(e.getShaderSource(t),o)}else return n}function Qbe(e,t){let r=Kbe(t);return"vec4 "+e+"( vec4 value ) { return LinearTo"+r[0]+r[1]+"; }"}function Zbe(e,t){let r;switch(t){case nve:r="Linear";break;case ave:r="Reinhard";break;case ove:r="OptimizedCineon";break;case sve:r="ACESFilmic";break;case lve:r="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),r="Linear"}return"vec3 "+e+"( vec3 color ) { return "+r+"ToneMapping( color ); }"}function Jbe(e){return[e.extensionDerivatives||e.envMapCubeUVHeight||e.bumpMap||e.tangentSpaceNormalMap||e.clearcoatNormalMap||e.flatShading||e.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(e.extensionFragDepth||e.logarithmicDepthBuffer)&&e.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",e.extensionDrawBuffers&&e.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(e.extensionShaderTextureLOD||e.envMap||e.transmission)&&e.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Jm).join(`
`)}function exe(e){let t=[];for(let r in e){let i=e[r];i!==!1&&t.push("#define "+r+" "+i)}return t.join(`
`)}function txe(e,t){let r={},i=e.getProgramParameter(t,35721);for(let n=0;n<i;n++){let a=e.getActiveAttrib(t,n),o=a.name,s=1;a.type===35674&&(s=2),a.type===35675&&(s=3),a.type===35676&&(s=4),r[o]={type:a.type,location:e.getAttribLocation(t,o),locationSize:s}}return r}function Jm(e){return e!==""}function ez(e,t){let r=t.numSpotLightShadows+t.numSpotLightMaps-t.numSpotLightShadowsWithMaps;return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,t.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,r).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,t.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function tz(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}var rxe=/^[ \t]*#include +<([\w\d./]+)>/gm;function RA(e){return e.replace(rxe,ixe)}function ixe(e,t){let r=lr[t];if(r===void 0)throw new Error("Can not resolve #include <"+t+">");return RA(r)}var nxe=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function rz(e){return e.replace(nxe,axe)}function axe(e,t,r,i){let n="";for(let a=parseInt(t);a<parseInt(r);a++)n+=i.replace(/\[\s*i\s*\]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a);return n}function iz(e){let t="precision "+e.precision+` float;
precision `+e.precision+" int;";return e.precision==="highp"?t+=`
#define HIGH_PRECISION`:e.precision==="mediump"?t+=`
#define MEDIUM_PRECISION`:e.precision==="lowp"&&(t+=`
#define LOW_PRECISION`),t}function oxe(e){let t="SHADOWMAP_TYPE_BASIC";return e.shadowMapType===KT?t="SHADOWMAP_TYPE_PCF":e.shadowMapType===Lme?t="SHADOWMAP_TYPE_PCF_SOFT":e.shadowMapType===Zm&&(t="SHADOWMAP_TYPE_VSM"),t}function sxe(e){let t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case th:case rh:t="ENVMAP_TYPE_CUBE";break;case Hg:t="ENVMAP_TYPE_CUBE_UV";break}return t}function lxe(e){let t="ENVMAP_MODE_REFLECTION";if(e.envMap)switch(e.envMapMode){case rh:t="ENVMAP_MODE_REFRACTION";break}return t}function cxe(e){let t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case rj:t="ENVMAP_BLENDING_MULTIPLY";break;case rve:t="ENVMAP_BLENDING_MIX";break;case ive:t="ENVMAP_BLENDING_ADD";break}return t}function dxe(e){let t=e.envMapCubeUVHeight;if(t===null)return null;let r=Math.log2(t)-2,i=1/t;return{texelWidth:1/(3*Math.max(Math.pow(2,r),7*16)),texelHeight:i,maxMip:r}}function uxe(e,t,r,i){let n=e.getContext(),a=r.defines,o=r.vertexShader,s=r.fragmentShader,l=oxe(r),c=sxe(r),d=lxe(r),u=cxe(r),h=dxe(r),f=r.isWebGL2?"":Jbe(r),p=exe(a),v=n.createProgram(),m,g,y=r.glslVersion?"#version "+r.glslVersion+`
`:"";r.isRawShaderMaterial?(m=[p].filter(Jm).join(`
`),m.length>0&&(m+=`
`),g=[f,p].filter(Jm).join(`
`),g.length>0&&(g+=`
`)):(m=[iz(r),"#define SHADER_NAME "+r.shaderName,p,r.instancing?"#define USE_INSTANCING":"",r.instancingColor?"#define USE_INSTANCING_COLOR":"",r.supportsVertexTextures?"#define VERTEX_TEXTURES":"",r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+d:"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMap&&r.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",r.normalMap&&r.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",r.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",r.displacementMap&&r.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",r.specularColorMap?"#define USE_SPECULARCOLORMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.transmission?"#define USE_TRANSMISSION":"",r.transmissionMap?"#define USE_TRANSMISSIONMAP":"",r.thicknessMap?"#define USE_THICKNESSMAP":"",r.sheenColorMap?"#define USE_SHEENCOLORMAP":"",r.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",r.vertexTangents?"#define USE_TANGENT":"",r.vertexColors?"#define USE_COLOR":"",r.vertexAlphas?"#define USE_COLOR_ALPHA":"",r.vertexUvs?"#define USE_UV":"",r.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",r.flatShading?"#define FLAT_SHADED":"",r.skinning?"#define USE_SKINNING":"",r.morphTargets?"#define USE_MORPHTARGETS":"",r.morphNormals&&r.flatShading===!1?"#define USE_MORPHNORMALS":"",r.morphColors&&r.isWebGL2?"#define USE_MORPHCOLORS":"",r.morphTargetsCount>0&&r.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",r.morphTargetsCount>0&&r.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+r.morphTextureStride:"",r.morphTargetsCount>0&&r.isWebGL2?"#define MORPHTARGETS_COUNT "+r.morphTargetsCount:"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+l:"",r.sizeAttenuation?"#define USE_SIZEATTENUATION":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.logarithmicDepthBuffer&&r.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Jm).join(`
`),g=[f,iz(r),"#define SHADER_NAME "+r.shaderName,p,r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.matcap?"#define USE_MATCAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+c:"",r.envMap?"#define "+d:"",r.envMap?"#define "+u:"",h?"#define CUBEUV_TEXEL_WIDTH "+h.texelWidth:"",h?"#define CUBEUV_TEXEL_HEIGHT "+h.texelHeight:"",h?"#define CUBEUV_MAX_MIP "+h.maxMip+".0":"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMap&&r.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",r.normalMap&&r.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",r.clearcoat?"#define USE_CLEARCOAT":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.iridescence?"#define USE_IRIDESCENCE":"",r.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",r.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",r.specularColorMap?"#define USE_SPECULARCOLORMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.alphaTest?"#define USE_ALPHATEST":"",r.sheen?"#define USE_SHEEN":"",r.sheenColorMap?"#define USE_SHEENCOLORMAP":"",r.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",r.transmission?"#define USE_TRANSMISSION":"",r.transmissionMap?"#define USE_TRANSMISSIONMAP":"",r.thicknessMap?"#define USE_THICKNESSMAP":"",r.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",r.vertexTangents?"#define USE_TANGENT":"",r.vertexColors||r.instancingColor?"#define USE_COLOR":"",r.vertexAlphas?"#define USE_COLOR_ALPHA":"",r.vertexUvs?"#define USE_UV":"",r.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",r.gradientMap?"#define USE_GRADIENTMAP":"",r.flatShading?"#define FLAT_SHADED":"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+l:"",r.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",r.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.logarithmicDepthBuffer&&r.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",r.toneMapping!==Zs?"#define TONE_MAPPING":"",r.toneMapping!==Zs?lr.tonemapping_pars_fragment:"",r.toneMapping!==Zs?Zbe("toneMapping",r.toneMapping):"",r.dithering?"#define DITHERING":"",r.opaque?"#define OPAQUE":"",lr.encodings_pars_fragment,Qbe("linearToOutputTexel",r.outputEncoding),r.useDepthPacking?"#define DEPTH_PACKING "+r.depthPacking:"",`
`].filter(Jm).join(`
`)),o=RA(o),o=ez(o,r),o=tz(o,r),s=RA(s),s=ez(s,r),s=tz(s,r),o=rz(o),s=rz(s),r.isWebGL2&&r.isRawShaderMaterial!==!0&&(y=`#version 300 es
`,m=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+m,g=["#define varying in",r.glslVersion===EI?"":"layout(location = 0) out highp vec4 pc_fragColor;",r.glslVersion===EI?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+g);let b=y+m+o,x=y+g+s,S=ZI(n,35633,b),w=ZI(n,35632,x);if(n.attachShader(v,S),n.attachShader(v,w),r.index0AttributeName!==void 0?n.bindAttribLocation(v,0,r.index0AttributeName):r.morphTargets===!0&&n.bindAttribLocation(v,0,"position"),n.linkProgram(v),e.debug.checkShaderErrors){let A=n.getProgramInfoLog(v).trim(),M=n.getShaderInfoLog(S).trim(),P=n.getShaderInfoLog(w).trim(),T=!0,R=!0;if(n.getProgramParameter(v,35714)===!1){T=!1;let z=JI(n,S,"vertex"),F=JI(n,w,"fragment");console.error("THREE.WebGLProgram: Shader Error "+n.getError()+" - VALIDATE_STATUS "+n.getProgramParameter(v,35715)+`

Program Info Log: `+A+`
`+z+`
`+F)}else A!==""?console.warn("THREE.WebGLProgram: Program Info Log:",A):(M===""||P==="")&&(R=!1);R&&(this.diagnostics={runnable:T,programLog:A,vertexShader:{log:M,prefix:m},fragmentShader:{log:P,prefix:g}})}n.deleteShader(S),n.deleteShader(w);let _;this.getUniforms=function(){return _===void 0&&(_=new pb(n,v)),_};let C;return this.getAttributes=function(){return C===void 0&&(C=txe(n,v)),C},this.destroy=function(){i.releaseStatesOfProgram(this),n.deleteProgram(v),this.program=void 0},this.name=r.shaderName,this.id=Ybe++,this.cacheKey=t,this.usedTimes=1,this.program=v,this.vertexShader=S,this.fragmentShader=w,this}var hxe=0,fxe=class{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){let t=e.vertexShader,r=e.fragmentShader,i=this._getShaderStage(t),n=this._getShaderStage(r),a=this._getShaderCacheForMaterial(e);return a.has(i)===!1&&(a.add(i),i.usedTimes++),a.has(n)===!1&&(a.add(n),n.usedTimes++),this}remove(e){let t=this.materialCache.get(e);for(let r of t)r.usedTimes--,r.usedTimes===0&&this.shaderCache.delete(r.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){let t=this.materialCache,r=t.get(e);return r===void 0&&(r=new Set,t.set(e,r)),r}_getShaderStage(e){let t=this.shaderCache,r=t.get(e);return r===void 0&&(r=new pxe(e),t.set(e,r)),r}},pxe=class{constructor(e){this.id=hxe++,this.code=e,this.usedTimes=0}};function mxe(e,t,r,i,n,a,o){let s=new eP,l=new fxe,c=[],d=n.isWebGL2,u=n.logarithmicDepthBuffer,h=n.vertexTextures,f=n.precision,p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function v(C,A,M,P,T){let R=P.fog,z=T.geometry,F=C.isMeshStandardMaterial?P.environment:null,H=(C.isMeshStandardMaterial?r:t).get(C.envMap||F),N=H&&H.mapping===Hg?H.image.height:null,U=p[C.type];C.precision!==null&&(f=n.getMaxPrecision(C.precision),f!==C.precision&&console.warn("THREE.WebGLProgram.getParameters:",C.precision,"not supported, using",f,"instead."));let ie=z.morphAttributes.position||z.morphAttributes.normal||z.morphAttributes.color,te=ie!==void 0?ie.length:0,X=0;z.morphAttributes.position!==void 0&&(X=1),z.morphAttributes.normal!==void 0&&(X=2),z.morphAttributes.color!==void 0&&(X=3);let W,q,$,le;if(U){let de=Fs[U];W=de.vertexShader,q=de.fragmentShader}else W=C.vertexShader,q=C.fragmentShader,l.update(C),$=l.getVertexShaderID(C),le=l.getFragmentShaderID(C);let ee=e.getRenderTarget(),Q=C.alphaTest>0,ne=C.clearcoat>0,V=C.iridescence>0;return{isWebGL2:d,shaderID:U,shaderName:C.type,vertexShader:W,fragmentShader:q,defines:C.defines,customVertexShaderID:$,customFragmentShaderID:le,isRawShaderMaterial:C.isRawShaderMaterial===!0,glslVersion:C.glslVersion,precision:f,instancing:T.isInstancedMesh===!0,instancingColor:T.isInstancedMesh===!0&&T.instanceColor!==null,supportsVertexTextures:h,outputEncoding:ee===null?e.outputEncoding:ee.isXRRenderTarget===!0?ee.texture.encoding:hs,map:!!C.map,matcap:!!C.matcap,envMap:!!H,envMapMode:H&&H.mapping,envMapCubeUVHeight:N,lightMap:!!C.lightMap,aoMap:!!C.aoMap,emissiveMap:!!C.emissiveMap,bumpMap:!!C.bumpMap,normalMap:!!C.normalMap,objectSpaceNormalMap:C.normalMapType===Ave,tangentSpaceNormalMap:C.normalMapType===_ve,decodeVideoTexture:!!C.map&&C.map.isVideoTexture===!0&&C.map.encoding===sr,clearcoat:ne,clearcoatMap:ne&&!!C.clearcoatMap,clearcoatRoughnessMap:ne&&!!C.clearcoatRoughnessMap,clearcoatNormalMap:ne&&!!C.clearcoatNormalMap,iridescence:V,iridescenceMap:V&&!!C.iridescenceMap,iridescenceThicknessMap:V&&!!C.iridescenceThicknessMap,displacementMap:!!C.displacementMap,roughnessMap:!!C.roughnessMap,metalnessMap:!!C.metalnessMap,specularMap:!!C.specularMap,specularIntensityMap:!!C.specularIntensityMap,specularColorMap:!!C.specularColorMap,opaque:C.transparent===!1&&C.blending===Fu,alphaMap:!!C.alphaMap,alphaTest:Q,gradientMap:!!C.gradientMap,sheen:C.sheen>0,sheenColorMap:!!C.sheenColorMap,sheenRoughnessMap:!!C.sheenRoughnessMap,transmission:C.transmission>0,transmissionMap:!!C.transmissionMap,thicknessMap:!!C.thicknessMap,combine:C.combine,vertexTangents:!!C.normalMap&&!!z.attributes.tangent,vertexColors:C.vertexColors,vertexAlphas:C.vertexColors===!0&&!!z.attributes.color&&z.attributes.color.itemSize===4,vertexUvs:!!C.map||!!C.bumpMap||!!C.normalMap||!!C.specularMap||!!C.alphaMap||!!C.emissiveMap||!!C.roughnessMap||!!C.metalnessMap||!!C.clearcoatMap||!!C.clearcoatRoughnessMap||!!C.clearcoatNormalMap||!!C.iridescenceMap||!!C.iridescenceThicknessMap||!!C.displacementMap||!!C.transmissionMap||!!C.thicknessMap||!!C.specularIntensityMap||!!C.specularColorMap||!!C.sheenColorMap||!!C.sheenRoughnessMap,uvsVertexOnly:!(C.map||C.bumpMap||C.normalMap||C.specularMap||C.alphaMap||C.emissiveMap||C.roughnessMap||C.metalnessMap||C.clearcoatNormalMap||C.iridescenceMap||C.iridescenceThicknessMap||C.transmission>0||C.transmissionMap||C.thicknessMap||C.specularIntensityMap||C.specularColorMap||C.sheen>0||C.sheenColorMap||C.sheenRoughnessMap)&&!!C.displacementMap,fog:!!R,useFog:C.fog===!0,fogExp2:R&&R.isFogExp2,flatShading:!!C.flatShading,sizeAttenuation:C.sizeAttenuation,logarithmicDepthBuffer:u,skinning:T.isSkinnedMesh===!0,morphTargets:z.morphAttributes.position!==void 0,morphNormals:z.morphAttributes.normal!==void 0,morphColors:z.morphAttributes.color!==void 0,morphTargetsCount:te,morphTextureStride:X,numDirLights:A.directional.length,numPointLights:A.point.length,numSpotLights:A.spot.length,numSpotLightMaps:A.spotLightMap.length,numRectAreaLights:A.rectArea.length,numHemiLights:A.hemi.length,numDirLightShadows:A.directionalShadowMap.length,numPointLightShadows:A.pointShadowMap.length,numSpotLightShadows:A.spotShadowMap.length,numSpotLightShadowsWithMaps:A.numSpotLightShadowsWithMaps,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:C.dithering,shadowMapEnabled:e.shadowMap.enabled&&M.length>0,shadowMapType:e.shadowMap.type,toneMapping:C.toneMapped?e.toneMapping:Zs,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:C.premultipliedAlpha,doubleSided:C.side===fa,flipSided:C.side===Ln,useDepthPacking:!!C.depthPacking,depthPacking:C.depthPacking||0,index0AttributeName:C.index0AttributeName,extensionDerivatives:C.extensions&&C.extensions.derivatives,extensionFragDepth:C.extensions&&C.extensions.fragDepth,extensionDrawBuffers:C.extensions&&C.extensions.drawBuffers,extensionShaderTextureLOD:C.extensions&&C.extensions.shaderTextureLOD,rendererExtensionFragDepth:d||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:d||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:d||i.has("EXT_shader_texture_lod"),customProgramCacheKey:C.customProgramCacheKey()}}function m(C){let A=[];if(C.shaderID?A.push(C.shaderID):(A.push(C.customVertexShaderID),A.push(C.customFragmentShaderID)),C.defines!==void 0)for(let M in C.defines)A.push(M),A.push(C.defines[M]);return C.isRawShaderMaterial===!1&&(g(A,C),y(A,C),A.push(e.outputEncoding)),A.push(C.customProgramCacheKey),A.join()}function g(C,A){C.push(A.precision),C.push(A.outputEncoding),C.push(A.envMapMode),C.push(A.envMapCubeUVHeight),C.push(A.combine),C.push(A.vertexUvs),C.push(A.fogExp2),C.push(A.sizeAttenuation),C.push(A.morphTargetsCount),C.push(A.morphAttributeCount),C.push(A.numDirLights),C.push(A.numPointLights),C.push(A.numSpotLights),C.push(A.numSpotLightMaps),C.push(A.numHemiLights),C.push(A.numRectAreaLights),C.push(A.numDirLightShadows),C.push(A.numPointLightShadows),C.push(A.numSpotLightShadows),C.push(A.numSpotLightShadowsWithMaps),C.push(A.shadowMapType),C.push(A.toneMapping),C.push(A.numClippingPlanes),C.push(A.numClipIntersection),C.push(A.depthPacking)}function y(C,A){s.disableAll(),A.isWebGL2&&s.enable(0),A.supportsVertexTextures&&s.enable(1),A.instancing&&s.enable(2),A.instancingColor&&s.enable(3),A.map&&s.enable(4),A.matcap&&s.enable(5),A.envMap&&s.enable(6),A.lightMap&&s.enable(7),A.aoMap&&s.enable(8),A.emissiveMap&&s.enable(9),A.bumpMap&&s.enable(10),A.normalMap&&s.enable(11),A.objectSpaceNormalMap&&s.enable(12),A.tangentSpaceNormalMap&&s.enable(13),A.clearcoat&&s.enable(14),A.clearcoatMap&&s.enable(15),A.clearcoatRoughnessMap&&s.enable(16),A.clearcoatNormalMap&&s.enable(17),A.iridescence&&s.enable(18),A.iridescenceMap&&s.enable(19),A.iridescenceThicknessMap&&s.enable(20),A.displacementMap&&s.enable(21),A.specularMap&&s.enable(22),A.roughnessMap&&s.enable(23),A.metalnessMap&&s.enable(24),A.gradientMap&&s.enable(25),A.alphaMap&&s.enable(26),A.alphaTest&&s.enable(27),A.vertexColors&&s.enable(28),A.vertexAlphas&&s.enable(29),A.vertexUvs&&s.enable(30),A.vertexTangents&&s.enable(31),A.uvsVertexOnly&&s.enable(32),C.push(s.mask),s.disableAll(),A.fog&&s.enable(0),A.useFog&&s.enable(1),A.flatShading&&s.enable(2),A.logarithmicDepthBuffer&&s.enable(3),A.skinning&&s.enable(4),A.morphTargets&&s.enable(5),A.morphNormals&&s.enable(6),A.morphColors&&s.enable(7),A.premultipliedAlpha&&s.enable(8),A.shadowMapEnabled&&s.enable(9),A.physicallyCorrectLights&&s.enable(10),A.doubleSided&&s.enable(11),A.flipSided&&s.enable(12),A.useDepthPacking&&s.enable(13),A.dithering&&s.enable(14),A.specularIntensityMap&&s.enable(15),A.specularColorMap&&s.enable(16),A.transmission&&s.enable(17),A.transmissionMap&&s.enable(18),A.thicknessMap&&s.enable(19),A.sheen&&s.enable(20),A.sheenColorMap&&s.enable(21),A.sheenRoughnessMap&&s.enable(22),A.decodeVideoTexture&&s.enable(23),A.opaque&&s.enable(24),C.push(s.mask)}function b(C){let A=p[C.type],M;if(A){let P=Fs[A];M=Vp.clone(P.uniforms)}else M=C.uniforms;return M}function x(C,A){let M;for(let P=0,T=c.length;P<T;P++){let R=c[P];if(R.cacheKey===A){M=R,++M.usedTimes;break}}return M===void 0&&(M=new uxe(e,A,C,a),c.push(M)),M}function S(C){if(--C.usedTimes===0){let A=c.indexOf(C);c[A]=c[c.length-1],c.pop(),C.destroy()}}function w(C){l.remove(C)}function _(){l.dispose()}return{getParameters:v,getProgramCacheKey:m,getUniforms:b,acquireProgram:x,releaseProgram:S,releaseShaderCache:w,programs:c,dispose:_}}function vxe(){let e=new WeakMap;function t(a){let o=e.get(a);return o===void 0&&(o={},e.set(a,o)),o}function r(a){e.delete(a)}function i(a,o,s){e.get(a)[o]=s}function n(){e=new WeakMap}return{get:t,remove:r,update:i,dispose:n}}function gxe(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function nz(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function az(){let e=[],t=0,r=[],i=[],n=[];function a(){t=0,r.length=0,i.length=0,n.length=0}function o(u,h,f,p,v,m){let g=e[t];return g===void 0?(g={id:u.id,object:u,geometry:h,material:f,groupOrder:p,renderOrder:u.renderOrder,z:v,group:m},e[t]=g):(g.id=u.id,g.object=u,g.geometry=h,g.material=f,g.groupOrder=p,g.renderOrder=u.renderOrder,g.z=v,g.group=m),t++,g}function s(u,h,f,p,v,m){let g=o(u,h,f,p,v,m);f.transmission>0?i.push(g):f.transparent===!0?n.push(g):r.push(g)}function l(u,h,f,p,v,m){let g=o(u,h,f,p,v,m);f.transmission>0?i.unshift(g):f.transparent===!0?n.unshift(g):r.unshift(g)}function c(u,h){r.length>1&&r.sort(u||gxe),i.length>1&&i.sort(h||nz),n.length>1&&n.sort(h||nz)}function d(){for(let u=t,h=e.length;u<h;u++){let f=e[u];if(f.id===null)break;f.id=null,f.object=null,f.geometry=null,f.material=null,f.group=null}}return{opaque:r,transmissive:i,transparent:n,init:a,push:s,unshift:l,finish:d,sort:c}}function yxe(){let e=new WeakMap;function t(i,n){let a=e.get(i),o;return a===void 0?(o=new az,e.set(i,[o])):n>=a.length?(o=new az,a.push(o)):o=a[n],o}function r(){e=new WeakMap}return{get:t,dispose:r}}function bxe(){let e={};return{get:function(t){if(e[t.id]!==void 0)return e[t.id];let r;switch(t.type){case"DirectionalLight":r={direction:new k,color:new Lt};break;case"SpotLight":r={position:new k,direction:new k,color:new Lt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":r={position:new k,color:new Lt,distance:0,decay:0};break;case"HemisphereLight":r={direction:new k,skyColor:new Lt,groundColor:new Lt};break;case"RectAreaLight":r={color:new Lt,position:new k,halfWidth:new k,halfHeight:new k};break}return e[t.id]=r,r}}}function xxe(){let e={};return{get:function(t){if(e[t.id]!==void 0)return e[t.id];let r;switch(t.type){case"DirectionalLight":r={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ye};break;case"SpotLight":r={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ye};break;case"PointLight":r={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ye,shadowCameraNear:1,shadowCameraFar:1e3};break}return e[t.id]=r,r}}}var wxe=0;function Sxe(e,t){return(t.castShadow?2:0)-(e.castShadow?2:0)+(t.map?1:0)-(e.map?1:0)}function Cxe(e,t){let r=new bxe,i=xxe(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let d=0;d<9;d++)n.probe.push(new k);let a=new k,o=new it,s=new it;function l(d,u){let h=0,f=0,p=0;for(let P=0;P<9;P++)n.probe[P].set(0,0,0);let v=0,m=0,g=0,y=0,b=0,x=0,S=0,w=0,_=0,C=0;d.sort(Sxe);let A=u!==!0?Math.PI:1;for(let P=0,T=d.length;P<T;P++){let R=d[P],z=R.color,F=R.intensity,H=R.distance,N=R.shadow&&R.shadow.map?R.shadow.map.texture:null;if(R.isAmbientLight)h+=z.r*F*A,f+=z.g*F*A,p+=z.b*F*A;else if(R.isLightProbe)for(let U=0;U<9;U++)n.probe[U].addScaledVector(R.sh.coefficients[U],F);else if(R.isDirectionalLight){let U=r.get(R);if(U.color.copy(R.color).multiplyScalar(R.intensity*A),R.castShadow){let ie=R.shadow,te=i.get(R);te.shadowBias=ie.bias,te.shadowNormalBias=ie.normalBias,te.shadowRadius=ie.radius,te.shadowMapSize=ie.mapSize,n.directionalShadow[v]=te,n.directionalShadowMap[v]=N,n.directionalShadowMatrix[v]=R.shadow.matrix,x++}n.directional[v]=U,v++}else if(R.isSpotLight){let U=r.get(R);U.position.setFromMatrixPosition(R.matrixWorld),U.color.copy(z).multiplyScalar(F*A),U.distance=H,U.coneCos=Math.cos(R.angle),U.penumbraCos=Math.cos(R.angle*(1-R.penumbra)),U.decay=R.decay,n.spot[g]=U;let ie=R.shadow;if(R.map&&(n.spotLightMap[_]=R.map,_++,ie.updateMatrices(R),R.castShadow&&C++),n.spotLightMatrix[g]=ie.matrix,R.castShadow){let te=i.get(R);te.shadowBias=ie.bias,te.shadowNormalBias=ie.normalBias,te.shadowRadius=ie.radius,te.shadowMapSize=ie.mapSize,n.spotShadow[g]=te,n.spotShadowMap[g]=N,w++}g++}else if(R.isRectAreaLight){let U=r.get(R);U.color.copy(z).multiplyScalar(F),U.halfWidth.set(R.width*.5,0,0),U.halfHeight.set(0,R.height*.5,0),n.rectArea[y]=U,y++}else if(R.isPointLight){let U=r.get(R);if(U.color.copy(R.color).multiplyScalar(R.intensity*A),U.distance=R.distance,U.decay=R.decay,R.castShadow){let ie=R.shadow,te=i.get(R);te.shadowBias=ie.bias,te.shadowNormalBias=ie.normalBias,te.shadowRadius=ie.radius,te.shadowMapSize=ie.mapSize,te.shadowCameraNear=ie.camera.near,te.shadowCameraFar=ie.camera.far,n.pointShadow[m]=te,n.pointShadowMap[m]=N,n.pointShadowMatrix[m]=R.shadow.matrix,S++}n.point[m]=U,m++}else if(R.isHemisphereLight){let U=r.get(R);U.skyColor.copy(R.color).multiplyScalar(F*A),U.groundColor.copy(R.groundColor).multiplyScalar(F*A),n.hemi[b]=U,b++}}y>0&&(t.isWebGL2||e.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=ht.LTC_FLOAT_1,n.rectAreaLTC2=ht.LTC_FLOAT_2):e.has("OES_texture_half_float_linear")===!0?(n.rectAreaLTC1=ht.LTC_HALF_1,n.rectAreaLTC2=ht.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),n.ambient[0]=h,n.ambient[1]=f,n.ambient[2]=p;let M=n.hash;(M.directionalLength!==v||M.pointLength!==m||M.spotLength!==g||M.rectAreaLength!==y||M.hemiLength!==b||M.numDirectionalShadows!==x||M.numPointShadows!==S||M.numSpotShadows!==w||M.numSpotMaps!==_)&&(n.directional.length=v,n.spot.length=g,n.rectArea.length=y,n.point.length=m,n.hemi.length=b,n.directionalShadow.length=x,n.directionalShadowMap.length=x,n.pointShadow.length=S,n.pointShadowMap.length=S,n.spotShadow.length=w,n.spotShadowMap.length=w,n.directionalShadowMatrix.length=x,n.pointShadowMatrix.length=S,n.spotLightMatrix.length=w+_-C,n.spotLightMap.length=_,n.numSpotLightShadowsWithMaps=C,M.directionalLength=v,M.pointLength=m,M.spotLength=g,M.rectAreaLength=y,M.hemiLength=b,M.numDirectionalShadows=x,M.numPointShadows=S,M.numSpotShadows=w,M.numSpotMaps=_,n.version=wxe++)}function c(d,u){let h=0,f=0,p=0,v=0,m=0,g=u.matrixWorldInverse;for(let y=0,b=d.length;y<b;y++){let x=d[y];if(x.isDirectionalLight){let S=n.directional[h];S.direction.setFromMatrixPosition(x.matrixWorld),a.setFromMatrixPosition(x.target.matrixWorld),S.direction.sub(a),S.direction.transformDirection(g),h++}else if(x.isSpotLight){let S=n.spot[p];S.position.setFromMatrixPosition(x.matrixWorld),S.position.applyMatrix4(g),S.direction.setFromMatrixPosition(x.matrixWorld),a.setFromMatrixPosition(x.target.matrixWorld),S.direction.sub(a),S.direction.transformDirection(g),p++}else if(x.isRectAreaLight){let S=n.rectArea[v];S.position.setFromMatrixPosition(x.matrixWorld),S.position.applyMatrix4(g),s.identity(),o.copy(x.matrixWorld),o.premultiply(g),s.extractRotation(o),S.halfWidth.set(x.width*.5,0,0),S.halfHeight.set(0,x.height*.5,0),S.halfWidth.applyMatrix4(s),S.halfHeight.applyMatrix4(s),v++}else if(x.isPointLight){let S=n.point[f];S.position.setFromMatrixPosition(x.matrixWorld),S.position.applyMatrix4(g),f++}else if(x.isHemisphereLight){let S=n.hemi[m];S.direction.setFromMatrixPosition(x.matrixWorld),S.direction.transformDirection(g),m++}}}return{setup:l,setupView:c,state:n}}function oz(e,t){let r=new Cxe(e,t),i=[],n=[];function a(){i.length=0,n.length=0}function o(d){i.push(d)}function s(d){n.push(d)}function l(d){r.setup(i,d)}function c(d){r.setupView(i,d)}return{init:a,state:{lightsArray:i,shadowsArray:n,lights:r},setupLights:l,setupLightsView:c,pushLight:o,pushShadow:s}}function _xe(e,t){let r=new WeakMap;function i(a,o=0){let s=r.get(a),l;return s===void 0?(l=new oz(e,t),r.set(a,[l])):o>=s.length?(l=new oz(e,t),s.push(l)):l=s[o],l}function n(){r=new WeakMap}return{get:i,dispose:n}}var Sj=class extends Wg{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=pc,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}},Axe=class extends Wg{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new k,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}},Mxe=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,Exe=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function Txe(e,t,r){let i=new rP,n=new ye,a=new ye,o=new Kt,s=new Sj({depthPacking:lj}),l=new Axe,c={},d=r.maxTextureSize,u={[us]:Ln,[Ln]:us,[fa]:fa},h=new jr({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new ye},radius:{value:4}},vertexShader:Mxe,fragmentShader:Exe}),f=h.clone();f.defines.HORIZONTAL_PASS=1;let p=new Ot;p.setAttribute("position",new $t(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));let v=new Di(p,h),m=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=KT,this.render=function(x,S,w){if(m.enabled===!1||m.autoUpdate===!1&&m.needsUpdate===!1||x.length===0)return;let _=e.getRenderTarget(),C=e.getActiveCubeFace(),A=e.getActiveMipmapLevel(),M=e.state;M.setBlending(ln),M.buffers.color.setClear(1,1,1,1),M.buffers.depth.setTest(!0),M.setScissorTest(!1);for(let P=0,T=x.length;P<T;P++){let R=x[P],z=R.shadow;if(z===void 0){console.warn("THREE.WebGLShadowMap:",R,"has no shadow.");continue}if(z.autoUpdate===!1&&z.needsUpdate===!1)continue;n.copy(z.mapSize);let F=z.getFrameExtents();if(n.multiply(F),a.copy(z.mapSize),(n.x>d||n.y>d)&&(n.x>d&&(a.x=Math.floor(d/F.x),n.x=a.x*F.x,z.mapSize.x=a.x),n.y>d&&(a.y=Math.floor(d/F.y),n.y=a.y*F.y,z.mapSize.y=a.y)),z.map===null){let N=this.type!==Zm?{minFilter:Hr,magFilter:Hr}:{};z.map=new Ur(n.x,n.y,N),z.map.texture.name=R.name+".shadowMap",z.camera.updateProjectionMatrix()}e.setRenderTarget(z.map),e.clear();let H=z.getViewportCount();for(let N=0;N<H;N++){let U=z.getViewport(N);o.set(a.x*U.x,a.y*U.y,a.x*U.z,a.y*U.w),M.viewport(o),z.updateMatrices(R,N),i=z.getFrustum(),b(S,w,z.camera,R,this.type)}z.isPointLightShadow!==!0&&this.type===Zm&&g(z,w),z.needsUpdate=!1}m.needsUpdate=!1,e.setRenderTarget(_,C,A)};function g(x,S){let w=t.update(v);h.defines.VSM_SAMPLES!==x.blurSamples&&(h.defines.VSM_SAMPLES=x.blurSamples,f.defines.VSM_SAMPLES=x.blurSamples,h.needsUpdate=!0,f.needsUpdate=!0),x.mapPass===null&&(x.mapPass=new Ur(n.x,n.y)),h.uniforms.shadow_pass.value=x.map.texture,h.uniforms.resolution.value=x.mapSize,h.uniforms.radius.value=x.radius,e.setRenderTarget(x.mapPass),e.clear(),e.renderBufferDirect(S,null,w,h,v,null),f.uniforms.shadow_pass.value=x.mapPass.texture,f.uniforms.resolution.value=x.mapSize,f.uniforms.radius.value=x.radius,e.setRenderTarget(x.map),e.clear(),e.renderBufferDirect(S,null,w,f,v,null)}function y(x,S,w,_,C,A){let M=null,P=w.isPointLight===!0?x.customDistanceMaterial:x.customDepthMaterial;if(P!==void 0)M=P;else if(M=w.isPointLight===!0?l:s,e.localClippingEnabled&&S.clipShadows===!0&&Array.isArray(S.clippingPlanes)&&S.clippingPlanes.length!==0||S.displacementMap&&S.displacementScale!==0||S.alphaMap&&S.alphaTest>0||S.map&&S.alphaTest>0){let T=M.uuid,R=S.uuid,z=c[T];z===void 0&&(z={},c[T]=z);let F=z[R];F===void 0&&(F=M.clone(),z[R]=F),M=F}return M.visible=S.visible,M.wireframe=S.wireframe,A===Zm?M.side=S.shadowSide!==null?S.shadowSide:S.side:M.side=S.shadowSide!==null?S.shadowSide:u[S.side],M.alphaMap=S.alphaMap,M.alphaTest=S.alphaTest,M.map=S.map,M.clipShadows=S.clipShadows,M.clippingPlanes=S.clippingPlanes,M.clipIntersection=S.clipIntersection,M.displacementMap=S.displacementMap,M.displacementScale=S.displacementScale,M.displacementBias=S.displacementBias,M.wireframeLinewidth=S.wireframeLinewidth,M.linewidth=S.linewidth,w.isPointLight===!0&&M.isMeshDistanceMaterial===!0&&(M.referencePosition.setFromMatrixPosition(w.matrixWorld),M.nearDistance=_,M.farDistance=C),M}function b(x,S,w,_,C){if(x.visible===!1)return;if(x.layers.test(S.layers)&&(x.isMesh||x.isLine||x.isPoints)&&(x.castShadow||x.receiveShadow&&C===Zm)&&(!x.frustumCulled||i.intersectsObject(x))){x.modelViewMatrix.multiplyMatrices(w.matrixWorldInverse,x.matrixWorld);let M=t.update(x),P=x.material;if(Array.isArray(P)){let T=M.groups;for(let R=0,z=T.length;R<z;R++){let F=T[R],H=P[F.materialIndex];if(H&&H.visible){let N=y(x,H,_,w.near,w.far,C);e.renderBufferDirect(w,null,M,N,x,F)}}}else if(P.visible){let T=y(x,P,_,w.near,w.far,C);e.renderBufferDirect(w,null,M,T,x,null)}}let A=x.children;for(let M=0,P=A.length;M<P;M++)b(A[M],S,w,_,C)}}function Pxe(e,t,r){let i=r.isWebGL2;function n(){let pe=!1,Te=new Kt,ce=null,Re=new Kt(0,0,0,0);return{setMask:function($e){ce!==$e&&!pe&&(e.colorMask($e,$e,$e,$e),ce=$e)},setLocked:function($e){pe=$e},setClear:function($e,at,qt,ir,Fe){Fe===!0&&($e*=ir,at*=ir,qt*=ir),Te.set($e,at,qt,ir),Re.equals(Te)===!1&&(e.clearColor($e,at,qt,ir),Re.copy(Te))},reset:function(){pe=!1,ce=null,Re.set(-1,0,0,0)}}}function a(){let pe=!1,Te=null,ce=null,Re=null;return{setTest:function($e){$e?Q(2929):ne(2929)},setMask:function($e){Te!==$e&&!pe&&(e.depthMask($e),Te=$e)},setFunc:function($e){if(ce!==$e){switch($e){case Xme:e.depthFunc(512);break;case Kme:e.depthFunc(519);break;case Qme:e.depthFunc(513);break;case AA:e.depthFunc(515);break;case Zme:e.depthFunc(514);break;case Jme:e.depthFunc(518);break;case eve:e.depthFunc(516);break;case tve:e.depthFunc(517);break;default:e.depthFunc(515)}ce=$e}},setLocked:function($e){pe=$e},setClear:function($e){Re!==$e&&(e.clearDepth($e),Re=$e)},reset:function(){pe=!1,Te=null,ce=null,Re=null}}}function o(){let pe=!1,Te=null,ce=null,Re=null,$e=null,at=null,qt=null,ir=null,Fe=null;return{setTest:function(Ke){pe||(Ke?Q(2960):ne(2960))},setMask:function(Ke){Te!==Ke&&!pe&&(e.stencilMask(Ke),Te=Ke)},setFunc:function(Ke,ut,Ft){(ce!==Ke||Re!==ut||$e!==Ft)&&(e.stencilFunc(Ke,ut,Ft),ce=Ke,Re=ut,$e=Ft)},setOp:function(Ke,ut,Ft){(at!==Ke||qt!==ut||ir!==Ft)&&(e.stencilOp(Ke,ut,Ft),at=Ke,qt=ut,ir=Ft)},setLocked:function(Ke){pe=Ke},setClear:function(Ke){Fe!==Ke&&(e.clearStencil(Ke),Fe=Ke)},reset:function(){pe=!1,Te=null,ce=null,Re=null,$e=null,at=null,qt=null,ir=null,Fe=null}}}let s=new n,l=new a,c=new o,d=new WeakMap,u=new WeakMap,h={},f={},p=new WeakMap,v=[],m=null,g=!1,y=null,b=null,x=null,S=null,w=null,_=null,C=null,A=!1,M=null,P=null,T=null,R=null,z=null,F=e.getParameter(35661),H=!1,N=0,U=e.getParameter(7938);U.indexOf("WebGL")!==-1?(N=parseFloat(/^WebGL (\d)/.exec(U)[1]),H=N>=1):U.indexOf("OpenGL ES")!==-1&&(N=parseFloat(/^OpenGL ES (\d)/.exec(U)[1]),H=N>=2);let ie=null,te={},X=e.getParameter(3088),W=e.getParameter(2978),q=new Kt().fromArray(X),$=new Kt().fromArray(W);function le(pe,Te,ce){let Re=new Uint8Array(4),$e=e.createTexture();e.bindTexture(pe,$e),e.texParameteri(pe,10241,9728),e.texParameteri(pe,10240,9728);for(let at=0;at<ce;at++)e.texImage2D(Te+at,0,6408,1,1,0,6408,5121,Re);return $e}let ee={};ee[3553]=le(3553,3553,1),ee[34067]=le(34067,34069,6),s.setClear(0,0,0,1),l.setClear(1),c.setClear(0),Q(2929),l.setFunc(AA),Se(!1),we(QR),Q(2884),Z(ln);function Q(pe){h[pe]!==!0&&(e.enable(pe),h[pe]=!0)}function ne(pe){h[pe]!==!1&&(e.disable(pe),h[pe]=!1)}function V(pe,Te){return f[pe]!==Te?(e.bindFramebuffer(pe,Te),f[pe]=Te,i&&(pe===36009&&(f[36160]=Te),pe===36160&&(f[36009]=Te)),!0):!1}function de(pe,Te){let ce=v,Re=!1;if(pe)if(ce=p.get(Te),ce===void 0&&(ce=[],p.set(Te,ce)),pe.isWebGLMultipleRenderTargets){let $e=pe.texture;if(ce.length!==$e.length||ce[0]!==36064){for(let at=0,qt=$e.length;at<qt;at++)ce[at]=36064+at;ce.length=$e.length,Re=!0}}else ce[0]!==36064&&(ce[0]=36064,Re=!0);else ce[0]!==1029&&(ce[0]=1029,Re=!0);Re&&(r.isWebGL2?e.drawBuffers(ce):t.get("WEBGL_draw_buffers").drawBuffersWEBGL(ce))}function me(pe){return m!==pe?(e.useProgram(pe),m=pe,!0):!1}let Ce={[yf]:32774,[Fme]:32778,[Nme]:32779};if(i)Ce[tI]=32775,Ce[rI]=32776;else{let pe=t.get("EXT_blend_minmax");pe!==null&&(Ce[tI]=pe.MIN_EXT,Ce[rI]=pe.MAX_EXT)}let G={[Ume]:0,[jme]:1,[Vme]:768,[ej]:770,[Yme]:776,[$me]:774,[Wme]:772,[Hme]:769,[tj]:771,[qme]:775,[Gme]:773};function Z(pe,Te,ce,Re,$e,at,qt,ir){if(pe===ln){g===!0&&(ne(3042),g=!1);return}if(g===!1&&(Q(3042),g=!0),pe!==Bme){if(pe!==y||ir!==A){if((b!==yf||w!==yf)&&(e.blendEquation(32774),b=yf,w=yf),ir)switch(pe){case Fu:e.blendFuncSeparate(1,771,1,771);break;case ZR:e.blendFunc(1,1);break;case JR:e.blendFuncSeparate(0,769,0,1);break;case eI:e.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",pe);break}else switch(pe){case Fu:e.blendFuncSeparate(770,771,1,771);break;case ZR:e.blendFunc(770,1);break;case JR:e.blendFuncSeparate(0,769,0,1);break;case eI:e.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",pe);break}x=null,S=null,_=null,C=null,y=pe,A=ir}return}$e=$e||Te,at=at||ce,qt=qt||Re,(Te!==b||$e!==w)&&(e.blendEquationSeparate(Ce[Te],Ce[$e]),b=Te,w=$e),(ce!==x||Re!==S||at!==_||qt!==C)&&(e.blendFuncSeparate(G[ce],G[Re],G[at],G[qt]),x=ce,S=Re,_=at,C=qt),y=pe,A=!1}function ue(pe,Te){pe.side===fa?ne(2884):Q(2884);let ce=pe.side===Ln;Te&&(ce=!ce),Se(ce),pe.blending===Fu&&pe.transparent===!1?Z(ln):Z(pe.blending,pe.blendEquation,pe.blendSrc,pe.blendDst,pe.blendEquationAlpha,pe.blendSrcAlpha,pe.blendDstAlpha,pe.premultipliedAlpha),l.setFunc(pe.depthFunc),l.setTest(pe.depthTest),l.setMask(pe.depthWrite),s.setMask(pe.colorWrite);let Re=pe.stencilWrite;c.setTest(Re),Re&&(c.setMask(pe.stencilWriteMask),c.setFunc(pe.stencilFunc,pe.stencilRef,pe.stencilFuncMask),c.setOp(pe.stencilFail,pe.stencilZFail,pe.stencilZPass)),Ee(pe.polygonOffset,pe.polygonOffsetFactor,pe.polygonOffsetUnits),pe.alphaToCoverage===!0?Q(32926):ne(32926)}function Se(pe){M!==pe&&(pe?e.frontFace(2304):e.frontFace(2305),M=pe)}function we(pe){pe!==zme?(Q(2884),pe!==P&&(pe===QR?e.cullFace(1029):pe===kme?e.cullFace(1028):e.cullFace(1032))):ne(2884),P=pe}function _e(pe){pe!==T&&(H&&e.lineWidth(pe),T=pe)}function Ee(pe,Te,ce){pe?(Q(32823),(R!==Te||z!==ce)&&(e.polygonOffset(Te,ce),R=Te,z=ce)):ne(32823)}function fe(pe){pe?Q(3089):ne(3089)}function B(pe){pe===void 0&&(pe=33984+F-1),ie!==pe&&(e.activeTexture(pe),ie=pe)}function D(pe,Te,ce){ce===void 0&&(ie===null?ce=33984+F-1:ce=ie);let Re=te[ce];Re===void 0&&(Re={type:void 0,texture:void 0},te[ce]=Re),(Re.type!==pe||Re.texture!==Te)&&(ie!==ce&&(e.activeTexture(ce),ie=ce),e.bindTexture(pe,Te||ee[pe]),Re.type=pe,Re.texture=Te)}function I(){let pe=te[ie];pe!==void 0&&pe.type!==void 0&&(e.bindTexture(pe.type,null),pe.type=void 0,pe.texture=void 0)}function O(){try{e.compressedTexImage2D.apply(e,arguments)}catch(pe){console.error("THREE.WebGLState:",pe)}}function j(){try{e.compressedTexImage3D.apply(e,arguments)}catch(pe){console.error("THREE.WebGLState:",pe)}}function L(){try{e.texSubImage2D.apply(e,arguments)}catch(pe){console.error("THREE.WebGLState:",pe)}}function Ae(){try{e.texSubImage3D.apply(e,arguments)}catch(pe){console.error("THREE.WebGLState:",pe)}}function We(){try{e.compressedTexSubImage2D.apply(e,arguments)}catch(pe){console.error("THREE.WebGLState:",pe)}}function je(){try{e.compressedTexSubImage3D.apply(e,arguments)}catch(pe){console.error("THREE.WebGLState:",pe)}}function ze(){try{e.texStorage2D.apply(e,arguments)}catch(pe){console.error("THREE.WebGLState:",pe)}}function Je(){try{e.texStorage3D.apply(e,arguments)}catch(pe){console.error("THREE.WebGLState:",pe)}}function nt(){try{e.texImage2D.apply(e,arguments)}catch(pe){console.error("THREE.WebGLState:",pe)}}function lt(){try{e.texImage3D.apply(e,arguments)}catch(pe){console.error("THREE.WebGLState:",pe)}}function dt(pe){q.equals(pe)===!1&&(e.scissor(pe.x,pe.y,pe.z,pe.w),q.copy(pe))}function vt(pe){$.equals(pe)===!1&&(e.viewport(pe.x,pe.y,pe.z,pe.w),$.copy(pe))}function se(pe,Te){let ce=u.get(Te);ce===void 0&&(ce=new WeakMap,u.set(Te,ce));let Re=ce.get(pe);Re===void 0&&(Re=e.getUniformBlockIndex(Te,pe.name),ce.set(pe,Re))}function Le(pe,Te){let ce=u.get(Te).get(pe);d.get(Te)!==ce&&(e.uniformBlockBinding(Te,ce,pe.__bindingPointIndex),d.set(Te,ce))}function Ye(){e.disable(3042),e.disable(2884),e.disable(2929),e.disable(32823),e.disable(3089),e.disable(2960),e.disable(32926),e.blendEquation(32774),e.blendFunc(1,0),e.blendFuncSeparate(1,0,1,0),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(513),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(519,0,4294967295),e.stencilOp(7680,7680,7680),e.clearStencil(0),e.cullFace(1029),e.frontFace(2305),e.polygonOffset(0,0),e.activeTexture(33984),e.bindFramebuffer(36160,null),i===!0&&(e.bindFramebuffer(36009,null),e.bindFramebuffer(36008,null)),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),h={},ie=null,te={},f={},p=new WeakMap,v=[],m=null,g=!1,y=null,b=null,x=null,S=null,w=null,_=null,C=null,A=!1,M=null,P=null,T=null,R=null,z=null,q.set(0,0,e.canvas.width,e.canvas.height),$.set(0,0,e.canvas.width,e.canvas.height),s.reset(),l.reset(),c.reset()}return{buffers:{color:s,depth:l,stencil:c},enable:Q,disable:ne,bindFramebuffer:V,drawBuffers:de,useProgram:me,setBlending:Z,setMaterial:ue,setFlipSided:Se,setCullFace:we,setLineWidth:_e,setPolygonOffset:Ee,setScissorTest:fe,activeTexture:B,bindTexture:D,unbindTexture:I,compressedTexImage2D:O,compressedTexImage3D:j,texImage2D:nt,texImage3D:lt,updateUBOMapping:se,uniformBlockBinding:Le,texStorage2D:ze,texStorage3D:Je,texSubImage2D:L,texSubImage3D:Ae,compressedTexSubImage2D:We,compressedTexSubImage3D:je,scissor:dt,viewport:vt,reset:Ye}}function Dxe(e,t,r,i,n,a,o){let s=n.isWebGL2,l=n.maxTextures,c=n.maxCubemapSize,d=n.maxTextureSize,u=n.maxSamples,h=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):null,f=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),p=new WeakMap,v,m=new WeakMap,g=!1;try{g=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function y(D,I){return g?new OffscreenCanvas(D,I):ng("canvas")}function b(D,I,O,j){let L=1;if((D.width>j||D.height>j)&&(L=j/Math.max(D.width,D.height)),L<1||I===!0)if(typeof HTMLImageElement<"u"&&D instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&D instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&D instanceof ImageBitmap){let Ae=I?hx:Math.floor,We=Ae(L*D.width),je=Ae(L*D.height);v===void 0&&(v=y(We,je));let ze=O?y(We,je):v;return ze.width=We,ze.height=je,ze.getContext("2d").drawImage(D,0,0,We,je),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+D.width+"x"+D.height+") to ("+We+"x"+je+")."),ze}else return"data"in D&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+D.width+"x"+D.height+")."),D;return D}function x(D){return OA(D.width)&&OA(D.height)}function S(D){return s?!1:D.wrapS!==Si||D.wrapT!==Si||D.minFilter!==Hr&&D.minFilter!==ur}function w(D,I){return D.generateMipmaps&&I&&D.minFilter!==Hr&&D.minFilter!==ur}function _(D){e.generateMipmap(D)}function C(D,I,O,j,L=!1){if(s===!1)return I;if(D!==null){if(e[D]!==void 0)return e[D];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+D+"'")}let Ae=I;return I===6403&&(O===5126&&(Ae=33326),O===5131&&(Ae=33325),O===5121&&(Ae=33321)),I===33319&&(O===5126&&(Ae=33328),O===5131&&(Ae=33327),O===5121&&(Ae=33323)),I===6408&&(O===5126&&(Ae=34836),O===5131&&(Ae=34842),O===5121&&(Ae=j===sr&&L===!1?35907:32856),O===32819&&(Ae=32854),O===32820&&(Ae=32855)),(Ae===33325||Ae===33326||Ae===33327||Ae===33328||Ae===34842||Ae===34836)&&t.get("EXT_color_buffer_float"),Ae}function A(D,I,O){return w(D,O)===!0||D.isFramebufferTexture&&D.minFilter!==Hr&&D.minFilter!==ur?Math.log2(Math.max(I.width,I.height))+1:D.mipmaps!==void 0&&D.mipmaps.length>0?D.mipmaps.length:D.isCompressedTexture&&Array.isArray(D.image)?I.mipmaps.length:1}function M(D){return D===Hr||D===iI||D===ES?9728:9729}function P(D){let I=D.target;I.removeEventListener("dispose",P),R(I),I.isVideoTexture&&p.delete(I)}function T(D){let I=D.target;I.removeEventListener("dispose",T),F(I)}function R(D){let I=i.get(D);if(I.__webglInit===void 0)return;let O=D.source,j=m.get(O);if(j){let L=j[I.__cacheKey];L.usedTimes--,L.usedTimes===0&&z(D),Object.keys(j).length===0&&m.delete(O)}i.remove(D)}function z(D){let I=i.get(D);e.deleteTexture(I.__webglTexture);let O=D.source,j=m.get(O);delete j[I.__cacheKey],o.memory.textures--}function F(D){let I=D.texture,O=i.get(D),j=i.get(I);if(j.__webglTexture!==void 0&&(e.deleteTexture(j.__webglTexture),o.memory.textures--),D.depthTexture&&D.depthTexture.dispose(),D.isWebGLCubeRenderTarget)for(let L=0;L<6;L++)e.deleteFramebuffer(O.__webglFramebuffer[L]),O.__webglDepthbuffer&&e.deleteRenderbuffer(O.__webglDepthbuffer[L]);else{if(e.deleteFramebuffer(O.__webglFramebuffer),O.__webglDepthbuffer&&e.deleteRenderbuffer(O.__webglDepthbuffer),O.__webglMultisampledFramebuffer&&e.deleteFramebuffer(O.__webglMultisampledFramebuffer),O.__webglColorRenderbuffer)for(let L=0;L<O.__webglColorRenderbuffer.length;L++)O.__webglColorRenderbuffer[L]&&e.deleteRenderbuffer(O.__webglColorRenderbuffer[L]);O.__webglDepthRenderbuffer&&e.deleteRenderbuffer(O.__webglDepthRenderbuffer)}if(D.isWebGLMultipleRenderTargets)for(let L=0,Ae=I.length;L<Ae;L++){let We=i.get(I[L]);We.__webglTexture&&(e.deleteTexture(We.__webglTexture),o.memory.textures--),i.remove(I[L])}i.remove(I),i.remove(D)}let H=0;function N(){H=0}function U(){let D=H;return D>=l&&console.warn("THREE.WebGLTextures: Trying to use "+D+" texture units while this GPU supports only "+l),H+=1,D}function ie(D){let I=[];return I.push(D.wrapS),I.push(D.wrapT),I.push(D.wrapR||0),I.push(D.magFilter),I.push(D.minFilter),I.push(D.anisotropy),I.push(D.internalFormat),I.push(D.format),I.push(D.type),I.push(D.generateMipmaps),I.push(D.premultiplyAlpha),I.push(D.flipY),I.push(D.unpackAlignment),I.push(D.encoding),I.join()}function te(D,I){let O=i.get(D);if(D.isVideoTexture&&fe(D),D.isRenderTargetTexture===!1&&D.version>0&&O.__version!==D.version){let j=D.image;if(j===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(j.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{ne(O,D,I);return}}r.bindTexture(3553,O.__webglTexture,33984+I)}function X(D,I){let O=i.get(D);if(D.version>0&&O.__version!==D.version){ne(O,D,I);return}r.bindTexture(35866,O.__webglTexture,33984+I)}function W(D,I){let O=i.get(D);if(D.version>0&&O.__version!==D.version){ne(O,D,I);return}r.bindTexture(32879,O.__webglTexture,33984+I)}function q(D,I){let O=i.get(D);if(D.version>0&&O.__version!==D.version){V(O,D,I);return}r.bindTexture(34067,O.__webglTexture,33984+I)}let $={[Hl]:10497,[Si]:33071,[TA]:33648},le={[Hr]:9728,[iI]:9984,[ES]:9986,[ur]:9729,[cve]:9985,[mp]:9987};function ee(D,I,O){if(O?(e.texParameteri(D,10242,$[I.wrapS]),e.texParameteri(D,10243,$[I.wrapT]),(D===32879||D===35866)&&e.texParameteri(D,32882,$[I.wrapR]),e.texParameteri(D,10240,le[I.magFilter]),e.texParameteri(D,10241,le[I.minFilter])):(e.texParameteri(D,10242,33071),e.texParameteri(D,10243,33071),(D===32879||D===35866)&&e.texParameteri(D,32882,33071),(I.wrapS!==Si||I.wrapT!==Si)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(D,10240,M(I.magFilter)),e.texParameteri(D,10241,M(I.minFilter)),I.minFilter!==Hr&&I.minFilter!==ur&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),t.has("EXT_texture_filter_anisotropic")===!0){let j=t.get("EXT_texture_filter_anisotropic");if(I.magFilter===Hr||I.minFilter!==ES&&I.minFilter!==mp||I.type===on&&t.has("OES_texture_float_linear")===!1||s===!1&&I.type===ec&&t.has("OES_texture_half_float_linear")===!1)return;(I.anisotropy>1||i.get(I).__currentAnisotropy)&&(e.texParameterf(D,j.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(I.anisotropy,n.getMaxAnisotropy())),i.get(I).__currentAnisotropy=I.anisotropy)}}function Q(D,I){let O=!1;D.__webglInit===void 0&&(D.__webglInit=!0,I.addEventListener("dispose",P));let j=I.source,L=m.get(j);L===void 0&&(L={},m.set(j,L));let Ae=ie(I);if(Ae!==D.__cacheKey){L[Ae]===void 0&&(L[Ae]={texture:e.createTexture(),usedTimes:0},o.memory.textures++,O=!0),L[Ae].usedTimes++;let We=L[D.__cacheKey];We!==void 0&&(L[D.__cacheKey].usedTimes--,We.usedTimes===0&&z(I)),D.__cacheKey=Ae,D.__webglTexture=L[Ae].texture}return O}function ne(D,I,O){let j=3553;(I.isDataArrayTexture||I.isCompressedArrayTexture)&&(j=35866),I.isData3DTexture&&(j=32879);let L=Q(D,I),Ae=I.source;r.bindTexture(j,D.__webglTexture,33984+O);let We=i.get(Ae);if(Ae.version!==We.__version||L===!0){r.activeTexture(33984+O),e.pixelStorei(37440,I.flipY),e.pixelStorei(37441,I.premultiplyAlpha),e.pixelStorei(3317,I.unpackAlignment),e.pixelStorei(37443,0);let je=S(I)&&x(I.image)===!1,ze=b(I.image,je,!1,d);ze=B(I,ze);let Je=x(ze)||s,nt=a.convert(I.format,I.encoding),lt=a.convert(I.type),dt=C(I.internalFormat,nt,lt,I.encoding,I.isVideoTexture);ee(j,I,Je);let vt,se=I.mipmaps,Le=s&&I.isVideoTexture!==!0,Ye=We.__version===void 0||L===!0,pe=A(I,ze,Je);if(I.isDepthTexture)dt=6402,s?I.type===on?dt=36012:I.type===Wl?dt=33190:I.type===Nu?dt=35056:dt=33189:I.type===on&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),I.format===Uu&&dt===6402&&I.type!==nj&&I.type!==Wl&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),I.type=Wl,lt=a.convert(I.type)),I.format===ih&&dt===6402&&(dt=34041,I.type!==Nu&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),I.type=Nu,lt=a.convert(I.type))),Ye&&(Le?r.texStorage2D(3553,1,dt,ze.width,ze.height):r.texImage2D(3553,0,dt,ze.width,ze.height,0,nt,lt,null));else if(I.isDataTexture)if(se.length>0&&Je){Le&&Ye&&r.texStorage2D(3553,pe,dt,se[0].width,se[0].height);for(let Te=0,ce=se.length;Te<ce;Te++)vt=se[Te],Le?r.texSubImage2D(3553,Te,0,0,vt.width,vt.height,nt,lt,vt.data):r.texImage2D(3553,Te,dt,vt.width,vt.height,0,nt,lt,vt.data);I.generateMipmaps=!1}else Le?(Ye&&r.texStorage2D(3553,pe,dt,ze.width,ze.height),r.texSubImage2D(3553,0,0,0,ze.width,ze.height,nt,lt,ze.data)):r.texImage2D(3553,0,dt,ze.width,ze.height,0,nt,lt,ze.data);else if(I.isCompressedTexture)if(I.isCompressedArrayTexture){Le&&Ye&&r.texStorage3D(35866,pe,dt,se[0].width,se[0].height,ze.depth);for(let Te=0,ce=se.length;Te<ce;Te++)vt=se[Te],I.format!==In?nt!==null?Le?r.compressedTexSubImage3D(35866,Te,0,0,0,vt.width,vt.height,ze.depth,nt,vt.data,0,0):r.compressedTexImage3D(35866,Te,dt,vt.width,vt.height,ze.depth,0,vt.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Le?r.texSubImage3D(35866,Te,0,0,0,vt.width,vt.height,ze.depth,nt,lt,vt.data):r.texImage3D(35866,Te,dt,vt.width,vt.height,ze.depth,0,nt,lt,vt.data)}else{Le&&Ye&&r.texStorage2D(3553,pe,dt,se[0].width,se[0].height);for(let Te=0,ce=se.length;Te<ce;Te++)vt=se[Te],I.format!==In?nt!==null?Le?r.compressedTexSubImage2D(3553,Te,0,0,vt.width,vt.height,nt,vt.data):r.compressedTexImage2D(3553,Te,dt,vt.width,vt.height,0,vt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Le?r.texSubImage2D(3553,Te,0,0,vt.width,vt.height,nt,lt,vt.data):r.texImage2D(3553,Te,dt,vt.width,vt.height,0,nt,lt,vt.data)}else if(I.isDataArrayTexture)Le?(Ye&&r.texStorage3D(35866,pe,dt,ze.width,ze.height,ze.depth),r.texSubImage3D(35866,0,0,0,0,ze.width,ze.height,ze.depth,nt,lt,ze.data)):r.texImage3D(35866,0,dt,ze.width,ze.height,ze.depth,0,nt,lt,ze.data);else if(I.isData3DTexture)Le?(Ye&&r.texStorage3D(32879,pe,dt,ze.width,ze.height,ze.depth),r.texSubImage3D(32879,0,0,0,0,ze.width,ze.height,ze.depth,nt,lt,ze.data)):r.texImage3D(32879,0,dt,ze.width,ze.height,ze.depth,0,nt,lt,ze.data);else if(I.isFramebufferTexture){if(Ye)if(Le)r.texStorage2D(3553,pe,dt,ze.width,ze.height);else{let Te=ze.width,ce=ze.height;for(let Re=0;Re<pe;Re++)r.texImage2D(3553,Re,dt,Te,ce,0,nt,lt,null),Te>>=1,ce>>=1}}else if(se.length>0&&Je){Le&&Ye&&r.texStorage2D(3553,pe,dt,se[0].width,se[0].height);for(let Te=0,ce=se.length;Te<ce;Te++)vt=se[Te],Le?r.texSubImage2D(3553,Te,0,0,nt,lt,vt):r.texImage2D(3553,Te,dt,nt,lt,vt);I.generateMipmaps=!1}else Le?(Ye&&r.texStorage2D(3553,pe,dt,ze.width,ze.height),r.texSubImage2D(3553,0,0,0,nt,lt,ze)):r.texImage2D(3553,0,dt,nt,lt,ze);w(I,Je)&&_(j),We.__version=Ae.version,I.onUpdate&&I.onUpdate(I)}D.__version=I.version}function V(D,I,O){if(I.image.length!==6)return;let j=Q(D,I),L=I.source;r.bindTexture(34067,D.__webglTexture,33984+O);let Ae=i.get(L);if(L.version!==Ae.__version||j===!0){r.activeTexture(33984+O),e.pixelStorei(37440,I.flipY),e.pixelStorei(37441,I.premultiplyAlpha),e.pixelStorei(3317,I.unpackAlignment),e.pixelStorei(37443,0);let We=I.isCompressedTexture||I.image[0].isCompressedTexture,je=I.image[0]&&I.image[0].isDataTexture,ze=[];for(let Te=0;Te<6;Te++)!We&&!je?ze[Te]=b(I.image[Te],!1,!0,c):ze[Te]=je?I.image[Te].image:I.image[Te],ze[Te]=B(I,ze[Te]);let Je=ze[0],nt=x(Je)||s,lt=a.convert(I.format,I.encoding),dt=a.convert(I.type),vt=C(I.internalFormat,lt,dt,I.encoding),se=s&&I.isVideoTexture!==!0,Le=Ae.__version===void 0||j===!0,Ye=A(I,Je,nt);ee(34067,I,nt);let pe;if(We){se&&Le&&r.texStorage2D(34067,Ye,vt,Je.width,Je.height);for(let Te=0;Te<6;Te++){pe=ze[Te].mipmaps;for(let ce=0;ce<pe.length;ce++){let Re=pe[ce];I.format!==In?lt!==null?se?r.compressedTexSubImage2D(34069+Te,ce,0,0,Re.width,Re.height,lt,Re.data):r.compressedTexImage2D(34069+Te,ce,vt,Re.width,Re.height,0,Re.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):se?r.texSubImage2D(34069+Te,ce,0,0,Re.width,Re.height,lt,dt,Re.data):r.texImage2D(34069+Te,ce,vt,Re.width,Re.height,0,lt,dt,Re.data)}}}else{pe=I.mipmaps,se&&Le&&(pe.length>0&&Ye++,r.texStorage2D(34067,Ye,vt,ze[0].width,ze[0].height));for(let Te=0;Te<6;Te++)if(je){se?r.texSubImage2D(34069+Te,0,0,0,ze[Te].width,ze[Te].height,lt,dt,ze[Te].data):r.texImage2D(34069+Te,0,vt,ze[Te].width,ze[Te].height,0,lt,dt,ze[Te].data);for(let ce=0;ce<pe.length;ce++){let Re=pe[ce].image[Te].image;se?r.texSubImage2D(34069+Te,ce+1,0,0,Re.width,Re.height,lt,dt,Re.data):r.texImage2D(34069+Te,ce+1,vt,Re.width,Re.height,0,lt,dt,Re.data)}}else{se?r.texSubImage2D(34069+Te,0,0,0,lt,dt,ze[Te]):r.texImage2D(34069+Te,0,vt,lt,dt,ze[Te]);for(let ce=0;ce<pe.length;ce++){let Re=pe[ce];se?r.texSubImage2D(34069+Te,ce+1,0,0,lt,dt,Re.image[Te]):r.texImage2D(34069+Te,ce+1,vt,lt,dt,Re.image[Te])}}}w(I,nt)&&_(34067),Ae.__version=L.version,I.onUpdate&&I.onUpdate(I)}D.__version=I.version}function de(D,I,O,j,L){let Ae=a.convert(O.format,O.encoding),We=a.convert(O.type),je=C(O.internalFormat,Ae,We,O.encoding);i.get(I).__hasExternalTextures||(L===32879||L===35866?r.texImage3D(L,0,je,I.width,I.height,I.depth,0,Ae,We,null):r.texImage2D(L,0,je,I.width,I.height,0,Ae,We,null)),r.bindFramebuffer(36160,D),Ee(I)?h.framebufferTexture2DMultisampleEXT(36160,j,L,i.get(O).__webglTexture,0,_e(I)):(L===3553||L>=34069&&L<=34074)&&e.framebufferTexture2D(36160,j,L,i.get(O).__webglTexture,0),r.bindFramebuffer(36160,null)}function me(D,I,O){if(e.bindRenderbuffer(36161,D),I.depthBuffer&&!I.stencilBuffer){let j=33189;if(O||Ee(I)){let L=I.depthTexture;L&&L.isDepthTexture&&(L.type===on?j=36012:L.type===Wl&&(j=33190));let Ae=_e(I);Ee(I)?h.renderbufferStorageMultisampleEXT(36161,Ae,j,I.width,I.height):e.renderbufferStorageMultisample(36161,Ae,j,I.width,I.height)}else e.renderbufferStorage(36161,j,I.width,I.height);e.framebufferRenderbuffer(36160,36096,36161,D)}else if(I.depthBuffer&&I.stencilBuffer){let j=_e(I);O&&Ee(I)===!1?e.renderbufferStorageMultisample(36161,j,35056,I.width,I.height):Ee(I)?h.renderbufferStorageMultisampleEXT(36161,j,35056,I.width,I.height):e.renderbufferStorage(36161,34041,I.width,I.height),e.framebufferRenderbuffer(36160,33306,36161,D)}else{let j=I.isWebGLMultipleRenderTargets===!0?I.texture:[I.texture];for(let L=0;L<j.length;L++){let Ae=j[L],We=a.convert(Ae.format,Ae.encoding),je=a.convert(Ae.type),ze=C(Ae.internalFormat,We,je,Ae.encoding),Je=_e(I);O&&Ee(I)===!1?e.renderbufferStorageMultisample(36161,Je,ze,I.width,I.height):Ee(I)?h.renderbufferStorageMultisampleEXT(36161,Je,ze,I.width,I.height):e.renderbufferStorage(36161,ze,I.width,I.height)}}e.bindRenderbuffer(36161,null)}function Ce(D,I){if(I&&I.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(r.bindFramebuffer(36160,D),!(I.depthTexture&&I.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(I.depthTexture).__webglTexture||I.depthTexture.image.width!==I.width||I.depthTexture.image.height!==I.height)&&(I.depthTexture.image.width=I.width,I.depthTexture.image.height=I.height,I.depthTexture.needsUpdate=!0),te(I.depthTexture,0);let O=i.get(I.depthTexture).__webglTexture,j=_e(I);if(I.depthTexture.format===Uu)Ee(I)?h.framebufferTexture2DMultisampleEXT(36160,36096,3553,O,0,j):e.framebufferTexture2D(36160,36096,3553,O,0);else if(I.depthTexture.format===ih)Ee(I)?h.framebufferTexture2DMultisampleEXT(36160,33306,3553,O,0,j):e.framebufferTexture2D(36160,33306,3553,O,0);else throw new Error("Unknown depthTexture format")}function G(D){let I=i.get(D),O=D.isWebGLCubeRenderTarget===!0;if(D.depthTexture&&!I.__autoAllocateDepthBuffer){if(O)throw new Error("target.depthTexture not supported in Cube render targets");Ce(I.__webglFramebuffer,D)}else if(O){I.__webglDepthbuffer=[];for(let j=0;j<6;j++)r.bindFramebuffer(36160,I.__webglFramebuffer[j]),I.__webglDepthbuffer[j]=e.createRenderbuffer(),me(I.__webglDepthbuffer[j],D,!1)}else r.bindFramebuffer(36160,I.__webglFramebuffer),I.__webglDepthbuffer=e.createRenderbuffer(),me(I.__webglDepthbuffer,D,!1);r.bindFramebuffer(36160,null)}function Z(D,I,O){let j=i.get(D);I!==void 0&&de(j.__webglFramebuffer,D,D.texture,36064,3553),O!==void 0&&G(D)}function ue(D){let I=D.texture,O=i.get(D),j=i.get(I);D.addEventListener("dispose",T),D.isWebGLMultipleRenderTargets!==!0&&(j.__webglTexture===void 0&&(j.__webglTexture=e.createTexture()),j.__version=I.version,o.memory.textures++);let L=D.isWebGLCubeRenderTarget===!0,Ae=D.isWebGLMultipleRenderTargets===!0,We=x(D)||s;if(L){O.__webglFramebuffer=[];for(let je=0;je<6;je++)O.__webglFramebuffer[je]=e.createFramebuffer()}else{if(O.__webglFramebuffer=e.createFramebuffer(),Ae)if(n.drawBuffers){let je=D.texture;for(let ze=0,Je=je.length;ze<Je;ze++){let nt=i.get(je[ze]);nt.__webglTexture===void 0&&(nt.__webglTexture=e.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(s&&D.samples>0&&Ee(D)===!1){let je=Ae?I:[I];O.__webglMultisampledFramebuffer=e.createFramebuffer(),O.__webglColorRenderbuffer=[],r.bindFramebuffer(36160,O.__webglMultisampledFramebuffer);for(let ze=0;ze<je.length;ze++){let Je=je[ze];O.__webglColorRenderbuffer[ze]=e.createRenderbuffer(),e.bindRenderbuffer(36161,O.__webglColorRenderbuffer[ze]);let nt=a.convert(Je.format,Je.encoding),lt=a.convert(Je.type),dt=C(Je.internalFormat,nt,lt,Je.encoding,D.isXRRenderTarget===!0),vt=_e(D);e.renderbufferStorageMultisample(36161,vt,dt,D.width,D.height),e.framebufferRenderbuffer(36160,36064+ze,36161,O.__webglColorRenderbuffer[ze])}e.bindRenderbuffer(36161,null),D.depthBuffer&&(O.__webglDepthRenderbuffer=e.createRenderbuffer(),me(O.__webglDepthRenderbuffer,D,!0)),r.bindFramebuffer(36160,null)}}if(L){r.bindTexture(34067,j.__webglTexture),ee(34067,I,We);for(let je=0;je<6;je++)de(O.__webglFramebuffer[je],D,I,36064,34069+je);w(I,We)&&_(34067),r.unbindTexture()}else if(Ae){let je=D.texture;for(let ze=0,Je=je.length;ze<Je;ze++){let nt=je[ze],lt=i.get(nt);r.bindTexture(3553,lt.__webglTexture),ee(3553,nt,We),de(O.__webglFramebuffer,D,nt,36064+ze,3553),w(nt,We)&&_(3553)}r.unbindTexture()}else{let je=3553;(D.isWebGL3DRenderTarget||D.isWebGLArrayRenderTarget)&&(s?je=D.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),r.bindTexture(je,j.__webglTexture),ee(je,I,We),de(O.__webglFramebuffer,D,I,36064,je),w(I,We)&&_(je),r.unbindTexture()}D.depthBuffer&&G(D)}function Se(D){let I=x(D)||s,O=D.isWebGLMultipleRenderTargets===!0?D.texture:[D.texture];for(let j=0,L=O.length;j<L;j++){let Ae=O[j];if(w(Ae,I)){let We=D.isWebGLCubeRenderTarget?34067:3553,je=i.get(Ae).__webglTexture;r.bindTexture(We,je),_(We),r.unbindTexture()}}}function we(D){if(s&&D.samples>0&&Ee(D)===!1){let I=D.isWebGLMultipleRenderTargets?D.texture:[D.texture],O=D.width,j=D.height,L=16384,Ae=[],We=D.stencilBuffer?33306:36096,je=i.get(D),ze=D.isWebGLMultipleRenderTargets===!0;if(ze)for(let Je=0;Je<I.length;Je++)r.bindFramebuffer(36160,je.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064+Je,36161,null),r.bindFramebuffer(36160,je.__webglFramebuffer),e.framebufferTexture2D(36009,36064+Je,3553,null,0);r.bindFramebuffer(36008,je.__webglMultisampledFramebuffer),r.bindFramebuffer(36009,je.__webglFramebuffer);for(let Je=0;Je<I.length;Je++){Ae.push(36064+Je),D.depthBuffer&&Ae.push(We);let nt=je.__ignoreDepthValues!==void 0?je.__ignoreDepthValues:!1;if(nt===!1&&(D.depthBuffer&&(L|=256),D.stencilBuffer&&(L|=1024)),ze&&e.framebufferRenderbuffer(36008,36064,36161,je.__webglColorRenderbuffer[Je]),nt===!0&&(e.invalidateFramebuffer(36008,[We]),e.invalidateFramebuffer(36009,[We])),ze){let lt=i.get(I[Je]).__webglTexture;e.framebufferTexture2D(36009,36064,3553,lt,0)}e.blitFramebuffer(0,0,O,j,0,0,O,j,L,9728),f&&e.invalidateFramebuffer(36008,Ae)}if(r.bindFramebuffer(36008,null),r.bindFramebuffer(36009,null),ze)for(let Je=0;Je<I.length;Je++){r.bindFramebuffer(36160,je.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064+Je,36161,je.__webglColorRenderbuffer[Je]);let nt=i.get(I[Je]).__webglTexture;r.bindFramebuffer(36160,je.__webglFramebuffer),e.framebufferTexture2D(36009,36064+Je,3553,nt,0)}r.bindFramebuffer(36009,je.__webglMultisampledFramebuffer)}}function _e(D){return Math.min(u,D.samples)}function Ee(D){let I=i.get(D);return s&&D.samples>0&&t.has("WEBGL_multisampled_render_to_texture")===!0&&I.__useRenderToTexture!==!1}function fe(D){let I=o.render.frame;p.get(D)!==I&&(p.set(D,I),D.update())}function B(D,I){let O=D.encoding,j=D.format,L=D.type;return D.isCompressedTexture===!0||D.isVideoTexture===!0||D.format===DA||O!==hs&&(O===sr?s===!1?t.has("EXT_sRGB")===!0&&j===In?(D.format=DA,D.minFilter=ur,D.generateMipmaps=!1):I=hj.sRGBToLinear(I):(j!==In||L!==ga)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",O)),I}this.allocateTextureUnit=U,this.resetTextureUnits=N,this.setTexture2D=te,this.setTexture2DArray=X,this.setTexture3D=W,this.setTextureCube=q,this.rebindTextures=Z,this.setupRenderTarget=ue,this.updateRenderTargetMipmap=Se,this.updateMultisampleRenderTarget=we,this.setupDepthRenderbuffer=G,this.setupFrameBufferTexture=de,this.useMultisampledRTT=Ee}function Oxe(e,t,r){let i=r.isWebGL2;function n(a,o=null){let s;if(a===ga)return 5121;if(a===fve)return 32819;if(a===pve)return 32820;if(a===dve)return 5120;if(a===uve)return 5122;if(a===nj)return 5123;if(a===hve)return 5124;if(a===Wl)return 5125;if(a===on)return 5126;if(a===ec)return i?5131:(s=t.get("OES_texture_half_float"),s!==null?s.HALF_FLOAT_OES:null);if(a===mve)return 6406;if(a===In)return 6408;if(a===vve)return 6409;if(a===gve)return 6410;if(a===Uu)return 6402;if(a===ih)return 34041;if(a===DA)return s=t.get("EXT_sRGB"),s!==null?s.SRGB_ALPHA_EXT:null;if(a===yve)return 6403;if(a===bve)return 36244;if(a===sx)return 33319;if(a===xve)return 33320;if(a===aj)return 36249;if(a===TS||a===PS||a===DS||a===OS)if(o===sr)if(s=t.get("WEBGL_compressed_texture_s3tc_srgb"),s!==null){if(a===TS)return s.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(a===PS)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(a===DS)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(a===OS)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(s=t.get("WEBGL_compressed_texture_s3tc"),s!==null){if(a===TS)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(a===PS)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(a===DS)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(a===OS)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(a===nI||a===aI||a===oI||a===sI)if(s=t.get("WEBGL_compressed_texture_pvrtc"),s!==null){if(a===nI)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(a===aI)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(a===oI)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(a===sI)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(a===wve)return s=t.get("WEBGL_compressed_texture_etc1"),s!==null?s.COMPRESSED_RGB_ETC1_WEBGL:null;if(a===lI||a===cI)if(s=t.get("WEBGL_compressed_texture_etc"),s!==null){if(a===lI)return o===sr?s.COMPRESSED_SRGB8_ETC2:s.COMPRESSED_RGB8_ETC2;if(a===cI)return o===sr?s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:s.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(a===dI||a===uI||a===hI||a===fI||a===pI||a===mI||a===vI||a===gI||a===yI||a===bI||a===xI||a===wI||a===SI||a===CI)if(s=t.get("WEBGL_compressed_texture_astc"),s!==null){if(a===dI)return o===sr?s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:s.COMPRESSED_RGBA_ASTC_4x4_KHR;if(a===uI)return o===sr?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s.COMPRESSED_RGBA_ASTC_5x4_KHR;if(a===hI)return o===sr?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:s.COMPRESSED_RGBA_ASTC_5x5_KHR;if(a===fI)return o===sr?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s.COMPRESSED_RGBA_ASTC_6x5_KHR;if(a===pI)return o===sr?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:s.COMPRESSED_RGBA_ASTC_6x6_KHR;if(a===mI)return o===sr?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:s.COMPRESSED_RGBA_ASTC_8x5_KHR;if(a===vI)return o===sr?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s.COMPRESSED_RGBA_ASTC_8x6_KHR;if(a===gI)return o===sr?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:s.COMPRESSED_RGBA_ASTC_8x8_KHR;if(a===yI)return o===sr?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:s.COMPRESSED_RGBA_ASTC_10x5_KHR;if(a===bI)return o===sr?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:s.COMPRESSED_RGBA_ASTC_10x6_KHR;if(a===xI)return o===sr?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:s.COMPRESSED_RGBA_ASTC_10x8_KHR;if(a===wI)return o===sr?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(a===SI)return o===sr?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(a===CI)return o===sr?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:s.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(a===RS)if(s=t.get("EXT_texture_compression_bptc"),s!==null){if(a===RS)return o===sr?s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:s.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(a===Sve||a===_I||a===AI||a===MI)if(s=t.get("EXT_texture_compression_rgtc"),s!==null){if(a===RS)return s.COMPRESSED_RED_RGTC1_EXT;if(a===_I)return s.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(a===AI)return s.COMPRESSED_RED_GREEN_RGTC2_EXT;if(a===MI)return s.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return a===Nu?i?34042:(s=t.get("WEBGL_depth_texture"),s!==null?s.UNSIGNED_INT_24_8_WEBGL:null):e[a]!==void 0?e[a]:null}return{convert:n}}var Rxe=class extends da{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}},$l=class extends Yr{constructor(){super(),this.isGroup=!0,this.type="Group"}},Ixe={type:"move"},nC=class{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new $l,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new $l,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new k,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new k),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new $l,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new k,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new k),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){let t=this._hand;if(t)for(let r of e.hand.values())this._getHandJoint(t,r)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,r){let i=null,n=null,a=null,o=this._targetRay,s=this._grip,l=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(l&&e.hand){a=!0;for(let p of e.hand.values()){let v=t.getJointPose(p,r),m=this._getHandJoint(l,p);v!==null&&(m.matrix.fromArray(v.transform.matrix),m.matrix.decompose(m.position,m.rotation,m.scale),m.jointRadius=v.radius),m.visible=v!==null}let c=l.joints["index-finger-tip"],d=l.joints["thumb-tip"],u=c.position.distanceTo(d.position),h=.02,f=.005;l.inputState.pinching&&u>h+f?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&u<=h-f&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else s!==null&&e.gripSpace&&(n=t.getPose(e.gripSpace,r),n!==null&&(s.matrix.fromArray(n.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale),n.linearVelocity?(s.hasLinearVelocity=!0,s.linearVelocity.copy(n.linearVelocity)):s.hasLinearVelocity=!1,n.angularVelocity?(s.hasAngularVelocity=!0,s.angularVelocity.copy(n.angularVelocity)):s.hasAngularVelocity=!1));o!==null&&(i=t.getPose(e.targetRaySpace,r),i===null&&n!==null&&(i=n),i!==null&&(o.matrix.fromArray(i.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),i.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(i.linearVelocity)):o.hasLinearVelocity=!1,i.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(i.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent(Ixe)))}return o!==null&&(o.visible=i!==null),s!==null&&(s.visible=n!==null),l!==null&&(l.visible=a!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){let r=new $l;r.matrixAutoUpdate=!1,r.visible=!1,e.joints[t.jointName]=r,e.add(r)}return e.joints[t.jointName]}},gp=class extends Oi{constructor(e,t,r,i,n,a,o,s,l,c){if(c=c!==void 0?c:Uu,c!==Uu&&c!==ih)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");r===void 0&&c===Uu&&(r=Wl),r===void 0&&c===ih&&(r=Nu),super(null,i,n,a,o,s,c,r,l),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=o!==void 0?o:Hr,this.minFilter=s!==void 0?s:Hr,this.flipY=!1,this.generateMipmaps=!1}},zxe=class extends aa{constructor(e,t){super();let r=this,i=null,n=1,a=null,o="local-floor",s=1,l=null,c=null,d=null,u=null,h=null,f=null,p=t.getContextAttributes(),v=null,m=null,g=[],y=[],b=new Set,x=new Map,S=new da;S.layers.enable(1),S.viewport=new Kt;let w=new da;w.layers.enable(2),w.viewport=new Kt;let _=[S,w],C=new Rxe;C.layers.enable(1),C.layers.enable(2);let A=null,M=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(X){let W=g[X];return W===void 0&&(W=new nC,g[X]=W),W.getTargetRaySpace()},this.getControllerGrip=function(X){let W=g[X];return W===void 0&&(W=new nC,g[X]=W),W.getGripSpace()},this.getHand=function(X){let W=g[X];return W===void 0&&(W=new nC,g[X]=W),W.getHandSpace()};function P(X){let W=y.indexOf(X.inputSource);if(W===-1)return;let q=g[W];q!==void 0&&q.dispatchEvent({type:X.type,data:X.inputSource})}function T(){i.removeEventListener("select",P),i.removeEventListener("selectstart",P),i.removeEventListener("selectend",P),i.removeEventListener("squeeze",P),i.removeEventListener("squeezestart",P),i.removeEventListener("squeezeend",P),i.removeEventListener("end",T),i.removeEventListener("inputsourceschange",R);for(let X=0;X<g.length;X++){let W=y[X];W!==null&&(y[X]=null,g[X].disconnect(W))}A=null,M=null,e.setRenderTarget(v),h=null,u=null,d=null,i=null,m=null,te.stop(),r.isPresenting=!1,r.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(X){n=X,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(X){o=X,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l||a},this.setReferenceSpace=function(X){l=X},this.getBaseLayer=function(){return u!==null?u:h},this.getBinding=function(){return d},this.getFrame=function(){return f},this.getSession=function(){return i},this.setSession=async function(X){if(i=X,i!==null){if(v=e.getRenderTarget(),i.addEventListener("select",P),i.addEventListener("selectstart",P),i.addEventListener("selectend",P),i.addEventListener("squeeze",P),i.addEventListener("squeezestart",P),i.addEventListener("squeezeend",P),i.addEventListener("end",T),i.addEventListener("inputsourceschange",R),p.xrCompatible!==!0&&await t.makeXRCompatible(),i.renderState.layers===void 0||e.capabilities.isWebGL2===!1){let W={antialias:i.renderState.layers===void 0?p.antialias:!0,alpha:p.alpha,depth:p.depth,stencil:p.stencil,framebufferScaleFactor:n};h=new XRWebGLLayer(i,t,W),i.updateRenderState({baseLayer:h}),m=new Ur(h.framebufferWidth,h.framebufferHeight,{format:In,type:ga,encoding:e.outputEncoding,stencilBuffer:p.stencil})}else{let W=null,q=null,$=null;p.depth&&($=p.stencil?35056:33190,W=p.stencil?ih:Uu,q=p.stencil?Nu:Wl);let le={colorFormat:32856,depthFormat:$,scaleFactor:n};d=new XRWebGLBinding(i,t),u=d.createProjectionLayer(le),i.updateRenderState({layers:[u]}),m=new Ur(u.textureWidth,u.textureHeight,{format:In,type:ga,depthTexture:new gp(u.textureWidth,u.textureHeight,q,void 0,void 0,void 0,void 0,void 0,void 0,W),stencilBuffer:p.stencil,encoding:e.outputEncoding,samples:p.antialias?4:0});let ee=e.properties.get(m);ee.__ignoreDepthValues=u.ignoreDepthValues}m.isXRRenderTarget=!0,this.setFoveation(s),l=null,a=await i.requestReferenceSpace(o),te.setContext(i),te.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}};function R(X){for(let W=0;W<X.removed.length;W++){let q=X.removed[W],$=y.indexOf(q);$>=0&&(y[$]=null,g[$].disconnect(q))}for(let W=0;W<X.added.length;W++){let q=X.added[W],$=y.indexOf(q);if($===-1){for(let ee=0;ee<g.length;ee++)if(ee>=y.length){y.push(q),$=ee;break}else if(y[ee]===null){y[ee]=q,$=ee;break}if($===-1)break}let le=g[$];le&&le.connect(q)}}let z=new k,F=new k;function H(X,W,q){z.setFromMatrixPosition(W.matrixWorld),F.setFromMatrixPosition(q.matrixWorld);let $=z.distanceTo(F),le=W.projectionMatrix.elements,ee=q.projectionMatrix.elements,Q=le[14]/(le[10]-1),ne=le[14]/(le[10]+1),V=(le[9]+1)/le[5],de=(le[9]-1)/le[5],me=(le[8]-1)/le[0],Ce=(ee[8]+1)/ee[0],G=Q*me,Z=Q*Ce,ue=$/(-me+Ce),Se=ue*-me;W.matrixWorld.decompose(X.position,X.quaternion,X.scale),X.translateX(Se),X.translateZ(ue),X.matrixWorld.compose(X.position,X.quaternion,X.scale),X.matrixWorldInverse.copy(X.matrixWorld).invert();let we=Q+ue,_e=ne+ue,Ee=G-Se,fe=Z+($-Se),B=V*ne/_e*we,D=de*ne/_e*we;X.projectionMatrix.makePerspective(Ee,fe,B,D,we,_e)}function N(X,W){W===null?X.matrixWorld.copy(X.matrix):X.matrixWorld.multiplyMatrices(W.matrixWorld,X.matrix),X.matrixWorldInverse.copy(X.matrixWorld).invert()}this.updateCamera=function(X){if(i===null)return;C.near=w.near=S.near=X.near,C.far=w.far=S.far=X.far,(A!==C.near||M!==C.far)&&(i.updateRenderState({depthNear:C.near,depthFar:C.far}),A=C.near,M=C.far);let W=X.parent,q=C.cameras;N(C,W);for(let le=0;le<q.length;le++)N(q[le],W);C.matrixWorld.decompose(C.position,C.quaternion,C.scale),X.matrix.copy(C.matrix),X.matrix.decompose(X.position,X.quaternion,X.scale);let $=X.children;for(let le=0,ee=$.length;le<ee;le++)$[le].updateMatrixWorld(!0);q.length===2?H(C,S,w):C.projectionMatrix.copy(S.projectionMatrix)},this.getCamera=function(){return C},this.getFoveation=function(){if(!(u===null&&h===null))return s},this.setFoveation=function(X){s=X,u!==null&&(u.fixedFoveation=X),h!==null&&h.fixedFoveation!==void 0&&(h.fixedFoveation=X)},this.getPlanes=function(){return b};let U=null;function ie(X,W){if(c=W.getViewerPose(l||a),f=W,c!==null){let q=c.views;h!==null&&(e.setRenderTargetFramebuffer(m,h.framebuffer),e.setRenderTarget(m));let $=!1;q.length!==C.cameras.length&&(C.cameras.length=0,$=!0);for(let le=0;le<q.length;le++){let ee=q[le],Q=null;if(h!==null)Q=h.getViewport(ee);else{let V=d.getViewSubImage(u,ee);Q=V.viewport,le===0&&(e.setRenderTargetTextures(m,V.colorTexture,u.ignoreDepthValues?void 0:V.depthStencilTexture),e.setRenderTarget(m))}let ne=_[le];ne===void 0&&(ne=new da,ne.layers.enable(le),ne.viewport=new Kt,_[le]=ne),ne.matrix.fromArray(ee.transform.matrix),ne.projectionMatrix.fromArray(ee.projectionMatrix),ne.viewport.set(Q.x,Q.y,Q.width,Q.height),le===0&&C.matrix.copy(ne.matrix),$===!0&&C.cameras.push(ne)}}for(let q=0;q<g.length;q++){let $=y[q],le=g[q];$!==null&&le!==void 0&&le.update($,W,l||a)}if(U&&U(X,W),W.detectedPlanes){r.dispatchEvent({type:"planesdetected",data:W.detectedPlanes});let q=null;for(let $ of b)W.detectedPlanes.has($)||(q===null&&(q=[]),q.push($));if(q!==null)for(let $ of q)b.delete($),x.delete($),r.dispatchEvent({type:"planeremoved",data:$});for(let $ of W.detectedPlanes)if(!b.has($))b.add($),x.set($,W.lastChangedTime),r.dispatchEvent({type:"planeadded",data:$});else{let le=x.get($);$.lastChangedTime>le&&(x.set($,$.lastChangedTime),r.dispatchEvent({type:"planechanged",data:$}))}}f=null}let te=new gj;te.setAnimationLoop(ie),this.setAnimationLoop=function(X){U=X},this.dispose=function(){}}};function kxe(e,t){function r(v,m){m.color.getRGB(v.fogColor.value,vj(e)),m.isFog?(v.fogNear.value=m.near,v.fogFar.value=m.far):m.isFogExp2&&(v.fogDensity.value=m.density)}function i(v,m,g,y,b){m.isMeshBasicMaterial||m.isMeshLambertMaterial?n(v,m):m.isMeshToonMaterial?(n(v,m),d(v,m)):m.isMeshPhongMaterial?(n(v,m),c(v,m)):m.isMeshStandardMaterial?(n(v,m),u(v,m),m.isMeshPhysicalMaterial&&h(v,m,b)):m.isMeshMatcapMaterial?(n(v,m),f(v,m)):m.isMeshDepthMaterial?n(v,m):m.isMeshDistanceMaterial?(n(v,m),p(v,m)):m.isMeshNormalMaterial?n(v,m):m.isLineBasicMaterial?(a(v,m),m.isLineDashedMaterial&&o(v,m)):m.isPointsMaterial?s(v,m,g,y):m.isSpriteMaterial?l(v,m):m.isShadowMaterial?(v.color.value.copy(m.color),v.opacity.value=m.opacity):m.isShaderMaterial&&(m.uniformsNeedUpdate=!1)}function n(v,m){v.opacity.value=m.opacity,m.color&&v.diffuse.value.copy(m.color),m.emissive&&v.emissive.value.copy(m.emissive).multiplyScalar(m.emissiveIntensity),m.map&&(v.map.value=m.map),m.alphaMap&&(v.alphaMap.value=m.alphaMap),m.bumpMap&&(v.bumpMap.value=m.bumpMap,v.bumpScale.value=m.bumpScale,m.side===Ln&&(v.bumpScale.value*=-1)),m.displacementMap&&(v.displacementMap.value=m.displacementMap,v.displacementScale.value=m.displacementScale,v.displacementBias.value=m.displacementBias),m.emissiveMap&&(v.emissiveMap.value=m.emissiveMap),m.normalMap&&(v.normalMap.value=m.normalMap,v.normalScale.value.copy(m.normalScale),m.side===Ln&&v.normalScale.value.negate()),m.specularMap&&(v.specularMap.value=m.specularMap),m.alphaTest>0&&(v.alphaTest.value=m.alphaTest);let g=t.get(m).envMap;if(g&&(v.envMap.value=g,v.flipEnvMap.value=g.isCubeTexture&&g.isRenderTargetTexture===!1?-1:1,v.reflectivity.value=m.reflectivity,v.ior.value=m.ior,v.refractionRatio.value=m.refractionRatio),m.lightMap){v.lightMap.value=m.lightMap;let x=e.physicallyCorrectLights!==!0?Math.PI:1;v.lightMapIntensity.value=m.lightMapIntensity*x}m.aoMap&&(v.aoMap.value=m.aoMap,v.aoMapIntensity.value=m.aoMapIntensity);let y;m.map?y=m.map:m.specularMap?y=m.specularMap:m.displacementMap?y=m.displacementMap:m.normalMap?y=m.normalMap:m.bumpMap?y=m.bumpMap:m.roughnessMap?y=m.roughnessMap:m.metalnessMap?y=m.metalnessMap:m.alphaMap?y=m.alphaMap:m.emissiveMap?y=m.emissiveMap:m.clearcoatMap?y=m.clearcoatMap:m.clearcoatNormalMap?y=m.clearcoatNormalMap:m.clearcoatRoughnessMap?y=m.clearcoatRoughnessMap:m.iridescenceMap?y=m.iridescenceMap:m.iridescenceThicknessMap?y=m.iridescenceThicknessMap:m.specularIntensityMap?y=m.specularIntensityMap:m.specularColorMap?y=m.specularColorMap:m.transmissionMap?y=m.transmissionMap:m.thicknessMap?y=m.thicknessMap:m.sheenColorMap?y=m.sheenColorMap:m.sheenRoughnessMap&&(y=m.sheenRoughnessMap),y!==void 0&&(y.isWebGLRenderTarget&&(y=y.texture),y.matrixAutoUpdate===!0&&y.updateMatrix(),v.uvTransform.value.copy(y.matrix));let b;m.aoMap?b=m.aoMap:m.lightMap&&(b=m.lightMap),b!==void 0&&(b.isWebGLRenderTarget&&(b=b.texture),b.matrixAutoUpdate===!0&&b.updateMatrix(),v.uv2Transform.value.copy(b.matrix))}function a(v,m){v.diffuse.value.copy(m.color),v.opacity.value=m.opacity}function o(v,m){v.dashSize.value=m.dashSize,v.totalSize.value=m.dashSize+m.gapSize,v.scale.value=m.scale}function s(v,m,g,y){v.diffuse.value.copy(m.color),v.opacity.value=m.opacity,v.size.value=m.size*g,v.scale.value=y*.5,m.map&&(v.map.value=m.map),m.alphaMap&&(v.alphaMap.value=m.alphaMap),m.alphaTest>0&&(v.alphaTest.value=m.alphaTest);let b;m.map?b=m.map:m.alphaMap&&(b=m.alphaMap),b!==void 0&&(b.matrixAutoUpdate===!0&&b.updateMatrix(),v.uvTransform.value.copy(b.matrix))}function l(v,m){v.diffuse.value.copy(m.color),v.opacity.value=m.opacity,v.rotation.value=m.rotation,m.map&&(v.map.value=m.map),m.alphaMap&&(v.alphaMap.value=m.alphaMap),m.alphaTest>0&&(v.alphaTest.value=m.alphaTest);let g;m.map?g=m.map:m.alphaMap&&(g=m.alphaMap),g!==void 0&&(g.matrixAutoUpdate===!0&&g.updateMatrix(),v.uvTransform.value.copy(g.matrix))}function c(v,m){v.specular.value.copy(m.specular),v.shininess.value=Math.max(m.shininess,1e-4)}function d(v,m){m.gradientMap&&(v.gradientMap.value=m.gradientMap)}function u(v,m){v.roughness.value=m.roughness,v.metalness.value=m.metalness,m.roughnessMap&&(v.roughnessMap.value=m.roughnessMap),m.metalnessMap&&(v.metalnessMap.value=m.metalnessMap),t.get(m).envMap&&(v.envMapIntensity.value=m.envMapIntensity)}function h(v,m,g){v.ior.value=m.ior,m.sheen>0&&(v.sheenColor.value.copy(m.sheenColor).multiplyScalar(m.sheen),v.sheenRoughness.value=m.sheenRoughness,m.sheenColorMap&&(v.sheenColorMap.value=m.sheenColorMap),m.sheenRoughnessMap&&(v.sheenRoughnessMap.value=m.sheenRoughnessMap)),m.clearcoat>0&&(v.clearcoat.value=m.clearcoat,v.clearcoatRoughness.value=m.clearcoatRoughness,m.clearcoatMap&&(v.clearcoatMap.value=m.clearcoatMap),m.clearcoatRoughnessMap&&(v.clearcoatRoughnessMap.value=m.clearcoatRoughnessMap),m.clearcoatNormalMap&&(v.clearcoatNormalScale.value.copy(m.clearcoatNormalScale),v.clearcoatNormalMap.value=m.clearcoatNormalMap,m.side===Ln&&v.clearcoatNormalScale.value.negate())),m.iridescence>0&&(v.iridescence.value=m.iridescence,v.iridescenceIOR.value=m.iridescenceIOR,v.iridescenceThicknessMinimum.value=m.iridescenceThicknessRange[0],v.iridescenceThicknessMaximum.value=m.iridescenceThicknessRange[1],m.iridescenceMap&&(v.iridescenceMap.value=m.iridescenceMap),m.iridescenceThicknessMap&&(v.iridescenceThicknessMap.value=m.iridescenceThicknessMap)),m.transmission>0&&(v.transmission.value=m.transmission,v.transmissionSamplerMap.value=g.texture,v.transmissionSamplerSize.value.set(g.width,g.height),m.transmissionMap&&(v.transmissionMap.value=m.transmissionMap),v.thickness.value=m.thickness,m.thicknessMap&&(v.thicknessMap.value=m.thicknessMap),v.attenuationDistance.value=m.attenuationDistance,v.attenuationColor.value.copy(m.attenuationColor)),v.specularIntensity.value=m.specularIntensity,v.specularColor.value.copy(m.specularColor),m.specularIntensityMap&&(v.specularIntensityMap.value=m.specularIntensityMap),m.specularColorMap&&(v.specularColorMap.value=m.specularColorMap)}function f(v,m){m.matcap&&(v.matcap.value=m.matcap)}function p(v,m){v.referencePosition.value.copy(m.referencePosition),v.nearDistance.value=m.nearDistance,v.farDistance.value=m.farDistance}return{refreshFogUniforms:r,refreshMaterialUniforms:i}}function Lxe(e,t,r,i){let n={},a={},o=[],s=r.isWebGL2?e.getParameter(35375):0;function l(y,b){let x=b.program;i.uniformBlockBinding(y,x)}function c(y,b){let x=n[y.id];x===void 0&&(p(y),x=d(y),n[y.id]=x,y.addEventListener("dispose",m));let S=b.program;i.updateUBOMapping(y,S);let w=t.render.frame;a[y.id]!==w&&(h(y),a[y.id]=w)}function d(y){let b=u();y.__bindingPointIndex=b;let x=e.createBuffer(),S=y.__size,w=y.usage;return e.bindBuffer(35345,x),e.bufferData(35345,S,w),e.bindBuffer(35345,null),e.bindBufferBase(35345,b,x),x}function u(){for(let y=0;y<s;y++)if(o.indexOf(y)===-1)return o.push(y),y;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function h(y){let b=n[y.id],x=y.uniforms,S=y.__cache;e.bindBuffer(35345,b);for(let w=0,_=x.length;w<_;w++){let C=x[w];if(f(C,w,S)===!0){let A=C.__offset,M=Array.isArray(C.value)?C.value:[C.value],P=0;for(let T=0;T<M.length;T++){let R=M[T],z=v(R);typeof R=="number"?(C.__data[0]=R,e.bufferSubData(35345,A+P,C.__data)):R.isMatrix3?(C.__data[0]=R.elements[0],C.__data[1]=R.elements[1],C.__data[2]=R.elements[2],C.__data[3]=R.elements[0],C.__data[4]=R.elements[3],C.__data[5]=R.elements[4],C.__data[6]=R.elements[5],C.__data[7]=R.elements[0],C.__data[8]=R.elements[6],C.__data[9]=R.elements[7],C.__data[10]=R.elements[8],C.__data[11]=R.elements[0]):(R.toArray(C.__data,P),P+=z.storage/Float32Array.BYTES_PER_ELEMENT)}e.bufferSubData(35345,A,C.__data)}}e.bindBuffer(35345,null)}function f(y,b,x){let S=y.value;if(x[b]===void 0){if(typeof S=="number")x[b]=S;else{let w=Array.isArray(S)?S:[S],_=[];for(let C=0;C<w.length;C++)_.push(w[C].clone());x[b]=_}return!0}else if(typeof S=="number"){if(x[b]!==S)return x[b]=S,!0}else{let w=Array.isArray(x[b])?x[b]:[x[b]],_=Array.isArray(S)?S:[S];for(let C=0;C<w.length;C++){let A=w[C];if(A.equals(_[C])===!1)return A.copy(_[C]),!0}}return!1}function p(y){let b=y.uniforms,x=0,S=16,w=0;for(let _=0,C=b.length;_<C;_++){let A=b[_],M={boundary:0,storage:0},P=Array.isArray(A.value)?A.value:[A.value];for(let T=0,R=P.length;T<R;T++){let z=P[T],F=v(z);M.boundary+=F.boundary,M.storage+=F.storage}if(A.__data=new Float32Array(M.storage/Float32Array.BYTES_PER_ELEMENT),A.__offset=x,_>0){w=x%S;let T=S-w;w!==0&&T-M.boundary<0&&(x+=S-w,A.__offset=x)}x+=M.storage}return w=x%S,w>0&&(x+=S-w),y.__size=x,y.__cache={},this}function v(y){let b={boundary:0,storage:0};return typeof y=="number"?(b.boundary=4,b.storage=4):y.isVector2?(b.boundary=8,b.storage=8):y.isVector3||y.isColor?(b.boundary=16,b.storage=12):y.isVector4?(b.boundary=16,b.storage=16):y.isMatrix3?(b.boundary=48,b.storage=48):y.isMatrix4?(b.boundary=64,b.storage=64):y.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",y),b}function m(y){let b=y.target;b.removeEventListener("dispose",m);let x=o.indexOf(b.__bindingPointIndex);o.splice(x,1),e.deleteBuffer(n[b.id]),delete n[b.id],delete a[b.id]}function g(){for(let y in n)e.deleteBuffer(n[y]);o=[],n={},a={}}return{bind:l,update:c,dispose:g}}function Bxe(){let e=ng("canvas");return e.style.display="block",e}function Cj(e={}){this.isWebGLRenderer=!0;let t=e.canvas!==void 0?e.canvas:Bxe(),r=e.context!==void 0?e.context:null,i=e.depth!==void 0?e.depth:!0,n=e.stencil!==void 0?e.stencil:!0,a=e.antialias!==void 0?e.antialias:!1,o=e.premultipliedAlpha!==void 0?e.premultipliedAlpha:!0,s=e.preserveDrawingBuffer!==void 0?e.preserveDrawingBuffer:!1,l=e.powerPreference!==void 0?e.powerPreference:"default",c=e.failIfMajorPerformanceCaveat!==void 0?e.failIfMajorPerformanceCaveat:!1,d;r!==null?d=r.getContextAttributes().alpha:d=e.alpha!==void 0?e.alpha:!1;let u=null,h=null,f=[],p=[];this.domElement=t,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=hs,this.physicallyCorrectLights=!1,this.toneMapping=Zs,this.toneMappingExposure=1;let v=this,m=!1,g=0,y=0,b=null,x=-1,S=null,w=new Kt,_=new Kt,C=null,A=t.width,M=t.height,P=1,T=null,R=null,z=new Kt(0,0,A,M),F=new Kt(0,0,A,M),H=!1,N=new rP,U=!1,ie=!1,te=null,X=new it,W=new ye,q=new k,$={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function le(){return b===null?P:1}let ee=r;function Q(K,Me){for(let He=0;He<K.length;He++){let Oe=K[He],Ne=t.getContext(Oe,Me);if(Ne!==null)return Ne}return null}try{let K={alpha:!0,depth:i,stencil:n,antialias:a,premultipliedAlpha:o,preserveDrawingBuffer:s,powerPreference:l,failIfMajorPerformanceCaveat:c};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${Up}`),t.addEventListener("webglcontextlost",dt,!1),t.addEventListener("webglcontextrestored",vt,!1),t.addEventListener("webglcontextcreationerror",se,!1),ee===null){let Me=["webgl2","webgl","experimental-webgl"];if(v.isWebGL1Renderer===!0&&Me.shift(),ee=Q(Me,K),ee===null)throw Q(Me)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}ee.getShaderPrecisionFormat===void 0&&(ee.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(K){throw console.error("THREE.WebGLRenderer: "+K.message),K}let ne,V,de,me,Ce,G,Z,ue,Se,we,_e,Ee,fe,B,D,I,O,j,L,Ae,We,je,ze,Je;function nt(){ne=new Kye(ee),V=new Wye(ee,ne,e),ne.init(V),je=new Oxe(ee,ne,V),de=new Pxe(ee,ne,V),me=new Jye,Ce=new vxe,G=new Dxe(ee,ne,de,Ce,V,je,me),Z=new $ye(v),ue=new Xye(v),Se=new lge(ee,V),ze=new Vye(ee,ne,Se,V),we=new Qye(ee,Se,me,ze),_e=new ibe(ee,we,Se,me),L=new rbe(ee,V,G),I=new Gye(Ce),Ee=new mxe(v,Z,ue,ne,V,ze,I),fe=new kxe(v,Ce),B=new yxe,D=new _xe(ne,V),j=new jye(v,Z,ue,de,_e,d,o),O=new Txe(v,_e,V),Je=new Lxe(ee,me,V,de),Ae=new Hye(ee,ne,me,V),We=new Zye(ee,ne,me,V),me.programs=Ee.programs,v.capabilities=V,v.extensions=ne,v.properties=Ce,v.renderLists=B,v.shadowMap=O,v.state=de,v.info=me}nt();let lt=new zxe(v,ee);this.xr=lt,this.getContext=function(){return ee},this.getContextAttributes=function(){return ee.getContextAttributes()},this.forceContextLoss=function(){let K=ne.get("WEBGL_lose_context");K&&K.loseContext()},this.forceContextRestore=function(){let K=ne.get("WEBGL_lose_context");K&&K.restoreContext()},this.getPixelRatio=function(){return P},this.setPixelRatio=function(K){K!==void 0&&(P=K,this.setSize(A,M,!1))},this.getSize=function(K){return K.set(A,M)},this.setSize=function(K,Me,He){if(lt.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}A=K,M=Me,t.width=Math.floor(K*P),t.height=Math.floor(Me*P),He!==!1&&(t.style.width=K+"px",t.style.height=Me+"px"),this.setViewport(0,0,K,Me)},this.getDrawingBufferSize=function(K){return K.set(A*P,M*P).floor()},this.setDrawingBufferSize=function(K,Me,He){A=K,M=Me,P=He,t.width=Math.floor(K*He),t.height=Math.floor(Me*He),this.setViewport(0,0,K,Me)},this.getCurrentViewport=function(K){return K.copy(w)},this.getViewport=function(K){return K.copy(z)},this.setViewport=function(K,Me,He,Oe){K.isVector4?z.set(K.x,K.y,K.z,K.w):z.set(K,Me,He,Oe),de.viewport(w.copy(z).multiplyScalar(P).floor())},this.getScissor=function(K){return K.copy(F)},this.setScissor=function(K,Me,He,Oe){K.isVector4?F.set(K.x,K.y,K.z,K.w):F.set(K,Me,He,Oe),de.scissor(_.copy(F).multiplyScalar(P).floor())},this.getScissorTest=function(){return H},this.setScissorTest=function(K){de.setScissorTest(H=K)},this.setOpaqueSort=function(K){T=K},this.setTransparentSort=function(K){R=K},this.getClearColor=function(K){return K.copy(j.getClearColor())},this.setClearColor=function(){j.setClearColor.apply(j,arguments)},this.getClearAlpha=function(){return j.getClearAlpha()},this.setClearAlpha=function(){j.setClearAlpha.apply(j,arguments)},this.clear=function(K=!0,Me=!0,He=!0){let Oe=0;K&&(Oe|=16384),Me&&(Oe|=256),He&&(Oe|=1024),ee.clear(Oe)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",dt,!1),t.removeEventListener("webglcontextrestored",vt,!1),t.removeEventListener("webglcontextcreationerror",se,!1),B.dispose(),D.dispose(),Ce.dispose(),Z.dispose(),ue.dispose(),_e.dispose(),ze.dispose(),Je.dispose(),Ee.dispose(),lt.dispose(),lt.removeEventListener("sessionstart",Re),lt.removeEventListener("sessionend",$e),te&&(te.dispose(),te=null),at.stop()};function dt(K){K.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),m=!0}function vt(){console.log("THREE.WebGLRenderer: Context Restored."),m=!1;let K=me.autoReset,Me=O.enabled,He=O.autoUpdate,Oe=O.needsUpdate,Ne=O.type;nt(),me.autoReset=K,O.enabled=Me,O.autoUpdate=He,O.needsUpdate=Oe,O.type=Ne}function se(K){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",K.statusMessage)}function Le(K){let Me=K.target;Me.removeEventListener("dispose",Le),Ye(Me)}function Ye(K){pe(K),Ce.remove(K)}function pe(K){let Me=Ce.get(K).programs;Me!==void 0&&(Me.forEach(function(He){Ee.releaseProgram(He)}),K.isShaderMaterial&&Ee.releaseShaderCache(K))}this.renderBufferDirect=function(K,Me,He,Oe,Ne,wt){Me===null&&(Me=$);let Rt=Ne.isMesh&&Ne.matrixWorld.determinant()<0,It=_i(K,Me,He,Oe,Ne);de.setMaterial(Oe,Rt);let Tt=He.index,hr=1;Oe.wireframe===!0&&(Tt=we.getWireframeAttribute(He),hr=2);let Zt=He.drawRange,Pe=He.attributes.position,Qe=Zt.start*hr,xt=(Zt.start+Zt.count)*hr;wt!==null&&(Qe=Math.max(Qe,wt.start*hr),xt=Math.min(xt,(wt.start+wt.count)*hr)),Tt!==null?(Qe=Math.max(Qe,0),xt=Math.min(xt,Tt.count)):Pe!=null&&(Qe=Math.max(Qe,0),xt=Math.min(xt,Pe.count));let Mr=xt-Qe;if(Mr<0||Mr===1/0)return;ze.setup(Ne,Oe,It,He,Tt);let ci,Nt=Ae;if(Tt!==null&&(ci=Se.get(Tt),Nt=We,Nt.setIndex(ci)),Ne.isMesh)Oe.wireframe===!0?(de.setLineWidth(Oe.wireframeLinewidth*le()),Nt.setMode(1)):Nt.setMode(4);else if(Ne.isLine){let nr=Oe.linewidth;nr===void 0&&(nr=1),de.setLineWidth(nr*le()),Ne.isLineSegments?Nt.setMode(1):Ne.isLineLoop?Nt.setMode(2):Nt.setMode(3)}else Ne.isPoints?Nt.setMode(0):Ne.isSprite&&Nt.setMode(4);if(Ne.isInstancedMesh)Nt.renderInstances(Qe,Mr,Ne.count);else if(He.isInstancedBufferGeometry){let nr=He._maxInstanceCount!==void 0?He._maxInstanceCount:1/0,_n=Math.min(He.instanceCount,nr);Nt.renderInstances(Qe,Mr,_n)}else Nt.render(Qe,Mr)},this.compile=function(K,Me){function He(Oe,Ne,wt){Oe.transparent===!0&&Oe.side===fa&&Oe.forceSinglePass===!1?(Oe.side=Ln,Oe.needsUpdate=!0,Ft(Oe,Ne,wt),Oe.side=us,Oe.needsUpdate=!0,Ft(Oe,Ne,wt),Oe.side=fa):Ft(Oe,Ne,wt)}h=D.get(K),h.init(),p.push(h),K.traverseVisible(function(Oe){Oe.isLight&&Oe.layers.test(Me.layers)&&(h.pushLight(Oe),Oe.castShadow&&h.pushShadow(Oe))}),h.setupLights(v.physicallyCorrectLights),K.traverse(function(Oe){let Ne=Oe.material;if(Ne)if(Array.isArray(Ne))for(let wt=0;wt<Ne.length;wt++){let Rt=Ne[wt];He(Rt,K,Oe)}else He(Ne,K,Oe)}),p.pop(),h=null};let Te=null;function ce(K){Te&&Te(K)}function Re(){at.stop()}function $e(){at.start()}let at=new gj;at.setAnimationLoop(ce),typeof self<"u"&&at.setContext(self),this.setAnimationLoop=function(K){Te=K,lt.setAnimationLoop(K),K===null?at.stop():at.start()},lt.addEventListener("sessionstart",Re),lt.addEventListener("sessionend",$e),this.render=function(K,Me){if(Me!==void 0&&Me.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(m===!0)return;K.matrixWorldAutoUpdate===!0&&K.updateMatrixWorld(),Me.parent===null&&Me.matrixWorldAutoUpdate===!0&&Me.updateMatrixWorld(),lt.enabled===!0&&lt.isPresenting===!0&&(lt.cameraAutoUpdate===!0&&lt.updateCamera(Me),Me=lt.getCamera()),K.isScene===!0&&K.onBeforeRender(v,K,Me,b),h=D.get(K,p.length),h.init(),p.push(h),X.multiplyMatrices(Me.projectionMatrix,Me.matrixWorldInverse),N.setFromProjectionMatrix(X),ie=this.localClippingEnabled,U=I.init(this.clippingPlanes,ie),u=B.get(K,f.length),u.init(),f.push(u),qt(K,Me,0,v.sortObjects),u.finish(),v.sortObjects===!0&&u.sort(T,R),U===!0&&I.beginShadows();let He=h.state.shadowsArray;if(O.render(He,K,Me),U===!0&&I.endShadows(),this.info.autoReset===!0&&this.info.reset(),j.render(u,K),h.setupLights(v.physicallyCorrectLights),Me.isArrayCamera){let Oe=Me.cameras;for(let Ne=0,wt=Oe.length;Ne<wt;Ne++){let Rt=Oe[Ne];ir(u,K,Rt,Rt.viewport)}}else ir(u,K,Me);b!==null&&(G.updateMultisampleRenderTarget(b),G.updateRenderTargetMipmap(b)),K.isScene===!0&&K.onAfterRender(v,K,Me),ze.resetDefaultState(),x=-1,S=null,p.pop(),p.length>0?h=p[p.length-1]:h=null,f.pop(),f.length>0?u=f[f.length-1]:u=null};function qt(K,Me,He,Oe){if(K.visible===!1)return;if(K.layers.test(Me.layers)){if(K.isGroup)He=K.renderOrder;else if(K.isLOD)K.autoUpdate===!0&&K.update(Me);else if(K.isLight)h.pushLight(K),K.castShadow&&h.pushShadow(K);else if(K.isSprite){if(!K.frustumCulled||N.intersectsSprite(K)){Oe&&q.setFromMatrixPosition(K.matrixWorld).applyMatrix4(X);let wt=_e.update(K),Rt=K.material;Rt.visible&&u.push(K,wt,Rt,He,q.z,null)}}else if((K.isMesh||K.isLine||K.isPoints)&&(K.isSkinnedMesh&&K.skeleton.frame!==me.render.frame&&(K.skeleton.update(),K.skeleton.frame=me.render.frame),!K.frustumCulled||N.intersectsObject(K))){Oe&&q.setFromMatrixPosition(K.matrixWorld).applyMatrix4(X);let wt=_e.update(K),Rt=K.material;if(Array.isArray(Rt)){let It=wt.groups;for(let Tt=0,hr=It.length;Tt<hr;Tt++){let Zt=It[Tt],Pe=Rt[Zt.materialIndex];Pe&&Pe.visible&&u.push(K,wt,Pe,He,q.z,Zt)}}else Rt.visible&&u.push(K,wt,Rt,He,q.z,null)}}let Ne=K.children;for(let wt=0,Rt=Ne.length;wt<Rt;wt++)qt(Ne[wt],Me,He,Oe)}function ir(K,Me,He,Oe){let Ne=K.opaque,wt=K.transmissive,Rt=K.transparent;h.setupLightsView(He),U===!0&&I.setGlobalState(v.clippingPlanes,He),wt.length>0&&Fe(Ne,Me,He),Oe&&de.viewport(w.copy(Oe)),Ne.length>0&&Ke(Ne,Me,He),wt.length>0&&Ke(wt,Me,He),Rt.length>0&&Ke(Rt,Me,He),de.buffers.depth.setTest(!0),de.buffers.depth.setMask(!0),de.buffers.color.setMask(!0),de.setPolygonOffset(!1)}function Fe(K,Me,He){let Oe=V.isWebGL2;te===null&&(te=new Ur(1,1,{generateMipmaps:!0,type:ne.has("EXT_color_buffer_half_float")?ec:ga,minFilter:mp,samples:Oe&&a===!0?4:0})),v.getDrawingBufferSize(W),Oe?te.setSize(W.x,W.y):te.setSize(hx(W.x),hx(W.y));let Ne=v.getRenderTarget();v.setRenderTarget(te),v.clear();let wt=v.toneMapping;v.toneMapping=Zs,Ke(K,Me,He),v.toneMapping=wt,G.updateMultisampleRenderTarget(te),G.updateRenderTargetMipmap(te),v.setRenderTarget(Ne)}function Ke(K,Me,He){let Oe=Me.isScene===!0?Me.overrideMaterial:null;for(let Ne=0,wt=K.length;Ne<wt;Ne++){let Rt=K[Ne],It=Rt.object,Tt=Rt.geometry,hr=Oe===null?Rt.material:Oe,Zt=Rt.group;It.layers.test(He.layers)&&ut(It,Me,He,Tt,hr,Zt)}}function ut(K,Me,He,Oe,Ne,wt){K.onBeforeRender(v,Me,He,Oe,Ne,wt),K.modelViewMatrix.multiplyMatrices(He.matrixWorldInverse,K.matrixWorld),K.normalMatrix.getNormalMatrix(K.modelViewMatrix),Ne.onBeforeRender(v,Me,He,Oe,K,wt),Ne.transparent===!0&&Ne.side===fa&&Ne.forceSinglePass===!1?(Ne.side=Ln,Ne.needsUpdate=!0,v.renderBufferDirect(He,Me,Oe,Ne,K,wt),Ne.side=us,Ne.needsUpdate=!0,v.renderBufferDirect(He,Me,Oe,Ne,K,wt),Ne.side=fa):v.renderBufferDirect(He,Me,Oe,Ne,K,wt),K.onAfterRender(v,Me,He,Oe,Ne,wt)}function Ft(K,Me,He){Me.isScene!==!0&&(Me=$);let Oe=Ce.get(K),Ne=h.state.lights,wt=h.state.shadowsArray,Rt=Ne.state.version,It=Ee.getParameters(K,Ne.state,wt,Me,He),Tt=Ee.getProgramCacheKey(It),hr=Oe.programs;Oe.environment=K.isMeshStandardMaterial?Me.environment:null,Oe.fog=Me.fog,Oe.envMap=(K.isMeshStandardMaterial?ue:Z).get(K.envMap||Oe.environment),hr===void 0&&(K.addEventListener("dispose",Le),hr=new Map,Oe.programs=hr);let Zt=hr.get(Tt);if(Zt!==void 0){if(Oe.currentProgram===Zt&&Oe.lightsStateVersion===Rt)return ui(K,It),Zt}else It.uniforms=Ee.getUniforms(K),K.onBuild(He,It,v),K.onBeforeCompile(It,v),Zt=Ee.acquireProgram(It,Tt),hr.set(Tt,Zt),Oe.uniforms=It.uniforms;let Pe=Oe.uniforms;(!K.isShaderMaterial&&!K.isRawShaderMaterial||K.clipping===!0)&&(Pe.clippingPlanes=I.uniform),ui(K,It),Oe.needsLights=De(K),Oe.lightsStateVersion=Rt,Oe.needsLights&&(Pe.ambientLightColor.value=Ne.state.ambient,Pe.lightProbe.value=Ne.state.probe,Pe.directionalLights.value=Ne.state.directional,Pe.directionalLightShadows.value=Ne.state.directionalShadow,Pe.spotLights.value=Ne.state.spot,Pe.spotLightShadows.value=Ne.state.spotShadow,Pe.rectAreaLights.value=Ne.state.rectArea,Pe.ltc_1.value=Ne.state.rectAreaLTC1,Pe.ltc_2.value=Ne.state.rectAreaLTC2,Pe.pointLights.value=Ne.state.point,Pe.pointLightShadows.value=Ne.state.pointShadow,Pe.hemisphereLights.value=Ne.state.hemi,Pe.directionalShadowMap.value=Ne.state.directionalShadowMap,Pe.directionalShadowMatrix.value=Ne.state.directionalShadowMatrix,Pe.spotShadowMap.value=Ne.state.spotShadowMap,Pe.spotLightMatrix.value=Ne.state.spotLightMatrix,Pe.spotLightMap.value=Ne.state.spotLightMap,Pe.pointShadowMap.value=Ne.state.pointShadowMap,Pe.pointShadowMatrix.value=Ne.state.pointShadowMatrix);let Qe=Zt.getUniforms(),xt=pb.seqWithValue(Qe.seq,Pe);return Oe.currentProgram=Zt,Oe.uniformsList=xt,Zt}function ui(K,Me){let He=Ce.get(K);He.outputEncoding=Me.outputEncoding,He.instancing=Me.instancing,He.skinning=Me.skinning,He.morphTargets=Me.morphTargets,He.morphNormals=Me.morphNormals,He.morphColors=Me.morphColors,He.morphTargetsCount=Me.morphTargetsCount,He.numClippingPlanes=Me.numClippingPlanes,He.numIntersection=Me.numClipIntersection,He.vertexAlphas=Me.vertexAlphas,He.vertexTangents=Me.vertexTangents,He.toneMapping=Me.toneMapping}function _i(K,Me,He,Oe,Ne){Me.isScene!==!0&&(Me=$),G.resetTextureUnits();let wt=Me.fog,Rt=Oe.isMeshStandardMaterial?Me.environment:null,It=b===null?v.outputEncoding:b.isXRRenderTarget===!0?b.texture.encoding:hs,Tt=(Oe.isMeshStandardMaterial?ue:Z).get(Oe.envMap||Rt),hr=Oe.vertexColors===!0&&!!He.attributes.color&&He.attributes.color.itemSize===4,Zt=!!Oe.normalMap&&!!He.attributes.tangent,Pe=!!He.morphAttributes.position,Qe=!!He.morphAttributes.normal,xt=!!He.morphAttributes.color,Mr=Oe.toneMapped?v.toneMapping:Zs,ci=He.morphAttributes.position||He.morphAttributes.normal||He.morphAttributes.color,Nt=ci!==void 0?ci.length:0,nr=Ce.get(Oe),_n=h.state.lights;if(U===!0&&(ie===!0||K!==S)){let ae=K===S&&Oe.id===x;I.setState(Oe,K,ae)}let Jt=!1;Oe.version===nr.__version?(nr.needsLights&&nr.lightsStateVersion!==_n.state.version||nr.outputEncoding!==It||Ne.isInstancedMesh&&nr.instancing===!1||!Ne.isInstancedMesh&&nr.instancing===!0||Ne.isSkinnedMesh&&nr.skinning===!1||!Ne.isSkinnedMesh&&nr.skinning===!0||nr.envMap!==Tt||Oe.fog===!0&&nr.fog!==wt||nr.numClippingPlanes!==void 0&&(nr.numClippingPlanes!==I.numPlanes||nr.numIntersection!==I.numIntersection)||nr.vertexAlphas!==hr||nr.vertexTangents!==Zt||nr.morphTargets!==Pe||nr.morphNormals!==Qe||nr.morphColors!==xt||nr.toneMapping!==Mr||V.isWebGL2===!0&&nr.morphTargetsCount!==Nt)&&(Jt=!0):(Jt=!0,nr.__version=Oe.version);let ro=nr.currentProgram;Jt===!0&&(ro=Ft(Oe,Me,Ne));let Uo=!1,uo=!1,ka=!1,Y=ro.getUniforms(),J=nr.uniforms;if(de.useProgram(ro.program)&&(Uo=!0,uo=!0,ka=!0),Oe.id!==x&&(x=Oe.id,uo=!0),Uo||S!==K){if(Y.setValue(ee,"projectionMatrix",K.projectionMatrix),V.logarithmicDepthBuffer&&Y.setValue(ee,"logDepthBufFC",2/(Math.log(K.far+1)/Math.LN2)),S!==K&&(S=K,uo=!0,ka=!0),Oe.isShaderMaterial||Oe.isMeshPhongMaterial||Oe.isMeshToonMaterial||Oe.isMeshStandardMaterial||Oe.envMap){let ae=Y.map.cameraPosition;ae!==void 0&&ae.setValue(ee,q.setFromMatrixPosition(K.matrixWorld))}(Oe.isMeshPhongMaterial||Oe.isMeshToonMaterial||Oe.isMeshLambertMaterial||Oe.isMeshBasicMaterial||Oe.isMeshStandardMaterial||Oe.isShaderMaterial)&&Y.setValue(ee,"isOrthographic",K.isOrthographicCamera===!0),(Oe.isMeshPhongMaterial||Oe.isMeshToonMaterial||Oe.isMeshLambertMaterial||Oe.isMeshBasicMaterial||Oe.isMeshStandardMaterial||Oe.isShaderMaterial||Oe.isShadowMaterial||Ne.isSkinnedMesh)&&Y.setValue(ee,"viewMatrix",K.matrixWorldInverse)}if(Ne.isSkinnedMesh){Y.setOptional(ee,Ne,"bindMatrix"),Y.setOptional(ee,Ne,"bindMatrixInverse");let ae=Ne.skeleton;ae&&(V.floatVertexTextures?(ae.boneTexture===null&&ae.computeBoneTexture(),Y.setValue(ee,"boneTexture",ae.boneTexture,G),Y.setValue(ee,"boneTextureSize",ae.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}let be=He.morphAttributes;if((be.position!==void 0||be.normal!==void 0||be.color!==void 0&&V.isWebGL2===!0)&&L.update(Ne,He,Oe,ro),(uo||nr.receiveShadow!==Ne.receiveShadow)&&(nr.receiveShadow=Ne.receiveShadow,Y.setValue(ee,"receiveShadow",Ne.receiveShadow)),Oe.isMeshGouraudMaterial&&Oe.envMap!==null&&(J.envMap.value=Tt,J.flipEnvMap.value=Tt.isCubeTexture&&Tt.isRenderTargetTexture===!1?-1:1),uo&&(Y.setValue(ee,"toneMappingExposure",v.toneMappingExposure),nr.needsLights&&Ar(J,ka),wt&&Oe.fog===!0&&fe.refreshFogUniforms(J,wt),fe.refreshMaterialUniforms(J,Oe,P,M,te),pb.upload(ee,nr.uniformsList,J,G)),Oe.isShaderMaterial&&Oe.uniformsNeedUpdate===!0&&(pb.upload(ee,nr.uniformsList,J,G),Oe.uniformsNeedUpdate=!1),Oe.isSpriteMaterial&&Y.setValue(ee,"center",Ne.center),Y.setValue(ee,"modelViewMatrix",Ne.modelViewMatrix),Y.setValue(ee,"normalMatrix",Ne.normalMatrix),Y.setValue(ee,"modelMatrix",Ne.matrixWorld),Ne.previousModelViewMatrix&&Y.setValue(ee,"previousModelViewMatrix",Ne.previousModelViewMatrix),K.previousProjectionMatrix&&Y.setValue(ee,"previousProjectionMatrix",K.previousProjectionMatrix),Oe.isShaderMaterial||Oe.isRawShaderMaterial){let ae=Oe.uniformsGroups;for(let Ie=0,ot=ae.length;Ie<ot;Ie++)if(V.isWebGL2){let jo=ae[Ie];Je.update(jo,ro),Je.bind(jo,ro)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return ro}function Ar(K,Me){K.ambientLightColor.needsUpdate=Me,K.lightProbe.needsUpdate=Me,K.directionalLights.needsUpdate=Me,K.directionalLightShadows.needsUpdate=Me,K.pointLights.needsUpdate=Me,K.pointLightShadows.needsUpdate=Me,K.spotLights.needsUpdate=Me,K.spotLightShadows.needsUpdate=Me,K.rectAreaLights.needsUpdate=Me,K.hemisphereLights.needsUpdate=Me}function De(K){return K.isMeshLambertMaterial||K.isMeshToonMaterial||K.isMeshPhongMaterial||K.isMeshStandardMaterial||K.isShadowMaterial||K.isShaderMaterial&&K.lights===!0}this.getActiveCubeFace=function(){return g},this.getActiveMipmapLevel=function(){return y},this.getRenderTarget=function(){return b},this.setRenderTargetTextures=function(K,Me,He){Ce.get(K.texture).__webglTexture=Me,Ce.get(K.depthTexture).__webglTexture=He;let Oe=Ce.get(K);Oe.__hasExternalTextures=!0,Oe.__hasExternalTextures&&(Oe.__autoAllocateDepthBuffer=He===void 0,Oe.__autoAllocateDepthBuffer||ne.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),Oe.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(K,Me){let He=Ce.get(K);He.__webglFramebuffer=Me,He.__useDefaultFramebuffer=Me===void 0},this.setRenderTarget=function(K,Me=0,He=0){b=K,g=Me,y=He;let Oe=!0,Ne=null,wt=!1,Rt=!1;if(K){let It=Ce.get(K);It.__useDefaultFramebuffer!==void 0?(de.bindFramebuffer(36160,null),Oe=!1):It.__webglFramebuffer===void 0?G.setupRenderTarget(K):It.__hasExternalTextures&&G.rebindTextures(K,Ce.get(K.texture).__webglTexture,Ce.get(K.depthTexture).__webglTexture);let Tt=K.texture;(Tt.isData3DTexture||Tt.isDataArrayTexture||Tt.isCompressedArrayTexture)&&(Rt=!0);let hr=Ce.get(K).__webglFramebuffer;K.isWebGLCubeRenderTarget?(Ne=hr[Me],wt=!0):V.isWebGL2&&K.samples>0&&G.useMultisampledRTT(K)===!1?Ne=Ce.get(K).__webglMultisampledFramebuffer:Ne=hr,w.copy(K.viewport),_.copy(K.scissor),C=K.scissorTest}else w.copy(z).multiplyScalar(P).floor(),_.copy(F).multiplyScalar(P).floor(),C=H;if(de.bindFramebuffer(36160,Ne)&&V.drawBuffers&&Oe&&de.drawBuffers(K,Ne),de.viewport(w),de.scissor(_),de.setScissorTest(C),wt){let It=Ce.get(K.texture);ee.framebufferTexture2D(36160,36064,34069+Me,It.__webglTexture,He)}else if(Rt){let It=Ce.get(K.texture),Tt=Me||0;ee.framebufferTextureLayer(36160,36064,It.__webglTexture,He||0,Tt)}x=-1},this.readRenderTargetPixels=function(K,Me,He,Oe,Ne,wt,Rt){if(!(K&&K.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let It=Ce.get(K).__webglFramebuffer;if(K.isWebGLCubeRenderTarget&&Rt!==void 0&&(It=It[Rt]),It){de.bindFramebuffer(36160,It);try{let Tt=K.texture,hr=Tt.format,Zt=Tt.type;if(hr!==In&&je.convert(hr)!==ee.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}let Pe=Zt===ec&&(ne.has("EXT_color_buffer_half_float")||V.isWebGL2&&ne.has("EXT_color_buffer_float"));if(Zt!==ga&&je.convert(Zt)!==ee.getParameter(35738)&&!(Zt===on&&(V.isWebGL2||ne.has("OES_texture_float")||ne.has("WEBGL_color_buffer_float")))&&!Pe){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}Me>=0&&Me<=K.width-Oe&&He>=0&&He<=K.height-Ne&&ee.readPixels(Me,He,Oe,Ne,je.convert(hr),je.convert(Zt),wt)}finally{let Tt=b!==null?Ce.get(b).__webglFramebuffer:null;de.bindFramebuffer(36160,Tt)}}},this.copyFramebufferToTexture=function(K,Me,He=0){let Oe=Math.pow(2,-He),Ne=Math.floor(Me.image.width*Oe),wt=Math.floor(Me.image.height*Oe);G.setTexture2D(Me,0),ee.copyTexSubImage2D(3553,He,0,0,K.x,K.y,Ne,wt),de.unbindTexture()},this.copyTextureToTexture=function(K,Me,He,Oe=0){let Ne=Me.image.width,wt=Me.image.height,Rt=je.convert(He.format),It=je.convert(He.type);G.setTexture2D(He,0),ee.pixelStorei(37440,He.flipY),ee.pixelStorei(37441,He.premultiplyAlpha),ee.pixelStorei(3317,He.unpackAlignment),Me.isDataTexture?ee.texSubImage2D(3553,Oe,K.x,K.y,Ne,wt,Rt,It,Me.image.data):Me.isCompressedTexture?ee.compressedTexSubImage2D(3553,Oe,K.x,K.y,Me.mipmaps[0].width,Me.mipmaps[0].height,Rt,Me.mipmaps[0].data):ee.texSubImage2D(3553,Oe,K.x,K.y,Rt,It,Me.image),Oe===0&&He.generateMipmaps&&ee.generateMipmap(3553),de.unbindTexture()},this.copyTextureToTexture3D=function(K,Me,He,Oe,Ne=0){if(v.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}let wt=K.max.x-K.min.x+1,Rt=K.max.y-K.min.y+1,It=K.max.z-K.min.z+1,Tt=je.convert(Oe.format),hr=je.convert(Oe.type),Zt;if(Oe.isData3DTexture)G.setTexture3D(Oe,0),Zt=32879;else if(Oe.isDataArrayTexture)G.setTexture2DArray(Oe,0),Zt=35866;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}ee.pixelStorei(37440,Oe.flipY),ee.pixelStorei(37441,Oe.premultiplyAlpha),ee.pixelStorei(3317,Oe.unpackAlignment);let Pe=ee.getParameter(3314),Qe=ee.getParameter(32878),xt=ee.getParameter(3316),Mr=ee.getParameter(3315),ci=ee.getParameter(32877),Nt=He.isCompressedTexture?He.mipmaps[0]:He.image;ee.pixelStorei(3314,Nt.width),ee.pixelStorei(32878,Nt.height),ee.pixelStorei(3316,K.min.x),ee.pixelStorei(3315,K.min.y),ee.pixelStorei(32877,K.min.z),He.isDataTexture||He.isData3DTexture?ee.texSubImage3D(Zt,Ne,Me.x,Me.y,Me.z,wt,Rt,It,Tt,hr,Nt.data):He.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),ee.compressedTexSubImage3D(Zt,Ne,Me.x,Me.y,Me.z,wt,Rt,It,Tt,Nt.data)):ee.texSubImage3D(Zt,Ne,Me.x,Me.y,Me.z,wt,Rt,It,Tt,hr,Nt),ee.pixelStorei(3314,Pe),ee.pixelStorei(32878,Qe),ee.pixelStorei(3316,xt),ee.pixelStorei(3315,Mr),ee.pixelStorei(32877,ci),Ne===0&&Oe.generateMipmaps&&ee.generateMipmap(Zt),de.unbindTexture()},this.initTexture=function(K){K.isCubeTexture?G.setTextureCube(K,0):K.isData3DTexture?G.setTexture3D(K,0):K.isDataArrayTexture||K.isCompressedArrayTexture?G.setTexture2DArray(K,0):G.setTexture2D(K,0),de.unbindTexture()},this.resetState=function(){g=0,y=0,b=null,de.reset(),ze.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}var Fxe=class extends Cj{};Fxe.prototype.isWebGL1Renderer=!0;var _j=class{constructor(e,t=1,r=1e3){this.isFog=!0,this.name="",this.color=new Lt(e),this.near=t,this.far=r}clone(){return new _j(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}},Js=class extends Yr{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){let t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t}get autoUpdate(){return console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate}set autoUpdate(e){console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate=e}},Nxe=class{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=PA,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Io()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,r){e*=this.stride,r*=t.stride;for(let i=0,n=this.stride;i<n;i++)this.array[e+i]=t.array[r+i];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Io()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);let t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),r=new this.constructor(t,this.stride);return r.setUsage(this.usage),r}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Io()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}},ba=new k,IA=class{constructor(e,t,r,i=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=r,this.normalized=i}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,r=this.data.count;t<r;t++)ba.fromBufferAttribute(this,t),ba.applyMatrix4(e),this.setXYZ(t,ba.x,ba.y,ba.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)ba.fromBufferAttribute(this,t),ba.applyNormalMatrix(e),this.setXYZ(t,ba.x,ba.y,ba.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)ba.fromBufferAttribute(this,t),ba.transformDirection(e),this.setXYZ(t,ba.x,ba.y,ba.z);return this}setX(e,t){return this.normalized&&(t=di(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=di(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=di(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=di(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Gl(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Gl(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Gl(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Gl(t,this.array)),t}setXY(e,t,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=di(t,this.array),r=di(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this}setXYZ(e,t,r,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=di(t,this.array),r=di(r,this.array),i=di(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=i,this}setXYZW(e,t,r,i,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=di(t,this.array),r=di(r,this.array),i=di(i,this.array),n=di(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=i,this.data.array[e+3]=n,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");let t=[];for(let r=0;r<this.count;r++){let i=r*this.data.stride+this.offset;for(let n=0;n<this.itemSize;n++)t.push(this.data.array[i+n])}return new $t(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new IA(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");let t=[];for(let r=0;r<this.count;r++){let i=r*this.data.stride+this.offset;for(let n=0;n<this.itemSize;n++)t.push(this.data.array[i+n])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}},Aj=class extends Yr{constructor(){super(),this.isBone=!0,this.type="Bone"}},Po=class extends Oi{constructor(e=null,t=1,r=1,i,n,a,o,s,l=Hr,c=Hr,d,u){super(null,a,o,s,l,c,i,n,d,u),this.isDataTexture=!0,this.image={data:e,width:t,height:r},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},sz=new it,Uxe=new it,nP=class{constructor(e=[],t=[]){this.uuid=Io(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){let e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let r=0,i=this.bones.length;r<i;r++)this.boneInverses.push(new it)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){let r=new it;this.bones[e]&&r.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(r)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){let r=this.bones[e];r&&r.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){let r=this.bones[e];r&&(r.parent&&r.parent.isBone?(r.matrix.copy(r.parent.matrixWorld).invert(),r.matrix.multiply(r.matrixWorld)):r.matrix.copy(r.matrixWorld),r.matrix.decompose(r.position,r.quaternion,r.scale))}}update(){let e=this.bones,t=this.boneInverses,r=this.boneMatrices,i=this.boneTexture;for(let n=0,a=e.length;n<a;n++){let o=e[n]?e[n].matrixWorld:Uxe;sz.multiplyMatrices(o,t[n]),sz.toArray(r,n*16)}i!==null&&(i.needsUpdate=!0)}clone(){return new nP(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=cj(e),e=Math.max(e,4);let t=new Float32Array(e*e*4);t.set(this.boneMatrices);let r=new Po(t,e,e,In,on);return r.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=r,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,r=this.bones.length;t<r;t++){let i=this.bones[t];if(i.name===e)return i}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let r=0,i=e.bones.length;r<i;r++){let n=e.bones[r],a=t[n];a===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",n),a=new Aj),this.bones.push(a),this.boneInverses.push(new it().fromArray(e.boneInverses[r]))}return this.init(),this}toJSON(){let e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;let t=this.bones,r=this.boneInverses;for(let i=0,n=t.length;i<n;i++){let a=t[i];e.bones.push(a.uuid);let o=r[i];e.boneInverses.push(o.toArray())}return e}},ag=class extends $t{constructor(e,t,r,i=1){super(e,t,r),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){let e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}},lz=new it,cz=new it,J0=[],jxe=new it,_m=new Di,Vxe=class extends Di{constructor(e,t,r){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new ag(new Float32Array(r*16),16),this.instanceColor=null,this.count=r,this.frustumCulled=!1;for(let i=0;i<r;i++)this.setMatrixAt(i,jxe)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}raycast(e,t){let r=this.matrixWorld,i=this.count;if(_m.geometry=this.geometry,_m.material=this.material,_m.material!==void 0)for(let n=0;n<i;n++){this.getMatrixAt(n,lz),cz.multiplyMatrices(r,lz),_m.matrixWorld=cz,_m.raycast(e,J0);for(let a=0,o=J0.length;a<o;a++){let s=J0[a];s.instanceId=n,s.object=this,t.push(s)}J0.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new ag(new Float32Array(this.instanceMatrix.count*3),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}},Ud=class extends Wg{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Lt(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}},dz=new k,uz=new k,hz=new it,aC=new jp,ey=new Za,fx=class extends Yr{constructor(e=new Ot,t=new Ud){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){let e=this.geometry;if(e.index===null){let t=e.attributes.position,r=[0];for(let i=1,n=t.count;i<n;i++)dz.fromBufferAttribute(t,i-1),uz.fromBufferAttribute(t,i),r[i]=r[i-1],r[i]+=dz.distanceTo(uz);e.setAttribute("lineDistance",new yt(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){let r=this.geometry,i=this.matrixWorld,n=e.params.Line.threshold,a=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),ey.copy(r.boundingSphere),ey.applyMatrix4(i),ey.radius+=n,e.ray.intersectsSphere(ey)===!1)return;hz.copy(i).invert(),aC.copy(e.ray).applyMatrix4(hz);let o=n/((this.scale.x+this.scale.y+this.scale.z)/3),s=o*o,l=new k,c=new k,d=new k,u=new k,h=this.isLineSegments?2:1,f=r.index,p=r.attributes.position;if(f!==null){let v=Math.max(0,a.start),m=Math.min(f.count,a.start+a.count);for(let g=v,y=m-1;g<y;g+=h){let b=f.getX(g),x=f.getX(g+1);if(l.fromBufferAttribute(p,b),c.fromBufferAttribute(p,x),aC.distanceSqToSegment(l,c,u,d)>s)continue;u.applyMatrix4(this.matrixWorld);let S=e.ray.origin.distanceTo(u);S<e.near||S>e.far||t.push({distance:S,point:d.clone().applyMatrix4(this.matrixWorld),index:g,face:null,faceIndex:null,object:this})}}else{let v=Math.max(0,a.start),m=Math.min(p.count,a.start+a.count);for(let g=v,y=m-1;g<y;g+=h){if(l.fromBufferAttribute(p,g),c.fromBufferAttribute(p,g+1),aC.distanceSqToSegment(l,c,u,d)>s)continue;u.applyMatrix4(this.matrixWorld);let b=e.ray.origin.distanceTo(u);b<e.near||b>e.far||t.push({distance:b,point:d.clone().applyMatrix4(this.matrixWorld),index:g,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){let e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){let r=e[t[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let i=0,n=r.length;i<n;i++){let a=r[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=i}}}}},fz=new k,pz=new k,Gg=class extends fx{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){let e=this.geometry;if(e.index===null){let t=e.attributes.position,r=[];for(let i=0,n=t.count;i<n;i+=2)fz.fromBufferAttribute(t,i),pz.fromBufferAttribute(t,i+1),r[i]=i===0?0:r[i-1],r[i+1]=r[i]+fz.distanceTo(pz);e.setAttribute("lineDistance",new yt(r,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}},Hxe=class extends Oi{constructor(e,t,r,i,n,a,o,s,l){super(e,t,r,i,n,a,o,s,l),this.isVideoTexture=!0,this.minFilter=a!==void 0?a:ur,this.magFilter=n!==void 0?n:ur,this.generateMipmaps=!1;let c=this;function d(){c.needsUpdate=!0,e.requestVideoFrameCallback(d)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(d)}clone(){return new this.constructor(this.image).copy(this)}update(){let e=this.image;!("requestVideoFrameCallback"in e)&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}},Wxe=class extends Oi{constructor(e,t,r,i,n,a,o,s,l){super(e,t,r,i,n,a,o,s,l),this.isCanvasTexture=!0,this.needsUpdate=!0}},hl=class{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){let r=this.getUtoTmapping(e);return this.getPoint(r,t)}getPoints(e=5){let t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return t}getSpacedPoints(e=5){let t=[];for(let r=0;r<=e;r++)t.push(this.getPointAt(r/e));return t}getLength(){let e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;let t=[],r,i=this.getPoint(0),n=0;t.push(0);for(let a=1;a<=e;a++)r=this.getPoint(a/e),n+=r.distanceTo(i),t.push(n),i=r;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){let r=this.getLengths(),i=0,n=r.length,a;t?a=t:a=e*r[n-1];let o=0,s=n-1,l;for(;o<=s;)if(i=Math.floor(o+(s-o)/2),l=r[i]-a,l<0)o=i+1;else if(l>0)s=i-1;else{s=i;break}if(i=s,r[i]===a)return i/(n-1);let c=r[i],d=r[i+1]-c,u=(a-c)/d;return(i+u)/(n-1)}getTangent(e,t){let r=e-1e-4,i=e+1e-4;r<0&&(r=0),i>1&&(i=1);let n=this.getPoint(r),a=this.getPoint(i),o=t||(n.isVector2?new ye:new k);return o.copy(a).sub(n).normalize(),o}getTangentAt(e,t){let r=this.getUtoTmapping(e);return this.getTangent(r,t)}computeFrenetFrames(e,t){let r=new k,i=[],n=[],a=[],o=new k,s=new it;for(let h=0;h<=e;h++){let f=h/e;i[h]=this.getTangentAt(f,new k)}n[0]=new k,a[0]=new k;let l=Number.MAX_VALUE,c=Math.abs(i[0].x),d=Math.abs(i[0].y),u=Math.abs(i[0].z);c<=l&&(l=c,r.set(1,0,0)),d<=l&&(l=d,r.set(0,1,0)),u<=l&&r.set(0,0,1),o.crossVectors(i[0],r).normalize(),n[0].crossVectors(i[0],o),a[0].crossVectors(i[0],n[0]);for(let h=1;h<=e;h++){if(n[h]=n[h-1].clone(),a[h]=a[h-1].clone(),o.crossVectors(i[h-1],i[h]),o.length()>Number.EPSILON){o.normalize();let f=Math.acos(nn(i[h-1].dot(i[h]),-1,1));n[h].applyMatrix4(s.makeRotationAxis(o,f))}a[h].crossVectors(i[h],n[h])}if(t===!0){let h=Math.acos(nn(n[0].dot(n[e]),-1,1));h/=e,i[0].dot(o.crossVectors(n[0],n[e]))>0&&(h=-h);for(let f=1;f<=e;f++)n[f].applyMatrix4(s.makeRotationAxis(i[f],h*f)),a[f].crossVectors(i[f],n[f])}return{tangents:i,normals:n,binormals:a}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){let e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}},Z1=class extends hl{constructor(e=0,t=0,r=1,i=1,n=0,a=Math.PI*2,o=!1,s=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=r,this.yRadius=i,this.aStartAngle=n,this.aEndAngle=a,this.aClockwise=o,this.aRotation=s}getPoint(e,t){let r=t||new ye,i=Math.PI*2,n=this.aEndAngle-this.aStartAngle,a=Math.abs(n)<Number.EPSILON;for(;n<0;)n+=i;for(;n>i;)n-=i;n<Number.EPSILON&&(a?n=0:n=i),this.aClockwise===!0&&!a&&(n===i?n=-i:n=n-i);let o=this.aStartAngle+e*n,s=this.aX+this.xRadius*Math.cos(o),l=this.aY+this.yRadius*Math.sin(o);if(this.aRotation!==0){let c=Math.cos(this.aRotation),d=Math.sin(this.aRotation),u=s-this.aX,h=l-this.aY;s=u*c-h*d+this.aX,l=u*d+h*c+this.aY}return r.set(s,l)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){let e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}},Gxe=class extends Z1{constructor(e,t,r,i,n,a){super(e,t,r,r,i,n,a),this.isArcCurve=!0,this.type="ArcCurve"}};function aP(){let e=0,t=0,r=0,i=0;function n(a,o,s,l){e=a,t=s,r=-3*a+3*o-2*s-l,i=2*a-2*o+s+l}return{initCatmullRom:function(a,o,s,l,c){n(o,s,c*(s-a),c*(l-o))},initNonuniformCatmullRom:function(a,o,s,l,c,d,u){let h=(o-a)/c-(s-a)/(c+d)+(s-o)/d,f=(s-o)/d-(l-o)/(d+u)+(l-s)/u;h*=d,f*=d,n(o,s,h,f)},calc:function(a){let o=a*a,s=o*a;return e+t*a+r*o+i*s}}}var ty=new k,oC=new aP,sC=new aP,lC=new aP,$xe=class extends hl{constructor(e=[],t=!1,r="centripetal",i=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=r,this.tension=i}getPoint(e,t=new k){let r=t,i=this.points,n=i.length,a=(n-(this.closed?0:1))*e,o=Math.floor(a),s=a-o;this.closed?o+=o>0?0:(Math.floor(Math.abs(o)/n)+1)*n:s===0&&o===n-1&&(o=n-2,s=1);let l,c;this.closed||o>0?l=i[(o-1)%n]:(ty.subVectors(i[0],i[1]).add(i[0]),l=ty);let d=i[o%n],u=i[(o+1)%n];if(this.closed||o+2<n?c=i[(o+2)%n]:(ty.subVectors(i[n-1],i[n-2]).add(i[n-1]),c=ty),this.curveType==="centripetal"||this.curveType==="chordal"){let h=this.curveType==="chordal"?.5:.25,f=Math.pow(l.distanceToSquared(d),h),p=Math.pow(d.distanceToSquared(u),h),v=Math.pow(u.distanceToSquared(c),h);p<1e-4&&(p=1),f<1e-4&&(f=p),v<1e-4&&(v=p),oC.initNonuniformCatmullRom(l.x,d.x,u.x,c.x,f,p,v),sC.initNonuniformCatmullRom(l.y,d.y,u.y,c.y,f,p,v),lC.initNonuniformCatmullRom(l.z,d.z,u.z,c.z,f,p,v)}else this.curveType==="catmullrom"&&(oC.initCatmullRom(l.x,d.x,u.x,c.x,this.tension),sC.initCatmullRom(l.y,d.y,u.y,c.y,this.tension),lC.initCatmullRom(l.z,d.z,u.z,c.z,this.tension));return r.set(oC.calc(s),sC.calc(s),lC.calc(s)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let i=e.points[t];this.points.push(i.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){let i=this.points[t];e.points.push(i.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let i=e.points[t];this.points.push(new k().fromArray(i))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}};function mz(e,t,r,i,n){let a=(i-t)*.5,o=(n-r)*.5,s=e*e,l=e*s;return(2*r-2*i+a+o)*l+(-3*r+3*i-2*a-o)*s+a*e+r}function qxe(e,t){let r=1-e;return r*r*t}function Yxe(e,t){return 2*(1-e)*e*t}function Xxe(e,t){return e*e*t}function Av(e,t,r,i){return qxe(e,t)+Yxe(e,r)+Xxe(e,i)}function Kxe(e,t){let r=1-e;return r*r*r*t}function Qxe(e,t){let r=1-e;return 3*r*r*e*t}function Zxe(e,t){return 3*(1-e)*e*e*t}function Jxe(e,t){return e*e*e*t}function Mv(e,t,r,i,n){return Kxe(e,t)+Qxe(e,r)+Zxe(e,i)+Jxe(e,n)}var rs=class extends hl{constructor(e=new ye,t=new ye,r=new ye,i=new ye){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=r,this.v3=i}getPoint(e,t=new ye){let r=t,i=this.v0,n=this.v1,a=this.v2,o=this.v3;return r.set(Mv(e,i.x,n.x,a.x,o.x),Mv(e,i.y,n.y,a.y,o.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}},mb=class extends hl{constructor(e=new k,t=new k,r=new k,i=new k){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=r,this.v3=i}getPoint(e,t=new k){let r=t,i=this.v0,n=this.v1,a=this.v2,o=this.v3;return r.set(Mv(e,i.x,n.x,a.x,o.x),Mv(e,i.y,n.y,a.y,o.y),Mv(e,i.z,n.z,a.z,o.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}},ls=class extends hl{constructor(e=new ye,t=new ye){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new ye){let r=t;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t){let r=t||new ye;return r.copy(this.v2).sub(this.v1).normalize(),r}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},Mj=class extends hl{constructor(e=new k,t=new k){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new k){let r=t;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},Cd=class extends hl{constructor(e=new ye,t=new ye,r=new ye){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new ye){let r=t,i=this.v0,n=this.v1,a=this.v2;return r.set(Av(e,i.x,n.x,a.x),Av(e,i.y,n.y,a.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},e1e=class extends hl{constructor(e=new k,t=new k,r=new k){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new k){let r=t,i=this.v0,n=this.v1,a=this.v2;return r.set(Av(e,i.x,n.x,a.x),Av(e,i.y,n.y,a.y),Av(e,i.z,n.z,a.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},oP=class extends hl{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new ye){let r=t,i=this.points,n=(i.length-1)*e,a=Math.floor(n),o=n-a,s=i[a===0?a:a-1],l=i[a],c=i[a>i.length-2?i.length-1:a+1],d=i[a>i.length-3?i.length-1:a+2];return r.set(mz(o,s.x,l.x,c.x,d.x),mz(o,s.y,l.y,c.y,d.y)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let i=e.points[t];this.points.push(i.clone())}return this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){let i=this.points[t];e.points.push(i.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let i=e.points[t];this.points.push(new ye().fromArray(i))}return this}},t1e=Object.freeze({__proto__:null,ArcCurve:Gxe,CatmullRomCurve3:$xe,CubicBezierCurve:rs,CubicBezierCurve3:mb,EllipseCurve:Z1,LineCurve:ls,LineCurve3:Mj,QuadraticBezierCurve:Cd,QuadraticBezierCurve3:e1e,SplineCurve:oP}),Ej=class extends hl{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){let e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new ls(t,e))}getPoint(e,t){let r=e*this.getLength(),i=this.getCurveLengths(),n=0;for(;n<i.length;){if(i[n]>=r){let a=i[n]-r,o=this.curves[n],s=o.getLength(),l=s===0?0:1-a/s;return o.getPointAt(l,t)}n++}return null}getLength(){let e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;let e=[],t=0;for(let r=0,i=this.curves.length;r<i;r++)t+=this.curves[r].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){let t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){let t=[],r;for(let i=0,n=this.curves;i<n.length;i++){let a=n[i],o=a.isEllipseCurve?e*2:a.isLineCurve||a.isLineCurve3?1:a.isSplineCurve?e*a.points.length:e,s=a.getPoints(o);for(let l=0;l<s.length;l++){let c=s[l];r&&r.equals(c)||(t.push(c),r=c)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){let i=e.curves[t];this.curves.push(i.clone())}return this.autoClose=e.autoClose,this}toJSON(){let e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,r=this.curves.length;t<r;t++){let i=this.curves[t];e.curves.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){let i=e.curves[t];this.curves.push(new t1e[i.type]().fromJSON(i))}return this}},px=class extends Ej{constructor(e){super(),this.type="Path",this.currentPoint=new ye,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,r=e.length;t<r;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){let r=new ls(this.currentPoint.clone(),new ye(e,t));return this.curves.push(r),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,r,i){let n=new Cd(this.currentPoint.clone(),new ye(e,t),new ye(r,i));return this.curves.push(n),this.currentPoint.set(r,i),this}bezierCurveTo(e,t,r,i,n,a){let o=new rs(this.currentPoint.clone(),new ye(e,t),new ye(r,i),new ye(n,a));return this.curves.push(o),this.currentPoint.set(n,a),this}splineThru(e){let t=[this.currentPoint.clone()].concat(e),r=new oP(t);return this.curves.push(r),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,r,i,n,a){let o=this.currentPoint.x,s=this.currentPoint.y;return this.absarc(e+o,t+s,r,i,n,a),this}absarc(e,t,r,i,n,a){return this.absellipse(e,t,r,r,i,n,a),this}ellipse(e,t,r,i,n,a,o,s){let l=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(e+l,t+c,r,i,n,a,o,s),this}absellipse(e,t,r,i,n,a,o,s){let l=new Z1(e,t,r,i,n,a,o,s);if(this.curves.length>0){let d=l.getPoint(0);d.equals(this.currentPoint)||this.lineTo(d.x,d.y)}this.curves.push(l);let c=l.getPoint(1);return this.currentPoint.copy(c),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){let e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}},Tj=class extends Ot{constructor(e=[new ye(0,-.5),new ye(.5,0),new ye(0,.5)],t=12,r=0,i=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:r,phiLength:i},t=Math.floor(t),i=nn(i,0,Math.PI*2);let n=[],a=[],o=[],s=[],l=[],c=1/t,d=new k,u=new ye,h=new k,f=new k,p=new k,v=0,m=0;for(let g=0;g<=e.length-1;g++)switch(g){case 0:v=e[g+1].x-e[g].x,m=e[g+1].y-e[g].y,h.x=m*1,h.y=-v,h.z=m*0,p.copy(h),h.normalize(),s.push(h.x,h.y,h.z);break;case e.length-1:s.push(p.x,p.y,p.z);break;default:v=e[g+1].x-e[g].x,m=e[g+1].y-e[g].y,h.x=m*1,h.y=-v,h.z=m*0,f.copy(h),h.x+=p.x,h.y+=p.y,h.z+=p.z,h.normalize(),s.push(h.x,h.y,h.z),p.copy(f)}for(let g=0;g<=t;g++){let y=r+g*c*i,b=Math.sin(y),x=Math.cos(y);for(let S=0;S<=e.length-1;S++){d.x=e[S].x*b,d.y=e[S].y,d.z=e[S].x*x,a.push(d.x,d.y,d.z),u.x=g/t,u.y=S/(e.length-1),o.push(u.x,u.y);let w=s[3*S+0]*b,_=s[3*S+1],C=s[3*S+0]*x;l.push(w,_,C)}}for(let g=0;g<t;g++)for(let y=0;y<e.length-1;y++){let b=y+g*e.length,x=b,S=b+e.length,w=b+e.length+1,_=b+1;n.push(x,S,_),n.push(w,_,S)}this.setIndex(n),this.setAttribute("position",new yt(a,3)),this.setAttribute("uv",new yt(o,2)),this.setAttribute("normal",new yt(l,3))}static fromJSON(e){return new Tj(e.points,e.segments,e.phiStart,e.phiLength)}},sP=class extends Ot{constructor(e=1,t=1,r=1,i=32,n=1,a=!1,o=0,s=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:r,radialSegments:i,heightSegments:n,openEnded:a,thetaStart:o,thetaLength:s};let l=this;i=Math.floor(i),n=Math.floor(n);let c=[],d=[],u=[],h=[],f=0,p=[],v=r/2,m=0;g(),a===!1&&(e>0&&y(!0),t>0&&y(!1)),this.setIndex(c),this.setAttribute("position",new yt(d,3)),this.setAttribute("normal",new yt(u,3)),this.setAttribute("uv",new yt(h,2));function g(){let b=new k,x=new k,S=0,w=(t-e)/r;for(let _=0;_<=n;_++){let C=[],A=_/n,M=A*(t-e)+e;for(let P=0;P<=i;P++){let T=P/i,R=T*s+o,z=Math.sin(R),F=Math.cos(R);x.x=M*z,x.y=-A*r+v,x.z=M*F,d.push(x.x,x.y,x.z),b.set(z,w,F).normalize(),u.push(b.x,b.y,b.z),h.push(T,1-A),C.push(f++)}p.push(C)}for(let _=0;_<i;_++)for(let C=0;C<n;C++){let A=p[C][_],M=p[C+1][_],P=p[C+1][_+1],T=p[C][_+1];c.push(A,M,T),c.push(M,P,T),S+=6}l.addGroup(m,S,0),m+=S}function y(b){let x=f,S=new ye,w=new k,_=0,C=b===!0?e:t,A=b===!0?1:-1;for(let P=1;P<=i;P++)d.push(0,v*A,0),u.push(0,A,0),h.push(.5,.5),f++;let M=f;for(let P=0;P<=i;P++){let T=P/i*s+o,R=Math.cos(T),z=Math.sin(T);w.x=C*z,w.y=v*A,w.z=C*R,d.push(w.x,w.y,w.z),u.push(0,A,0),S.x=R*.5+.5,S.y=z*.5*A+.5,h.push(S.x,S.y),f++}for(let P=0;P<i;P++){let T=x+P,R=M+P;b===!0?c.push(R,R+1,T):c.push(R+1,R,T),_+=3}l.addGroup(m,_,b===!0?1:2),m+=_}}static fromJSON(e){return new sP(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}},lP=class extends sP{constructor(e=1,t=1,r=32,i=1,n=!1,a=0,o=Math.PI*2){super(0,e,t,r,i,n,a,o),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:r,heightSegments:i,openEnded:n,thetaStart:a,thetaLength:o}}static fromJSON(e){return new lP(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}},cP=class extends Ot{constructor(e=[],t=[],r=1,i=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:r,detail:i};let n=[],a=[];o(i),l(r),c(),this.setAttribute("position",new yt(n,3)),this.setAttribute("normal",new yt(n.slice(),3)),this.setAttribute("uv",new yt(a,2)),i===0?this.computeVertexNormals():this.normalizeNormals();function o(g){let y=new k,b=new k,x=new k;for(let S=0;S<t.length;S+=3)h(t[S+0],y),h(t[S+1],b),h(t[S+2],x),s(y,b,x,g)}function s(g,y,b,x){let S=x+1,w=[];for(let _=0;_<=S;_++){w[_]=[];let C=g.clone().lerp(b,_/S),A=y.clone().lerp(b,_/S),M=S-_;for(let P=0;P<=M;P++)P===0&&_===S?w[_][P]=C:w[_][P]=C.clone().lerp(A,P/M)}for(let _=0;_<S;_++)for(let C=0;C<2*(S-_)-1;C++){let A=Math.floor(C/2);C%2===0?(u(w[_][A+1]),u(w[_+1][A]),u(w[_][A])):(u(w[_][A+1]),u(w[_+1][A+1]),u(w[_+1][A]))}}function l(g){let y=new k;for(let b=0;b<n.length;b+=3)y.x=n[b+0],y.y=n[b+1],y.z=n[b+2],y.normalize().multiplyScalar(g),n[b+0]=y.x,n[b+1]=y.y,n[b+2]=y.z}function c(){let g=new k;for(let y=0;y<n.length;y+=3){g.x=n[y+0],g.y=n[y+1],g.z=n[y+2];let b=v(g)/2/Math.PI+.5,x=m(g)/Math.PI+.5;a.push(b,1-x)}f(),d()}function d(){for(let g=0;g<a.length;g+=6){let y=a[g+0],b=a[g+2],x=a[g+4],S=Math.max(y,b,x),w=Math.min(y,b,x);S>.9&&w<.1&&(y<.2&&(a[g+0]+=1),b<.2&&(a[g+2]+=1),x<.2&&(a[g+4]+=1))}}function u(g){n.push(g.x,g.y,g.z)}function h(g,y){let b=g*3;y.x=e[b+0],y.y=e[b+1],y.z=e[b+2]}function f(){let g=new k,y=new k,b=new k,x=new k,S=new ye,w=new ye,_=new ye;for(let C=0,A=0;C<n.length;C+=9,A+=6){g.set(n[C+0],n[C+1],n[C+2]),y.set(n[C+3],n[C+4],n[C+5]),b.set(n[C+6],n[C+7],n[C+8]),S.set(a[A+0],a[A+1]),w.set(a[A+2],a[A+3]),_.set(a[A+4],a[A+5]),x.copy(g).add(y).add(b).divideScalar(3);let M=v(x);p(S,A+0,g,M),p(w,A+2,y,M),p(_,A+4,b,M)}}function p(g,y,b,x){x<0&&g.x===1&&(a[y]=g.x-1),b.x===0&&b.z===0&&(a[y]=x/2/Math.PI+.5)}function v(g){return Math.atan2(g.z,-g.x)}function m(g){return Math.atan2(-g.y,Math.sqrt(g.x*g.x+g.z*g.z))}}static fromJSON(e){return new cP(e.vertices,e.indices,e.radius,e.details)}},Pj=class extends cP{constructor(e=1,t=0){let r=(1+Math.sqrt(5))/2,i=1/r,n=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-r,0,-i,r,0,i,-r,0,i,r,-i,-r,0,-i,r,0,i,-r,0,i,r,0,-r,0,-i,r,0,-i,-r,0,i,r,0,i],a=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(n,a,e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Pj(e.radius,e.detail)}},mx=class extends px{constructor(e){super(e),this.uuid=Io(),this.type="Shape",this.holes=[]}getPointsHoles(e){let t=[];for(let r=0,i=this.holes.length;r<i;r++)t[r]=this.holes[r].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){let i=e.holes[t];this.holes.push(i.clone())}return this}toJSON(){let e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,r=this.holes.length;t<r;t++){let i=this.holes[t];e.holes.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){let i=e.holes[t];this.holes.push(new px().fromJSON(i))}return this}},r1e={triangulate:function(e,t,r=2){let i=t&&t.length,n=i?t[0]*r:e.length,a=Dj(e,0,n,r,!0),o=[];if(!a||a.next===a.prev)return o;let s,l,c,d,u,h,f;if(i&&(a=s1e(e,t,a,r)),e.length>80*r){s=c=e[0],l=d=e[1];for(let p=r;p<n;p+=r)u=e[p],h=e[p+1],u<s&&(s=u),h<l&&(l=h),u>c&&(c=u),h>d&&(d=h);f=Math.max(c-s,d-l),f=f!==0?32767/f:0}return og(a,o,r,s,l,f,0),o}};function Dj(e,t,r,i,n){let a,o;if(n===y1e(e,t,r,i)>0)for(a=t;a<r;a+=i)o=vz(a,e[a],e[a+1],o);else for(a=r-i;a>=t;a-=i)o=vz(a,e[a],e[a+1],o);return o&&J1(o,o.next)&&(lg(o),o=o.next),o}function nh(e,t){if(!e)return e;t||(t=e);let r=e,i;do if(i=!1,!r.steiner&&(J1(r,r.next)||Pi(r.prev,r,r.next)===0)){if(lg(r),r=t=r.prev,r===r.next)break;i=!0}else r=r.next;while(i||r!==t);return t}function og(e,t,r,i,n,a,o){if(!e)return;!o&&a&&h1e(e,i,n,a);let s=e,l,c;for(;e.prev!==e.next;){if(l=e.prev,c=e.next,a?n1e(e,i,n,a):i1e(e)){t.push(l.i/r|0),t.push(e.i/r|0),t.push(c.i/r|0),lg(e),e=c.next,s=c.next;continue}if(e=c,e===s){o?o===1?(e=a1e(nh(e),t,r),og(e,t,r,i,n,a,2)):o===2&&o1e(e,t,r,i,n,a):og(nh(e),t,r,i,n,a,1);break}}}function i1e(e){let t=e.prev,r=e,i=e.next;if(Pi(t,r,i)>=0)return!1;let n=t.x,a=r.x,o=i.x,s=t.y,l=r.y,c=i.y,d=n<a?n<o?n:o:a<o?a:o,u=s<l?s<c?s:c:l<c?l:c,h=n>a?n>o?n:o:a>o?a:o,f=s>l?s>c?s:c:l>c?l:c,p=i.next;for(;p!==t;){if(p.x>=d&&p.x<=h&&p.y>=u&&p.y<=f&&Pf(n,s,a,l,o,c,p.x,p.y)&&Pi(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function n1e(e,t,r,i){let n=e.prev,a=e,o=e.next;if(Pi(n,a,o)>=0)return!1;let s=n.x,l=a.x,c=o.x,d=n.y,u=a.y,h=o.y,f=s<l?s<c?s:c:l<c?l:c,p=d<u?d<h?d:h:u<h?u:h,v=s>l?s>c?s:c:l>c?l:c,m=d>u?d>h?d:h:u>h?u:h,g=zA(f,p,t,r,i),y=zA(v,m,t,r,i),b=e.prevZ,x=e.nextZ;for(;b&&b.z>=g&&x&&x.z<=y;){if(b.x>=f&&b.x<=v&&b.y>=p&&b.y<=m&&b!==n&&b!==o&&Pf(s,d,l,u,c,h,b.x,b.y)&&Pi(b.prev,b,b.next)>=0||(b=b.prevZ,x.x>=f&&x.x<=v&&x.y>=p&&x.y<=m&&x!==n&&x!==o&&Pf(s,d,l,u,c,h,x.x,x.y)&&Pi(x.prev,x,x.next)>=0))return!1;x=x.nextZ}for(;b&&b.z>=g;){if(b.x>=f&&b.x<=v&&b.y>=p&&b.y<=m&&b!==n&&b!==o&&Pf(s,d,l,u,c,h,b.x,b.y)&&Pi(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;x&&x.z<=y;){if(x.x>=f&&x.x<=v&&x.y>=p&&x.y<=m&&x!==n&&x!==o&&Pf(s,d,l,u,c,h,x.x,x.y)&&Pi(x.prev,x,x.next)>=0)return!1;x=x.nextZ}return!0}function a1e(e,t,r){let i=e;do{let n=i.prev,a=i.next.next;!J1(n,a)&&Oj(n,i,i.next,a)&&sg(n,a)&&sg(a,n)&&(t.push(n.i/r|0),t.push(i.i/r|0),t.push(a.i/r|0),lg(i),lg(i.next),i=e=a),i=i.next}while(i!==e);return nh(i)}function o1e(e,t,r,i,n,a){let o=e;do{let s=o.next.next;for(;s!==o.prev;){if(o.i!==s.i&&m1e(o,s)){let l=Rj(o,s);o=nh(o,o.next),l=nh(l,l.next),og(o,t,r,i,n,a,0),og(l,t,r,i,n,a,0);return}s=s.next}o=o.next}while(o!==e)}function s1e(e,t,r,i){let n=[],a,o,s,l,c;for(a=0,o=t.length;a<o;a++)s=t[a]*i,l=a<o-1?t[a+1]*i:e.length,c=Dj(e,s,l,i,!1),c===c.next&&(c.steiner=!0),n.push(p1e(c));for(n.sort(l1e),a=0;a<n.length;a++)r=c1e(n[a],r);return r}function l1e(e,t){return e.x-t.x}function c1e(e,t){let r=d1e(e,t);if(!r)return t;let i=Rj(r,e);return nh(i,i.next),nh(r,r.next)}function d1e(e,t){let r=t,i=-1/0,n,a=e.x,o=e.y;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){let h=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(h<=a&&h>i&&(i=h,n=r.x<r.next.x?r:r.next,h===a))return n}r=r.next}while(r!==t);if(!n)return null;let s=n,l=n.x,c=n.y,d=1/0,u;r=n;do a>=r.x&&r.x>=l&&a!==r.x&&Pf(o<c?a:i,o,l,c,o<c?i:a,o,r.x,r.y)&&(u=Math.abs(o-r.y)/(a-r.x),sg(r,e)&&(u<d||u===d&&(r.x>n.x||r.x===n.x&&u1e(n,r)))&&(n=r,d=u)),r=r.next;while(r!==s);return n}function u1e(e,t){return Pi(e.prev,e,t.prev)<0&&Pi(t.next,e,e.next)<0}function h1e(e,t,r,i){let n=e;do n.z===0&&(n.z=zA(n.x,n.y,t,r,i)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next;while(n!==e);n.prevZ.nextZ=null,n.prevZ=null,f1e(n)}function f1e(e){let t,r,i,n,a,o,s,l,c=1;do{for(r=e,e=null,a=null,o=0;r;){for(o++,i=r,s=0,t=0;t<c&&(s++,i=i.nextZ,!!i);t++);for(l=c;s>0||l>0&&i;)s!==0&&(l===0||!i||r.z<=i.z)?(n=r,r=r.nextZ,s--):(n=i,i=i.nextZ,l--),a?a.nextZ=n:e=n,n.prevZ=a,a=n;r=i}a.nextZ=null,c*=2}while(o>1);return e}function zA(e,t,r,i,n){return e=(e-r)*n|0,t=(t-i)*n|0,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e|t<<1}function p1e(e){let t=e,r=e;do(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;while(t!==e);return r}function Pf(e,t,r,i,n,a,o,s){return(n-o)*(t-s)>=(e-o)*(a-s)&&(e-o)*(i-s)>=(r-o)*(t-s)&&(r-o)*(a-s)>=(n-o)*(i-s)}function m1e(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!v1e(e,t)&&(sg(e,t)&&sg(t,e)&&g1e(e,t)&&(Pi(e.prev,e,t.prev)||Pi(e,t.prev,t))||J1(e,t)&&Pi(e.prev,e,e.next)>0&&Pi(t.prev,t,t.next)>0)}function Pi(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function J1(e,t){return e.x===t.x&&e.y===t.y}function Oj(e,t,r,i){let n=iy(Pi(e,t,r)),a=iy(Pi(e,t,i)),o=iy(Pi(r,i,e)),s=iy(Pi(r,i,t));return!!(n!==a&&o!==s||n===0&&ry(e,r,t)||a===0&&ry(e,i,t)||o===0&&ry(r,e,i)||s===0&&ry(r,t,i))}function ry(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function iy(e){return e>0?1:e<0?-1:0}function v1e(e,t){let r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&Oj(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}function sg(e,t){return Pi(e.prev,e,e.next)<0?Pi(e,t,e.next)>=0&&Pi(e,e.prev,t)>=0:Pi(e,t,e.prev)<0||Pi(e,e.next,t)<0}function g1e(e,t){let r=e,i=!1,n=(e.x+t.x)/2,a=(e.y+t.y)/2;do r.y>a!=r.next.y>a&&r.next.y!==r.y&&n<(r.next.x-r.x)*(a-r.y)/(r.next.y-r.y)+r.x&&(i=!i),r=r.next;while(r!==e);return i}function Rj(e,t){let r=new kA(e.i,e.x,e.y),i=new kA(t.i,t.x,t.y),n=e.next,a=t.prev;return e.next=t,t.prev=e,r.next=n,n.prev=r,i.next=r,r.prev=i,a.next=i,i.prev=a,i}function vz(e,t,r,i){let n=new kA(e,t,r);return i?(n.next=i.next,n.prev=i,i.next.prev=n,i.next=n):(n.prev=n,n.next=n),n}function lg(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function kA(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function y1e(e,t,r,i){let n=0;for(let a=t,o=r-i;a<r;a+=i)n+=(e[o]-e[a])*(e[a+1]+e[o+1]),o=a;return n}var Ij=class{static area(e){let t=e.length,r=0;for(let i=t-1,n=0;n<t;i=n++)r+=e[i].x*e[n].y-e[n].x*e[i].y;return r*.5}static isClockWise(e){return Ij.area(e)<0}static triangulateShape(e,t){let r=[],i=[],n=[];gz(e),yz(r,e);let a=e.length;t.forEach(gz);for(let s=0;s<t.length;s++)i.push(a),a+=t[s].length,yz(r,t[s]);let o=r1e.triangulate(r,i);for(let s=0;s<o.length;s+=3)n.push(o.slice(s,s+3));return n}};function gz(e){let t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function yz(e,t){for(let r=0;r<t.length;r++)e.push(t[r].x),e.push(t[r].y)}var zj=class extends cP{constructor(e=1,t=0){let r=(1+Math.sqrt(5))/2,i=[-1,r,0,1,r,0,-1,-r,0,1,-r,0,0,-1,r,0,1,r,0,-1,-r,0,1,-r,r,0,-1,r,0,1,-r,0,-1,-r,0,1],n=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(i,n,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new zj(e.radius,e.detail)}},Hf=class extends Ot{constructor(e=1,t=32,r=16,i=0,n=Math.PI*2,a=0,o=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:r,phiStart:i,phiLength:n,thetaStart:a,thetaLength:o},t=Math.max(3,Math.floor(t)),r=Math.max(2,Math.floor(r));let s=Math.min(a+o,Math.PI),l=0,c=[],d=new k,u=new k,h=[],f=[],p=[],v=[];for(let m=0;m<=r;m++){let g=[],y=m/r,b=0;m==0&&a==0?b=.5/t:m==r&&s==Math.PI&&(b=-.5/t);for(let x=0;x<=t;x++){let S=x/t;d.x=-e*Math.cos(i+S*n)*Math.sin(a+y*o),d.y=e*Math.cos(a+y*o),d.z=e*Math.sin(i+S*n)*Math.sin(a+y*o),f.push(d.x,d.y,d.z),u.copy(d).normalize(),p.push(u.x,u.y,u.z),v.push(S+b,1-y),g.push(l++)}c.push(g)}for(let m=0;m<r;m++)for(let g=0;g<t;g++){let y=c[m][g+1],b=c[m][g],x=c[m+1][g],S=c[m+1][g+1];(m!==0||a>0)&&h.push(y,b,S),(m!==r-1||s<Math.PI)&&h.push(b,x,S)}this.setIndex(h),this.setAttribute("position",new yt(f,3)),this.setAttribute("normal",new yt(p,3)),this.setAttribute("uv",new yt(v,2))}static fromJSON(e){return new Hf(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}},kj=class extends Ot{constructor(e=1,t=.4,r=12,i=48,n=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:r,tubularSegments:i,arc:n},r=Math.floor(r),i=Math.floor(i);let a=[],o=[],s=[],l=[],c=new k,d=new k,u=new k;for(let h=0;h<=r;h++)for(let f=0;f<=i;f++){let p=f/i*n,v=h/r*Math.PI*2;d.x=(e+t*Math.cos(v))*Math.cos(p),d.y=(e+t*Math.cos(v))*Math.sin(p),d.z=t*Math.sin(v),o.push(d.x,d.y,d.z),c.x=e*Math.cos(p),c.y=e*Math.sin(p),u.subVectors(d,c).normalize(),s.push(u.x,u.y,u.z),l.push(f/i),l.push(h/r)}for(let h=1;h<=r;h++)for(let f=1;f<=i;f++){let p=(i+1)*h+f-1,v=(i+1)*(h-1)+f-1,m=(i+1)*(h-1)+f,g=(i+1)*h+f;a.push(p,v,g),a.push(v,m,g)}this.setIndex(a),this.setAttribute("position",new yt(o,3)),this.setAttribute("normal",new yt(s,3)),this.setAttribute("uv",new yt(l,2))}static fromJSON(e){return new kj(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}},Lj=class extends Ot{constructor(e=1,t=.4,r=64,i=8,n=2,a=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:r,radialSegments:i,p:n,q:a},r=Math.floor(r),i=Math.floor(i);let o=[],s=[],l=[],c=[],d=new k,u=new k,h=new k,f=new k,p=new k,v=new k,m=new k;for(let y=0;y<=r;++y){let b=y/r*n*Math.PI*2;g(b,n,a,e,h),g(b+.01,n,a,e,f),v.subVectors(f,h),m.addVectors(f,h),p.crossVectors(v,m),m.crossVectors(p,v),p.normalize(),m.normalize();for(let x=0;x<=i;++x){let S=x/i*Math.PI*2,w=-t*Math.cos(S),_=t*Math.sin(S);d.x=h.x+(w*m.x+_*p.x),d.y=h.y+(w*m.y+_*p.y),d.z=h.z+(w*m.z+_*p.z),s.push(d.x,d.y,d.z),u.subVectors(d,h).normalize(),l.push(u.x,u.y,u.z),c.push(y/r),c.push(x/i)}}for(let y=1;y<=r;y++)for(let b=1;b<=i;b++){let x=(i+1)*(y-1)+(b-1),S=(i+1)*y+(b-1),w=(i+1)*y+b,_=(i+1)*(y-1)+b;o.push(x,S,_),o.push(S,w,_)}this.setIndex(o),this.setAttribute("position",new yt(s,3)),this.setAttribute("normal",new yt(l,3)),this.setAttribute("uv",new yt(c,2));function g(y,b,x,S,w){let _=Math.cos(y),C=Math.sin(y),A=x/b*y,M=Math.cos(A);w.x=S*(2+M)*.5*_,w.y=S*(2+M)*C*.5,w.z=S*Math.sin(A)*.5}}static fromJSON(e){return new Lj(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}};function Tc(e,t,r){return Bj(e)?new e.constructor(e.subarray(t,r!==void 0?r:e.length)):e.slice(t,r)}function ny(e,t,r){return!e||e.constructor===t?e:typeof t.BYTES_PER_ELEMENT=="number"?new t(e):Array.prototype.slice.call(e)}function Bj(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function b1e(e){function t(n,a){return e[n]-e[a]}let r=e.length,i=new Array(r);for(let n=0;n!==r;++n)i[n]=n;return i.sort(t),i}function bz(e,t,r){let i=e.length,n=new e.constructor(i);for(let a=0,o=0;o!==i;++a){let s=r[a]*t;for(let l=0;l!==t;++l)n[o++]=e[s+l]}return n}function Fj(e,t,r,i){let n=1,a=e[0];for(;a!==void 0&&a[i]===void 0;)a=e[n++];if(a===void 0)return;let o=a[i];if(o!==void 0)if(Array.isArray(o))do o=a[i],o!==void 0&&(t.push(a.time),r.push.apply(r,o)),a=e[n++];while(a!==void 0);else if(o.toArray!==void 0)do o=a[i],o!==void 0&&(t.push(a.time),o.toArray(r,r.length)),a=e[n++];while(a!==void 0);else do o=a[i],o!==void 0&&(t.push(a.time),r.push(o)),a=e[n++];while(a!==void 0)}var ew=class{constructor(e,t,r,i){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=i!==void 0?i:new t.constructor(r),this.sampleValues=t,this.valueSize=r,this.settings=null,this.DefaultSettings_={}}evaluate(e){let t=this.parameterPositions,r=this._cachedIndex,i=t[r],n=t[r-1];e:{t:{let a;r:{i:if(!(e<i)){for(let o=r+2;;){if(i===void 0){if(e<n)break i;return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}if(r===o)break;if(n=i,i=t[++r],e<i)break t}a=t.length;break r}if(!(e>=n)){let o=t[1];e<o&&(r=2,n=o);for(let s=r-2;;){if(n===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===s)break;if(i=n,n=t[--r-1],e>=n)break t}a=r,r=0;break r}break e}for(;r<a;){let o=r+a>>>1;e<t[o]?a=o:r=o+1}if(i=t[r],n=t[r-1],n===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===void 0)return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}this._cachedIndex=r,this.intervalChanged_(r,n,i)}return this.interpolate_(r,n,e,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){let t=this.resultBuffer,r=this.sampleValues,i=this.valueSize,n=e*i;for(let a=0;a!==i;++a)t[a]=r[n+a];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}},x1e=class extends ew{constructor(e,t,r,i){super(e,t,r,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Mf,endingEnd:Mf}}intervalChanged_(e,t,r){let i=this.parameterPositions,n=e-2,a=e+1,o=i[n],s=i[a];if(o===void 0)switch(this.getSettings_().endingStart){case Ef:n=e,o=2*t-r;break;case dx:n=i.length-2,o=t+i[n]-i[n+1];break;default:n=e,o=r}if(s===void 0)switch(this.getSettings_().endingEnd){case Ef:a=e,s=2*r-t;break;case dx:a=1,s=r+i[1]-i[0];break;default:a=e-1,s=t}let l=(r-t)*.5,c=this.valueSize;this._weightPrev=l/(t-o),this._weightNext=l/(s-r),this._offsetPrev=n*c,this._offsetNext=a*c}interpolate_(e,t,r,i){let n=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,l=s-o,c=this._offsetPrev,d=this._offsetNext,u=this._weightPrev,h=this._weightNext,f=(r-t)/(i-t),p=f*f,v=p*f,m=-u*v+2*u*p-u*f,g=(1+u)*v+(-1.5-2*u)*p+(-.5+u)*f+1,y=(-1-h)*v+(1.5+h)*p+.5*f,b=h*v-h*p;for(let x=0;x!==o;++x)n[x]=m*a[c+x]+g*a[l+x]+y*a[s+x]+b*a[d+x];return n}},Nj=class extends ew{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e,t,r,i){let n=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,l=s-o,c=(r-t)/(i-t),d=1-c;for(let u=0;u!==o;++u)n[u]=a[l+u]*d+a[s+u]*c;return n}},w1e=class extends ew{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e){return this.copySampleValue_(e-1)}},fl=class{constructor(e,t,r,i){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=ny(t,this.TimeBufferType),this.values=ny(r,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(e){let t=e.constructor,r;if(t.toJSON!==this.toJSON)r=t.toJSON(e);else{r={name:e.name,times:ny(e.times,Array),values:ny(e.values,Array)};let i=e.getInterpolation();i!==e.DefaultInterpolation&&(r.interpolation=i)}return r.type=e.ValueTypeName,r}InterpolantFactoryMethodDiscrete(e){return new w1e(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new Nj(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new x1e(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case lx:t=this.InterpolantFactoryMethodDiscrete;break;case cx:t=this.InterpolantFactoryMethodLinear;break;case IS:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){let r="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(r);return console.warn("THREE.KeyframeTrack:",r),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return lx;case this.InterpolantFactoryMethodLinear:return cx;case this.InterpolantFactoryMethodSmooth:return IS}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){let t=this.times;for(let r=0,i=t.length;r!==i;++r)t[r]+=e}return this}scale(e){if(e!==1){let t=this.times;for(let r=0,i=t.length;r!==i;++r)t[r]*=e}return this}trim(e,t){let r=this.times,i=r.length,n=0,a=i-1;for(;n!==i&&r[n]<e;)++n;for(;a!==-1&&r[a]>t;)--a;if(++a,n!==0||a!==i){n>=a&&(a=Math.max(a,1),n=a-1);let o=this.getValueSize();this.times=Tc(r,n,a),this.values=Tc(this.values,n*o,a*o)}return this}validate(){let e=!0,t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);let r=this.times,i=this.values,n=r.length;n===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let a=null;for(let o=0;o!==n;o++){let s=r[o];if(typeof s=="number"&&isNaN(s)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,s),e=!1;break}if(a!==null&&a>s){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,s,a),e=!1;break}a=s}if(i!==void 0&&Bj(i))for(let o=0,s=i.length;o!==s;++o){let l=i[o];if(isNaN(l)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,o,l),e=!1;break}}return e}optimize(){let e=Tc(this.times),t=Tc(this.values),r=this.getValueSize(),i=this.getInterpolation()===IS,n=e.length-1,a=1;for(let o=1;o<n;++o){let s=!1,l=e[o],c=e[o+1];if(l!==c&&(o!==1||l!==e[0]))if(i)s=!0;else{let d=o*r,u=d-r,h=d+r;for(let f=0;f!==r;++f){let p=t[d+f];if(p!==t[u+f]||p!==t[h+f]){s=!0;break}}}if(s){if(o!==a){e[a]=e[o];let d=o*r,u=a*r;for(let h=0;h!==r;++h)t[u+h]=t[d+h]}++a}}if(n>0){e[a]=e[n];for(let o=n*r,s=a*r,l=0;l!==r;++l)t[s+l]=t[o+l];++a}return a!==e.length?(this.times=Tc(e,0,a),this.values=Tc(t,0,a*r)):(this.times=e,this.values=t),this}clone(){let e=Tc(this.times,0),t=Tc(this.values,0),r=this.constructor,i=new r(this.name,e,t);return i.createInterpolant=this.createInterpolant,i}};fl.prototype.TimeBufferType=Float32Array;fl.prototype.ValueBufferType=Float32Array;fl.prototype.DefaultInterpolation=cx;var Wp=class extends fl{};Wp.prototype.ValueTypeName="bool";Wp.prototype.ValueBufferType=Array;Wp.prototype.DefaultInterpolation=lx;Wp.prototype.InterpolantFactoryMethodLinear=void 0;Wp.prototype.InterpolantFactoryMethodSmooth=void 0;var Uj=class extends fl{};Uj.prototype.ValueTypeName="color";var vx=class extends fl{};vx.prototype.ValueTypeName="number";var S1e=class extends ew{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e,t,r,i){let n=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=(r-t)/(i-t),l=e*o;for(let c=l+o;l!==c;l+=4)Xt.slerpFlat(n,0,a,l-o,a,l,s);return n}},$g=class extends fl{InterpolantFactoryMethodLinear(e){return new S1e(this.times,this.values,this.getValueSize(),e)}};$g.prototype.ValueTypeName="quaternion";$g.prototype.DefaultInterpolation=cx;$g.prototype.InterpolantFactoryMethodSmooth=void 0;var Gp=class extends fl{};Gp.prototype.ValueTypeName="string";Gp.prototype.ValueBufferType=Array;Gp.prototype.DefaultInterpolation=lx;Gp.prototype.InterpolantFactoryMethodLinear=void 0;Gp.prototype.InterpolantFactoryMethodSmooth=void 0;var gx=class extends fl{};gx.prototype.ValueTypeName="vector";var LA=class{constructor(e,t=-1,r,i=ZT){this.name=e,this.tracks=r,this.duration=t,this.blendMode=i,this.uuid=Io(),this.duration<0&&this.resetDuration()}static parse(e){let t=[],r=e.tracks,i=1/(e.fps||1);for(let a=0,o=r.length;a!==o;++a)t.push(_1e(r[a]).scale(i));let n=new this(e.name,e.duration,t,e.blendMode);return n.uuid=e.uuid,n}static toJSON(e){let t=[],r=e.tracks,i={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let n=0,a=r.length;n!==a;++n)t.push(fl.toJSON(r[n]));return i}static CreateFromMorphTargetSequence(e,t,r,i){let n=t.length,a=[];for(let o=0;o<n;o++){let s=[],l=[];s.push((o+n-1)%n,o,(o+1)%n),l.push(0,1,0);let c=b1e(s);s=bz(s,1,c),l=bz(l,1,c),!i&&s[0]===0&&(s.push(n),l.push(l[0])),a.push(new vx(".morphTargetInfluences["+t[o].name+"]",s,l).scale(1/r))}return new this(e,-1,a)}static findByName(e,t){let r=e;if(!Array.isArray(e)){let i=e;r=i.geometry&&i.geometry.animations||i.animations}for(let i=0;i<r.length;i++)if(r[i].name===t)return r[i];return null}static CreateClipsFromMorphTargetSequences(e,t,r){let i={},n=/^([\w-]*?)([\d]+)$/;for(let o=0,s=e.length;o<s;o++){let l=e[o],c=l.name.match(n);if(c&&c.length>1){let d=c[1],u=i[d];u||(i[d]=u=[]),u.push(l)}}let a=[];for(let o in i)a.push(this.CreateFromMorphTargetSequence(o,i[o],t,r));return a}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;let r=function(c,d,u,h,f){if(u.length!==0){let p=[],v=[];Fj(u,p,v,h),p.length!==0&&f.push(new c(d,p,v))}},i=[],n=e.name||"default",a=e.fps||30,o=e.blendMode,s=e.length||-1,l=e.hierarchy||[];for(let c=0;c<l.length;c++){let d=l[c].keys;if(!(!d||d.length===0))if(d[0].morphTargets){let u={},h;for(h=0;h<d.length;h++)if(d[h].morphTargets)for(let f=0;f<d[h].morphTargets.length;f++)u[d[h].morphTargets[f]]=-1;for(let f in u){let p=[],v=[];for(let m=0;m!==d[h].morphTargets.length;++m){let g=d[h];p.push(g.time),v.push(g.morphTarget===f?1:0)}i.push(new vx(".morphTargetInfluence["+f+"]",p,v))}s=u.length*a}else{let u=".bones["+t[c].name+"]";r(gx,u+".position",d,"pos",i),r($g,u+".quaternion",d,"rot",i),r(gx,u+".scale",d,"scl",i)}}return i.length===0?null:new this(n,s,i,o)}resetDuration(){let e=this.tracks,t=0;for(let r=0,i=e.length;r!==i;++r){let n=this.tracks[r];t=Math.max(t,n.times[n.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){let e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}};function C1e(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return vx;case"vector":case"vector2":case"vector3":case"vector4":return gx;case"color":return Uj;case"quaternion":return $g;case"bool":case"boolean":return Wp;case"string":return Gp}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}function _1e(e){if(e.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");let t=C1e(e.type);if(e.times===void 0){let r=[],i=[];Fj(e.keys,r,i,"value"),e.times=r,e.values=i}return t.parse!==void 0?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}var yx={enabled:!1,files:{},add:function(e,t){this.enabled!==!1&&(this.files[e]=t)},get:function(e){if(this.enabled!==!1)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}},jj=class{constructor(e,t,r){let i=this,n=!1,a=0,o=0,s,l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=r,this.itemStart=function(c){o++,n===!1&&i.onStart!==void 0&&i.onStart(c,a,o),n=!0},this.itemEnd=function(c){a++,i.onProgress!==void 0&&i.onProgress(c,a,o),a===o&&(n=!1,i.onLoad!==void 0&&i.onLoad())},this.itemError=function(c){i.onError!==void 0&&i.onError(c)},this.resolveURL=function(c){return s?s(c):c},this.setURLModifier=function(c){return s=c,this},this.addHandler=function(c,d){return l.push(c,d),this},this.removeHandler=function(c){let d=l.indexOf(c);return d!==-1&&l.splice(d,2),this},this.getHandler=function(c){for(let d=0,u=l.length;d<u;d+=2){let h=l[d],f=l[d+1];if(h.global&&(h.lastIndex=0),h.test(c))return f}return null}}},A1e=new jj,qg=class{constructor(e){this.manager=e!==void 0?e:A1e,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){let r=this;return new Promise(function(i,n){r.load(e,i,t,n)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}},Cl={},M1e=class extends Error{constructor(e,t){super(e),this.response=t}},BA=class extends qg{constructor(e){super(e)}load(e,t,r,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let n=yx.get(e);if(n!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(n),this.manager.itemEnd(e)},0),n;if(Cl[e]!==void 0){Cl[e].push({onLoad:t,onProgress:r,onError:i});return}Cl[e]=[],Cl[e].push({onLoad:t,onProgress:r,onError:i});let a=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),o=this.mimeType,s=this.responseType;fetch(a).then(l=>{if(l.status===200||l.status===0){if(l.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||l.body===void 0||l.body.getReader===void 0)return l;let c=Cl[e],d=l.body.getReader(),u=l.headers.get("Content-Length")||l.headers.get("X-File-Size"),h=u?parseInt(u):0,f=h!==0,p=0,v=new ReadableStream({start(m){g();function g(){d.read().then(({done:y,value:b})=>{if(y)m.close();else{p+=b.byteLength;let x=new ProgressEvent("progress",{lengthComputable:f,loaded:p,total:h});for(let S=0,w=c.length;S<w;S++){let _=c[S];_.onProgress&&_.onProgress(x)}m.enqueue(b),g()}})}}});return new Response(v)}else throw new M1e(`fetch for "${l.url}" responded with ${l.status}: ${l.statusText}`,l)}).then(l=>{switch(s){case"arraybuffer":return l.arrayBuffer();case"blob":return l.blob();case"document":return l.text().then(c=>new DOMParser().parseFromString(c,o));case"json":return l.json();default:if(o===void 0)return l.text();{let c=/charset="?([^;"\s]*)"?/i.exec(o),d=c&&c[1]?c[1].toLowerCase():void 0,u=new TextDecoder(d);return l.arrayBuffer().then(h=>u.decode(h))}}}).then(l=>{yx.add(e,l);let c=Cl[e];delete Cl[e];for(let d=0,u=c.length;d<u;d++){let h=c[d];h.onLoad&&h.onLoad(l)}}).catch(l=>{let c=Cl[e];if(c===void 0)throw this.manager.itemError(e),l;delete Cl[e];for(let d=0,u=c.length;d<u;d++){let h=c[d];h.onError&&h.onError(l)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}},E1e=class extends qg{constructor(e){super(e)}load(e,t,r,i){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let n=this,a=yx.get(e);if(a!==void 0)return n.manager.itemStart(e),setTimeout(function(){t&&t(a),n.manager.itemEnd(e)},0),a;let o=ng("img");function s(){c(),yx.add(e,this),t&&t(this),n.manager.itemEnd(e)}function l(d){c(),i&&i(d),n.manager.itemError(e),n.manager.itemEnd(e)}function c(){o.removeEventListener("load",s,!1),o.removeEventListener("error",l,!1)}return o.addEventListener("load",s,!1),o.addEventListener("error",l,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(o.crossOrigin=this.crossOrigin),n.manager.itemStart(e),o.src=e,o}},T1e=class extends qg{constructor(e){super(e)}load(e,t,r,i){let n=new Oi,a=new E1e(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,function(o){n.image=o,n.needsUpdate=!0,t!==void 0&&t(n)},r,i),n}},Yg=class extends Yr{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Lt(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){let t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}},P1e=class extends Yg{constructor(e,t,r){super(e,r),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Yr.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Lt(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}},cC=new it,xz=new k,wz=new k,dP=class{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new ye(512,512),this.map=null,this.mapPass=null,this.matrix=new it,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new rP,this._frameExtents=new ye(1,1),this._viewportCount=1,this._viewports=[new Kt(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){let t=this.camera,r=this.matrix;xz.setFromMatrixPosition(e.matrixWorld),t.position.copy(xz),wz.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(wz),t.updateMatrixWorld(),cC.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(cC),r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(cC)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){let e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}},D1e=class extends dP{constructor(){super(new da(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){let t=this.camera,r=ig*2*e.angle*this.focus,i=this.mapSize.width/this.mapSize.height,n=e.distance||t.far;(r!==t.fov||i!==t.aspect||n!==t.far)&&(t.fov=r,t.aspect=i,t.far=n,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}},O1e=class extends Yg{constructor(e,t,r=0,i=Math.PI/3,n=0,a=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Yr.DEFAULT_UP),this.updateMatrix(),this.target=new Yr,this.distance=r,this.angle=i,this.penumbra=n,this.decay=a,this.map=null,this.shadow=new D1e}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}},Sz=new it,Am=new k,dC=new k,R1e=class extends dP{constructor(){super(new da(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new ye(4,2),this._viewportCount=6,this._viewports=[new Kt(2,1,1,1),new Kt(0,1,1,1),new Kt(3,1,1,1),new Kt(1,1,1,1),new Kt(3,0,1,1),new Kt(1,0,1,1)],this._cubeDirections=[new k(1,0,0),new k(-1,0,0),new k(0,0,1),new k(0,0,-1),new k(0,1,0),new k(0,-1,0)],this._cubeUps=[new k(0,1,0),new k(0,1,0),new k(0,1,0),new k(0,1,0),new k(0,0,1),new k(0,0,-1)]}updateMatrices(e,t=0){let r=this.camera,i=this.matrix,n=e.distance||r.far;n!==r.far&&(r.far=n,r.updateProjectionMatrix()),Am.setFromMatrixPosition(e.matrixWorld),r.position.copy(Am),dC.copy(r.position),dC.add(this._cubeDirections[t]),r.up.copy(this._cubeUps[t]),r.lookAt(dC),r.updateMatrixWorld(),i.makeTranslation(-Am.x,-Am.y,-Am.z),Sz.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Sz)}},I1e=class extends Yg{constructor(e,t,r=0,i=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=r,this.decay=i,this.shadow=new R1e}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}},z1e=class extends dP{constructor(){super(new K1(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}},k1e=class extends Yg{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Yr.DEFAULT_UP),this.updateMatrix(),this.target=new Yr,this.shadow=new z1e}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}},Vj=class extends Ot{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){let e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}},Hj=class extends qg{constructor(e){super(e)}load(e,t,r,i){let n=this,a=new BA(n.manager);a.setPath(n.path),a.setRequestHeader(n.requestHeader),a.setWithCredentials(n.withCredentials),a.load(e,function(o){try{t(n.parse(JSON.parse(o)))}catch(s){i?i(s):console.error(s),n.manager.itemError(e)}},r,i)}parse(e){let t={},r={};function i(u,h){if(t[h]!==void 0)return t[h];let f=u.interleavedBuffers[h],p=n(u,f.buffer),v=z0(f.type,p),m=new Nxe(v,f.stride);return m.uuid=f.uuid,t[h]=m,m}function n(u,h){if(r[h]!==void 0)return r[h];let f=u.arrayBuffers[h],p=new Uint32Array(f).buffer;return r[h]=p,p}let a=e.isInstancedBufferGeometry?new Vj:new Ot,o=e.data.index;if(o!==void 0){let u=z0(o.type,o.array);a.setIndex(new $t(u,1))}let s=e.data.attributes;for(let u in s){let h=s[u],f;if(h.isInterleavedBufferAttribute){let p=i(e.data,h.data);f=new IA(p,h.itemSize,h.offset,h.normalized)}else{let p=z0(h.type,h.array),v=h.isInstancedBufferAttribute?ag:$t;f=new v(p,h.itemSize,h.normalized)}h.name!==void 0&&(f.name=h.name),h.usage!==void 0&&f.setUsage(h.usage),h.updateRange!==void 0&&(f.updateRange.offset=h.updateRange.offset,f.updateRange.count=h.updateRange.count),a.setAttribute(u,f)}let l=e.data.morphAttributes;if(l)for(let u in l){let h=l[u],f=[];for(let p=0,v=h.length;p<v;p++){let m=h[p],g;if(m.isInterleavedBufferAttribute){let y=i(e.data,m.data);g=new IA(y,m.itemSize,m.offset,m.normalized)}else{let y=z0(m.type,m.array);g=new $t(y,m.itemSize,m.normalized)}m.name!==void 0&&(g.name=m.name),f.push(g)}a.morphAttributes[u]=f}e.data.morphTargetsRelative&&(a.morphTargetsRelative=!0);let c=e.data.groups||e.data.drawcalls||e.data.offsets;if(c!==void 0)for(let u=0,h=c.length;u!==h;++u){let f=c[u];a.addGroup(f.start,f.count,f.materialIndex)}let d=e.data.boundingSphere;if(d!==void 0){let u=new k;d.center!==void 0&&u.fromArray(d.center),a.boundingSphere=new Za(u,d.radius)}return e.name&&(a.name=e.name),e.userData&&(a.userData=e.userData),a}},L1e=class{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=Cz(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){let t=Cz();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}};function Cz(){return(typeof performance>"u"?Date:performance).now()}var B1e=class{constructor(e,t,r){this.binding=e,this.valueSize=r;let i,n,a;switch(t){case"quaternion":i=this._slerp,n=this._slerpAdditive,a=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(r*6),this._workIndex=5;break;case"string":case"bool":i=this._select,n=this._select,a=this._setAdditiveIdentityOther,this.buffer=new Array(r*5);break;default:i=this._lerp,n=this._lerpAdditive,a=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(r*5)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=n,this._setIdentity=a,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){let r=this.buffer,i=this.valueSize,n=e*i+i,a=this.cumulativeWeight;if(a===0){for(let o=0;o!==i;++o)r[n+o]=r[o];a=t}else{a+=t;let o=t/a;this._mixBufferRegion(r,n,0,o,i)}this.cumulativeWeight=a}accumulateAdditive(e){let t=this.buffer,r=this.valueSize,i=r*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,i,0,e,r),this.cumulativeWeightAdditive+=e}apply(e){let t=this.valueSize,r=this.buffer,i=e*t+t,n=this.cumulativeWeight,a=this.cumulativeWeightAdditive,o=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,n<1){let s=t*this._origIndex;this._mixBufferRegion(r,i,s,1-n,t)}a>0&&this._mixBufferRegionAdditive(r,i,this._addIndex*t,1,t);for(let s=t,l=t+t;s!==l;++s)if(r[s]!==r[s+t]){o.setValue(r,i);break}}saveOriginalState(){let e=this.binding,t=this.buffer,r=this.valueSize,i=r*this._origIndex;e.getValue(t,i);for(let n=r,a=i;n!==a;++n)t[n]=t[i+n%r];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){let e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){let e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let r=e;r<t;r++)this.buffer[r]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){let e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let r=0;r<this.valueSize;r++)this.buffer[t+r]=this.buffer[e+r]}_select(e,t,r,i,n){if(i>=.5)for(let a=0;a!==n;++a)e[t+a]=e[r+a]}_slerp(e,t,r,i){Xt.slerpFlat(e,t,e,t,e,r,i)}_slerpAdditive(e,t,r,i,n){let a=this._workIndex*n;Xt.multiplyQuaternionsFlat(e,a,e,t,e,r),Xt.slerpFlat(e,t,e,t,e,a,i)}_lerp(e,t,r,i,n){let a=1-i;for(let o=0;o!==n;++o){let s=t+o;e[s]=e[s]*a+e[r+o]*i}}_lerpAdditive(e,t,r,i,n){for(let a=0;a!==n;++a){let o=t+a;e[o]=e[o]+e[r+a]*i}}},uP="\\[\\]\\.:\\/",F1e=new RegExp("["+uP+"]","g"),hP="[^"+uP+"]",N1e="[^"+uP.replace("\\.","")+"]",U1e=/((?:WC+[\/:])*)/.source.replace("WC",hP),j1e=/(WCOD+)?/.source.replace("WCOD",N1e),V1e=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",hP),H1e=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",hP),W1e=new RegExp("^"+U1e+j1e+V1e+H1e+"$"),G1e=["material","materials","bones","map"],$1e=class{constructor(e,t,r){let i=r||ni.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,i)}getValue(e,t){this.bind();let r=this._targetGroup.nCachedObjects_,i=this._bindings[r];i!==void 0&&i.getValue(e,t)}setValue(e,t){let r=this._bindings;for(let i=this._targetGroup.nCachedObjects_,n=r.length;i!==n;++i)r[i].setValue(e,t)}bind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].bind()}unbind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].unbind()}},ni=class{constructor(e,t,r){this.path=t,this.parsedPath=r||ni.parseTrackName(t),this.node=ni.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,r){return e&&e.isAnimationObjectGroup?new ni.Composite(e,t,r):new ni(e,t,r)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(F1e,"")}static parseTrackName(e){let t=W1e.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);let r={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},i=r.nodeName&&r.nodeName.lastIndexOf(".");if(i!==void 0&&i!==-1){let n=r.nodeName.substring(i+1);G1e.indexOf(n)!==-1&&(r.nodeName=r.nodeName.substring(0,i),r.objectName=n)}if(r.propertyName===null||r.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return r}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){let r=e.skeleton.getBoneByName(t);if(r!==void 0)return r}if(e.children){let r=function(n){for(let a=0;a<n.length;a++){let o=n[a];if(o.name===t||o.uuid===t)return o;let s=r(o.children);if(s)return s}return null},i=r(e.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){let r=this.resolvedProperty;for(let i=0,n=r.length;i!==n;++i)e[t++]=r[i]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){let r=this.resolvedProperty;for(let i=0,n=r.length;i!==n;++i)r[i]=e[t++]}_setValue_array_setNeedsUpdate(e,t){let r=this.resolvedProperty;for(let i=0,n=r.length;i!==n;++i)r[i]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){let r=this.resolvedProperty;for(let i=0,n=r.length;i!==n;++i)r[i]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node,t=this.parsedPath,r=t.objectName,i=t.propertyName,n=t.propertyIndex;if(e||(e=ni.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(r){let l=t.objectIndex;switch(r){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let c=0;c<e.length;c++)if(e[c].name===l){l=c;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[r]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[r]}if(l!==void 0){if(e[l]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[l]}}let a=e[i];if(a===void 0){let l=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+l+"."+i+" but it wasn't found.",e);return}let o=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?o=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(o=this.Versioning.MatrixWorldNeedsUpdate);let s=this.BindingType.Direct;if(n!==void 0){if(i==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[n]!==void 0&&(n=e.morphTargetDictionary[n])}s=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=n}else a.fromArray!==void 0&&a.toArray!==void 0?(s=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(s=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=i;this.getValue=this.GetterByBindingType[s],this.setValue=this.SetterByBindingTypeAndVersioning[s][o]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}};ni.Composite=$1e;ni.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};ni.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};ni.prototype.GetterByBindingType=[ni.prototype._getValue_direct,ni.prototype._getValue_array,ni.prototype._getValue_arrayElement,ni.prototype._getValue_toArray];ni.prototype.SetterByBindingTypeAndVersioning=[[ni.prototype._setValue_direct,ni.prototype._setValue_direct_setNeedsUpdate,ni.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[ni.prototype._setValue_array,ni.prototype._setValue_array_setNeedsUpdate,ni.prototype._setValue_array_setMatrixWorldNeedsUpdate],[ni.prototype._setValue_arrayElement,ni.prototype._setValue_arrayElement_setNeedsUpdate,ni.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[ni.prototype._setValue_fromArray,ni.prototype._setValue_fromArray_setNeedsUpdate,ni.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];var q1e=class{constructor(e,t,r=null,i=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=r,this.blendMode=i;let n=t.tracks,a=n.length,o=new Array(a),s={endingStart:Mf,endingEnd:Mf};for(let l=0;l!==a;++l){let c=n[l].createInterpolant(null);o[l]=c,c.settings=s}this._interpolantSettings=s,this._interpolants=o,this._propertyBindings=new Array(a),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=sj,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,r){if(e.fadeOut(t),this.fadeIn(t),r){let i=this._clip.duration,n=e._clip.duration,a=n/i,o=i/n;e.warp(1,a,t),this.warp(o,1,t)}return this}crossFadeTo(e,t,r){return e.crossFadeFrom(this,t,r)}stopFading(){let e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,r){let i=this._mixer,n=i.time,a=this.timeScale,o=this._timeScaleInterpolant;o===null&&(o=i._lendControlInterpolant(),this._timeScaleInterpolant=o);let s=o.parameterPositions,l=o.sampleValues;return s[0]=n,s[1]=n+r,l[0]=e/a,l[1]=t/a,this}stopWarping(){let e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,r,i){if(!this.enabled){this._updateWeight(e);return}let n=this._startTime;if(n!==null){let s=(e-n)*r;s<0||r===0?t=0:(this._startTime=null,t=r*s)}t*=this._updateTimeScale(e);let a=this._updateTime(t),o=this._updateWeight(e);if(o>0){let s=this._interpolants,l=this._propertyBindings;switch(this.blendMode){case Cve:for(let c=0,d=s.length;c!==d;++c)s[c].evaluate(a),l[c].accumulateAdditive(o);break;case ZT:default:for(let c=0,d=s.length;c!==d;++c)s[c].evaluate(a),l[c].accumulate(i,o)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;let r=this._weightInterpolant;if(r!==null){let i=r.evaluate(e)[0];t*=i,e>r.parameterPositions[1]&&(this.stopFading(),i===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;let r=this._timeScaleInterpolant;if(r!==null){let i=r.evaluate(e)[0];t*=i,e>r.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){let t=this._clip.duration,r=this.loop,i=this.time+e,n=this._loopCount,a=r===QT;if(e===0)return n===-1?i:a&&(n&1)===1?t-i:i;if(r===oj){n===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(i>=t)i=t;else if(i<0)i=0;else{this.time=i;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(n===-1&&(e>=0?(n=0,this._setEndings(!0,this.repetitions===0,a)):this._setEndings(this.repetitions===0,!0,a)),i>=t||i<0){let o=Math.floor(i/t);i-=t*o,n+=Math.abs(o);let s=this.repetitions-n;if(s<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,i=e>0?t:0,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(s===1){let l=e<0;this._setEndings(l,!l,a)}else this._setEndings(!1,!1,a);this._loopCount=n,this.time=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o})}}else this.time=i;if(a&&(n&1)===1)return t-i}return i}_setEndings(e,t,r){let i=this._interpolantSettings;r?(i.endingStart=Ef,i.endingEnd=Ef):(e?i.endingStart=this.zeroSlopeAtStart?Ef:Mf:i.endingStart=dx,t?i.endingEnd=this.zeroSlopeAtEnd?Ef:Mf:i.endingEnd=dx)}_scheduleFading(e,t,r){let i=this._mixer,n=i.time,a=this._weightInterpolant;a===null&&(a=i._lendControlInterpolant(),this._weightInterpolant=a);let o=a.parameterPositions,s=a.sampleValues;return o[0]=n,s[0]=t,o[1]=n+e,s[1]=r,this}},Y1e=new Float32Array(1),X1e=class extends aa{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){let r=e._localRoot||this._root,i=e._clip.tracks,n=i.length,a=e._propertyBindings,o=e._interpolants,s=r.uuid,l=this._bindingsByRootAndName,c=l[s];c===void 0&&(c={},l[s]=c);for(let d=0;d!==n;++d){let u=i[d],h=u.name,f=c[h];if(f!==void 0)++f.referenceCount,a[d]=f;else{if(f=a[d],f!==void 0){f._cacheIndex===null&&(++f.referenceCount,this._addInactiveBinding(f,s,h));continue}let p=t&&t._propertyBindings[d].binding.parsedPath;f=new B1e(ni.create(r,h,p),u.ValueTypeName,u.getValueSize()),++f.referenceCount,this._addInactiveBinding(f,s,h),a[d]=f}o[d].resultBuffer=f.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){let r=(e._localRoot||this._root).uuid,i=e._clip.uuid,n=this._actionsByClip[i];this._bindAction(e,n&&n.knownActions[0]),this._addInactiveAction(e,i,r)}let t=e._propertyBindings;for(let r=0,i=t.length;r!==i;++r){let n=t[r];n.useCount++===0&&(this._lendBinding(n),n.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){let t=e._propertyBindings;for(let r=0,i=t.length;r!==i;++r){let n=t[r];--n.useCount===0&&(n.restoreOriginalState(),this._takeBackBinding(n))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;let e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){let t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,r){let i=this._actions,n=this._actionsByClip,a=n[t];if(a===void 0)a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,n[t]=a;else{let o=a.knownActions;e._byClipCacheIndex=o.length,o.push(e)}e._cacheIndex=i.length,i.push(e),a.actionByRoot[r]=e}_removeInactiveAction(e){let t=this._actions,r=t[t.length-1],i=e._cacheIndex;r._cacheIndex=i,t[i]=r,t.pop(),e._cacheIndex=null;let n=e._clip.uuid,a=this._actionsByClip,o=a[n],s=o.knownActions,l=s[s.length-1],c=e._byClipCacheIndex;l._byClipCacheIndex=c,s[c]=l,s.pop(),e._byClipCacheIndex=null;let d=o.actionByRoot,u=(e._localRoot||this._root).uuid;delete d[u],s.length===0&&delete a[n],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){let t=e._propertyBindings;for(let r=0,i=t.length;r!==i;++r){let n=t[r];--n.referenceCount===0&&this._removeInactiveBinding(n)}}_lendAction(e){let t=this._actions,r=e._cacheIndex,i=this._nActiveActions++,n=t[i];e._cacheIndex=i,t[i]=e,n._cacheIndex=r,t[r]=n}_takeBackAction(e){let t=this._actions,r=e._cacheIndex,i=--this._nActiveActions,n=t[i];e._cacheIndex=i,t[i]=e,n._cacheIndex=r,t[r]=n}_addInactiveBinding(e,t,r){let i=this._bindingsByRootAndName,n=this._bindings,a=i[t];a===void 0&&(a={},i[t]=a),a[r]=e,e._cacheIndex=n.length,n.push(e)}_removeInactiveBinding(e){let t=this._bindings,r=e.binding,i=r.rootNode.uuid,n=r.path,a=this._bindingsByRootAndName,o=a[i],s=t[t.length-1],l=e._cacheIndex;s._cacheIndex=l,t[l]=s,t.pop(),delete o[n],Object.keys(o).length===0&&delete a[i]}_lendBinding(e){let t=this._bindings,r=e._cacheIndex,i=this._nActiveBindings++,n=t[i];e._cacheIndex=i,t[i]=e,n._cacheIndex=r,t[r]=n}_takeBackBinding(e){let t=this._bindings,r=e._cacheIndex,i=--this._nActiveBindings,n=t[i];e._cacheIndex=i,t[i]=e,n._cacheIndex=r,t[r]=n}_lendControlInterpolant(){let e=this._controlInterpolants,t=this._nActiveControlInterpolants++,r=e[t];return r===void 0&&(r=new Nj(new Float32Array(2),new Float32Array(2),1,Y1e),r.__cacheIndex=t,e[t]=r),r}_takeBackControlInterpolant(e){let t=this._controlInterpolants,r=e.__cacheIndex,i=--this._nActiveControlInterpolants,n=t[i];e.__cacheIndex=i,t[i]=e,n.__cacheIndex=r,t[r]=n}clipAction(e,t,r){let i=t||this._root,n=i.uuid,a=typeof e=="string"?LA.findByName(i,e):e,o=a!==null?a.uuid:e,s=this._actionsByClip[o],l=null;if(r===void 0&&(a!==null?r=a.blendMode:r=ZT),s!==void 0){let d=s.actionByRoot[n];if(d!==void 0&&d.blendMode===r)return d;l=s.knownActions[0],a===null&&(a=l._clip)}if(a===null)return null;let c=new q1e(this,a,t,r);return this._bindAction(c,l),this._addInactiveAction(c,o,n),c}existingAction(e,t){let r=t||this._root,i=r.uuid,n=typeof e=="string"?LA.findByName(r,e):e,a=n?n.uuid:e,o=this._actionsByClip[a];return o!==void 0&&o.actionByRoot[i]||null}stopAllAction(){let e=this._actions,t=this._nActiveActions;for(let r=t-1;r>=0;--r)e[r].stop();return this}update(e){e*=this.timeScale;let t=this._actions,r=this._nActiveActions,i=this.time+=e,n=Math.sign(e),a=this._accuIndex^=1;for(let l=0;l!==r;++l)t[l]._update(i,e,n,a);let o=this._bindings,s=this._nActiveBindings;for(let l=0;l!==s;++l)o[l].apply(a);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){let t=this._actions,r=e.uuid,i=this._actionsByClip,n=i[r];if(n!==void 0){let a=n.knownActions;for(let o=0,s=a.length;o!==s;++o){let l=a[o];this._deactivateAction(l);let c=l._cacheIndex,d=t[t.length-1];l._cacheIndex=null,l._byClipCacheIndex=null,d._cacheIndex=c,t[c]=d,t.pop(),this._removeInactiveBindingsForAction(l)}delete i[r]}}uncacheRoot(e){let t=e.uuid,r=this._actionsByClip;for(let a in r){let o=r[a].actionByRoot,s=o[t];s!==void 0&&(this._deactivateAction(s),this._removeInactiveAction(s))}let i=this._bindingsByRootAndName,n=i[t];if(n!==void 0)for(let a in n){let o=n[a];o.restoreOriginalState(),this._removeInactiveBinding(o)}}uncacheAction(e,t){let r=this.existingAction(e,t);r!==null&&(this._deactivateAction(r),this._removeInactiveAction(r))}},rt=class{constructor(e){this.value=e}clone(){return new rt(this.value.clone===void 0?this.value:this.value.clone())}},Wj=class{constructor(e,t,r=0,i=1/0){this.ray=new jp(e,t),this.near=r,this.far=i,this.camera=null,this.layers=new eP,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,r=[]){return FA(e,this,r,t),r.sort(_z),r}intersectObjects(e,t=!0,r=[]){for(let i=0,n=e.length;i<n;i++)FA(e[i],this,r,t);return r.sort(_z),r}};function _z(e,t){return e.distance-t.distance}function FA(e,t,r,i){if(e.layers.test(t.layers)&&e.raycast(t,r),i===!0){let n=e.children;for(let a=0,o=n.length;a<o;a++)FA(n[a],t,r,!0)}}var Az=class{constructor(e=1,t=0,r=0){return this.radius=e,this.phi=t,this.theta=r,this}set(e,t,r){return this.radius=e,this.phi=t,this.theta=r,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,r){return this.radius=Math.sqrt(e*e+t*t+r*r),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,r),this.phi=Math.acos(nn(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}},Mz=new ye,Gj=class{constructor(e=new ye(1/0,1/0),t=new ye(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let r=Mz.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return Mz.copy(e).clamp(this.min,this.max).sub(e).length()}intersect(e){return this.min.max(e.min),this.max.min(e.max),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}},Ez=new k,ay=new k,zo=class{constructor(e=new k,t=new k){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){Ez.subVectors(e,this.start),ay.subVectors(this.end,this.start);let r=ay.dot(ay),i=ay.dot(Ez)/r;return t&&(i=nn(i,0,1)),i}closestPointToPoint(e,t,r){let i=this.closestPointToPointParameter(e,t);return this.delta(r).multiplyScalar(i).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}},Tz=new k,K1e=class extends Yr{constructor(e,t){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";let r=new Ot,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let a=0,o=1,s=32;a<s;a++,o++){let l=a/s*Math.PI*2,c=o/s*Math.PI*2;i.push(Math.cos(l),Math.sin(l),1,Math.cos(c),Math.sin(c),1)}r.setAttribute("position",new yt(i,3));let n=new Ud({fog:!1,toneMapped:!1});this.cone=new Gg(r,n),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);let e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),Tz.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(Tz),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}},Q1e=class extends Di{constructor(e,t,r){let i=new Hf(t,4,2),n=new tc({wireframe:!0,fog:!1,toneMapped:!1});super(i,n),this.light=e,this.color=r,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}},Pz=new k,oy=new k,Dz=new k,Z1e=class extends Yr{constructor(e,t,r){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,this.type="DirectionalLightHelper",t===void 0&&(t=1);let i=new Ot;i.setAttribute("position",new yt([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));let n=new Ud({fog:!1,toneMapped:!1});this.lightPlane=new fx(i,n),this.add(this.lightPlane),i=new Ot,i.setAttribute("position",new yt([0,0,0,0,0,1],3)),this.targetLine=new fx(i,n),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),Pz.setFromMatrixPosition(this.light.matrixWorld),oy.setFromMatrixPosition(this.light.target.matrixWorld),Dz.subVectors(oy,Pz),this.lightPlane.lookAt(oy),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(oy),this.targetLine.scale.z=Dz.length()}},sy=new k,Ii=new xh,bx=class extends Gg{constructor(e){let t=new Ot,r=new Ud({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],n=[],a={};o("n1","n2"),o("n2","n4"),o("n4","n3"),o("n3","n1"),o("f1","f2"),o("f2","f4"),o("f4","f3"),o("f3","f1"),o("n1","f1"),o("n2","f2"),o("n3","f3"),o("n4","f4"),o("p","n1"),o("p","n2"),o("p","n3"),o("p","n4"),o("u1","u2"),o("u2","u3"),o("u3","u1"),o("c","t"),o("p","c"),o("cn1","cn2"),o("cn3","cn4"),o("cf1","cf2"),o("cf3","cf4");function o(f,p){s(f),s(p)}function s(f){i.push(0,0,0),n.push(0,0,0),a[f]===void 0&&(a[f]=[]),a[f].push(i.length/3-1)}t.setAttribute("position",new yt(i,3)),t.setAttribute("color",new yt(n,3)),super(t,r),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update();let l=new Lt(16755200),c=new Lt(16711680),d=new Lt(43775),u=new Lt(16777215),h=new Lt(3355443);this.setColors(l,c,d,u,h)}setColors(e,t,r,i,n){let a=this.geometry.getAttribute("color");a.setXYZ(0,e.r,e.g,e.b),a.setXYZ(1,e.r,e.g,e.b),a.setXYZ(2,e.r,e.g,e.b),a.setXYZ(3,e.r,e.g,e.b),a.setXYZ(4,e.r,e.g,e.b),a.setXYZ(5,e.r,e.g,e.b),a.setXYZ(6,e.r,e.g,e.b),a.setXYZ(7,e.r,e.g,e.b),a.setXYZ(8,e.r,e.g,e.b),a.setXYZ(9,e.r,e.g,e.b),a.setXYZ(10,e.r,e.g,e.b),a.setXYZ(11,e.r,e.g,e.b),a.setXYZ(12,e.r,e.g,e.b),a.setXYZ(13,e.r,e.g,e.b),a.setXYZ(14,e.r,e.g,e.b),a.setXYZ(15,e.r,e.g,e.b),a.setXYZ(16,e.r,e.g,e.b),a.setXYZ(17,e.r,e.g,e.b),a.setXYZ(18,e.r,e.g,e.b),a.setXYZ(19,e.r,e.g,e.b),a.setXYZ(20,e.r,e.g,e.b),a.setXYZ(21,e.r,e.g,e.b),a.setXYZ(22,e.r,e.g,e.b),a.setXYZ(23,e.r,e.g,e.b),a.setXYZ(24,t.r,t.g,t.b),a.setXYZ(25,t.r,t.g,t.b),a.setXYZ(26,t.r,t.g,t.b),a.setXYZ(27,t.r,t.g,t.b),a.setXYZ(28,t.r,t.g,t.b),a.setXYZ(29,t.r,t.g,t.b),a.setXYZ(30,t.r,t.g,t.b),a.setXYZ(31,t.r,t.g,t.b),a.setXYZ(32,r.r,r.g,r.b),a.setXYZ(33,r.r,r.g,r.b),a.setXYZ(34,r.r,r.g,r.b),a.setXYZ(35,r.r,r.g,r.b),a.setXYZ(36,r.r,r.g,r.b),a.setXYZ(37,r.r,r.g,r.b),a.setXYZ(38,i.r,i.g,i.b),a.setXYZ(39,i.r,i.g,i.b),a.setXYZ(40,n.r,n.g,n.b),a.setXYZ(41,n.r,n.g,n.b),a.setXYZ(42,n.r,n.g,n.b),a.setXYZ(43,n.r,n.g,n.b),a.setXYZ(44,n.r,n.g,n.b),a.setXYZ(45,n.r,n.g,n.b),a.setXYZ(46,n.r,n.g,n.b),a.setXYZ(47,n.r,n.g,n.b),a.setXYZ(48,n.r,n.g,n.b),a.setXYZ(49,n.r,n.g,n.b),a.needsUpdate=!0}update(){let e=this.geometry,t=this.pointMap,r=1,i=1;Ii.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),ji("c",t,e,Ii,0,0,-1),ji("t",t,e,Ii,0,0,1),ji("n1",t,e,Ii,-r,-i,-1),ji("n2",t,e,Ii,r,-i,-1),ji("n3",t,e,Ii,-r,i,-1),ji("n4",t,e,Ii,r,i,-1),ji("f1",t,e,Ii,-r,-i,1),ji("f2",t,e,Ii,r,-i,1),ji("f3",t,e,Ii,-r,i,1),ji("f4",t,e,Ii,r,i,1),ji("u1",t,e,Ii,r*.7,i*1.1,-1),ji("u2",t,e,Ii,-r*.7,i*1.1,-1),ji("u3",t,e,Ii,0,i*2,-1),ji("cf1",t,e,Ii,-r,0,1),ji("cf2",t,e,Ii,r,0,1),ji("cf3",t,e,Ii,0,-i,1),ji("cf4",t,e,Ii,0,i,1),ji("cn1",t,e,Ii,-r,0,-1),ji("cn2",t,e,Ii,r,0,-1),ji("cn3",t,e,Ii,0,-i,-1),ji("cn4",t,e,Ii,0,i,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}};function ji(e,t,r,i,n,a,o){sy.set(n,a,o).unproject(i);let s=t[e];if(s!==void 0){let l=r.getAttribute("position");for(let c=0,d=s.length;c<d;c++)l.setXYZ(s[c],sy.x,sy.y,sy.z)}}var xx=class extends Gg{constructor(e,t=16776960){let r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],n=new Ot;n.setIndex(new $t(r,1)),n.setAttribute("position",new yt(i,3)),super(n,new Ud({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){let t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}},J1e=class extends Gg{constructor(e=1){let t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],r=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],i=new Ot;i.setAttribute("position",new yt(t,3)),i.setAttribute("color",new yt(r,3));let n=new Ud({vertexColors:!0,toneMapped:!1});super(i,n),this.type="AxesHelper"}setColors(e,t,r){let i=new Lt,n=this.geometry.attributes.color.array;return i.set(e),i.toArray(n,0),i.toArray(n,3),i.set(t),i.toArray(n,6),i.toArray(n,9),i.set(r),i.toArray(n,12),i.toArray(n,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}},jl=ewe();function ewe(){let e=new ArrayBuffer(4),t=new Float32Array(e),r=new Uint32Array(e),i=new Uint32Array(512),n=new Uint32Array(512);for(let l=0;l<256;++l){let c=l-127;c<-27?(i[l]=0,i[l|256]=32768,n[l]=24,n[l|256]=24):c<-14?(i[l]=1024>>-c-14,i[l|256]=1024>>-c-14|32768,n[l]=-c-1,n[l|256]=-c-1):c<=15?(i[l]=c+15<<10,i[l|256]=c+15<<10|32768,n[l]=13,n[l|256]=13):c<128?(i[l]=31744,i[l|256]=64512,n[l]=24,n[l|256]=24):(i[l]=31744,i[l|256]=64512,n[l]=13,n[l|256]=13)}let a=new Uint32Array(2048),o=new Uint32Array(64),s=new Uint32Array(64);for(let l=1;l<1024;++l){let c=l<<13,d=0;for(;!(c&8388608);)c<<=1,d-=8388608;c&=-8388609,d+=947912704,a[l]=c|d}for(let l=1024;l<2048;++l)a[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)o[l]=l<<23;o[31]=1199570944,o[32]=2147483648;for(let l=33;l<63;++l)o[l]=2147483648+(l-32<<23);o[63]=3347054592;for(let l=1;l<64;++l)l!==32&&(s[l]=1024);return{floatView:t,uint32View:r,baseTable:i,shiftTable:n,mantissaTable:a,exponentTable:o,offsetTable:s}}function twe(e){Math.abs(e)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),e=nn(e,-65504,65504),jl.floatView[0]=e;let t=jl.uint32View[0],r=t>>23&511;return jl.baseTable[r]+((t&8388607)>>jl.shiftTable[r])}function rwe(e){let t=e>>10;return jl.uint32View[0]=jl.mantissaTable[jl.offsetTable[t]+(e&1023)]+jl.exponentTable[t],jl.floatView[0]}var iwe=Object.freeze({__proto__:null,fromHalfFloat:rwe,toHalfFloat:twe});typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:Up}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=Up);var Mm=".",fP=Symbol("target"),$j=Symbol("unsubscribe");function NA(e){return e instanceof Date||e instanceof Set||e instanceof Map||e instanceof WeakSet||e instanceof WeakMap||ArrayBuffer.isView(e)}function nwe(e){return(typeof e=="object"?e===null:typeof e!="function")||e instanceof RegExp}var Hs=Array.isArray;function pP(e){return typeof e=="symbol"}var awe={after:(e,t)=>Hs(e)?e.slice(t.length):t===""?e:e.slice(t.length+1),concat:(e,t)=>Hs(e)?(e=[...e],t&&e.push(t),e):t&&t.toString!==void 0?(e!==""&&(e+=Mm),pP(t)?e+t.toString():e+t):e,initial:e=>{if(Hs(e))return e.slice(0,-1);if(e==="")return e;let t=e.lastIndexOf(Mm);return t===-1?"":e.slice(0,t)},last:e=>{if(Hs(e))return e[e.length-1]||"";if(e==="")return e;let t=e.lastIndexOf(Mm);return t===-1?e:e.slice(t+1)},walk:(e,t)=>{if(Hs(e))for(let r of e)t(r);else if(e!==""){let r=0,i=e.indexOf(Mm);if(i===-1)t(e);else for(;r<e.length;)i===-1&&(i=e.length),t(e.slice(r,i)),r=i+1,i=e.indexOf(Mm,r)}},get(e,t){return this.walk(t,r=>{e&&(e=e[r])}),e}},So=awe;function owe(e){return typeof e=="object"&&typeof e.next=="function"}function swe(e,t,r,i,n){let a=e.next;if(t.name==="entries")e.next=function(){let o=a.call(this);return o.done===!1&&(o.value[0]=n(o.value[0],t,o.value[0],i),o.value[1]=n(o.value[1],t,o.value[0],i)),o};else if(t.name==="values"){let o=r[fP].keys();e.next=function(){let s=a.call(this);return s.done===!1&&(s.value=n(s.value,t,o.next().value,i)),s}}else e.next=function(){let o=a.call(this);return o.done===!1&&(o.value=n(o.value,t,o.value,i)),o};return e}function Oz(e,t,r){return e.isUnsubscribed||t.ignoreSymbols&&pP(r)||t.ignoreUnderscores&&r.charAt(0)==="_"||"ignoreKeys"in t&&t.ignoreKeys.includes(r)}var lwe=class{constructor(e){this._equals=e,this._proxyCache=new WeakMap,this._pathCache=new WeakMap,this.isUnsubscribed=!1}_getDescriptorCache(){return this._descriptorCache===void 0&&(this._descriptorCache=new WeakMap),this._descriptorCache}_getProperties(e){let t=this._getDescriptorCache(),r=t.get(e);return r===void 0&&(r={},t.set(e,r)),r}_getOwnPropertyDescriptor(e,t){if(this.isUnsubscribed)return Reflect.getOwnPropertyDescriptor(e,t);let r=this._getProperties(e),i=r[t];return i===void 0&&(i=Reflect.getOwnPropertyDescriptor(e,t),r[t]=i),i}getProxy(e,t,r,i){if(this.isUnsubscribed)return e;let n=e[i],a=n||e;this._pathCache.set(a,t);let o=this._proxyCache.get(a);return o===void 0&&(o=n===void 0?new Proxy(e,r):e,this._proxyCache.set(a,o)),o}getPath(e){return this.isUnsubscribed?void 0:this._pathCache.get(e)}isDetached(e,t){return!Object.is(e,So.get(t,this.getPath(e)))}defineProperty(e,t,r){return Reflect.defineProperty(e,t,r)?(this.isUnsubscribed||(this._getProperties(e)[t]=r),!0):!1}setProperty(e,t,r,i,n){if(!this._equals(n,r)||!(t in e)){let a=this._getOwnPropertyDescriptor(e,t);return a!==void 0&&"set"in a?Reflect.set(e,t,r,i):Reflect.set(e,t,r)}return!0}deleteProperty(e,t,r){if(Reflect.deleteProperty(e,t)){if(!this.isUnsubscribed){let i=this._getDescriptorCache().get(e);i&&(delete i[t],this._pathCache.delete(r))}return!0}return!1}isSameDescriptor(e,t,r){let i=this._getOwnPropertyDescriptor(t,r);return e!==void 0&&i!==void 0&&Object.is(e.value,i.value)&&(e.writable||!1)===(i.writable||!1)&&(e.enumerable||!1)===(i.enumerable||!1)&&(e.configurable||!1)===(i.configurable||!1)&&e.get===i.get&&e.set===i.set}isGetInvariant(e,t){let r=this._getOwnPropertyDescriptor(e,t);return r!==void 0&&r.configurable!==!0&&r.writable!==!0}unsubscribe(){this._descriptorCache=null,this._pathCache=null,this._proxyCache=null,this.isUnsubscribed=!0}};function UA(e){return toString.call(e)==="[object Object]"}function ly(){return!0}function Zh(e,t){return e.length!==t.length||e.some((r,i)=>t[i]!==r)}var qj=new Set(["hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),cwe=new Set(["concat","includes","indexOf","join","keys","lastIndexOf"]),Yj={push:ly,pop:ly,shift:ly,unshift:ly,copyWithin:Zh,reverse:Zh,sort:Zh,splice:Zh,flat:Zh,fill:Zh},dwe=new Set([...qj,...cwe,...Object.keys(Yj)]);function cy(e,t){if(e.size!==t.size)return!0;for(let r of e)if(!t.has(r))return!0;return!1}var Xj=["keys","values","entries"],Kj=new Set(["has","toString"]),Qj={add:cy,clear:cy,delete:cy,forEach:cy},uwe=new Set([...Kj,...Object.keys(Qj),...Xj]);function dy(e,t){if(e.size!==t.size)return!0;let r;for(let[i,n]of e)if(r=t.get(i),r!==n||r===void 0&&!t.has(i))return!0;return!1}var hwe=new Set([...Kj,"get"]),Zj={set:dy,clear:dy,delete:dy,forEach:dy},fwe=new Set([...hwe,...Object.keys(Zj),...Xj]),_d=class{constructor(e,t,r,i){this._path=t,this._isChanged=!1,this._clonedCache=new Set,this._hasOnValidate=i,this._changes=i?[]:null,this.clone=t===void 0?e:this._shallowClone(e)}static isHandledMethod(e){return qj.has(e)}_shallowClone(e){let t=e;if(UA(e))t={...e};else if(Hs(e))t=[...e];else if(e instanceof Date)t=new Date(e);else if(e instanceof Set)t=new Set([...e].map(r=>this._shallowClone(r)));else if(e instanceof Map){t=new Map;for(let[r,i]of e.entries())t.set(r,this._shallowClone(i))}return this._clonedCache.add(t),t}preferredThisArg(e,t,r,i){return e?(Hs(i)?this._onIsChanged=Yj[t]:i instanceof Set?this._onIsChanged=Qj[t]:i instanceof Map&&(this._onIsChanged=Zj[t]),i):r}update(e,t,r){let i=So.after(e,this._path);if(t!=="length"){let n=this.clone;So.walk(i,a=>{n&&n[a]&&(this._clonedCache.has(n[a])||(n[a]=this._shallowClone(n[a])),n=n[a])}),this._hasOnValidate&&this._changes.push({path:i,property:t,previous:r}),n&&n[t]&&(n[t]=r)}this._isChanged=!0}undo(e){let t;for(let r=this._changes.length-1;r!==-1;r--)t=this._changes[r],So.get(e,t.path)[t.property]=t.previous}isChanged(e){return this._onIsChanged===void 0?this._isChanged:this._onIsChanged(this.clone,e)}},Rz=class extends _d{static isHandledMethod(e){return dwe.has(e)}},pwe=class extends _d{undo(e){e.setTime(this.clone.getTime())}isChanged(e,t){return!t(this.clone.valueOf(),e.valueOf())}},Iz=class extends _d{static isHandledMethod(e){return uwe.has(e)}undo(e){for(let t of this.clone)e.add(t);for(let t of e)this.clone.has(t)||e.delete(t)}},zz=class extends _d{static isHandledMethod(e){return fwe.has(e)}undo(e){for(let[t,r]of this.clone.entries())e.set(t,r);for(let t of e.keys())this.clone.has(t)||e.delete(t)}},mwe=class extends _d{constructor(e,t,r,i){super(void 0,t,r,i),this._arg1=r[0],this._weakValue=e.has(this._arg1)}isChanged(e){return this._weakValue!==e.has(this._arg1)}undo(e){this._weakValue&&!e.has(this._arg1)?e.add(this._arg1):e.delete(this._arg1)}},vwe=class extends _d{constructor(e,t,r,i){super(void 0,t,r,i),this._weakKey=r[0],this._weakHas=e.has(this._weakKey),this._weakValue=e.get(this._weakKey)}isChanged(e){return this._weakValue!==e.get(this._weakKey)}undo(e){let t=e.has(this._weakKey);this._weakHas&&!t?e.set(this._weakKey,this._weakValue):!this._weakHas&&t?e.delete(this._weakKey):this._weakValue!==e.get(this._weakKey)&&e.set(this._weakKey,this._weakValue)}},bf=class{constructor(e){this._stack=[],this._hasOnValidate=e}static isHandledType(e){return UA(e)||Hs(e)||NA(e)}static isHandledMethod(e,t){return UA(e)?_d.isHandledMethod(t):Hs(e)?Rz.isHandledMethod(t):e instanceof Set?Iz.isHandledMethod(t):e instanceof Map?zz.isHandledMethod(t):NA(e)}get isCloning(){return this._stack.length>0}start(e,t,r){let i=_d;Hs(e)?i=Rz:e instanceof Date?i=pwe:e instanceof Set?i=Iz:e instanceof Map?i=zz:e instanceof WeakSet?i=mwe:e instanceof WeakMap&&(i=vwe),this._stack.push(new i(e,t,r,this._hasOnValidate))}update(e,t,r){this._stack[this._stack.length-1].update(e,t,r)}preferredThisArg(e,t,r){let{name:i}=e,n=bf.isHandledMethod(r,i);return this._stack[this._stack.length-1].preferredThisArg(n,i,t,r)}isChanged(e,t,r){return this._stack[this._stack.length-1].isChanged(e,t,r)}undo(e){this._previousClone!==void 0&&this._previousClone.undo(e)}stop(){return this._previousClone=this._stack.pop(),this._previousClone.clone}},gwe={equals:Object.is,isShallow:!1,pathAsArray:!1,ignoreSymbols:!1,ignoreUnderscores:!1,ignoreDetached:!1,details:!1},mP=(e,t,r={})=>{r={...gwe,...r};let i=Symbol("ProxyTarget"),{equals:n,isShallow:a,ignoreDetached:o,details:s}=r,l=new lwe(n),c=typeof r.onValidate=="function",d=new bf(c),u=(y,b,x,S,w)=>!c||d.isCloning||r.onValidate(So.concat(l.getPath(y),b),x,S,w)===!0,h=(y,b,x,S)=>{!Oz(l,r,b)&&!(o&&l.isDetached(y,e))&&f(l.getPath(y),b,x,S)},f=(y,b,x,S,w)=>{d.isCloning?d.update(y,b,S):t(So.concat(y,b),x,S,w)},p=y=>y&&(y[i]||y),v=(y,b,x,S)=>nwe(y)||x==="constructor"||a&&!bf.isHandledMethod(b,x)||Oz(l,r,x)||l.isGetInvariant(b,x)||o&&l.isDetached(b,e)?y:(S===void 0&&(S=l.getPath(b)),l.getProxy(y,So.concat(S,x),m,i)),m={get(y,b,x){if(pP(b)){if(b===i||b===fP)return y;if(b===$j&&!l.isUnsubscribed&&l.getPath(y).length===0)return l.unsubscribe(),y}let S=NA(y)?Reflect.get(y,b):Reflect.get(y,b,x);return v(S,y,b)},set(y,b,x,S){x=p(x);let w=y[i]||y,_=w[b];if(n(_,x)&&b in y)return!0;let C=u(y,b,x,_);return C&&l.setProperty(w,b,x,S,_)?(h(y,b,y[b],_),!0):!C},defineProperty(y,b,x){if(!l.isSameDescriptor(x,y,b)){let S=y[b];u(y,b,x.value,S)&&l.defineProperty(y,b,x,S)&&h(y,b,x.value,S)}return!0},deleteProperty(y,b){if(!Reflect.has(y,b))return!0;let x=Reflect.get(y,b),S=u(y,b,void 0,x);return S&&l.deleteProperty(y,b,x)?(h(y,b,void 0,x),!0):!S},apply(y,b,x){let S=b[i]||b;if(l.isUnsubscribed)return Reflect.apply(y,S,x);if((s===!1||s!==!0&&!s.includes(y.name))&&bf.isHandledType(S)){let w=So.initial(l.getPath(y)),_=bf.isHandledMethod(S,y.name);d.start(S,w,x);let C=Reflect.apply(y,d.preferredThisArg(y,b,S),_?x.map(P=>p(P)):x),A=d.isChanged(S,n),M=d.stop();if(bf.isHandledType(C)&&_&&(b instanceof Map&&y.name==="get"&&(w=So.concat(w,x[0])),C=l.getProxy(C,w,m)),A){let P={name:y.name,args:x,result:C},T=d.isCloning?So.initial(w):w,R=d.isCloning?So.last(w):"";u(So.get(e,T),R,S,M,P)?f(T,R,S,M,P):d.undo(S)}return(b instanceof Map||b instanceof Set)&&owe(C)?swe(C,y,b,w,v):C}return Reflect.apply(y,b,x)}},g=l.getProxy(e,r.pathAsArray?[]:"",m);return t=t.bind(g),c&&(r.onValidate=r.onValidate.bind(g)),g};mP.target=e=>e&&e[fP]||e;mP.unsubscribe=e=>e[$j]||e;var kz=mP,ywe=typeof global=="object"&&global&&global.Object===Object&&global,Jj=ywe,bwe=typeof self=="object"&&self&&self.Object===Object&&self,xwe=Jj||bwe||Function("return this")(),ys=xwe,wwe=ys.Symbol,Fo=wwe,eV=Object.prototype,Swe=eV.hasOwnProperty,Cwe=eV.toString,Em=Fo?Fo.toStringTag:void 0;function _we(e){var t=Swe.call(e,Em),r=e[Em];try{e[Em]=void 0;var i=!0}catch{}var n=Cwe.call(e);return i&&(t?e[Em]=r:delete e[Em]),n}var Awe=_we,Mwe=Object.prototype,Ewe=Mwe.toString;function Twe(e){return Ewe.call(e)}var Pwe=Twe,Dwe="[object Null]",Owe="[object Undefined]",Lz=Fo?Fo.toStringTag:void 0;function Rwe(e){return e==null?e===void 0?Owe:Dwe:Lz&&Lz in Object(e)?Awe(e):Pwe(e)}var wh=Rwe;function Iwe(e){return e!=null&&typeof e=="object"}var ic=Iwe,zwe="[object Symbol]";function kwe(e){return typeof e=="symbol"||ic(e)&&wh(e)==zwe}var Xg=kwe;function Lwe(e,t){for(var r=-1,i=e==null?0:e.length,n=Array(i);++r<i;)n[r]=t(e[r],r,e);return n}var tV=Lwe,Bwe=Array.isArray,ol=Bwe,Fwe=1/0,Bz=Fo?Fo.prototype:void 0,Fz=Bz?Bz.toString:void 0;function rV(e){if(typeof e=="string")return e;if(ol(e))return tV(e,rV)+"";if(Xg(e))return Fz?Fz.call(e):"";var t=e+"";return t=="0"&&1/e==-Fwe?"-0":t}var Nwe=rV,Uwe=/\s/;function jwe(e){for(var t=e.length;t--&&Uwe.test(e.charAt(t)););return t}var Vwe=jwe,Hwe=/^\s+/;function Wwe(e){return e&&e.slice(0,Vwe(e)+1).replace(Hwe,"")}var Gwe=Wwe;function $we(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var ps=$we,Nz=NaN,qwe=/^[-+]0x[0-9a-f]+$/i,Ywe=/^0b[01]+$/i,Xwe=/^0o[0-7]+$/i,Kwe=parseInt;function Qwe(e){if(typeof e=="number")return e;if(Xg(e))return Nz;if(ps(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=ps(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=Gwe(e);var r=Ywe.test(e);return r||Xwe.test(e)?Kwe(e.slice(2),r?2:8):qwe.test(e)?Nz:+e}var Uz=Qwe;function Zwe(e){return e}var iV=Zwe,Jwe="[object AsyncFunction]",eSe="[object Function]",tSe="[object GeneratorFunction]",rSe="[object Proxy]";function iSe(e){if(!ps(e))return!1;var t=wh(e);return t==eSe||t==tSe||t==Jwe||t==rSe}var nV=iSe,nSe=ys["__core-js_shared__"],uC=nSe,jz=function(){var e=/[^.]+$/.exec(uC&&uC.keys&&uC.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function aSe(e){return!!jz&&jz in e}var oSe=aSe,sSe=Function.prototype,lSe=sSe.toString;function cSe(e){if(e!=null){try{return lSe.call(e)}catch{}try{return e+""}catch{}}return""}var Sh=cSe,dSe=/[\\^$.*+?()[\]{}|]/g,uSe=/^\[object .+?Constructor\]$/,hSe=Function.prototype,fSe=Object.prototype,pSe=hSe.toString,mSe=fSe.hasOwnProperty,vSe=RegExp("^"+pSe.call(mSe).replace(dSe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function gSe(e){if(!ps(e)||oSe(e))return!1;var t=nV(e)?vSe:uSe;return t.test(Sh(e))}var ySe=gSe;function bSe(e,t){return e==null?void 0:e[t]}var xSe=bSe;function wSe(e,t){var r=xSe(e,t);return ySe(r)?r:void 0}var Ch=wSe,SSe=Ch(ys,"WeakMap"),jA=SSe,Vz=Object.create,CSe=function(){function e(){}return function(t){if(!ps(t))return{};if(Vz)return Vz(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}(),_Se=CSe;function ASe(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var MSe=ASe;function ESe(e,t){var r=-1,i=e.length;for(t||(t=Array(i));++r<i;)t[r]=e[r];return t}var TSe=ESe,PSe=800,DSe=16,OSe=Date.now;function RSe(e){var t=0,r=0;return function(){var i=OSe(),n=DSe-(i-r);if(r=i,n>0){if(++t>=PSe)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var ISe=RSe;function zSe(e){return function(){return e}}var kSe=zSe,LSe=function(){try{var e=Ch(Object,"defineProperty");return e({},"",{}),e}catch{}}(),wx=LSe,BSe=wx?function(e,t){return wx(e,"toString",{configurable:!0,enumerable:!1,value:kSe(t),writable:!0})}:iV,FSe=BSe,NSe=ISe(FSe),USe=NSe;function jSe(e,t){for(var r=-1,i=e==null?0:e.length;++r<i&&t(e[r],r,e)!==!1;);return e}var VSe=jSe,HSe=9007199254740991,WSe=/^(?:0|[1-9]\d*)$/;function GSe(e,t){var r=typeof e;return t=t??HSe,!!t&&(r=="number"||r!="symbol"&&WSe.test(e))&&e>-1&&e%1==0&&e<t}var vP=GSe;function $Se(e,t,r){t=="__proto__"&&wx?wx(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var aV=$Se;function qSe(e,t){return e===t||e!==e&&t!==t}var gP=qSe,YSe=Object.prototype,XSe=YSe.hasOwnProperty;function KSe(e,t,r){var i=e[t];(!(XSe.call(e,t)&&gP(i,r))||r===void 0&&!(t in e))&&aV(e,t,r)}var yP=KSe;function QSe(e,t,r,i){var n=!r;r||(r={});for(var a=-1,o=t.length;++a<o;){var s=t[a],l=i?i(r[s],e[s],s,r,e):void 0;l===void 0&&(l=e[s]),n?aV(r,s,l):yP(r,s,l)}return r}var Kg=QSe,Hz=Math.max;function ZSe(e,t,r){return t=Hz(t===void 0?e.length-1:t,0),function(){for(var i=arguments,n=-1,a=Hz(i.length-t,0),o=Array(a);++n<a;)o[n]=i[t+n];n=-1;for(var s=Array(t+1);++n<t;)s[n]=i[n];return s[t]=r(o),MSe(e,this,s)}}var JSe=ZSe,eCe=9007199254740991;function tCe(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=eCe}var bP=tCe;function rCe(e){return e!=null&&bP(e.length)&&!nV(e)}var oV=rCe,iCe=Object.prototype;function nCe(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||iCe;return e===r}var xP=nCe;function aCe(e,t){for(var r=-1,i=Array(e);++r<e;)i[r]=t(r);return i}var oCe=aCe,sCe="[object Arguments]";function lCe(e){return ic(e)&&wh(e)==sCe}var Wz=lCe,sV=Object.prototype,cCe=sV.hasOwnProperty,dCe=sV.propertyIsEnumerable,uCe=Wz(function(){return arguments}())?Wz:function(e){return ic(e)&&cCe.call(e,"callee")&&!dCe.call(e,"callee")},wP=uCe;function hCe(){return!1}var fCe=hCe,lV=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Gz=lV&&typeof module=="object"&&module&&!module.nodeType&&module,pCe=Gz&&Gz.exports===lV,$z=pCe?ys.Buffer:void 0,mCe=$z?$z.isBuffer:void 0,vCe=mCe||fCe,Sx=vCe,gCe="[object Arguments]",yCe="[object Array]",bCe="[object Boolean]",xCe="[object Date]",wCe="[object Error]",SCe="[object Function]",CCe="[object Map]",_Ce="[object Number]",ACe="[object Object]",MCe="[object RegExp]",ECe="[object Set]",TCe="[object String]",PCe="[object WeakMap]",DCe="[object ArrayBuffer]",OCe="[object DataView]",RCe="[object Float32Array]",ICe="[object Float64Array]",zCe="[object Int8Array]",kCe="[object Int16Array]",LCe="[object Int32Array]",BCe="[object Uint8Array]",FCe="[object Uint8ClampedArray]",NCe="[object Uint16Array]",UCe="[object Uint32Array]",bi={};bi[RCe]=bi[ICe]=bi[zCe]=bi[kCe]=bi[LCe]=bi[BCe]=bi[FCe]=bi[NCe]=bi[UCe]=!0;bi[gCe]=bi[yCe]=bi[DCe]=bi[bCe]=bi[OCe]=bi[xCe]=bi[wCe]=bi[SCe]=bi[CCe]=bi[_Ce]=bi[ACe]=bi[MCe]=bi[ECe]=bi[TCe]=bi[PCe]=!1;function jCe(e){return ic(e)&&bP(e.length)&&!!bi[wh(e)]}var VCe=jCe;function HCe(e){return function(t){return e(t)}}var SP=HCe,cV=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Ev=cV&&typeof module=="object"&&module&&!module.nodeType&&module,WCe=Ev&&Ev.exports===cV,hC=WCe&&Jj.process,GCe=function(){try{var e=Ev&&Ev.require&&Ev.require("util").types;return e||hC&&hC.binding&&hC.binding("util")}catch{}}(),yp=GCe,qz=yp&&yp.isTypedArray,$Ce=qz?SP(qz):VCe,dV=$Ce,qCe=Object.prototype,YCe=qCe.hasOwnProperty;function XCe(e,t){var r=ol(e),i=!r&&wP(e),n=!r&&!i&&Sx(e),a=!r&&!i&&!n&&dV(e),o=r||i||n||a,s=o?oCe(e.length,String):[],l=s.length;for(var c in e)(t||YCe.call(e,c))&&!(o&&(c=="length"||n&&(c=="offset"||c=="parent")||a&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||vP(c,l)))&&s.push(c);return s}var uV=XCe;function KCe(e,t){return function(r){return e(t(r))}}var hV=KCe,QCe=hV(Object.keys,Object),ZCe=QCe,JCe=Object.prototype,e_e=JCe.hasOwnProperty;function t_e(e){if(!xP(e))return ZCe(e);var t=[];for(var r in Object(e))e_e.call(e,r)&&r!="constructor"&&t.push(r);return t}var r_e=t_e;function i_e(e){return oV(e)?uV(e):r_e(e)}var CP=i_e;function n_e(e){var t=[];if(e!=null)for(var r in Object(e))t.push(r);return t}var a_e=n_e,o_e=Object.prototype,s_e=o_e.hasOwnProperty;function l_e(e){if(!ps(e))return a_e(e);var t=xP(e),r=[];for(var i in e)i=="constructor"&&(t||!s_e.call(e,i))||r.push(i);return r}var c_e=l_e;function d_e(e){return oV(e)?uV(e,!0):c_e(e)}var Su=d_e,u_e=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,h_e=/^\w*$/;function f_e(e,t){if(ol(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||Xg(e)?!0:h_e.test(e)||!u_e.test(e)||t!=null&&e in Object(t)}var p_e=f_e,m_e=Ch(Object,"create"),cg=m_e;function v_e(){this.__data__=cg?cg(null):{},this.size=0}var g_e=v_e;function y_e(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var b_e=y_e,x_e="__lodash_hash_undefined__",w_e=Object.prototype,S_e=w_e.hasOwnProperty;function C_e(e){var t=this.__data__;if(cg){var r=t[e];return r===x_e?void 0:r}return S_e.call(t,e)?t[e]:void 0}var __e=C_e,A_e=Object.prototype,M_e=A_e.hasOwnProperty;function E_e(e){var t=this.__data__;return cg?t[e]!==void 0:M_e.call(t,e)}var T_e=E_e,P_e="__lodash_hash_undefined__";function D_e(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=cg&&t===void 0?P_e:t,this}var O_e=D_e;function $p(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}$p.prototype.clear=g_e;$p.prototype.delete=b_e;$p.prototype.get=__e;$p.prototype.has=T_e;$p.prototype.set=O_e;var Yz=$p;function R_e(){this.__data__=[],this.size=0}var I_e=R_e;function z_e(e,t){for(var r=e.length;r--;)if(gP(e[r][0],t))return r;return-1}var tw=z_e,k_e=Array.prototype,L_e=k_e.splice;function B_e(e){var t=this.__data__,r=tw(t,e);if(r<0)return!1;var i=t.length-1;return r==i?t.pop():L_e.call(t,r,1),--this.size,!0}var F_e=B_e;function N_e(e){var t=this.__data__,r=tw(t,e);return r<0?void 0:t[r][1]}var U_e=N_e;function j_e(e){return tw(this.__data__,e)>-1}var V_e=j_e;function H_e(e,t){var r=this.__data__,i=tw(r,e);return i<0?(++this.size,r.push([e,t])):r[i][1]=t,this}var W_e=H_e;function qp(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}qp.prototype.clear=I_e;qp.prototype.delete=F_e;qp.prototype.get=U_e;qp.prototype.has=V_e;qp.prototype.set=W_e;var rw=qp,G_e=Ch(ys,"Map"),dg=G_e;function $_e(){this.size=0,this.__data__={hash:new Yz,map:new(dg||rw),string:new Yz}}var q_e=$_e;function Y_e(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var X_e=Y_e;function K_e(e,t){var r=e.__data__;return X_e(t)?r[typeof t=="string"?"string":"hash"]:r.map}var iw=K_e;function Q_e(e){var t=iw(this,e).delete(e);return this.size-=t?1:0,t}var Z_e=Q_e;function J_e(e){return iw(this,e).get(e)}var e2e=J_e;function t2e(e){return iw(this,e).has(e)}var r2e=t2e;function i2e(e,t){var r=iw(this,e),i=r.size;return r.set(e,t),this.size+=r.size==i?0:1,this}var n2e=i2e;function Yp(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}Yp.prototype.clear=q_e;Yp.prototype.delete=Z_e;Yp.prototype.get=e2e;Yp.prototype.has=r2e;Yp.prototype.set=n2e;var nw=Yp,a2e="Expected a function";function _P(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(a2e);var r=function(){var i=arguments,n=t?t.apply(this,i):i[0],a=r.cache;if(a.has(n))return a.get(n);var o=e.apply(this,i);return r.cache=a.set(n,o)||a,o};return r.cache=new(_P.Cache||nw),r}_P.Cache=nw;var o2e=_P,s2e=500;function l2e(e){var t=o2e(e,function(i){return r.size===s2e&&r.clear(),i}),r=t.cache;return t}var c2e=l2e,d2e=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,u2e=/\\(\\)?/g,h2e=c2e(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(d2e,function(r,i,n,a){t.push(n?a.replace(u2e,"$1"):i||r)}),t}),f2e=h2e;function p2e(e){return e==null?"":Nwe(e)}var m2e=p2e;function v2e(e,t){return ol(e)?e:p_e(e,t)?[e]:f2e(m2e(e))}var Xp=v2e,g2e=1/0;function y2e(e){if(typeof e=="string"||Xg(e))return e;var t=e+"";return t=="0"&&1/e==-g2e?"-0":t}var aw=y2e;function b2e(e,t){t=Xp(t,e);for(var r=0,i=t.length;e!=null&&r<i;)e=e[aw(t[r++])];return r&&r==i?e:void 0}var fV=b2e;function x2e(e,t){for(var r=-1,i=t.length,n=e.length;++r<i;)e[n+r]=t[r];return e}var AP=x2e,Xz=Fo?Fo.isConcatSpreadable:void 0;function w2e(e){return ol(e)||wP(e)||!!(Xz&&e&&e[Xz])}var S2e=w2e;function pV(e,t,r,i,n){var a=-1,o=e.length;for(r||(r=S2e),n||(n=[]);++a<o;){var s=e[a];t>0&&r(s)?t>1?pV(s,t-1,r,i,n):AP(n,s):i||(n[n.length]=s)}return n}var C2e=pV;function _2e(e){var t=e==null?0:e.length;return t?C2e(e,1):[]}var A2e=_2e;function M2e(e){return USe(JSe(e,void 0,A2e),e+"")}var mV=M2e,E2e=hV(Object.getPrototypeOf,Object),MP=E2e,T2e="[object Object]",P2e=Function.prototype,D2e=Object.prototype,vV=P2e.toString,O2e=D2e.hasOwnProperty,R2e=vV.call(Object);function I2e(e){if(!ic(e)||wh(e)!=T2e)return!1;var t=MP(e);if(t===null)return!0;var r=O2e.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&vV.call(r)==R2e}var z2e=I2e;function k2e(e,t,r){var i=-1,n=e.length;t<0&&(t=-t>n?0:n+t),r=r>n?n:r,r<0&&(r+=n),n=t>r?0:r-t>>>0,t>>>=0;for(var a=Array(n);++i<n;)a[i]=e[i+t];return a}var L2e=k2e;function B2e(){this.__data__=new rw,this.size=0}var F2e=B2e;function N2e(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var U2e=N2e;function j2e(e){return this.__data__.get(e)}var V2e=j2e;function H2e(e){return this.__data__.has(e)}var W2e=H2e,G2e=200;function $2e(e,t){var r=this.__data__;if(r instanceof rw){var i=r.__data__;if(!dg||i.length<G2e-1)return i.push([e,t]),this.size=++r.size,this;r=this.__data__=new nw(i)}return r.set(e,t),this.size=r.size,this}var q2e=$2e;function Kp(e){var t=this.__data__=new rw(e);this.size=t.size}Kp.prototype.clear=F2e;Kp.prototype.delete=U2e;Kp.prototype.get=V2e;Kp.prototype.has=W2e;Kp.prototype.set=q2e;var vb=Kp;function Y2e(e,t){return e&&Kg(t,CP(t),e)}var X2e=Y2e;function K2e(e,t){return e&&Kg(t,Su(t),e)}var Q2e=K2e,gV=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Kz=gV&&typeof module=="object"&&module&&!module.nodeType&&module,Z2e=Kz&&Kz.exports===gV,Qz=Z2e?ys.Buffer:void 0,Zz=Qz?Qz.allocUnsafe:void 0;function J2e(e,t){if(t)return e.slice();var r=e.length,i=Zz?Zz(r):new e.constructor(r);return e.copy(i),i}var eAe=J2e;function tAe(e,t){for(var r=-1,i=e==null?0:e.length,n=0,a=[];++r<i;){var o=e[r];t(o,r,e)&&(a[n++]=o)}return a}var rAe=tAe;function iAe(){return[]}var yV=iAe,nAe=Object.prototype,aAe=nAe.propertyIsEnumerable,Jz=Object.getOwnPropertySymbols,oAe=Jz?function(e){return e==null?[]:(e=Object(e),rAe(Jz(e),function(t){return aAe.call(e,t)}))}:yV,EP=oAe;function sAe(e,t){return Kg(e,EP(e),t)}var lAe=sAe,cAe=Object.getOwnPropertySymbols,dAe=cAe?function(e){for(var t=[];e;)AP(t,EP(e)),e=MP(e);return t}:yV,bV=dAe;function uAe(e,t){return Kg(e,bV(e),t)}var hAe=uAe;function fAe(e,t,r){var i=t(e);return ol(e)?i:AP(i,r(e))}var xV=fAe;function pAe(e){return xV(e,CP,EP)}var VA=pAe;function mAe(e){return xV(e,Su,bV)}var wV=mAe,vAe=Ch(ys,"DataView"),HA=vAe,gAe=Ch(ys,"Promise"),WA=gAe,yAe=Ch(ys,"Set"),GA=yAe,ek="[object Map]",bAe="[object Object]",tk="[object Promise]",rk="[object Set]",ik="[object WeakMap]",nk="[object DataView]",xAe=Sh(HA),wAe=Sh(dg),SAe=Sh(WA),CAe=Sh(GA),_Ae=Sh(jA),ou=wh;(HA&&ou(new HA(new ArrayBuffer(1)))!=nk||dg&&ou(new dg)!=ek||WA&&ou(WA.resolve())!=tk||GA&&ou(new GA)!=rk||jA&&ou(new jA)!=ik)&&(ou=function(e){var t=wh(e),r=t==bAe?e.constructor:void 0,i=r?Sh(r):"";if(i)switch(i){case xAe:return nk;case wAe:return ek;case SAe:return tk;case CAe:return rk;case _Ae:return ik}return t});var ug=ou,AAe=Object.prototype,MAe=AAe.hasOwnProperty;function EAe(e){var t=e.length,r=new e.constructor(t);return t&&typeof e[0]=="string"&&MAe.call(e,"index")&&(r.index=e.index,r.input=e.input),r}var TAe=EAe,PAe=ys.Uint8Array,Cx=PAe;function DAe(e){var t=new e.constructor(e.byteLength);return new Cx(t).set(new Cx(e)),t}var TP=DAe;function OAe(e,t){var r=t?TP(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}var RAe=OAe,IAe=/\w*$/;function zAe(e){var t=new e.constructor(e.source,IAe.exec(e));return t.lastIndex=e.lastIndex,t}var kAe=zAe,ak=Fo?Fo.prototype:void 0,ok=ak?ak.valueOf:void 0;function LAe(e){return ok?Object(ok.call(e)):{}}var BAe=LAe;function FAe(e,t){var r=t?TP(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}var NAe=FAe,UAe="[object Boolean]",jAe="[object Date]",VAe="[object Map]",HAe="[object Number]",WAe="[object RegExp]",GAe="[object Set]",$Ae="[object String]",qAe="[object Symbol]",YAe="[object ArrayBuffer]",XAe="[object DataView]",KAe="[object Float32Array]",QAe="[object Float64Array]",ZAe="[object Int8Array]",JAe="[object Int16Array]",eMe="[object Int32Array]",tMe="[object Uint8Array]",rMe="[object Uint8ClampedArray]",iMe="[object Uint16Array]",nMe="[object Uint32Array]";function aMe(e,t,r){var i=e.constructor;switch(t){case YAe:return TP(e);case UAe:case jAe:return new i(+e);case XAe:return RAe(e,r);case KAe:case QAe:case ZAe:case JAe:case eMe:case tMe:case rMe:case iMe:case nMe:return NAe(e,r);case VAe:return new i;case HAe:case $Ae:return new i(e);case WAe:return kAe(e);case GAe:return new i;case qAe:return BAe(e)}}var oMe=aMe;function sMe(e){return typeof e.constructor=="function"&&!xP(e)?_Se(MP(e)):{}}var lMe=sMe,cMe="[object Map]";function dMe(e){return ic(e)&&ug(e)==cMe}var uMe=dMe,sk=yp&&yp.isMap,hMe=sk?SP(sk):uMe,fMe=hMe,pMe="[object Set]";function mMe(e){return ic(e)&&ug(e)==pMe}var vMe=mMe,lk=yp&&yp.isSet,gMe=lk?SP(lk):vMe,yMe=gMe,bMe=1,xMe=2,wMe=4,SV="[object Arguments]",SMe="[object Array]",CMe="[object Boolean]",_Me="[object Date]",AMe="[object Error]",CV="[object Function]",MMe="[object GeneratorFunction]",EMe="[object Map]",TMe="[object Number]",_V="[object Object]",PMe="[object RegExp]",DMe="[object Set]",OMe="[object String]",RMe="[object Symbol]",IMe="[object WeakMap]",zMe="[object ArrayBuffer]",kMe="[object DataView]",LMe="[object Float32Array]",BMe="[object Float64Array]",FMe="[object Int8Array]",NMe="[object Int16Array]",UMe="[object Int32Array]",jMe="[object Uint8Array]",VMe="[object Uint8ClampedArray]",HMe="[object Uint16Array]",WMe="[object Uint32Array]",hi={};hi[SV]=hi[SMe]=hi[zMe]=hi[kMe]=hi[CMe]=hi[_Me]=hi[LMe]=hi[BMe]=hi[FMe]=hi[NMe]=hi[UMe]=hi[EMe]=hi[TMe]=hi[_V]=hi[PMe]=hi[DMe]=hi[OMe]=hi[RMe]=hi[jMe]=hi[VMe]=hi[HMe]=hi[WMe]=!0;hi[AMe]=hi[CV]=hi[IMe]=!1;function gb(e,t,r,i,n,a){var o,s=t&bMe,l=t&xMe,c=t&wMe;if(r&&(o=n?r(e,i,n,a):r(e)),o!==void 0)return o;if(!ps(e))return e;var d=ol(e);if(d){if(o=TAe(e),!s)return TSe(e,o)}else{var u=ug(e),h=u==CV||u==MMe;if(Sx(e))return eAe(e,s);if(u==_V||u==SV||h&&!n){if(o=l||h?{}:lMe(e),!s)return l?hAe(e,Q2e(o,e)):lAe(e,X2e(o,e))}else{if(!hi[u])return n?e:{};o=oMe(e,u,s)}}a||(a=new vb);var f=a.get(e);if(f)return f;a.set(e,o),yMe(e)?e.forEach(function(m){o.add(gb(m,t,r,m,e,a))}):fMe(e)&&e.forEach(function(m,g){o.set(g,gb(m,t,r,g,e,a))});var p=c?l?wV:VA:l?Su:CP,v=d?void 0:p(e);return VSe(v||e,function(m,g){v&&(g=m,m=e[g]),yP(o,g,gb(m,t,r,g,e,a))}),o}var AV=gb,GMe=1,$Me=4;function qMe(e){return AV(e,GMe|$Me)}var ow=qMe,YMe="__lodash_hash_undefined__";function XMe(e){return this.__data__.set(e,YMe),this}var KMe=XMe;function QMe(e){return this.__data__.has(e)}var ZMe=QMe;function _x(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new nw;++t<r;)this.add(e[t])}_x.prototype.add=_x.prototype.push=KMe;_x.prototype.has=ZMe;var JMe=_x;function eEe(e,t){for(var r=-1,i=e==null?0:e.length;++r<i;)if(t(e[r],r,e))return!0;return!1}var tEe=eEe;function rEe(e,t){return e.has(t)}var iEe=rEe,nEe=1,aEe=2;function oEe(e,t,r,i,n,a){var o=r&nEe,s=e.length,l=t.length;if(s!=l&&!(o&&l>s))return!1;var c=a.get(e),d=a.get(t);if(c&&d)return c==t&&d==e;var u=-1,h=!0,f=r&aEe?new JMe:void 0;for(a.set(e,t),a.set(t,e);++u<s;){var p=e[u],v=t[u];if(i)var m=o?i(v,p,u,t,e,a):i(p,v,u,e,t,a);if(m!==void 0){if(m)continue;h=!1;break}if(f){if(!tEe(t,function(g,y){if(!iEe(f,y)&&(p===g||n(p,g,r,i,a)))return f.push(y)})){h=!1;break}}else if(!(p===v||n(p,v,r,i,a))){h=!1;break}}return a.delete(e),a.delete(t),h}var MV=oEe;function sEe(e){var t=-1,r=Array(e.size);return e.forEach(function(i,n){r[++t]=[n,i]}),r}var lEe=sEe;function cEe(e){var t=-1,r=Array(e.size);return e.forEach(function(i){r[++t]=i}),r}var dEe=cEe,uEe=1,hEe=2,fEe="[object Boolean]",pEe="[object Date]",mEe="[object Error]",vEe="[object Map]",gEe="[object Number]",yEe="[object RegExp]",bEe="[object Set]",xEe="[object String]",wEe="[object Symbol]",SEe="[object ArrayBuffer]",CEe="[object DataView]",ck=Fo?Fo.prototype:void 0,fC=ck?ck.valueOf:void 0;function _Ee(e,t,r,i,n,a,o){switch(r){case CEe:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case SEe:return!(e.byteLength!=t.byteLength||!a(new Cx(e),new Cx(t)));case fEe:case pEe:case gEe:return gP(+e,+t);case mEe:return e.name==t.name&&e.message==t.message;case yEe:case xEe:return e==t+"";case vEe:var s=lEe;case bEe:var l=i&uEe;if(s||(s=dEe),e.size!=t.size&&!l)return!1;var c=o.get(e);if(c)return c==t;i|=hEe,o.set(e,t);var d=MV(s(e),s(t),i,n,a,o);return o.delete(e),d;case wEe:if(fC)return fC.call(e)==fC.call(t)}return!1}var AEe=_Ee,MEe=1,EEe=Object.prototype,TEe=EEe.hasOwnProperty;function PEe(e,t,r,i,n,a){var o=r&MEe,s=VA(e),l=s.length,c=VA(t),d=c.length;if(l!=d&&!o)return!1;for(var u=l;u--;){var h=s[u];if(!(o?h in t:TEe.call(t,h)))return!1}var f=a.get(e),p=a.get(t);if(f&&p)return f==t&&p==e;var v=!0;a.set(e,t),a.set(t,e);for(var m=o;++u<l;){h=s[u];var g=e[h],y=t[h];if(i)var b=o?i(y,g,h,t,e,a):i(g,y,h,e,t,a);if(!(b===void 0?g===y||n(g,y,r,i,a):b)){v=!1;break}m||(m=h=="constructor")}if(v&&!m){var x=e.constructor,S=t.constructor;x!=S&&"constructor"in e&&"constructor"in t&&!(typeof x=="function"&&x instanceof x&&typeof S=="function"&&S instanceof S)&&(v=!1)}return a.delete(e),a.delete(t),v}var DEe=PEe,OEe=1,dk="[object Arguments]",uk="[object Array]",uy="[object Object]",REe=Object.prototype,hk=REe.hasOwnProperty;function IEe(e,t,r,i,n,a){var o=ol(e),s=ol(t),l=o?uk:ug(e),c=s?uk:ug(t);l=l==dk?uy:l,c=c==dk?uy:c;var d=l==uy,u=c==uy,h=l==c;if(h&&Sx(e)){if(!Sx(t))return!1;o=!0,d=!1}if(h&&!d)return a||(a=new vb),o||dV(e)?MV(e,t,r,i,n,a):AEe(e,t,l,r,i,n,a);if(!(r&OEe)){var f=d&&hk.call(e,"__wrapped__"),p=u&&hk.call(t,"__wrapped__");if(f||p){var v=f?e.value():e,m=p?t.value():t;return a||(a=new vb),n(v,m,r,i,a)}}return h?(a||(a=new vb),DEe(e,t,r,i,n,a)):!1}var zEe=IEe;function EV(e,t,r,i,n){return e===t?!0:e==null||t==null||!ic(e)&&!ic(t)?e!==e&&t!==t:zEe(e,t,r,i,EV,n)}var kEe=EV;function LEe(e,t){return e!=null&&t in Object(e)}var BEe=LEe;function FEe(e,t,r){t=Xp(t,e);for(var i=-1,n=t.length,a=!1;++i<n;){var o=aw(t[i]);if(!(a=e!=null&&r(e,o)))break;e=e[o]}return a||++i!=n?a:(n=e==null?0:e.length,!!n&&bP(n)&&vP(o,n)&&(ol(e)||wP(e)))}var NEe=FEe;function UEe(e,t){return e!=null&&NEe(e,t,BEe)}var jEe=UEe,VEe=function(){return ys.Date.now()},pC=VEe,HEe="Expected a function",WEe=Math.max,GEe=Math.min;function $Ee(e,t,r){var i,n,a,o,s,l,c=0,d=!1,u=!1,h=!0;if(typeof e!="function")throw new TypeError(HEe);t=Uz(t)||0,ps(r)&&(d=!!r.leading,u="maxWait"in r,a=u?WEe(Uz(r.maxWait)||0,t):a,h="trailing"in r?!!r.trailing:h);function f(w){var _=i,C=n;return i=n=void 0,c=w,o=e.apply(C,_),o}function p(w){return c=w,s=setTimeout(g,t),d?f(w):o}function v(w){var _=w-l,C=w-c,A=t-_;return u?GEe(A,a-C):A}function m(w){var _=w-l,C=w-c;return l===void 0||_>=t||_<0||u&&C>=a}function g(){var w=pC();if(m(w))return y(w);s=setTimeout(g,v(w))}function y(w){return s=void 0,h&&i?f(w):(i=n=void 0,o)}function b(){s!==void 0&&clearTimeout(s),c=0,i=l=n=s=void 0}function x(){return s===void 0?o:y(pC())}function S(){var w=pC(),_=m(w);if(i=arguments,n=this,l=w,_){if(s===void 0)return p(l);if(u)return clearTimeout(s),s=setTimeout(g,t),f(l)}return s===void 0&&(s=setTimeout(g,t)),o}return S.cancel=b,S.flush=x,S}var PP=$Ee;function qEe(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var YEe=qEe;function XEe(e,t){return e>t}var KEe=XEe;function QEe(e,t){return t.length<2?e:fV(e,L2e(t,0,-1))}var ZEe=QEe;function JEe(e,t){return kEe(e,t)}var DP=JEe;function eTe(e,t,r){for(var i=-1,n=e.length;++i<n;){var a=e[i],o=t(a);if(o!=null&&(s===void 0?o===o&&!Xg(o):r(o,s)))var s=o,l=a}return l}var tTe=eTe;function rTe(e){return e&&e.length?tTe(e,iV,KEe):void 0}var iTe=rTe;function nTe(e,t){return t=Xp(t,e),e=ZEe(e,t),e==null||delete e[aw(YEe(t))]}var aTe=nTe;function oTe(e){return z2e(e)?void 0:e}var sTe=oTe,lTe=1,cTe=2,dTe=4,uTe=mV(function(e,t){var r={};if(e==null)return r;var i=!1;t=tV(t,function(a){return a=Xp(a,e),i||(i=a.length>1),a}),Kg(e,wV(e),r),i&&(r=AV(r,lTe|cTe|dTe,sTe));for(var n=t.length;n--;)aTe(r,t[n]);return r}),$A=uTe;function hTe(e,t,r,i){if(!ps(e))return e;t=Xp(t,e);for(var n=-1,a=t.length,o=a-1,s=e;s!=null&&++n<a;){var l=aw(t[n]),c=r;if(l==="__proto__"||l==="constructor"||l==="prototype")return e;if(n!=o){var d=s[l];c=i?i(d,l,s):void 0,c===void 0&&(c=ps(d)?d:vP(t[n+1])?[]:{})}yP(s,l,c),s=s[l]}return e}var fTe=hTe;function pTe(e,t,r){for(var i=-1,n=t.length,a={};++i<n;){var o=t[i],s=fV(e,o);r(s,o)&&fTe(a,Xp(o,e),s)}return a}var mTe=pTe;function vTe(e,t){return mTe(e,t,function(r,i){return jEe(e,i)})}var gTe=vTe,yTe=mV(function(e,t){return e==null?{}:gTe(e,t)}),Kl=yTe,bTe="Expected a function";function xTe(e,t,r){var i=!0,n=!0;if(typeof e!="function")throw new TypeError(bTe);return ps(r)&&(i="leading"in r?!!r.leading:i,n="trailing"in r?!!r.trailing:n),PP(e,t,{leading:i,maxWait:t,trailing:n})}var wTe=xTe;function TV(e){for(let t of Object.keys(e))e[t]===void 0&&delete e[t];return e}function No(e,t){return Object.setPrototypeOf(e,t),e}var STe=()=>typeof window>"u"?!1:window.navigator.userAgent.toLowerCase().includes(" electron/"),CTe=()=>typeof window>"u"?!1:window.navigator.platform.toUpperCase().includes("MAC"),_Te=()=>typeof window>"u"?!1:/iPad|iPhone|iPod/.test(window.navigator.userAgent)||sw&&"ontouchend"in document,ATe=()=>typeof window>"u"?!1:window.navigator.userAgent.toLowerCase().indexOf("firefox")>-1,MTe=()=>typeof window>"u"?!1:"ontouchstart"in window||navigator.maxTouchPoints>0,ETe=()=>{if(typeof window>"u")return!1;let e=navigator.userAgent,t=navigator.vendor;return/Safari/i.test(e)&&/Apple Computer/.test(t)},TTe=()=>{if(typeof window>"u")return null;let e=navigator.userAgent.match(/Version\/(\d+\.\d)/);return e&&e[1]},PTe=()=>{if(typeof window>"u")return;let e=new URLSearchParams(window.location.search).get("desktop-app-version");return e?(window.localStorage.setItem("desktop-app-version",e),e):window.localStorage.getItem("desktop-app-version")??"0.0.6"},PV=STe();PV&&PTe();var sw=CTe(),Qg=_Te(),DTe=ATe(),lo=MTe(),fk=ETe(),OTe=Number(TTe());function DV(e){return Array.isArray(e)?e:[e]}function OV(e,t){let r=0;for(;r<e.length&&r<t.length;){if(e[r]<t[r])return-1;if(e[r]>t[r])return 1;r+=1}return r!==t.length?-1:r!==e.length?1:0}function hy(e){return sw?e.metaKey:e.ctrlKey}function RTe(e){return e.wheelDeltaY===0||e.deltaY===0?sw&&e.shiftKey&&Math.abs(e.wheelDeltaX)>=120?!1:e.wheelDeltaX?e.wheelDeltaX===-3*e.deltaX||e.wheelDeltaX===-3*window.devicePixelRatio*e.deltaX:e.deltaMode===0:e.wheelDeltaY?e.wheelDeltaY===-3*e.deltaY||e.wheelDeltaY===-3*window.devicePixelRatio*e.deltaY:e.deltaMode===0}var Ht=[],Ax={},ev={},yb={};function RV(e){Ht.includes(e)||Ht.push(e)}function Wf(e){delete Ax[e.pointerId];for(let t=0;t<Ht.length;t++)if(Ht[t].pointerId===e.pointerId){Ht.splice(t,1);break}}function ITe(){Ht.splice(0,Ht.length)}function Mx(e){if(e.pointerType!=="touch")return;let t=Ax[e.pointerId];t===void 0&&(t={x:0,y:0},Ax[e.pointerId]=t),t.x=e.pageX,t.y=e.pageY}function mC(e){let t=e.pointerId===Ht[0].pointerId?Ht[1]:Ht[0];return Ax[t.pointerId]}function IV(e){ev[e.key]=!0,yb[e.key]=yb[e.key]===void 0?1:yb[e.key]+1}function zV(e){if(sw&&ev.Meta)for(let t in ev)ev[t]=!1;else ev[e.key]=!1;yb={}}function zTe(e){e.addEventListener("pointerdown",RV,!0),e.addEventListener("pointerdown",Mx,!0),e.addEventListener("pointermove",Mx,!0),e.addEventListener("pointerup",Wf,!0),e.addEventListener("pointercancel",Wf,!0),e.addEventListener("pointerleave",Wf,!0),window.addEventListener("keydown",IV,!0),window.addEventListener("keyup",zV,!0)}function kTe(e){e.removeEventListener("pointerdown",RV,!0),e.removeEventListener("pointerdown",Mx,!0),e.removeEventListener("pointermove",Mx,!0),e.removeEventListener("pointerup",Wf,!0),e.removeEventListener("pointercancel",Wf,!0),e.removeEventListener("pointerleave",Wf,!0),window.removeEventListener("keydown",IV,!0),window.removeEventListener("keyup",zV,!0)}var kV,LTe=new Promise(e=>{kV=e}),fy;function BTe(){if(fy)return fy;async function e(){let t="https://unpkg.com/@splinetool/navmesh-wasm@1.9.21/build",r=Nd(()=>import("./navmesh-BFd9Mv4x.js"),[]),[i,n]=await Promise.all([r,fetch(`${t}/navmesh.wasm`).then(s=>s.arrayBuffer())]),a=i.default,o=await a({wasmBinary:n});kV(o)}return fy=e(),fy}var LV,FTe=new Promise(e=>{LV=e}),py;function NTe(){if(py)return py;async function e(){let t=await Nd(()=>import("./physics-BM4kW-A5.js"),[]);await t.init(),LV(t)}return py=e(),py}var kt=class{modifyById(e,t){let r=this;if(r[e]===void 0)throw new Error("not expected");{let i={...r,[e]:t};return Object.setPrototypeOf(i,kt.prototype),i}}add(e,t){var r;return((r=this.runOp({type:1,id:e,data:t}))==null?void 0:r.data)??this}runOp(e){let t=this;if(e.type===1){let r=t[e.id],i;r===void 0?i={type:2,id:e.id}:i={type:1,id:e.id,data:r};let{id:n,data:a}=e,o={...t,[n]:a};return Object.setPrototypeOf(o,kt.prototype),{data:o,actual:e,reverse:i}}else if(e.type===2){let{id:r}=e,i=t[r];if(i===void 0)return null;{let n={...t};return Object.setPrototypeOf(n,kt.prototype),delete n[r],{data:n,actual:e,reverse:{type:1,id:r,data:i}}}}return null}};function OP(e){if(e.deepFreeze!==void 0){e.deepFreeze(e);return}let t=Object.getOwnPropertyNames(e);for(let r of t){let i=e[r];i&&typeof i=="object"&&OP(i)}return Object.freeze(e)}function UTe(e,t){let r=0;for(;r<e.length&&r<t.length;){if(e[r]<t[r])return-1;if(e[r]>t[r])return 1;r+=1}return r!==t.length?-1:r!==e.length?1:0}var BV=class extends Error{};function vC(e){let t={...e};return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),t}function Jc(e,t,r){if(e===void 0?t===void 0?(e=0,t=10):e=t-10:t===void 0&&(t=e+10),e>t){let a=e;e=t,t=a}let i=[],n=1/(r+1);for(let a=0;a<r;a++){let o=e+(t-e)*(a+.75+Math.random()*.5)*n;i.push(o)}return i}function RP(e){return e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Float32Array||e instanceof Float64Array}function jTe(){return typeof process<"u"}function FV(e,t){for(let r of e)t(r.id,r.data)!==!0&&FV(r.children,t)}function NV(e,t){if(t(e.id,e.data)!==!0)for(let r of e.children)NV(r,t)}var Jn=class extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,Jn.prototype)}deepFreeze(){let e=0;for(;e<this.length;)OP(this[e]),e++}fillCaches0(e,t){this.objCaches.set(e.id,e),this.parentCaches.set(e.id,t);for(let r of e.children)this.fillCaches0(r,e.id)}fillCaches(){if(this.objCaches===void 0){this.objCaches=new Map,this.parentCaches=new Map;for(let e of this)this.fillCaches0(e,null)}}randomId(){this.fillCaches();let e=Array.from(this.objCaches.keys());if(e.length!==0)return e[Math.max(0,Math.floor(Math.random()*e.length)-1)]}nonExistOrDescendantOf(e,t){if(!this.has(e))return!0;for(;e;){let r=this.parent(e);if(r===t)return!0;e=r}return!1}rootAcestor(e){for(;e;){let t=this.parent(e);if(t)e=t;else return e}return e}isDescendantOf(e,t){for(;e;){let r=this.parent(e);if(r===t)return!0;e=r}return!1}data(e){var t;return(t=this.get(e))==null?void 0:t.data}has(e){return this.childrenOf(e)!==void 0}get(e){return this.fillCaches(),this.objCaches.get(e)}childrenOf(e){var t;return e===null?this:(t=this.get(e))==null?void 0:t.children}traverseFrom(e,t){if(e===null)this.traverse(t);else{let r=this.get(e);r&&NV(r,t)}}traverse(e){FV(this,e)}totalSize(){return this.fillCaches(),this.objCaches.size}parent(e){return this.fillCaches(),this.parentCaches.get(e)}childrenArray(e){return e===null?this:this.get(e).children}modifyById(e,t){if(this.get(e)===void 0)throw new Error("not expected");{let r=this.parent(e),i=this.childrenArray(r),n=i.findIndex(o=>o.id===e);if(n<0)throw new Error("not expected");let a=i[n];return i=[...i],i[n]={...a,data:t},this.modifyArrayBy(r,i)}}modifyArrayBy(e,t){let r=e,i=t;for(;r!==null;){let a=i,o=r;if(r=this.parent(r),r===void 0)throw new Error;i=this.childrenArray(r);let s=i.findIndex(l=>l.id===o);if(s<0)throw new Error;i=[...i],i[s]={...i[s],children:a}}Object.setPrototypeOf(i,Jn.prototype);let n=i;return n.fillCaches(),n}runOp(e){switch(e.type){case 7:return this.addOp(e);case 8:return this.deleteOp(e);case 9:return this.moveOp(e)}return null}checkDuplicatedIdRec({id:e,children:t}){if(this.get(e)!==void 0)return!0;for(let r of t)if(this.checkDuplicatedIdRec(r))return!0;return!1}addOp(e){let{parent:t,fi:r,id:i,data:n,children:a}=e;if(t!==null&&this.get(t)===void 0||this.checkDuplicatedIdRec(e))return null;{let o=t,s=this.childrenArray(o),l={fi:r,id:i,data:n,children:a};return s=[...s,l],s.sort((c,d)=>c.fi-d.fi),e.localIndex=s.indexOf(l),{data:this.modifyArrayBy(o,s),actual:e,reverse:{type:8,id:i}}}}deleteOp(e){let{id:t}=e;if(this.get(t)===null)return null;{let r=this.parent(t);if(r===void 0)return null;let i=this.childrenArray(r),n=i.findIndex(o=>o.id===t);e.localIndex=n,i=[...i];let a=i.splice(n,1)[0];return{data:this.modifyArrayBy(r,i),actual:e,reverse:{type:7,...a,parent:r}}}}moveOp(e){let{parent:t,fi:r,id:i}=e;if(t!==null&&this.get(t)===void 0)return this.deleteOp({type:8,id:i});if(t!==null){let u=t;for(;u!==null;){if(u===void 0)throw new Error;if(u===i)throw new BV("cyclic tree");u=this.parent(u)}}let n=this.parent(i);if(n===void 0)return null;let a=n,o=this.childrenArray(n),s=o.findIndex(u=>u.id===i);o=[...o];let l=o.splice(s,1)[0],c=this.modifyArrayBy(n,o);n=t,o=c.childrenArray(n);let d=l.fi;return l={...l,fi:r},o=[...o,l],o.sort((u,h)=>u.fi-h.fi),e.localIndex=o.indexOf(l),c=c.modifyArrayBy(n,o),{data:c,actual:e,reverse:{type:9,parent:a,fi:d,id:i}}}previous(e,t){if(t===null){let i=this.childrenArray(e);return i.length===0?null:i[i.length-1].id}let r=null;for(let i of this.childrenArray(e)){if(i.id===t)return r;r=i.id}return null}traverseSortNext(e){let t=this.parent(e);if(t!==void 0){let r=this.childrenArray(t),i=r.findIndex(n=>n.id===e)+1;if(i<r.length)return r[i].id;if(t)return this.traverseSortNext(t)}}sortNext(e){let t=this.childrenArray(e);return t.length>0?t[0].id:this.traverseSortNext(e)}traverseSortPrevious(e){let t=this.childrenArray(e);return t.length>0?this.traverseSortPrevious(t[t.length-1].id):e}sortPrevious(e){let t=this.parent(e);if(t!==void 0){let r=this.childrenArray(t),i=r.findIndex(n=>n.id===e)-1;return i>=0?this.traverseSortPrevious(r[i].id):t}}getAllSorted(e){let t=[];for(let r of e){let i=this.getWithSortKey(r.id);i!==void 0&&t.push({...r,...i})}t.sort((r,i)=>UTe(r.sortKey,i.sortKey));for(let r of t)delete r.sortKey;return t}getWithSortKey(e){var t=e;let r=[],i=this.get(t),n=i;if(i!==void 0){for(;t;)r.splice(0,0,i.fi),t=this.parent(t),t!==null&&(i=this.get(t));return{...n,sortKey:r}}}insertBeforeHelper(e,t,r){return this.insertAfterHelper(e,this.previous(e,t),r)}insertAfterHelper(e,t,r){let i=this.childrenArray(e);if(t===null){if(i.length===0)return Jc(0,r,r);{let n=i[0].fi;return Jc(n-r,n,r)}}else{let n=this.get(t);if(n===void 0||this.parent(t)!==e)throw new Error("illegal args");let a=i.find(o=>o.fi>n.fi);if(a===void 0){let o=i[i.length-1].fi;return Jc(o,o+r,r)}else return Jc(n.fi,a.fi,r)}}},Ex;(e=>{function t(r,i){if(i.type!==0)return null;if(Array.isArray(r)){let n=i.props,a={},o=[...r],s=!1;if(n)for(let l of Object.keys(n)){let c=parseInt(l);if(isNaN(c))throw new Error("wrong index");a[l]=o[c],o[c]=n[l],s=!0}return s?{data:o,actual:i,reverse:{type:0,props:a}}:null}else{let n=i.props,a={},o={...r},s=!1;if(n)for(let l of Object.keys(n)){a[l]=o[l];let c=n[l];c===void 0?delete o[l]:o[l]=c,s=!0}return s?{data:o,actual:i,reverse:{type:0,props:a}}:null}}e.runOp=t})(Ex||(Ex={}));var Dt=class extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,Dt.prototype)}deepFreeze(){let e=0;for(;e<this.length;)OP(this[e]),e++}fillCaches0(e){this.objCaches.set(e.id,e)}fillCaches(){if(this.objCaches===void 0){this.objCaches=new Map,Object.getOwnPropertyDescriptor(this,"objCaches").enumerable=!1;for(let e of this)this.fillCaches0(e)}}randomId(){this.fillCaches();let e=Array.from(this.objCaches.keys());if(e.length!==0)return e[Math.max(0,Math.floor(Math.random()*e.length)-1)]}data(e){var t;return(t=this.get(e))==null?void 0:t.data}get(e){return this.fillCaches(),this.objCaches.get(e)}modifyById(e,t){if(this.get(e)===void 0)throw new Error("not expected");{let r=this,i=r.findIndex(a=>a.id===e);if(i<0)throw new Error("not expected");let n=r[i];return r=[...r],r[i]={...n,data:t},this.modifyArrayBy(r)}}modifyArrayBy(e){Object.setPrototypeOf(e,Dt.prototype);let t=e;return jTe()||t.fillCaches(),t}runOp(e){switch(e.type){case 4:return this.addOp(e);case 5:return this.deleteOp(e);case 6:return this.moveOp(e)}return null}addOp(e){let{fi:t,id:r,data:i}=e,n=this,a={fi:t,id:r,data:i};return n=[...n,a],n.sort((o,s)=>o.fi-s.fi),e.localIndex=n.indexOf(a),{data:this.modifyArrayBy(n),actual:e,reverse:{type:5,id:r}}}deleteOp(e){let{id:t}=e,r=this,i=r.findIndex(a=>a.id===t);if(i===-1)return null;e.localIndex=i,r=[...r];let n=r.splice(i,1)[0];return{data:this.modifyArrayBy(r),actual:e,reverse:{type:4,...n}}}moveOp(e){let{fi:t,id:r}=e,i=this;i=[...i];let n=i.findIndex(s=>s.id===r);if(n===-1)return null;let a=i[n].fi,o={...i[n],fi:t};return i[n]=o,i.sort((s,l)=>s.fi-l.fi),e.localIndex=i.indexOf(o),{data:this.modifyArrayBy(i),actual:e,reverse:{type:6,fi:a,id:r}}}previous(e){if(e===null)return this.length===0?null:this[this.length-1].id;let t=null;for(let r of this){if(r.id===e)return t;t=r.id}return null}insertBeforeHelper(e,t){return this.insertAfterHelper(this.previous(e),t)}insertAfterHelper(e,t){let r=this;if(e===null){if(r.length===0)return Jc(0,t,t);{let i=r[0].fi;return Jc(i-t,i,t)}}else{let i=this.get(e);if(i===void 0)throw new Error("illegal args");let n=r.find(a=>a.fi>i.fi);if(n===void 0){let a=r[r.length-1].fi;return Jc(a,a+t,t)}else return Jc(i.fi,n.fi,t)}}};function bp(e){return e&&typeof e=="object"&&e instanceof cn}var cn=class{unusedFunOverridesTable(e){}runOp(e){let t=[],r=this,i=0,n={};for(;i<e.path.length;){if(t.push(r),r=r===void 0?void 0:r[e.path[i]],r!==void 0&&!bp(r))return null;i+=1}r=r?vC(r):new cn;for(let[s,l]of Object.entries(e.props)){let c=r[s];n[s]=c,l===void 0?delete r[s]:r[s]=l}for(;i>0;){if(Object.keys(r).length===0){let s=t[i-1];s&&(r=vC(s),delete r[e.path[i-1]])}else{let s=t[i-1];if(s){let l=vC(s);l[e.path[i-1]]=r,r=l}else{let l=new cn;l[e.path[i-1]]=r,r=l}}i-=1}let a=Object.setPrototypeOf(r,cn.prototype),o={...e,props:n};return{data:a,actual:e,reverse:o}}},fd;(e=>{function t(n,a){return hg(n,a)??n}e.apply=t;function r(n,a){return zP(n,a)}e.merge=r;function i(n,a){let o=0,s=a.path,l=n;for(;o<s.length&&l!==void 0;){if(l=gn.zoomOnce(l,s[o]),l===void 0)return a;if(!bp(l))return;o+=1}if(l===void 0)return a;if(bp(l))if(a.type===0){let c={...a.props};for(let d of Object.keys(l))delete c[d];return{...a,props:c}}else if(a.type===1||a.type===4||a.type===7){let c=IP([a],l);return c?(console.log(c),c):a}else return a}e.filterOp=i})(fd||(fd={}));function IP(e,t){if(t===void 0)return;let r=!1,i=e.map(n=>{let a=n.id,o=hg(n.data,t[a]);if(r=r||o!==void 0,o===void 0&&(o=n.data),n.children){let s=IP(n.children,t);return s!==void 0?r=!0:s=n.children,{...n,id:a,data:o,children:s}}else return{...n,id:a,data:o}});if(r)return i}function VTe(e,t){if(t===void 0)return;let r=!1,i=e.map(n=>{let a=n.id,o=hg(n.data,t[a]);return r=r||o!==void 0,o===void 0&&(o=n.data),{...n,id:a,data:o}});if(r)return Object.setPrototypeOf(i,Object.getPrototypeOf(e)),i}function hg(e,t){if(!bp(t))return t;if(e instanceof Jn){let r=IP(e,t);return r!==void 0&&Object.setPrototypeOf(r,Object.getPrototypeOf(e)),r}else{if(e instanceof Dt)return VTe(e,t);if(Array.isArray(e)){let r=!1,i=e.map((n,a)=>{let o=hg(n,t[a]);return r=r||o!==void 0,o===void 0&&(o=n),o});return r?(Object.setPrototypeOf(i,Object.getPrototypeOf(e)),i):void 0}else{if(e instanceof cn)return zP(e,t);if(e&&typeof e=="object"){let r={},i=!1;for(let[n,a]of Object.entries(e)){let o=hg(a,t[n]);i=i||o!==void 0,o===void 0&&(o=a),r[n]=o}return i?(Object.setPrototypeOf(r,Object.getPrototypeOf(e)),r):void 0}}}}function zP(e,t){if(e===void 0)return t;if(t===void 0)return e;if(!bp(t))return t;if(!bp(e))return fd.apply(e,t);let r=new Set;for(let n of Object.keys(e))r.add(n);for(let n of Object.keys(t))r.add(n);let i=new cn;for(let n of r){let a=zP(e===void 0?void 0:e[n],t===void 0?void 0:t[n]);i[n]=a}return i}function HTe(e,t){let r={cur:[],result:[],len:0};return e=fg(e,t,r)??e,[e,r.result]}function Tx(e,t){return e===null?null:(e.cur[e.len]=t,e.len+=1,e)}function Px(e){e&&(e.len-=1)}function WTe(e){if(e===null)return null;e.result.push(e.cur.slice(0,e.len))}function UV(e,t,r){let i=!1,n=e.map(a=>{let o=a.id,s=t[o];if(s!==void 0&&typeof s=="string"&&(i=!0,o=s,r!==null))throw new Error("not supported");let l=fg(a.data,t,Tx(r,o));Px(r),i=i||l!==void 0,l===void 0&&(l=a.data);let c=UV(a.children,t,r);return c!==void 0?i=!0:c=a.children,{...a,id:o,data:l,children:c}});if(i)return n}function GTe(e,t,r){let i=!1,n=e.map(a=>{let o=a.id,s=t[o];if(s!==void 0&&typeof s=="string"&&(i=!0,o=s,r!==null))throw new Error("not supported");let l=fg(a.data,t,Tx(r,o));return Px(r),i=i||l!==void 0,l===void 0&&(l=a.data),{...a,id:o,data:l}});if(i)return Object.setPrototypeOf(n,Object.getPrototypeOf(e)),n}function fg(e,t,r){if(e instanceof Jn){let i=UV(e,t,r);return i!==void 0&&Object.setPrototypeOf(i,Object.getPrototypeOf(e)),i}else{if(e instanceof Dt)return GTe(e,t,r);if(Array.isArray(e)){let i=!1,n=e.map((a,o)=>{let s=fg(a,t,Tx(r,o));return Px(r),i=i||s!==void 0,s===void 0&&(s=a),s});return i?(Object.setPrototypeOf(n,Object.getPrototypeOf(e)),n):void 0}else if(e&&typeof e=="object"&&!RP(e)){let i={},n=!1;for(let[a,o]of Object.entries(e))if(a!=="name"&&a!=="variableId"){let s=t[a];if(typeof s=="string"){if(r!==null)throw new Error("not supported");n=!0,a=s}let l=fg(o,t,Tx(r,a));Px(r),n=n||l!==void 0,l===void 0&&(l=o),i[a]=l}else i[a]=o;return n?(Object.setPrototypeOf(i,Object.getPrototypeOf(e)),i):void 0}else if(typeof e=="string"){let i=t[e];return i!==void 0&&WTe(r),i}else return}}var Dx;(e=>{function t(r,i){let n=gn.zoom(i,r.path);if(typeof n=="object"){let a={};for(let o of Object.keys(r.props))a[o]=n[o];return{...r,props:a}}else return{...r,props:{}}}e.replaceProps=t})(Dx||(Dx={}));var zn;(e=>{function t(l,c){return{...l,path:l.path.slice(c)}}e.drop=t;function r(l,c){var d;return((d=i(l,c))==null?void 0:d.data)??l}e.applySimple=r;function i(l,c){var h,f;let d=c.path;for(var u=[];;){let p;if(l instanceof cn&&c.type===0&&(p=l.runOp({...c,path:d.slice(u.length)}),p===null&&(p=void 0)),p===void 0&&u.length===d.length&&(l instanceof Jn||l instanceof Dt||l instanceof kt?p=l.runOp(c):p=Ex.runOp(l,c)),p!==void 0)if(p!==null){let g=p.data;for(let y=u.length-1;y>=0;y--){let b=d[y],x=u[y];if(x instanceof Jn){if(typeof b=="number")throw new Error("illegal arg");g=x.modifyById(b,g)}else if(x instanceof Dt){if(typeof b=="number")throw new Error("illegal arg");g=x.modifyById(b,g)}else if(x instanceof kt){if(typeof b=="number")throw new Error("illegal arg");g=x.modifyById(b,g)}else if(x instanceof cn){let S={...x,[b]:g};g=Object.setPrototypeOf(S,cn.prototype)}else if(typeof x=="object")if(Array.isArray(x)){if(typeof b=="string"&&(b=parseInt(b),isNaN(b)))throw new Error("Invalid path");let S=g;g=[...x],g[b]=S}else g={...x,[b]:g};else return null}return{data:g,actual:{...p.actual,path:d},reverse:{...p.reverse,path:d}}}else return null;let v=d[u.length],m;if(l instanceof Jn){if(typeof v=="number")throw new Error("");m=(h=l.get(v))==null?void 0:h.data}else if(l instanceof Dt){if(typeof v=="number")throw new Error("");m=(f=l.get(v))==null?void 0:f.data}else l!==null&&(m=l[v]);if(m!==void 0)u.push(l),l=m;else return null}}e.apply=i;function n(l,c){for(let d=0;d<l.length&&d<c.length;d++)if(l[d]!==c[d])return!0;return!1}e.pathDisjoint=n;function a(l,c){if(l.length!==c.length)return!1;for(let d=0;d<l.length;d++)if(l[d]!==c[d])return!1;return!0}e.pathEq=a;function o(l,c){return n(l.path,c.path)}e.commutative=o;function s(l,c){return l.type===0&&c.type===0&&a(l.path,c.path)?Object.keys(l.props).every(d=>c.props[d]!==void 0):!1}e.subsumed=s})(zn||(zn={}));var qA;(e=>{function t(){return[]}e.empty=t;function r(c,d){let u=[];for(let h of c){let[f,...p]=h.path;f===d&&u.push({...h,path:p})}return u}e.removePrefix=r;function i(c,d){return c.map(u=>({...u,path:[d,...u.path]}))}e.addPrefix=i;function n(c,d){return[...c,...d]}e.concat=n;function a(c,d){return[...c.filter(u=>!d.some(h=>zn.subsumed(u,h))),...d]}e.compress=a;function o(c,d){return c.every(u=>d.every(h=>zn.commutative(u,h)))}e.commutative=o;function s(c,d){for(let u of d){let h=l(c,u);h!==null&&(c=h.data)}return c}e.applyAll=s;function l(c,d){var u=c;let h=[],f=[];for(let p of d)try{if(p.type===3||p.type===5&&p.path[p.path.length-1]==="variables"){let v,m,g;if(p.type===3?(v=gn.zoom(u,[...p.path,p.id]),g=zn.apply(u,{...p,type:2})):(v=gn.zoom(u,[...p.path,p.id,"value"]),g=zn.apply(u,p)),g!==null){u=g.data;let[y,b]=HTe(u,{[p.id]:v});u=y;for(let x=0;x<b.length;x++){let S=b[x],w=S.pop();if(typeof w=="number"){let _=[w];for(let A=x+1;A<b.length;A++){let M=b[A],P=M[M.length-1];if(typeof P=="number"&&gn.equal(S,M.slice(0,M.length-1)))_.push(P),b.splice(A,1);else break}let C=gn.zoom(u,S);m=C.map((A,M)=>_.includes(M)?p.id:A),v=C,w=S.pop()}else{if(w==="alphaOverride"||w==="alpha"){v/=100;let _=v,C=gn.zoom(u,S.slice(0,S.length-2)),A=C.layers.map(M=>M.id===S[S.length-1]?{...M,data:{...M.data,[w]:_}}:M);Object.setPrototypeOf(A,Object.getPrototypeOf(C.layers)),C.layers=A}m=p.id}h.push({type:0,path:S,props:{[w]:v}}),f.push({type:0,path:S,props:{[w]:m}})}f.push(g.reverse),h.push(g.actual)}}else{let v=zn.apply(u,p);v!==null&&(h.push(v.actual),u=v.data,f.push(v.reverse))}}catch(v){if(v instanceof BV)return null;throw v}return{data:u,actual:h,reverse:f.reverse()}}e.apply=l})(qA||(qA={}));var jV=Symbol(),$Te=Symbol(),lw=Symbol(),Zg=class{reportOp(e,t,r=[]){let i=this;if(t===null)return;i._current=t.data;let n=r;for(;!(i instanceof HV);){let a=i._path,o=i._current;if(a!==""&&n.splice(0,0,a),i=i._parent,i===null)return;i.update(a,o)}i.push(n,e,t.actual,t.reverse)}deleteChildren(e){if(this._children){let t=this._children[e];if(t){let r=t[lw];r&&r(),delete this._children[e]}}}},qTe=class extends Zg{constructor(e,t,r){super(),this._parent=e,this._path=t,this._current=r}update(e,t){if(Array.isArray(this._current)){if(typeof e=="string"&&(e=parseInt(e),isNaN(e)))throw new Error("Invalid path");this._current=[...this._current],this._current[e]=t}else this._current={...this._current,[e]:t}}runOp(e){this.reportOp(e,Ex.runOp(this._current,e),e.path)}},YTe=class extends Zg{constructor(e,t,r){super(),this._parent=e,this._path=t,this._current=r}update(e,t){this._current={...this._current,[e]:t},Object.setPrototypeOf(this._current,kt.prototype)}runOp(e){this.reportOp(e,this._current.runOp(e))}},VV={get(e,t){if(t===lw)return()=>{e._parent=null};if(t===jV)return e._current;if(t===$Te)return e;let{_current:r,_children:i}=e;if(t==="push"&&Array.isArray(r))throw new Error("not supported to expand array");let n=i===void 0?void 0:i[t];if(n!==void 0)return n;let a=r[t],o=cw(e,t,a);return o!==a?(i===void 0&&(i={},e._children=i),i[t]=o,o):a},has(e,t){return t in e._current},ownKeys(e){return Reflect.ownKeys(e._current)},defineProperty(){throw Error("not supported")},getPrototypeOf(e){return Object.getPrototypeOf(e._current)},setPrototypeOf(){throw Error("not supported")},getOwnPropertyDescriptor(e,t){let r=e._current,i=Reflect.getOwnPropertyDescriptor(r,t);return i&&{writable:!0,configurable:!0,enumerable:i.enumerable,value:r[t]}}},XTe={...VV,set(e,t,r){let i={type:0,props:{[t]:qi(r)??r}};return e.deleteChildren(t),e.runOp(i),!0},deleteProperty(e,t){let r={type:0,props:{[t]:void 0}};return e.deleteChildren(t),e.runOp(r),!0}},KTe={...VV,set(e,t,r){return r===void 0?this.deleteProperty(e,t):(e.deleteChildren(t),e.runOp({type:1,id:t,data:r})),!0},deleteProperty(e,t){return e.runOp({type:2,id:t}),!0}},kP=class extends Zg{constructor(e,t,r){super(),this._children={},this._parent=e,this._path=t,this._current=r,this[lw]=()=>{this._parent=null}}unproxy(){return this._current}update(e,t){this._current=this._current.modifyById(e,t)}runOp(e){this.reportOp(e,this._current.runOp(e))}randomId(){return this._current.randomId()}isDescendantOf(e,t){return this._current.isDescendantOf(e,t)}childrenOf(e){return this._current.childrenOf(e)}traverse(e){return this._current.traverse(e)}get(e){return this._current.get(e)}parent(e){return this._current.parent(e)}traverse(e){this._current.traverse((t,r)=>{e(t,this.data(t))})}data(e){var o;let{_current:t,_children:r}=this,i=r===void 0?void 0:r[e];if(i!==void 0)return i;let n=(o=t.get(e))==null?void 0:o.data,a=cw(this,e,n);return a!==n?(r===void 0&&(r={},this._children=r),r[e]=a,a):n}add(e,t,r,i,n){this.runOp({type:7,parent:e,fi:t,id:r,data:i,children:n})}move(e,t,r){this.runOp({type:9,parent:e,fi:t,id:r})}insertAfter(e,t,r){let i=this._current.insertAfterHelper(e,t,r.length);for(let n=0;n<r.length;n++){let a=r[n];this.add(e,i[n],a.id,a.data,a.children)}}insertBefore(e,t,r){let i=this._current.insertBeforeHelper(e,t,r.length);for(let n=0;n<r.length;n++){let a=r[n];this.add(e,i[n],a.id,a.data,a.children)}}moveAfter(e,t,r){let i=this._current.insertAfterHelper(e,t,r.length);for(let n=0;n<r.length;n++){let a=r[n];this.move(e,i[n],a)}}moveBefore(e,t,r){let i=this._current.insertBeforeHelper(e,t,r.length);for(let n=0;n<r.length;n++){let a=r[n];this.move(e,i[n],a)}}delete(e){this.deleteChildren(e),this.runOp({type:8,id:e})}sortNext(e){return this._current.sortNext(e)}sortPrevious(e){return this._current.sortPrevious(e)}getAllSorted(e){return this._current.getAllSorted(e)}},LP=class extends Zg{constructor(e,t,r){super(),this._children={},this._parent=e,this._path=t,this._current=r,this[lw]=()=>{this._parent=null}}unproxy(){return this._current}get length(){return this._current.length}forEach(e){let t=this.length;for(let r=0;r<t;r++){let i=this._current[r].id,n=this._current[r].fi;e(this.data(this._current[r].id),i,n)}}find(e){let t=this.length;for(let r=0;r<t;r++){let i=this._current[r].id;if(e(this.data(i),i))return this.get(i)}}update(e,t){this._current=this._current.modifyById(e,t)}randomId(){return this._current.randomId()}get(e){return{...this._current.get(e),data:this.data(e)}}data(e){var o;let{_current:t,_children:r}=this,i=r===void 0?void 0:r[e];if(i!==void 0)return i;let n=(o=t.get(e))==null?void 0:o.data,a=cw(this,e,n);return a!==n?(r===void 0&&(r={},this._children=r),r[e]=a,a):n}runOp(e){this.reportOp(e,this._current.runOp(e))}add(e,t,r){this.runOp({type:4,fi:e,id:t,data:r})}move(e,t){this.runOp({type:6,fi:e,id:t})}insertAfter(e,t){let r=this._current.insertAfterHelper(e,t.length);for(let i=0;i<t.length;i++){let n=t[i];this.add(r[i],n.id,n.data)}}insertBefore(e,t){let r=this._current.insertBeforeHelper(e,t.length);for(let i=0;i<t.length;i++){let n=t[i];this.add(r[i],n.id,n.data)}}moveAfter(e,t){let r=this._current.insertAfterHelper(e,t.length);for(let i=0;i<t.length;i++){let n=t[i];this.move(r[i],n)}}moveBefore(e,t){let r=this._current.insertBeforeHelper(e,t.length);for(let i=0;i<t.length;i++){let n=t[i];this.move(r[i],n)}}delete(e){this.deleteChildren(e),this.runOp({type:5,id:e})}};function gC(e,t,r){if(e.length>0){let i=e[e.length-1];if(i.type===0&&t.type===0&&gn.equal(i.path,r)){Object.assign(i.props,t.props);return}}e.push({...t,path:r})}var HV=class extends Zg{constructor(e){super(),this.ts=[],this.actual=[],this.reverse=[],this._current=e}update(e,t){if(e!=="")throw new Error("");this._current=t}push(e,t,r,i){gC(this.ts,t,e),gC(this.actual,r,e),gC(this.reverse,i,e)}result(){return{data:this._current,ts:this.ts,actual:this.actual,reverse:this.reverse.reverse()}}};function cw(e,t,r){return r instanceof Jn?new kP(e,t,r):r instanceof Dt?new LP(e,t,r):r instanceof kt?new Proxy(new YTe(e,t,r),KTe):r!==null&&typeof r=="object"?RP(r)?r:new Proxy(new qTe(e,t,r),XTe):r}function WV(e){let t=new HV(e);return[cw(t,"",e),t]}function pg(e,t){let[r,i]=WV(e);return t(r),i.result()}function qi(e){return e instanceof kP||e instanceof LP?e._current:e!==null&&typeof e=="object"?e[jV]:e}var gn;(e=>{function t(a,o){if(o.length===a.length)for(var s=0;s<a.length;){if(a[s]!==o[s])return!1;s+=1}else return!1;return!0}e.equal=t;function r(a,o,s){let l=n(s,a);if(l!==void 0&&typeof l=="object"&&l!==null){let c={...o};return Object.keys(l).forEach(d=>{delete c[d]}),c}else return o}e.removeOverridden=r;function i(a,o){if((a instanceof Jn||a instanceof kP)&&typeof o=="string"||(a instanceof Dt||a instanceof LP)&&typeof o=="string")return a.data(o);if(typeof o=="number"&&Array.isArray(a)||typeof o=="string"&&typeof a=="object"&&a!==null)return a[o]}e.zoomOnce=i;function n(a,o,s=0){for(;s<o.length&&a!==void 0;)a=i(a,o[s]),s+=1;return a}e.zoom=n})(gn||(gn={}));function QTe(e,t){let r=[];if(t.length===e.length)for(var i=0;i<e.length;){if(t[i]==="*")r.push(e[i]);else if(e[i]!==t[i])return null;i+=1}else return null;return r}function si(e,t){let r=[];if(t.length<=e.length)for(var i=0;i<t.length;){if(t[i]==="*")r.push(e[i]);else if(e[i]!==t[i])return null;i+=1}else return null;return r}var GV=class{},pk=class extends GV{constructor(e){super(),this.id=e}},mk=class extends GV{constructor(e){super(),this.data=e}},YA;try{YA=new TextDecoder}catch{}var At,pd,Ue=0,Wa={},Nr,ed,Co=0,Ws=0,oo,Ql,Oa=[],$r,vk={useRecords:!1,mapsAsObjects:!0},$V=class{},qV=new $V;qV.name="MessagePack 0xC1";var xp=!1,Ox=class{constructor(e){e&&(e.useRecords===!1&&e.mapsAsObjects===void 0&&(e.mapsAsObjects=!0),e.structures?e.structures.sharedLength=e.structures.length:e.getStructures&&((e.structures=[]).uninitialized=!0,e.structures.sharedLength=0)),Object.assign(this,e)}unpack(e,t){if(At)return JV(()=>(KA(),this?this.unpack(e,t):Ox.prototype.unpack.call(vk,e,t)));pd=t>-1?t:e.length,Ue=0,Ws=0,ed=null,oo=null,At=e;try{$r=e.dataView||(e.dataView=new DataView(e.buffer,e.byteOffset,e.byteLength))}catch(r){throw At=null,e instanceof Uint8Array?r:new Error("Source must be a Uint8Array or Buffer but was a "+(e&&typeof e=="object"?e.constructor.name:typeof e))}if(this instanceof Ox){if(Wa=this,this.structures)return Nr=this.structures,my();(!Nr||Nr.length>0)&&(Nr=[])}else Wa=vk,(!Nr||Nr.length>0)&&(Nr=[]);return my()}unpackMultiple(e,t){let r,i=0;try{xp=!0;let n=e.length,a=this?this.unpack(e,n):uw.unpack(e,n);if(t){for(t(a);Ue<n;)if(i=Ue,t(my())===!1)return}else{for(r=[a];Ue<n;)i=Ue,r.push(my());return r}}catch(n){throw n.lastPosition=i,n.values=r,n}finally{xp=!1,KA()}}_mergeStructures(e,t){e=e||[];for(let r=0,i=e.length;r<i;r++){let n=e[r];n&&(n.isShared=!0,r>=32&&(n.highByte=r-32>>5))}e.sharedLength=e.length;for(let r in t||[])if(r>=0){let i=e[r],n=t[r];n&&(i&&((e.restoreStructures||(e.restoreStructures=[]))[r]=i),e[r]=n)}return this.structures=e}decode(e,t){return this.unpack(e,t)}};function my(){try{if(!Wa.trusted&&!xp){let t=Nr.sharedLength||0;t<Nr.length&&(Nr.length=t)}let e=ki();if(Ue==pd)Nr.restoreStructures&&gk(),Nr=null,At=null,Ql&&(Ql=null);else if(Ue>pd){let t=new Error("Unexpected end of MessagePack data");throw t.incomplete=!0,t}else if(!xp)throw new Error("Data read, but end of buffer not reached");return e}catch(e){throw Nr.restoreStructures&&gk(),KA(),(e instanceof RangeError||e.message.startsWith("Unexpected end of buffer"))&&(e.incomplete=!0),e}}function gk(){for(let e in Nr.restoreStructures)Nr[e]=Nr.restoreStructures[e];Nr.restoreStructures=null}function ki(){let e=At[Ue++];if(e<160)if(e<128){if(e<64)return e;{let t=Nr[e&63]||Wa.getStructures&&YV()[e&63];return t?(t.read||(t.read=BP(t,e&63)),t.read()):e}}else if(e<144)if(e-=128,Wa.mapsAsObjects){let t={};for(let r=0;r<e;r++)t[KV()]=ki();return t}else{let t=new Map;for(let r=0;r<e;r++)t.set(ki(),ki());return t}else{e-=144;let t=new Array(e);for(let r=0;r<e;r++)t[r]=ki();return t}else if(e<192){let t=e-160;if(Ws>=Ue)return ed.slice(Ue-Co,(Ue+=t)-Co);if(Ws==0&&pd<140){let r=t<16?FP(t):XV(t);if(r!=null)return r}return XA(t)}else{let t;switch(e){case 192:return null;case 193:return oo?(t=ki(),t>0?oo[1].slice(oo.position1,oo.position1+=t):oo[0].slice(oo.position0,oo.position0-=t)):qV;case 194:return!1;case 195:return!0;case 196:return yC(At[Ue++]);case 197:return t=$r.getUint16(Ue),Ue+=2,yC(t);case 198:return t=$r.getUint32(Ue),Ue+=4,yC(t);case 199:return Qd(At[Ue++]);case 200:return t=$r.getUint16(Ue),Ue+=2,Qd(t);case 201:return t=$r.getUint32(Ue),Ue+=4,Qd(t);case 202:if(t=$r.getFloat32(Ue),Wa.useFloat32>2){let r=NP[(At[Ue]&127)<<1|At[Ue+1]>>7];return Ue+=4,(r*t+(t>0?.5:-.5)>>0)/r}return Ue+=4,t;case 203:return t=$r.getFloat64(Ue),Ue+=8,t;case 204:return At[Ue++];case 205:return t=$r.getUint16(Ue),Ue+=2,t;case 206:return t=$r.getUint32(Ue),Ue+=4,t;case 207:return Wa.int64AsNumber?(t=$r.getUint32(Ue)*4294967296,t+=$r.getUint32(Ue+4)):t=$r.getBigUint64(Ue),Ue+=8,t;case 208:return $r.getInt8(Ue++);case 209:return t=$r.getInt16(Ue),Ue+=2,t;case 210:return t=$r.getInt32(Ue),Ue+=4,t;case 211:return Wa.int64AsNumber?(t=$r.getInt32(Ue)*4294967296,t+=$r.getUint32(Ue+4)):t=$r.getBigInt64(Ue),Ue+=8,t;case 212:if(t=At[Ue++],t==114)return Sk(At[Ue++]&63);{let r=Oa[t];if(r)return r.read?(Ue++,r.read(ki())):r.noBuffer?(Ue++,r()):r(At.subarray(Ue,++Ue));throw new Error("Unknown extension "+t)}case 213:return t=At[Ue],t==114?(Ue++,Sk(At[Ue++]&63,At[Ue++])):Qd(2);case 214:return Qd(4);case 215:return Qd(8);case 216:return Qd(16);case 217:return t=At[Ue++],Ws>=Ue?ed.slice(Ue-Co,(Ue+=t)-Co):JTe(t);case 218:return t=$r.getUint16(Ue),Ue+=2,Ws>=Ue?ed.slice(Ue-Co,(Ue+=t)-Co):ePe(t);case 219:return t=$r.getUint32(Ue),Ue+=4,Ws>=Ue?ed.slice(Ue-Co,(Ue+=t)-Co):tPe(t);case 220:return t=$r.getUint16(Ue),Ue+=2,bk(t);case 221:return t=$r.getUint32(Ue),Ue+=4,bk(t);case 222:return t=$r.getUint16(Ue),Ue+=2,xk(t);case 223:return t=$r.getUint32(Ue),Ue+=4,xk(t);default:if(e>=224)return e-256;if(e===void 0){let r=new Error("Unexpected end of MessagePack data");throw r.incomplete=!0,r}throw new Error("Unknown MessagePack token "+e)}}}var ZTe=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function BP(e,t){function r(){if(r.count++>2){let n=e.read=new Function("r","return function(){return {"+e.map(a=>ZTe.test(a)?a+":r()":"["+JSON.stringify(a)+"]:r()").join(",")+"}}")(ki);return e.highByte===0&&(e.read=yk(t,e.read)),n()}let i={};for(let n=0,a=e.length;n<a;n++){let o=e[n];i[o]=ki()}return i}return r.count=0,e.highByte===0?yk(t,r):r}var yk=(e,t)=>function(){let r=At[Ue++];if(r===0)return t();let i=e<32?-(e+(r<<5)):e+(r<<5),n=Nr[i]||YV()[i];if(!n)throw new Error("Record id is not defined for "+i);return n.read||(n.read=BP(n,e)),n.read()};function YV(){let e=JV(()=>(At=null,Wa.getStructures()));return Nr=Wa._mergeStructures(e,Nr)}var XA=dw,JTe=dw,ePe=dw,tPe=dw;function dw(e){let t;if(e<16&&(t=FP(e)))return t;if(e>64&&YA)return YA.decode(At.subarray(Ue,Ue+=e));let r=Ue+e,i=[];for(t="";Ue<r;){let n=At[Ue++];if(!(n&128))i.push(n);else if((n&224)===192){let a=At[Ue++]&63;i.push((n&31)<<6|a)}else if((n&240)===224){let a=At[Ue++]&63,o=At[Ue++]&63;i.push((n&31)<<12|a<<6|o)}else if((n&248)===240){let a=At[Ue++]&63,o=At[Ue++]&63,s=At[Ue++]&63,l=(n&7)<<18|a<<12|o<<6|s;l>65535&&(l-=65536,i.push(l>>>10&1023|55296),l=56320|l&1023),i.push(l)}else i.push(n);i.length>=4096&&(t+=En.apply(String,i),i.length=0)}return i.length>0&&(t+=En.apply(String,i)),t}function bk(e){let t=new Array(e);for(let r=0;r<e;r++)t[r]=ki();return t}function xk(e){if(Wa.mapsAsObjects){let t={};for(let r=0;r<e;r++)t[KV()]=ki();return t}else{let t=new Map;for(let r=0;r<e;r++)t.set(ki(),ki());return t}}var En=String.fromCharCode;function XV(e){let t=Ue,r=new Array(e);for(let i=0;i<e;i++){let n=At[Ue++];if((n&128)>0){Ue=t;return}r[i]=n}return En.apply(String,r)}function FP(e){if(e<4)if(e<2){if(e===0)return"";{let t=At[Ue++];if((t&128)>1){Ue-=1;return}return En(t)}}else{let t=At[Ue++],r=At[Ue++];if((t&128)>0||(r&128)>0){Ue-=2;return}if(e<3)return En(t,r);let i=At[Ue++];if((i&128)>0){Ue-=3;return}return En(t,r,i)}else{let t=At[Ue++],r=At[Ue++],i=At[Ue++],n=At[Ue++];if((t&128)>0||(r&128)>0||(i&128)>0||(n&128)>0){Ue-=4;return}if(e<6){if(e===4)return En(t,r,i,n);{let a=At[Ue++];if((a&128)>0){Ue-=5;return}return En(t,r,i,n,a)}}else if(e<8){let a=At[Ue++],o=At[Ue++];if((a&128)>0||(o&128)>0){Ue-=6;return}if(e<7)return En(t,r,i,n,a,o);let s=At[Ue++];if((s&128)>0){Ue-=7;return}return En(t,r,i,n,a,o,s)}else{let a=At[Ue++],o=At[Ue++],s=At[Ue++],l=At[Ue++];if((a&128)>0||(o&128)>0||(s&128)>0||(l&128)>0){Ue-=8;return}if(e<10){if(e===8)return En(t,r,i,n,a,o,s,l);{let c=At[Ue++];if((c&128)>0){Ue-=9;return}return En(t,r,i,n,a,o,s,l,c)}}else if(e<12){let c=At[Ue++],d=At[Ue++];if((c&128)>0||(d&128)>0){Ue-=10;return}if(e<11)return En(t,r,i,n,a,o,s,l,c,d);let u=At[Ue++];if((u&128)>0){Ue-=11;return}return En(t,r,i,n,a,o,s,l,c,d,u)}else{let c=At[Ue++],d=At[Ue++],u=At[Ue++],h=At[Ue++];if((c&128)>0||(d&128)>0||(u&128)>0||(h&128)>0){Ue-=12;return}if(e<14){if(e===12)return En(t,r,i,n,a,o,s,l,c,d,u,h);{let f=At[Ue++];if((f&128)>0){Ue-=13;return}return En(t,r,i,n,a,o,s,l,c,d,u,h,f)}}else{let f=At[Ue++],p=At[Ue++];if((f&128)>0||(p&128)>0){Ue-=14;return}if(e<15)return En(t,r,i,n,a,o,s,l,c,d,u,h,f,p);let v=At[Ue++];if((v&128)>0){Ue-=15;return}return En(t,r,i,n,a,o,s,l,c,d,u,h,f,p,v)}}}}}function yC(e){return Wa.copyBuffers?Uint8Array.prototype.slice.call(At,Ue,Ue+=e):At.subarray(Ue,Ue+=e)}function Qd(e){let t=At[Ue++];if(Oa[t])return Oa[t](At.subarray(Ue,Ue+=e));throw new Error("Unknown extension type "+t)}var wk=new Array(4096);function KV(){let e=At[Ue++];if(e>=160&&e<192){if(e=e-160,Ws>=Ue)return ed.slice(Ue-Co,(Ue+=e)-Co);if(!(Ws==0&&pd<180))return XA(e)}else return Ue--,ki();let t=(e<<5^(e>1?$r.getUint16(Ue):e>0?At[Ue]:0))&4095,r=wk[t],i=Ue,n=Ue+e-3,a,o=0;if(r&&r.bytes==e){for(;i<n;){if(a=$r.getUint32(i),a!=r[o++]){i=1879048192;break}i+=4}for(n+=3;i<n;)if(a=At[i++],a!=r[o++]){i=1879048192;break}if(i===n)return Ue=i,r.string;n-=3,i=Ue}for(r=[],wk[t]=r,r.bytes=e;i<n;)a=$r.getUint32(i),r.push(a),i+=4;for(n+=3;i<n;)a=At[i++],r.push(a);let s=e<16?FP(e):XV(e);return s!=null?r.string=s:r.string=XA(e)}var Sk=(e,t)=>{var r=ki();let i=e;t!==void 0&&(e=e<32?-((t<<5)+e):(t<<5)+e,r.highByte=t);let n=Nr[e];return n&&n.isShared&&((Nr.restoreStructures||(Nr.restoreStructures=[]))[e]=n),Nr[e]=r,r.read=BP(r,i),r.read()},QV=typeof self=="object"?self:global;Oa[0]=()=>{};Oa[0].noBuffer=!0;Oa[101]=()=>{let e=ki();return(QV[e[0]]||Error)(e[1])};Oa[105]=e=>{let t=$r.getUint32(Ue-4);Ql||(Ql=new Map);let r=At[Ue],i;r>=144&&r<160||r==220||r==221?i=[]:i={};let n={target:i};Ql.set(t,n);let a=ki();return n.used?Object.assign(i,a):(n.target=a,a)};Oa[112]=e=>{let t=$r.getUint32(Ue-4),r=Ql.get(t);return r.used=!0,r.target};Oa[115]=()=>new Set(ki());var ZV=["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64","BigInt64","BigUint64"].map(e=>e+"Array");Oa[116]=e=>{let t=e[0],r=ZV[t];if(!r)throw new Error("Could not find typed array for code "+t);return new QV[r](Uint8Array.prototype.slice.call(e,1).buffer)};Oa[120]=()=>{let e=ki();return new RegExp(e[0],e[1])};Oa[98]=e=>{let t=(e[0]<<24)+(e[1]<<16)+(e[2]<<8)+e[3],r=Ue;Ue+=t-4,oo=[ki(),ki()],oo.position0=0,oo.position1=0;let i=Ue;Ue=r;try{return ki()}finally{Ue=i}};Oa[255]=e=>e.length==4?new Date((e[0]*16777216+(e[1]<<16)+(e[2]<<8)+e[3])*1e3):e.length==8?new Date(((e[0]<<22)+(e[1]<<14)+(e[2]<<6)+(e[3]>>2))/1e6+((e[3]&3)*4294967296+e[4]*16777216+(e[5]<<16)+(e[6]<<8)+e[7])*1e3):e.length==12?new Date(((e[0]<<24)+(e[1]<<16)+(e[2]<<8)+e[3])/1e6+((e[4]&128?-281474976710656:0)+e[6]*1099511627776+e[7]*4294967296+e[8]*16777216+(e[9]<<16)+(e[10]<<8)+e[11])*1e3):new Date("invalid");function JV(e){let t=pd,r=Ue,i=Co,n=Ws,a=ed,o=Ql,s=oo,l=new Uint8Array(At.slice(0,pd)),c=Nr,d=Nr.slice(0,Nr.length),u=Wa,h=xp,f=e();return pd=t,Ue=r,Co=i,Ws=n,ed=a,Ql=o,oo=s,At=l,xp=h,Nr=c,Nr.splice(0,Nr.length,...d),Wa=u,$r=new DataView(At.buffer,At.byteOffset,At.byteLength),f}function KA(){At=null,Ql=null,Nr=null}function rPe(e){e.unpack?Oa[e.type]=e.unpack:Oa[e.type]=e}var NP=new Array(147);for(let e=0;e<256;e++)NP[e]=+("1e"+Math.floor(45.15-e*.30103));var uw=new Ox({useRecords:!1});uw.unpack;uw.unpackMultiple;uw.unpack;var iPe=new Float32Array(1);new Uint8Array(iPe.buffer,0,4);var bb;try{bb=new TextEncoder}catch{}var Rx,UP,hw=typeof Buffer<"u",bC=hw?Buffer.allocUnsafeSlow:Uint8Array,e8=hw?Buffer:Uint8Array,Ck=hw?4294967296:2144337920,et,Vi,Ge=0,Cs,_s=null,nPe=/[\u0080-\uFFFF]/,Tm=Symbol("record-id"),t8=class extends Ox{constructor(e){super(e),this.offset=0;let t,r,i,n,a,o=0,s=e8.prototype.utf8Write?function(w,_,C){return et.utf8Write(w,_,C)}:bb&&bb.encodeInto?function(w,_){return bb.encodeInto(w,et.subarray(_)).written}:!1,l=this;e||(e={});let c=e&&e.sequential,d=e.structures||e.saveStructures,u=e.maxSharedStructures;if(u==null&&(u=d?32:0),u>8160)throw new Error("Maximum maxSharedStructure is 8160");let h=e.maxOwnStructures;h==null&&(h=d?32:64),c&&!e.saveStructures&&(this.structures=[]);let f=u>32||h+u>64,p=u+64,v=u+h+64;if(v>8256)throw new Error("Maximum maxSharedStructure + maxOwnStructure is 8192");let m=[],g=0,y=0;this.pack=this.encode=function(w,_){if(et||(et=new bC(8192),Vi=new DataView(et.buffer,0,8192),Ge=0),Cs=et.length-10,Cs-Ge<2048?(et=new bC(et.length),Vi=new DataView(et.buffer,0,et.length),Cs=et.length-10,Ge=0):Ge=Ge+7&2147483640,t=Ge,a=l.structuredClone?new Map:null,l.bundleStrings?(_s=["",""],et[Ge++]=214,et[Ge++]=98,_s.position=Ge-t,Ge+=4):_s=null,r=l.structures,r){r.uninitialized&&(r=l._mergeStructures(l.getStructures()));let C=r.sharedLength||0;if(C>u)throw new Error("Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to "+r.sharedLength);if(!r.transitions){r.transitions=Object.create(null);for(let A=0;A<C;A++){let M=r[A];if(!M)continue;let P,T=r.transitions;for(let R=0,z=M.length;R<z;R++){let F=M[R];P=T[F],P||(P=T[F]=Object.create(null)),T=P}T[Tm]=A+64}o=C}c||(r.nextId=C+64)}i&&(i=!1),n=r||[];try{if(b(w),_s){Vi.setUint32(_s.position+t,Ge-_s.position-t);let C=_s;_s=null,b(C[0]),b(C[1])}if(l.offset=Ge,a&&a.idsToInsert){Ge+=a.idsToInsert.length*6,Ge>Cs&&S(Ge),l.offset=Ge;let C=oPe(et.subarray(t,Ge),a.idsToInsert);return a=null,C}return _&sPe?(et.start=t,et.end=Ge,et):et.subarray(t,Ge)}finally{if(r){if(y<10&&y++,g>1e4)r.transitions=null,y=0,g=0,m.length>0&&(m=[]);else if(m.length>0&&!c){for(let C=0,A=m.length;C<A;C++)m[C][Tm]=0;m=[]}if(i&&l.saveStructures){let C=r.sharedLength||u;r.length>C&&(r=r.slice(0,C));let A=et.subarray(t,Ge);return l.saveStructures(r,o)===!1?(l._mergeStructures(l.getStructures()),l.pack(w)):(o=C,A)}}_&lPe&&(Ge=t)}};let b=w=>{Ge>Cs&&(et=S(Ge));var _=typeof w,C;if(_==="string"){let A=w.length;if(_s&&A>=8&&A<4096){let T=nPe.test(w);_s[T?0:1]+=w,et[Ge++]=193,b(T?-A:A);return}let M;A<32?M=1:A<256?M=2:A<65536?M=3:M=5;let P=A*3;if(Ge+P>Cs&&(et=S(Ge+P)),A<64||!s){let T,R,z,F=Ge+M;for(T=0;T<A;T++)R=w.charCodeAt(T),R<128?et[F++]=R:R<2048?(et[F++]=R>>6|192,et[F++]=R&63|128):(R&64512)===55296&&((z=w.charCodeAt(T+1))&64512)===56320?(R=65536+((R&1023)<<10)+(z&1023),T++,et[F++]=R>>18|240,et[F++]=R>>12&63|128,et[F++]=R>>6&63|128,et[F++]=R&63|128):(et[F++]=R>>12|224,et[F++]=R>>6&63|128,et[F++]=R&63|128);C=F-Ge-M}else C=s(w,Ge+M,P);C<32?et[Ge++]=160|C:C<256?(M<2&&et.copyWithin(Ge+2,Ge+1,Ge+1+C),et[Ge++]=217,et[Ge++]=C):C<65536?(M<3&&et.copyWithin(Ge+3,Ge+2,Ge+2+C),et[Ge++]=218,et[Ge++]=C>>8,et[Ge++]=C&255):(M<5&&et.copyWithin(Ge+5,Ge+3,Ge+3+C),et[Ge++]=219,Vi.setUint32(Ge,C),Ge+=4),Ge+=C}else if(_==="number")if(w>>>0===w)w<64?et[Ge++]=w:w<256?(et[Ge++]=204,et[Ge++]=w):w<65536?(et[Ge++]=205,et[Ge++]=w>>8,et[Ge++]=w&255):(et[Ge++]=206,Vi.setUint32(Ge,w),Ge+=4);else if(w>>0===w)w>=-32?et[Ge++]=256+w:w>=-128?(et[Ge++]=208,et[Ge++]=w+256):w>=-32768?(et[Ge++]=209,Vi.setInt16(Ge,w),Ge+=2):(et[Ge++]=210,Vi.setInt32(Ge,w),Ge+=4);else{let A;if((A=this.useFloat32)>0&&w<4294967296&&w>=-2147483648){et[Ge++]=202,Vi.setFloat32(Ge,w);let M;if(A<4||(M=w*NP[(et[Ge]&127)<<1|et[Ge+1]>>7])>>0===M){Ge+=4;return}else Ge--}et[Ge++]=203,Vi.setFloat64(Ge,w),Ge+=8}else if(_==="object")if(!w)et[Ge++]=192;else{if(a){let M=a.get(w);if(M){if(!M.id){let P=a.idsToInsert||(a.idsToInsert=[]);M.id=P.push(M)}et[Ge++]=214,et[Ge++]=112,Vi.setUint32(Ge,M.id),Ge+=4;return}else a.set(w,{offset:Ge-t})}let A=w.constructor;if(A===Object)x(w,!0);else if(A===Array){C=w.length,C<16?et[Ge++]=144|C:C<65536?(et[Ge++]=220,et[Ge++]=C>>8,et[Ge++]=C&255):(et[Ge++]=221,Vi.setUint32(Ge,C),Ge+=4);for(let M=0;M<C;M++)b(w[M])}else if(A===Map){C=w.size,C<16?et[Ge++]=128|C:C<65536?(et[Ge++]=222,et[Ge++]=C>>8,et[Ge++]=C&255):(et[Ge++]=223,Vi.setUint32(Ge,C),Ge+=4);for(let[M,P]of w)b(M),b(P)}else{for(let M=0,P=Rx.length;M<P;M++){let T=UP[M];if(w instanceof T){let R=Rx[M];if(R.write){R.type&&(et[Ge++]=212,et[Ge++]=R.type,et[Ge++]=0),b(R.write.call(this,w));return}let z=et,F=Vi,H=Ge;et=null;let N;try{N=R.pack.call(this,w,U=>(et=z,z=null,Ge+=U,Ge>Cs&&S(Ge),{target:et,targetView:Vi,position:Ge-U}),b)}finally{z&&(et=z,Vi=F,Ge=H,Cs=et.length-10)}N&&(N.length+Ge>Cs&&S(N.length+Ge),Ge=aPe(N,et,Ge,R.type));return}}x(w,!w.hasOwnProperty)}}else if(_==="boolean")et[Ge++]=w?195:194;else if(_==="bigint"){if(w<BigInt(1)<<BigInt(63)&&w>=-(BigInt(1)<<BigInt(63)))et[Ge++]=211,Vi.setBigInt64(Ge,w);else if(w<BigInt(1)<<BigInt(64)&&w>0)et[Ge++]=207,Vi.setBigUint64(Ge,w);else if(this.largeBigIntToFloat)et[Ge++]=203,Vi.setFloat64(Ge,Number(w));else throw new RangeError(w+" was too large to fit in MessagePack 64-bit integer format, set largeBigIntToFloat to convert to float-64");Ge+=8}else if(_==="undefined")this.encodeUndefinedAsNil?et[Ge++]=192:(et[Ge++]=212,et[Ge++]=0,et[Ge++]=0);else if(_==="function")b(this.writeFunction&&this.writeFunction());else throw new Error("Unknown type: "+_)},x=this.useRecords===!1?this.variableMapSize?w=>{let _=Object.keys(w),C=_.length;C<16?et[Ge++]=128|C:C<65536?(et[Ge++]=222,et[Ge++]=C>>8,et[Ge++]=C&255):(et[Ge++]=223,Vi.setUint32(Ge,C),Ge+=4);let A;for(let M=0;M<C;M++)b(A=_[M]),b(w[A])}:(w,_)=>{et[Ge++]=222;let C=Ge-t;Ge+=2;let A=0;for(let M in w)(_||w.hasOwnProperty(M))&&(b(M),b(w[M]),A++);et[C+++t]=A>>8,et[C+t]=A&255}:w=>{let _=Object.keys(w),C,A=n.transitions||(n.transitions=Object.create(null)),M=0;for(let T=0,R=_.length;T<R;T++){let z=_[T];C=A[z],C||(C=A[z]=Object.create(null),M++),A=C}let P=A[Tm];if(P)P>=96&&f?(et[Ge++]=((P-=96)&31)+96,et[Ge++]=P>>5):et[Ge++]=P;else{P=n.nextId,P||(P=64),P<p&&this.shouldShareStructure&&!this.shouldShareStructure(_)?(P=n.nextOwnId,P<v||(P=p),n.nextOwnId=P+1):(P>=v&&(P=p),n.nextId=P+1);let T=_.highByte=P>=96&&f?P-96>>5:-1;A[Tm]=P,n[P-64]=_,P<p?(_.isShared=!0,n.sharedLength=P-63,i=!0,T>=0?(et[Ge++]=(P&31)+96,et[Ge++]=T):et[Ge++]=P):(T>=0?(et[Ge++]=213,et[Ge++]=114,et[Ge++]=(P&31)+96,et[Ge++]=T):(et[Ge++]=212,et[Ge++]=114,et[Ge++]=P),M&&(g+=y*M),m.length>=h&&(m.shift()[Tm]=0),m.push(A),b(_))}for(let T=0,R=_.length;T<R;T++)b(w[_[T]])},S=w=>{let _;if(w>16777216){if(w-t>Ck)throw new Error("Packed buffer would be larger than maximum buffer size");_=Math.min(Ck,Math.round(Math.max((w-t)*(w>67108864?1.25:2),4194304)/4096)*4096)}else _=(Math.max(w-t<<2,et.length-1)>>12)+1<<12;let C=new bC(_);return Vi=new DataView(C.buffer,0,_),et.copy?et.copy(C,0,t,w):C.set(et.slice(t,w)),Ge-=t,t=0,Cs=C.length-10,et=C}}useBuffer(e){et=e,Vi=new DataView(et.buffer,et.byteOffset,et.byteLength),Ge=0}};UP=[Date,Set,Error,RegExp,ArrayBuffer,Object.getPrototypeOf(Uint8Array.prototype).constructor,$V];Rx=[{pack(e,t,r){let i=e.getTime()/1e3;if((this.useTimestamp32||e.getMilliseconds()===0)&&i>=0&&i<4294967296){let{target:n,targetView:a,position:o}=t(6);n[o++]=214,n[o++]=255,a.setUint32(o,i)}else if(i>0&&i<17179869184){let{target:n,targetView:a,position:o}=t(10);n[o++]=215,n[o++]=255,a.setUint32(o,e.getMilliseconds()*4e6+(i/1e3/4294967296>>0)),a.setUint32(o+4,i)}else if(isNaN(i)){if(this.onInvalidDate)return t(0),r(this.onInvalidDate());let{target:n,targetView:a,position:o}=t(3);n[o++]=212,n[o++]=255,n[o++]=255}else{let{target:n,targetView:a,position:o}=t(15);n[o++]=199,n[o++]=12,n[o++]=255,a.setUint32(o,e.getMilliseconds()*1e6),a.setBigInt64(o+4,BigInt(Math.floor(i)))}}},{pack(e,t,r){let i=Array.from(e),{target:n,position:a}=t(this.structuredClone?3:0);this.structuredClone&&(n[a++]=212,n[a++]=115,n[a++]=0),r(i)}},{pack(e,t,r){let{target:i,position:n}=t(this.structuredClone?3:0);this.structuredClone&&(i[n++]=212,i[n++]=101,i[n++]=0),r([e.name,e.message])}},{pack(e,t,r){let{target:i,position:n}=t(this.structuredClone?3:0);this.structuredClone&&(i[n++]=212,i[n++]=120,i[n++]=0),r([e.source,e.flags])}},{pack(e,t){this.structuredClone?_k(e,16,t):Ak(hw?Buffer.from(e):new Uint8Array(e),t)}},{pack(e,t){let r=e.constructor;r!==e8&&this.structuredClone?_k(e,ZV.indexOf(r.name),t):Ak(e,t)}},{pack(e,t){let{target:r,position:i}=t(1);r[i]=193}}];function _k(e,t,r,i){let n=e.byteLength;if(n+1<256){var{target:a,position:o}=r(4+n);a[o++]=199,a[o++]=n+1}else if(n+1<65536){var{target:a,position:o}=r(5+n);a[o++]=200,a[o++]=n+1>>8,a[o++]=n+1&255}else{var{target:a,position:o,targetView:s}=r(7+n);a[o++]=201,s.setUint32(o,n+1),o+=4}a[o++]=116,a[o++]=t,a.set(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),o)}function Ak(e,t){let r=e.byteLength;var i,n;if(r<256){var{target:i,position:n}=t(r+2);i[n++]=196,i[n++]=r}else if(r<65536){var{target:i,position:n}=t(r+3);i[n++]=197,i[n++]=r>>8,i[n++]=r&255}else{var{target:i,position:n,targetView:a}=t(r+5);i[n++]=198,a.setUint32(n,r),n+=4}i.set(e,n)}function aPe(e,t,r,i){let n=e.length;switch(n){case 1:t[r++]=212;break;case 2:t[r++]=213;break;case 4:t[r++]=214;break;case 8:t[r++]=215;break;case 16:t[r++]=216;break;default:n<256?(t[r++]=199,t[r++]=n):n<65536?(t[r++]=200,t[r++]=n>>8,t[r++]=n&255):(t[r++]=201,t[r++]=n>>24,t[r++]=n>>16&255,t[r++]=n>>8&255,t[r++]=n&255)}return t[r++]=i,t.set(e,r),r+=n,r}function oPe(e,t){let r,i=t.length*6,n=e.length-i;for(t.sort((a,o)=>a.offset>o.offset?1:-1);r=t.pop();){let a=r.offset,o=r.id;e.copyWithin(a+i,a,n),i-=6;let s=a+i;e[s++]=214,e[s++]=105,e[s++]=o>>24,e[s++]=o>>16&255,e[s++]=o>>8&255,e[s++]=o&255,n=a}return e}function Qp(e){if(e.Class){if(!e.pack&&!e.write)throw new Error("Extension has no pack or write function");if(e.pack&&!e.type)throw new Error("Extension has no type (numeric code to identify the extension)");UP.unshift(e.Class),Rx.unshift(e)}rPe(e)}var r8=new t8({useRecords:!1});r8.pack;r8.pack;var sPe=512,lPe=1024,Mk=new t8({structuredClone:!0});Qp({Class:kt.prototype.constructor,type:1,write(e){return{...e}},read(e){return Object.setPrototypeOf(e,kt.prototype),e}});Qp({Class:Dt.prototype.constructor,type:2,write(e){return[...e]},read(e){return Object.setPrototypeOf(e,Dt.prototype),e}});Qp({Class:Jn.prototype.constructor,type:3,write(e){return[...e]},read(e){return Object.setPrototypeOf(e,Jn.prototype),e}});Qp({Class:pk.prototype.constructor,type:4,write(e){return e.id},read(e){return new pk(e)}});Qp({Class:mk.prototype.constructor,type:5,write(e){return e.data},read(e){return new mk(e)}});Qp({Class:cn.prototype.constructor,type:6,write(e){return{...e}},read(e){return Object.setPrototypeOf(e,cn.prototype),e}});function cPe(e){var t=0;if(e.length===0)return t;for(let r=0;r<e.length;r++){let i=e[r];t=(t<<5)-t+i,t=t&t}return t}function QA(e){if(RP(e))return e;if(Array.isArray(e))return e.map(QA);if(typeof e=="object"&&e!==null){let t={};for(let r of Object.keys(e).sort())t[r]=QA(e[r]);return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),t}else return e}var ZA;(e=>{function t(n){return Mk.pack(n)}e.serialize=t;function r(n){return Mk.unpack(n)}e.deserialize=r;function i(n){return cPe(t(QA(n))).toString()}e.checksum=i})(ZA||(ZA={}));var Ek;(e=>{function t(i){return i.type==="Conditional"?i.condition.type==="Distance"?"Distance":"StateChange":i.type}e.toEventUIType=t;function r(i){return i==="Distance"||i==="StateChange"?"Conditional":i}e.fromEventUIType=r})(Ek||(Ek={}));function Tk(e){return e==="MouseDown"||e==="MouseUp"||e==="KeyDown"||e==="KeyUp"||e==="Collision"||e==="Trigger"}var la={LookAt:[],Follow:["Create"],DragDrop:["Transition","Animation","Audio","Particles","Create","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],MouseHover:["Transition","Animation","Particles","Create","Destroy","SwitchCamera","SceneTransition","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],Scroll:["Transition","Animation","Create","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],Start:["Transition","Animation","Audio","Particles","Video","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],Conditional:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],MouseDown:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],MouseUp:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],MousePress:["Transition","Animation","Audio","Particles","Video","Link","Create","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],KeyDown:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],KeyUp:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],KeyPress:["Transition","Animation","Audio","Particles","Video","Link","Create","SwitchCamera","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],GameControl:["Transition","Animation","Audio","Particles","Create","Conditional"],Collision:["Transition","Animation","Audio","Particles","Video","Create","Destroy","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],Trigger:["Transition","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],Resize:["Transition","Animation","Audio","Particles","Video","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],VariableChange:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],API:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],WEBHOOK:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"]},Pk;(e=>{function t(i){return i.type==="MouseDown"||i.type==="MouseUp"||i.type==="MousePress"||i.type==="KeyDown"||i.type==="KeyUp"||i.type==="KeyPress"}e.is=t;function r(i){return i==="MouseDown"||i==="MouseUp"||i==="MousePress"?{type:i,mode:"Object",disabled:!1,actions:new Dt}:{type:i,disabled:!1,key:void 0,actions:new Dt}}e.defaultData=r})(Pk||(Pk={}));var Ix;(e=>{function t(r){return{type:"Property",value:[r??null,"position","x"]}}e.propertyDefaultData=t,e.valueDefaultData={type:"Literal",value:0}})(Ix||(Ix={}));var JA;(e=>{function t(n){return{type:"Comparison",operator:"==",lOperand:Ix.propertyDefaultData(n),rOperand:{...Ix.valueDefaultData}}}e.comparisonDefaultData=t;function r(n){return{type:"Distance",toObject:n??null,fromObject:n??null,distance:200}}e.distanceDefaultData=r;function i(n,a){return{type:"State",object:n??null,state:a??null}}e.stateDefaultData=i})(JA||(JA={}));var Dk;(e=>{function t(r){return r.find(i=>i==="ifActions"||i==="elseActions")!==void 0}e.isConditionalSubActions=t})(Dk||(Dk={}));var Ok;(e=>{function t(i){return i.type==="Conditional"}e.is=t;function r(i){return{type:"Conditional",disabled:!1,inActions:new Dt,outActions:new Dt,condition:JA.distanceDefaultData(i)}}e.defaultData=r})(Ok||(Ok={}));var Rk;(e=>e.defaultData={type:"DragDrop",cursor:"hand",disabled:!1,dampingFactor:1,objects:[],snapTo:"center",snapSurfaceMode:"bbox",snapSurfaceOffset:0,dropOn:"all",autoOrient:!0,dropDestinations:[],plane:"adaptive",planeMode:"locked",referenceFrame:"global",limits:[-1/0,1/0,-1/0,1/0,-1/0,1/0],drop:!1,resetOnSnapFail:!1,snapSpeed:20,resetSpeed:20,dragDropActions:{drag:new Dt,drop:new Dt}})(Rk||(Rk={}));var eM;(e=>e.defaultData={type:"Follow",disabled:!1,maxDelta:0,dampingFactor:1,target:"cursor",plane:"custom",resetOnPointerLeave:!0,resetAfterDistanceLimit:!0,enabledTranslation:[!0,!0,!0],limitDistanceEnabled:!1,limitDistance:1e3,snapDelay:0,resetSpeed:5,actions:new Dt})(eM||(eM={}));var tM;(e=>e.defaultData={type:"LookAt",disabled:!1,distance:1e3,dampingFactor:1,target:"cursor",tilt:"up",axis:"z",plane:"custom",resetOnPointerLeave:!0,resetAfterDistanceLimit:!0,enabledRotation:[!0,!0,!0],limitDistanceEnabled:!1,limitDistance:1e3,snapDelay:0,resetSpeed:5})(tM||(tM={}));var Ik;(e=>{function t(i){return i.type==="MouseHover"}e.is=t;function r(){return{type:"MouseHover",disabled:!1,actions:new Dt}}e.defaultData=r})(Ik||(Ik={}));var zk;(e=>{function t(i){return i.type==="Scroll"}e.is=t;function r(){return{type:"Scroll",disabled:!1,steps:100,trigger:"load",startFrom:"enter",enterAnchor:"top",startOffset:0,endAfter:400,actions:new Dt}}e.defaultData=r})(zk||(zk={}));var kk;(e=>{function t(i){return i.type==="Start"}e.is=t;function r(){return{type:"Start",disabled:!1,actions:new Dt}}e.defaultData=r})(kk||(kk={}));var Lk;(e=>{function t(i){return i.type==="Collision"}e.is=t;function r(){return{type:"Collision",disabled:!1,target:"character",actions:new Dt}}e.defaultData=r})(Lk||(Lk={}));var Bk;(e=>{function t(i){return i.type==="Trigger"}e.is=t;function r(i,n){return{type:"Trigger",disabled:!1,target:"all",triggeringObjects:[],actions:new Dt,triggerZone:"box",position:n.toArray(),rotation:[0,0,0],size:i.toArray(),radius:i.length()/2,helperVisible:!0}}e.defaultData=r})(Bk||(Bk={}));var rM;(e=>{e.defaultSizes={mobile:[480,480],tablet:[768,768],desktop:[1200,1200],custom:[769,1200]};function t(o){return o.type==="Resize"}e.is=t;function r(o){return typeof o=="string"?o:"custom"}e.sizeToDevice=r;function i(o){return typeof o=="string"?[...e.defaultSizes[o]]:[...o]}e.deviceToSize=i;function n(){let o={size:"mobile",operator:"<",actions:new Dt},s={size:"tablet",operator:"<",actions:new Dt},l={size:[...e.defaultSizes.custom],operator:"<>",actions:new Dt},c=new Dt;return c.push({id:St.generateUUID(),fi:0,data:o},{id:St.generateUUID(),fi:1,data:s},{id:St.generateUUID(),fi:2,data:l}),{type:"Resize",disabled:!1,orientation:"horizontal",breakpoints:c}}e.defaultData=n;function a(){return{size:[...e.defaultSizes.custom],operator:"<>",actions:new Dt}}e.defaultBreakpointData=a})(rM||(rM={}));var iM;(e=>{e.propertyPaths={Position:["position"],"Position X":["position","x"],"Position Y":["position","y"],"Position Z":["position","z"],Rotation:["rotation"],"Rotation X":["rotation","x"],"Rotation Y":["rotation","y"],"Rotation Z":["rotation","z"],Scale:["scale"],"Scale X":["scale","x"],"Scale Y":["scale","y"],"Scale Z":["scale","z"],Width:["width"],Height:["height"],Depth:["depth"],"Mouse Position X":["mouse","x"],"Mouse Position Y":["mouse","y"],"Mouse Pressed":["mouse","pressed"],"Screen Width":["mouse","width"],"Screen Height":["mouse","height"],"Hit Position X":["raycast","x"],"Hit Position Y":["raycast","y"],"Hit Position Z":["raycast","z"],"Hit Object Position X":["raycast","objX"],"Hit Object Position Y":["raycast","objY"],"Hit Object Position Z":["raycast","objZ"]};function t(i){return i.type==="VariableChange"}e.is=t;function r(){return{disabled:!1,type:"VariableChange",actions:new Dt,variableId:"",objectId:null,property:"Position X"}}e.defaultData=r})(iM||(iM={}));var Fk;(e=>{function t(i){return i.type==="API"}e.is=t;function r(){return{disabled:!1,type:"API",successActions:new Dt,errorActions:new Dt,userAPIId:""}}e.defaultData=r})(Fk||(Fk={}));var Nk;(e=>{function t(i){return i.type==="WEBHOOK"}e.is=t;function r(){return{disabled:!1,type:"WEBHOOK",actions:new Dt,userWebhookId:""}}e.defaultData=r})(Nk||(Nk={}));var Zp="personal camera",Tv="a218fcc3-276b-49b9-b485-49037fd14f5f",dPe=2960946,co=5526619,ql;(e=>{function t(p,v){return p[0]===v[0]&&p[1]===v[1]}e.isEqual=t;function r(p,v,m){return[p[0]+(v[0]-p[0])*m,p[1]+(v[1]-p[1])*m]}e.lerp=r;function i(p,v){return[p[0]+v[0],p[1]+v[1]]}e.add=i;function n(p,v){return[p[0]-v[0],p[1]-v[1]]}e.sub=n;function a(p,v){return[p[0]*v[0],p[1]*v[1]]}e.multiply=a;function o(p,v){return[p[0]/v[0],p[1]/v[1]]}e.divide=o;function s(p,v){return Math.pow(v[0]-p[0],2)+Math.pow(v[1]-p[1],2)}e.distanceSquared=s;function l(p,v){return Math.sqrt(s(p,v))}e.distance=l;function c(p,v){return p[0]*v[0]+p[1]*v[1]}e.dot=c;function d(p,v){return[p[0]*v,p[1]*v]}e.scalarMultiply=d;function u(p,v,m){let g=e.sub(v,p),y=e.sub(m,p),b=e.dot(g,y)/e.dot(g,g),x=e.scalarMultiply(g,b);return e.add(p,x)}e.projectionOnto=u;function h(p,v,m){return l(p,u(p,v,m))}e.projectionOntoDistance=h;function f(p,v){return[(p[0]+v[0])*.5,(p[1]+v[1])*.5]}e.center=f})(ql||(ql={}));var Vu;(e=>{function t(l,c){return l[0]===c[0]&&l[1]===c[1]&&l[2]===c[2]}e.isEqual=t;function r(l,c){return[l[0]+c[0],l[1]+c[1],l[2]+c[2]]}e.add=r;function i(l,c){return[l[0]-c[0],l[1]-c[1],l[2]-c[2]]}e.sub=i;function n(l,c){return[l[0]/c[0],l[1]/c[1],l[2]/c[2]]}e.div=n;function a(l,c){return[l[0]*c[0],l[1]*c[1],l[2]*c[2]]}e.mul=a;function o(l,c){return Math.hypot(l[0]-c[0],l[1]-c[1],l[2]-c[2])}e.dist=o;function s(l,c,d){return[l[0]+(c[0]-l[0])*d,l[1]+(c[1]-l[1])*d,l[2]+(c[2]-l[2])*d]}e.lerp=s})(Vu||(Vu={}));var zx;(e=>{function t(i,n){return i[0]===n[0]&&i[1]===n[1]&&i[2]===n[2]&&i[3]===n[3]}e.isEqual=t;function r(i,n,a){return[i[0]+(n[0]-i[0])*a,i[1]+(n[1]-i[1])*a,i[2]+(n[2]-i[2])*a,i[3]+(n[3]-i[3])*a]}e.lerp=r})(zx||(zx={}));var Uk;(e=>{let t=180/Math.PI,r=Math.PI/180;function i(s){return typeof s=="number"?s*t:s}function n(s){return typeof s=="number"?s*r:s}function a(s){return[i(s[0]),i(s[1]),i(s[2])]}e.radToDeg=a;function o(s){return[n(s[0]),n(s[1]),n(s[2])]}e.degToRad=o})(Uk||(Uk={}));var wp;(e=>{e.identity=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function t(n,a){for(let o=0;o<16;o++)if(n[o]!==a[o])return!1;return!0}e.isEqual=t;function r(n){return n??e.identity}e.simplify=r;function i(n,a){let o=a.slice(0);for(var s=0,l=a.length;s<l;s+=3){let c=n[3]*a[s]+n[7]*a[s+1]+n[11]*a[s+2]+n[15];o[s]=(n[0]*a[s]+n[4]*a[s+1]+n[8]*a[s+2]+n[12])/c,o[s+1]=(n[1]*a[s]+n[5]*a[s+1]+n[9]*a[s+2]+n[13])/c,o[s+2]=(n[2]*a[s]+n[6]*a[s+1]+n[10]*a[s+2]+n[14])/c}return o}e.applyMatrix4=i})(wp||(wp={}));var Qn;(e=>{function t(c){return typeof c=="object"&&typeof c.r=="number"&&typeof c.g=="number"&&typeof c.b=="number"}e.isRGB=t,e.white={r:1,g:1,b:1},e.red={r:1,g:0,b:0},e.black={r:0,g:0,b:0};function r(c){return{r:Math.round(c.r*255),g:Math.round(c.g*255),b:Math.round(c.b*255),a:1}}e.toRgb255a1=r;function i(c){return{r:c.r,g:c.g,b:c.b}}e.clone=i;function n(c){return c=Math.floor(c),{r:(c>>16&255)/255,g:(c>>8&255)/255,b:(c&255)/255}}e.fromHex=n;function a(c){return Math.round(c.r*255)*65536+Math.round(c.g*255)*256+Math.round(c.b*255)}e.toHex=a;function o(c,d){return c.r===d.r&&c.g===d.g&&c.b===d.b}e.equals=o;function s(c,d){return c.r.toFixed(2)===d.r.toFixed(2)&&c.g.toFixed(2)===d.g.toFixed(2)&&c.b.toFixed(2)===d.b.toFixed(2)}e.equalsFixed=s;function l(c,d,u){return{r:c.r+(d.r-c.r)*u,g:c.g+(d.g-c.g)*u,b:c.b+(d.b-c.b)*u}}e.lerp=l})(Qn||(Qn={}));var ri;(e=>{e.white={...Qn.white,a:1},e.transparent={...Qn.white,a:0};function t(l){return{r:l[0],g:l[1],b:l[2],a:l[3]}}e.from0to1=t;function r(l,c){return{...Qn.fromHex(l),a:c}}e.fromHexAndA=r;function i(l){return{r:Math.round(l.r*255),g:Math.round(l.g*255),b:Math.round(l.b*255),a:l.a}}e.toRgb255a1=i;function n(l,c){return Qn.equals(l,c)&&l.a===c.a}e.equals=n;function a(l,c){return Qn.equalsFixed(l,c)&&l.a.toFixed(2)===c.a.toFixed(2)}e.equalsFixed=a;function o(l,c,d){return{r:l.r+(c.r-l.r)*d,g:l.g+(c.g-l.g)*d,b:l.b+(c.b-l.b)*d,a:l.a+(c.a-l.a)*d}}e.lerp=o;function s({r:l,g:c,b:d,a:u}=e.white){return`rgba(${l*255}, ${c*255}, ${d*255}, ${u})`}e.toStyle=s})(ri||(ri={}));var nM;(e=>e.identity={position:[0,0,0],rotation:[0,0,0],scale:[1,1,1]})(nM||(nM={}));var jk;(e=>e.defaultData={mass:1,stiffness:80,damping:10,velocity:0})(jk||(jk={}));var Vk;(e=>e.defaultData={control1:[.5,0],control2:[.5,1]})(Vk||(Vk={}));var Gc;(e=>(e.linear=[0,0,1,1],e.ease=[.25,.1,.25,1],e.easeIn=[.42,0,1,1],e.easeOut=[0,0,.58,1],e.easeInOut=[.42,0,.58,1]))(Gc||(Gc={}));function Hk(e){return typeof e=="string"&&e.length===36?/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e):!1}var ah;(e=>{e.all=["PerspectiveCamera","OrthographicCamera"];function t(r){return e.all.includes(r)}e.is=t})(ah||(ah={}));var Sp;(e=>{e.DefaultUp=[0,1,0],e.DefaultTargetOffset=1e3,e.defaultData={far:1e5,type:"OrthographicCamera",perspective:{near:70,fov:45,zoom:1},orthographic:{near:-1e5,zoom:1},up:e.DefaultUp,isUpVectorFlipped:!1,targetOffset:e.DefaultTargetOffset};function t(r){var i,n;return r.type==="PerspectiveCamera"?((i=r.perspective)==null?void 0:i.zoom)??1:((n=r.orthographic)==null?void 0:n.zoom)??1}e.getZoom=t})(Sp||(Sp={}));var td;(e=>{function t(i,n=.1){return{disabled:!1,type:"linear",hideBase:!1,count:3,radial:{radius:Math.max(i[0],i[1])*2,start:0,end:360,alignment:!1,axis:"y",scale:[1,1,1],rotation:[0,0,0],position:[0,0,0]},toObject:{object:"",spreadType:"random",scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],axis:"x",seed:0,count:99,align:"normal"},linear:{scale:[1,1,1],rotation:[0,0,0],position:[i[0]+i[0]*n,0,0]},grid:{count:[2,2,2],size:i.map(a=>a*(1+n)),useCenter:!0},randomness:!1,randomnessObject:{strength:100,scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],movement:1,seed:0,freqScale:10,noiseType:"perlin"}}}e.defaultData=t;function r(i,n){let a={...i};if(i8.forEach(o=>{Object.assign(a,{[o]:n[o]??i[o]})}),a.radial={...i.radial},n.radial){let o=i.radial,s=n.radial;n8.forEach(l=>{Object.assign(a.radial,{[l]:s[l]??o[l]})})}if(a.linear={...i.linear},n.linear){let o=i.linear,s=n.linear;a8.forEach(l=>{Object.assign(a.linear,{[l]:s[l]??o[l]})})}if(a.grid={...i.grid},n.grid){let o=i.grid,s=n.grid;o8.forEach(l=>{Object.assign(a.grid,{[l]:s[l]??o[l]})})}if(a.toObject={...i.toObject},n.toObject){let o=i.toObject,s=n.toObject;s8.forEach(l=>{Object.assign(a.toObject,{[l]:s[l]??o[l]})})}if(a.randomnessObject={...i.randomnessObject},n.randomnessObject){let o=i.randomnessObject,s=n.randomnessObject;l8.forEach(l=>{Object.assign(a.randomnessObject,{[l]:s[l]??o[l]})})}return a}e.merge=r})(td||(td={}));var aM;(e=>{e.defaultData={radial:{},linear:{},grid:{},toObject:{},randomnessObject:{}};let t=["radial","linear","grid","toObject","randomnessObject"];function r(i,n){let a=[];i.count!==void 0&&a.push({type:0,path:n,props:{count:i.count}});for(let o of t){let s=i[o];s&&Object.keys(s).length>0&&a.push({type:0,path:[...n,o],props:s})}return a}e.toOps=r})(aM||(aM={}));var i8=["count"],n8=["radius","start","end","position","scale","rotation"],a8=["position","scale","rotation"],o8=["count","size"],s8=["count","position","scale","rotation"],l8=["strength","scale","rotation","position","movement","seed","freqScale"],oM;(e=>{e.all=["PointLight","SpotLight","DirectionalLight","HemisphereLight"];function t(r){return e.all.includes(r)}e.is=t})(oM||(oM={}));var sM;(e=>{function t(i){return r(i)}e.defaultData=t;function r(i){if(i==="PointLight")return{type:i,color:ri.white,intensity:1,distance:2e3,decay:1,shadows:!0,shadowResolution:1024,shadowRadius:1,penumbraSize:.5,depth:1e5};if(i==="SpotLight")return{type:i,color:ri.white,intensity:1,distance:2e3,decay:1,shadows:!0,penumbra:0,angle:30/180*Math.PI,depth:1e5,penumbraSize:.5,shadowResolution:1024,shadowRadius:1};if(i==="DirectionalLight")return{type:i,color:ri.white,intensity:1,shadows:!0,size:2e3,depth:1e5,penumbraSize:.5,shadowResolution:1024,shadowRadius:1};throw new Error("not implemented")}})(sM||(sM={}));var kx;(e=>(e.defaultShapeData={type:"PlaneEmitterShape",size:[100,100,100]},e.defaultCollisionData={colliderEntityId:null,collisionBounce:.75},e.defaultData={renderMaterial:{type:"particleMaterial",color:{r:1,g:.2,b:.545,a:1},color2:{r:.945,g:.714,b:.184,a:1},coloring:"gradient",ease:"linearFadeOut",easeSize:"linearFadeOut",transparent:!0,size:[40,40],texture:"pt_default_particle",spriteRotation:[0,0]},birthRatePerSec:50,gravity:1,noiseStrength:0,noiseScale:0,noiseSeed:1,noiseType:"curl",randomRotation:0,randomScale:.2,randomMass:.5,rootObjectType:"instancedMesh",life:1,direction:[0,0,0],directionMode:"axis",speed:10,shape:e.defaultShapeData,autoPlay:!0,emitTimeDelay:0,emitTimeCycle:"infinity",emitTimeDuration:1,...e.defaultCollisionData}))(kx||(kx={}));var Cp;(e=>e.defaultData={enabled:"visibility",fusedBody:!0,rigidBody:"positioned",density:1,pointMass:0,gravityScale:1,friction:.5,damping:0,restitution:.2,colliderType:"convex",enabledRotation:[!0,!0,!0],enabledTranslation:[!0,!0,!0]})(Cp||(Cp={}));var lM;(e=>{e.defaultData={castShadow:!0,receiveShadow:!0};function t(r,i){return r.castShadow===i.castShadow&&r.receiveShadow===i.receiveShadow}e.equals=t})(lM||(lM={}));var cM;(e=>{e.defaultData={flatShading:!1,wireframe:!1,side:0};function t(r,i){return r.flatShading===i.flatShading&&r.side===i.side&&r.wireframe===i.wireframe}e.equals=t})(cM||(cM={}));var dM;(e=>e.defaultData={...cM.defaultData,...lM.defaultData})(dM||(dM={}));var Wk;(e=>{function t(r,i){var a,o;let n=[];if("material"in r){let s=typeof r.material=="string"?i.materials[r.material]??((a=i.lib.materials[r.material])==null?void 0:a.asset):r.material;s&&n.push(s)}else if("materials"in r)for(let s of r.materials){let l=typeof s=="string"?i.materials[s]??((o=i.lib.materials[s])==null?void 0:o.asset):s;l&&n.push(l)}return n}e.getMaterialData=t})(Wk||(Wk={}));var Lx;(e=>(e.defaultVideo={data:"",thumb:"/_assets/_videos/catThumb.png",type:"video",name:"Cat video"},e.maxSize=3e7))(Lx||(Lx={}));var Gk;(e=>{function t(r){return r==="texture"||r==="video"||r==="color"||r==="depth"||r==="normal"||r==="gradient"||r==="noise"||r==="fresnel"||r==="rainbow"||r==="toon"||r==="outline"||r==="particle"||r==="transmission"||r==="matcap"||r==="displace"||r==="pattern"||r==="light"}e.is=t})(Gk||(Gk={}));function uPe(e){return e.type!=="displace"}var $k;(e=>{function t(r){return r==="phong"||r==="toon"||r==="lambert"||r==="physical"}e.is=t})($k||($k={}));var c8=["mode","gradientType","noiseType","displacementType","projection","cnormal","crop","axis","side"],hPe=["wrapping","image","video","name","minFilter","magFilter"],Tn;(e=>{function t(a,o){let{texture:s,...l}=o;if(Object.assign(a,l),s){let c=a.texture;c&&Object.assign(c,s)}}e.patch=t;function r(a,o){return a==="light"&&o?i(o):n(a)}e.defaultData=r;function i(a){let o={mode:0,isMask:!1,visible:!0,bumpMap:void 0,bumpMapIntensity:5,roughnessMap:void 0,alphaOverride:1};switch(a){case"phong":return{...o,category:"phong",specular:{r:.2,g:.2,b:.2},shininess:5,type:"light",visible:!0,mode:0,occlusion:!0,alpha:.6};case"toon":return{...o,category:"toon",specular:{r:.2,g:.2,b:.2},shininess:10,type:"light",alpha:1};case"lambert":return{...o,category:"lambert",emissive:{r:0,g:0,b:0},type:"light",alpha:1,visible:!0,mode:0,occlusion:!0};case"physical":return{...o,category:"physical",roughness:.2,metalness:.2,reflectivity:.2,type:"light",alpha:1,visible:!0,mode:0,occlusion:!0}}}function n(a){let o={alpha:1,mode:0,isMask:!1,visible:!0};switch(a){case"texture":return{...o,type:"texture",size:[128,128],blending:0,axis:"x",side:2,projection:0,texture:{image:"image_0",wrapping:1e3,repeat:[1,1],offset:[0,0],rotation:0,minFilter:1008,magFilter:1006},crop:!1};case"video":return{...o,type:"video",size:[128,128],blending:0,axis:"x",side:2,projection:0,texture:{video:Lx.defaultVideo,wrapping:1001,repeat:[1,1],offset:[0,0],rotation:0,minFilter:1008,magFilter:1006},crop:!1};case"color":return{...o,type:"color",color:Qn.fromHex(co)};case"depth":return{...o,type:"depth",gradientType:1,smooth:!1,isVector:!0,isWorldSpace:!1,origin:[0,0,0],direction:[1,0,0],colors:[[1,1,1,1],[0,0,0,1]],steps:[0,1],near:50,far:200};case"normal":return{...o,type:"normal",cnormal:[1,1,1]};case"gradient":return{...o,type:"gradient",gradientType:0,smooth:!1,colors:[[0,0,0,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1]],steps:[0,1,1,1,1,1,1,1,1,1],num:2,angle:0,offset:[0,0],morph:[0,0]};case"noise":return{...o,type:"noise",size:[100,100,100],noiseType:0,scale:1,move:1,colorA:{...Qn.fromHex(6710886),a:1},colorB:{...Qn.fromHex(6710886),a:1},colorC:{...Qn.fromHex(16777215),a:1},colorD:{...Qn.fromHex(16777215),a:1},distortion:[1,1],fA:[1.7,9.2],fB:[8.3,2.8],voronoiStyle:0,highCut:1,lowCut:0,smoothness:.3,seed:0,quality:1};case"fresnel":return{...o,type:"fresnel",color:ri.fromHexAndA(16777215,1),bias:.1,scale:1,intensity:2,factor:1};case"rainbow":return{...o,type:"rainbow",filmThickness:30,movement:0,wavelengths:[0,0,0],noiseStrength:0,noiseScale:1,offset:[0,0,0]};case"toon":return{...o,type:"toon",positioning:2,colors:[[0,0,0,1],[.5,.5,.5,1],[.5,.5,.5,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1]],steps:[0,.475,.525,1,1,1,1,1,1,1],num:4,source:[0,1e3,0],isWorldSpace:!0,noiseStrength:0,noiseScale:1,shadowColor:ri.fromHexAndA(0,0),offset:[0,0,0]};case"outline":return{...o,type:"outline",outlineColor:ri.fromHexAndA(0,1),contourColor:ri.fromHexAndA(0,1),outlineWidth:2,contourWidth:5,outlineThreshold:.4,contourThreshold:0,outlineSmoothing:0,contourFrequency:10,contourDirection:[0,1,0],positionalLines:!1,compensation:!0};case"matcap":return{...o,type:"matcap",texture:{image:"matcap_0",wrapping:1001,repeat:[1,1],offset:[0,0],rotation:0,minFilter:1008,magFilter:1006}};case"transmission":return{...o,type:"transmission",thickness:10,ior:1.5,roughness:1};case"displace":return{visible:!0,type:"displace",displacementType:"noise",noiseType:0,scale:10,movement:1,offset:[0,0,0],intensity:8,voronoiStyle:0,smoothness:.3,seed:0,highCut:1,lowCut:0,quality:1};case"pattern":return{...o,type:"pattern",style:0,projection:0,axis:"y",blending:0,offset:[0,0],colorA:{...Qn.fromHex(0),a:1},colorB:{...Qn.fromHex(16777215),a:1},frequency:[10,10],size:.5,variation:0,smoothness:.5,zigzag:0,rotation:0,vertical:[0,1],horizontal:[0,1],sides:6}}}})(Tn||(Tn={}));var ea;(e=>{function t(d){return!d.layers.some(u=>u.data.type==="texture"&&u.data.projection!==0||u.data.type==="depth"&&!u.data.isWorldSpace||u.data.type==="noise"||u.data.type==="displace")}e.isMergable=t;function r(d){let u="";return d.layers.forEach(h=>{Object.entries(h.data).forEach(([f,p])=>{u+=`${f}${p}`,Array.isArray(p)?p.forEach(v=>u+=`${v}`):typeof p=="object"?Object.values(p).forEach(v=>{typeof v=="number"?u+=`${v.toFixed(4)}`:u+=`${v}`}):u+=`${p}`})}),u}e.getHash=r;function i(){return{layers:new Dt}}e.defaultEmptyData=i;function n(d="layer1",u="layer2"){return o("phong",d,u)}e.defaultData=n;function a(d,u){return{...d,name:u}}e.withName=a;function o(d,u="layer1",h="layer2"){let f=new Dt;return f.push({fi:0,data:Tn.defaultData("light",d),id:u}),f.push({fi:1,data:Tn.defaultData("color"),id:h}),{layers:f}}e.defaultTwoLayerData=o;function s(d){let u=Tn.defaultData("texture");d&&Object.assign(u.texture,{image:d});let h=new Dt;return h.push({fi:0,data:u,id:"layer1"}),h.push({fi:1,data:{...Tn.defaultData("transmission"),alpha:1},id:"layer2"}),h.push({fi:2,data:{...Tn.defaultData("light","lambert"),alpha:0},id:"layer3"}),{layers:h}}e.defaultUIObjectMaterial=s;function l(d,u="phong",h="layer1",f="layer2"){let p=Tn.defaultData("texture");Object.assign(p.texture,{image:d});let v=new Dt;return v.push({fi:0,data:p,id:h}),v.push({fi:1,data:Tn.defaultData("light",u),id:f}),{layers:v}}e.defaultTwoLayerTextureData=l;function c(d,u="phong",h="layer1",f="layer2"){let p=Tn.defaultData("video");Object.assign(p.texture,{video:d});let v=new Dt;return v.push({fi:0,data:p,id:h}),v.push({fi:1,data:Tn.defaultData("light",u),id:f}),{layers:v}}e.defaultTwoLayerVideoTextureData=c})(ea||(ea={}));var Bx;(e=>{function t(){return{points:new Dt,roundness:0,shapeHoles:[],isClosed:!1}}e.defaultData=t})(Bx||(Bx={}));var Fx;(e=>{function t(){return{points:new Dt,lastInsertionPlane:null,subdivisions:12,isClosed:!1}}e.defaultData=t})(Fx||(Fx={}));var d8={type:"Ellipse",width:50,height:50,spikes:16,angle:360,innerRadius:0},uM;(e=>{function t(r,i){let n={...r};return h8.forEach(a=>{Object.assign(n,{[a]:i[a]??r[a]})}),n}e.merge=t})(uM||(uM={}));var u8={shape:d8,depth:1,offset:0,bevel:50,bevelSides:6,angle:0,twist:0,startScale:1,endScale:1,capType:"flat"},h8=["depth","offset","angle","twist","startScale","endScale"],Nx;(e=>{function t(i){return i==="PolygonGeometry"||i==="RectangleGeometry"||i==="StarGeometry"||i==="TriangleGeometry"||i==="EllipseGeometry"||i==="UIGeometry"}e.is2DParametricMesh=t;function r(i){return i==="PolygonGeometry"||i==="PolygonGeometry"||i==="RectangleGeometry"||i==="StarGeometry"||i==="TriangleGeometry"||i==="EllipseGeometry"||i==="PathGeometry"||i==="VectorGeometry"||i==="ConeGeometry"||i==="CubeGeometry"||i==="CylinderGeometry"||i==="DodecahedronGeometry"||i==="HelixGeometry"||i==="IcosahedronGeometry"||i==="LatheGeometry"||i==="PyramidGeometry"||i==="SphereGeometry"||i==="PlaneGeometry"||i==="BackdropGeometry"||i==="TorusGeometry"||i==="TorusKnotGeometry"||i==="BooleanGeometry"||i==="TextGeometry"||i==="InputGeometry"}e.isParametricMesh=r})(Nx||(Nx={}));var hM;(e=>{function t(r,i){let n={...r};return Object.assign(n,i),n.type==="PathGeometry"&&"extrusion"in i&&i.extrusion&&(n.extrusion={...r.extrusion},Object.assign(n.extrusion,uM.merge(n.extrusion,i.extrusion))),n}e.merge=t})(hM||(hM={}));var Cu;(e=>{function t(r){if(r==="RectangleGeometry")return{width:320,height:320,type:r,cornerRadius:[0,0,0,0],cornerType:0,depth:0,extrudeBevelSize:0,extrudeBevelSegments:1};if(r==="UIGeometry")return{type:r,frame:"",cornerRadius:[0,0,0,0],cornerType:0,width:1,height:1};if(r==="PathGeometry")return{type:r,width:1,height:1,depth:1,path:Fx.defaultData(),extrusion:u8};if(r==="VectorGeometry")return{width:1,height:1,type:r,subdivisions:12,shape:Bx.defaultData(),depth:0,extrudeBevelSize:0,extrudeBevelSegments:1};if(r==="BooleanGeometry")return{type:r,operation:2,width:0,height:0,depth:0,phongAngle:35};if(r==="TextGeometry")return{type:r,width:100,height:100,depth:0,horizontalAlign:1,verticalAlign:1,fontSize:16,lineHeight:1.2,letterSpacing:0,text:{textValue:""},textTransform:1,font:"Roboto_regular",editable:!1,extrudeBevelSize:0,extrudeBevelSegments:1};if(r==="InputGeometry")return{...e.defaultData("TextGeometry"),type:r,editable:!0};if(r==="SphereGeometry")return{type:"SphereGeometry",width:100,height:100,depth:100,widthSegments:64,heightSegments:64,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:180};throw new Error("not implemented")}e.defaultData=t})(Cu||(Cu={}));var qk=["width","height","depth"],fM;(e=>e.defaultData={enabled:!1,useBackgroundColor:!1,color:Qn.white,near:.1,far:2e3})(fM||(fM={}));var Ux;(e=>{let t={opacity:1,blendFunction:13,enabled:!1};e.defaultData={enabled:!1,pixelation:{...t,blendFunction:16,granularity:15},bloom:{...t,blendFunction:16,intensity:1,blurScale:1,luminanceThreshold:.25,luminanceSmoothing:.025,kernelSize:3},chromaticAberration:{...t,offset:[2,2]},vignette:{...t,darkness:1,offset:0},hueSaturation:{...t,hue:3,saturation:0},brightnessContrast:{...t,brightness:.25,contrast:0},depthOfField:{...t,focusDistance:100,focalLength:20,bokehScale:5},noise:{...t,blendFunction:16}}})(Ux||(Ux={}));var pM;(e=>e.defaultData={softShadowQuality:"low"})(pM||(pM={}));var mM;(e=>e.defaultData={enabled:!0,color:{r:.8274509803921568,g:.8274509803921568,b:.8274509803921568},intensity:.75})(mM||(mM={}));var vM;(e=>e.defaultData={occlusion:!1,aoFullRes:!1,radius:256,bias:.5,aoColor:{r:.19607843137254902,g:.19607843137254902,b:.19607843137254902}})(vM||(vM={}));var _p;(e=>e.defaultData={usePhysics:!1,gravity:-10})(_p||(_p={}));var gM;(e=>e.defaultData={playCamera:Zp,gameControlObject:null})(gM||(gM={}));var yM;(e=>e.defaultData={backgroundColor:ri.fromHexAndA(dPe,1),postprocessing:Ux.defaultData,fog:fM.defaultData,globalPhysics:_p.defaultData,ambient:mM.defaultData,ao:vM.defaultData,shadow:pM.defaultData,publish:gM.defaultData})(yM||(yM={}));var bM;(e=>e.defaultData={colliderType:"box",size:[100,100,100],colliderHelperVisible:!0,forceType:"collider",forceRange:"global",forceIntensity:.5,forceDambing:.95})(bM||(bM={}));var Yk;(e=>{function t(i){return i==="Component"||i==="Instance"}e.isComponentRelated=t;function r(i){return i==="Empty"||i==="Instance"}e.isEmptyOrComponent=r})(Yk||(Yk={}));var Ap;(e=>{e.identity={...nM.identity,hiddenMatrix:wp.identity};function t(n){return{position:n.position,rotation:n.rotation,scale:n.scale,hiddenMatrix:n.hiddenMatrix}}e.fromObject=t;function r(n,a){return{position:(a==null?void 0:a.position)||n.position,rotation:(a==null?void 0:a.rotation)||n.rotation,scale:(a==null?void 0:a.scale)||n.scale,hiddenMatrix:(a==null?void 0:a.hiddenMatrix)||n.hiddenMatrix}}e.merge=r;function i(n,a){return TV({position:Vu.isEqual(n.position,a.position)?void 0:a.position,rotation:Vu.isEqual(n.rotation,a.rotation)?void 0:a.rotation,scale:Vu.isEqual(n.scale,a.scale)?null:a.scale,hiddenMatrix:wp.isEqual(n.hiddenMatrix,a.hiddenMatrix)?void 0:a.hiddenMatrix})}e.diff=i})(Ap||(Ap={}));var Bn;(e=>e.defaultData={states:new Dt,events:new Dt,visible:!0,raycastLock:!1,physics:Cp.defaultData,pathSnapping:{pathId:null,slide:0,offset:0,orientation:"tangential"},...Ap.identity,cloner:null})(Bn||(Bn={}));var xM;(e=>e.defaultData={type:"Empty",...Bn.defaultData})(xM||(xM={}));var Xk;(e=>e.defaultData={type:"ParticleCollider",...bM.defaultData,...Bn.defaultData})(Xk||(Xk={}));var Kk;(e=>e.defaultData={type:"Component",...Bn.defaultData})(Kk||(Kk={}));var Qk;(e=>e.defaultData={type:"Particle",...Bn.defaultData,...kx.defaultData})(Qk||(Qk={}));var _u;(e=>e.defaultData={type:"Mesh",...Bn.defaultData,...dM.defaultData})(_u||(_u={}));var mg;(e=>e.defaultData={...Bn.defaultData,...Ap.identity,position:[0,0,Sp.DefaultTargetOffset],...Sp.defaultData})(mg||(mg={}));var wM;(e=>{function t(r){return{...Bn.defaultData,...sM.defaultData(r)}}e.defaultData=t,e.defaultDirectionalLightData={...e.defaultData("DirectionalLight"),position:[200,300,300],name:"Directional Light",intensity:.7}})(wM||(wM={}));var jx;(e=>{function t(i,n,a=0){for(;a<n.length;){let o=i?i[n[a]]:void 0;if(n.length===a+1)return o;if(o)i=o.descendants,a+=1;else return}}e.resolveWithDes=t;function r(i,n,a=0){let o=t(i,n,a);if(o){let s=Object.keys(o);if(s.length===1&&s[0]==="descendants")return}return o}e.resolve=r})(jx||(jx={}));var rd;(e=>{e.rootOverrideProps=["physics","events"],e.compositeNonOptionalOverrideProps=["geometry"],e.compositeEntireOverrideOverrideProps=["material"];function t(i,n){return{...Bn.defaultData,...n,component:i,overrides:new cn,physics:void 0,events:void 0,type:"Instance"}}e.ofComponent=t;function r(i){let n=Ap.fromObject(i.data);return t(i.id,n)}e.fromComponentData=r})(rd||(rd={}));var Mp;(e=>{e.defaultData={type:"Page",...Bn.defaultData,physics:{...Cp.defaultData,fusedBody:!1},...yM.defaultData,camera:mg.defaultData};function t(r){return r.uiScene!==void 0}e.isUIPage=t})(Mp||(Mp={}));var SM;(e=>(e.defaultCamera={position:[0,0,1e3],scale:[1,1,1],rotation:[0,0,0],hiddenMatrix:wp.identity,name:"Play Camera",visible:!0,raycastLock:!1,physics:Cp.defaultData,states:new Dt,events:new Dt,cloner:null,pathSnapping:{pathId:null,orientation:"tangential",slide:0,offset:0},...Sp.defaultData},e.KeysByResetCategory={States:["states"],Events:["events"],Material:["material","materials"],Geometry:["geometry"],Position:["position"],Rotation:["rotation"],Scale:["scale"],Transform:["position","scale","rotation","hiddenMatrix"],Name:["name"],Visibility:["visible","raycastLock","flatShading","wireframe","side"],Shadows:["castShadow","receiveShadow"],Cloner:["cloner"],Physics:["physics"]},e.defaultMeshObject={name:"Rectangle",...Bn.defaultData,..._u.defaultData,geometry:Cu.defaultData("RectangleGeometry"),material:ea.defaultTwoLayerData("phong","layer1","layer2")},e.defaultBooleanObject={name:"Boolean",...Bn.defaultData,..._u.defaultData,geometry:Cu.defaultData("BooleanGeometry"),material:ea.defaultTwoLayerData("phong","layer1","layer2")},e.defaultTextObject={name:"Text",...Bn.defaultData,..._u.defaultData,geometry:Cu.defaultData("TextGeometry"),material:ea.defaultTwoLayerData("phong","layer1","layer2")},e.defaultInputObject={name:"Input",...Bn.defaultData,..._u.defaultData,geometry:Cu.defaultData("InputGeometry"),material:ea.defaultTwoLayerData("phong","layer1","layer2")}))(SM||(SM={}));var Au;(e=>{function t(a,o){let s={name:o};return a.type==="Mesh"?(s.geometry={},"material"in a&&(s.material={layers:new cn}),"materials"in a&&(s.materials=a.materials.map(l=>({layers:new cn})))):ah.is(a.type)&&(s.perspective={},s.orthographic={}),s}e.newEmpty=t;function r(a,o){if(o===void 0)return a;let s={...a};return"material"in s&&"material"in o&&o.material&&(s.material=pg(s.material,l=>{if(typeof l!="string")for(let[c,d]of Object.entries(o.material.layers)){let u=l.layers.data(c);u&&Tn.patch(u,d)}}).data),s.materials&&o.materials&&(s.materials=pg(s.materials,l=>{var c,d;for(let u=0;u<s.materials.length;u++){let h=o.materials[u];if(typeof h!="string")for(let[f,p]of Object.entries(h.layers)){let v=(d=(c=l[u])==null?void 0:c.layers)==null?void 0:d.data(f);v&&Tn.patch(v,p)}}}).data),s}function i(a,o){let s,l=[],c={orthographic:0,perspective:0,geometry:0};function d(u,h){for(let[f,p]of Object.entries(h.layers)){let{texture:v,...m}=p;if(v!==void 0&&Object.keys(v).length>0){let g={path:[...u,"layers",f,"texture"],props:v,type:0};l.push(g)}if(Object.keys(m).length>0){let g={path:[...u,"layers",f],props:m,type:0};l.push(g)}}}for(let[u,h]of Object.entries(o))if(u!=="name")if(u==="cloner")l.push(...aM.toOps(h,["cloner"]));else if(u==="pathSnapping")l.push({path:[u],props:{slide:h.slide,offset:h.offset},type:0});else if(u==="material")d(["material"],h);else if(u==="materials")for(let[f,p]of Object.entries(h))d(["materials",f],p);else if(c[u]===0){if(u==="geometry"&&h.extrusion!==void 0){let f={path:[u,"extrusion"],props:h.extrusion,type:0};l.push(f),h={...h},delete h.extrusion}if(Object.keys(h).length>0){let f={path:[u],props:h,type:0};l.push(f)}}else s===void 0&&(s={path:[],props:{},type:0},l.push(s)),s.props[u]=h;return l}e.toOps=i;function n(a,o){var l,c,d,u,h,f;if(o===void 0)return a;let s={...a};if(Object.assign(s,Ap.merge(s,o)),Object.assign(s,{pathSnapping:Object.assign({},s.pathSnapping,{slide:((l=o.pathSnapping)==null?void 0:l.slide)??((c=s.pathSnapping)==null?void 0:c.slide)??0,offset:((d=o.pathSnapping)==null?void 0:d.offset)??((u=s.pathSnapping)==null?void 0:u.offset)??0})}),ah.is(a.type)){s.orthographic={...s.orthographic},s.perspective={...s.perspective};let p=o;((h=p.orthographic)==null?void 0:h.zoom)!==void 0&&(s.orthographic.zoom=p.orthographic.zoom),((f=p.perspective)==null?void 0:f.zoom)!==void 0&&(s.perspective.zoom=p.perspective.zoom),p.isUpVectorFlipped!==void 0&&(s.isUpVectorFlipped=p.isUpVectorFlipped),p.targetOffset!==void 0&&(s.targetOffset=p.targetOffset)}else if(a.type==="Mesh")"geometry"in o&&Object.assign(s,{geometry:hM.merge(s.geometry,o.geometry)}),(o.material||o.materials)&&(s=r(s,o)),s.cloner&&"cloner"in o&&Object.assign(s,{cloner:td.merge(s.cloner,o.cloner)});else if(a.type==="Empty")s.cloner&&"cloner"in o&&Object.assign(s,{cloner:td.merge(s.cloner,o.cloner)});else if(oM.is(a.type)){let p=o;p.intensity!==void 0&&(s.intensity=p.intensity),p.color!==void 0&&(typeof p.color=="string"?s.color=p.color:s.color=Qn.clone(p.color))}return s}e.patch=n})(Au||(Au={}));var Vx;(e=>e.defaultData={enablePan:!0,enableZoom:!0,enableRotate:!0,enableDamping:!0,rotationLimitsMode:0,rotationVerticalOffset:{min:Math.PI/4,max:Math.PI/4},rotationHorizontalOffset:{min:Math.PI/4,max:Math.PI/4},rotationSoftLimit:2,panLimitsMode:0,panVerticalOffset:{min:250,max:250},panHorizontalOffset:{min:250,max:250},panSoftLimit:2,zoomLimitsEnabled:!1,zoomLimits:{min:.1,max:2},autoRotate:!1,autoRotateSpeed:2,autoRotateClockwise:!0,hoverRotatePanMode:0,hoverRotatePanStrength:20,hoverRotateDamping:.125,isTouchZoom:!0,orbitTouches:2,panTouches:3,resetHoverEffectOnPointerLeave:!0})(Vx||(Vx={}));var id;(e=>e.defaultData={orbitControls:Vx.defaultData,playPage:Tv,withBackground:!0,preventScroll:!1,preventTouchScroll:!1,hideCursor:!1,mouseEventTarget:"canvas",joystickSizeAndXYOffset:Array(12).fill(0).map((t,r)=>{let i=0,n=0;return r<5?n=-30:r<10&&(n=30),r===0||r===10||r===5?i=30:(r===4||r===11||r===9)&&(i=-30),[120,[i,n],"show"]}),settings:{image:{format:"jpg",ratio:1},video:{format:"mp4",imageFormat:"jpg",fps:30,mbps:80,ratio:Math.max(1,typeof window<"u"?Math.floor(window.devicePixelRatio):1),stopMode:"manual",duration:5e3},web:{logo:!0,compress:!0,preset:1,preload:!0,hint:!1,imageQuality:70}},stopRaycast:!0,hdTransmission:!1})(id||(id={}));var CM;(e=>e.defaultData={id:"basic",label:"Basic",style:"None",prompt:""})(CM||(CM={}));var _M;(e=>e.defaultData={weather:0,shadows:0,lightOrigin:0,temperature:0,sun:0,camera:0,environment:0,particles:0,nature:0,floor:0})(_M||(_M={}));var Mu;(e=>(e.defaultData=()=>({mode:"line-art-both",prompt:"",negativePrompt:"",style:{...CM.defaultData},isRandomSeed:!0,seed:e.generateSeed(),guessMode:!1,advanced:!1,steps:20,guidanceScale:7.5,controlNetScale:1,modifiers:_M.defaultData}),e.generateSeed=()=>Math.round(Math.random()*1e5)))(Mu||(Mu={}));var vg;(e=>{function t(i){return i.find(n=>n.data.type==="Page"&&n.data.globalPhysics.usePhysics)!==void 0}e.physicsEnabled=t;function r(i,n,a){i.scene.objects.traverseFrom(n,(o,s)=>{var l;if(s.type==="Instance"){let c=(l=Gx.getComponentData(i,s.component))==null?void 0:l.data;c&&a(o,s,c.events)}else a(o,s,s.events)})}e.traverseModuleInstances=r})(vg||(vg={}));var Eu;(e=>{e.TRASH_CAN_ID="830a2708-8ed9-49cf-a68e-085299892222",e.defaultLight={fi:-1,data:wM.defaultDirectionalLightData,id:"830a2708-8ed9-49cf-a68e-085299899103",children:[]};function t(n=!0,a=[]){let o=[],s=SM.defaultMeshObject;n&&(o.push({...e.defaultLight}),o.push({fi:1,id:"7ba78968-2a55-48f2-b14c-5191da3e075e",data:s,children:[]})),o.push(...a);let l=new Jn;return l.push({fi:1,id:Tv,data:{...Mp.defaultData,name:"Scene 1"},children:o}),l}e.createDefaultObjectTreeWithPage=t,e.defaultData={objects:t(),publish:id.defaultData,styles:Mu.defaultData()},e.emptyDataWithoutPage=function(){return{objects:new Jn,publish:id.defaultData,styles:Mu.defaultData()}},e.emptyDataWithPage=function(n=!0){return{objects:t(n),publish:id.defaultData,styles:Mu.defaultData()}},e.emptyData=function(){return{objects:new Jn,publish:{...id.defaultData},styles:Mu.defaultData()}};function r(n){return{...e.defaultData,objects:No(n,Jn.prototype)}}e.withObjs=r;function i(n,a){return r([{id:n,data:a,children:[],fi:0}])}e.withObj=i})(Eu||(Eu={}));var Pv;(e=>e.defaultData={preset:"fullscreen",allowResponsive:!1,size:[512,512],coords:[0,0],sceneScale:1,color:{r:0,g:0,b:0,a:.5}})(Pv||(Pv={}));var AM;(e=>(e.defaultData=t=>({url:t,name:"New Webhook",parametersSchemas:new Dt}),e.defaultParameterValueByType=t=>t==="number"?0:t==="boolean"?!1:""))(AM||(AM={}));var Zk;(e=>e.defaultData=(t,r="GET")=>({url:t,method:r,name:"New API",headers:new Dt,queries:new Dt,autoStart:!0}))(Zk||(Zk={}));var ta;(e=>{function t(o){return o.textValue!==void 0}e.isTextValue=t;function r(o){return typeof o=="number"}e.isNumber=r;function i(o){return typeof o=="boolean"}e.isBoolean=i;function n(o){return t(o)?"string":i(o)?"boolean":"number"}e.typeOfVariable=n;function a(o){return e.isTextValue(o)?Array.isArray(o.textValue)?o.textValue.map(s=>s.toString().padStart(o.padding??2,"0")).join(o.deliminator??":")+(o.suffix!==void 0?" "+o.suffix:""):o.textValue.toString():e.isBoolean(o)?o?"True":"False":e.isNumber(o)?parseFloat(o.toFixed(3)).toString():o.toString()}e.getDisplayedValue=a})(ta||(ta={}));var MM;(e=>e.all=["images","videos","colors","audios","particles","fonts","materials","variables"])(MM||(MM={}));var Jk;(e=>e.all=[...MM.all,"components"])(Jk||(Jk={}));var eL;(e=>{function t(){return{images:new kt,videos:new kt,colors:new kt,audios:new kt,particles:new kt,fonts:new kt,materials:new kt,components:new kt,variables:new kt,userAPIs:new kt,userWebhooks:new kt}}e.defaultData=t})(eL||(eL={}));var nc;(e=>{function t(){return{images:new kt,videos:new kt,colors:new kt,audios:new kt,particles:new kt,fonts:new kt,materials:new kt,components:new kt,variables:new kt,userAPIs:new kt,userWebhooks:new kt}}e.defaultData=t})(nc||(nc={}));var _o;(e=>{function t(){let o={};return o["89b10010-844c-11ec-a8a3-0242ac120002"]={r:.5,g:.5,b:.5,a:1,name:"Default Color"},No(o,kt.prototype)}e.defaultColors=t;function r(){return No({},kt.prototype)}e.defaultImages=r;function i(){return{catelogs:new kt,materials:new kt,images:new kt,videos:new kt,colors:new kt,audios:new kt,particles:new kt,fonts:new kt,variables:new Dt,userAPIs:new kt,userWebhooks:new kt,lib:nc.defaultData()}}e.emptyData=i;function n(o){switch(o){case"number":return{value:0,name:"Number"};case"boolean":return{value:!1,name:"Boolean"};case"string":return{value:{textValue:"String value"},name:"String"};case"time":let s=[0,0,0];return{name:"Time",value:{textValue:s,deliminator:":",padding:2,suffix:"AM"},dynamicVariableType:"time",format:"HH:mm:ss",format12h24h:"12ampm",timeZone:null,hasEnd:!1,endValue:{textValue:s,deliminator:":",padding:2,suffix:"AM"},autoStart:!0,repeat:!1};case"counter":return{name:"Counter",value:0,dynamicVariableType:"counter",updateInterval:1e3,increment:1,autoStart:!0,hasEnd:!0,endValue:60,repeat:!0,randomStart:!1,range:[0,100],decimals:0};case"random":return{name:"Random",value:0,dynamicVariableType:"random",updateInterval:1e3,increment:1,autoStart:!0,isStatic:!1,hasEnd:!0,endValue:60,repeat:!0,min:0,max:100,decimals:0};default:console.error("Unknown variable type",o)}}e.defaultVariables=n;function a(o,s){if(s.format==="HH:mm:ss"){let l=Math.floor(o/3600),c=Math.floor((o-l*3600)/60),d=Math.round(o-l*3600-c*60);return{textValue:[l,c,d]}}else if(s.format==="mm:ss"){let l=Math.floor(o/60),c=Math.round(o-l*60);return{textValue:[l,c]}}else return s.format==="number"?o=Math.round(o):o=Math.round(o*1e3)/1e3,o}e.getFormattedTimerTime=a})(_o||(_o={}));var Hx;(e=>e.list=["idle","move","jump","run"])(Hx||(Hx={}));var Wx;(e=>(e.defaultColliderData={type:"capsule",height:200,radius:50,position:[0,0,0],rotation:[0,0,0]},e.defaultDataThirdPerson={moveMode:"walk",forwardDirection:"+z",speedTranslate:1e3,speedRotate:100,runMultiplier:2,rotationMode:"normal",rotBy:"keys",rotByTouch:"drag",delayPos:[.3,.3],delayRot:[.3,.3],keyAssignments:[["moveNegZ","W"],["moveNegX","A"],["movePosZ","S"],["movePosX","D"],["rotPosX","▲"],["rotPosY","◀"],["rotNegX","▼"],["rotNegY","▶"],["jump","Space"],["run","⇧"],["none","Ctrl"]],touchControl:!0,joystickPosLoc:5,joystickRotLoc:11,jumpTouchButtonLoc:9,collider:e.defaultColliderData,colliderHelperVisible:!0,collisionEnabled:!0,jumpPower:100,resetYPosition:3e3,alignToGround:!1,autoOrientMove:!0,orientWith:"camera",orientMode:"radial",delayPosCamera:.3,delayRotCamera:.3,camera:"",cameraXAxis:"Limit",cameraYAxis:"Free",cameraRotXLimits:[0,Math.PI/2],cameraRotYLimits:[-Math.PI/2,Math.PI/2],gameActions:{idle:new Dt,move:new Dt,jump:new Dt,run:new Dt},navmesh:{enabled:!1,ch:6,cs:6,walkableClimb:5,walkableHeight:1,walkableRadius:0,zones:"all",objects:[],helperVisible:!0,destinationHelperRadius:0,destinationHelperColor:ri.fromHexAndA(3728051,1)}}))(Wx||(Wx={}));function tL(e){e.layers.forEach(t=>{if(t.type==="depth"&&t.colorA!==void 0){let r=t.colorA,i=t.colorB,n=[[r.r,r.g,r.b,r.a],[i.r,i.g,i.b,i.a]],a=[0,1];for(let s=2;s<10;s++)n.push(n[1]),a.push(1);let o={...Kl(qi(t),"type","visible","isVector","isWorldSpace","origin","alpha","mode"),near:Math.max(0,t.near),far:Math.max(0,t.far),colors:n,steps:a,num:2,direction:[1,0,0],smooth:!1,gradientType:1};Object.assign(t,o)}else if(t.type==="depth"&&t.gradientType===1&&(t.near<0||t.far<0)){let r={...qi(t),near:Math.max(t.near,0),far:Math.max(t.far,0)};Object.assign(t,r)}})}function Xc(e,t){Object.values(e.shared.materials).forEach(r=>t(r))}function Kc(e,t){e.scene.objects.traverse((r,i)=>{"materials"in i?i.materials.forEach((n,a)=>{n===void 0&&(i.materials[a]=ea.defaultData(),n=i.materials[a]),typeof n!="string"&&t(n)}):"material"in i?typeof i.material!="string"&&(i.material===void 0&&(i.material=ea.defaultData()),t(i.material)):i.type==="Mesh"&&(i.material===void 0&&(i.material=ea.defaultData()),t(i.material)),"overrides"in i&&Object.values(i.overrides).forEach(n=>{n.material&&typeof n.material!="string"&&Object.getPrototypeOf(n.material)!==cn.prototype&&t(n.material)})})}function fPe(e){Object.assign(e.scene.publish,{orbitControls:{...Vx.defaultData,...qi(e.scene.publish.orbitControls)}})}function pPe(e){Object.assign(e.scene.publish.settings,{video:{...id.defaultData.settings.video,...qi(e.scene.publish.settings.video)}})}function mPe(e){function t(r){if(r.layers){for(let i of Object.values(r.layers))if(i){for(let[n,a]of Object.entries(i))if((c8.includes(n)||typeof a=="boolean")&&delete i[n],n==="texture")for(let[o,s]of Object.entries(a))(hPe.includes(o)||typeof s=="boolean")&&delete a[o]}}}e.scene.objects.traverse((r,i)=>{i.states.forEach(n=>{let a=n;a.material?t(a.material):a.materials&&a.materials.forEach(o=>{t(o)})})})}function vPe(e){e.scene.publish.withBackground=!0}function gPe(e){e.scene.publish.settings.web={compress:!0,preload:!0,preset:1,logo:!0,hint:!1}}function yPe(e){e.scene.objects.traverse((t,r)=>{let i=r.cloner;i&&(i.radial.scale=i.radial.scale.map(n=>n+1),i.linear.scale=i.linear.scale.map(n=>n+1))})}function bPe(e){e.scene.objects.traverse((t,r)=>{let i=r.geometry;i&&(i.type==="DodecahedronGeometry"||i.type==="IcosahedronGeometry")&&(i.detail=Math.round(i.detail))})}function xPe(e){e.scene.objects.traverse((t,r)=>{let i=e.scene.objects.unproxy().parent(t);if(i){let n=qi(e.scene.objects.data(i));n&&n.type==="Mesh"&&n.geometry.type==="BooleanGeometry"&&r.type==="Mesh"&&(r.visible=qi(r).booleanExclude!==!0)}})}function wPe(e){e.scene.objects.traverse((t,r)=>{if(r.type==="Mesh"){let i=r;r.geometry.type==="NonParametricGeometry"?i.material!==void 0&&delete i.material:i.materials!==void 0&&delete i.materials}})}function SPe(e){function t(i){Object.setPrototypeOf(i,cn.prototype),i.texture&&Object.setPrototypeOf(i.texture,cn.prototype)}function r(i){Object.setPrototypeOf(i,cn.prototype);for(let n in i)t(i[n])}e.scene.objects.traverse((i,n)=>{n.states.forEach(a=>{let o=a;if(o.material){let s=qi(o.material).layers;r(s),o.material.layers=s}if(o.materials)for(let s=0;s<o.materials.length;s++){let l=o.materials[s],c=qi(l).layers;r(c),l.layers=c}})})}function rL(e){e.layers===void 0&&Object.assign(e,ea.defaultTwoLayerData("lambert"))}function xC(e){!e.layers||e.layers.forEach(t=>{if(t.type==="depth"&&t.colors.length===10){let r=[...t.colors];r.push(t.colors[9]);let i=[...t.steps];i.push(t.steps[9]);let n={...qi(t),colors:r,steps:i};Object.assign(t,n)}})}function CPe(e){e.scene.objects.traverse((t,r)=>{r.type==="Mesh"&&(r.geometry.type==="BooleanGeometry"||r.geometry.type==="SubdivGeometry")&&(r.geometry.phongAngle=35)})}function iL(e){e.scene.objects.traverse((t,r)=>{"materials"in r?r.materials.forEach(i=>{typeof i!="string"&&xC(i)}):"material"in r&&typeof r.material!="string"&&xC(r.material)}),Object.values(e.shared.materials).forEach(t=>xC(t))}function _Pe(e){e.scene.environment.ambientLight.softShadows=!1,e.scene.environment.ambientLight.softShadowQuality="low",e.scene.objects.traverse((t,r)=>{(r.type==="DirectionalLight"||r.type==="SpotLight")&&(r.shadowResolution=1024,r.shadowRadius=1,r.depth=1e5)}),e.shared.penumbraSize=new Array(5).fill(.5)}function APe(e){e.shared.audios=No({},kt.prototype)}function MPe(e){e.shared.videos=No({},kt.prototype)}function EPe(e){let t=e.shared.materials;Object.entries(t).forEach(([r,i])=>{if(!i.layers){let n={name:"Untitled Material",layers:[{fi:0,data:{type:"light",category:"phong",alpha:.6,visible:!0,mode:0,specular:{r:.2,g:.2,b:.2},shininess:5},id:"layer1"},{fi:1,data:{type:"color",alpha:1,visible:!0,mode:0,color:{r:.2823529411764706,g:.2823529411764706,b:.30196078431372547}},id:"layer2"}]};Object.assign(t,{[r]:n})}})}function TPe(e){Object.entries(qi(e.shared.images)).filter(t=>t[1].asset===!1).map(t=>t[0]).forEach(t=>{delete e.shared.images[t]}),Object.entries(qi(e.shared.audios)).filter(t=>t[1].asset===!1).map(t=>t[0]).forEach(t=>{delete e.shared.audios[t]})}function PPe(e){e.scene.publish.settings.web.preload=!1}function nL(e){e.layers&&e.layers.forEach(t=>{t.type==="depth"&&t.num!==void 0&&(t.colors=t.colors.slice(0,t.num),t.steps=t.steps.slice(0,t.num),delete t.num)})}function aL(e){e.layers&&e.layers.forEach(t=>{uPe(t)&&t.isMask===void 0&&(t.isMask=!1),(t.type==="texture"||t.type==="video")&&t.blending===void 0&&(t.blending=0),(t.type==="noise"||t.type==="displace"&&t.displacementType==="noise")&&(t.voronoiStyle===void 0&&(t.voronoiStyle=0),t.highCut===void 0&&(t.highCut=1),t.lowCut===void 0&&(t.lowCut=0),t.smoothness===void 0&&(t.smoothness=.3),t.seed===void 0&&(t.seed=0),t.quality===void 0&&(t.quality=1))})}function DPe(e){e.shared.fonts=No({},kt.prototype)}function OPe(e){return e.replace(".typeface","").replace(/optimer/gi,"open sans").replace("space_mono","space mono").replace(/alma_mono/gi,"varela round").replace(/droid_sans_mono/gi,"noto sans mono").replace(/droid_sans|gentilis|gnomon_(simple|foreground)|helvetiker/gi,"roboto").replace(/droid_serif/gi,"roboto slab").replace("_sans"," sans").replace("crimson_text","crimson text").replace("medium_medium","medium").replace("fatface_fatface","fatface").replace("100hairline","thin").replace("200thin","extralight").replace("300light","light").replace("500medium","medium").replace("600semi","semibold").replace("800heavy","extrabold").replace("900black","black").replace(/bodoni_(11|16|24|36|48|72|96)([^_])/gi,"bodoni_$1_$2").replace(/bodoni_(11|16|24|36|48|72|96)/gi,"bodoni moda").replace(/(thin|hairline)(_regular)?/gi,"100").replace(/(extra|ultra)light(_regular)?/gi,"200").replace(/light(_regular)?/gi,"300").replace(/_book|_normal|_roman/gi,"_regular").replace(/medium(_regular)?/gi,"500").replace(/(semi|demi)bold(_regular)?/gi,"600").replace(/(extra|ultra)bold(_regular)?/gi,"800").replace(/bold(_regular)?/gi,"700").replace(/(black|heavy|fatface)(_regular)?/gi,"900").replace(/([1-9]00)_italic/gi,"$1italic").replace(/regularitalic/gi,"italic").replace(/regularitalic/gi,"italic").split(" ").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" ")}function RPe(e){let t=[];e.scene.objects.traverse((r,i)=>{let n=i;if(n.type==="TextFrame"){let a=ea.defaultTwoLayerData("phong"),o=typeof n.color=="string"?e.shared.colors[n.color]:n.color;a.layers[1].data.color={r:o.r,g:o.g,b:o.b},a.layers[1].data.alpha=n.alpha;let s=OPe(n.font);e.shared.fonts[s]===void 0&&(e.shared.fonts[s]={name:s});let l={name:n.name,...Bn.defaultData,..._u.defaultData,flatShading:!1,wireframe:!1,geometry:{...Cu.defaultData("TextGeometry"),width:n.width,height:n.height,font:s,depth:0,horizontalAlign:n.horizontalAlign,verticalAlign:n.verticalAlign,fontSize:n.fontSize*1.40625,lineHeight:n.lineHeight/1.40625,letterSpacing:n.letterSpacing-1,text:n.text,textTransform:n.textTransform,extrudeBevelSize:0,extrudeBevelSegments:1},material:a,states:qi(n.states),events:qi(n.events),visible:n.visible,raycastLock:n.raycastLock,position:n.position,rotation:n.rotation,scale:n.scale,hiddenMatrix:n.hiddenMatrix},c=qi(e.scene.objects).parent(r);e.scene.objects.insertAfter(c??null,r,[{id:r+"new",data:l,children:[]}]),t.push(r)}}),t.forEach(r=>{e.scene.objects.delete(r)})}function IPe(e){let t={0:"MouseDown",1:"MouseUp",2:"MouseHover",5:"KeyDown",6:"KeyUp",7:"Start",9:"LookAt",10:"Follow",11:"Scroll",12:"Audio",13:"GameControl"};e.scene.objects.traverse((r,i)=>{i.events.forEach(n=>{if(t[Number(n.type)])if(Object.assign(n,{type:t[Number(n.type)]}),n.type==="Audio"&&"audioEvent"in n&&(Object.assign(n,{playAudio:n.audioEvent}),delete n.audioEvent),n.type==="GameControl")Object.assign(n,{gameActions:{idle:new Dt,move:new Dt,jump:new Dt}});else{let a=new Dt;Object.assign(n,{actions:a}),(n.type==="MouseDown"||n.type==="MouseUp"||n.type==="KeyDown"||n.type==="KeyUp")&&"url"in n&&a.push({fi:0,id:St.generateUUID(),data:{type:"Link",url:n.url,delay:0}}),"targets"in n&&(n.targets.forEach((o,s,l)=>{let c={state:void 0,repeat:0,delay:0,delayDirection:void 0,direction:"normal",duration:0,easing:4},d={easing:o.easing,duration:o.duration};o.easing===6?Object.assign(d,Kl(o,"mass","stiffness","damping","velocity")):o.easing===5&&Object.assign(d,{control1:{...o.control1},control2:{...o.control2}});let u={repeat:o.repeat?-1:0,delay:o.delay,delayDirection:o.delayDirection,direction:o.cycle&&o.rewind?"pingpong-rewind":o.cycle?"pingpong":"normal"},h={state:o.state,...u,...d},f={allowSlerp:!0,type:"Transition",object:o.object,repeat:0,delay:0,delayDirection:void 0,direction:"normal",tweens:new Dt({fi:0,id:St.generateUUID(),data:c},{fi:1,id:St.generateUUID(),data:h})};a.push({fi:l,id:s,data:f})}),delete n.targets)}})})}function zPe(e){e.scene.objects.traverse((t,r)=>{function i(n,a){var l;let o=new Dt,s=[];if(r.events.forEach((c,d,u)=>{if(c.type==="Audio"&&c.trigger===a){let h;s.push(d),c.interaction==="play"?h={...Kl(c,"interaction","audio","delay","volume","loop"),triggerAfter:"after"in c?c.after:void 0,toggle:"after"in c?c.toggle:void 0,type:"Audio"}:(c.interaction==="pause"||c.interaction==="stop")&&(h={...Kl(c,"interaction","delay","object","playAudio"),type:"Audio"}),h&&o.push({fi:u,id:d,data:h})}}),s.forEach(c=>r.events.delete(c)),o.length){let c=(l=r.events.find(d=>d.type===n))==null?void 0:l.data;c?"actions"in c&&c.actions.insertBefore(null,o):r.events.insertBefore(null,[{id:St.generateUUID(),data:{type:n,actions:o}}])}}i("Start","start"),i("MouseDown","mouseDown"),i("MouseUp","mouseUp"),i("KeyDown","keyDown"),i("KeyUp","keyUp")})}function oL(e){var r;let t=(r=e.layers.find(i=>i.type==="light"))==null?void 0:r.data;if((t==null?void 0:t.category)==="basic"){let i=Tn.defaultData("light","phong"),n=t;Object.assign(n,i),n.visible=!1}}function sL(e){Xc(e,oL),Kc(e,oL)}function kPe(e){e.scene.objects.traverse((t,r)=>{r.type==="Mesh"&&r.geometry.type==="SubdivGeometry"&&(r.geometry.scaleBaked||(r.geometry.scaleBaked=[1,1,1]))})}function LPe(e){e.scene.objects.traverse((t,r)=>{(r.type==="Empty"||r.type==="Mesh")&&r.cloner&&!r.cloner.randomnessObject&&!r.cloner.toObject&&!r.cloner.randomness&&(r.cloner={...r.cloner,toObject:{object:"",spreadType:"random",scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],axis:"x",seed:0,count:99,align:"normal"},randomness:!1,randomnessObject:{strength:100,scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],movement:1,seed:0,freqScale:10,noiseType:"perlin"}})})}function BPe(e){e.scene.objects.traverse((t,r)=>{r.type==="Mesh"&&r.geometry.type==="NonParametricGeometry"&&!("material"in r)&&!("materials"in r)&&(r.material=ea.defaultTwoLayerData("phong"))})}function FPe(e){e.scene.publish.orbitControls.autoZoom===void 0&&(e.scene.publish.orbitControls.autoZoom=!1),e.scene.objects.traverse((t,r)=>{(r.type==="OrthographicCamera"||r.type==="PerspectiveCamera")&&(r.orthographic.autoZoom===void 0&&(r.orthographic.autoZoom=!1),r.orthographic.autoZoomFrustumSize===void 0&&(r.orthographic.autoZoomFrustumSize=790))})}function NPe(e){e.scene.objects.traverse((t,r)=>{r.pathSnapping===void 0&&(r.pathSnapping={pathId:null,slide:0,offset:0,orientation:"tangential"}),r.pathSnapping.offset===void 0&&(r.pathSnapping.offset=0)})}function UPe(e){e.scene.publish.mouseEventTarget===void 0&&(e.scene.publish.mouseEventTarget="canvas"),e.scene.publish.settings.web.hint===void 0&&(e.scene.publish.settings.web.hint=!1)}function jPe(e){let{video:t}=e.scene.publish.settings;t.format==="gif"&&t.fps>48&&(t.fps=15)}function VPe(e){e.scene.objects.traverse((t,r)=>{r.events.forEach(i=>{i.type==="GameControl"&&(i.resetYPosition=Math.abs(i.resetYPosition-r.position[1]))})})}function HPe(e){let t=e.scene.environment.usePhysics;e.scene.objects.traverse((r,i)=>{t&&i.physics===null?i.collision=!1:i.collision="visibility"})}function WPe(e){e.scene.objects.traverse((t,r)=>{r.events.forEach(i=>{i.type==="GameControl"&&(i.navmesh=Wx.defaultDataThirdPerson.navmesh)})})}function GPe(e){e.scene.styles||(e.scene.styles=Mu.defaultData())}function lL(e){e.layers.forEach(t=>{t.type==="light"&&t.category!=="toon"&&t.occlusion===void 0&&(t.occlusion=!0)})}function $Pe(e){e.scene.environment.ambientLight.occlusion===void 0&&(e.scene.environment.ambientLight.occlusion=!1),e.scene.environment.ambientLight.aoFullRes===void 0&&(e.scene.environment.ambientLight.aoFullRes=!1),e.scene.environment.ambientLight.radius===void 0&&(e.scene.environment.ambientLight.radius=256),e.scene.environment.ambientLight.bias===void 0&&(e.scene.environment.ambientLight.bias=.5),e.scene.environment.ambientLight.aoColor===void 0&&(e.scene.environment.ambientLight.aoColor={r:.19607843137254902,g:.19607843137254902,b:.19607843137254902}),Kc(e,lL),Xc(e,lL)}function qPe(e){e.scene.objects.traverse((t,r)=>{r.events.forEach(i=>{i.type==="GameControl"&&Object.assign(i.gameActions,{run:new Dt})})})}function YPe(e){e.scene.objects.traverse((t,r)=>{r.events.forEach(i=>{i.type==="GameControl"&&(i.keyAssignments=[...i.keyAssignments,["run","⇧"],["none","Ctrl"]])})})}function cL(e){e.layers&&e.layers.forEach(t=>{t.type==="light"&&t.bumpMapIntensity===void 0&&(t.bumpMapIntensity=5)})}function XPe(e,t){if(t<1&&(Kc(e,tL),Xc(e,tL),e.schema=1),t<2&&(fPe(e),e.schema=2),t<3&&(mPe(e),e.schema=3),t<4&&(vPe(e),e.schema=4),t<5&&(gPe(e),e.schema=5),t<6&&(yPe(e),e.schema=6),t<7&&(bPe(e),e.schema=7),t<8&&(e.schema=8),t<9&&(iL(e),e.schema=9),t<10&&(CPe(e),e.schema=10),t<11&&(_Pe(e),e.schema=11),t<12&&(iL(e),e.schema=12),t<13&&(APe(e),e.schema=13),t<14&&(EPe(e),e.schema=14),t<15&&(TPe(e),e.schema=15),t<16&&(PPe(e),e.schema=16),t<17&&(Kc(e,nL),Xc(e,nL),e.schema=17),t<18&&(Kc(e,rL),Xc(e,rL),e.schema=18),t<19&&(pPe(e),e.schema=19),t<20&&(DPe(e),RPe(e),e.schema=20),t<21&&(IPe(e),zPe(e),e.schema=21),t<22&&(sL(e),e.schema=22),t<23&&(kPe(e),e.schema=23),t<24&&(LPe(e),e.schema=24),(t<25||e.shared.videos===void 0)&&(MPe(e),t<25&&(e.schema=25)),t<26&&(xPe(e),e.schema=26),t<27&&(wPe(e),e.schema=27),t<28&&(sL(e),e.schema=28),t<29&&(SPe(e),e.schema=29),t<30&&(BPe(e),e.schema=30),t<31&&(FPe(e),e.schema=31),t<33&&(NPe(e),e.schema=33),t<34&&(UPe(e),e.schema=34),t<35&&(jPe(e),e.schema=35),t<36&&(VPe(e),e.schema=36),t<37&&(HPe(e),e.schema=37),t<38&&(Kc(e,aL),Xc(e,aL),e.schema=38),t<39&&(WPe(e),e.schema=39),t<40&&(GPe(e),e.schema=40),t<41&&($Pe(e),e.schema=41),t<42&&(qPe(e),e.schema=42),t<43&&(YPe(e),e.schema=43),t<99){Kc(e,cL),Xc(e,cL),e.scene.publish.playCamera===null&&(e.scene.publish.playCamera=Zp);let r=qi(e.scene.objects),i=e.scene.objects;e.scene.publish.playPage=Tv,i.insertBefore(null,null,[{id:Tv,data:{...Mp.defaultData,backgroundColor:e.scene.backgroundColor,fog:e.scene.fog,postprocessing:e.scene.postprocessing,ao:Kl(e.scene.environment.ambientLight,"occlusion","aoFullRes","radius","bias","aoColor"),publish:{playCamera:e.scene.publish.playCamera,gameControlObject:e.scene.publish.gameControlObject},shadow:Kl(e.scene.environment.ambientLight,"softShadowQuality"),globalPhysics:{..._p.defaultData,...Kl(e.scene.environment,"usePhysics","gravity")},camera:qi(e.scene.ownerCamera)??Mp.defaultData.camera,name:"Scene"},children:[]}]);for(let o of r)o.id!==Eu.TRASH_CAN_ID&&i.move(Tv,o.fi,o.id);let n=0,a=0;e.shared.penumbraSize&&e.scene.objects.traverse((o,s)=>{s.type==="DirectionalLight"?(s.penumbraSize=e.shared.penumbraSize[Math.min(n,2)],n+=1):s.type==="SpotLight"&&(s.penumbraSize=e.shared.penumbraSize[3+Math.min(a,1)],a+=1),(s.physics===void 0||s.physics===null)&&s.type!=="Instance"&&(s.physics={},Object.assign(s.physics,Cp.defaultData)),s.physics!==void 0&&s.physics!==null&&(s.physics.enabled=s.collision??"visibility",delete s.collision)}),e.schema=99}}function dL(e){e.layers&&e.layers.forEach(t=>{t.type==="light"&&t.alphaOverride===void 0&&(t.alphaOverride=1)})}function KPe(e){e.scene.objects.traverse((t,r)=>{let i=r.geometry;i&&i.type==="PathGeometry"&&(i.extrusion.capType="flat",i.extrusion.bevel=50,i.extrusion.bevelSides=6,i.extrusion.shape.type==="Custom"&&(i.extrusion.shape.shapeQuality="low"))})}function QPe(e){var t;Array.isArray(qi(e.events))&&((t=e.events)==null||t.forEach(r=>{"disabled"in r||(r.disabled=!1),(r.type==="MouseDown"||r.type==="MouseUp"||r.type==="MousePress")&&(r.mode=r.mode||"Object")}))}var xf=180/Math.PI;function uL(e){e.rotation=e.rotation.slice(0,3).map(t=>t*xf)}function f8(e){var r,i;uL(e),e.type==="Page"&&uL(e.camera),(r=e.states)==null||r.forEach(n=>{n.rotation===void 0||n.rotation===null||(n.rotation=n.rotation.slice(0,3).map(a=>a*xf))});let t=e.geometry;t&&t.type==="SphereGeometry"&&(t.thetaLength=(t.thetaLength??180)*xf),t&&t.type==="TorusGeometry"&&(t.arc=t.arc*xf),t&&t.type==="PathGeometry"&&(t.extrusion.angle*=xf,t.extrusion.twist*=xf),e.type==="Mesh"&&e.geometry.type==="TextGeometry"&&(e.geometry.text={textValue:e.geometry.text}),Array.isArray(qi(e.events))&&((i=e.events)==null||i.forEach(n=>{(n.type==="MouseDown"||n.type==="MouseUp"||n.type==="MousePress"||n.type==="KeyDown"||n.type==="KeyUp"||n.type==="KeyPress"||n.type==="Collision"||n.type==="Trigger")&&(n.runMode=n.toggle?"Toggle":"Repeat")}))}function ZPe(e){e.shared.variables=No({},kt.prototype)}function JPe(e){let t=qi(e.shared.variables);e.shared.variables=No(Object.entries(t??{}).map(([r,i],n)=>({fi:n,id:r,data:i})),Dt.prototype)}var Bl=115;function p8(e,t){t(e.data);for(let r of e.children)p8(r,t)}function eDe(e){let t=e.schema??104;t!==Bl&&t<105&&(p8(e.asset,f8),e.schema=105)}function tDe(e){e.shared.particles=No({},kt.prototype),e.shared.lib&&(e.shared.lib.particles=nc.defaultData().particles)}function rDe(e){e.scene.objects.traverse((t,r)=>{r.type==="Particle"&&typeof r.renderMaterial.size=="number"&&Object.assign(r.renderMaterial,{size:[r.renderMaterial.size,r.renderMaterial.size]})})}function iDe(e){e.scene.objects.traverse((t,r)=>{r.type==="Page"&&(r.postprocessing.depthOfField.focusDistance=100,r.postprocessing.depthOfField.focalLength=20,r.postprocessing.depthOfField.bokehScale=5)})}function nDe(e){e.scene.objects.traverse((t,r)=>{var i;Array.isArray(qi(r.events))!==!1&&((i=r.events)==null||i.forEach(n=>{var o,s,l,c,d,u,h,f,p,v,m;let a=n.runMode;n.type==="MouseDown"||n.type==="MouseUp"||n.type==="KeyDown"||n.type==="KeyUp"||n.type==="Collision"||n.type==="Trigger"?(o=n.actions)==null||o.forEach(g=>{g.type==="Transition"&&(g.runMode=a??"Repeat"),(g.type==="Animation"||g.type==="SwitchCamera")&&(g.runMode=a==="Toggle"?"Toggle":"Normal")}):n.type==="MouseHover"||n.type==="MousePress"||n.type==="KeyPress"?(s=n.actions)==null||s.forEach(g=>{(g.type==="Transition"||g.type==="Animation"||g.type==="SwitchCamera")&&(g.runMode="Toggle")}):n.type==="GameControl"?(delete n.actions,Object.keys(n.gameActions).forEach(g=>{var y;(y=n.gameActions[g])==null||y.forEach(b=>{b.type==="Transition"&&(b.runMode="Repeat"),b.type==="Animation"&&(b.runMode="Normal")})})):n.type==="DragDrop"?(delete n.actions,(c=(l=n.dragDropActions)==null?void 0:l.drag)==null||c.forEach(g=>{(g.type==="Transition"||g.type==="Animation"||g.type==="SwitchCamera")&&(g.runMode="Toggle")}),(u=(d=n.dragDropActions)==null?void 0:d.drop)==null||u.forEach(g=>{(g.type==="Transition"||g.type==="Animation"||g.type==="SwitchCamera")&&(g.runMode="Toggle")})):n.type==="Resize"?(delete n.actions,(h=n.breakpoints)==null||h.forEach(g=>{var y;(y=g.actions)==null||y.forEach(b=>{(b.type==="Transition"||b.type==="Animation"||b.type==="SwitchCamera")&&(b.runMode="Toggle")})})):n.type==="Start"?(f=n.actions)==null||f.forEach(g=>{g.type==="Transition"&&(g.runMode="Once"),(g.type==="Animation"||g.type==="SwitchCamera")&&(g.runMode="Normal")}):n.type==="VariableChange"||n.type==="Scroll"?(p=n.actions)==null||p.forEach(g=>{g.type==="Transition"&&(g.runMode="Repeat"),(g.type==="Animation"||g.type==="SwitchCamera")&&(g.runMode="Normal")}):n.type==="Conditional"&&(delete n.actions,(v=n.inActions)==null||v.forEach(g=>{g.type==="Transition"&&(g.runMode="Repeat"),(g.type==="Animation"||g.type==="SwitchCamera")&&(g.runMode="Normal")}),(m=n.outActions)==null||m.forEach(g=>{g.type==="Transition"&&(g.runMode="Repeat"),(g.type==="Animation"||g.type==="SwitchCamera")&&(g.runMode="Normal")}))}))})}function aDe(e){e.shared.userAPIs=No({},kt.prototype),e.shared.userWebhooks=No({},kt.prototype),e.shared.lib&&(e.shared.lib.userAPIs=nc.defaultData().userAPIs,e.shared.lib.userWebhooks=nc.defaultData().userWebhooks)}function m8(e){let t=e.schema??0;if(t!==Bl){console.warn("updating from ",t,"to ",Bl),XPe(e,t),t<100&&(e.scene.publish.joystickSizeAndXYOffset===void 0&&(e.scene.publish.joystickSizeAndXYOffset=id.defaultData.joystickSizeAndXYOffset),e.schema=100),t<101&&(Kc(e,dL),Xc(e,dL),e.schema=101),t<102&&(KPe(e),e.schema=102),t<104&&(e.shared.catelogs=new kt,e.shared.lib=nc.defaultData(),e.schema=104),t<105&&(ZPe(e),e.scene.objects.traverse((r,i)=>{f8(i)}),e.schema=105);for(let r of Object.values(e.shared.lib.components))eDe(r);t<106&&(JPe(e),e.schema=106),t<107&&(e.shared.lib.variables=nc.defaultData().variables,e.schema=107),t<109&&(tDe(e),e.schema=109),t<110&&(rDe(e),e.schema=110),t<111&&(e.scene.objects.traverse((r,i)=>{QPe(i)}),e.schema=111),t<112&&(iDe(e),e.schema=112),t<113&&(nDe(e),e.schema=113),t<114&&(e.scene.publish.settings.web.imageQuality===void 0&&(e.scene.publish.settings.web.imageQuality=70),e.schema=114),t<115&&(aDe(e),e.schema=115)}}var Gx;(e=>{e.defaultData={schema:Bl,scene:Eu.defaultData,frames:new kt().add("72fc2993-2da3-4b6b-96ac-2879db3a28bd",Pv.defaultData),shared:{..._o.emptyData(),colors:_o.defaultColors()}},e.emptyDataForImports=function(){let a=Eu.emptyDataWithPage();return{schema:Bl,scene:a,frames:new kt().add("72fc2993-2da3-4b6b-96ac-2879db3a28bd",Pv.defaultData),shared:{..._o.emptyData(),colors:_o.defaultColors(),images:_o.defaultImages()}}},e.emptyData=function(){return{schema:Bl,scene:Eu.emptyDataWithPage(),frames:new kt().add("72fc2993-2da3-4b6b-96ac-2879db3a28bd",Pv.defaultData),shared:_o.emptyData()}},e.clipboard2dData=function(){return{schema:Bl,scene:Eu.emptyData(),frames:new kt,shared:_o.emptyData()}},e.collabHelper={...qA,updateSchema(a){return(a.schema??0)<Bl?pg(a,m8):(a.schema??0)-Bl}};function t(a){let o=e.collabHelper.updateSchema(a);return typeof o=="number"?o===0?a:null:o.data}e.updateSchemaDirectly=t;function r(a){return{...a,shared:{...a.shared,lib:nc.defaultData()}}}e.withoutLib=r;function i(a,o){let s=a.scene.objects.get(o);if(s&&s.data.type==="Component")return s;{let l=a.shared.lib.components[o];if(l)return l.asset}}e.getComponentData=i;function n(a){let o=Object.values(a.shared.userAPIs);for(let s of o){let l=s.headers;for(let c of l)if(c.data.key.toLowerCase()==="authorization"&&c.data.value!=="")return!0}return!1}e.hasSensitiveData=n})(Gx||(Gx={}));var EM;(e=>e.emptyImage={data:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVQYV2NgYAAAAAMAAWgmWQ0AAAAASUVORK5CYII=",name:"empty"})(EM||(EM={}));var hL;(e=>{function t(r){return!0}e.is=t})(hL||(hL={}));var $x;(e=>{e.defaultData={position:[0,0],scale:[1,1],rotation:0,shear:[0,0]};function t(i,n){return{position:(n==null?void 0:n.position)??i.position,rotation:(n==null?void 0:n.rotation)??i.rotation,scale:(n==null?void 0:n.scale)??i.scale,shear:(n==null?void 0:n.shear)??i.shear}}e.merge=t;function r(i,n){return TV({position:ql.isEqual(i.position,n.position)?void 0:n.position,rotation:i.rotation===n.rotation?void 0:n.rotation,scale:ql.isEqual(i.scale,n.scale)?void 0:n.scale,shear:i.shear&&n.shear&&ql.isEqual(i.shear,n.shear)?void 0:n.shear})}e.diff=r})($x||($x={}));var TM;(e=>e.defaultData={horizontalConstraint:0,verticalConstraint:0})(TM||(TM={}));var fL;(e=>e.defaultData={direction:"row",wrap:"unwrap",align:"top-left",gap:10,rowGap:10,autoGap:!1,autoRowGap:!1,leftPadding:8,rightPadding:8,topPadding:8,bottomPadding:8})(fL||(fL={}));var qx;(e=>e.defaultData={opacity:1,fill:{color:ri.fromHexAndA(co,1),enabled:!0},stroke:{color:ri.from0to1([0,0,0,1]),thickness:1,enabled:!1,mode:"inside"},layerBlur:{radius:2,enabled:!1},backgroundBlur:{radius:2,enabled:!1},dropShadow:{offset:[10,10],blurRadius:10,color:ri.from0to1([0,0,0,1]),enabled:!1,spread:0},innerShadow:{offset:[10,10],blurRadius:10,color:ri.from0to1([0,0,0,1]),enabled:!1,spread:0}})(qx||(qx={}));var Tu;(e=>{function t(o,s){return{name:s}}e.newEmpty=t;function r(o,s){if(s===void 0)return o;let l={...o},c=["width","height","cornerRadius"];for(let d of c)d in l&&d in s&&s[d]!==void 0&&Object.assign(l,{[d]:s[d]});return l}function i(o,s){if(s===void 0)return o;let l={...o};return"fill"in l&&"fill"in s&&s.fill!==void 0&&Object.assign(l,{fill:{...l.fill,...s.fill}}),"stroke"in l&&"stroke"in s&&s.stroke!==void 0&&Object.assign(l,{stroke:{...l.stroke,...s.stroke}}),"layerBlur"in l&&"layerBlur"in s&&s.layerBlur!==void 0&&Object.assign(l,{layerBlur:{...l.layerBlur,...s.layerBlur}}),"backgroundBlur"in l&&"backgroundBlur"in s&&s.backgroundBlur!==void 0&&Object.assign(l,{backgroundBlur:{...l.backgroundBlur,...s.backgroundBlur}}),"dropShadow"in l&&"dropShadow"in s&&s.dropShadow!==void 0&&Object.assign(l,{dropShadow:{...l.dropShadow,...s.dropShadow}}),"innerShadow"in l&&"innerShadow"in s&&s.innerShadow!==void 0&&Object.assign(l,{innerShadow:{...l.innerShadow,...s.innerShadow}}),l}function n(o,s){if(s===void 0)return o;let l={...o};return Object.assign(l,$x.merge(l,s)),l=r(l,s),l=i(l,s),l}e.patch=n;function a(o,s){let l,c=[];for(let[d,u]of Object.entries(s))d!=="name"&&(l===void 0&&(l={path:[],props:{},type:0},c.push(l)),l.props[d]=u);return c}e.toOps=a})(Tu||(Tu={}));var gg;(e=>e.defaultData={...$x.defaultData,...TM.defaultData,states:new Dt,events:new Dt,visible:!0,raycastLock:!1})(gg||(gg={}));var Ep;(e=>e.defaultData={...gg.defaultData,...qx.defaultData})(Ep||(Ep={}));var Yx;(e=>e.defaultData={cornerRadius:[0,0,0,0]})(Yx||(Yx={}));var PM;(e=>e.defaultData={...Ep.defaultData,type:"ellipse2d",width:100,height:100,name:"Ellipse"})(PM||(PM={}));var yg;(e=>e.defaultData={...Ep.defaultData,...Yx.defaultData,type:"rectangle2d",width:100,height:100,name:"Rectangle"})(yg||(yg={}));var DM;(e=>e.defaultData={...Ep.defaultData,type:"text2d",width:100,height:100,fontSize:12,lineHeight:1.2,letterSpacing:0,text:{textValue:"Hello world"},horizontalAlign:1,verticalAlign:1,textTransform:1,font:"Roboto_regular",name:"Text"})(DM||(DM={}));var OM;(e=>e.defaultData={...Ep.defaultData,type:"path2d",path:"",name:"Path"})(OM||(OM={}));var pL;(e=>{function t(r){return r.type==="ellipse2d"||r.type==="rectangle2d"||r.type==="text2d"||r.type==="vector2d"||r.type==="path2d"}e.is=t})(pL||(pL={}));var Xx;(e=>e.defaultData={...gg.defaultData,name:"Group",type:"group2d"})(Xx||(Xx={}));var RM;(e=>e.defaultData=()=>({...gg.defaultData,...Yx.defaultData,...qx.defaultData,name:"Frame",type:"frame2d",clipped:!0,width:200,height:200,fill:{color:ri.fromHexAndA(4737101,1),enabled:!0},stroke:{color:ri.fromHexAndA(0,1),thickness:1,enabled:!1,mode:"inside"},backgroundBlur:{radius:2,enabled:!1},layerBlur:{radius:2,enabled:!1}}))(RM||(RM={}));var Hu;(e=>{function t(o){switch(o){case"rectangle2d":return{...yg.defaultData};case"ellipse2d":return{...PM.defaultData};case"text2d":return{...DM.defaultData};case"vector2d":return{...yg.defaultData};case"path2d":return{...OM.defaultData};case"frame2d":return{...RM.defaultData()};case"group2d":return{...Xx.defaultData}}}e.defaultData=t;function r(o){return"width"in o&&"height"in o?[typeof o.width=="number"?o.width*.5:0,typeof o.height=="number"?o.height*.5:0]:[0,0]}e.getPivot=r;function i(o){return o.type==="rectangle2d"||o.type==="ellipse2d"||o.type==="text2d"||o.type==="frame2d"}e.isResizeable=i;function n(o){return o.type==="frame2d"&&o.autoLayout!==void 0}e.isAutoLayoutable=n;function a(o){return o.type==="rectangle2d"||o.type==="frame2d"}e.hasCorners=a})(Hu||(Hu={}));var IM;(e=>(e.defaultData={name:"UI",type:"scene2d",objects:new Jn},e.emptyData=function(){return{type:"scene2d",objects:new Jn}}))(IM||(IM={}));function Pu(e,t=!1){let r=e[0].index!==null,i=new Set(Object.keys(e[0].attributes)),n=new Set(Object.keys(e[0].morphAttributes)),a={},o={},s=e[0].morphTargetsRelative,l=new Ot,c=0;for(let d=0;d<e.length;++d){let u=e[d],h=0;if(r!==(u.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+d+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(let f in u.attributes){if(!i.has(f))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+d+'. All geometries must have compatible attributes; make sure "'+f+'" attribute exists among all geometries, or in none of them.'),null;a[f]===void 0&&(a[f]=[]),a[f].push(u.attributes[f]),h++}if(h!==i.size)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+d+". Make sure all geometries have the same number of attributes."),null;if(s!==u.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+d+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(let f in u.morphAttributes){if(!n.has(f))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+d+".  .morphAttributes must be consistent throughout all geometries."),null;o[f]===void 0&&(o[f]=[]),o[f].push(u.morphAttributes[f])}if(t){let f;if(r)f=u.index.count;else if(u.attributes.position!==void 0)f=u.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+d+". The geometry must have either an index or a position attribute"),null;l.addGroup(c,f,d),c+=f}}if(r){let d=0,u=[];for(let h=0;h<e.length;++h){let f=e[h].index;for(let p=0;p<f.count;++p)u.push(f.getX(p)+d);d+=e[h].attributes.position.count}l.setIndex(u)}for(let d in a){let u=mL(a[d]);if(!u)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+d+" attribute."),null;l.setAttribute(d,u)}for(let d in o){let u=o[d][0].length;if(u===0)break;l.morphAttributes=l.morphAttributes||{},l.morphAttributes[d]=[];for(let h=0;h<u;++h){let f=[];for(let v=0;v<o[d].length;++v)f.push(o[d][v][h]);let p=mL(f);if(!p)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+d+" morphAttribute."),null;l.morphAttributes[d].push(p)}}return l}function mL(e){let t,r,i,n=0;for(let s=0;s<e.length;++s){let l=e[s];if(l.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. InterleavedBufferAttributes are not supported."),null;if(t===void 0&&(t=l.array.constructor),t!==l.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(r===void 0&&(r=l.itemSize),r!==l.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(i===void 0&&(i=l.normalized),i!==l.normalized)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;n+=l.array.length}let a=new t(n),o=0;for(let s=0;s<e.length;++s)a.set(e[s].array,o),o+=e[s].array.length;return new $t(a,r,i)}var oDe=Math.pow(2,-24),vy=class{constructor(){}};function Gs(e,t,r){return r.min.x=t[e],r.min.y=t[e+1],r.min.z=t[e+2],r.max.x=t[e+3],r.max.y=t[e+4],r.max.z=t[e+5],r}function vL(e){let t=-1,r=-1/0;for(let i=0;i<3;i++){let n=e[i+3]-e[i];n>r&&(r=n,t=i)}return t}function gL(e,t){t.set(e)}function yL(e,t,r){let i,n;for(let a=0;a<3;a++){let o=a+3;i=e[a],n=t[a],r[a]=i<n?i:n,i=e[o],n=t[o],r[o]=i>n?i:n}}function gy(e,t,r){for(let i=0;i<3;i++){let n=t[e+2*i],a=t[e+2*i+1],o=n-a,s=n+a;o<r[i]&&(r[i]=o),s>r[i+3]&&(r[i+3]=s)}}function Pm(e){let t=e[3]-e[0],r=e[4]-e[1],i=e[5]-e[2];return 2*(t*r+r*i+i*t)}function sDe(e,t){if(!e.index){let r=e.attributes.position.count,i=t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer,n;r>65535?n=new Uint32Array(new i(4*r)):n=new Uint16Array(new i(2*r)),e.setIndex(new $t(n,1));for(let a=0;a<r;a++)n[a]=a}}function lDe(e){if(!e.groups||!e.groups.length)return[{offset:0,count:e.index.count/3}];let t=[],r=new Set;for(let n of e.groups)r.add(n.start),r.add(n.start+n.count);let i=Array.from(r.values()).sort((n,a)=>n-a);for(let n=0;n<i.length-1;n++){let a=i[n],o=i[n+1];t.push({offset:a/3,count:(o-a)/3})}return t}function wC(e,t,r,i,n=null){let a=1/0,o=1/0,s=1/0,l=-1/0,c=-1/0,d=-1/0,u=1/0,h=1/0,f=1/0,p=-1/0,v=-1/0,m=-1/0,g=n!==null;for(let y=t*6,b=(t+r)*6;y<b;y+=6){let x=e[y+0],S=e[y+1],w=x-S,_=x+S;w<a&&(a=w),_>l&&(l=_),g&&x<u&&(u=x),g&&x>p&&(p=x);let C=e[y+2],A=e[y+3],M=C-A,P=C+A;M<o&&(o=M),P>c&&(c=P),g&&C<h&&(h=C),g&&C>v&&(v=C);let T=e[y+4],R=e[y+5],z=T-R,F=T+R;z<s&&(s=z),F>d&&(d=F),g&&T<f&&(f=T),g&&T>m&&(m=T)}i[0]=a,i[1]=o,i[2]=s,i[3]=l,i[4]=c,i[5]=d,g&&(n[0]=u,n[1]=h,n[2]=f,n[3]=p,n[4]=v,n[5]=m)}function cDe(e,t,r,i){let n=1/0,a=1/0,o=1/0,s=-1/0,l=-1/0,c=-1/0;for(let d=t*6,u=(t+r)*6;d<u;d+=6){let h=e[d+0];h<n&&(n=h),h>s&&(s=h);let f=e[d+2];f<a&&(a=f),f>l&&(l=f);let p=e[d+4];p<o&&(o=p),p>c&&(c=p)}i[0]=n,i[1]=a,i[2]=o,i[3]=s,i[4]=l,i[5]=c}function dDe(e,t,r,i,n){let a=r,o=r+i-1,s=n.pos,l=n.axis*2;for(;;){for(;a<=o&&t[a*6+l]<s;)a++;for(;a<=o&&t[o*6+l]>=s;)o--;if(a<o){for(let c=0;c<3;c++){let d=e[a*3+c];e[a*3+c]=e[o*3+c],e[o*3+c]=d;let u=t[a*6+c*2+0];t[a*6+c*2+0]=t[o*6+c*2+0],t[o*6+c*2+0]=u;let h=t[a*6+c*2+1];t[a*6+c*2+1]=t[o*6+c*2+1],t[o*6+c*2+1]=h}a++,o--}else return a}}var Dl=32,uDe=(e,t)=>e.candidate-t.candidate,Pc=new Array(Dl).fill().map(()=>({count:0,bounds:new Float32Array(6),rightCacheBounds:new Float32Array(6),leftCacheBounds:new Float32Array(6),candidate:0})),yy=new Float32Array(6);function hDe(e,t,r,i,n,a){let o=-1,s=0;if(a===0)o=vL(t),o!==-1&&(s=(t[o]+t[o+3])/2);else if(a===1)o=vL(e),o!==-1&&(s=fDe(r,i,n,o));else if(a===2){let l=Pm(e),c=1.25*n,d=i*6,u=(i+n)*6;for(let h=0;h<3;h++){let f=t[h],p=(t[h+3]-f)/Dl;if(n<Dl/4){let v=[...Pc];v.length=n;let m=0;for(let y=d;y<u;y+=6,m++){let b=v[m];b.candidate=r[y+2*h],b.count=0;let{bounds:x,leftCacheBounds:S,rightCacheBounds:w}=b;for(let _=0;_<3;_++)w[_]=1/0,w[_+3]=-1/0,S[_]=1/0,S[_+3]=-1/0,x[_]=1/0,x[_+3]=-1/0;gy(y,r,x)}v.sort(uDe);let g=n;for(let y=0;y<g;y++){let b=v[y];for(;y+1<g&&v[y+1].candidate===b.candidate;)v.splice(y+1,1),g--}for(let y=d;y<u;y+=6){let b=r[y+2*h];for(let x=0;x<g;x++){let S=v[x];b>=S.candidate?gy(y,r,S.rightCacheBounds):(gy(y,r,S.leftCacheBounds),S.count++)}}for(let y=0;y<g;y++){let b=v[y],x=b.count,S=n-b.count,w=b.leftCacheBounds,_=b.rightCacheBounds,C=0;x!==0&&(C=Pm(w)/l);let A=0;S!==0&&(A=Pm(_)/l);let M=1+1.25*(C*x+A*S);M<c&&(o=h,c=M,s=b.candidate)}}else{for(let g=0;g<Dl;g++){let y=Pc[g];y.count=0,y.candidate=f+p+g*p;let b=y.bounds;for(let x=0;x<3;x++)b[x]=1/0,b[x+3]=-1/0}for(let g=d;g<u;g+=6){let y=~~((r[g+2*h]-f)/p);y>=Dl&&(y=Dl-1);let b=Pc[y];b.count++,gy(g,r,b.bounds)}let v=Pc[Dl-1];gL(v.bounds,v.rightCacheBounds);for(let g=Dl-2;g>=0;g--){let y=Pc[g],b=Pc[g+1];yL(y.bounds,b.rightCacheBounds,y.rightCacheBounds)}let m=0;for(let g=0;g<Dl-1;g++){let y=Pc[g],b=y.count,x=y.bounds,S=Pc[g+1].rightCacheBounds;b!==0&&(m===0?gL(x,yy):yL(x,yy,yy)),m+=b;let w=0,_=0;m!==0&&(w=Pm(yy)/l);let C=n-m;C!==0&&(_=Pm(S)/l);let A=1+1.25*(w*m+_*C);A<c&&(o=h,c=A,s=y.candidate)}}}}else console.warn(`MeshBVH: Invalid build strategy value ${a} used.`);return{axis:o,pos:s}}function fDe(e,t,r,i){let n=0;for(let a=t,o=t+r;a<o;a++)n+=e[a*6+i*2];return n/r}function pDe(e,t){let r=e.attributes.position,i=e.index.array,n=i.length/3,a=new Float32Array(n*6),o=r.normalized,s=r.array,l=r.offset||0,c=3;r.isInterleavedBufferAttribute&&(c=r.data.stride);let d=["getX","getY","getZ"];for(let u=0;u<n;u++){let h=u*3,f=u*6,p,v,m;o?(p=i[h+0],v=i[h+1],m=i[h+2]):(p=i[h+0]*c+l,v=i[h+1]*c+l,m=i[h+2]*c+l);for(let g=0;g<3;g++){let y,b,x;o?(y=r[d[g]](p),b=r[d[g]](v),x=r[d[g]](m)):(y=s[p+g],b=s[v+g],x=s[m+g]);let S=y;b<S&&(S=b),x<S&&(S=x);let w=y;b>w&&(w=b),x>w&&(w=x);let _=(w-S)/2,C=g*2;a[f+C+0]=S+_,a[f+C+1]=_+(Math.abs(S)+_)*oDe,S<t[g]&&(t[g]=S),w>t[g+3]&&(t[g+3]=w)}}return a}function mDe(e,t){function r(g){h&&h(g/f)}function i(g,y,b,x=null,S=0){if(!p&&S>=l&&(p=!0,c&&(console.warn(`MeshBVH: Max depth of ${l} reached when generating BVH. Consider increasing maxDepth.`),console.warn(e))),b<=d||S>=l)return r(y+b),g.offset=y,g.count=b,g;let w=hDe(g.boundingData,x,o,y,b,u);if(w.axis===-1)return r(y+b),g.offset=y,g.count=b,g;let _=dDe(s,o,y,b,w);if(_===y||_===y+b)r(y+b),g.offset=y,g.count=b;else{g.splitAxis=w.axis;let C=new vy,A=y,M=_-y;g.left=C,C.boundingData=new Float32Array(6),wC(o,A,M,C.boundingData,a),i(C,A,M,a,S+1);let P=new vy,T=_,R=b-M;g.right=P,P.boundingData=new Float32Array(6),wC(o,T,R,P.boundingData,a),i(P,T,R,a,S+1)}return g}sDe(e,t);let n=new Float32Array(6),a=new Float32Array(6),o=pDe(e,n),s=e.index.array,l=t.maxDepth,c=t.verbose,d=t.maxLeafTris,u=t.strategy,h=t.onProgress,f=e.index.count/3,p=!1,v=[],m=lDe(e);if(m.length===1){let g=m[0],y=new vy;y.boundingData=n,cDe(o,g.offset,g.count,a),i(y,g.offset,g.count,a),v.push(y)}else for(let g of m){let y=new vy;y.boundingData=new Float32Array(6),wC(o,g.offset,g.count,y.boundingData,a),i(y,g.offset,g.count,a),v.push(y)}return v}function vDe(e,t){let r=mDe(e,t),i,n,a,o=[],s=t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;for(let d=0;d<r.length;d++){let u=r[d],h=l(u),f=new s(32*h);i=new Float32Array(f),n=new Uint32Array(f),a=new Uint16Array(f),c(0,u),o.push(f)}return o;function l(d){return d.count?1:1+l(d.left)+l(d.right)}function c(d,u){let h=d/4,f=d/2,p=!!u.count,v=u.boundingData;for(let m=0;m<6;m++)i[h+m]=v[m];if(p){let m=u.offset,g=u.count;return n[h+6]=m,a[f+14]=g,a[f+15]=65535,d+32}else{let m=u.left,g=u.right,y=u.splitAxis,b;if(b=c(d+32,m),b/4>Math.pow(2,32))throw new Error("MeshBVH: Cannot store child pointer greater than 32 bits.");return n[h+6]=b/4,b=c(b,g),n[h+7]=y,b}}}var ac=class{constructor(){this.min=1/0,this.max=-1/0}setFromPointsField(e,t){let r=1/0,i=-1/0;for(let n=0,a=e.length;n<a;n++){let o=e[n][t];r=o<r?o:r,i=o>i?o:i}this.min=r,this.max=i}setFromPoints(e,t){let r=1/0,i=-1/0;for(let n=0,a=t.length;n<a;n++){let o=t[n],s=e.dot(o);r=s<r?s:r,i=s>i?s:i}this.min=r,this.max=i}isSeparated(e){return this.min>e.max||e.min>this.max}};ac.prototype.setFromBox=function(){let e=new k;return function(t,r){let i=r.min,n=r.max,a=1/0,o=-1/0;for(let s=0;s<=1;s++)for(let l=0;l<=1;l++)for(let c=0;c<=1;c++){e.x=i.x*s+n.x*(1-s),e.y=i.y*l+n.y*(1-l),e.z=i.z*c+n.z*(1-c);let d=t.dot(e);a=Math.min(d,a),o=Math.max(d,o)}this.min=a,this.max=o}}();var gDe=function(){let e=new k,t=new k,r=new k;return function(i,n,a){let o=i.start,s=e,l=n.start,c=t;r.subVectors(o,l),e.subVectors(i.end,i.start),t.subVectors(n.end,n.start);let d=r.dot(c),u=c.dot(s),h=c.dot(c),f=r.dot(s),p=s.dot(s)*h-u*u,v,m;p!==0?v=(d*u-f*h)/p:v=0,m=(d+v*u)/h,a.x=v,a.y=m}}(),jP=function(){let e=new ye,t=new k,r=new k;return function(i,n,a,o){gDe(i,n,e);let s=e.x,l=e.y;if(s>=0&&s<=1&&l>=0&&l<=1){i.at(s,a),n.at(l,o);return}else if(s>=0&&s<=1){l<0?n.at(0,o):n.at(1,o),i.closestPointToPoint(o,!0,a);return}else if(l>=0&&l<=1){s<0?i.at(0,a):i.at(1,a),n.closestPointToPoint(a,!0,o);return}else{let c;s<0?c=i.start:c=i.end;let d;l<0?d=n.start:d=n.end;let u=t,h=r;if(i.closestPointToPoint(d,!0,t),n.closestPointToPoint(c,!0,r),u.distanceToSquared(d)<=h.distanceToSquared(c)){a.copy(u),o.copy(d);return}else{a.copy(c),o.copy(h);return}}}}(),yDe=function(){let e=new k,t=new k,r=new Va,i=new zo;return function(n,a){let{radius:o,center:s}=n,{a:l,b:c,c:d}=a;if(i.start=l,i.end=c,i.closestPointToPoint(s,!0,e).distanceTo(s)<=o||(i.start=l,i.end=d,i.closestPointToPoint(s,!0,e).distanceTo(s)<=o)||(i.start=c,i.end=d,i.closestPointToPoint(s,!0,e).distanceTo(s)<=o))return!0;let u=a.getPlane(r);if(Math.abs(u.distanceToPoint(s))<=o){let h=u.projectPoint(s,t);if(a.containsPoint(h))return!0}return!1}}(),bDe=1e-15;function Jh(e){return Math.abs(e)<bDe}var oc=class extends Zn{constructor(...e){super(...e),this.isExtendedTriangle=!0,this.satAxes=new Array(4).fill().map(()=>new k),this.satBounds=new Array(4).fill().map(()=>new ac),this.points=[this.a,this.b,this.c],this.sphere=new Za,this.plane=new Va,this.needsUpdate=!0}intersectsSphere(e){return yDe(e,this)}update(){let e=this.a,t=this.b,r=this.c,i=this.points,n=this.satAxes,a=this.satBounds,o=n[0],s=a[0];this.getNormal(o),s.setFromPoints(o,i);let l=n[1],c=a[1];l.subVectors(e,t),c.setFromPoints(l,i);let d=n[2],u=a[2];d.subVectors(t,r),u.setFromPoints(d,i);let h=n[3],f=a[3];h.subVectors(r,e),f.setFromPoints(h,i),this.sphere.setFromPoints(this.points),this.plane.setFromNormalAndCoplanarPoint(o,e),this.needsUpdate=!1}};oc.prototype.closestPointToSegment=function(){let e=new k,t=new k,r=new zo;return function(i,n=null,a=null){let{start:o,end:s}=i,l=this.points,c,d=1/0;for(let u=0;u<3;u++){let h=(u+1)%3;r.start.copy(l[u]),r.end.copy(l[h]),jP(r,i,e,t),c=e.distanceToSquared(t),c<d&&(d=c,n&&n.copy(e),a&&a.copy(t))}return this.closestPointToPoint(o,e),c=o.distanceToSquared(e),c<d&&(d=c,n&&n.copy(e),a&&a.copy(o)),this.closestPointToPoint(s,e),c=s.distanceToSquared(e),c<d&&(d=c,n&&n.copy(e),a&&a.copy(s)),Math.sqrt(d)}}();oc.prototype.intersectsTriangle=function(){let e=new oc,t=new Array(3),r=new Array(3),i=new ac,n=new ac,a=new k,o=new k,s=new k,l=new k,c=new zo,d=new zo,u=new zo;return function(h,f=null,p=!1){this.needsUpdate&&this.update(),h.isExtendedTriangle?h.needsUpdate&&h.update():(e.copy(h),e.update(),h=e);let v=this.plane,m=h.plane;if(Math.abs(v.normal.dot(m.normal))>1-1e-10){let g=this.satBounds,y=this.satAxes;r[0]=h.a,r[1]=h.b,r[2]=h.c;for(let S=0;S<4;S++){let w=g[S],_=y[S];if(i.setFromPoints(_,r),w.isSeparated(i))return!1}let b=h.satBounds,x=h.satAxes;t[0]=this.a,t[1]=this.b,t[2]=this.c;for(let S=0;S<4;S++){let w=b[S],_=x[S];if(i.setFromPoints(_,t),w.isSeparated(i))return!1}for(let S=0;S<4;S++){let w=y[S];for(let _=0;_<4;_++){let C=x[_];if(a.crossVectors(w,C),i.setFromPoints(a,t),n.setFromPoints(a,r),i.isSeparated(n))return!1}}return f&&(p||console.warn("ExtendedTriangle.intersectsTriangle: Triangles are coplanar which does not support an output edge. Setting edge to 0, 0, 0."),f.start.set(0,0,0),f.end.set(0,0,0)),!0}else{let g=this.points,y=!1,b=0;for(let R=0;R<3;R++){let z=g[R],F=g[(R+1)%3];c.start.copy(z),c.end.copy(F),c.delta(o);let H=y?d.start:d.end,N=Jh(m.distanceToPoint(z));if(Jh(m.normal.dot(o))&&N){d.copy(c),b=2;break}if((m.intersectLine(c,H)||N)&&!Jh(H.distanceTo(F))){if(b++,y)break;y=!0}}if(b===1&&h.containsPoint(d.end))return f&&(f.start.copy(d.end),f.end.copy(d.end)),!0;if(b!==2)return!1;let x=h.points,S=!1,w=0;for(let R=0;R<3;R++){let z=x[R],F=x[(R+1)%3];c.start.copy(z),c.end.copy(F),c.delta(s);let H=S?u.start:u.end,N=Jh(v.distanceToPoint(z));if(Jh(v.normal.dot(s))&&N){u.copy(c),w=2;break}if((v.intersectLine(c,H)||N)&&!Jh(H.distanceTo(F))){if(w++,S)break;S=!0}}if(w===1&&this.containsPoint(u.end))return f&&(f.start.copy(u.end),f.end.copy(u.end)),!0;if(w!==2)return!1;if(d.delta(o),u.delta(s),o.dot(s)<0){let R=u.start;u.start=u.end,u.end=R}let _=d.start.dot(o),C=d.end.dot(o),A=u.start.dot(o),M=u.end.dot(o),P=C<A,T=_<M;return _!==M&&A!==C&&P===T?!1:(f&&(l.subVectors(d.start,u.start),l.dot(o)>0?f.start.copy(d.start):f.start.copy(u.start),l.subVectors(d.end,u.end),l.dot(o)<0?f.end.copy(d.end):f.end.copy(u.end)),!0)}}}();oc.prototype.distanceToPoint=function(){let e=new k;return function(t){return this.closestPointToPoint(t,e),t.distanceTo(e)}}();oc.prototype.distanceToTriangle=function(){let e=new k,t=new k,r=["a","b","c"],i=new zo,n=new zo;return function(a,o=null,s=null){let l=o||s?i:null;if(this.intersectsTriangle(a,l))return(o||s)&&(o&&l.getCenter(o),s&&l.getCenter(s)),0;let c=1/0;for(let d=0;d<3;d++){let u,h=r[d],f=a[h];this.closestPointToPoint(f,e),u=f.distanceToSquared(e),u<c&&(c=u,o&&o.copy(e),s&&s.copy(f));let p=this[h];a.closestPointToPoint(p,e),u=p.distanceToSquared(e),u<c&&(c=u,o&&o.copy(p),s&&s.copy(e))}for(let d=0;d<3;d++){let u=r[d],h=r[(d+1)%3];i.set(this[u],this[h]);for(let f=0;f<3;f++){let p=r[f],v=r[(f+1)%3];n.set(a[p],a[v]),jP(i,n,e,t);let m=e.distanceToSquared(t);m<c&&(c=m,o&&o.copy(e),s&&s.copy(t))}}return Math.sqrt(c)}}();var sl=class{constructor(e,t,r){this.isOrientedBox=!0,this.min=new k,this.max=new k,this.matrix=new it,this.invMatrix=new it,this.points=new Array(8).fill().map(()=>new k),this.satAxes=new Array(3).fill().map(()=>new k),this.satBounds=new Array(3).fill().map(()=>new ac),this.alignedSatBounds=new Array(3).fill().map(()=>new ac),this.needsUpdate=!1,e&&this.min.copy(e),t&&this.max.copy(t),r&&this.matrix.copy(r)}set(e,t,r){this.min.copy(e),this.max.copy(t),this.matrix.copy(r),this.needsUpdate=!0}copy(e){this.min.copy(e.min),this.max.copy(e.max),this.matrix.copy(e.matrix),this.needsUpdate=!0}};sl.prototype.update=function(){return function(){let e=this.matrix,t=this.min,r=this.max,i=this.points;for(let l=0;l<=1;l++)for(let c=0;c<=1;c++)for(let d=0;d<=1;d++){let u=1*l|2*c|4*d,h=i[u];h.x=l?r.x:t.x,h.y=c?r.y:t.y,h.z=d?r.z:t.z,h.applyMatrix4(e)}let n=this.satBounds,a=this.satAxes,o=i[0];for(let l=0;l<3;l++){let c=a[l],d=n[l],u=1<<l,h=i[u];c.subVectors(o,h),d.setFromPoints(c,i)}let s=this.alignedSatBounds;s[0].setFromPointsField(i,"x"),s[1].setFromPointsField(i,"y"),s[2].setFromPointsField(i,"z"),this.invMatrix.copy(this.matrix).invert(),this.needsUpdate=!1}}();sl.prototype.intersectsBox=function(){let e=new ac;return function(t){this.needsUpdate&&this.update();let r=t.min,i=t.max,n=this.satBounds,a=this.satAxes,o=this.alignedSatBounds;if(e.min=r.x,e.max=i.x,o[0].isSeparated(e)||(e.min=r.y,e.max=i.y,o[1].isSeparated(e))||(e.min=r.z,e.max=i.z,o[2].isSeparated(e)))return!1;for(let s=0;s<3;s++){let l=a[s],c=n[s];if(e.setFromBox(l,t),c.isSeparated(e))return!1}return!0}}();sl.prototype.intersectsTriangle=function(){let e=new oc,t=new Array(3),r=new ac,i=new ac,n=new k;return function(a){this.needsUpdate&&this.update(),a.isExtendedTriangle?a.needsUpdate&&a.update():(e.copy(a),e.update(),a=e);let o=this.satBounds,s=this.satAxes;t[0]=a.a,t[1]=a.b,t[2]=a.c;for(let u=0;u<3;u++){let h=o[u],f=s[u];if(r.setFromPoints(f,t),h.isSeparated(r))return!1}let l=a.satBounds,c=a.satAxes,d=this.points;for(let u=0;u<3;u++){let h=l[u],f=c[u];if(r.setFromPoints(f,d),h.isSeparated(r))return!1}for(let u=0;u<3;u++){let h=s[u];for(let f=0;f<4;f++){let p=c[f];if(n.crossVectors(h,p),r.setFromPoints(n,t),i.setFromPoints(n,d),r.isSeparated(i))return!1}}return!0}}();sl.prototype.closestPointToPoint=function(){return function(e,t){return this.needsUpdate&&this.update(),t.copy(e).applyMatrix4(this.invMatrix).clamp(this.min,this.max).applyMatrix4(this.matrix),t}}();sl.prototype.distanceToPoint=function(){let e=new k;return function(t){return this.closestPointToPoint(t,e),t.distanceTo(e)}}();sl.prototype.distanceToBox=function(){let e=["x","y","z"],t=new Array(12).fill().map(()=>new zo),r=new Array(12).fill().map(()=>new zo),i=new k,n=new k;return function(a,o=0,s=null,l=null){if(this.needsUpdate&&this.update(),this.intersectsBox(a))return(s||l)&&(a.getCenter(n),this.closestPointToPoint(n,i),a.closestPointToPoint(i,n),s&&s.copy(i),l&&l.copy(n)),0;let c=o*o,d=a.min,u=a.max,h=this.points,f=1/0;for(let v=0;v<8;v++){let m=h[v];n.copy(m).clamp(d,u);let g=m.distanceToSquared(n);if(g<f&&(f=g,s&&s.copy(m),l&&l.copy(n),g<c))return Math.sqrt(g)}let p=0;for(let v=0;v<3;v++)for(let m=0;m<=1;m++)for(let g=0;g<=1;g++){let y=(v+1)%3,b=(v+2)%3,x=m<<y|g<<b,S=1<<v|m<<y|g<<b,w=h[x],_=h[S];t[p].set(w,_);let C=e[v],A=e[y],M=e[b],P=r[p],T=P.start,R=P.end;T[C]=d[C],T[A]=m?d[A]:u[A],T[M]=g?d[M]:u[A],R[C]=u[C],R[A]=m?d[A]:u[A],R[M]=g?d[M]:u[A],p++}for(let v=0;v<=1;v++)for(let m=0;m<=1;m++)for(let g=0;g<=1;g++){n.x=v?u.x:d.x,n.y=m?u.y:d.y,n.z=g?u.z:d.z,this.closestPointToPoint(n,i);let y=n.distanceToSquared(i);if(y<f&&(f=y,s&&s.copy(i),l&&l.copy(n),y<c))return Math.sqrt(y)}for(let v=0;v<12;v++){let m=t[v];for(let g=0;g<12;g++){let y=r[g];jP(m,y,i,n);let b=i.distanceToSquared(n);if(b<f&&(f=b,s&&s.copy(i),l&&l.copy(n),b<c))return Math.sqrt(b)}}return Math.sqrt(f)}}();var ef=new k,tf=new k,rf=new k,by=new ye,xy=new ye,wy=new ye,bL=new k,xL=new k,wL=new k,Sy=new k;function xDe(e,t,r,i,n,a){let o;return a===Ln?o=e.intersectTriangle(i,r,t,!0,n):o=e.intersectTriangle(t,r,i,a!==fa,n),o===null?null:{distance:e.origin.distanceTo(n),point:n.clone()}}function wDe(e,t,r,i,n,a,o,s,l){ef.fromBufferAttribute(t,a),tf.fromBufferAttribute(t,o),rf.fromBufferAttribute(t,s);let c=xDe(e,ef,tf,rf,Sy,l);if(c){i&&(by.fromBufferAttribute(i,a),xy.fromBufferAttribute(i,o),wy.fromBufferAttribute(i,s),c.uv=Zn.getInterpolation(Sy,ef,tf,rf,by,xy,wy,new ye)),n&&(by.fromBufferAttribute(n,a),xy.fromBufferAttribute(n,o),wy.fromBufferAttribute(n,s),c.uv1=Zn.getInterpolation(Sy,ef,tf,rf,by,xy,wy,new ye)),r&&(bL.fromBufferAttribute(r,a),xL.fromBufferAttribute(r,o),wL.fromBufferAttribute(r,s),c.normal=Zn.getInterpolation(Sy,ef,tf,rf,bL,xL,wL,new k),c.normal.dot(e.direction)>0&&c.normal.multiplyScalar(-1));let d={a,b:o,c:s,normal:new k,materialIndex:0};Zn.getNormal(ef,tf,rf,d.normal),c.face=d,c.faceIndex=a}return c}function v8(e,t,r,i,n){let a=i*3,o=e.index.getX(a),s=e.index.getX(a+1),l=e.index.getX(a+2),{position:c,normal:d,uv:u,uv1:h}=e.attributes,f=wDe(r,c,d,u,h,o,s,l,t);return f?(f.faceIndex=i,n&&n.push(f),f):null}function SDe(e,t,r,i,n,a){for(let o=i,s=i+n;o<s;o++)v8(e,t,r,o,a)}function CDe(e,t,r,i,n){let a=1/0,o=null;for(let s=i,l=i+n;s<l;s++){let c=v8(e,t,r,s);c&&c.distance<a&&(o=c,a=c.distance)}return o}function Ns(e,t,r,i){let n=e.a,a=e.b,o=e.c,s=t,l=t+1,c=t+2;r&&(s=r.getX(t),l=r.getX(t+1),c=r.getX(t+2)),n.x=i.getX(s),n.y=i.getY(s),n.z=i.getZ(s),a.x=i.getX(l),a.y=i.getY(l),a.z=i.getZ(l),o.x=i.getX(c),o.y=i.getY(c),o.z=i.getZ(c)}function SL(e,t,r,i,n,a,o){let s=r.index,l=r.attributes.position;for(let c=e,d=t+e;c<d;c++)if(Ns(o,c*3,s,l),o.needsUpdate=!0,i(o,c,n,a))return!0;return!1}var g8=class{constructor(e){this._getNewPrimitive=e,this._primitives=[]}getPrimitive(){let e=this._primitives;return e.length===0?this._getNewPrimitive():e.pop()}releasePrimitive(e){this._primitives.push(e)}};function Qc(e,t){return t[e+15]===65535}function Gf(e,t){return t[e+6]}function bg(e,t){return t[e+14]}function xg(e){return e+8}function wg(e,t){return t[e+6]}function _De(e,t){return t[e+7]}var Df=new Zi,Kx=new k,ADe=["x","y","z"];function zM(e,t,r,i,n){let a=e*2,o=Jp,s=md,l=vd;if(Qc(a,s)){let c=Gf(e,l),d=bg(a,s);SDe(t,r,i,c,d,n)}else{let c=xg(e);Qx(c,o,i,Kx)&&zM(c,t,r,i,n);let d=wg(e,l);Qx(d,o,i,Kx)&&zM(d,t,r,i,n)}}function kM(e,t,r,i){let n=e*2,a=Jp,o=md,s=vd;if(Qc(n,o)){let l=Gf(e,s),c=bg(n,o);return CDe(t,r,i,l,c)}else{let l=_De(e,s),c=ADe[l],d=i.direction[c]>=0,u,h;d?(u=xg(e),h=wg(e,s)):(u=wg(e,s),h=xg(e));let f=Qx(u,a,i,Kx)?kM(u,t,r,i):null;if(f){let v=f.point[c];if(d?v<=a[h+l]:v>=a[h+l+3])return f}let p=Qx(h,a,i,Kx)?kM(h,t,r,i):null;return f&&p?f.distance<=p.distance?f:p:f||p||null}}var MDe=function(){let e,t,r=[],i=new g8(()=>new Zi);return function(...a){e=i.getPrimitive(),t=i.getPrimitive(),r.push(e,t);let o=n(...a);i.releasePrimitive(e),i.releasePrimitive(t),r.pop(),r.pop();let s=r.length;return s>0&&(t=r[s-1],e=r[s-2]),o};function n(a,o,s,l,c=null,d=0,u=0){function h(y){let b=y*2,x=md,S=vd;for(;!Qc(b,x);)y=xg(y),b=y*2;return Gf(y,S)}function f(y){let b=y*2,x=md,S=vd;for(;!Qc(b,x);)y=wg(y,S),b=y*2;return Gf(y,S)+bg(b,x)}let p=a*2,v=Jp,m=md,g=vd;if(Qc(p,m)){let y=Gf(a,g),b=bg(p,m);return Gs(a,v,e),l(y,b,!1,u,d+a,e)}else{let y=xg(a),b=wg(a,g),x=y,S=b,w,_,C,A;if(c&&(C=e,A=t,Gs(x,v,C),Gs(S,v,A),w=c(C),_=c(A),_<w)){x=b,S=y;let H=w;w=_,_=H,C=A}C||(C=e,Gs(x,v,C));let M=Qc(x*2,m),P=s(C,M,w,u+1,d+x),T;if(P===2){let H=h(x),N=f(x)-H;T=l(H,N,!0,u+1,d+x,C)}else T=P&&n(x,o,s,l,c,d,u+1);if(T)return!0;A=t,Gs(S,v,A);let R=Qc(S*2,m),z=s(A,R,_,u+1,d+S),F;if(z===2){let H=h(S),N=f(S)-H;F=l(H,N,!0,u+1,d+S,A)}else F=z&&n(S,o,s,l,c,d,u+1);return!!F}}}(),EDe=function(){let e=new oc,t=new oc,r=new it,i=new sl,n=new sl;return function a(o,s,l,c,d=null){let u=o*2,h=Jp,f=md,p=vd;if(d===null&&(l.boundingBox||l.computeBoundingBox(),i.set(l.boundingBox.min,l.boundingBox.max,c),d=i),Qc(u,f)){let v=s,m=v.index,g=v.attributes.position,y=l.index,b=l.attributes.position,x=Gf(o,p),S=bg(u,f);if(r.copy(c).invert(),l.boundsTree)return Gs(o,h,n),n.matrix.copy(r),n.needsUpdate=!0,l.boundsTree.shapecast({intersectsBounds:w=>n.intersectsBox(w),intersectsTriangle:w=>{w.a.applyMatrix4(c),w.b.applyMatrix4(c),w.c.applyMatrix4(c),w.needsUpdate=!0;for(let _=x*3,C=(S+x)*3;_<C;_+=3)if(Ns(t,_,m,g),t.needsUpdate=!0,w.intersectsTriangle(t))return!0;return!1}});for(let w=x*3,_=S+x*3;w<_;w+=3){Ns(e,w,m,g),e.a.applyMatrix4(r),e.b.applyMatrix4(r),e.c.applyMatrix4(r),e.needsUpdate=!0;for(let C=0,A=y.count;C<A;C+=3)if(Ns(t,C,y,b),t.needsUpdate=!0,e.intersectsTriangle(t))return!0}}else{let v=o+8,m=p[o+6];return Gs(v,h,Df),!!(d.intersectsBox(Df)&&a(v,s,l,c,d)||(Gs(m,h,Df),d.intersectsBox(Df)&&a(m,s,l,c,d)))}}}();function Qx(e,t,r,i){return Gs(e,t,Df),r.intersectBox(Df,i)}var LM=[],xb,Jp,md,vd;function tv(e){xb&&LM.push(xb),xb=e,Jp=new Float32Array(e),md=new Uint16Array(e),vd=new Uint32Array(e)}function Cy(){xb=null,Jp=null,md=null,vd=null,LM.length&&tv(LM.pop())}var SC=Symbol("skip tree generation"),CC=new Zi,_C=new Zi,nf=new it,Zd=new sl,Dm=new sl,Om=new k,_y=new k,TDe=new k,PDe=new k,DDe=new k,CL=new Zi,As=new g8(()=>new oc),Dv=class{static serialize(e,t={}){if(t.isBufferGeometry)return console.warn("MeshBVH.serialize: The arguments for the function have changed. See documentation for new signature."),Dv.serialize(arguments[0],{cloneBuffers:arguments[2]===void 0?!0:arguments[2]});t={cloneBuffers:!0,...t};let r=e.geometry,i=e._roots,n=r.getIndex(),a;return t.cloneBuffers?a={roots:i.map(o=>o.slice()),index:n.array.slice()}:a={roots:i,index:n.array},a}static deserialize(e,t,r={}){if(typeof r=="boolean")return console.warn("MeshBVH.deserialize: The arguments for the function have changed. See documentation for new signature."),Dv.deserialize(arguments[0],arguments[1],{setIndex:arguments[2]===void 0?!0:arguments[2]});r={setIndex:!0,...r};let{index:i,roots:n}=e,a=new Dv(t,{...r,[SC]:!0});if(a._roots=n,r.setIndex){let o=t.getIndex();if(o===null){let s=new $t(e.index,1,!1);t.setIndex(s)}else o.array!==i&&(o.array.set(i),o.needsUpdate=!0)}return a}constructor(e,t={}){if(e.isBufferGeometry){if(e.index&&e.index.isInterleavedBufferAttribute)throw new Error("MeshBVH: InterleavedBufferAttribute is not supported for the index attribute.")}else throw new Error("MeshBVH: Only BufferGeometries are supported.");if(t=Object.assign({strategy:0,maxDepth:40,maxLeafTris:10,verbose:!0,useSharedArrayBuffer:!1,setBoundingBox:!0,onProgress:null,[SC]:!1},t),t.useSharedArrayBuffer&&typeof SharedArrayBuffer>"u")throw new Error("MeshBVH: SharedArrayBuffer is not available.");this._roots=null,t[SC]||(this._roots=vDe(e,t),!e.boundingBox&&t.setBoundingBox&&(e.boundingBox=this.getBoundingBox(new Zi))),this.geometry=e}refit(e=null){e&&Array.isArray(e)&&(e=new Set(e));let t=this.geometry,r=t.index.array,i=t.attributes.position,n,a,o,s,l=0,c=this._roots;for(let u=0,h=c.length;u<h;u++)n=c[u],a=new Uint32Array(n),o=new Uint16Array(n),s=new Float32Array(n),d(0,l),l+=n.byteLength;function d(u,h,f=!1){let p=u*2;if(o[p+15]===65535){let v=a[u+6],m=o[p+14],g=1/0,y=1/0,b=1/0,x=-1/0,S=-1/0,w=-1/0;for(let _=3*v,C=3*(v+m);_<C;_++){let A=r[_],M=i.getX(A),P=i.getY(A),T=i.getZ(A);M<g&&(g=M),M>x&&(x=M),P<y&&(y=P),P>S&&(S=P),T<b&&(b=T),T>w&&(w=T)}return s[u+0]!==g||s[u+1]!==y||s[u+2]!==b||s[u+3]!==x||s[u+4]!==S||s[u+5]!==w?(s[u+0]=g,s[u+1]=y,s[u+2]=b,s[u+3]=x,s[u+4]=S,s[u+5]=w,!0):!1}else{let v=u+8,m=a[u+6],g=v+h,y=m+h,b=f,x=!1,S=!1;e?b||(x=e.has(g),S=e.has(y),b=!x&&!S):(x=!0,S=!0);let w=b||x,_=b||S,C=!1;w&&(C=d(v,h,b));let A=!1;_&&(A=d(m,h,b));let M=C||A;if(M)for(let P=0;P<3;P++){let T=v+P,R=m+P,z=s[T],F=s[T+3],H=s[R],N=s[R+3];s[u+P]=z<H?z:H,s[u+P+3]=F>N?F:N}return M}}}traverse(e,t=0){let r=this._roots[t],i=new Uint32Array(r),n=new Uint16Array(r);a(0);function a(o,s=0){let l=o*2,c=n[l+15]===65535;if(c){let d=i[o+6],u=n[l+14];e(s,c,new Float32Array(r,o*4,6),d,u)}else{let d=o+8,u=i[o+6],h=i[o+7];e(s,c,new Float32Array(r,o*4,6),h)||(a(d,s+1),a(u,s+1))}}}raycast(e,t=us){let r=this._roots,i=this.geometry,n=[],a=t.isMaterial,o=Array.isArray(t),s=i.groups,l=a?t.side:t;for(let c=0,d=r.length;c<d;c++){let u=o?t[s[c].materialIndex].side:l,h=n.length;if(tv(r[c]),zM(0,i,u,e,n),Cy(),o){let f=s[c].materialIndex;for(let p=h,v=n.length;p<v;p++)n[p].face.materialIndex=f}}return n}raycastFirst(e,t=us){let r=this._roots,i=this.geometry,n=t.isMaterial,a=Array.isArray(t),o=null,s=i.groups,l=n?t.side:t;for(let c=0,d=r.length;c<d;c++){let u=a?t[s[c].materialIndex].side:l;tv(r[c]);let h=kM(0,i,u,e);Cy(),h!=null&&(o==null||h.distance<o.distance)&&(o=h,a&&(h.face.materialIndex=s[c].materialIndex))}return o}intersectsGeometry(e,t){let r=this.geometry,i=!1;for(let n of this._roots)if(tv(n),i=EDe(0,r,e,t),Cy(),i)break;return i}shapecast(e,t,r){let i=this.geometry;if(e instanceof Function){if(t){let u=t;t=(h,f,p,v)=>{let m=f*3;return u(h,m,m+1,m+2,p,v)}}e={boundsTraverseOrder:r,intersectsBounds:e,intersectsTriangle:t,intersectsRange:null},console.warn("MeshBVH: Shapecast function signature has changed and now takes an object of callbacks as a second argument. See docs for new signature.")}let n=As.getPrimitive(),{boundsTraverseOrder:a,intersectsBounds:o,intersectsRange:s,intersectsTriangle:l}=e;if(s&&l){let u=s;s=(h,f,p,v,m)=>u(h,f,p,v,m)?!0:SL(h,f,i,l,p,v,n)}else s||(l?s=(u,h,f,p)=>SL(u,h,i,l,f,p,n):s=(u,h,f)=>f);let c=!1,d=0;for(let u of this._roots){if(tv(u),c=MDe(0,i,o,s,a,d),Cy(),c)break;d+=u.byteLength}return As.releasePrimitive(n),c}bvhcast(e,t,r){let{intersectsRanges:i,intersectsTriangles:n}=r,a=this.geometry.index,o=this.geometry.attributes.position,s=e.geometry.index,l=e.geometry.attributes.position;nf.copy(t).invert();let c=As.getPrimitive(),d=As.getPrimitive();if(n){let h=function(f,p,v,m,g,y,b,x){for(let S=v,w=v+m;S<w;S++){Ns(d,S*3,s,l),d.a.applyMatrix4(t),d.b.applyMatrix4(t),d.c.applyMatrix4(t),d.needsUpdate=!0;for(let _=f,C=f+p;_<C;_++)if(Ns(c,_*3,a,o),c.needsUpdate=!0,n(c,d,_,S,g,y,b,x))return!0}return!1};if(i){let f=i;i=function(p,v,m,g,y,b,x,S){return f(p,v,m,g,y,b,x,S)?!0:h(p,v,m,g,y,b,x,S)}}else i=h}e.getBoundingBox(_C),_C.applyMatrix4(t);let u=this.shapecast({intersectsBounds:h=>_C.intersectsBox(h),intersectsRange:(h,f,p,v,m,g)=>(CC.copy(g),CC.applyMatrix4(nf),e.shapecast({intersectsBounds:y=>CC.intersectsBox(y),intersectsRange:(y,b,x,S,w)=>i(h,f,y,b,v,m,S,w)}))});return As.releasePrimitive(c),As.releasePrimitive(d),u}intersectsBox(e,t){return Zd.set(e.min,e.max,t),Zd.needsUpdate=!0,this.shapecast({intersectsBounds:r=>Zd.intersectsBox(r),intersectsTriangle:r=>Zd.intersectsTriangle(r)})}intersectsSphere(e){return this.shapecast({intersectsBounds:t=>e.intersectsBox(t),intersectsTriangle:t=>t.intersectsSphere(e)})}closestPointToGeometry(e,t,r={},i={},n=0,a=1/0){e.boundingBox||e.computeBoundingBox(),Zd.set(e.boundingBox.min,e.boundingBox.max,t),Zd.needsUpdate=!0;let o=this.geometry,s=o.attributes.position,l=o.index,c=e.attributes.position,d=e.index,u=As.getPrimitive(),h=As.getPrimitive(),f=_y,p=TDe,v=null,m=null;i&&(v=PDe,m=DDe);let g=1/0,y=null,b=null;return nf.copy(t).invert(),Dm.matrix.copy(nf),this.shapecast({boundsTraverseOrder:x=>Zd.distanceToBox(x),intersectsBounds:(x,S,w)=>w<g&&w<a?(S&&(Dm.min.copy(x.min),Dm.max.copy(x.max),Dm.needsUpdate=!0),!0):!1,intersectsRange:(x,S)=>{if(e.boundsTree)return e.boundsTree.shapecast({boundsTraverseOrder:w=>Dm.distanceToBox(w),intersectsBounds:(w,_,C)=>C<g&&C<a,intersectsRange:(w,_)=>{for(let C=w*3,A=(w+_)*3;C<A;C+=3){Ns(h,C,d,c),h.a.applyMatrix4(t),h.b.applyMatrix4(t),h.c.applyMatrix4(t),h.needsUpdate=!0;for(let M=x*3,P=(x+S)*3;M<P;M+=3){Ns(u,M,l,s),u.needsUpdate=!0;let T=u.distanceToTriangle(h,f,v);if(T<g&&(p.copy(f),m&&m.copy(v),g=T,y=M/3,b=C/3),T<n)return!0}}}});{let w=d?d.count:c.count;for(let _=0,C=w;_<C;_+=3){Ns(h,_,d,c),h.a.applyMatrix4(t),h.b.applyMatrix4(t),h.c.applyMatrix4(t),h.needsUpdate=!0;for(let A=x*3,M=(x+S)*3;A<M;A+=3){Ns(u,A,l,s),u.needsUpdate=!0;let P=u.distanceToTriangle(h,f,v);if(P<g&&(p.copy(f),m&&m.copy(v),g=P,y=A/3,b=_/3),P<n)return!0}}}}}),As.releasePrimitive(u),As.releasePrimitive(h),g===1/0?null:(r.point?r.point.copy(p):r.point=p.clone(),r.distance=g,r.faceIndex=y,i&&(i.point?i.point.copy(m):i.point=m.clone(),i.point.applyMatrix4(nf),p.applyMatrix4(nf),i.distance=p.sub(i.point).length(),i.faceIndex=b),r)}closestPointToPoint(e,t={},r=0,i=1/0){let n=r*r,a=i*i,o=1/0,s=null;if(this.shapecast({boundsTraverseOrder:c=>(Om.copy(e).clamp(c.min,c.max),Om.distanceToSquared(e)),intersectsBounds:(c,d,u)=>u<o&&u<a,intersectsTriangle:(c,d)=>{c.closestPointToPoint(e,Om);let u=e.distanceToSquared(Om);return u<o&&(_y.copy(Om),o=u,s=d),u<n}}),o===1/0)return null;let l=Math.sqrt(o);return t.point?t.point.copy(_y):t.point=_y.clone(),t.distance=l,t.faceIndex=s,t}getBoundingBox(e){return e.makeEmpty(),this._roots.forEach(t=>{Gs(0,new Float32Array(t),CL),e.union(CL)}),e}},Rm=fc(Eme()),ODe=.5*(Math.sqrt(3)-1),Im=(3-Math.sqrt(3))/6,RDe=1/3,Ms=1/6,Ov=e=>Math.floor(e)|0,_L=new Float64Array([1,1,-1,1,1,-1,-1,-1,1,0,-1,0,1,0,-1,0,0,1,0,-1,0,1,0,-1]),AC=new Float64Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]);function MC(e=Math.random){let t=y8(e),r=new Float64Array(t).map(n=>_L[n%12*2]),i=new Float64Array(t).map(n=>_L[n%12*2+1]);return function(n,a){let o=0,s=0,l=0,c=(n+a)*ODe,d=Ov(n+c),u=Ov(a+c),h=(d+u)*Im,f=d-h,p=u-h,v=n-f,m=a-p,g,y;v>m?(g=1,y=0):(g=0,y=1);let b=v-g+Im,x=m-y+Im,S=v-1+2*Im,w=m-1+2*Im,_=d&255,C=u&255,A=.5-v*v-m*m;if(A>=0){let T=_+t[C],R=r[T],z=i[T];A*=A,o=A*A*(R*v+z*m)}let M=.5-b*b-x*x;if(M>=0){let T=_+g+t[C+y],R=r[T],z=i[T];M*=M,s=M*M*(R*b+z*x)}let P=.5-S*S-w*w;if(P>=0){let T=_+1+t[C+1],R=r[T],z=i[T];P*=P,l=P*P*(R*S+z*w)}return 70*(o+s+l)}}function IDe(e=Math.random){let t=y8(e),r=new Float64Array(t).map(a=>AC[a%12*3]),i=new Float64Array(t).map(a=>AC[a%12*3+1]),n=new Float64Array(t).map(a=>AC[a%12*3+2]);return function(a,o,s){let l,c,d,u,h=(a+o+s)*RDe,f=Ov(a+h),p=Ov(o+h),v=Ov(s+h),m=(f+p+v)*Ms,g=f-m,y=p-m,b=v-m,x=a-g,S=o-y,w=s-b,_,C,A,M,P,T;x>=S?S>=w?(_=1,C=0,A=0,M=1,P=1,T=0):x>=w?(_=1,C=0,A=0,M=1,P=0,T=1):(_=0,C=0,A=1,M=1,P=0,T=1):S<w?(_=0,C=0,A=1,M=0,P=1,T=1):x<w?(_=0,C=1,A=0,M=0,P=1,T=1):(_=0,C=1,A=0,M=1,P=1,T=0);let R=x-_+Ms,z=S-C+Ms,F=w-A+Ms,H=x-M+2*Ms,N=S-P+2*Ms,U=w-T+2*Ms,ie=x-1+3*Ms,te=S-1+3*Ms,X=w-1+3*Ms,W=f&255,q=p&255,$=v&255,le=.6-x*x-S*S-w*w;if(le<0)l=0;else{let V=W+t[q+t[$]];le*=le,l=le*le*(r[V]*x+i[V]*S+n[V]*w)}let ee=.6-R*R-z*z-F*F;if(ee<0)c=0;else{let V=W+_+t[q+C+t[$+A]];ee*=ee,c=ee*ee*(r[V]*R+i[V]*z+n[V]*F)}let Q=.6-H*H-N*N-U*U;if(Q<0)d=0;else{let V=W+M+t[q+P+t[$+T]];Q*=Q,d=Q*Q*(r[V]*H+i[V]*N+n[V]*U)}let ne=.6-ie*ie-te*te-X*X;if(ne<0)u=0;else{let V=W+1+t[q+1+t[$+1]];ne*=ne,u=ne*ne*(r[V]*ie+i[V]*te+n[V]*X)}return 32*(l+c+d+u)}}function y8(e){let t=new Uint8Array(512);for(let r=0;r<512/2;r++)t[r]=r;for(let r=0;r<512/2-1;r++){let i=r+~~(e()*(256-r)),n=t[r];t[r]=t[i],t[i]=n}for(let r=256;r<512;r++)t[r]=t[r-256];return t}var Go=new Zn,zDe=class{constructor(e){this.weightAttribute=null;let t=e.geometry;if(!t.isBufferGeometry||t.attributes.position.itemSize!==3)throw new Error("THREE.MeshSurfaceSampler: Requires BufferGeometry triangle mesh.");t.index&&(t=t.toNonIndexed()),this.geometry=t,this.randomFunction=Math.random,this.positionAttribute=this.geometry.getAttribute("position"),this.distribution=null}build(){let e=this.positionAttribute,t=new Float32Array(e.count/3);for(let i=0;i<e.count;i+=3){let n=1;Go.a.fromBufferAttribute(e,i),Go.b.fromBufferAttribute(e,i+1),Go.c.fromBufferAttribute(e,i+2),n*=Go.getArea(),t[i/3]=n}this.distribution=new Float32Array(e.count/3);let r=0;for(let i=0;i<t.length;i++)r+=t[i],this.distribution[i]=r;return this}setRandomGenerator(e){return this.randomFunction=e,this}sample(e,t){if(this.distribution){let r=this.distribution[this.distribution.length-1],i=this.binarySearch(this.randomFunction()*r);return this.sampleFace(i,e,t)}}binarySearch(e){if(!this.distribution)return 0;let t=this.distribution,r=0,i=t.length-1,n=-1;for(;r<=i;){let a=Math.ceil((r+i)/2);if(a===0||t[a-1]<=e&&t[a]>e){n=a;break}else e<t[a]?i=a-1:r=a+1}return n}sampleFace(e,t,r){let i=this.randomFunction(),n=this.randomFunction();return i+n>1&&(i=1-i,n=1-n),Go.a.fromBufferAttribute(this.positionAttribute,e*3),Go.b.fromBufferAttribute(this.positionAttribute,e*3+1),Go.c.fromBufferAttribute(this.positionAttribute,e*3+2),t.set(0,0,0).addScaledVector(Go.a,i).addScaledVector(Go.b,n).addScaledVector(Go.c,1-(i+n)),Go.getNormal(r),this}},kDe=fc(Z6()),LDe=new it,BDe=new it,FDe=new it,Sg;(e=>{function t(r){return r&&r.__isSPEObject}e.is=t})(Sg||(Sg={}));var VP=e=>class extends e{constructor(){super(...arguments),this.previousModelViewMatrix=new it,this.copyPreviousMatrix=!0,this.hiddenMatrix=new it,this.matrixWorldRigid=new it,this.shearScale=new it,this.shearScaleInv=new it}get __isSPEObject(){return!0}isDescendantOf(t){t instanceof Yr&&(t=t.uuid);let r=this;for(;r.parent;){if(r.parent.uuid===t)return!0;r=r.parent}return!1}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.parent===null?this.matrixWorld.multiplyMatrices(this.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,t=!0);for(let r of this.children)r.updateMatrixWorld(t)}updateWorldMatrix(t,r){let i=this.parent;if(t&&i!==null&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.multiplyMatrices(this.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),r)for(let n of this.children)n.updateWorldMatrix(!1,!0)}traverseChildren(t,r=0){for(let i of this.children)Sg.is(i)&&i.traverseObject(t,r+1)}traverseObject(t,r=0){if(t(this,r)!==!0)for(let i of this.children)Sg.is(i)&&i.traverseObject(t,r+1)}updateMatrixWorldSVD(){let t=this.matrixWorld.elements,r=[[t[0],t[4],t[8]],[t[1],t[5],t[9]],[t[2],t[6],t[10]]],{u:i,v:n,q:a}=(0,kDe.SVD)(r),o=LDe.set(i[0][0],i[0][1],i[0][2],0,i[1][0],i[1][1],i[1][2],0,i[2][0],i[2][1],i[2][2],0,0,0,0,1),s=BDe.set(n[0][0],n[0][1],n[0][2],0,n[1][0],n[1][1],n[1][2],0,n[2][0],n[2][1],n[2][2],0,0,0,0,1),l=FDe.copy(s).transpose();this.shearScale.makeScale(a[0],a[1],a[2]).multiply(l).premultiply(s),this.shearScaleInv.copy(this.shearScale).invert(),this.matrixWorldRigid.multiplyMatrices(o,l).copyPosition(this.matrixWorld),a.every(c=>Math.abs(a[0]-c)<.01)?this.hasNonUniformScale=!1:this.hasNonUniformScale=!0}attach(t,r){this.updateWorldMatrix(!0,!1);let i=new it().copy(this.matrixWorld).invert();return t.parent!==null&&(t.parent.updateWorldMatrix(!0,!1),i.multiply(t.parent.matrixWorld)),"hiddenMatrix"in t&&t.hiddenMatrix instanceof it?t.hiddenMatrix.premultiply(i):t.applyMatrix4(i),t.updateWorldMatrix(!1,!1),this.add(t),r!==void 0&&(this.children.pop(),this.children.splice(r,0,t)),this}copy(t,r=!1){return super.copy(t,r),this.hasNonUniformScale=t.hasNonUniformScale,this}onAfterRender(t,r,i,n,a,o){this.copyPreviousMatrix&&this.previousModelViewMatrix.copy(this.modelViewMatrix)}},NDe=class extends VP(Yr){},UDe=e=>e.type==="Mesh",pa=class extends NDe{constructor(e){super(),this.object=e,this.matrixAutoUpdate=!1,this.hasNonUniformScale=e.hasNonUniformScale}raycast(e,t){}expand(){let e=0,t=this.object.entityChildren(e);for(;t;){let r=this.children[e];(r==null?void 0:r.object)!==t&&(r&&this.remove(r),r=new pa(t),this.add(r),this.children.splice(e,0,this.children.pop()),r.matrixWorldNeedsUpdate=!0,r.matrixAutoUpdate=!1,r.matrix=t.matrix,r.hiddenMatrix=t.hiddenMatrix),r.expand(),e+=1,t=this.object.entityChildren(e)}for(;this.children.length>e;)this.remove(this.children[e])}get visible(){var e;return this.playModeVisible!==void 0?this.playModeVisible:this.object.visible||this.object.dataPatched.visible&&((e=this.object.dataPatched.cloner)==null?void 0:e.hideBase)===!0}set visible(e){}get castShadow(){return this.object.castShadow}set castShadow(e){}get receiveShadow(){return this.object.receiveShadow}set receiveShadow(e){}get isMesh(){return UDe(this.object)}get isLight(){return this.object.isLight}get layers(){return this.object.layers}set layers(e){}get isCamera(){return!1}get geometry(){if(this.object.geometry)return this.object.geometry}get material(){if(this.object.material)return this.object.material}},fu=new k,pu=new k,$f=new it,b8=[new k(-1,1,1),new k(-1,-1,1),new k(1,-1,1),new k(1,1,1),new k(-1,1,-1),new k(-1,-1,-1),new k(1,-1,-1),new k(1,1,-1)],jDe=[[0,3],[1,2],[5,6],[4,7],[0,1],[3,2],[7,6],[4,5],[0,4],[1,5],[2,6],[3,7]],VDe=[[0,2],[7,5],[4,1],[3,6],[4,3],[1,6]],AL=(e,t,r)=>{e.updateEntityBoxSize(fu,pu),$f.copy(t).multiply(e.matrixWorld),pu.x===0&&pu.y===0&&pu.z===0?r.push(new k(fu.x,fu.y,fu.z).applyMatrix4($f)):b8.forEach(i=>{r.push(i.clone().multiply(pu).add(fu).applyMatrix4($f))})},ML=class extends Zi{constructor(){super(...arguments),this.matrix=new it,this.vertices=[],this.faces=[],this.edges=[],this.centerEdges=[]}copy(e){return super.copy(e),this.matrix.copy(e.matrix),this.vertices=e.vertices.map(t=>t.clone()),this.faces=e.faces.map(t=>t.clone()),this.edges=e.edges.map(t=>t.clone()),this.centerEdges=e.centerEdges.map(t=>t.clone()),this}setFromObjectSize(e,t=!1){e.updateWorldMatrix(!1,t),this.makeEmpty(),this.matrix.copy(e.matrixWorld);let r=new it().copy(e.matrixWorld).invert();return this.expandByObjectSize(e,r,t)}expandByObjectSize(e,t,r=!1){let i=[];return r===!0?e.traverseEntity(n=>{if(n.visible||n.cloner&&n.data.visible){if(!("geometry"in n)){i.push(new k);return}AL(n,t,i)}}):AL(e,t,i),this.setFromPoints(i)}getCenter(e){return e=super.getCenter(e),e.applyMatrix4(this.matrix),e}getPositionToCenter(e){return e=super.getCenter(e),e.applyMatrix4($f.copy(this.matrix).setPosition(0,0,0)),e}computeVertices(){this.getSize(pu).multiplyScalar(.5),this.getCenter(fu),$f.copy(this.matrix).setPosition(fu),this.vertices=b8.map(e=>e.clone().multiply(pu).applyMatrix4($f))}computeEdges(){this.vertices.length>0&&this.computeVertices(),this.edges=jDe.map(([e,t])=>new zo(this.vertices[e],this.vertices[t])),this.centerEdges=this.edges.map(e=>e.getCenter(new k))}computeFaces(){this.vertices.length>0&&this.computeVertices(),this.faces=VDe.map(([e,t])=>this.vertices[e].clone().add(this.vertices[t]).multiplyScalar(.5))}},nd={Cloner:()=>{},changeEntityProptotype:()=>{},createEntity:()=>{}},HDe=class extends Ej{constructor(){super()}getPoints(e=12){let t=[],r,i=this.getCurveLengths(),n=i[i.length-1]/i.length;for(let a=0,o=this.curves;a<o.length;a++){let s=o[a],l=a===0?i[a]:i[a]-i[a-1],c=Math.ceil(e*l/n),d=s.getPoints(c);for(let u=0;u<d.length;u++){let h=d[u];r&&r.equals(h)||(t.push(h),r=h)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}},BM=.001;function FM(e,t,r){return t.clone().sub(e).cross(t.clone().sub(r)).length()<=BM}function EC(e,t){let r=new k(...e.position),i=new k(...e.controlNext.position),n=new k(...t.controlPrevious.position),a=new k(...t.position);return FM(r,i,a)&&FM(r,n,a)}function x8(e){let t=e.points.map(d=>new k(...d.data.position)),r=[e.points[0]],i=new k(...r[0].data.position);for(let d=0;d<e.points.length-1;d++)FM(i,t[d],t[d+1])||(r.push(e.points[d]),i=t[d]);r.push(e.points[e.points.length-1]);let n=e.isClosed,a=r.length-(n?0:1),o=r.length,s=[];for(let d=0;d<o;d++){let u=r[d].data,h=new k(...u.position),f=new k(...u.controlPrevious.position),p=new k(...u.controlNext.position),v={position:h,baseRoundness:u.roundness,controlPrevious:f,controlNext:p};if(u.roundness===0||!e.isClosed&&(d===0||d===o-1)){s[d]={...v,removedLength:0};continue}let m=n&&d==0?o-1:d-1,g=n&&d==o-1?0:d+1,y=r[m].data,b=r[g].data,x=new k(...y.position),S=new k(...b.position),w=x.clone().sub(h).normalize(),_=S.clone().sub(h).normalize();Object.assign(v,{prevDir:w,nextDir:_});let C=EC(y,u),A=EC(u,b);if(!C||!A)s[d]={...v,removedLength:0};else{let M=w.clone().add(_).normalize(),P=M.clone().cross(w).length()/w.dot(M);s[d]={...v,tan:P,removedLength:u.roundness/P}}}for(let d=0;d<a;d++){let u=d,h=n&&d===o-1?0:d+1,f=s[u],p=s[h];if(f.removedLength!==0||p.removedLength!==0){let v=f.position.distanceTo(p.position);f.removedLength=Math.min(f.removedLength,v/2),p.removedLength=Math.min(p.removedLength,v/2)}}let l=[];for(let d=0;d<a;d++){let u=d,h=n&&d===o-1?0:d+1,f=s[u],p=s[h],v=null;if(!EC(r[u].data,r[h].data))f.position.distanceTo(p.position)>BM&&(v=new mb(f.position,f.controlNext,p.controlPrevious,p.position));else{let m=f.position.clone(),g=p.position.clone();(f.removedLength!==0||p.removedLength!==0)&&(f.nextDir&&m.add(f.nextDir.clone().setLength(f.removedLength)),p.prevDir&&g.add(p.prevDir.clone().setLength(p.removedLength))),m.distanceTo(g)>BM&&(v=new mb(m,m.clone().lerp(g,.3),g.clone().lerp(m,.3),g))}l[2*d+1]=v}for(let d=0;d<o;d++){let u=s[d];if(u.removedLength===0){l[2*d]=null;continue}let h=u.position,f=u.prevDir.clone().multiplyScalar(u.removedLength).add(h),p=u.nextDir.clone().multiplyScalar(u.removedLength).add(h),v=u.tan*u.removedLength,m=u.prevDir.clone().add(u.nextDir).normalize(),g=f.clone().lerp(p,.5),y=f.distanceTo(p)/2,b=m.clone().multiplyScalar(Math.sqrt(Math.pow(v,2)-Math.pow(y,2))).add(g),x=m.clone().multiplyScalar(-v).add(b),S=h.distanceTo(x)/h.distanceTo(g),w=u.prevDir.clone().multiplyScalar(S*h.distanceTo(f)).add(h),_=w.clone().lerp(x,2),C=f.clone().lerp(w,4/3),A=p.clone().lerp(_,4/3);l[2*d]=new mb(f,C,A,p)}let c=new HDe;return l.forEach(d=>{d&&c.add(d)}),c}var Cr;(e=>{function t(r){return r&&r.__isEntity}e.is=t})(Cr||(Cr={}));var Fl=e=>Cr.is(e),WDe={type:"completeState",isfromEntity:!0},GDe=["x","y","z"],TC=new k,$De=new k().set(0,1,0),HP=e=>class extends VP(e){constructor(){super(...arguments),this.raycastLock=!1,this.scaleLock=!1,this.disposed=!1,this.stateSelection=null,this.destroyedInAction=!1,this.instances=[],this.prevState=null,this.currentState=null,this.reversibleToState=null,this.currentTransitionEvent=null,this.previousAction=null,this._singleBBox=new ML,this._recursiveBBox=new ML,this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0,this._needApplyPathSnapping=!0,this.attachedPaths=new Set}get __isEntity(){return!0}entityChildren(t){let r=this.children[t];if(Cr.is(r))return r}entityChildrenCount(){let t=this.children.length;for(;t--;)if(Cr.is(this.children[t]))return t+1;return 0}get isConcreteEntity(){return typeof this.identity=="string"}get isVirtualEntity(){return typeof this.identity!="string"}get isInstanceRoot(){return this.isConcreteEntity&&this.data.type==="Instance"}nearestInstanceSelfOrParent(){let t=this;for(;t.data.type!=="Instance";){let r=t.parent;if(Cr.is(r))t=r;else return}return t}forInstancesRec(t){this.instances.forEach(r=>{r.disposed||t(r),r.forInstancesRec(t)})}super_Entity(t,r){typeof t=="string"&&(this.uuid=t),this.identity=t,this.data=r,this.matrixAutoUpdate=!1,this.dataPatched=this.data}changeSelectedState(t,r,i=!1){if(!(this.data.states.length===0&&!i)){for(let n of this.data.states)Au.toOps(this.data,n.data).forEach(a=>{let o=Dx.replaceProps(a,this.data);this.dataPatched=this.data,this.updateByPatchedOp(o,this.data,r)});if(t!==null){let n=this.data.states.data(t);n&&(this.dataPatched=Au.patch(this.data,n),Au.toOps(this.data,n).forEach(a=>{this.updateByPatchedOp(a,this.dataPatched,r)}))}i&&this.updateTransformState(this.dataPatched,r),this.stateSelection=t,this.updatePathSnapping(this.dataPatched.pathSnapping)}}get singleBBox(){return this.singleBBoxNeedsUpdate&&(this.singleBBoxNeedsUpdate=!1,this._singleBBox.setFromObjectSize(this,!1),this._singleBBox.computeVertices(),this._singleBBox.computeEdges(),this._singleBBox.computeFaces()),this._singleBBox}get recursiveBBox(){return this.recursiveBBoxNeedsUpdate&&(this.recursiveBBoxNeedsUpdate=!1,this._recursiveBBox.setFromObjectSize(this,!0),this._recursiveBBox.computeVertices(),this._recursiveBBox.computeEdges(),this._recursiveBBox.computeFaces()),this._recursiveBBox}updateEntityBoxSize(t,r){t.setScalar(0),r.setScalar(0)}resetBBoxNeedsUpdateSelf(){this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0}resetBBoxNeedsUpdate(){this.resetBBoxNeedsUpdateSelf(),this.traverseAncestors(t=>{Fl(t)&&t.resetBBoxNeedsUpdateSelf()}),this.traverseEntity(t=>{t.resetBBoxNeedsUpdateSelf()})}find(t){let r;return this.traverseEntity(i=>{i.uuid===t&&(r=i)}),r}traverseSortNextHelper(){let t=this.parent;if(t){let r=t.children,i=r.indexOf(this)+1;if(Cr.is(r[i]))return r[i];if(Cr.is(t))return t.traverseSortNextHelper()}}sortNext(){let t=this.children;return this.children.length>0&&Cr.is(this.children[0])?t[0]:this.traverseSortNextHelper()}goUp(t){let r=this;for(;t>0&&r!==null;)r=r.parent,t-=1;return r}hasAnccestorOrSelf(t){return this===t||this.hasAnccestor(t)}hasAnccestor(t){let r=this.parent;for(;r;){if(t===r)return!0;r=r.parent}return!1}countToAccestor(t){let r=0,i=this;for(;i!==t;){if(i===null)return-1;i=i.parent,r+=1}return r}forEachEntity(t){for(let r of this.children)Fl(r)&&t(r)}traverseEntityAncestors(t){this.traverseAncestors(r=>{Cr.is(r)&&t(r)})}traverseConcreteEntity(t,r=0){if(t(this,r)!==!0)for(let i of this.children)Fl(i)&&i.isConcreteEntity&&i.traverseEntity(t,r+1)}traverseEntity(t,r=0){if(t(this,r)!==!0)for(let i of this.children)Fl(i)&&i.traverseEntity(t,r+1)}traverseVisibleEntity(t){t(this);for(let r of this.children)Fl(r)&&r.visible&&r.traverseVisibleEntity(t)}updateMatrix(){super.updateMatrix(),this.cloner&&this.cloner.onObjUpdateMatrix(),this.dispatchEvent({type:"updateMatrix"})}updateMatrixWorld(t){super.updateMatrixWorld(t),this.dispatchEvent({type:"updateMatrixWorld"})}copy(t,r=!1){return super.copy(t,r),this.dataPatched=t.dataPatched,this.raycastLock=t.raycastLock,this.scaleLock=t.scaleLock,this.hiddenMatrix.copy(t.hiddenMatrix),this}hasEntityChild(){return this.children.some(t=>Fl(t))}isAncestorOf(t){if(this.uuid===t)return!1;let r=!1;return this.traverseEntity(i=>{i.uuid===t&&(r=!0)}),r}toObjectTransformState(t=[]){this.updateWorldMatrix(!0,!1);let r={position:this.position.toArray(),rotation:[this.rotation.x*St.RAD2DEG,this.rotation.y*St.RAD2DEG,this.rotation.z*St.RAD2DEG],scale:this.scale.toArray(),hiddenMatrix:this.hiddenMatrix.toArray()};return $A(r,t)}getTransformValues(t,r,i){return r[t].map((n,a)=>(i==null?void 0:i.shared.getVariable(n,[this.uuid,t,GDe[a]]))??n)}updateTransformState(t,r){let i=!1;return t.position&&(this.position.fromArray(this.getTransformValues("position",t,r)),i=!0),t.rotation&&(TC.fromArray(this.getTransformValues("rotation",t,r)).multiplyScalar(St.DEG2RAD),this.rotation.setFromVector3(TC),i=!0),t.scale&&(this.scale.fromArray(this.getTransformValues("scale",t,r)),i=!0),t.hiddenMatrix!==void 0&&(i=!0,this.hiddenMatrix.fromArray(t.hiddenMatrix??wp.identity)),i&&(this.updateMatrix(),this.resetBBoxNeedsUpdate(),this.invalidateClonerTransform(this),this.traverseEntityAncestors(n=>{n.invalidateClonerTransform(this)})),t.position&&t.rotation&&t.scale&&t.hiddenMatrix!==void 0&&this.updateWorldMatrix(!1,!0),i}onVariableUpdate(t=!1){if(t){this.resetBBoxNeedsUpdate();return}this.updateMatrix(),this.resetBBoxNeedsUpdate(),this.invalidateClonerTransform(this),this.traverseEntityAncestors(r=>{r.invalidateClonerTransform(this)})}dispose(){this.disposed=!0,this.cloner&&(this.cloner.removeFromParent(),this.cloner=void 0)}disposeChildrenRecursively(){for(let t of this.children)Cr.is(t)&&t.disposeRecursively()}disposeRecursively(){this.dispose(),this.children.forEach(t=>{Cr.is(t)&&t.disposeRecursively()})}toState(t=[]){let r={name:this.name,visible:this.visible,raycastLock:this.raycastLock,...this.toObjectTransformState(t)};return $A(r,t)}updateByObjUpdateOp(t,r){t!==void 0&&this.updateByOp({type:0,props:t,path:[]},{...this.data,...t},r,!1)}updateByOp(t,r,i,n){let a=this.data;this.data=r;let o=t,s=si(t.path,["states","*"]);if(s!==null){if(t.type===0){let[l]=s;if((this==null?void 0:this.stateSelection)===l){let c={...t.props};if(delete c.name,Object.values(t.props).some(d=>d===void 0)){let d=this.data;if(d!==void 0){let u=gn.zoom(d,t.path.slice(2));if(u)for(let h in t.props)t.props[h]===void 0&&h in u&&(c[h]=u[h])}}o={...t,props:c,path:t.path.slice(2)}}}}else if(t.type===0){let l=this.stateSelection?this.data.states.data(this.stateSelection):void 0;if(l!==void 0){if(t.props.name!==void 0&&l.name){let{name:d,...u}=l;l=u}if(t.props.material!==void 0&&"material"in l){let{material:d,...u}=l;l=u}let c=gn.removeOverridden(t.path,t.props,l);o={...t,props:c}}}if(this.updateByPatchedOpBase(o,Au.patch(this.data,this.stateSelection?this.data.states.data(this.stateSelection):void 0),i),si(t.path,["overrides"])){let l=[],c=[...t.path];for(l.push(c[1]),c.splice(0,2);c.length>0&&c[0]==="descendants";)l.push(c[1]),c.splice(0,2);if(l[l.length-1]===void 0){if(t.type===0)for(let d of Object.keys(t.props)){l[l.length-1]=d;let u=i.scene.findInstance([this.uuid,...l]);u&&(u.overrideData=t.props[d],u.updateState(fd.apply(u.component.data,u.overrideData),i))}}else{let d=i.scene.findInstance([this.uuid,...l]);if(d){let u=gn.zoom(d.component.data,c);if(t={...t,path:c},t.type===0){let h=t.props;if(u)for(let[f,p]of Object.entries(t.props))p===void 0&&(h===t.props&&(h={...t.props}),h[f]=u[f]);t={...t,props:h}}d.overrideData=jx.resolve(r.overrides,l),d.updateByOp(t,zn.applySimple(d.data,t),i,!1)}}}else if(this.instances.length>0){let l;if(t.path.length===0&&t.type===0){let c;for(let d of rd.rootOverrideProps)d in t.props&&(c===void 0&&(c={}),c[d]=t.props[d]);c&&(l={...t,props:c})}else for(let c of rd.rootOverrideProps)if(si(t.path,[c])){l=t;break}l!==void 0&&this.instances.forEach(c=>{if(c.isInstanceRoot){let d=fd.filterOp(c.overrideData,l);d&&c.updateByOp(d,zn.applySimple(c.data,d),i,!0)}}),this.instances.forEach(c=>{if(!c.isInstanceRoot){let d=fd.filterOp(c.overrideData,t);if(d){let u;a===c.data&&t===d?u=r:u=zn.applySimple(c.data,d),c.updateByOp(d,u,i,!0)}}})}}updateByPatchedOpBase(t,r,i){if(this.dataPatched=r,t.path.length===0&&t.type===0)t.props.type!==void 0&&!ah.is(t.props.type)&&nd.changeEntityProptotype(this,r,i);else if(t.path.length===1&&t.path[0]==="geometry"&&t.type===0&&"type"in t.props){nd.changeEntityProptotype(this,r,i);for(let n of this.children)Cr.is(n)&&n.updateVisible(i.scene)}this.updateByPatchedOp(t,r,i)}updateByPatchedOp(t,r,i){if(t.path.length===0&&t.type===0&&this.updateState(t.props,i),si(t.path,["pathSnapping"])!==null&&this.updatePathSnapping(r.pathSnapping),si(t.path,["cloner"])!==null){let n=zn.drop(t,1);n.path.length===0&&n.type===0&&n.props.disabled===!0?this.setFromClonerState(null,i):this.cloner?this.cloner.updateState(r.cloner,i.scene):(this.setFromClonerState(r.cloner,i),this.expandCloner(i.scene)),this.updateVisible(i.scene)}}updatePathSnapping(t=this.dataPatched.pathSnapping){this._updatedPathSnapping=t,this._needApplyPathSnapping=!0}get updatedPathSnapping(){return this._updatedPathSnapping}applyPathSnapping(t){var p,v,m,g,y;let r=((p=this._updatedPathSnapping)==null?void 0:p.pathId)??this.dataPatched.pathSnapping.pathId,i=((v=this._updatedPathSnapping)==null?void 0:v.slide)??this.dataPatched.pathSnapping.slide??0,n=((m=this._updatedPathSnapping)==null?void 0:m.offset)??this.dataPatched.pathSnapping.offset??0,a=((g=this._updatedPathSnapping)==null?void 0:g.orientation)??this.dataPatched.pathSnapping.orientation;if(r===null)return;let o=t.find(r);if(!o||this._needApplyPathSnapping===!1)return;this._needApplyPathSnapping=!1;let s=o.data;if(s.geometry.path.points.length<=1)return;let l=x8(s.geometry.path),c=(i+n)%1;i+n===1&&c===0&&(c=1);let d=l.curves.length?l.getPointAt(c):null;if(d===null)return;let u=this.parent?(y=this.parent)==null?void 0:y.matrixWorld:new it;o.updateMatrixWorld();let h=new it().multiplyMatrices(u.clone().invert(),o.matrixWorld);d.applyMatrix4(h);let f={position:d.toArray(),rotation:s.rotation};if(a==="tangential"){let b=new it().extractRotation(o.matrixWorld),x=l.getTangentAt(c).applyMatrix4(b).add(d),S=new it().lookAt(d,x,$De),w=TC.setFromEuler(new vn().setFromRotationMatrix(S)).multiplyScalar(St.RAD2DEG);f={...f,rotation:w.toArray()}}this.updateTransformState(f),this.traverseEntity(b=>{b._cameraType&&b.dispatchEvent(WDe)})}updateVisible(t){var i;if(this.visible=this.dataPatched.visible&&(!this.dataPatched.cloner||(this.dataPatched.cloner.disabled??!1)||((i=this.dataPatched.cloner)==null?void 0:i.hideBase)!==!0),!t)return;let r=!1;this.traverseEntity(n=>{if(n.data.type==="Splat")return r=!0,!0}),r&&t.reloadSplats()}updateState_Entity(t,r){t.name!==void 0&&(this.name=t.name),t.raycastLock!==void 0&&(this.raycastLock=t.raycastLock),t.visible!==void 0&&(this.updateVisible(r==null?void 0:r.scene),this.resetBBoxNeedsUpdate()),r&&"cloner"in t&&t.cloner!==void 0&&(this.setFromClonerState(t.cloner,r),this.updateVisible(r.scene)),this.updateTransformState(t,r)}get attachedSurfaceCloners(){return this.children.filter(t=>t instanceof nd.Cloner&&t.parameters.type==="toObject")}setFromClonerState(t,r){this.disposed||(t===null||t.disabled?(this.cloner&&this.cloner.removeFromParent(),this.cloner=void 0):this.cloner===void 0?(this.cloner=new nd.Cloner(this,t),r.scene.addPendingExpandCloner(this)):this.cloner.updateState(t,r.scene))}expandCloner(t){!this.disposed&&this.cloner&&this.cloner.expandClones(t)}invalidateClonerTransform(t){this.cloner&&this.cloner.invalidateTransform(t)}requestRender(){this.dispatchEvent({type:"requestRender"})}},w8=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,radialSegments:64,heightSegments:1,openEnded:!1,thetaStart:0,thetaLength:360,cornerRadius:8,cornerSegments:8,hollow:0},e.parameters);r.thetaLength=St.clamp(r.thetaLength,0,360);let i=r.width/2,n=r.radiusTop??i,a=r.radiusBottom??i;return n===a?(n=i,a=i):n>a?(n=i,a=a*i/n):(n=n*i/a,a=i),{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width),radiusTop:n,radiusBottom:a})}}static build(e){let{width:t,depth:r,height:i,radialSegments:n,heightSegments:a,openEnded:o,thetaStart:s,thetaLength:l,radiusTop:c,radiusBottom:d,cornerRadius:u,cornerSegments:h,hollow:f}=e.parameters,p;return l===0?(p=new Ot,p.setAttribute("position",new yt([],3))):u||f?p=new S8(c,d,i,n,a,o,s,l*Math.PI/180,u,u,h,f):p=new sP(c,d,i,n,a,o,s,l*Math.PI/180),p.scale(1,1,r/t),Object.assign(p,{userData:{...e,type:"CylinderGeometry"}})}};function Dc(e,t,r){r.x=e.x*t.x,r.y=e.y,r.z=e.x*t.y}function EL(e){return new ye(e.y,-e.x)}var S8=class extends Ot{constructor(e,t,r,i,n,a,o,s,l,c,d,u,h=!1){super(),this.type="RoundedCylinderBufferGeometry",e=e!==void 0?e:1,t=t!==void 0?t:1,r=r||1,i=Math.floor(i)||8,n=Math.floor(n)||1,a=a!==void 0?a:!1,o=o!==void 0?o:0,s=s!==void 0?s:Math.PI*2,a&&(l=0,c=0);let f=[],p=[],v=[],m=[],g=0,y=r/2,b=new k,x=new k;h&&e==0&&(e=l),h&&t==0&&(t=c);let S=new ye(e,y),w=new ye(t,-y),_=null,C=null,A=null,M=null,P=S.clone().sub(w),T=0,R=0,z=0;u>0&&(T=Math.min(e,t)*(1-u),R=e-T,z=t-T);let F=S.clone();F.x-=T;let H=Math.PI-P.angle(),N=P.angle(),U=Math.tan(N/2),ie=Math.tan(H/2),te=U+ie,X=u?te:ie,W=u?te:U;if(l=Math.min(l,(e-R)/X,P.length()/te),c=Math.min(c,(t-z)/W,P.length()/te),l>0){let ne=l/U;_=S.clone().sub(new ye(ne,l)),u&&(A=_.clone(),A.x-=T-te*l),S.sub(P.clone().setLength(ne))}if(c>0){let ne=c/ie;C=w.clone().sub(new ye(ne,-c)),w.add(P.clone().setLength(ne)),u&&(M=C.clone(),M.x-=T-te*c,F.sub(P.clone().setLength(ne)))}P=S.clone().sub(w);let q=P.length()<.5,$=[];for(let ne=0;ne<=i;ne++){let V=[],de=ne/i,me=de*s+o,Ce=new ye(Math.sin(me),Math.cos(me));M&&C?(le(V,de,Ce,H,c,M,-1,!0),le(V,de,Ce,N,c,C,-1,!1)):C?(ee(V,Ce,C.x,0,-1),le(V,de,Ce,N,c,C,-1,!1)):a||ee(V,Ce,t,z,-1);let G=EL(P).normalize();if(Dc(G,Ce,b),!q)for(let Z=0;Z<=n;Z++){let ue=Z/n,Se=P.clone().multiplyScalar(ue).add(w);Dc(Se,Ce,x),p.push(x.x,x.y,x.z),v.push(b.x,b.y,b.z),m.push(de,.5+x.y/r),V.push(g++)}if(A&&_?(le(V,de,Ce,H,l,_,1,!1),le(V,de,Ce,N,l,A,1,!0)):_?(le(V,de,Ce,H,l,_,1,!1),ee(V,Ce,_.x,0,1)):a||ee(V,Ce,e,R,1),u&&!q){let Z=EL(P).multiplyScalar(-1).normalize();Dc(Z,Ce,b);for(let ue=0;ue<=n;ue++){let Se=ue/n,we=P.clone().multiplyScalar(-Se).add(F);Dc(we,Ce,x),p.push(x.x,x.y,x.z),v.push(b.x,b.y,b.z),m.push(de,.5+x.y/r),V.push(g++)}}u&&!a&&V.push(V[0]),$.push(V)}for(let ne=0;ne<$.length-1;ne++)for(let V=0;V<$[0].length-1;V++){if(a&&u&&V==n)continue;let de=$[ne][V],me=$[ne+1][V],Ce=$[ne+1][V+1],G=$[ne][V+1],Z=p[Ce*3+0],ue=p[Ce*3+2];f.push(de,me,G),(Z!=0||ue!=0)&&f.push(me,Ce,G)}s<Math.PI*2&&(Q(-1,$[0],o),Q(1,$[$.length-1],o+s)),this.setIndex(f),this.setAttribute("position",new yt(p,3)),this.setAttribute("normal",new yt(v,3)),this.setAttribute("uv",new yt(m,2));function le(ne,V,de,me,Ce,G,Z,ue){for(let Se=0;Se<d+1;Se++){let we=Se/d,_e=Z<0?we:1-we;ue&&(_e-=1),_e*=me;let Ee=new ye(Math.sin(_e),Math.cos(_e)*Z),fe=Ee.clone().multiplyScalar(Ce).add(G);Dc(fe,de,x),p.push(x.x,x.y,x.z),Dc(Ee,de,b),v.push(b.x,b.y,b.z),m.push(V,.5+x.y/r),ne.push(g++)}}function ee(ne,V,de,me,Ce){let G=new k,Z=new ye,ue=[de,me];Ce<0&&ue.reverse();for(let Se of ue)Z.set(Se,y*Ce),Dc(Z,V,G),p.push(G.x,G.y,G.z),v.push(0,Ce,0),m.push(.5,.5),ne.push(g++)}function Q(ne,V,de){let me=new ye(Math.sin(de),Math.cos(de)),Ce=new ye(-Math.cos(de),Math.sin(de)),G=new k,Z=ne<0?(we,_e,Ee)=>f.push(we,_e,Ee):(we,_e,Ee)=>f.push(we,Ee,_e),ue=new ye((e+t+R+z)/4,0);Dc(ue,me,G),p.push(G.x,G.y,G.z),v.push(Ce.x,0,Ce.y),m.push(.5,.5);let Se=g++;for(let we of V){let _e=p.slice(we*3,we*3+3);p.push(..._e),v.push(Ce.x,0,Ce.y);let Ee=m.slice(we*2,we*2+2);m.push(...Ee),g++}for(let we=Se+1;we<g-1;we++)Z(Se,we,we+1);Z(Se,g-1,Se+1)}}},qDe=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,radialSegments:32,heightSegments:8,openEnded:!1,thetaStart:0,thetaLength:360,cornerRadiusTop:8,cornerRadiusBottom:8,cornerSegments:8},e.parameters);return r.thetaLength=St.clamp(r.thetaLength,0,360),{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(e){let{width:t,depth:r,height:i,radialSegments:n,heightSegments:a,openEnded:o,thetaStart:s,thetaLength:l,cornerRadiusTop:c,cornerRadiusBottom:d,cornerSegments:u}=e.parameters,h;return l===0?(h=new Ot,h.setAttribute("position",new yt([],3))):c>0||d>0||l<360?h=new S8(0,t/2,i,n,a,o,s,l*Math.PI/180,c,d,u,0,!0):h=new lP(t/2,i,n,a,o),h.scale(1,1,r/t),Object.assign(h,{userData:{...e,type:"ConeGeometry"}})}},YDe=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,widthSegments:1,heightSegments:1,depthSegments:1,cornerRadius:8,cornerSegments:8},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(e){let{width:t,height:r,depth:i,widthSegments:n,heightSegments:a,depthSegments:o,cornerRadius:s,cornerSegments:l}=e.parameters,c;return s===0?c=new fs(t,r,i,n,a,o):c=new XDe(t,r,i,n,a,o,s,l),Object.assign(c,{userData:{...e,type:"CubeGeometry"}})}},PC=Math.PI/2,XDe=class extends Ot{constructor(e=1,t=1,r=1,i=1,n=1,a=1,o=0,s=4){super(),this.type="BoxGeometry",i=Math.floor(i),n=Math.floor(n),a=Math.floor(a),s=Math.floor(s),o=Math.min(o,e/2,t/2,r/2);let l=[],c=[],d=[],u=[],h=0;f("z","y","x",-1,-1,r,t,e,a,n),f("z","y","x",1,-1,r,t,-e,a,n),f("x","z","y",1,1,e,r,t,i,a),f("x","z","y",1,-1,e,r,-t,i,a),f("x","y","z",1,-1,e,t,r,i,n),f("x","y","z",-1,-1,e,t,-r,i,n),o>0&&(p("z","y","x",-1,-1,1,r,t,e,a),p("z","y","x",1,-1,-1,r,t,e,a),p("z","y","x",-1,1,-1,r,t,e,a),p("z","y","x",1,1,1,r,t,e,a),p("x","y","z",-1,-1,-1,e,t,r,i),p("x","y","z",1,-1,1,e,t,r,i),p("x","y","z",-1,1,1,e,t,r,i),p("x","y","z",1,1,-1,e,t,r,i),p("y","x","z",-1,-1,1,t,e,r,n),p("y","x","z",1,-1,-1,t,e,r,n),p("y","x","z",1,1,1,t,e,r,n),p("y","x","z",-1,1,-1,t,e,r,n),v(1,1,1),v(-1,1,1),v(1,-1,1),v(-1,-1,1),v(1,1,-1),v(-1,1,-1),v(1,-1,-1),v(-1,-1,-1)),this.setIndex(l),this.setAttribute("position",new yt(c,3)),this.setAttribute("normal",new yt(d,3)),this.setAttribute("uv",new yt(u,2));function f(m,g,y,b,x,S,w,_,C,A){let M=(S-2*o)/C,P=(w-2*o)/A,T=S/2-o,R=w/2-o,z=_/2,F=C+1,H=A+1,N=0,U=new k;for(let ie=0;ie<H;ie++){let te=ie*P-R;for(let X=0;X<F;X++){let W=X*M-T;U[m]=W*b,U[g]=te*x,U[y]=z,c.push(U.x,U.y,U.z),U[m]=0,U[g]=0,U[y]=_>0?1:-1,d.push(U.x,U.y,U.z),u.push(X/C),u.push(1-ie/A),N+=1}}for(let ie=0;ie<A;ie++)for(let te=0;te<C;te++){let X=h+te+F*ie,W=h+te+F*(ie+1),q=h+(te+1)+F*(ie+1),$=h+(te+1)+F*ie;l.push(X,W,$),l.push(W,q,$)}h+=N}function p(m,g,y,b,x,S,w,_,C,A){let M=(w-2*o)/A,P=w/2-o,T=_/2-o,R=C/2,z=A+1,F=0,H=new k,N=new k;for(let U=0;U<s+1;U++){let ie=U/s*PC,te=Math.sin(ie)*o,X=(1-Math.cos(ie))*o,W=Math.sin(ie),q=Math.cos(ie);H[g]=(T+te)*x,H[y]=(R-X)*S,N[m]=0,N[g]=W*Math.sign(H[g]),N[y]=q*Math.sign(H[y]);for(let $=0;$<z;$++){let le=$*M-P;H[m]=le*b,c.push(H.x,H.y,H.z),d.push(N.x,N.y,N.z),u.push($/A),u.push(0),F+=1}}for(let U=0;U<s;U++)for(let ie=0;ie<A;ie++){let te=h+ie+z*U,X=h+ie+z*(U+1),W=h+(ie+1)+z*(U+1),q=h+(ie+1)+z*U;l.push(te,X,q),l.push(X,W,q)}h+=F}function v(m,g,y){let b=new k,x=new k(e/2,t/2,r/2);x.subScalar(o);let S=[],w=m*g*y>0?(C,A,M)=>l.push(C,A,M):(C,A,M)=>l.push(C,M,A);for(let C=0;C<=s;C++){let A=[],M=PC*(1-C/s),P=Math.cos(M),T=Math.sin(M),R=0;for(let z=0;z<=C;z++){let F=Math.cos(R),H=Math.sin(R);b.x=P*F,b.y=T,b.z=P*H;let N=x.clone().addScaledVector(b,o);c.push(m*N.x,g*N.y,y*N.z),d.push(m*b.x,g*b.y,y*b.z),u.push(0,0),A.push(h++),R+=PC/C}S.push(A)}let _=S.length-1;for(let C=0;C<_;C++){let A=S[C],M=S[C+1],P=A.length-1;w(A[0],M[1],M[0]);for(let T=1;T<=P;T++)w(A[T-1],A[T],M[T]),w(A[T],M[T+1],M[T])}}}},WP=class extends Ot{constructor(e=[],t=[],r="",i=1,n=.2,a=4){super(),this.type="PolyhedronGeometryRound";let o=[],s=[],l=[];c(),d(),this.setAttribute("position",new yt(o,3)),this.setAttribute("normal",new yt(l,3)),this.setAttribute("uv",new yt(s,2));return;function c(){var N;n=Math.min(1-1e-5,n),n==0&&(a=0);let u={IcosahedronGeometry:5,DodecahedronGeometry:3,HexahedronGeometry:3,OctahedronGeometry:4,TetrahedronGeometry:3}[r],h=new k,f=h.clone(),p=new Zn,v=n*i,m=i-v,g=a+1,y=new k,b=(U,ie)=>y.subVectors(U,ie).normalize(),x=(U,ie)=>Array(U).fill(void 0).map(ie),S=x(e.length/3,(U,ie)=>new k().fromArray(e,ie*3).setLength(i)),w=[],_=1e6;for(let U=0;U<S.length;U++){let ie=S[U],te=[],X,W,q,$=1e10,le=-1;for(;(le=t.indexOf(U,le+1))!=-1;){let V=le-le%3;X=t[V+(le+1)%3],W=t[V+(le+2)%3],q=ie.distanceToSquared(S[X]),$=Math.min($,q),te.push([X,W,q])}$+=1e-6;let ee=[],Q=0,ne=te.length;for(let V=0;V<ne;V++){[X,W,q]=te[Q];let de=((N=w[X])==null?void 0:N.includes(U))==!0;q<=$&&ee.push(X+ +de*_),Q=te.findIndex(me=>me[0]==W)}w.push(ee)}let C=[];{let U=0,ie=0,te,X,W=u==3;for(let q=0;q<=a;q++){te=q*(q+1)/2,X=(q+1)*(q+2)/2;for(let $=0;$<a-q;$++)[U,ie]=[te+$+q+2,X+$+q+3],C.push(te,X,...W?[ie,te]:[U,X],ie,U),[te,X]=[U,ie];C.push(te,X,te+a+2)}}let A=h.clone(),M=h.clone(),P=h.clone(),T=h.clone(),R=h.clone(),z=[],F=x(S.length,()=>x(u,()=>h.clone()));for(let U=0;U<S.length;U++){h.copy(S[U]).normalize(),A.copy(h).multiplyScalar(m);let ie=w[U];for(let ee=0;ee<ie.length;ee++){let Q=ie[ee],ne=ie[(ee+1)%u];p.setFromPointsAndIndices(S,U,Q%_,ne%_),p.b.sub(p.a).setLength(1e10).add(p.a),p.c.sub(p.a).setLength(1e10).add(p.a),p.closestPointToPoint(A,F[U][ee])}let te=[],X=[],W=[],q=new k;a==0&&[...F[U]].reduce((ee,Q)=>ee.add(Q),q).multiplyScalar(1/u);for(let ee=0;ee<u;ee++){let Q=[],ne=(ee-1+u)%u,V=F[U][ne],de=F[U][ee];h.copy(V).sub(A),f.copy(de).sub(A);let me=A.angleTo(h),Ce=h.angleTo(f),G=Math.cos(me)*v;a==0?M.copy(q):M.copy(A).setLength(m+G),X.push(G);let Z=[M,V,de];for(let ue=0;ue<2;ue++){let Se=Z[ue],we=Z[ue+1];T.subVectors(Se,A),R.subVectors(we,A),P.crossVectors(T,R).normalize();for(let _e=0;_e<g;_e++){let Ee=[me,Ce][ue]*_e/g;h.copy(T).applyAxisAngle(P,Ee).add(A),te.push(h.clone()),ue&&(b(h,A),Q.push([_e==0?Se:h.clone(),y.clone()]))}ue&&(b(we,A),Q.push([we,y.clone()]))}W.push(Q)}z.push(W);let $=2*g,le=2;for(let ee=0;ee<u;ee++){let Q=$*ee,ne=$*((ee+1)%u),V=[te[Q]];for(let me=1;me<g;me++){T=te[Q+me],R=te[ne+me],V.push(T);for(let Ce=1,G=me-le+1;Ce<=G;Ce++)h.lerpVectors(T,R,Ce/(G+1)),h.sub(A).setLength(X[ee]).add(A),V.push(h.clone());V.push(R)}for(let me=0;me<g;me++)V.push(te[me+g+Q]);V.push(te[ne+g]);let de=C.map(me=>V[me]);o.push(...de.map(me=>[me.x,me.y,me.z]).flat()),l.push(...de.map(me=>(b(me,A),[y.x,y.y,y.z])).flat())}}let H=[];for(let U=0;U<w.length;U++)for(let ie=0;ie<u;ie++){let te=w[U][ie];if(te<_){let X=w[te].findIndex($=>$%_==U),W=z[U][ie],q=z[te][X];for(let $=0;$<g;$++){let le=W[$],ee=q[g-$],Q=W[$+1],ne=q[g-($+1)];[le,ee,Q,Q,ee,ne].forEach(V=>{o.push(V[0].x,V[0].y,V[0].z),l.push(V[1].x,V[1].y,V[1].z)})}H.push(W[0][0],q[g][0],W[g][0],q[0][0])}}for(;H.length;){let U,ie,te,X;[U,ie]=H.splice(0,2);let W=[U];for(;U!=ie;)W.push(ie),te=H.indexOf(ie),X=te%2,ie=H.splice(te-X,2)[1-X];y.subVectors(W[0],W[1]).cross(h.subVectors(W[0],W[2])).normalize();let q=y.dot(W[0])<0;q&&y.negate();for(let $=1;$<=W.length-2;$++)[W[$+ +q],W[$+1-+q],W[0]].forEach(le=>{o.push(le.x,le.y,le.z),l.push(y.x,y.y,y.z)})}}function d(){let u=new k;for(let w=0;w<o.length;w+=3){u.x=o[w+0],u.y=o[w+1],u.z=o[w+2];let _=x(u)/2/Math.PI+.5,C=S(u)/Math.PI+.5;s.push(_,1-C)}let h=new k,f=new k,p=new k,v=new k,m=new ye,g=new ye,y=new ye,b=(w,_,C,A)=>{A<0&&w.x===1&&(s[_]=w.x-1),C.x===0&&C.z===0&&(s[_]=A/2/Math.PI+.5)};for(let w=0,_=0;w<o.length;w+=9,_+=6){h.set(o[w+0],o[w+1],o[w+2]),f.set(o[w+3],o[w+4],o[w+5]),p.set(o[w+6],o[w+7],o[w+8]),m.set(s[_+0],s[_+1]),g.set(s[_+2],s[_+3]),y.set(s[_+4],s[_+5]),v.copy(h).add(f).add(p).divideScalar(3);let C=x(v);b(m,_+0,h,C),b(g,_+2,f,C),b(y,_+4,p,C)}for(let w=0;w<s.length;w+=6){let _=s[w+0],C=s[w+2],A=s[w+4],M=Math.max(_,C,A),P=Math.min(_,C,A);M>.9&&P<.1&&(_<.2&&(s[w+0]+=1),C<.2&&(s[w+2]+=1),A<.2&&(s[w+4]+=1))}function x(w){return Math.atan2(w.z,-w.x)}function S(w){return Math.atan2(-w.y,Math.sqrt(w.x*w.x+w.z*w.z))}}}static fromJSON(e){return new WP(e.vertices,e.indices,e.radius,e.corner,e.cornerSides)}},KDe=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,detail:0,corner:0,cornerSides:4},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(e){let{width:t,height:r,depth:i,detail:n,corner:a,cornerSides:o}=e.parameters,s=n===0&&a!==0?new C8(t*.5,a,o):new Pj(t*.5,n);return s.scale(1,r/t,i/t),Object.assign(s,{userData:{...e,type:"DodecahedronGeometry"}})}},C8=class extends WP{constructor(e=1,t=.2,r=4){let i=(1+Math.sqrt(5))/2,n=1/i,a=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-n,-i,0,-n,i,0,n,-i,0,n,i,-n,-i,0,-n,i,0,n,-i,0,n,i,0,-i,0,-n,i,0,-n,-i,0,n,i,0,n],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],s="DodecahedronGeometry";super(a,o,s,e,t,r),this.type=s}static fromJSON(e){return new C8(e.radius,e.corner,e.cornerSides)}},zm=1e-12,GP=class{constructor(e){this.position=new ye,this.startPosition=new ye,this.uuid=St.generateUUID(),this.position=e.clone()}start(){this.reset()}reset(){this.startPosition.copy(this.position)}applyOffset(e){this.position.copy(this.startPosition).add(e)}copy(e){return this.position.copy(e.position),this.startPosition.copy(e.startPosition),this}clone(){return new GP(this.position).copy(this)}toJSON(){return[this.position.x,this.position.y]}},NM=class extends GP{constructor(e){super(e.position),this.parent=e}copy(e){return super.copy(e),this}clone(){return new NM(this.parent).copy(this)}},qf=class extends GP{constructor(e,t){super(t),this.controls=[],this.roundness=0,this.areControlsDirectionsMirrored=!0,this.uuid=e,this.controls.push(new NM(this),new NM(this))}static create(e,t){let r=new qf(e,new ye(...t.position));return r.controls[0].position.set(...t.controlPrevious.position),r.controls[1].position.set(...t.controlNext.position),r.roundness=t.roundness,r.areControlsDirectionsMirrored=t.areControlsDirectionsMirrored,r}getOppositeControl(e){let t=this.controls.indexOf(e);return t===0?this.controls[1]:t===1?this.controls[0]:null}applyOffsetToControls(e,t=1){for(let r=0,i=this.controls.length;r<i;r++){let n=this.controls[r];this.position.distanceTo(n.position)<=t?n.position.copy(this.position):n.applyOffset(e)}}controlsMoved(){return!(this.position.equals(this.controls[0].position)&&this.position.equals(this.controls[1].position))}copy(e){return super.copy(e),this.controls[0].copy(e.controls[0]),this.controls[1].copy(e.controls[1]),this.roundness=e.roundness,this.uuid=e.uuid,this}clone(){return new qf(this.uuid,this.position).copy(this)}toJSON(){return super.toJSON().concat(this.controls[0].toJSON(),this.controls[1].toJSON(),[this.roundness])}computeTangents(){var r,i;let e=(r=this.curveBefore)==null?void 0:r.getTangentAt(1),t=(i=this.curveAfter)==null?void 0:i.getTangentAt(0);return[e,t]}computeNormals(e=new ye,t=new ye){let[r,i]=this.computeTangents();return r&&i&&(TL(r,e),TL(i,t)),[e,t]}computeTangent(e=new ye){let[t,r]=this.computeTangents();return t&&r&&e.copy(t).add(r).normalize(),e}computeNormal(e=new ye){let[t,r]=this.computeNormals();return e.copy(t).add(r).normalize(),e}};function TL(e,t=new ye){let r=e.length();return t.set(-e.y/r,e.x/r)}var $P=e=>e,em=new ye,fw=new ye,QDe=new ye,ZDe=new ye,JDe=new ye,e3e=new ye,_8=new k,A8=new k;function t3e(e){let t=new ye;t.addVectors(e.v0,em.subVectors(e.v1,e.v0).multiplyScalar(2/3));let r=new ye;return r.addVectors(e.v2,fw.subVectors(e.v1,e.v2).multiplyScalar(2/3)),new rs(e.v0,t,r,e.v2)}function rv(e,t,r=Number.EPSILON){return Math.abs(e-t)<r}function r3e(e,t,r=Number.EPSILON){return e.distanceTo(t)<r}function i3e(e,t,r=Number.EPSILON){return e.distanceTo(t)<r}function M8(e,t,r){let i=Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)),n=Math.sqrt(Math.pow(t.x-r.x,2)+Math.pow(t.y-r.y,2)),a=Math.sqrt(Math.pow(r.x-e.x,2)+Math.pow(r.y-e.y,2));return Math.acos((n*n+i*i-a*a)/(2*n*i))}function n3e(e,t,r){return DL(e,t)&&DL(t,r)&&UM(e.position,t.position,r.position)}function UM(e,t,r){return em.copy(t).sub(e).cross(fw.copy(r).sub(e))===0}function a3e(e,t,r,i,n){let a=Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)),o=(e.y+t.y)/2,s=(e.x+t.x)/2,l=Math.sqrt(Math.pow(r,2)-Math.pow(a/2,2))*(e.y-t.y)/a,c=Math.sqrt(Math.pow(r,2)-Math.pow(a/2,2))*(t.x-e.x)/a;return i.set(s+l,o+c),n.set(s-l,o-c),[i,n]}function o3e(e,t,r){let i=e.distanceTo(r),n=t.distanceTo(r);return i<n?t:e}function s3e(e,t,r,i,n,a){let o=t.x-e.x,s=t.y-e.y,l=r.x-e.x,c=r.y-e.y,d=Math.sqrt((o+l)*(o+l)+(s+c)*(s+c)),u;return M8(t,e,r)>Math.PI&&(d*=-1),rv(c,s)?u=(s+c)*(i/d-.5)*8/3/(o-l):u=(o+l)*(i/d-.5)*8/3/(c-s),n.set(t.x-u*s,t.y+u*o),a.set(r.x+u*c,r.y-u*l),[n,a]}function PL(e,t){return e.position.equals(e.controls[1].position)&&t.position.equals(t.controls[0].position)}function DL(e,t){return UM(e.position,e.controls[1].position,t.position)&&UM(e.position,t.controls[0].position,t.position)}function l3e(e,t,r,i,n=.5){let a=em.subVectors(t,e).multiplyScalar(n).add(e),o=fw.subVectors(r,t).multiplyScalar(n).add(t),s=QDe.subVectors(i,r).multiplyScalar(n).add(r),l=a,c=ZDe.subVectors(o,a).multiplyScalar(n).add(a),d=JDe.subVectors(s,o).multiplyScalar(n).add(o),u=s,h=e3e.subVectors(d,c).multiplyScalar(n).add(c);return[e.x,e.y,l.x,l.y,c.x,c.y,h.x,h.y,d.x,d.y,u.x,u.y,i.x,i.y]}function c3e(e,t,r=12,i=!0){let n=A8.set(0,0,0),a,o=0;for(let s=0;s<t.length;s++){let l=$P(t[s]),c=em,d=Wu(l,r);for(let u=0;u<=d;u++)if(l instanceof rs||l instanceof Cd||l instanceof ls){if(l.getPoint(u/d,c),n.set(c.x,c.y,0),a!==void 0&&i3e(a,n))continue;a===void 0&&(a=_8),a.copy(n),e.setXYZ(o,n.x,n.y,n.z),o++}}return i&&o>1&&!(e.getX(o-1)===e.getX(0)&&e.getY(o-1)===e.getY(0)&&e.getZ(o-1)===e.getZ(0))&&(e.setXYZ(o,e.getX(0),e.getY(0),e.getZ(0)),o++),e}function d3e(e,t,r,i=12,n=!0){let a=A8.set(0,0,0),o=0,s=[];for(let l=0;l<t.length;l++){if(r[l]===!1)continue;let c,d=$P(t[l]),u=em,h=Wu(d,i);s.push(h);for(let f=0;f<=h;f++)if(d instanceof rs||d instanceof Cd||d instanceof ls){if(d.getPoint(f/h,u),a.set(u.x,u.y,0),c==null?void 0:c.equals(a))continue;c===void 0?c=_8:(e.setXYZ(o,c.x,c.y,c.z),o++,e.setXYZ(o,a.x,a.y,a.z),o++),c.copy(a)}}return n&&o>1&&!(e.getX(o-1)===e.getX(0)&&e.getY(o-1)===e.getY(0)&&e.getZ(o-1)===e.getZ(0))&&(e.setXYZ(o,e.getX(0),e.getY(0),e.getZ(0)),o++),s}function OL(e,t=12,r=!1){let i=[];for(let n=0,a=e.length;n<a;n++){let o=e[n],s=0;if(r&&o.roundedCurveCorner!==void 0){let l=Wu(o.roundedCurveCorner,t)*.5;n>0&&(i[n-1]+=l),s+=l}o.curveAfter!==void 0&&(s+=Wu(o.curveAfter,t)),i.push(s)}return e.length>0&&r&&e[0].roundedCurveCorner!==void 0&&(i[e.length-1]+=Wu(e[0].roundedCurveCorner,t)*.5),i}function Wu(e,t=12){return e&&e instanceof Z1?t*2:e&&(e instanceof ls||e instanceof Mj)?1:e&&e instanceof oP?t*e.points.length:t}function u3e(e,t,r=12,i=!0){let n,a=0;for(let o=0;o<t.length;o++){let s=$P(t[o]),l=Wu(s,r),c=em;for(let d=0;d<=l;d++)if(s instanceof rs||s instanceof Cd||s instanceof ls){if(s.getPoint(d/l,c),n!==void 0&&r3e(n,c,zm))continue;n===void 0&&(n=fw),n.copy(c),e.push(c.x,c.y),a++}}return rv(e[0],e[e.length-2],zm)&&rv(e[1],e[e.length-1],zm)&&(e.pop(),e.pop()),i&&a>1&&!(rv(e[a-1],e[1],zm)&&rv(e[a-2],e[0],zm))&&(e.push(e[0],e[1]),a++),e}var DC=new ye,h3e=new ye,f3e=new ye,p3e=new ye,m3e=new ye,v3e=new ye,Bi=class extends mx{constructor(e=100,t=100){super(),this.points=[],this.shapeHoles=[],this.plane=new Va(new k(0,0,-1)),this.subdivision=0,this.controlSnapDistance=4,this.pointIDs=0,this.isMesh2D=!1,this.isText=!1,this._roundness=0,this.isClosed=!1,this.useCubicForRoundedCorners=!0,this.uuid=St.generateUUID(),this.needsUpdate=!1,this.roundedCurves=[],this._width=e,this._height=t}static createFromState(e,t,r){let i=new Bi;return i.isClosed=e.isClosed,i.points=e.points.map(n=>qf.create(n.id,n.data)),typeof e.roundness=="number"&&(i.roundness=e.roundness),i.shapeHoles=e.shapeHoles.map(n=>Bi.createFromState(n)),t!==void 0&&r!==void 0&&i.applySize(t,r),i.update(),i}get width(){return this._width}get height(){return this._height}get roundness(){return this._roundness}set roundness(e){if(this._roundness!==e){this._roundness=e;for(let t=0,r=this.points.length;t<r;t++)this.points[t].roundness=e;this.needsUpdate=!0}}getPointsIndexesByIds(e){return e.map(t=>this.getPointIndexById(t)).filter(t=>t>=0)}getPointIndexById(e){let t=this.points.length,r=this.points.findIndex(i=>i.uuid===e);if(r<0){let i=t;for(let n=0,a=this.shapeHoles.length;n<a;n++){let o=this.shapeHoles[n],s=o.points.length,l=o.getPointIndexById(e);if(l<0)i+=s;else return l+i}}return r}getLineIndexById(e){return this.getPointIndexById(e)}getBezierPoint(e){if(e<=this.points.length-1)return this.points[e];if(this.shapeHoles.length>0){let t=this.points.length;for(let r=0,i=this.shapeHoles.length;r<i;r++){let n=this.shapeHoles[r],a=e-t;if(a<=n.points.length-1)return n.points[a];t+=n.points.length}}throw new Error("This shape does not have a point for this index: "+e)}getBezierPointIndex(e){let t=this.points.indexOf(e);if(t>=0)return t;if(t=this.points.length,this.shapeHoles.length>0)for(let r=0,i=this.shapeHoles.length;r<i;r++){let n=this.shapeHoles[r],a=n.points.indexOf(e);if(a>=0)return t+a;t+=n.points.length}return-1}getAllPoints(){let e=[].concat(...this.shapeHoles.map(t=>t.points));return[...this.points,...e]}applySize(e,t){e===0&&(e=.001),t===0&&(t=.001),this._width=e,this._height=t}applyScale(e,t){let r=DC.set(e,t);for(let i=0,n=this.points.length;i<n;i++){let a=this.points[i];a.position.multiply(r),a.controls[0].position.multiply(r),a.controls[1].position.multiply(r)}for(let i=0,n=this.shapeHoles.length;i<n;i++)this.shapeHoles[i].applyScale(e,t);this._update()}createPoint(e,t=0,r=St.generateUUID()){let i;e instanceof ye?i=e:i=new ye(e,t);let n=new qf(r,i);return n.roundness=this.roundness,n}addPoint(e){this.points.push(e),this.needsUpdate=!0}addPointAt(e,t){this.points.splice(t,0,e),this.needsUpdate=!0}getPointByUuid(e){for(let t=0,r=this.points.length;t<r;t++){let i=this.points[t];if(i.uuid===e)return i}for(let t=0,r=this.shapeHoles.length;t<r;t++){let i=this.shapeHoles[t].getPointByUuid(e);if(i)return i}}getFirstPoint(){return this.points[0]}getLastPoint(){return this.points[this.points.length-1]}removePoint(e){let t=this.points.indexOf(e);t>=0&&this.points.splice(t,1),this.needsUpdate=!0}removePointById(e){let t=this.points.find(r=>r.uuid===e);t&&this.removePoint(t)}update(){for(let e=0,t=this.shapeHoles.length;e<t;e++)this.shapeHoles[e].update();this._update()}extractShapePointsToBuffer(e,t=12,r=!1){this.subdivision=t,this.curveDivisions===void 0&&this.computeCurveDivisions(t);let i=r?this.roundedCurveDivisions:this.curveDivisions;return c3e(e,r?this.roundedCurves:this.curves,t,this.autoClose),i.reduce((n,a)=>n+a,0)+1}computeCurveDivisions(e=12){return this.curveDivisions=OL(this.points,e,!1),this.roundedCurveDivisions=OL(this.points,e,!0),this.curveDivisions}extractFilteredShapePointsToBuffer(e,t,r=12){return d3e(e,this.curves,t,r,this.autoClose).reduce((i,n)=>i+n,0)*2}extractShapePointsToFlatArray(e,t=12){return this.subdivision=t,this.curveDivisions===void 0&&this.computeCurveDivisions(t),u3e(e,this.roundedCurves,t,this.autoClose)}getCurveIndexFromVertexId(e,t=!1){let r=0;this.curveDivisions===void 0&&this.computeCurveDivisions(this.subdivision);let i=t?this.roundedCurveDivisions:this.curveDivisions,n=0;t&&this.points[0].roundedCurveCorner!==void 0&&(n=Wu(this.points[0].roundedCurveCorner,this.subdivision)*.5);let a=e-n;a<0&&(a+=i.reduce((o,s)=>o+s,0));for(let o=0,s=i.length;o<s;o++){let l=i[o];if(a<r+l)return[o,(a-r+1)/l];r+=l}return[0,1]}getCurveT(e,t,r){let i=this.points[e],n=this.points[e>=this.points.length-1?0:e+1],a=this.curveDivisions,o=a[e];if(PL(i,n)){let l=i.position.distanceTo(n.position);return i.position.distanceTo(DC.set(r.x,r.y))/l}let s=0;for(let l=0;l<e;l++)s+=a[l];return(t-s)/o}dispose(){}_applyCurveForPoint(e,t){PL(t,e)?this.lineTo(e.position.x,e.position.y):this.bezierCurveTo(t.controls[1].position.x,t.controls[1].position.y,e.controls[0].position.x,e.controls[0].position.y,e.position.x,e.position.y);let r=this.curves[this.curves.length-1];e.curveBefore=r,t.curveAfter=r;let i=r.clone();e.roundedCurveBefore=i,t.roundedCurveAfter=i,e.roundedCurveCorner=void 0,this.roundedCurves.push(i)}_update(){if(this.curves=[],this.roundedCurves=[],!this.points.length)return;for(let t=0,r=this.points.length;t<r;t++){let i=this.points[t];if(t===0)this.moveTo(i.position.x,i.position.y);else{let n=this.points[t-1];this._applyCurveForPoint(i,n)}}let e=this.getLastPoint();if(e!=null&&e.curveAfter&&(e.curveAfter=void 0),this.isClosed){let t=this.points[0],r=this.points[this.points.length-1];this._applyCurveForPoint(t,r)}if(this.points.length>2){let t=0;for(let r=0,i=this.points.length;r<i;r++){let n=this.points[r],a=this.points[r-1]??this.points[this.points.length-1],o=this.points[r+1]??this.points[0],s=n.roundness,l=a&&o&&n3e(a,n,o);if(!n.controlsMoved()&&s>0&&!l){let c=n.curveBefore,d=n.curveAfter;if(c===void 0||d===void 0)continue;let u=n.roundedCurveBefore,h=n.roundedCurveAfter,f=c.getLength(),p=d.getLength(),v=Math.min(s,f*.499),m=Math.min(s,p*.499),g=Math.min(v,m),y=1-g/f,b=g/p,x=c.getPointAt(y,DC),S=d.getPointAt(b,h3e);this._subSplitCurve(c,u,y,x,void 0),this._subSplitCurve(d,h,b,void 0,S);let w;if(this.useCubicForRoundedCorners){let _=M8(x,n.position,S)/2,C=Math.tan(_)*x.distanceTo(n.position),[A,M]=a3e(x,S,C,f3e,p3e),P=o3e(A,M,n.position),[T,R]=s3e(P,x,S,C,m3e,v3e);w=new rs(x.clone(),T.clone(),R.clone(),S.clone())}else w=new Cd(x.clone(),n.position.clone(),S.clone());n.roundedCurveCorner=w,this.roundedCurves.splice(r+t,0,w),t++}}}}_subSplitCurve(e,t,r,i,n){if(e instanceof ls)i!==void 0&&t.v2.copy(i),n!==void 0&&t.v1.copy(n);else{let a=e,o=t,s=a.getUtoTmapping(r,0),l=l3e(a.v0,a.v1,a.v2,a.v3,s);return i!==void 0&&(o.v0.set(l[0],l[1]),o.v1.set(l[2],l[3]),o.v2.set(l[4],l[5]),o.v3.set(l[6],l[7])),n!==void 0&&(o.v0.set(l[6],l[7]),o.v1.set(l[8],l[9]),o.v2.set(l[10],l[11]),o.v3.set(l[12],l[13])),o}return t}clone(){let e=new Bi(this._width,this._height);return e.points=this.points.map(t=>t.clone()),e.isClosed=this.isClosed,e.roundness=this.roundness,e.isMesh2D=this.isMesh2D,e.shapeHoles=this.shapeHoles.map(t=>t.clone()),e}toJSON(){return{points:this.points.reduce((e,t)=>e.concat(t.toJSON()),[]),shapeHoles:this.shapeHoles.map(e=>e.toJSON()),isClosed:this.isClosed,roundness:this.roundness}}fromJSON(e){var r;this.points=[],this.pointIDs=0;let t=e.points.length/7;for(let i=0;i<t;i++){let n=i*7,a=e.points[n+0],o=e.points[n+1],s=e.points[n+2],l=e.points[n+3],c=e.points[n+4],d=e.points[n+5],u=e.points[n+6],h=new qf(St.generateUUID(),new ye(a,o));h.controls[0].position.set(s,l),h.controls[1].position.set(c,d),h.roundness=u,this.points.push(h)}return this.shapeHoles=(r=e.shapeHoles)!=null&&r.length?e.shapeHoles.map(i=>{let n=new Bi;return n.fromJSON(i),n}):[],this.isClosed=e.isClosed,this._roundness=e.roundness,this._update(),this}fromShape(e,t=!1){this.isText=t;let r=(n,a)=>{a instanceof rs&&a.v3.equals(n.position)&&n.controls[0].position.copy(a.v2)},i=n=>{let a=[],o,s;for(o=0,s=n.length;o<s;o++)n[o]instanceof Cd&&(n[o]=t3e(n[o]));for(o=0,s=n.length;o<s;o++){let d=n[o],u=o>0?n[o-1]:null,h;d instanceof rs?(h=this.createPoint(d.v0),h.controls[1].position.copy(d.v1)):d instanceof ls&&(h=this.createPoint(d.v1)),h!==void 0&&(u!==null&&r(h,u),a.push(h))}let l=n[n.length-1],c=!1;return l instanceof rs?l.v3.equals(a[0].position)&&(a[0].controls[0].position.copy(l.v2),c=!0):l instanceof ls&&l.v2.equals(a[0].position)&&(c=!0),this.isClosed=c,a};return this.points=i(e.curves),e instanceof mx&&(this.shapeHoles=e.holes.map(n=>{let a=new Bi;return a.fromShape(n),a})),this.update(),this}updatePoint(e,t){let r=this.getPointByUuid(e);r&&(t.position!==void 0&&r.position.fromArray(t.position),t.roundness!==void 0&&(r.roundness=t.roundness),t.areControlsDirectionsMirrored!==void 0&&(r.areControlsDirectionsMirrored=t.areControlsDirectionsMirrored),this.needsUpdate=!0)}updatePreviousControl(e,t){var i;let r=(i=this.getPointByUuid(e))==null?void 0:i.controls[0];r&&(t.position&&r.position.fromArray(t.position),this.needsUpdate=!0)}updateNextControl(e,t){var i;let r=(i=this.getPointByUuid(e))==null?void 0:i.controls[1];r&&(t.position&&r.position.fromArray(t.position),this.needsUpdate=!0)}},jM=Math.PI*2;function OC({x:e,y:t},r,i,n,a){return{x:e*r+n,y:t*i+a}}function g3e(e,t){let r=t===1.5707963267948966?.551915024494:t===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(t/4),i=Math.cos(e),n=Math.sin(e),a=Math.cos(e+t),o=Math.sin(e+t);return[{x:i-n*r,y:n+i*r},{x:a+o*r,y:o-a*r},{x:a,y:o}]}function RL(e,t,r,i){let n=e*i-t*r<0?-1:1,a=Math.min(1,Math.max(-1,e*r+t*i));return n*Math.acos(a)}function y3e(e,t,r,i,n,a,o,s,l,c){let d=Math.pow(n,2),u=Math.pow(a,2),h=Math.pow(o,2),f=Math.pow(s,2),p=d*u-d*f-u*h;p<0&&(p=0),p/=d*f+u*h,p=Math.sqrt(p)*(l===c?-1:1);let v=p*n/a*s,m=p*-a/n*o,g=v+(e+r)/2,y=m+(t+i)/2,b=(o-v)/n,x=(s-m)/a,S=(-o-v)/n,w=(-s-m)/a,_=RL(1,0,b,x),C=RL(b,x,S,w);return!c&&C>0&&(C-=jM),c&&C<0&&(C+=jM),{centerx:g,centery:y,ang1:_,ang2:C}}function b3e({px:e,py:t,cx:r,cy:i,rx:n,ry:a,largeArcFlag:o,sweepFlag:s}){let l=[];if(n===0||a===0)return[];let c=(e-r)/2,d=(t-i)/2;if(c===0&&d===0)return[];n=Math.abs(n),a=Math.abs(a);let u=Math.pow(c,2)/Math.pow(n,2)+Math.pow(d,2)/Math.pow(a,2);u>1&&(n*=Math.sqrt(u),a*=Math.sqrt(u));let h=y3e(e,t,r,i,n,a,c,d,o,s),{ang1:f,ang2:p}=h,{centerx:v,centery:m}=h,g=Math.abs(p)/(jM/4);Math.abs(1-g)<1e-7&&(g=1);let y=Math.max(Math.ceil(g),1);p/=y;for(let b=0;b<y;b++)l.push(g3e(f,p)),f+=p;return l.map(b=>{let{x,y:S}=OC(b[0],n,a,v,m),{x:w,y:_}=OC(b[1],n,a,v,m),{x:C,y:A}=OC(b[2],n,a,v,m);return{x1:x,y1:S,x2:w,y2:_,x:C,y:A}})}var ti;(function(e){e[e.ODD=0]="ODD",e[e.NONZERO=1]="NONZERO",e[e.POSITIVE=2]="POSITIVE",e[e.NEGATIVE=3]="NEGATIVE",e[e.ABS_GEQ_TWO=4]="ABS_GEQ_TWO"})(ti||(ti={}));var an;(function(e){e[e.POLYGONS=0]="POLYGONS",e[e.CONNECTED_POLYGONS=1]="CONNECTED_POLYGONS",e[e.BOUNDARY_CONTOURS=2]="BOUNDARY_CONTOURS"})(an||(an={}));function Wt(e,t){if(!e)throw t||"Assertion Failed!"}var zt=function(){function e(){}return e.vertEq=function(t,r){return t.s===r.s&&t.t===r.t},e.vertLeq=function(t,r){return t.s<r.s||t.s===r.s&&t.t<=r.t},e.transLeq=function(t,r){return t.t<r.t||t.t===r.t&&t.s<=r.s},e.edgeGoesLeft=function(t){return e.vertLeq(t.Dst,t.Org)},e.edgeGoesRight=function(t){return e.vertLeq(t.Org,t.Dst)},e.vertL1dist=function(t,r){return Math.abs(t.s-r.s)+Math.abs(t.t-r.t)},e.edgeEval=function(t,r,i){Wt(e.vertLeq(t,r)&&e.vertLeq(r,i));var n=r.s-t.s,a=i.s-r.s;return n+a>0?n<a?r.t-t.t+(t.t-i.t)*(n/(n+a)):r.t-i.t+(i.t-t.t)*(a/(n+a)):0},e.edgeSign=function(t,r,i){Wt(e.vertLeq(t,r)&&e.vertLeq(r,i));var n=r.s-t.s,a=i.s-r.s;return n+a>0?(r.t-i.t)*n+(r.t-t.t)*a:0},e.transEval=function(t,r,i){Wt(e.transLeq(t,r)&&e.transLeq(r,i));var n=r.t-t.t,a=i.t-r.t;return n+a>0?n<a?r.s-t.s+(t.s-i.s)*(n/(n+a)):r.s-i.s+(i.s-t.s)*(a/(n+a)):0},e.transSign=function(t,r,i){Wt(e.transLeq(t,r)&&e.transLeq(r,i));var n=r.t-t.t,a=i.t-r.t;return n+a>0?(r.s-i.s)*n+(r.s-t.s)*a:0},e.vertCCW=function(t,r,i){return t.s*(r.t-i.t)+r.s*(i.t-t.t)+i.s*(t.t-r.t)>=0},e.interpolate=function(t,r,i,n){return t=t<0?0:t,i=i<0?0:i,t<=i?i===0?(r+n)/2:r+(n-r)*(t/(t+i)):n+(r-n)*(i/(t+i))},e.intersect=function(t,r,i,n,a){var o,s,l;e.vertLeq(t,r)||(l=t,t=r,r=l),e.vertLeq(i,n)||(l=i,i=n,n=l),e.vertLeq(t,i)||(l=t,t=i,i=l,l=r,r=n,n=l),e.vertLeq(i,r)?e.vertLeq(r,n)?(o=e.edgeEval(t,i,r),s=e.edgeEval(i,r,n),o+s<0&&(o=-o,s=-s),a.s=e.interpolate(o,i.s,s,r.s)):(o=e.edgeSign(t,i,r),s=-e.edgeSign(t,n,r),o+s<0&&(o=-o,s=-s),a.s=e.interpolate(o,i.s,s,n.s)):a.s=(i.s+r.s)/2,e.transLeq(t,r)||(l=t,t=r,r=l),e.transLeq(i,n)||(l=i,i=n,n=l),e.transLeq(t,i)||(l=t,t=i,i=l,l=r,r=n,n=l),e.transLeq(i,r)?e.transLeq(r,n)?(o=e.transEval(t,i,r),s=e.transEval(i,r,n),o+s<0&&(o=-o,s=-s),a.t=e.interpolate(o,i.t,s,r.t)):(o=e.transSign(t,i,r),s=-e.transSign(t,n,r),o+s<0&&(o=-o,s=-s),a.t=e.interpolate(o,i.t,s,n.t)):a.t=(i.t+r.t)/2},e}(),km=function(){function e(){this.next=null,this.prev=null,this.anEdge=null,this.trail=null,this.n=0,this.marked=!1,this.inside=!1}return e}(),Ay=function(){function e(t){this.side=t,this.next=null,this.Org=null,this.Sym=null,this.Onext=null,this.Lnext=null,this.Lface=null,this.activeRegion=null,this.winding=0}return Object.defineProperty(e.prototype,"Rface",{get:function(){return this.Sym.Lface},set:function(t){this.Sym.Lface=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Dst",{get:function(){return this.Sym.Org},set:function(t){this.Sym.Org=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Oprev",{get:function(){return this.Sym.Lnext},set:function(t){this.Sym.Lnext=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Lprev",{get:function(){return this.Onext.Sym},set:function(t){this.Onext.Sym=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Dprev",{get:function(){return this.Lnext.Sym},set:function(t){this.Lnext.Sym=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Rprev",{get:function(){return this.Sym.Onext},set:function(t){this.Sym.Onext=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Dnext",{get:function(){return this.Sym.Onext.Sym},set:function(t){this.Sym.Onext.Sym=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Rnext",{get:function(){return this.Sym.Lnext.Sym},set:function(t){this.Sym.Lnext.Sym=t},enumerable:!0,configurable:!0}),e}(),wf=function(){function e(){this.next=null,this.prev=null,this.anEdge=null,this.coords=[0,0,0],this.s=0,this.t=0,this.pqHandle=0,this.n=0,this.idx=0}return e}(),IL=function(){function e(){var t=new wf,r=new km,i=new Ay(0),n=new Ay(1);t.next=t.prev=t,t.anEdge=null,r.next=r.prev=r,i.next=i,i.Sym=n,n.next=n,n.Sym=i,this.vHead=t,this.fHead=r,this.eHead=i,this.eHeadSym=n}return e.prototype.makeEdge_=function(t){var r=new Ay(0),i=new Ay(1);t.Sym.side<t.side&&(t=t.Sym);var n=t.Sym.next;return i.next=n,n.Sym.next=r,r.next=t,t.Sym.next=i,r.Sym=i,r.Onext=r,r.Lnext=i,r.Org=null,r.Lface=null,r.winding=0,r.activeRegion=null,i.Sym=r,i.Onext=i,i.Lnext=r,i.Org=null,i.Lface=null,i.winding=0,i.activeRegion=null,r},e.prototype.splice_=function(t,r){var i=t.Onext,n=r.Onext;i.Sym.Lnext=r,n.Sym.Lnext=t,t.Onext=n,r.Onext=i},e.prototype.makeVertex_=function(t,r,i){var n=t;Wt(n,"Vertex can't be null!");var a=i.prev;n.prev=a,a.next=n,n.next=i,i.prev=n,n.anEdge=r;var o=r;do o.Org=n,o=o.Onext;while(o!==r)},e.prototype.makeFace_=function(t,r,i){var n=t;Wt(n,"Face can't be null");var a=i.prev;n.prev=a,a.next=n,n.next=i,i.prev=n,n.anEdge=r,n.trail=null,n.marked=!1,n.inside=i.inside;var o=r;do o.Lface=n,o=o.Lnext;while(o!==r)},e.prototype.killEdge_=function(t){t.Sym.side<t.side&&(t=t.Sym);var r=t.next,i=t.Sym.next;r.Sym.next=i,i.Sym.next=r},e.prototype.killVertex_=function(t,r){var i=t.anEdge,n=i;do n.Org=r,n=n.Onext;while(n!==i);var a=t.prev,o=t.next;o.prev=a,a.next=o},e.prototype.killFace_=function(t,r){var i=t.anEdge,n=i;do n.Lface=r,n=n.Lnext;while(n!==i);var a=t.prev,o=t.next;o.prev=a,a.next=o},e.prototype.makeEdge=function(){var t=new wf,r=new wf,i=new km,n=this.makeEdge_(this.eHead);return this.makeVertex_(t,n,this.vHead),this.makeVertex_(r,n.Sym,this.vHead),this.makeFace_(i,n,this.fHead),n},e.prototype.splice=function(t,r){var i=!1,n=!1;if(t!==r){if(r.Org!==t.Org&&(n=!0,this.killVertex_(r.Org,t.Org)),r.Lface!==t.Lface&&(i=!0,this.killFace_(r.Lface,t.Lface)),this.splice_(r,t),!n){var a=new wf;this.makeVertex_(a,r,t.Org),t.Org.anEdge=t}if(!i){var o=new km;this.makeFace_(o,r,t.Lface),t.Lface.anEdge=t}}},e.prototype.delete=function(t){var r=t.Sym,i=!1;if(t.Lface!==t.Rface&&(i=!0,this.killFace_(t.Lface,t.Rface)),t.Onext===t)this.killVertex_(t.Org,null);else if(t.Rface.anEdge=t.Oprev,t.Org.anEdge=t.Onext,this.splice_(t,t.Oprev),!i){var n=new km;this.makeFace_(n,t,t.Lface)}r.Onext===r?(this.killVertex_(r.Org,null),this.killFace_(r.Lface,null)):(t.Lface.anEdge=r.Oprev,r.Org.anEdge=r.Onext,this.splice_(r,r.Oprev)),this.killEdge_(t)},e.prototype.addEdgeVertex=function(t){var r=this.makeEdge_(t),i=r.Sym;this.splice_(r,t.Lnext),r.Org=t.Dst;var n=new wf;return this.makeVertex_(n,i,r.Org),r.Lface=i.Lface=t.Lface,r},e.prototype.splitEdge=function(t){var r=this.addEdgeVertex(t),i=r.Sym;return this.splice_(t.Sym,t.Sym.Oprev),this.splice_(t.Sym,i),t.Dst=i.Org,i.Dst.anEdge=i.Sym,i.Rface=t.Rface,i.winding=t.winding,i.Sym.winding=t.Sym.winding,i.idx=t.idx,i.Sym.idx=t.Sym.idx,i},e.prototype.connect=function(t,r){var i=!1,n=this.makeEdge_(t),a=n.Sym;if(r.Lface!==t.Lface&&(i=!0,this.killFace_(r.Lface,t.Lface)),this.splice_(n,t.Lnext),this.splice_(a,r),n.Org=t.Dst,a.Org=r.Org,n.Lface=a.Lface=t.Lface,t.Lface.anEdge=a,!i){var o=new km;this.makeFace_(o,n,t.Lface)}return n},e.prototype.zapFace=function(t){var r=t.anEdge,i,n,a,o,s;n=r.Lnext;do i=n,n=i.Lnext,i.Lface=null,i.Rface===null&&(i.Onext===i?this.killVertex_(i.Org,null):(i.Org.anEdge=i.Onext,this.splice_(i,i.Oprev)),a=i.Sym,a.Onext===a?this.killVertex_(a.Org,null):(a.Org.anEdge=a.Onext,this.splice_(a,a.Oprev)),this.killEdge_(i));while(i!=r);o=t.prev,s=t.next,s.prev=o,o.next=s},e.prototype.countFaceVerts_=function(t){var r=t.anEdge,i=0;do i++,r=r.Lnext;while(r!==t.anEdge);return i},e.prototype.mergeConvexFaces=function(t){var r,i,n,a,o,s,l;for(r=this.fHead.next;r!==this.fHead;r=r.next)if(r.inside)for(i=r.anEdge,o=i.Org;n=i.Lnext,a=i.Sym,a&&a.Lface&&a.Lface.inside&&(s=this.countFaceVerts_(r),l=this.countFaceVerts_(a.Lface),s+l-2<=t&&zt.vertCCW(i.Lprev.Org,i.Org,a.Lnext.Lnext.Org)&&zt.vertCCW(a.Lprev.Org,a.Org,i.Lnext.Lnext.Org)&&(n=a.Lnext,this.delete(a),i=null,a=null)),!(i&&i.Lnext.Org===o);)i=n;return!0},e.prototype.check=function(){var t=this.fHead,r=this.vHead,i=this.eHead,n,a,o,s,l,c;for(a=t,a=t;(n=a.next)!==t;a=n){Wt(n.prev===a),l=n.anEdge;do Wt(l.Sym!==l),Wt(l.Sym.Sym===l),Wt(l.Lnext.Onext.Sym===l),Wt(l.Onext.Sym.Lnext===l),Wt(l.Lface===n),l=l.Lnext;while(l!==n.anEdge)}for(Wt(n.prev===a&&n.anEdge===null),s=r,s=r;(o=s.next)!==r;s=o){Wt(o.prev===s),l=o.anEdge;do Wt(l.Sym!==l),Wt(l.Sym.Sym===l),Wt(l.Lnext.Onext.Sym===l),Wt(l.Onext.Sym.Lnext===l),Wt(l.Org===o),l=l.Onext;while(l!==o.anEdge)}for(Wt(o.prev===s&&o.anEdge===null),c=i,c=i;(l=c.next)!==i;c=l)Wt(l.Sym.next===c.Sym),Wt(l.Sym!==l),Wt(l.Sym.Sym===l),Wt(l.Org!==null),Wt(l.Dst!==null),Wt(l.Lnext.Onext.Sym===l),Wt(l.Onext.Sym.Lnext===l);Wt(l.Sym.next===c.Sym&&l.Sym===this.eHeadSym&&l.Sym.Sym===l&&l.Org===null&&l.Dst===null&&l.Lface===null&&l.Rface===null)},e}(),zL=function(){function e(){this.handle=null}return e}(),kL=function(){function e(){this.key=null,this.node=0}return e}(),x3e=function(){function e(t,r){this.leq=r,this.max=0,this.nodes=[],this.handles=[],this.initialized=!1,this.freeList=0,this.size=0,this.max=t,this.nodes=[],this.handles=[];for(var i=0;i<t+1;i++)this.nodes[i]=new zL,this.handles[i]=new kL;this.initialized=!1,this.nodes[1].handle=1,this.handles[1].key=null}return e.prototype.floatDown_=function(t){var r=this.nodes,i=this.handles,n,a,o;for(n=r[t].handle;;){if(o=t<<1,o<this.size&&this.leq(i[r[o+1].handle].key,i[r[o].handle].key)&&++o,Wt(o<=this.max),a=r[o].handle,o>this.size||this.leq(i[n].key,i[a].key)){r[t].handle=n,i[n].node=t;break}r[t].handle=a,i[a].node=t,t=o}},e.prototype.floatUp_=function(t){var r=this.nodes,i=this.handles,n,a,o;for(n=r[t].handle;;){if(o=t>>1,a=r[o].handle,o===0||this.leq(i[a].key,i[n].key)){r[t].handle=n,i[n].node=t;break}r[t].handle=a,i[a].node=t,t=o}},e.prototype.init=function(){for(var t=this.size;t>=1;--t)this.floatDown_(t);this.initialized=!0},e.prototype.min=function(){return this.handles[this.nodes[1].handle].key},e.prototype.insert=function(t){var r,i;if(r=++this.size,r*2>this.max){this.max*=2;var n,a;for(a=this.nodes.length,this.nodes.length=this.max+1,n=a;n<this.nodes.length;n++)this.nodes[n]=new zL;for(a=this.handles.length,this.handles.length=this.max+1,n=a;n<this.handles.length;n++)this.handles[n]=new kL}return this.freeList===0?i=r:(i=this.freeList,this.freeList=this.handles[i].node),this.nodes[r].handle=i,this.handles[i].node=r,this.handles[i].key=t,this.initialized&&this.floatUp_(r),i},e.prototype.extractMin=function(){var t=this.nodes,r=this.handles,i=t[1].handle,n=r[i].key;return this.size>0&&(t[1].handle=t[this.size].handle,r[t[1].handle].node=1,r[i].key=null,r[i].node=this.freeList,this.freeList=i,--this.size,this.size>0&&this.floatDown_(1)),n},e.prototype.delete=function(t){var r=this.nodes,i=this.handles,n;Wt(t>=1&&t<=this.max&&i[t].key!==null),n=i[t].node,r[n].handle=r[this.size].handle,i[r[n].handle].node=n,--this.size,n<=this.size&&(n<=1||this.leq(i[r[n>>1].handle].key,i[r[n].handle].key)?this.floatDown_(n):this.floatUp_(n)),i[t].key=null,i[t].node=this.freeList,this.freeList=t},e}(),RC=function(){function e(){this.eUp=null,this.nodeUp=null,this.windingNumber=0,this.inside=!1,this.sentinel=!1,this.dirty=!1,this.fixUpperEdge=!1}return e}(),LL=function(){function e(){this.key=null,this.next=null,this.prev=null}return e}(),w3e=function(){function e(t,r){this.frame=t,this.leq=r,this.head=new LL,this.head.next=this.head,this.head.prev=this.head}return e.prototype.min=function(){return this.head.next},e.prototype.max=function(){return this.head.prev},e.prototype.insert=function(t){return this.insertBefore(this.head,t)},e.prototype.search=function(t){var r=this.head;do r=r.next;while(r.key!==null&&!this.leq(this.frame,t,r.key));return r},e.prototype.insertBefore=function(t,r){do t=t.prev;while(t.key!==null&&!this.leq(this.frame,t.key,r));var i=new LL;return i.key=r,i.next=t.next,t.next.prev=i,i.prev=t,t.next=i,i},e.prototype.delete=function(t){t.next.prev=t.prev,t.prev.next=t.next},e}(),S3e=function(){function e(){}return e.regionBelow=function(t){return t.nodeUp.prev.key},e.regionAbove=function(t){return t.nodeUp.next.key},e.debugEvent=function(t){},e.addWinding=function(t,r){t.winding+=r.winding,t.Sym.winding+=r.Sym.winding},e.edgeLeq=function(t,r,i){var n=t.event,a=r.eUp,o=i.eUp;if(a.Dst===n)return o.Dst===n?zt.vertLeq(a.Org,o.Org)?zt.edgeSign(o.Dst,a.Org,o.Org)<=0:zt.edgeSign(a.Dst,o.Org,a.Org)>=0:zt.edgeSign(o.Dst,n,o.Org)<=0;if(o.Dst===n)return zt.edgeSign(a.Dst,n,a.Org)>=0;var s=zt.edgeEval(a.Dst,n,a.Org),l=zt.edgeEval(o.Dst,n,o.Org);return s>=l},e.deleteRegion=function(t,r){r.fixUpperEdge&&Wt(r.eUp.winding===0),r.eUp.activeRegion=null,t.dict.delete(r.nodeUp)},e.fixUpperEdge=function(t,r,i){Wt(r.fixUpperEdge),t.mesh.delete(r.eUp),r.fixUpperEdge=!1,r.eUp=i,i.activeRegion=r},e.topLeftRegion=function(t,r){var i=r.eUp.Org,n;do r=e.regionAbove(r);while(r.eUp.Org===i);if(r.fixUpperEdge){if(n=t.mesh.connect(e.regionBelow(r).eUp.Sym,r.eUp.Lnext),n===null)return null;e.fixUpperEdge(t,r,n),r=e.regionAbove(r)}return r},e.topRightRegion=function(t){var r=t.eUp.Dst;do t=e.regionAbove(t);while(t.eUp.Dst===r);return t},e.addRegionBelow=function(t,r,i){var n=new RC;return n.eUp=i,n.nodeUp=t.dict.insertBefore(r.nodeUp,n),n.fixUpperEdge=!1,n.sentinel=!1,n.dirty=!1,i.activeRegion=n,n},e.isWindingInside=function(t,r){switch(t.windingRule){case ti.ODD:return(r&1)!==0;case ti.NONZERO:return r!==0;case ti.POSITIVE:return r>0;case ti.NEGATIVE:return r<0;case ti.ABS_GEQ_TWO:return r>=2||r<=-2}throw new Error("Invalid winding rulle")},e.computeWinding=function(t,r){r.windingNumber=e.regionAbove(r).windingNumber+r.eUp.winding,r.inside=e.isWindingInside(t,r.windingNumber)},e.finishRegion=function(t,r){var i=r.eUp,n=i.Lface;n.inside=r.inside,n.anEdge=i,e.deleteRegion(t,r)},e.finishLeftRegions=function(t,r,i){for(var n,a=null,o=r,s=r.eUp;o!==i;){if(o.fixUpperEdge=!1,a=e.regionBelow(o),n=a.eUp,n.Org!=s.Org){if(!a.fixUpperEdge){e.finishRegion(t,o);break}n=t.mesh.connect(s.Lprev,n.Sym),e.fixUpperEdge(t,a,n)}s.Onext!==n&&(t.mesh.splice(n.Oprev,n),t.mesh.splice(s,n)),e.finishRegion(t,o),s=a.eUp,o=a}return s},e.addRightEdges=function(t,r,i,n,a,o){var s,l,c,d,u=!0;c=i;do Wt(zt.vertLeq(c.Org,c.Dst)),e.addRegionBelow(t,r,c.Sym),c=c.Onext;while(c!==n);for(a===null&&(a=e.regionBelow(r).eUp.Rprev),l=r,d=a;s=e.regionBelow(l),c=s.eUp.Sym,c.Org===d.Org;)c.Onext!==d&&(t.mesh.splice(c.Oprev,c),t.mesh.splice(d.Oprev,c)),s.windingNumber=l.windingNumber-c.winding,s.inside=e.isWindingInside(t,s.windingNumber),l.dirty=!0,!u&&e.checkForRightSplice(t,l)&&(e.addWinding(c,d),e.deleteRegion(t,l),t.mesh.delete(d)),u=!1,l=s,d=c;l.dirty=!0,Wt(l.windingNumber-c.winding===s.windingNumber),o&&e.walkDirtyRegions(t,l)},e.spliceMergeVertices=function(t,r,i){t.mesh.splice(r,i)},e.vertexWeights=function(t,r,i){var n=zt.vertL1dist(r,t),a=zt.vertL1dist(i,t),o=.5*a/(n+a),s=.5*n/(n+a);t.coords[0]+=o*r.coords[0]+s*i.coords[0],t.coords[1]+=o*r.coords[1]+s*i.coords[1],t.coords[2]+=o*r.coords[2]+s*i.coords[2]},e.getIntersectData=function(t,r,i,n,a,o){r.coords[0]=r.coords[1]=r.coords[2]=0,r.idx=-1,e.vertexWeights(r,i,n),e.vertexWeights(r,a,o)},e.checkForRightSplice=function(t,r){var i=e.regionBelow(r),n=r.eUp,a=i.eUp;if(zt.vertLeq(n.Org,a.Org)){if(zt.edgeSign(a.Dst,n.Org,a.Org)>0)return!1;zt.vertEq(n.Org,a.Org)?n.Org!==a.Org&&(t.pq.delete(n.Org.pqHandle),e.spliceMergeVertices(t,a.Oprev,n)):(t.mesh.splitEdge(a.Sym),t.mesh.splice(n,a.Oprev),r.dirty=i.dirty=!0)}else{if(zt.edgeSign(n.Dst,a.Org,n.Org)<0)return!1;e.regionAbove(r).dirty=r.dirty=!0,t.mesh.splitEdge(n.Sym),t.mesh.splice(a.Oprev,n)}return!0},e.checkForLeftSplice=function(t,r){var i=e.regionBelow(r),n=r.eUp,a=i.eUp,o;if(Wt(!zt.vertEq(n.Dst,a.Dst)),zt.vertLeq(n.Dst,a.Dst)){if(zt.edgeSign(n.Dst,a.Dst,n.Org)<0)return!1;e.regionAbove(r).dirty=r.dirty=!0,o=t.mesh.splitEdge(n),t.mesh.splice(a.Sym,o),o.Lface.inside=r.inside}else{if(zt.edgeSign(a.Dst,n.Dst,a.Org)>0)return!1;r.dirty=i.dirty=!0,o=t.mesh.splitEdge(a),t.mesh.splice(n.Lnext,a.Sym),o.Rface.inside=r.inside}return!0},e.checkForIntersect=function(t,r){var i=e.regionBelow(r),n=r.eUp,a=i.eUp,o=n.Org,s=a.Org,l=n.Dst,c=a.Dst,d,u,h=new wf,f,p;if(Wt(!zt.vertEq(c,l)),Wt(zt.edgeSign(l,t.event,o)<=0),Wt(zt.edgeSign(c,t.event,s)>=0),Wt(o!==t.event&&s!==t.event),Wt(!r.fixUpperEdge&&!i.fixUpperEdge),o===s||(d=Math.min(o.t,l.t),u=Math.max(s.t,c.t),d>u))return!1;if(zt.vertLeq(o,s)){if(zt.edgeSign(c,o,s)>0)return!1}else if(zt.edgeSign(l,s,o)<0)return!1;return e.debugEvent(t),zt.intersect(l,o,c,s,h),Wt(Math.min(o.t,l.t)<=h.t),Wt(h.t<=Math.max(s.t,c.t)),Wt(Math.min(c.s,l.s)<=h.s),Wt(h.s<=Math.max(s.s,o.s)),zt.vertLeq(h,t.event)&&(h.s=t.event.s,h.t=t.event.t),f=zt.vertLeq(o,s)?o:s,zt.vertLeq(f,h)&&(h.s=f.s,h.t=f.t),zt.vertEq(h,o)||zt.vertEq(h,s)?(e.checkForRightSplice(t,r),!1):!zt.vertEq(l,t.event)&&zt.edgeSign(l,t.event,h)>=0||!zt.vertEq(c,t.event)&&zt.edgeSign(c,t.event,h)<=0?c===t.event?(t.mesh.splitEdge(n.Sym),t.mesh.splice(a.Sym,n),r=e.topLeftRegion(t,r),n=e.regionBelow(r).eUp,e.finishLeftRegions(t,e.regionBelow(r),i),e.addRightEdges(t,r,n.Oprev,n,n,!0),!0):l===t.event?(t.mesh.splitEdge(a.Sym),t.mesh.splice(n.Lnext,a.Oprev),i=r,r=e.topRightRegion(r),p=e.regionBelow(r).eUp.Rprev,i.eUp=a.Oprev,a=e.finishLeftRegions(t,i,null),e.addRightEdges(t,r,a.Onext,n.Rprev,p,!0),!0):(zt.edgeSign(l,t.event,h)>=0&&(e.regionAbove(r).dirty=r.dirty=!0,t.mesh.splitEdge(n.Sym),n.Org.s=t.event.s,n.Org.t=t.event.t),zt.edgeSign(c,t.event,h)<=0&&(r.dirty=i.dirty=!0,t.mesh.splitEdge(a.Sym),a.Org.s=t.event.s,a.Org.t=t.event.t),!1):(t.mesh.splitEdge(n.Sym),t.mesh.splitEdge(a.Sym),t.mesh.splice(a.Oprev,n),n.Org.s=h.s,n.Org.t=h.t,n.Org.pqHandle=t.pq.insert(n.Org),e.getIntersectData(t,n.Org,o,l,s,c),e.regionAbove(r).dirty=r.dirty=i.dirty=!0,!1)},e.walkDirtyRegions=function(t,r){for(var i=e.regionBelow(r),n,a;;){for(;i.dirty;)r=i,i=e.regionBelow(i);if(!r.dirty&&(i=r,r=e.regionAbove(r),r===null||!r.dirty))return;if(r.dirty=!1,n=r.eUp,a=i.eUp,n.Dst!==a.Dst&&e.checkForLeftSplice(t,r)&&(i.fixUpperEdge?(e.deleteRegion(t,i),t.mesh.delete(a),i=e.regionBelow(r),a=i.eUp):r.fixUpperEdge&&(e.deleteRegion(t,r),t.mesh.delete(n),r=e.regionAbove(i),n=r.eUp)),n.Org!==a.Org)if(n.Dst!==a.Dst&&!r.fixUpperEdge&&!i.fixUpperEdge&&(n.Dst===t.event||a.Dst===t.event)){if(e.checkForIntersect(t,r))return}else e.checkForRightSplice(t,r);n.Org===a.Org&&n.Dst===a.Dst&&(e.addWinding(a,n),e.deleteRegion(t,r),t.mesh.delete(n),r=e.regionAbove(i))}},e.connectRightVertex=function(t,r,i){var n,a=i.Onext,o=e.regionBelow(r),s=r.eUp,l=o.eUp,c=!1;if(s.Dst!==l.Dst&&e.checkForIntersect(t,r),zt.vertEq(s.Org,t.event)&&(t.mesh.splice(a.Oprev,s),r=e.topLeftRegion(t,r),a=e.regionBelow(r).eUp,e.finishLeftRegions(t,e.regionBelow(r),o),c=!0),zt.vertEq(l.Org,t.event)&&(t.mesh.splice(i,l.Oprev),i=e.finishLeftRegions(t,o,null),c=!0),c){e.addRightEdges(t,r,i.Onext,a,a,!0);return}zt.vertLeq(l.Org,s.Org)?n=l.Oprev:n=s,n=t.mesh.connect(i.Lprev,n),e.addRightEdges(t,r,n,n.Onext,n.Onext,!1),n.Sym.activeRegion.fixUpperEdge=!0,e.walkDirtyRegions(t,r)},e.connectLeftDegenerate=function(t,r,i){var n,a,o,s,l;if(n=r.eUp,zt.vertEq(n.Org,i)){Wt(!1),e.spliceMergeVertices(t,n,i.anEdge);return}if(!zt.vertEq(n.Dst,i)){t.mesh.splitEdge(n.Sym),r.fixUpperEdge&&(t.mesh.delete(n.Onext),r.fixUpperEdge=!1),t.mesh.splice(i.anEdge,n),e.sweepEvent(t,i);return}Wt(!1),r=e.topRightRegion(r),l=e.regionBelow(r),o=l.eUp.Sym,a=s=o.Onext,l.fixUpperEdge&&(Wt(a!==o),e.deleteRegion(t,l),t.mesh.delete(o),o=a.Oprev),t.mesh.splice(i.anEdge,o),zt.edgeGoesLeft(a)||(a=null),e.addRightEdges(t,r,o.Onext,s,a,!0)},e.connectLeftVertex=function(t,r){var i,n,a,o,s,l,c=new RC;if(c.eUp=r.anEdge.Sym,i=t.dict.search(c).key,n=e.regionBelow(i),!!n){if(o=i.eUp,s=n.eUp,zt.edgeSign(o.Dst,r,o.Org)===0){e.connectLeftDegenerate(t,i,r);return}if(a=zt.vertLeq(s.Dst,o.Dst)?i:n,i.inside||a.fixUpperEdge){if(a===i)l=t.mesh.connect(r.anEdge.Sym,o.Lnext);else{var d=t.mesh.connect(s.Dnext,r.anEdge);l=d.Sym}a.fixUpperEdge?e.fixUpperEdge(t,a,l):e.computeWinding(t,e.addRegionBelow(t,i,l)),e.sweepEvent(t,r)}else e.addRightEdges(t,i,r.anEdge,r.anEdge,null,!0)}},e.sweepEvent=function(t,r){t.event=r,e.debugEvent(t);for(var i=r.anEdge;i.activeRegion===null;)if(i=i.Onext,i===r.anEdge){e.connectLeftVertex(t,r);return}var n=e.topLeftRegion(t,i.activeRegion);Wt(n!==null);var a=e.regionBelow(n),o=a.eUp,s=e.finishLeftRegions(t,a,null);s.Onext===o?e.connectRightVertex(t,n,s):e.addRightEdges(t,n,s.Onext,o,o,!0)},e.addSentinel=function(t,r,i,n){var a=new RC,o=t.mesh.makeEdge();o.Org.s=i,o.Org.t=n,o.Dst.s=r,o.Dst.t=n,t.event=o.Dst,a.eUp=o,a.windingNumber=0,a.inside=!1,a.fixUpperEdge=!1,a.sentinel=!0,a.dirty=!1,a.nodeUp=t.dict.insert(a)},e.initEdgeDict=function(t){t.dict=new w3e(t,e.edgeLeq);var r=t.bmax[0]-t.bmin[0],i=t.bmax[1]-t.bmin[1],n=t.bmin[0]-r,a=t.bmax[0]+r,o=t.bmin[1]-i,s=t.bmax[1]+i;e.addSentinel(t,n,a,o),e.addSentinel(t,n,a,s)},e.doneEdgeDict=function(t){for(var r,i=0;(r=t.dict.min().key)!==null;)r.sentinel||(Wt(r.fixUpperEdge),Wt(++i===1)),Wt(r.windingNumber===0),e.deleteRegion(t,r)},e.removeDegenerateEdges=function(t){var r,i,n,a=t.mesh.eHead;for(r=a.next;r!==a;r=i)i=r.next,n=r.Lnext,zt.vertEq(r.Org,r.Dst)&&r.Lnext.Lnext!==r&&(e.spliceMergeVertices(t,n,r),t.mesh.delete(r),r=n,n=r.Lnext),n.Lnext===r&&(n!==r&&((n===i||n===i.Sym)&&(i=i.next),t.mesh.delete(n)),(r===i||r===i.Sym)&&(i=i.next),t.mesh.delete(r))},e.initPriorityQ=function(t){var r,i,n,a=0;for(n=t.mesh.vHead,i=n.next;i!==n;i=i.next)a++;for(a+=8,r=t.pq=new x3e(a,zt.vertLeq),n=t.mesh.vHead,i=n.next;i!==n;i=i.next)i.pqHandle=r.insert(i);return i!==n?!1:(r.init(),!0)},e.donePriorityQ=function(t){t.pq=null},e.removeDegenerateFaces=function(t,r){var i,n,a;for(i=r.fHead.next;i!==r.fHead;i=n)n=i.next,a=i.anEdge,Wt(a.Lnext!==a),a.Lnext.Lnext===a&&(e.addWinding(a.Onext,a),t.mesh.delete(a));return!0},e.computeInterior=function(t,r){r===void 0&&(r=!0);var i,n;if(e.removeDegenerateEdges(t),!e.initPriorityQ(t))return!1;for(e.initEdgeDict(t);(i=t.pq.extractMin())!==null;){for(;n=t.pq.min(),!(n===null||!zt.vertEq(n,i));)n=t.pq.extractMin(),e.spliceMergeVertices(t,i.anEdge,n.anEdge);e.sweepEvent(t,i)}return t.event=t.dict.min().key.eUp.Org,e.debugEvent(t),e.doneEdgeDict(t),e.donePriorityQ(t),e.removeDegenerateFaces(t,t.mesh)?(r&&t.mesh.check(),!0):!1},e}(),C3e=function(){function e(){this.mesh=new IL,this.normal=[0,0,0],this.sUnit=[0,0,0],this.tUnit=[0,0,0],this.bmin=[0,0],this.bmax=[0,0],this.windingRule=ti.ODD,this.dict=null,this.pq=null,this.event=null,this.vertexIndexCounter=0,this.vertices=[],this.vertexIndices=[],this.vertexCount=0,this.elements=[],this.elementCount=0}return e.prototype.dot_=function(t,r){return t[0]*r[0]+t[1]*r[1]+t[2]*r[2]},e.prototype.normalize_=function(t){var r=t[0]*t[0]+t[1]*t[1]+t[2]*t[2];if(!r)throw"Zero-size vector!";r=Math.sqrt(r),t[0]/=r,t[1]/=r,t[2]/=r},e.prototype.longAxis_=function(t){var r=0;return Math.abs(t[1])>Math.abs(t[0])&&(r=1),Math.abs(t[2])>Math.abs(t[r])&&(r=2),r},e.prototype.computeNormal_=function(t){var r,i,n,a,o,s,l=[0,0,0],c=[0,0,0],d=[0,0,0],u=[0,0,0],h=[0,0,0],f=[null,null,null],p=[null,null,null],v=this.mesh.vHead;r=v.next;for(var m=0;m<3;++m)a=r.coords[m],c[m]=a,p[m]=r,l[m]=a,f[m]=r;for(r=v.next;r!==v;r=r.next)for(var g=0;g<3;++g)a=r.coords[g],a<c[g]&&(c[g]=a,p[g]=r),a>l[g]&&(l[g]=a,f[g]=r);var y=0;if(l[1]-c[1]>l[0]-c[0]&&(y=1),l[2]-c[2]>l[y]-c[y]&&(y=2),c[y]>=l[y]){t[0]=0,t[1]=0,t[2]=1;return}for(s=0,i=p[y],n=f[y],d[0]=i.coords[0]-n.coords[0],d[1]=i.coords[1]-n.coords[1],d[2]=i.coords[2]-n.coords[2],r=v.next;r!==v;r=r.next)u[0]=r.coords[0]-n.coords[0],u[1]=r.coords[1]-n.coords[1],u[2]=r.coords[2]-n.coords[2],h[0]=d[1]*u[2]-d[2]*u[1],h[1]=d[2]*u[0]-d[0]*u[2],h[2]=d[0]*u[1]-d[1]*u[0],o=h[0]*h[0]+h[1]*h[1]+h[2]*h[2],o>s&&(s=o,t[0]=h[0],t[1]=h[1],t[2]=h[2]);s<=0&&(t[0]=t[1]=t[2]=0,t[this.longAxis_(d)]=1)},e.prototype.checkOrientation_=function(){for(var t=this.mesh.fHead,r,i=this.mesh.vHead,n,a=0,o=t.next;o!==t;o=o.next)if(n=o.anEdge,!(n.winding<=0))do a+=(n.Org.s-n.Dst.s)*(n.Org.t+n.Dst.t),n=n.Lnext;while(n!==o.anEdge);if(a<0){for(r=i.next;r!==i;r=r.next)r.t=-r.t;this.tUnit[0]=-this.tUnit[0],this.tUnit[1]=-this.tUnit[1],this.tUnit[2]=-this.tUnit[2]}},e.prototype.projectPolygon_=function(){var t=this.mesh.vHead,r=[0,0,0],i,n,a=!1;r[0]=this.normal[0],r[1]=this.normal[1],r[2]=this.normal[2],!r[0]&&!r[1]&&!r[2]&&(this.computeNormal_(r),a=!0),i=this.sUnit,n=this.tUnit;var o=this.longAxis_(r);i[o]=0,i[(o+1)%3]=1,i[(o+2)%3]=0,n[o]=0,n[(o+1)%3]=0,n[(o+2)%3]=r[o]>0?1:-1;for(var s=t.next;s!==t;s=s.next)s.s=this.dot_(s.coords,i),s.t=this.dot_(s.coords,n);a&&this.checkOrientation_();for(var l=!0,c=t.next;c!==t;c=c.next)l?(this.bmin[0]=this.bmax[0]=c.s,this.bmin[1]=this.bmax[1]=c.t,l=!1):(c.s<this.bmin[0]&&(this.bmin[0]=c.s),c.s>this.bmax[0]&&(this.bmax[0]=c.s),c.t<this.bmin[1]&&(this.bmin[1]=c.t),c.t>this.bmax[1]&&(this.bmax[1]=c.t))},e.prototype.addWinding_=function(t,r){t.winding+=r.winding,t.Sym.winding+=r.Sym.winding},e.prototype.tessellateMonoRegion_=function(t,r){var i,n;if(i=r.anEdge,!(i.Lnext!==i&&i.Lnext.Lnext!==i))throw"Mono region invalid";for(;zt.vertLeq(i.Dst,i.Org);i=i.Lprev);for(;zt.vertLeq(i.Org,i.Dst);i=i.Lnext);n=i.Lprev;for(var a=void 0;i.Lnext!==n;)if(zt.vertLeq(i.Dst,n.Org)){for(;n.Lnext!==i&&(zt.edgeGoesLeft(n.Lnext)||zt.edgeSign(n.Org,n.Dst,n.Lnext.Dst)<=0);)a=t.connect(n.Lnext,n),n=a.Sym;n=n.Lprev}else{for(;n.Lnext!==i&&(zt.edgeGoesRight(i.Lprev)||zt.edgeSign(i.Dst,i.Org,i.Lprev.Org)>=0);)a=t.connect(i,i.Lprev),i=a.Sym;i=i.Lnext}if(n.Lnext===i)throw"Mono region invalid";for(;n.Lnext.Lnext!==i;)a=t.connect(n.Lnext,n),n=a.Sym;return!0},e.prototype.tessellateInterior_=function(t){for(var r,i=t.fHead.next;i!==t.fHead;i=r)if(r=i.next,i.inside&&!this.tessellateMonoRegion_(t,i))return!1;return!0},e.prototype.discardExterior_=function(t){for(var r,i=t.fHead.next;i!==t.fHead;i=r)r=i.next,i.inside||t.zapFace(i)},e.prototype.setWindingNumber_=function(t,r,i){for(var n,a=t.eHead.next;a!==t.eHead;a=n)n=a.next,a.Rface.inside!==a.Lface.inside?a.winding=a.Lface.inside?r:-r:i?t.delete(a):a.winding=0},e.prototype.getNeighbourFace_=function(t){return!t.Rface||!t.Rface.inside?-1:t.Rface.n},e.prototype.outputPolymesh_=function(t,r,i,n){var a,o=0,s=0,l;i>3&&t.mergeConvexFaces(i);for(var c=t.vHead.next;c!==t.vHead;c=c.next)c.n=-1;for(var d=t.fHead.next;d!==t.fHead;d=d.next)if(d.n=-1,!!d.inside){a=d.anEdge,l=0;do{var c=a.Org;c.n===-1&&(c.n=s,s++),l++,a=a.Lnext}while(a!==d.anEdge);if(l>i)throw"Face vertex greater that support polygon";d.n=o,++o}this.elementCount=o,r===an.CONNECTED_POLYGONS&&(o*=2),this.elements=[],this.elements.length=o*i,this.vertexCount=s,this.vertices=[],this.vertices.length=s*n,this.vertexIndices=[],this.vertexIndices.length=s;for(var c=t.vHead.next;c!==t.vHead;c=c.next)if(c.n!==-1){var u=c.n*n;this.vertices[u+0]=c.coords[0],this.vertices[u+1]=c.coords[1],n>2&&(this.vertices[u+2]=c.coords[2]),this.vertexIndices[c.n]=c.idx}for(var h=0,d=t.fHead.next;d!==t.fHead;d=d.next)if(d.inside){a=d.anEdge,l=0;do{var c=a.Org;this.elements[h++]=c.n,l++,a=a.Lnext}while(a!==d.anEdge);for(var f=l;f<i;++f)this.elements[h++]=-1;if(r===an.CONNECTED_POLYGONS){a=d.anEdge;do this.elements[h++]=this.getNeighbourFace_(a),a=a.Lnext;while(a!==d.anEdge);for(var p=l;p<i;++p)this.elements[h++]=-1}}},e.prototype.outputContours_=function(t,r){var i,n,a=0,o=0;this.vertexCount=0,this.elementCount=0;for(var s=t.fHead.next;s!==t.fHead;s=s.next)if(s.inside){n=i=s.anEdge;do this.vertexCount++,i=i.Lnext;while(i!==n);this.elementCount++}this.elements=[],this.elements.length=this.elementCount*2,this.vertices=[],this.vertices.length=this.vertexCount*r,this.vertexIndices=[],this.vertexIndices.length=this.vertexCount;var l=0,c=0,d=0;a=0;for(var s=t.fHead.next;s!==t.fHead;s=s.next)if(s.inside){o=0,n=i=s.anEdge;do this.vertices[l++]=i.Org.coords[0],this.vertices[l++]=i.Org.coords[1],r>2&&(this.vertices[l++]=i.Org.coords[2]),this.vertexIndices[c++]=this.vertexIdCallback?this.vertexIdCallback(i):i.Org.idx,o++,i=i.Lnext;while(i!==n);this.elements[d++]=a,this.elements[d++]=o,a+=o}},e.prototype.addContour=function(t,r){this.mesh===null&&(this.mesh=new IL),t<2&&(t=2),t>3&&(t=3);for(var i=null,n=0;n<r.length;n+=t)i===null?(i=this.mesh.makeEdge(),this.mesh.splice(i,i.Sym)):(this.mesh.splitEdge(i),i=i.Lnext),i.Org.coords[0]=r[n+0],i.Org.coords[1]=r[n+1],t>2?i.Org.coords[2]=r[n+2]:i.Org.coords[2]=0,i.Org.idx=this.vertexIndexCounter++,this.edgeCreateCallback&&this.edgeCreateCallback(i),i.winding=1,i.Sym.winding=-1},e.prototype.tesselate=function(t,r,i,n,a,o){if(t===void 0&&(t=ti.ODD),r===void 0&&(r=an.POLYGONS),o===void 0&&(o=!0),this.vertices=[],this.elements=[],this.vertexIndices=[],this.vertexIndexCounter=0,a&&(this.normal[0]=a[0],this.normal[1]=a[1],this.normal[2]=a[2]),this.windingRule=t,n<2&&(n=2),n>3&&(n=3),!this.mesh)return!1;this.projectPolygon_(),S3e.computeInterior(this,o);var s=this.mesh;return r===an.BOUNDARY_CONTOURS?this.setWindingNumber_(s,1,!0):this.tessellateInterior_(s),o&&s.check(),r===an.BOUNDARY_CONTOURS?this.outputContours_(s,n):this.outputPolymesh_(s,r,i,n),!0},e}();function ad(e){var t=e.windingRule,r=t===void 0?ti.ODD:t,i=e.elementType,n=i===void 0?an.POLYGONS:i,a=e.polySize,o=a===void 0?3:a,s=e.vertexSize,l=s===void 0?2:s,c=e.normal,d=c===void 0?[0,0,1]:c,u=e.contours,h=u===void 0?[]:u,f=e.strict,p=f===void 0?!0:f,v=e.debug,m=v===void 0?!1:v;if(!h&&p)throw new Error("Contours can't be empty");if(h){var g=new C3e;e.edgeCreateCallback&&(g.edgeCreateCallback=e.edgeCreateCallback),e.vertexIdCallback&&(g.vertexIdCallback=e.vertexIdCallback);for(var y=0;y<h.length;y++)g.addContour(l||2,h[y]);return g.tesselate(r,n,o,l,d,p),{vertices:g.vertices,vertexIndices:g.vertexIndices,vertexCount:g.vertexCount,elements:g.elements,elementCount:g.elementCount,mesh:m?g.mesh:void 0}}}ti.ODD;ti.NONZERO;ti.POSITIVE;ti.NEGATIVE;ti.ABS_GEQ_TWO;an.POLYGONS;an.CONNECTED_POLYGONS;an.BOUNDARY_CONTOURS;var VM=class{constructor(e=256,t=!1){this.capacity=e,this.size=0,this.debug=t,this.debug&&console.log(`allocating with cap ${e}`);let r=e*VM.eSize;this.buffer=new ArrayBuffer(r);let i=Float32Array.BYTES_PER_ELEMENT,n=0;this.positions=new Float32Array(this.buffer,n*i,3*e),n+=3*e,this.normals=new Float32Array(this.buffer,n*i,3*e),n+=3*e,this.uvs=new Float32Array(this.buffer,n*i,2*e)}realloc(e,t=!1){if(e<this.size)throw Error("cannot shrink buffer");if(e<=this.capacity&&!t)return;this.debug&&console.log(`resizing from ${this.capacity} → ${e}`);let r=e*VM.eSize,i=new ArrayBuffer(r),n=Float32Array.BYTES_PER_ELEMENT,a=0,o=new Float32Array(i,a*n,3*e);a+=3*e;let s=new Float32Array(i,a*n,3*e);a+=3*e;let l=new Float32Array(i,a*n,2*e);t?(o.set(this.positions.subarray(0,this.size*3)),s.set(this.normals.subarray(0,this.size*3)),l.set(this.uvs.subarray(0,this.size*2))):(o.set(this.positions),s.set(this.normals),l.set(this.uvs)),this.buffer=i,this.positions=o,this.normals=s,this.uvs=l,this.capacity=e}get(e=1){let t=this.size+e;if(t>this.capacity){let i=this.capacity;for(;t>i;)i*=2;this.realloc(i)}let r=this.size;return this.size=t,r}reserve(e){let t=this.size+e;t>this.capacity&&this.realloc(t)}shrink(){this.debug&&console.log(`shrinking ${this.capacity} → ${this.size}`),this.realloc(this.size,!0)}},E8=VM;E8.eSize=8*Float32Array.BYTES_PER_ELEMENT;var _3e=fc(Pme()),qP={vertices:[160,160,-160,160,-160,-160,160,-160],vertexIndices:[1,0,3,2],vertexCount:4,elements:[0,4],elementCount:1,mesh:void 0},T8={vertices:[],vertexIndices:[],vertexCount:0,elements:[],elementCount:0,mesh:void 0},P8={vertices:[-160,160,160,-160,160,160,-160,-160],vertexIndices:[1,3,0,2],vertexCount:4,elements:[0,1,2,1,0,3],elementCount:2,mesh:void 0},IC=(e,t)=>([r,i])=>(i<r&&(i+=t),(e>=r?e:e+t)<=i),YP=class extends Ot{constructor(e,t,r=0,i=12,n=3,a=ti.ODD,o=!1){super(),this.forPathBevel=o,this.type="ShapeGeometry",this.vertexCache={},this._shape=e,this._depth=t,this._curveSegments=i,this._bevelSegmentsInput=n;let s=this._shape.extractShapePointsToFlatArray([],i),l=this._shape.shapeHoles.map(A=>{let M=A.extractShapePointsToFlatArray([],i),P=[];for(let T=M.length-1;T>=1;T-=2){let R=M[T-1],z=M[T-0];P.push(R,z)}return P}),c=[],d=[];for(let A=0;A<s.length;A+=2)d.push([s[A],s[A+1]]);c.push(d);for(let A=0;A<l.length;A++){let M=l[A],P=[];for(let T=0;T<M.length;T+=2)P.push([M[T],M[T+1]]);c.push(P)}let u;e.isText?u=new Gj().setFromPoints(e.points.map(A=>A.position)).getSize(new ye).length()*.1:c[0].length===0?u=r:u=(0,_3e.default)(c).distance,r<=0?(this._bevel=0,this._bevelSegments=0):(this._bevel=Math.min(r,u,t/2),this._bevelSegments=Math.floor(n));let h;try{h=ad({windingRule:a,elementType:an.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[s]})}catch{h=qP}let f;try{f=ad({windingRule:ti.ODD,elementType:an.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[...l]})}catch{f=T8}if(!h)throw new Error("error generating geometry");let p=h.elementCount;if(f){h.elementCount+=f.elementCount;for(let A=0;A<f.elements.length;A++){let M=f.elements[A],P=A%2===0?h.vertexCount:0;h.elements.push(M+P)}for(let A=0;A<f.vertexIndices.length;A++){let M=f.vertexIndices[A],P=h.vertexCount;h.vertexIndices.push(M+P)}for(let A=0;A<f.vertices.length;A++){let M=f.vertices[A];h.vertices.push(M)}}let v=1/0,m=-1/0,g=1/0,y=-1/0;for(let A=0,M=h.vertexCount;A<M;A++){let P=A*2,T=h.vertices[P+0],R=h.vertices[P+1];T<v&&(v=T),T>m&&(m=T),R<g&&(g=R),R>y&&(y=R)}this._minX=v,this._minY=g,this._width=m-v,this._height=y-g,this._buffer=new E8(this._computeBufferEstimatedSize(h));let b=[],x=[];for(let A=h.elementCount-1;A>=0;A--){let M=A>=p,P=A*2,T=h.elements[P+0],R=h.elements[P+1],z=T+R,F={start:T,count:R,normals:[],continuous:[],concave:[]},H=T,N=z-1,U=T+1,ie=this._shape.roundedCurves.length;do{let $=H-T,le=h.vertices[N*2+0],ee=h.vertices[N*2+1],Q=h.vertices[H*2+0],ne=h.vertices[H*2+1],V=h.vertices[U*2+0],de=h.vertices[U*2+1],me=Q-le,Ce=ne-ee,G=Math.sqrt(me*me+Ce*Ce);me/=G,Ce/=G;let Z=Q-V,ue=ne-de,Se=Math.sqrt(Z*Z+ue*ue);Z/=Se,ue/=Se,F.normals[$*2+0]=-ue,F.normals[$*2+1]=Z,F.concave[$]=me*ue-Ce*Z>0;let we=h.vertexIndices[H];if(Array.isArray(we))F.continuous[$]=!1;else{let[_e,Ee]=this._shape.getCurveIndexFromVertexId(we-1,!0);if(Ee>0&&Ee<1)F.continuous[$]=!0;else{let fe=Ee===1?_e+1:_e-1;fe=(fe+ie)%ie;let B=Ee===1?0:1,D=this._shape.roundedCurves[_e].getTangent(Ee),I=this._shape.roundedCurves[fe].getTangent(B);F.continuous[$]=D.dot(I)>.95}}M&&(F.normals[$*2+0]*=-1,F.normals[$*2+1]*=-1),[N,H,U]=[H,U,U+1],U>=z&&(U-=R)}while(U!==T+1);let te=[];te.push({bevelI:0,angle:0,size:0,boundary:{vertices:h.vertices.slice(T*2,z*2),vertexCount:R,vertexIndices:new Array(R).fill(!0).map(($,le)=>[le,le]),elements:[0,R],elementCount:1,mesh:null},reverseMap:[],insetPoints:h.vertices.slice(T*2,z*2)});let X=0;for(let $=1;$<=this._bevelSegments;$++){let le=$/this._bevelSegments*Math.PI/2,ee=(1-Math.cos(le))*this._bevel,Q=[],ne=[],V=0;for(let me=0;me<R;me++){let Ce=me*2,G=(me-1+R)%R*2,Z=h.vertices[F.start*2+Ce+0],ue=h.vertices[F.start*2+Ce+1],Se=-F.normals[G+0]*ee,we=-F.normals[G+1]*ee,_e=-F.normals[Ce+0]*ee,Ee=-F.normals[Ce+1]*ee;if(F.concave[me]||!F.concave[me]&&M){let fe=Math.atan2(we,Se),B=Math.atan2(Ee,_e);B>fe&&(B-=Math.PI*2);let D=B-fe;if(F.continuous[me]||M){let I=fe+D/2,O=Math.cos(I)*ee,j=Math.sin(I)*ee;Q[2*V+0]=Z+O*(M?-1:1),Q[2*V+1]=ue+j*(M?-1:1),ne[V]=me,V++}else{let I=Math.max(1,Math.floor(i/4*Math.abs(D)/Math.PI));for(let O=0;O<=I;O++){let j=fe+D*(O/I),L=Math.cos(j)*ee,Ae=Math.sin(j)*ee;Q[2*V+0]=Z+L,Q[2*V+1]=ue+Ae,ne[V]=me,V++}}}else Q[2*V+0]=Z+Se,Q[2*V+1]=ue+we,ne[V]=me,V++,Q[2*V+0]=Z,Q[2*V+1]=ue,ne[V]=me,V++,Q[2*V+0]=Z+_e,Q[2*V+1]=ue+Ee,ne[V]=me,V++}let de=ad({windingRule:ti.POSITIVE,elementType:an.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[Q],edgeCreateCallback:me=>{let Ce=me.Org.idx,G=ne[Ce],Z=ne[(Ce+1)%ne.length];me.idx=[G,Z],me.Sym.idx=[Z,G]},vertexIdCallback:me=>{let Ce=me.Lprev.idx;return[Ce?Ce[1]:0,me.idx?me.idx[0]:0]}});if(!de)throw console.log("Error"),new Error(`error generating bevel geometry for ${$}'th loop`);if(!de.vertexCount){let me=($-1)/this._bevelSegments*Math.PI/2;X=(1-Math.sin(me))*this._bevel;break}for(let me=0;me<de.vertexIndices.length;me++){let[Ce,G]=de.vertexIndices[me];if(Ce===G)continue;let Z=G;G<Ce&&(Z+=R);for(let ue=Ce;ue<Z;ue++){let Se=ue%R,we=(ue+1)%R;if(!F.continuous[Se]||!F.continuous[we]){de.vertexIndices[me]=[Ce,Se],de.vertexIndices.splice(me+1,0,[we,G]),de.vertices.splice((me+1)*2,0,de.vertices[me*2],de.vertices[me*2+1]);break}}}te.push({bevelI:$,angle:le,size:ee,boundary:de,reverseMap:ne,insetPoints:Q})}let W=($,le,ee)=>{let Q=0,ne=$.boundary.vertexIndices.length;for(;Q<ne&&ee($.boundary.vertexIndices[le]);)le=(le+1)%ne,Q++;return Q},q=b.length;for(let $=1;$<te.length;$++){let le=te[$-1],ee=te[$],Q=le.boundary.vertexIndices.length,ne=ee.boundary.vertexIndices.length;if(!Q||!ne)break;let V=F.concave.length,de=0,me=IC(de,R);for(;!le.boundary.vertexIndices.filter(me).length||!ee.boundary.vertexIndices.filter(me).length;)de++,me=IC(de,R);let Ce=le.boundary.vertexIndices.findIndex(me),G=ee.boundary.vertexIndices.findIndex(me);do Ce=(Ce+1)%Q;while(me(le.boundary.vertexIndices[Ce]));do G=(G+1)%ne;while(me(ee.boundary.vertexIndices[G]));de=(de+1)%R;let Z=de,ue=0,Se=this._buildBevelVert(F,le,(Ce-1+Q)%Q,void 0,ue),we=this._buildBevelVert(F,ee,(G-1+ne)%ne,void 0,ue),_e=Se,Ee=we,fe,B,D=!1;do{ue=(de||V)/V,me=IC(de,R);let I=W(le,Ce,me),O=W(ee,G,me),j=D;if(D=!1,I&&!O){for(let L=0;L<I;L++)fe=this._buildBevelVert(F,le,(Ce+L)%Q,L/(I-1),ue),b.push(_e.topN,fe.topP,Ee.topN),o===!1&&b.push(fe.bottomP,_e.bottomN,Ee.bottomN),_e=fe;D=!0}else if(!I&&O)for(let L=0;L<O;L++)B=this._buildBevelVert(F,ee,(G+L)%ne,L/(O-1),ue),b.push(Ee.topN,_e.topP,B.topP),o===!1&&b.push(_e.bottomP,Ee.bottomN,B.bottomP),Ee=B;else if(I&&O)if(fe=this._buildBevelVert(F,le,Ce,0,ue),B=this._buildBevelVert(F,ee,G,0,ue),j?(b.push(_e.topN,B.topP,Ee.topN),b.push(_e.topN,fe.topP,B.topP),o===!1&&(b.push(B.bottomP,_e.bottomN,Ee.bottomN),b.push(B.bottomP,fe.bottomP,_e.bottomN))):(b.push(Ee.topN,_e.topN,fe.topP),b.push(Ee.topN,fe.topP,B.topP),o===!1&&(b.push(fe.bottomP,_e.bottomN,Ee.bottomN),b.push(fe.bottomP,Ee.bottomN,B.bottomP))),_e=fe,Ee=B,I===O)for(let L=1;L<I;L++)fe=this._buildBevelVert(F,le,(Ce+L)%Q,L/(I-1),ue),B=this._buildBevelVert(F,ee,(G+L)%ne,L/(O-1),ue),b.push(_e.topN,fe.topP,Ee.topN),b.push(Ee.topN,fe.topP,B.topP),o===!1&&(b.push(fe.bottomP,_e.bottomN,Ee.bottomN),b.push(fe.bottomP,Ee.bottomN,B.bottomP)),_e=fe,Ee=B;else if(I>O){let L=I/O,Ae=0;for(let We=1;We<I;We++)fe=this._buildBevelVert(F,le,(Ce+We)%Q,We/(I-1),ue),b.push(_e.topN,fe.topP,Ee.topN),o===!1&&b.push(fe.bottomP,_e.bottomN,Ee.bottomN),_e=fe,We>(Ae+1)*L&&(Ae++,B=this._buildBevelVert(F,ee,(G+Ae)%ne,Ae/(O-1),ue),b.push(Ee.topN,fe.topP,B.topP),o===!1&&b.push(fe.bottomP,Ee.bottomN,B.bottomP),Ee=B)}else{let L=O/I,Ae=0;for(let We=1;We<O;We++)B=this._buildBevelVert(F,ee,(G+We)%ne,We/(O-1),ue),b.push(Ee.topN,fe.topP,B.topP),o===!1&&b.push(fe.bottomP,Ee.bottomN,B.bottomP),Ee=B,We>(Ae+1)*L&&(Ae++,fe=this._buildBevelVert(F,le,(Ce+Ae)%Q,Ae/(I-1),ue),b.push(_e.topN,fe.topP,Ee.topN),o===!1&&b.push(fe.bottomP,_e.bottomN,Ee.bottomN),_e=fe)}Ce=(Ce+I)%Q,G=(G+O)%ne,de=(de+1)%V}while(de!==Z)}if(o===!1&&this._depth>this._bevel*2&&this._buildWall(te,F,b),M){let $=[];for(let le=b.length-1;le>=q+2;le-=3){let ee=b[le-2],Q=b[le-1],ne=b[le-0];$.push(ne,Q,ee)}b.splice(q,b.length-q,...$)}if(M){let $=[];for(let le=te[te.length-1].boundary.vertices.length-1;le>=1;le-=2){let ee=te[te.length-1].boundary.vertices[le-1],Q=te[te.length-1].boundary.vertices[le-0];$.push(ee,Q)}x.push($)}if(!M){let $=te[te.length-1],le;try{le=ad({windingRule:te.length>1?ti.POSITIVE:ti.ODD,elementType:an.POLYGONS,vertexSize:2,strict:!0,contours:[$.insetPoints,...x]})}catch{le=P8}if(!le)throw new Error("Error generating geometry for surface");l.length===0&&this._bevel<u&&Object.assign(this,{useNgonForTopBottomFaceDuringBake:!0});for(let ee=0;ee<le.elementCount*3;ee+=3){let Q=this._buildSurfaceVert(le,le.elements[ee+0],X),ne=this._buildSurfaceVert(le,le.elements[ee+1],X),V=this._buildSurfaceVert(le,le.elements[ee+2],X);b.push(Q.top,ne.top,V.top),o===!1&&b.push(V.bottom,ne.bottom,Q.bottom)}}this.vertexCache={}}this._buffer.shrink();let S=new $t(Uint32Array.from(b),1),w=new $t(this._buffer.positions,3),_=new $t(this._buffer.normals,3),C=new $t(this._buffer.uvs,2);w.needsUpdate=!0,_.needsUpdate=!0,C.needsUpdate=!0,S.needsUpdate=!0,this.setAttribute("position",w),this.setAttribute("normal",_),this.setAttribute("uv",C),this.setIndex(S)}_computeBufferEstimatedSize(e){return e.vertexCount*2*(2+this._bevelSegments)}_buildWall(e,t,r){let i=e[0];for(let n=0,a=i.boundary.vertexCount;n<a;n++){let o=this._buildBevelVert(t,i,n),s=this._buildBevelVert(t,i,(n+1)%a);r.push(s.topP,o.topN,o.bottomN),r.push(s.topP,o.bottomN,s.bottomP)}}_buildSurfaceVert(e,t,r){let i=t.toString();if(i in this.vertexCache)return this.vertexCache[i];let n=e.vertices[t*2+0],a=e.vertices[t*2+1],o=(n-this._minX)/this._width,s=(a-this._minY)/this._height;this.forPathBevel&&(s=1);let l=this._buffer.get(this.forPathBevel?1:2),c=l*3,d=l*2,u={top:l+0,bottom:l+1};return this._buffer.positions[c+0]=n,this._buffer.positions[c+1]=a,this._buffer.positions[c+2]=this.forPathBevel?this._bevel:this._depth-r,this._buffer.normals[c+0]=0,this._buffer.normals[c+1]=0,this._buffer.normals[c+2]=1,this._buffer.uvs[d+0]=o,this._buffer.uvs[d+1]=s,this.forPathBevel===!1&&(this._buffer.positions[c+3]=n,this._buffer.positions[c+4]=a,this._buffer.positions[c+5]=r,this._buffer.normals[c+3]=0,this._buffer.normals[c+4]=0,this._buffer.normals[c+5]=-1,this._buffer.uvs[d+2]=o,this._buffer.uvs[d+3]=s),this.vertexCache[i]=u,u}_buildBevelVert(e,t,r,i=1,n){let a=`${t.bevelI}:${r}`;if(a in this.vertexCache&&n!==0&&n!==1&&(!n||n===this.vertexCache[a].pathBevelUCoord))return this.vertexCache[a];let[o,s]=t.boundary.vertexIndices[r],l,c,d,u;o!==s?(c=o,l=s,u=!1,d=e.continuous[c]&&e.continuous[l]):(l=o,c=(l-1+e.count)%e.count,u=e.concave[l]&&t.bevelI>0,d=e.continuous[l]||u);let h=Math.cos(t.angle),f=Math.sin(t.angle),p=r*2,v=l*2,m=c*2,g=t.boundary.vertices[p+0],y=t.boundary.vertices[p+1],b=(1-f)*this._bevel,x=(g-this._minX)/this._width,S=(y-this._minY)/this._height;this.forPathBevel&&(n!==void 0&&(x=n),S=1);let w=e.normals[v+0],_=e.normals[v+1],C=e.normals[m+0],A=e.normals[m+1];if(u){let z=C-w,F=A-_;w=w+z*(1-i),_=_+F*(1-i);let H=Math.sqrt(w*w+_*_);w/=H,_/=H}let M=this.forPathBevel?this._buffer.get(d?1:2):this._buffer.get(d?2:4),P=M*3,T=M*2,R={i:r,fi:l,topP:M+0,topN:M+0,bottomP:M+1,bottomN:M+1,pathBevelUCoord:n};return this._buffer.positions[P+0]=g,this._buffer.positions[P+1]=y,this._buffer.positions[P+2]=(this.forPathBevel?this._bevel:this._depth)-b,this._buffer.normals[P+0]=w*h,this._buffer.normals[P+1]=_*h,this._buffer.normals[P+2]=f,this._buffer.uvs[T+0]=x,this._buffer.uvs[T+1]=S,this.forPathBevel===!1&&(this._buffer.positions[P+3]=g,this._buffer.positions[P+4]=y,this._buffer.positions[P+5]=b,this._buffer.normals[P+3]=w*h,this._buffer.normals[P+4]=_*h,this._buffer.normals[P+5]=-f,this._buffer.uvs[T+2]=S,this._buffer.uvs[T+3]=x),d||(this.forPathBevel?(M+=1,P+=3,T+=2):(M+=2,P+=6,T+=4),R.topP=M+0,R.bottomP=M+1,this._buffer.positions[P+0]=g,this._buffer.positions[P+1]=y,this._buffer.positions[P+2]=(this.forPathBevel?this._bevel:this._depth)-b,this._buffer.normals[P+0]=C*h,this._buffer.normals[P+1]=A*h,this._buffer.normals[P+2]=f,this._buffer.uvs[T+0]=x,this._buffer.uvs[T+1]=S,this.forPathBevel===!1&&(this._buffer.positions[P+3]=g,this._buffer.positions[P+4]=y,this._buffer.positions[P+5]=b,this._buffer.normals[P+3]=C*h,this._buffer.normals[P+4]=A*h,this._buffer.normals[P+5]=-f,this._buffer.uvs[T+2]=S,this._buffer.uvs[T+3]=x)),this.vertexCache[a]=R,R}clone(){let e=new YP(this._shape,this._depth,this._bevel,this._curveSegments,this._bevelSegmentsInput);return e.userData=ow(this.userData),e}},D8=class extends Ot{constructor(e,t=12,r={}){super(),this.type="ShapeGeometry",this.windingRule=ti.ODD,this.elementType=an.POLYGONS,this.polySize=3,this.vertexSize=2,this.strict=!0,this._shape=e,this._curveSegments=t,this._triangulationOptions=Object.assign({windingRule:ti.ODD,elementType:an.POLYGONS,polySize:3,vertexSize:2,strict:!0},r);let i=this._shape.extractShapePointsToFlatArray([],this._curveSegments),n=this._shape.shapeHoles.map(h=>h.extractShapePointsToFlatArray([],this._curveSegments)),a,o=!0,s=!0,l,c;for(let h=0,f=i.length/2;h<f;h++){let p=h*2,v=i[p+0],m=i[p+1];if(l!==void 0&&v!==l&&(o=!1),c!==void 0&&m!==c&&(s=!1),l=v,c=m,!o&&!s)break}if(!o&&!s)try{a=ad({contours:[i,...n],windingRule:this._triangulationOptions.windingRule,elementType:this._triangulationOptions.elementType,polySize:this._triangulationOptions.polySize,vertexSize:this._triangulationOptions.vertexSize,strict:this._triangulationOptions.strict})}catch{a=qP}let d=(a==null?void 0:a.vertexCount)??1,u=(a==null?void 0:a.elementCount)??1;if(this._positionAttribute=new $t(new Float32Array(d*3),3),this._normalAttribute=new $t(new Float32Array(d*3),3),this._uvAttribute=new $t(new Float32Array(d*2),2),this._indexAttribute=new $t(new Uint32Array(u*3),1),a){let h=1/0,f=-1/0,p=1/0,v=-1/0;for(let y=0,b=d;y<b;y++){let x=y*2,S=a.vertices[x+0],w=a.vertices[x+1];S<h&&(h=S),S>f&&(f=S),w<p&&(p=w),w>v&&(v=w)}let m=f-h,g=v-p;for(let y=0,b=d;y<b;y++){let x=y*2,S=a.vertices[x+0],w=a.vertices[x+1],_=(S-h)/m,C=(w-p)/g;this._positionAttribute.setXYZ(y,S,w,0),this._normalAttribute.setXYZ(y,0,0,1),this._uvAttribute.setXY(y,_,C)}for(let y=0,b=u;y<b;y++){let x=y*3,S=a.elements[x+0],w=a.elements[x+1],_=a.elements[x+2];this._indexAttribute.setX(x+0,S),this._indexAttribute.setX(x+1,w),this._indexAttribute.setX(x+2,_)}}this.setAttribute("position",this._positionAttribute),this.setAttribute("normal",this._normalAttribute),this.setAttribute("uv",this._uvAttribute),this.setIndex(this._indexAttribute),this.setDrawRange(0,((a==null?void 0:a.elementCount)??1)*3)}clone(){let e=new D8(this._shape,this._curveSegments);return e.userData=ow(this.userData),e}},O8=class extends YP{constructor(e,t,r=0,i=12,n=3,a=ti.ODD){super(e,t,r,i,n,a),this.type="ShapeGeometry"}_computeBufferEstimatedSize(e){return e.vertexCount*2*(2+this._bevelSegments)}_buildWall(e,t,r){let i=e[0];for(let n=0,a=i.boundary.vertexCount;n<a;n++){let o=this._buildBevelVert(t,i,n),s=this._buildBevelVert(t,i,(n+1)%a);r.push(s.topP,o.topN,o.bottomN),r.push(s.topP,o.bottomN,s.bottomP)}}clone(){let e=new O8(this._shape,this._depth,this._bevel,this._curveSegments,this._bevelSegmentsInput);return e.userData=ow(this.userData),e}},_h=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var c,d;let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,subdivisions:40,roundness:0,extrudeBevelSize:0,extrudeBevelSegments:3,windingRule:ti.ODD},e.parameters),i=Math.abs(r.width),n=Math.abs(r.height??r.width),a=Math.abs(r.depth??0),o=e.shape??(t==null?void 0:t.shape),s=(o==null?void 0:o.roundness)??r.roundness;o!==void 0&&(o instanceof Bi?(o.width!==i||o.height!==n)&&o.applySize(i,n):o=new Bi(i,n).fromJSON(o),((c=e.parameters)==null?void 0:c.roundness)!==void 0&&((d=e.parameters)==null?void 0:d.roundness)>0&&o.update());let l=o??new Bi(i,n);return{parameters:Object.assign(r,{width:i,height:n,depth:a,roundness:s}),shape:l}}static build(e){let{depth:t,extrudeBevelSize:r,extrudeBevelSegments:i,subdivisions:n,roundness:a,windingRule:o}=e.parameters;e.shape.roundness=a;let s;return t<=0?s=new D8(e.shape,n,{windingRule:o}):s=new O8(e.shape,t,r,n,i,o),Object.assign(s,{userData:{...e,type:"VectorGeometry"}})}},R8=Math.PI*2,XP=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0,spikes:64,angle:360,innerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:1},e.parameters);return r.angle=St.clamp(r.angle,0,360),{shape:e.shape&&e.shape instanceof Bi?e.shape:new Bi,parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??0)})}}static build(e){let{width:t,height:r,spikes:i,angle:n,innerRadius:a,depth:o,extrudeBevelSize:s,extrudeBevelSegments:l}=e.parameters,c=e.shape,d=t*.5,u=r*.5,h=A3e(c,d,u,n*Math.PI/180,i,a);c.isClosed=!0,c.update();let f;return n===0?(f=new Ot,f.setAttribute("position",new yt([],3))):f=_h.create({shape:c,parameters:{subdivisions:h,depth:o,extrudeBevelSize:s,extrudeBevelSegments:l}}),Object.assign(f,{userData:{...e,type:"EllipseGeometry"}})}};function A3e(e,t,r,i,n,a){if(i>=R8)return n>30||n%4===0?(E3e(e,t,r,a),Math.round(n/4)):BL(e,i,n,t,r,a);i=Math.max(i,.001);let o={x:0,y:r},s=i+Math.PI*.5,l={x:Math.cos(s)*t,y:Math.sin(s)*r},c=b3e({px:o.x,py:o.y,cx:l.x,cy:l.y,rx:t,ry:r,largeArcFlag:i>Math.PI,sweepFlag:!0});return n>30||n%c.length===0?M3e(e,o.x,o.y,c,n,t,r,a):BL(e,i,n,t,r,a)}function M3e(e,t,r,i,n,a,o,s){let l=Math.round(n/i.length);e.addPoint(Yf(t,r));for(let c=0,d=i.length;c<d;c++){let u=i[c],h=e.points[c],f=Yf(u.x,u.y);h.controls[1].position.set(u.x1,u.y1),f.controls[0].position.set(u.x2,u.y2),e.addPoint(f)}return s>0?I8(e,a,o,s):e.addPoint(Yf(0,0)),l}function BL(e,t,r,i,n,a){let o=-t/r;for(let s=0;s<=r;s++){let l=o*s,c=Math.sin(l)*i,d=Math.cos(l)*n;e.addPoint(Yf(c,d))}return t<R8?a>0?I8(e,i,n,a):e.addPoint(Yf(0,0)):(e.removePoint(e.points[e.points.length-1]),a>0&&z8(e,i,n,a)),1}function E3e(e,t,r,i=0,n=0,a=0){let o=.5522847498,s=t*o,l=r*o;e.addPoint(My(n-t,a,n-t,a-l,n-t,a+l)),e.addPoint(My(n,a+r,n-s,a+r,n+s,a+r)),e.addPoint(My(n+t,a,n+t,a+l,n+t,a-l)),e.addPoint(My(n,a-r,n+s,a-r,n-s,a-r)),i>0&&z8(e,t,r,i)}function Yf(e,t){return new qf(St.generateUUID(),new ye(e,t))}function My(e,t,r,i,n,a){let o=Yf(e,t);return o.controls[0].position.set(r,i),o.controls[1].position.set(n,a),o}function I8(e,t,r,i){k8(e,t,r,i).forEach(n=>e.addPoint(n))}function z8(e,t,r,i){let n=k8(e,t,r,i),a=new Bi;n.forEach(o=>a.addPoint(o)),a.isClosed=!0,e.shapeHoles.push(a)}function k8(e,t,r,i){let n=i*t/100,a=n*(Math.abs(r)/Math.abs(t)),o=new ye(n/t,a/r),s=e.points.map(l=>{let c=l.clone();return c.uuid=St.generateUUID(),c}).reverse();return s.forEach(l=>{l.position.multiply(o);let c=l.controls[0].position.clone().multiply(o),d=l.controls[1].position.clone().multiply(o);l.controls[0].position.copy(d),l.controls[1].position.copy(c)}),s}var T3e=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,revolutions:2,segments:40,pathRadius:10,pathType:0,pathSegments:30,cornerRadius:30,cornerSegments:4},e.parameters),i=Math.abs(r.width),n=Math.abs(r.height??i),a=Math.abs(r.depth??i),o=Math.abs(Math.min(i,a))/2;return{parameters:Object.assign(r,{width:i,height:n,depth:a,radius:o,segments:Math.round(r.segments),pathSegments:Math.round(r.pathSegments),cornerSegments:Math.round(r.cornerSegments)})}}static build(e){let{width:t,height:r,depth:i,radius:n,revolutions:a,segments:o,pathRadius:s,pathType:l,pathSegments:c,cornerRadius:d,cornerSegments:u}=e.parameters,h=new L8(!1,t,r,i,n,a,o,s,l,c,d,u);return Object.assign(h,{userData:{...e,type:"HelixGeometry"}})}},zC=new Vf([0,0,0],1),L8=class extends Ot{constructor(e=!0,t=1,r=1,i=1,n=1,a=1,o=1,s=1,l=1,c=1,d=1,u=1){if(super(),a===0)return;let h=e&&a===1;h&&(u=0),d>100&&(d=100),d===0&&(u=0);let f=()=>new k,p=new k,v=f(),m=f(),g=f(),y,b,x,S,w,_,C,A,M=f(),P=f(),T=f(),R=f(),z=f(),F=f(),H=f(),N=f(),U=r-2*s+.001,ie=U/a,te=Math.ceil(o*a),X=te+1,W=U/te,q=-U/2,$=c+1,le=2*Math.PI/c,ee=Math.PI/2/u,Q=.01,ne=Math.min((1-d/100)*s,s-Q),V=s-ne,de=0,me=2,Ce=u*me+me,G=$*Ce/me,Z=G+$*X,ue=Math.max(0,$*(X+Ce)),[Se,we,_e]=[3,3,2].map(ze=>Array(ue*ze).fill(0)),Ee=[],fe=n-s;function B(ze,Je){let nt=Math.PI/2;_=Je*W,A=2*Math.PI*(_%ie)/ie+nt,_+=q,C=Math.sin(A)*fe,w=Math.cos(A)*fe,e?ze.set(w,C,_):ze.set(w,_,C)}B(p,-1e-10),B(v,0),M.copy(p),B(p,1);let D=p.distanceTo(v),I=h?0:V+ne,O=D*te+2*I,j=ne,L=O-I;for(let ze=0;ze<=te;ze++){B(m,ze),N.subVectors(m,M).normalize(),M.copy(m),F.copy(m).setComponent(+e+1,0).normalize(),H.crossVectors(N,F).normalize();let Je=ze===0,nt=ze===te,lt=Je?3*Math.PI/2:ee,dt=Je?j:L,vt=Je?$:Z,se=Je?0:ue-$,Le=N.clone().multiplyScalar(Je?-V:V).add(m),Ye=N.clone().multiplyScalar(Je?-1:1).normalize();for(let pe=0;pe<$;pe++){let Te=pe*le;if(P.addVectors(p.copy(F).multiplyScalar(s*Math.cos(Te)),v.copy(H).multiplyScalar(s*Math.sin(Te))),T.copy(P).normalize(),Je||nt){h||(de=se+pe,[0,1,2].forEach(ce=>{Se[de*3+ce]=Le.getComponent(ce),we[de*3+ce]=Ye.getComponent(ce)}),_e[de*2]=+nt,_e[de*2+1]=pe/c),v.copy(T).multiplyScalar(ne),g.addVectors(m,v);for(let ce=0;ce<u;ce++){let Re=ce*ee+lt;R.addVectors(p.copy(N).multiplyScalar(V*Math.sin(Re)),v.copy(T).multiplyScalar(V*Math.cos(Re))),z.copy(R).normalize(),v.addVectors(g,R),R.normalize(),de=vt+ce*$+pe,[0,1,2].forEach(at=>{Se[de*3+at]=v.getComponent(at),we[de*3+at]=z.getComponent(at)});let $e=+Je+Math.sin(Re);_e[de*2]=(dt+V*$e)/O,_e[de*2+1]=pe/c}}v.addVectors(m,P),de=G+ze*$+pe,[0,1,2].forEach(ce=>{Se[de*3+ce]=v.getComponent(ce),we[de*3+ce]=T.getComponent(ce)}),_e[de*2]=(I+ze*D)/O,_e[de*2+1]=pe/c}}let Ae=X+2*u+me,[We,je]=[+h,Ae-1];for(let ze=We;ze<=je-1;ze++){let Je=h&&ze===je-1;for(let nt=0;nt<$-1;nt++)y=ze*$+nt,b=y+1,x=(Je?nt:y)+$,S=(Je?nt+1:b)+$,ze===0?Ee.push(b,S,x):ze===Ae-2?Ee.push(y,b,x):Ee.push(y,b,x,b,S,x)}this.setIndex(Ee),this.setAttribute("position",new yt(Se,3)),this.setAttribute("normal",new yt(we,3)),this.setAttribute("uv",new yt(_e,2))}getClosedTorusIndicesForBooleanOrSubdiv(){let e=this.userData.parameters,t=Math.ceil(e.tubularSegments),r=e.radialSegments+1,i=Array.from(this.getIndex().array),n,a,o,s,l=6*(t-1)*e.radialSegments,c=t,d=c===t;for(let u=0;u<e.radialSegments;u++)n=c*r+u,a=n+1,o=(d?u:n)+r,s=(d?u+1:a)+r,i[l++]=n,i[l++]=a,i[l++]=o,i[l++]=a,i[l++]=s,i[l++]=o;return i.length=l,zC.array=i,zC.count=i.length,zC}},P3e=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,detail:0,corner:0,cornerSides:4},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(e){let{width:t,height:r,depth:i,detail:n,corner:a,cornerSides:o}=e.parameters,s=n===0&&a!==0?new B8(t*.5,a,o):new zj(t*.5,n);return s.scale(1,r/t,i/t),Object.assign(s,{userData:{...e,type:"IcosahedronGeometry"}})}},B8=class extends WP{constructor(e=1,t=.2,r=4){let i=(1+Math.sqrt(5))/2,n=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],a=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],o="IcosahedronGeometry";super(n,a,o,e,t,r),this.type=o}static fromJSON(e){return new B8(e.radius,e.corner,e.cornerSides)}},D3e=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var i;(((i=e.parameters)==null?void 0:i.points)??[]).forEach(n=>{Array.isArray(n)&&(n.x=n[0],n.y=n[1])});let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,segments:64,verticalSegments:64,points:[{x:0,y:-50,id:0},{x:50,y:-50,id:1},{x:50,y:50,id:2},{x:0,y:50,id:3}]},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(e){let{points:t,segments:r,verticalSegments:i}=e.parameters,n=new mx;n.moveTo(t[0].x,t[0].y),n.bezierCurveTo(t[1].x,t[1].y,t[2].x,t[2].y,t[3].x,t[3].y);let a=new Tj(n.extractPoints(i).shape,r);return a.rotateZ(Math.PI),Object.assign(a,{userData:{...e,type:"LatheGeometry"}})}},Es=new it,kC=new Yr,Ey=new k,Zx=class extends aa{constructor(){super(),this.uuid=St.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}applyMatrix4(e){let t=new sn().getNormalMatrix(e);for(let r=0,i=this.vertices.length;r<i;r++)this.vertices[r].applyMatrix4(e);for(let r=0,i=this.faces.length;r<i;r++){let n=this.faces[r];n.normal.applyMatrix3(t).normalize();for(let a=0,o=n.vertexNormals.length;a<o;a++)n.vertexNormals[a].applyMatrix3(t).normalize()}return this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this}rotateX(e){return Es.makeRotationX(e),this.applyMatrix4(Es),this}rotateY(e){return Es.makeRotationY(e),this.applyMatrix4(Es),this}rotateZ(e){return Es.makeRotationZ(e),this.applyMatrix4(Es),this}translate(e,t,r){return Es.makeTranslation(e,t,r),this.applyMatrix4(Es),this}scale(e,t,r){return Es.makeScale(e,t,r),this.applyMatrix4(Es),this}lookAt(e){return kC.lookAt(e),kC.updateMatrix(),this.applyMatrix4(kC.matrix),this}fromBufferGeometry(e){let t=this,r=e.index!==null?e.index:void 0,i=e.attributes;if(i.position===void 0)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;let n=i.position,a=i.normal,o=i.color,s=i.uv,l=i.uv2;l!==void 0&&(this.faceVertexUvs[1]=[]);for(let u=0;u<n.count;u++)t.vertices.push(new k().fromBufferAttribute(n,u)),o!==void 0&&t.colors.push(new Lt().fromBufferAttribute(o,u));function c(u,h,f,p){let v=o===void 0?[]:[t.colors[u].clone(),t.colors[h].clone(),t.colors[f].clone()],m=a===void 0?[]:[new k().fromBufferAttribute(a,u),new k().fromBufferAttribute(a,h),new k().fromBufferAttribute(a,f)],g=new HM(u,h,f,m,v,p);t.faces.push(g),s!==void 0&&t.faceVertexUvs[0].push([new ye().fromBufferAttribute(s,u),new ye().fromBufferAttribute(s,h),new ye().fromBufferAttribute(s,f)]),l!==void 0&&t.faceVertexUvs[1].push([new ye().fromBufferAttribute(l,u),new ye().fromBufferAttribute(l,h),new ye().fromBufferAttribute(l,f)])}let d=e.groups;if(d.length>0)for(let u=0;u<d.length;u++){let h=d[u],f=h.start,p=h.count;for(let v=f,m=f+p;v<m;v+=3)r!==void 0?c(r.getX(v),r.getX(v+1),r.getX(v+2),h.materialIndex):c(v,v+1,v+2,h.materialIndex)}else if(r!==void 0)for(let u=0;u<r.count;u+=3)c(r.getX(u),r.getX(u+1),r.getX(u+2));else for(let u=0;u<n.count;u+=3)c(u,u+1,u+2);return this.computeFaceNormals(),e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Ey).negate(),this.translate(Ey.x,Ey.y,Ey.z),this}normalize(){this.computeBoundingSphere();let e=this.boundingSphere.center,t=this.boundingSphere.radius,r=t===0?1:1/t,i=new it;return i.set(r,0,0,-r*e.x,0,r,0,-r*e.y,0,0,r,-r*e.z,0,0,0,1),this.applyMatrix4(i),this}computeFaceNormals(){let e=new k,t=new k;for(let r=0,i=this.faces.length;r<i;r++){let n=this.faces[r],a=this.vertices[n.a],o=this.vertices[n.b],s=this.vertices[n.c];e.subVectors(s,o),t.subVectors(a,o),e.cross(t),e.normalize(),n.normal.copy(e)}}computeVertexNormals(e=!0){let t=new Array(this.vertices.length);for(let r=0,i=this.vertices.length;r<i;r++)t[r]=new k;if(e){let r=new k,i=new k;for(let n=0,a=this.faces.length;n<a;n++){let o=this.faces[n],s=this.vertices[o.a],l=this.vertices[o.b],c=this.vertices[o.c];r.subVectors(c,l),i.subVectors(s,l),r.cross(i),t[o.a].add(r),t[o.b].add(r),t[o.c].add(r)}}else{this.computeFaceNormals();for(let r=0,i=this.faces.length;r<i;r++){let n=this.faces[r];t[n.a].add(n.normal),t[n.b].add(n.normal),t[n.c].add(n.normal)}}for(let r=0,i=this.vertices.length;r<i;r++)t[r].normalize();for(let r=0,i=this.faces.length;r<i;r++){let n=this.faces[r],a=n.vertexNormals;a.length===3?(a[0].copy(t[n.a]),a[1].copy(t[n.b]),a[2].copy(t[n.c])):(a[0]=t[n.a].clone(),a[1]=t[n.b].clone(),a[2]=t[n.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)}computeFlatVertexNormals(){this.computeFaceNormals();for(let e=0,t=this.faces.length;e<t;e++){let r=this.faces[e],i=r.vertexNormals;i.length===3?(i[0].copy(r.normal),i[1].copy(r.normal),i[2].copy(r.normal)):(i[0]=r.normal.clone(),i[1]=r.normal.clone(),i[2]=r.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)}computeMorphNormals(){for(let t=0,r=this.faces.length;t<r;t++){let i=this.faces[t];i.__originalFaceNormal?i.__originalFaceNormal.copy(i.normal):i.__originalFaceNormal=i.normal.clone(),i.__originalVertexNormals||(i.__originalVertexNormals=[]);for(let n=0,a=i.vertexNormals.length;n<a;n++)i.__originalVertexNormals[n]?i.__originalVertexNormals[n].copy(i.vertexNormals[n]):i.__originalVertexNormals[n]=i.vertexNormals[n].clone()}let e=new Zx;e.faces=this.faces;for(let t=0,r=this.morphTargets.length;t<r;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[];let n=this.morphNormals[t].faceNormals,a=this.morphNormals[t].vertexNormals;for(let o=0,s=this.faces.length;o<s;o++){let l=new k,c={a:new k,b:new k,c:new k};n.push(l),a.push(c)}}let i=this.morphNormals[t];e.vertices=this.morphTargets[t].vertices,e.computeFaceNormals(),e.computeVertexNormals();for(let n=0,a=this.faces.length;n<a;n++){let o=this.faces[n],s=i.faceNormals[n],l=i.vertexNormals[n];s.copy(o.normal),l.a.copy(o.vertexNormals[0]),l.b.copy(o.vertexNormals[1]),l.c.copy(o.vertexNormals[2])}}for(let t=0,r=this.faces.length;t<r;t++){let i=this.faces[t];i.normal=i.__originalFaceNormal,i.vertexNormals=i.__originalVertexNormals}}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Zi),this.boundingBox.setFromPoints(this.vertices)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Za),this.boundingSphere.setFromPoints(this.vertices)}merge(e,t,r=0){if(!(e&&e.isGeometry)){console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e);return}let i,n=this.vertices.length,a=this.vertices,o=e.vertices,s=this.faces,l=e.faces,c=this.colors,d=e.colors;t!==void 0&&(i=new sn().getNormalMatrix(t));for(let u=0,h=o.length;u<h;u++){let f=o[u].clone();t!==void 0&&f.applyMatrix4(t),a.push(f)}for(let u=0,h=d.length;u<h;u++)c.push(d[u].clone());for(let u=0,h=l.length;u<h;u++){let f=l[u],p,v,m=f.vertexNormals,g=f.vertexColors,y=new HM(f.a+n,f.b+n,f.c+n);y.normal.copy(f.normal),i!==void 0&&y.normal.applyMatrix3(i).normalize();for(let b=0,x=m.length;b<x;b++)p=m[b].clone(),i!==void 0&&p.applyMatrix3(i).normalize(),y.vertexNormals.push(p);y.color.copy(f.color);for(let b=0,x=g.length;b<x;b++)v=g[b],y.vertexColors.push(v.clone());y.materialIndex=f.materialIndex+r,s.push(y)}for(let u=0,h=e.faceVertexUvs.length;u<h;u++){let f=e.faceVertexUvs[u];this.faceVertexUvs[u]===void 0&&(this.faceVertexUvs[u]=[]);for(let p=0,v=f.length;p<v;p++){let m=f[p],g=[];for(let y=0,b=m.length;y<b;y++)g.push(m[y].clone());this.faceVertexUvs[u].push(g)}}}mergeMesh(e){if(!(e&&e.isMesh)){console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e);return}e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)}mergeVertices(e=4){let t={},r=[],i=[],n=Math.pow(10,e);for(let s=0,l=this.vertices.length;s<l;s++){let c=this.vertices[s],d=Math.round(c.x*n)+"_"+Math.round(c.y*n)+"_"+Math.round(c.z*n);t[d]===void 0?(t[d]=s,r.push(this.vertices[s]),i[s]=r.length-1):i[s]=i[t[d]]}let a=[];for(let s=0,l=this.faces.length;s<l;s++){let c=this.faces[s];c.a=i[c.a],c.b=i[c.b],c.c=i[c.c];let d=[c.a,c.b,c.c];for(let u=0;u<3;u++)if(d[u]===d[(u+1)%3]){a.push(s);break}}for(let s=a.length-1;s>=0;s--){let l=a[s];this.faces.splice(l,1);for(let c=0,d=this.faceVertexUvs.length;c<d;c++)this.faceVertexUvs[c].splice(l,1)}let o=this.vertices.length-r.length;return this.vertices=r,o}setFromPoints(e){this.vertices=[];for(let t=0,r=e.length;t<r;t++){let i=e[t];this.vertices.push(new k(i.x,i.y,i.z||0))}return this}sortFacesByMaterialIndex(){let e=this.faces,t=e.length;for(let s=0;s<t;s++)e[s]._id=s;function r(s,l){return s.materialIndex-l.materialIndex}e.sort(r);let i=this.faceVertexUvs[0],n=this.faceVertexUvs[1],a,o;i&&i.length===t&&(a=[]),n&&n.length===t&&(o=[]);for(let s=0;s<t;s++){let l=e[s]._id;a&&a.push(i[l]),o&&o.push(n[l])}a&&(this.faceVertexUvs[0]=a),o&&(this.faceVertexUvs[1]=o)}toJSON(){let e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),this.parameters!==void 0){let f=this.parameters;for(let p in f)f[p]!==void 0&&(e[p]=f[p]);return e}let t=[];for(let f=0;f<this.vertices.length;f++){let p=this.vertices[f];t.push(p.x,p.y,p.z)}let r=[],i=[],n={},a=[],o={},s=[],l={};for(let f=0;f<this.faces.length;f++){let p=this.faces[f],v=!0,m=!1,g=this.faceVertexUvs[0][f]!==void 0,y=p.normal.length()>0,b=p.vertexNormals.length>0,x=p.color.r!==1||p.color.g!==1||p.color.b!==1,S=p.vertexColors.length>0,w=0;if(w=c(w,0,0),w=c(w,1,v),w=c(w,2,m),w=c(w,3,g),w=c(w,4,y),w=c(w,5,b),w=c(w,6,x),w=c(w,7,S),r.push(w),r.push(p.a,p.b,p.c),r.push(p.materialIndex),g){let _=this.faceVertexUvs[0][f];r.push(h(_[0]),h(_[1]),h(_[2]))}if(y&&r.push(d(p.normal)),b){let _=p.vertexNormals;r.push(d(_[0]),d(_[1]),d(_[2]))}if(x&&r.push(u(p.color)),S){let _=p.vertexColors;r.push(u(_[0]),u(_[1]),u(_[2]))}}function c(f,p,v){return v?f|1<<p:f&~(1<<p)}function d(f){let p=f.x.toString()+f.y.toString()+f.z.toString();return n[p]!==void 0||(n[p]=i.length/3,i.push(f.x,f.y,f.z)),n[p]}function u(f){let p=f.r.toString()+f.g.toString()+f.b.toString();return o[p]!==void 0||(o[p]=a.length,a.push(f.getHex())),o[p]}function h(f){let p=f.x.toString()+f.y.toString();return l[p]!==void 0||(l[p]=s.length/2,s.push(f.x,f.y)),l[p]}return e.data={},e.data.vertices=t,e.data.normals=i,a.length>0&&(e.data.colors=a),s.length>0&&(e.data.uvs=[s]),e.data.faces=r,e}clone(){return new Zx().copy(this)}copy(e){this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;let t=e.vertices;for(let u=0,h=t.length;u<h;u++)this.vertices.push(t[u].clone());let r=e.colors;for(let u=0,h=r.length;u<h;u++)this.colors.push(r[u].clone());let i=e.faces;for(let u=0,h=i.length;u<h;u++)this.faces.push(i[u].clone());for(let u=0,h=e.faceVertexUvs.length;u<h;u++){let f=e.faceVertexUvs[u];this.faceVertexUvs[u]===void 0&&(this.faceVertexUvs[u]=[]);for(let p=0,v=f.length;p<v;p++){let m=f[p],g=[];for(let y=0,b=m.length;y<b;y++){let x=m[y];g.push(x.clone())}this.faceVertexUvs[u].push(g)}}let n=e.morphTargets;for(let u=0,h=n.length;u<h;u++){let f={};if(f.name=n[u].name,n[u].vertices!==void 0){f.vertices=[];for(let p=0,v=n[u].vertices.length;p<v;p++)f.vertices.push(n[u].vertices[p].clone())}if(n[u].normals!==void 0){f.normals=[];for(let p=0,v=n[u].normals.length;p<v;p++)f.normals.push(n[u].normals[p].clone())}this.morphTargets.push(f)}let a=e.morphNormals;for(let u=0,h=a.length;u<h;u++){let f={};if(a[u].vertexNormals!==void 0){f.vertexNormals=[];for(let p=0,v=a[u].vertexNormals.length;p<v;p++){let m=a[u].vertexNormals[p],g={};g.a=m.a.clone(),g.b=m.b.clone(),g.c=m.c.clone(),f.vertexNormals.push(g)}}if(a[u].faceNormals!==void 0){f.faceNormals=[];for(let p=0,v=a[u].faceNormals.length;p<v;p++)f.faceNormals.push(a[u].faceNormals[p].clone())}this.morphNormals.push(f)}let o=e.skinWeights;for(let u=0,h=o.length;u<h;u++)this.skinWeights.push(o[u].clone());let s=e.skinIndices;for(let u=0,h=s.length;u<h;u++)this.skinIndices.push(s[u].clone());let l=e.lineDistances;for(let u=0,h=l.length;u<h;u++)this.lineDistances.push(l[u]);let c=e.boundingBox;c!==null&&(this.boundingBox=c.clone());let d=e.boundingSphere;return d!==null&&(this.boundingSphere=d.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this}toBufferGeometry(){let e=new O3e().fromGeometry(this),t=new Ot,r=new Float32Array(e.vertices.length*3);if(t.setAttribute("position",Ty.call(new $t(r,3),e.vertices)),e.normals.length>0){let i=new Float32Array(e.normals.length*3);t.setAttribute("normal",Ty.call(new $t(i,3),e.normals))}if(e.colors.length>0){let i=new Float32Array(e.colors.length*3);t.setAttribute("color",FL.call(new $t(i,3),e.colors))}if(e.uvs.length>0){let i=new Float32Array(e.uvs.length*2);t.setAttribute("uv",NL.call(new $t(i,2),e.uvs))}if(e.uvs2.length>0){let i=new Float32Array(e.uvs2.length*2);t.setAttribute("uv2",NL.call(new $t(i,2),e.uvs2))}t.groups=e.groups;for(let i in e.morphTargets){let n=[],a=e.morphTargets[i];for(let o=0,s=a.length;o<s;o++){let l=a[o],c=new yt(l.data.length*3,3);c.name=l.name,n.push(Ty.call(c,l.data))}t.morphAttributes[i]=n}if(e.skinIndices.length>0){let i=new yt(e.skinIndices.length*4,4);t.setAttribute("skinIndex",UL.call(i,e.skinIndices))}if(e.skinWeights.length>0){let i=new yt(e.skinWeights.length*4,4);t.setAttribute("skinWeight",UL.call(i,e.skinWeights))}return e.boundingSphere!==null&&(t.boundingSphere=e.boundingSphere.clone()),e.boundingBox!==null&&(t.boundingBox=e.boundingBox.clone()),t}computeTangents(){console.error("THREE.Geometry: .computeTangents() has been removed.")}computeLineDistances(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")}applyMatrix(e){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}dispose(){this.dispatchEvent({type:"dispose"})}static createBufferGeometryFromObject(e){let t=new Ot,r=e.geometry;if(e.isPoints||e.isLine){let i=new yt(r.vertices.length*3,3),n=new yt(r.colors.length*3,3);if(t.setAttribute("position",Ty.call(i,r.vertices)),t.setAttribute("color",FL.call(n,r.colors)),r.lineDistances&&r.lineDistances.length===r.vertices.length){let a=new yt(r.lineDistances.length,1);t.setAttribute("lineDistance",R3e.call(a,r.lineDistances))}r.boundingSphere!==null&&(t.boundingSphere=r.boundingSphere.clone()),r.boundingBox!==null&&(t.boundingBox=r.boundingBox.clone())}else e.isMesh&&(t=r.toBufferGeometry());return t}};Zx.prototype.isGeometry=!0;var O3e=class{constructor(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}computeGroups(e){let t=[],r,i,n,a=e.faces;for(i=0;i<a.length;i++){let o=a[i];o.materialIndex!==n&&(n=o.materialIndex,r!==void 0&&(r.count=i*3-r.start,t.push(r)),r={start:i*3,materialIndex:n})}r!==void 0&&(r.count=i*3-r.start,t.push(r)),this.groups=t}fromGeometry(e){let t=e.faces,r=e.vertices,i=e.faceVertexUvs,n=i[0]&&i[0].length>0,a=i[1]&&i[1].length>0,o=e.morphTargets,s=o.length,l;if(s>0){l=[];for(let m=0;m<s;m++)l[m]={name:o[m].name,data:[]};this.morphTargets.position=l}let c=e.morphNormals,d=c.length,u;if(d>0){u=[];for(let m=0;m<d;m++)u[m]={name:c[m].name,data:[]};this.morphTargets.normal=u}let h=e.skinIndices,f=e.skinWeights,p=h.length===r.length,v=f.length===r.length;r.length>0&&t.length===0&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(let m=0;m<t.length;m++){let g=t[m];this.vertices.push(r[g.a],r[g.b],r[g.c]);let y=g.vertexNormals;if(y.length===3)this.normals.push(y[0],y[1],y[2]);else{let x=g.normal;this.normals.push(x,x,x)}let b=g.vertexColors;if(b.length===3)this.colors.push(b[0],b[1],b[2]);else{let x=g.color;this.colors.push(x,x,x)}if(n===!0){let x=i[0][m];x!==void 0?this.uvs.push(x[0],x[1],x[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",m),this.uvs.push(new ye,new ye,new ye))}if(a===!0){let x=i[1][m];x!==void 0?this.uvs2.push(x[0],x[1],x[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",m),this.uvs2.push(new ye,new ye,new ye))}for(let x=0;x<s;x++){let S=o[x].vertices;l[x].data.push(S[g.a],S[g.b],S[g.c])}for(let x=0;x<d;x++){let S=c[x].vertexNormals[m];u[x].data.push(S.a,S.b,S.c)}p&&this.skinIndices.push(h[g.a],h[g.b],h[g.c]),v&&this.skinWeights.push(f[g.a],f[g.b],f[g.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),this}},HM=class{constructor(e,t,r,i,n,a=0){this.a=e,this.b=t,this.c=r,this.normal=i&&i.isVector3?i:new k,this.vertexNormals=Array.isArray(i)?i:[],this.color=n&&n.isColor?n:new Lt,this.vertexColors=Array.isArray(n)?n:[],this.materialIndex=a}clone(){return new this.constructor().copy(this)}copy(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(let t=0,r=e.vertexNormals.length;t<r;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(let t=0,r=e.vertexColors.length;t<r;t++)this.vertexColors[t]=e.vertexColors[t].clone();return this}};function R3e(e){return this.array.set(e),this}function FL(e){let t=this.array,r=0;for(let i=0,n=e.length;i<n;i++){let a=e[i];a===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",i),a=new Lt),t[r++]=a.r,t[r++]=a.g,t[r++]=a.b}return this}function NL(e){let t=this.array,r=0;for(let i=0,n=e.length;i<n;i++){let a=e[i];a===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",i),a=new ye),t[r++]=a.x,t[r++]=a.y}return this}function Ty(e){let t=this.array,r=0;for(let i=0,n=e.length;i<n;i++){let a=e[i];a===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",i),a=new k),t[r++]=a.x,t[r++]=a.y,t[r++]=a.z}return this}function UL(e){let t=this.array,r=0;for(let i=0,n=e.length;i<n;i++){let a=e[i];a===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",i),a=new Kt),t[r++]=a.x,t[r++]=a.y,t[r++]=a.z,t[r++]=a.w}return this}var I3e=["a","b","c"];function z3e(e,t){switch(t){case"c":return e.c;case"b":return e.b;case"a":default:return e.a}}function LC(e,t,r){let i=Math.min(e,t),n=Math.max(e,t),a=i+"_"+n;return r.get(a)}function BC(e,t,r,i,n,a){let o=Math.min(e,t),s=Math.max(e,t),l=o+"_"+s,c;if(i.has(l))c=i.get(l);else{let d=r[o],u=r[s];c={a:d,b:u,newEdge:null,faces:[]},i.set(l,c)}c.faces.push(n),a[e].edges.push(c),a[t].edges.push(c)}function k3e(e,t,r,i){let n,a,o;for(n=0,a=e.length;n<a;n++)r[n]={edges:[]};for(n=0,a=t.length;n<a;n++)o=t[n],BC(o.a,o.b,e,i,o,r),BC(o.b,o.c,e,i,o,r),BC(o.c,o.a,e,i,o,r)}function Py(e,t,r,i,n){e.push(new HM(t,r,i,void 0,void 0,n))}function af(e,t){return Math.abs(t-e)/2+Math.min(e,t)}function Dy(e,t,r,i){e.push([t.clone(),r.clone(),i.clone()])}var L3e=class{constructor(e=1){this.subdivisions=e}modify(e){e instanceof Ot?e=new Zx().fromBufferGeometry(e):e=e.clone(),e.mergeVertices();let t=this.subdivisions;for(;t-- >0;)this._smooth(e);return e.computeFaceNormals(),e.computeVertexNormals(),e}_smooth(e){let t=new k,r,i,n,a,o,s=e.vertices,l=e.faces,c=e.faceVertexUvs[0],d=c!==void 0&&c.length>0,u=[],h=new Map;k3e(s,l,u,h);let f=[],p,v,m,g,y,b,x;for(let Q of Array.from(h.keys())){for(v=h.get(Q),m=new k,y=3/8,b=1/8,x=v.faces.length,x!=2&&(y=.5,b=0,x!=1),m.addVectors(v.a,v.b).multiplyScalar(y),t.set(0,0,0),a=0;a<x;a++){for(g=v.faces[a],o=0;o<3&&(p=s[z3e(g,I3e[o])],!(p!==v.a&&p!==v.b));o++);p&&t.add(p)}t.multiplyScalar(b),m.add(t),v.newEdge=f.length,f.push(m)}let S,w,_,C,A,M,P,T=[];for(i=0,n=s.length;i<n;i++){for(M=s[i],A=u[i].edges,r=A.length,r==3?S=3/16:r>3&&(S=3/(8*r)),w=1-r*Number(S),_=S,r<=2&&(r==2?(w=3/4,_=1/8):r==1||r==0),P=M.clone().multiplyScalar(w),t.set(0,0,0),a=0;a<r;a++)C=A[a],p=C.a!==M?C.a:C.b,t.add(p);t.multiplyScalar(Number(_)),P.add(t),T.push(P)}let R=T.concat(f),z=T.length,F,H,N,U=[],ie=[],te,X,W,q,$=new ye,le=new ye,ee=new ye;for(i=0,n=l.length;i<n;i++)g=l[i],F=Number(LC(g.a,g.b,h).newEdge)+z,H=Number(LC(g.b,g.c,h).newEdge)+z,N=Number(LC(g.c,g.a,h).newEdge)+z,Py(U,F,H,N,g.materialIndex),Py(U,g.a,F,N,g.materialIndex),Py(U,g.b,H,F,g.materialIndex),Py(U,g.c,N,H,g.materialIndex),d&&(te=c[i],X=te[0],W=te[1],q=te[2],$.set(af(X.x,W.x),af(X.y,W.y)),le.set(af(W.x,q.x),af(W.y,q.y)),ee.set(af(X.x,q.x),af(X.y,q.y)),Dy(ie,$,le,ee),Dy(ie,X,$,ee),Dy(ie,W,le,$),Dy(ie,q,ee,le));e.vertices=R,e.faces=U,d&&(e.faceVertexUvs[0]=ie)}},hn=new k,B3e=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=e.geometry??(t==null?void 0:t.geometry)??new Ot().copy(new fs(100,100,100)),i;t===void 0?(r.computeBoundingBox(),r.boundingBox.getSize(hn),i={width:hn.x,height:hn.y,depth:hn.z,subdivisions:0}):i=t.parameters;let n={...i,...e.parameters};return{parameters:{width:Math.abs(n.width),height:Math.abs(n.height),depth:Math.abs(n.depth),subdivisions:Math.abs(n.subdivisions)},geometry:r}}static build(e){let{width:t,height:r,depth:i,subdivisions:n}=e.parameters,a=e.geometry??new Ot().copy(new fs(100,100,100)),o=a.userData.parameters;o===void 0?(a.computeBoundingBox(),a.boundingBox.getSize(hn)):hn.set(o.width,o.height,o.depth),(t!==hn.x||r!==hn.y||i!==hn.z)&&a.scale(hn.x===0?1:t/hn.x,hn.y===0?1:r/hn.y,hn.z===0?1:i/hn.z);let s=a.originalGeometry;try{n>0?(s===void 0||(o==null?void 0:o.subdivisions)!==n)&&(s===void 0&&(s=a),a=new L3e(n).modify(s).toBufferGeometry()):(s!==void 0&&(a=s),s=void 0,a.getAttribute("normal")===void 0&&a.computeVertexNormals())}catch{s!==void 0&&(a=s),s=void 0,a.getAttribute("normal")===void 0&&a.computeVertexNormals()}return s!==void 0&&Object.assign(a,{originalGeometry:s}),delete e.geometry,Object.assign(a,{userData:{...e,type:"NonParametricGeometry"}})}static loadFromUrl(e,t,r){new Hj(r).load(e,i=>{let n=this.normalizeInputs({geometry:i});i.boundingBox.getSize(hn);let a=100/hn.x;Object.assign(n.parameters,{width:100,height:hn.y*a,depth:hn.z*a}),t(this.build(n))})}},F8=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0,spikes:5,cornerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:3},e.parameters);return{shape:e.shape&&e.shape instanceof Bi?e.shape:new Bi,parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??0)})}}static build(e){let{width:t,height:r,spikes:i,cornerRadius:n,depth:a,extrudeBevelSize:o,extrudeBevelSegments:s}=e.parameters,l=e.shape,c=t*.5,d=r*.5,u=0,h=0,f=2*Math.PI/i;for(let v=0;v<i;v++){let m=f*v,g=u+Math.sin(m)*c,y=h+Math.cos(m)*d;l.addPoint(l.createPoint(g,y))}l.isClosed=!0;for(let v=0,m=l.points.length;v<m;v++)l.points[v].roundness=n;l.roundness=n,l.update();let p=_h.create({shape:l,parameters:{roundness:n,depth:a,extrudeBevelSize:o,extrudeBevelSegments:s}});return Object.assign(p,{userData:{...e,type:"PolygonGeometry"}})}},F3e=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,radialSegments:4,heightSegments:1,cornerRadius:0,cornerSegments:8,openEnded:!1},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(e){let{width:t,height:r,depth:i,radialSegments:n,heightSegments:a,openEnded:o,cornerRadius:s,cornerSegments:l}=e.parameters,c=new U3e(t*.5,r,n,a,o,s,l);return c.scale(1,1,i/t),Object.assign(c,{userData:{...e,type:"PyramidGeometry"}})}};function Lm(e,t,r){r.x=e.x*t.x,r.y=e.y,r.z=e.x*t.y}function FC(e,t,r,i,n,a){let o=t.clone().sub(e),s=r.clone().sub(e),l=o.angleTo(s);if(o.normalize(),s.normalize(),i===n){let c=o.add(s).normalize();a.copy(e).addScaledVector(c,i/Math.sin(l/2))}else{let c=o.angleTo(s);a.copy(e),a.addScaledVector(o,n/Math.sin(c)),a.addScaledVector(s,i/Math.sin(c))}}function N3e(e,t,r){let i=e.clone().sub(t),n=r.clone().sub(t);return i.projectOnVector(n),i.add(t)}var U3e=class extends Ot{constructor(e=.5,t=1,r=4,i=1,n=!1,a=0,o=4){super(),r=Math.floor(Math.max(3,r)),i=Math.floor(i),o=Math.floor(o);let s=[],l=[],c=[],d=[],u=0,h=t/2,f=Math.PI/r,p=e*Math.cos(Math.PI/r),v=2*Math.PI/r,m=(r-2)*Math.PI/r,g=Math.PI-m,y=new k(0,-h,0),b=new k(0,h,0),x=new ye(e,-h),S=new ye(p,-h),w=new ye(0,b.y).sub(S),_=new ye(0,b.y).sub(x),C=new ye(w.y,-w.x).normalize(),A=new ye(_.y,-_.x).normalize(),M=e*Math.cos(Math.PI/r)*Math.tan((Math.PI-w.angle())/2)-1e-8;a=Math.min(a,M);let P;{let N=new k(C.x,C.y,0),U=new k(Math.cos(v)*N.x,N.y,Math.sin(v)*N.x);P=N.angleTo(U)}let T=a/Math.tan((Math.PI-w.angle())/2),R=a/Math.tan((Math.PI-P)/2),z=new k;if(!n){l.push(y.x,y.y,y.z),c.push(0,-1,0),d.push(0,0);let N=u++,U=[],ie=x.clone(),te=T/Math.cos(Math.PI/r);ie.x-=te;for(let X=0;X<r;X++){let W=X/r*Math.PI*2+f,q=new ye(Math.sin(W),Math.cos(W));Lm(ie,q,z),l.push(z.x,z.y,z.z),c.push(0,-1,0),d.push(0,0),U.push(u++)}for(let X=0;X<U.length;X++)s.push(U[X],N,U[(X+1)%U.length])}{let N=new k,U=new k,ie=new k,te=new k,X=new k,W=new k;for(let q=0;q<r;q++){let $=q/r*Math.PI*2+f,le=(q+.5)/r*Math.PI*2+f,ee=(q+1)/r*Math.PI*2+f,Q=new ye(Math.sin($),Math.cos($)),ne=new ye(Math.sin(le),Math.cos(le)),V=new ye(Math.sin(ee),Math.cos(ee));Lm(x,Q,U),Lm(x,V,ie),Lm(C,ne,N),FC(b,U,ie,R,R,te),l.push(te.x,te.y,te.z),FC(U,b,ie,R,T,X),l.push(X.x,X.y,X.z),FC(ie,U,b,T,R,W),l.push(W.x,W.y,W.z),c.push(N.x,N.y,N.z),c.push(N.x,N.y,N.z),c.push(N.x,N.y,N.z),d.push(0,0),d.push(0,0),d.push(0,0);let de=u++,me=u++,Ce=u++;if(s.push(de,me,Ce),a>0){{let ue=U.clone().add(ie).multiplyScalar(.5),Se=b.clone().sub(ue).normalize(),we=y.clone().sub(ue).normalize().add(Se).normalize().multiplyScalar(-1),_e=W.clone().sub(X);F(ue,_e,we,w.angle())}let G,Z;{let ue=new k;Lm(A,V,ue);let Se=W.clone().add(te).multiplyScalar(.5);Se=N3e(Se,ie,b);let we=W.clone().sub(te);[G,Z]=F(Se,we,ue,P,te.y)}{let ue=G,Se=ue.clone().setY(0).normalize(),we=new k(0,-1,0),_e=Se.clone().cross(we);H(ue,Se,we,_e)}{let ue=w.angle(),Se=Math.PI-ue,we=b.clone();we.y-=a/Math.sin(ue-Math.PI/2);let _e=new k,Ee=[];for(let B=0;B<o;B++){let D=[],I=Math.PI/2-Se*B/o,O=Math.cos(I),j=Math.sin(I),L=le;for(let Ae=0;Ae<=B;Ae++){let We=Math.cos(L),je=Math.sin(L);N.x=O*je,N.y=j,N.z=O*We,_e.copy(we).addScaledVector(N,a),l.push(_e.x,_e.y,_e.z),c.push(N.x,N.y,N.z),d.push(0,0),D.push(u++),L+=Math.PI*2/B/r}Ee.push(D)}Z.reverse(),Ee.push(Z);let fe=Ee.length-1;for(let B=0;B<fe;B++){let D=Ee[B],I=Ee[B+1],O=D.length-1;s.push(I[1],D[0],I[0]);for(let j=1;j<=O;j++)s.push(D[j],D[j-1],I[j]),s.push(I[j+1],D[j],I[j])}}}}}this.setIndex(s),this.setAttribute("position",new yt(l,3)),this.setAttribute("normal",new yt(c,3)),this.setAttribute("uv",new yt(d,2));function F(N,U,ie,te,X){let W=-te/2,q=(Math.PI-te)/2,$=U.clone().normalize().cross(ie);N.addScaledVector(ie,-a/Math.sin(q));let le=new k,ee=new k,Q=1,ne=u,V=[];for(let de=0;de<=o;de++){let me=W+de/o*te;ee.set(0,0,0),ee.addScaledVector($,Math.sin(me)),ee.addScaledVector(ie,Math.cos(me));for(let Ce=0;Ce<=Q;Ce++){let G=Ce/Q-.5;if(le.copy(N),le.addScaledVector(U,G),le.addScaledVector(ee,a),X!=null){let Z=Math.max(0,le.y-X);le.addScaledVector(U,-Z/U.y)}l.push(le.x,le.y,le.z),c.push(ee.x,ee.y,ee.z),d.push(0,0),Ce===0&&V.push(u),u++}}for(let de=0;de<o;de++)for(let me=0;me<Q;me++){let Ce=ne+me+(Q+1)*de,G=Ce+(Q+1),Z=G+1,ue=Ce+1;s.push(Ce,G,ue),s.push(G,Z,ue)}return[N.clone().addScaledVector(U,.5),V]}function H(N,U,ie,te){let X=Math.PI/2,W=_.angle()-X,q=[],$=new k,le=new k;for(let Q=0;Q<=o;Q++){let ne=[],V=Q/o;for(let de=0;de<=Q;de++){let me=((Q?de/Q:0)-.5)*g,Ce=Math.cos(me),G=Math.sin(me),Z=Math.atan(Math.tan(W)*Ce),ue=(X+Z)*V,Se=Math.cos(ue),we=Math.sin(ue);$.set(0,0,0),$.addScaledVector(U,we*Ce),$.addScaledVector(ie,Se),$.addScaledVector(te,we*G),le.copy(N).addScaledVector($,a),l.push(le.x,le.y,le.z),c.push($.x,$.y,$.z),d.push(0,0),ne.push(u++)}q.push(ne)}let ee=q.length-1;for(let Q=0;Q<ee;Q++){let ne=q[Q],V=q[Q+1],de=ne.length-1;s.push(ne[0],V[1],V[0]);for(let me=1;me<=de;me++)s.push(ne[me-1],ne[me],V[me]),s.push(ne[me],V[me+1],V[me])}}}},KP=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0,cornerRadius:[0,0,0,0],cornerType:1,extrudeBevelSize:0,extrudeBevelSegments:1},e.parameters),i=Object.assign((t==null?void 0:t.ui)??{enabledIndieCorners:!1},e.ui);return{shape:e.shape&&e.shape instanceof Bi?e.shape:new Bi,parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??0)}),ui:i}}static build(e){let t=e.shape,{width:r,height:i,cornerRadius:n,cornerType:a,depth:o,extrudeBevelSize:s,extrudeBevelSegments:l}=e.parameters,c={x:r*.5,y:i*.5},d={x:-c.x,y:-c.y},u={x:c.x,y:c.y};function h(x,S,w){return S>r&&w>i?Math.min(x*r/S,x*i/w):S>r?x*r/S:w>i?x*i/w:x}let f=[];f[0]=n[0]===0?0:h(n[0],n[0]+n[3],n[0]+n[1]),f[1]=n[1]===0?0:h(n[1],n[1]+n[2],n[1]+n[0]),f[2]=n[2]===0?0:h(n[2],n[2]+n[1],n[2]+n[3]),f[3]=n[3]===0?0:h(n[3],n[3]+n[0],n[3]+n[2]);let p=d.x,v=u.x,m=u.y,g=d.y;t.addPoint(t.createPoint(p,m)),t.addPoint(t.createPoint(v,m)),t.addPoint(t.createPoint(v,g)),t.addPoint(t.createPoint(p,g)),t.isClosed=!0;let y=!0;for(let x=0,S=t.points.length;x<S;x++)t.points[x].roundness=f[x],x>0&&f[x]!==f[x-1]&&(y=!1);y&&(t.roundness=f[0]),t.useCubicForRoundedCorners=a!==1,t.update();let b=_h.create({shape:t,parameters:{depth:o,extrudeBevelSize:s,extrudeBevelSegments:l}});return Object.assign(b,{userData:{...e,type:"RectangleGeometry"}})}},j3e=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,widthSegments:64,heightSegments:64,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:180},e.parameters);return r.thetaLength=St.clamp(r.thetaLength,0,180),{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(e){let{width:t=100,height:r=t,depth:i=t,widthSegments:n=64,heightSegments:a=64,phiStart:o,phiLength:s,thetaStart:l,thetaLength:c}=e.parameters,d;return c===0?(d=new Ot,d.setAttribute("position",new yt([],3))):d=new Hf(.5*t,n,a,o,s,l,c*St.DEG2RAD),d.scale(1,r/t,i/t),Object.assign(d,{userData:{...e,type:"SphereGeometry"}})}},V3e=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0,widthSegments:8,heightSegments:8},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:0})}}static build(e){let{width:t=100,height:r=t,widthSegments:i=8,heightSegments:n=8}=e.parameters,a=new rc(t,r,i,n);return a.scale(1,1,1),Object.assign(a,{userData:{...e,type:"PlaneGeometry"}})}},H3e=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,angle:90,cornerRadius:24,cornerSegments:8},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(e){let{width:t,height:r,depth:i,angle:n,cornerRadius:a,cornerSegments:o}=e.parameters,s=new W3e(t,r,i,n,a,o);return Object.assign(s,{userData:{...e,type:"BackdropGeometry"}})}},W3e=class extends Ot{constructor(e=1,t=1,r=1,i=90,n=10,a=24){super(),this.type="BackdropGeometry";let o=[],s=[],l=[],c=.001;n==0&&(a=1),a=Math.max(1,Math.floor(a)),n=Math.min(n,100),i=Math.min(180-c,i),i*=Math.PI/180;let d=[],u=Math.PI/2,h=(Q=0,ne=0,V=0)=>new k(Q,ne,V),f=h(),p=h(),[v,m,g]=[t/2,e/2,r/2],y=-m,b=+m,[x,S,w]=[h(y,-v,+g),h(y,-v,-g),h(y,+v,-g)],_=(Q,ne=!1)=>Math.sin(Q-Math.PI/(1+ +ne)),C=(Q,ne=!1)=>Math.cos(Q-Math.PI/(1+ +ne));w.y=Math.sin(i)*t-v;let A=Math.cos(i)*t-g,M=x.z-c;i<=u?(w.z=Math.min(A,M),w.z==M&&(w.y-=(A-M)/Math.tan(u-i))):S.z=Math.min(S.z-A-g,x.z-c),f.subVectors(x,S),p.subVectors(w,S);let P=Math.min(f.length(),p.length())*n/100,T=P*Math.tan(i/2),R=P/Math.cos(i/2),z=f.clone().normalize().add(p.normalize()).setLength(R).add(S);f.set(0,_(i,!0),C(i,!0)),d.push([w,f.clone()]);let F=(Math.PI-i)/a;for(let Q=0;Q<=a;Q++){let ne=u+i+Q*F;f.set(0,Math.sin(ne)*T,Math.cos(ne)*T),f.add(z),p.set(0,_(ne),C(ne)),d.push([f.clone(),p.clone()])}d.push([x,h(0,1,0)]);let H=Math.sin(F/2)*T*2,N=d.length-1,U=d[0][0].distanceTo(d[1][0]),ie=d[N-1][0].distanceTo(d[N][0]),te=U+H*a+ie;d[0].push(1);for(let Q=0;Q<=a;Q++)d[Q+1].push(1-(U+Q*H)/te);d[N].push(0);let[X,W,q]=d[0],$,le,ee;for(let Q=1;Q<d.length;Q++)[$,le,ee]=d[Q],o.push(y,X.y,X.z,y,$.y,$.z,b,X.y,X.z,b,X.y,X.z,y,$.y,$.z,b,$.y,$.z),s.push(0,W.y,W.z,0,le.y,le.z,0,W.y,W.z,0,W.y,W.z,0,le.y,le.z,0,le.y,le.z),l.push(0,q,0,ee,1,q,1,q,0,ee,1,ee),[X,W,q]=[$,le,ee];this.setAttribute("position",new yt(o,3)),this.setAttribute("normal",new yt(s,3)),this.setAttribute("uv",new yt(l,2))}},N8=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0,innerRadiusPercent:38.19,spikes:5,cornerRadius:0,angle:360,extrudeBevelSize:0,extrudeBevelSegments:1},e.parameters);return{shape:e.shape&&e.shape instanceof Bi?e.shape:new Bi,parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??0)})}}static build(e){let{width:t,height:r,innerRadiusPercent:i,spikes:n,cornerRadius:a,angle:o,depth:s,extrudeBevelSize:l,extrudeBevelSegments:c}=e.parameters,d=e.shape,u=t*.5,h=r*.5,f=0,p=0,v=o*Math.PI/360/n,m=Math.PI/2*3*-1,g=u*i/100,y=h*i/100;if(n===3&&i===50){v=2*Math.PI/n;for(let x=0;x<n;x++){let S=v*x,w=f+Math.sin(S)*u,_=p+Math.cos(S)*h;d.addPoint(d.createPoint(w,_))}}else for(let x=0;x<n;x++){let S=f+Math.cos(m)*u,w=p+Math.sin(m)*h;d.addPoint(d.createPoint(S,w)),m+=v,S=f+Math.cos(m)*g,w=p+Math.sin(m)*y,d.addPoint(d.createPoint(S,w)),m+=v}d.isClosed=!0;for(let x=0,S=d.points.length;x<S;x++)d.points[x].roundness=a;d.roundness=a,d.update();let b=_h.create({shape:d,parameters:{roundness:a,depth:s,extrudeBevelSize:l,extrudeBevelSegments:c}});return Object.assign(b,{userData:{...e,type:"StarGeometry"}})}},G3e=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??0)})}}static build(e){let{width:t,height:r}=e.parameters,i=new rc(t,r);return Object.assign(i,{userData:{...e,type:"TextFrameGeometry"}})}},$3e=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,radialSegments:32,tubularSegments:64,arc:360,cornerRadius:30,cornerSegments:8},e.parameters),i=Math.abs(r.width),n=Math.abs(r.height??r.width),a=Math.round(Math.abs(r.depth??r.width*.25));return{parameters:Object.assign(r,{width:i,height:n,depth:a})}}static build(e){let{width:t,height:r,depth:i,radialSegments:n,tubularSegments:a,arc:o,cornerRadius:s,cornerSegments:l}=e.parameters,c=q3e(t,r,i,t*.5,o,a,0,0,n,s,l);return c.scale(1,r/t,1),Object.assign(c,{userData:{...e,type:"TorusGeometry"}})}};function q3e(e,t,r,i,n,a,o,s,l,c,d){[t,r]=[r,t],o=t/2;let u=St.clamp(n/360,0,1);if(u===0){let h=new Ot;return h.setAttribute("position",new yt([],3)),h}return u===1&&(c=0),new L8(!0,e,t,r,i,u,a,o,s,l,c,d)}var Y3e=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,tubularSegments:64,radialSegments:32,p:2,q:3},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width),tube:r.tube??r.width*.125})}}static build(e){let{width:t,tube:r,tubularSegments:i,radialSegments:n,p:a,q:o}=e.parameters,s=t*.5;s!==r&&(s-=r);let l=new Lj(s,r,i,n,a,o);return Object.assign(l,{userData:{...e,type:"TorusKnotGeometry"}})}},X3e=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0,spikes:5,cornerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:1,isRect:!1},e.parameters);return{shape:e.shape&&e.shape instanceof Bi?e.shape:new Bi,parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width*(r.isRect?1:Math.sqrt(3)/2)),depth:Math.abs(r.depth??0)})}}static build(e){let{width:t=100,height:r,cornerRadius:i,depth:n,extrudeBevelSize:a,extrudeBevelSegments:o,isRect:s}=e.parameters,l=e.shape,c=t*.5,d=r*.5;s?(l.addPoint(l.createPoint(-c,d)),l.addPoint(l.createPoint(c,-d)),l.addPoint(l.createPoint(-c,-d))):(l.addPoint(l.createPoint(0,d)),l.addPoint(l.createPoint(c,-d)),l.addPoint(l.createPoint(-c,-d))),l.isClosed=!0;for(let h=0,f=l.points.length;h<f;h++)l.points[h].roundness=i;l.roundness=i,l.update();let u=_h.create({shape:l,parameters:{roundness:i,depth:n,extrudeBevelSize:a,extrudeBevelSegments:o}});return Object.assign(u,{userData:{...e,type:"TriangleGeometry"}})}};function K3e(e,t){let r=2*Math.PI;return(e%r+r)%r===(t%r+r)%r}var Q3e=class{add(e,t,r){if(typeof arguments[0]!="string")for(let i in arguments[0])this.add(i,arguments[0][i],arguments[1]);else(Array.isArray(e)?e:[e]).forEach(function(i){this[i]=this[i]||[],t&&this[i][r?"unshift":"push"](t)},this)}run(e,t){this[e]=this[e]||[],this[e].forEach(function(r){r.call(t&&t.context?t.context:t,t)})}},Z3e=class{constructor(e){this.jsep=e,this.registered={}}register(...e){e.forEach(t=>{if(typeof t!="object"||!t.name||!t.init)throw new Error("Invalid JSEP plugin format");this.registered[t.name]||(t.init(this.jsep),this.registered[t.name]=t)})}},qe=class{static get version(){return"1.3.8"}static toString(){return"JavaScript Expression Parser (JSEP) v"+qe.version}static addUnaryOp(e){return qe.max_unop_len=Math.max(e.length,qe.max_unop_len),qe.unary_ops[e]=1,qe}static addBinaryOp(e,t,r){return qe.max_binop_len=Math.max(e.length,qe.max_binop_len),qe.binary_ops[e]=t,r?qe.right_associative.add(e):qe.right_associative.delete(e),qe}static addIdentifierChar(e){return qe.additional_identifier_chars.add(e),qe}static addLiteral(e,t){return qe.literals[e]=t,qe}static removeUnaryOp(e){return delete qe.unary_ops[e],e.length===qe.max_unop_len&&(qe.max_unop_len=qe.getMaxKeyLen(qe.unary_ops)),qe}static removeAllUnaryOps(){return qe.unary_ops={},qe.max_unop_len=0,qe}static removeIdentifierChar(e){return qe.additional_identifier_chars.delete(e),qe}static removeBinaryOp(e){return delete qe.binary_ops[e],e.length===qe.max_binop_len&&(qe.max_binop_len=qe.getMaxKeyLen(qe.binary_ops)),qe.right_associative.delete(e),qe}static removeAllBinaryOps(){return qe.binary_ops={},qe.max_binop_len=0,qe}static removeLiteral(e){return delete qe.literals[e],qe}static removeAllLiterals(){return qe.literals={},qe}get char(){return this.expr.charAt(this.index)}get code(){return this.expr.charCodeAt(this.index)}constructor(e){this.expr=e,this.index=0}static parse(e){return new qe(e).parse()}static getMaxKeyLen(e){return Math.max(0,...Object.keys(e).map(t=>t.length))}static isDecimalDigit(e){return e>=48&&e<=57}static binaryPrecedence(e){return qe.binary_ops[e]||0}static isIdentifierStart(e){return e>=65&&e<=90||e>=97&&e<=122||e>=128&&!qe.binary_ops[String.fromCharCode(e)]||qe.additional_identifier_chars.has(String.fromCharCode(e))}static isIdentifierPart(e){return qe.isIdentifierStart(e)||qe.isDecimalDigit(e)}throwError(e){let t=new Error(e+" at character "+this.index);throw t.index=this.index,t.description=e,t}runHook(e,t){if(qe.hooks[e]){let r={context:this,node:t};return qe.hooks.run(e,r),r.node}return t}searchHook(e){if(qe.hooks[e]){let t={context:this};return qe.hooks[e].find(function(r){return r.call(t.context,t),t.node}),t.node}}gobbleSpaces(){let e=this.code;for(;e===qe.SPACE_CODE||e===qe.TAB_CODE||e===qe.LF_CODE||e===qe.CR_CODE;)e=this.expr.charCodeAt(++this.index);this.runHook("gobble-spaces")}parse(){this.runHook("before-all");let e=this.gobbleExpressions(),t=e.length===1?e[0]:{type:qe.COMPOUND,body:e};return this.runHook("after-all",t)}gobbleExpressions(e){let t=[],r,i;for(;this.index<this.expr.length;)if(r=this.code,r===qe.SEMCOL_CODE||r===qe.COMMA_CODE)this.index++;else if(i=this.gobbleExpression())t.push(i);else if(this.index<this.expr.length){if(r===e)break;this.throwError('Unexpected "'+this.char+'"')}return t}gobbleExpression(){let e=this.searchHook("gobble-expression")||this.gobbleBinaryExpression();return this.gobbleSpaces(),this.runHook("after-expression",e)}gobbleBinaryOp(){this.gobbleSpaces();let e=this.expr.substr(this.index,qe.max_binop_len),t=e.length;for(;t>0;){if(qe.binary_ops.hasOwnProperty(e)&&(!qe.isIdentifierStart(this.code)||this.index+e.length<this.expr.length&&!qe.isIdentifierPart(this.expr.charCodeAt(this.index+e.length))))return this.index+=t,e;e=e.substr(0,--t)}return!1}gobbleBinaryExpression(){let e,t,r,i,n,a,o,s,l;if(a=this.gobbleToken(),!a||(t=this.gobbleBinaryOp(),!t))return a;for(n={value:t,prec:qe.binaryPrecedence(t),right_a:qe.right_associative.has(t)},o=this.gobbleToken(),o||this.throwError("Expected expression after "+t),i=[a,n,o];t=this.gobbleBinaryOp();){if(r=qe.binaryPrecedence(t),r===0){this.index-=t.length;break}n={value:t,prec:r,right_a:qe.right_associative.has(t)},l=t;let c=d=>n.right_a&&d.right_a?r>d.prec:r<=d.prec;for(;i.length>2&&c(i[i.length-2]);)o=i.pop(),t=i.pop().value,a=i.pop(),e={type:qe.BINARY_EXP,operator:t,left:a,right:o},i.push(e);e=this.gobbleToken(),e||this.throwError("Expected expression after "+l),i.push(n,e)}for(s=i.length-1,e=i[s];s>1;)e={type:qe.BINARY_EXP,operator:i[s-1].value,left:i[s-2],right:e},s-=2;return e}gobbleToken(){let e,t,r,i;if(this.gobbleSpaces(),i=this.searchHook("gobble-token"),i)return this.runHook("after-token",i);if(e=this.code,qe.isDecimalDigit(e)||e===qe.PERIOD_CODE)return this.gobbleNumericLiteral();if(e===qe.SQUOTE_CODE||e===qe.DQUOTE_CODE)i=this.gobbleStringLiteral();else if(e===qe.OBRACK_CODE)i=this.gobbleArray();else{for(t=this.expr.substr(this.index,qe.max_unop_len),r=t.length;r>0;){if(qe.unary_ops.hasOwnProperty(t)&&(!qe.isIdentifierStart(this.code)||this.index+t.length<this.expr.length&&!qe.isIdentifierPart(this.expr.charCodeAt(this.index+t.length)))){this.index+=r;let n=this.gobbleToken();return n||this.throwError("missing unaryOp argument"),this.runHook("after-token",{type:qe.UNARY_EXP,operator:t,argument:n,prefix:!0})}t=t.substr(0,--r)}qe.isIdentifierStart(e)?(i=this.gobbleIdentifier(),qe.literals.hasOwnProperty(i.name)?i={type:qe.LITERAL,value:qe.literals[i.name],raw:i.name}:i.name===qe.this_str&&(i={type:qe.THIS_EXP})):e===qe.OPAREN_CODE&&(i=this.gobbleGroup())}return i?(i=this.gobbleTokenProperty(i),this.runHook("after-token",i)):this.runHook("after-token",!1)}gobbleTokenProperty(e){this.gobbleSpaces();let t=this.code;for(;t===qe.PERIOD_CODE||t===qe.OBRACK_CODE||t===qe.OPAREN_CODE||t===qe.QUMARK_CODE;){let r;if(t===qe.QUMARK_CODE){if(this.expr.charCodeAt(this.index+1)!==qe.PERIOD_CODE)break;r=!0,this.index+=2,this.gobbleSpaces(),t=this.code}this.index++,t===qe.OBRACK_CODE?(e={type:qe.MEMBER_EXP,computed:!0,object:e,property:this.gobbleExpression()},this.gobbleSpaces(),t=this.code,t!==qe.CBRACK_CODE&&this.throwError("Unclosed ["),this.index++):t===qe.OPAREN_CODE?e={type:qe.CALL_EXP,arguments:this.gobbleArguments(qe.CPAREN_CODE),callee:e}:(t===qe.PERIOD_CODE||r)&&(r&&this.index--,this.gobbleSpaces(),e={type:qe.MEMBER_EXP,computed:!1,object:e,property:this.gobbleIdentifier()}),r&&(e.optional=!0),this.gobbleSpaces(),t=this.code}return e}gobbleNumericLiteral(){let e="",t,r;for(;qe.isDecimalDigit(this.code);)e+=this.expr.charAt(this.index++);if(this.code===qe.PERIOD_CODE)for(e+=this.expr.charAt(this.index++);qe.isDecimalDigit(this.code);)e+=this.expr.charAt(this.index++);if(t=this.char,t==="e"||t==="E"){for(e+=this.expr.charAt(this.index++),t=this.char,(t==="+"||t==="-")&&(e+=this.expr.charAt(this.index++));qe.isDecimalDigit(this.code);)e+=this.expr.charAt(this.index++);qe.isDecimalDigit(this.expr.charCodeAt(this.index-1))||this.throwError("Expected exponent ("+e+this.char+")")}return r=this.code,qe.isIdentifierStart(r)?this.throwError("Variable names cannot start with a number ("+e+this.char+")"):(r===qe.PERIOD_CODE||e.length===1&&e.charCodeAt(0)===qe.PERIOD_CODE)&&this.throwError("Unexpected period"),{type:qe.LITERAL,value:parseFloat(e),raw:e}}gobbleStringLiteral(){let e="",t=this.index,r=this.expr.charAt(this.index++),i=!1;for(;this.index<this.expr.length;){let n=this.expr.charAt(this.index++);if(n===r){i=!0;break}else if(n==="\\")switch(n=this.expr.charAt(this.index++),n){case"n":e+=`
`;break;case"r":e+="\r";break;case"t":e+="	";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:e+=n}else e+=n}return i||this.throwError('Unclosed quote after "'+e+'"'),{type:qe.LITERAL,value:e,raw:this.expr.substring(t,this.index)}}gobbleIdentifier(){let e=this.code,t=this.index;for(qe.isIdentifierStart(e)?this.index++:this.throwError("Unexpected "+this.char);this.index<this.expr.length&&(e=this.code,qe.isIdentifierPart(e));)this.index++;return{type:qe.IDENTIFIER,name:this.expr.slice(t,this.index)}}gobbleArguments(e){let t=[],r=!1,i=0;for(;this.index<this.expr.length;){this.gobbleSpaces();let n=this.code;if(n===e){r=!0,this.index++,e===qe.CPAREN_CODE&&i&&i>=t.length&&this.throwError("Unexpected token "+String.fromCharCode(e));break}else if(n===qe.COMMA_CODE){if(this.index++,i++,i!==t.length){if(e===qe.CPAREN_CODE)this.throwError("Unexpected token ,");else if(e===qe.CBRACK_CODE)for(let a=t.length;a<i;a++)t.push(null)}}else if(t.length!==i&&i!==0)this.throwError("Expected comma");else{let a=this.gobbleExpression();(!a||a.type===qe.COMPOUND)&&this.throwError("Expected comma"),t.push(a)}}return r||this.throwError("Expected "+String.fromCharCode(e)),t}gobbleGroup(){this.index++;let e=this.gobbleExpressions(qe.CPAREN_CODE);if(this.code===qe.CPAREN_CODE)return this.index++,e.length===1?e[0]:e.length?{type:qe.SEQUENCE_EXP,expressions:e}:!1;this.throwError("Unclosed (")}gobbleArray(){return this.index++,{type:qe.ARRAY_EXP,elements:this.gobbleArguments(qe.CBRACK_CODE)}}},J3e=new Q3e;Object.assign(qe,{hooks:J3e,plugins:new Z3e(qe),COMPOUND:"Compound",SEQUENCE_EXP:"SequenceExpression",IDENTIFIER:"Identifier",MEMBER_EXP:"MemberExpression",LITERAL:"Literal",THIS_EXP:"ThisExpression",CALL_EXP:"CallExpression",UNARY_EXP:"UnaryExpression",BINARY_EXP:"BinaryExpression",ARRAY_EXP:"ArrayExpression",TAB_CODE:9,LF_CODE:10,CR_CODE:13,SPACE_CODE:32,PERIOD_CODE:46,COMMA_CODE:44,SQUOTE_CODE:39,DQUOTE_CODE:34,OPAREN_CODE:40,CPAREN_CODE:41,OBRACK_CODE:91,CBRACK_CODE:93,QUMARK_CODE:63,SEMCOL_CODE:59,COLON_CODE:58,unary_ops:{"-":1,"!":1,"~":1,"+":1},binary_ops:{"||":1,"&&":2,"|":3,"^":4,"&":5,"==":6,"!=":6,"===":6,"!==":6,"<":7,">":7,"<=":7,">=":7,"<<":8,">>":8,">>>":8,"+":9,"-":9,"*":10,"/":10,"%":10},right_associative:new Set,additional_identifier_chars:new Set(["$","_"]),literals:{true:!0,false:!1,null:null},this_str:"this"});qe.max_unop_len=qe.getMaxKeyLen(qe.unary_ops);qe.max_binop_len=qe.getMaxKeyLen(qe.binary_ops);var Tp=e=>new qe(e).parse(),eOe=Object.getOwnPropertyNames(qe);eOe.forEach(e=>{Tp[e]===void 0&&e!=="prototype"&&(Tp[e]=qe[e])});Tp.Jsep=qe;var tOe="ConditionalExpression",rOe={name:"ternary",init(e){e.hooks.add("after-expression",function(t){if(t.node&&this.code===e.QUMARK_CODE){this.index++;let r=t.node,i=this.gobbleExpression();if(i||this.throwError("Expected expression"),this.gobbleSpaces(),this.code===e.COLON_CODE){this.index++;let n=this.gobbleExpression();if(n||this.throwError("Expected expression"),t.node={type:tOe,test:r,consequent:i,alternate:n},r.operator&&e.binary_ops[r.operator]<=.9){let a=r;for(;a.right.operator&&e.binary_ops[a.right.operator]<=.9;)a=a.right;t.node.test=a.right,a.right=t.node,t.node=r}}else this.throwError("Expected :")}})}};Tp.plugins.register(rOe);var iOe=["+","-","*","/","(",")","==","!=",">","<",">=","<=","and","or","!","%","^",","],nOe=["0","1","2","3","4","5","6","7","8","9","."],aOe=["sin","cos","tan","asin","acos","atan","atan2","sqrt","abs","log","exp","floor","ceil","round","min","max","random"];function oOe(e){return typeof e!="string"?!1:!isNaN(e)&&!isNaN(parseFloat(e))}Tp.addBinaryOp("^",11,!0);function U8(e,t,r="number"){let i="";for(let o=0;o<e.length;o++){let s=e[o];if("objType"in s&&s.objType==="api"){let l=JSON.parse(s.id),c=l[0],d=t.getUserAPI(c);if(d!==void 0){let u=d.retrieveValue(l.slice(1));u!==void 0&&(i+=u)}continue}if("objType"in s&&s.objType==="webhook"){let l=JSON.parse(s.id),[c,d]=l,u=t.getUserWebhook(c);if(u!==void 0){let h=u.getParameterValue(d);h!==void 0&&(i+=h)}continue}if("id"in s){let l=e[o-1];if(o>0&&"id"in l){console.error("Two variables in a row",e);return}let c=t.getVariable(s.id),d=ta.getDisplayedValue(c);r==="number"&&ta.isTextValue(c)&&Array.isArray(c.textValue)&&c.textValue.length===1?d=parseFloat(d).toString():r==="boolean"&&ta.isBoolean(c)?d=c?"true":"false":r==="boolean"&&ta.isTextValue(c)&&!Array.isArray(c.textValue)&&(d='"'+d+'"'),i+=d;continue}else if(r==="string"){s.name!=='"'&&(s.name!=="+"||s.escaped)&&(i+=s.name),s.name==="+"&&!s.escaped&&i[i.length-1]==="\\"&&(i=i.slice(0,-1)+s.name);continue}if(s.name==="and"){i+="&&";continue}if(s.name==="or"){i+="||";continue}if(s.name==="True"){i+="true";continue}if(s.name==="False"){i+="false";continue}if(r==="boolean"&&!oOe(s.name)&&!nOe.includes(s.name)&&!iOe.includes(s.name)&&!aOe.includes(s.name.replace(/\($/g,""))){i+='"'+s.name+'"';continue}i+=s.name}if(r==="string")return i;if(e.length===0){if(r==="number")return 0;if(r==="boolean")return!1}let n;try{n=Tp(i)}catch(o){console.error(i,o);return}let a;try{a=zr(n)}catch(o){console.error(i,n,o)}return a}function zr(e){switch(e.type){case"BinaryExpression":switch(e.operator){case"==":return+(zr(e.left)===zr(e.right));case"!=":return+(zr(e.left)!==zr(e.right));case">":return+(zr(e.left)>zr(e.right));case">=":return+(zr(e.left)>=zr(e.right));case"<":return+(zr(e.left)<zr(e.right));case"<=":return+(zr(e.left)<=zr(e.right));case"+":return zr(e.left)+zr(e.right);case"-":return zr(e.left)-zr(e.right);case"*":return zr(e.left)*zr(e.right);case"/":return zr(e.left)/zr(e.right);case"%":return zr(e.left)%zr(e.right);case"&&":return zr(e.left)&&zr(e.right);case"||":return zr(e.left)||zr(e.right);case"^":return Math.pow(zr(e.left),zr(e.right));default:throw new Error("Unknown operator: "+e.operator)}case"UnaryExpression":switch(e.operator){case"-":return-zr(e.argument);case"!":return+!zr(e.argument);default:throw new Error("Unknown operator: "+e.operator)}case"Identifier":throw new Error("Unknown identifier: "+e.name);case"Literal":return e.value;case"CallExpression":if(e.callee.type==="Identifier"){if(e.callee.name==="random"){let t=0,r=1;if(e.arguments.length>=1)try{t=zr(e.arguments[0])}catch(i){console.warn(i)}if(e.arguments.length>=2)try{r=zr(e.arguments[1])}catch(i){console.warn(i)}return t=Math.min(r,t),r=Math.max(r,t),t+Math.random()*(r-t)}return Math[e.callee.name].apply(null,e.arguments.map(zr))}else throw new Error("Unknown node");default:throw new Error("Unknown node type: "+e.type)}}var sOe=new it,lOe=new it;function cOe(e,t,r){let i=[new k,new k,new k],n=[new k,new k,new k];return e.extractBasis(i[0],i[1],i[2]),t.extractBasis(n[0],n[1],n[2]),i.forEach((a,o)=>{let s=n[o],l=St.lerp(a.length(),s.length(),r);a.lerp(s,r).setLength(l)}),new it().makeBasis(i[0],i[1],i[2])}var dOe=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,height:100,depth:1,subdivisions:12,roundness:0,extrudeBevelSize:0,extrudeBevelSegments:3},e.parameters),i=Math.abs(r.width),n=Math.abs(r.height??r.width),a=Math.abs(r.depth??0),o=(t==null?void 0:t.shapeData)??XP.create({parameters:d8}).userData.shape;return{path:e.path??Fx.defaultData(),parameters:Object.assign(r,{width:i,height:n,depth:a,extrusion:{...u8,...r.extrusion}}),shapeData:o}}static build(e){if(e.path.points.length>=2){let t=new uOe(e);return Object.assign(t,{userData:{...e,type:"PathGeometry"}})}else return Object.assign(new Ot,{userData:{...e,type:"PathGeometry"}})}},uOe=class extends Ot{constructor(e){super(),this.type="PathExtrusionGeometry",this.inputs=e,this.build()}_isGeometryClosed(){return this.inputs.path.isClosed&&this.inputs.parameters.extrusion.depth===1}_isOpenEnded(){let e=this.inputs.parameters.extrusion;return!(this.inputs.path.isClosed&&e.depth===1)||!K3e(e.twist,0)||e.startScale!==e.endScale}build(){let e=this._extractPathPoints();if(e.length<2)return;let t=this._computeBasisMatrices(e),{depth:r,offset:i}=this.inputs.parameters.extrusion;r=Math.max(0,Math.min(r,1)),i=Math.max(0,Math.min(i,1));let n=this.inputs.path.isClosed?e.length:e.length-1,a=Math.floor(i*n),o=this.inputs.path.isClosed?Math.ceil((r+i)*n):Math.ceil(Math.min(1,r+i)*n),s=Math.min(Math.max(2,o-a+1),n+2),l=[],c=[];for(let N=0;N<s;N++){let U=this.inputs.path.isClosed?(N+a)%e.length:Math.min(N+a,e.length-1);l.push(e[U].clone()),c.push(t[U].clone())}let d=(N,U,ie)=>{l[N]=l[N].clone().lerp(l[U],ie),c[N]=cOe(c[N],c[U],ie)},u=0,h=i*n%1;(!this.inputs.path.isClosed||r<=1)&&(h||i===0)&&(u=h,d(0,1,u));let f=0,p=(i+r)*n%1;if((this.inputs.path.isClosed&&r<=1||!this.inputs.path.isClosed&&i+r<1)&&p&&(f=p,d(l.length-1,l.length-2,1-f)),r===0){let N=l.length-1;l[N].copy(l[0]),c[N].copy(c[0])}this._applyPathModifiers(c,u,f);let{bevel:v,bevelSides:m}=this.inputs.parameters.extrusion,g=v>0?this.inputs.parameters.extrusion.capType:"flat",y=5;this.inputs.parameters.extrusion.shape.type==="Custom"&&(y=this.inputs.parameters.extrusion.shape.shapeQuality==="low"?5:12);let{regions:b,infos:x,vertices:S}=this._computeShapePoints(y),w=0,_;g==="round"&&(_=new YP(this.inputs.shapeData,2*v,v,y,m,void 0,!0),w=_.getAttribute("position").count);let C=0,A=0;x.sort((N,U)=>N.start-U.start),x.forEach(N=>{N.verticesStart=C,N.verticesCount=N.continuous.reduce((U,ie,te)=>U+(te===0||!ie?2:1),0),A+=N.verticesCount,C=A});let M=A*s,P,T=0;if(this._isOpenEnded()&&g==="flat"){try{P=ad({windingRule:ti.ODD,elementType:an.POLYGONS,polySize:3,vertexSize:2,strict:!0,contours:b})}catch{P=P8}T=P.vertexCount}let R=M+2*T+w*2,z=M+2*T,F={positions:new Float32Array(R*3),normals:new Float32Array(R*3),uvs:new Float32Array(R*2)},H=[];if(x.forEach(N=>{this._extrudeRegion(N,S,c,l,F,H,this._isGeometryClosed()&&!this._isOpenEnded())}),P&&(this._closeEnd(P,M,H,F,c[0],l[0],!1),this._closeEnd(P,M+T,H,F,c[c.length-1],l[l.length-1],!0)),_){F.positions.set(_.getAttribute("position").array,z*3),F.normals.set(_.getAttribute("normal").array,z*3),F.uvs.set(_.getAttribute("uv").array,z*2);for(let te=z;te<z+w;te++)F.uvs[te*2+1]=1e-4;let N=H.length;H.push(..._.getIndex().array.map(te=>te+z)),z+=w,F.positions.set(_.getAttribute("position").array,z*3),F.normals.set(_.getAttribute("normal").array,z*3),F.uvs.set(_.getAttribute("uv").array,z*2);let U=H.length;H.push(..._.getIndex().array.map(te=>te+z)),this.setAttribute("position",new $t(F.positions,3)),this.setAttribute("normal",new $t(F.normals,3)),this.setAttribute("uv",new $t(F.uvs,2)),this.setIndex(H);let ie=sOe;ie.copy(c[c.length-1]).setPosition(l[l.length-1]),this.applyMatrix4OnRange(ie,z,R),ie.copy(c[0]).setPosition(l[0]).multiply(lOe.makeScale(1,1,-1)),this.applyMatrix4OnRange(ie,z-w,z),this.reverseIndicesOnRange(N,U)}else this.setAttribute("position",new $t(F.positions,3)),this.setAttribute("normal",new $t(F.normals,3)),this.setAttribute("uv",new $t(F.uvs,2)),this.setIndex(H)}_extractPathPoints(){let e=x8(this.inputs.path).getPoints(this.inputs.path.subdivisions);if(e.length<2)return[];let t=[e[0]];return e.forEach(r=>{t[t.length-1].distanceToSquared(r)>.001&&t.push(r)}),this.inputs.path.isClosed&&t[t.length-1].distanceTo(t[0])<.001&&t.pop(),t}_computeBasisMatrices(e){let t=[],r=e.length,i=this.inputs.path.isClosed,n=new k,a=new k,o=new k,s=new k,l=new k(0,1,0);for(let p=0;p<r;p++){let v=e[p],m;p===0?m=i?e[e.length-2]:v.clone().multiplyScalar(2).sub(e[1]):m=e[p-1];let g;p===r-1?g=i?e[1]:v.clone().multiplyScalar(2).sub(e[p-1]):g=e[p+1];let y=v.clone().sub(m).normalize(),b=g.clone().sub(v).normalize(),x=y.clone().add(b).normalize();o.copy(x),p===0&&(x.equals(l)||x.clone().negate().equals(l))&&l.set(0,0,1);let S=l.clone().cross(x).normalize(),w=x.clone().cross(S).normalize();l.copy(w),s.copy(S),p===0&&(n.copy(w),a.copy(x));let _=new it().makeBasis(S,w,x);t.push(_)}let c=i?a:o,d=i?n:new k(0,1,0),u=c.clone().cross(s).normalize(),h=Math.acos(d.dot(u));if(isNaN(h))return t;let f=d.clone().cross(u);c.dot(f)>0&&(h*=-1);for(let p=1;p<t.length;p++){let v=new it().makeRotationZ(h*p/t.length);t[p].multiply(v)}return t}_applyPathModifiers(e,t,r){let i=e.length,{angle:n,twist:a,startScale:o,endScale:s}=this.inputs.parameters.extrusion,l=new it,c=new it;return e.forEach((d,u)=>{let h=u===0?0:u===i-1?1:(u-t)/(i-(r===0?0:1)-(t+(1-r)));l.makeRotationZ(St.lerp(n,n+a,h)*St.DEG2RAD);let f=St.lerp(o,s,h);c.makeScale(f,f,f),d.multiply(l).multiply(c)}),e}_computeShapePoints(e=12,t=ti.ODD){let r=this.inputs.shapeData,i=r.extractShapePointsToFlatArray([],e),n=r.shapeHoles.map(c=>{let d=c.extractShapePointsToFlatArray([],e),u=[];for(let h=d.length-1;h>=1;h-=2){let f=d[h-1],p=d[h-0];u.push(f,p)}return u}),a;try{a=ad({windingRule:t,elementType:an.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[i]})}catch{a=qP}let o;try{o=ad({windingRule:ti.ODD,elementType:an.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[...n]})}catch{o=T8}if(!a)throw new Error("error generating geometry");let s=a.elementCount;if(o){a.elementCount+=o.elementCount;for(let c=0;c<o.elements.length;c++){let d=o.elements[c],u=c%2===0?a.vertexCount:0;a.elements.push(d+u)}for(let c=0;c<o.vertexIndices.length;c++){let d=o.vertexIndices[c],u=a.vertexCount;a.vertexIndices.push(d+u)}for(let c=0;c<o.vertices.length;c++){let d=o.vertices[c];a.vertices.push(d)}}for(let c=0,d=a.vertexCount;c<d;c++){let u=c*2;a.vertices[u+0],a.vertices[u+1]}let l=[];for(let c=a.elementCount-1;c>=0;c--){let d=c>=s,u=c*2,h=a.elements[u+0],f=a.elements[u+1],p=h+f,v={start:h,count:f,normals:[],isHole:d,continuous:[],verticesStart:0,verticesCount:0};l.push(v);let m=h,g=p-1,y=h+1,b=r.roundedCurves.length;do{let x=m-h;a.vertices[g*2+0],a.vertices[g*2+1];let S=a.vertices[m*2+0],w=a.vertices[m*2+1],_=a.vertices[y*2+0],C=a.vertices[y*2+1],A=S-_,M=w-C,P=Math.sqrt(A*A+M*M);A/=P,M/=P,v.normals[x*2+0]=-M,v.normals[x*2+1]=A;let T=a.vertexIndices[m];if(Array.isArray(T))v.continuous[x]=!1;else{let[R,z]=r.getCurveIndexFromVertexId(T-1,!0);if(z>0&&z<1)v.continuous[x]=!0;else{let F=z===1?R+1:R-1;F=(F+b)%b;let H=z===1?0:1,N=r.roundedCurves[R].getTangent(z),U=r.roundedCurves[F].getTangent(H);v.continuous[x]=N.dot(U)>.95}}d&&(v.normals[x*2+0]*=-1,v.normals[x*2+1]*=-1),[g,m,y]=[m,y,y+1],y>=p&&(y-=f)}while(y!==h+1)}return{regions:[i,...n],infos:l,vertices:a.vertices}}_insertVertex(e,t,r,i,n){let a=t*2,o=t*3;e.positions[o+0]=r.x,e.positions[o+1]=r.y,e.positions[o+2]=r.z,e.normals[o+0]=i.x,e.normals[o+1]=i.y,e.normals[o+2]=i.z,e.uvs[a+0]=n.x,e.uvs[a+1]=n.y}_extrudeRegion(e,t,r,i,n,a,o){let s=new k,l=new k,c=new k,d=new k,u=new ye;r.forEach((f,p)=>{let v=i[p],m=e.verticesStart*r.length+e.verticesCount*p;for(let g=0;g<e.count;g++){let y=(e.start+g)*2;if(s.set(t[y+0],t[y+1],0),c.copy(s).applyMatrix4(f).add(v),e.continuous[g])d.set(e.normals[g*2+0],e.normals[g*2+1],0);else{let b=g===0?(e.start+e.count-1)*2:y-2;l.set(t[b+0],t[b+1],0),d.copy(s).sub(l),d.set(-d.y,d.x,0),e.isHole||d.negate()}if(d.applyMatrix4(f).normalize(),u.set(g===0?1:g/e.count,p/(r.length-1)),this._insertVertex(n,m,c,d,u),m++,!e.continuous[g]||g===0){if(g===0)d.set(e.normals[g*2+0],e.normals[g*2+1],0),u.set(0,p/(r.length-1));else{let b=g===e.count-1?e.start*2:y+2;l.set(t[b+0],t[b+1],0),d.copy(l).sub(s),d.set(-d.y,d.x,0),e.isHole||d.negate()}d.applyMatrix4(f).normalize(),this._insertVertex(n,m,c,d,u),m++}}});let h=r.length-1;for(let f=0;f<h;f++){let p=e.verticesStart*r.length+e.verticesCount*f,v=e.verticesStart*r.length+e.verticesCount*(f+1),m=0;for(let g=0;g<e.count;g++){(!e.continuous[g]||g===0)&&m++;let y=g===e.count-1?0:m+1,b=p+m,x=p+y,S=v+y,w=v+m;e.isHole?a.push(b,S,x,b,w,S):a.push(b,x,S,b,S,w),m++}}}_closeEnd(e,t,r,i,n,a,o){let s=e.vertexCount,l=new k(0,0,o?-1:1).applyMatrix4(n),c=new k,d=new ye;for(let h=0;h<s;h++){let f=2*h;c.set(e.vertices[f+0],e.vertices[f+1],0).applyMatrix4(n).add(a),this._insertVertex(i,t+h,c,l,d)}let u=e.elements;for(let h=0;h<e.elementCount;h++){let f=3*h,p=u[f+0]+t,v=u[f+(o?1:2)]+t,m=u[f+(o?2:1)]+t;r.push(p,v,m)}}applyMatrix4OnRange(e,t,r){let i=e.elements,n=new sn().getNormalMatrix(e).elements,a,o,s,l,c=this.attributes.position,d=this.attributes.normal;if(!c||!d)return;let u=c.array,h=d.array,f=c.itemSize;for(let p=t*f,v=r*f;p<v;p+=f){if(p===t)debugger;a=u[p+0],o=u[p+1],s=u[p+2],l=1/(i[3]*a+i[7]*o+i[11]*s+i[15]),u[p+0]=(i[0]*a+i[4]*o+i[8]*s+i[12])*l,u[p+1]=(i[1]*a+i[5]*o+i[9]*s+i[13])*l,u[p+2]=(i[2]*a+i[6]*o+i[10]*s+i[14])*l,a=h[p+0],o=h[p+1],s=h[p+2],h[p+0]=n[0]*a+n[3]*o+n[6]*s,h[p+1]=n[1]*a+n[4]*o+n[7]*s,h[p+2]=n[2]*a+n[5]*o+n[8]*s}c.needsUpdate=!0,d.needsUpdate=!0}reverseIndicesOnRange(e,t){let r=this.index;if(r){for(let i=e;i<t;i+=3){let n=r.getX(i),a=r.getX(i+1),o=r.getX(i+2);r.setXYZ(i,o,a,n)}r.needsUpdate=!0}}};function j8(){let e=new Ot;return e.setAttribute("position",new $t(new Float32Array([]),3)),e.setIndex(new $t(new Uint16Array([]),1)),e}var hOe=j8().attributes,fOe=12,pOe=1,WM=class extends Ot{constructor(e,t){super(),this.charWidths=[],this.charCoords=[],this.wrappedText=[],this.isLowResolution=!1,this.vectorShapes=[],Object.assign(this.attributes,hOe),this.userData={parameters:e,type:"TextGeometry"};let r=t.getFont(e.font);r!=null&&r.isLoaded?(this.font=r,this.update(e)):this.updateFont(e.font,t).then(()=>{this.update(e),t==null||t.requestRender()})}async updateFont(e,t){let r=t.getFont(e);r&&(this.font=r,await r.loadingPromise)}update(e){let t=this.font;if(this.userData={parameters:e,type:"TextGeometry"},!(t!=null&&t.isLoaded)){console.warn("Cannot update text because its font is not loaded");return}let{width:r,height:i,depth:n,extrudeBevelSize:a,extrudeBevelSegments:o,text:s,textTransform:l}=e,c=ta.getDisplayedValue(s),d=l===2?c.toUpperCase():l===3?c.toLowerCase():c,u=mOe(e,t,d),{shapes:h,charWidths:f,charCoords:p}=t.generateShapes(u,e),v=(typeof r=="number"?r:1)*.5,m=(typeof i=="number"?i:1)*.5,g=h.map(x=>new Bi().fromShape(x,!0));this.vectorShapes=g;let y=g.map(x=>_h.create({shape:x,parameters:{depth:n,extrudeBevelSegments:o,extrudeBevelSize:a,windingRule:n<=0?ti.NONZERO:ti.ODD,subdivisions:this.isLowResolution&&n>0?pOe:fOe}})),b=y.length?Pu(y):j8();b.translate(-v,m,0),this.dispose(),this.wrappedText=u,this.charCoords=p,this.charWidths=f,this.deleteAttribute("extrudeNormal"),Object.entries(b.attributes).forEach(([x,S])=>{this.setAttribute(x,S)}),this.setIndex(b.index),this.computeBoundingSphere()}clone(){let e=No(new Ot,WM.prototype);return e.copy(this),console.log("CloneGeometry",this,e),e}copy(e){return Object.entries(e.attributes).forEach(([t,r])=>{this.setAttribute(t,r)}),this.setIndex(e.index),this.userData={parameters:{...e.userData.parameters},type:"TextGeometry"},this}async setText(e){this.font&&await this.font.loadingPromise,await this.update({...this.userData.parameters,text:{textValue:e}})}get text(){return this.userData.parameters.text??""}};function mOe(e,t,r){let i=[""],n="";for(let a of r)n+=a,a===" "||a===`
`?(i[i.length-1]+=n,n="",a===`
`&&i.push("")):t.getTextWidth(i[i.length-1]+n,e)>e.width&&(i[i.length-1].length&&i.push(""),t.getTextWidth(i[i.length-1]+n,e)>e.width&&(n.length===1?(i[i.length-1]+=n,n=""):(i[i.length-1]+=n.slice(0,-1),n=n[n.length-1],i.push(""))));return i[i.length-1]+=n,i}var V8,H8=new Promise(e=>{V8=e}),jL=!1,Oy;function vOe(){if(jL)return;if(Oy)return Oy;async function e(){let t="https://unpkg.com/@splinetool/modelling-wasm@1.9.21/build",r=Nd(()=>import("./process-B9H0U9ag.js"),[]),[i,n]=await Promise.all([r,fetch(`${t}/process.wasm`).then(s=>s.arrayBuffer())]),a=i.default,o=await a({wasmBinary:n});V8(o),jL=!0}return Oy=e(),Oy}var gOe=["font"];function Cg(e,t,r,i){var c,d;let n,a,o;e.type==="PathGeometry"?(a=JSON.parse(JSON.stringify(e)),o=[[],["extrusion"]]):(a={...e},o=[[]]);for(let u of o){let h=a;for(let f of u)h=h[f];for(n in h){let f=h[n];Hk(f)&&!gOe.includes(n)&&(h[n]=t.getVariable(f,[i.uuid,"geometry",...u,n]),Hk(h[n])&&(h[n]=1))}}let s={parameters:a,type:a.type};if(a.type==="PathGeometry")s.path=a.path;else if(a.type==="VectorGeometry"){let u=Bi.createFromState(a.shape,a.width,a.height);s.shape=u}else if(a.type==="NonParametricGeometry"){if(a.data.groups&&((c=a.data.groups)==null||c.forEach(u=>u.materialIndex=Math.max(u.materialIndex??0,0))),s.geometry=new Hj().parse(a),s.geometry.groups.length===0){let u=s.geometry;u.addGroup(0,Math.max(((d=u.getIndex())==null?void 0:d.count)??0,u.getAttribute("position").count),0)}}else if(a.type==="SubdivGeometry"){let u=new _a(a,r);return u.data=e,u}else{if(a.type==="TextGeometry")return new WM(a,t);if(a.type==="InputGeometry")return new WM(a,t);if(a.type==="UIGeometry")return KP.create({parameters:{width:a.width,height:a.height,cornerRadius:a.cornerRadius,cornerType:a.cornerType}})}let l;try{l=$L(s)}catch(u){console.error(u)}if(!l){let u=Bi.createFromState(Bx.defaultData(),100,100);s.shape=u,l=$L(s)}return l}var yOe=new it;function GM(e,t,r,i){let n=e.position.array,a=e.normal.array,o=yOe.makeScale(t,r,i).invert().elements,s,l,c;for(var d=0,u=n.length;d<u;d+=3)n[d]*=t,n[d+1]*=r,n[d+2]*=i,s=a[d],l=a[d+1],c=a[d+2],a[d]=o[0]*s+o[4]*l+o[8]*c,a[d+1]=o[1]*s+o[5]*l+o[9]*c,a[d+2]=o[2]*s+o[6]*l+o[10]*c;e.position.needsUpdate=!0,e.normal.needsUpdate=!0}var Ry=new Zi,of=new k,Ut;H8.then(e=>{Ut=e});var VL=new Float32Array([10,10,0,-10,10,0,-10,-10,0,10,-10,0]),HL=new Uint32Array([0,1,2,3]),WL=new Uint8Array([4]),_a=class extends Ot{constructor(e,t){super(),this.data=e,this.flatShading=t,this.subdivPointer=0,this.rebuild(),this.freeSubdivPointer()}mutateDirectlyScaleBaked(e,t){this.freeSubdivPointer();let r=this.data.scaleBaked,i=Vu.div(t,r);this.subdividedGeometry&&GM(this.subdividedGeometry.attributes,...i),this.originalGeometry&&GM(this.originalGeometry.attributes,...i),this.data=e;let n=this.userData.parameters;this.userData.parameters={width:n.width*i[0],height:n.height*i[1],depth:n.depth*i[2]},this.originalGeometry.boundingSphere.center.multiply(of.fromArray(i));let a=of.set(n.width,n.height,n.depth).length();this.originalGeometry.boundingSphere.radius=a/2}ensureSubdivPointer(){return this.subdivPointer===0&&this.rebuild(),this.subdivPointer}rebuild(){let e,t,r;try{({originalGeometry:e,subdividedGeometry:t,subdivPointer:r}=_a.build(this.data,void 0,!this.flatShading,void 0))}catch{e=new fs(100,100,100),r=0}this.subdivPointer=r,this.originalGeometry=e,this.subdividedGeometry=t??void 0;let i=this.subdividedGeometry??this.originalGeometry;Object.assign(this,i),this.calcBoundingBox()}freeSubdivPointer(){this.subdivPointer&&(_a.freeSubdivPointer(this.subdivPointer),this.subdivPointer=0)}dispose(){super.dispose(),this.freeSubdivPointer()}calcBoundingBox(){let e=this.originalGeometry;e.boundingSphere===null&&(e.boundingSphere=new Za,this.subdividedGeometry&&(this.subdividedGeometry.boundingSphere=e.boundingSphere));let t=e.attributes.position,r=e.boundingSphere.center;Ry.setFromBufferAttribute(t),Ry.getCenter(r),e.boundingSphere.radius=r.distanceTo(Ry.max),isNaN(e.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this),Ry.getSize(of);let i={width:of.x,height:of.y,depth:of.z};return this.userData.parameters=i,i}static build(e,t,r,i){let n,a,o,s=(e==null?void 0:e.phongAngle)??35;r===!1&&(s=-1),t&&(Ut.free_bvh(t),Ut.free_subdivision_surface(t));try{n=_a.allocate(e,i)}catch(l){console.error(l,e),n=_a.allocate({positionWASM:VL,indexWASM:HL,verticesPerFaceWASM:WL},i)}if(Ut.set_destination_refinement_level(n,0),a=_a.buildLevel(n,!0,s),e.subdivisions>0)try{Ut.set_destination_refinement_level(n,e.subdivisions),o=_a.buildLevel(n,!1,s)}catch{try{Ut.set_destination_refinement_level(n,e.subdivisions-1),o=_a.buildLevel(n,!1,s)}catch{o=null}}else o=null;return{subdivPointer:n,originalGeometry:a,subdividedGeometry:o}}static primitiveToQuads(e,t,r){e.widthSegments>16&&(e.widthSegments=16),e.heightSegments>16&&(e.heightSegments=16),e.depthSegments>16&&(e.depthSegments=16),e.radialSegments>16&&(e.radialSegments=16),e.type==="DodecahedronGeometry"&&(e.detail=0);let i=e.shape!==void 0||e.path!==void 0?t.geometry:Cg(e,r,!1),n;e.type==="TorusGeometry"&&e.arc===Math.PI*2?n=i.getClosedTorusIndicesForBooleanOrSubdiv():n=i.getIndex();let a,o,s,l;({positions:a,triIndices:l}=pw(i.getAttribute("position"),n));let c;if(e.type==="CylinderGeometry"&&e.cornerRadius===0&&e.hollow===0&&e.openEnded===!1){let d=e.radialSegments*e.heightSegments*3*2,u=d+e.radialSegments*3;c=[d,u]}return{indices:o,verticesPerFace:s}=W8(a,l,i,c),{positions:a,indices:o,verticesPerFace:s}}static allocate(e,t){var b;let r,i,n,a=[],o=[];e.positionWASM&&e.positionWASM.length>0?(r=e.positionWASM,i=e.indexWASM,n=e.verticesPerFaceWASM):(r=VL,i=HL,n=WL);let s=r.length,l=i.length,c=n.length,d=r.length+a.length+o.length,u=i.length+n.length,h=d*Float32Array.BYTES_PER_ELEMENT+u*Uint32Array.BYTES_PER_ELEMENT,f=d*Float32Array.BYTES_PER_ELEMENT,p=Ut._malloc(h),v=new Float32Array(Ut.HEAPF32.buffer,p,d),m=new Uint32Array(Ut.HEAPU32.buffer,p+f,u);v.set(r,0),v.set(a,r.length),v.set(o,r.length+a.length),m.set(i,0),m.set(n,i.length);let g;(b=e==null?void 0:e.scaleBaked)!=null&&b.some(x=>x!==1)&&(g=new it().makeScale(...e.scaleBaked)),t&&(g?g.premultiply(t):g=t);let y=g?Ut.alloc_subdivision_surface2(p,s,p+f,l,p+f+i.length*Uint32Array.BYTES_PER_ELEMENT,c,g.elements):Ut.alloc_subdivision_surface(p,s,p+f,l,p+f+i.length*Uint32Array.BYTES_PER_ELEMENT,c);return Ut._free(p),y}static buildLevel(e,t,r,i,n){let a=n?Ut.get_mesh_data2(e,t?Ut.Level.CONTROL:Ut.Level.REFINED,r,n.elements):Ut.get_mesh_data(e,t?Ut.Level.CONTROL:Ut.Level.REFINED,r),o=8,s=Ut.HEAPU32.subarray(a>>2,(a>>2)+o),l=s.subarray(4,8),c=0,d=Ut.HEAPU32[s[c]>>2],u=Ut.HEAPF32.subarray(d>>2,(d>>2)+l[c]);c++;let h=Ut.HEAPU32[s[c]>>2],f=Ut.HEAPF32.subarray(h>>2,(h>>2)+l[c]);c++;let p=Ut.HEAPU32[s[c]>>2],v=Ut.HEAPU32.subarray(p>>2,(p>>2)+l[c]);c++;let m=Ut.HEAPU32[s[c]>>2],g=Ut.HEAPU32.subarray(m>>2,(m>>2)+l[c]);if(c++,i===void 0){let y=new Ot;if(y.setIndex(new Vf(g,1)),y.setAttribute("position",new yt(u,3)),y.setAttribute("normal",new yt(f,3)),t){y.setAttribute("faceMap",new Vf(v,1));let b=new Float32Array(f.length/3*4).fill(0);y.setAttribute("color",new $t(b,4))}return Ut.free_mesh_data(a),y.userData.type="SubdivGeometry",y}i.getAttribute("position").copyArray(u),i.getAttribute("normal").copyArray(f),i.attributes.position.needsUpdate=!0,i.attributes.normal.needsUpdate=!0,Ut.free_mesh_data(a)}static freeSubdivPointer(e){Ut.free_bvh(e),Ut.free_subdivision_surface(e)}static buildControlCageWireframe(e,t,r){let i=Ut.get_wireframe_data_for_base_level(e),n=4,a=Ut.HEAPU32.subarray(i>>2,(i>>2)+n),o=a.subarray(2,4),s=0,l=Ut.HEAPU32[a[s]>>2],c=Ut.HEAPF32.subarray(l>>2,(l>>2)+o[s]);s++;let d=Ut.HEAPU32[a[s]>>2],u=Ut.HEAPU32.subarray(d>>2,(d>>2)+o[s]);if(t===void 0){let h=new Ot;h.setAttribute("position",new yt(c,3));let f=new Float32Array(c.length);for(let p=0,v=c.length;p<v;)f[p++]=r.r,f[p++]=r.g,f[p++]=r.b;return h.setAttribute("color",new $t(f,3)),h.setIndex(new Vf(u,1)),Ut.free_wireframe_data_for_base_level(i),h}t.getAttribute("position").copyArray(c),t.attributes.position.needsUpdate=!0,Ut.free_wireframe_data_for_base_level(i)}static updateCollabMesh(e,t,r){let i=t===0;i||Ut.set_destination_refinement_level(e,t);let n=r?Ut.get_topological_data2(e,i?Ut.Level.CONTROL:Ut.Level.REFINED,r.elements):Ut.get_topological_data(e,i?Ut.Level.CONTROL:Ut.Level.REFINED),a=6,o=Ut.HEAPU32.subarray(n>>2,(n>>2)+a),s=o.subarray(3,6),l=0,c=Ut.HEAPU32[o[l]>>2],d=new Float32Array(Ut.HEAPF32.subarray(c>>2,(c>>2)+s[l]));l++;let u=Ut.HEAPU32[o[l]>>2],h=new Uint32Array(Ut.HEAPU32.subarray(u>>2,(u>>2)+s[l]));l++;let f=Ut.HEAPU32[o[l]>>2],p=new Uint8Array(Ut.HEAPU32.subarray(f>>2,(f>>2)+s[l]));return Ut.free_topological_data(n),{positions:d,indices:h,verticesPerFace:p}}},GL=["getX","getY","getZ"];function pw(e,t){let r={},i=t?t.count:e.count,n=0,a=[],o=[],s=1e4;for(let c=0;c<i;c++){let d=t?t.getX(c):c,u="";for(let h=0;h<3;h++)u+=`${~~(e[GL[h]](d)*s)},`;if(u in r)a.push(r[u]);else{for(let h=0;h<3;h++)o.push(e[GL[h]](d));r[u]=n,a.push(n),n++}}let l=[];for(let c=0;c<a.length;c+=3)a[c]===a[c+1]||a[c]===a[c+2]||a[c+1]===a[c+2]||l.push(a[c],a[c+1],a[c+2]);return{positions:o,triIndices:l}}var Iy=new k,NC=new k,UC=new k,jC=new k;function W8(e,t,r,i){let n=[],a=[];if(r.userData.shape!==void 0&&r.userData.parameters.depth===0&&r.userData.shape.shapeHoles.length===0){let l=r.userData.shape.extractShapePointsToFlatArray([]),c=r.userData.parameters.spikes;if(r.userData.type==="EllipseGeometry"&&c<=24&&c%4===0&&r.userData.parameters.angle>=360){let h=l.length/2/c;l=l.filter((f,p)=>Math.floor(p/2)%h===0)}let d=0;for(let h=0;h<l.length;h+=2)d+=(l[h]-l[(h===0?l.length:h)-2])*(l[h+1]+l[(h===0?l.length:h)-1]);e.length=0;let u=0;if(d<0)for(let h=0;h<l.length;h+=2)e.push(l[h],l[h+1],0),n.push(u++);else for(let h=l.length-2;h>=0;h-=2)e.push(l[h],l[h+1],0),n.push(u++);return a.push(u),{indices:n,verticesPerFace:a}}let o=new Float32Array([r.userData.parameters.depth])[0],s=0;for(;s<t.length;){if(r.useNgonForTopBottomFaceDuringBake){let l=0;if((e[t[s]*3+2]===o||e[t[s]*3+2]===0)&&l++,(e[t[s+1]*3+2]===o||e[t[s+1]*3+2]===0)&&l++,(e[t[s+2]*3+2]===o||e[t[s+2]*3+2]===0)&&l++,l===3)break}if(t[s+1]===t[s+3]&&t[s+2]===t[s+5]||t[s+0]===t[s+3]&&t[s+2]===t[s+4]){Iy.set(e[t[s]*3],e[t[s]*3+1],e[t[s]*3+2]),NC.set(e[t[s+1]*3],e[t[s+1]*3+1],e[t[s+1]*3+2]),UC.set(e[t[s+4]*3],e[t[s+4]*3+1],e[t[s+4]*3+2]),jC.set(e[t[s+5]*3],e[t[s+5]*3+1],e[t[s+5]*3+2]),NC.sub(Iy).normalize(),UC.sub(Iy).normalize(),jC.sub(Iy).normalize();let l=NC.cross(UC).dot(jC);Math.abs(l)>.005||i&&i.some((c,d)=>d%2===1?!1:s>=i[d]&&s<i[d+1])?(n.push(t[s],t[s+1],t[s+2]),a.push(3),s+=3):(n.push(t[s],t[s+1],t[s+4],t[s+5]),a.push(4),s+=6)}else n.push(t[s],t[s+1],t[s+2]),a.push(3),s+=3}if(r.useNgonForTopBottomFaceDuringBake){let l=[],c=[],d=0;for(let u=0,h=0;u<e.length;u+=3,h++)e[u+2]===0&&(l.push(h),d++),e[u+2]===o&&c.push(h);if(r.userData.parameters.extrudeBevelSize===0){let u=c[0];c[0]=c[1],c[1]=u}l.reverse(),n.push(...l,...c),a.push(d,d)}return{indices:n,verticesPerFace:a}}var kl={};Ame(kl,{calcBoolean:()=>COe,calcBooleanTopological:()=>SOe,freeMeshSet:()=>EOe,getMeshSet:()=>_Oe,hasOpenEdges:()=>AOe,transformMeshSet:()=>MOe});var G8,bOe=new Promise(e=>{G8=e}),zy;function xOe(){if(zy)return zy;async function e(){let t="https://unpkg.com/@splinetool/boolean-wasm@1.9.21/build",r=Nd(()=>import("./boolean-BpCokwB2.js"),[]),[i,n]=await Promise.all([r,fetch(`${t}/boolean.wasm`).then(s=>s.arrayBuffer())]),a=i.default,o=await a({wasmBinary:n});G8(o)}return zy=e(),zy}var gr,Xf;bOe.then(e=>gr=e);function wOe(e,t,r){let i,n;e.userData.parameters.type==="TorusGeometry"&&e.userData.parameters.arc===Math.PI*2?n=e.getClosedTorusIndicesForBooleanOrSubdiv():n=e.getIndex();let{positions:a,triIndices:o}=pw(e.getAttribute("position"),n),s;if(t&&r){let{indices:l,verticesPerFace:c}=W8(a,o,e);s=c.length,i=[];for(let d=0,u=0;d<s;d++){i.push(c[d]);for(let h=0;h<c[d];h++)i.push(l[u++])}}else{let l=o.length;i=Array(l+l/3),s=0;for(let c=0,d=0;d<i.length;)i[d++]=3,s++,i[d++]=o[c++],i[d++]=o[c++],i[d++]=o[c++]}return{positions:a,faceIndices:i,nFaces:s}}function $8(e){let t=e.length,r=t*Uint32Array.BYTES_PER_ELEMENT,i=t*Float32Array.BYTES_PER_ELEMENT,n=Number.isInteger(e[0])?r:i,a=gr._malloc(n);return(Number.isInteger(e[0])?new Uint32Array(gr.HEAPU32.buffer,a,t):new Float32Array(gr.HEAPF32.buffer,a,t)).set(e,0),a}function q8(e){switch(e){case 0:return gr.OP.UNION;case 1:return gr.OP.INTERSECTION;case 2:return gr.OP.A_MINUS_B;case 3:return gr.OP.B_MINUS_A;case 4:return gr.OP.SYMMETRIC_DIFFERENCE;case 5:return gr.OP.ALL;default:throw new Error("Unknown boolean operation "+e)}}function SOe(e,t){Xf===void 0&&(Xf=gr.init_csg());let r=$8(e),i=gr.csg_calc_topological(Xf,r,e.length,q8(t));gr._free(r);let n=6,a=gr.HEAPU32.subarray(i>>2,(i>>2)+n),o=a.subarray(3,6),s=0,l=gr.HEAPU32[a[s]>>2],c=new Float32Array(gr.HEAPF32.subarray(l>>2,(l>>2)+o[s]));s++;let d=gr.HEAPU32[a[s]>>2],u=new Uint32Array(gr.HEAPU32.subarray(d>>2,(d>>2)+o[s]));s++;let h=gr.HEAPU32[a[s]>>2],f=new Uint8Array(gr.HEAPU32.subarray(h>>2,(h>>2)+o[s]));return gr.free_mesh_data(i),{positions:c,indices:u,verticesPerFace:f}}function COe(e,t,r,i){Xf===void 0&&(Xf=gr.init_csg());let n=$8(e),a=gr.csg_calc(Xf,n,e.length,i,q8(t));gr._free(n);let o=5,s=gr.HEAPU32.subarray(a>>2,(a>>2)+o),l=s.subarray(2,5),c=0,d=gr.HEAPU32[s[c]>>2],u=gr.HEAPF32.subarray(d>>2,(d>>2)+l[c]);c++;let h=gr.HEAPU32[s[c]>>2],f=gr.HEAPF32.subarray(h>>2,(h>>2)+l[c]);c++;let p=l[c];r.setAttribute("position",new yt(u,3)),r.setAttribute("normal",new yt(f,3));let v=gr.HEAPF32.subarray((a>>2)+5,(a>>2)+5+6);return r.boundingSphere===null&&(r.boundingSphere=new Za),r.boundingSphere.center.set(v[0],v[1],v[2]),r.boundingSphere.radius=(v[3]**2+v[4]**2+v[5]**2)**.5,r.userData.parameters={width:v[3]*2,height:v[4]*2,depth:v[5]*2},gr.free_mesh_data(a),p}function _Oe(e,t,r){if(gr===void 0)return-1;let i,n,a;if(t&&e.userData.positions!==void 0){let m=e.userData;a=m.verticesPerFace.length,i=m.positions,n=Array(m.verticesPerFace.reduce((g,y)=>g+y,0)+a);for(let g=0,y=0,b=0;g<m.verticesPerFace.length;g++){n[b++]=m.verticesPerFace[g];for(let x=0;x<m.verticesPerFace[g];x++)n[b++]=m.indices[y++]}}else({positions:i,faceIndices:n,nFaces:a}=wOe(e,t,r));let o=i.length,s=n.length,l=i.length,c=n.length,d=l*Float32Array.BYTES_PER_ELEMENT+c*Uint32Array.BYTES_PER_ELEMENT,u=l*Float32Array.BYTES_PER_ELEMENT,h=gr._malloc(d),f=new Float32Array(gr.HEAPF32.buffer,h,l),p=new Uint32Array(gr.HEAPU32.buffer,h+u,c);f.set(i,0),p.set(n,0);let v=gr.get_csg_mesh(h,o,h+u,s,a);return gr._free(h),v}function AOe(e){return gr.has_open_edges(e)}function MOe(e,t){gr.transform_csg_mesh(e,t.elements)}function EOe(e){gr.free_csg_mesh(e)}var TOe={ConeGeometry:qDe,CubeGeometry:YDe,CylinderGeometry:w8,DodecahedronGeometry:KDe,EllipseGeometry:XP,HelixGeometry:T3e,IcosahedronGeometry:P3e,LatheGeometry:D3e,NonParametricGeometry:B3e,PolygonGeometry:F8,PyramidGeometry:F3e,RectangleGeometry:KP,SphereGeometry:j3e,PlaneGeometry:V3e,BackdropGeometry:H3e,StarGeometry:N8,TextFrameGeometry:G3e,TorusGeometry:$3e,TorusKnotGeometry:Y3e,TriangleGeometry:X3e,PathGeometry:dOe,VectorGeometry:_h},$L=e=>TOe[e.type].create(e);function sf(e){return e!==null&&"booleanOp"in e}var Y8=class extends HP(Di){constructor(){super(...arguments),this.booleanMeshSetAddress=-1,this.booleanWasTransformed=!1,this.booleanMatrixInvOld=new it}updateVisible(e){super.updateVisible(e),this.visible=!sf(this.parent)&&this.visible,sf(this.parent)&&this.parent.invalidateDownstreamBooleanData()}freeBooleanPointer(){this.booleanMeshSetAddress!==-1&&(kl.freeMeshSet(this.booleanMeshSetAddress),this.booleanMeshSetAddress=-1)}invalidateDownstreamBooleanData(e=!1){return e?this.booleanWasTransformed=!0:this.freeBooleanPointer(),sf(this.parent)?this.parent.invalidateDownstreamBooleanData():this}invalidateUpstreamBooleanData(){this.freeBooleanPointer();for(let e of this.children)e instanceof Y8&&(e.freeBooleanPointer(),sf(e)&&e.invalidateUpstreamBooleanData())}updateTransformState(e,t){let r=super.updateTransformState(e,t);return r&&sf(this.parent)&&this.invalidateDownstreamBooleanData(!0),r}onVariableUpdate(e=!1){super.onVariableUpdate(e),sf(this.parent)&&this.invalidateDownstreamBooleanData(!0)}},ky=new Zi;function QP(e,t=0,r=e.count,i,n){let a=1/0,o=1/0,s=1/0,l=-1/0,c=-1/0,d=-1/0;for(let u=t;u<r;u++){let h=e.getX(u),f=e.getY(u),p=e.getZ(u);h<a&&(a=h),f<o&&(o=f),p<s&&(s=p),h>l&&(l=h),f>c&&(c=f),p>d&&(d=p)}ky.min.set(a,o,s),ky.max.set(l,c,d),ky.getCenter(i),ky.getSize(n).multiplyScalar(.5)}var POe=new Ot,DOe=new tc,Ra=class extends Y8{constructor(e,t){super(POe,DOe),this.super_Entity(e,t)}updateState(e,t){this.updateState_Entity(e,t)}updateEntityBoxSize(e,t){let r=this.geometry.getAttribute("position");r!==void 0?QP(r,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:r.count,e,t):super.updateEntityBoxSize(e,t)}},$c=class{constructor(e){if(this.hashProperties=void 0,this.isNode=!0,this.shortcuts={},$c.uuidContext===null)throw new Error("plz startContext");$c.uuidContext===$c.globalContext?this.uuid="_gid"+$c.uuidContext.nodeContextUuid++:this.uuid="_uid"+$c.uuidContext.nodeContextUuid++,this.type=e,this.name=""}static startContext(e){this.uuidContext===null||this.uuidContext===$c.globalContext?this.uuidContext=e:console.error("Can't start context twice")}static endContext(e){this.uuidContext!==e&&console.error("Can't end context twice"),this.uuidContext=null}analyze(e,t){t=t??{},e.analyzing=!0,this.build(e.addFlow(t.slot,t.cache,t.context),"v4"),e.clearVertexNodeCode(),e.clearFragmentNodeCode(),e.removeFlow(),e.analyzing=!1}analyzeAndFlow(e,t,r){return r=r??{},this.analyze(e,r),this.flow(e,t,r)}flow(e,t,r){r=r??{},e.addFlow(r.slot,r.cache,r.context);let i={result:this.build(e,t),code:e.clearNodeCode(),extra:e.context.extra};return e.removeFlow(),i}build(e,t,r){t=t??this.getType(e,t);let i=e.getNodeData(r??this);return e.analyzing&&this.appendDepsNode(e,i,t),e.nodes.indexOf(this)===-1&&e.nodes.push(this),this.updateFrame!==void 0&&e.updaters.indexOf(this)===-1&&e.updaters.push(this),this.generate(e,t,r)}updateFrame(e){}generateReadonly(e,t,r,i,n,a){return""}generate(e,t,r,i,n){return""}parse(e,t,r,i){}appendDepsNode(e,t,r){t.deps=(t.deps||0)+1;let i=e.getTypeLength(r);(i>(t.outputMax||0)||this.getType(e,r))&&(t.outputMax=i,t.output=r)}setName(e){this.name=e}getName(){return this.name}getType(e,t){return t==="sampler2D"||t==="samplerCube"?t:this.type}},mn=$c;mn.globalContext={nodeContextUuid:0},mn.uuidContext=$c.globalContext;var qL=class{constructor(e){e=e??{},this.name=e.name,this.type=e.type,this.node=e.node,this.size=e.size,this.needsUpdate=e.needsUpdate}get value(){return this.node.value}set value(e){this.node.value=e}},OOe=class{constructor(){this.nodes={},this.keywords={}}add(e){this.nodes[e.name]=e}addKeyword(e,t,r){r=r!==void 0?r:!0,this.keywords[e]={callback:t,cache:r}}remove(e){delete this.nodes[e.name]}removeKeyword(e){delete this.keywords[e]}get(e){return this.nodes[e]}getKeyword(e,t){return this.keywords[e].callback(t)}getKeywordData(e){return this.keywords[e]}contains(e){return this.nodes[e]!==void 0}containsKeyword(e){return this.keywords[e]!==void 0}},Ga=new OOe,ii=class extends mn{constructor(e,t){super(e),this.scope="",t=t??{},this.shared=t.shared!==void 0?t.shared:!0,this.unique=t.unique!==void 0?t.unique:!1}build(e,t,r,i){if(t=t??this.getType(e),this.getShared(e,t)){let n=this.getUnique(e,t);n&&this.uuid===void 0&&(this.uuid=St.generateUUID()),r=e.getUUID(r??this.getUUID(),!n);let a=e.getNodeData(r),o=a.output||this.getType(e);if(e.analyzing)return(a.deps||0)>0||this.getLabel()?(this.appendDepsNode(e,a,t),this.generate(e,t,r)):super.build(e,t,r);if(n)return a.name=a.name||super.build(e,t,r),a.name;if(!this.getLabel()&&(!this.getShared(e,o)||e.context.ignoreCache||a.deps===1))return super.build(e,t,r);r=this.getUUID(!1);let s=this.getTemp(e,r);if(s)return e.format(s,o,t);{s=super.generate(e,t,r,a.output,i);let l=this.generate(e,o,r);return e.addNodeCode(s+" = "+l+";"),e.format(s,o,t)}}return super.build(e,t,r)}getShared(e,t){return t!=="sampler2D"&&t!=="samplerCube"&&this.shared}getUnique(e,t){return this.unique}setLabel(e){return this.label=e,this}getLabel(){return this.label}getUUID(e){let t=this.uuid;return typeof this.scope=="string"&&(t=this.scope+"-"+t),t}getTemp(e,t){t=t||this.uuid;let r=e.getVars()[t];return r?r.name:void 0}generate(e,t,r,i,n){return this.getShared(e,t)||console.error("TempNode is not shared"),r=r??this.uuid,e.getTempVar(r,i??this.getType(e),n,this.getLabel()).name}},eo=class extends ii{constructor(e,t){t=t??{},t.shared=t.shared!==void 0?t.shared:!1,super(e,t),this.readonly=!1}setReadonly(e){return this.readonly=e,this.hashProperties=this.readonly?["value"]:void 0,this}getReadonly(){return this.readonly}generate(e,t,r,i,n,a){r=e.getUUID(r??this.getUUID()),i=i??this.getType(e);let o=e.getNodeData(r);return this.getReadonly()&&this.generateReadonly!==void 0?this.generateReadonly(e,t,r,i,n,a):e.isShader("vertex")?(o.vertex||(o.vertex=e.createVertexUniform(i,this,n,a,this.getLabel())),e.format(o.vertex.name,i,t)):(o.fragment||(o.fragment=e.createFragmentUniform(i,this,n,a,this.getLabel())),e.format(o.fragment.name,i,t))}},Xn=class extends eo{constructor(e=0,t){super("v2"),this.nodeType="Vector2",this.value=e instanceof ye?e:new ye(e,t)}get x(){return this.value.x}set x(e){this.value.x=e}get y(){return this.value.y}set y(e){this.value.y=e}generateReadonly(e,t,r,i,n,a){return e.format("vec2("+this.value.x+", "+this.value.y+")",i,t)}},xo=class extends eo{constructor(e=0,t,r){super("v3"),this.nodeType="Vector3",this.value=e instanceof k?e:new k(e,t,r)}get x(){return this.value.x}set x(e){this.value.x=e}get y(){return this.value.y}set y(e){this.value.y=e}get z(){return this.value.z}set z(e){this.value.z=e}generateReadonly(e,t,r,i,n,a){return e.format("vec3("+this.value.x+", "+this.value.y+", "+this.value.z+")",i,t)}},ia=class extends Lt{constructor(e,t,r,i){super(e,t,r),this.isColorA=!0,this.a=i}setRGBA(e,t,r,i){super.setRGB(e,t,r),this.a=i}copy(e){return super.copy(e),this.a="a"in e?e.a:1,this}clone(){return new this.constructor(this.r,this.g,this.b,this.a)}equals(e){return super.equals(e)&&this.a===e.a}setStyle(e,t="srgb"){let r;if(e==="transparent")return this.setRGBA(0,0,0,0),this;if(r=/^((?:rgb|hsl)a?)\(([^)]*)\)/.exec(e)){let i,n=r[1],a=r[2];switch(n){case"rgb":case"rgba":if(i=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.a=n==="rgba"?parseFloat(i[4]):1,super.setStyle(e,t);break;case"hsl":case"hsla":if(i=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)%\s*,\s*(\d*\.?\d+)%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.a=n==="hsla"?parseFloat(i[4]):1,super.setStyle(e,t);break}}return super.setStyle(e,t)}get x(){return this.r}get y(){return this.g}get z(){return this.b}get w(){return this.a}set x(e){this.r=e}set y(e){this.g=e}set z(e){this.b=e}set w(e){this.a=e}},Ll=class extends eo{constructor(e){super("v4"),this.nodeType="Vector4",this.value=e instanceof ia?e:new ia(e.r,e.g,e.b,e.a)}generateReadonly(e,t,r,i,n,a){return e.format("vec4("+this.value.r+", "+this.value.g+", "+this.value.b+", "+this.value.a+")",i,t)}},ROe=/^\s*([a-z_0-9]+)\s([a-z_0-9]+)\s*\((.*?)\)/i,YL=/[a-z_0-9]+/gi,mt=class extends ii{constructor(e,t,r,i,n){super(n),this.src="",this.nodeType="Function",this.useKeywords=!0,this.includes=[],this.extensions={},this.keywords={},this.isMethod=n===void 0,this.isInterface=!1,this.parse(e,t,r,i)}getShared(e,t){return!this.isMethod}getType(e){return e.getTypeByFormat(this.type)}getInputByName(e){if(this.inputs){let t=this.inputs.length;for(;t--;)if(this.inputs[t].name===e)return this.inputs[t]}}getIncludeByName(e){if(this.includes){let t=this.includes.length;for(;t--;)if(this.includes[t].name===e)return this.includes[t]}}generate(e,t,r,i,n){let a,o=0,s=this.src;if(this.includes)for(let c=0;c<this.includes.length;c++)e.include(this.includes[c],this);for(let c in this.extensions)e.extensions[c]=!0;let l=[];for(;a=YL.exec(this.src);)l.push(a);for(let c=0;c<l.length;c++){let d=l[c],u=d[0],h=this.isMethod?!this.getInputByName(u):!0,f=u;if(this.keywords[u]||this.useKeywords&&h&&Ga.containsKeyword(u)){let p=this.keywords[u];if(!p){let v=Ga.getKeywordData(u);v.cache&&(p=e.keywords[u]),p=p||Ga.getKeyword(u,e),v.cache&&(e.keywords[u]=p)}f=p.build(e)}u!==f&&s[d.index+o-1]!=="."&&(s=s.substring(0,d.index+o)+f+s.substring(d.index+u.length+o),o+=f.length-u.length),this.getIncludeByName(f)===void 0&&Ga.contains(f)&&e.include(Ga.get(f))}return t==="source"?s:this.isMethod?(this.isInterface||e.include(this,void 0,s),this.name):e.format("( "+s+" )",this.getType(e),t)}parse(e,t,r,i){if(this.src=e||"",this.includes=t??[],this.extensions=r??{},this.keywords=i??{},this.isMethod){let n=ROe.exec(this.src);if(this.inputs=[],n&&n.length==4){this.type=n[1],this.name=n[2];let a=n[3].match(YL);if(a){let o=0;for(;o<a.length;){let s=a[o++],l;s==="in"||s==="out"||s==="inout"?l=a[o++]:(l=s,s="");let c=a[o++];this.inputs.push({name:c,type:l,qualifier:s})}}this.isInterface=this.src.indexOf("{")===-1}else this.type="",this.name=""}}},IOe=/^([a-z_0-9]+)\s([a-z_0-9]+)\s?\=?\s?(.*?)(\;|$)/i,X8=class extends ii{constructor(e="",t){super(),this.src="",this.useDefine=!1,this.nodeType="Const",this.parse(e||X8.PI,void 0,void 0,void 0,t)}getType(e){return e.getTypeByFormat(this.type)}parse(e,t,r,i,n){this.src=e||"";let a,o,s="",l=IOe.exec(e);this.useDefine=n??this.src.charAt(0)==="#",l&&l.length>1?(o=l[1],a=l[2],s=l[3]):(a=this.src,o="f"),this.name=a,this.type=o,this.value=s}build(e,t){if(t==="source"){if(this.value)return this.useDefine?"#define "+this.name+" "+this.value:"const "+this.type+" "+this.name+" = "+this.value+";";if(this.useDefine)return this.src}return e.include(this),e.format(this.name,this.getType(e),t)}generate(e,t,r,i,n){return e.format(this.name,this.getType(e),t)}},Kr=X8;Kr.PI="PI",Kr.PI2="PI2",Kr.RECIPROCAL_PI="RECIPROCAL_PI",Kr.RECIPROCAL_PI2="RECIPROCAL_PI2",Kr.LOG2="LOG2",Kr.EPSILON="EPSILON";var zOe=new RegExp(`^structs*([a-z_0-9]+)s*{s*((.|
)*?)}`,"gim"),kOe=new RegExp("s*(w*?)s*(w*?)(=|;)","gim"),K8=class extends ii{constructor(e=""){super(),this.inputs=[],this.src="",this.nodeType="Struct",this.parse(e)}getType(e){return e.getTypeByFormat(this.name)}getInputByName(e){let t=this.inputs.length;for(;t--;)if(this.inputs[t].name===e)return this.inputs[t]}generate(e,t,r,i,n){return t==="source"?this.src+";":e.format("( "+this.src+" )",this.getType(e),t)}parse(e=""){this.src=e,this.inputs=[];let t=zOe.exec(e);if(t){let r=t[2],i;for(;i=kOe.exec(r);)this.inputs.push({type:i[1],name:i[2]});this.name=t[1]}else this.name="";this.type=this.name}},ZP=class extends ii{constructor(e){super("v2",{shared:!1}),this.nodeType="UV",this.index=e??0}generate(e,t){e.requires.uv[this.index]=!0;let r=this.index>0?this.index+1:"",i=e.isShader("vertex")?"uv"+r:"vUv"+r;return e.format(i,this.getType(e),t)}};Ga.addKeyword("uv",function(){return new ZP});Ga.addKeyword("uv2",function(){return new ZP(1)});var Sf=class extends ii{constructor(e,t){super("v4"),this.nodeType="ColorSpace",this.input=e,this.method=t??Sf.LINEAR_TO_LINEAR,this.hashProperties=["method"]}static getEncodingComponents(e){switch(e){case hs:return["Linear"];case sr:return["sRGB"];default:return[]}}generate(e,t){var o;let r=this.input.build(e,"v4"),i=this.getType(e),n=Sf.Nodes[this.method],a=e.include(n);if(a===Sf.LINEAR_TO_LINEAR)return e.format(r,i,t);if(((o=n.inputs)==null?void 0:o.length)===2){let s=this.factor.build(e,"f");return e.format(a+"( "+r+", "+s+" )",i,t)}else return e.format(a+"( "+r+" )",i,t)}fromEncoding(e){let t=Sf.getEncodingComponents(e);this.method="LinearTo"+t[0],this.factor=t[1]}fromDecoding(e){let t=Sf.getEncodingComponents(e);this.method=t[0]+"ToLinear",this.factor=t[1]}},qs=Sf;qs.Nodes={LinearToLinear:new mt(["vec4 LinearToLinear( in vec4 value ) {","	return value;","}"].join(`
`)),sRGBToLinear:new mt(["vec4 sRGBToLinear( in vec4 value ) {","	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );","}"].join(`
`)),LinearTosRGB:new mt(["vec4 LinearTosRGB( in vec4 value ) {","	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );","}"].join(`
`))},qs.LINEAR_TO_LINEAR="LinearToLinear",qs.SRGB_TO_LINEAR="sRGBToLinear",qs.LINEAR_TO_SRGB="LinearTosRGB";var pi=class extends mt{constructor(e="",t,r,i,n){super(e,n,i,r,t),this.nodeType="Expression"}},Vl=class extends eo{constructor(e=new Oi,t,r,i){super("v4",{shared:!0}),this.nodeType="Texture",this.value=e,this.uv=t??new ZP,this.bias=r,this.project=i!==void 0?i:!1}getTexture(e,t){return super.generate(e,t,this.value.uuid,"t")}generate(e,t){if(t==="sampler2D")return this.getTexture(e,t);let r=this.getTexture(e,t),i=this.uv.build(e,this.project?"v4":"v2"),n=this.bias?this.bias.build(e,"f"):void 0;n===void 0&&e.context.bias&&(n=e.context.bias.setTexture(this).build(e,"f"));let a,o;this.project?a="texture2DProj":a=n?"tex2DBias":"tex2D",n?o=a+"( "+r+", "+i+", "+n+" )":o=a+"( "+r+", "+i+" )";let s={include:e.isShader("vertex"),ignoreCache:!0},l=this.getType(e);return e.addContext(s),this.colorSpace=this.colorSpace??new qs(new pi("",l)),this.colorSpace.fromDecoding(e.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(o),o=this.colorSpace.build(e,l),e.removeContext(),e.format(o,l,t)}},Ct=class extends eo{constructor(e){super("f"),this.nodeType="Float",this.value=e??0}generateReadonly(e,t,r,i,n,a){return e.format(this.value+(this.value%1?"":".0"),i,t)}},XL=class extends ii{constructor(e,t){super(),this.inputs=[],this.nodeType="FunctionCall",this.value=e,this.inputs=t??[]}getFunction(){return this.value}getType(e){return this.value.getType(e)}generate(e,t,r,i,n){i=this.getType(e);let a=this.value,o=a.build(e,t)+"( ",s=[];if(a.inputs){for(let l=0;l<a.inputs.length;l++){let c=a.inputs[l],d=this.inputs[l]||this.inputs[c.name];s.push(d.build(e,e.getTypeByFormat(c.type)))}o+=s.join(", ")+" )"}return e.format(o,i,t)}},Q8=class extends ii{constructor(e,t,r=Q8.ADD){super(),this.nodeType="Operator",this.type=e.type,this.a=e,this.b=t,this.op=r}getType(e){let t=this.a.getType(e),r=this.b.getType(e);return e.isTypeMatrix(t)?"v4":e.getTypeLength(r)>e.getTypeLength(t)?r:t}generate(e,t){let r=this.getType(e);this.type=r;let i=this.a.build(e,r),n=this.b.build(e,r);return e.format("( "+i+" "+this.op+" "+n+" )",r,t)}},Ua=Q8;Ua.ADD="+",Ua.SUB="-",Ua.MUL="*",Ua.DIV="/";var Xr=class extends ii{constructor(e,t=Xr.ABS,r,i){super(),this.nodeType="Math",this.a=e,typeof t!="string"?this.b=t:i=t,typeof r!="string"?this.c=r:i=r,this.method=i,this.hashProperties=["method"]}getNumInputs(e){switch(this.method){case Xr.MIX:case Xr.CLAMP:case Xr.REFRACT:case Xr.SMOOTHSTEP:case Xr.FACEFORWARD:return 3;case Xr.MIN:case Xr.MAX:case Xr.MOD:case Xr.STEP:case Xr.REFLECT:case Xr.DISTANCE:case Xr.DOT:case Xr.CROSS:case Xr.POW:return 2;default:return 1}}getInputType(e){let t=e.getTypeLength(this.a.getType(e)),r=this.b?e.getTypeLength(this.b.getType(e)):0,i=this.c?e.getTypeLength(this.c.getType(e)):0;return t>r&&t>i?this.a.getType(e):r>i?this.b.getType(e):this.c.getType(e)}getType(e){switch(this.method){case Xr.LENGTH:case Xr.DISTANCE:case Xr.DOT:return"f";case Xr.CROSS:return"v3"}return this.getInputType(e)}generate(e,t){let r,i,n,a=this.a?e.getTypeLength(this.a.getType(e)):0,o=this.b?e.getTypeLength(this.b.getType(e)):0,s=this.c?e.getTypeLength(this.c.getType(e)):0,l=this.getInputType(e),c=this.getType(e);switch(this.type=c,this.method){case Xr.NEGATE:return e.format("( -"+this.a.build(e,l)+" )",l,t);case Xr.INVERT:return e.format("( 1.0 - "+this.a.build(e,l)+" )",l,t);case Xr.CROSS:r=this.a.build(e,"v3"),i=this.b.build(e,"v3");break;case Xr.STEP:r=this.a.build(e,a===1?"f":l),i=this.b.build(e,l);break;case Xr.MIN:case Xr.MAX:case Xr.MOD:r=this.a.build(e,l),i=this.b.build(e,o===1?"f":l);break;case Xr.REFRACT:r=this.a.build(e,l),i=this.b.build(e,l),n=this.c.build(e,"f");break;case Xr.MIX:r=this.a.build(e,l),i=this.b.build(e,l),n=this.c.build(e,s===1?"f":l);break;default:r=this.a.build(e,l),this.b&&(i=this.b.build(e,l)),this.c&&(n=this.c.build(e,l));break}let d=[];d.push(r),i&&d.push(i),n&&d.push(n);let u=this.getNumInputs(e);if(d.length!==u)throw Error(`Arguments not match used in "${this.method}". Require ${u}, currently ${d.length}.`);return e.format(this.method+"( "+d.join(", ")+" )",c,t)}},ar=Xr;ar.RAD="radians",ar.DEG="degrees",ar.EXP="exp",ar.EXP2="exp2",ar.LOG="log",ar.LOG2="log2",ar.SQRT="sqrt",ar.INV_SQRT="inversesqrt",ar.FLOOR="floor",ar.CEIL="ceil",ar.NORMALIZE="normalize",ar.FRACT="fract",ar.SATURATE="saturate",ar.SIN="sin",ar.COS="cos",ar.TAN="tan",ar.ASIN="asin",ar.ACOS="acos",ar.ARCTAN="atan",ar.ABS="abs",ar.SIGN="sign",ar.LENGTH="length",ar.NEGATE="negate",ar.INVERT="invert",ar.MIN="min",ar.MAX="max",ar.MOD="mod",ar.STEP="step",ar.REFLECT="reflect",ar.DISTANCE="distance",ar.DOT="dot",ar.CROSS="cross",ar.POW="pow",ar.MIX="mix",ar.CLAMP="clamp",ar.REFRACT="refract",ar.SMOOTHSTEP="smoothstep",ar.FACEFORWARD="faceforward";var iv=class extends ii{constructor(e,t,r){super("v4"),this.nodeType="TextureCubeUV",this.value=e,this.uv=t,this.bias=r}bilinearCubeUV(e,t,r,i){let n=new XL(iv.Nodes.bilinearCubeUV,[t,r,i]);this.colorSpaceTL=this.colorSpaceTL??new qs(new pi("","v4")),this.colorSpaceTL.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceTL.input.parse(n.build(e)+".tl"),this.colorSpaceTR=this.colorSpaceTR??new qs(new pi("","v4")),this.colorSpaceTR.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceTR.input.parse(n.build(e)+".tr"),this.colorSpaceBL=this.colorSpaceBL??new qs(new pi("","v4")),this.colorSpaceBL.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceBL.input.parse(n.build(e)+".bl"),this.colorSpaceBR=this.colorSpaceBR??new qs(new pi("","v4")),this.colorSpaceBR.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceBR.input.parse(n.build(e)+".br");let a={include:e.isShader("vertex"),ignoreCache:!0};e.addContext(a),this.colorSpaceTLExp=new pi(this.colorSpaceTL.build(e,"v4"),"v4"),this.colorSpaceTRExp=new pi(this.colorSpaceTR.build(e,"v4"),"v4"),this.colorSpaceBLExp=new pi(this.colorSpaceBL.build(e,"v4"),"v4"),this.colorSpaceBRExp=new pi(this.colorSpaceBR.build(e,"v4"),"v4"),e.removeContext();let o=new pi("mix( mix( cubeUV_TL, cubeUV_TR, cubeUV.f.x ), mix( cubeUV_BL, cubeUV_BR, cubeUV.f.x ), cubeUV.f.y )","v4");return o.keywords.cubeUV_TL=this.colorSpaceTLExp,o.keywords.cubeUV_TR=this.colorSpaceTRExp,o.keywords.cubeUV_BL=this.colorSpaceBLExp,o.keywords.cubeUV_BR=this.colorSpaceBRExp,o.keywords.cubeUV=n,o}generate(e,t){if(e.isShader("fragment")){let r=this.uv,i=this.bias||e.context.roughness,n=new XL(iv.Nodes.roughnessToMip,[i]),a=new ar(n,iv.Nodes.m0,iv.Nodes.cubeUV_maxMipLevel,ar.CLAMP),o=new ar(a,ar.FLOOR),s=new ar(a,ar.FRACT),l=this.bilinearCubeUV(e,this.value,r,o),c=this.bilinearCubeUV(e,this.value,r,new Ua(o,new Ct(1).setReadonly(!0),Ua.ADD)),d=new ar(l,c,s,ar.MIX);return e.format(d.build(e),"v4",t)}else return console.warn("TextureCubeUVNode is not compatible with "+e.shader+" shader."),e.format("vec4( 0.0 )",this.getType(e),t)}},$M=iv;$M.Nodes=function(){let e=new K8(`struct TextureCubeUVData {
			vec4 tl;
			vec4 tr;
			vec4 br;
			vec4 bl;
			vec2 f;
		}`),t=new Kr("float cubeUV_maxMipLevel 8.0",!0),r=new Kr("float cubeUV_minMipLevel 4.0",!0),i=new Kr("float cubeUV_maxTileSize 256.0",!0),n=new Kr("float cubeUV_minTileSize 16.0",!0),a=new mt(`float getFace(vec3 direction) {
				vec3 absDirection = abs(direction);
				float face = -1.0;
				if (absDirection.x > absDirection.z) {
					if (absDirection.x > absDirection.y)
						face = direction.x > 0.0 ? 0.0 : 3.0;
					else
						face = direction.y > 0.0 ? 1.0 : 4.0;
				} else {
					if (absDirection.z > absDirection.y)
						face = direction.z > 0.0 ? 2.0 : 5.0;
					else
						face = direction.y > 0.0 ? 1.0 : 4.0;
				}
				return face;
		}`);a.useKeywords=!1;let o=new mt(`vec2 getUV(vec3 direction, float face) {
				vec2 uv;
				if (face == 0.0) {
					uv = vec2(direction.z, direction.y) / abs(direction.x); // pos x
				} else if (face == 1.0) {
					uv = vec2(-direction.x, -direction.z) / abs(direction.y); // pos y
				} else if (face == 2.0) {
					uv = vec2(-direction.x, direction.y) / abs(direction.z); // pos z
				} else if (face == 3.0) {
					uv = vec2(-direction.z, direction.y) / abs(direction.x); // neg x
				} else if (face == 4.0) {
					uv = vec2(-direction.x, direction.z) / abs(direction.y); // neg y
				} else {
					uv = vec2(direction.x, direction.y) / abs(direction.z); // neg z
				}
				return 0.5 * (uv + 1.0);
		}`);o.useKeywords=!1;let s=new mt(`TextureCubeUVData bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {
			float face = getFace(direction);
			float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);
			mipInt = max(mipInt, cubeUV_minMipLevel);
			float faceSize = exp2(mipInt);
			float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);
			vec2 uv = getUV(direction, face) * (faceSize - 1.0);
			vec2 f = fract(uv);
			uv += 0.5 - f;
			if (face > 2.0) {
				uv.y += faceSize;
				face -= 3.0;
			}
			uv.x += face * faceSize;
			if(mipInt < cubeUV_maxMipLevel){
				uv.y += 2.0 * cubeUV_maxTileSize;
			}
			uv.y += filterInt * 2.0 * cubeUV_minTileSize;
			uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);
			uv *= texelSize;
			vec4 tl = texture2D(envMap, uv);
			uv.x += texelSize;
			vec4 tr = texture2D(envMap, uv);
			uv.y += texelSize;
			vec4 br = texture2D(envMap, uv);
			uv.x -= texelSize;
			vec4 bl = texture2D(envMap, uv);
			return TextureCubeUVData( tl, tr, br, bl, f );
		}`,[e,a,o,t,r,i,n]);s.useKeywords=!1;let l=new Kr("float r0 1.0",!0),c=new Kr("float v0 0.339",!0),d=new Kr("float m0 -2.0",!0),u=new Kr("float r1 0.8",!0),h=new Kr("float v1 0.276",!0),f=new Kr("float m1 -1.0",!0),p=new Kr("float r4 0.4",!0),v=new Kr("float v4 0.046",!0),m=new Kr("float m4 2.0",!0),g=new Kr("float r5 0.305",!0),y=new Kr("float v5 0.016",!0),b=new Kr("float m5 3.0",!0),x=new Kr("float r6 0.21",!0),S=new Kr("float v6 0.0038",!0),w=new Kr("float m6 4.0",!0),_=[l,c,d,u,h,f,p,v,m,g,y,b,x,S,w],C=new mt(`float roughnessToMip(float roughness) {
			float mip = 0.0;
			if (roughness >= r1) {
				mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;
			} else if (roughness >= r4) {
				mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;
			} else if (roughness >= r5) {
				mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;
			} else if (roughness >= r6) {
				mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;
			} else {
				mip = -2.0 * log2(1.16 * roughness);// 1.16 = 1.79^0.25
			}
			return mip;
		}`,_);return{bilinearCubeUV:s,roughnessToMip:C,m0:d,cubeUV_maxMipLevel:t}}();var Cf=class extends ii{constructor(e){super("v3"),this.nodeType="Normal",this.scope=e??Cf.VIEW}getShared(){return this.scope===Cf.WORLD}build(e,t,r,i){let n=e.context[this.scope+"Normal"];return n?n.build(e,t,r,i):super.build(e,t,r)}generate(e,t,r,i,n){let a;switch(this.scope){case Cf.VIEW:e.isShader("vertex")?a="transformedNormal":a="geometryNormal";break;case Cf.LOCAL:e.isShader("vertex")?a="objectNormal":(e.requires.normal=!0,a="vObjectNormal");break;case Cf.WORLD:e.isShader("vertex")?a="inverseTransformDirection( transformedNormal, viewMatrix ).xyz":(e.requires.worldNormal=!0,a="vWNormal");break}return e.format(a,this.getType(e),t)}},$a=Cf;$a.LOCAL="local",$a.WORLD="world",$a.VIEW="view",$a.NORMAL="normal";Ga.addKeyword("viewNormal",function(){return new $a($a.VIEW)});Ga.addKeyword("localNormal",function(){return new $a($a.NORMAL)});Ga.addKeyword("worldNormal",function(){return new $a($a.WORLD)});var Ol=class extends ii{constructor(e){super("v3"),this.nodeType="Position",this.scope=e??Ol.LOCAL}getType(){switch(this.scope){case Ol.PROJECTION:return"v4"}return this.type}getShader(){switch(this.scope){case Ol.LOCAL:case Ol.WORLD:return!1}return!0}generate(e,t,r,i,n){let a;switch(this.scope){case Ol.LOCAL:e.isShader("vertex")?a="transformed":(e.requires.position=!0,a="vPosition");break;case Ol.WORLD:if(e.isShader("vertex"))return"( modelMatrix * vec4( transformed, 1.0 ) ).xyz";e.requires.worldPosition=!0,a="vWPosition";break;case Ol.VIEW:a=e.isShader("vertex")?"-mvPosition.xyz":"vViewPosition";break;case Ol.PROJECTION:a=e.isShader("vertex")?"( projectionMatrix * modelViewMatrix * vec4( position, 1.0 ) )":"vec4( 0.0 )";break}return e.format(a,this.getType(),t)}},is=Ol;is.LOCAL="local",is.WORLD="world",is.VIEW="view",is.PROJECTION="projection";Ga.addKeyword("position",function(){return new is});Ga.addKeyword("worldPosition",function(){return new is(is.WORLD)});Ga.addKeyword("viewPosition",function(){return new is(is.VIEW)});var zs=class extends ii{constructor(e){super("v3"),this.nodeType="Reflect",this.scope=e??zs.CUBE}getUnique(e){return!e.context.viewNormal}getType(){switch(this.scope){case zs.SPHERE:return"v2"}return this.type}generate(e,t){let r=this.getUnique(e);if(e.isShader("fragment")){let i;switch(this.scope){case zs.VECTOR:{let n=new $a($a.VIEW),a=e.context.roughness,o=n.build(e,"v3"),s=new is(is.VIEW).build(e,"v3"),l=a?a.build(e,"f"):void 0,c=`reflect( -normalize( ${s} ), ${o} )`;l&&(c=`normalize( mix( ${c}, ${o}, ${l} * ${l} ) )`);let d=`inverseTransformDirection( ${c}, viewMatrix )`;r?(e.addNodeCode(`vec3 reflectVec = ${d};`),i="reflectVec"):i=d;break}case zs.CUBE:{let n=new zs(zs.VECTOR).build(e,"v3"),a="vec3( -"+n+".x, "+n+".yz )";r?(e.addNodeCode(`vec3 reflectCubeVec = ${a};`),i="reflectCubeVec"):i=a;break}case zs.SPHERE:{let n="normalize( ( viewMatrix * vec4( "+new zs(zs.VECTOR).build(e,"v3")+", 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) ).xy * 0.5 + 0.5";r?(e.addNodeCode(`vec2 reflectSphereVec = ${n};`),i="reflectSphereVec"):i=n;break}}return e.format(i,this.getType(),t)}else return console.warn("ReflectNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.type,t)}},Kf=zs;Kf.CUBE="cube",Kf.SPHERE="sphere",Kf.VECTOR="vector";var LOe=class extends ii{constructor(e=new Vl,t,r){super("v4"),this.nodeType="TextureCube",this.value=e,this.radianceNode=new $M(this.value,t??new Kf(Kf.VECTOR),r),this.irradianceNode=new $M(this.value,new $a($a.WORLD),new Ct(1).setReadonly(!0))}generate(e,t){return e.isShader("fragment")?(e.require("irradiance"),e.context.bias&&e.context.bias.setTexture(this.value),(e.slot==="irradiance"?this.irradianceNode:this.radianceNode).build(e,t)):(console.warn("TextureCubeNode is not compatible with "+e.shader+" shader."),e.format("vec4( 0.0 )",this.getType(e),t))}},BOe=class extends eo{constructor(e=new tP,t,r){super("v4",{shared:!0}),this.nodeType="CubeTexture",this.value=e,this.uv=t??new Kf,this.bias=r}getTexture(e,t){return super.generate(e,t,this.value.uuid,"tc")}generate(e,t){var l;if(t==="samplerCube")return this.getTexture(e,t);let r=this.getTexture(e,t),i=(l=this.uv)==null?void 0:l.build(e,"v3"),n=this.bias?this.bias.build(e,"f"):void 0;n===void 0&&e.context.bias&&(n=e.context.bias.setTexture(this).build(e,"f"));let a;n?a="texCubeBias( "+r+", "+i+", "+n+" )":a="texCube( "+r+", "+i+" )";let o={include:e.isShader("vertex"),ignoreCache:!0},s=this.getType(e);return e.addContext(o),this.colorSpace=this.colorSpace??new qs(new pi("",s)),this.colorSpace.fromDecoding(e.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(a),a=this.colorSpace.build(e,s),e.removeContext(),e.format(a,s,t)}},FOe=`
uniform int frameIndex;
uniform vec2 resolution;
uniform mat4 previousModelViewMatrix;
uniform mat4 previousProjectionMatrix;

varying vec4 vCurrentPosition;
varying vec4 vPreviousPosition;
`,NOe=`
layout(location = 1) out vec4 gVelocity;

uniform int frameIndex;
uniform vec2 resolution;

varying vec4 vCurrentPosition;
varying vec4 vPreviousPosition;

const vec2 haltonSequence[16] = vec2[16](
vec2( 0.000000,-0.333334),
vec2(-0.500000, 0.333334),
vec2( 0.500000,-0.777778),
vec2(-0.750000,-0.111112),
vec2( 0.250000, 0.555556),
vec2(-0.250000,-0.555556),
vec2( 0.750000, 0.111112),
vec2(-0.875000, 0.777778),
vec2(0.125000, -0.925926),
vec2(-0.375000, -0.259260),
vec2(0.625000, 0.407408),
vec2(-0.625000, -0.703704),
vec2(0.375000, -0.037038),
vec2(-0.125000, 0.629630),
vec2(0.875000, -0.481482),
vec2(-0.937500, 0.185186));

vec2 vogelDiskSample(int sampleIndex, int sampleCount, float angle) {
  const float goldenAngle = 2.399963f; // radians
  float r = sqrt(float(sampleIndex) + 0.5f) / sqrt(float(sampleCount));
  float theta = float(sampleIndex) * goldenAngle + angle;
  float sine = sin(theta);
  float cosine = cos(theta);
  return vec2(cosine, sine) * r;
}

// Derived from the interleaved gradient function from Jimenez 2014 http:goo.gl/eomGso
float getNoiseInterleavedGradient(vec2 screenPos) {
    vec3 magic = vec3(0.06711056f, 0.00583715f, 52.9829189f);
    return fract(magic.z * fract(dot(screenPos, magic.xy)));
}

`,UOe=`
// TODO: This could be generated CPU side and passed to the shader every frame
const vec2 haltonSequence[16] = vec2[16](
vec2( 0.000000,-0.333334),
vec2(-0.500000, 0.333334),
vec2( 0.500000,-0.777778),
vec2(-0.750000,-0.111112),
vec2( 0.250000, 0.555556),
vec2(-0.250000,-0.555556),
vec2( 0.750000, 0.111112),
vec2(-0.875000, 0.777778),
vec2(0.125000, -0.925926),
vec2(-0.375000, -0.259260),
vec2(0.625000, 0.407408),
vec2(-0.625000, -0.703704),
vec2(0.375000, -0.037038),
vec2(-0.125000, 0.629630),
vec2(0.875000, -0.481482),
vec2(-0.937500, 0.185186));

// TODO: Pass correct view size
vec2 offset = haltonSequence[frameIndex];
offset.x /= resolution.x;
offset.y /= resolution.y;

vec4 currentPosition = gl_Position;
vec4 currentPositionJittered = currentPosition + (vec4(offset.x, offset.y, 0.0, 0.0) * currentPosition.w);

// We want to calculate the velocity with unjittered positions
// so that things that are not moving get a velocity = 0
vCurrentPosition = currentPosition;
vPreviousPosition = previousProjectionMatrix * previousModelViewMatrix * vec4(transformed, 1.0);
#ifdef OUTLINE_COMPENSATION
vPreviousPosition.xy += OUTLINE_COMPENSATION;
#endif
gl_Position = currentPositionJittered;

`,jOe=`
vec2 oldPos = vPreviousPosition.xy;
    oldPos /= vPreviousPosition.w;
    oldPos.xy = (oldPos.xy+1.)/2.0;

vec2 newPos = vCurrentPosition.xy;
    newPos /= vCurrentPosition.w;
    newPos.xy = (newPos.xy+1.)/2.0;

vec2 velocity = (newPos - oldPos);

// Discard fully transparent pixels 
if (gl_FragColor.a <= 0.0) discard;

gVelocity = vec4(velocity, 0.0, 1.0);
`,VOe=`
layout(location = 1) out vec4 gVelocity;
`,HOe=`
    // Discard fully transparent pixels 
    if (gl_FragColor.a <= 0.0) discard;

    gVelocity = vec4(0.0, 0.0, 0.0, 1.0);
`,KL=["x","y","z","w"],WOe=["float","vec2","vec3","vec4"],GOe={float:"f",vec2:"v2",vec3:"v3",vec4:"v4",mat4:"v4",int:"i",bool:"b","float[]":"f[]","vec4[]":"v4[]"},$Oe={t:"sampler2D",tc:"samplerCube",b:"bool",i:"int",f:"float",c:"vec3",v2:"vec2",v3:"vec3",v4:"vec4",m3:"mat3",m4:"mat4","f[]":"float[]","v4[]":"vec4[]"},Z8=class{constructor(){this.includes={consts:{},functions:{},structs:{}},this.cache="",this.slot="",this.shader="",this.context={},this.needsJitter=!0,this.getIncludesCode=function(){function e(t,r){return t.deps.length-r.deps.length}return function(t,r){let i=this.getIncludes(t,r);if(!i)return"";let n="";i=i.sort(e);for(let a=0;a<i.length;a++)i[a].src&&(n+=i[a].src+`
`);return n}}(),this.slots=[],this.caches=[],this.contexts=[],this.keywords={},this.nodeData={},this.fragmentVariables={},this.fragmentParsVariables={},this.vertexParsVariables={},this.requires={uv:[],color:[],transparent:!1,irradiance:!1,position:!1,worldPosition:!1,normal:!1,worldNormal:!1,vWorldViewDir:!1,modelMatrix:!1,viewMatrix:!1,projectionMatrix:!1},this.includes={consts:[],functions:[],structs:[]},this.attributes={},this.prefixCode=["#ifdef TEXTURE_LOD_EXT","	#define texCube(a, b) textureCube(a, b)","	#define texCubeBias(a, b, c) textureCubeLodEXT(a, b, c)","	#define tex2D(a, b) texture2D(a, b)","	#define tex2DBias(a, b, c) texture2DLodEXT(a, b, c)","#else","	#define texCube(a, b) textureCube(a, b)","	#define texCubeBias(a, b, c) textureCube(a, b, c)","	#define tex2D(a, b) texture2D(a, b)","	#define tex2DBias(a, b, c) texture2D(a, b, c)","#endif",`
			// NOTE: Include Spline's blending modes. This could be part of BlendNode
			#define SPE_BLENDING_NORMAL 0
			#define SPE_BLENDING_MULTIPLY 1
			#define SPE_BLENDING_SCREEN 2
			#define SPE_BLENDING_OVERLAY 3

			vec3 spe_normalBlend( vec3 a, vec3 b, float alpha ) {
				return mix( a, b, alpha );
			}

			vec3 spe_multiplyBlend( vec3 a, vec3 b, float alpha ) {
				return mix( a, a * b, alpha );
			}

			vec3 spe_screenBlend( vec3 a, vec3 b, float alpha ) {
				vec3 tmp = 1.0 - ( 1.0 - a ) * ( 1.0 - b );
				return mix( a, tmp, alpha );
			}

			vec3 spe_overlayBlend( vec3 a, vec3 b, float alpha ) {
				vec3 tmp = mix( 1. - 2. * (1. - a) * (1. - b), 2. * a * b, step( a, vec3(.5) ) );
				return clamp( mix( a, tmp, alpha ), 0.0, 1.0 );
			}

			vec3 spe_blend( vec3 a, vec3 b, float alpha, int mode ) {
				if ( mode == SPE_BLENDING_NORMAL ) return spe_normalBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_MULTIPLY ) return spe_multiplyBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_SCREEN ) return spe_screenBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_OVERLAY ) return spe_overlayBlend( a, b, alpha );
				return vec3( 1.0 );
			}
			`,"#include <packing>","#include <common>"].join(`
`),this.parsCode={vertex:["float neighbor_offset = 0.0001;",""].join(`
`),fragment:["float accumAlpha = 0.0;",`void accumulateAlpha(float alpha) {
					accumAlpha += (1.0 - accumAlpha) * alpha;
				}`,""].join(`
`)},this.code={vertex:"",fragment:""},this.nodeCode={vertex:"",fragment:""},this.resultCode={vertex:"",fragment:""},this.finalCode={vertex:"",fragment:""},this.inputs={uniforms:{list:[],vertex:[],fragment:[]},arrayUniforms:{list:[],vertex:[],fragment:[]},vars:{varying:[],vertex:[],fragment:[]}},this.defines={},this.uniforms={},this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.updaters=[],this.nodes=[],this.analyzing=!1}build(e,t){this.addVertexParsCode(FOe),this.addFragmentParsCode(NOe),this.buildShader("vertex",e),this.buildShader("fragment",t);for(let r=0;r<this.requires.uv.length;r++)if(this.requires.uv[r]){let i=r>0?r+1:"";this.addVaryCode("varying vec2 vUv"+i+";"),r>0&&this.addVertexParsCode("attribute vec2 uv"+i+";"),this.addVertexFinalCode("vUv"+i+" = uv"+i+";")}return this.requires.color[0]&&(this.addVaryCode("varying vec4 vColor;"),this.addVertexParsCode("attribute vec4 color;"),this.addVertexFinalCode("vColor = color;")),this.requires.color[1]&&(this.addVaryCode("varying vec4 vColor2;"),this.addVertexParsCode("attribute vec4 color2;"),this.addVertexFinalCode("vColor2 = color2;")),this.requires.position&&(this.addVaryCode("varying vec3 vPosition;"),this.addVertexFinalCode("vPosition = transformed;")),this.requires.worldPosition,this.requires.normal&&(this.addVaryCode("varying vec3 vObjectNormal;"),this.addVertexFinalCode("vObjectNormal = normal;")),this.requires.modelMatrix&&this.addFragmentParsCode("uniform mat4 modelMatrix;"),this.requires.viewMatrix&&this.addFragmentParsCode("uniform mat4 viewMatrix;"),this.requires.projectionMatrix&&this.addFragmentParsCode("uniform mat4 projectionMatrix;"),this.requires.worldNormal&&(this.addVaryCode("varying vec3 vWNormal;"),this.addVertexFinalCode("vWNormal = inverseTransformDirection( transformedNormal, viewMatrix ).xyz;")),this.requires.vWorldViewDir&&(this.addVaryCode("varying vec3 vWorldViewDir;"),this.addVertexFinalCode("vWorldViewDir = isPerspectiveMatrix( projectionMatrix ) ?  ( (modelMatrix * vec4(position, 1.0)).xyz - cameraPosition ) : vec3( -viewMatrix[0][2], -viewMatrix[1][2], -viewMatrix[2][2] );")),this.needsJitter&&(this.addVertexFinalCode(UOe),this.addFragmentFinalCode(jOe)),this}buildShader(e,t){this.resultCode[e]=t.build(this.setShader(e),"v4")}setMaterial(e,t){return this.defines={},this}addFlow(e,t,r){return this.addSlot(e).addCache(t).addContext(r)}removeFlow(){return this.removeSlot().removeCache().removeContext()}addCache(e){return this.cache=e??"",this.caches.push(this.cache),this}removeCache(){return this.caches.pop(),this.cache=this.caches[this.caches.length-1]||"",this}addContext(e){return this.context=Object.assign({},this.context,e),this.context.extra=this.context.extra||{},this.contexts.push(this.context),this}removeContext(){return this.contexts.pop(),this.context=this.contexts[this.contexts.length-1]||{},this}addSlot(e){return this.slot=e||"",this.slots.push(this.slot),this}removeSlot(){return this.slots.pop(),this.slot=this.slots[this.slots.length-1]||"",this}addFragmentVariable(e,t){this.fragmentVariables[e]===void 0&&(this.addFragmentCode(`${t} ${e};`),this.fragmentVariables[e]="")}addFragmentParsVariable(e,t){this.fragmentParsVariables[e]===void 0&&(this.addFragmentParsCode(`${t} ${e};`),this.fragmentParsVariables[e]="")}addVertexParsVariable(e,t){this.vertexParsVariables[e]===void 0&&(this.addVertexParsCode(`${t} ${e};`),this.vertexParsVariables[e]="")}addVertexCode(e){this.addCode(e,"vertex")}addFragmentCode(e){this.addCode(e,"fragment")}addCode(e,t){this.code[t??this.shader]+=e+`
`}addVertexNodeCode(e){this.addNodeCode(e,"vertex")}addFragmentNodeCode(e){this.addNodeCode(e,"fragment")}addNodeCode(e,t){this.nodeCode[t??this.shader]+=e+`
`}clearNodeCode(e){e=e??this.shader;let t=this.nodeCode[e];return this.nodeCode[e]="",t}clearVertexNodeCode(){return this.clearNodeCode("vertex")}clearFragmentNodeCode(){return this.clearNodeCode("fragment")}addVertexFinalCode(e){this.addFinalCode(e,"vertex")}addFragmentFinalCode(e){this.addFinalCode(e,"fragment")}addFinalCode(e,t){this.finalCode[t??this.shader]+=e+`
`}addVertexParsCode(e){this.addParsCode(e,"vertex")}addFragmentParsCode(e){this.addParsCode(e,"fragment")}addParsCode(e,t){this.parsCode[t??this.shader]+=e+`
`}addVaryCode(e){this.addVertexParsCode(e),this.addFragmentParsCode(e)}isCache(e){return this.caches.indexOf(e)!==-1}isSlot(e){return this.slots.indexOf(e)!==-1}define(e,t){this.defines[e]=t===void 0?1:t}require(e){this.requires[e]=!0}isDefined(e){return this.defines[e]!==void 0}getVar(e,t,r,i="varying",n="V",a=""){let o=this.getVars(i),s=o[e];if(!s){let l=o.length;s={name:r||"node"+n+l+(a?"_"+a:""),type:t},o.push(s),o[e]=s}return s}getTempVar(e,t,r,i){return this.getVar(e,t,r,this.shader,"T",i)}getAttribute(e,t){if(!this.attributes[e]){let r=this.getVar(e,t);this.addVertexParsCode("attribute "+t+" "+e+";"),this.addVertexFinalCode(r.name+" = "+e+";"),this.attributes[e]={varying:r,name:e,type:t}}return this.attributes[e]}getCode(e){return[this.prefixCode,this.parsCode[e],this.getVarListCode(this.getVars("varying"),"varying"),this.getVarListCode(this.inputs.uniforms[e],"uniform"),this.getVarListCode(this.inputs.arrayUniforms[e],"uniform"),this.getIncludesCode("consts",e),this.getIncludesCode("structs",e),this.getIncludesCode("functions",e),"void main() {",this.getVarListCode(this.getVars(e)),this.code[e],this.resultCode[e],this.finalCode[e],"}"].join(`
`)}getVarListCode(e,t){t=t??"";let r="";for(let i=0,n=e.length;i<n;++i){let a=e[i],o=a.type,s=a.name,l=a.size,c=this.getFormatByType(o);if(c===void 0)throw new Error("Node pars "+c+" not found.");c.includes("[]")?r+=t+" "+c.substring(0,c.length-2)+" "+s+`[${l}];
`:r+=t+" "+c+" "+s+`;
`}return r}getVars(e){return this.inputs.vars[e??this.shader]}getNodeData(e){let t=e instanceof mn?e.uuid:e;return this.nodeData[t]=this.nodeData[t]||{}}createUniform(e,t,r,i,n,a){if(t.includes("[]")){let o=this.inputs.arrayUniforms,s=o.list.length,l=new qL({type:t,size:r.size,name:i||"nodeUA"+s+(a?"_"+a:""),node:r,needsUpdate:n});return o.list.push(l),o[e].push(l),o[e][l.name]=l,this.uniforms[l.name]=l,l}else{let o=this.inputs.uniforms,s=o.list.length,l=new qL({type:t,name:i||"nodeU"+s+(a?"_"+a:""),node:r,needsUpdate:n});return o.list.push(l),o[e].push(l),o[e][l.name]=l,this.uniforms[l.name]=l,l}}createVertexUniform(e,t,r,i,n){return this.createUniform("vertex",e,t,r,i,n)}createFragmentUniform(e,t,r,i,n){return this.createUniform("fragment",e,t,r,i,n)}include(e,t,r){var a;let i;if(e=typeof e=="string"?Ga.get(e):e,this.context.include===!1)return e.name;e instanceof mt?i=this.includes.functions:e instanceof Kr?i=this.includes.consts:e instanceof K8&&(i=this.includes.structs);let n=i[this.shader]=i[this.shader]||[];if(e){let o=n[e.name];if(o||(o=n[e.name]={node:e,deps:[]},n.push(o),o.src=e.build(this,"source")),e instanceof mt&&t&&n[t.name]&&n[t.name].deps.indexOf(e)===-1&&(n[t.name].deps.push(e),(a=e.includes)==null?void 0:a.length)){let s=0;do this.include(e.includes[s++],t);while(s<e.includes.length)}return r&&(o.src=r),e.name}else throw new Error("Include not found.")}colorToVectorProperties(e){return e.replace("r","x").replace("g","y").replace("b","z").replace("a","w")}colorToVector(e){return e.replace(/c/g,"v3")}getIncludes(e,t){return this.includes[e][t||this.shader]}getConstructorFromLength(e){return WOe[e-1]}isTypeMatrix(e){return/^m/.test(e)}getTypeLength(e){return e==="f"?1:parseInt(this.colorToVector(e).substr(1))}getTypeFromLength(e){return e===1?"f":"v"+e}findNode(...e){for(let t=0;t<arguments.length;t++){let r=e[t];if(r!=null&&r.isNode)return r}}resolve(...e){for(let t=0;t<arguments.length;t++){let r=e[t];if(r!==void 0){if(r.isNode)return r;if(r.isTexture)switch(r.mapping){case th:case rh:return new BOe(r);case Hg:return new LOe(new Vl(r));default:return new Vl(r)}else{if(r.isVector2)return new Xn(r);if(r.isVector3)return new xo(r);if(r.isVector4)return new Ll(r)}}}}format(e,t,r){switch(this.colorToVector(r+" <- "+t)){case"f <- v2":return e+".x";case"f <- v3":return e+".x";case"f <- v4":return e+".x";case"f <- i":case"f <- b":return"float( "+e+" )";case"v2 <- f":return"vec2( "+e+" )";case"v2 <- v3":return e+".xy";case"v2 <- v4":return e+".xy";case"v2 <- i":case"v2 <- b":return"vec2( float( "+e+" ) )";case"v3 <- f":return"vec3( "+e+" )";case"v3 <- v2":return"vec3( "+e+", 0.0 )";case"v3 <- v4":return e+".xyz";case"v3 <- i":case"v3 <- b":return"vec2( float( "+e+" ) )";case"v4 <- f":return"vec4( "+e+" )";case"v4 <- v2":return"vec4( "+e+", 0.0, 1.0 )";case"v4 <- v3":return"vec4( "+e+", 1.0 )";case"v4 <- i":case"v4 <- b":return"vec4( float( "+e+" ) )";case"i <- f":case"i <- b":return"int( "+e+" )";case"i <- v2":return"int( "+e+".x )";case"i <- v3":return"int( "+e+".x )";case"i <- v4":return"int( "+e+".x )";case"b <- f":return"( "+e+" != 0.0 )";case"b <- v2":return"( "+e+" != vec2( 0.0 ) )";case"b <- v3":return"( "+e+" != vec3( 0.0 ) )";case"b <- v4":return"( "+e+" != vec4( 0.0 ) )";case"b <- i":return"( "+e+" != 0 )"}return e}getTypeByFormat(e){return GOe[e]||e}getFormatByType(e){return $Oe[e]||e}getUUID(e,t){return t=t!==void 0?t:!0,t&&this.cache&&(e=this.cache+"-"+e),e}getElementByIndex(e){return KL[e]}getIndexByElement(e){return KL.indexOf(e)}isShader(e){return this.shader===e}setShader(e){return this.shader=e,this}mergeDefines(e){for(let t in e)this.defines[t]=e[t];return this.defines}mergeUniform(e){for(let t in e)this.uniforms[t]=e[t];return this.uniforms}getTextureEncodingFromMap(e){let t;return e?e.isTexture&&(t=e.encoding):t=hs,t===hs&&this.context.gamma&&(t=sr),t}},Fi=class extends eo{constructor(e=0,t,r,i){super("c"),this.nodeType="Color",this.value=e instanceof ia?e:new ia(e||0,t,r,i)}setRGBA(e){this.value.setRGBA(e.r,e.g,e.b,e.a)}generate(e,t,r,i,n,a){r=e.getUUID(r??this.getUUID()),i=i??this.getType(e);let o=e.getNodeData(r),s=this.getReadonly()&&this.generateReadonly!==void 0;if(this.alpha){let l=this.alpha.build(e,"f");e.addFragmentNodeCode(`accumAlpha += ( 1.0 - accumAlpha ) * ${l};`)}return s?this.generateReadonly(e,t,r,i,n,a):e.isShader("vertex")?(o.vertex||(o.vertex=e.createVertexUniform(i,this,n,a,this.getLabel())),e.format(o.vertex.name,i,t)):(o.fragment||(o.fragment=e.createFragmentUniform(i,this,n,a,this.getLabel())),e.format(o.fragment.name,i,t))}generateReadonly(e,t,r,i,n,a){return e.format("vec3("+this.value.r+", "+this.value.g+", "+this.value.b+")",i,t)}},oi=class extends eo{constructor(e){super("i"),this.nodeType="Int",this.value=Math.floor(e??0)}generateReadonly(e,t,r,i,n,a){return e.format(this.value.toString(),i,t)}},Ea=class extends eo{constructor(e){super("b"),this.nodeType="Bool",this.value=e??!1}generateReadonly(e,t,r,i){return e.format(this.value?"true":"false",i,t)}},su=class extends eo{constructor(e=1,t){super("f[]"),this.nodeType="FloatArray",this.size=e,this.value=Array.isArray(t)?t:typeof t=="number"?new Array(e).fill(t):new Array(e).fill(0)}},JP=class extends eo{},qOe=class extends JP{constructor(e){super("v3"),this.image=e,this._value=new k}get value(){return this._value.x=this.image.isVideo?this.image.img.videoWidth??0:this.image.img.width,this._value.y=this.image.isVideo?this.image.img.videoHeight??0:this.image.img.height,this._value}},qM=class extends JP{constructor(e,t,r=1008,i=1006){super("t"),this.image=e,this.wrap=t,this.minFilter=r,this.magFilter=i}get value(){return this.image.getTexture(this.wrap,this.minFilter,this.magFilter)}},J8=class extends eo{constructor(e){super("m3"),this.nodeType="Matrix3",this.value=e??new sn}generateReadonly(e,t,r,i,n,a){return e.format("mat3("+this.value.elements.join(", ")+")",i,t)}get elements(){return this.value.elements}set elements(e){this.value.fromArray(e)}},ll=class extends eo{constructor(e){super("m4"),this.nodeType="Matrix4",this.value=e??new it}generateReadonly(e,t,r,i,n,a){return e.format("mat4("+this.value.elements.join(", ")+")",i,t)}get elements(){return this.value.elements}set elements(e){this.value.fromArray(e)}};function QL(e,t,r,i=0){e.setUvTransform(r[0],r[1],t[0],t[1],0,0,0).premultiply(new sn().makeRotation(i*St.DEG2RAD))}var YOe=class extends J8{constructor(e,t,r=0){super(new sn),this.repeat=e,this.offset=t,this.rotation=r,QL(this.value,e,t,r)}updateMatrix(){QL(this.value,this.repeat,this.offset,this.rotation)}},lu=class extends eo{constructor(e=1,t){super("v4[]"),this.nodeType="Vector4Array",this.size=e,this.value=Array.isArray(t)?t:t instanceof Kt?new Array(e).fill(t):new Array(e).fill(new Kt(0))}},ZL=class extends ii{constructor(e,t,r,i){super("v3"),this.nodeType="Blend",this.a=e,this.b=t,this.alpha=r,this.mode=i}generate(e,t){if(e.isShader("fragment")){let r=[];return r.push(this.a.build(e,"c")),r.push(this.b.build(e,"c")),r.push(this.alpha.build(e,"f")),r.push(this.mode.build(e,"i")),e.format("spe_blend("+r.join(",")+")",this.getType(e),t)}else return console.warn("BlendNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},eH=class extends ii{constructor(e,t){super("v3"),this.nodeType="CustomColor",this.color=e,this.alpha=t,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.isShader("fragment")){let r=e.include(eH.Nodes.customColor);e.addFragmentVariable(this.calpha,"float");let i=[];return i.push(this.color.build(e,"v3")),i.push(this.mask?`luminance(${this.mask.build(e,"v3")})`:"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.calpha),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("CustomColorNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},YM=eH;YM.Nodes=function(){return{customColor:new mt(`vec3 customColor(vec3 color, float mask, float alpha, out float calpha) {
				float lalpha = alpha * mask;
				calpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);
				accumAlpha += (1.0 - accumAlpha) * lalpha;

				return color;
			}`)}}();var tH=class extends ii{constructor(e,t){super("v3"),this.nodeType="CustomNormal",this.cnormal=e,this.alpha=t,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.isShader("fragment")){let r=e.include(tH.Nodes.customNormal);e.addFragmentVariable(this.calpha,"float");let i=[];return i.push(this.cnormal.build(e,"v3")),i.push("normal"),i.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.calpha),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("CustomNormalNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},rH=tH;rH.Nodes=function(){return{customNormal:new mt(`vec3 customNormal(vec3 cnormal, vec3 norm, float mask, float alpha, out float calpha) {
				vec3 normal = packNormalToRGB( norm ).rgb;
				normal *= step( vec3(0.5), cnormal );

				float lalpha = alpha * mask;
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += ( 1.0 - accumAlpha ) * lalpha;

				return normal;
			}`)}}();var nv=class extends ii{constructor(e,t,r,i,n,a,o,s,l,c,d,u){super("v3"),this.nodeType="CustomTexture",this.texture=e,this.textureSize=t,this.crop=r,this.projection=i,this.axis=n,this.side=a,this.size=o,this.blending=s,this.mat=l,this.isMask=u,this.alpha=c,this.mode=d,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){e.require("position"),e.require("normal"),e.require("uv"),e.requires.uv=[!0],e.extensions.shaderTextureLOD=!0,e.extensions.derivatives=!0;let r=`g${this.uuid.toString().replace(/-/g,"")}`,i;switch(this.projection.value){case 3:i=e.include(nv.Nodes.cylindrical);break;case 2:i=e.include(nv.Nodes.spherical);break;case 1:let a=["vec3(1.0, 0.0, 0.0)","vec3(0.0, 1.0, 0.0)","vec3(0.0, 0.0, 1.0)"][this.axis.value],o=["zy","xz","xy"][this.axis.value],s=new mt(`
		vec3 ${r}_planarTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
				vec2 projected = (1. + (position.${o})) / 2.;
				vec2 uvs = ( mat * vec3( (projected * 2. - 1.) / (size * .5), 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

				vec4 tmp = texture2D( tex, uvs );

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				${this.side.value===2?"":`lalpha *= step(0.0, ${this.side.value===1?"-1.0 * ":""}dot(vObjectNormal, ${a}));`}

				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}
				
				lalpha *= mask;

				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}`);i=e.include(s);break;case 4:i=e.include(nv.Nodes.triplanar);break;default:i=e.include(nv.Nodes.uv);break}e.addFragmentVariable(this.calpha,"float");let n=[];if(n.push("normal"),n.push(this.texture.generate(e,"t")),n.push(this.textureSize.build(e,"v2")),n.push(this.crop.build(e,"f")),n.push(this.mat.build(e,"mat3")),n.push(this.size.build(e,"v2")),n.push(this.blending.build(e,"f")),n.push(this.isMask.build(e,"b")),n.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),n.push(this.alpha.build(e,"f")),n.push(this.mode.build(e,"i")),n.push(this.calpha),this.projection.value===4){let a=`${r}_writeUvs`,o=a+"0",s=a+"1",l=a+"2",c=`${r}_triplanarWeights`;e.addFragmentVariable(o,"vec2"),e.addFragmentVariable(s,"vec2"),e.addFragmentVariable(l,"vec2"),e.addFragmentVariable(c,"vec3"),n.push(o),n.push(s),n.push(l),n.push(c)}else{let a=`${r}_writeUvs`;e.addFragmentVariable(a,"vec2"),n.push(a)}return e.format(i+"("+n.join(",")+")",this.getType(e),t)}},eD=nv;eD.Nodes=function(){let e=new mt(`
vec3 cylindricalTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
                vec3 posN = normalize(position);
                float u = 0.5 + atan(posN.z, posN.x) / (2.*3.1415);
                float scaledHeight = position.y / (size.y * 0.5);
                float v =  (scaledHeight / 2.) + .5;

                vec2 calculatedUv = vec2(u,v);
				vec2 uvs = ( mat * vec3( calculatedUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

                vec2 df = fwidth(uvs);
               	if(df.x > 0.5) df.x = 0.;

				#ifdef GL_EXT_shader_texture_lod
                vec4 tmp = texture2DLodEXT(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#else
                vec4 tmp = textureLod(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#endif

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}

				lalpha *= mask;
				
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}
`),t=new mt(`
vec3 sphericalTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
                vec3 posN = normalize(vPosition);
                float u = 0.5 + atan(posN.z, posN.x) / (2.*3.1415);
                float v = 0.5 + asin(posN.y) / 3.1415;

                vec2 calculatedUv = vec2(u,v);
				vec2 uvs = ( mat * vec3( calculatedUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

                vec2 df = fwidth(uvs);
               	if(df.x > 0.5) df.x = 0.;
				#ifdef GL_EXT_shader_texture_lod
                vec4 tmp = texture2DLodEXT(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#else
                vec4 tmp = textureLod(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#endif

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}

				lalpha *= mask;

				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}
`),r=new mt(`vec3 uvTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
				vec2 uvs = ( mat * vec3( vUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

				vec4 tmp = texture2D( tex, uvs );

				vec3 col = tmp.rgb;

				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}
				
				lalpha *= mask;

				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}`),i=new mt(`vec3 triplanarTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUvs0, out vec2 writeUvs1, out vec2 writeUvs2, out vec3 writeWeights) {
				vec3 p = position;
				vec2 uv0 = (1.0 + p.xy) / 2.0;     
				vec2 uv1 = (1.0 + p.zy) / 2.0;		
				vec2 uv2 = (1.0 + p.xz) / 2.0;		
	
				uv0 = (mat * vec3((uv0 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;
				uv1 = (mat * vec3((uv1 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;
				uv2 = (mat * vec3((uv2 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;

				// Range from 3 to 128 seems to be good
				float exponent = (1.0 - blending) * 125.0 + 3.0;

				vec3 n = vObjectNormal;
				vec3 weights = abs(normalize(n));
				weights = pow(weights, vec3(exponent));
				weights /= dot(weights, vec3(1.0));

				// Write out all sets of UVs that we generated
				writeUvs0 = uv0;
				writeUvs1 = uv1;
				writeUvs2 = uv2;
				writeWeights = weights;

				// Derivatives for LOD
				vec2 df0 = fwidth(uv0);
				vec2 df1 = fwidth(uv1);
				vec2 df2 = fwidth(uv2);
				if (df0.x > 0.5) df0.x = 0.0;
				if (df1.x > 0.5) df1.x = 0.0;
				if (df2.x > 0.5) df2.x = 0.0;

				#ifdef GL_EXT_shader_texture_lod
                	vec4 tmp = 
						texture2DLodEXT(tex, uv0, log2(max(df0.x, df0.y)*min(textureSize.x, textureSize.y))) * weights.z + 
						texture2DLodEXT(tex, uv1, log2(max(df1.x, df1.y)*min(textureSize.x, textureSize.y))) * weights.x + 
						texture2DLodEXT(tex, uv2, log2(max(df2.x, df2.y)*min(textureSize.x, textureSize.y))) * weights.y;
				#else
                	vec4 tmp = 
						textureLod(tex, uv0, log2(max(df0.x, df0.y)*min(textureSize.x, textureSize.y))) * weights.z + 
						textureLod(tex, uv1, log2(max(df1.x, df1.y)*min(textureSize.x, textureSize.y))) * weights.x + 
						textureLod(tex, uv2, log2(max(df2.x, df2.y)*min(textureSize.x, textureSize.y))) * weights.y;
				#endif

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;

				// Apply cropping across all 3 planes
				if ( crop > 0.5 ) {
					if ( uv0.x < 0.0 || uv0.x > 1.0 || uv0.y < 0.0 || uv0.y > 1.0 )  {
						lalpha = 0.0;
					}
					if ( uv1.x < 0.0 || uv1.x > 1.0 || uv1.y < 0.0 || uv1.y > 1.0 )  {
						lalpha = 0.0;
					}
					if ( uv2.x < 0.0 || uv2.x > 1.0 || uv2.y < 0.0 || uv2.y > 1.0 )  {
						lalpha = 0.0;
					}
				}

				lalpha *= mask;
				calpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;//n * 0.5 + 0.5;
			}			
			`);return{cylindrical:e,spherical:t,uv:r,triplanar:i}}();var av=class extends ii{constructor(e,t,r,i,n,a,o,s,l,c,d,u){super("v3"),this.nodeType="Depth",this.gradientType=e,this.smooth=t,this.near=r,this.far=i,this.isVector=n,this.isWorldSpace=a,this.origin=o,this.direction=s,this.colors=l,this.steps=c,this.isMask=u,this.alpha=d,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){let r=`g${this.uuid.toString().replace(/-/g,"")}`,i=new mt(`vec3 ${r}_sdepth(float near, float far, vec3 origin, vec3 direction, vec4 colors[${r}_MAX_COLORS], float steps[${r}_MAX_COLORS], bool isMask, float mask, float alpha, out float calpha) {
               vec4 color = colors[0];
               #ifdef ${r}_IS_VECTOR
                   #ifdef ${r}_LINEAR
                       #ifdef ${r}_WORLDSPACE
                       float depth = vectorLinearWorldSpaceDepth(direction, origin, near, far);
                       #else
                       float depth = vectorLinearObjectSpaceDepth(direction, origin, near, far);
                       #endif
                   #else
                       #ifdef ${r}_WORLDSPACE
                           float depth = vectorSphericalWorldSpaceDepth(origin, near, far);
                       #else
                           float depth = vectorSphericalObjectSpaceDepth(origin, near, far);
                       #endif
                   #endif
               #else
                   float dist = length(vWPosition - cameraPosition);
			       float depth = ( dist - near ) / ( far - near );
               #endif


              float p;
              #ifdef ${r}_SMOOTH
				for ( int i = 1; i < ${r}_MAX_COLORS; i++ ) {
						p = clamp( ( depth - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
					}
              #else
                for ( int i = 1; i < ${r}_MAX_COLORS; i++ ) {
                   p = clamp(( depth - steps[i - 1] ) / ( steps[i] - steps[i - 1] ), 0.0, 1.0);
                   color = mix(color, colors[i], p);
                 }
              #endif

               float lalpha = alpha * color.a * mask;
               calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
			   accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));
			   
               return color.rgb;
			}`,[av.Nodes.vectorLinearWorldSpaceDepth,av.Nodes.vectorLinearObjectSpaceDepth,av.Nodes.vectorSphericalObjectSpaceDepth,av.Nodes.vectorSphericalWorldSpaceDepth]);if(e.isShader("fragment")){e.define(`${r}_MAX_COLORS`,this.colors.value.length),this.smooth.value&&e.define(`${r}_SMOOTH`),this.isVector.value>.5&&e.define(`${r}_IS_VECTOR`),this.gradientType.value===0&&e.define(`${r}_LINEAR`),this.isWorldSpace.value>.5&&e.define(`${r}_WORLDSPACE`),e.require("worldPosition"),e.addFragmentVariable(this.calpha,"float");let n=e.include(i),a=[];return a.push(this.near.build(e,"f")),a.push(this.far.build(e,"f")),a.push(this.origin.build(e,"v3")),a.push(this.direction.build(e,"v3")),a.push(this.colors.build(e,"v4[]")),a.push(this.steps.build(e,"f[]")),a.push(this.isMask.build(e,"b")),a.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),a.push(this.alpha.build(e,"f")),a.push(this.calpha),e.format(n+"("+a.join(",")+")",this.getType(e),t)}else return console.warn("DepthNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},iH=av;iH.Nodes=function(){let e=new mt(`float vectorLinearWorldSpaceDepth(vec3 direction, vec3 origin, float near, float far) {
               vec3 n = normalize(direction);
               float dist = (n.x*(vWPosition.x - origin.x) + n.y*(vWPosition.y - origin.y) + n.z*(vWPosition.z - origin.z));
               return ( dist - near ) / ( far - near );
            }`),t=new mt(`float vectorLinearObjectSpaceDepth(vec3 direction, vec3 origin, float near, float far) {
               vec3 n = normalize(direction);
               float dist = (n.x*(position.x - origin.x) + n.y*(position.y - origin.y) + n.z*(position.z - origin.z));
               return ( dist - near ) / ( far - near );
            }`),r=new mt(`float vectorSphericalWorldSpaceDepth(vec3 origin, float near, float far) {
               float dist = length(vWPosition - origin);
               return ( dist - near ) / ( far - near );
            }`),i=new mt(`float vectorSphericalObjectSpaceDepth(vec3 origin, float near, float far) {
               float dist = length(position - origin);
               return ( dist - near ) / ( far - near );
            }`);return{vectorLinearWorldSpaceDepth:e,vectorLinearObjectSpaceDepth:t,vectorSphericalWorldSpaceDepth:r,vectorSphericalObjectSpaceDepth:i}}();var XOe=class extends ii{constructor(e,t,r,i,n,a,o,s){super("v3"),this.nodeType="Fresnel",this.color=e,this.bias=t,this.scale=r,this.intensity=i,this.factor=n,this.isMask=s,this.alpha=a,this.mode=o,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.require("vWorldViewDir"),e.require("worldNormal"),e.isShader("fragment")){e.addFragmentVariable(this.calpha,"float");let r=new mt(`vec3 fresnel(vec3 color, float bias, float scale, float intensity, float factor, bool isMask, float mask, float alpha, int mode, out float calpha) {
					float fresnel = bias + scale * pow( abs( factor + dot( normalize( vWorldViewDir ), normalize( vWNormal ) ) ), intensity );

					float lalpha = clamp(fresnel, 0.0, 1.0) * alpha * mask;
					calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
					accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

					return color;
				}`),i=e.include(r),n=[];return n.push(this.color.build(e,"c")),n.push(this.bias.build(e,"f")),n.push(this.scale.build(e,"f")),n.push(this.intensity.build(e,"f")),n.push(this.factor.build(e,"f")),n.push(this.isMask.build(e,"b")),n.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),n.push(this.alpha.build(e,"f")),n.push(this.mode.build(e,"i")),n.push(this.calpha),e.format(i+"("+n.join(",")+")",this.getType(e),t)}else return console.warn("FresnelNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},nH=class extends ii{constructor(e,t,r,i,n,a,o,s,l){super("v3"),this.nodeType="Gradient",this.gradientType=e,this.smooth=t,this.colors=r,this.steps=i,this.offset=n,this.morph=a,this.angle=o,this.isMask=l,this.alpha=s,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.isShader("fragment")){e.define("GRAD_MAX",10),e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let r=e.include(nH.Nodes.gradient),i=[];return i.push(this.gradientType.build(e,"i")),i.push(this.smooth.build(e,"b")),i.push(this.colors.build(e,"v4[]")),i.push(this.steps.build(e,"f[]")),i.push(this.offset.build(e,"v2")),i.push(this.morph.build(e,"v2")),i.push(this.angle.build(e,"f")),i.push(this.isMask.build(e,"b")),i.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.calpha),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("GradientNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},aH=nH;aH.Nodes=function(){return{gradient:new mt(`vec3 gradient(int gradientType, bool smoothed, vec4 colors[GRAD_MAX], float steps[GRAD_MAX], vec2 offset, vec2 morph, float angle, bool isMask, float mask, float alpha, out float calpha) {
				vec4 color = colors[0];
				vec2 m = morph / vUv.xy;
				vec2 rot = vec2( 0.5 + m.x, m.y );
				vec2 dt = vec2(
					cos( angle ) * rot.x - sin( angle ) * rot.y,
					sin( angle ) * rot.x + cos( angle ) * rot.y
				);
				vec2 pt = ( vUv - 0.5 + offset ) / 2.0 + dt / 2.0;
				float t = dot( pt, dt ) / dot( dt, dt );
				if ( gradientType == 1 ) {
					t = distance (
						( vUv + morph ) * 3.0,
						( vUv + offset ) + 1.0
					) + angle;
				} else if ( gradientType == 2 ) {
					float polar = atan(
						vUv.x + morph.x - 0.5 + offset.x,
						vUv.y + morph.y - 0.5 + offset.y
					) * -1.0;
					t = fract( ( angle / PI / -2.0 ) + 0.5 * ( polar / PI ) );
				}

				float p;
				if (smoothed) {
					for ( int i = 1; i < GRAD_MAX; i++ ) {
						p = clamp( ( t - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
					}

				} else {
					for ( int i = 1; i < GRAD_MAX; i++ ) {
						p = clamp( ( t - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], p);
					}
				}

				float lalpha = alpha * color.a * mask;
				calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));
				
				return color.xyz;
			}`)}}();var oH=class extends ii{constructor(e,t,r,i,n){super("v3"),this.nodeType="Matcap",this.texture=e,this.isMask=i,this.alpha=t,this.mode=r,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`,this.rotation=n}generate(e,t){if(e.isShader("fragment")){e.addFragmentVariable(this.calpha,"float");let r=e.include(oH.Nodes.matcap);e.require("normal"),e.requires.normal=!0;let i=[];return i.push(this.texture.generate(e,"t")),i.push("normal"),i.push(this.isMask.build(e,"b")),i.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.mode.build(e,"i")),i.push(this.calpha),i.push(this.rotation.build(e,"f")),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("MatcapNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},sH=oH;sH.Nodes=function(){return{matcap:new mt(`vec3 matcap(sampler2D matcapTex, vec3 normal, bool isMask, float mask, float alpha, int mode, out float calpha, float rotation) {
					vec3 viewDir = normalize( vViewPosition );
					vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
					vec3 y = cross( viewDir, x );
					vec2 uv = vec2( dot( x, normal ), dot( y, normal ) );
					uv = mat2( cos(rotation), sin(rotation), -sin(rotation), cos(rotation) ) * uv;
					uv = uv * 0.495 + 0.5;
					vec4 matcapColor = texture2D( matcapTex, uv );

					float lalpha = alpha * mask;
					calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
					accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));
					
					return matcapColor.rgb;
            	}`)}}();var tD=(e=>(e.SIMPLEX="simplex3d",e.SIMPLEX_FRACTAL="simplex3dFractal",e.ASHIMA="simplexAshima",e.FBM="fbm",e.PERLIN="perlin",e.VORONOI="voronoi",e))(tD||{}),Ha=function(){let e=new mt(`vec3 random3(vec3 c) {
			float j = 4096.0*sin(dot(c,vec3(17.0, 59.4, 15.0)));
			vec3 r;
			r.z = fract(512.0*j);
			j *= .125;
			r.x = fract(512.0*j);
			j *= .125;
			r.y = fract(512.0*j);
			return r-0.5;
		}`),t=new mt(`float simplex3d(vec3 p) {
			 vec3 s = floor(p + dot(p, vec3(F3)));
			 vec3 x = p - s + dot(s, vec3(G3));
			 
			 vec3 e = step(vec3(0.0), x - x.yzx);
			 vec3 i1 = e*(1.0 - e.zxy);
			 vec3 i2 = 1.0 - e.zxy*(1.0 - e);
				
			 vec3 x1 = x - i1 + G3;
			 vec3 x2 = x - i2 + 2.0*G3;
			 vec3 x3 = x - 1.0 + 3.0*G3;
			 
			 vec4 w, d;
			 
			 w.x = dot(x, x);
			 w.y = dot(x1, x1);
			 w.z = dot(x2, x2);
			 w.w = dot(x3, x3);
			 
			 w = max(0.6 - w, 0.0);
			 
			 d.x = dot(random3(s), x);
			 d.y = dot(random3(s + i1), x1);
			 d.z = dot(random3(s + i2), x2);
			 d.w = dot(random3(s + 1.0), x3);
			 
			 w *= w;
			 w *= w;
			 d *= w;
			 
			 return dot(d, vec4(52.0));
		}`,[e]);t.keywords.F3=new Kr("float F3 0.3333333"),t.keywords.G3=new Kr("float G3 0.1666667");let r=new mt(`float simplex3dFractal(vec3 m) {
			mat3 rot1 = mat3(-0.37, 0.36, 0.85,-0.14,-0.93, 0.34,0.92, 0.01,0.4);
			mat3 rot2 = mat3(-0.55,-0.39, 0.74, 0.33,-0.91,-0.24,0.77, 0.12,0.63);
			mat3 rot3 = mat3(-0.71, 0.52,-0.47,-0.08,-0.72,-0.68,-0.7,-0.45,0.56);
			return 0.5333333 * simplex3d(m * rot1)
				 + 0.2666667 * simplex3d(2.0 * m * rot2)
				 + 0.1333333 * simplex3d(4.0 * m * rot3)
				 + 0.0666667 * simplex3d(8.0 * m);
		}`,[t]),i=new mt("vec4 permute(vec4 x){return mod(((x*34.0)+1.0)*x, 289.0);}"),n=new mt("vec4 taylorInvSqrt(vec4 r){return 1.79284291400159 - 0.85373472095314 * r;}"),a=new mt(`float simplexAshima(vec3 v) {
		  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;
		  const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);
		  vec3 i  = floor(v + dot(v, C.yyy) );
		  vec3 x0 =   v - i + dot(i, C.xxx) ;
		  vec3 g = step(x0.yzx, x0.xyz);
		  vec3 l = 1.0 - g;
		  vec3 i1 = min( g.xyz, l.zxy );
		  vec3 i2 = max( g.xyz, l.zxy );
		  vec3 x1 = x0 - i1 + 1.0 * C.xxx;
		  vec3 x2 = x0 - i2 + 2.0 * C.xxx;
		  vec3 x3 = x0 - 1. + 3.0 * C.xxx;
		  i = mod(i, 289.0 ); 
		  vec4 p = permute( permute( permute( 
					 i.z + vec4(0.0, i1.z, i2.z, 1.0 ))
				   + i.y + vec4(0.0, i1.y, i2.y, 1.0 )) 
				   + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));
		  float n_ = 1.0/7.0; // N=7
		  vec3  ns = n_ * D.wyz - D.xzx;
		  vec4 j = p - 49.0 * floor(p * ns.z *ns.z);  //  mod(p,N*N)
		  vec4 x_ = floor(j * ns.z);
		  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)
		  vec4 x = x_ *ns.x + ns.yyyy;
		  vec4 y = y_ *ns.x + ns.yyyy;
		  vec4 h = 1.0 - abs(x) - abs(y);
		  vec4 b0 = vec4( x.xy, y.xy );
		  vec4 b1 = vec4( x.zw, y.zw );
		  vec4 s0 = floor(b0)*2.0 + 1.0;
		  vec4 s1 = floor(b1)*2.0 + 1.0;
		  vec4 sh = -step(h, vec4(0.0));
		  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;
		  vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;
		  vec3 p0 = vec3(a0.xy,h.x);
		  vec3 p1 = vec3(a0.zw,h.y);
		  vec3 p2 = vec3(a1.xy,h.z);
		  vec3 p3 = vec3(a1.zw,h.w);
		  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));
		  p0 *= norm.x;
		  p1 *= norm.y;
		  p2 *= norm.z;
		  p3 *= norm.w;
		  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);
		  m = m * m;
		  return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1), 
										dot(p2,x2), dot(p3,x3) ) );
		}`,[i,n]),o=new mt("vec4 mod289(vec4 x){return x - floor(x * (1.0 / 289.0)) * 289.0;}"),s=new mt("vec4 perm(vec4 x){return mod289(((x * 34.0) + 1.0) * x);}",[o]),l=new mt(`float noise(vec3 p){
			vec3 a = floor(p);
			vec3 d = p - a;
			d = d * d * (3.0 - 2.0 * d);
			vec4 b = a.xxyy + vec4(0.0, 1.0, 0.0, 1.0);
			vec4 k1 = perm(b.xyxy);
			vec4 k2 = perm(k1.xyxy + b.zzww);
			vec4 c = k2 + a.zzzz;
			vec4 k3 = perm(c);
			vec4 k4 = perm(c + 1.0);
			vec4 o1 = fract(k3 * (1.0 / 41.0));
			vec4 o2 = fract(k4 * (1.0 / 41.0));
			vec4 o3 = o2 * d.z + o1 * (1.0 - d.z);
			vec2 o4 = o3.yw * d.x + o3.xz * (1.0 - d.x);
			return o4.y * d.y + o4.x * (1.0 - d.y);
		}`,[s]),c=new mt(`float fbm(vec3 x) {
			float v = 0.0;
			float a = 0.5;
			vec3 shift = vec3(100);
			for (int i = 0; i < NUM_OCTAVES; ++i) {
				v += a * noise(x);
				x = x * 2.0 + shift;
				a *= 0.5;
			}
			return v;
		}`,[l]);c.keywords.NUM_OCTAVES=new Kr("int NUM_OCTAVES 5");let d=new mt("vec3 fade(vec3 t) {return t*t*t*(t*(t*6.0-15.0)+10.0);}"),u=new mt(`float perlin(vec3 P){
		  vec3 Pi0 = floor(P);
		  vec3 Pi1 = Pi0 + vec3(1.0);
		  Pi0 = mod(Pi0, 289.0);
		  Pi1 = mod(Pi1, 289.0);
		  vec3 Pf0 = fract(P);
		  vec3 Pf1 = Pf0 - vec3(1.0);
		  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);
		  vec4 iy = vec4(Pi0.yy, Pi1.yy);
		  vec4 iz0 = Pi0.zzzz;
		  vec4 iz1 = Pi1.zzzz;
		  vec4 ixy = permute(permute(ix) + iy);
		  vec4 ixy0 = permute(ixy + iz0);
		  vec4 ixy1 = permute(ixy + iz1);
		  vec4 gx0 = ixy0 / 7.0;
		  vec4 gy0 = fract(floor(gx0) / 7.0) - 0.5;
		  gx0 = fract(gx0);
		  vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);
		  vec4 sz0 = step(gz0, vec4(0.0));
		  gx0 -= sz0 * (step(0.0, gx0) - 0.5);
		  gy0 -= sz0 * (step(0.0, gy0) - 0.5);
		  vec4 gx1 = ixy1 / 7.0;
		  vec4 gy1 = fract(floor(gx1) / 7.0) - 0.5;
		  gx1 = fract(gx1);
		  vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);
		  vec4 sz1 = step(gz1, vec4(0.0));
		  gx1 -= sz1 * (step(0.0, gx1) - 0.5);
		  gy1 -= sz1 * (step(0.0, gy1) - 0.5);
		  vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);
		  vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);
		  vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);
		  vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);
		  vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);
		  vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);
		  vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);
		  vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);
		  vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));
		  g000 *= norm0.x;
		  g010 *= norm0.y;
		  g100 *= norm0.z;
		  g110 *= norm0.w;
		  vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));
		  g001 *= norm1.x;
		  g011 *= norm1.y;
		  g101 *= norm1.z;
		  g111 *= norm1.w;
		  float n000 = dot(g000, Pf0);
		  float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));
		  float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));
		  float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));
		  float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));
		  float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));
		  float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));
		  float n111 = dot(g111, Pf1);
		  vec3 fade_xyz = fade(Pf0);
		  vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);
		  vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);
		  float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x); 
		  return 2.2 * n_xyz;
		}`,[i,n,d]),h=new mt(`float hashwithoutsine13(vec3 p3)
		{
			p3  = fract(p3 * .1031);
			p3 += dot(p3, p3.yzx + 33.33);
			return fract((p3.x + p3.y) * p3.z);
		}`),f=new mt(`vec3 hashwithoutsine33(vec3 p3)
		{
			p3 = fract(p3 * vec3(.1031, .1030, .0973));
			p3 += dot(p3, p3.yxz+33.33);
			return fract((p3.xxy + p3.yxx)*p3.zyx);
		}`),p=new mt(`float metric(in vec3 p)
		{
			// L2 
			return length(p);

			// Chebyshev 
			// vec3 a = abs(p);
			// return max(a.x, max(a.y, a.z));
		}`),v=new mt(`float smin( float a, float b, float k )
		{
			float h = smoothstep(0.0, 1.0, 0.5 + 0.5 * (b - a) / k);
			float correction = k * h * (1.0 - h);
			return mix(b, a, h) - correction;
		}`),m=new mt(`float smax( float a, float b, float k )
		{
			float h = smoothstep(1.0, 0.0, 0.5 + 0.5 * (a - b) / k);
			float correction = k * h * (1.0 - h);
			return mix(a, b, h) + correction;
		}`),g=new mt(`float remap(float value, float input_min, float input_max, float output_min, float output_max) {
			// Compute width of each interval
			float input_width = input_max - input_min;
			float output_width = output_max - output_min;
		
			// Convert input range into a 0-1 range 
			float scaled = (value - input_min) / input_width;
		
			// Convert the 0-1 range into a value in output range
			return output_min + (scaled * output_width);
		}`),y=new mt(`float voronoi(in vec3 x, in int style, in float smoothness, in float seed, in int quality) 
		{
			// Integer and fractional parts of this point's coordinates
			ivec3 p = ivec3(floor(x));
			vec3 f = fract(x);

			// Different variables that we will use to construct noise:
			//
			// f1: distance to the closest feature point
			// f2: distance to the second closest feature point
			// e: distance to the closest edge (cell boundary)
			//
			// We also compute "smooth" versions of all of the above quantites, essentially
			// replacing "hard" minimums with "smooth" minimums (described by IQ)
			float f1_smooth = 8.0;
			float f1 = 8.0;
			float f2_smooth = 8.0;
			float f2 = 8.0;
			float e_smooth = 8.0;
			float e = 8.0;

			// Variables stored from closest cell
			ivec3 mb;
			vec3 mr; 

			int steps = quality;
			
			for (int x = -steps; x <= steps; x++) 
			for (int y = -steps; y <= steps; y++)
			for (int z = -steps; z <= steps; z++)
			{
				ivec3 b = ivec3(x, y, z);
				vec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;
				float d = length(r);
				
				f1_smooth = smin(d, f1_smooth, smoothness);

				// Store un-smoothed distances too 
				if (d < f1) 
				{
					f2 = f1;
					f1 = d;

					mb = ivec3(x, y, z);
					mr = r;
				} 
				else if (d < f2) 
				{
					f2 = d;
				}
			}	
			
			float id = hashwithoutsine13(vec3(p + mb) + seed);

			// Second pass for edge distance  
			for (int x = -steps; x <= steps; x++) 
			for (int y = -steps; y <= steps; y++)
			for (int z = -steps; z <= steps; z++)
			{
				// Start search at the cell that contains the closest point to "x" (found in 1st pass)
				ivec3 b = mb + ivec3(x, y, z);
				vec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;
				float d1 = dot(0.5 * (mr + r), (r - mr)); 				// IQ normalizes "r - mr" but that breaks things for the smooth version?
				float d2 = dot(0.5 * (mr + r), normalize(r - mr));

				e_smooth = smin(d1, e_smooth, smoothness);

				e = min(e, d2);

				// Also compute a smooth version of F2 in this pass
				{
					ivec3 b = ivec3(x, y, z);
					if (b != mb) 
					{
						vec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;
						float d = length(r);

						f2_smooth = smin(d, f2_smooth, smoothness);
					}
				}
			}

			// Different visualization modes 
			if (style == 0) 
			{
				return f1_smooth;
			}
			if (style == 1) 
			{
				return f2_smooth;
			}
			if (style == 2) 
			{
				return f2_smooth - f1_smooth;
				
				// "Pebbles" also cool
				//return step(0.2, f2_smooth - f1_smooth);
			}
			if (style == 3) 
			{
				// This one is really good for rock / stone effects
				float a = f1; 
				float b = f2;
				float k = 3.0;
				float h = max(k - abs(a - b), 0.0) / k;
				float final = min(a, b) - h * h * k * (1.0 / 4.0);
				return final;
			}
			if (style == 4) 
			{
				// Some random adjustments to make this style stand out more 
				return exp(5.0 * e_smooth);
			}
			if (style == 5) 
			{
				return pow(f1_smooth, 3.0);
			}
			if (style == 6) 
			{				
				const float eps = 0.0125;

				// Thicker lines as the user increases the smoothness slider
				float thickness = smoothness * 0.25 + eps;

				// Blurrier lines as the user increases the smoothness slider
				float blur = pow(smoothness, 3.0) * 0.25 + eps;

				return smoothstep(
					thickness - thickness * blur, 
					thickness + thickness * blur, 
					e
				);
			}
			if (style == 7) 
			{
				return hashwithoutsine13(vec3(p + mb) + seed);
			}
		}
	`,[h,f,p,v,m,g]);return{simplex:t,simplexFractal:r,simplexAshima:a,fbm:c,perlin:u,voronoi:y}}(),lH=class extends ii{constructor(e,t,r,i,n,a,o,s,l,c,d,u,h,f,p,v,m,g,y){super("v3"),this.nodeType="Noise",this.scale=e,this.size=t,this.move=r,this.fA=i,this.fB=n,this.distortion=a,this.colorA=o,this.colorB=s,this.colorC=l,this.colorD=c,this.noiseType=u,this.voronoiStyle=f,this.highCut=p,this.lowCut=v,this.smoothness=m,this.seed=g,this.quality=y,this.isMask=h,this.alpha=d,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t,r,i,n){e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let a=Object.values(tD)[this.noiseType.value],o=a=="voronoi"?`
		float v = ${a}(st + move, voronoiStyle, smoothness, seed, quality);

		// Apply clipping to colors
		v = remap(v, lowCut, highCut, 0.0, 1.0);
		v = smax(v, 0.0, smoothness * 0.25);
		v = smin(v, 1.0, smoothness * 0.25);

		// Note that the voronoi mode only uses colors "A" and "C" from the UI 
		vec4 color = mix(colorA, colorC, v); 
		`:`
		vec3 q = vec3(${a}(st),
					   ${a}(st + vec3(1.0)),
					   ${a}(st + vec3(1.0)));
		vec3 r = vec3(${a}(st + vec3(distortion, 1.0) * q + vec3(fA, 1.0) + move),
					  ${a}(st + vec3(distortion, 1.0) * q + vec3(fB, 1.0) + move), 
					  ${a}(st * q));
		float f = ${a}(st + r);
		vec4 color;
		color = mix(colorA, colorB, clamp((f * f) * 4.0, 0.0, 1.0));
		color = mix(color, colorC, clamp(length(q), 0.0, 1.0));
		color = mix(color, colorD, clamp(length(r.x), 0.0, 1.0));
		`,s=new mt(`vec3 ${a}customNoise(float scale, vec3 size, float move, vec2 fA, vec2 fB, vec2 distortion, vec4 colorA, vec4 colorB, vec4 colorC, vec4 colorD, int voronoiStyle, float highCut, float lowCut, float smoothness, float seed, int quality, bool isMask, float mask, float alpha, out float calpha) 
			{
                // Prevent scale of zero 
				scale = max(abs(scale), 0.001);

				vec3 st = position / size;
				st /= scale;

				${o}

				float lalpha = alpha * color.a * mask;
				calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return clamp(color, 0.0, 1.0).rgb;
			}`,[Ha.simplex,Ha.simplexFractal,Ha.simplexAshima,Ha.fbm,Ha.perlin,Ha.voronoi]),l=e.include(s),c=[];return c.push(this.scale.build(e,"f")),c.push(this.size.build(e,"v3")),c.push(this.move.build(e,"f")),c.push(this.fA.build(e,"v2")),c.push(this.fB.build(e,"v2")),c.push(this.distortion.build(e,"v2")),c.push(this.colorA.build(e,"v4")),c.push(this.colorB.build(e,"v4")),c.push(this.colorC.build(e,"v4")),c.push(this.colorD.build(e,"v4")),c.push(this.voronoiStyle.build(e,"i")),c.push(this.highCut.build(e,"f")),c.push(this.lowCut.build(e,"f")),c.push(this.smoothness.build(e,"f")),c.push(this.seed.build(e,"f")),c.push(this.quality.build(e,"i")),c.push(this.isMask.build(e,"b")),c.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),c.push(this.alpha.build(e,"f")),c.push(this.calpha),e.format(l+"("+c.join(",")+")",this.getType(e),t)}};lH.numOctaves=5;var cH=class extends ii{constructor(e,t,r,i,n,a,o,s,l,c,d,u,h,f,p,v){super("v3"),this.nodeType="Outline",this.firstTime=!0,this.outlineColor=e,this.contourColor=t,this.outlineWidth=r,this.contourWidth=i,this.contourThreshold=n,this.outlineThreshold=a,this.contourFrequency=o,this.outlineSmoothing=s,this.contourDirection=l,this.positionalLines=c,this.compensation=d,this.resolution=u,this.normalMap=h,this.depthMap=f,this.pixelRatio=p,this.alpha=v,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){let r=`g${this.uuid.toString().replace(/-/g,"")}`;if(e.require("vWorldViewDir"),e.require("worldNormal"),e.extensions.derivatives=!0,this.compensation.value&&e.define("OUTLINE_COMPENSATION",`${r}_offset`),this.firstTime){let i=this.outlineWidth.build(e,"f"),n=this.resolution.build(e,"v2"),a=this.compensation.build(e,"b"),o=this.pixelRatio.build(e,"f");e.addVertexParsVariable("randomColor","attribute vec3"),e.addVertexParsVariable("extrudeNormal","attribute vec3"),e.addVertexParsVariable(i,"uniform float"),e.addVertexParsVariable(n,"uniform vec2"),e.addVertexParsVariable(a,"uniform bool"),e.addVertexParsVariable(o,"uniform float"),e.addVertexParsVariable("vID","flat out float"),e.addFragmentParsVariable("vID","flat in float"),e.addVertexFinalCode(`
                vID = randomColor.r;
                vec2 ${r}_offset = vec2(0.0);
                if (${a}) {
                    vec4 ${r}_clipPosition = projectionMatrix * (modelViewMatrix * vec4(transformed, 1.0));
                    // NOTE: For certain shapes, like spheres, we get incorrect extrusion when the
                    // normals face the camera directly. So we hackily fix this by offsetting the normal
                    // by a tiny amount.
                    vec3 ${r}_clipNormal = mat3(projectionMatrix) * (mat3(modelViewMatrix) * extrudeNormal) + 0.0000001;
                    ${r}_offset = normalize(${r}_clipNormal.xy) / ${n} * (${i} / 2.0) * ${r}_clipPosition.w * 2.0 * ${o};
                    ${r}_clipPosition.xy += ${r}_offset;
                    // TODO(MAX): To handle multiple outline layers, we only want to extrude
                    // if this offset is the biggest of all the potential offsets
                    gl_Position = ${r}_clipPosition;
                }
            `)}if(e.isShader("fragment")){e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let i=e.include(cH.Nodes.outline),n=[];return n.push(this.outlineColor.build(e,"c")),n.push(this.contourColor.build(e,"c")),n.push(this.outlineWidth.build(e,"f")),n.push(this.contourWidth.build(e,"f")),n.push(this.contourThreshold.build(e,"f")),n.push(this.outlineThreshold.build(e,"f")),n.push(this.contourFrequency.build(e,"f")),n.push(this.outlineSmoothing.build(e,"f")),n.push(this.contourDirection.build(e,"v3")),n.push(this.positionalLines.build(e,"b")),n.push(this.resolution.build(e,"v2")),n.push(this.normalMap.getTexture(e,"t")),n.push(this.depthMap.getTexture(e,"t")),n.push(this.pixelRatio.build(e,"f")),n.push(this.compensation.build(e,"b")),n.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),n.push(this.alpha.build(e,"f")),n.push(this.calpha),this.firstTime=!this.firstTime,e.format(i+"("+n.join(",")+")",this.getType(e),t)}else return console.warn("OutlineNode is not compatible with "+e.shader+" shader."),""}},dH=cH;dH.Nodes=function(){let e=new mt(`
float sobelSample(sampler2D t, sampler2D d, vec2 uv, vec2 resolution, float outlineWidth, float pixelRatio)
{
    vec2 halton = haltonSequence[frameIndex];
    float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
    float temporalAngle  = temporalOffset * PI2;

    vec2 texelSize = (vec2(1.0) / resolution);
    vec2 offsetSize = texelSize * outlineWidth * pixelRatio;

    vec2 uvSamples[9];
    vec4 normalSamples[9];

	uvSamples[0] = uv + vec2( -offsetSize.x, -offsetSize.y) + (vogelDiskSample(0, 9, temporalAngle) * texelSize);
	uvSamples[1] = uv + vec2(0.0, -offsetSize.y) + (vogelDiskSample(1, 9, temporalAngle) * texelSize);
	uvSamples[2] = uv + vec2(  offsetSize.x, -offsetSize.y) + (vogelDiskSample(2, 9, temporalAngle) * texelSize);
	uvSamples[3] = uv + vec2( -offsetSize.x, 0.0) + (vogelDiskSample(3, 9, temporalAngle) * texelSize);
	uvSamples[4] = uv;
	uvSamples[5] = uv + vec2(  offsetSize.x, 0.0) + (vogelDiskSample(5, 9, temporalAngle) * texelSize);
	uvSamples[6] = uv + vec2( -offsetSize.x, offsetSize.y) + (vogelDiskSample(6, 9, temporalAngle) * texelSize);
	uvSamples[7] = uv + vec2(0.0, offsetSize.y) + (vogelDiskSample(7, 9, temporalAngle) * texelSize);
	uvSamples[8] = uv + vec2(  offsetSize.x, offsetSize.y) + (vogelDiskSample(8, 9, temporalAngle) * texelSize);


    normalSamples[0] = texture2D(t, uvSamples[0]);
    normalSamples[1] = texture2D(t, uvSamples[1]);
    normalSamples[2] = texture2D(t, uvSamples[2]);
    normalSamples[3] = texture2D(t, uvSamples[3]);
    normalSamples[4] = texture2D(t, uvSamples[4]);
    normalSamples[5] = texture2D(t, uvSamples[5]);
    normalSamples[6] = texture2D(t, uvSamples[6]);
    normalSamples[7] = texture2D(t, uvSamples[7]);
    normalSamples[8] = texture2D(t, uvSamples[8]);

    float depthBias = 0.0001;
    // TODO(MAX): Can we somehow reduce the number of conditionals here with MATH?!
    if (normalSamples[0].a != vID && normalSamples[0].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[0]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[1].a != vID && normalSamples[1].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[1]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[2].a != vID && normalSamples[2].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[2]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[3].a != vID && normalSamples[3].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[3]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }


    if (normalSamples[4].a != vID && normalSamples[4].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[4]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[5].a != vID && normalSamples[5].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[5]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[6].a != vID && normalSamples[6].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[6]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[7].a != vID && normalSamples[7].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[7]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[8].a != vID && normalSamples[8].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[8]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    vec3 sobel_edge_h = normalSamples[2].rgb + (2.0*normalSamples[5].rgb) + normalSamples[8].rgb - (normalSamples[0].rgb + (2.0*normalSamples[3].rgb) + normalSamples[6].rgb);
  	vec3 sobel_edge_v = normalSamples[0].rgb + (2.0*normalSamples[1].rgb) + normalSamples[2].rgb - (normalSamples[6].rgb + (2.0*normalSamples[7].rgb) + normalSamples[8].rgb);

    float edgeNormal = sqrt(dot(sobel_edge_h, sobel_edge_h) + dot(sobel_edge_v, sobel_edge_v));
    return edgeNormal;
}
`);return{outline:new mt(`vec3 outline(vec3 outlineColor, vec3 contourColor, float outlineWidth, float contourWidth, float outlineThreshold, float contourThreshold, float outlineSmoothing, float contourFrequency, vec3 contourDirection, bool positionalLines, vec2 resolution, sampler2D normalMap, sampler2D depthMap, float pixelRatio, bool compensation, float mask, float alpha, out float calpha) {
                vec3 result = outlineColor;
                float resultAlpha = 0.0;

                vec3 N = normalize(vWNormal);
                vec2 nuv = (gl_FragCoord.xy / resolution);
                float sobelSample = compensation ? sobelSample(normalMap, depthMap, nuv, resolution, outlineWidth / 2., pixelRatio) : sobelSample(normalMap, depthMap, nuv, resolution, outlineWidth, pixelRatio);
                resultAlpha = smoothstep(outlineThreshold - outlineSmoothing, outlineThreshold + outlineSmoothing, sobelSample);

                //resultAlpha = 1.0;
                //result = vec3(sobelSample);

                float t = 1.0 - contourThreshold;
                if(positionalLines) {
                    vec3 NDir = position * contourDirection;
                    float NT = NDir.x + NDir.y + NDir.z;
                    float f  = fract(NT * contourFrequency * 0.01);
                    float df = fwidth(NT * contourFrequency);

                    float g = smoothstep(df * (contourWidth * 0.01), df * (contourWidth * 0.01 * 2.0), f);
                    if (g < 1.0 && resultAlpha == 0.0) {
                        result = contourColor;
                        resultAlpha = 1.0;
                    }
                 }
                 else {
                    vec3 NDir = N * contourDirection;
                    float NT = NDir.x + NDir.y + NDir.z;
                    float df = fwidth(NT * contourThreshold);
                    float f = sin(NT * 1.0 * contourFrequency);
                    float g = smoothstep(0.0, df * contourWidth, 1.0 - f);

                    if (df > (t * 0.5) && g < 1.0 && resultAlpha == 0.0) {
                        result = contourColor;
                        resultAlpha = 1.0 - g;
                    }
                 }

                 float lalpha = alpha * resultAlpha * mask;
                 calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
                 accumAlpha += ( 1.0 - accumAlpha ) * lalpha;
				 
                 return result;
             }`,[e])}}();var Rl=class extends ii{constructor(e,t,r,i,n,a,o,s,l,c,d,u,h,f,p,v,m,g){super("v3"),this.nodeType="Pattern",this.style=e,this.projection=t,this.axis=r,this.blending=i,this.offset=n,this.colorA=a,this.colorB=o,this.frequency=s,this.size=l,this.variation=c,this.smoothness=d,this.zigzag=u,this.rotation=h,this.vertical=f,this.horizontal=p,this.sides=v,this.isMask=g,this.alpha=m,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.isShader("fragment")){e.require("position"),e.require("uv"),e.requires.uv=[!0],e.require("normal"),e.requires.normal=!0,e.addFragmentVariable(this.calpha,"float");let r;switch(this.style.value){case 0:r="circle";break;case 1:r="ring";break;case 2:r="polygon";break;case 3:r="xcross";break;case 4:r="diamond";break;case 5:r="checkerboard";break;case 6:r="line";break;case 7:r="wave";break;default:r="circle";break}let i=`g${this.uuid.toString().replace(/-/g,"")}`,n=new mt(`float hashwithoutsine12(vec2 p)
				{
					vec3 p3 = fract(vec3(p.xyx) * .1031);
					p3 += dot(p3, p3.yzx + 33.33);
					return fract((p3.x + p3.y) * p3.z);
				}`),a=new mt(`vec2 rotate_uv(in vec2 uv, float a, bool repeat) 
				{
					const float mid = 0.5;
					float radians = a * (PI / 180.0);
					vec2 rotated = vec2(
						cos(radians) * (uv.x - mid) + sin(radians) * (uv.y - mid) + mid,
						cos(radians) * (uv.y - mid) - sin(radians) * (uv.x - mid) + mid
					);
					return repeat ? fract(rotated): rotated;
				}`),o="";if(this.projection.value===4){let d=this.style.value===2?`${r}(uv0, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${r}(uv0, frequency, size, variation, smoothness_remapped, zigzag, rotation)`,u=this.style.value===2?`${r}(uv1, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${r}(uv1, frequency, size, variation, smoothness_remapped, zigzag, rotation)`,h=this.style.value===2?`${r}(uv2, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${r}(uv2, frequency, size, variation, smoothness_remapped, zigzag, rotation)`;o=`
				vec3 p = position;
				float factor = 0.0125;
				vec2 uv0 = fract(p.xy * factor);
				vec2 uv1 = fract(p.zy * factor);
				vec2 uv2 = fract(p.xz * factor);
				
				uv0 = rotate_uv(uv0 + offset, rotation, true);
				uv1 = rotate_uv(uv1 + offset, rotation, true);
				uv2 = rotate_uv(uv2 + offset, rotation, true);
	
				float d0 = ${d};
				float d1 = ${u};
				float d2 = ${h};
				
				// Range from 3 to 128 seems to be good
				float exponent = (1.0 - blending) * 125.0 + 3.0;

				vec3 n = vObjectNormal;
				vec3 weights = abs(normalize(n));
				weights = pow(weights, vec3(exponent));
				weights /= dot(weights, vec3(1.0));
				d0 *= weights.z;
				d1 *= weights.x;
				d2 *= weights.y;
				float draw = d0 + d1 + d2;
	
				vec2 custom_uv = uv0 * weights.z + uv1 * weights.x + uv2 * weights.y;
				`}else{let d=this.style.value===2?`${r}(custom_uv, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${r}(custom_uv, frequency, size, variation, smoothness_remapped, zigzag, rotation)`,u="";this.axis.value===0?u=`float radius = length(p);
					float theta = atan(p.y, p.z);
					float phi = acos(p.x / radius);`:this.axis.value===1?u=`float radius = length(p);
					float theta = atan(p.x, p.z);
					float phi = acos(p.y / radius);`:(this.axis.value,u=`float radius = length(p);
					float theta = atan(p.y, p.x);
					float phi = acos(p.z / radius);`);let h="";switch(this.projection.value){case 0:h="custom_uv = vUv.st;";break;case 1:break;case 2:h=`
							vec3 p = position;
							${u}
							custom_uv = vec2(theta, phi);
							custom_uv /= PI;
							`;break}o=`
				vec2 custom_uv;
				${h}
	
				custom_uv += offset;
				custom_uv = fract(custom_uv);
				custom_uv = rotate_uv(custom_uv, rotation, true);
	
				float draw = ${d};
				`}let s=new mt(`vec3 ${i}_pattern(vec3 normal, float blending, int style, vec2 offset, vec4 colorA, vec4 colorB, vec2 frequency, float size, float variation, float smoothness, float zigzag, float rotation, vec2 vertical, vec2 horizontal, int sides, bool isMask, float mask, float alpha, out float calpha) {
					const float TWO_PI = PI * 2.0;
					float smoothness_remapped = pow(smoothness, 5.0);	

					${o}

					// Construct final output color
					vec4 color = mix(colorA, colorB, draw);
					color.a = clamp(color.a, 0.0, 1.0);

					// Apply cuts
					color.a *= 
						step(vertical.x, custom_uv.y) * 
						step(custom_uv.y, vertical.y);
					color.a *= 
						step(horizontal.x, abs(custom_uv.x)) * 
						step(abs(custom_uv.x), horizontal.y);

					// Accumulate alpha 
					float lalpha = alpha * clamp(color.a, 0.0, 1.0) * mask;
					calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
					accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

					return clamp(color, 0.0, 1.0).rgb;
				}`,[a,n,Rl.DrawFunctions.circle,Rl.DrawFunctions.ring,Rl.DrawFunctions.polygon,Rl.DrawFunctions.cross,Rl.DrawFunctions.diamond,Rl.DrawFunctions.checkerboard,Rl.DrawFunctions.line,Rl.DrawFunctions.wave]),l=e.include(s),c=[];return c.push("normal"),c.push(this.blending.build(e,"f")),c.push(this.style.build(e,"i")),c.push(this.offset.build(e,"v2")),c.push(this.colorA.build(e,"v4")),c.push(this.colorB.build(e,"v4")),c.push(this.frequency.build(e,"v2")),c.push(this.size.build(e,"f")),c.push(this.variation.build(e,"f")),c.push(this.smoothness.build(e,"f")),c.push(this.zigzag.build(e,"f")),c.push(this.rotation.build(e,"f")),c.push(this.vertical.build(e,"v2")),c.push(this.horizontal.build(e,"v2")),c.push(this.sides.build(e,"i")),c.push(this.isMask.build(e,"b")),c.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),c.push(this.alpha.build(e,"f")),c.push(this.calpha),e.format(l+"("+c.join(",")+")",this.getType(e),t)}else return console.warn("PatterNode is not compatible with "+e.shader+" shader."),e.format("vec3(0.0)",this.getType(e),t)}},uH=Rl;uH.DrawFunctions=function(){let e=new mt(`float hashwithoutsine12(vec2 p) {
				vec3 p3 = fract(vec3(p.xyx) * 0.1031);
				p3 += dot(p3, p3.yzx + 33.33);
				return fract((p3.x + p3.y) * p3.z);
			}`),t=new mt(`vec2 tile_and_center(in vec2 uv, in vec2 frequency, in float variation, in float zigzag, in float rotation) {
                // Create tiles in UV-space
                uv *= frequency;

                // Integer coords
                vec2 i = floor(uv);

                // Offset every other row based on zigzag param, then compute fractional coords
                float row_offset = mod(i.y, 2.0);
                uv.x += row_offset * zigzag;
                vec2 f = fract(uv);

				// Rotate the tile itself:
				// const float mid = 0.5;
				// f = vec2(
				// 	cos(rotation) * (f.x - mid) + sin(rotation) * (f.y - mid) + mid,
				// 	cos(rotation) * (f.y - mid) - sin(rotation) * (f.x - mid) + mid
				// );
				// f = fract(f);

                f = f * 2.0 - 1.0;

				// Recompute integer coords after shifting - then, random value per tile 
				i = floor(uv);
				float rand = (hashwithoutsine12(i) * 5.0 + 1.0);
				float jitter = mix(1.0, rand, variation);
				f *= jitter;

                return f;
            }`,[e]),r=new mt(`float circle(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
                return smoothstep(
                    -smoothness, 
                     smoothness, 
                     length(f) - size
                );
            }`,[t]),i=new mt(`float ring(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);

				float d = length(f);
                const float inner_width = 0.5;

                float outer = smoothstep(-smoothness, smoothness, d - size);
                float inner = smoothstep(-smoothness, smoothness, d - size * inner_width);
				return outer + (1.0 - inner);   
            }`,[t]),n=new mt(`float sdf_ngon(in vec2 p, in float r, in int n) {
                float an = (PI * 2.0) / float(n);
                float he = r * tan(0.5 * an);
                
                // Rotate to first sector
                p = -p.yx; 
                float bn = an * floor((atan(p.y, p.x) + 0.5 * an) / an);
                vec2  cs = vec2(cos(bn), sin(bn));
                p = mat2(cs.x, -cs.y, cs.y, cs.x)*p;
            
                // Side of polygon
                return length(p - vec2(r, clamp(p.y, -he, he))) * sign(p.x - r);
            }
            
            float polygon(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation, in int sides) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
                return smoothstep(-smoothness, smoothness, sdf_ngon(f, size, sides));
            }`,[t]),a=new mt(`float sdf_cross(in vec2 p, in vec2 b, float r ) {
                p = abs(p); 
				p = (p.y > p.x) ? p.yx : p.xy;
                vec2  q = p - b;
                float k = max(q.y, q.x);
                vec2  w = (k > 0.0) ? q : vec2(b.y - p.x, -k);
                return sign(k) * length(max(w, 0.0)) + r;
            }
            
            // Avoid namespace conflicts 
            float xcross(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
                return smoothstep(-smoothness, smoothness, sdf_cross(f, vec2(size, size * 0.25), smoothness));
            }`,[t]),o=new mt(`float ndot(vec2 a, vec2 b) { 
                return a.x*b.x - a.y*b.y; 
            }
            
            float sdf_diamond(in vec2 p, in vec2 b) {
                p = abs(p);
                float h = clamp(ndot(b - 2.0 * p, b) / dot(b, b), -1.0, 1.0);
                float d = length(p - 0.5 * b * vec2(1.0 - h, 1.0 + h));
                return d * sign(p.x * b.y + p.y * b.x - b.x * b.y);
            }

            float diamond(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
	            return smoothstep(-smoothness, smoothness, sdf_diamond(f, vec2(size)));
            }`,[t]),s=new mt(`float checkerboard(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                uv *= frequency;
                vec2 i = floor(uv);

                float offset = mod(i.y, 2.0);

                uv.x += offset + zigzag * offset;
                float x = floor(uv.x);
                
                return mod(x, 2.0);
            }`),l=new mt(`float line(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, 0.0, zigzag, rotation);
				
				// Different approach for variation param here
				float row = floor(uv * frequency).y;
				float rand = hashwithoutsine12(vec2(row));
				float s = mix(size, size * rand, variation);

				return smoothstep(
					s - smoothness, 
					s + smoothness, 
					abs(f.y)
				);
            }`,[t]),c=new mt(`// Uses bisection 
            float udf_cos(in vec2 p, in float a, in float b, in float c, in float d) {
                // Convert all data to a primitive cosine wave
                p = c * (p - vec2(d, a));
                
                const float TWO_PI = PI * 2.0;

                // Reduce to principal half cycle
                p.x = mod(p.x, TWO_PI); 
                if (p.x > PI) {
                    p.x = TWO_PI - p.x;
                }
            
                // Find zero of derivative (minimize distance)
                float xa = 0.0;
                float xb = TWO_PI;

                // 24 bit precision
                for (int i = 0; i < 24; i++) {
                    float x = 0.5 * (xa + xb);
                    float y = x - p.x + b * c * sin(x) * (p.y - b * c * cos(x));
                    if (y < 0.0) xa = x; 
                    else xb = x;
                }
                float x = 0.5 * (xa + xb);
                
                // Compute distance    
                vec2 q = vec2(x, b * c * cos(x));
                return length(p - q) / c;
            }

            float wave(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                float repeat = frequency.x;
                uv *= repeat;
                vec2 i = floor(uv);
                float row_offset = mod(i.y, 2.0);
                uv.x += row_offset * zigzag;
                vec2 f = vec2(uv.x, fract(uv.y));

                // Generalized cosine: y(x) = a + b * cos(cx + d)
                const float amplitude = 0.125;
                float wave_frequency = frequency.y * 0.1;
                float distance_estimate = udf_cos(f, 0.50, amplitude, wave_frequency * (2.0 * PI), 0.0);

				// Different approach for variation param here
				float rand = hashwithoutsine12(vec2(i.y));
				float s = mix(size, size * rand, variation);

                return smoothstep(-smoothness, smoothness, distance_estimate - s * 0.5);
            }`);return{tileAndCenter:t,circle:r,ring:i,polygon:n,cross:a,diamond:o,checkerboard:s,line:l,wave:c}}();var hH=class extends ii{constructor(e,t,r,i,n,a,o,s){super("v3"),this.nodeType="Rainbow",this.filmThickness=e,this.movement=t,this.wavelengths=r,this.noiseStrength=i,this.noiseScale=n,this.offset=a,this.isMask=s,this.alpha=o,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.require("vWorldViewDir"),e.require("worldNormal"),e.isShader("fragment")){e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let r=e.include(hH.Nodes.rainbow),i=[];return i.push(this.filmThickness.build(e,"f")),i.push(this.movement.build(e,"f")),i.push(this.wavelengths.build(e,"v3")),i.push(this.noiseStrength.build(e,"f")),i.push(this.noiseScale.build(e,"f")),i.push(this.offset.build(e,"v3")),i.push(this.isMask.build(e,"b")),i.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.calpha),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("RainbowNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},fH=hH;fH.Nodes=function(){let e=new mt(`vec3 attenuation(vec3 wavelengths, float filmThickness, float movement, float noiseStrength, float noiseScale, vec3 offset) {
                 vec3 st = position / noiseScale;
				 vec3 q = vec3(simplex3d(st),
							  simplex3d(st + vec3(1.0)),
							  simplex3d(st + vec3(1.0)));

				 vec3 r = vec3(simplex3d(st + vec3(1.4, 1.3, 1.0) * q + vec3(1.7, 9.2, 1.0)),
							  simplex3d(st + vec3(2.0, 1.2, 1.0) * q + vec3(8.3, 2.8, 1.0)),
							  simplex3d(st * q));

                 float noise = simplex3d(st + r);

                 return .5 + .5 * cos((((filmThickness + (noise * noiseStrength)) / (vec3(wavelengths.r * 1.0, wavelengths.g * 0.8, wavelengths.b * 0.6) + 1.0)) * dot(normalize(vWorldViewDir + (offset * -0.001)), normalize(vWNormal))) + movement);
             }`,[Ha.simplex]);return{rainbow:new mt(`vec3 rainbow(float filmThickness, float movement, vec3 wavelengths, float noiseStrength, float noiseScale, vec3 offset, bool isMask, float mask, float alpha, out float calpha) {
				vec3 res = clamp(attenuation(wavelengths, filmThickness, movement, noiseStrength, noiseScale, offset), 0.0, 2.0);

				float rainbowContribution = clamp(res.r + res.g + res.b, 0.0, 1.0);

				float lalpha = alpha * rainbowContribution * mask;
				calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return res;
             }`,[e])}}();var pH=class extends ii{constructor(e,t,r,i,n,a,o,s,l,c){super("v3"),this.nodeType="Toon",this.positioning=e,this.colors=t,this.steps=r,this.source=i,this.isWorldSpace=n,this.noiseStrength=a,this.noiseScale=o,this.shadowColor=s,this.offset=l,this.alpha=c,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.require("worldNormal"),e.require("worldPosition"),e.isShader("fragment")){e.define("COLORS_MAX",10),e.addFragmentVariable(this.calpha,"float");let r=e.include(pH.Nodes.toon),i=[];return i.push(this.positioning.build(e,"i")),i.push(this.colors.build(e,"v4[]")),i.push(this.steps.build(e,"f[]")),i.push(this.source.build(e,"v3")),i.push(this.isWorldSpace.build(e,"b")),i.push(this.noiseStrength.build(e,"f")),i.push(this.noiseScale.build(e,"f")),i.push(this.shadowColor.build(e,"v4")),i.push(this.offset.build(e,"v3")),i.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.calpha),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("ToonNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},mH=pH;mH.Nodes=function(){let e=new mt(`float rand(float n) {
				return fract(sin(n) * 43758.5453123);
			}`),t=new mt(`float hash1(float p) { 
				p = fract(p * 0.011); 
				p *= p + 7.5; 
				p *= p + p; 
				return fract(p); 
			}`),r=new mt(`float valueNoise(vec3 x) {
				const vec3 step = vec3(110, 241, 171);
			
				vec3 i = floor(x);
				vec3 f = fract(x);
			 
				// For performance, compute the base input to a 1D hash from the integer part of the argument and the 
				// incremental change to the 1D based on the 3D -> 1D wrapping
				float n = dot(i, step);
			
				vec3 u = f * f * (3.0 - 2.0 * f);
				return mix(mix(mix( hash1(n + dot(step, vec3(0, 0, 0))), hash1(n + dot(step, vec3(1, 0, 0))), u.x),
							   mix( hash1(n + dot(step, vec3(0, 1, 0))), hash1(n + dot(step, vec3(1, 1, 0))), u.x), u.y),
						   mix(mix( hash1(n + dot(step, vec3(0, 0, 1))), hash1(n + dot(step, vec3(1, 0, 1))), u.x),
							   mix( hash1(n + dot(step, vec3(0, 1, 1))), hash1(n + dot(step, vec3(1, 1, 1))), u.x), u.y), u.z);
			}`,[t]),i=new mt(`vec3 hash3(vec3 x) {
				x = vec3(dot(x,vec3(127.1, 311.7, 74.7)),
						 dot(x,vec3(269.5, 183.3, 246.1)),
						 dot(x,vec3(113.5, 271.9, 124.6)));
			
				return fract(sin(x)*43758.5453123);
			}`),n=new mt(`vec3 voronoiNoise(in vec3 x)
			{
				vec3 p = floor(x);
				vec3 f = fract(x);

				float id = 0.0;
				vec2 res = vec2(100.0);

				for(int k=-1; k<=1; k++)
				for(int j=-1; j<=1; j++)
				for(int i=-1; i<=1; i++)
				{
					vec3 b = vec3(float(i), float(j), float(k));

					// Comment out the "+ hash(p + b);" part below to get "square" cells
					vec3 r = vec3(b) - f + hash3(p + b);
					float d = dot(r, r);

					if (d < res.x)
					{
						id = dot(p + b, vec3(1.0, 57.0, 113.0));
						res = vec2(d, res.x);			
					}
					else if (d < res.y)
					{
						res.y = d;
					}
				}

				return vec3(sqrt(res), abs(id));
			}
			`,[i]);return{toon:new mt(`vec3 toon(int positioning, vec4 colors[COLORS_MAX], float steps[COLORS_MAX], vec3 source, bool isWorldSpace, float noiseStrength, float noiseScale, vec4 shadowColor, vec3 offset, float mask, float alpha, out float calpha) {
				float t = 0.0;
				float shadow = 1.0;

				if (positioning == 0) {

					// Can't do this mode if lighting is "none"
					#if (defined(PHONG) || defined(LAMBERT) || defined(STANDARD))

						// Algorithm from Chapter 10 of Graphics Shaders
						const vec3 weights = vec3(0.2125, 0.7154, 0.0721);
						vec3 lpos;
						vec3 l;
						float dproduct;

						#if (NUM_POINT_LIGHTS > 0)

							#if defined(USE_SHADOWMAP) && (NUM_POINT_LIGHT_SHADOWS > 0)
								PointLightShadow pointLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_POINT_LIGHTS; i++) {
								// Light positions are in view-space for some reason?
								lpos = (inverse(viewMatrix) * vec4(pointLights[UNROLLED_LOOP_INDEX].position, 1.0)).xyz;
								l = normalize(lpos - worldPosition);
								
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								
								// TODO: we want to use "intensity" but it isn't available in the shader code
								//dproduct += dot(pointLights[UNROLLED_LOOP_INDEX].color, weights);

								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS)
									pointLightShadow = pointLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getPointShadow( 
											pointShadowMap[UNROLLED_LOOP_INDEX], 
											pointLightShadow.shadowMapSize, 
											pointLightShadow.shadowBias, 
											pointLightShadow.shadowRadius,
											vPointShadowCoord[UNROLLED_LOOP_INDEX], 
											pointLightShadow.shadowCameraNear, 
											pointLightShadow.shadowCameraFar);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						#if NUM_DIR_LIGHTS > 0 
							
							#if defined(USE_SHADOWMAP) && (NUM_DIR_LIGHT_SHADOWS > 0)
								DirectionalLightShadow directionalLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_DIR_LIGHTS; i++) {
								// Use the direction vector for directional lights instead
								l = (inverse(viewMatrix) * vec4(directionalLights[UNROLLED_LOOP_INDEX].direction, 0.0)).xyz;
		
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS)
									directionalLightShadow = directionalLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getShadow( 
										UNROLLED_LOOP_INDEX,
										directionalShadowMap[UNROLLED_LOOP_INDEX], 
										directionalLightShadow.shadowMapSize, 
										directionalLightShadow.shadowBias, 
										directionalLightShadow.shadowRadius, 
										vDirectionalShadowCoord[UNROLLED_LOOP_INDEX]);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						#if NUM_SPOT_LIGHTS > 0 
							
							#if defined(USE_SHADOWMAP) && (NUM_SPOT_LIGHT_SHADOWS > 0)
								SpotLightShadow spotLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_SPOT_LIGHTS; i++) {
								lpos = (inverse(viewMatrix) * vec4(spotLights[UNROLLED_LOOP_INDEX].position, 1.0)).xyz;
								l = normalize(lpos - worldPosition);
								
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS)
									spotLightShadow = spotLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getShadow(
										UNROLLED_LOOP_INDEX,
										spotShadowMap[UNROLLED_LOOP_INDEX], 
										spotLightShadow.shadowMapSize, 
										spotLightShadow.shadowBias, 
										spotLightShadow.shadowRadius, 
										vSpotLightCoord[UNROLLED_LOOP_INDEX]);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						t = clamp(t, 0.0, 1.0);
				
					#endif

				} else if (positioning == 1) {
					
					vec3 origin = mix(position, worldPosition, float(isWorldSpace));
					vec3 direction = normalize(source - origin);
					t = dot(direction, normalize(worldNormal)) * 0.5 + 0.5;	

				} else {

					vec3 origin = worldPosition;
					vec3 source = cameraPosition - offset;
					vec3 direction = normalize(source - origin);
					t = dot(direction, normalize(worldNormal)) * 0.5 + 0.5;	
					
				}

				if (noiseStrength > 0.0) {
					// Distort with noise
					vec3 st = position / noiseScale;
					
					// Voronoi "smooth" noise
					float noise = 1.0 - voronoiNoise(st).x;

					// Voronoi cellular noise
					//float noise = 1.0 - rand(voronoiNoise(st).z);

					// Position warp noise
					// vec3 offset = vec3(
					// 	simplex3d(st),
					// 	simplex3d(st + vec3(111.1, 143.89, 217.19)),
					// 	simplex3d(st + vec3(171.1, 247.89, 117.23))
					// );
					// st += offset;
					// float noise = valueNoise(st);

					t += noise * noiseStrength;
				}

				t = clamp(t, 0.0, 1.0);

				// Compute ramp color
				float p;
				vec4 color = colors[0];
				for (int i = 1; i < COLORS_MAX; i++) {
					p = clamp((t - steps[i-1]) / (steps[i] - steps[i-1]), 0.0, 1.0);
					color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
				}

				// Incorporate custom shadow color
				if (positioning == 0) {

					vec3 blendedShadow = mix(color.rgb, shadowColor.rgb, shadowColor.a);
					color.rgb = mix(blendedShadow, color.rgb, shadow);
				
				}

				// Accumulate alpha as usual
				float lalpha = alpha * color.a * mask;
				calpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);
				accumAlpha += (1.0 - accumAlpha) * lalpha;

				return color.xyz;

            }`,[Ha.simplex,e,r,n])}}();var KOe=function(){return{textureBicubic:new mt(`float w0( float a ) {
            return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
        }
    
        float w1( float a ) {
            return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
        }
    
        float w2( float a ){
            return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
        }
    
        float w3( float a ) {
            return ( 1.0 / 6.0 ) * ( a * a * a );
        }
    
        // g0 and g1 are the two amplitude functions
        float g0( float a ) {
            return w0( a ) + w1( a );
        }
    
        float g1( float a ) {
            return w2( a ) + w3( a );
        }
    
        // h0 and h1 are the two offset functions
        float h0( float a ) {
            return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
        }
    
        float h1( float a ) {
            return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
        }
    
        vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
            uv = uv * texelSize.zw + 0.5;
    
            vec2 iuv = floor( uv );
            vec2 fuv = fract( uv );
    
            float g0x = g0( fuv.x );
            float g1x = g1( fuv.x );
            float h0x = h0( fuv.x );
            float h1x = h1( fuv.x );
            float h0y = h0( fuv.y );
            float h1y = h1( fuv.y );
    
            vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
            vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
            vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
            vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
    
            return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) + 
                   g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
        }

        vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
            vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
            vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
            vec2 fLodSizeInv = 1.0 / fLodSize;
            vec2 cLodSizeInv = 1.0 / cLodSize;
            vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
            vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
            return mix( fSample, cSample, fract( lod ) );
        }`)}}();function QOe(e,t){return e>=t?new ye(t/e,1):new ye(1,e/t)}var vH=class extends ii{constructor(e,t,r,i,n,a,o,s){super("v3"),this.nodeType="Transmission",this.thickness=e,this.ior=t,this.roughness=r,this.transmissionSamplerSize=i,this.transmissionSamplerMap=n,this.transmissionDepthMap=a,this.aspectRatio=o,this.alpha=s,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.extensions.shaderTextureLOD=!0,e.extensions.derivatives=!0,e.isShader("fragment")){e.define("NUM_SAMPLES",6),e.define("BLUR_SLOD",Math.pow(2,jt.transmissionLod.value)),e.require("worldPosition"),e.requires.worldNormal=!0,e.requires.modelMatrix=!0,e.requires.projectionMatrix=!0,e.addFragmentVariable(this.calpha,"float");let r=e.include(vH.Nodes.transmission),i=[];return i.push(this.thickness.build(e,"f")),i.push(this.ior.build(e,"f")),i.push(this.roughness.build(e,"f")),i.push(this.transmissionSamplerSize.build(e,"v2")),i.push(this.transmissionSamplerMap.getTexture(e,"t")),i.push(this.transmissionDepthMap.getTexture(e,"t")),i.push(this.aspectRatio.build(e,"v2")),i.push("normal"),i.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.calpha),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("TransmissionNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},gH=vH;gH.Nodes=function(){let e=new mt(`vec3 blur(sampler2D sp, vec2 U, vec2 scale, float lod, sampler2D dm, vec2 unrefractedU, vec2 aspectRatio) {
                // Slightly modified version of this:
                // https://www.shadertoy.com/view/ltScRG

				// Special case for blur == 0.0
				if (lod == 0.0) {
					#ifdef TEXTURE_LOD_EXT
					return texture2DLodEXT( sp, U, 0.0).rgb;
					#else
					return textureLod( sp, U, 0.0).rgb;
					#endif
				}
				
				vec2 texelSize = vec2(1.0) / resolution;
                vec2 halton = haltonSequence[frameIndex];
                float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
                float temporalAngle  = temporalOffset * PI2;
				vec3 res = vec3(0.0);
                vec2 uv = vec2(0.0);
                vec2 offset = vec2(0.0);
                vec2 vogelSample = vec2(0.0);
                for (int i = 0; i < NUM_SAMPLES; i++) {
                    vogelSample =  vogelDiskSample(i, NUM_SAMPLES, temporalAngle) * texelSize;
                    offset = vogelSample * scale * (lod * 10.0); // TODO: used to be hardcoded to 20
                    uv = U + offset;
                    float opaqueDepth = unpackRGBAToDepth(textureLod(dm, uv, lod));
                    if (opaqueDepth != 0.0 && opaqueDepth < gl_FragCoord.z) {
                        uv = unrefractedU;
                        lod = lod > 4.0 ? lod : lod / 2.0;
                    }
                    res += textureLod(sp, uv, lod).rgb;
                }
                return res / float(NUM_SAMPLES);
            }`),t=new mt(`vec3 getVolumeTransmissionRay( vec3 n, vec3 v, float thickness, float ior, mat4 modelMatrix ) {
		        // Direction of refracted light.
		        vec3 refractionVector = refract( -v,  n, 1.0 / ior );
		        
				// Compute rotation-independant scaling of the model matrix.
		        vec3 modelScale;
		        modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		        modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		        modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );

		        // The thickness is specified in local space
		        return normalize( refractionVector ) * thickness * modelScale;
	        }`),r=new mt(`float applyIorToRoughness( float roughness, float ior ) {
				// Scale roughness with IOR so that an IOR of 1.0 results in no microfacet refraction and
				// an IOR of 1.5 results in the default amount of microfacet refraction.
				return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
			}`),i=new mt(`vec3 getTransmissionSample( vec2 fragCoord, float roughness, float ior, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 unrefractedCoords, vec2 aspectRatio) {
				// Threejs exports do not pass a depth map to this shader, so we have to fallback to the "Threejs method of blurring" - see
				// also the code in convertTransmission.ts, which runs during export
				#ifdef IS_THREEJS_EXPORT
					float lod = log2(transmissionSamplerSize.x) * applyIorToRoughness(roughness / 5.0, ior);
					return textureBicubic(transmissionSamplerMap, fragCoord.xy, lod).rgb;
				#else
					float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
					float lod = applyIorToRoughness(roughness, ior);
					return blur(transmissionSamplerMap, fragCoord, vec2(lod), min(framebufferLod / 5.5, 8.5), transmissionDepthMap, unrefractedCoords, aspectRatio);
				#endif
			}`,[KOe.textureBicubic,r,e]),n=new mt(`vec3 getIBLVolumeRefraction( vec3 n, vec3 v, float roughness, vec3 position, mat4 modelMatrix, mat4 viewMatrix, mat4 projMatrix, float ior, float thickness, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 aspectRatio ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;

				// Project refracted vector on the framebuffer, while mapping to normalized device coordinates.
				vec4 ndcPos = projMatrix * viewMatrix *  vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;

				vec4 ndcPosUnrefracted = projMatrix * viewMatrix * vec4(position, 1.0 );
				vec2 unrefractedCoords = ndcPosUnrefracted.xy / ndcPosUnrefracted.w;
				unrefractedCoords += 1.0;
				unrefractedCoords /= 2.0;

				// Sample framebuffer to get pixel the refracted ray hits.
				return getTransmissionSample( refractionCoords, roughness, ior, transmissionSamplerSize, transmissionSamplerMap, transmissionDepthMap, unrefractedCoords, aspectRatio );
    		}`,[i,t]);return{transmission:new mt(`vec3 transmission(float thickness, float ior, float roughness, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 aspectRatio, vec3 normal, float mask, float alpha, out float calpha) {
                vec3 v = vec3(0.);
                if (isOrthographic) {
                    v = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
                } else {
                    v = normalize(vWPosition - cameraPosition);
                }
                vec3 transmission = getIBLVolumeRefraction(vWNormal, -v, roughness,  vWPosition, modelMatrix, viewMatrix, projectionMatrix, ior, thickness, transmissionSamplerSize, transmissionSamplerMap, transmissionDepthMap, aspectRatio );
                
				float lalpha = alpha * mask;
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += ( 1.0 - accumAlpha ) * alpha;

				return transmission;
            }`,[n])}}();var XM=(e=>(e.NOISE="noise",e.MAP="map",e))(XM||{}),yH=class extends ii{constructor(e,t,r,i,n,a,o,s,l,c,d){super("v3"),this.displacementTypeIndex=new oi(0),this.nodeType="VertexDisplacement",this.intensity=e,this.movementOrTexture=t,Object.values(XM)[this.displacementTypeIndex.value]==="map"&&(this.mat=new J8(this.movementOrTexture.value.matrix)),this.cropOrOffset=r,this.scale=c,this.noiseFunctionIndex=d,this.voronoiStyle=i,this.smoothness=n,this.seed=a,this.highCut=o,this.lowCut=s,this.quality=l}generate(e,t){if(e.isShader("vertex")){e.define("USE_LAYER_DISPLACE");let r,i=[];switch(i.push("displaced_position"),i.push("displaced_normal"),Object.values(XM)[this.displacementTypeIndex.value]){case"map":{r=e.include(yH.Nodes.map),i.push(this.movementOrTexture.getTexture(e,"t")),i.push("uv"),i.push(this.cropOrOffset.build(e,"f")),this.mat&&i.push(this.mat.build(e,"mat3"));break}case"noise":{let n=Object.values(tD)[this.noiseFunctionIndex.value],a=new mt(`vec3 orthogonal(vec3 v) {
							return normalize(abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0) : vec3(0.0, -v.z, v.y));
						}`),o=n=="voronoi"?`
					float v = ${n}((p + offset) * scale * 0.001 + neighbour_offset + (movement * 0.1), voronoiStyle, smoothness, seed, quality);
					v = remap(v, lowCut, highCut, 0.0, 1.0);
					v = smax(v, 0.0, smoothness * 0.25);
					v = smin(v, 1.0, smoothness * 0.25);

					return p + n * v * intensity;
					`:`
					return p + n * ${n}((p + offset) * scale * 0.001 + neighbour_offset + (movement * 0.1)) * intensity;
					`,s=new mt(`vec3 distorted(vec3 p, vec3 n, float scale, float intensity, vec3 offset, float neighbour_offset, float movement, int voronoiStyle, float smoothness, float seed, float highCut, float lowCut, int quality) {
							${o}
						}`,[Ha.simplex,Ha.simplexFractal,Ha.simplexAshima,Ha.fbm,Ha.perlin,Ha.voronoi]),l=new mt(`vec3 vertexDisplacementNoise(vec3 position, vec3 normal, float scale, vec3 offset, float movement, int voronoiStyle, float smoothness, float seed, float highCut, float lowCut, int quality, float intensity, out vec3 displaced_normal) {
							vec3 displaced_position = distorted(position, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);
							vec3 tangent1 = orthogonal(normal);
							vec3 tangent2 = normalize(cross(normal, tangent1));

                            // TODO(Max): The distance to the neighbors was originally scaled by 0.1.
                            // This caused some small oval/circular visual artifacts in the lighting.
                            // For now, simply using neighbors further away betters the problem,
                            // but we should figure out the underlying cause when we have some time.
                            // Maybe its related to how we calculate the tangent and bitangent?
							vec3 nearby1 = position + tangent1;
							vec3 nearby2 = position + tangent2;
							vec3 distorted1 = distorted(nearby1, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);
							vec3 distorted2 = distorted(nearby2, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);
							displaced_normal = normalize(cross(distorted1 - displaced_position, distorted2 - displaced_position));
							return displaced_position;
						}`,[s,a]);r=e.include(l),i.push(this.scale.build(e,"f")),i.push(this.cropOrOffset.build(e,"v3")),i.push(this.movementOrTexture.build(e,"f")),i.push(this.voronoiStyle.build(e,"i")),i.push(this.smoothness.build(e,"f")),i.push(this.seed.build(e,"f")),i.push(this.highCut.build(e,"f")),i.push(this.lowCut.build(e,"f")),i.push(this.quality.build(e,"i"));break}}return i.push(this.intensity.build(e,"f")),i.push("displaced_normal"),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("VertexDisplacementNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},bH=yH;bH.Nodes=function(){let e=new mt(`vec3 orthogonal(vec3 v) {
				return normalize(abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0) : vec3(0.0, -v.z, v.y));
			}`),t=new mt(`float displacementMapTexture(sampler2D tex, float crop, vec2 uv, mat3 mat, vec2 offset) {
				vec2 uvs = (mat * vec3(uv * 2.0 - 1.0, 1.0) / 2.0 + 0.5).xy + offset;
				vec4 tmp = texture2D(tex, uvs);
				vec3 col = tmp.rgb;
				if (crop > 0.5) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						return 0.0;
					}
				}
				return col.r;
			}`);return{map:new mt(`vec3 vertexDisplacementMap(vec3 position, vec3 normal, sampler2D tex, vec2 uv, float crop, mat3 mat, float intensity, out vec3 displaced_normal) {
				vec3 displaced_position = position + normal * displacementMapTexture(tex, crop, uv, mat, vec2(0.0)) * intensity;
				vec3 tangent1 = normalize(orthogonal(normal));
				vec3 tangent2 = normalize(cross(normal, tangent1));
				vec3 nearby1 = position + tangent1 * 0.1;
				vec3 nearby2 = position + tangent2 * 0.1;
				vec3 distorted1 = nearby1 + normal * displacementMapTexture(tex, crop, uv, mat, vec2(neighbor_offset)) * intensity;
				vec3 distorted2 = nearby2 + normal * displacementMapTexture(tex, crop, uv, mat, vec2(neighbor_offset)) * intensity;
				displaced_normal = normalize(cross(distorted1 - displaced_position, distorted2 - displaced_position));
				return displaced_position;
			}`,[e,t])}}();var jt={normalRenderTarget:new Vl,normalRenderTargetDepth:new Vl,transmissionRenderTarget:new Vl,aspectRatio:new Xn,transmissionSize:new Xn(2048,2048),transmissionRenderTargetDepth:new Vl,aoRenderTarget:new Vl,aoEnabled:new Ea,pixelRatioNode:new Ct(1),resolution:new Xn,penumbraSize:new su(5,.5),frameIndex:new oi(0),transmissionLod:new oi(2)};for(let e of Object.values(jt))e.isRenderGlobal=!0;var xH={skiaWasmUrl:"https://unpkg.com/@splinetool/ui-wasm@1.9.21/build/ui.wasm"},rD=class extends mn{constructor(){super("basic"),this.nodeType="Basic",this.color=new Fi(co),this.shadingAlpha=new Ct(1),this.shadingBlend=new oi(0),this.previousModelViewMatrix=new ll,this.previouseProjectionMatrix=new ll}get category(){return"phong"}generate(e){let t;if(e.isShader("vertex")){let r=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:jt.frameIndex}),e.mergeUniform({resolution:jt.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(Vp.merge([ht.fog])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <normal_pars_vertex>"].join(`
`));let i=["#include <beginnormal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#if defined( USE_LAYER_DISPLACE )
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <begin_vertex>
				#endif /* !USE_LAYER_DISPLACE */
				`];r&&i.push(r.code,r.result?"displaced_position = "+r.result+";":""),i.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","	vNormal = transformedNormal;","#endif"),i.push("#include <project_vertex>","#include <fog_vertex>","#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=i.join(`
`)}else{this.color===void 0&&(this.color=new Fi(co)),this.color.analyze(e,{slot:"color"}),this.alpha&&this.alpha.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"});let r=this.color.flow(e,"c",{slot:"color"}),i=this.alpha?this.alpha.flow(e,"f"):void 0,n=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0,a=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0;e.requires.transparent=i!==void 0,e.addParsCode(["varying vec3 vWPosition;","#include <fog_pars_fragment>","#include <dithering_pars_fragment>","varying vec3 vViewPosition;","#include <normal_pars_fragment>"].join(`
`));let o=["#include <normal_fragment_begin>",r.code];i&&o.push(i.code,"#ifdef ALPHATEST"," if ( "+i.result+" <= ALPHATEST ) discard;","#endif"),a?o.push(a.code,`vec3 outgoingLight = ${r.result};`,`vec3 finalColor = spe_blend(outgoingLight, ${a.result}, 1.0, SPE_BLENDING_NORMAL);`):o.push(`vec3 finalColor = ${r.result};`);let s="1.0";this.mask&&(this.mask.analyze(e),s=`luminance(${this.mask.flow(e,"v3").result})`),i?o.push(`gl_FragColor = vec4( finalColor, accumAlpha * ${i.result} * ${s} );`):o.push("gl_FragColor = vec4("+r.result+", 1.0 );"),n&&o.push(`gl_FragColor.a *= ${n.result};`),o.push("#include <fog_fragment>","#include <dithering_fragment>"),t=o.join(`
`)}return t}},ZOe=class extends mn{constructor(){super("lambert"),this.nodeType="Lambert",this.color=new Fi(co),this.emissive=new Fi(0),this.emissiveIntensity=new Ct(1),this.previousModelViewMatrix=new ll,this.previouseProjectionMatrix=new ll,this.shadingAlpha=new Ct(1),this.shadingBlend=new oi(0),this.occlusion=new Ea(!0)}get category(){return"lambert"}build(e){let t;if(e.define("LAMBERT"),e.requires.lights=!0,e.extensions.derivatives=!0,e.isShader("vertex")){let r=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:jt.frameIndex}),e.mergeUniform({resolution:jt.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(Vp.merge([ht.fog,ht.lights])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","varying vec3 vLightFront;","varying vec3 vIndirectFront;","#ifndef DOUBLE_SIDED","   #define DOUBLE_SIDED","#endif","#ifdef DOUBLE_SIDED","	varying vec3 vLightBack;","	varying vec3 vIndirectBack;","#endif","#include <bsdfs>","#include <lights_pars_begin>","#include <color_pars_vertex>","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let i=["#include <beginnormal_vertex>",`
				#include <skinbase_vertex>
				#include <skinnormal_vertex>
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = objectNormal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];r&&i.push(r.code,r.result?"displaced_position = "+r.result+";":""),i.push("transformed = displaced_position;","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),i.push("	#include <project_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>",`
					vec3 diffuse = vec3( 1.0 );
					GeometricContext geometry;
					geometry.position = mvPosition.xyz;
					geometry.normal = normalize( transformedNormal );
					geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
				`),i.push(`
					GeometricContext backGeometry;
					backGeometry.position = geometry.position;
					backGeometry.normal = -geometry.normal;
					backGeometry.viewDir = geometry.viewDir;
					vLightFront = vec3( 0.0 );
					vIndirectFront = vec3( 0.0 );
					#ifdef DOUBLE_SIDED
						vLightBack = vec3( 0.0 );
						vIndirectBack = vec3( 0.0 );
					#endif
					IncidentLight directLight;
					float dotNL;
					vec3 directLightColor_Diffuse;
					vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
					vIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );
					#ifdef DOUBLE_SIDED
						vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
						vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );
					#endif
					#if NUM_POINT_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
							getPointLightInfo( pointLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_SPOT_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
							getSpotLightInfo( spotLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_DIR_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
							getDirectionalLightInfo( directionalLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_HEMI_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
							vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
							#ifdef DOUBLE_SIDED
								vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );
							#endif
						}
						#pragma unroll_loop_end
					#endif
				`,"	#include <shadowmap_vertex>","	#include <fog_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=i.join(`
`)}else{e.mergeUniform({penumbraSize:jt.penumbraSize}),e.mergeUniform({frameIndex:jt.frameIndex}),e.mergeUniform({aoMap:jt.aoRenderTarget}),e.mergeUniform({aoEnabled:jt.aoEnabled}),this.color===void 0&&(this.color=new Fi(co)),this.color.analyze(e,{slot:"color"}),this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e);let r=this.color.flow(e,"c",{slot:"color"}),i=this.emissive.flow(e,"c",{slot:"emissive"}),n=this.emissiveIntensity.flow(e,"f",{slot:"emissive"}),a=this.occlusion.flow(e,"b",{slot:"occlusion"}),o=this.shadingAlpha.flow(e,"f"),s=this.shadingBlend.flow(e,"i"),l=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,c=this.alpha?this.alpha.flow(e,"f"):void 0,d=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0;e.requires.transparent=c!==void 0,e.addParsCode(["uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","varying vec3 vViewPosition;","varying vec3 vWPosition;","varying vec3 vLightFront;","varying vec3 vIndirectFront;","#ifndef DOUBLE_SIDED","   #define DOUBLE_SIDED","#endif","#include <normal_pars_fragment>","#ifdef DOUBLE_SIDED","	varying vec3 vLightBack;","	varying vec3 vIndirectBack;","#endif","#include <bsdfs>","#include <lights_pars_begin>","#include <fog_pars_fragment>","#include <shadowmap_pars_fragment>","#include <shadowmask_pars_fragment>","#include <clipping_planes_pars_fragment>","#include <dithering_pars_fragment>"].join(`
`));let u=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx, viewdy));
				bool isFrontFacing = (dot(normal, faceNormal) >= 0.0);
				`,"#include <clipping_planes_fragment>"];u.push(r.code,"vec3 diffuseColor = "+r.result+";","ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );"),c&&u.push(c.code,"#ifdef ALPHATEST","if ( "+c.result+" <= ALPHATEST ) discard;","#endif"),u.push("#ifdef DOUBLE_SIDED","	reflectedLight.indirectDiffuse += ( isFrontFacing ) ? vIndirectFront : vIndirectBack;","#else","	reflectedLight.indirectDiffuse += vIndirectFront;","#endif","#include <lightmap_fragment>","reflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );","#ifdef DOUBLE_SIDED","	reflectedLight.directDiffuse = ( isFrontFacing ) ? vLightFront : vLightBack;","#else","	reflectedLight.directDiffuse = vLightFront;","#endif","reflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();"),i&&u.push(i.code,"reflectedLight.directDiffuse += "+i.result+" * "+n.result+";"),u.push("vec3 ao = aoEnabled && "+a.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = (reflectedLight.directDiffuse + reflectedLight.indirectDiffuse) ;");let h="1.0";this.mask&&(this.mask.analyze(e),h=`luminance(${this.mask.flow(e,"v3").result})`),u.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${o.result} * ${h} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${o.result} * ${h}, ${s.result} );

					outgoingLight *= ao;
				}
				`),l&&u.push(l.code,`outgoingLight = spe_blend(outgoingLight, ${l.result}, 1.0, SPE_BLENDING_NORMAL);`),c?u.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${c.result} );`):u.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),d&&u.push(`gl_FragColor.a *= ${d.result};`),u.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=u.join(`
`)}return t}},Pp=function(){let e=new mt(`vec2 dHdxy(sampler2D bumpMap, vec2 bumpMapUv, float bumpScale) {

            // Gradient of UVs w.r.t. X coordinate (in screen-space)
            vec2 dSTdx = dFdx(bumpMapUv);

            // Gradient of UVs w.r.t. Y coordinate (in screen-space)
            vec2 dSTdy = dFdy(bumpMapUv);
            
            // Forward differencing
            float Hll = bumpScale * luminance(texture(bumpMap, bumpMapUv).rgb);
            float dBx = bumpScale * luminance(texture(bumpMap, bumpMapUv + dSTdx).rgb) - Hll;
            float dBy = bumpScale * luminance(texture(bumpMap, bumpMapUv + dSTdy).rgb) - Hll;
            
            return vec2( dBx, dBy );
        }`),t=new mt(`vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
            vec3 vSigmaX = dFdx( surf_pos.xyz );
            vec3 vSigmaY = dFdy( surf_pos.xyz );
            vec3 vN = surf_norm; // normalized
            
            vN = normalize(vN);

            vec3 R1 = cross( vSigmaY, vN );
            vec3 R2 = cross( vN, vSigmaX );

            R1 = normalize(R1);
            R2 = normalize(R2);
    
            float fDet = dot( vSigmaX, R1 ) * faceDirection;
    
            vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
            return normalize( abs( fDet ) * vN - vGrad );
        }`);return{dHdxy:e,perturbNormalArb:t}}(),JOe=class extends mn{constructor(){super("phong"),this.nodeType="Phong",this.color=new Fi(co),this.specular=new Fi(1118481),this.shininess=new Ct(30),this.previousModelViewMatrix=new ll,this.previouseProjectionMatrix=new ll,this.shadingAlpha=new Ct(1),this.shadingBlend=new oi(0),this.occlusion=new Ea(!0)}get category(){return"phong"}build(e){let t;if(e.define("PHONG"),e.requires.lights=!0,e.extensions.derivatives=!0,e.isShader("vertex")){let r=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:jt.frameIndex}),e.mergeUniform({resolution:jt.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(Vp.merge([ht.fog,ht.lights])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let i=["#include <beginnormal_vertex>",`
				#include <skinbase_vertex>
				#include <skinnormal_vertex>
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = objectNormal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];r&&i.push(r.code,r.result?"displaced_position = "+r.result+";":""),i.push("transformed = displaced_position;","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),i.push("	#include <project_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>","	#include <shadowmap_vertex>","	#include <fog_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=i.join(`
`)}else{e.mergeUniform({penumbraSize:jt.penumbraSize}),e.mergeUniform({frameIndex:jt.frameIndex}),e.mergeUniform({aoMap:jt.aoRenderTarget}),e.mergeUniform({aoEnabled:jt.aoEnabled}),this.color===void 0&&(this.color=new Fi(co)),this.color.analyze(e,{slot:"color"}),this.specular.analyze(e),this.shininess.analyze(e);let r=this.occlusion.flow(e,"b",{slot:"occlusion"});this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e);let i=this.color.flow(e,"c",{slot:"color"}),n=this.specular.flow(e,"c"),a=this.shininess.flow(e,"f"),o=this.shadingAlpha.flow(e,"f"),s=this.shadingBlend.flow(e,"i"),l=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,c=this.alpha?this.alpha.flow(e,"f"):void 0,d=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0;e.requires.transparent=c!==void 0,e.addParsCode(["varying vec3 vWPosition;","uniform vec3 emissive;","uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","#include <normal_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_phong_pars_fragment>","#include <shadowmap_pars_fragment>","#include <dithering_pars_fragment>"].join(`
`));let u=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	BlinnPhongMaterial material;"];if(this.bumpMap){e.include(Pp.dHdxy),e.include(Pp.perturbNormalArb);let f=this.bumpMap.texture.flow(e,"t"),p=this.bumpMap.flow(e,"v3"),v=this.bumpMapIntensity?this.bumpMapIntensity.flow(e,"f").result:"1.0",m="";this.bumpMap.projection.value===4?m=`
					vec3 bumpNormal = vec3(0.0);
					{
						vec2 uv0 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						vec2 grad0 = dHdxy(${f.result}, uv0, ${v});
						vec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);

						vec2 grad1 = dHdxy(${f.result}, uv1, ${v});
						vec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);

						vec2 grad2 = dHdxy(${f.result}, uv2, ${v});
						vec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);
						
						bumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;
						bumpNormal = normalize(bumpNormal);
					}

					normal = bumpNormal;
					`:m=`
					vec2 bumpMapCachedUv = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs;
					vec2 grad = dHdxy(${f.result}, bumpMapCachedUv, ${v});
					normal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );
					`,u.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${p.result};
					${m}
					`)}u.push(i.code,"	vec3 diffuseColor = "+i.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );","	vec3 totalEmissiveRadiance = emissive;",n.code,"	vec3 specular = "+n.result+";",a.code,"	float shininess = max( 0.0001, "+a.result+" );","	float specularStrength = 1.0;"),c&&u.push(c.code,"#ifdef ALPHATEST","if ( "+c.result+" <= ALPHATEST ) discard;","#endif"),u.push("material.diffuseColor = diffuseColor;"),u.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),u.push("vec3 ao = aoEnabled && "+r.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse)) + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;");let h="1.0";this.mask&&(this.mask.analyze(e),h=`luminance(${this.mask.flow(e,"v3").result})`),u.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${o.result} * ${h} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${o.result} * ${h}, ${s.result} );
					
					outgoingLight *= ao;
				}
				`),l&&u.push(l.code,`outgoingLight = spe_blend(outgoingLight, ${l.result}, 1.0, SPE_BLENDING_NORMAL);`),c?u.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${c.result});`):u.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),d&&u.push(`gl_FragColor.a *= ${d.result};`),u.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=u.join(`
`)}return t}},eRe=class extends mn{constructor(){super("standard"),this.nodeType="Standard",this.color=new Fi(co),this.roughness=new Ct(.3),this.metalness=new Ct(0),this.reflectivity=new Ct(.5),this.previousModelViewMatrix=new ll,this.previouseProjectionMatrix=new ll,this.shadingAlpha=new Ct(1),this.shadingBlend=new oi(0),this.occlusion=new Ea(!0)}get category(){return"physical"}build(e){let t;if(e.define("STANDARD"),e.requires.lights=!0,e.extensions.derivatives=!0,e.extensions.shaderTextureLOD=!0,e.isShader("vertex")){let r=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:jt.frameIndex}),e.mergeUniform({resolution:jt.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(Vp.merge([ht.fog,ht.lights])),ht.LTC_1&&(e.uniforms.ltc_1={value:void 0},e.uniforms.ltc_2={value:void 0}),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let i=["#include <beginnormal_vertex>",`
				#include <skinbase_vertex>
				#include <skinnormal_vertex>
				#if !defined( USE_LAYER_DISPLACE )
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = objectNormal;

				#if defined( USE_LAYER_DISPLACE )
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <begin_vertex>
				#endif /* !USE_LAYER_DISPLACE */
				`];r&&i.push(r.code,r.result?"displaced_position = "+r.result+";":""),i.push("transformed = displaced_position;","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),i.push("#include <project_vertex>","#include <fog_vertex>","#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>","#include <shadowmap_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=i.join(`
`)}else{e.mergeUniform({penumbraSize:jt.penumbraSize}),e.mergeUniform({frameIndex:jt.frameIndex}),e.mergeUniform({aoMap:jt.aoRenderTarget}),e.mergeUniform({aoEnabled:jt.aoEnabled});let r={gamma:!0};this.color===void 0&&(this.color=new Fi(co)),this.color.analyze(e,{slot:"color",context:r}),this.roughness.analyze(e),this.metalness.analyze(e);let i=this.occlusion.flow(e,"b",{slot:"occlusion"});this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e),this.reflectivity&&this.reflectivity.analyze(e);let n=this.color.flow(e,"c",{slot:"color",context:r}),a=this.roughness.flow(e,"f"),o=this.metalness.flow(e,"f"),s=this.shadingAlpha.flow(e,"f"),l=this.shadingBlend.flow(e,"i"),c=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,d=this.alpha?this.alpha.flow(e,"f"):void 0,u=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0,h=this.reflectivity?this.reflectivity.flow(e,"f"):void 0;e.requires.transparent=d!==void 0,e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","#include <normal_pars_fragment>","#include <dithering_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_physical_pars_fragment>","#include <shadowmap_pars_fragment>"].join(`
`));let f=["#include <clipping_planes_fragment>","	#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	PhysicalMaterial material;","	material.diffuseColor = vec3( 1.0 );"];if(this.bumpMap){e.include(Pp.dHdxy),e.include(Pp.perturbNormalArb);let v=this.bumpMap.texture.flow(e,"t"),m=this.bumpMap.flow(e,"v3"),g=this.bumpMapIntensity?this.bumpMapIntensity.flow(e,"f").result:"1.0",y="";this.bumpMap.projection.value===4?y=`
					vec3 bumpNormal = vec3(0.0);
					{
						vec2 uv0 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						vec2 grad0 = dHdxy(${v.result}, uv0, ${g});
						vec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);

						vec2 grad1 = dHdxy(${v.result}, uv1, ${g});
						vec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);

						vec2 grad2 = dHdxy(${v.result}, uv2, ${g});
						vec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);
						
						bumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;
						bumpNormal = normalize(bumpNormal);
					}

					normal = bumpNormal;
					`:y=`
					vec2 bumpMapCachedUv = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs;
					vec2 grad = dHdxy(${v.result}, bumpMapCachedUv, ${g});
					normal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );
					`,f.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${m.result};
					${y}
					`)}if(f.push(n.code,"	vec3 diffuseColor = "+n.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );",o.code,"	float metalnessFactor = "+o.result+";"),this.roughnessMap){let v=this.roughnessMap.texture.flow(e,"t"),m=this.roughnessMap.flow(e,"v3"),g="";this.roughnessMap.projection.value===4?g=`
					float roughnessChange = 1.0;
					{
						vec2 uv0 = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						float r0 = luminance(texture(${v.result}, uv0).rgb) * roughnessScale;
						float r1 = luminance(texture(${v.result}, uv1).rgb) * roughnessScale;
						float r2 = luminance(texture(${v.result}, uv2).rgb) * roughnessScale;

						roughnessChange = (r0 * weights.z + r1 * weights.x + r2 * weights.y);
					}
					float roughnessFactor = roughnessChange * ${a.result};
					`:g=`
					vec2 roughnessMapCachedUv = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs;

					vec4 vals = texture(${v.result},  roughnessMapCachedUv);
					float roughnessFactor = luminance(vals.rgb) * ${a.result};
					`,f.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${m.result};

					const float roughnessScale = 1.0;

					${g}
				`)}else f.push(a.code,"	float roughnessFactor = "+a.result+";");d&&f.push(d.code,"#ifdef ALPHATEST","	if ( "+d.result+" <= ALPHATEST ) discard;","#endif"),f.push("vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );"),f.push("material.diffuseColor = diffuseColor * ( 1.0 - metalnessFactor );","material.roughness = max( roughnessFactor, 0.0525 );","material.roughness += geometryRoughness;","material.roughness = min( material.roughness, 1.0 );","material.roughness = clamp( roughnessFactor, 0.04, 1.0 );"),h?f.push(h.code,"material.specularColor = mix( vec3( 0.16 * pow2( "+h.result+" ) ), diffuseColor, metalnessFactor );"):f.push("material.specularColor = mix( vec3( 0.04 ), diffuseColor, metalnessFactor );"),f.push("#include <lights_fragment_begin>"),f.push("#include <lights_fragment_end>"),f.push("vec3 ao = aoEnabled && "+i.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse)) + reflectedLight.directSpecular + reflectedLight.indirectSpecular;");let p="1.0";this.mask&&(this.mask.analyze(e),p=`luminance(${this.mask.flow(e,"v3").result})`),f.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${s.result} * ${p} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${s.result} * ${p}, ${l.result} );
					
					outgoingLight *= ao;
				}
				`),c&&f.push(c.code,`outgoingLight = spe_blend(outgoingLight, ${c.result}, 1.0, SPE_BLENDING_NORMAL);`),d?f.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${d.result} );`):f.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),u&&f.push(`gl_FragColor.a *= ${u.result};`),f.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=f.join(`
`)}return t}},tRe=class extends mn{constructor(){super("toon"),this.nodeType="Toon",this.color=new Fi(co),this.specular=new Fi(1118481),this.shininess=new Ct(30),this.previousModelViewMatrix=new ll,this.previouseProjectionMatrix=new ll,this.shadingAlpha=new Ct(1),this.shadingBlend=new oi(0)}get category(){return"toon"}build(e){let t;if(e.define("TOON"),e.requires.lights=!0,e.extensions.derivatives=!0,e.isShader("vertex")){let r=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:jt.frameIndex}),e.mergeUniform({resolution:jt.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(Vp.merge([ht.fog,ht.lights])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let i=["#include <beginnormal_vertex>",`
				#include <skinbase_vertex>
				#include <skinnormal_vertex>
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = objectNormal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];r&&i.push(r.code,r.result?"displaced_position = "+r.result+";":""),i.push("transformed = displaced_position;","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),i.push("	#include <project_vertex>","	#include <fog_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>","	#include <shadowmap_vertex>","	#include <fog_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=i.join(`
`)}else{e.mergeUniform({penumbraSize:jt.penumbraSize}),e.mergeUniform({frameIndex:jt.frameIndex}),e.mergeUniform({aoMap:jt.aoRenderTarget}),e.mergeUniform({aoEnabled:jt.aoEnabled}),this.color===void 0&&(this.color=new Fi(co)),this.color.analyze(e,{slot:"color"}),this.specular.analyze(e),this.shininess.analyze(e),this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e);let r=this.color.flow(e,"c",{slot:"color"}),i=this.specular.flow(e,"c"),n=this.shininess.flow(e,"f"),a=this.shadingAlpha.flow(e,"f"),o=this.shadingBlend.flow(e,"i"),s=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,l=this.alpha?this.alpha.flow(e,"f"):void 0,c=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0;e.requires.transparent=l!==void 0,e.addParsCode(["uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","varying vec3 vWPosition;","#include <normal_pars_fragment>","#include <gradientmap_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <dithering_pars_fragment>",`
					varying vec3 vViewPosition;
					struct ToonMaterial {
						vec3	diffuseColor;
						vec3	specularColor;
						float	specularShininess;
						float	specularStrength;
					};
					void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
						vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
			
						reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
						reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
					}
					void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
						reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
					}
					#define RE_Direct				RE_Direct_Toon
					#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
					#define Material_LightProbeLOD( material )	(0)
					`,"#include <shadowmap_pars_fragment>","#include <bumpmap_pars_fragment>","#include <normalmap_pars_fragment>"].join(`
`));let d=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	ToonMaterial material;"];if(this.bumpMap){e.include(Pp.dHdxy),e.include(Pp.perturbNormalArb);let h=this.bumpMap.texture.flow(e,"t"),f=this.bumpMap.flow(e,"v3"),p=this.bumpMapIntensity?this.bumpMapIntensity.flow(e,"f").result:"1.0",v="";this.bumpMap.projection.value===4?v=`
					vec3 bumpNormal = vec3(0.0);
					{
						vec2 uv0 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						vec2 grad0 = dHdxy(${h.result}, uv0, ${p});
						vec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);

						vec2 grad1 = dHdxy(${h.result}, uv1, ${p});
						vec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);

						vec2 grad2 = dHdxy(${h.result}, uv2, ${p});
						vec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);
						
						bumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;
						bumpNormal = normalize(bumpNormal);
					}

					normal = bumpNormal;
					`:v=`
					vec2 bumpMapCachedUv = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs;
					vec2 grad = dHdxy(${h.result}, bumpMapCachedUv, ${p});
					normal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );
					`,d.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${f.result};
					${v}
					`)}d.push(r.code,"	vec3 diffuseColor = "+r.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );",i.code,"	vec3 specular = "+i.result+";",n.code,"	float shininess = max( 0.0001, "+n.result+" );","	float specularStrength = 1.0;"),l&&d.push(l.code,"#ifdef ALPHATEST","if ( "+l.result+" <= ALPHATEST ) discard;","#endif"),d.push("material.diffuseColor = diffuseColor;"),d.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),d.push("vec3 ao = aoEnabled ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse) * ao) + reflectedLight.directSpecular;");let u="1.0";this.mask&&(this.mask.analyze(e),u=`luminance(${this.mask.flow(e,"v3").result})`),d.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${a.result} * ${u} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${a.result} * ${u}, ${o.result} );
				}
				`),s&&d.push(s.code,`outgoingLight = spe_blend(outgoingLight, ${s.result}, 1.0, SPE_BLENDING_NORMAL);`),l?d.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${l.result} );`):d.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),c&&d.push(`gl_FragColor.a *= ${c.result};`),d.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=d.join(`
`)}return t}},rRe=class{constructor(e=1e3*10){this.timeout=e,this.cache=new Map,this.head={data:null,time:0,src:null,next:null,prev:null},this.tail={data:null,time:1/0,src:null,next:null,prev:null},this.hasClean=!1,this.head.next=this.tail,this.tail.prev=this.head}log(...e){}remove(e){let t=this.cache.get(e);t&&(this.dispose(e,t.data),this.cache.delete(e),t.prev.next=t.next,t.next.prev=t.prev)}scheduleCleanup(){this.hasClean||(this.log("scheduled cleanup"),this.hasClean=!0,setTimeout(()=>{this.hasClean=!1,this.log("cleaning");let e=Date.now(),t=this.head.next;for(;t.time<e-this.timeout;)this.dispose(t.src,t.data),this.cache.delete(t.src),t=t.next,t.prev=this.head,this.head.next=t;this.head.next!==this.tail?this.scheduleCleanup():this.log("no more cleanup")},this.timeout+1e3))}has(e){var t;return(t=this.cache.get(e))==null?void 0:t.data}load(e){let t=Date.now(),r=this.cache.get(e);return r===void 0?(r={data:this.create(e),src:e,time:t,next:null,prev:null},this.cache.set(e,r)):(r.time=t,r.prev.next=r.next,r.next.prev=r.prev),r.prev=this.tail.prev,r.next=this.tail,this.tail.prev.next=r,this.tail.prev=r,this.scheduleCleanup(),r.data}},iRe=class extends rRe{create(e){return URL.createObjectURL(new Blob([e]))}dispose(e,t){URL.revokeObjectURL(t)}},VC;function nRe(e){return typeof e=="string"?e:(VC||(VC=new iRe),VC.load(e))}var aRe=class{constructor(e,t){this.data=e,this.cache=t,this.refCount=0}deref(){this.refCount,this.refCount-=1,this.refCount===0&&(this.cache.remove(this),this.dispose())}dispose(){this.refCount}},oRe=class{constructor(){this.cache=new Map}remove(e){this.cache.delete(e.data)}load(e){let t=this.cache.get(e);return t===void 0&&(t=this.create(e),this.cache.set(e,t)),t.refCount+=1,t}},wH=class extends aRe{constructor(e,t){super(e,t.imageHolderCache),this.data=e,this.shared=t,this.loaded=!1,this.isVideo=!1,this.isBuffer=!1,this._cache={1e3:{},1001:{},1002:{}},this.isVideo=e.type==="video",this.isBuffer=e.isWebGLRenderTarget===!0,this.loadPromise=this.updateSrc(this.isBuffer?e:e.data)}async updateSrc(e){if(typeof document>"u")return;this.disposeTextures(),this.loaded=!1;let t=()=>{this.loaded=!0;for(let i of Object.values(this._cache))for(let n of Object.values(i))for(let a of Object.values(n))a&&(a.image=this.img,a.needsUpdate=!0);this.shared.requestRender()};if(this.isBuffer)this.img=e,this.loaded=!0;else if(this.isVideo){if(this.img=document.createElement("video"),this.img.preload="auto",this.img.playsInline=!0,this.img.currentTime=.01,typeof e!="string"){var r=new FileReader;r.readAsDataURL(new Blob([e],{type:"video/mp4"}));let i;await new Promise(n=>{r.onloadend=a=>{var o;i=(o=a.target)==null?void 0:o.result,n(null)}}),this.img.src=i}else this.img.src=e;this.img.onloadeddata=()=>{t()}}else this.img=new Image,this.img.src=nRe(e),this.img.onload=t}getTexture(e,t=1008,r=1006){var n,a;let i=(a=(n=this._cache[e])==null?void 0:n[t])==null?void 0:a[r];if(i)return i;{let o;return this.isBuffer?o=this.img.texture:this.isVideo?o=new Hxe(this.img,void 0,e,e):o=new Oi(this.img,void 0,e,e,r,t),this.loaded&&(o.needsUpdate=!0),this._cache[e]===void 0&&(this._cache[e]={}),this._cache[e][t]===void 0&&(this._cache[e][t]={}),this._cache[e][t][r]=o,o}}setNeedsUpdate(e){for(let t of Object.values(this._cache))for(let r of Object.values(t))for(let i of Object.values(r))i&&(i.needsUpdate=e)}disposeTextures(){for(let[e,t]of Object.entries(this._cache))for(let[r,i]of Object.entries(t))for(let[n,a]of Object.entries(i))a==null||a.dispose(),this._cache[e]!==void 0&&this._cache[e][r]!==void 0&&(this._cache[e][r][n]=void 0)}dispose(){super.dispose(),this.disposeTextures()}},Zc=class extends wH{};function sRe(e,t){var r=uRe(t);return r.formatToParts?cRe(r,e):dRe(r,e)}var lRe={year:0,month:1,day:2,hour:3,minute:4,second:5};function cRe(e,t){try{for(var r=e.formatToParts(t),i=[],n=0;n<r.length;n++){var a=lRe[r[n].type];a>=0&&(i[a]=parseInt(r[n].value,10))}return i}catch(o){if(o instanceof RangeError)return[NaN];throw o}}function dRe(e,t){var r=e.format(t).replace(/\u200E/g,""),i=/(\d+)\/(\d+)\/(\d+),? (\d+):(\d+):(\d+)/.exec(r);return[i[3],i[1],i[2],i[4],i[5],i[6]]}var HC={};function uRe(e){if(!HC[e]){var t=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:"America/New_York",year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(new Date("2014-06-25T04:00:00.123Z")),r=t==="06/25/2014, 00:00:00"||t==="‎06‎/‎25‎/‎2014‎ ‎00‎:‎00‎:‎00";HC[e]=r?new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:e,year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):new Intl.DateTimeFormat("en-US",{hourCycle:"h23",timeZone:e,year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}return HC[e]}function SH(e,t,r,i,n,a,o){var s=new Date(0);return s.setUTCFullYear(e,t,r),s.setUTCHours(i,n,a,o),s}var JL=36e5,hRe=6e4,WC={timezone:/([Z+-].*)$/,timezoneZ:/^(Z)$/,timezoneHH:/^([+-]\d{2})$/,timezoneHHMM:/^([+-]\d{2}):?(\d{2})$/};function CH(e,t,r){var i,n;if(!e||(i=WC.timezoneZ.exec(e),i))return 0;var a;if(i=WC.timezoneHH.exec(e),i)return a=parseInt(i[1],10),eB(a)?-(a*JL):NaN;if(i=WC.timezoneHHMM.exec(e),i){a=parseInt(i[1],10);var o=parseInt(i[2],10);return eB(a,o)?(n=Math.abs(a)*JL+o*hRe,a>0?-n:n):NaN}if(mRe(e)){t=new Date(t||Date.now());var s=r?t:fRe(t),l=KM(s,e),c=r?l:pRe(t,l,e);return-c}return NaN}function fRe(e){return SH(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}function KM(e,t){var r=sRe(e,t),i=SH(r[0],r[1]-1,r[2],r[3]%24,r[4],r[5],0).getTime(),n=e.getTime(),a=n%1e3;return n-=a>=0?a:1e3+a,i-n}function pRe(e,t,r){var i=e.getTime(),n=i-t,a=KM(new Date(n),r);if(t===a)return t;n-=a-t;var o=KM(new Date(n),r);return a===o?a:Math.max(a,o)}function eB(e,t){return-23<=e&&e<=23&&(t==null||0<=t&&t<=59)}var tB={};function mRe(e){if(tB[e])return!0;try{return new Intl.DateTimeFormat(void 0,{timeZone:e}),tB[e]=!0,!0}catch{return!1}}var vRe=fc(Dme(),1),rB=fc(Ome(),1),gRe=/(Z|[+-]\d{2}(?::?\d{2})?| UTC| [a-zA-Z]+\/[a-zA-Z_]+(?:\/[a-zA-Z_]+)?)$/,yRe=gRe,GC=36e5,iB=6e4,bRe=2,Ta={dateTimePattern:/^([0-9W+-]+)(T| )(.*)/,datePattern:/^([0-9W+-]+)(.*)/,plainTime:/:/,YY:/^(\d{2})$/,YYY:[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],YYYY:/^(\d{4})/,YYYYY:[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],MM:/^-(\d{2})$/,DDD:/^-?(\d{3})$/,MMDD:/^-?(\d{2})-?(\d{2})$/,Www:/^-?W(\d{2})$/,WwwD:/^-?W(\d{2})-?(\d{1})$/,HH:/^(\d{2}([.,]\d*)?)$/,HHMM:/^(\d{2}):?(\d{2}([.,]\d*)?)$/,HHMMSS:/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,timeZone:yRe};function xRe(e,t){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");if(e===null)return new Date(NaN);var r={},i=r.additionalDigits==null?bRe:(0,vRe.default)(r.additionalDigits);if(i!==2&&i!==1&&i!==0)throw new RangeError("additionalDigits must be 0, 1 or 2");if(e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]")return new Date(e.getTime());if(typeof e=="number"||Object.prototype.toString.call(e)==="[object Number]")return new Date(e);if(!(typeof e=="string"||Object.prototype.toString.call(e)==="[object String]"))return new Date(NaN);var n=wRe(e),a=SRe(n.date,i),o=a.year,s=a.restDateString,l=CRe(s,o);if(isNaN(l))return new Date(NaN);if(l){var c=l.getTime(),d=0,u;if(n.time&&(d=_Re(n.time),isNaN(d)))return new Date(NaN);if(n.timeZone||r.timeZone){if(u=CH(n.timeZone||r.timeZone,new Date(c+d)),isNaN(u))return new Date(NaN)}else u=(0,rB.default)(new Date(c+d)),u=(0,rB.default)(new Date(c+d+u));return new Date(c+d+u)}else return new Date(NaN)}function wRe(e){var t={},r=Ta.dateTimePattern.exec(e),i;if(r?(t.date=r[1],i=r[3]):(r=Ta.datePattern.exec(e),r?(t.date=r[1],i=r[2]):(t.date=null,i=e)),i){var n=Ta.timeZone.exec(i);n?(t.time=i.replace(n[1],""),t.timeZone=n[1].trim()):t.time=i}return t}function SRe(e,t){var r=Ta.YYY[t],i=Ta.YYYYY[t],n;if(n=Ta.YYYY.exec(e)||i.exec(e),n){var a=n[1];return{year:parseInt(a,10),restDateString:e.slice(a.length)}}if(n=Ta.YY.exec(e)||r.exec(e),n){var o=n[1];return{year:parseInt(o,10)*100,restDateString:e.slice(o.length)}}return{year:null}}function CRe(e,t){if(t===null)return null;var r,i,n,a;if(e.length===0)return i=new Date(0),i.setUTCFullYear(t),i;if(r=Ta.MM.exec(e),r)return i=new Date(0),n=parseInt(r[1],10)-1,aB(t,n)?(i.setUTCFullYear(t,n),i):new Date(NaN);if(r=Ta.DDD.exec(e),r){i=new Date(0);var o=parseInt(r[1],10);return ERe(t,o)?(i.setUTCFullYear(t,0,o),i):new Date(NaN)}if(r=Ta.MMDD.exec(e),r){i=new Date(0),n=parseInt(r[1],10)-1;var s=parseInt(r[2],10);return aB(t,n,s)?(i.setUTCFullYear(t,n,s),i):new Date(NaN)}if(r=Ta.Www.exec(e),r)return a=parseInt(r[1],10)-1,oB(t,a)?nB(t,a):new Date(NaN);if(r=Ta.WwwD.exec(e),r){a=parseInt(r[1],10)-1;var l=parseInt(r[2],10)-1;return oB(t,a,l)?nB(t,a,l):new Date(NaN)}return null}function _Re(e){var t,r,i;if(t=Ta.HH.exec(e),t)return r=parseFloat(t[1].replace(",",".")),$C(r)?r%24*GC:NaN;if(t=Ta.HHMM.exec(e),t)return r=parseInt(t[1],10),i=parseFloat(t[2].replace(",",".")),$C(r,i)?r%24*GC+i*iB:NaN;if(t=Ta.HHMMSS.exec(e),t){r=parseInt(t[1],10),i=parseInt(t[2],10);var n=parseFloat(t[3].replace(",","."));return $C(r,i,n)?r%24*GC+i*iB+n*1e3:NaN}return null}function nB(e,t,r){t=t||0,r=r||0;var i=new Date(0);i.setUTCFullYear(e,0,4);var n=i.getUTCDay()||7,a=t*7+r+1-n;return i.setUTCDate(i.getUTCDate()+a),i}var ARe=[31,28,31,30,31,30,31,31,30,31,30,31],MRe=[31,29,31,30,31,30,31,31,30,31,30,31];function _H(e){return e%400===0||e%4===0&&e%100!==0}function aB(e,t,r){if(t<0||t>11)return!1;if(r!=null){if(r<1)return!1;var i=_H(e);if(i&&r>MRe[t]||!i&&r>ARe[t])return!1}return!0}function ERe(e,t){if(t<1)return!1;var r=_H(e);return!(r&&t>366||!r&&t>365)}function oB(e,t,r){return!(t<0||t>52||r!=null&&(r<0||r>6))}function $C(e,t,r){return!(e!=null&&(e<0||e>=25)||t!=null&&(t<0||t>=60)||r!=null&&(r<0||r>=60))}function TRe(e,t,r){var i=xRe(e,r),n=CH(t,i,!0),a=new Date(i.getTime()-n),o=new Date(0);return o.setFullYear(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate()),o.setHours(a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds(),a.getUTCMilliseconds()),o}function Pa(e,t){return t.color(e)}function sB(e=new Date,t){let r=t.format,i=e.getSeconds(),n=e;t&&t.timeZone!==null&&(n=TRe(new Date,t.timeZone));let a=n.getHours(),o=n.getMinutes(),s;t.format12h24h==="12ampm"&&(s=a>=12?"PM":"AM");let l=a;t.format12h24h!=="24"&&(l=a%12,l===0&&(l=12));let c,d;switch(r){case"HH:mm:ss":c=[l,o,i];break;case"HH:mm":c=[l,o];break;case"HH":c=[l],s=void 0;break;case"mm":c=[o],s=void 0;break;case"ss":c=[i],s=void 0;break;case"year":d=n.getFullYear();break;case"month":d=n.getMonth()+1;break;case"dayOfYear":d=Math.floor((n.getTime()-new Date(n.getFullYear(),0,0).getTime())/864e5);break;case"dayOfMonth":d=n.getDate();break;case"secondOfDay":d=a*60*60+o*60+i;break;default:console.error("Unknown time format",r),d=0;break}return c!==void 0?{textValue:c,suffix:s}:d}function PRe(e,t){switch(e.type){case"fresnel":return RRe(e,t);case"gradient":return IRe(e,t);case"depth":return zRe(e,t);case"normal":return kRe(e,t);case"noise":return LRe(e,t);case"rainbow":return BRe(e,t);case"toon":return FRe(e,t);case"outline":return NRe(e,t);case"transmission":return URe(e,t);case"color":return ORe(e,t);case"pattern":return jRe(e,t)}}function DRe(e){return{type:e.type}}function bs(e,t){let{alpha:r,mode:i,isMask:n}=e,a=typeof r=="string"?(Number(t.getVariable(r))??100)/100:r;return{...DRe(e),alpha:a,mode:i,isMask:n}}function ORe(e,t){return{...bs(e,t),color:Pa(e.color,t)}}function RRe(e,t){let{bias:r,scale:i,intensity:n,factor:a,color:o}=e;return{...bs(e,t),color:Pa(o,t),bias:r,scale:i,intensity:n,factor:a}}function IRe(e,t){let{gradientType:r,smooth:i,colors:n,steps:a,angle:o,offset:s,morph:l}=e;return{...bs(e,t),gradientType:r,smooth:i,colors:n.map(c=>new Kt(c[0],c[1],c[2],c[3])),num:n.length,steps:a,offset:new ye(...s),morph:new ye(...l),angle:o}}function zRe(e,t){let{gradientType:r,near:i,far:n,isVector:a,isWorldSpace:o,origin:s,direction:l,colors:c,steps:d,smooth:u}=e;return{...bs(e,t),gradientType:r,near:i,far:n,isVector:a,isWorldSpace:o,origin:new k(...s),direction:l?new k(...l):new k(1,0,0),colors:c.map(h=>h!==void 0?new Kt(h[0],h[1],h[2],h[3]):new Kt(0,0,0,0)),steps:d.slice(0,c.length),smooth:u}}function kRe(e,t){let{cnormal:r}=e;return{...bs(e,t),cnormal:new k(r[0],r[1],r[2])}}function LRe(e,t){return{...bs(e,t),scale:e.scale,move:e.move,fA:new ye(...e.fA),fB:new ye(...e.fB),size:new k(...e.size),distortion:new ye(...e.distortion),colorA:Pa(e.colorA,t),colorB:Pa(e.colorB,t),colorC:Pa(e.colorC,t),colorD:Pa(e.colorD,t),noiseType:e.noiseType,voronoiStyle:e.voronoiStyle,highCut:e.highCut,lowCut:e.lowCut,smoothness:e.smoothness,seed:e.seed,quality:e.quality}}function BRe(e,t){return{...bs(e,t),filmThickness:e.filmThickness,movement:e.movement,wavelengths:new k(...e.wavelengths),noiseStrength:e.noiseStrength,noiseScale:e.noiseScale,offset:new k(...e.offset)}}function FRe(e,t){return{...bs(e,t),positioning:e.positioning,colors:e.colors.map(r=>new Kt(r[0],r[1],r[2],r[3])),num:e.colors.length,steps:e.steps,source:new k(...e.source),isWorldSpace:e.isWorldSpace,noiseStrength:e.noiseStrength,noiseScale:e.noiseScale,shadowColor:Pa(e.shadowColor,t),offset:new k(...e.offset)}}function NRe(e,t){return{...bs(e,t),outlineColor:Pa(e.outlineColor,t),contourColor:Pa(e.contourColor,t),outlineWidth:e.outlineWidth,contourWidth:e.contourWidth,outlineThreshold:e.outlineThreshold,contourThreshold:e.contourThreshold,outlineSmoothing:e.outlineSmoothing,contourFrequency:e.contourFrequency,contourDirection:new k(...e.contourDirection),positionalLines:e.positionalLines,compensation:e.compensation}}function URe(e,t){return{...bs(e,t),thickness:e.thickness,ior:e.ior,roughness:e.roughness}}function jRe(e,t){return{...bs(e,t),style:e.style,projection:e.projection,axis:e.axis,blending:e.blending,offset:new ye(...e.offset),colorA:Pa(e.colorA,t),colorB:Pa(e.colorB,t),frequency:new ye(...e.frequency),size:e.size,variation:e.variation,smoothness:e.smoothness,zigzag:e.zigzag,rotation:e.rotation,vertical:new ye(...e.vertical),horizontal:new ye(...e.horizontal),sides:e.sides}}var Jx=class extends ia{},VRe={noise:["noiseType"],texture:["projection","axis","side"],video:["projection","axis","side"],displace:["noiseType"],light:["roughnessMap","bumpMap"],depth:["smooth","isWorldSpace","gradientType","isVector"],pattern:["style","projection","axis"]},HRe={depth:["colors"]};function WRe(e,t,r){var a,o;if(t==="isMask")return!0;let i=VRe[e.type],n=HRe[e.type];if(n!==void 0){let s=e.color;if(n.includes(t)){let l=(o=(a=s[t])==null?void 0:a.value)==null?void 0:o.length;if(l!==void 0&&l!==r.length)return!0}}return i!==void 0?i.includes(t):!1}function AH(e,t,r){let i=r.uniforms[`f${r.id}_texture`];if(!i)return!1;let n=!1,a=e;if("image"in a){let o=a.image,s=t.image(o),l=i;l.image instanceof Zc||l.image.deref(),l.image=s}if("video"in a){let o=a.video,s=t.video(o),l=i;l.image instanceof Zc||l.image.deref(),l.image=s}if("wrapping"in a){let o=i;o.wrap=a.wrapping}if("minFilter"in a){let o=i;o.minFilter=a.minFilter}if("magFilter"in a){let o=i;o.magFilter=a.magFilter}if("rotation"in a&&r.uniforms[`f${r.id}_rotation`])return r.uniforms[`f${r.id}_rotation`].value=(a.rotation??0)*St.DEG2RAD,n;if("repeat"in a||"offset"in a||"rotation"in a){let o="mat",s=r.uniforms[`f${r.id}_${o}`];"repeat"in a&&(s.repeat=a.repeat),"offset"in a&&(s.offset=a.offset),"rotation"in a&&(s.rotation=a.rotation??0),s.updateMatrix()}return n}function GRe(e,t,r,i){let n=!1;for(let[a,o]of Object.entries(e)){if(a==="bumpMap"||a==="roughnessMap"){n=!0;continue}if(!a||o===void 0)continue;if(EH(a,r,i,t)){a==="visible"&&r.type==="light"&&(n=!0);continue}r.visible=i.visible;let s=r.uniforms[`f${r.id}_${a}`];if(s&&!(s instanceof JP))switch(n=n||WRe(r,a,o),s.constructor){case Fi:if(typeof o=="string"){let l=t.getColor(o);l&&(s.value=l);break}else{let l=o;s.value instanceof Jx?s.value=new ia(l.r,l.g,l.b,l.a):s.setRGBA(l);break}case Ll:if(typeof o=="string"){let l=t.getColor(o);l&&(s.value=l);break}else{let l=o;s.value instanceof Jx?s.value=new ia(l.r,l.g,l.b,l.a):s.value.setRGBA(l.r,l.g,l.b,l.a);break}case Xn:{let l=o;s.value.setX(l[0]),s.value.setY(l[1]);break}case xo:{let l=o;s.value.setX(l[0]),s.value.setY(l[1]),s.value.setZ(l[2]);break}case Vl:{AH(o,t,r);break}case lu:{s.value=o.map(l=>new Kt(...l));break}default:{s.value=o;break}}}return n}var oh=(e,t,r)=>Math.max(0,Math.min(1,Number(t.getVariable(typeof e=="number"?e*100:e,r)??100)/100))??1,Jg=class{constructor(e,t,r,i,n){this.id=e,this.uuid=t,this.data=r,this.uniforms={};for(let a in i)this.uniforms[`f${this.id}_${a}`]=i[a];for(let a in r)EH(a,this,r,n)}get type(){return this.data.type}static create(e,t,r,i){if(r.type==="light")return Ls.createLigherLayer(e,t,r,i);if(r.type==="texture"||r.type==="video"){let n=r.type==="texture"?i.uiBuffer(r.texture.image)??i.image(r.texture.image):i.video(r.texture.video),a=new qM(n,r.texture.wrapping,r.texture.minFilter??1008,r.texture.magFilter??1006),o=new qOe(n),s=new YOe(r.texture.repeat,r.texture.offset,r.texture.rotation??0),l=new Ct(r.crop?1:0),c=new oi(r.projection??0),d=new oi(["x","y","z"].indexOf(r.axis)??0),u=new oi(r.side??0),h=new Xn(r.size?new ye(r.size[0],r.size[1]):new ye(100,100)),f=new Ct(r.blending??0),p=new Ct(oh(r.alpha,i)),v=new oi(r.mode??0),m=new Ea(r.isMask??!1),g=new eD(a,o,l,c,d,u,h,f,s,p,v,m),y=new pi(g.calpha,"f");return new zi(e,t,r,{texture:a,textureSize:o,crop:l,projection:c,axis:d,side:u,size:h,blending:f,mat:s,alpha:p,mode:v,isMask:m},g,v,y,m,i)}else if(r.type==="matcap"){let n=i.image(r.texture.image),a=new qM(n,r.texture.wrapping,r.texture.minFilter??1008,r.texture.magFilter??1006),o=new Ct(oh(r.alpha,i)),s=new oi(r.mode??0),l=new Ea(r.isMask??!1),c=new Ct((r.texture.rotation??0)*St.DEG2RAD),d=new sH(a,o,s,l,c),u=new pi(d.calpha,"f");return new zi(e,t,r,{texture:a,alpha:o,mode:s,isMask:l,rotation:c},d,s,u,l,i)}else if(r.type==="displace")if(r.displacementType==="noise"){let n=new xo(new k(...r.offset)),a=new Ct(r.scale??10),o=new Ct(r.intensity??8),s=new Ct(r.movement??1),l=new oi(r.noiseType??0),c=new oi(r.voronoiStyle??0),d=new Ct(r.smoothness??.5),u=new Ct(r.seed??0),h=new Ct(r.highCut??1),f=new Ct(r.lowCut??0),p=new oi(r.quality??1),v=new bH(o,s,n,c,d,u,h,f,p,a,l);return new MH(e,t,r,{offset:n,scale:a,intensity:o,movement:s,noiseType:l,voronoiStyle:c,smoothness:d,seed:u,highCut:h,lowCut:f,quality:p},v,i)}else throw new Error;else return YRe(e,t,r,i)}updateByOp(e,t,r){let i=e;if(i.path[0]===void 0){if(i.type===0)return"type"in i.props||"category"in i.props||"visible"in i.props?(r.scene.markNeedsUpdateRendererDirty(),!0):GRe(i.props,r.shared,this,t)}else if(i.path[0]==="texture")return"texture"in t||"video"in t?AH(i.props,r.shared,this):!0;return!1}dispose(){if($Re(this)){let e=this.uniforms[`f${this.id}_texture`];if(!e)return!1;let t=e;t.image instanceof Zc||t.image.deref()}}hasValueByKey(e){return this.uniforms[e]!==void 0}hasValue(e){return this.hasValueByKey(`f${this.id}_${e}`)}setValue(e,t){let r=`f${this.id}_${e}`;this.hasValueByKey(r)&&t!==void 0&&(this.uniforms[r].value=t)}getNode(e){let t=`f${this.id}_${e}`;if(this.hasValueByKey(t))return this.uniforms[t]}getValue(e){let t=`f${this.id}_${e}`;if(this.hasValueByKey(t))return this.uniforms[t].value}getName(e){let t=/f\d+_(.*)/.exec(e);if(t&&t.length>1)return t[1];console.log(`Layer.getName: error ${e}`)}getNames(){let e=[];for(let t in this.uniforms){let r=this.getName(t);r&&e.push(r)}return e}},zi=class extends Jg{constructor(e,t,r,i,n,a,o,s,l){super(e,t,r,i,l),this.params=i,this.color=n,this.mode=a,this.alpha=o,this.isMask=s}},MH=class extends Jg{constructor(e,t,r,i,n,a){super(e,t,r,i,a),this.position=n}},Ls=class extends Jg{constructor(e,t,r,i,n,a){super(e,t,r,n,a),this.node=i}static createLigherLayer(e,t,r,i){let n,a=new Ct(oh(r.alpha,i)),o=new oi(r.mode),s=new Ct(r.bumpMapIntensity),l=new Ct(oh(r.alphaOverride,i)),c;if(!r.visible)n=new rD,c={};else if(r.category==="lambert"){n=new ZOe;let d=new Fi(i.color(r.emissive)??0),u=new Ea(r.occlusion??!0);c={emissive:d,occlusion:u},n.emissive=d,n.occlusion=u}else if(r.category==="toon"){n=new tRe;let d=new Ct(r.shininess??30),u=new Fi(i.color(r.specular)??1118481);c={shininess:d,specular:u},n.shininess=d,n.specular=u}else if(r.category==="physical"){n=new eRe;let d=new Ct(r.roughness??.3),u=new Ct(r.metalness??0),h=new Ct(r.reflectivity??.5),f=new Ea(r.occlusion??!0);c={roughness:d,metalness:u,reflectivity:h,occlusion:f},n.roughness=d,n.metalness=u,n.reflectivity=h,n.occlusion=f}else{n=new JOe;let d=new Ct(r.shininess??30),u=new Fi(r.specular!==void 0?i.color(r.specular)??1118481:1118481),h=new Ea(r.occlusion??!0);c={shininess:d,specular:u,occlusion:h},n.shininess=d,n.specular=u,n.occlusion=h}return n.alpha=new Ct(1),n.shadingAlpha=a,n.shadingBlend=o,n.bumpMapIntensity=s,n.alphaOverride=l,c.alpha=n.shadingAlpha,c.mode=n.shadingBlend,c.bumpMapIntensity=n.bumpMapIntensity,c.alphaOverride=n.alphaOverride,new Ls(e,t,r,n,c,i)}get category(){return this.node.category}};function $Re(e){let t=e instanceof Jg?e.type:e;return t==="texture"||t==="video"||t==="displace_map"||t==="matcap"}function vo(e){return{alpha:new Ct(e.alpha??1),mode:new oi(e.mode??0),isMask:new Ea(e.isMask??!1)}}function qRe(e,t,r,i,n){switch(e.type){case"color":{let a=new Fi(i.color??co),o=vo(i),s=new YM(a,o.alpha),l=new pi(s.calpha,"f");return new zi(t,r,e,{color:a,...o},s,o.mode,l,o.isMask,n)}case"fresnel":{let a=new Fi(i.color??16777215),o=new Ct(i.bias??.1),s=new Ct(i.scale??1),l=new Ct(i.intensity??2),c=new Ct(i.factor??1),d=vo(i),u=new XOe(a,o,s,l,c,d.alpha,d.mode,d.isMask),h=new pi(u.calpha,"f");return new zi(t,r,e,{color:a,bias:o,scale:s,intensity:l,factor:c,...d},u,d.mode,h,d.isMask,n)}case"rainbow":{let a=new Ct(i.filmThickness??30),o=new Ct(i.movement??0),s=new xo(i.wavelengths??new k(0,0,0)),l=new Ct(i.noiseStrength??0),c=new Ct(i.noiseScale??1),d=new xo(i.offset??new k(0,0,0)),u=vo(i),h=new fH(a,o,s,l,c,d,u.alpha,u.isMask),f=new pi(h.calpha,"f");return new zi(t,r,e,{filmThickness:a,movement:o,wavelengths:s,noiseStrength:l,noiseScale:c,offset:d,...u},h,u.mode,f,u.isMask,n)}case"transmission":{let a=new Ct(i.thickness??10),o=new Ct(i.ior??1.5),s=new Ct(i.roughness??.5),l=jt.transmissionSize,c=jt.transmissionRenderTarget,d=jt.transmissionRenderTargetDepth,u=window.innerWidth,h=window.innerHeight,f=u>=h?new Xn(h/u,1):new Xn(1,u/h),p=vo(i),v=new gH(a,o,s,l,c,d,f,p.alpha),m=new pi(v.calpha,"f");return new zi(t,r,e,{thickness:a,ior:o,roughness:s,aspectRatio:f,...p},v,p.mode,m,p.isMask,n)}case"toon":{let a=new oi(i.positioning??0),o;i.colors?o=new lu(i.colors.length,i.colors):(o=new lu(10,new Kt(0,0,0,1)),o.value[1]=new Kt(1,1,1,1));let s;i.steps?s=new su(i.steps.length,i.steps):(s=new su(10,1),s.value[0]=0);let l=new xo(i.source??new k(0,0,0)),c=new Ea(i.isWorldSpace??!0),d=new Ct(i.noiseStrength??0),u=new Ct(i.noiseScale??1),h=new Ll(i.shadowColor),f=new xo(i.offset??new k(0,0,0)),p=vo(i),v=new mH(a,o,s,l,c,d,u,h,f,p.alpha),m=new pi(v.calpha,"f");return new zi(t,r,e,{positioning:a,colors:o,steps:s,source:l,isWorldSpace:c,noiseStrength:d,noiseScale:u,shadowColor:h,offset:f,...p},v,p.mode,m,p.isMask,n)}case"outline":{let a=new Fi(i.outlineColor??16777215),o=new Fi(i.contourColor??16777215),s=new Ct(i.outlineWidth??.1),l=new Ct(i.contourWidth??.1),c=new Ct(i.outlineThreshold??.1),d=new Ct(i.contourThreshold??.1),u=new Ct(i.outlineSmoothing??.1),h=new Ct(i.contourFrequency??.1),f=new xo(i.contourDirection??new k(0,1,0)),p=new Ea(i.positionalLines??!1),v=new Ea(i.compensation??!0),m=jt.normalRenderTarget,g=jt.normalRenderTargetDepth,y=jt.pixelRatioNode,b=jt.resolution,x=vo(i),S=new dH(a,o,s,l,c,d,u,h,f,p,v,b,m,g,y,x.alpha),w=new pi(S.calpha,"f");return new zi(t,r,e,{outlineColor:a,contourColor:o,outlineWidth:s,contourWidth:l,outlineThreshold:c,contourThreshold:d,outlineSmoothing:u,contourFrequency:h,contourDirection:f,positionalLines:p,compensation:v,...x},S,x.mode,w,x.isMask,n)}case"depth":{let a=new oi(i.gradientType??0),o=new Ea(i.smooth??!1),s=new Ct(i.near??50),l=new Ct(i.far??200),c=new Ct(i.isVector??1),d=new Ct(i.isWorldSpace??0),u=new xo(i.origin??new k),h=new xo(i.direction??new k),f;i.colors?f=new lu(i.colors.length,i.colors):(f=new lu(2,new Kt(0,0,0,1)),f.value[1]=new Kt(1,1,1,1));let p;i.steps?p=new su(i.steps.length,i.steps):(p=new su(2,1),p.value[0]=0);let v=vo(i),m=new iH(a,o,s,l,c,d,u,h,f,p,v.alpha,v.isMask),g=new pi(m.calpha,"f");return new zi(t,r,e,{gradientType:a,smooth:o,near:s,far:l,isVector:c,isWorldSpace:d,origin:u,direction:h,colors:f,steps:p,...v},m,v.mode,g,v.isMask,n)}case"noise":{let a=new Ct(i.scale??1),o=new xo(i.size??new k(100,100,100)),s=new Ct(i.move??1),l=new Xn(i.fA??new ye(1.7,9.2)),c=new Xn(i.fB??new ye(8.3,2.8)),d=new Xn(i.distortion??new ye(1,1)),u=new Ll(i.colorA),h=new Ll(i.colorB),f=new Ll(i.colorC),p=new Ll(i.colorD),v=new oi(i.noiseType??0),m=new oi(i.voronoiStyle??0),g=new Ct(i.highCut??1),y=new Ct(i.lowCut??0),b=new Ct(i.smoothness??.5),x=new Ct(i.seed??.5),S=new oi(i.quality??1),w=vo(i),_=new lH(a,o,s,l,c,d,u,h,f,p,w.alpha,v,w.isMask,m,g,y,b,x,S),C=new pi(_.calpha,"f");return new zi(t,r,e,{scale:a,size:o,move:s,fA:l,fB:c,distortion:d,colorA:u,colorB:h,colorC:f,colorD:p,noiseType:v,...w,voronoiStyle:m,highCut:g,lowCut:y,smoothness:b,seed:x,quality:S},_,w.mode,C,w.isMask,n)}case"normal":{let a=new xo(i.cnormal??new k(1,1,1)),o=vo(i),s=new rH(a,o.alpha),l=new pi(s.calpha,"f");return new zi(t,r,e,{cnormal:a,...o},s,o.mode,l,o.isMask,n)}case"gradient":{let a=new oi(i.gradientType??0),o=new Ea(i.smooth??!1),s;i.colors?s=new lu(i.colors.length,i.colors):(s=new lu(10,new Kt(0,0,0,1)),s.value[1]=new Kt(1,1,1,1));let l;i.steps?l=new su(i.steps.length,i.steps):(l=new su(10,1),l.value[0]=0);let c=new Xn(i.offset??new ye(0,0)),d=new Xn(i.morph??new ye(0,0)),u=new Ct(i.angle??0),h=vo(i),f=new aH(a,o,s,l,c,d,u,h.alpha,h.isMask),p=new pi(f.calpha,"f");return new zi(t,r,e,{gradientType:a,smooth:o,colors:s,steps:l,offset:c,morph:d,angle:u,...h},f,h.mode,p,h.isMask,n)}case"pattern":{let a=new oi(i.style??0),o=new oi(i.projection??0),s=new oi(["x","y","z"].indexOf(i.axis)??0),l=new Ct(i.blending??0),c=new Xn(i.offset??new ye(0,0)),d=new Ll(i.colorA),u=new Ll(i.colorB),h=new Xn(i.frequency??new ye(10,10)),f=new Ct(i.size??.5),p=new Ct(i.variation??0),v=new Ct(i.smoothness??.5),m=new Ct(i.zigzag??0),g=new Ct(i.rotation??0),y=new Xn(i.vertical??new ye(0,1)),b=new Xn(i.horizontal??new ye(0,1)),x=new oi(i.sides??6),S=vo(i),w=new uH(a,o,s,l,c,d,u,h,f,p,v,m,g,y,b,x,S.alpha,S.isMask),_=new pi(w.calpha,"f");return new zi(t,r,e,{style:a,projection:o,axis:s,blending:l,offset:c,colorA:d,colorB:u,frequency:h,size:f,variation:p,smoothness:v,zigzag:m,rotation:g,vertical:y,horizontal:b,sides:x,...S},w,S.mode,_,S.isMask,n)}default:{let a=new Fi(1,0,0,1),o=vo(i),s=new YM(a,o.alpha),l=new pi(s.calpha,"f");return new zi(t,r,e,{color:a,...o},s,o.mode,l,o.isMask,n)}}}function YRe(e,t,r,i){let n=PRe(r,i);return qRe(r,e,t,n,i)}function EH(e,t,r,i){if(r.type==="displace"&&(e==="intensity"||e==="visible")){let n=t.uniforms[`f${t.id}_intensity`];return n?(n.value=r.intensity*(r.visible?1:0),n):void 0}if(r.type!=="displace"&&(e==="alpha"||e==="visible")){let n=t.uniforms[`f${t.id}_alpha`];if(!n)return;if(n.value=oh(r.alpha,i)*(r.visible?1:0),r.type==="outline"&&e==="visible"){let a=t.uniforms[`f${t.id}_compensation`];a&&(a.value=r.compensation&&r.visible)}return n}}function Of(e,t){let r=0,i=e.layers.find(n=>n.data.type==="light");if(i){let n=i.data,a=Number(t.getVariable(n.alphaOverride));if((typeof n.alphaOverride=="string"?a/100:n.alphaOverride)<1)return!0}for(let n of e.layers){if(n.data.type!=="displace"&&n.data.isMask)return!0;if(n.data.type!=="displace"&&"alpha"in n.data&&n.data.type!=="light"&&n.data.type!=="fresnel"&&n.data.type!=="texture"&&n.data.type!=="matcap"&&n.data.type!=="rainbow"&&n.data.type!=="outline"&&n.data.type!=="pattern"){let a=n.data.visible?n.data.alpha:0;if(typeof a=="string"&&(a=Math.max(0,Math.min(1,Number(t.getVariable(a)??100)/100))),a===1&&n.data.type==="depth"||n.data.type==="gradient"){for(let o of n.data.colors)if(o[3]<1){a=o[3];break}}else if(a===1&&n.data.type==="noise"){let o=t.color(n.data.colorA).a,s=t.color(n.data.colorB).a,l=t.color(n.data.colorC).a,c=t.color(n.data.colorD).a,d=Math.min(o,Math.min(s,Math.min(l,c)));d<1&&(a=d)}r+=(1-r)*a}}return r<1}var Ad=class extends jr{constructor(){super(void 0),this.flatShading=!1,this.needsJitter=!0,this.nodeContextUuid=0,this.fog=!0,this.dithering=!0,this.vertexColors=!0,this.transparent=!0}customProgramCacheKey(){return""}},XRe=class extends Ad{constructor(e,t,r,i){super(),this.flatShading=e,this.side=t,this.wireframe=r,this.root=i}updateAfterBuild(){let e=this.root;this.lights=e.lights,this.vertexShader=e.vertexShader,this.fragmentShader=e.fragmentShader,this.defines=e.defines,this.uniforms=e.uniforms,this.extensions=e.extensions,this.transparent=e.transparent,this.cacheKey=e.customProgramCacheKey()+"flat"+this.flatShading+this.side}onBeforeCompile(e,t){this.root.onBeforeCompile(e)}get data(){return this.root.data}get category(){return this.root.category}get hasAO(){return this.root.hasAO}getFlavor(e,t,r){return this.root.getFlavor(e,t,r)}get layers(){return this.root.layers}get fragment(){return this.root.fragment}getLayersOfType(e){return this.root.getLayersOfType(e)}getLayerByUuid(e){return this.root.getLayerByUuid(e)}updateByOp(e,t,r){this.root.updateByOp(e,t,r)}nodeMaterialDispose(){this.root.nodeMaterialDispose()}},iD=class extends Ad{constructor(e,t,r=!0){super(),this.data=e,this.allowVariableSaves=r,this.layerIdGen=0,this.flavors=[],this.masks={},this.type="NodeMaterial",this.updaters=[],this.needsJitter=t.shared.needsJitter,mn.startContext(this),this.reset0(e,t),mn.endContext(this)}get nodeMaterial(){return this}getFlavor(e,t,r){let i=r?6:(e?3:0)+t;if(i===0)return this;this.flavors===void 0&&(this.flavors=[]),i-=1;let n=this.flavors[i];return n===void 0&&(n=new XRe(e,t,r,this),n.needsJitter=this.needsJitter,this.flavors[i]=n,n.flatShading=e,n.side=t,n.updateAfterBuild()),n}get fragment(){return this.lightLayer.node}get category(){return this.lightLayer.category}get hasAO(){var e;return((e=this.lightLayer.getNode("occlusion"))==null?void 0:e.value)??!1}reset(e,t,r=!1){mn.startContext(this),(this.data!==e||r)&&this.reset0(e,t),mn.endContext(this)}reset0(e,t){this.data=e;let r=e.layers??ea.defaultTwoLayerData("phong").layers;try{this.layers=r.map(i=>Jg.create(this.layerIdGen++,i.id,i.data,t.shared))}catch{this.layers=[]}this.layers.reverse(),this.name=e.name??"Untitled Material",this.onUpdate(t.shared),this.transparent=Of(e,t.shared),this.saveVariableLocations(t)}onVariableUpdate(e,t,r){if(e[0]==="alphaOverride")this.transparent=Of(this.data,r.shared),this.lightLayer.setValue("alphaOverride",Math.max(0,Math.min(Number(t)/100,1)));else if(e[0]==="layer"){let i=e[1],n=e[2];if(i&&n){let a=this.layers.find(o=>o.uuid===i);a!=null&&a.hasValue(n)&&(n==="alpha"?(this.transparent=Of(this.data,r.shared),a.setValue(n,Math.max(0,Math.min(Number(t)/100,1)))):a.setValue(n,t))}}}saveVariableLocations(e){if(!this.allowVariableSaves)return;let t=this.data.layers.find(r=>r.data.type==="light");t&&e.shared.getVariable(t.data.alphaOverride,["material",this.uuid,"alphaOverride"]),this.data.layers.forEach(r=>{"alpha"in r.data&&typeof r.data.alpha=="string"&&e.shared.getVariable(r.data.alpha,["material",this.uuid,"layer",r.id,"alpha"])})}getLayersOfType(e){return this.layers.filter(t=>t.type===e)}getLayerByUuid(e){return this.layers.find(t=>t.uuid===e)}onUpdate(e){this.lightLayer=this.layers.find(t=>t instanceof Ls),this.lightLayer===void 0&&(this.lightLayer=new Ls(0,"",{...Tn.defaultData("light","phong"),visible:!1},new rD,{},e)),this.dispose();for(let t of this.flavors)t&&t.dispose();this.applyTextureMaps(),this.applyMasks(),this.blendColors(),this.blendAfterColors(),this.blendPositions(),this.build(),this.nodeContextUuid=0}applyTextureMaps(){let e=this.layers.find(n=>n instanceof Ls);if(!e)return;let t=e.data,r=t.bumpMap,i=t.roughnessMap;e.node.bumpMap=void 0,e.node.roughnessMap=void 0;for(let n=0;n<this.layers.length;++n){let a=this.layers[n];a instanceof zi&&a.color instanceof eD&&(a.uuid===r&&(e.node.bumpMap=a.color),a.uuid===i&&(e.node.roughnessMap=a.color))}}updateByOp(e,t,r){if(mn.startContext(this),t!==void 0?this.data=t:t=this.data,this.transparent=Of(t,r.shared),e.path[0]==="layers"){let i=r.shared,n=e.path[1];if(n===void 0)r.scene.markNeedsUpdateRendererDirty(),this.reset0(t,r);else{e.type===0&&e.props.occlusion!==void 0&&r.scene.markNeedsUpdateRendererDirty();let a=this.layers.find(o=>o.uuid===n);if(a){let o=t.layers.data(n),s;e.type===0&&("alpha"in e.props||"alphaOverride"in e.props)&&("alpha"in e.props?s={...e.props,alpha:oh(e.props.alpha,i,["material",this.uuid,"layer",n,"alpha"])}:s={...e.props,alphaOverride:oh(e.props.alphaOverride,i,["material",this.uuid,"alphaOverride"])}),a.updateByOp({...e,...s?{props:s}:{},path:e.path.slice(2)},o,r)&&this.reset0(t,r)}}}else this.reset0(t,r);mn.endContext(this)}applyMasks(){for(let e=0;e<this.layers.length;++e){let t=this.layers[e];t instanceof zi?t.color.mask=void 0:t instanceof Ls&&(t.node.mask=void 0)}for(let e=0;e<this.layers.length;++e){let t=this.layers[e];if(t instanceof zi&&t.isMask.value&&t.data.visible&&e>0){let r=e-1,i=this.layers[r];i instanceof Ls?i.node.mask=new Ua(t.color,t.alpha,Ua.MUL):i instanceof zi&&(i.isMask.value||(i.color.mask=new Ua(t.color,t.alpha,Ua.MUL)))}}}blendColors(){let e=this.layers.findIndex(r=>r instanceof zi),t=this.layers.findIndex(r=>r instanceof Ls);if(e!==-1&&e<t){let r=this.layers[e].color;for(let i=e+1;i<t;++i){let n=this.layers[i];if(n instanceof zi){if(n.isMask.value)continue;r=new ZL(r,n.color,n.alpha,n.mode)}}this.fragment.color=r}else this.fragment.color=void 0}blendAfterColors(){let e=new pi("outgoingLight","f"),t=this.layers.findIndex(r=>r instanceof Ls);if(this.layers.length>t+1){for(let r=t+1;r<this.layers.length;++r){let i=this.layers[r];if(i instanceof zi){if(i.isMask.value)continue;e=new ZL(e,i.color,i.alpha,i.mode)}}this.fragment.afterColor=e}else this.fragment.afterColor=void 0}blendPositions(){let e=this.layers.filter(t=>t instanceof MH);if(e.length>0){let t=e[0].position;for(let r=1;r<e.length;++r)e[r]&&(t=new Ua(t,e[r].position,Ua.ADD),t=new Ua(t,new Ct(.5).setReadonly(!0),Ua.MUL));this.fragment.position=t}else this.fragment.position=void 0}getDefines(){return this.defines}getUniforms(){return this.uniforms}getVertexShader(){return this.vertexShader}getFragmentShader(){return this.fragmentShader}onBeforeCompile(e){e.defines=this.defines,e.uniforms=this.uniforms,e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader,e.extensionDerivatives=this.extensions.derivatives===!0,e.extensionFragDepth=this.extensions.fragDepth===!0,e.extensionDrawBuffers=this.extensions.drawBuffers===!0,e.extensionShaderTextureLOD=this.extensions.shaderTextureLOD===!0}clampUniformsForPreview(e,t){let r=(i,n,a)=>Math.min(Math.max(i,n),a);for(let i of this.layers)if(i.type==="displace"){let n=r(i.uniforms[`f${i.id}_intensity`].value,e,t);i.uniforms[`f${i.id}_intensity`].value=n}}updateFrame(e){for(let t=0;t<this.updaters.length;++t)e.updateNode(this.updaters[t])}build(){let e=new Z8;e.needsJitter=this.needsJitter,this.lights=this.lightLayer.data.visible,e.build(this.fragment,this.fragment),this.vertexShader=e.getCode("vertex"),this.fragmentShader=e.getCode("fragment"),this.defines=e.defines,this.uniforms=e.uniforms,this.extensions=e.extensions,this.updaters=e.updaters;for(let t of this.flavors)t&&t.updateAfterBuild();return this}nodeMaterialDispose(){this.layers.forEach(e=>e.dispose()),super.dispose();for(let e of this.flavors)e&&e.dispose()}assetsLoaded(){for(let e of this.layers)if(e instanceof zi){let t=e.params.texture;if(t instanceof qM&&!t.image.loaded)return!1}return!0}};Object.defineProperties(Ad.prototype,{properties:{get:function(){return this.fragment.properties}}});var QM=class extends iD{constructor(e,t,r){super(e,t,!1),this.uuid=r,this.allowVariableSaves=!0,this.saveVariableLocations(t)}},lB=new Map;function KRe(e){if(typeof e=="string")return e;let t=lB.get(e);return t||(t={url:URL.createObjectURL(new Blob([e]))},lB.set(e,t)),t.url}var TH,QRe=new Promise(e=>{TH=e}),cB=!1,Ly;function ZRe(){if(cB)return;if(Ly)return Ly;async function e(){await Nd(()=>import("./howler-gjfl33IT.js").then(t=>t.h),[]),TH(window!==void 0?window:global),cB=!0}return Ly=e(),Ly}var PH;QRe.then(e=>PH=e);function JRe(e){let t=!1;return e.scene.objects.traverse((r,i)=>{if(i.events===void 0||Array.isArray(i.events)===!1)return!0;let n=[];i.events.forEach(a=>{"dragDropActions"in a.data?(n.push(...a.data.dragDropActions.drag),n.push(...a.data.dragDropActions.drop)):"inActions"in a.data?(n.push(...a.data.inActions),n.push(...a.data.outActions)):"gameActions"in a.data?(n.push(...a.data.gameActions.idle),n.push(...a.data.gameActions.move),n.push(...a.data.gameActions.jump),n.push(...a.data.gameActions.run)):"breakpoints"in a.data?a.data.breakpoints.forEach(o=>{n.push(...o.data.actions)}):"actions"in a.data&&n.push(...a.data.actions),t=t||n.some(o=>o.data.type==="Audio")})}),t}var ov=class{constructor({src:e,volume:t,delay:r,loop:i}){this._volume=1,this.delay=0,this._loop=1,this.loopsRemaining=0,this._status="stopped",this.onEnd=()=>{this.loopsRemaining===1/0?this.replay():this.loopsRemaining>1?(this.replay(),this.loopsRemaining--):(this._status="stopped",this.loopsRemaining=this._loop)};let n;typeof e=="string"?n={src:e}:n={src:KRe(e),format:"wav"},this.sound=new PH.Howl(n),this.sound.on("end",this.onEnd),this.src=e,t!==void 0&&(this.volume=t),r!==void 0&&(this.delay=r),i!==void 0&&(this.loop=i)}get status(){return this._status}get volume(){return this._volume}set volume(e){this._volume=e,this.sound.volume(e)}get loop(){return this._loop}set loop(e){this._loop=e,this.loopsRemaining=e}replay(){this.clearDelay(),this.delayTimerId=window.setTimeout(()=>{this.sound.play(),this.clearDelay()},this.delay)}fade(e,t=1e3){e?(this.sound.volume(this._volume),this.clearFade(),this.fadeTimerId=window.setTimeout(()=>{this.sound.fade(this._volume,0,t),this.clearFade()},e)):this.sound.fade(this._volume,0,t)}on(e,t,r){this.sound.on(e,t,r)}off(e,t,r){this.sound.off(e,t,r)}play(){this._status==="playing"||this.sound.playing()||(this._status==="paused"?(this.sound.seek()===0?this.replay():this.sound.play(),this._status="playing"):this._status==="stopped"&&(this.replay(),this._status="playing"))}pause(){this._status==="playing"&&(this.sound.pause(),this.clearFade(),this.clearDelay(),this._status="paused")}stop(){this.sound.stop(),this.loopsRemaining=this._loop,this.clearFade(),this.clearDelay(),this._status="stopped"}clearFade(){this.fadeTimerId&&(clearTimeout(this.fadeTimerId),delete this.fadeTimerId)}clearDelay(){this.delayTimerId&&(clearTimeout(this.delayTimerId),delete this.delayTimerId)}dispose(e=!1){this.off(),this.stop(),this.clearFade(),this.clearDelay()}},eIe=class{constructor(){this.type="ShapePath",this.color=new Lt,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new px,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){var r;return(r=this.currentPath)==null||r.lineTo(e,t),this}quadraticCurveTo(e,t,r,i){var n;return(n=this.currentPath)==null||n.quadraticCurveTo(e,t,r,i),this}bezierCurveTo(e,t,r,i,n,a){var o;return(o=this.currentPath)==null||o.bezierCurveTo(e,t,r,i,n,a),this}splineThru(e){var t;return(t=this.currentPath)==null||t.splineThru(e),this}toShapes(){let e={ORIGIN:0,DESTINATION:1,BETWEEN:2,LEFT:3,RIGHT:4,BEHIND:5,BEYOND:6},t={loc:e.ORIGIN,t:0};function r(f,p,v,m){let g=f.x,y=p.x,b=v.x,x=m.x,S=f.y,w=p.y,_=v.y,C=m.y,A=(x-b)*(S-_)-(C-_)*(g-b),M=(y-g)*(S-_)-(w-S)*(g-b),P=(C-_)*(y-g)-(x-b)*(w-S),T=A/P,R=M/P;if(P===0&&A!==0||T<=0||T>=1||R<0||R>1)return null;if(A===0&&P===0){for(let z=0;z<2;z++)if(i(z===0?v:m,f,p),t.loc===e.ORIGIN){let F=z===0?v:m;return{x:F.x,y:F.y,t:t.t}}else if(t.loc===e.BETWEEN){let F=+(g+t.t*(y-g)).toPrecision(10),H=+(S+t.t*(w-S)).toPrecision(10);return{x:F,y:H,t:t.t}}return null}else{for(let H=0;H<2;H++)if(i(H===0?v:m,f,p),t.loc===e.ORIGIN){let N=H===0?v:m;return{x:N.x,y:N.y,t:t.t}}let z=+(g+T*(y-g)).toPrecision(10),F=+(S+T*(w-S)).toPrecision(10);return{x:z,y:F,t:T}}}function i(f,p,v){let m=v.x-p.x,g=v.y-p.y,y=f.x-p.x,b=f.y-p.y,x=m*b-y*g;if(f.x===p.x&&f.y===p.y){t.loc=e.ORIGIN,t.t=0;return}if(f.x===v.x&&f.y===v.y){t.loc=e.DESTINATION,t.t=1;return}if(x<-Number.EPSILON){t.loc=e.LEFT;return}if(x>Number.EPSILON){t.loc=e.RIGHT;return}if(m*y<0||g*b<0){t.loc=e.BEHIND;return}if(Math.sqrt(m*m+g*g)<Math.sqrt(y*y+b*b)){t.loc=e.BEYOND;return}let S;m!==0?S=y/m:S=b/g,t.loc=e.BETWEEN,t.t=S}function n(f,p){let v=[],m=[];for(let g=1;g<f.length;g++){let y=f[g-1],b=f[g];for(let x=1;x<p.length;x++){let S=p[x-1],w=p[x],_=r(y,b,S,w);_!==null&&v.find(C=>C.t<=_.t+Number.EPSILON&&C.t>=_.t-Number.EPSILON)===void 0&&(v.push(_),m.push(new ye(_.x,_.y)))}}return m}function a(f,p,v){let m=new ye;p.getCenter(m);let g=[];return v.forEach(y=>{y.boundingBox.containsPoint(m)&&n(f,y.points).forEach(b=>{g.push({identifier:y.identifier,isCW:y.isCW,point:b})})}),g.sort((y,b)=>y.point.x-b.point.x),g}function o(f,p,v,m,g){(g==null||g==="")&&(g="nonzero");let y=new ye;f.boundingBox.getCenter(y);let b=[new ye(v,y.y),new ye(m,y.y)],x=a(b,f.boundingBox,p);x.sort((M,P)=>M.point.x-P.point.x);let S=[],w=[];x.forEach(M=>{M.identifier===f.identifier?S.push(M):w.push(M)});let _=S[0].point.x,C=[],A=0;for(;A<w.length&&w[A].point.x<_;)C.length>0&&C[C.length-1]===w[A].identifier?C.pop():C.push(w[A].identifier),A++;if(C.push(f.identifier),g==="evenodd"){let M=C.length%2===0,P=C[C.length-2];return{identifier:f.identifier,isHole:M,for:P}}else if(g==="nonzero"){let M=!0,P=null,T=null;for(let R=0;R<C.length;R++){let z=C[R];p[z]&&(M?(T=p[z].isCW,M=!1,P=z):T!==p[z].isCW&&(T=p[z].isCW,M=!0))}return{identifier:f.identifier,isHole:M,for:P}}else console.warn('fill-rule: "'+g+'" is currently not implemented.')}let s=0,l=999999999,c=-999999999,d=[];this.subPaths.forEach(f=>{let p=f.getPoints(),v=-999999999,m=999999999,g=-999999999,y=999999999;for(let b=0;b<p.length;b++){let x=p[b];x.y>v&&(v=x.y),x.y<m&&(m=x.y),x.x>g&&(g=x.x),x.x<y&&(y=x.x)}c<=g&&(c=g+1),l>=y&&(l=y-1),p.length&&d.push({curves:f.curves,points:p,isCW:Ij.isClockWise(p),identifier:s++,boundingBox:new Gj(new ye(y,m),new ye(g,v))})});let u=d.map(f=>{var p;return o(f,d,l,c,(p=this.userData)==null?void 0:p.style.fillRule)}),h=[];return d.forEach(f=>{let p=u[f.identifier];if(p&&!p.isHole){let v=new mx;v.curves=f.curves,u.filter(m=>(m==null?void 0:m.isHole)&&m.for===f.identifier).forEach(m=>{if(m){let g=d[m.identifier],y=new px;y.curves=g.curves,v.holes.push(y)}}),h.push(v)}}),h}},DH=!1,OH,dB=new Promise(e=>{OH=e}),uB=!1,By;function tIe(){if(DH=!0,uB)return;if(By)return By;async function e(){let t=await Nd(()=>import("./opentype-D6jUvuOk.js"),[]);OH(t),uB=!0}return By=e(),By}var rIe=class{async load(e,t,r=()=>{}){let{load:i}=await dB;i(e,(n,a)=>{n||!a?r(n??"Something went wrong"):t(a)})}async parse(e){let{parse:t,Bidi:r}=await dB;try{let i=t(e),n=new r,a=o=>i.charToGlyphIndex(o.char);return n.registerModifier("glyphIndex",null,a),n.applyFeatures(i,i.defaultRenderOptions.features),{font:i,bidi:n}}catch(i){console.error(i)}}};async function iIe(e){return await(await fetch(e)).arrayBuffer()}var nIe=new rIe;async function hB(e){let t,r,i=!1;if(e.url?(t=await iIe(e.url),r=e.url,i=e.url.startsWith("/")):e.data&&(t=e.data.buffer.slice(e.data.byteOffset,e.data.byteOffset+e.data.byteLength)),t)if(DH){let n=await nIe.parse(t);if(n)return{font:n.font,url:r,intercepted:i,arr:t,bidi:n.bidi}}else return{font:void 0,url:r,intercepted:i,arr:t,bidi:null}}function aIe(e,t){return t.state.glyphIndex===e||t.state.fina===e||t.state.medi===e||t.state.init===e}var oIe=class{constructor(e){this._arrayBuffer=new ArrayBuffer(1),this._isLoaded=!1,this._intercepted=!1,this._isUserFont=e.isUserFont??!1,this._loadingPromise=hB(e).then(t=>{t&&(this._arrayBuffer=t.arr,this._url=t.url,this.font=t.font,this._intercepted=t.intercepted,this._isLoaded=!0,this._bidi=t.bidi)})}update(e){this._isLoaded=!1,this._isUserFont=e.isUserFont??!1,this._loadingPromise=hB(e).then(t=>{t&&(this._arrayBuffer=t.arr,this._url=t.url,this.font=t.font,this._intercepted=t.intercepted,this._isLoaded=!0,this._bidi=t.bidi)})}get url(){return this._url}get intercepted(){return this._intercepted}get isLoaded(){return this._isLoaded}get loadingPromise(){return this._loadingPromise}reverseLigaturesTable(e,t,r){if(!this._bidi)return[];let i=this._bidi;i.getTextGlyphs(t);let n=i.tokenizer.tokens,a=[],o=0,s=r.length===n.length;for(let l=0;l<r.length;l++){let c=r[l].index,d=String.fromCharCode(r[l].unicode),u=n[o];if(aIe(c,u)||s)a.push({char:d,index:c,replacements:[u.state.glyphIndex],replacementChars:[u.char]}),o++;else{let h=u.char,f="",p=[u.state.glyphIndex],v=[],m=!1;for(;!m;)o++,f=t.charAt(o),h+=f,p.push(e.charToGlyphIndex(f)),v=e.stringToGlyphs(h),v.length===1&&v[0].index===c&&(m=!0),o>t.length&&(m=!0);a.push({char:d,index:c,replacements:p,replacementChars:Array.from(h)}),o++}}return a}generateShapes(e,t){if(!this._isLoaded)return;let r=this.font,i=t.fontSize/this.unitsPerEm,n=t.fontSize*t.lineHeight,a=e.map(g=>this.getTextWidth(g,t)),o=t.width,s=this.getCharWidth(`
`,t),l=t.horizontalAlign===1?s:0,c=this.computeSpaceWidthForLine(e,0,t),d=this.getLineInitialOffsetX(a[0],o,t.horizontalAlign,e[0],s),u=this.getLineInitialOffsetY(n,e.length,t.height,i,t.verticalAlign),h=[],f=e.map(g=>[]),p=e.map(g=>[]),v;for(let g=0;g<e.length;g++){let y=e[g],b={features:{liga:!0}},x=[];try{x=r.stringToGlyphs(y,b)}catch(w){console.warn(w)}d=this.getLineInitialOffsetX(a[g],o,t.horizontalAlign,y,s);let S=[];try{S=this.reverseLigaturesTable(r,y,x)}catch(w){console.warn(w)}c=this.computeSpaceWidthForLine(e,g,t);for(let w=0;w<x.length;w++){let _=x[w],C=_.index===0?`
`:_.unicode?String.fromCharCode(_.unicode):void 0,A=S[w],M=0,P=0;w===0&&t.horizontalAlign===2&&_.leftSideBearing!==void 0&&(P=-_.leftSideBearing*i),v&&(M=r.getKerningValue(_,v)*i),d+=P+M;let T=0;if(C===`
`)T=l;else if(C===" ")T=c;else{let R=this.createPath(_,i,d,u,t);R&&(T=R.offsetX-(M+P),h.push(R.path))}if(A.replacements.length===1)p[g].push([d,u]),f[g].push(T);else{let R=A.replacements.map(N=>(r.glyphs.get(N).advanceWidth??0)*i),z=R.reduce((N,U)=>N+=U,0),F=R.map(N=>N/z),H=d;for(let N=0;N<F.length;N++){let U=T*F[N];p[g].push([H,u]),f[g].push(U),H+=U}}d+=T,v=_}u-=n}let m=[];for(let g=0,y=h.length;g<y;g++)m.push(...h[g].toShapes());return{shapes:m,charWidths:f,lineWidths:a,charCoords:p}}get isUserFont(){return this._isUserFont}get arrayBuffer(){return this._arrayBuffer}get ascender(){var e;return((e=this.font)==null?void 0:e.ascender)??0}get descender(){var e;return((e=this.font)==null?void 0:e.descender)??0}get familyName(){var e;return((e=this.font)==null?void 0:e.names.fontFamily)??""}get subfamilyName(){var e;return((e=this.font)==null?void 0:e.names.fontSubfamily)??""}get unitsPerEm(){var e;return((e=this.font)==null?void 0:e.unitsPerEm)??1}getLineInitialOffsetX(e,t,r,i,n){return(r===3||r===2)&&i.indexOf(`
`)>=0&&(e-=n),r===3?t*.5-e*.5:r===2?t-e:0}getLineInitialOffsetY(e,t,r,i,n){let a=t*e,o=Math.abs(this.ascender-this.descender)*i,s=e-o,l=-this.ascender*i-s/2;return n===3?-(r-a-l):n===2?-(r*.5-a*.5-l):l}createPath(e,t,r,i,n){var l;let a=e.getPath(r,-i,n.fontSize,{kerning:!1,letterSpacing:n.letterSpacing});if(!a){console.error('THREE.Font: character "'+e+'" does not exists in font family '+this.familyName+".");return}let o=new eIe,s=(e.advanceWidth??1)*t;if(e)for(let c of a.commands){let d=(l=o.currentPath)==null?void 0:l.currentPoint;if(!(d&&c.type!=="Z"&&d.x===c.x&&-d.y===c.y))switch(c.type){case"M":o.moveTo(c.x,-c.y);break;case"L":o.lineTo(c.x,-c.y);break;case"Q":o.quadraticCurveTo(c.x1,-c.y1,c.x,-c.y);break;case"C":o.bezierCurveTo(c.x1,-c.y1,c.x2,-c.y2,c.x,-c.y);break}}return o.subPaths.forEach(c=>{let d=sIe(c.curves);d!==void 0&&c.currentPoint.distanceTo(d)>0&&c.lineTo(d.x,d.y)}),{offsetX:s+n.fontSize*n.letterSpacing,path:o}}getCharWidth(e,t){var r;return((r=this.font)==null?void 0:r.getAdvanceWidth(e,t.fontSize,{kerning:!0,letterSpacing:t.letterSpacing}))??0}getTextWidth(e,t){var r;return((r=this.font)==null?void 0:r.getAdvanceWidth(e,t.fontSize,{kerning:!0,letterSpacing:t.letterSpacing}))??0}computeSpaceWidthForLine(e,t,r){let i=this.getCharWidth(" ",r),n=e[t];if(n){let a=this.countSpaces(n.trimEnd());if(r.horizontalAlign===4&&t<e.length-1&&a){let o=r.width,s=this.getTextWidth(n,r);return(o-(s-a*i))/a}}return i}countSpaces(e){return(e.match(/ /g)||[]).length}};function sIe(e){if(e.length){let t=e[0];if(t instanceof ls)return t.v1;if(t instanceof rs||t instanceof Cd)return t.v0}}var lIe=class{constructor(){this.objects=new Map,this.unreachable=new Set}getCached(e){return this.objects.get(e)}get size(){return this.objects.size}get(e,t,r){let i=this.objects.get(e);return i===void 0?(i=this.createObject(e,t,r),this.objects.set(e,i)):i.isShared=!0,i}forceDelete(e){let t=this.objects.get(e);t&&(this.disposeObject(t),this.objects.delete(e))}mutateIfUnique(e,t){let r=this.objects.get(e);if(r&&r.isShared!==!0)return this.objects.delete(e),this.objects.set(t,r),r}startGc(){this.unreachable=new Set(this.objects.keys())}markAsReachable(e,t){let r=this.objects.get(e);t===r&&this.unreachable.delete(e)}endGc(){this.unreachable.forEach(e=>{this.disposeObject(this.objects.get(e)),this.objects.delete(e)}),this.unreachable.clear()}dispose(){this.objects.forEach(e=>{this.disposeObject(e)}),this.objects.clear()}},fB=class extends lIe{constructor(e){super(),this.flatShading=e}disposeObject(e){e.dispose()}createObject(e,t,r){let i=Cg(e,t,this.flatShading,r);return i.computeBoundingSphere(),i}},cIe={markNeedsUpdateRendererDirty:()=>{}};function nD(e){return{all:e=e||new Map,on:function(t,r){var i=e.get(t);i?i.push(r):e.set(t,[r])},off:function(t,r){var i=e.get(t);i&&(r?i.splice(i.indexOf(r)>>>0,1):e.set(t,[]))},emit:function(t,r){var i=e.get(t);i&&i.slice().map(function(n){n(r)}),(i=e.get("*"))&&i.slice().map(function(n){n(t,r)})}}}var dIe=class{constructor(e,t,r){var i;this.id=e,this.userAPI=t,this.result=void 0,this.error="null",this.isPrefetched=!1,this.isLoading=!1,this.isLoaded=!1,this.prefetchPromise=new Promise(n=>n()),this.emitter=nD(),((i=t==null?void 0:t.integration)==null?void 0:i.type)==="OpenAI"?this.result={content:""}:t.method==="GET"&&t.url!==""&&(this.prefetchPromise=this.prefetch(r))}async prefetch(e){await this.callUserAPI(e)}async callUserAPI(e){var t,r,i;this.emitter.emit("start",{userAPIId:this.id}),this.isLoading=!0,this.isLoading=!1;try{this.result=await mIe(this.userAPI,e),this.error="null",this.emitter.emit("success",{userAPIId:this.id})}catch(n){let a=((i=(r=(t=n.message)==null?void 0:t.split("_:_"))==null?void 0:r[0])==null?void 0:i.replace("status:",""))??"null";this.error=a,this.result=null,this.emitter.emit("error",{userAPIId:this.id})}this.isLoading=!1,this.isPrefetched=!0,this.isLoaded=!0}update(e,t){this.userAPI=e,this.userAPI.url!==""&&this.userAPI.method==="GET"&&this.prefetch(t)}retrieveValue(e){if(this.result)try{return gn.zoom(this.result,e)}catch(t){console.error(t)}}retrieveZoomedKeyValues(e){if(this.result){let t=e&&e.length?gn.zoom(this.result,e):this.result;if(pIe(t))return Object.entries(t);if(fIe(t))return t.map((r,i)=>[i.toString(),r]);throw hIe(t)?new Error("This path points to a value, use retrieveValue() instead. "+(e==null?void 0:e.join("."))):new Error("Path error"+(e==null?void 0:e.join(".")))}}dispose(){}on(e,t){this.emitter.on(e,t)}off(e,t){this.emitter.off(e,t)}get autostart(){return this.userAPI.autoStart}};function uIe(e){let t=new Headers;return e.headers.forEach(r=>{r.data.key!==""&&t.append(r.data.key,r.data.value)}),t}function hIe(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||e===null}function fIe(e){return Array.isArray(e)}function pIe(e){return typeof e=="object"&&e!==null}async function mIe(e,t,r=new AbortController){var a,o;let i;if(((a=e.integration)==null?void 0:a.type)==="OpenAI"){let s=wb(e.integration.prompt===""?"":JSON.parse(e.integration.prompt),t),l=e.integration.behavior===""?"":wb(JSON.parse(e.integration.behavior),t);i=`{
			"model": "${e.integration.model}",
			"messages": [${e.integration.useBehavior?`
			{
				"role": "system",
				"content": "${l}"
			},`:""}
			{
				"role": "user",
				"content": "${s}"
			}
			]
		}`}else e.method==="POST"&&e.body&&(i=wb(JSON.parse(e.body),t));let n=await fetch(e.url,{method:e.method,headers:uIe(e),signal:r.signal,body:i});if(!n.ok)throw new Error("status:"+n.status+"_:_"+n.statusText);return((o=e.integration)==null?void 0:o.type)==="OpenAI"?{content:(await n.json()).choices[0].message.content}:await n.json()}var RH=(e,t)=>{if(typeof e=="string"){let r=t.getVariable(e);if(r)return RH(r,t)}return ta.isBoolean(e)?ta.getDisplayedValue(e).toLowerCase():ta.getDisplayedValue(e)},wb=(e,t)=>e.map((r,i)=>{if("text"in r)return r.text;if("type"in r){if(r.type==="paragraph")return(i>0?`
`:"")+wb(r.children,t);if(r.type==="variable"){let n=t.getVariable(r.variableId);if(n!==void 0)return RH(n,t)}}return""}).join(""),Sb=1e3,pB=512*Sb;function vIe(e,t){let r=typeof e;return!!((t==="string"||t==="number")&&r===t||t==="boolean"&&(e==="true"||e==="false"||e===!0||e===!1)||t==="image"&&r==="string"&&e.startsWith("http"))}var gIe="https://hooks.spline.design",yIe=`${gIe}/events?hashFile=`,bIe=class{constructor(e,t){this.id=e,this.userWebhook=t,this.result=void 0,this._connected=!1,this.emitter=nD(),this.reconnectWaitFor=Sb,this._onError=r=>{var i,n,a;(i=this.eventSource)==null||i.removeEventListener("message",this._onMessage),(n=this.eventSource)==null||n.removeEventListener("error",this._onError),(a=this.eventSource)==null||a.removeEventListener("open",this._onConnected),this._scheduleReconnect()},this._onConnected=r=>{clearTimeout(this.scheduledReconnectHandle),this.reconnectWaitFor=Sb,this._connected=!0},this._onDisconnected=()=>{clearTimeout(this.scheduledReconnectHandle),this.reconnectWaitFor=Sb,this._connected=!1},this._onMessage=r=>{let i=r.data,n;try{n=JSON.parse(i)}catch(a){console.error("Error parsing webhook message",a)}if(n){let a=!1;this.userWebhook.parametersSchemas.forEach(({data:o})=>{n[o.name]!==void 0&&vIe(n[o.name],o.type)&&(this.result===void 0&&(this.result={}),this.result[o.name]=n[o.name],a=!0)}),a&&this.emitter.emit("message",{userWebhookId:this.id})}}}connect(){clearTimeout(this.scheduledReconnectHandle),this.userWebhook.url&&(this.eventSource=new EventSource(yIe+this.userWebhook.url),this.eventSource.addEventListener("message",this._onMessage),this.eventSource.addEventListener("error",this._onError),this.eventSource.addEventListener("open",this._onConnected))}disconnect(){var e,t,r,i;(e=this.eventSource)==null||e.removeEventListener("message",this._onMessage),(t=this.eventSource)==null||t.removeEventListener("error",this._onError),(r=this.eventSource)==null||r.removeEventListener("open",this._onConnected),(i=this.eventSource)==null||i.close(),this._onDisconnected(),clearTimeout(this.scheduledReconnectHandle)}_scheduleReconnect(){this.reconnectWaitFor*=2,this.reconnectWaitFor>pB&&(this.reconnectWaitFor=pB),clearTimeout(this.scheduledReconnectHandle),this.scheduledReconnectHandle=setTimeout(()=>{this.scheduledReconnectHandle=void 0,this.connect()},this.reconnectWaitFor)}update(e){this.userWebhook=e}dispose(){this._connected&&this.disconnect()}get connected(){return this._connected}on(e,t){this.emitter.on(e,t)}off(e,t){this.emitter.off(e,t)}getParametersKeys(){return this.userWebhook.parametersSchemas.map(e=>e.data.name)}getParameterValue(e){var t;if(this.getParametersKeys().includes(e)){if(this.result)return(t=this.result)==null?void 0:t[e];for(let r of this.userWebhook.parametersSchemas)if(r.data.name===e)return AM.defaultParameterValueByType(r.data.type)}}};function ZM(e){return"variable_"+e}var xIe=class extends oRe{constructor(e){super(),this.shared=e}create(e){return new wH(e,this.shared)}},aD=class{constructor(e,t={},r=!0,i=!1){if(this.data=e,this.needsJitter=r,this.enableLocalStorageForPersistentVariables=i,this.geometryCache=new fB(!0),this.geometryCache2=new fB(!1),this.imageHolderCache=new xIe(this),this.thisContext={scene:cIe,shared:this},this.deletedMaterial=new QM(ea.defaultTwoLayerData("phong"),this.thisContext,""),this.deletedImage=new Zc(EM.emptyImage,this),this.deletedVideo=new Zc(Lx.defaultVideo,this),this.materials={},this.images={},this.uiBuffers={},this.videos={},this.colors={},this.audios={},this.particles={},this.fonts={},this.variables={},this.userAPIs={},this.userWebhooks={},this.mouseProperty=null,this.raycastProperty=null,this.requestRender=()=>{this._requestRender&&this._requestRender()},t.images)for(let[n,a]of Object.entries(t.images))this.addImage(n,a);if(t.videos)for(let[n,a]of Object.entries(t.videos))this.addVideo(n,a);if(t.audios)for(let[n,a]of Object.entries(t.audios))this.addAudio(n,a);if(t.particles)for(let[n,a]of Object.entries(t.particles))this.addParticle(n,a);this.reset(e)}setRequestRender(e){this._requestRender=e}getImageLoadPromises(){return Object.values(this.images).map(e=>e.loadPromise)}setEntityOpContext(e){this.entityOpContext=e}reset(e,t=!1){this.data=e,this.resetLib(e.lib);for(let{id:r,data:i}of e.variables)this.addVariableHolder(r,i),t&&this.updateVariableHolder(r,i);for(let[r,i]of Object.entries(e.userAPIs))this.addUserAPI(r,i);for(let[r,i]of Object.entries(e.userWebhooks))this.addUserWebhook(r,i);for(let[r,i]of Object.entries(e.images))this.addImage(r,i);for(let[r,i]of Object.entries(e.videos))this.addVideo(r,i);for(let[r,i]of Object.entries(e.colors))this.addColor(r,i);for(let[r,i]of Object.entries(e.materials))this.addMaterial(r,i);for(let[r,i]of Object.entries(e.audios))this.addAudio(r,i);for(let[r,i]of Object.entries(e.particles))this.addParticle(r,i);for(let[r,i]of Object.entries(e.fonts))this.addFont(r,i)}addMaterial(e,t){if(this.materials[e]){let r=this.materials[e];r.reset(t,this.thisContext),r.dispose()}else{let r=new QM(t,this.thisContext,e);this.materials[e]=r}}deleteMaterial(e){this.materials[e]&&(this.materials[e].nodeMaterialDispose(),delete this.materials[e])}getMaterial(e){return this.materials[e]}getMaterialOrDeletedPlaceholder(e){return this.materials[e]??this.deletedMaterial}material(e){return typeof e=="string"?this.getMaterialOrDeletedPlaceholder(e):e==null?(console.error("material is undefined or null"),this.deletedMaterial):new iD(e,this.thisContext)}getMaterials(){return this.materials}addImage(e,t){return this.images[e]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),this.images[e].updateSrc(t.data),!0):(this.images[e]=new Zc(t,this),!1)}deleteImage(e){let t=this.images[e];t&&(t.dispose(),delete this.images[e])}getDefaultImage(){return this.images.image_0}getImage(e){return this.images[e]??this.deletedImage}image(e){return typeof e=="string"?this.getImage(e):this.imageHolderCache.load(e)}addUIBuffer(e,t){return this.uiBuffers[e]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),this.uiBuffers[e].updateSrc(t),!0):(this.uiBuffers[e]=new Zc(t,this),!1)}uiBuffer(e){return this.uiBuffers[e]}addVideo(e,t){return this.videos[e]?(this.videos[e].updateSrc(t.data),!0):(this.videos[e]=new Zc(t,this),!1)}deleteVideo(e){let t=this.videos[e];t&&(t.dispose(),delete this.videos[e])}getVideo(e){return this.videos[e]??this.deletedVideo}video(e){return typeof e=="string"?this.getVideo(e):this.imageHolderCache.load(e)}addColor(e,t){return this.colors[e]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),"a"in t?this.colors[e].setRGBA(t.r,t.g,t.b,t.a):this.colors[e].setRGBA(t.r,t.g,t.b,1),!0):("a"in t?this.colors[e]=new Jx(t.r,t.g,t.b,t.a):this.colors[e]=new Jx(t.r,t.g,t.b,1),!1)}updateColor(e,t){if(this.colors[e]){this.onColorOrImageUpdate&&this.onColorOrImageUpdate();let r=this.colors[e];return this.colors[e].r=t.r??r.r,this.colors[e].g=t.g??r.g,this.colors[e].b=t.b??r.b,this.colors[e].a=t.a??r.a,!0}return!1}deleteColor(e){this.colors[e]&&delete this.colors[e]}getColor(e){return this.colors[e]}color(e){let t;if(typeof e=="string"){let r=this.getColor(e);r?t=r:(console.warn("Tried to create color layer params with a color key that does not exist in the assets manager"),t=new ia(0,0,0,0))}else return"a"in e?new ia(e.r,e.g,e.b,e.a):new ia(e.r,e.g,e.b,1);return t}addAudio(e,t){this.audios[e]=t}getAudio(e){let t=this.audios[e];if(t instanceof ov)return t;{let r=new ov({src:t.data});return this.audios[e]=r,r}}addParticle(e,t){this.particles[e]=t}getParticle(e){return this.particles[e]}deleteParticle(e){this.particles[e]&&delete this.particles[e]}deleteAudio(e){let t=this.audios[e];t&&(t instanceof ov&&t.dispose(),delete this.audios[e])}addFont(e,t){this.fonts[e]=new oIe(t),this.fonts[e].loadingPromise.then(()=>this.requestRender())}getFont(e){return this.fonts[e]}deleteFont(e){this.fonts[e]&&delete this.fonts[e]}dispose(){Object.keys(this.materials).forEach(e=>this.deleteMaterial(e)),this._requestRender=void 0,Object.values(this.audios).forEach(e=>{e instanceof ov&&e.dispose()}),this.audios={},this.particles={},this.geometryCache.dispose(),this.geometryCache2.dispose()}addVariableHolder(e,t){if(this.variables[e]===void 0){let r=t.value;if(this.enableLocalStorageForPersistentVariables&&t.persistent){let i=localStorage.getItem(ZM(e));r=i!==null?JSON.parse(i):t.value}return this.variables[e]={value:r,locations:[],persistent:t.persistent},"dynamicVariableType"in t&&(this.variables[e].dynamicVariablePlayState="Playing",this.variables[e].dynamicVariableToggleIsForward=void 0),!0}return this.variables[e].value=t.value,!1}resetDynamicVariablePlayState(){for(let e in this.variables)this.variables[e].dynamicVariablePlayState!==void 0&&(this.variables[e].dynamicVariablePlayState="Playing",this.variables[e].dynamicVariableToggleIsForward=void 0)}updateVariableHolder(e,t){this.updateVariable(e,t.value)}updateVariable(e,t){if(this.variables[e]===void 0)return!1;this.variables[e].value=t,this.enableLocalStorageForPersistentVariables&&this.variables[e].persistent&&localStorage.setItem(ZM(e),JSON.stringify(t));let r=t;for(;typeof r=="string";)r=this.variables[r].value;let i=this.entityOpContext.scene;for(let n=this.variables[e].locations.length-1;n>=0;n--){let a=this.variables[e].locations[n];if(a[0]==="material"){let o=a[1],s=r,l={scene:i,shared:this},c=a.slice(2);i.traverseMaterial(u=>{let h=u.root??u;h.uuid===o&&h.onVariableUpdate(c,s,l)});let d=this.materials[o];d&&d.onVariableUpdate(c,s,l)}else{let o=i.find(a[0]);if(o===void 0){this.variables[e].locations.splice(n,1);continue}if(a[1]!=="geometry"&&a[1]!=="particles"){for(let s=1;s<a.length-1;s++)o=o[a[s]];a[1]==="rotation"?o[a[a.length-1]]=r*St.DEG2RAD:o[a[a.length-1]]=r}if(o=i.find(a[0]),o.type==="ParticleEmitter"&&o.updateVariableState(r,a),Cr.is(o)){if(a[1]==="position"||a[1]==="rotation"||a[1]==="scale")o.onVariableUpdate();else if(a[1]==="geometry"){let s=o;o.component&&(s=o.component);let l=s.dataPatched;s.chooseGeoemtryCache(this).forceDelete(l.geometry),s.createGeometryDelayed(this.entityOpContext),s.onVariableUpdate(!0),s.instances.forEach(c=>{let d=c.dataPatched;c.chooseGeoemtryCache(this).forceDelete(d.geometry),c.createGeometryDelayed(this.entityOpContext),c.onVariableUpdate(!0)})}}}}return this.requestRender(),!0}deleteVariable(e){this.variables[e]&&delete this.variables[e]}getVariable(e,t){var r,i,n;if(Array.isArray(e)){if(e[0]==="mouse")return((r=this.mouseProperty)==null?void 0:r[e[1]])??0;if(e[0]==="raycast")return((i=this.raycastProperty)==null?void 0:i[e[1]])??0;let a=this.entityOpContext.scene.find(e[0]);if(e[1]==="width"||e[1]==="height"||e[1]==="depth")return a.geometry.userData.parameters[e[1]];for(let o=1;o<e.length;o++)a=a[e[o]];return e[1]==="rotation"&&(a*=St.RAD2DEG),a}for(let a in this.variables){if(t===void 0)break;let o=this.variables[a],s=(n=o.locations)==null?void 0:n.findIndex(l=>gn.equal(l,t));s!==void 0&&s!==-1&&o.locations.splice(s,1)}if(typeof e=="string"){let a=e,o=e;do{if(o=a,this.variables[a]===void 0)break;let s=this.variables[a].value;t&&this.variables[o]!==void 0&&this.variables[o].locations.push(t),a=s}while(typeof a=="string");return a}else return e}getVariables(){return this.variables}getDynamicVariablePlayState(e){var t;return(t=this.variables[e])==null?void 0:t.dynamicVariablePlayState}setDynamicVariablePlayState(e,t){this.variables[e]!==void 0&&(this.variables[e].dynamicVariablePlayState=t)}getDynamicVariableToggleIsForward(e){var t;return(t=this.variables[e])==null?void 0:t.dynamicVariableToggleIsForward}setDynamicVariableToggleIsForward(e,t){this.variables[e]!==void 0&&(this.variables[e].dynamicVariableToggleIsForward=t)}resetLib(e){for(let[t,r]of Object.entries(e.images))this.addImage(t,r.asset);for(let[t,r]of Object.entries(e.audios))this.addAudio(t,r.asset);for(let[t,r]of Object.entries(e.particles))this.addParticle(t,r.asset);for(let[t,r]of Object.entries(e.colors))this.addColor(t,r.asset);for(let[t,r]of Object.entries(e.fonts))this.addFont(t,r.asset);for(let[t,r]of Object.entries(e.materials))this.addMaterial(t,r.asset);for(let[t,r]of Object.entries(e.videos))this.addVideo(t,r.asset);for(let[t,r]of Object.entries(e.variables))this.addVariableHolder(t,r.asset)}updateLibByOp(e,t){e.path[0]==="images"?e.path.length===1&&e.type===1?this.addImage(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteImage(e.id):e.path[0]==="videos"?e.path.length===1&&e.type===1?this.addVideo(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteVideo(e.id):e.path[0]==="audios"?e.path.length===1&&e.type===1?this.addAudio(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteAudio(e.id):e.path[0]==="particles"?e.path.length===1&&e.type===1?this.addParticle(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteParticle(e.id):e.path[0]==="colors"?e.path.length===1&&e.type===1?this.addColor(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteColor(e.id):e.path[0]==="materials"?e.path.length===1&&e.type===1?this.addMaterial(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteMaterial(e.id):e.path[0]==="fonts"?e.path.length===1&&e.type===1?this.addFont(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteFont(e.id):e.path[0]==="variables"?e.path.length===1&&e.type===1?this.addVariableHolder(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteVariable(e.id):e.path[0]==="components"&&t.updateByLibOp(e,this)}updateByOp(e,t,r){var i,n;if(this.data=t,e.path[0]==="images")e.path.length===2&&e.type===0?e.props.data&&this.getImage(e.path[1]).updateSrc(e.props.data):e.path.length===1&&e.type===1?this.addImage(e.id,e.data):e.path.length===1&&e.type===2&&this.deleteImage(e.id);else if(e.path[0]==="videos")e.path.length===2&&e.type===0?e.props.data&&this.getVideo(e.path[1]).updateSrc(e.props.data):e.path.length===1&&e.type===1?this.addVideo(e.id,e.data):e.path.length===1&&e.type===2&&this.deleteVideo(e.id);else if(e.path[0]==="audios")e.path.length===2&&e.type===0?e.props.data&&this.addAudio(e.path[1],t.audios[e.path[1]]):e.path.length===1&&e.type===1?this.addAudio(e.id,e.data):e.path.length===1&&e.type===2&&this.deleteAudio(e.id);else if(e.path[0]==="particles")e.path.length===2&&e.type===0?e.props.data&&this.addParticle(e.path[1],t.particles[e.path[1]]):e.path.length===1&&e.type===1?this.addParticle(e.id,e.data):e.path.length===1&&e.type===2&&this.deleteParticle(e.id);else if(e.path[0]==="colors")e.path.length===2&&e.type===0?this.updateColor(e.path[1],e.props):e.path.length===1&&e.type===1?this.addColor(e.id,e.data):e.path.length===1&&e.type===2&&this.deleteColor(e.id);else if(e.path[0]==="materials")e.path.length===1&&e.type===1?this.addMaterial(e.id,e.data):e.path.length===1&&e.type===2?this.deleteMaterial(e.id):e.path.length>1&&this.getMaterial(e.path[1]).updateByOp(zn.drop(e,2),t.materials[e.path[1]],{shared:this,scene:r});else if(e.path[0]==="fonts")e.path.length===2&&e.type===0?this.updateFont(e.path[1],e,r):e.path.length===1&&e.type===1?this.addFont(e.id,e.data):e.path.length===1&&e.type===2&&this.deleteFont(e.id);else if(e.path[0]==="variables")e.path.length===2&&e.type===0?"value"in e.props?this.updateVariable(e.path[1],e.props.value):"persistent"in e.props&&(this.variables[e.path[1]].persistent=e.props.persistent):e.path.length===1&&e.type===4?this.addVariableHolder(e.id,e.data):e.path.length===1&&e.type===5&&this.deleteVariable(e.id);else if(e.path[0]==="userAPIs"){if(e.path.length===1&&e.type===1)this.addUserAPI(e.id,e.data);else if(e.path.length===1&&e.type===2)this.deleteUserAPI(e.id);else if(typeof e.path[1]=="string"){let a=t.userAPIs[e.path[1]];a&&((i=this.getUserAPI(e.path[1]))==null||i.update(a,this))}}else if(e.path[0]==="userWebhooks"){if(e.path.length===1&&e.type===1)this.addUserWebhook(e.id,e.data);else if(e.path.length===1&&e.type===2)this.deleteUserWebhook(e.id);else if(typeof e.path[1]=="string"){let a=t.userWebhooks[e.path[1]];a&&((n=this.getUserWebhook(e.path[1]))==null||n.update(a))}}else e.path[0]==="lib"&&this.updateLibByOp(zn.drop(e,1),r)}updateFont(e,t,r){if(t.props.url){let i=this.getFont(e),n={...this.data.fonts[e],url:t.props.url};i.update(n),i.loadingPromise.then(()=>this.requestRender()),r.updateFont(e,this)}}addUserAPI(e,t){return this.userAPIs[e]?(this.userAPIs[e].update(t,this),!0):(this.userAPIs[e]=new dIe(e,t,this),!1)}getUserAPI(e){return this.userAPIs[e]}getUserAPIs(){return this.userAPIs}deleteUserAPI(e){let t=this.userAPIs[e];t&&(t.dispose(),delete this.userAPIs[e])}addUserWebhook(e,t){return this.userWebhooks[e]?(this.userWebhooks[e].update(t),!0):(this.userWebhooks[e]=new bIe(e,t),!1)}getUserWebhook(e){return this.userWebhooks[e]}getUserWebhooks(){return this.userWebhooks}deleteUserWebhook(e){let t=this.userWebhooks[e];t&&(t.dispose(),delete this.userWebhooks[e])}};new aD(_o.emptyData());var tm=class extends Ra{updateByPatchedOp(e,t,r){if(super.updateByPatchedOp(e,t,r),QTe(e.path,["materials"])!==null&&e.type===0&&Array.isArray(this.material))for(let[i,n]of Object.entries(e.props)){let a=r.shared.material(n);this.material[Number(i)]=a}else if(si(e.path,["material"])&&this.material instanceof Ad)"material"in t&&typeof t.material!="string"&&this.material.updateByOp(zn.drop(e,1),t.material,r);else if(si(e.path,["materials","*"])&&Array.isArray(this.material)){let i=e.path[1];if("materials"in t&&i<this.material.length){let n=t.materials[i];typeof n!="string"&&this.material[i].updateByOp(zn.drop(e,2),n,r)}}}get needsAO(){return this.material!==void 0?(Array.isArray(this.material)?this.material[0]:this.material).hasAO:!1}updateState(e,t){var i,n;super.updateState(e,t),e.castShadow!==void 0&&(this.castShadow=e.castShadow),e.receiveShadow!==void 0&&(this.receiveShadow=e.receiveShadow);let r=this.dataPatched;if(((i=e.geometry)==null?void 0:i.type)!=="NonParametricGeometry"&&"material"in e&&e.material!==void 0&&(this.disposeMaterial(),this.material=t.shared.material(e.material).getFlavor(r.flatShading,r.side,r.wireframe),t.scene.markNeedsUpdateRendererDirty()),(((n=e.geometry)==null?void 0:n.type)==="NonParametricGeometry"||"materials"in e)&&("materials"in e&&e.materials!==void 0?(this.disposeMaterial(),this.material=e.materials.map(a=>t.shared.material(a).getFlavor(r.flatShading,r.side,r.wireframe)),t.scene.markNeedsUpdateRendererDirty()):"material"in e&&e.material!==void 0&&(this.disposeMaterial(),this.material=[t.shared.material(e.material).getFlavor(r.flatShading,r.side,r.wireframe)],t.scene.markNeedsUpdateRendererDirty())),e.flatShading!==void 0||e.wireframe!==void 0||e.side!==void 0)if(Array.isArray(this.material))for(let a=0;a<this.material.length;a++)this.material[a]=this.material[a].getFlavor(r.flatShading,r.side,r.wireframe);else this.material=this.material.getFlavor(r.flatShading,r.side,r.wireframe)}disposeMaterial(){this.material&&DV(this.material).forEach(e=>{e instanceof Ad&&(e instanceof QM||e.nodeMaterialDispose())})}dispose(){this.disposeMaterial(),super.dispose()}},mB=new k,vB=new Kt,gB=new Kt,wIe=new k,yB=new it,ma=class extends tm{constructor(e,t,r){super(e,t),this.data=t,this.isSkinnedMesh=!1,this.localGeometry=void 0,t.bindMode&&t.bindMatrix&&(this.bindMode=t.bindMode,this.bindMatrix=new it().fromArray(t.bindMatrix),this.bindMatrixInverse=new it)}chooseGeoemtryCache(e){return e.geometryCache}markGeometryAsReachable(e){this.geometryCreateDeleyed instanceof Ot&&this.chooseGeoemtryCache(e).markAsReachable(this.dataPatched.geometry,this.geometryCreateDeleyed)}get geometry(){if(this.localGeometry!==void 0)return this.localGeometry;if(this.geometryCreateDeleyed instanceof aD){let e=this.geometryCreateDeleyed,t=this.chooseGeoemtryCache(e);this.geometryCreateDeleyed=t.get(this.dataPatched.geometry,e,this)}return this.geometryCreateDeleyed}set geometry(e){this.localGeometry=e}get is2DAndNoDepth(){let e=this.dataPatched.geometry;return Nx.is2DParametricMesh(e.type)&&e.depth===0}get is2DType(){return Nx.is2DParametricMesh(this.geometry.userData.type)}get isNonParametric(){return this.geometry.userData.type==="NonParametricGeometry"}updateByPatchedOp(e,t,r){super.updateByPatchedOp(e,t,r),si(e.path,["geometry"])&&this.updateByPatchedOpGeometry(zn.drop(e,1),t.geometry,r)}removeInteractionGeometry(e){var t;(t=this.localGeometry)==null||t.dispose(),this.localGeometry=void 0}updateGeometryInteractions(e,t){var i;this.invalidateDownstreamBooleanData();let r=this.data.geometry.type;if(r==="NonParametricGeometry"||r==="SubdivGeometry"){let n=e;if(this.localGeometry===void 0){let c={...this.data.geometry,...n};this.localGeometry=Cg(c,t,this.data.flatShading,this)}let a,o,s;n.scaleBaked?[a,o,s]=n.scaleBaked:{width:a,height:o,depth:s}=n;let l=this.localGeometry.userData;l.sxPrev!==void 0&&GM(this.localGeometry.attributes,a/l.sxPrev,o/l.syPrev,s/l.szPrev),l.sxPrev=a,l.syPrev=o,l.szPrev=s}else{let n={...this.data.geometry,...e};(i=this.localGeometry)==null||i.dispose(),this.localGeometry=Cg(n,t,this.data.flatShading,this)}}refreshAttachedClonersInteractions(){for(let e of this.attachedSurfaceCloners)e.update()}refreshAttachedCloners(e){for(let t of this.attachedSurfaceCloners)e.scene.addPendingUpdateCloner(t.object)}refreshAttachedPaths(e){for(let t of this.attachedPaths)e.scene.addPendingCommand(()=>t.updateShape())}createGeometryDelayed(e){this.geometryCreateDeleyed=e.shared,this.refreshAttachedCloners(e),this.refreshAttachedPaths(e)}updateByPatchedOpGeometry(e,t,r){var n;let i=!1;e.type===0&&e.path.length===0&&Object.keys(e.props).includes("scaleBaked")&&this.geometryCreateDeleyed instanceof _a&&this.chooseGeoemtryCache(r.shared).mutateIfUnique(this.geometryCreateDeleyed.data,t)===this.geometryCreateDeleyed&&(i=!0,this.geometryCreateDeleyed.mutateDirectlyScaleBaked(t,e.props.scaleBaked),this.refreshAttachedCloners(r),this.refreshAttachedPaths(r)),i||((n=r.scene)==null||n.markGeometryCacheDirty(),this.createGeometryDelayed(r)),this.resetBBoxNeedsUpdate(),this.invalidateDownstreamBooleanData()}updateGeometryOnStateUpdate(e,t){this.createGeometryDelayed(t)}updateState(e,t){e.geometry!==void 0&&this.updateGeometryOnStateUpdate(e.geometry,t),super.updateState(e,t)}updateGeometryGroupsIfNeeded(){var e;Array.isArray(this.material)&&this.geometry.groups.length===0&&this.geometry.addGroup(0,Math.max(((e=this.geometry.getIndex())==null?void 0:e.count)??0,this.geometry.getAttribute("position").count),0)}updateEntityBoxSize(e,t){let r=this.geometry.userData.parameters;this.is2DType?e.set(0,0,r.depth*.5):this.isNonParametric?(e.setScalar(0),this.geometry.boundingSphere&&e.copy(this.geometry.boundingSphere.center),t.set(r.width,r.height,r.depth??0).multiplyScalar(.5)):e.setScalar(0),t.set(r.width,r.height,r.depth??0).multiplyScalar(.5)}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"&&this.bindMatrixInverse.copy(this.bindMatrix).invert()}bind(e,t){this.skeleton=e,this.isSkinnedMesh=!0,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(e){let t=new Kt,r=this.geometry.attributes.skinWeight;for(let i=0,n=r.count;i<n;i++){t.fromBufferAttribute(r,i);let a=1/t.manhattanLength();a!==1/0?t.multiplyScalar(a):t.set(1,0,0,0),r.setXYZW(i,t.x,t.y,t.z,t.w)}}boneTransform(e,t){let r=this.skeleton;if(r===void 0)return;let i=this.geometry;vB.fromBufferAttribute(i.attributes.skinIndex,e),gB.fromBufferAttribute(i.attributes.skinWeight,e),mB.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let n=0;n<4;n++){let a=gB.getComponent(n);if(a!==0){let o=vB.getComponent(n);yB.multiplyMatrices(r.bones[o].matrixWorld,r.boneInverses[o]),t.addScaledVector(wIe.copy(mB).applyMatrix4(yB),a)}}return t.applyMatrix4(this.bindMatrixInverse)}};function SIe(e){var o,s;if(e.geometry.attributes.extrudeNormal||!e.geometry.attributes.position||!e.geometry.attributes.normal)return;let t=new Map,r=e.geometry.attributes,i=r.position.array,n=r.normal.array,a=new Float32Array(i.length);for(let l=0;l<i.length;l+=3){let c=`${i[l]}_${i[l+1]}_${i[l+2]}`,d=new k(n[l],n[l+1],n[l+2]);t.has(c)?(o=t.get(c))==null||o.normals.push(d):t.set(c,{normals:[d],result:new k})}t.forEach((l,c)=>{for(let d of l.normals)l.result.add(d);l.result.divideScalar(l.normals.length)});for(let l=0;l<i.length;l+=3){let c=`${i[l]}_${i[l+1]}_${i[l+2]}`,d=(s=t.get(c))==null?void 0:s.result;d&&(a[l]=d.x,a[l+1]=d.y,a[l+2]=d.z)}e.geometry.setAttribute("extrudeNormal",new yt(a,3))}function CIe(e){if(e.geometry.attributes.extrudeNormals||!e.geometry.attributes.position)return;let t=e.geometry.attributes.position.array,r=new Float32Array(t.length),i=new k;for(let n=0;n<t.length;n+=3)i.set(t[n],t[n+1],t[n+2]).normalize(),r[n]=i.x,r[n+1]=i.y,r[n+2]=i.z;e.geometry.setAttribute("extrudeNormal",new yt(r,3))}function oD(e){if(Array.isArray(e.material)){for(let t of e.material)if(t.getLayersOfType("outline").length===0)return}else if(!(e.material instanceof Ad)||e.material.getLayersOfType("outline").length===0)return;e instanceof ma&&e.is2DAndNoDepth?CIe(e):SIe(e)}function sD(e){if(!e.geometry.attributes.position)return;let t=e.geometry.attributes.position.array,r=new Float32Array(t.length),i=parseInt(e.uuid.replace(/\D/g,"")),n=[St.seededRandom(i),St.seededRandom(i+1e4),St.seededRandom(i+2e4)];for(let a=0;a<t.length;a++)r[a]=n[a%3];e.geometry.setAttribute("randomColor",new $t(r,3))}var Ts=new Zi,Bm=new k;function _Ie(e){let t=!1;return e.scene.objects.traverse((r,i)=>{i.type==="Mesh"&&i.geometry.type==="SubdivGeometry"&&(t=!0)}),t}var _g=class extends ma{constructor(e,t,r){super(e,t,r),this.data=t,this.hiddenMatrixOld=new it,this.smoothShading=!0,this.skipReactionUpdate=!1}chooseGeoemtryCache(e){return this.dataPatched.flatShading?e.geometryCache:e.geometryCache2}get subdivPointerNew(){return this.localGeometry!==void 0?this.subdivPointer:this.geometry.ensureSubdivPointer()}get originalGeometryNew(){return this.localGeometry!==void 0?this.originalGeometry:this.geometry.originalGeometry}get phongAngle(){return this.data.geometry.phongAngle??45}updateEntityBoxSize(e,t){let r=this.geometry.userData.parameters;e.copy(this.originalGeometryNew.boundingSphere.center),t.set(r.width,r.height,r.depth??0).multiplyScalar(.5)}createGeometryByControls(e){var a,o,s;if(this.skipReactionUpdate===!0)return;let t=(a=this.localGeometry)==null?void 0:a.uuid,{originalGeometry:r,subdividedGeometry:i,subdivPointer:n}=_a.build(e,this.subdivPointer,this.smoothShading,this.hasNonUniformScale?this.shearScale:void 0);this.subdivPointer=n,r!==void 0&&((o=this.originalGeometry)==null||o.dispose(),this.originalGeometry=r),i!==void 0&&((s=this.subdividedGeometry)==null||s.dispose(),this.subdividedGeometry=i??void 0),this.localGeometry=this.subdividedGeometry??this.originalGeometry,oD(this),sD(this),this.calcBoundingBox(),t&&(this.localGeometry.uuid=t)}updateState(e,t){if(super.updateState(e,t),e.flatShading!==void 0){let r=this.material;this.material=Array.isArray(r)?r.map(i=>i.getFlavor(!1,i.side,i.wireframe)):r.getFlavor(!1,r.side,r.wireframe),this.smoothShading=!e.flatShading,this.createGeometryDelayed(t)}}updateMesh(e=!1){_a.buildLevel(this.subdivPointer,!0,this.smoothShading?this.phongAngle:-1,this.originalGeometry,e&&this.hasNonUniformScale?this.shearScaleInv:void 0),this.subdividedGeometry&&_a.buildLevel(this.subdivPointer,!1,this.smoothShading?this.phongAngle:-1,this.subdividedGeometry,e&&this.hasNonUniformScale?this.shearScaleInv:void 0)}updateTopology(){this.originalGeometry.dispose(),this.originalGeometry=_a.buildLevel(this.subdivPointer,!0,this.smoothShading?this.phongAngle:-1),this.subdividedGeometry&&(this.subdividedGeometry.dispose(),this.subdividedGeometry=_a.buildLevel(this.subdivPointer,!1,this.smoothShading?this.phongAngle:-1)),this.localGeometry=this.subdividedGeometry??this.originalGeometry}raycast(e,t){let r=this.localGeometry;this.localGeometry=this.originalGeometryNew,Ra.prototype.raycast.call(this,e,t),this.localGeometry=r}activateSVDCompensation(){!this.hasNonUniformScale||(this.matrix.copy(this.matrixWorldRigid),this.hiddenMatrixOld.copy(this.hiddenMatrix),this.hiddenMatrix.copy(this.parent.matrixWorld).invert())}deactivateSVDCompensation(){!this.hasNonUniformScale||(this.updateMatrix(),this.hasNonUniformScale=void 0,this.hiddenMatrix.copy(this.hiddenMatrixOld))}calcBoundingBox(){let e=this.originalGeometry;e.boundingSphere===null&&(e.boundingSphere=new Za,this.subdividedGeometry&&(this.subdividedGeometry.boundingSphere=e.boundingSphere));let t=e.attributes.position,r=e.boundingSphere.center;Ts.setFromBufferAttribute(t),Ts.getCenter(r),e.boundingSphere.radius=r.distanceTo(Ts.max),isNaN(e.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this),Ts.getSize(Bm),this.hasNonUniformScale&&Bm.divide(this.scale);let i={width:Bm.x,height:Bm.y,depth:Bm.z};return this.geometry.userData.parameters=i,i}updateBoundingSphere(e){let t=this.originalGeometry;Ts.min.set(e[0],e[2],e[4]),Ts.max.set(e[1],e[3],e[5]),this.hasNonUniformScale&&(Ts.min.applyMatrix4(this.shearScaleInv),Ts.max.applyMatrix4(this.shearScaleInv)),t.boundingSphere===null&&(t.boundingSphere=new Za);let r=t.boundingSphere.center;Ts.getCenter(r),t.boundingSphere.radius=r.distanceTo(Ts.max)}freeSubdivPointer(){var e,t;this.subdivPointer&&(_a.freeSubdivPointer(this.subdivPointer),this.subdivPointer=0),this.localGeometry=void 0,(e=this.originalGeometry)==null||e.dispose(),(t=this.subdividedGeometry)==null||t.dispose()}dispose(){super.dispose(),this.freeSubdivPointer()}updateByPatchedOpGeometry(e,t,r){super.updateByPatchedOpGeometry(e,t,r),this.localGeometry&&this.createGeometryByControls(t)}},bB=-1,AIe=1,MIe={x:[1,0,0],"-x":[-1,0,0],y:[0,1,0],"-y":[0,-1,0],z:[0,0,1],"-z":[0,0,-1]},EIe={polygon_center:0,edge:1,vertex:2},Fy=(e,t)=>(r,i)=>!t||r===0||e===0?0:e*i/100,or=(e,t)=>{let r=Math.abs(t),i=r*-1;return(e-bB)*(r-i)/(AIe-bB)+i};function TIe(e){let t=[],r={};for(var i=0,n=e.length;i<n;i++){var a=JSON.stringify(e[i].pos.map(o=>Math.round(o*1e4)/1e4));r[a]||(t.push(e[i]),r[a]=!0)}return t}var PIe=new k,Ny=new k,DIe=new k,OIe=new k;function Qf(e,t){let r=DIe.fromArray(e),i=OIe.fromArray(t);Ny.copy(i).sub(r);let n=Ny.length();return Ny.normalize().multiplyScalar(n*.5),PIe.copy(r).add(Ny).toArray()}var Ao=new Zn,Uy=new k,e1=new k,mu=new k;function RIe(e){let t=[];for(let r=0;r<=e.index.count;r++)if(Uy.fromArray(e.index.array,r*3),Ao.setFromAttributeAndIndices(e.attributes.position,Uy.x,Uy.y,Uy.z),Ao.getNormal(e1),Ao.getMidpoint(mu),!(isNaN(mu.x)||isNaN(mu.y)||isNaN(mu.z))){let{a:i,b:n,c:a}=Ao,o=i.toArray(),s=n.toArray(),l=a.toArray(),c=i.distanceTo(n),d=n.distanceTo(a),u=a.distanceTo(i),h=Qf(o,s),f=Qf(s,l),p=Qf(l,o),v=[c,d,u],m=Math.max(...v),g=v.filter(x=>Math.round(x)===Math.round(m)).length>1,y=[],b=Ao.getMidpoint(mu).toArray();m===c&&!g&&(y=[f,p,p],b=h),m===d&&!g&&(y=[h,p,p],b=f),m===u&&!g&&(y=[h,f,f],b=p),g&&(y=[h,f,p]),t.push({vertices:[o,s,l],faceCenters:y,midpoint:b,norm:Ao.getNormal(e1).toArray()})}return t}function IIe(e){let t=[],{position:r}=e.attributes;for(let i=0;i<r.count;i++){Ao.setFromAttributeAndIndices(r,i*3,i*3+1,i*3+2),Ao.getNormal(e1),Ao.getMidpoint(mu);let n=Ao.a.toArray(),a=Ao.b.toArray(),o=Ao.c.toArray();t.push({vertices:[n,a,o],faceCenters:[Qf(n,a),Qf(a,o),Qf(o,n)],midpoint:mu.toArray(),norm:e1.toArray()})}return t}var zIe=4,kIe=.5,qC=e=>.5*(1-Math.cos(e*Math.PI)),LIe=class{constructor(){this.perlin=new Array(4096)}noise(e,t=0,r=0){if(this.perlin==null){this.perlin=new Array(4096);for(let m=0;m<4096;m++)this.perlin[m]=Math.random()}e<0&&(e=-e),t<0&&(t=-t),r<0&&(r=-r);let i=Math.floor(e),n=Math.floor(t),a=Math.floor(r),o=e-i,s=t-n,l=r-a,c,d,u=0,h=.5,f,p,v;for(let m=0;m<zIe;m++){let g=i+(n<<4)+(a<<8);c=qC(o),d=qC(s),f=this.perlin[g&4095],f+=c*(this.perlin[g+1&4095]-f),p=this.perlin[g+16&4095],p+=c*(this.perlin[g+16+1&4095]-p),f+=d*(p-f),g+=256,p=this.perlin[g&4095],p+=c*(this.perlin[g+1&4095]-p),v=this.perlin[g+16&4095],v+=c*(this.perlin[g+16+1&4095]-v),p+=d*(v-p),f+=qC(l)*(p-f),u+=f*h,h*=kIe,i<<=1,o*=2,n<<=1,s*=2,a<<=1,l*=2,o>=1&&(i++,o--),s>=1&&(n++,s--),l>=1&&(a++,l--)}return u}noiseSeed(e){let t=(()=>{let r,i;return{setSeed(n){i=r=(n??Math.random()*4294967296)>>>0},getSeed(){return r},rand(){return i=(1664525*i+1013904223)%4294967296,i/4294967296}}})();t.setSeed(e),this.perlin=new Array(4096);for(let r=0;r<4096;r++)this.perlin[r]=t.rand()}},BIe=LIe,xB=new k,wB=new it,SB=new jp;function CB(e){let t=!1;return e.scene.objects.traverse((r,i)=>{i.type==="Mesh"&&i.geometry.type==="TextGeometry"&&(t=!0)}),t}var lD=class extends ma{constructor(e,t,r){super(e,t,r),this.data=t}get textGeometry(){return this.geometry}get charWidths(){return this.textGeometry.charWidths}get charCoords(){return this.textGeometry.charCoords}get wrappedText(){return this.textGeometry.wrappedText}get font(){return this.textGeometry.font}get initialOffsetY(){var t;let e=this.dataPatched;return((t=this.font)==null?void 0:t.getLineInitialOffsetY(this.lineHeight,this.wrappedText.length,e.geometry.height,this.fontScale,e.geometry.verticalAlign))??0}get fontScale(){let e=this.dataPatched;return this.font?e.geometry.fontSize/this.font.unitsPerEm:1}get AD(){return Math.abs(this.ascender-this.descender)}get ascender(){var e;return(((e=this.font)==null?void 0:e.ascender)??1)*this.fontScale}get descender(){var e;return(((e=this.font)==null?void 0:e.descender)??1)*this.fontScale}get lineHeight(){let e=this.dataPatched;return e.geometry.fontSize*e.geometry.lineHeight}raycast(e,t){let{matrixWorld:r}=this;if(!(isNaN(e.ray.origin.x)||this.scale.x===0||this.scale.y===0||this.scale.z===0)&&(wB.copy(r).invert(),SB.copy(e.ray).applyMatrix4(wB),SB.intersectBox(this.singleBBox,xB))){let i=xB.applyMatrix4(r),n=e.ray.origin.distanceTo(i);t.push({distance:n,point:i.clone(),object:this})}}},xa=1e-4,Ps,IH,zH,kH,_B=new k,AB=new k;H8.then(e=>{Ps=e,IH=[Ps.get_face_center,Ps.get_edge_midpoint,Ps.get_vertex_position],zH=[Ps.get_face_normal,Ps.get_edge_normal,Ps.get_vertex_normal],kH=[Ps.face_count,Ps.edge_count,Ps.vertex_count]});var FIe=new it,NIe=new it,Oc=new k,jy=new k,Fm=new k,YC=new k,UIe=new k,jIe=new k,_l=new BIe,ns=class extends VP(Yr){constructor(e,t){super(),this.parameters=t,this.objectForSample=void 0,this._pendingMediaLoad=!1,this.object=e}resetOnMove(){this.removeFromParent(),this.parent=null}expandClones(e){if(this.parent===null)this.updateState(this.parameters,e);else for(let t of this.children)t instanceof pa&&t.expand()}invalidateTransform(e){this.matrixWorldNeedsUpdate=!0,this.traverse(t=>{t instanceof pa&&t.object===e&&(t.matrixWorldNeedsUpdate=!0)})}onObjUpdateMatrix(){this.parameters.type!=="toObject"&&(this.matrixWorldNeedsUpdate=!0)}update(){switch(this._updateCount(),this.parameters.type){case"radial":this._updateRadial(this.parameters);break;case"linear":this._updateLinear(this.parameters);break;case"grid":this._updateGrid(this.parameters);break;case"toObject":this._updateToObject(this.parameters)}for(let e of this.children)e.updateMatrix(),e.hasNonUniformScale&&(e.updateMatrixWorld(),e.updateMatrixWorldSVD())}_updateCount(e){let t;if(e!==void 0?t=e:t=this.parameters.type==="grid"?Math.round(this.parameters.grid.count[0])*Math.round(this.parameters.grid.count[1])*Math.round(this.parameters.grid.count[2]):this.parameters.count,this.parameters.type==="toObject"&&!this.parameters.toObject.object&&(t=0),this.parameters.type==="toObject"&&this.objectForSample){for(let i=0,n=this.children.length;i<n;++i)this.remove(this.children[0]);let r=this.children;if(r.length===t)return;if(r.length<t)for(let i=0,n=t-r.length;i<n;++i){let a=new pa(this.object);a.expand(),this.add(a)}else for(let i=0,n=r.length-t;i<n;++i)this.remove(r[i])}else{if(this.children.length===t)return;if(this.children.length<t)for(let r=0,i=t-this.children.length;r<i;++r){let n=new pa(this.object);n.expand(),this.add(n)}else for(let r=0,i=this.children.length-t;r<i;++r)this.remove(this.children[0])}}_updateRadial(e){let t=e.radial,r=t.start*St.DEG2RAD,i=t.end*St.DEG2RAD,n=r-i,a=new vn(t.rotation[0],t.rotation[1],t.rotation[2]),o;switch(t.axis){case"z":o=new k(0,0,1);break;case"y":o=new k(0,1,0);break;default:case"x":o=new k(1,0,0);break}let s=e.randomnessObject??td.defaultData([1,1,1]).randomnessObject,l=s.noiseType==="perlin";_l.noiseSeed(s.seed);let c=MC((0,Rm.default)(s.seed)),d=Fy(s.strength,this.parameters.randomness);for(let[u,h]of this.children.entries()){let f=u*(s.freqScale/10)+s.movement,p=l?_l.noise(f):c(f,f),v=u+1;h.scale.x=t.scale[0]+d(v,or(p,s.scale[0]))||xa,h.scale.y=t.scale[1]+d(v,or(p,s.scale[1]))||xa,h.scale.z=t.scale[2]+d(v,or(p,s.scale[2]))||xa,h.position.setScalar(0);let m=n/e.count*u-r;switch(t.axis){case"x":h.rotation.set(0,m,0);break;case"y":h.rotation.set(0,0,m);break;case"z":h.rotation.set(m,0,0);break}h.translateOnAxis(o,t.radius),h.position.x+=t.position[0]+d(v,or(p,s.position[0])),h.position.y+=t.position[1]+d(v,or(p,s.position[1])),h.position.z+=t.position[2]+d(v,or(p,s.position[2]));let g=d(v,or(p,s.rotation[0])),y=d(v,or(p,s.rotation[1])),b=d(v,or(p,s.rotation[2]));t.alignment===!0?(h.rotation.x+=a.x+g,h.rotation.y+=a.y+y,h.rotation.z+=a.z+b):h.rotation.set(a.x+g,a.y+y,a.z+b)}}_updateLinear(e){if(e.type!=="linear")throw new Error;let t=e.linear,r=new vn(t.rotation[0],t.rotation[1],t.rotation[2]),i=e.randomnessObject??td.defaultData([1,1,1]).randomnessObject,n=i.noiseType==="perlin";_l.noiseSeed(i.seed);let a=MC((0,Rm.default)(i.seed)),o=Fy(i.strength,this.parameters.randomness);for(let[s,l]of this.children.entries()){let c=s*(i.freqScale/10)+i.movement,d=n?_l.noise(c):a(c,c),u=s+1,h=o(u,or(d,i.rotation[0])),f=o(u,or(d,i.rotation[1])),p=o(u,or(d,i.rotation[2]));l.scale.x=1+(t.scale[0]-1)*s+o(u,or(d,i.scale[0]))||xa,l.scale.y=1+(t.scale[1]-1)*s+o(u,or(d,i.scale[1]))||xa,l.scale.z=1+(t.scale[2]-1)*s+o(u,or(d,i.scale[2]))||xa,l.rotation.x=r.x*s+h,l.rotation.y=r.y*s+f,l.rotation.z=r.z*s+p,l.position.x=t.position[0]*s+o(u,or(d,i.position[0])),l.position.y=t.position[1]*s+o(u,or(d,i.position[1])),l.position.z=t.position[2]*s+o(u,or(d,i.position[2]))}}_updateGrid(e){let t=0,r=e.grid,i=e.randomnessObject??td.defaultData([1,1,1]).randomnessObject,n=Fy(i.strength,this.parameters.randomness),a=i.noiseType==="perlin";_l.noiseSeed(i.seed);let o=IDe((0,Rm.default)(i.seed));if(r.useCenter===!0){let s={x:r.count[0]%2===0?2:1,y:r.count[1]%2===0?2:1,z:r.count[2]%2===0?2:1},l=new k(r.size[0]*(r.count[0]-s.x)*.5,r.size[1]*(r.count[1]-s.y)*.5,r.size[2]*(r.count[2]-s.z)*.5);for(let c=0;c<r.count[0];c++)for(let d=0;d<r.count[1];d++)for(let u=0;u<r.count[2];u++){let h=[(c+1)*(i.freqScale/10)+i.movement,(d+1)*(i.freqScale/10)+i.movement,(u+1)*(i.freqScale/10)+i.movement],f=a?_l.noise(...h):o(...h),p=this.children[t++];p.scale.x=1+n(t,or(f,i.scale[0]))||xa,p.scale.y=1+n(t,or(f,i.scale[1]))||xa,p.scale.z=1+n(t,or(f,i.scale[2]))||xa;let v=n(t,or(f,i.rotation[0])),m=n(t,or(f,i.rotation[1])),g=n(t,or(f,i.rotation[2]));p.rotation.set(v,m,g),p.position.x=r.size[0]*c-l.x+n(t,or(f,i.position[0])),p.position.y=r.size[1]*d-l.y+n(t,or(f,i.position[1])),p.position.z=r.size[2]*u-l.z+n(t,or(f,i.position[2]))}}else for(let s=0;s<r.count[0];s++)for(let l=0;l<r.count[1];l++)for(let c=0;c<r.count[2];c++){let d=[(s+1)*(i.freqScale/10)+i.movement,(l+1)*(i.freqScale/10)+i.movement,(c+1)*(i.freqScale/10)+i.movement],u=a?_l.noise(...d):o(...d),h=this.children[t++];h.scale.x=1+n(t,or(u,i.scale[0]))||xa,h.scale.y=1+n(t,or(u,i.scale[1]))||xa,h.scale.z=1+n(t,or(u,i.scale[2]))||xa;let f=n(t,or(u,i.rotation[0])),p=n(t,or(u,i.rotation[1])),v=n(t,or(u,i.rotation[2]));h.rotation.set(f,p,v),h.position.x=r.size[0]*s+n(t,or(u,i.position[0])),h.position.y=-r.size[1]*l+n(t,or(u,i.position[1])),h.position.z=-r.size[2]*c+n(t,or(u,i.position[2]))}}_updateToObject(e){var v;if(e.type!=="toObject")throw new Error;let{toObject:t}=e,r=new vn(t.rotation[0],t.rotation[1],t.rotation[2]),i=e.randomnessObject??td.defaultData([1,1,1]).randomnessObject,n=i.noiseType==="perlin";_l.noiseSeed(i.seed);let a=MC((0,Rm.default)(i.seed)),o=Fy(i.strength,this.parameters.randomness);if(!t.object){for(let[,m]of this.children.entries())m.position.set(0,0,0),m.scale.setScalar(1),m.rotation.set(0,0,0);this.objectForSample=void 0;return}if(!this.objectForSample)return;if(this.objectForSample instanceof lD)if(!((v=this.objectForSample.font)!=null&&v.isLoaded)||this.objectForSample.geometry.attributes.position===void 0){this._pendingMediaLoad=!0;return}else this._pendingMediaLoad=!1;if(this.objectForSample.geometry===void 0&&this.objectForSample.isAncestorOf(this.object.uuid)){console.warn(`Oh no! The object "${this.object.name}" (${this.object.uuid}) seem to be a child/descendant of the object it's being cloned to. Please re-parent it so that they are siblings instead.`);return}let s=this.getSubdivData(),l=[],c=m=>{let g=m.length,y=m.map(S=>S[0]).reduce((S,w)=>S+w,0),b=m.map(S=>S[1]).reduce((S,w)=>S+w,0),x=m.map(S=>S[2]).reduce((S,w)=>S+w,0);return[y/g,b/g,x/g]},d=m=>Math.round(m*1e6)/1e6;s.forEach(m=>{let g=s.filter(y=>d(m.pos[0])===d(y.pos[0])&&d(m.pos[1])===d(y.pos[1])&&d(m.pos[2])===d(y.pos[2]));g.length>1?l.push({pos:m.pos,norm:c(g.map(y=>y.norm))}):l.push(m)});let u=TIe(l);if(u.length>0){let m=Math.round(u.length*t.count/100);this._updateCount(m)}else{let m=this.objectForSample.geometry.getAttribute("position");if(!m||isNaN(m.count)||m.count===0){console.warn(`Oh no! The object "${this.object.name}" (${this.object.uuid}) cannot be cloned on the surface of "${this.objectForSample.name}" (${this.objectForSample.uuid}) because the latter does not have a valid geometry.`);return}}this.objectForSample.updateMatrixWorld();let h=new zDe(this.objectForSample).build(),f=MIe[t.axis],p=this.children;h.setRandomGenerator((0,Rm.default)(this.object.uuid+t.seed));for(let[m,g]of p.entries()){let y=m*(i.freqScale/10)+i.movement,b=n?_l.noise(y):a(y,y),x=m+1,S=o(x,or(b,i.rotation[0])),w=o(x,or(b,i.rotation[1])),_=o(x,or(b,i.rotation[2]));t.spreadType==="random"?h.sample(Fm,YC):(u.length&&(Fm.fromArray(u[m].pos),YC.fromArray(u[m].norm)),this.objectForSample instanceof _g&&Fm.applyMatrix4(FIe.copy(this.objectForSample.matrixWorld).invert())),Fm.applyMatrix4(this.object.hiddenMatrix.clone().invert()),g.position.copy(Fm),Oc.fromArray(f);let C=t.align==="normal"?YC:this.object.getWorldDirection(jIe),A=jy.fromArray(t.position);jy.x+=o(x,or(b,i.position[0])),jy.y+=o(x,or(b,i.position[1])),jy.z+=o(x,or(b,i.position[2]));let M=Math.acos(C.dot(Oc)),P=UIe.crossVectors(Oc,C).normalize(),T=NIe.makeRotationAxis(P,M),R=C.clone().cross(this.object.up).normalize(),z=R.clone().cross(C).normalize(),F=new it().makeBasis(R,C,z),H=new k(Oc.y,Oc.z,Oc.x).normalize(),N=H.clone().cross(Oc).normalize(),U=new it().makeBasis(H,Oc,N).invert(),ie=new it().multiplyMatrices(F,U);g.rotation.setFromRotationMatrix(ie),A.applyMatrix4(T),g.position.add(A),g.rotation.x=g.rotation.x+r.x+S,g.rotation.y=g.rotation.y+r.y+w,g.rotation.z=g.rotation.z+r.z+_,g.scale.setScalar(1),g.scale.x=g.scale.x+t.scale[0]+o(x,or(b,i.scale[0]))||xa,g.scale.y=g.scale.y+t.scale[1]+o(x,or(b,i.scale[1]))||xa,g.scale.z=g.scale.z+t.scale[2]+o(x,or(b,i.scale[2]))||xa,g.scale.multiply(this.object.scale),g.hiddenMatrix=this.object.hiddenMatrix}}getSubdivData(){if(!this.objectForSample)return[];let e=this.parameters.toObject.spreadType;if(e==="random")return[];if(this.objectForSample instanceof _g){let t=this.objectForSample,r=EIe[e],i=kH[r],n=IH[r],a=zH[r],o=[],s=i(t.subdivPointerNew);for(let l=0;l<=s-1;l++){let c=n(t.subdivPointerNew,l),d=a(t.subdivPointerNew,l);_B.fromArray(c).applyMatrix4(t.matrixWorld),AB.fromArray(d),o.push({pos:_B.toArray(),norm:AB.toArray()})}return o}else return(this.objectForSample.geometry.index?RIe(this.objectForSample.geometry):IIe(this.objectForSample.geometry)).map((t,r)=>e==="polygon_center"?{pos:t.midpoint,norm:t.norm}:e==="vertex"?[{pos:t.vertices[0],norm:t.norm},{pos:t.vertices[1],norm:t.norm},{pos:t.vertices[2],norm:t.norm}]:e==="edge"?[{pos:t.faceCenters[0],norm:t.norm},{pos:t.faceCenters[1],norm:t.norm},{pos:t.faceCenters[2],norm:t.norm}]:[]).flat()}updateState(e,t){var r;if(this.parameters=ow(e),this.parameters.type!=="toObject")(this.parent===null||this.parent!==this.object)&&(this.removeFromParent(),(r=this.object.parent)==null||r.add(this),this.matrix=this.object.matrix,this.hiddenMatrix=this.object.hiddenMatrix,this.matrixWorldNeedsUpdate=!0,this.matrixAutoUpdate=!1);else if(this.parent===null||this.parent.uuid!==this.parameters.toObject.object){this.removeFromParent();let i=t.find(this.parameters.toObject.object);i instanceof Ra?this.objectForSample=i:this.objectForSample=void 0,this.matrix=new it,this.hiddenMatrix=new it,this.matrixWorldNeedsUpdate=!0,this.matrixAutoUpdate=!1,i&&i.add(this)}this.update()}get pendingMediaLoad(){return this._pendingMediaLoad}},e0=e=>{var t;return t=class extends e{},t.geometryHelper=new fs(30,30,30),t},Vy=new jp,XC=new Za,MB=new it,t0=(e,t,r,i,n=!1,a=e)=>{let o=t,s=a.matrixWorld;if(o.boundingSphere===null&&o.computeBoundingSphere(),XC.copy(o.boundingSphere),XC.applyMatrix4(s),r.ray.intersectsSphere(XC)===!1||(MB.copy(s).invert(),Vy.copy(r.ray).applyMatrix4(MB),o.boundingBox!==null&&Vy.intersectsBox(o.boundingBox)===!1))return;let l,c,d,u,h=o.index,f=o.attributes.position,p=o.drawRange,v,m;if(n===!1){let y=Math.max(0,p.start),b=Math.min(h.count,p.start+p.count);for(v=y,m=b;v<m;v+=3)if(c=h.getX(v),d=h.getX(v+1),u=h.getX(v+2),l=g(e,r,Vy,f,c,d,u),l){l.faceIndex=Math.floor(v/3),i.push(l);return}}else{let y=o.attributes.position,b=new k,x=new k,S=new k,w=new k,_=2,C=1/((a.scale.x+a.scale.y+a.scale.z)/3),A=C*C,M=Math.max(0,p.start),P=Math.min(y.count,p.start+p.count);for(let T=M,R=P-1;T<R;T+=_){if(b.fromBufferAttribute(y,T),x.fromBufferAttribute(y,T+1),Vy.distanceSqToSegment(b,x,w,S)>A)continue;w.applyMatrix4(a.matrixWorld);let z=r.ray.origin.distanceTo(w);z<r.near||z>r.far||i.push({distance:z,point:S.clone().applyMatrix4(a.matrixWorld),object:e})}}function g(y,b,x,S,w,_,C){let A=new k,M=new k,P=new k,T=new k,R=new k;if(A.fromBufferAttribute(S,w),M.fromBufferAttribute(S,_),P.fromBufferAttribute(S,C),x.intersectTriangle(A,M,P,!1,T)===null)return null;R.copy(T),R.applyMatrix4(y.matrixWorld);let z=b.ray.origin.distanceTo(R);return z<b.near||z>b.far?null:{faceIndex:1,distance:z,point:R.clone(),object:y}}},Hy=new k,go=new xh,VIe=class extends Gg{constructor(e){let t=new Ot,r=new Ud({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],n=[],a={},o=new Lt(15711266),s=new Lt(15711266),l=new Lt(2857471);c("n1","n2",o),c("n2","n4",o),c("n4","n3",o),c("n3","n1",o),c("f1","f2",o),c("f2","f4",o),c("f4","f3",o),c("f3","f1",o),c("n1","f1",o),c("n2","f2",o),c("n3","f3",o),c("n4","f4",o),c("p","n1",s),c("p","n2",s),c("p","n3",s),c("p","n4",s),c("u1","u2",l),c("u2","u3",l),c("u3","u1",l);function c(u,h,f){d(u,f),d(h,f)}function d(u,h){i.push(0,0,0),n.push(h.r,h.g,h.b),a[u]===void 0&&(a[u]=[]),a[u].push(i.length/3-1)}t.setAttribute("position",new yt(i,3)),t.setAttribute("color",new yt(n,3)),super(t,r),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update()}update(){let e=this.geometry,t=this.pointMap;go.projectionMatrixInverse.elements=[.5112609807824982,-0,-0,-0,-0,.41421356237309503,-0,-0,-0,-0,-0,-.099999,-0,-0,-1.0000000000000002,.100001];let r=1,i=1,n=.8;$o("n1",t,e,go,-r,-i,n),$o("n2",t,e,go,r,-i,n),$o("n3",t,e,go,-r,i,n),$o("n4",t,e,go,r,i,n);let a=n;$o("f1",t,e,go,-r,-i,a),$o("f2",t,e,go,r,-i,a),$o("f3",t,e,go,-r,i,a),$o("f4",t,e,go,r,i,a);let o=a,s=.5;$o("u1",t,e,go,r*.7*s,i*1.1,o),$o("u2",t,e,go,-r*.7*s,i*1.1,o),$o("u3",t,e,go,0,i*(1.1+.9*s),o),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}};function $o(e,t,r,i,n,a,o){Hy.set(n,a,o).unproject(i);let s=t[e];if(s!==void 0){let l=r.getAttribute("position");for(let c=0,d=s.length;c<d;c++)l.setXYZ(s[c],Hy.x,Hy.y,Hy.z)}}var HIe=class extends e0(VIe){constructor(e){super(e),this.object=e,this.object=e,this.name=`CombinedCameraHelper: ${e.uuid}`}updateMatrixWorld(e){super.updateMatrixWorld(e),this.updateTarget()}updateTarget(){let e=this.object.getTarget();this.updateWorldMatrix(!0,!1),this.worldToLocal(e)}raycast(e,t){t0(this.object,this.geometry,e,t,!0)}},JM;(e=>e.is=t=>"objectHelper"in t)(JM||(JM={}));var rm=(e,t)=>class extends HP(e){constructor(){super(...arguments),this.objectHelper=new t(this),this.gizmos={}}get geometryHelper(){return t.geometryHelper}raycast(r,i){this.objectHelper.raycast(r,i)}showGizmos(){for(let r in this.gizmos){let i=this.gizmos[r];i instanceof xx&&(i.visible=!0)}}updateEntityBoxSize(r,i){this.objectHelper.visible&&this.geometryHelper instanceof fs?(r.setScalar(0),i.set(this.geometryHelper.parameters.width,this.geometryHelper.parameters.height,this.geometryHelper.parameters.height).multiplyScalar(.5)):super.updateEntityBoxSize(r,i)}hideGizmos(){for(let r in this.gizmos){let i=this.gizmos[r];i instanceof xx&&(i.visible=!1)}}},Wy=790,lf=new k,KC=new k,QC=new Xt,ZC=new k,Nm=new k,JC=new k,va=class extends rm(xh,HIe){constructor(e="",t={...mg.defaultData,name:""}){super(),this._cameraType="OrthographicCamera",this.targetOffset=Sp.DefaultTargetOffset,this.isUpVectorFlipped=!1,this.angleOffsetFromUp=0,this.wasMovedByUser=!1,this.wasMovedBySwitchCameraAction=!1,this.super_Entity(e,t),this.previousProjectionMatrix=new it,this.matrixAutoUpdate=!0,this.width=window.innerWidth,this.height=window.innerHeight;let r=this.width,i=this.height;this.orthoCamera=new K1(r*-.5,r*.5,i*.5,i*-.5,-5e4,1e4),this.perspCamera=new da(45,r/i,50,1e4),this.left=this.orthoCamera.left,this.right=this.orthoCamera.right,this.top=this.orthoCamera.top,this.bottom=this.orthoCamera.bottom,this.far=this.orthoCamera.far,this.view=this.orthoCamera.view,this.aspect=this.perspCamera.aspect,this.focus=this.perspCamera.focus,this.filmGauge=this.perspCamera.filmGauge,this.filmOffset=this.perspCamera.filmOffset,this.objectHelper.update()}get isPerspectiveCamera(){return this.cameraType==="PerspectiveCamera"}get isOrthographicCamera(){return!this.isPerspectiveCamera}get cameraType(){return this._cameraType}set fov(e){this.perspCamera.fov=e}get fov(){return this.perspCamera.fov}setNear(e,t){e==="PerspectiveCamera"?this.perspCamera.near=t:this.orthoCamera.near=t}setZoom(e,t){t>=0&&(e==="PerspectiveCamera"?this.perspCamera.zoom=t:this.orthoCamera.zoom=t)}set cameraType(e){e==="PerspectiveCamera"?this.toPerspective():e==="OrthographicCamera"&&this.toOrthographic()}get near(){return this._cameraType==="PerspectiveCamera"?this.perspCamera.near:this.orthoCamera.near}set near(e){this._cameraType==="PerspectiveCamera"?this.perspCamera.near=e:this.orthoCamera.near=e}get zoom(){return this._cameraType==="PerspectiveCamera"?this.perspCamera.zoom:this.orthoCamera.zoom}set zoom(e){e>=0&&(this._cameraType==="PerspectiveCamera"?this.perspCamera.zoom=e:this.orthoCamera.zoom=e)}lookAt(e,t,r){typeof e=="number"&&(e=new k(e,t,r)),super.lookAt(e),this.getWorldPosition(lf),this.targetOffset=lf.distanceTo(e)}getTarget(e=new k){return this.getWorldDirection(KC),this.getWorldPosition(lf),KC.multiplyScalar(this.targetOffset),e.copy(lf).add(KC),e}getDistanceToTarget(){let e=this.getTarget();return this.getWorldPosition(lf),lf.distanceTo(e)}updateUp(){this.getWorldQuaternion(QC),ZC.set(0,0,1).applyQuaternion(QC),Nm.copy(Yr.DEFAULT_UP),this.isUpVectorFlipped&&Nm.negate(),Nm.applyQuaternion(QC),JC.copy(Yr.DEFAULT_UP).projectOnPlane(ZC),this.angleOffsetFromUp=JC.angleTo(Nm),this.angleOffsetFromUp*=JC.cross(Nm).dot(ZC)>=0?1:-1}updateTransformState(e,t){let r=super.updateTransformState(e,t);return e.isUpVectorFlipped!==void 0&&(this.isUpVectorFlipped=e.isUpVectorFlipped),this.updateUp(),r}getViewFrontToObject(e){let t=e.getWorldPosition(new k),r=e.getWorldDirection(new k).multiplyScalar(this.targetOffset);return{position:t.clone().add(r),target:t}}getViewToTarget(e){let t=this.getWorldDirection(new k).multiplyScalar(this.targetOffset);return{position:e.clone().sub(t),target:e}}getViewToObject(e){let t=new k;return e.getWorldPosition(t),this.getViewToTarget(t)}setViewplaneSize(e,t,r=!1){if(this.aspect=e/t,r){let i=e>t?this.aspect:1,n=e>t?1:this.aspect;this.left=-Wy*.5*i,this.right=Wy*.5*i,this.top=Wy*.5*(1/n),this.bottom=-Wy*.5*(1/n)}else this.left=-e*.5,this.right=e*.5,this.top=t*.5,this.bottom=-t*.5;this.updateProjectionMatrix()}copyViewPlaneSize(e){this.aspect=e.aspect,this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.updateProjectionMatrix()}toOrthographic(){this.orthoCamera.left=this.left,this.orthoCamera.right=this.right,this.orthoCamera.top=this.top,this.orthoCamera.bottom=this.bottom,this.orthoCamera.view=this.view,this.orthoCamera.far=this.far,this.orthoCamera.updateProjectionMatrix(),this.projectionMatrix=this.orthoCamera.projectionMatrix,this.projectionMatrixInverse=this.orthoCamera.projectionMatrixInverse,this._cameraType="OrthographicCamera",this.objectHelper&&this.objectHelper.update()}toPerspective(){this.perspCamera.aspect=this.aspect,this.perspCamera.fov=this.fov,this.perspCamera.view=this.view,this.perspCamera.far=this.far,this.perspCamera.updateProjectionMatrix(),this.projectionMatrix=this.perspCamera.projectionMatrix,this.projectionMatrixInverse=this.perspCamera.projectionMatrixInverse,this._cameraType="PerspectiveCamera",this.objectHelper&&this.objectHelper.update()}setFocalLength(e){this.perspCamera.setFocalLength(e),this.toPerspective()}getFocalLength(){return this.perspCamera.getFocalLength()}getEffectiveFOV(){return this.perspCamera.getEffectiveFOV()}getFilmWidth(){return this.perspCamera.getFilmWidth()}getFilmHeight(){return this.perspCamera.getFilmHeight()}setViewOffset(e,t,r,i,n,a){this._cameraType==="PerspectiveCamera"?this.perspCamera.setViewOffset(e,t,r,i,n,a):this.orthoCamera.setViewOffset(e,t,r,i,n,a)}clearViewOffset(){this._cameraType==="PerspectiveCamera"?(this.perspCamera.clearViewOffset(),this.toPerspective()):(this.orthoCamera.clearViewOffset(),this.toOrthographic())}copyHistory(){this.previousProjectionMatrix&&this.previousProjectionMatrix.copy(this.projectionMatrix)}updateProjectionMatrix(){this._cameraType==="PerspectiveCamera"?this.toPerspective():this._cameraType==="OrthographicCamera"&&this.toOrthographic()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}copy(e,t){return super.copy(e,t),this.parent=e.parent,this.orthoCamera.copy(e.orthoCamera),this.perspCamera.copy(e.perspCamera),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.far=e.far,this.view=e.view===null?null:Object.assign({},e.view),this._cameraType=e._cameraType,this.aspect=e.aspect,this.fov=e.fov,this.focus=e.focus,this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this.targetOffset=e.targetOffset,this.updateProjectionMatrix(),this}toCameraState(e=[]){let t={type:this.cameraType,far:this.far,orthographic:{near:this.orthoCamera.near,zoom:this.orthoCamera.zoom},perspective:{near:this.perspCamera.near,fov:this.perspCamera.fov,zoom:this.perspCamera.zoom},up:this.up.toArray(),targetOffset:this.targetOffset,isUpVectorFlipped:this.isUpVectorFlipped};return $A(t,e)}updateCameraSubtype(e,t){let r=e==="perspective"?"PerspectiveCamera":"OrthographicCamera";t.zoom!==void 0&&this.setZoom(r,t.zoom),t.near!==void 0&&this.setNear(r,t.near),t.fov!==void 0&&r==="PerspectiveCamera"&&(this.fov=t.fov)}updateState(e,t){this.updateCameraState(e,t)}updateCameraState(e,t){this.updateState_Entity(e,t),e.far!==void 0&&(this.far=e.far),e.orthographic!==void 0&&this.updateCameraSubtype("orthographic",e.orthographic),e.perspective!==void 0&&this.updateCameraSubtype("perspective",e.perspective),e.type!==void 0&&(this.cameraType=e.type),e.up!==void 0&&this.up.fromArray(e.up),e.targetOffset!==void 0&&(this.targetOffset=e.targetOffset),e.isUpVectorFlipped!==void 0&&(this.isUpVectorFlipped=e.isUpVectorFlipped),this.updateProjectionMatrix()}updateByPatchedOp(e,t,r){super.updateByPatchedOp(e,t,r),e.path.length===1&&e.type===0&&this.updateCameraSubtype(e.path[0],e.props)}toState(e){return{...super.toState(e),...this.toCameraState(e),type:this.cameraType}}},cf=new it,WIe=new it;function EB(e){let t=!1;return e.scene.objects.traverse((r,i)=>{var n;((n=i.geometry)==null?void 0:n.type)==="BooleanGeometry"&&(t=!0)}),t}var sh=class extends tm{constructor(e,t,r){super(e,t),this.data=t,this.meshSetAddresses=[],this.needsTransformForDownstream=!1,this.geometry=new Ot,this.onAfterRender=(i,n,a,o,s,l)=>{super.onAfterRender(i,n,a,o,s,l),this.recomputeBoolean()},this.geometry.userData.parameters={width:0,height:0,depth:0}}get booleanOp(){return this.data.geometry.operation}get phongAngle(){return this.data.geometry.phongAngle??45}get isLOD(){return this.recomputeBoolean(),!1}updateByPatchedOp(e,t,r){super.updateByPatchedOp(e,t,r),e.path.length===1&&e.path[0]==="geometry"&&e.type===0&&e.props.operation!==void 0&&(this.freeBooleanPointer(),this.resetBBoxNeedsUpdate())}freeBooleanPointer(){super.freeBooleanPointer(),this.geometry.dispose()}recomputeBoolean(e,t=!0){var i;if(this.booleanMeshSetAddress!==-1&&!e)return;for(let n=0;n<this.children.length;n++){let a=this.children[n];a instanceof sh&&a.dataPatched.visible===!0&&a.recomputeBoolean(e===!0,t)}this.meshSetAddresses=[];for(let n=0;n<this.children.length;n++){let a=this.children[n];if(a instanceof Ra&&a.dataPatched.visible===!0&&((i=a.geometry.attributes.position)==null?void 0:i.count)>0&&a.geometry.drawRange.count>0&&a.booleanMeshSetAddress!==0){cf.multiplyMatrices(a.hiddenMatrix,a.matrix);try{if(a.booleanMeshSetAddress===-1){if((a.geometry.index??a.geometry.getAttribute("position")).count/3<15e5&&(a.booleanMeshSetAddress=kl.getMeshSet(a.geometry,e===!0,t)),a.booleanMeshSetAddress===-1)return;kl.transformMeshSet(a.booleanMeshSetAddress,cf),a.booleanMatrixInvOld.copy(cf).invert(),a.booleanWasTransformed=!1}else a instanceof sh&&a.needsTransformForDownstream===!0?(kl.transformMeshSet(a.booleanMeshSetAddress,cf),a.needsTransformForDownstream=!1):a.booleanWasTransformed===!0&&(kl.transformMeshSet(a.booleanMeshSetAddress,WIe.multiplyMatrices(cf,a.booleanMatrixInvOld)),a.booleanMatrixInvOld.copy(cf).invert(),a.booleanWasTransformed=!1)}catch(o){console.error(o),a.booleanMeshSetAddress=0,a.geometry.userData.booleanOperationDidFail=!0;continue}kl.hasOpenEdges(a.booleanMeshSetAddress)===!1||n===this.children.length-1&&this.booleanOp===2?(this.meshSetAddresses.push(a.booleanMeshSetAddress),a.geometry.userData.booleanOperationDidFail=!1):a.geometry.userData.booleanOperationDidFail="openEdges"}}if(this.meshSetAddresses.length===0){this.geometry.setAttribute("position",new yt([],0)),this.geometry.setDrawRange(0,0);return}if(e===!0)return kl.calcBooleanTopological(this.meshSetAddresses,this.booleanOp);let r=this.geometry;r.dispose(),this.geometry=new Ot,this.geometry.userData=r.userData,this.geometry.boundingSphere=r.boundingSphere;try{this.booleanMeshSetAddress=kl.calcBoolean(this.meshSetAddresses,this.booleanOp,this.geometry,this.phongAngle)}catch(n){this.booleanMeshSetAddress=0,this.geometry.userData.booleanOperationDidFail=!0,console.error(n)}this.booleanMatrixInvOld.copy(this.matrix).invert(),this.needsTransformForDownstream=!0,oD(this),sD(this)}dispose(){super.dispose(),this.geometry.dispose()}},eE;(e=>{function t(r){return Cr.is(r)&&r instanceof Yg}e.is=t})(eE||(eE={}));var cD=(e,t)=>class extends rm(e,t){updateState_Light(r,i){this.updateState_Entity(r,i),r.color!==void 0&&(this.color=i.shared.color(r.color)),r.intensity!==void 0&&(this.intensity=r.intensity),r.depth!==void 0&&(this.shadow.camera.far=r.depth,this.shadow.needsUpdate=!0),r.shadows!==void 0&&(this.castShadow=r.shadows)}},Jo=e=>e instanceof Ra,Yl=e=>e!==null&&e instanceof sh,GIe=e=>e instanceof va,$Ie=e=>eE.is(e),tE=e=>JM.is(e),qIe=new k(1,1,1),TB=new k,YIe=new k,PB=new Xt,r0=class extends e0(J1e){constructor(e,t=15){super(t),this.object=e,this.dummy=new $l,this.object.updateMatrixWorld(),this.name=`EmptyObjectHelper: ${e.uuid}`,this.matrix=this.dummy.matrixWorld,this.matrixAutoUpdate=!1,this.object.isBone&&(this.visible=!1)}raycast(e,t){t0(this.object,r0.geometryHelper,e,t,!1,this.dummy)}update(){}updateMatrix(){}updateMatrixWorld(e){this.object.matrixWorld.decompose(TB,PB,YIe),this.matrix.compose(TB,PB,qIe),super.updateMatrixWorld(e)}updateWorldMatrix(e,t){}},Zf=class extends rm($l,r0){constructor(e,t){super(),this.super_Entity(e,t),this.objectHelper.update()}updateState(e,t){this.updateState_Entity(e,t),"buffer"in e&&Object.keys(e).length===1&&t.scene.reloadSplats()}},Cb=class extends rm($l,r0){constructor(e,t,r){super(),this.super_Entity(e,t),this.context=r,this.objectHelper.update()}updateState(e,t){this.updateState_Entity(e,t)}},LH={RED:0,GREEN:1,BLUE:2,ALPHA:3},i0="varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}",XIe=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform lowp sampler2D cocBuffer;uniform vec2 texelSize;uniform float scale;uniform vec4 kernel64[32];varying vec2 vUv;void main(){
#ifdef FOREGROUND
vec2 CoCNearFar=texture2D(cocBuffer,vUv).rg;float CoC=CoCNearFar.r*scale;
#else
float CoC=texture2D(cocBuffer,vUv).g*scale;
#endif
if(CoC==0.0){gl_FragColor=texture2D(inputBuffer,vUv);}else{
#ifdef FOREGROUND
vec2 step=texelSize*max(CoC,CoCNearFar.g*scale);
#else
vec2 step=texelSize*CoC;
#endif
vec4 acc=vec4(0.0);for(int i=0;i<32;++i){vec4 kernel=kernel64[i];vec2 uv=step*kernel.xy+vUv;acc+=texture2D(inputBuffer,uv);uv=step*kernel.zw+vUv;acc+=texture2D(inputBuffer,uv);}gl_FragColor=acc/64.0;}}`,Gy=class extends jr{constructor(e=!1,t=!1){super({name:"BokehMaterial",defines:{PASS:e?"2":"1"},uniforms:{kernel64:new rt(null),kernel16:new rt(null),inputBuffer:new rt(null),cocBuffer:new rt(null),texelSize:new rt(new ye),scale:new rt(1)},blending:ln,depthWrite:!1,depthTest:!1,fragmentShader:XIe,vertexShader:i0}),this.toneMapped=!1,t&&(this.defines.FOREGROUND="1"),this.generateKernel()}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}set cocBuffer(e){this.uniforms.cocBuffer.value=e}setCoCBuffer(e){this.uniforms.cocBuffer.value=e}get scale(){return this.uniforms.scale.value}set scale(e){this.uniforms.scale.value=e}getScale(e){return this.uniforms.scale.value=e}setScale(e){this.uniforms.scale.value=e}generateKernel(){let e=2.39996323,t=new Float32Array(128),r=new Float32Array(32),i=0,n=0;for(let s=0;s<80;++s){let l=s*e,c=Math.sqrt(s)/Math.sqrt(80),d=c*Math.cos(l),u=c*Math.sin(l);s%5===0?(r[n++]=d,r[n++]=u):(t[i++]=d,t[i++]=u)}let a=[],o=[];for(let s=0;s<128;)a.push(new Kt(t[s++],t[s++],t[s++],t[s++]));for(let s=0;s<32;)o.push(new Kt(r[s++],r[s++],r[s++],r[s++]));this.uniforms.kernel64.value=a,this.uniforms.kernel16.value=o}setTexelSize(e,t){this.uniforms.texelSize.value.set(e,t)}setSize(e,t){this.uniforms.texelSize.value.set(1/e,1/t)}};function DB(e,t,r){return e*(t-r)-t}function rE(e,t,r){return Math.min(Math.max((e+t)/(t-r),0),1)}var KIe=`#include <common>
#include <packing>
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform float focusDistance;uniform float focusRange;uniform float cameraNear;uniform float cameraFar;varying vec2 vUv;float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}void main(){float depth=readDepth(vUv);
#ifdef PERSPECTIVE_CAMERA
float viewZ=perspectiveDepthToViewZ(depth,cameraNear,cameraFar);float linearDepth=viewZToOrthographicDepth(viewZ,cameraNear,cameraFar);
#else
float linearDepth=depth;
#endif
float signedDistance=linearDepth-focusDistance;float magnitude=smoothstep(0.0,focusRange,abs(signedDistance));gl_FragColor.rg=magnitude*vec2(step(signedDistance,0.0),step(0.0,signedDistance));}`,QIe=class extends jr{constructor(e){super({name:"CircleOfConfusionMaterial",defines:{DEPTH_PACKING:"0"},uniforms:{depthBuffer:new rt(null),focusDistance:new rt(0),focusRange:new rt(0),cameraNear:new rt(.3),cameraFar:new rt(1e3)},blending:ln,depthWrite:!1,depthTest:!1,fragmentShader:KIe,vertexShader:i0}),this.toneMapped=!1,this.uniforms.focalLength=this.uniforms.focusRange,this.adoptCameraSettings(e)}get near(){return this.uniforms.cameraNear.value}get far(){return this.uniforms.cameraFar.value}set depthBuffer(e){this.uniforms.depthBuffer.value=e}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e,t=pc){this.depthBuffer=e,this.depthPacking=t}get focusDistance(){return this.uniforms.focusDistance.value}set focusDistance(e){this.uniforms.focusDistance.value=e}get worldFocusDistance(){return-DB(this.focusDistance,this.near,this.far)}set worldFocusDistance(e){this.focusDistance=rE(-e,this.near,this.far)}getFocusDistance(e){this.uniforms.focusDistance.value=e}setFocusDistance(e){this.uniforms.focusDistance.value=e}get focalLength(){return this.focusRange}set focalLength(e){this.focusRange=e}get focusRange(){return this.uniforms.focusRange.value}set focusRange(e){this.uniforms.focusRange.value=e}get worldFocusRange(){return-DB(this.focusRange,this.near,this.far)}set worldFocusRange(e){this.focusRange=rE(-e,this.near,this.far)}getFocalLength(e){return this.focusRange}setFocalLength(e){this.focusRange=e}adoptCameraSettings(e){e&&(this.uniforms.cameraNear.value=e.near,this.uniforms.cameraFar.value=e.far,e instanceof da?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}},ZIe=`#include <common>
#include <dithering_pars_fragment>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec4 sum=texture2D(inputBuffer,vUv0);sum+=texture2D(inputBuffer,vUv1);sum+=texture2D(inputBuffer,vUv2);sum+=texture2D(inputBuffer,vUv3);gl_FragColor=sum*0.25;
#include <encodings_fragment>
#include <dithering_fragment>
}`,JIe="uniform vec2 texelSize;uniform vec2 halfTexelSize;uniform float kernel;uniform float scale;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vec2 dUv=(texelSize*vec2(kernel)+halfTexelSize)*scale;vUv0=vec2(uv.x-dUv.x,uv.y+dUv.y);vUv1=vec2(uv.x+dUv.x,uv.y+dUv.y);vUv2=vec2(uv.x+dUv.x,uv.y-dUv.y);vUv3=vec2(uv.x-dUv.x,uv.y-dUv.y);gl_Position=vec4(position.xy,1.0,1.0);}",OB=class extends jr{constructor(e=new ye){super({name:"KawaseBlurMaterial",uniforms:{inputBuffer:new rt(null),texelSize:new rt(new ye),halfTexelSize:new rt(new ye),kernel:new rt(0),scale:new rt(1)},blending:ln,depthWrite:!1,depthTest:!1,fragmentShader:ZIe,vertexShader:JIe}),this.toneMapped=!1,this.setTexelSize(e.x,e.y)}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.inputBuffer=e}get scale(){return this.uniforms.scale.value}set scale(e){this.uniforms.scale.value=e}getScale(){return this.uniforms.scale.value}setScale(e){this.uniforms.scale.value=e}getKernel(){return null}get kernel(){return this.uniforms.kernel.value}set kernel(e){this.uniforms.kernel.value=e}setKernel(e){this.kernel=e}setTexelSize(e,t){this.uniforms.texelSize.value.set(e,t),this.uniforms.halfTexelSize.value.set(e,t).multiplyScalar(.5)}setSize(e,t){let r=this.uniforms;r.texelSize.value.set(1/e,1/t),r.halfTexelSize.value.copy(r.texelSize.value).multiplyScalar(.5)}},eze=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform float opacity;varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);gl_FragColor=opacity*texel;
#include <encodings_fragment>
}`,tze=class extends jr{constructor(){super({name:"CopyMaterial",uniforms:{inputBuffer:new rt(null),opacity:new rt(1)},blending:ln,depthWrite:!1,depthTest:!1,fragmentShader:eze,vertexShader:i0}),this.toneMapped=!1}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}getOpacity(e){return this.uniforms.opacity.value}setOpacity(e){this.uniforms.opacity.value=e}},rze=`varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;
#if THREE_REVISION < 143
#define luminance(v) linearToRelativeLuminance(v)
#endif
#if EDGE_DETECTION_MODE != 0
varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;
#endif
#if EDGE_DETECTION_MODE == 1
#include <common>
#endif
#if EDGE_DETECTION_MODE == 0 || PREDICATION_MODE == 1
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}vec3 gatherNeighbors(){float p=readDepth(vUv);float pLeft=readDepth(vUv0);float pTop=readDepth(vUv1);return vec3(p,pLeft,pTop);}
#elif PREDICATION_MODE == 2
uniform sampler2D predicationBuffer;vec3 gatherNeighbors(){float p=texture2D(predicationBuffer,vUv).r;float pLeft=texture2D(predicationBuffer,vUv0).r;float pTop=texture2D(predicationBuffer,vUv1).r;return vec3(p,pLeft,pTop);}
#endif
#if PREDICATION_MODE != 0
vec2 calculatePredicatedThreshold(){vec3 neighbours=gatherNeighbors();vec2 delta=abs(neighbours.xx-neighbours.yz);vec2 edges=step(PREDICATION_THRESHOLD,delta);return PREDICATION_SCALE*EDGE_THRESHOLD*(1.0-PREDICATION_STRENGTH*edges);}
#endif
#if EDGE_DETECTION_MODE != 0
uniform sampler2D inputBuffer;
#endif
void main(){
#if EDGE_DETECTION_MODE == 0
const vec2 threshold=vec2(DEPTH_THRESHOLD);
#elif PREDICATION_MODE != 0
vec2 threshold=calculatePredicatedThreshold();
#else
const vec2 threshold=vec2(EDGE_THRESHOLD);
#endif
#if EDGE_DETECTION_MODE == 0
vec3 neighbors=gatherNeighbors();vec2 delta=abs(neighbors.xx-vec2(neighbors.y,neighbors.z));vec2 edges=step(threshold,delta);if(dot(edges,vec2(1.0))==0.0){discard;}gl_FragColor=vec4(edges,0.0,1.0);
#elif EDGE_DETECTION_MODE == 1
float l=luminance(texture2D(inputBuffer,vUv).rgb);float lLeft=luminance(texture2D(inputBuffer,vUv0).rgb);float lTop=luminance(texture2D(inputBuffer,vUv1).rgb);vec4 delta;delta.xy=abs(l-vec2(lLeft,lTop));vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0))==0.0){discard;}float lRight=luminance(texture2D(inputBuffer,vUv2).rgb);float lBottom=luminance(texture2D(inputBuffer,vUv3).rgb);delta.zw=abs(l-vec2(lRight,lBottom));vec2 maxDelta=max(delta.xy,delta.zw);float lLeftLeft=luminance(texture2D(inputBuffer,vUv4).rgb);float lTopTop=luminance(texture2D(inputBuffer,vUv5).rgb);delta.zw=abs(vec2(lLeft,lTop)-vec2(lLeftLeft,lTopTop));maxDelta=max(maxDelta.xy,delta.zw);float finalDelta=max(maxDelta.x,maxDelta.y);edges.xy*=step(finalDelta,LOCAL_CONTRAST_ADAPTATION_FACTOR*delta.xy);gl_FragColor=vec4(edges,0.0,1.0);
#elif EDGE_DETECTION_MODE == 2
vec4 delta;vec3 c=texture2D(inputBuffer,vUv).rgb;vec3 cLeft=texture2D(inputBuffer,vUv0).rgb;vec3 t=abs(c-cLeft);delta.x=max(max(t.r,t.g),t.b);vec3 cTop=texture2D(inputBuffer,vUv1).rgb;t=abs(c-cTop);delta.y=max(max(t.r,t.g),t.b);vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0))==0.0){discard;}vec3 cRight=texture2D(inputBuffer,vUv2).rgb;t=abs(c-cRight);delta.z=max(max(t.r,t.g),t.b);vec3 cBottom=texture2D(inputBuffer,vUv3).rgb;t=abs(c-cBottom);delta.w=max(max(t.r,t.g),t.b);vec2 maxDelta=max(delta.xy,delta.zw);vec3 cLeftLeft=texture2D(inputBuffer,vUv4).rgb;t=abs(c-cLeftLeft);delta.z=max(max(t.r,t.g),t.b);vec3 cTopTop=texture2D(inputBuffer,vUv5).rgb;t=abs(c-cTopTop);delta.w=max(max(t.r,t.g),t.b);maxDelta=max(maxDelta.xy,delta.zw);float finalDelta=max(maxDelta.x,maxDelta.y);edges*=step(finalDelta,LOCAL_CONTRAST_ADAPTATION_FACTOR*delta.xy);gl_FragColor=vec4(edges,0.0,1.0);
#endif
}`,ize=`uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;
#if EDGE_DETECTION_MODE != 0
varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;
#endif
void main(){vUv=position.xy*0.5+0.5;vUv0=vUv+texelSize*vec2(-1.0,0.0);vUv1=vUv+texelSize*vec2(0.0,-1.0);
#if EDGE_DETECTION_MODE != 0
vUv2=vUv+texelSize*vec2(1.0,0.0);vUv3=vUv+texelSize*vec2(0.0,1.0);vUv4=vUv+texelSize*vec2(-2.0,0.0);vUv5=vUv+texelSize*vec2(0.0,-2.0);
#endif
gl_Position=vec4(position.xy,1.0,1.0);}`,mw={DEPTH:0,LUMA:1,COLOR:2},nze={DISABLED:0,DEPTH:1,CUSTOM:2},aze=class extends jr{constructor(e=new ye,t=mw.COLOR){super({name:"EdgeDetectionMaterial",defines:{THREE_REVISION:Up.replace(/\D+/g,""),LOCAL_CONTRAST_ADAPTATION_FACTOR:"2.0",EDGE_THRESHOLD:"0.1",DEPTH_THRESHOLD:"0.01",PREDICATION_MODE:"0",PREDICATION_THRESHOLD:"0.01",PREDICATION_SCALE:"2.0",PREDICATION_STRENGTH:"1.0",DEPTH_PACKING:"0"},uniforms:{inputBuffer:new rt(null),depthBuffer:new rt(null),predicationBuffer:new rt(null),texelSize:new rt(e)},blending:ln,depthWrite:!1,depthTest:!1,fragmentShader:rze,vertexShader:ize}),this.toneMapped=!1,this.edgeDetectionMode=t}set depthBuffer(e){this.uniforms.depthBuffer.value=e}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e,t=pc){this.depthBuffer=e,this.depthPacking=t}get edgeDetectionMode(){return Number(this.defines.EDGE_DETECTION_MODE)}set edgeDetectionMode(e){this.defines.EDGE_DETECTION_MODE=e.toFixed(0),this.needsUpdate=!0}getEdgeDetectionMode(){return this.edgeDetectionMode}setEdgeDetectionMode(e){this.edgeDetectionMode=e}get localContrastAdaptationFactor(){return Number(this.defines.LOCAL_CONTRAST_ADAPTATION_FACTOR)}set localContrastAdaptationFactor(e){this.defines.LOCAL_CONTRAST_ADAPTATION_FACTOR=e.toFixed("6"),this.needsUpdate=!0}getLocalContrastAdaptationFactor(){return this.localContrastAdaptationFactor}setLocalContrastAdaptationFactor(e){this.localContrastAdaptationFactor=e}get edgeDetectionThreshold(){return Number(this.defines.EDGE_THRESHOLD)}set edgeDetectionThreshold(e){this.defines.EDGE_THRESHOLD=e.toFixed("6"),this.defines.DEPTH_THRESHOLD=(e*.1).toFixed("6"),this.needsUpdate=!0}getEdgeDetectionThreshold(){return this.edgeDetectionThreshold}setEdgeDetectionThreshold(e){this.edgeDetectionThreshold=e}get predicationMode(){return Number(this.defines.PREDICATION_MODE)}set predicationMode(e){this.defines.PREDICATION_MODE=e.toFixed(0),this.needsUpdate=!0}getPredicationMode(){return this.predicationMode}setPredicationMode(e){this.predicationMode=e}set predicationBuffer(e){this.uniforms.predicationBuffer.value=e}setPredicationBuffer(e){this.uniforms.predicationBuffer.value=e}get predicationThreshold(){return Number(this.defines.PREDICATION_THRESHOLD)}set predicationThreshold(e){this.defines.PREDICATION_THRESHOLD=e.toFixed("6"),this.needsUpdate=!0}getPredicationThreshold(){return this.predicationThreshold}setPredicationThreshold(e){this.predicationThreshold=e}get predicationScale(){return Number(this.defines.PREDICATION_SCALE)}set predicationScale(e){this.defines.PREDICATION_SCALE=e.toFixed("6"),this.needsUpdate=!0}getPredicationScale(){return this.predicationScale}setPredicationScale(e){this.predicationScale=e}get predicationStrength(){return Number(this.defines.PREDICATION_STRENGTH)}set predicationStrength(e){this.defines.PREDICATION_STRENGTH=e.toFixed("6"),this.needsUpdate=!0}getPredicationStrength(){return this.predicationStrength}setPredicationStrength(e){this.predicationStrength=e}setSize(e,t){this.uniforms.texelSize.value.set(1/e,1/t)}},oze=`#include <common>
#include <packing>
#include <dithering_pars_fragment>
#define packFloatToRGBA(v) packDepthToRGBA(v)
#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;
#if THREE_REVISION < 143
#define luminance(v) linearToRelativeLuminance(v)
#endif
#if THREE_REVISION >= 137
vec4 sRGBToLinear(const in vec4 value){return vec4(mix(pow(value.rgb*0.9478672986+vec3(0.0521327014),vec3(2.4)),value.rgb*0.0773993808,vec3(lessThanEqual(value.rgb,vec3(0.04045)))),value.a);}
#endif
float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}float getViewZ(const in float depth){
#ifdef PERSPECTIVE_CAMERA
return perspectiveDepthToViewZ(depth,cameraNear,cameraFar);
#else
return orthographicDepthToViewZ(depth,cameraNear,cameraFar);
#endif
}FRAGMENT_HEADvoid main(){FRAGMENT_MAIN_UVvec4 color0=texture2D(inputBuffer,UV);vec4 color1=vec4(0.0);FRAGMENT_MAIN_IMAGEgl_FragColor=color0;
#ifdef ENCODE_OUTPUT
#include <encodings_fragment>
#endif
#include <dithering_fragment>
}`,sze="uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;VERTEX_HEADvoid main(){vUv=position.xy*0.5+0.5;VERTEX_MAIN_SUPPORTgl_Position=vec4(position.xy,1.0,1.0);}",qo={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},iE=class extends jr{constructor(e,t,r,i,n=!1){super({name:"EffectMaterial",defines:{THREE_REVISION:Up.replace(/\D+/g,""),DEPTH_PACKING:"0",ENCODE_OUTPUT:"1"},uniforms:{inputBuffer:new rt(null),depthBuffer:new rt(null),resolution:new rt(new ye),texelSize:new rt(new ye),cameraNear:new rt(.3),cameraFar:new rt(1e3),aspect:new rt(1),time:new rt(0)},blending:ln,depthWrite:!1,depthTest:!1,dithering:n}),this.toneMapped=!1,e&&this.setShaderParts(e),t&&this.setDefines(t),r&&this.setUniforms(r),this.adoptCameraSettings(i)}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(e){this.uniforms.depthBuffer.value=e}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e,t=pc){this.depthBuffer=e,this.depthPacking=t}setShaderParts(e){return this.fragmentShader=oze.replace(qo.FRAGMENT_HEAD,e.get(qo.FRAGMENT_HEAD)).replace(qo.FRAGMENT_MAIN_UV,e.get(qo.FRAGMENT_MAIN_UV)).replace(qo.FRAGMENT_MAIN_IMAGE,e.get(qo.FRAGMENT_MAIN_IMAGE)),this.vertexShader=sze.replace(qo.VERTEX_HEAD,e.get(qo.VERTEX_HEAD)).replace(qo.VERTEX_MAIN_SUPPORT,e.get(qo.VERTEX_MAIN_SUPPORT)),this.needsUpdate=!0,this}setDefines(e){for(let t of e.entries())this.defines[t[0]]=t[1];return this.needsUpdate=!0,this}setUniforms(e){for(let t of e.entries())this.uniforms[t[0]]=t[1];return this}setExtensions(e){this.extensions={};for(let t of e)this.extensions[t]=!0;return this}get encodeOutput(){return this.defines.ENCODE_OUTPUT!==void 0}set encodeOutput(e){this.encodeOutput!==e&&(e?this.defines.ENCODE_OUTPUT="1":delete this.defines.ENCODE_OUTPUT,this.needsUpdate=!0)}isOutputEncodingEnabled(e){return this.encodeOutput}setOutputEncodingEnabled(e){this.encodeOutput=e}get time(){return this.uniforms.time.value}set time(e){this.uniforms.time.value=e}setDeltaTime(e){this.uniforms.time.value+=e}adoptCameraSettings(e){e&&(this.uniforms.cameraNear.value=e.near,this.uniforms.cameraFar.value=e.far,e instanceof da?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}setSize(e,t){let r=this.uniforms;r.resolution.value.set(e,t),r.texelSize.value.set(1/e,1/t),r.aspect.value=e/t}static get Section(){return qo}},lze=`#include <common>
#if THREE_REVISION < 143
#define luminance(v) linearToRelativeLuminance(v)
#endif
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef RANGE
uniform vec2 range;
#elif defined(THRESHOLD)
uniform float threshold;uniform float smoothing;
#endif
varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);float l=luminance(texel.rgb);
#ifdef RANGE
float low=step(range.x,l);float high=step(l,range.y);l*=low*high;
#elif defined(THRESHOLD)
l=smoothstep(threshold,threshold+smoothing,l);
#endif
#ifdef COLOR
gl_FragColor=vec4(texel.rgb*l,l);
#else
gl_FragColor=vec4(l);
#endif
}`,cze=class extends jr{constructor(e=!1,t=null){super({name:"LuminanceMaterial",defines:{THREE_REVISION:Up.replace(/\D+/g,"")},uniforms:{inputBuffer:new rt(null),threshold:new rt(0),smoothing:new rt(1),range:new rt(null)},blending:ln,depthWrite:!1,depthTest:!1,fragmentShader:lze,vertexShader:i0}),this.toneMapped=!1,this.colorOutput=e,this.luminanceRange=t}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get threshold(){return this.uniforms.threshold.value}set threshold(e){this.smoothing>0||e>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.threshold.value=e}getThreshold(){return this.threshold}setThreshold(e){this.threshold=e}get smoothing(){return this.uniforms.smoothing.value}set smoothing(e){this.threshold>0||e>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.smoothing.value=e}getSmoothingFactor(){return this.smoothing}setSmoothingFactor(e){this.smoothing=e}get useThreshold(){return this.threshold>0||this.smoothing>0}set useThreshold(e){}get colorOutput(){return this.defines.COLOR!==void 0}set colorOutput(e){e?this.defines.COLOR="1":delete this.defines.COLOR,this.needsUpdate=!0}isColorOutputEnabled(e){return this.colorOutput}setColorOutputEnabled(e){this.colorOutput=e}get useRange(){return this.luminanceRange!==null}set useRange(e){this.luminanceRange=null}get luminanceRange(){return this.uniforms.range.value}set luminanceRange(e){e!==null?this.defines.RANGE="1":delete this.defines.RANGE,this.uniforms.range.value=e,this.needsUpdate=!0}getLuminanceRange(){return this.luminanceRange}setLuminanceRange(e){this.luminanceRange=e}},dze=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef MASK_PRECISION_HIGH
uniform mediump sampler2D maskTexture;
#else
uniform lowp sampler2D maskTexture;
#endif
#if MASK_FUNCTION != 0
uniform float strength;
#endif
varying vec2 vUv;void main(){
#if COLOR_CHANNEL == 0
float mask=texture2D(maskTexture,vUv).r;
#elif COLOR_CHANNEL == 1
float mask=texture2D(maskTexture,vUv).g;
#elif COLOR_CHANNEL == 2
float mask=texture2D(maskTexture,vUv).b;
#else
float mask=texture2D(maskTexture,vUv).a;
#endif
#if MASK_FUNCTION == 0
#ifdef INVERTED
mask=step(mask,0.0);
#else
mask=1.0-step(mask,0.0);
#endif
#else
mask=clamp(mask*strength,0.0,1.0);
#ifdef INVERTED
mask=1.0-mask;
#endif
#endif
#if MASK_FUNCTION == 2
gl_FragColor=vec4(mask*texture2D(inputBuffer,vUv).rgb,mask);
#else
gl_FragColor=mask*texture2D(inputBuffer,vUv);
#endif
}`,BH={DISCARD:0,MULTIPLY:1,MULTIPLY_RGB_SET_ALPHA:2},uze=class extends jr{constructor(e=null){super({name:"MaskMaterial",uniforms:{maskTexture:new rt(e),inputBuffer:new rt(null),strength:new rt(1)},blending:ln,depthWrite:!1,depthTest:!1,fragmentShader:dze,vertexShader:i0}),this.toneMapped=!1,this.setColorChannel(LH.RED),this.setMaskFunction(BH.DISCARD)}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}set maskTexture(e){this.uniforms.maskTexture.value=e,delete this.defines.MASK_PRECISION_HIGH,e.type!==ga&&(this.defines.MASK_PRECISION_HIGH="1"),this.needsUpdate=!0}setMaskTexture(e){this.maskTexture=e}set colorChannel(e){this.defines.COLOR_CHANNEL=e.toFixed(0),this.needsUpdate=!0}setColorChannel(e){this.colorChannel=e}set maskFunction(e){this.defines.MASK_FUNCTION=e.toFixed(0),this.needsUpdate=!0}setMaskFunction(e){this.maskFunction=e}get inverted(){return this.defines.INVERTED!==void 0}set inverted(e){this.inverted&&!e?delete this.defines.INVERTED:e&&(this.defines.INVERTED="1"),this.needsUpdate=!0}isInverted(){return this.inverted}setInverted(e){this.inverted=e}get strength(){return this.uniforms.strength.value}set strength(e){this.uniforms.strength.value=e}getStrength(){return this.strength}setStrength(e){this.strength=e}},hze=`#define sampleLevelZeroOffset(t, coord, offset) texture2D(t, coord + offset * texelSize)
#if __VERSION__ < 300
#define round(v) floor(v + 0.5)
#endif
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform lowp sampler2D areaTexture;uniform lowp sampler2D searchTexture;uniform vec2 texelSize;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixCoord;void movec(const in bvec2 c,inout vec2 variable,const in vec2 value){if(c.x){variable.x=value.x;}if(c.y){variable.y=value.y;}}void movec(const in bvec4 c,inout vec4 variable,const in vec4 value){movec(c.xy,variable.xy,value.xy);movec(c.zw,variable.zw,value.zw);}vec2 decodeDiagBilinearAccess(in vec2 e){e.r=e.r*abs(5.0*e.r-5.0*0.75);return round(e);}vec4 decodeDiagBilinearAccess(in vec4 e){e.rb=e.rb*abs(5.0*e.rb-5.0*0.75);return round(e);}vec2 searchDiag1(const in vec2 texCoord,const in vec2 dir,out vec2 e){vec4 coord=vec4(texCoord,-1.0,1.0);vec3 t=vec3(texelSize,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(coord.z<float(MAX_SEARCH_STEPS_DIAG_INT-1)&&coord.w>0.9)){break;}coord.xyz=t*vec3(dir,1.0)+coord.xyz;e=texture2D(inputBuffer,coord.xy).rg;coord.w=dot(e,vec2(0.5));}return coord.zw;}vec2 searchDiag2(const in vec2 texCoord,const in vec2 dir,out vec2 e){vec4 coord=vec4(texCoord,-1.0,1.0);coord.x+=0.25*texelSize.x;vec3 t=vec3(texelSize,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(coord.z<float(MAX_SEARCH_STEPS_DIAG_INT-1)&&coord.w>0.9)){break;}coord.xyz=t*vec3(dir,1.0)+coord.xyz;e=texture2D(inputBuffer,coord.xy).rg;e=decodeDiagBilinearAccess(e);coord.w=dot(e,vec2(0.5));}return coord.zw;}vec2 areaDiag(const in vec2 dist,const in vec2 e,const in float offset){vec2 texCoord=vec2(AREATEX_MAX_DISTANCE_DIAG,AREATEX_MAX_DISTANCE_DIAG)*e+dist;texCoord=AREATEX_PIXEL_SIZE*texCoord+0.5*AREATEX_PIXEL_SIZE;texCoord.x+=0.5;texCoord.y+=AREATEX_SUBTEX_SIZE*offset;return texture2D(areaTexture,texCoord).rg;}vec2 calculateDiagWeights(const in vec2 texCoord,const in vec2 e,const in vec4 subsampleIndices){vec2 weights=vec2(0.0);vec4 d;vec2 end;if(e.r>0.0){d.xz=searchDiag1(texCoord,vec2(-1.0,1.0),end);d.x+=float(end.y>0.9);}else{d.xz=vec2(0.0);}d.yw=searchDiag1(texCoord,vec2(1.0,-1.0),end);if(d.x+d.y>2.0){vec4 coords=vec4(-d.x+0.25,d.x,d.y,-d.y-0.25)*texelSize.xyxy+texCoord.xyxy;vec4 c;c.xy=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(-1,0)).rg;c.zw=sampleLevelZeroOffset(inputBuffer,coords.zw,vec2(1,0)).rg;c.yxwz=decodeDiagBilinearAccess(c.xyzw);vec2 cc=vec2(2.0)*c.xz+c.yw;movec(bvec2(step(0.9,d.zw)),cc,vec2(0.0));weights+=areaDiag(d.xy,cc,subsampleIndices.z);}d.xz=searchDiag2(texCoord,vec2(-1.0,-1.0),end);if(sampleLevelZeroOffset(inputBuffer,texCoord,vec2(1,0)).r>0.0){d.yw=searchDiag2(texCoord,vec2(1.0),end);d.y+=float(end.y>0.9);}else{d.yw=vec2(0.0);}if(d.x+d.y>2.0){vec4 coords=vec4(-d.x,-d.x,d.y,d.y)*texelSize.xyxy+texCoord.xyxy;vec4 c;c.x=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(-1,0)).g;c.y=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(0,-1)).r;c.zw=sampleLevelZeroOffset(inputBuffer,coords.zw,vec2(1,0)).gr;vec2 cc=vec2(2.0)*c.xz+c.yw;movec(bvec2(step(0.9,d.zw)),cc,vec2(0.0));weights+=areaDiag(d.xy,cc,subsampleIndices.w).gr;}return weights;}float searchLength(const in vec2 e,const in float offset){vec2 scale=SEARCHTEX_SIZE*vec2(0.5,-1.0);vec2 bias=SEARCHTEX_SIZE*vec2(offset,1.0);scale+=vec2(-1.0,1.0);bias+=vec2(0.5,-0.5);scale*=1.0/SEARCHTEX_PACKED_SIZE;bias*=1.0/SEARCHTEX_PACKED_SIZE;return texture2D(searchTexture,scale*e+bias).r;}float searchXLeft(in vec2 texCoord,const in float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.x>end&&e.g>0.8281&&e.r==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(-2.0,0.0)*texelSize+texCoord;}float offset=-(255.0/127.0)*searchLength(e,0.0)+3.25;return texelSize.x*offset+texCoord.x;}float searchXRight(vec2 texCoord,const in float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.x<end&&e.g>0.8281&&e.r==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(2.0,0.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e,0.5)+3.25;return-texelSize.x*offset+texCoord.x;}float searchYUp(vec2 texCoord,const in float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.y>end&&e.r>0.8281&&e.g==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=-vec2(0.0,2.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e.gr,0.0)+3.25;return texelSize.y*offset+texCoord.y;}float searchYDown(vec2 texCoord,const in float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;i++){if(!(texCoord.y<end&&e.r>0.8281&&e.g==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(0.0,2.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e.gr,0.5)+3.25;return-texelSize.y*offset+texCoord.y;}vec2 area(const in vec2 dist,const in float e1,const in float e2,const in float offset){vec2 texCoord=vec2(AREATEX_MAX_DISTANCE)*round(4.0*vec2(e1,e2))+dist;texCoord=AREATEX_PIXEL_SIZE*texCoord+0.5*AREATEX_PIXEL_SIZE;texCoord.y=AREATEX_SUBTEX_SIZE*offset+texCoord.y;return texture2D(areaTexture,texCoord).rg;}void detectHorizontalCornerPattern(inout vec2 weights,const in vec4 texCoord,const in vec2 d){
#if !defined(DISABLE_CORNER_DETECTION)
vec2 leftRight=step(d.xy,d.yx);vec2 rounding=(1.0-CORNER_ROUNDING_NORM)*leftRight;rounding/=leftRight.x+leftRight.y;vec2 factor=vec2(1.0);factor.x-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(0,1)).r;factor.x-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,1)).r;factor.y-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(0,-2)).r;factor.y-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,-2)).r;weights*=clamp(factor,0.0,1.0);
#endif
}void detectVerticalCornerPattern(inout vec2 weights,const in vec4 texCoord,const in vec2 d){
#if !defined(DISABLE_CORNER_DETECTION)
vec2 leftRight=step(d.xy,d.yx);vec2 rounding=(1.0-CORNER_ROUNDING_NORM)*leftRight;rounding/=leftRight.x+leftRight.y;vec2 factor=vec2(1.0);factor.x-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(1,0)).g;factor.x-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,1)).g;factor.y-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(-2,0)).g;factor.y-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(-2,1)).g;weights*=clamp(factor,0.0,1.0);
#endif
}void main(){vec4 weights=vec4(0.0);vec4 subsampleIndices=vec4(0.0);vec2 e=texture2D(inputBuffer,vUv).rg;if(e.g>0.0){
#if !defined(DISABLE_DIAG_DETECTION)
weights.rg=calculateDiagWeights(vUv,e,subsampleIndices);if(weights.r==-weights.g){
#endif
vec2 d;vec3 coords;coords.x=searchXLeft(vOffset[0].xy,vOffset[2].x);coords.y=vOffset[1].y;d.x=coords.x;float e1=texture2D(inputBuffer,coords.xy).r;coords.z=searchXRight(vOffset[0].zw,vOffset[2].y);d.y=coords.z;d=round(resolution.xx*d+-vPixCoord.xx);vec2 sqrtD=sqrt(abs(d));float e2=sampleLevelZeroOffset(inputBuffer,coords.zy,vec2(1,0)).r;weights.rg=area(sqrtD,e1,e2,subsampleIndices.y);coords.y=vUv.y;detectHorizontalCornerPattern(weights.rg,coords.xyzy,d);
#if !defined(DISABLE_DIAG_DETECTION)
}else{e.r=0.0;}
#endif
}if(e.r>0.0){vec2 d;vec3 coords;coords.y=searchYUp(vOffset[1].xy,vOffset[2].z);coords.x=vOffset[0].x;d.x=coords.y;float e1=texture2D(inputBuffer,coords.xy).g;coords.z=searchYDown(vOffset[1].zw,vOffset[2].w);d.y=coords.z;d=round(resolution.yy*d-vPixCoord.yy);vec2 sqrtD=sqrt(abs(d));float e2=sampleLevelZeroOffset(inputBuffer,coords.xz,vec2(0,1)).g;weights.ba=area(sqrtD,e1,e2,subsampleIndices.x);coords.x=vUv.x;detectVerticalCornerPattern(weights.ba,coords.xyxz,d);}gl_FragColor=weights;}`,fze="uniform vec2 texelSize;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixCoord;void main(){vUv=position.xy*0.5+0.5;vPixCoord=vUv*resolution;vOffset[0]=vUv.xyxy+texelSize.xyxy*vec4(-0.25,-0.125,1.25,-0.125);vOffset[1]=vUv.xyxy+texelSize.xyxy*vec4(-0.125,-0.25,-0.125,1.25);vOffset[2]=vec4(vOffset[0].xz,vOffset[1].yw)+vec4(-2.0,2.0,-2.0,2.0)*texelSize.xxyy*MAX_SEARCH_STEPS_FLOAT;gl_Position=vec4(position.xy,1.0,1.0);}",pze=class extends jr{constructor(e=new ye,t=new ye){super({name:"SMAAWeightsMaterial",defines:{MAX_SEARCH_STEPS_INT:"16",MAX_SEARCH_STEPS_FLOAT:"16.0",MAX_SEARCH_STEPS_DIAG_INT:"8",MAX_SEARCH_STEPS_DIAG_FLOAT:"8.0",CORNER_ROUNDING:"25",CORNER_ROUNDING_NORM:"0.25",AREATEX_MAX_DISTANCE:"16.0",AREATEX_MAX_DISTANCE_DIAG:"20.0",AREATEX_PIXEL_SIZE:"(1.0 / vec2(160.0, 560.0))",AREATEX_SUBTEX_SIZE:"(1.0 / 7.0)",SEARCHTEX_SIZE:"vec2(66.0, 33.0)",SEARCHTEX_PACKED_SIZE:"vec2(64.0, 16.0)"},uniforms:{inputBuffer:new rt(null),searchTexture:new rt(null),areaTexture:new rt(null),resolution:new rt(t),texelSize:new rt(e)},blending:ln,depthWrite:!1,depthTest:!1,fragmentShader:hze,vertexShader:fze}),this.toneMapped=!1}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get searchTexture(){return this.uniforms.searchTexture.value}set searchTexture(e){this.uniforms.searchTexture.value=e}get areaTexture(){return this.uniforms.areaTexture.value}set areaTexture(e){this.uniforms.areaTexture.value=e}setLookupTextures(e,t){this.searchTexture=e,this.areaTexture=t}get orthogonalSearchSteps(){return Number(this.defines.MAX_SEARCH_STEPS_INT)}set orthogonalSearchSteps(e){let t=Math.min(Math.max(e,0),112);this.defines.MAX_SEARCH_STEPS_INT=t.toFixed("0"),this.defines.MAX_SEARCH_STEPS_FLOAT=t.toFixed("1"),this.needsUpdate=!0}setOrthogonalSearchSteps(e){this.orthogonalSearchSteps=e}get diagonalSearchSteps(){return Number(this.defines.MAX_SEARCH_STEPS_DIAG_INT)}set diagonalSearchSteps(e){let t=Math.min(Math.max(e,0),20);this.defines.MAX_SEARCH_STEPS_DIAG_INT=t.toFixed("0"),this.defines.MAX_SEARCH_STEPS_DIAG_FLOAT=t.toFixed("1"),this.needsUpdate=!0}setDiagonalSearchSteps(e){this.diagonalSearchSteps=e}get diagonalDetection(){return this.defines.DISABLE_DIAG_DETECTION===void 0}set diagonalDetection(e){e?delete this.defines.DISABLE_DIAG_DETECTION:this.defines.DISABLE_DIAG_DETECTION="1",this.needsUpdate=!0}isDiagonalDetectionEnabled(){return this.diagonalDetection}setDiagonalDetectionEnabled(e){this.diagonalDetection=e}get cornerRounding(){return Number(this.defines.CORNER_ROUNDING)}set cornerRounding(e){let t=Math.min(Math.max(e,0),100);this.defines.CORNER_ROUNDING=t.toFixed("4"),this.defines.CORNER_ROUNDING_NORM=(t/100).toFixed("4"),this.needsUpdate=!0}setCornerRounding(e){this.cornerRounding=e}get cornerDetection(){return this.defines.DISABLE_CORNER_DETECTION===void 0}set cornerDetection(e){e?delete this.defines.DISABLE_CORNER_DETECTION:this.defines.DISABLE_CORNER_DETECTION="1",this.needsUpdate=!0}isCornerRoundingEnabled(){return this.cornerDetection}setCornerRoundingEnabled(e){this.cornerDetection=e}setSize(e,t){let r=this.uniforms;r.texelSize.value.set(1/e,1/t),r.resolution.value.set(e,t)}},mze=new xh,Rc=null;function vze(){if(Rc===null){let e=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),t=new Float32Array([0,0,2,0,0,2]);Rc=new Ot,Rc.setAttribute!==void 0?(Rc.setAttribute("position",new $t(e,3)),Rc.setAttribute("uv",new $t(t,2))):(Rc.addAttribute("position",new $t(e,3)),Rc.addAttribute("uv",new $t(t,2)))}return Rc}var za=class{constructor(e="Pass",t=new Js,r=mze){this.name=e,this.renderer=null,this.scene=t,this.camera=r,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}get renderToScreen(){return!this.rtt}set renderToScreen(e){if(this.rtt===e){let t=this.getFullscreenMaterial();t!==null&&(t.needsUpdate=!0),this.rtt=!e}}setRenderer(e){this.renderer=e}isEnabled(){return this.enabled}setEnabled(e){this.enabled=e}get fullscreenMaterial(){return this.screen!==null?this.screen.material:null}set fullscreenMaterial(e){let t=this.screen;t!==null?t.material=e:(t=new Di(vze(),e),t.frustumCulled=!1,this.scene===null&&(this.scene=new Js),this.scene.add(t),this.screen=t)}getFullscreenMaterial(){return this.fullscreenMaterial}setFullscreenMaterial(e){this.fullscreenMaterial=e}getDepthTexture(){return null}setDepthTexture(e,t=pc){}render(e,t,r,i,n){throw new Error("Render method not implemented!")}setSize(e,t){}initialize(e,t,r){}dispose(){for(let e of Object.keys(this)){let t=this[e];if(t!==null&&typeof t=="object"&&typeof t.dispose=="function"){if(t instanceof Js||t===this.renderer)continue;this[e].dispose()}}}},nE=class extends za{constructor(e,t=!0){super("CopyPass"),this.fullscreenMaterial=new tze,this.needsSwap=!1,this.renderTarget=e,e===void 0&&(this.renderTarget=new Ur(1,1,{minFilter:ur,magFilter:ur,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="CopyPass.Target"),this.autoResize=t}get resize(){return this.autoResize}set resize(e){this.autoResize=e}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}setAutoResizeEnabled(e){this.autoResize=e}render(e,t,r,i,n){this.fullscreenMaterial.inputBuffer=t.texture,e.setRenderTarget(this.renderToScreen?null:this.renderTarget),e.render(this.scene,this.camera)}setSize(e,t){this.autoResize&&this.renderTarget.setSize(e,t)}initialize(e,t,r){r!==void 0&&(this.renderTarget.texture.type=r,r!==ga?this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1":e.outputEncoding===sr&&(this.renderTarget.texture.encoding=sr))}},gze=class extends za{constructor(){super("ClearMaskPass",null,null),this.needsSwap=!1}render(e,t,r,i,n){let a=e.state.buffers.stencil;a.setLocked(!1),a.setTest(!1)}},e_=new Lt,dD=class extends za{constructor(e=!0,t=!0,r=!1){super("ClearPass",null,null),this.needsSwap=!1,this.color=e,this.depth=t,this.stencil=r,this.overrideClearColor=null,this.overrideClearAlpha=-1}setClearFlags(e,t,r){this.color=e,this.depth=t,this.stencil=r}getOverrideClearColor(){return this.overrideClearColor}setOverrideClearColor(e){this.overrideClearColor=e}getOverrideClearAlpha(){return this.overrideClearAlpha}setOverrideClearAlpha(e){this.overrideClearAlpha=e}render(e,t,r,i,n){let a=this.overrideClearColor,o=this.overrideClearAlpha,s=e.getClearAlpha(),l=a!==null,c=o>=0;l?(e_.copy(e.getClearColor(e_)),e.setClearColor(a,c?o:s)):c&&e.setClearAlpha(o),e.setRenderTarget(this.renderToScreen?null:t),e.clear(this.color,this.depth,this.stencil),l?e.setClearColor(e_,s):c&&e.setClearAlpha(s)}},Ic=-1,qa=class extends aa{constructor(e,t=Ic,r=Ic,i=1){super(),this.resizable=e,this.base=new ye(1,1),this.preferred=new ye(t,r),this.target=this.preferred,this.s=i}get width(){let{base:e,preferred:t,scale:r}=this,i;return t.width!==Ic?i=t.width:t.height!==Ic?i=Math.round(t.height*(e.width/Math.max(e.height,1))):i=Math.round(e.width*r),i}set width(e){this.preferredWidth=e}get height(){let{base:e,preferred:t,scale:r}=this,i;return t.height!==Ic?i=t.height:t.width!==Ic?i=Math.round(t.width/Math.max(e.width/Math.max(e.height,1),1)):i=Math.round(e.height*r),i}set height(e){this.preferredHeight=e}getWidth(){return this.width}getHeight(){return this.height}get scale(){return this.s}set scale(e){this.s!==e&&(this.s=e,this.preferred.setScalar(Ic),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getScale(){return this.scale}setScale(e){this.scale=e}get baseWidth(){return this.base.width}set baseWidth(e){this.base.width!==e&&(this.base.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getBaseWidth(){return this.base.width}setBaseWidth(e){this.base.width!==e&&(this.base.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}get baseHeight(){return this.base.height}set baseHeight(e){this.base.height!==e&&(this.base.height=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getBaseHeight(){return this.baseHeight}setBaseHeight(e){this.baseHeight=e}setBaseSize(e,t){(this.base.width!==e||this.base.height!==t)&&(this.base.set(e,t),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}get preferredWidth(){return this.preferred.width}set preferredWidth(e){this.preferred.width!==e&&(this.preferred.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getPreferredWidth(){return this.preferredWidth}setPreferredWidth(e){this.preferredWidth=e}get preferredHeight(){return this.preferred.height}set preferredHeight(e){this.preferred.height!==e&&(this.preferred.height=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getPreferredHeight(){return this.preferredHeight}setPreferredHeight(e){this.preferredHeight=e}setPreferredSize(e,t){(this.preferred.width!==e||this.preferred.height!==t)&&(this.preferred.set(e,t),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}copy(e){this.base.set(e.getBaseWidth(),e.getBaseHeight()),this.preferred.set(e.getPreferredWidth(),e.getPreferredHeight()),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height)}static get AUTO_SIZE(){return Ic}},t_=!1,RB=class{constructor(e=null){this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.materialsFlatShaded=null,this.materialsFlatShadedBackSide=null,this.materialsFlatShadedDoubleSide=null,this.setMaterial(e),this.meshCount=0,this.replaceMaterial=t=>{if(t.isMesh){let r;if(t.material.flatShading)switch(t.material.side){case fa:r=this.materialsFlatShadedDoubleSide;break;case Ln:r=this.materialsFlatShadedBackSide;break;default:r=this.materialsFlatShaded;break}else switch(t.material.side){case fa:r=this.materialsDoubleSide;break;case Ln:r=this.materialsBackSide;break;default:r=this.materials;break}this.originalMaterials.set(t,t.material),t.isSkinnedMesh?t.material=r[2]:t.isInstancedMesh?t.material=r[1]:t.material=r[0],++this.meshCount}}}setMaterial(e){if(this.disposeMaterials(),this.material=e,e!==null){let t=this.materials=[e.clone(),e.clone(),e.clone()];for(let r of t)r.uniforms=Object.assign({},e.uniforms),r.side=us;t[2].skinning=!0,this.materialsBackSide=t.map(r=>{let i=r.clone();return i.uniforms=Object.assign({},e.uniforms),i.side=Ln,i}),this.materialsDoubleSide=t.map(r=>{let i=r.clone();return i.uniforms=Object.assign({},e.uniforms),i.side=fa,i}),this.materialsFlatShaded=t.map(r=>{let i=r.clone();return i.uniforms=Object.assign({},e.uniforms),i.flatShading=!0,i}),this.materialsFlatShadedBackSide=t.map(r=>{let i=r.clone();return i.uniforms=Object.assign({},e.uniforms),i.flatShading=!0,i.side=Ln,i}),this.materialsFlatShadedDoubleSide=t.map(r=>{let i=r.clone();return i.uniforms=Object.assign({},e.uniforms),i.flatShading=!0,i.side=fa,i})}}render(e,t,r){let i=e.shadowMap.enabled;if(e.shadowMap.enabled=!1,t_){let n=this.originalMaterials;this.meshCount=0,t.traverse(this.replaceMaterial),e.render(t,r);for(let a of n)a[0].material=a[1];this.meshCount!==n.size&&n.clear()}else{let n=t.overrideMaterial;t.overrideMaterial=this.material,e.render(t,r),t.overrideMaterial=n}e.shadowMap.enabled=i}disposeMaterials(){if(this.material!==null){let e=this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide).concat(this.materialsFlatShaded).concat(this.materialsFlatShadedBackSide).concat(this.materialsFlatShadedDoubleSide);for(let t of e)t.dispose()}}dispose(){this.originalMaterials.clear(),this.disposeMaterials()}static get workaroundEnabled(){return t_}static set workaroundEnabled(e){t_=e}},yze=class extends za{constructor(e,t,r=null){super("RenderPass",e,t),this.needsSwap=!1,this.clearPass=new dD,this.overrideMaterialManager=r===null?null:new RB(r),this.ignoreBackground=!1,this.skipShadowMapUpdate=!1,this.selection=null}get renderToScreen(){return super.renderToScreen}set renderToScreen(e){super.renderToScreen=e,this.clearPass.renderToScreen=e}get overrideMaterial(){let e=this.overrideMaterialManager;return e!==null?e.material:null}set overrideMaterial(e){let t=this.overrideMaterialManager;e!==null?t!==null?t.setMaterial(e):this.overrideMaterialManager=new RB(e):t!==null&&(t.dispose(),this.overrideMaterialManager=null)}getOverrideMaterial(){return this.overrideMaterial}setOverrideMaterial(e){this.overrideMaterial=e}get clear(){return this.clearPass.enabled}set clear(e){this.clearPass.enabled=e}getSelection(){return this.selection}setSelection(e){this.selection=e}isBackgroundDisabled(){return this.ignoreBackground}setBackgroundDisabled(e){this.ignoreBackground=e}isShadowMapDisabled(){return this.skipShadowMapUpdate}setShadowMapDisabled(e){this.skipShadowMapUpdate=e}getClearPass(){return this.clearPass}render(e,t,r,i,n){let a=this.scene,o=this.camera,s=this.selection,l=o.layers.mask,c=a.background,d=e.shadowMap.autoUpdate,u=this.renderToScreen?null:t;s!==null&&o.layers.set(s.getLayer()),this.skipShadowMapUpdate&&(e.shadowMap.autoUpdate=!1),(this.ignoreBackground||this.clearPass.overrideClearColor!==null)&&(a.background=null),this.clearPass.enabled&&this.clearPass.render(e,t),e.setRenderTarget(u),this.overrideMaterialManager!==null?this.overrideMaterialManager.render(e,a,o):e.render(a,o),o.layers.mask=l,a.background=c,e.shadowMap.autoUpdate=d}},IB=class extends za{constructor(e,t,{resolutionScale:r=1,width:i=qa.AUTO_SIZE,height:n=qa.AUTO_SIZE,renderTarget:a}={}){super("DepthPass"),this.needsSwap=!1,this.renderPass=new yze(e,t,new Sj({depthPacking:lj}));let o=this.renderPass;o.skipShadowMapUpdate=!0,o.ignoreBackground=!0;let s=o.getClearPass();s.overrideClearColor=new Lt(16777215),s.overrideClearAlpha=1,this.renderTarget=a,this.renderTarget===void 0&&(this.renderTarget=new Ur(1,1,{minFilter:Hr,magFilter:Hr,stencilBuffer:!1}),this.renderTarget.texture.name="DepthPass.Target");let l=this.resolution=new qa(this,i,n,r);l.addEventListener("change",c=>this.setSize(l.baseWidth,l.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}render(e,t,r,i,n){let a=this.renderToScreen?null:this.renderTarget;this.renderPass.render(e,a)}setSize(e,t){let r=this.resolution;r.setBaseSize(e,t),this.renderTarget.setSize(r.width,r.height)}},Tr={SKIP:0,ADD:1,ALPHA:2,AVERAGE:3,COLOR_BURN:4,COLOR_DODGE:5,DARKEN:6,DIFFERENCE:7,EXCLUSION:8,LIGHTEN:9,MULTIPLY:10,DIVIDE:11,NEGATION:12,NORMAL:13,OVERLAY:14,REFLECT:15,SCREEN:16,SOFT_LIGHT:17,SUBTRACT:18},bze="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return min(x+y,1.0)*opacity+x*(1.0-opacity);}",xze="vec3 blend(const in vec3 x,const in vec3 y,const in float opacity){return y*opacity+x*(1.0-opacity);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){float a=min(y.a,opacity);return vec4(blend(x.rgb,y.rgb,a),max(x.a,a));}",wze="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(x+y)*0.5*opacity+x*(1.0-opacity);}",Sze="float blend(const in float x,const in float y){return(y==0.0)?y:max(1.0-(1.0-x)/y,0.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",Cze="float blend(const in float x,const in float y){return(y==1.0)?y:min(x/(1.0-y),1.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",_ze="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return min(x,y)*opacity+x*(1.0-opacity);}",Aze="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return abs(x-y)*opacity+x*(1.0-opacity);}",Mze="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(x+y-2.0*x*y)*opacity+x*(1.0-opacity);}",Eze="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return max(x,y)*opacity+x*(1.0-opacity);}",Tze="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return x*y*opacity+x*(1.0-opacity);}",Pze="float blend(const in float x,const in float y){return(y>0.0)?min(x/y,1.0):1.0;}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",Dze="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(1.0-abs(1.0-x-y))*opacity+x*(1.0-opacity);}",Oze="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return y*opacity+x*(1.0-opacity);}",Rze="float blend(const in float x,const in float y){return(x<0.5)?(2.0*x*y):(1.0-2.0*(1.0-x)*(1.0-y));}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",Ize="float blend(const in float x,const in float y){return(y==1.0)?y:min(x*x/(1.0-y),1.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",zze="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(1.0-(1.0-x)*(1.0-y))*opacity+x*(1.0-opacity);}",kze="float blend(const in float x,const in float y){return(y<0.5)?(2.0*x*y+x*x*(1.0-2.0*y)):(sqrt(x)*(2.0*y-1.0)+2.0*x*(1.0-y));}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",Lze="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return max(x+y-1.0,0.0)*opacity+x*(1.0-opacity);}",Bze=new Map([[Tr.SKIP,null],[Tr.ADD,bze],[Tr.ALPHA,xze],[Tr.AVERAGE,wze],[Tr.COLOR_BURN,Sze],[Tr.COLOR_DODGE,Cze],[Tr.DARKEN,_ze],[Tr.DIFFERENCE,Aze],[Tr.EXCLUSION,Mze],[Tr.LIGHTEN,Eze],[Tr.MULTIPLY,Tze],[Tr.DIVIDE,Pze],[Tr.NEGATION,Dze],[Tr.NORMAL,Oze],[Tr.OVERLAY,Rze],[Tr.REFLECT,Ize],[Tr.SCREEN,zze],[Tr.SOFT_LIGHT,kze],[Tr.SUBTRACT,Lze]]),Fze=class extends aa{constructor(e,t=1){super(),this.f=e,this.opacity=new rt(t)}getOpacity(){return this.opacity.value}setOpacity(e){this.opacity.value=e}get blendFunction(){return this.f}set blendFunction(e){this.f=e,this.dispatchEvent({type:"change"})}getBlendFunction(){return this.blendFunction}setBlendFunction(e){this.blendFunction=e}getShaderCode(){return Bze.get(this.blendFunction)}},el={NONE:0,DEPTH:1,CONVOLUTION:2},pl=class extends aa{constructor(e,t,{attributes:r=el.NONE,blendFunction:i=Tr.SCREEN,defines:n=new Map,uniforms:a=new Map,extensions:o=null,vertexShader:s=null}={}){super(),this.name=e,this.renderer=null,this.attributes=r,this.fragmentShader=t,this.vertexShader=s,this.defines=n,this.uniforms=a,this.extensions=o,this.blendMode=new Fze(i),this.blendMode.addEventListener("change",l=>this.setChanged())}getName(){return this.name}setRenderer(e){this.renderer=e}getDefines(){return this.defines}getUniforms(){return this.uniforms}getExtensions(){return this.extensions}getBlendMode(){return this.blendMode}getAttributes(){return this.attributes}setAttributes(e){this.attributes=e,this.setChanged()}getFragmentShader(){return this.fragmentShader}setFragmentShader(e){this.fragmentShader=e,this.setChanged()}getVertexShader(){return this.vertexShader}setVertexShader(e){this.vertexShader=e,this.setChanged()}setChanged(){this.dispatchEvent({type:"change"})}setDepthTexture(e,t=pc){}update(e,t,r){}setSize(e,t){}initialize(e,t,r){}dispose(){for(let e of Object.keys(this)){let t=this[e];if(t!==null&&typeof t=="object"&&typeof t.dispose=="function"){if(t instanceof Js||t===this.renderer)continue;this[e].dispose()}}}};function zB(e,t,r){for(let i of t){let n="$1"+e+i.charAt(0).toUpperCase()+i.slice(1),a=new RegExp("([^\\.])(\\b"+i+"\\b)","g");for(let o of r.entries())o[1]!==null&&r.set(o[0],o[1].replace(a,n))}}function Nze(e,t,r,i,n,a,o){let s=new Map([["fragment",t.getFragmentShader()],["vertex",t.getVertexShader()]]),l=s.get("fragment")!==void 0&&/mainImage/.test(s.get("fragment")),c=s.get("fragment")!==void 0&&/mainUv/.test(s.get("fragment")),d=[],u=[],h=!1,f=!1;if(s.get("fragment")===void 0)console.error("Missing fragment shader",t);else if(c&&o&el.CONVOLUTION)console.error("Effects that transform UV coordinates are incompatible with convolution effects",t);else if(!l&&!c)console.error("The fragment shader contains neither a mainImage nor a mainUv function",t);else{let p=/(?:\w+\s+(\w+)\([\w\s,]*\)\s*{[^}]+})/g,v=iE.Section;if(c){let g=`	${e}MainUv(UV);
`;r.set(v.FRAGMENT_MAIN_UV,r.get(v.FRAGMENT_MAIN_UV)+g),h=!0}if(s.get("vertex")!==null&&/mainSupport/.test(s.get("vertex"))){let g=`	${e}MainSupport(`;g+=/mainSupport *\([\w\s]*?uv\s*?\)/.test(s.get("vertex"))?`vUv);
`:`);
`,r.set(v.VERTEX_MAIN_SUPPORT,r.get(v.VERTEX_MAIN_SUPPORT)+g),d=d.concat([...s.get("vertex").matchAll(/(?:varying\s+\w+\s+(\w*))/g)].map(y=>y[1])),u=u.concat(d).concat([...s.get("vertex").matchAll(p)].map(y=>y[1]))}u=u.concat([...s.get("fragment").matchAll(p)].map(g=>g[1])),u=u.concat([...t.defines.keys()].map(g=>g.replace(/\([\w\s,]*\)/g,""))),u=u.concat([...t.uniforms.keys()]),t.uniforms.forEach((g,y)=>a.set(e+y.charAt(0).toUpperCase()+y.slice(1),g)),t.defines.forEach((g,y)=>n.set(e+y.charAt(0).toUpperCase()+y.slice(1),g)),zB(e,u,n),zB(e,u,s);let m=t.blendMode;if(i.set(m.blendFunction,m),l){let g=/MainImage *\([\w\s,]*?depth[\w\s,]*?\)/,y=`${e}MainImage(color0, UV, `;o&el.DEPTH&&g.test(s.get("fragment"))&&(y+="depth, ",f=!0),y+=`color1);
	`;let b=e+"BlendOpacity";a.set(b,m.opacity),y+=`color0 = blend${m.blendFunction}(color0, color1, ${b});

	`,r.set(v.FRAGMENT_MAIN_IMAGE,r.get(v.FRAGMENT_MAIN_IMAGE)+y),y=`uniform float ${b};

`,r.set(v.FRAGMENT_HEAD,r.get(v.FRAGMENT_HEAD)+y)}r.set(v.FRAGMENT_HEAD,r.get(v.FRAGMENT_HEAD)+s.get("fragment")+`
`),s.get("vertex")!==null&&r.set(v.VERTEX_HEAD,r.get(v.VERTEX_HEAD)+s.get("vertex")+`
`)}return{varyings:d,transformedUv:h,readDepth:f}}var t1=class extends za{constructor(e,...t){super("EffectPass"),this.fullscreenMaterial=new iE(null,null,null,e),this.effects=t.sort((r,i)=>i.attributes-r.attributes),this.skipRendering=!1,this.uniformCount=0,this.varyingCount=0,this.minTime=1,this.maxTime=Number.POSITIVE_INFINITY}get encodeOutput(){return this.fullscreenMaterial.encodeOutput}set encodeOutput(e){this.fullscreenMaterial.encodeOutput=e}get dithering(){return this.fullscreenMaterial.dithering}set dithering(e){let t=this.fullscreenMaterial;t.dithering=e,t.needsUpdate=!0}verifyResources(){let e=this.renderer.capabilities,t=Math.min(e.maxFragmentUniforms,e.maxVertexUniforms);this.uniformCount>t&&console.warn("The current rendering context doesn't support more than "+t+" uniforms, but "+this.uniformCount+" were defined"),t=e.maxVaryings,this.varyingCount>t&&console.warn("The current rendering context doesn't support more than "+t+" varyings, but "+this.varyingCount+" were defined")}updateMaterial(){let e=iE.Section,t=new Map([[e.FRAGMENT_HEAD,""],[e.FRAGMENT_MAIN_UV,""],[e.FRAGMENT_MAIN_IMAGE,""],[e.VERTEX_HEAD,""],[e.VERTEX_MAIN_SUPPORT,""]]),r=new Map,i=new Map,n=new Map,a=new Set,o=0,s=0,l=0,c=!1,d=!1;for(let h of this.effects)if(h.blendMode.blendFunction===Tr.SKIP)l|=h.getAttributes()&el.DEPTH;else if(l&h.getAttributes()&el.CONVOLUTION)console.error("Convolution effects cannot be merged",h);else{l|=h.getAttributes();let f="e"+o++,p=Nze(f,h,t,r,i,n,l);if(s+=p.varyings.length,c=c||p.transformedUv,d=d||p.readDepth,h.extensions!==null)for(let v of h.extensions)a.add(v)}let u=/\bblend\b/g;for(let h of r.values()){let f=h.getShaderCode().replace(u,`blend${h.blendFunction}`);t.set(e.FRAGMENT_HEAD,t.get(e.FRAGMENT_HEAD)+f+`
`)}l&el.DEPTH?(d&&t.set(e.FRAGMENT_MAIN_IMAGE,`float depth = readDepth(UV);

	`+t.get(e.FRAGMENT_MAIN_IMAGE)),this.needsDepthTexture=this.getDepthTexture()===null):this.needsDepthTexture=!1,c?(t.set(e.FRAGMENT_MAIN_UV,`vec2 transformedUv = vUv;
`+t.get(e.FRAGMENT_MAIN_UV)),i.set("UV","transformedUv")):i.set("UV","vUv"),t.forEach((h,f,p)=>p.set(f,h.trim().replace(/^#/,`
#`))),this.uniformCount=n.size,this.varyingCount=s,this.skipRendering=o===0,this.needsSwap=!this.skipRendering,this.fullscreenMaterial.setShaderParts(t).setExtensions(a).setUniforms(n).setDefines(i)}recompile(){this.updateMaterial(),this.verifyResources()}getDepthTexture(){return this.fullscreenMaterial.depthBuffer}setDepthTexture(e,t=pc){this.fullscreenMaterial.depthBuffer=e,this.fullscreenMaterial.depthPacking=t;for(let r of this.effects)r.setDepthTexture(e,t)}render(e,t,r,i,n){for(let a of this.effects)a.update(e,t,i);if(!this.skipRendering||this.renderToScreen){let a=this.fullscreenMaterial;a.inputBuffer=t.texture,a.time+=i,e.setRenderTarget(this.renderToScreen?null:r),e.render(this.scene,this.camera)}}setSize(e,t){this.fullscreenMaterial.setSize(e,t);for(let r of this.effects)r.setSize(e,t)}initialize(e,t,r){this.renderer=e;for(let i of this.effects)i.initialize(e,t,r),i.addEventListener("change",n=>this.handleEvent(n));this.updateMaterial(),this.verifyResources(),r!==void 0&&r!==ga&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}dispose(){super.dispose();for(let e of this.effects)e.dispose()}handleEvent(e){switch(e.type){case"change":this.recompile();break}}},Uze=[new Float32Array([0,0]),new Float32Array([0,1,1]),new Float32Array([0,1,1,2]),new Float32Array([0,1,2,2,3]),new Float32Array([0,1,2,3,4,4,5]),new Float32Array([0,1,2,3,4,5,7,8,9,10])],uD=class extends za{constructor({resolutionScale:e=.5,width:t=qa.AUTO_SIZE,height:r=qa.AUTO_SIZE,kernelSize:i=vw.LARGE}={}){super("KawaseBlurPass"),this.renderTargetA=new Ur(1,1,{minFilter:ur,magFilter:ur,stencilBuffer:!1,depthBuffer:!1}),this.renderTargetA.texture.name="Blur.Target.A",this.renderTargetB=this.renderTargetA.clone(),this.renderTargetB.texture.name="Blur.Target.B";let n=this.resolution=new qa(this,t,r,e);n.addEventListener("change",a=>this.setSize(n.baseWidth,n.baseHeight)),this.blurMaterial=new OB,this.ditheredBlurMaterial=new OB,this.ditheredBlurMaterial.uniforms.scale=this.blurMaterial.uniforms.scale,this.ditheredBlurMaterial.dithering=!0,this.dithering=!1,this.kernelSize=i}getResolution(){return this.resolution}get width(){return this.resolution.width}set width(e){this.resolution.preferredWidth=e}get height(){return this.resolution.height}set height(e){this.resolution.preferredHeight=e}get scale(){return this.blurMaterial.scale}set scale(e){this.blurMaterial.scale=e}getScale(){return this.blurMaterial.scale}setScale(e){this.blurMaterial.scale=e}getKernelSize(){return this.kernelSize}setKernelSize(e){this.kernelSize=e}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}render(e,t,r,i,n){let a=this.scene,o=this.camera,s=this.renderTargetA,l=this.renderTargetB,c=Uze[this.kernelSize],d=this.blurMaterial,u=t,h,f;for(this.fullscreenMaterial=d,h=0,f=c.length-1;h<f;++h){let p=h&1?l:s;d.kernel=c[h],d.inputBuffer=u.texture,e.setRenderTarget(p),e.render(a,o),u=p}this.dithering&&(d=this.ditheredBlurMaterial,this.fullscreenMaterial=d),d.kernel=c[h],d.inputBuffer=u.texture,e.setRenderTarget(this.renderToScreen?null:r),e.render(a,o)}setSize(e,t){let r=this.resolution;r.setBaseSize(e,t);let i=r.width,n=r.height;this.renderTargetA.setSize(i,n),this.renderTargetB.setSize(i,n),this.blurMaterial.setSize(i,n),this.ditheredBlurMaterial.setSize(i,n)}initialize(e,t,r){r!==void 0&&(this.renderTargetA.texture.type=r,this.renderTargetB.texture.type=r,r!==ga?(this.blurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.ditheredBlurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1"):e.outputEncoding===sr&&(this.renderTargetA.texture.encoding=sr,this.renderTargetB.texture.encoding=sr))}static get AUTO_SIZE(){return qa.AUTO_SIZE}},jze=class extends za{constructor({width:e=qa.AUTO_SIZE,height:t=qa.AUTO_SIZE,renderTarget:r,luminanceRange:i,colorOutput:n}={}){super("LuminancePass"),this.fullscreenMaterial=new cze(n,i),this.needsSwap=!1,this.renderTarget=r,this.renderTarget===void 0&&(this.renderTarget=new Ur(1,1,{minFilter:ur,magFilter:ur,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="LuminancePass.Target",this.renderTarget.texture.generateMipmaps=!1);let a=this.resolution=new qa(this,e,t);a.addEventListener("change",o=>this.setSize(a.baseWidth,a.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}render(e,t,r,i,n){let a=this.fullscreenMaterial;a.inputBuffer=t.texture,e.setRenderTarget(this.renderToScreen?null:this.renderTarget),e.render(this.scene,this.camera)}setSize(e,t){let r=this.resolution;r.setBaseSize(e,t),this.renderTarget.setSize(r.width,r.height)}initialize(e,t,r){r!==void 0&&r!==ga&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},Vze=class extends za{constructor(e,t){super("MaskPass",e,t),this.needsSwap=!1,this.clearPass=new dD(!1,!1,!0),this.inverse=!1}get inverted(){return this.inverse}set inverted(e){this.inverse=e}get clear(){return this.clearPass.enabled}set clear(e){this.clearPass.enabled=e}getClearPass(){return this.clearPass}isInverted(){return this.inverted}setInverted(e){this.inverted=e}render(e,t,r,i,n){let a=e.getContext(),o=e.state.buffers,s=this.scene,l=this.camera,c=this.clearPass,d=this.inverted?0:1,u=1-d;o.color.setMask(!1),o.depth.setMask(!1),o.color.setLocked(!0),o.depth.setLocked(!0),o.stencil.setTest(!0),o.stencil.setOp(a.REPLACE,a.REPLACE,a.REPLACE),o.stencil.setFunc(a.ALWAYS,d,4294967295),o.stencil.setClear(u),o.stencil.setLocked(!0),this.clearPass.enabled&&(this.renderToScreen?c.render(e,null):(c.render(e,t),c.render(e,r))),this.renderToScreen?(e.setRenderTarget(null),e.render(s,l)):(e.setRenderTarget(t),e.render(s,l),e.setRenderTarget(r),e.render(s,l)),o.color.setLocked(!1),o.depth.setLocked(!1),o.stencil.setLocked(!1),o.stencil.setFunc(a.EQUAL,1,4294967295),o.stencil.setOp(a.KEEP,a.KEEP,a.KEEP),o.stencil.setLocked(!0)}},Zo=class extends za{constructor(e,t="inputBuffer"){super("ShaderPass"),this.fullscreenMaterial=e,this.inputBufferUniform=null,this.setInput(t)}setInput(e){if(this.inputBufferUniform=null,this.fullscreenMaterial!==null){let t=this.fullscreenMaterial.uniforms;t!==void 0&&t[e]!==void 0&&(this.inputBufferUniform=t[e])}}render(e,t,r,i,n){this.inputBufferUniform!==null&&t!==null&&(this.inputBufferUniform.value=t.texture),e.setRenderTarget(this.renderToScreen?null:r),e.render(this.scene,this.camera)}initialize(e,t,r){r!==void 0&&r!==ga&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},r_=1/1e3,Hze=1e3,Wze=class{constructor(){this.previousTime=0,this.currentTime=0,this.delta=0,this.fixedDelta=1e3/60,this.elapsed=0,this.timescale=1,this.fixedDeltaEnabled=!1,this.autoReset=!1}setFixedDeltaEnabled(e){return this.fixedDeltaEnabled=e,this}isAutoResetEnabled(e){return this.autoReset}setAutoResetEnabled(e){return typeof document<"u"&&document.hidden!==void 0&&(e?document.addEventListener("visibilitychange",this):document.removeEventListener("visibilitychange",this),this.autoReset=e),this}getDelta(){return this.delta*r_}getFixedDelta(){return this.fixedDelta*r_}setFixedDelta(e){return this.fixedDelta=e*Hze,this}getElapsed(){return this.elapsed*r_}getTimescale(){return this.timescale}setTimescale(e){return this.timescale=e,this}update(e){return this.fixedDeltaEnabled?this.delta=this.fixedDelta:(this.previousTime=this.currentTime,this.currentTime=e!==void 0?e:performance.now(),this.delta=this.currentTime-this.previousTime),this.delta*=this.timescale,this.elapsed+=this.delta,this}reset(){return this.delta=0,this.elapsed=0,this.currentTime=performance.now(),this}handleEvent(e){document.hidden||(this.currentTime=performance.now())}dispose(){this.setAutoResetEnabled(!1)}},vw={VERY_SMALL:0,SMALL:1,MEDIUM:2,LARGE:3,VERY_LARGE:4,HUGE:5},Gze=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D map;
#else
uniform lowp sampler2D map;
#endif
uniform float intensity;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=clamp(texture2D(map,uv)*intensity,0.0,1.0);}`,$ze=class extends pl{constructor({blendFunction:e=Tr.SCREEN,luminanceThreshold:t=.9,luminanceSmoothing:r=.025,resolutionScale:i=.5,intensity:n=1,width:a=qa.AUTO_SIZE,height:o=qa.AUTO_SIZE,kernelSize:s=vw.LARGE}={}){super("BloomEffect",Gze,{blendFunction:e,uniforms:new Map([["map",new rt(null)],["intensity",new rt(n)]])}),this.renderTarget=new Ur(1,1,{minFilter:ur,magFilter:ur,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="Bloom.Target",this.renderTarget.texture.generateMipmaps=!1,this.uniforms.get("map").value=this.renderTarget.texture,this.luminancePass=new jze({renderTarget:this.renderTarget,colorOutput:!0}),this.luminanceMaterial.threshold=t,this.luminanceMaterial.smoothingFactor=r,this.blurPass=new uD({resolutionScale:i,width:a,height:o,kernelSize:s});let l=this.blurPass.getResolution();l.addEventListener("change",c=>this.setSize(l.baseWidth,l.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}get resolution(){return this.blurPass.resolution}getResolution(){return this.blurPass.resolution}getBlurPass(){return this.blurPass}getLuminancePass(){return this.luminancePass}get luminanceMaterial(){return this.luminancePass.fullscreenMaterial}getLuminanceMaterial(){return this.luminancePass.fullscreenMaterial}get width(){return this.resolution.width}set width(e){this.resolution.preferredWidth=e}get height(){return this.resolution.height}set height(e){this.resolution.preferredHeight=e}get dithering(){return this.blurPass.dithering}set dithering(e){this.blurPass.dithering=e}get kernelSize(){return this.blurPass.kernelSize}set kernelSize(e){this.blurPass.kernelSize=e}get distinction(){return console.warn(this.name,"distinction was removed"),1}set distinction(e){console.warn(this.name,"distinction was removed")}get intensity(){return this.uniforms.get("intensity").value}set intensity(e){this.uniforms.get("intensity").value=e}getIntensity(){return this.intensity}setIntensity(e){this.intensity=e}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}update(e,t,r){let i=this.renderTarget;this.luminancePass.enabled?(this.luminancePass.render(e,t,i),this.blurPass.render(e,i,i)):this.blurPass.render(e,t,i)}setSize(e,t){let r=this.resolution;r.setBaseSize(e,t),this.renderTarget.setSize(r.width,r.height),this.luminancePass.resolution.copy(r)}initialize(e,t,r){this.blurPass.initialize(e,t,r),r!==void 0&&(this.renderTarget.texture.type=r,e.outputEncoding===sr&&(this.renderTarget.texture.encoding=sr))}},qze="uniform float brightness;uniform float contrast;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=inputColor.rgb+vec3(brightness-0.5);if(contrast>0.0){color/=vec3(1.0-contrast);}else{color*=vec3(1.0+contrast);}outputColor=vec4(min(color+vec3(0.5),1.0),inputColor.a);}",Yze=class extends pl{constructor({blendFunction:e=Tr.NORMAL,brightness:t=0,contrast:r=0}={}){super("BrightnessContrastEffect",qze,{blendFunction:e,uniforms:new Map([["brightness",new rt(t)],["contrast",new rt(r)]])})}get brightness(){return this.uniforms.get("brightness").value}set brightness(e){this.uniforms.get("brightness").value=e}getBrightness(e){return this.brightness}setBrightness(e){this.brightness=e}get contrast(){return this.uniforms.get("contrast").value}set contrast(e){this.uniforms.get("contrast").value=e}getContrast(e){return this.contrast}setContrast(e){this.contrast=e}},Xze="void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=vec4(vec3(average(inputColor.rgb)),inputColor.a);}",Kze=class extends pl{constructor(e=Tr.NORMAL){super("ColorAverageEffect",Xze,{blendFunction:e})}},Qze="varying vec2 vUvR;varying vec2 vUvB;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec2 ra=texture2D(inputBuffer,vUvR).ra;vec2 ba=texture2D(inputBuffer,vUvB).ba;outputColor=vec4(ra.x,inputColor.g,ba.x,max(max(ra.y,ba.y),inputColor.a));}",Zze="uniform vec2 offset;varying vec2 vUvR;varying vec2 vUvB;void mainSupport(const in vec2 uv){vec2 shift=offset*vec2(1.0,aspect);vUvR=uv+shift;vUvB=uv-shift;}",Jze=class extends pl{constructor({blendFunction:e=Tr.NORMAL,offset:t=new ye(.001,5e-4)}={}){super("ChromaticAberrationEffect",Qze,{vertexShader:Zze,blendFunction:e,attributes:el.CONVOLUTION,uniforms:new Map([["offset",new rt(t)]])})}get offset(){return this.uniforms.get("offset").value}set offset(e){this.uniforms.get("offset").value=e}getOffset(){return this.offset}setOffset(e){this.offset=e}},eke=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D nearColorBuffer;uniform mediump sampler2D farColorBuffer;
#else
uniform lowp sampler2D nearColorBuffer;uniform lowp sampler2D farColorBuffer;
#endif
uniform lowp sampler2D nearCoCBuffer;uniform float scale;void mainImage(const in vec4 inputColor,const in vec2 uv,const in float depth,out vec4 outputColor){vec4 colorNear=texture2D(nearColorBuffer,uv);vec4 colorFar=texture2D(farColorBuffer,uv);float CoCNear=texture2D(nearCoCBuffer,uv).r;CoCNear=min(CoCNear*scale,1.0);vec4 result=inputColor*(1.0-colorFar.a)+colorFar;result=mix(result,colorNear,CoCNear);outputColor=result;}`,tke=class extends pl{constructor(e,{blendFunction:t=Tr.NORMAL,worldFocusDistance:r,worldFocusRange:i,focusDistance:n=0,focalLength:a=.1,focusRange:o=a,bokehScale:s=1,width:l=qa.AUTO_SIZE,height:c=qa.AUTO_SIZE}={}){super("DepthOfFieldEffect",eke,{blendFunction:t,attributes:el.DEPTH,uniforms:new Map([["nearColorBuffer",new rt(null)],["farColorBuffer",new rt(null)],["nearCoCBuffer",new rt(null)],["scale",new rt(1)]])}),this.camera=e,this.renderTarget=new Ur(1,1,{minFilter:ur,magFilter:ur,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="DoF.Intermediate",this.renderTarget.texture.generateMipmaps=!1,this.renderTargetMasked=this.renderTarget.clone(),this.renderTargetMasked.texture.name="DoF.Masked.Far",this.renderTargetNear=this.renderTarget.clone(),this.renderTargetNear.texture.name="DoF.Bokeh.Near",this.uniforms.get("nearColorBuffer").value=this.renderTargetNear.texture,this.renderTargetFar=this.renderTarget.clone(),this.renderTargetFar.texture.name="DoF.Bokeh.Far",this.uniforms.get("farColorBuffer").value=this.renderTargetFar.texture,this.renderTargetCoC=this.renderTarget.clone(),this.renderTargetCoC.texture.name="DoF.CoC",this.renderTargetCoCBlurred=this.renderTargetCoC.clone(),this.renderTargetCoCBlurred.texture.name="DoF.CoC.Blurred",this.uniforms.get("nearCoCBuffer").value=this.renderTargetCoCBlurred.texture,this.cocPass=new Zo(new QIe(e));let d=this.cocMaterial;d.focusDistance=n,d.focusRange=o,r!==void 0&&(d.worldFocusDistance=r),i!==void 0&&(d.worldFocusRange=i),this.blurPass=new uD({kernelSize:vw.MEDIUM,width:l,height:c});let u=this.blurPass.getResolution();u.addEventListener("change",f=>this.setSize(u.getBaseWidth(),u.getBaseHeight())),this.maskPass=new Zo(new uze(this.renderTargetCoC.texture));let h=this.maskPass.fullscreenMaterial;h.maskFunction=BH.MULTIPLY,h.colorChannel=LH.GREEN,this.bokehNearBasePass=new Zo(new Gy(!1,!0)),this.bokehNearBasePass.fullscreenMaterial.cocBuffer=this.renderTargetCoCBlurred.texture,this.bokehNearFillPass=new Zo(new Gy(!0,!0)),this.bokehNearFillPass.fullscreenMaterial.cocBuffer=this.renderTargetCoCBlurred.texture,this.bokehFarBasePass=new Zo(new Gy(!1,!1)),this.bokehFarBasePass.fullscreenMaterial.cocBuffer=this.renderTargetCoC.texture,this.bokehFarFillPass=new Zo(new Gy(!0,!1)),this.bokehFarFillPass.fullscreenMaterial.cocBuffer=this.renderTargetCoC.texture,this.target=null,this.bokehScale=s}get cocTexture(){return this.renderTargetCoC.texture}get cocMaterial(){return this.cocPass.fullscreenMaterial}get circleOfConfusionMaterial(){return this.cocMaterial}getCircleOfConfusionMaterial(){return this.circleOfConfusionMaterial}getBlurPass(){return this.blurPass}get resolution(){return this.blurPass.getResolution()}getResolution(){return this.blurPass.getResolution()}get bokehScale(){return this.uniforms.get("scale").value}set bokehScale(e){let t=[this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass];for(let r of t)r.fullscreenMaterial.setScale(e);this.maskPass.fullscreenMaterial.setStrength(e),this.uniforms.get("scale").value=e}getBokehScale(){return this.bokehScale}setBokehScale(e){this.bokehScale=e}getTarget(){return this.target}setTarget(e){this.target=e}calculateFocusDistance(e){let t=this.camera,r=t.position.distanceTo(e);return rE(-r,t.near,t.far)}setDepthTexture(e,t=pc){this.circleOfConfusionMaterial.depthBuffer=e,this.circleOfConfusionMaterial.depthPacking=t}update(e,t,r){let i=this.renderTarget,n=this.renderTargetCoC,a=this.renderTargetCoCBlurred,o=this.renderTargetMasked;if(this.target!==null){let s=this.calculateFocusDistance(this.target);this.circleOfConfusionMaterial.focusDistance=s}this.cocPass.render(e,null,n),this.blurPass.render(e,n,a),this.maskPass.render(e,t,o),this.bokehFarBasePass.render(e,o,i),this.bokehFarFillPass.render(e,i,this.renderTargetFar),this.bokehNearBasePass.render(e,t,i),this.bokehNearFillPass.render(e,i,this.renderTargetNear)}setSize(e,t){let r=this.resolution;r.setBaseSize(e,t);let i=r.width,n=r.height,a=[this.cocPass,this.blurPass,this.maskPass,this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass];a.push(this.renderTargetCoC,this.renderTargetMasked),a.forEach(o=>o.setSize(e,t)),a=[this.renderTarget,this.renderTargetNear,this.renderTargetFar,this.renderTargetCoCBlurred],a.forEach(o=>o.setSize(i,n)),[this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass].forEach(o=>o.fullscreenMaterial.setSize(i,n))}initialize(e,t,r){[this.cocPass,this.maskPass,this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass].forEach(i=>i.initialize(e,t,r)),this.blurPass.initialize(e,t,ga),r!==void 0&&(this.renderTarget.texture.type=r,this.renderTargetNear.texture.type=r,this.renderTargetFar.texture.type=r,this.renderTargetMasked.texture.type=r,e.outputEncoding===sr&&(this.renderTarget.texture.encoding=sr,this.renderTargetNear.texture.encoding=sr,this.renderTargetFar.texture.encoding=sr,this.renderTargetMasked.texture.encoding=sr))}};new k;new it;var rke="uniform vec3 hue;uniform float saturation;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=vec3(dot(inputColor.rgb,hue.xyz),dot(inputColor.rgb,hue.zxy),dot(inputColor.rgb,hue.yzx));float average=(color.r+color.g+color.b)/3.0;vec3 diff=average-color;if(saturation>0.0){color+=diff*(1.0-1.0/(1.001-saturation));}else{color+=diff*-saturation;}outputColor=vec4(min(color,1.0),inputColor.a);}",ike=class extends pl{constructor({blendFunction:e=Tr.NORMAL,hue:t=0,saturation:r=0}={}){super("HueSaturationEffect",rke,{blendFunction:e,uniforms:new Map([["hue",new rt(new k)],["saturation",new rt(r)]])}),this.hue=t}get saturation(){return this.uniforms.get("saturation").value}set saturation(e){this.uniforms.get("saturation").value=e}getSaturation(){return this.saturation}setSaturation(e){this.saturation=e}get hue(){let e=this.uniforms.get("hue").value;return Math.acos((e.x*3-1)/2)}set hue(e){let t=Math.sin(e),r=Math.cos(e);this.uniforms.get("hue").value.set((2*r+1)/3,(-Math.sqrt(3)*t-r+1)/3,(Math.sqrt(3)*t-r+1)/3)}getHue(){return this.hue}setHue(e){this.hue=e}};new Lt;var nke=`void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 noise=vec3(rand(uv*time));
#ifdef PREMULTIPLY
outputColor=vec4(min(inputColor.rgb*noise,vec3(1.0)),inputColor.a);
#else
outputColor=vec4(noise,inputColor.a);
#endif
}`,ake=class extends pl{constructor({blendFunction:e=Tr.SCREEN,premultiply:t=!1}={}){super("NoiseEffect",nke,{blendFunction:e}),this.premultiply=t}get premultiply(){return this.defines.has("PREMULTIPLY")}set premultiply(e){this.premultiply!==e&&(e?this.defines.set("PREMULTIPLY","1"):this.defines.delete("PREMULTIPLY"),this.setChanged())}isPremultiplied(){return this.premultiply}setPremultiplied(e){this.premultiply=e}},oke="uniform bool active;uniform vec2 d;void mainUv(inout vec2 uv){if(active){uv=vec2(d.x*(floor(uv.x/d.x)+0.5),d.y*(floor(uv.y/d.y)+0.5));}}",ske=class extends pl{constructor(e=30){super("PixelationEffect",oke,{uniforms:new Map([["active",new rt(!1)],["d",new rt(new ye)]])}),this.resolution=new ye,this.d=0,this.granularity=e}get granularity(){return this.d}set granularity(e){let t=Math.floor(e);t%2>0&&(t+=1),this.d=t,this.uniforms.get("active").value=t>0,this.setSize(this.resolution.width,this.resolution.height)}getGranularity(){return this.granularity}setGranularity(e){this.granularity=e}setSize(e,t){this.resolution.set(e,t),this.uniforms.get("d").value.setScalar(this.d).divide(this.resolution)}};new k;new k;var kB="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAAQCAYAAACm53kpAAAAeElEQVRYR+2XSwqAMAxEJ168ePEqwRSKhIIiuHjJqiU0gWE+1CQdApcVAMUAuARaMGCX1MIL/Ow13++9lW2s3mW9MWvsnWc/2fvGygwPAN4E8QzAA4CXAB6AHjG4JTHYI1ey3pcx6FHnEfhLDOIBKAmUBK6/ANUDTlROXAHd9EC1AAAAAElFTkSuQmCC",LB="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAAIwCAYAAAABNmBHAAAgAElEQVR4Xuy9CbhlV1ktOvbpq09DkiIkUBI6kxASIH0DlAQiIK1wRfSJTx+i4JX7vKIigs8HXpXvqVcvrcC9agQ7IDTSSWgqCQQliDRBJKkkhDSkqVPNqVOnP+8b//rH3P+eZ+199tlznVTlvVrft7+1T7OaueZY42/m37QALKNk2wHg1pITlB17mC+Pp11W3X/LHyT32vhg48/5SOv+PnwpsHA70JoGlueB1iKApeqzvOzn44GatTB76Xzhd7suBR7+WWADgDEAwwCG/L54b/poDLrHuvvm70Z2Avhsc+PVcxscBU8F8C8ADg5+ipIjD/PlGwfgju8B924E5seARUfLsiNmqQW0IjL8+7L2NYD/7COBzfcCm+aB8SVgdAkYIRCXKyDax4EdAanL5PuNPllNvXDlAHwFgP8AcC2AhRIoDXbsYb48dl5WkVFTE3LGDcC9m4CZCWBuFFgeAZaGAYJQQCRqDHT+McJrVb8zwATUXH02MHYfMHEIGFsAxgjApQqACYQORjtd/B7Axt/z79sC0+cMPgjjlwPwVwHcA+DfAHzTxcVgWBroqMN8+cYBeM71wH0TwKExYHYUWCIAHYRLTlkCYgcIBcAgU/n3qy8GRu4HRgnAOWBkERhddPAJhGJDBxkvw7cqimr+zFM/ZLnZF64cgL8BYD+AWwB8x/dlWuWagHiYL984AJ/0RWBy1AE4AizyM1yxYAcTigW55xMbAkxEiwEdkJ/ZCQxPAiOHgBECcKEC4TBZcKkSv+mTieNcNPNC26mLNsj45QD8LQDTAO4GcJt/7iw2bfoG4WG+vAGwm9ExiEg69zpg/wgwPQLMjgALzn4E4aIzoJjQ9g4024uygkj+pyuAoX0VAIfngOH5NgCHMhAm8Sv2y3XDZeBhNIp8OzJE8OsBzAKYBHAXgDt8/4O+MVT0j4f58o0D8Pxrgf3DwMwIMEPQEYRkNwfgsuuDZLskip0No0gWMD/9HGDoADAkAC4Aw/wsAgZAgs2Z0ABI0GU6IVmKv+f28KDnHxkA/G0A8y6G73N9kOCjXnh/Ebb6OvgwX75xAF5wLTA1VIHPADgMLDj4yIA5AAm6aCUnv4oz46eeDwxNAUMzwJAz4BABSNDFTwSfg7DDKHE23MG5PqIY8A1u/dINs9dBdy8AgnGPM2NfUBrsnw7z5RsH4IXXAAcJviFgluAbygBINnSLWOAjGxJ4pgOKDV0v/OSLKp8iGXBovhLBBOCQM2ACoTOhnYrAdItYbCij5JFzRyIAqRccAnDAQUjg6UNQ7hsMXP0cRQAexss3DsCLCECCLwCQzMcPwUi2MwAScAKbfnY/YRLFQ8DHX+IAJAMSfDkAF13kLvleIjhjQQHxUVS3jjgGpKeeNzYVQEjgUS8k+PghONdhIwAP4+XXBYCHKIJbwJyDTgaIAdCBJx3Q2M8tYAHP9m4df/ylQOsQ0JqtRLCx30K1wtLBggScQOgsKBGcWHAJeOwRC0BSM1mQIKRbhh+Bj98JQP6t4U0APEyXXxcAEnxkQAFwoVUxID9kvQg+c1C7vidRbIDkc24B//hTQGumDcCWA5DgMxASdNIFBUI5pCML8v8API5zfEQx4BudgqiczviSnJhQwCP4BMCGl+wO8+U7AJi/W4O4YS6+pmK/2ciADsAOBhTIIiAJnPB7AvNjP+0AnANaYkAHX2JBAc+tYaJXOqBZv24Vc386XW5dtkHGW+4HFAJonpOe+YYQZAShgKjv3PNvPQaxVoI8zJdfFwASfPzMUwS3Kt1v0UFIlos6oDFdAGFcliMAP/ryAEAGNwQRnDOgLbdlIEwrIs6AZ/QgkMMHQF6ZAKQcJAsSYPwIeAIk9wJgoPK1gi7+PwF4GC/fOAAvIQPSs0URTPBJ/Pp3GSEGRHfBCIQ0xowBtUbcAj7ys5X4Jfu1HIAGQrIgQRXEsAFQIORDFhiDY/rMHmrU4QUgR08AkgUjCAW6CD6CkwBsAIQC4GG6fPMA3OXiNzCg2I9gNCMksmAAoemDzoimFwL48M85AKkiuQVMAAp8CYRRDAt8GQiJ67N6GJODAXAHlsGguscA2AJg1IPGYmxOpBxFWkRN9LsATgIwXnNs/v/5z/9XCf8BO3YAtxbc/46/KDt+5+ea1Yku2VUxHz/z0v24FwMGK1gWsK2OUUxHHdCBeRUB6OxHABr4ZICIBd0QWSF+XRdMTAjgCdTrG9cBNwE4F8CpDkICyYLGsuhFt6zs+gISwUen8zEAjgMw4cfx2H6O/90yAFo84Cbg4ID3/9TfLTt+5+ebnRABkODjx0SwPi5ec/FrYpmqSAxM8Dn60CsqAFI6GfhqAMiDE/gokmvEr0C4PgDkBQm40wE8zMFEUDKEVoxIMLl/KS73mE7H9d+vcKHQQcjwW0Yu9nP8m8sAmOIBuWY6wP2/4s0ezjjg8TuvaR6ABJ70vxUApGrm7EbGE+i472BAB+WHfqHS/eoAaEwY2E9+wLSXTqhI7CXgnB6LCoOJ4BiST+hTnG0HcCwAglCx3ARoZEVFXnBPp/O/A/hXACc7CPs9/i1lAOyIB+RDX+P9/+pbQjjjAMfv/PL6AFDs1wFAgs/9fgKfgdE/ZEpuiQlbwAde6QAMBgiRmsSwA9BY0JfjovGRDBMH4TlcXGhcBOc6HkF0gjPhZgchxTLZMAci/04W/B6Ab3t09EPXcPyflgFwRTwgJ2MN9/8bf5qFM67x+B/aW4XQz42FeL0YrRyikztUFw0704mf9kXgxhOAqc3AAsPyRxxQCs/PdXOFY0W1KHy3QIUGtx+6vdnx1vsB+dsTncm2AogglFgVEAlUWrOMB2RyEmMCGQ/Y7/HvKns6tfGAnJQ+r/9b76oJZ1zD8WdyQjYBh8aBhVEHjELouQ8ukQ7VRSCJAALwkr+sALhnGzDD3JAJYJHg9uhoi4bx8ytkWUtvHT/7+Zc4dw1uZ3612fH2dkQf7yxIEEockwkJQn4IQoq8unhAhmPRKKFx0uv4K8ueTs94wD7u//VX9ghn7OP4c+4G7h8HpseB+dF2AKlFLwuAIZ8jD6NPrOhAffmfA9/ZBuzZCkyRWSeqBCWyoYGQ5yQrBpDbum/ME1HoPo0XEkSD2zlfbna8q6+EUJcTCxKEtHL5EQjP6BEPyIgYAZBvYt3xHyx7OqvGA65y/7/9wVXCGVc5/sl7qxD66dEqiYgRzAqhN1A4CBNAAlDyAFI+iZ9/N3DLJuC+jcDUBmCWyUnOrmTYCMIOkNclLg0B8/RsNLg9+UvNjnd1APLmmQpFHyEBROuWACQT8nN+H/GAvY7/VNnT6SsesMf13/CpahGnZzhjj+PPmwX2MYdDIfQexWyBAwEUOQDrRDN/98p3A7dvAO6fAA5sqHJDBEAyoUVGkwEd6HR12XU4kwzfl6fCXTZzjy57vvnR513X7Hj7AyDvggAUi9EyFgiZqNxPQF6345nOWbD1HQ/Y5fpvuLa/2+82/vNHgAPDFQDnhoF5j2C2qBWCI8bw1eRw5CL5l94L3DEOTI4DB8Y9OWmsEu/zBJ3rgsaybqBob/7A4C7jtWcooRrczr+u2fH2D0AOQgAUCxKEP7aGgLy64+m6KdjWFA9Yc/03/Osa4glrjr+AupqHz1sEs0cxG0BC9HIePLoit9eNkVf9L+DuUWByDJgaq4ybGYLPAWgiXmLedUE7dwC7saL7CqfPKXi4NYdaykCD410bAHlDEsNiwZ9wAPYbkJcfz6T2gm3N8YDZ9d/wHxUA+739fPwXPrSKYGb+BuP3jAFDElFH9HIWwbzCIGkBr/or4J4RYO8oMOW6ZVcAuvi1Cgoha04BCwT5gfMKHm7NoRde2+x41w5A3hQZkADk5+cGiAeMx3+/7AENFA8Yrv/G71cAXFM4Yzj+otOAaQLQA0gZxaIIZtMDFTigKJV8H9Iq6aZ59ZXAvSPAvpEKgBTtBODcSCWCZeRYtpzrmLyeGNCAyFl1v+Hei8qeb370Rdc2O97BAMi7EgB/2QG41nhAHU9LuWAbOB7Qr//GPRUA13r7Gv9FZwIMoVcEswEwfDoimEP0shKKtIphaZQAXv1+YM+wA3DEdcvRKkGJADQQEsQuhi1Tjt95vBsh5nx2IO59SsHDrTmUOStNjndwAAqEry0IyCMICkOyiuIBNwBvPFQQT7gBuPjc9oRYAIHyOEL4vIFEYVNaOou5vCGE/tV/A0wOVcnpzI47NOri3QFIBpSeaSDUdYLOSWvYImSGgftpJDa4MWJbAGxivGUA5MAOc0Be6eVLj7/4Mk+hzCOYPYpZDBiNkLh+G/M3yFyv/ltgL3W3YQfgcFUhgRY2PwY+Z7/EhAR1SFyXCOb57r28QfQBsJQBMn5D4y0HYLPje9Cd7RIC0PM3EiMofF4gVCBp1P840ix/gyz56r+vAMjk9Gl375iB4+CzveuZdLkkEPJ8ZEfX/6R73vOjzT5Si9hucLxHAVg4PwJgRwh9CKOXK8YA4ZEqKZXSQWh5P+5AftXfA/uGKvYjCKn72cctbFrZNECka5L5CPwIPtMH3TVz17MLB5gdLgA2Nd6jACycHwLQxFEUSR5ASvARDB0h9AQb9bXIgCGk6lUfAPYTgEPAITKgg1BObk58srTJgG58WMkWMaAbQQT1nc8rHGANAJsc71EAFs4PAagQestgC1lsBJ4BMCSOK6dDUcwqqaFiQr/0QeAAAdjy+jBiQQeeMSBZT3nCPUDIa9z+/MIB1gCwyfEeBWDh/BCAeQSzgkjFfGLBBD5nxQ4DxN0wv3hVxX5TBGDwL5obxvVA5YqYL5BeMLd66YYxJpRB0gK+96LCAdYAsMnxHgVg4fwIgMrhUPKQ2C+Bz0PmBTqBMQehAbDlIjj4F80KJguSVZ0FuXpjoCOgXawLjALhbT9eOMAuAGxqvEcBWDg/l1IE05Ed0ygZnyHdz0VwCqEPIfNyx0QQvvLDFQCp+8nfZk5und8tXwIgWcHSNX0N2CJmnAl3v6RwgNnhl17T7HiPArBwfghAS7mV/hey2JS9FvM3BLpUUi1YwDRMXvkRYJoAlAh2l0dcZ04s6JUTDIjyBcrl4yDc/dLCAdYAsMnxHgVg4fxwKVwJgGEJNmWtxpQMpX9on2eRhVA+O56AjMfnP+e3Xvf3NwG4xIPTleiY55bpGh6UbafNU0l0z0p+5Jh5HqYJ6b51nP6XP8cx12XNHQVgIQB/bFPVg2OC7Q+WgVFWng/FvtWLI06uWh5oguKEcXVS/9sEAF//VGD7t4ETDgJbF4CNi8CGZWBs2fPL/H6Vwp2KEtVk4fJ+v/EIYPN9wKa5qu+IncfPwXHVZe/aOL3EbwS7xv8A1rQvnO0j8PArTgTGZ4BxFv9mIxhOCGsv+0OPYDRghcLfkWkEuq0+G00x4OtfDGz+d2DbHmDLjL8si8AYP/7CGIAiEEMTG92zXqSbH+d9R2aA0XnvO+JjthiIrOVDHHPOkBrzUQAWAPsZp3oPDpa/Xag6EVkLBK+5rAnJC3/nYk/APD704WiEAV8OTHwX2LQH2DgFbJgFNrBhjd8r79deGoEwsllgNBOzy8CdjweG9wBj08AIAci2D6HafmyAk4/Z7SJ72hGYRwFYAMDLTwOGp4FRFgD3HhzqRGQiyeurqOdG6r0Rm8IEZjzRlkiqCWoEgK8Axm4BJu4HJhyAbFhDxmbDGnZO4j0SgLGDkpibgEq66TJw/1nA0F5gdLpq+zDqFfd5LMeWqu5HNST0uJOIllg+qgMWgI+HPv0xwLA3gWHpW2sC441gCECbmKziaGrnUdMO4aHeh6MxAP4SMHI7ML4HGD8AjHvHJGNAgpDgY/ck3stipRemvVhc+uASMPUEYGh/9dIRgGx8Y+MNbR/00uVtH0wEx94j/v0oAxaA8Ed+GBieAYZZg5kADC0QWGOFzGJlcGPzl1BxNLXD8sk4xftwNAbA/wwM3wGMUmxOOQBnHXzetIYvibonmSiuYTNjriVg7glAiwBk0fNZH6+PmX9P6kfNmCXGpftJ7TgKwBIAnln14BAAYxMYm5C6RjCyCoOyr0qkD/c+HI0B8DXA8N3AyCQwesD1VQKH7EcASm1Q+y4CkN9pUKiVF5nLvy+fBbTUd8QBaH1HvNBROiZvfsNnrF4kcvPwpdsBLBeU18Nf7AB23Dp4ecHC8oBgUlJJecLS+7+WOpE3gbE+HKw+yoevCYkMGKqPJrdEKARutaFYRs1fiEZ0wP8CDN8LDO8FRqYq3W10pgKgfYLaYCzootgA6KXaTA90y374TKB1sBozy77xHFZ536utRgAmEaw6g5kUSFZwSXnA330qsOlfgHMPDlZesLA8IOjoLypPWHj/11EnCiVwkz7kAExtsGraYUWdSDX5TmsagL8KDBGA7Bd30JsW0oWivnEOQNP7yGTSBR101AlZSUtGyfgZDkCWY1HnJdcBVe6325hTvelg2CQjZNDygG/2An0j1wKnL6y9vGBheUC8prQ8YeH9X39OVQSc7Mc6fCaKvAeHdCIVf4yMYCynTpX+nb97NJmlSQb8r8DQHm9YOFUZTKOzoXGhs6AxF0HIexcLBvWBuiHN8s2ne98R3qc6L4Vyb2oBVjfm9MIFHbjDCh6kPOBbQoG+oW8CO5bWVl6wsDwgfr20PGHh/X/1iaEIuDcCTIW/1Q4rFv8OnYiW3c+W2iKwUjKbyjQNwL1uuR6sAEgDgq1brXOmV81PxhNB6DUDBSYzQJwFtz623XcktX1Q1VWKaTF/zZhVazBVYA1tX5MazsGvobwe/jQr0Ne6BTh5uf/ygoXlAfG60vKEhff/rSe1i4DnTWDUACY1guFTDqLYdCBvf6DJYSMYATBfOx1kLfj1v1axH10nQ3Sd0GUkBnTfpemtBJgseIKQAHLQcVxa2TnuMW0Aqui5es8xBIegVdVVE8VhzHnLh65WMB9An+X18K6aAn2tO4ETl6vqbKuVFywsDwhevqg8YeH93/Rk70JE90nowxZbIJjvS3WYNSGUwGHJTpPxwwcbBuBrgRYBeKACn7VtpdUu/c0NJxO9BIxcKu4TTODzbkonPLoaL0vyUQRb2y8HsL1ckfWzMeuFi40Qezqi+yiPhyt7FOjr6/gCFwgP7Xb5vssTFt7/nQRg6MGRWmDRoeyTlpgw68GRTwgZgo1gGmXAX6/8dtaylSKY/koyID9BhzML3q1gAos2AcOrZYSoq/pJp1VtODRm9Z3LS/7WjVkvXOzEtOpKyGrlAT+4SoG+VY8vBGCvy/dVnrDw/vee65NBJiAjBIVcAJQjOm+DkCZEeiGAMw6sAwDZsJrAdhFM9rPGhd4904Co5oVuCZPV6kD40Ec6+9W8dBTBsfdc3nkpvnB82fp2RPcs79dHgb51LA9ofsDV6vut5/3PnxcAmLVBiDqgevDaJLkYrpuQxzcNwN8AWgIgRbB8loEBzXDwl4cGiDGft58SCOWGedgjvOJ+bPvgRkiuA+ZjzhnQQOiFNVbloa7l/fos0LdO5QENgEXlCfs8Qbf7HyMA3QVjYihYhLENgjX9y/qwxQmRU/asfd0ZcLU2CHVGyusJQLKfVi98CS12T5f7iECkHpsMkAhCF8+nshWH2I/jXsOYO144GV/9ApAIrS3vt4YCfetQHtAA2G+/4PW4/2PPbzMgmUMi2NoeSCRxIt2/FvuxWURIWCXg357gfTjEDNIHnTRXRCpH5ugKwGl3HpMBXQc0v6WLYVm/5limj04rG762K2uYY9jBkr9+rI03NL5ZbczS/dJ+LQyoga4o77fGAn0NlwdMAOy3vl/T938KAcj121z8Bn+Y9eWQJRz8Y6kNagDh2ey5EvxjxQD8TWdAuneCCO4An1vw5vdzQMmdktwq7pLZQR+dM34+ZumAxvY1Y04uqOAJ6FsExzeto7zfAAX6GiwPaLWR1lrfr8n7f/Rl3QGzmsis+/uO71V9OFgP2gpPhgr7TGRqRUT6dyvr4aIs/pm/2zVUNbBSv6G8e5pEv0Cvec7Po7+bTtjlBRlkvAMBkDeQyvsNWKCvofKACYBrre/X1P0/oWEAnnFD1YdjhtXxR73mX10FfCHHE9pVWcGAI/S0gKsfA2y+twrFZw6Hxf/F0Pk8Ri/kpGSnMuDx5T0iACgQHioo0NdAecBUHW6QdsV2/cL7v/Cyqr5gnc42CCOcfX1VIZ/V8We9IDmTzVXwPDJiXuKXPxtDBma8+lzP4WAgKkPxCUAPE4v5GzEuMX0PYJPLhB6FJsc7MAMmkVxaYC/K9gG+F1++8AQ7Gwbgk78I7GFpXgIwFiRXOwaJZPUbiR0yCUDRk+cHf+YpwMj9HgfI8ClGPyvsSiH0WSKRuYlitLb/zHM/JOSs5C/YIC9cMQDZr/dwxgOW9gtGYUBi0wA8l304vDQvAchilFbpIBQhZ7Ejq6ZQ0/Yhil8y4j89Axie9DAsD6FX9HOK3QtROTFkviN83kG4felIY8DCeLrSeMDSfsEovAECUFsTjHD+tcB+tkFgcXKvBRir7qtFl9owmO4Xy/1G3bAFfPrZHorFNWBFwHjQAFctIghj2kBarw06If/+MM9ZqTN6DgsDojCerjQesLRfMApvoGkAWh8Ob/tgAPSKWCp8ngNQtadjmTdltvNvn3peFYhgQQgh+iUmEaUAUoXM1yRLmWuFLaE9Z+XIAWBhPF1pPGBpv2AU3kDTALzwmqo6qtVh9kJErAudABia38TC5wJgS2xIhAwBn3yhByL4EhzXfRXxYsDTJ4IvrNN2JFMxZcBzVo4cABbG05XGA5b2C0bhDTQNQLZBYH1AVsQSAAU+imI1obHyblnjG/kJk3U8BHz8xVUQAhnQIl5CyNgKAGp5LKSSCoAySh5Jj79vTagcxUaIBeRNe79g9gq+DXig4wGzy+PONfT7RWFA4noAkGXZVAhcBckJQgNgrLiaNb3paIDo1vHHX+oA9LQBi4DxJcOUPJUnTgU2NJUyROs8irGARxQAC+PpCtsFd40H/AEf0gMQkLgeACT41PiGoLOKqyrJq3K/Ya9mNyr5FusN/uPLPIeDa8Bc+w3rtyl4VFHaMZc3i9RWBM9jjzgAFsbTFbYLRmm/YBTeQNMAtD4cBKDXBTQGdAB2MGBo8SCLmEuS1AFVAJ3A/NhPt0PoCcA8bSDG76XI7aySg6JYuGfKwJHFgH0E5B3ueMCe/Y4L+xVHAOZ+9EHcEgQgwbeiEYx6jwTdz4qfu7EhEJqxGqruf/RnHIAEnxgwBM0aC8aUAYWNBRCmoIll4HTqO122QcZbrgMWxtMVtgvuOx6wa7/jwhtoGoDWh4MBJ16WN4lfr8AqI0TVV1O1fa9BbQzovkAy4Ed+NgCQUSxZCFWvCOaOFREXyUwZOPIA2GdA3uGOB6wPaOz+QPv5S+MA3OXiN9aclghW+d3IgupBF2pPqxcxGenDPxfSRh2ASiKKiVP2PaZScvAKoA0VDc6cOlIB2GdA3uGOB1zR77iwX/F6AFB9ONSOQW0frA50sILVcckWJyIDSgwPAVcJgFbYuZ3FJvAlEHbJ3IsgJLGedeBIA+AAAXmHOx6wo99xYb/i9QKg2iAIfDJEJHqj4SExbEty0gkdhB/6P9oZbBZIGiKYVb9GKaN50lRHBLOvhDxh/5EKwDUG5B3ueMB2QGM/grb7/6wHAPNGMAY+GSGUjC52VX2f2CD4+HO0gqkZfegXKgBaHkcWtS0AWii9xG1ImrLlN5XR8L8fmQD05BVrmEENmpYSP9QX+KHiqj2/82+HqqDWwnbBRfGATdzAegGwru2DpRq7Mzq2fpAf0Nq0Rl2wBXzglZ4yUAPAmDSVWDBPHQjLcgTqOZ6zUvdKHh4ruDCerox/Dnu7YqwXAC1NI/QcEQuK6WK/kdgCTGC0PYAP/KIDMBgglq+hIkrOfsaCviLSofcJgJ5AdM7kkSaCj/HqQKVIGvD4swF8bcBjmzjsaQ2H5D/6acBd9wALB4DFWWB5AVherMp4GKIYEOp7+26UF0aSfT/xYuDG7wDjrIpAERytXf2vajj7ueryQXSFl10K/ON3gIWDwCLvjfGB8Z54O+Ee4ve6513uB2R1yzsqC+twbC8HcNVhfAeaBuDP/TvwtS3A/ePAIfYFVlPq2HHTuyulZCTlhbjhETF5yxTQGgPGhoHhIWC4VSXGD3n0tLkMHXHxu+YyB+MlPwDuZs5K6FlsbCzdVO9DuKfkHM8AEkP7B8fOkwDcD+B7np42+JkGOvKdAL4E4K8P0zvQdET0b14D3DgB3D0B7B8HZka9WzrD88N6sFm+YcUjrn7E1ZDvMtF9DBgeAYaHgSGB0PNHCD4BLwLRsByAyX/ij0/dDUxuqlIG5hix7eFhvLcOVUAtyPSydAFmOQNe6EYGV/9ZESiKgIEgtbaD/gHALQC4ovY5r5KwtjOU/XfTAHzzLuCmIeDuMWDvKHBwpMoN0WQzNtAaYSs0K4ZlOSAjGG9kPjCBRwZ0ABKEBJexYAZEAU3A7Oi1BeDym4EDnjQ1TwCGWMW8MXcKks0YOyZNlQOQjcgYIUHllEzYQ0ktm+r6oz8G4F4AXwXwRd8/kO9A0wB8y65KmPxgGJgcqYJTKYpTv2CCzyddQJRDOjKivn+Deh8BF8BnwBtaCUA+YYEyAU8h+c6Az9gNHHRmrgOgmDA3jHQ+iWupCeUAvNSrA9HNwqx+muk9nJVNg/CTfrmbAPwbgK8D+PcHkIibjob5o13A3XypWsAkG1cPA9PDFQDZM1id0i1KxsWfOrKnAFXlifCFFMMRcASigOcs2MGAIfE9iWXplS6On7UbmPaUUTXQrgsVMzcRj5Folg2V5ayUA5BWYKwOxKUafnosWjcJwk+7W5F2EKvlE3xcXaNYfiCYsGkA/smuqug6hcleAnAImPbO6YwRpMgjCAVAm/yQmKTv5hNsAf/i7SyNBSl2a8Qv/4/M1yF+BZSYlNQCnnVrpbC+mToAACAASURBVJcaI7sOSEY2NpaDXLqpR+vE/OVksDgImgGgghHoYJbTWc7oJtFWc65/cg2AYvh2ALsB3AzgVv95nS/f4QdsIkT9T3cBrGtITWZfC5hqtQHInsEGQn3UDDvEDEY/ICf7SxMOrAg8T+c00JGkvHGd2DABUYZIAONzCUDppCFhSukCBsLQrFtZe/IixYQpSyEoJoqnuPWrVRAubQh83HNlZB23z7j1ywmj6CIIqUPxw2Xeu9bx2jx10wz4Z7sqTYZaDD8EIDuoE3hMVEphWg66JIp90k0sBxBcy+iPIIaT1RtEsHS/yIAqw+VSNPWQfe5tlVEk8auXgVa5BUsEJuT5uoliAbE5AGotmIAjCPnR9xDG3TQernYAUupTdBGEFMf83OkApHG+XlvTAPwfuyrgSZOhas3u6cwTsUBVn2gTwyFMi8wjHZAA1M9fYGHDULJD1m8Cpa8fRxDad+l+Ykf/3XNvd11U+qiL39SxXevSsshdDFvgbI1O2AwAtRZMZzTBRuDFjxe1Xg8QEIB8yyj5yYIUxfQIkfkIRnmHCM712JoG4FsdgHHp3ACoMH2G6jM4lWzoQarSvwQ6MSB/vporVaFkh+mCLlpVR8Z+dqDZLoDOpHSiQeAFDkBjPrlgCHgCUaFifg67H/9uYjn4Ai1vpTERTAASBaoQJBAKeNqHlL6mwPDZYAOROag/EYRkPX34MwHIvzW9rQcA+TLpI22G7EcQKlJGsYIJhC6ClUMiXfBTbFUQAej6nPS/OuAl9pOOqIc2BLzg++3VmWgIEUz82cRuCAtLIHQQm0gO52uOAb22sC3JEWgRfPpZf2sQBQIgLydPEIFGwPEj8MlF2bSbsulghLftqsCXq9HGgHysznrGgi5qzTUTFH8FLhAUn3hIJwCN0HLncw37qaF2zoYvuKNivmQIuUNc7GvWt6sHNs26twA6vhyq8NEMAHlyntFrDCcQehyaPTl+FwAbXDcmAKMRThakEk8Q8kPg8SPL0qzLBl+A9QCgR6uZGs3vfHz8TtBZvkgGQrEPBVAUg2Sij50QAOjiVKI3saADJRm7dSLYWfSFDkCem/dhZeMy9pPY5QvSDYQyUJoDIK8qMezh3wY6fSL49PcGgCAA8pScJLIgAUYQEmz8RPA17StvGoBv39W24eREiBoNQSgWNI1HBkdgxJSw1AI+dFIbgOYmkjimQ1r6XXC3rAbCHycAgytohf8vsB/r2KRaRq7zpZ+D37HMX0s3DDcCUGLYaw53MJ4YUODzusqlGCQAOQCejuxA8UULUkxIwAmMAp8Wa3qkN/R9W+sBwOhIEPjk5SLr8HeKFbTQfb77csPIMHGl/4MPbReslPhNe4+MiTpi9AFGV4nI7MfvagNQLh/pfrYnDAS8aJQ42A2w4em2cAyWQUuJVQTGWLs1uL7DG9J1RjhA+jvYk4t3KXeMqijpzrud4At9z3XtP16yGfjKZmCGooYh1tZzvv8xXPFl4PoJYC97k9FlwZWD+Azi/deMZWeP13eQCGEyoERudChIjbb3mJYwH7V0QIKuCwj/gfMj0asn2I0FXRSHXfL/iRkNgLyeVj8ccMY//J1fyxzTAXT2+xoQViKYD/1hDqLxPiYxTgSvQrphphG97tz4Slqafnj7uk1kIQDZrvWTw8B3jwEW+RLxPgSiCERdPwPR7+wCPg/gulFgfruDkOMQkFc5x84e708JAMmCuRNBXi4TIg5CGRzGiBGE/D4E/C2r2vcAYJoify62i0aJSMhB+2IHoNwu0fkcjQ85pu3ack5nIBREqneYFyWLkAXIJHESe00Cyx5QyeL6F/tyEcDcrOW2n7fX8df0mME+/vQ/PQjhoy3gzo3AISYf80MQaQx1peH9wb7v2mrtmCBkIMMejp3jIJD1MsaxaMZ8v5N/67INAsB3BAYU4JL4DSo1J15AFPAEwuQHZJzkKfUAtOHLJSOQRWndBYQvCQA01cfnNopfsaCJaD2baBn79QjSTiOEP1EcawIpkq2kegBTNgHWEpOKF8Uwq2NRFPM4AqCf46/rA2U9/uVDvurB01zvAJpiiwOl3fEeciCGF+Ij11f+QkbSfMPfIzqw57mEFZ9Dl3Ps5HXWAYByHJAJKV7N+s0cCQQhwSlfm4lGZ0KB8C/rABgZUS6ZHITBSEhCowUYAAksF7cStWREyxRwtuPpOlgw+5s9sq6OaIJIIlUgEhA1edoTgHxa9HVw5jibZNF+j/9yGQA/7pbujZ4bwv2+cWB6tFo0NzYnkxFA+cvEAo43VBoEo2e+48EMXEOmD9F6xhCE8RwZEJ80VblKvDlmzwicfqy93/o+8K8TwB2jVSgW138FrJQTXBNlnJgmrjZwanow9CBP/rL9wF0jwAGWDtFyoN9PHutnIHT05mPXz93dMGQAPniJsjiBXiTbxDZFMF9NLUPQxKR5qezz1Y6/YZDH0D6GkdAkYJIvRalAdHAMmPZoYhb6NhDWvEyf/ma737CXN7R1ZC7hUbPgcFgqt/ZZjADnM1xqEVhYBpb4CUk5UsL7jQvj///5buDrLeCOEeD+YQchYwG9VIfyg1NaZszFiCH6DkRGLze5/dgk8IMWcMCjdCiCzR8od1B8OTwvJM8JEShFut1fzMhi+eRJr6LI7hYP2M/xVLwKNoZjUTwRMAQQmYyhWGQxsSADOflZ4kukj7PhZ75bETjBpkAGahMkcrGgwhsXeCyBHBj1wmOBQwvAwqKzoFeRV8ZaerjKYAuirmPY/o9X7q5Cyr7fAvYMAftCPGAEoYlBiVtFwLjtp2U4irj7yOANbi+crHyrfCbTquJV44O0F1FrwQGIMZFqdQDyP/gGSZ8TC0ZRRsOlVzzgasd/u+zpMByLehAfCgMQCDyGZJHFCCgLZ2f8mgI5qauEcVx9e5vACTgCTwEMWr5TdIpWKJb5MvrnoocDswvAPAG4VLGg6UKeqmi4iuDz4er30oX0FP7u5moMvIf7W8B+jwlUNAzFnlZCIhvGFRCeWzrgXSSIBreXTFZSgVLHAp4UHOFuociEEsn2PJwl/XEk0dzfSojeerFg1IOo5BKAveIBex1P67lgUzgWQaJwLAKRH04i14ItgDKEtGsRnWx49b2Vkk9wUefTGrKCF7R0JxZMqxN8cmPAxWcAcxGABKEAKPA5u9lEaAbCmKMI+sDN1X3z+ro24wEZFc0VEE64ABgT180PF9ZdBcDb6JpqcPtPk+1ACbmKjJnllwyuILunEAWjZHkBsrsRUnfD0qEiC5IJfyisgMhzWhcP2O14Ro4WbASgAMQJ48SJwchmBCDFa8qpyBbSP7OvU4PQ0p2W7+LSnSJUFOrI4V7w5IoBTQQTfJ6oTSYk2mQcpGRyH2syGjIF6EM3V/fM++C1CfwUExhCsmzCaQT43lZC3e1hBpEHh36XEqrB7Scmq5dV0XZxmV8WuDFzAF9iwhow9seAGoBcGtKjqAc+1l9rLb/1igesO55ysmCrC8ei6IxRMAKTWNBi6Xw98xNTFUi0jEcmpYgRAPhddpVi9OIEPP5cYD4CcLkCooHPwaW9kV+iwWrQHT8uA1fd3F7DFvgUHUP2k8jTiogAqLoxFpDgbMj9jXSuN7i9dLIdaxzBp5XVBMIMgFEnFAPKT9qPd6A9BIGI7MfPmf4U+40HzI8nWgq2PBxL4FEkjKJixGRRFyQQPzzd1iAUzCAQas1YOmAEoFjwkecDC/PAwhKw6CxIkCXwOdVJLxTobMjBdyIgfvimNvNJ7Evf4jWtdnRYD1YNGVuG93VWuWs4Jf+mlZCCZxwP/cnJ6mXVKk2+tK8lQQVHRTGc64SDAZB3Ey3JcxyACkToJx4wHl+YwqloGDICmYmTFgMQFBET8yyYzyAG/AfWX8mCGQg0BTRoHwt9KVaPE/HQ890AIfgWK+CRAaMRYnVdxHbhdY8Wslw1V93UDsmPIj9GxgiAioRRMIJNvoti+SW/Ikd0gwAU8+XxJcbGITJPDvI6XdCFREFSknTB83xka40H1PGF9dnycCxFwygkK0bASJQSVAbAYeD98xUAe5U3jKIwBosSgNsuABYogl3/IwgFPrOIg1Xc4ZrpAsSrvruykl2ucykapkMMh4CExD5DwJfWAYAxwk4MKPAJgOIjGSEGwuCakRhemw6Yv0UUwRf7L00L9pnsNx6Qx4feY4O8pDEcixOjsoTKKpMYjSFYYjOC8Eq3Wnnr0YYS+0Tmi2HysrPGLqwASNYzBnT2Mz2QD91laxLB0gs12GAh81cf/o/OcHyJ+qj0S/zxnhUZbSyYWaL8+Rq2S29wowiWkJPan4MvgrDDGAlRe7KIywDIgR3meEDWg9HbJgApNTkXo8o0i7oVgxnEgFr8F7jEdnU5GvqfJQKQKyEOPlsNIQvyvupAGHS/Okv4qv9oh+PHxMLk8ggBCRxvAmEN+AiEzz2iQfQBeNmkh4K52hJBKOaNe/FSLobLRXCz43rQnu2yi9oMSMDxs2jo8303ERz1wsCGZECF4kd3DwEYYwJjhoNlQrgIjlYodbBPrwMAZfEmyzcIv27gs6XDzC/IR1DOgA9a6DRz4wZAsZ+LYXvQYsHoD4ziOFklna6YD3+nnU6dZ7bGDAcBUImIAmEUw/zbJ1i/scGNDJiLXmle3RhQ+l/aq57gUQCWzwwBKPeLsZ/LFrGg/ShRXAe64Ajkv30kALAjF8R11Dy3K7KRwJcsUTaqWScARou3w/INVnCH+A36n8RvM3nB5XP4oD6DATBYwGb5ajlOLOh6X8JaBKRG77+7ygGYp1bn+V25/01AzBnwQ1ypanD7KWfA1QDYC3zJIj7KgOUzc9nFbetX/r+O5biwNhyX5uSEDr5o0xsJwLp8/m4A7GaJUv/j3/5+HQFYJ3oFPPkho/hNeqBcMkcB2BAA6XrxmMBkfFAci/m0JpwzXw0TXvXtzrz+PKc/Ml/ugzM9MDqCAbz/keVjjGcQA/YLvjoguo1mRslRI6RwfsiA5nqhL5D6nscF8gfTdfxpS+/hLzvWfzMQCoB1Fq/8b3VWaPIDZqsRV64DALsZHVHs1gEvsqFAeBSApQC8pHK90Oql4UEAyvCwNeGcBXNLOPMLftgZsI75ouUr9ousp2TEyIJ/sU4AzC1e+WIFshyAHPZREVwItrrD3wGAhibTYBhxVpe/xePyrNBuWaoNp3DgFwC81O+RAepK/a5Lfe51jxr7JwA83nPXYgq1asl0yX5N48+f4VEGLATlK1vAo5YB1gBSRmsM+NFE57lcfPD5pPFWCJImtyvGgGfOAacBYO59zFglgHgPefZsXV6/gPXBYeC0RVgyJNOGYuJjPka9eHWgjL9bWzhWk0/n/wPn+k8bgFNmgYcsVflZnBRmIShtJM/m7JGibGBoOIIez9wKPP4AcNpylfbNlGfdI+9NjBjz8JVzppckZuJ+dBw4aQ44drk6j1LIY9JkPD7P4s2lwVEGLHwJnncscNIh4Nh5YMsSsHm5ndOu1BGFThJ8/K6JrZtoslST2+XHA6ftB05ZAE5crgAups5TfaL6EF+UyIif3gAcOwtsXep82eIYY9JkXpMgMp/AeZQBC2b8OduBYw8C2+aALQvARgJwGZhY7swEzbNa88IRvAVO1qkF91J36DNOBE7eD2yfB45fqphLnevzdGeBKBfL8UX5/CZgyyyweRHYsFwxYHzRNK6oetSBMDLjUQAWTPqPngpsnQK2zgKbCMAlYMMSME4ALrcnR6JYQIwsoUnjpDRstOLy7cBJB4CHUGwuAtuW2nUDVH1EFUhycSwWjGD64mZg0xywcaECoI0z5P3X5P6nWlHdgHgUgAUAfOYOYMtBYNMssHEe2LgITBCADkIzSJZXpCOnIg25uPrhgnupO/TyhwLHHwSOmwW2LVSik2pCrDsQskzNIBGIpBdGI+VfNgMb5oENCxX4yPRjPj4xaJ0+WGeEHRXBDUz2Mx4FbDoIbJypADixUAFwzAFI8KUJChMV2SUaAGc1cE/xFJef3FYRti64nkqWDrqqEhbrsm5zvZCdPCd8nHzJOLZuABRz9hTHZwPL7LnLnoNMIY2VyaKcjtZLHOAbNgNPngKe4BacfGF1pnydD+hphQ/8XV5UiEueLGnDN1tWXj/3/4cTwAUzwGPcRcFJiDpPt3FLmf5vjwE2HAQ2zPrEzDv7OQg5OSM+ScYQy5Xbo8465u/ZfLTJ7fKHAdumKxVh8wKwealSE6inEoSy2MWCdbUHIghv3AqMzwHji9VLZuDzD8cXxxWZs5c7apmW0fMBnIHKn5X7d6I5npvRz94O7LgXuGIReJSb+Xl1tzqflybwRwqf9i97BQRWomWJQ7oZVFtJoqDX/b/oGODsvcBTATB9gsfGqmzdjtVz+G+PAyamgYmZCoDjFE2anCVg1CeJwOMnTRB/DmUINVkkgia3y08BtkwDW+YqAFJFMD1VAAw6XG61R31O9/fdrcDYPDDmY0zjc1UjivBuAMx1QdMB+WAYXU8dhEU16dOSkppbcHFSrng8MHwnsGMPcN5ypURHp2xMIa7zDz2z8Gn/kVe0YomO0wEwBYKujL7v/zHA6C3AxfOVh58g5AsZxx4fZM7sf3h6BcDxWWeGBZ+cMEFiwGEHHRnDzun7ONHs/djkRgBunql0VDOSHIDU3cxSD4aEajhFXS4H4S1bgVGN0V8we7E0Fh9jVDG6Obr1LJMRwn+kOCaTEYT0dsfqZHXl/p7PrLi9wIY7gO0H2yAgCAWCWCowKrYE8nMLn/a7PQn9X7zIJPPkCcK+758y7x7guNsB6l98gZjLLYet3Ay5n0sv4R+fCYxPA2MOwLEAQLIDPyP8uBg2cRYmzFweAYilKkn+OC8/Fdh0CNhEA4nGA40kd6FES13WLO8v1qHKAfh9B+DoYjU2Ak/js/8NAIwg7OUb7LCC+WAfB4CpBJoIiTRNRmS1l13kqWh3Adv2A8cdqqp1MB+aIOSxWv6pq5D2kkIAvt8rF7BLJksN/jMqfa7v+7/Ak4B3A6ceqpasKMq5akAmlLWY37t8ZW97PDB2qALg2BxgAFwANEGcnI5JcrDZRPlkaXL4u1KJUAfAjbTQ59x6dSvdLPXAgGYshZWR6JIRaXB/NwFI8C1WwLMXzMeSwLfcXuKrA2G+wrLCDcN/IIg4ERRn0qvyySAQX6mG1XuA4fuAbTOVwktRRr2MLCoQyvEZ/UY/WwjAj3jtFJZkU79g1ghkgEBf98+0Umb/3A2M3lkBl/fOcdMok2EjkZyv8773LAfgHDDKjwNwxEUw9yailpwdxBAEYhBbAuGzG3aKkQEJwAkCkOCjlb7Y6SYyf2UwlAS+vKYnAXjfNmDEX7DEfA5CjUcsnzvbu1nDtUMmCDkRZEEyGdlAk6G6lQTSa6m0MP6HuY73AxNTlcJLZ6WOJYC5/CNxLpHMgdKIKNl69Qvu6/75AjHOiTU87gKOOViJb748BKCWrnK/maTA+58AjM0Ao7PA6Lx/xBAupoYDC9okBRAmPdBZ47lNA/DhwMRsxX7mPgl+SrmK5EaRNRslXFQ9CKB9DkADn79cZtkHFkysJ103eBbqlh97DpmTQTYgk9VNxu+xYbXKU3lhFoJPOgdFGY+lPkgQxokkgF9Xgj4AvfoFs84eX4Ke9x9fIC+tRfDxvvniif358sSir2LCj5wNjBKAc8CIi2AxxLCzIAGY9L7AhGIKgpATw4l8wToB0JjPrfTkp+SLQbHrOqm5jNyajS6VCMIpApDAWwQ4LrGgXqzIfnq5cv0vN0ZXHTInME5GBNLb1DGdOYQsI7AfGKFjlgqve8wJwG4T+fuFAFytXzCLb+VgWnH/fIGYfc46Hs7iHC8ZkPcdXx4VfVXJw8+cA4wIgM6AHSLKWZCTESfLfg7WsIyRF3ckiRQ+HACXkwHptyP4KHrpJvKVGnOhRF9eBF9wE0mUEogz2wC+WGI/vVxiQQIxAs9+rmHA6E1YFYB8DJwQMZl0OrLZ++i7sfT8zroYHLS9df4RACWKxSZvLXzG/fQLZqk2gqn2/vUCUQ9UZaM9wDaPeSPrC4A5C1KV+NITKwCS/SiCR/jRBDlLmP7nHynsxno1IPwJSyRpbiMADXzuPDYfZfBTEoAmcuVQdiaW0zwXwQsCYDYmMaDA1wG8TBSvaoR0G77EcGSET6hjOvVApfRPAUN0zjr45JzVcSqiTxD+VeGzXku/4Nr7JwDJOkxFIwt6j6+RqUrlkO4bXzp1gCAAv04AzgLDDsBhKugLFUvQUhTwCEKbnKCw14HwJ9cDgGQ9WegRgDI8XEcVEDvAl7lVlglAgi+I4CR+Zf1mLGgMmDFhBGFfDCicRJFERviSABjLS7FC0MFKMU+07wOPE0kGvaoQgGvtF9z1/iODkwn3VWoEXxres5ib9xx1wZufBAwLgAQexbAD0JiQwJOuJBA68/H3Zhk6+3CifqqwWNMKN8wjKgbk6gWJgC+FMaBb5vJVmsUbV2vCqo3cRWZcCIACoax53+ulkqNd7iqOcU1WcC9cxEm5kQBUdZ+sTnSL/jEtTWngi21jhJNJBivZBukXvOL+yYBkcOqxKjJ4AGgxzMrBVwdAMmHrZOAYF2l6y/mwV6xD17zmWo6MbRyeWtOHwxJ91IIhr6rqZS70DPPLXDVUrfBwzHKr1EUp6/h0T/6L/GcCqslt4IhoTcwdAqDSs7I60WQH6R329pHuFyuXDJmEjuOSbdB+wSvuP5bGUjmsA5XoUvcvBXKKAQnApUdXwah0b8jXR2YzJTsC0ZHB33FL+2yiX3h/1YeD1fFZGT81g/H6yqkVa9YEpqMhTADle8erHA6t7Mh6j4ZBXdBGjFyO4CSIm9wGBiBvgqxwIAJQlXIyEJLyI/i0SkAG/FbhaEr6BXfcv+5dLKhCg4z1C1HEBJ8+BODQGZXfk/quAZC6ketAZEQCTWAU8PIJt0fgwHzZvVWNaKqi7JLOmtDWFy42g1FxH/XfqGkII0C+a0tnDkfsGxQjn3VPsk7tXmuy+Xp0JhtoJosAaFcUAJUYKiYJxcqHqKAH9rPlG2cMrmCUbMX9guMLpGTcCMKDlZGhMK8IPnPIn1X5PA2AwegwEEYmDGBMjOI5whGQP3NPBT7VJlRNaKvF4t2IWHbDErtDlSk1p4lJ7/zd246tglGZryIfrFhQ7pU8WCAX0ZENG+57U14Z4YrCeLrSxXdev6TfLwrbxT7znMrfKQXfHLQCnyvmRIv0Q3430ezMmL98P393G3wqz6am1NYzzoGn+svqRmTAU2citctqAX/2EI8F9ACEmLHXLZGoFxtSl2xyK2bAYwrj6Xr12+1noL/jUTCD9vvFrn6u0v1/nvGkaoVBAQi0eummMAuXQHMWJAA7gCixG8U0gFfcXdlBKk4Z6zELgAJfZEKrxpC1xOIl/+Sk7jkcdYlSco90y9+gK6vJrRiADD0piad7RuFo3udNCgft94vCdrGXn+tujgV3QAcHLcFnroelivHkchEL8ue0uQ74S3eubAITS3IQhKkMRjBMokgWG3L//2z3VSnP4VDgQWxUEEUxAZFHL0eR3HDfm3IRbDHkBfF0zy4EIKNhSvr9goGEBdvTz/MIYQLQdVsTwRTFDj5jQmdArRDYJQNDSs961R3tPhx5NXoVgoxleHnarjohgLec3D2HI492yQNvIwvqO9fJm9zKGbAwnu6FhaP5pFuMg/b7tTbpBdvTz68cz/zI8azVj8iAHTqgmFHXDUB89R2dtaC7tUGw4kDOgFb0R2wYRDGZ8g9O8aU4XwPOczhiwGlMjqqLWiFYGu570wADFsbTvaxg8nkow7E8nM/atfKzln6/1mS4YHv6BQ4+Z0BbqHcd0NwwYbVD3+1yWhXJxPBrbq8AqE/XApSqAxiBV2MZ/54DMOZwKE00rnDUWcR5KiV/brjtSAMALIyn+/mCyeehjIYp6fdrvVELth8RAClyHXxmhPi6r1m8FM0ucgk8+y4RHC1kAK/5XgW+2hZYofafWcPq1B5AqDqEYsQ3nepR2gqhV2yiol1COkD0C+aOaoGx4aL7DQCwMJ7uVwomn4fm7VrX2u/XAlELth+5sHPtN+l/Ap6sX2dCsZ/phZkIJgv9l++1wbcq+2WFv2NXIjNKAPzuw7MUAV8DTuynFIEsQy83RgTAhiv+NgBABaQOGE/3mwWTLwAqHnaQfr9GnwUbARgDNBUlkpzQboyYCyYDYdILdf0l4NduW9kGoa4geNdazLElKoA3Prx7DofiETtC6XvE7hGEzJlpcis3Qgrj6d5UOJoYDcMglrX2+y0NPtl5UZUjkfx/Hqbecoe0OZzdF1gHQrln9Bhee4s3f3Zxm4MvAk9VSFdUIw0i+Q2PaBtISiBSSFgCYMjMW00MP7pwvvLDmwFgQTzdHxcOSGvBg/b7ZRZByWYAlOERluKM3Ra9CKWc0q73dTBhMFT4ZwIw9l5Lrpes+HjeBiGCUOKXeuBvPcKTiEIOR0f+RhDBMYi0Lhea4GTaa5NbOQAVDzhgPB1La5RssV3rIP1+7yy5OAADoAchEHBkFbKfGRpiweAPtMs5IFNokyOGk/7rAYC9OhBFwNXVY1at5tftCBHaWVS2AJdEcEinrDNC+Lumiyc1B8AB4+muLARAXTDCWvr93lR4/Z0Xt6ODFQkj8WtumEwHTKDLQejAfN3uds/dfjoQdatGLxb8jQBAYz6/boxiFgAVudzNIc2/s3xLk1szAORoB4yn+2DhaATAGJCtbpkCYq9+v4V+aBgAQ4i66XtaC85YkDog/zdZvzUgfN1N7a633Xqv6fe9msDIHfNaB6Ay2JRE1AHAEDIfI5nzZCLeN4Nbm9yaA+CA8XSsul6yqV0rJ2WQfr+splCyCYBR/HJyKX4phs0PKBZ0lqOYTpvniAiUAmAd+HKjo1cvDjHgr+3wPJQsVCymUZrPMuRsRBDG4AQCsunyJtFGHwAAIABJREFUcc0BUJlxQoH62q8ST8cggpKNAFRGwCD9fkuvbwAkyGgJE3C+Nz1P1q9/T3F1EZBxvZh50s6AEYC5yyUHXt5/Q8zI5/KrAmAIkkipkyGPYwXz1aRT8v5ZO6jJrRyAvKOvNXlLazsXs9bo/ztc29Pohgotp5J49Rcj/pzfIwGS//3OM4CNd1dpntQpFUmjEH4LYIgnyn/OLjL8FeDGhwJbNgFjI8DIEDA8BAy1PFK7FSKf43cNKrvHx+8C/vmxwMgmYHgEaA35J0StpvvzL/nP8RbLAfhyT207TChgDRiu/ZL9DsfWNABvYzbhCDBKoBAk/pEobGWTqp819hzQ1/0k0PoaMDEJbJjxVZFgDad0SaUO5LksWVj+XScDmw5UEUDJ6U4d0nVbC91S3ovfVHp5al64cgC+k7mZAP768KCA0WD3A/ieLz090CDceVmlAuhBljLgrfcAw6PAyDAwPFwBkCAbItM4a/FiNtERjBl76W9ffD2AbwJDdwFj+6syImRXrd5Y2FjIYcnzWPLEqnsfC0zsr6qBMQmfIDR/pyJ6xMhKyMrSDiKD2xja6TADTt0/AGAs1KcAUCFrOLF6tbtiRVFavT/wuMCa7MfVTlH098YBeBcwNAIMEYAUlS4uBULOmK3LCnwOPANlEIOSoF9+C4DvVoWXhvdWZVOYqWgi3vOXDUQhgieB0EElViMYJ08HxqeqnG8D4IIDkAzo51DKQQJvBKUmKACzbM4+5hUivwrgiwC4LzvjmgCh6nBcgiMTcv9Abo0D8E6g5eCjfpUA6AxoQIzgi8ALmWwC4z//DxcPPwBak8DQFDB8yJPpPZHeGCyC0KN5DFCByfh9/+OAsekKgEzCTwD047X0SCPM1IYQjCv2E/MJoGVwUUQoPboq0MdqkWVn7RtDDMahB4g+P6qhXFpjVtkDtRGA2nKjos7IyOyHFUbIrXe0FXsTuzIYfNb4O2M3ATGIYQOmPn6hG6gi3eUkQQAeAIYOAUOzALMVh2pAlESqGFBAXAYOMQVjxll03iO/yYKRAT0FQXkwZkjp1pz51LO2XAT3KtD3AIAwj4Wg05kfiuUHYlsXAJLVnP0INLM0OYFx78AzcRySeTsw2AJueI+Dj2Fne4EWKz5MA0MzDkCCkAByUWqsJzarEanzj2zXwjEGFHuGY+pYsMojzZL1G9EBexXou339IRBrC3lJGmNDuSHX+w7WC4Cm6wWxm8DngLTImgC8pBcGBuTXf/1fXnyTugnFwxTQOgi0CECyIFlsvvJfEnh0mhsYI/s5uxFYi1xZof7oOqSAawwYjRGBzYGXbtWXaCIrlvHUagX6SP/ruMVYCEbEqECXAMjfree2HgA0ESur1/0vtnNwGSsG0RsZME20/+/XWH6Mugk/yngPAGy5GDYALjiIHIgRUIrsZjM7Ax+BSx1S4pfffQVIep8dL7dMDsTGjJB+CvQxTHmdtrw4l0CovFruC2NOe975egDQsCXRK/eK634JhBK90q2C7I1i+Gt0jxF40k1cPJAB7UP2m3MGJAAFQrGei9iUTH9yBUDTHfU3B5+BOIKQ43BWtNtPcWIOzEZE8FoK9K0DCGNxLi3FqaKA9gTgeoFwPQAoI0OulWT11oEwiFz7cwbErzNxWtEYBB+VY76Vh4DWrH8IOoGQ7Ocg1CqMRLPltmxvs1/SHaP4dcAJePYyyUCRIzrTB8tE8FoL9DUMwl61kQQ87Rmy2PS2rgB0a1ci18RudEJH57OsY02y/+83/sZdBKr4FXQTApBvprGgQCg9UEAM+h9F6ugJDkC3gJPBEvRGrYoYCBX9IxEcS5K4i6cZAHIw8oXQ4mLBb35YH5d7OekadtTV1UZSjaEIPH4nQzYNwgjAHNwDuWGYpZc7lzPfX1cQur5oBorfzDf+zi0yVTuSkuxBI2Q+PhQDIUEnMLo1TBCZLufGw/ixbQa0KB8CTODjPohdY78IQmfDjmW7Yo/doAX6GqIiAtDHaYswSmeMubV81kp11L6hy2PdAcgblfslOKC1IiKRmyRxZgV/8++DS8BFrxXi5Hd/U6MeSKdqEsEKhpBRsgRMbAtuG4KU/+9ry5brzP/lPVMv1EPOQegharrVcgZUhVHFxNPcp9VFtlOWkL437C0WABWypFRGsV0sb5Hn2zYBwvUGoKl10v1knDgo0y7XA8Pfv0UACnjaK33Co9gJQAOe64FkNvtZAHQdjz9v2Nz2GSa3jYej2W3KGuZ9ixGdIVSoKT13B2s5AHkGheST6qn0erHv5AIgAAU+LVfw/wq3CEAV7clBKDDGZG9/5oVXx/oyYARczcqH5GyH8eFplTawFvAtrtXLGpNrQDGbejupB3omlIHQGc/ErzOcGSRs8zrhAbbuL1Tco/JfbLlNwHOmi2kIcs3owbdwNpYtynDQhsFcgvuG9/YapGFvYX22zZcAU0/GwA2LJ/4AmGF9mwEbBu98Y3cMF+uAGQCj2HVp3BbPuo3IlqxAy5wHAq4OfARmEBXGfNIBa0BIsG0ecwC67merHgRpZLwocrWaovuTxew/V0txJQ2DWeae3WAGbdhb2DB4+wRw7w5g8Qpv88liyGtoWHzMi4C9fAEHbBi8kwUKu2xNAdBxaGBLbJdZux1LwAGECYAEm6wyfpelJrEgFnRDxESwgyUxIUsVMwjVy5AYO0bG89Auu1/5BF38KqjBHlUAYXsteNCGwTeWNuwtk4JMkrlzGNizA1hm69g1Nix+zDOBW0aBeRZZGqBh8M4emfWNADDT+zqMjQyESdQFHfDbZECCLRgdHeCTe8CBaKJY1rDnBRCIAuGW4TYAZeFG8ZuMkGiQ1IEwGCJtHZBmy1obBsvVMnDD3jIAerti3LEBOMjGcOpa3WfD4ic9t6oveDtLfw7QMHjnH6wPAybW6yaG4+8D4HIQfvtDIVtLejpBFsVvUI7NIBHw3DUjRzL3rDVtsYPOkAScuX3coNDynT2VYJCkn+PjqvUD8hVbS8NgjphGxcANe8sAGNoVY/824BCBtIaGxRe8pLKZdpMkTvXiJ2toGHzSNHDPScAyq3er4qPyGaNc7JCRXWLT2TjwGmCOeQashq6+qSpZmp8vojQpheF58ncdZVjLnjWPHr4VWKTKxrHGUqq97qXu3jp0wPy+eEC/DYNZsZAO6IEb9pY9lNCuGPcNV830ZmkM9dmw+OKfbdcXvJMPdY0Ng0/7GnDXKcDMccBS7MwdKz8KCAKQIgY0MWGCtr4TOHAasMwOkTqf6unyuLykfd254nkb7qsw/iVg7jhgmSX31Vpd9yRHeLx+zRhjEGRbB6wDYT8NdymyubzDzCCGfpMJWfSRYfr9HP/aMgBm7YoxNQHMbQHm+ID6aFh8yS93tAvGQb7da2gYfPoXgbtPAqaPA+a3AEubgGU1RM6B060fgkRoCzj+TcD+04CFE4BldZdRc4/YxlxgjJMewSiwN1zWfsOngdljq3EmY08vm5i/7j5yIMqpvupKyGoNg9lngYosl9wY/0dZdrMzYl8Ne8sAWNOu2MA3zw/F2CoNiy99XbvftrcLriz6PhsGn3U9cM9xMODObQYWCMANwPJ49UliuW6SaqqBn/gGYP8pwPyJwNIxwDK76ahDeN6uXYCuYyABkEza4LbpY5WEWdSLxjF26/dQB0SJ6r4ByAN6NQxmkWcqrnQ00x1DEDJFjR8CcNWGvWVPp6ZdMQ6OVOCb3wAscPJ6NCy+7PerkP5Q3tBY1PrT9tEw+JwbgPu2AlNbgVkCcCOwtAFYcgAuiwWlM/XqDjMEbP9t4MB2YO54YJFMo/5gHIcALV1TRZ17FXOhPtvgtvkqf9H4kvHDlyKK4l6VzvVSBF22uwjOb7pbw+CfcwBSkyeFEHAUx/yw9JTyEbo27C17Ol3aFWNuAlgIn9QxO2tYfNlbK6MvaxeMRYquvL9rTcPgJ30TuH8LcHAzMOugX3QALo21WXBZLEHwRF1OgHS2eOgbgIPHA7PHAezNu7QFWFZ7JnXJ5rnqxHEulvlzwyVNN3+wern5Yovl7SXLGwvn4riLWO4fgMRJXcPd/+pmOymELEhRzBxJAo9gVL4kwVnbsLccgHEpWi3epocCAMeBRU5eTcPiy/6qtl0wpvhA+2gYfO7NwOQm4OBGYGaDs+5ExYDGgqP+ccAkINaVpB8GTv4d4OBxwNw2YGFrxYCmV0YxLNYheCXau7EhV3ga3Lb8g4+R45uoGLADgHWqhsBXA8K1AZADyRvuvtkBSArh+i9DsQhCOtf0UUgW/7aiYW/Z0+nRrhizoxXwFhyAi5y4rGHxU66qAFhT3rDSIVdpGHzencDejcDBDcDsBDBP1uX1CMJRwFiQIBzxieL3KIY1YW5MPOxNwLRb8gs0aghAss1GZ1O+SFHsdRPt0i/PLHu++dFb/x4mXfhcbWxhfCtYMFr/uWvKxfDaAcg7ipPCvFOVpuo3HrCjYW/ZA+rRrti6TS6MVQ+L4NPH2nx698GnXF0BsKa8Iab4dFZpGHz+JLBvApieqAA4J8CPOQuOBBAOV0CUYbIskRkAecrvAdNbXc/aDCxSpyT4CEIyTgRgneiLIp3nP6fs+a4A4N8B8/48CUC+ZGJA29fpuLmxJW+5h5kNFg2jiWHSi0r0Uv4pCoZsxw8DUfnhd4Vk0XGdGvaWPaBV2hVjdjgA0BlpkQ/K9bmn/HOVqtClvKEBqlfD4AtmgP3jDsBxB6DA7tdbcvYzJvQJkii2n4NOeMpbgJktbYPGACiF3wFoEx1ZMNe/4jnPLXu+KwD4t/5SO/iMBcXuesHylyACMBPDgzGg7opM8mEHIGdwrfGA1rC37AH10a64Yr4APvvOSdwEPOVbKxu+K2pdKRTmdI3dqkPPVgbSTBGAY8AsATjWniBdx0QxJylOFCcr6HBiw1P/CDgU3EgEIMW52M8YkLolQRddIN1AyKWiBretf9MJQN6HsaCPxe4rvgDdHOcOxDIAcmDFDXvLnk4f7Yqt63gEIB/Yoj+4p9xaAbBHeUPM8qF2aRh84QQwNQYcGgdmx4C50WqCFngNsgSvQ+Dxu4MuiawhwIAXVk1O+e/A7CZgThY1dcno1nHL2oDIyZULpBsAFTBZ9pjT0QQgn2V6ufRicS8QRgbs5ZYpEsENDejBfpoLrwAOjgIzZMBRZ0AHoUC+SOA56xJwNlEyTFw5FxBPeWvlzpnbANCdQ1eSGTRybMuydgMggVBsKmtYoC6Mt8znZxsZMLzAxoAOvsh+ydDqtXx4FIDl8L/omQ7A0QqA82S/ERdTI22mNfaTuBIIxR4BhKe+y61punQC+MytI/Zz/c9EuvyBeetLAfGZ5WOMZ9j2/gqABB1fMLsHAVBqhfTcyH5d9MByEdzs+B50Z7voGZX+NzNSsd8cwUcG5ASRKYbdHRNYwhhDIHRgGmO0gFP+HJh15jOXjnyKblVT5Cbfoq+yJOszF8P8+VnNPlICkMAzds/YLxlYznrJwIpO6egTPMqA5ZNDAB6iCCYAyYBcBqTRQ0e4630SxZyQJQIvMJ8mSeLrYe+p/GzGfnTpEIBy6US/out+K1wg+brs88rHmDOgAVCMnrEfxxMte1Mt6j7u9zzKgIXzczEBOJIB0BnCJoqgIfDEhM58SWzJEPGJe9hfVH42un/Mfxl9bgSiBySIBWnAJBDGEDAB8QWFA8wO3/a+wH4+rg4RLPYLul8tCI8CsJmJMQAOuwFC9qMI9g9Z0CxhZz65K0wfFBPqu7PEyVdWAOTHVlTcpxhXHZLz1w0ZA6EDLhkCskRf0sw4dRYC0PQ/vVSRAYPo7QCdj7GqVOSMeBSAzUzMxZcDMwLgcKX/zbv45SQlHXDIgagJc+bjZBqAWhUoH/Y+B2D0J7rFa6LYDRmzomsAaOeKqxEvbWacHQB08JkRIteSXiSBLYJOLB+X4xrzAzY7vgfd2S4RAKkDDgPzNEAIxMASSWF38WsgkuXLyXTRSRCe/DduSZMBMwe6ObTd8JBj24Aot07uDObPP9XsIzUGFPs5+JJ/M6oT4buxHv9X7BeY8KgOWDg/Z58GTC9Xq5FxTXOw9c3Cm6k5fPcjgbHbgAlvVG2tH1T3Oavoq6BlniZ+12n5u/2sDbOvasqoFg8x2Lnbcd1GdhSAhXN+7qMrAC4sA8sORJ6yHwD28z+Ft4fdv8UyqUDrDmCEBcpZ39kLS6aq9l4D2rLb/KYsFTPWdfbvh86vQu2s1K/K+zIjTsXIVQ9a59Egs4Y6sZfIA/EcSp/jEXv8BWcAhxaA+SVgSQAkGAMICcwVlNLlqTc9Gbv/HAA7MrL4+f1VlXwrUq7SvCoyGcrrWpGhuur2fNGYwM8YT67hT3s1LaZvqn5MLM0bzmHMmIFSgdFNj/mIBct63NhFZwEzDsBFgpDPeanNgATfCtGsX9TIKwNrg9tuVkhlng7TI/YArX1VkXKrEe1l2SynN1RCsFJsqnQv3UIMxhwIRjU5AGN9QUteVz3BUAvahuNgjC3HxLAND7nBp/cgONXF5wCz8xUDGgCjKPbvevlzcKUHH2ag6cnYzepYBB9Zi2FxDJdjoXJv1WDFiLJ6MKqKZUzoQFTfj2HmwTKcTpVWvcxHKm6kKgoORAEvVclPD6NdzLXpMT8IYNPcLV7yJGB2AVhYrAC4SNA5AxKM9ryDPE5fs6eeVKWGZ2M3S3MQfEyJUKV8L1ZpJXpVJ9pLilmlAxWkVJHKwIhjjD9TtVXVm1HdOy/pJiaMFRWM+bo0rWl4yM1N7oPhTJecC8wRgAttBjQWdBBGESwgSiV0Pb9DRgu0TY19N+M1mRKh8niqFx3rRDsLqjgl9yaGXT80vcL1wnE252PAZCzAHQCoiqoW3yYWFIt664fUpKaREr1NPakH6XkuOQ+YDwy4FMSwgU8GSRSz0UJx3Vx/5vFNbrs/EiLRY+v4ACITww6iJEodQKwBIyBRv9vwhKzUW6z66TUGEwhDS3ezqusAyNxnJn8xa1KRPSFts9YfFB/QDZcAm78CnDBT5U8rCqjfc3yh8Gn/hGd/MsKf1+QzYJ4891Jye13iy1cAE9cDJ+6FpYrEkidxDN3OtXR+FwBGMezoMmxJLOumAuD4J4rxJrfdH/XCoLGFVKiUbw+LAPQqWWaMMLrd6/+JycSIm85w9lOpt1j1MwAwFTiqAWEUxeYH5ENn/jInUVHeMXQ/f/jRePvCa4DhTwLHfBc4frGqqaNJzLPw6iZxV+HTplFGvZrXZT45N39+HW3TujlZv8D6fp8HRq8Dts9XIOR5YtakgBgdrrrt5Qsq8Ssd0BhQ4HMwmVitAWHAY/LbLDQNQDaTVJ8Q6W4qVB51OOqDZDPVB3TLOBepW5jmqaLbec3jGgBGMSxvvemDYkQ9GoKF1ShUCSKCqBeQrvmfVZPC1keBjXcCmw911tTJ8q5XgOLaQgA+x/OdWA2EGZ98gbjleTHdQHQN+2iwls3nK3/Zhj3VeQhovYzdxmArSwQgDRA3QiSCJUrTnjfl4KozRCSCCeYmt90EoJJbVCk/1+FiCwFZxLk4dRfLFia6x8LbYkD9v9cXtLG6+O4AYQRfrgPygVIcqyhTXcWFOJH8fh3rz7EKwnUArq8mcGwK2MCC1i7WY7Zenh56feHT/jE3yliE4TZncd636gPFCKWavGhcRx2J+cvs9MlSw0Ty3cCm+c7n0G0MExdW4BMIbTXE9UCynvyCCX+Ovm4gbByA/xisVgJPpXrzLj4EoRJjJIZrWHArS9iprK+KcefgiyB0XVKGjOmCmW9xhRVMUSyRFnNeFGEdI2q+/HFXclkp9WsAbgTG9wGj08CI64WxRk/OTDcUAvBHXSLQxcVCDMQSWbzv+1e7WVbz+k5w2tJtsbcCYV6WJY7hmAsDA7r1Sz3OgOgoM+KTOJbcjSI5yGIaNE1uuwlAAU/MF+tF5/0sIghVLdVdM2S0bSzHx2Mi+FTxXf8X925NC4BycK8QwfmgVX1LlcFiykEMcL2BndJJ7aQfijKfxLGDwAhByM7aC5U4qwPzNwufNnNuOH4VZaCPlPo2AahqFqoPVFc14ga2m+WEEL0cAz9kdPrOmMu8r1o/rTsXz7f9oswFs+jO6LAqkvC3Ggg5Fg6mwW03CUI6X12h8lyfcz3QHqr3DIl64DbqaQKc9mI87QXACD6vpJqY0EVxz2CEyCI5eMSGX2e7VtI5J4yTRyZhscrvt1nQuivOAaNLlYESwcySgiVbr37Bfd0/u31yEgg2FVaiPCeVOguqAfGov0iR0R9JABJ0bnwk9nMxw+fOh55EbgRhzozrBUA1polN9CLwok5HEEUQBjFMQB7D+j656PW+IrJ8O/bBCo4sGFdGejqiyYCx3mKe9/JtTiBvmI5OFiTisg9LtJFF7gZGDrUbHKs79+hyu5hSaUvh1foFr3r/6vZJCiXgCDwVVFJ7MVmRLsrGltuFCc68yFdACMDAflwR4QM3HPoKgIExt4gz42SuaQb8hBOE2oZmlu+KFlKR3QSssMJxDPWbbjpfLoJrxG8CYT8MKGZSVTCxYFTIb84nkCxCIPLDiby30gXFghaF4c2ReR466Uu2fvoFr3r/fKAEFxvpqMcd9yonIrkuK5LLV7MVCM+/uDJCyIC2J8a0z1iwqyESgMl15Sa33QKgmtPEBnp11mwuXgO70Ud4DHWzfgDYC3zBEOk7HlA6XKyHQzb8HgGoCSQLqsxorIy1Bxie7Wx0rFaf+wr9Xv32C+56/7HbJ5VHtRYT+GJrsehHcya57PyKAQk6+vBkBZPpjPEExlwU59awg3C24W6KBsC6tqHR+MidyVG3i3rdAnAsH2T093XT+zLr197MTA80h3SfsZP2UqpCrPQ46oF317VrpeiKXTJ9MhMLkgGdCacKG/mupV9w1/vnwyGgCDCKWzJe3lqsyzLWZWe6/kc/oKzgKH4jC7oolhdC4jiuzM0WPo+cPQ2AsX1obFCTO5Jzn566PwbReiwnfTWjI4KvDoh1juh+aT+WKSYD3i8Aql2rJk+VsVQly5kkddv2FvHT61icqO7Fr71/IkLNXOi0FQjV0046oBy6wZ922Q95ICqDEaL4XWw3COcf9Mw73DFB9AqE6wZAAS8XuzGQIDKf+oVkqxt00ttAc+YT0PJ9qRFSB8xoye5Xu1ZVeCSgCLbYLVNswoncHxoeLwCzBGjBNki/4BX3z9lXgUCyIIGmhova83cRgO5Te9yLgP3MfmsBS8xs8/U67ePQOqy9umBUruDchqo8sHSd3PMfT5ifo+ack8eFHI6QEcnT5GvdOnVdXof+ptJ+BVPWceiaRHA8Us/nkACo8mzqlqmWrbFDppT5A5UIZm7CPA2Vgm3QfsEd909kKIqB1qJAKCBG8ZstZz3xHOAAiwmpDIdng1maZQAkZzsHZ537YfQrwNyxoQ+HakrnS0h1mUA1C96TdJTmORyhC3oeqdwROi+GDhkFI6bYNrcNDEDeAkXwQizPRpmnIs3OdqZPSaRFUcbchHlgie6agq2kX7Dd/+d8lUJVXuUzk8ERmS+2vfd4uvN2VOV5rSwb0y3JhgIh9wJeN3YMQCIgR78Q+nDEVYBYZUrUpbXFnM7COSdf7N4IPvtDnT2BY/h8Chh10MXQeYGS+7GGjaQiABpuNIFiECnzdWJMIUHcazLptC7YivsF8/7FgLFMqpiQL5TuNbKfA/DC46rqqAbAwIKWK+timRUBEiNGsOQsyQm+Gpjd4n046hbT84KPuYjOmHHyp92gcgDS2OoIuVIeh/xyUkaVwyEWdLrewHE3uBUDcKIwnq40HpDXL+n3CzbaKdguel5VnFJl2awaghLQBTzteZ0cjLq2A2n0M6EPh2pC57Wg41poLzZsAZNso0Hw6eVR/J8bF9YjWGmVCpGKwQLBRCcrbiSxNLgVAxCF8XSl8YDHHFPW7xeFBRwv/rGqOKUBkODzqgdWPYAM53vTASMQu4Bx9J+69OHIF+N71F1O1gUB+AsBfFqKC+4Wi4BWX+CYgOTAU36wdMVNVKka3MoBWBhPxyiuko3xkSX9fvGMkqsDlzzHC1N6SQ4DoINOe7KelWWTheziObeKCdARApD1AdVnRH048gKUAmAEYi6Oh4DJV4VoGDWqjq4XLbO5o1jBoimEPhPJmwu9FvnTLgdgYTwd2wyXbMyRKen3i2eXXB245FlVYUpVxUpGiLtmGBlrTEhVUwV8dEkVKAq3MHJ1uzRbRx+OOgDWFX6MsXJU/36lJoEoA2AKvw8+uwTEDIBbStdOs8ddDsDCeDom7ZdszBIs6fcL9ror2C75US9IxJJsEsHdGFBil4yYuUwknofJgF4XcEUfjrz+X7fKo4EJJ//PkMORO6FrVjQMeL5kJhZMMXzLwNZCt1nzDFgYT8cQwpLt4hDON0i/X7ys5OrAJVe0S/ISgFY7j9ZvnQ7I3+lyqpYaL98CWp/N+nDkZdhi6bW8An1kP3fRTLKVWlwF6RZCH2L4zDDR0k1IqeTNb2OQSYNbOQMWxtMxeqtkY6I+ny9VEz6btfb7xc+XXB249AoXv85+tIBVgJJ6n4lf6oV+mfjdDJNMH0wAVFX90GMk1f5TxlS3Fggh92DyN0IORy5665KIfCktsl+K3VsGtpVOWOMiuDCerlSnjQ2rB+n3C+pIBdulz8wqonrNPLKgwKaC5B3s53qhXVq6oDNg6sOhqvqhEr3V2VNLBjmnSSNdrOLJ1zkAu6VPRjFcFz4fXDJ8i45hG94Gt3IGjOFYA8TTlQZ/qGH1oP1+8ZtlT1MAtHK8mQg25zOZUSCLIliWcbw8wfW5Ln04ssqnHX04euiCk6/3de66MPpuAQVZAEFkw2MKFw6a1wEL4+lSBvmAOMhD8vkOkFX77feLNw14YT/ssmc4A6oOdHBEkwXlgjH2k4Nal6wB4fIuX9LzZjAmorNeHMo5Tc0OewHwDTUh9HXxfGJsYkAbAAAgAElEQVS/uvCpoAcew6zBBrdyBlQwwoDxdLZWXLDFkHyF8xGE/fb7xR8XXByAAVC1oB18HQYIT+8uGfP75SCUs1o64he8v4j6cIQ+IqkPhxrBCHjdjBH6AblQkAeY1ondukSiELmsUPpjbyp7XuvDgAXxdNZVvWCLIfmKg6Bbhrjup98v3lVwcQLw8gqA5v9zC9jErutltg8gMxDWWMBaMVkmANWFyEV6R0uH2I1IzW7ypbkQOTP5f2ch9KsFkwp0kQlDAOmxzHpscGuGAQvi6VD4RgmAg/b7xZVlT5MATNXwqQc6KGwf2U2uGV2uzg3D4ua7fDnPwZcKgIdq9GaIBPZb0YdD7hgyIFWMXiH0eQ5vXS5HcMkc++9lz2t9GLAgns7KxxZsCkgdtN8vWD+vYDMAUpcja7lOR9eLVcIP4tcuob/3AOHCdW02VTX62ApB4Mv1v24gnPy9HiH03fJ366KYHYTHsgBBg1s5AxbG0+HLZaOp65i+ln6/YM5EwdYBwGj1cmUkE7+8THLNdAHhwrUOXtcrO/pwhF4cct2oN68BMDCfmsJM/n6PEPoYPp8bH3kCkbtjji2tJJA962YAWBBPZ0WBCrbYsFoOf9pDAiENk179fkuvf9nTXewKcBSjsn7ldonWbgQpx+26otaLIwAlfi2QQSJY3Yjy5i9dmsFM/oEDMM/Z7Uf0RiYUA7J+ToNbOQC3e0WBBm9qLad6HICG1ZK1XB5PoxnuOOIcxSXe/Of8xHV/P+FpwN47gKUpYHmuSve0pKZgCKSq5wqniWE1WZz/xouBm74KTMwBI17lVBXwtWSs+8/vL45Ff3vhpcAnvwos8d48DZX3M2hx9XIAnu0IIO0chu35AOgLL0yuG/jOmwbg028G/mNz1YWdETbm4I5BrFlov+EtD2wIo7l+Atg8D2xY7iw3V5diEqO54mnj6XdMAYcU+6gon7A3NSO2qFjlyZYDkAX6uD5Iam44YaUfVNDNxaJcLIPXcGGpfi6PnZdVD1wPspQBX/wl4OaNwN6Jqg+xwrxslcVFuYJblehkcYYZGPS3L20BxueBcS8nwg5H5kZkx6TQSbXFZcCQKadx5Cz5mPurAFxrRaa17pAR2PFC+ElSHKQ/0QjQcgCyGyM9v3SnsDBRJgL6msWCf6IfWeUJac8UFlpY8500DcCfvgb43hiwZwyYVhd2D/VSrKGAmIDnBkiafEcN9cprHgKMzgNjS1V7rRjRlceyrqif6KAkMgXIM+6tAnDl+zSL36O9+U8p9jGHQo285/2XA/AnXeNnKAorDXH/AILwbSvLEz6Ql2+cAf/3XcCdw8DkKHBwpOpFbE2wadzIdyh3jjNQirYWEwYq+/zJwMh8pf+xKNSwM6DZMmzNRRbM2K+2Ii6TlFrAWfd5V3i/F7IgT2LBF5LbIdkqxLPWvtzlAGQ3RpU3Y7AiixMxLOUB2t7pKQ8M0qCTnp8HkojJgNqaMEJesQv4AR3Iw8DB4QqAs+6SWRiqgJgY0HVDAdBA4Ba4xN7ndlSFAAjAYX4IPO5dBDMAdS2i+Jx7XTf1eEdTDfgAQnR34p/wQkRmjNAoByDT/ugFphXAmjAEn8qaPQAgZCs0lSckCNmVigEbFMsPBBE3DcBX7gLuawH7hoAD7EM8DMw48AhATrjtQwiXoqkTEwWd7LOneXNCbz6Tiq/TInb2M8ZzIFrTQbGiy92oGz7pXl/7jvdAJnb2470IbB3T77Sai+hyAP5voTqW6sKwFAc/TAdc5+3dvcsTrvPVYSK4SQb8xV3+6IaAqSHg0FDVh3iOIFTIFxtit9orL5Z/LD1Q4s+B8OnHVuXwhhdd5DoLGsgCCJ04q66X/Ju/vSaeAxDPvbdtmdtKDV90gVEPIl/xySkviOhmAEjrlzSkwj40SlQZYZ39I+8JBMx8mZryhOsKwqYB+KpdVSDFvhYwPVR9BD7uyX4SwRS59nNI+bRck/DzJ05v12M0nY8fAk8iWL5BB5qASPGRCi8EVjzv3mqpkC9ACrrwhKukB67GhpqRRowQMqCiYbj8oOoHeUWpdYIBAUj8c8WjrjyhNIJ1unzjDPjqXdUjJAAP8TMEzLYq9uOHICQALe/EwWe+QgddAqCzzD8+vgIgg0qp+5nYjaDzCgjmnCYone0klqP4JSgvvK+6LoFPoFMlkPGh+0rPWta4RHTNJJQz4M8EAGoNTPVU8opS64CC9zoAWTFChcq7lCdch6s3L4J/2QFIEBKA1P9mHIBmhPh3Ai354RyAAmWsR/PRs6vOR8Z8FMPS97yxtIlYgVB/I7jC0rIKSfLXF1EEB+BFFjQ3jCLA49OWsRTTEPzvzQEwry7VrZ5KwzAQAPssT9jw1dcHgCrORQCS/bgn+1HsCYQSveaHkzvGv1scgU/6R55Y1YIxhvOm1EZekQWl8wVDxJgwc88QiJc6AKX/meHDawX9z16M/Em7bO8Q08GBP/jEkAEVjMBoAFWXUjRA3KtNwOBXW3EkAZhrALktpC6lKtTV4OU7RHB+3kHWgv/zrnYZl2kCkF4uF8MGQGc+MqEYUCA0n1tkwxbw4ScHAHr71Q7W4++c8czwcBAmHVB/c7Bcek9b3FuwbdD/kjGWgzJjQ3thGmVA3jhfOyU+RxB6FamOFp8NrhsTgLy8Cpzm5QlVptAU+6CiNgXCaIQ0BcDYV8b0P4pi30vfIxD5+w72C9aliegW8MHzqrmh/meuFhYi0pKbs6D9fsh/n1XFMrYMbPgUByCZz6J+uEknDA9AornWFRb01WZEsACoHhOqyC7wdetT0QAK2KqOb5MCUvPyhLE0oQxzqaYNXL5xBvyVXe12vByLADjXAvgxBvSPGFGMIjCmJbEW8HfntxtQmxT0cmxp9UPAdKAZ1upA6EB7qgDo6oCUxXRtPVSpAwJpnUhuxAqWCCYK1MBExZljY5S8SYr+pxAFAuBayhNG26jw8usCQLX0SAAkwwcAEngyQizaXoziIli+Oe7/9kJvNk1LmBMe9ECO3XRB7aPeF0EYHNVPdT8gj016YBcWtBfBVYJuz7mF7VgGY/pO8f5WdQ1/7U67nIKNS7j0wIbDPFZsyNHHY7od/xdlEHj8CcC3TgCWHgGAPSxiSdt4312u/8SPAl8/Dlh4pDeZW2PD4J1c9+uyDaIDkgEJQKnTfG/N8nUAmu5HUnMW5ARbPfEuIHy/ACjRK7FL5pOR4RaxgTHofKl8r/S1ZWBnAGDKefbn3AFIPRPXB7sFiVQimKVgGdl5ooNwLQ1/1U+DQGSXQ9r5Evy1q9rZbP1lGQDZsPpzI8APHgXgod7qUx11YtBbFzC+/C+BL7SAWwhgdoLkONSLqy5oLogYft3ZI1F7EAC+phsAnekokhP4HIzml/PvthQWmPB9LJ7jxkcSr14jWj4/0wFlgJD5eoDw6fe4DzAYPHokWhHJZ3TFSkn4h7YOSOBwEtiMTv1aY0uktFYTmI2/43EMQmCuAJmUE0gmVD8EFdPpdnxhVhqzDr8F4NMtYM9Jfg98EVTeNu9Q2OFZBX7vr9vtgm/lcezczZ61ZNN8DCvilYCdPXqNDQpAlfGTKm0M6AA0PTAyoMSx64cRfPQHXsniOTI+fEWDFGp+Qb9BeySRBV2kpl0QxxGAlHDmkI56X6z+EP7UDYSdRgh/IouwIZ36lHabBE0GJ0r10Rgb/xA/tt/j/6aMAf+7R4CxzuBXWRGULwBfIrY6UNfpvLae7n0I+LO/reoLMqiVMbW38oUhkNkQIzZO7tIweGePcmWlAFTjAYHPVGwXxWoLYblEDkLuTT8MDPhXLJ4jALpaJB+ggU6xfgJknT7IKXIQXh4Y0FZCog+wxiUTwSkXUbSMV1rB/A31OXWuFpPUda/mRHKi1e6U+hA7Zq7l+A+UAfDtHg/LrptkQpZ727cRWOL9542Pa3rOvuOqagUltgtmJM08j4/PILbIDKz6w5PAHsbraTnMGdZWIwIzxIfeK0rn578J3LAVuH8CODRahV/FFQ/1IumIvXP1QudNfyNT8oVqcHviPcBd48A0g2RDuoDqHdb2SalZAdG9dnfDkAE0gXnH5ijWCDbKCq5/MRiV0QD8HgHQ63jG0hdsLGxA3x9Bw1Asli7hO3BwApgng/Gjvq01IHrXJ7q3Cz7E++YziF2rs1ZLZ+8H9jJsSoECWXj6igmR87aLgfbGq4GvbgLu2gjsHwdmCEIPSI1h+SkCRjpfUC3iNWcpoRrcnrYbuGsUOMBo7QBCxSTG/igxVcBIVGPWM1h1JYQPnyKNExGZMDIJ9b66eEBGxPDY1Y5nv+GCjfGAxD+DDpiawphABWZPjwNzNLAEIH4XCH0M7/5c93bBfI8Yk2cgVAdvdT10ifDkBWC/r9lGH51NhIsnsWHOfPmEUKT94WeAG8eAO8aAfWPAwVEHISNQlKQUglJjJExqC+H6Nq93kOpUg9szbwLuHa66QzFWkaFieXxi6hgVHOMCYGRuJ+5V4jYJIDKI9KlsAvFDq8QDrnb8NWVPh9EwdFkQ79TlSMIsN0Mi5s9MoOGno4U6f3YAvefL7Y7rvdoFLxOANSA8f7xSgWmd0kCQbmZ6mTLEnJ0UqWLhUkxlrBn6n3wWuGkYuGukCsufGq2iojnRFpafsU7MDxErJuZhYCsJosHtWTcBe1oeq+hxigJgXBrMmTBPnJKLrr+VED54ibHYvZos8sO+DNcrHrDX8YVVyglAKud0LtMjFPtNMz6QLDY7VomLJd671AEH4Xu+3g7nWq28ISvX58/hguOBg8vtFQvV/hEzxfqOevuTfpjri8vAWz8L3NYCfjBc6ZYHmBcitnFd06pxyb8W4gPlgonBqffTtdTg9pybqiVNBssyUsdUD7eGO9amnf3sXtxQipl7Wg/sD4A8AwHIyZMYky50Tp/xgN2OL8y051qw2hXzwRCEdT2nmck1RxHG+w5jeO9NFQBpR6ldMIMXlFWgVndqF2dVFsJzuOgRwMElB6DcI6rznemD0RnbwQiSRS3g7Z+tVIl7PC9kahiYZm6IizuLigliT/VoUog+p8P9l3wJ7qGEanB77k3VczroUToWLCsABud4ypaLCUoxf9i/9w9ADiICULrQRWuIB6w7nuZrwaZwLBGwClSqSyz3AhHbaRGEFGOmC44D72UVgjW2C2Z4lIF4ArjodODQcqUGqAxfcpG4mJVuVqcL5tbs2z/veV0tYK/nhTAqesYNHdO5PCJZos+WuzxHJIViuXFyJxupNLg976ZK2lizUKodilGUgzyGhokF8yw5Mf+qRkjdjfuDtwkkm7DTkNaBaQ2ox1q3eMD8+B6O3H6em8Kx1Ccx9ptWl9iYIUAAWrI3I3nHgPdOtsO5eOuxXXBdj0V1vOL/so3Cxef60tlSpYwveKf0pAu6ohfdJ8k4CUqgvr5jV6VGTBKALeCAh+VbZLTnh5gu6D44A6H8cVlkNK95O1WkBrfn31R5HSy+JCwPplAxRegE/2T+AloGncNmbQyogUQx/KwB4gHj8YWNTwRAOW0FIIIndoqNkTAxz/bd09XDGLBdMM6/pLKi5whAX60gCK2ujxzEAqGL2pQ1Jis5AJEAFHvTujYAKjRf+SEugm1d2COQLU/DAwQ44caEw8AtZzSIPgAvuKkdrWMM6M7xCMBoiBn4YpCE2NCfxWAA5MEuwvCCEICwlnhAHV+YORfDsWJGgPpMKwg1b9QpFnzHbD2BK2JGul9s8KkYW17vLALQRTCBpzXZpS4gtCXXMAkduuAy8E7PijPWprXJ5CR38ygw1fJDohh2BlRAgq2OeN7uTWc1D0AFNtmL54ESBsCaJcLkDajxj5ZXRiCIGA0waDwgjy8sk5+HY+X9ppUbJSCp6TnFCMXwny1WAFQ8rUAc2wUrRL6mXTAefWnFfnz3FpbagQKLAqAzoZjAKkkpXkNO5GCEvOMLFXOnnC4xIKOjnQGNdWSM+GqHQGd7JSsxUf+JzQLwhTdV4je1nQvr1MkPGtlf9yP2Dy+gAqZ6rQytfvdHSDxgLwBF8AmAYjHWluEDiKGMiqOVvtejXTBOuRSYJwDJAARgZAGWL9Nk+IM3SzgTydE4eec1nZHbtDaNAf1Dpd/SMx2END6kD0oXtFhBXmcY+OY6AFChnKnzl7NfdMR3qCAae2B+VVMYXASvDs3/X/zHJZcB84vuiqABEo0QPnhnwqQLyRURmZBPytnwHde0M1vN2lR6picoKULaxHDIEdHkW2iWg4/7b5zb7DSQAVd0/griV2JYojfpwRGEYsGBrOBmx/OgP5sAKANkcbFzNWTRnX/GSGImMYH/LYlk+gGvdT+bW+SWH+Ig1GqL5QeTtR2EYj5LVHfjw/ZDwL8yJ6TB7UU3VVoTjTYxYDK+Ivv7dzNAZIxpZSiU8jjKgIWTcykZkBawDBBnQdMr5QeTKI5iWCB09AmEb7+ucnOQ/aTPWn6wuzyS4u+R0Ob6CUGqJpIDA97AdqINbgRgBJ69CG4Jp6q/ckjXqB/RKla4WpkO2ODgHoynigA0JiLwaNiEt95YQKJ4FRC+7brKzRH9jZbN6iJYuSHm9I5iOAOhHNJfZkh+gxsBKPbLu3+JgaWDdojhMO5kkDWSlNTg4B6MpyIAjf3IggJgMD4MCARjFMU9QCgAykhSKnUCYHB9JB0wy5aTRUxmup4h+Q1uAmDs+hpXgFLnB6ULONOn5xACNJqxghsc3IPxVBGAiQG9aLeilWUJW1FvVXEN0TKp1C6At19TMSCBpz1dHtT/JH7N9yaxp6QkF73KBxYIr10nAMproB44qQGTj6sjUrtOFPtLeFQHLES9AdDFrq1E6M13MaxVCTNAXNFThIylLcor40zxtgDAPKuVwDMrOKw+SBTbtR2MND7sZwC7Qvm4wqHa4T/uIrhb+7n0EgbQdTijoyg+agWXT8llDsAFWr/B8qP1K7bT0pvtVwHhW6+t2C/m8svvZlawi2CKe37nhFtapkDnILRqBQA+v04AjMyn79EIkXO/DnzyCBwVweX4wxs9B4rRZgyPVFqykgDd+5JSpBU5r0vHyHz+jsc3ub0KABsZMCyQgeExKyFPVIz3lmcM6OfPAGCADYPE67Jfs6h7G0o+xvi7oyK4cLZfOgpsXwC2Lq9MwuuVERonKn4nSJrcXnQKcM7dwMMXgYcsVxkSebJgzOWPqdB1ad2f3gpsnwK2LXWeR9m3danUIV1lBSCPArBwtp+7DThuBti6UDWDmWA/DvXk8LRptfPtNUlihYZTOPCi04GH3wFsnwGOW6iAs5n3GeJJ+KLoE+9VDClQ8R6vOQHYegDYwuY3S6H/iJ8jb11ck0q9Qhoc9QMWgPBZJwFbpoFN88DGRWBiqQIgWyJY3lPozaGJ1KTEPh36zpTkJrcXPRE44S7g+Cng2DlgyyKwaclfFoIwvCwx9Zn3Q1DmIPx/2/sSaMuusszvjfXq1ZRUElJkKsBEGQyYhJCBSkUqAW1tsBdpuxEVaBzowXZqe1g90G2LotjQdmMjKqtBxQERdAWUAkUlZNBGkQRNyIAEMAkxpFKpqjfUG3t9//m/c/+737njPq9uVeqcte66b7jnnn32/s6///3v//++Tz0dmD0KzC4DM6vAFpd/0L3Gh6yTDgnvLwKzAWDGiH/ThcC2OWDrErB1pRgQisIQhAa+AED+HEEY6uNLyrRnZLSl6tSbrgLOeBQ44yiw8ziwfaV4UGbdegmA5QMTLFlqsfn7XecDW+eAmePAltXiXnkuZSBkRcm4UGXtU2uo3xsAZgz6y54JzMwDWzkgBOAqMMVBCSAUObh8QuN/CiTgcWAuyWhL1amvvBbY+VgxbW477paa7gIBqCnUrbUBiQuhAKDUot13IbBlDtiyBEyvtO5VDxvvVfxW/JkWNFrCeK8NAGsY7BsvKQC4hQCkJNaKy2LRIsg6SJ3IQSe1onKKC2CsOYMeN+0Dtj0ObDsGbFsEZmWp5S74g2Ir2uA22BScAJGA+dJFwPQ8ML0ETAUAkgDTPq9zdK/+sMWpPF19NxYwA4g3PtsHxAE4SQC6FdSgmGWRRIJLZJll8EGKjHiX1jwaN10HzD4BbD0GzC4WrsKMW2pNobZoCu6CLCDfCTqzgg6sr+wFphaAKQfgZHKvpRSYg7HN5XCL2AbAZwPrZGaj6ippXhgn0kqmU1woxnHedg5AATuWHig2FE1uVRwoxoX+Wcbg89S3AqCKPONcCi8oPtVP+9++G3j+oSK2xRBFDElUxbTS+3nvc4FpDsjxllXQoJg8FgdCQoGJJTTicLcQ6vPL6wbg9cDM4cJv27oAzFA5ky9/UOSvmg8oP86n0dICBn25JwjARWDSAUgBHN6vfdbv10AbARh8X91vDM2ss+NvAECKPVLCsHoyUgRqrlbnRwB933OBc+4DXrIC0IEmiLnE75di8HsyAcjzWUVGUi6uICMpVwwJVMXdeOk3XAxc+Hng+vV2esAYw+sWoP31r3eLcLwQBeQUrEHh4Jo2h4vDmJPuAyMLGAeEn7uqbgB+I7DlSWBGCwe31Gb9aL20kGDb/EGRxY6WTz8f2wtM8l4pgL1SgM8esHCvsuylME4nn9cfQLtldg6TZ0kUKorAfij23vAPCmqp3fcCl60XFINid1PlZrf41/dnApB6wSQjutUfIDJR8CGIQOwWEH7DywpKrWc8CFzqRLHkVYrB2jS2FQH5vkuBycXCAlIUUAAkCM2iRBA6+ARCe7DjYmQduLYTleiQ/XTTS4DpI+6nLhZW2nzVCEBaMLd+soIGqjD1ampdugiYWCpeBKA9bBJC9ActAk8LES26SqsftInLZ44dQif4Igdhym5WLrPDyuYH/7HTCNwDnPko8LXrBccjQaioe6BiKad3+QY/MGTH6rS3OBvCnQDuAIyqhiDkQ9RX+29yE3on8IwjxQPI8zkTiApGU3oVkD/4fGDieAuAdMw5MFQjEgg1DYsUku+a3uI0TGBfV7PotwHwaOEmbHEATvuDIutni6UAQoFRIFRYhfe/dhEw7tbe9Of0Si1g8HkrwRcevDajz07gIJ7n05rYyWIpb4ya/7vv8PRdFpj/LXDmkQLAnA4jCCOlTBRN/rFMAJKgkkVHpGUjySSBSFeg7/azqk8EgbSEq8UDRACLKDXSyaQ7Br//DcA4LSCtwnKhTEkQcmAIQhtM+Uaajl0uS9NatITXWzpzfcdNB4DpY+6nBgDaCtanYLN6fCj4u1ay0QIqtML/EYC61wSA9tAJeP6eWsAoDysFpg1eB0HIQRCIIkVeCqQf/05P3WCB+UPA+CPAzvmCaFWDKEuYcl1yMN+Y2dckqGTeHPEvvWDSNhOAfbefX0A6rS8CUw8X9066bFIfdqMHJID++DJgLACQumyc3gyAEYRRKFCLD1eu5ODLF6QvXedx0w3A1BwwxdAJLTXjd8seQnGrZ9bPFxLyA7WIKON63tYtCQBN/sv9QPm6BkLp0vl9t/m6ietR6fbyBA4gnXtORwRRpNnTtPpW6gWLH83lKqcOFTEnDiKtoHwy8RNFhrefyeztbnrBfbWfgttsP+kIyO32ELD1cHHvInrlvWs6TsnB7qAUlg/suFtAWkE55zYQ0QpqcALoNCXTEt7A3KoaDwGQfqoAOEUBa7fUbKctltwCajVbxvSiyvoasM0BaBKwwdKb9fN7NfcqBWGiSWykWXER0umeacUEonQgCKRfIgDFjya5yq8Wfsfs8dYgiuMxgpAg/vnMzu6mF0z6Zj5APdvPQec0TEosnvQosGOhaLuIYvnwEYSithE52F1XFAA0p5yigD4otCqygFKnpHUpLYP0OcKURYv6Mj4MNR433QhM0gL6QongawOg+6rl9CswKoSkEIxPyTsuAPigCYBmAXVfYcVf+n0SRYw6dP1YwNgHsgSajiJP429RrpWOM6cxDiJB6NINM4w7LbUGMQUwB/M9mZ3dSy+YVG0EoBiDBST5ddZ+PkCsAiIlQZDa3LVatJ0WXG2PbL98AB+4omB3oP/HgTUhmGgBfRqWf2TTrUSjExDSP/qWzQDgfAFAWyzR8rkFtDAKX75jo6nUguZxZ8NByHbvvqBQ36T1swcsBaBAGGRg40Ir+rt9WUDhQ5ZAU7Es2e9LLzglqHRxNkbeuW+oQRRls5jaMjnK0a9ecNf2R4LAwO829kQB3LTtEYQPUwzQAWgW0AGo8AQH0ljp/V17pm0KRcEifGuNOnocO1rACQbKPXhs8TtNwVr5uh+n6Zf3wDgu29g2FdMtOc8B6PdpFj08ZFrplw+ZA5FTvAQQ0/BT36FPDkRqBT9Jag7xYlQItY0f88j78sZzCcKPZlrAQfSCK9uvB4h577SCotUiEJ8opq8IQFl/PUBPEoBLxbRE62LSqG4dFB8r5bHcOtiOQSqT5T7RKzYDgJx+BUCCTxZQCwhaQc9oKcEnEBKknj5FsJ1LAPo9xoWWPWDy+6IIoqbeaO0VA+zHB0zxIQDKkn1GgtXiRxMIAx0Vn0Db+lkuFjLRCt5WEwD71Qvu2H5OfekD5FaciQay/GIbFgBXriwAyGmJADR1ck3DwTE3TQ4B0LetzBJErTYAr2BBSI3HTS8tLKBZPo/fWQDZp197Z3scjGb5BDp/L3+njMweB6B83Gj9wj3atOsPWin9WgXCFlVO/3ctf4iD8XkBkH5USlAZlNPZAQqARr5vxu1yjmH0givbX0UQKI63o0Wun/xHuR8E4VnPK5JQLd4VNttTBvK2uoiKOUf/f+GjwMNBh0NMV6J0c0NpcRv7mrYv3kh8/uHxYp+bVpwLp3R7sts2YzouSq3KGa+q7+x7Co4nazAerRKsVlV1QitF59dyyFZaYY0HMu9mWL3gtvZXMbymBIFMZ1ov2h0B+LTLisxgW+Eq5uU92iZ72ud9vvR+4JFp4NjkRh2ONi0OB1/UBCkvEYRhfuNs4OmhhiPKnFQlx6aAjMnSXJUAACAASURBVPjmz1w41nnwO4cCIBvBwZgTAOUHRq3gyDExD4zRGVYEnpm5LqmQc0M5esFt7acFl0SlHiBxuTkYxxdaihUC4QVXFu5FCUD5QtJl85sjGA0ziQxqeu/fem+hw0F2fLLQGxFlYMRvo7v1WmIVtpt1DFkXvOR7LwJ2HSkyoZmEypoVVe8p7b6qEMnidGG/Vl/L2aPOIwuA1pAIQE3DAmFa4j9f7CPaFpCHKujr5xzZesGdHqAqKz5X+FLRAl58le+jui+kTBALMcgZ73CDBkpN2/7+bfcWOhwUyCEAjQTcAVhKdjkPc2RajewKyu/n1//qJcA2uhBMRGXQOcn9U6JIOjXHQqSYOsVoQp1HNgAvz8yny80H5PVz9H6RqVd849WtXQ/zA0Ow2ayGLJ474L0G79vvbulwkJi8BGCg4S01SKqofoNvSIC+5zkhFUupV8rUTpJN06KpaBkFQm5M1HlkA3AyM5/u9Zl38zrk6f0iU6/4hmscgK5ISUtCTowyDqb7UxwsqFJW3fo/vbuIBJEZ1YRgyHwQKNi0KEl1OKTCZJdxtPDn//v8ooaDaVgqFyiTD2IKfcjZS4Fo+7g+HXOPv84jG4DIzKfLzQf8KVfI/FNKrQ6h94tfz+vOA9cGAAbrpylY2SDlVTTt+uCnV3/V3a7DQQAysJAwobZJgUXi78Qayhd812WeiOAZzEyUiAkHMeu5BF5FwZQAWLPwknkLQy9CrPMy8+lIHZFzvN3T+YbV+8X7c64OHHix74V6zIxB+RJ0wQ+UU992tYoFy3fcXcTDxQkoPsCUhFIczKVCegSg5B8A/PILN9ZwxBSxtiKiUAOi7JW0dLTustF8AGbm0/1o3vjjnSGdj+lYlGwdRO8XN+c1wABIoHk6k61yuSCJITq3jDY9Vx0BqK++uwAfX6JkI/hME0SC1EGguiQ+isqcQRLrF6/0jO2w+6FMnZhyZYsQ1W50qOHgPX1NXndtODsfgMwHzMin+0+ZN0S9YOllMzWfLwKQSS396P3iY3kNOLDPM1y065H4gOW3p4uTDkB8zWdb7FgbdDhEgJkCUDRvogTmd/vPv3BVAUBuvylNzAAYi4hisVQnEHoIqWblrxqm4Mx8ujfljT+YjsWBYgIOc0oJPsq1slCpH71fKybJOEoAuuVTRSCnYlmU6P/Z4iSJEcbLv+Yu9/1EAh7JKEXDKxq4ChUiKymRbwjgHdcUWTARgLYXHSr2LOU+BV7MVwzxwOfkOWybYAGZD5iRT0edjpxD6VhcOQ6j94tP51wdOHBdMeXa9OqWRcmWXA1XLUIUH6zyCwlAs3z+YBkfs1u+VIejJEF3ckrjI9T0y/aMA2+/tgAg08VURKT8vbKMUgAMIGzzAcOi5HknHQAz8+l+MW/829KxhtH7tTz+jIMAJPCYMULAWd6fvi+EY9ouoZBM/Kx/4LUBgFLgNC5o16FrE8JJVJgkiFhaQQBv3+dVbMrWVsC8UxFRkjjaVsW2DtRdOJ/vAyohVYK7A+bTvTdj8HlqTMcaRu/XxHkzjgNkIOWuDr8jnYYDKDutgpUhra0uAlAyCCUAK8BXcjBXgLCk/h0D/hcByDxFAdAzoFUqUBYRJTUcMWdPP7ONL6i5bLQeALJRQ+bT/W7G4AuAOXq/lsGdcRgAY+glLkYclJVTsa6ptCX3uQjAKINQstFrAZKIwWxQIhIJuovB/Nx+r2LzFCwlj8Y0evl/MYk0kieVtcvrwGUnHQCVjjVkPl3mItQsIPuElx9G79dOzDgMgGkAWlNyBJn8xKprBRC+zgEo4LWRgcdVcOCjjlNvmx84DrzNAahaFZWLygKWxUNibIhTcPD9BMLLa65bzreAMSGVoXvJ/Cgh1WUfO+XTZS5CDYDs9GH1fnOrIDcAkABTTDCCLYK0Cwi/586WcKJUiEpC8CCBYDsiiSplqUIUmOjf+o2tIiKVUJbgU5uSWl4DWwX4+PcXnrQATBNS+8yny1yEopdcay+930y5YhgAg+9n2OoUeI5TdQer+32fdhmGoOBZanBo+g1yEKU4dYgFSvqB//vZBIBt9RshkTbW8ZZZ2hUgvDL3iU3uux4LSBM0ZD7dPRnTH08VAIfV+2XAOucQAMuVcKfFSD/+IAABsEoGwYAoHZIKEEYxRIHwLS8pUuhjFVs6/ZZhIVWyxVKBBIRXnbQATBNS+8ynI4tBzkEACv+chlUVIKE/5cRGsWmlKfIzudc3APLQSlg3E2OCyVRc1kpU3DgBmKoQsWtlBcswjPu+nfTYtBL+GQdgOf16GCZW6pXlBCqWSgqJypoOAFfXXDifbwFJLvi5HAjlnUsiIe6AjOp4iQNQHRlT2PlgJCUbbc2s+v/hFwFb/q7gm6HlYpBbmTV2sscQyy/qFBj2v0/cAdz/HGD7NDA1AUyOOU+1CwWOewNjKj6/O03F1/WuugW4/XJgfBoYmwDGdH7IxB5kLPIB+I8AfNwZgga5ck2fJbEm8V9zNWPfrasbgMuPAcuseJ8Exsb9FdBhA+7gaQNKB6TfcgCYug+YJT+g89aoBDMmIMScP12uTKj13uDv8zsKig/uJ1uQOsnojm3qB5P5ACRBH3OhPuzzRN9DV88HqQLEWPJnvTy5nm/t/1s4BcuSpRZtGAu4fi+wtBVYEyccrYwn6hF8/FkJp9bKxAKVFsn/d8urgbHPA9NPOEOWl4+2cfoFHhfVrJTZPKHSj5daOtup6JyCpPx8rHWRVQ7WOlrYCMx8AHIzlxkALPD9c0VB+x/A3E/+E2fUYHXdF7KTGwdvTd0AHP9r4PgWYG0KWBdfsBdsMPfPrKKsoL9XAVLAvO2fFylCE4cKliyrDVZNcGS1CqEYhWFiAZV+XntaURdTLmpCEbpchTYLqi6NrkMCzLzt5Xc4HwyJmmkJ+Z73jQOh4NWeDUZiK1K08f0EXt7CMHVawIk7gaVpYJUA9LI1Ao8bzKX1cytoFtFfpdCIWz7rgzHgth8u0oPGDwETc8CEMySUzFaikgtlpW1Ta8JqNba7lVljSRgW+Q6ZP/57WQvj6fydBjXfAjKbgEvMLwWCvhNoipgNpnQshlS4IGFWzIk6ylWwAz93ETLxGWB5ClidLABoIOS7pmGfG+33YAG5mND0G8F4678vkiPJczNOAC4UyQm2N8w94kirFlfIAl7i402d6dbPWWAtrsjOFiuCvAJZOQE0pHTFsckHYDeCvhNgipQNxoAz8/8IPr5nbvH2jd+6AThJAE4AqwTdZKEBLDoDgU4+YVkPHIBoPwareOt/BkDexsMFAFnbzNJYm0IDnVwbt4uyur1kwL7Tp+iZM/08WT9Rc7DHUmuYTr/x+6o4ovvu9fjBbgR9JyA+omwwxvZI5ULg6ZW7y9FPf9QNwKm/CgCcKABovh8ByVy/UCtJq2f+X1yYJPGU27lIZLbuEWDsWBHesZeDz4iURLUWa1TE47LqK12fZmd3OXidFctqm92KatVs1jAEsNv6sdymaa2g8+xUL4I+Pn2beCgbLGWHI/h8G3oTr45iK86POlbBU9yKI/AcfLR+ouQwH9BfmmbLlTHboOnZ/T9+5vaf8FUaAThXsFOQ45mUcgZCWTAxe0UQ+urYMO1/37GtxQmoLCBtRSp30LrDp2SFdzYMgk/R+VNwvwR9mwQDsaspGSfJgYDYNTbp8psCQFJxEIBkQjDrxt8dXCUIY+COH5MVFPi8SOn2n/QYLZ9Gp0cxANIP5IvAkzVzxivRydnKNzBa8fddM84b6AFyAriMF2pajk9kYIeoClXmA3AQgr5NQEHMBqMVFMNaIOayNRL/vhlH3RZwmhbQQUcAasrVVGz4EtjCu/3dfb/ID3PbT7uKAZ/MhcIC0vqRTo4W0IBIEAmEtFwCYqjW03bcmdwBYeoWgetUbrR8snrloiR2drpACf+rD4D9EvTVjIJu7HBV+781X752Czj9lwUZkTEgcPoNPp5Nv4oBRhCG6dd+1DkMz1JIhR1BAHJ7zwqO3fIRRM5tmDK5CoQKsSgOeBYBKFZULTqcB9r6Ni5KYmd3WKDUA0BlhNLM8EbT1QBXBU72aI5ZjUcVOxz7WLkQ8d37vsart/uA6RcPsxNSAtAXHDYNC1AEpf9s01kKwuBwGU7HgVt/1jtD1e60fgQigSe/j5bQp+KYpGB+H62jT7P8/ZypBIC8Dhcx8eY9wF015abhmnoAyJ5WSrKeNgKO9SHxnT/LSasJBim5lRjWBEIVeROInKL1qunybRawLgASdEy74qjaNNzJCgqEEYzBGvK0297mAFSHEIB6ebKDgc8J1ksmV8t29f1en6L5v6cxIK5iK6Xne/5jCTiFcTqVn/r/tWDPWwXnEPTVgIKUHU7ljASawKefIwDpMdRxRB+wFgD+RREDJABpwSzz2c0LfxczVjkVKwaYgtBBezu3SvX08d39P5uO3QKahXMQciourZRAGKZWar/YZ1xXRPe8wQr2AUK7TvbOVTZBXx4MBECRnConUBSFEXT6mf/TK+/qmzAF/0UBOPqBZYF52HrTFCw2LH5G8UCzJEko5nZqmRnPh/uCXmpnVpDTsIPPwKApOaSA2QLDLSHf97iPx0tpISLfz7bl4iFfsUsnj+HZWEeOYDCDnDmCvZkEgedcCjxGseIhBYt3vx049HwMLRh8gA9gh2MoH9ABqKJzxf0McO7XlSAU4HzhYYFq+5D7hwBu/98OQLlIBCKnW39SlXNY+nqeiq2dkQg+gnGPb9/ZpT0lq6MV5D96gLCwgDmCwbdnCvZmCgY/dxy47xxg5SWuUjigYPHFbwA+fyGwfr2rXrMvPB+vp3L3GHCgi9JOHQCkRVPppeUBigXLFymyejYTB4YsgfA20ofRAlYB0FfAlvQqP0/TsX5PLOB5DNu471cmIwiBaRww/F01J+mz2pqChxUMZvpJlmBv3iTocsW4dzewfhkGFix+2febXDAeJO/YEILBB7pU1g8LQFo98QASVGYNQ6DZfEG3fnEqrgLhbf/HV15anbkFNCvohWSl9XPQ2XTM/2s3I4DwPIZwBEDfgitH0Ek6N6x+u/iD7T4g/YdBBYPpWHEaHlqwNw+AQa4Yj54JrJO+aQDB4pt+oCAyYvOPEIQDCgYfeF/9U3AbAMX7ItAlVtAspKZdz5SOlvA2pstxjES3wJ+92NgAGK2gwi78QoVfEhBeQACqNNP1RdoA18kKdgDhxkUI/zKIYDCnqyzB3jwAJnLFOEIW7QEEi1/1Y21ywVglCAcQDD5/Efj7M4CVrZ5AKlkhxeQUaxBI4nvFzxf8IfCVC4HV7cC6ZEX5nen3VX1vAGLZq8ysrvHY+QBwbGfI2E6JpLvdX+ksthpUvQrmX/sVDGZVUJZgb17vJHLFeGQcmCdVb5+Cxd/5xjZ6QzzMLOQBBIOfTV2Ps4HFHQ7CLQUQmUrV0rgKJMsCjsxGAqTn/hzw0EXA4tnAyg5gbTYBorKkUyLnkB9YVhTxu+kT13iccwtwdBewPAus+b2ar9xJAafqfgMQO4dh+J9+BHe5gqZZZzYok1JJUcpaR6bp93P+W/N6p0KuGIemgEWKgPQhWPxdP7NBLhiHKYHUp2DwpZ8rLOD8tmJQVplOLxAqmbRKC6EDYC7/CeCRPcCx3cDSrsISrs04CPm9ArZk55UvKAspYLqPaPdR4/H0g8DRHcDyVr/X6VabLHk2PhjpPVZY7d5xwF6CwS9y/4LbbVyQsEKIufGiKe0p2JvXOx3kinF0GjhOQY+oNRtljji9TQPf/fOV9IZY4Gq4D8Hgy/4W+Oo2YG5bUUy04vUcLCqSJVRWszJbNgxSmMau+q/Ao2cBR88EjtOqbgNWWaTkIFz3YiWrF4nAjtN0nBZrJnU+/8PA3CxwfMYB6LUra3oglL0tps6wlVha5rLiqd9AdDfB4Je6U0s/0BXTDYh80Sr2FOzNA2AXuWIszABL1JaKWq1R+nwGeM17OsoFY5XTVw/B4Cv+Djg0C8xvLYqJCECzgsxmZlq9T8e0XGUyaUizavPtxoFr/zvw2BnA0Z3A8e2FVV3x6c4sqwObckeyhiXAowUSADhD1XhceDMwx37lvU4XxVN2n3rJIocygkr/Vbs7fe+EdBLcfaXXQ3IPWIrpBB6XlnwpR76jYG9e7/SQKzarxM7qJFj8mg8UarMV9IZ4gvNDD8HgKx8HDs8A8zMFAFnPYQPDl0Co2g4fpDZLqKCxT0/7fhJ4fCdwbFvhRiwRgJruCOwUgCpeCvUjZmEFxhfk9W969kW/B8xvKQqnVgg+B6CB0MsI7P70AHgmd2n1NQ0rv7FvALIlVYK73MnQCDLThSGZoDpuP7uCeuX5n8zroB5yxThGnQ0CgyBMxY63Aq/5aBHG6EBviDlOLV0Eg1+0AByZLgbl+HRxnZXJoqqttA4ODovlJZVuSjTQFtq+NwNPbHMAzramdVpVs6wEoPtdNg37wJfvsYiJP9NFqvHY+7vAwjSwxAeNxVO8T6aNVRRRlT6hHrJ0Ovaw0WDJCKng7g86APvNB9wg2JvXO33IFWOBgn8EIf2nRLD4tbe1+AU7yAWbZeskGHwVdd2mgAUCcNKnJgLQrZ/V9/Jnn5JUYmnAE3hCmv3+t8AWQfSzyPK/POOgJgDdsgqA5nfJAvLdLV+bz0kK4RqPZ3wQWJxyAPqDVhZQyQr7gyaXI9axWCFVAGLvRUhV46PgLnUWBs0HbBPszeudPuWKsTRZAJDTo8l8ui/42juL5veQC7ZpsEow+OrZQlqVVuH4FLA8WVyDAOTAmHUQCAWQkOlsQAwDt/9/AE8SgPQpNa07+AhAA6HLXbb5Xr4IaAMfv/eGvP5NzyYA7UGjBWTWjh40v9fSyscHLtaxhJWxFVsNNAXH1khw983+DYPmA5aCvXkdNIBccemfceooAfhAAcA+6A2xLuAGucxrzgKOMexDfV9OwbS2BB/BEoqLSrBoYGgJ3E8qLcIEsP/ngCPuUy7S13L3wb6PU56/m/Xj4Ps0TKCXQA6AXuNeZY3HMz5QANAeND1kwcKXlj6wOZQ+b7R+Pi0PD0DeFAfk590CKg8qncfoFzIRVWVqfFfBhgn25vXOAHLFWCDbvPstBsJZ4LUPt+jdesgFg+qVptWq11bg2gtgfuLiRAAgQeg+oEmsOujsXb5SsAoCIN/3vx04OlNM6Yv0tdx1MKvK7/TFjVmeCD4HQQQhf159eV7/pmc/kwCcKABoeYvR0oept7SEoZQ0Tr1lPuPQFlAtO0nyAcWhpzw/FSjFzGjLx+RGvxzoSeC1hwsA9klvaFN5FAy+9mJgnhaQ0qqagglADo4c9AhCDpJPl5ZommQ8738HcGw6AJBW1VecZv0cePwOY0/wl1lAD/WUCx0mMlDLr8bjmb+Dwp3x4nkDYbD0thIO5aNtfmDi/xGEeRawxhs7Vb/q2huABQJwAlhyy2cC0xoggjAAUCWWAkksOiIY978TmOOqeqqwqAx3WGhHK06n7TDwOcAV/iipPAKjwgrZm2o8nkUA0gKmAHTrp+o9MTrEYvq44o9pZIOtgmu8mafCV72YAKT/RwAy5OPOuVlAAk9Oule6xQRTWUKlWtkU/IvAHAHti5oIwDK841ZPFtCmdr0U8PaC9hVultd4CIC8P2Ztt/m5/qC11TJXlJDGGpfGAmYODgFoCxACkLpuWh3KCgqE8gNVZK4KtxgjJAB/2X1Krao1rfN7CWZf3LSBT4uAEIyWBVpipL7GgwA0AW25GbGENBTRx3rm1M2w39mmrFVwjTd1Kn+VAZALEE5LtIDyMWUBvbLNLGHgd5H/V07BDp7r3uU+Jadgn3ptxekA5MBri0/Wp4wzBjDbCnkMWMqVpE8GJwLQqvfc0pqbkVj5aNk7gbCxgJno30cAjntowtXNaZ1suvSKNhsYTcVKmw9F5xGE+94dfEoP+JYhD/8OC8eIPUsUHokVVKB78XszbzAF4Pvd//PCKVGIpOAr78mn4DZOm8YC1jco+w6EFTDDPJqeCEBZBa5GffVbhmQ8DtZW5TYOvPhXip0GTuu22lTMLSw+aAVl9QhEWjurI/aQiLJkTMLsX9R3r/ymZ73fp1+37OU9hunXSkdl7T3QrhKCtlCM59k2i5CMMSIAGdqxEIwrmptzTsCEut5yilKoJLAcxCq3fe8tLCDBFwO+tKjyuxSCMdYEXoeDrHcHvu0tTwLzmwHA4N/Gh6zNCqqeOSxC2lb8tQSiMwbuqXIqAcjFh2JjBKGJyShQG6ygVbfJegULWBYcMR3rvb6oCRaQwFPgl1M5rR7/JtBZOIZWx/0+s4QeY5z/1/X2tFnAxPpFELaVkdLN8MWGVr4pCBsfMHN8bmTKfCjZ0Ncp456/x58zLzfw6Qf3ABd8pUgEYmqk5bGyek06IQl1bkXScnlN/u8L24Gdx1qVq91KQvrpgwaAAw9p+wnXPw1YjyWMGtDo2ASOFGMU7SIEUzdYD34vMPmXwLbHgdkFYAtlGiim6DpxJtvq9LtlVr/aWKEB8pUXAOOPAFPzwBTZ9r04vdQ9Ts4pAZ3cd+yHxgfMAOH+vcA69/9Uxijmz/AerYpdar1lNSMYzV+vWY/34I8DY58Gph8Bpo8A04vAFEFIknIHohGVR62QhFRSYjQE6qFri2z3iaPAhHNNlxKwArI0Q1IAxwfReacbC5gBPp66/5ICgLKCtqnsrKKlrFZUFPKOr7osMTtdsxzqQRZ93Q1MPARMPllohUxRqkEK6gShOP0S+dY2hlRv99y+ovRi7IiTnTvLqmg6xDPYpqAUgRgsoR7MxgJmgHD/c4E1FXu7FRRbvEgd7evXWlbPpp9EgUjiJpwe6zwOMlvpAWCMVusJYPIYMOlSDZRpoGiNxKzbdIQlXONMWJbGtw4svdgz3El47nzTRvPrrKptAJT6ZrzfintvAJgx4vsvdQvIXK5VYF3sUZxmJUvgA1FOvwF8spKyBtM1y6EepI4LqVMedbEaTp0EIKdPKh5FqYYqSxgo2jgFr13j6XXHnOiSZOeBVSvyC8qC2r05FVvVw9cAMAOA178AWPMp2LJaaekiCPXExwHw660n1oB/niGQazwOkkSepbJ/72I1x4CJ+cJ6lYI1riccrVicUuVSmIW82pkwnHHVOKbFsOozQGkFkwewnBES37ABYMaAX39ZAUCCb82nIlo+40p2gNnvsoKunxH1xGwA/LOzdQOQJPIuHzV2GBg7Cow7AI0l33XfjOsv6oVodes6ISbBsAZMX+kJxU56KY7pkmFVhOciuvTzSt05v0+ryuT/9gDrZNe4wPMsI7VJP3GcP7gUOOdvgL1rRYJ0ZI5IV3hV4/wrGYPPU3/AiRhYusy2K7mU999P+z90ObD7LuBZK0Xdkeq9NSX2+o4HLwfWlopFCC0fgciBMtAFC8CGrYXVoVjnU2G7rTXrzh4kfRzLY1kyGwBoeiGcPiXb5eAzdXWnazPCSScb4j3xfmav8Cx2p50lAMW0VXINitCogl2r9H2dcctWwQxQsn6ZTBbMNtcgdKIbiZj51VcBk38CXPxoQcfCUg8pjcYgZScw/momACnXyr4leBhs5QaBTHpf7X8dMPYJYO8XgAv9e8QJlAZZq8D4xSuANYKPJQn0AR2AHKy1MACKe9nfFI6IEqduEWoHIJ9wlsVKLekoMCa9EAegSTYQeM4TXco2SEMkAHEbBZoj4bbYtdyCVrFqGXgTSxgXYTZeHLi9AMjEQRCVUXP/n4KUaaT8vVTi+Rtg7GPAuYcAWlMCgUVkQfJ2Q12yBvPXMwHImhDWwf81imsTiLSEvHZkr+jY/p9CQRD4p8DOBwteItai05qn31FFdfLlFxYWgCDUIkRkj/TxbCEi/89jfPZ3X2VqYSJQbmUNQY3HQT7hbv2sLoerVwKQHNEEoCsm8R4MhPRjXUGzVEIKIoY7yaEYuY4dgGb5RXruoSgtSCLLarkICQ9f6QNykGjFdjsIBaI4kGlt8W+Rg5g0HJ8qAp47nihAzFpuWtPIMBZJlASILvR6fQ0DCVbJCkJOJCqnk4pGpb99tZ8MopyiKDX7WWDiwYKXiEQOehCrgKh+eJQ+EQHo1Lby/zRlyf8TIbf9XS5ftIb8I92YugH4ay2pLusorl7dAoonWtMwQSTdOFuQSLTGHyIC8kxSIQuA4hwU2WUAoO4/grBcDbsfWElSzg+JCoYDoEGM1ixSkHzgF/wG7y8sIa3J7JPAGWuFJSQIaU01iJHUiYP4e33BrPOHmG/JMaOfTZVYRhwGav87vWKPJ9/rSH4IOGO5sITqg/ggxXs4TOaBAECbeoOsgfl+DrQShFqcEIhyyt0MbMusEkx76iAZXKM8BvXiZAGlF+KaIbaadYpem4aDgpJZQz6YJABV5VcHAJZ0v4FxX6KG5UpYs0KnqjhRuagEVgPglYAl9ciHf8mdUrJh0Qx9vkDBzBywfbkYQIGwahA/kglATsHsDzKA0BATiPyZ4NEDwIeoa/uFYKKXL2f24nQoIgd9R3yQCMTFqwIAfdBWI7+yB5ZLECYLETd85YJl+2YAUNosLIel/xYlu4Jsl6bhNhD6it4WJCvA2Zc4Gxo73RcgJeOqFmGR6rcChLYACyGojmEYdj59KnZ+tIQRhH9IvWA2hiREjDeRI9Cly7fMF3EtWRFawhQIf5IJwE56wdTIYdt7tp9ys1K8JnoJvod9Wn682PNkP4hUy1ndWgstAtBDMLYN5/6PAc5DGNoF4SrZfN+4+IhT8jqwg2Cp8ThIJ5vfSWBXAVCrWN9SMxDK+skaOvhoAc8me654pmUB3f0wyt+E8FyRAGmPlOEoiSD2qgvmAKoOm52fAuiTDHSyIRxx+lI0QxxADubfF5vffMmSajrWlP7nmZ3dSy+4r/ZzAUEHnQ8R70HsXlK+PgJsW68G4XYGZj0EY2EYATCAT6tAhmE0DXcC4faapcwMgAIfLb0kuzT9Qmw5uwAAIABJREFUSi+EfeALkSrpBovbrQDnkm8wAo8/E3i+CCsZ98NCpAp8cUekZyBavI4ET/TnaAk/RQCyAXy6uNSPA0i+wMeB6ePA5HFgZq2wpNGK3FUDAHmv3fSCe7afX8CB4UNEEOolVi/3obastNwJ9cO5BOBKEQMsAcifHWzRAigWWAlCn5K2bQYAOe1KMjTIR2kRUhKVS7IrLia0v+3xwHMZMCbYNP0KfG79zAqK5DxOvyEuWu6VD5KSHy2YAEQAfpaRdl5UkuUctIpBnCIIl4psD03FtIIP1ADAlBuJM47EqqUX3LX9kSBQcuuyftK78xUkHyQ+RLqHZ3Fv1KcgLj5kAQ1s0Qo6IA1nHhNLQzA8ZxvBXuNx8DcS5UYpNnoYxsCnUIqvZo0F3wPTMa7Hv53HOJVbS/l+5bumX7d+5WLE44hxIRJB2NMCqj9ixwuE90svWCaIA6bAp959EKeWChAyA0PTOV2unGMQveCO7bfqHbcS4rJR7Ewqnw5AWhLuImg2uFQAXAVs8RGmntW4+g2hB3P79L/EJ9zGvqrxOPibiVihAOgrWQOf/EBfBcsPNBBqW9Hv6zzGqFzmoXz3B9AePgXiq6bgiv4YOB9QHS8AfpkAFMMjrWAcQA0iO9XJiQyAnos2vV7ESHOOQfWCO7Zf7F40mZFQScRKAYBaSU6vAVcTgN7xXHiUFpDTMK2dFh56912BTiDcvpkATIXzCL4g3WXTZ4jpGfjoF/oihL+fx+0yWUABLwIwtYKKIabgCzHQvi2ggBKn0McEQDaKT5cGkIOo6SuyYzEfjQB0EM5nZgAPoxe8of3sgSqCQM3jkdFLvpRvR13+7UVRuhUFSavNO6otwp88ZZ3+t4M6HLtch6OT9AG/q9cmtf//gV1JDYcnQ2zY6/YakfSrU+Pg1M45NqPt3IEtoM7WFHokyrWKkooglCMWLYjiUXMtK3g8Uzd1WL3gDe3vRRCoUEYCwGtYFxxqgA2E/jI20F5hhmQod98BHNnlxOTig1aGiDanO21yV4DygWuB8YeB6fnC9WEtiKVVKeE0ZGiXWczeJoWMIig5a9V5DA1ANoKDeDylZ9NSXxyAsiKawrQqmCv2HVf5e8aRoxfc1n7xs+khItAUvojvyWryxVcWJZksVSyZoQRA3dcAoHzax4Gj2wtu6FVKM7gMgti02jbV476oUJJs1j/AbA1mQ3Pm8eTRsoZDtR+xZKCiEKmMXTIeXHPGdhYArX8FwG4DGMEnAHIK4yvT58nWC2b73cexaZgWWaEKgU1gjNbPP7PvOYGsUSBkv3hBtmRWNzxjTk9RWktvxp6POj0vARjY9sWkFel8RWxegjIF4RjwAOnZWMPBTGjqvHmszxJOBUD3xyznL2bqROvoP3N3q84jG4C7M/PpcvMBef0cvV9k6hXv+2Yno5QfGArRbaCC0mWv2YtF3ecerNDhkNZIIsXQRv5dlTtGADJSz2gEE1EJQM//026HdIEZLC8B6A0tk0g1Ja8DuzJdphS82QBEZj5dbj7gxZN5er/IZI+67pscgE7QaDOUMyC0Wb8+gXjuR4F5J6YsaXnFhBoAGEVvUhb60jISgCQnoh/OLBgvIrL8v7DdFkEYM5dtNg97tvz5zJqzdfIBmJlPl5sP+DJP5xtW7xffnzeh7H+Z+3+RpkyWT1YxuURJYVtx6T0fCTocouQV85VkHRIGegEuEv/YKpkA/JceVmL8kv6t5/9pu62tfiPWcFQVEa0DZ9WcLJEPwMx8uvfnjT9IgZyj94t/ldeA/S9tMaGa9SNdmsIxbvVscVJ1GScoMt4UPwhAsmMZ0aXzQBsvdGRBjQz0FUpEJRAJQOq4KAnBdz+sfiPJ3bOYn8fsykyVWMfiN3BOzckS+QDMzKe7OW/88aqQzsfE5kH1fvGjeQ0wADodmVGwOeiMsUqHrGOnS4UFy9P/wAEojkEnI+IqOIJQNLgpCXhcmLAtD/D+kgQE235L93tj+YBqgTX9BiCeW/NedT4AmQ+YkU/3sbzxBymQuZhm8g1T+QbV+wWFdjKO/Te2mEFNlCb6gPF708VJ1TXHgKd91GnZpDfi1k/gM2vqU3DUnCuBmNQe3P9vw6pe229KOvB0K1k+ZS+rnrfM2AlA3JMZtah/EZKZT3drxuDz1O/yxAwu9JgJxr3lQfR+8aa8Buy/wdWQZAVl+ZzCrG3q9c/YrkmHy3IRYryAAqAkEBIlopJxNNUbER+fA/H+/+AAdP9PmS9dazicJybm7mlB8nR2dI1HvgVkOlZGPt2nM29GCamcGZjAwlQ+vvrV+8X/zGsAAUiLVPp/wd+zaTMFWw+/kAA0GQQnpCw5mDsAMIrcRB5mC/+MAffTwgfwKY2KfmCZ6ZIkUShrxXxBX4yYaV8Hzmcn13jUA8CMfDqWYeQcSkhVOl8U6uxH7xekrsg49h8oiCENgC5TUG5vKxxT8f2aRtOtcAKQ1s8soPuOVUIwpchNlEEIOyNSIrrvv3hwnckWIZPZsnbcDyzTpvg3lU8mpZQqozyfK74aj3wAKh1LgrsD5tMxiz/nkGD1sHq/YNFOxkEAcuW7oqmXlisuQOT7VV2jwi/kTgj1RkoZhBje8Z83SCAEEJZW0C3gff8tADCt4VASaWIBK0HI9q8BF5yUAMzIp8tNx5Jg9bB6v/jdDPSRns0BWIZeUitIo9IhHmhXTvzCPQddccnZ76U1V/IvC4SBCFyg26DFNg7c++Mhhb6qiCikT7WVUmr6lYn2nRKyrdZ51GMBlZIc07GUBdMjny6XCiUmpA6j94vMZbgBMFo552pu27PXAqXTyAUQcitOQjAm9xX0N9pIwIPmSCmH5QuPqER0L4kDYgp9zOUL6fYxkbZcFceyAreAF3GlV+NRDwAz8uksnT3jiILVSmpWNlhMze+k94vMZfgGAPJeHDjpCrgM01Tdry9OzvmYAzAqLVWIwEShwzbRwwSEn+MqP6bQK5tZlWyhjCCCsC19Xv7gOnBRbgp7cu/5AOyVjqVMmA75dJZ9nHF0yohWNlhMxKnS+0XmMtwAmFq4imnYbrEqNJPc+9kfd62RKh0On8qV9hXZ9askEPgAfI56ziocUgVbzGT28lEtRMoKtg7lBHtznfZNA+CQ+XQWM8k4uglWK/NLYKzS+8U9GReXD0g/Tyvh4Ne17Yb4Zbr6g6y7/aNWcoPpjKRTsJIags5IJwkEAv6en05S6GUBfRWsUExZyVZVQCQwrgN7Wfdd41GPBczIp8ODeXfTSbBa6YYxlY8/p3q/udc3C+jTbtvqt2oadnB2m4oNgMn0W0p+hYWHWbwg9yU/0Kb9EIy+5y2hiCit4UgKyTeAkN8Valk4Le/ldlONRz4AWWBRM6fdIPfHstw/G+SE5rMnVQ/kA5AkLHS0ak7V7reXfhgACaBqDtD3e/nmc5k9kA/A80JReq+U38zGVp3ObJo/BvAOD3dtwiWar9zEHsgHIGlFubqSx7+Jja36anLLcDvvgwA+NDpDfILv+qlzuXwAXuSjrkKemlO2e3U1uWUYnL8dwB/5e2apca9LNv+vsQfyAUheX4VguB+mzIsaG9ntqxhF4Xbe3QD+n7/uHLAW9wQ1tblMRQ/UA0CaHC7plXEh+q4T0OWcfhleYTSHBK0EH/mi+fcRuKQn4I6fWpeoB4AevCz3HOOm9yb3F5mBlZBNclYCj1aRfyfrbgPCTR6AzK+vD4CyglX7jpmN7HY66d1E0ctdIrEEE4wEIMlam+Pk7YF6AMj7EwAVbU82vTerCwhAXopJN9zVI+AYrOeULLZgErY2x8nZA/kAJGWr0naUWdFpy2cT+oCWjpdjLFxE5UzYIBBpEUX5nLnlvAktb76SPVAfAOUHpiAMm96bsVtCAMaKALICMyxDq6cXfycA+b/mOLl6oF4AiqBRIEzBp7/X2Af0+fi1XIioMIlAI+AIPIGPmeROWV3j1Zuvyu2B+gHoFfZiDS2lC0LiY52WUADkQoTTMH1BFSYRdHoRfKSu5v9qrizMHYPT+vx6ARhSuDcAzzmDo5ZGHT1PAKYMwQxME2jiSo/gEwBrrq+u41ZOy++oD4BaCcsXTPiSI3ey8s4KGoG8QwCMFM+0ggQhLR0BF19SXuD/ayakz7uR0/TsMcxg3SjfqWNA0hsrga/ojaq/8WPcC+YIk4Ke4CMSuB2XVht1Oj8zIfXlU8BtU8DhmYRXWdfrdF1fgr3+S8At48CD04DVjXQSDO70PTUnaJ5uOCwsIIFHSSFy1pKPWCDsZxCpw8UVgKSPxLXM937OzxxAljzcPAbcswU4Qh4V3UN8mKoeKm/bu78IfKJQa8VD48CylHQiL3O3/qg5Rf30BKACMtJXjXKQcfBSK8Dfqc3KVCwuN2VFGRnm/yKZtq4Re5ifyQQgM2A+BeB3GHaZBo5MAIue0l7Kt3cC4xhw+5eL7TuCkJk1jBtyerbUfYG5ExjZ/pqrxE5fAOrOq5SmowVIrRp1IyT2R6+fg0bgVYG4CsyZe2UsaiOGKXr4Sfp9k8CxCYAFSKyvXeY1o1BxQux91yMtfsHPutgnnyUuUvhc0ZsgUXib+nVkq6+ZKaABIHsgVZnuwD9sVo66rrR4ImdhLGSQ8zPL/JgBQxeU1ouWkO9PTgDzbgmXxrzMkatl3keivfG5x4r4IRcz5BfkO5vEZ0kgpIfBZ8yKjlL17syy0tMNcOn9dl4Fy6dLFabj1Mpvow9Ify+I4Nlo9Xt+ZqU9VdJpqZh4QDDyxUyYOYJwHDg+DhgI/WUVZl7aSEt93+GO9Ia2iuZKOfA7lhp9JpvAVy61w2mOwO5hmCgMHC1H9O24gu6UD9jP+ZmbtLRaSsei9SL4XDPbAEh/kGQ/pSUcc0lbApFWb67lQUhpVnLBsoKqqZclFMmUtrxPcwxl3X7vOCAtYLSCcugFQmqhdssH7HU+RznjiOlYXA8wqkOfkItTAom+oKygca4ES8jY+N3z7fSG4hfUtp3ihUHruVSsFy1iRvNP+1N7A5BdJACmVpAgZPhGOyCigEjlPLudn7kvFtOxuB4g6OjD8UWLRkCZFRwrLCEXJQQhp2K+37lQeBCRX1A7KPQto1prFEmSYn2mB9EAsO+kYfk8KQhZF8yjVz5gp/MztyOUjiW9bCUhEBhKRCCgSis45uQ/PhX/xfFWMgOnWu2gxB0TF/o0kEZ/kCDM1Ts+3RHYnwVUL6XhDFrAswfIB6w6P1MrTulY0sum1VICglKwCEACqvQFCUK3gHcsFQCM/ILayqP1k9JshVqrncMalOYYvgcGAyCvIwuod8YBJQmZpmGJeyRwkGw4n8jJOJQNw3idLFhMRNB0SgASTJyKoy/4ieXCeFfJBUeV2SoAclFyR0bbm1OHTUiN0/DTAwD7zQeM52dqj8VsGEkVE2jKetG7AEhQ0frJAv6RC0trC1skl+IWlNinGLbSaZg7Mc0xfA8MbgF1LQV1z08A2G8+oM7PVF9Ms2GUE0gQyp+Lwu2yagLgR9ZaYpkSypQ6a6Q2DCqzpkvietXIFdoZfuieGmcOD0DeP0HEbBhNwYPmA/L8zJQsATAKnguEqS+XTqkE4YfWWwCUFZTksYAYwZfIBeN9Tw0cjOwu8gDIZqsoSSvhEeQDiiGYFoyWiSDRypWgi69UP5sc5fIcquSCNeXqe2X9ZAHfM7Khe2pcOB+AT41+aO5iRD3QAHBEHd9ctuiBBoANEkbaAw0AR9r9zcUbADYYGGkPNAAcafc3F28A2GBgpD3QAHCk3d9cvAFgg4GR9kADwJF2f3PxBoANBkbaAw0AR9r9zcUbADYYGGkPNAAcafc3F28A2GBgpD3QAHCk3d9cfOxqYJ2au9RdPtdp/khoEOlglDYT39V1PzQFXLsMXAlgt9PCxJKPbufyf8/KHIPfBPAZABf79Xc5XQ0ZQ1Q7360NbxoHrlsDvs5ZRsgo0une06by6X1mZvtP99PNAp4F4LsBXA5gjw8EGTeqaGF4QhzQF80CX7cAvGIdeDYAfhdZ2sTKUcVrpE7nd31N5gj8e2dIo2osk7NZpMdK0Z19tv+bJ4F9K8D1ACj8yfNSikHeg+5Z969m57Y/8/ZP+dPLKZhP/rcA+AYAF7g1oRUhEMUzFMt6eSJfX78b2DkPfM0i8GIAX+uWlAMppreUUErn8p2gzTl+2flg/sDbTkvIOik+CP20//mzwAXzwDcCuNTPJeFXpEpM6QEjIHm/zTF8D7T5gATYNQCe69aAloRTGulfBESBSYNyxR5g/Bhw7hKwZwl4vk9LnM5JmsBzUyDGAX3B8G23Mz/g9BuUa/0IiutfMkj7zwKmngAuXSvOpUvAWYBtF4BTnspIj/O8zPaf7qdvWITw6eZA0JLQEhKEGgxZhUj/dz3NzSKwbR44exnYvVKcy+mM5Km0JhxInUtrGkmzCPicg3W5LMGkQiZZTm9xS9Z3+4m2o8C5c4X15pTKW2Lb+fCx7WLtjYxzqiql29Icw/dA5SqYf6RTTilg+lYCIXmICKQ4IK9wxfSJY8AZK8CuFWDnanEua9ZTAMsaCog3Dt92O/MvnRGBtGwkqKRmMEkqCaa+2k+0LQDTh4rP88UHj74kF1WaATo9QHQ7mmP4HugYhtEKj4PB6ZQ+FS0hQahpldPya1kXTOqNY8DscgG+HavAttUCvBxInitrkgL4lcO33c7spBdM3kAuSnq2nx9gQfAh4JyVwvrxwel2z3p4aMlzH6DM2z/lT+8aB+Q/OT4EEqckWQSBkGD6EQKQnDCLwBSnYgcf32fXioGUFawC4esyu7CXXnDP9tOCsyD4KLB1rmgvX7zfbu2WG/Jtme0/3U/vKxBNAMoi0KcjkATCN3HOEr3UAjDrwOP71rXixYEkeKMFlSX8ocwR6KUXTJ7AaNE2tF8WfA4Ye7Kw1mwvX/yZn+eKnvcrfzC6IK/ObP/pfnpfAGQnySoISBqUXyAASS1AK0JfagWYcRDOrAF66TxZQU7jBOEbM0egH71gcgXSFZAV54NQtj9YcNIpbONCyh8Ygi8CVospApDuB63g92W2/3Q/vW8AsqM4gLIKBBIH8bcJwMCNMX68BTqBb8s6sGWtsIA6jwDk662ZI9CvXjA5A6NVa2t/IAicnC/aGV+8T74IQPm/AmGuBc+8/VP+9IEAyLslAKMV/LgAyIUInfnjwPQqMOOgI/DstQ5Mr7UAqMF8V2YXDqoXXNl+EQQ6N9v29aKdesUpWJZbAPyPme0/3U8fGIDssDid/pUASCvCaXgJmFguAEfgEXT27gDkuwaUg/nbmSMwjF7whvbLhSDL5TwwvdRqo9oqHzACkCB8U2b7T/fThwIgO01T1IMCoAZxGRhbKoAXQUcQTjkI+a4B5e5FzjGsXvCG9gdqrLGFYrpVG/UuHzBOw2/LaXxzbh43DKeoJwlAHqLndSs4udoCoIBHQE45EPk3DuitmYOQoxdctp8+rFwIWsGFYiFFoLGNchcEQC6e+OJC5J2Z7T/dTx/aApYdJ37AyJK/DIwvFxYvWr0IwEn/H1Opco5sveDUhSAAF4HJpQJkWixp6k2n4IYfMGf0amDHev2I8+l4/UbvNw8Eozw72wJePOJ8und7EkKj9ztKGA1/7WwATo44n45pWI3e7/AAGPWZ2QBkYHCU+XTMfGGQmYIxjd7vqOE0+PXzATjifDrKtTZ6v4MP/MlyRj4AR5xPF+VaqZLJF1UzKdPV6P2eLDDr3I58AI44n07ZMARbo/d78gMubWE+AEecT8e9YOn2Uheu0fs9tUCYD8AR59MpG6bR+z21gKfW1gNAz4geRT5dTEZo9H5PPRDmAzBmRM8BJzqfLiYjSKKr0fs9dYBYDwBHmE9XtRfMsIz04aQZ1+j9npygrA+Akqs8wfl0BCCTWRq935MTYL1aVQ8Ao1zlAnAi8+kEQGZTNXq/vYb75Pt/fQAcUT5dBGCj93vyAaxXi+oDoFLyT3A+3Rcavd9eY3xS/z8fgCQX/LPR3SOzkon55jg1eyAfgD8M4NcAPD6aDmBtB1e4NMDNcer1QD4AbwbwxwDe4UvRE9wHZG1gNSXDLlwLNcep1QP5APxzzwj9IIAPnXhT5ORc5EYCA9HNcWr1QD4AmRH6FQBMTSZZH98ZmD5Bh5g1FopiNns1x6nTA/kAvAfAEwDudnI+EvQxPfkEzYfaCXRSBluQMB7YHKdGD+QDsBNBH/9+AkAobqTADGK7Inw1x8nfA/kA7EXQt8kgrGAGMfBxZ5Cv5ji5eyAfgL0I+r68uR0QmUFoBQU8vfNvzXHy9kA9AORoMw7CdGQCjoUZDwL4kv/+8OZ1gJhBIjGDgMh3vTavBc035/RAPgD7JegjODfhiMwgoqeJwNPPTaB6Ezq/hq+sB4AcXeXEP+ZhGVo9vRimIQD5v5oPAZCupgDI9wg8/qz/1Xz55usyeyAfgMMQ9GU2Op4eAchpOIJQQEz/VuPlm6/K7IH6AMjgGzdl6QtyX5jWjpQFevF3lq3xf6yhrOlIAUgQCojR8gmE+l9Nl2++JrMH6gEgR5UA5KYsc+AZmCbQCDi+IvgEQMob1XBEAHIajgBMLV+0kCdws6aGu3zqfkV9AGTwjftg3JRVVRAtHQEXX/wbAcoXP5d5CID8GoJKvqDAloKOoIz/y7x8c3pmD4zhaqwjRzCYyQg5gr2ZgsFTLweWr8XQgsXjbwLWrnNtMlKgNoLBmZAa7PTCAuYIBlMvlWQswwr2UlUw45jdDSx8HbD+Ctd+HVCwePKbgJV9aASDM8Yg59TWFDysYPBtmYK91IbNOHaPA/M7gUXKXA4hWDz79cA8+W0aweCMURj+1HYfcBjBYO54MMY3tGDv8I3nmWSHOzYOLJ0LLPGXAQWLz3oB8MQUsEa16kYwOG8whjh74yJkUMFgbsNlCfYO0epwissVY34bsHw2sEIRkAEEi/dcU0SP5qhF1ggG5w3GEGdXr4L5134Fg4kAjuDQgr1DtDqcUmZETwArZwAru4BVqsv0KVh8/o3F4v0QXZBGMDhvMIY4u3MYhv95Zh+Cu1xBcxuOU/HfeDIq5cv7FuwdotXhlCBXjOXZAnyrO4BV6in0IVh8wStLuWCsUAyvEQzOG5ABz+4eB+R/ewnu/kOP/3G/l4kJTERlljQtIot2e53/IwO2OPl4FLtcnCqAp9cahT56CBZf+LpSLhhz1N5qBIPzBmTAs/sLRHcTDKbiNHdBGGymOC/3hglEvgjAnoK9A7Y4+XgiV4zVWYDAs/etxaubYPFFP1QkLtCIP8neaASD8wZkwLP7AyC/tJNg8L/xLNBu+YBdBXsHbHEFAINcMVamgdWZAoRrfPdXm8KitLdmgYveWAq+2y7iMqfuRjA4b1AGOLt/APJLqwSD3+y5T1yI0AoSbAxMMzGV1o8/My2ro2DvAK2t+GgiV4zj4+3AIwDXtwBrVJeuECze+9aW4Dut4PxkIhYsdetGMDhvoDqcPRgA+SWp4O4veQ5Uv/mAGwR78+6rQq4Yq9PAOi2fA4/vBkKudKVU7VZw77uKvWFuZbtcMNb5v0YwOG9g+jx7cADyi6Pg7gccgIxlcA5TKhaD01yYKBmVFpBZMfx/m2Bvny3t8LGqoqTliZbVI+gMgHwnMAnCIFi897cLAAZ6QyzFzzSCwXkD1OPs4QDIL5XgLmk5JHk/SD5gKdibd38VcsVYGmuBTaAzEHLHgyCcaokB7/1IkUET5IKxwF5pBIPzBqbPs4cHIC/AaeqvPL9pmHxAE+zts6VdLCD/lcgVY3UyWD0Bj1ZwqgCggXA7sPfWAoAJvaEtZBrB4Lyx6efsPADyCtmCvf00s/NnOsgVY3m8BTRZPZuGBUACdArY+5lWDqGmYbIrLHEx0ggG5w1OH2fnA7CPizQfaXqgUw80AGywMdIeaAA40u5vLt4AsMHASHugAeBIu7+5eAPABgMj7YEGgCPt/ubiDQAbDIy0BxoAjrT7m4s3AGwwMNIeaAA40u5vLt4AsMHASHugAeBIu7+5eAPABgMj7YEGgCPt/ubiDQAbDIy0B8ZYNMbkX+ZekpuIiOQrPar+xs889HJg6jZg5jAwvVZ8B+ll9PlO5/Fc/o+ECjnHfi8zYfkvM5ulmp4qJXVqx5deD4zfAkw/CGxdAZgoHfuh131QkaI5hu8Bs4Ds8B0AWLnIRGCBsFfn87JffDMwdjOw5R5g8giwZa34jnQQUwDo99wBfJ4TM7COiNdlaj2rA/jeV/vfDeATAP4UGH8I2Lrc6gc+SHqY4oMZ74VSKM0xfA+UUzB/oBUUCKMl6zSQ/PsXqZD5KQC/A0w/DEwcAcYXgYnVwppwADuBkefnCim90FmBWXwnK87Uen53BI8sbuwqaz9p5UgnQhBS+ZN1zE8Ak0utviCwq8DI8/nx5hi+Bzb4gJzKZE1SEFZZgS9/2pWR/gTAJ4HJQ8DEMWB8ARhfBsaWCwDquwQKvvNgHXvOcYVbPFJPkw+dDxC/W1Y4tWDpw/Rlgo4lo1T4/KxTihDNpJwj3/UiMLXemprjffC7eWpzDN8DlYsQDiKtVxzEqoHkyX9HRizW+nIgaQnvAiaeBCbmC0s4tgSMu2rMePAR9X252jXklaTFU108K0MHav/nvJ6ZxVVk9OI7GR2IZoGQNc/HgbHgIwqILIVujuF7oOMqWFawCoRxkfEIB5CWgkREBCNf9wMTc8A4QciBWyoGz16rwNgaML5eWKpctYZL3N+TWLX0gvtuP0HHk2n16JDyxXmVhfU0qywbJbr5GSuXKxA/sV5Y9UYWdnjwyS3qKKgarWA69Wg6fjQOIK0HadnIjPVFB+AiME4AuiUkCFnESyCSkmAuU7Cjm15wX+2X2ifBRn9A8mKcW2UFjULVQcgVDl80u40SYh763FfvquhLCxitoBYUsoJfjXKttByMq9CKcHn4sPuCbgXNJwyWkECcz5Q376UX3LNncZyQAAADEklEQVT9fFgIJs6lBBwtn3Tt6FpIz4RWnuQxPh2XIGzm4CwQ9hWIFgBTK0gQHiIAJddKq0ELQh+KL1qUR4MvSEsoENIKrgALHNiMox+94K7tl9qnnMio8MSf6SNwGpYVjCDk/Ju7isq496fCqX0BkDeqlWwKwic1gAQSpzGREnFgREz01eALLvvq2Kfi45m6cf3qBXdsfxRbJMho8dimqOhEK8cXQRr9QVpvPoDNMXQP9A3ACELFxPh+jACkP0fLIKFCCRRqKuPUdqjlC9o07JZwKVNHeBC94DQcZO0XAAkmgotAk9QYrR9f/BvByYfMSATDVMzwTXMM3QMDAVAgVHCZ7/MaQK4QZUHiNCbBQlqUw74YCb7gcmYkelC9YFlwvVv7RRAorTuBkECU9asCID9/x9B935zYzyKkqpfiNHxcA0gLQgvBAaPVkCqm3h2AtC5m/RyEqzw/4xhGL3hD++MmslgqCbgUfLKAcRrmTlBzDN0DA1tAXUlWcDm1IOIIJAjlT/Fd05lbFQFwjdtgGcewesFt7Rc/Gx8iWjUCjGCT1YvWT1MwgUqrf3NG45tTbcu0aximWx9xENcEQHGbcYAEwtSXSqY0gnCdgeuMI0cvuGx/FUGgFhwEYrR80QckWN+X0fjm1DwAWv8RgJFilJZBznz0pQg+AZAAlVWh1GvGka0XzB0cCQi30aSGVa9AF62fLOB7MhrfnJoPwPER59Px+o3e76mL5Kwp2G57xPl0kxc3er+nLvyKtLmhfUC78RHn081ONnq/pzcAR5xPR9mRRu/31IVgvgUccT4dNaobvd/TGYAjzqejumqj93s6A3DE+XRUg2VSCjdaGr3fUw+I+VPwiPPpqJjO8J1Nw43e7ymHwHoAKMFd7QErAeEE5NNJMb3R+z3lsGcNzgfgiPPpomJ6o/d76oGwPgCOKJ8uKqY3er+nKwBHmE+noqRG7/fUA199U/AI8+kEwEbv93QHoEhZTnA+nYqSGr3fBoAtaiqBUImdm5hPJwA2er+nKwBHnE+X1gUzSbnR+z11wPj/AeCpPDD3t7rvAAAAAElFTkSuQmCC",lke="uniform sampler2D weightMap;varying vec2 vOffset0;varying vec2 vOffset1;void movec(const in bvec2 c,inout vec2 variable,const in vec2 value){if(c.x){variable.x=value.x;}if(c.y){variable.y=value.y;}}void movec(const in bvec4 c,inout vec4 variable,const in vec4 value){movec(c.xy,variable.xy,value.xy);movec(c.zw,variable.zw,value.zw);}void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec4 a;a.x=texture2D(weightMap,vOffset0).a;a.y=texture2D(weightMap,vOffset1).g;a.wz=texture2D(weightMap,uv).rb;vec4 color=inputColor;if(dot(a,vec4(1.0))>=1e-5){bool h=max(a.x,a.z)>max(a.y,a.w);vec4 blendingOffset=vec4(0.0,a.y,0.0,a.w);vec2 blendingWeight=a.yw;movec(bvec4(h),blendingOffset,vec4(a.x,0.0,a.z,0.0));movec(bvec2(h),blendingWeight,a.xz);blendingWeight/=dot(blendingWeight,vec2(1.0));vec4 blendingCoord=blendingOffset*vec4(texelSize,-texelSize)+uv.xyxy;color=blendingWeight.x*texture2D(inputBuffer,blendingCoord.xy);color+=blendingWeight.y*texture2D(inputBuffer,blendingCoord.zw);}outputColor=color;}",cke="varying vec2 vOffset0;varying vec2 vOffset1;void mainSupport(const in vec2 uv){vOffset0=uv+texelSize*vec2(1.0,0.0);vOffset1=uv+texelSize*vec2(0.0,1.0);}",vu={LOW:0,MEDIUM:1,HIGH:2,ULTRA:3},FH=class extends pl{constructor({preset:e=vu.MEDIUM,edgeDetectionMode:t=mw.COLOR,predicationMode:r=nze.DISABLED}={}){super("SMAAEffect",lke,{vertexShader:cke,blendFunction:Tr.NORMAL,attributes:el.CONVOLUTION|el.DEPTH,uniforms:new Map([["weightMap",new rt(null)]])});let i,n;arguments.length>1&&(i=arguments[0],n=arguments[1],arguments.length>2&&(e=arguments[2]),arguments.length>3&&(t=arguments[3])),this.renderTargetEdges=new Ur(1,1,{minFilter:ur,stencilBuffer:!1,depthBuffer:!1}),this.renderTargetEdges.texture.name="SMAA.Edges",this.renderTargetWeights=this.renderTargetEdges.clone(),this.renderTargetWeights.texture.name="SMAA.Weights",this.uniforms.get("weightMap").value=this.renderTargetWeights.texture,this.clearPass=new dD(!0,!1,!1),this.clearPass.overrideClearColor=new Lt(0),this.clearPass.overrideClearAlpha=1,this.edgeDetectionPass=new Zo(new aze),this.edgeDetectionMaterial.edgeDetectionMode=t,this.edgeDetectionMaterial.predicationMode=r,this.weightsPass=new Zo(new pze);let a=new jj;a.onLoad=()=>{let o=new Oi(i);o.name="SMAA.Search",o.magFilter=Hr,o.minFilter=Hr,o.generateMipmaps=!1,o.needsUpdate=!0,o.flipY=!0,this.weightsMaterial.searchTexture=o;let s=new Oi(n);s.name="SMAA.Area",s.magFilter=ur,s.minFilter=ur,s.generateMipmaps=!1,s.needsUpdate=!0,s.flipY=!1,this.weightsMaterial.areaTexture=s,this.dispatchEvent({type:"load"})},a.itemStart("search"),a.itemStart("area"),i!==void 0&&n!==void 0?(a.itemEnd("search"),a.itemEnd("area")):typeof Image<"u"&&(i=new Image,n=new Image,i.addEventListener("load",()=>a.itemEnd("search")),n.addEventListener("load",()=>a.itemEnd("area")),i.src=kB,n.src=LB),this.applyPreset(e)}get edgesTexture(){return this.renderTargetEdges.texture}getEdgesTexture(){return this.edgesTexture}get weightsTexture(){return this.renderTargetWeights.texture}getWeightsTexture(){return this.weightsTexture}get edgeDetectionMaterial(){return this.edgeDetectionPass.fullscreenMaterial}get colorEdgesMaterial(){return this.edgeDetectionMaterial}getEdgeDetectionMaterial(){return this.edgeDetectionMaterial}get weightsMaterial(){return this.weightsPass.fullscreenMaterial}getWeightsMaterial(){return this.weightsMaterial}setEdgeDetectionThreshold(e){this.edgeDetectionMaterial.edgeDetectionThreshold=e}setOrthogonalSearchSteps(e){this.weightsMaterial.orthogonalSearchSteps=e}applyPreset(e){let t=this.edgeDetectionMaterial,r=this.weightsMaterial;switch(e){case vu.LOW:t.edgeDetectionThreshold=.15,r.orthogonalSearchSteps=4,r.diagonalDetection=!1,r.cornerDetection=!1;break;case vu.MEDIUM:t.edgeDetectionThreshold=.1,r.orthogonalSearchSteps=8,r.diagonalDetection=!1,r.cornerDetection=!1;break;case vu.HIGH:t.edgeDetectionThreshold=.1,r.orthogonalSearchSteps=16,r.diagonalSearchSteps=8,r.cornerRounding=25,r.diagonalDetection=!0,r.cornerDetection=!0;break;case vu.ULTRA:t.edgeDetectionThreshold=.05,r.orthogonalSearchSteps=32,r.diagonalSearchSteps=16,r.cornerRounding=25,r.diagonalDetection=!0,r.cornerDetection=!0;break}}setDepthTexture(e,t=pc){this.edgeDetectionMaterial.depthBuffer=e,this.edgeDetectionMaterial.depthPacking=t}update(e,t,r){this.clearPass.render(e,this.renderTargetEdges),this.edgeDetectionPass.render(e,t,this.renderTargetEdges),this.weightsPass.render(e,this.renderTargetEdges,this.renderTargetWeights)}setSize(e,t){this.edgeDetectionMaterial.setSize(e,t),this.weightsMaterial.setSize(e,t),this.renderTargetEdges.setSize(e,t),this.renderTargetWeights.setSize(e,t)}dispose(){let{searchTexture:e,areaTexture:t}=this.weightsMaterial;e!==null&&t!==null&&(e.dispose(),t.dispose()),super.dispose()}static get searchImageDataURL(){return kB}static get areaImageDataURL(){return LB}},dke=`uniform float offset;uniform float darkness;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){const vec2 center=vec2(0.5);vec3 color=inputColor.rgb;
#if VIGNETTE_TECHNIQUE == 0
float d=distance(uv,center);color*=smoothstep(0.8,offset*0.799,d*(darkness+offset));
#else
vec2 coord=(uv-center)*vec2(offset);color=mix(color,vec3(1.0-darkness),dot(coord,coord));
#endif
outputColor=vec4(color,inputColor.a);}`,$y={DEFAULT:0,ESKIL:1},uke=class extends pl{constructor({blendFunction:e=Tr.NORMAL,technique:t=$y.DEFAULT,eskil:r=!1,offset:i=.5,darkness:n=.5}={}){super("VignetteEffect",dke,{blendFunction:e,defines:new Map([["VIGNETTE_TECHNIQUE",t.toFixed(0)]]),uniforms:new Map([["offset",new rt(i)],["darkness",new rt(n)]])})}get technique(){return Number(this.defines.get("VIGNETTE_TECHNIQUE"))}set technique(e){this.technique!==e&&(this.defines.set("VIGNETTE_TECHNIQUE",e.toFixed(0)),this.setChanged())}get eskil(){return this.technique===$y.ESKIL}set eskil(e){this.technique=e?$y.ESKIL:$y.DEFAULT}getTechnique(){return this.technique}setTechnique(e){this.technique=e}get offset(){return this.uniforms.get("offset").value}set offset(e){this.uniforms.get("offset").value=e}getOffset(){return this.offset}setOffset(e){this.offset=e}get darkness(){return this.uniforms.get("darkness").value}set darkness(e){this.uniforms.get("darkness").value=e}getDarkness(){return this.darkness}setDarkness(e){this.darkness=e}},mc=class{constructor(e,t){this.enabled=!1,this.effect=new e(t),Object.defineProperty(this,"opacity",{enumerable:!0,set(r){this.effect.blendMode.opacity.value=r},get(){return this.effect.blendMode.opacity.value}}),Object.defineProperty(this,"blendFunction",{enumerable:!0,set(r){this.effect.blendMode.setBlendFunction(Number(r))},get(){return this.effect.blendMode.blendFunction}}),this.blendFunction=Tr.NORMAL}},hke=class extends mc{constructor(){super($ze),this.blendFunction=Tr.SCREEN}set intensity(e){this.effect.intensity=e}get intensity(){return this.effect.intensity}set luminanceThreshold(e){this.effect.luminanceMaterial.threshold=e}get luminanceThreshold(){return this.effect.luminanceMaterial.threshold}set luminanceSmoothing(e){this.effect.luminanceMaterial.smoothing=e}get luminanceSmoothing(){return this.effect.luminanceMaterial.smoothing}set blurScale(e){this.effect.blurPass.scale=e}get blurScale(){return this.effect.blurPass.scale}set kernelSize(e){this.effect.blurPass.kernelSize=e}get kernelSize(){return this.effect.blurPass.kernelSize}},fke=class extends mc{constructor(){super(Yze)}set contrast(e){this.effect.uniforms.get("contrast").value=e}get contrast(){return this.effect.uniforms.get("contrast").value}set brightness(e){this.effect.uniforms.get("brightness").value=e}get brightness(){return this.effect.uniforms.get("brightness").value}},pke=class extends mc{constructor(){super(Jze),this.effect.offset=new ye(.01,.01)}set offset(e){this.effect.offset.set(e[0]/1e3,e[1]/1e3)}get offset(){return[this.effect.offset.x*1e3,this.effect.offset.y*1e3]}},mke=class extends mc{constructor(){super(Kze)}},vke=class extends mc{constructor(){super(ike),this._hue=0}set hue(e){this._hue=e,this.effect.setHue(e)}get hue(){return this._hue}set saturation(e){this.effect.uniforms.get("saturation").value=e}get saturation(){return this.effect.uniforms.get("saturation").value}},gke=class extends mc{constructor(){super(ake),this.blendFunction=Tr.OVERLAY}},yke=class extends mc{constructor(){super(uke)}get eskil(){return this.effect.eskil}set eskil(e){this.effect.eskil=e}get darkness(){return this.effect.uniforms.get("darkness").value}set darkness(e){this.effect.uniforms.get("darkness").value=e}get offset(){return this.effect.uniforms.get("offset").value}set offset(e){this.effect.uniforms.get("offset").value=e}},bke=class extends mc{constructor(e){super(tke)}set focalLength(e){this.effect.circleOfConfusionMaterial.uniforms.focalLength.value=e/2e3}get focalLength(){return this.effect.circleOfConfusionMaterial.uniforms.focalLength.value}set focusDistance(e){this.effect.circleOfConfusionMaterial.uniforms.focusDistance.value=this.isPerspectiveCamera?e/2e3:(e+992)/2e3}get focusDistance(){return this.effect.circleOfConfusionMaterial.uniforms.focusDistance.value}get bokehScale(){return this.effect.bokehScale}set bokehScale(e){this.effect.bokehScale=e}setCamera(e){let t=!1;(e.isPerspectiveCamera&&this.isPerspectiveCamera===!1||!e.isPerspectiveCamera&&this.isPerspectiveCamera===!0)&&(t=!0),e.isPerspectiveCamera?(this.effect.circleOfConfusionMaterial.adoptCameraSettings(e.perspCamera),this.isPerspectiveCamera=!0):(this.effect.circleOfConfusionMaterial.adoptCameraSettings(e),this.isPerspectiveCamera=!1),t&&this.effect.setChanged()}},xke=class extends mc{constructor(){super(ske)}get granularity(){return this.effect.getGranularity()}set granularity(e){this.effect.setGranularity(e)}},wke=`#define GLSLIFY 1
varying vec2 vUv;varying vec2 vTexCoords[9];uniform vec2 resolution;void main(){vUv=position.xy*0.5+0.5;vec2 texelSize=vec2(1.0)/resolution;vTexCoords[0]=vUv+vec2(-texelSize.x,-texelSize.y);vTexCoords[1]=vUv+vec2(0.0,-texelSize.y);vTexCoords[2]=vUv+vec2(texelSize.x,-texelSize.y);vTexCoords[3]=vUv+vec2(-texelSize.x,0.0);vTexCoords[4]=vUv+vec2(0.0,0.0);vTexCoords[5]=vUv+vec2(texelSize.x,0.0);vTexCoords[6]=vUv+vec2(-texelSize.x,texelSize.y);vTexCoords[7]=vUv+vec2(0.0,texelSize.y);vTexCoords[8]=vUv+vec2(texelSize.x,texelSize.y);gl_Position=vec4(position.xy,1.0,1.0);}`,Ske=`#define GLSLIFY 1
#include <common>
varying vec2 vUv;varying vec2 vTexCoords[9];uniform sampler2D inputBuffer;uniform sampler2D historyBuffer;uniform sampler2D velocityBuffer;uniform sampler2D depthBuffer;uniform vec2 resolution;
#define USE_YCOCG
#define USE_CATMULL_ROM
const float feedback_min=0.5;const float feedback_max=0.95;vec3 RGB_YCoCg(vec3 c){return vec3(c.x/4.0+c.y/2.0+c.z/4.0,c.x/2.0-c.z/2.0,-c.x/4.0+c.y/2.0-c.z/4.0);}vec3 YCoCg_RGB(vec3 c){return clamp(vec3(c.x+c.y-c.z,c.x+c.z,c.x-c.y-c.z),vec3(0.0),vec3(1.0));}vec4 sample_color(sampler2D tex,vec2 uv){
#ifdef USE_YCOCG
vec4 c=texture(tex,uv);return vec4(RGB_YCoCg(c.rgb),c.a);
#else
return texture(tex,uv);
#endif
}vec4 sample_catmull_rom(sampler2D tex,vec2 uv,vec2 texSize){vec2 samplePos=uv*texSize;vec2 texPos1=floor(samplePos-0.5)+0.5;vec2 f=samplePos-texPos1;vec2 w0=f*(-0.5+f*(1.0-0.5*f));vec2 w1=1.0+f*f*(-2.5+1.5*f);vec2 w2=f*(0.5+f*(2.0-1.5*f));vec2 w3=f*f*(-0.5+0.5*f);vec2 w12=w1+w2;vec2 offset12=w2/(w1+w2);vec2 texPos0=texPos1-1.0;vec2 texPos3=texPos1+2.0;vec2 texPos12=texPos1+offset12;texPos0/=texSize;texPos3/=texSize;texPos12/=texSize;vec4 result=vec4(0.0);result+=texture2D(tex,vec2(texPos12.x,texPos0.y))*w12.x*w0.y;result+=texture2D(tex,vec2(texPos0.x,texPos12.y))*w0.x*w12.y;result+=texture2D(tex,vec2(texPos12.x,texPos12.y))*w12.x*w12.y;result+=texture2D(tex,vec2(texPos3.x,texPos12.y))*w3.x*w12.y;result+=texture2D(tex,vec2(texPos12.x,texPos3.y))*w12.x*w3.y;return result;}vec3 choose_motion_vector(){
#ifdef CHOOSE_LONGEST_MOTION_VECTOR
float longest=-1.0;vec3 v_choose=vec3(-1.0);for(int i=0;i<9;i++){vec3 v=texture2D(velocityBuffer,vTexCoords[i]).rgb;float l=length(v.xy);if(l>longest){longest=l;v_choose=v;}}return v_choose;
#else
float closest_depth=1000.0;vec2 closest_uv_offset=vec2(0.0);for(int i=0;i<9;i++){float neighbor_depth=texture2D(depthBuffer,vTexCoords[i]).r;if(neighbor_depth<closest_depth){closest_uv_offset=vTexCoords[i];closest_depth=neighbor_depth;}}return texture2D(velocityBuffer,closest_uv_offset).rgb;
#endif
}vec4 clipAabb(vec3 aabb_min,vec3 aabb_max,vec4 avg,vec4 input_texel){const float FLT_EPS=0.00000001;vec3 p_clip=0.5*(aabb_max+aabb_min);vec3 e_clip=0.5*(aabb_max-aabb_min)+FLT_EPS;vec4 v_clip=input_texel-vec4(p_clip,avg.w);vec3 v_unit=v_clip.xyz/e_clip;vec3 a_unit=abs(v_unit);float ma_unit=max(a_unit.x,max(a_unit.y,a_unit.z));if(ma_unit>1.0){return vec4(p_clip,avg.w)+v_clip/ma_unit;}else{return input_texel;}}vec3 clip_aabb_variance(in vec3 cOld,in vec3 cNew,in vec3 centre,in vec3 halfSize){if(all(lessThanEqual(abs(cOld-centre),halfSize))){return cOld;}vec3 dir=(cNew-cOld);vec3 near=centre-sign(dir)*halfSize;vec3 tAll=(near-cOld)/dir;float t=0.0001;for(int i=0;i<3;i++){if(tAll[i]>=0.0&&tAll[i]<t){t=tAll[i];}}if(t>=0.0001){return cOld;}return cOld+dir*t;}void main(){vec3 v=choose_motion_vector();vec2 velocity=v.rg;vec2 previousPixelPos=vUv-velocity;vec4 currentColor=sample_color(inputBuffer,vUv);
#ifdef USE_CATMULL_ROM
vec4 previousColor=sample_catmull_rom(historyBuffer,previousPixelPos,resolution);
#else
vec4 previousColor=sample_color(historyBuffer,previousPixelPos);
#endif
#ifdef USE_YCOCG
previousColor=vec4(RGB_YCoCg(previousColor.rgb),previousColor.a);
#endif
vec4 ctl=sample_color(inputBuffer,vTexCoords[0]);vec4 ctc=sample_color(inputBuffer,vTexCoords[1]);vec4 ctr=sample_color(inputBuffer,vTexCoords[2]);vec4 cml=sample_color(inputBuffer,vTexCoords[3]);vec4 cmc=sample_color(inputBuffer,vTexCoords[4]);vec4 cmr=sample_color(inputBuffer,vTexCoords[5]);vec4 cbl=sample_color(inputBuffer,vTexCoords[6]);vec4 cbc=sample_color(inputBuffer,vTexCoords[7]);vec4 cbr=sample_color(inputBuffer,vTexCoords[8]);vec4 cmin=min(ctl,min(ctc,min(ctr,min(cml,min(cmc,min(cmr,min(cbl,min(cbc,cbr))))))));vec4 cmax=max(ctl,max(ctc,max(ctr,max(cml,max(cmc,max(cmr,max(cbl,max(cbc,cbr))))))));vec4 cavg=(ctl+ctc+ctr+cml+cmc+cmr+cbl+cbc+cbr)/9.0;vec4 cmin5=min(ctc,min(cml,min(cmc,min(cmr,cbc))));vec4 cmax5=max(ctc,max(cml,max(cmc,max(cmr,cbc))));vec4 cavg5=(ctc+cml+cmc+cmr+cbc)/5.0;cmin=0.5*(cmin+cmin5);cmax=0.5*(cmax+cmax5);cavg=0.5*(cavg+cavg5);
#ifdef USE_YCOCG
vec2 chroma_extent=vec2(0.25*0.5*(cmax.r-cmin.r));vec2 chroma_center=currentColor.gb;cmin.yz=chroma_center-chroma_extent;cmax.yz=chroma_center+chroma_extent;cavg.yz=chroma_center;
#endif
vec4 previousColorClipped=clamp(previousColor,cmin,cmax);
#ifdef LUMINANCE_DIFFERENCES
#ifdef USE_YCOCG
float lum0=currentColor.r;float lum1=previousColorClipped.r;
#else
float lum0=luminance(currentColor.rgb);float lum1=luminance(previousColorClipped.rgb);
#endif
float unbiased_diff=abs(lum0-lum1)/max(lum0,max(lum1,0.2));float unbiased_weight=1.0-unbiased_diff;float unbiased_weight_sqr=unbiased_weight*unbiased_weight;float k_feedback=mix(feedback_min,feedback_max,unbiased_weight_sqr);vec4 result=mix(currentColor,previousColorClipped,vec4(k_feedback));
#else
const float alpha=0.1;vec4 result=mix(currentColor,previousColorClipped,1.0-alpha);
#endif
#ifdef USE_YCOCG
gl_FragColor=vec4(YCoCg_RGB(result.rgb).rgb,result.a);
#else
gl_FragColor=result;
#endif
}`,Cke=`#define GLSLIFY 1
varying vec2 vUv;void main(){gl_Position=vec4(position.xy,1.0,1.0);vUv=position.xy*0.5+0.5;}`,_ke=`#define GLSLIFY 1
layout(location=1)out vec4 gVelocity;varying vec2 vUv;uniform sampler2D inputBuffer;void main(){gl_FragColor=texture2D(inputBuffer,vUv);gVelocity=vec4(0.0);}`,aE=class extends jr{constructor(){super({name:"PassthroughMaterial",uniforms:{inputBuffer:new rt(null)},blending:ln,depthWrite:!1,depthTest:!1,vertexShader:Cke,fragmentShader:_ke})}set inputBuffer(e){this.uniforms.inputBuffer.value=e}},Ake=class extends za{constructor(){super("TAAResolvePass"),this.MRTCompatible=!0,this.needsSwap=!1,this.passThroughMaterial=new aE,this.resolutionVector=new ye,this.resolveMaterial=new jr({name:"TAAResolveMaterial",uniforms:{inputBuffer:new rt(null),historyBuffer:new rt(null),velocityBuffer:new rt(null),depthBuffer:new rt(null),resolution:new rt(new ye)},blending:ln,depthWrite:!1,depthTest:!1,vertexShader:wke,fragmentShader:Ske}),this.historyRenderTarget=new Ur(1024,1024,{minFilter:ur,stencilBuffer:!1,depthBuffer:!1}),this.historyRenderTarget.texture.name="TAA.History",this.resultRenderTarget=new Ur(1024,1024,{minFilter:ur,stencilBuffer:!1,depthBuffer:!1}),this.resultRenderTarget.texture.name="TAA.Output"}setSize(e,t){this.historyRenderTarget.setSize(e,t),this.resultRenderTarget.setSize(e,t)}render(e,t){this.fullscreenMaterial=this.resolveMaterial,this.resolveMaterial.uniforms.inputBuffer.value=t.texture[0],this.resolveMaterial.uniforms.velocityBuffer.value=t.texture[1],this.resolveMaterial.uniforms.depthBuffer.value=t.depthTexture,this.resolveMaterial.uniforms.historyBuffer.value=this.historyRenderTarget.texture,this.resolveMaterial.uniforms.resolution.value.set(t.width,t.height),e.setRenderTarget(this.resultRenderTarget),e.render(this.scene,this.camera),this.fullscreenMaterial=this.passThroughMaterial,this.passThroughMaterial.inputBuffer=this.resultRenderTarget.texture,e.setRenderTarget(this.historyRenderTarget),e.render(this.scene,this.camera);let r=this.renderToScreen?null:t;this.fullscreenMaterial=this.passThroughMaterial,this.passThroughMaterial.inputBuffer=this.resultRenderTarget.texture,e.setRenderTarget(r),e.render(this.scene,this.camera)}dispose(){this.resultRenderTarget.dispose(),this.historyRenderTarget.dispose(),this.resolveMaterial.dispose(),this.passThroughMaterial.dispose()}},Mke=class extends za{constructor(e,t,r){super("TransmissionPass",void 0,t),this.MRTCompatible=!0,this.depthPass=new IB(e,t,{renderTarget:r.transmissionDepthTarget}),this.passThroughMaterial=new aE,this.splineScene=e,this.needsSwap=!1}updatePasses(e){this.passThroughMaterial=new aE,this.depthPass=new IB(this.splineScene,this.camera,{renderTarget:e.transmissionDepthTarget})}setCamera(e){this.camera=e}setScene(e){this.splineScene=e}render(e,t,r){let i=this.camera.layers.mask,n=e;n.setRenderTarget(n.transmissionRenderTarget),this.fullscreenMaterial=this.passThroughMaterial,this.passThroughMaterial.inputBuffer=t.texture[0],n.clear(),n.render(this.scene,this.camera),this.camera.layers.disable(3),this.depthPass.render(e,t,r),n.shadowMap.needsUpdate=!1,n.shadowMap.autoUpdate=!1;let a=this.renderToScreen?null:t;this.camera.layers.set(3),e.setRenderTarget(a),e.render(this.splineScene,this.camera),this.camera.layers.mask=i}},BB=new Js,Eke=new jr({transparent:!0,vertexShader:`
        void main() {
            gl_Position = vec4(0.0);
        }
    `,fragmentShader:`
        layout(location = 1) out vec4 gVelocity;

        void main() {
            gl_FragColor = vec4(0.0);
			gVelocity = vec4(0.0);
        }
    `}),oE=class extends za{constructor(e,t,r){super("OpaquePass",t??BB,r),this.MRTCompatible=!0,this.hasTransmissionPass=!1,this.clear=!0,this.clearColorOnly=!1,this.clearDepth=!1,this.needsSwap=!1,this.originalMaterials=new Map,this.MRTCompatible=e}setCamera(e){this.camera=e}setScene(e){this.scene=e??BB}getScene(){return this.scene}render(e,t){this.camera.layers.enable(3),this.hasTransmissionPass&&(this.originalMaterials.clear(),this.scene.traverse(i=>{i.layers.isEnabled(3)&&i instanceof Ra&&(this.originalMaterials.set(i.id,i.material),i.material=Eke)}),e.shadowMap.needsUpdate=!0,e.shadowMap.autoUpdate=!0),this.camera.layers.enable(8);let r=this.renderToScreen?null:t;e.setRenderTarget(r),this.clearColorOnly&&e.clear(!0,!1,!0),this.clear&&e.clear(),e.render(this.scene,this.camera),this.clearDepth&&e.clear(!1,!0,!1),this.hasTransmissionPass&&this.originalMaterials.forEach((i,n)=>{let a=this.scene.getObjectById(n);a&&(a.material=i)})}},Tke=class{constructor(e,{depthBuffer:t=!0,stencilBuffer:r=!1,multisampling:i=0,frameBufferType:n=0}={}){this.renderer=e,this.helperStartIndex=0,this.copyPass=new nE,this.depthTexture=null,this.timer=new Wze,this._width=1,this._height=1,this.passes=[],this.helperPasses=[],this.autoRenderToScreen=!0,this.inputBuffer=this.createBuffer(t,r,n,i,!0,"input buffer mrt"),this.inputBufferSingle=this.createBuffer(t,r,n,i,!1," input buffer single"),this.inputBufferSingle.texture.dispose(),this.inputBufferSingle.depthTexture.dispose(),this.inputBufferSingle.texture=this.inputBuffer.texture[0],this.inputBufferSingle.depthTexture=this.inputBuffer.depthTexture,this.outputBuffer=this.inputBuffer.clone(),this.outputBuffer.name="output buffer mrt",this.outputBufferSingle=this.createBuffer(t,r,n,i,!1,"output buffer single"),this.outputBufferSingle.texture.dispose(),this.outputBufferSingle.depthTexture.dispose(),this.outputBufferSingle.texture=this.outputBuffer.texture[0],this.outputBufferSingle.depthTexture=this.outputBuffer.depthTexture,this.setRenderer(e)}get multisampling(){return this.inputBuffer.samples||0}set multisampling(e){let t=this.inputBuffer,r=this.multisampling;r>0&&e>0?(this.inputBuffer.samples=e,this.outputBuffer.samples=e,this.inputBuffer.dispose(),this.outputBuffer.dispose()):r!==e&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),console.log("creating new input buffer"),this.inputBuffer=this.createBuffer(t.depthBuffer,t.stencilBuffer,t.texture.type,e,!0,"new input buffer"),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}getTimer(){return this.timer}getRenderer(){return this.renderer}setRenderer(e){var t;if(this.renderer=e,e!==null){let r=e.getSize(new ye),i=((t=e.getContext().getContextAttributes())==null?void 0:t.alpha)??!1,n=this.inputBuffer.texture[0].type;n===ga&&e.outputEncoding===sr&&(this.inputBuffer.texture[0].encoding=sr,this.outputBuffer.texture[0].encoding=sr,this.inputBuffer.dispose(),this.outputBuffer.dispose(),console.log("doing some kinda dispose??")),e.autoClear=!1,this.setSize(r.width,r.height,!1);for(let a of this.passes)a.initialize(e,i,n)}}replaceRenderer(e,t=!0){let r=this.renderer,i=r.domElement.parentNode;return this.setRenderer(e),t&&i!==null&&(i.removeChild(r.domElement),i.appendChild(e.domElement)),r}createDepthTexture(){let e=this.depthTexture=new gp(this._width,this._height);return this.inputBuffer.depthTexture=e,this.inputBuffer.stencilBuffer?(e.format=ih,e.type=Nu):e.type=Wl,e}deleteDepthTexture(){if(this.depthTexture!==null){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();for(let e of this.passes)e.setDepthTexture(null)}}createBuffer(e,t,r,i,n,a){let o=this.renderer,s=o===null?new ye:o.getDrawingBufferSize(new ye),l={minFilter:ur,magFilter:ur,wrapS:Si,wrapT:Si,stencilBuffer:t,depthBuffer:e},c;return i>0?(c=new Ur(s.width,s.height,l),c.samples=i):(n?(c=new Wve(s.width,s.height,2,l),c.texture[1].type=ec):c=new Ur(s.width,s.height,l),c.depthTexture=new gp(2048,2048),c.depthTexture.type=on),r===ga&&o!==null&&o.outputEncoding===sr&&(Array.isArray(c.texture)?c.texture.forEach(d=>d.encoding=sr):c.texture.encoding=sr),Array.isArray(c.texture)?c.texture.forEach((d,u)=>{d.name=`EffectComposer.Buffer ${n} ${u}`,d.generateMipmaps=!1}):(c.texture.name=`EffectComposer.Buffer ${n}`,c.texture.generateMipmaps=!1),c.name=a,c}addPass(e,t){var s;let r=this.passes,i=this.renderer,n=i.getDrawingBufferSize(new ye),a=((s=i.getContext().getContextAttributes())==null?void 0:s.alpha)??!1,o;if(e.MRTCompatible&&(o=this.inputBuffer.texture[0].type),e.MRTCompatible||(o=this.inputBuffer.texture.type),e.setRenderer(i),e.setSize(n.width,n.height),e.initialize(i,a,o),this.autoRenderToScreen&&(r.length>0&&(r[r.length-1].renderToScreen=!1),e.renderToScreen&&(this.autoRenderToScreen=!1)),t!==void 0?r.splice(t,0,e):r.push(e),this.autoRenderToScreen&&(r[r.length-1].renderToScreen=!0),e.needsDepthTexture||this.depthTexture!==null)if(this.depthTexture===null){let l=this.createDepthTexture();for(e of r)e.setDepthTexture(l)}else e.setDepthTexture(this.depthTexture)}setHelperStartIndex(e){this.helperStartIndex=e}removePass(e){let t=this.passes,r=t.indexOf(e);if(r!==-1&&t.splice(r,1).length>0){if(this.depthTexture!==null){let i=(n,a)=>n||a.needsDepthTexture;t.reduce(i,!1)||e.getDepthTexture()===this.depthTexture&&e.setDepthTexture(null)}this.autoRenderToScreen&&r===t.length&&(e.renderToScreen=!1,t.length>0&&(t[t.length-1].renderToScreen=!0))}}removeAllPasses(){let e=this.passes;e.length>0&&(this.autoRenderToScreen&&(e[e.length-1].renderToScreen=!1),this.passes=[])}render(e){let t=this.renderer,r=this.copyPass,i=this.inputBuffer,n=this.outputBuffer,a=this.inputBufferSingle,o=this.outputBufferSingle,s=!1,l,c,d,u;e===void 0&&(e=this.timer.update().getDelta());for(let h of this.passes)h.enabled&&(h.MRTCompatible?h.render(t,i,n,e,s):h.render(t,a,o,e,s),h.needsSwap&&(s&&(r.renderToScreen=h.renderToScreen,l=t.getContext(),c=t.state.buffers.stencil,c.setFunc(l.NOTEQUAL,1,4294967295),r.render(t,i,n,e,s),c.setFunc(l.EQUAL,1,4294967295)),d=i,u=a,i=n,a=o,n=d,o=u),h instanceof Vze?s=!0:h instanceof gze&&(s=!1))}setSize(e,t,r){let i=this.renderer;if(this._width=e,this._height=t,e===void 0||t===void 0){let a=i.getSize(new ye);e=a.width,t=a.height}i.setSize(e,t,r);let n=i.getDrawingBufferSize(new ye);this.inputBuffer.setSize(n.width,n.height),this.outputBuffer.setSize(n.width,n.height),this.inputBufferSingle.setSize(n.width,n.height),this.outputBufferSingle.setSize(n.width,n.height);for(let a of this.passes)a.setSize(n.width,n.height)}reset(){let e=this.timer.isAutoResetEnabled();this.dispose(),this.autoRenderToScreen=!0,this.timer.setAutoResetEnabled(e)}dispose(){for(let e of this.passes)e.dispose();this.passes=[],this.inputBuffer!==null&&this.inputBuffer.dispose(),this.outputBuffer!==null&&this.outputBuffer.dispose(),this.inputBufferSingle!==null&&this.inputBufferSingle.dispose(),this.outputBufferSingle!==null&&this.outputBufferSingle.dispose(),this.deleteDepthTexture(),this.copyPass.dispose(),this.timer.dispose()}},Pke=new jr({name:"CombineMaterial",uniforms:{inputBufferA:new rt(null),inputBufferB:new rt(null)},blending:ln,depthWrite:!1,depthTest:!1,vertexShader:`
varying vec2 vUv;
void main() {
    gl_Position = vec4(position.xy, 1.0, 1.0);
    vUv = position.xy * 0.5 + 0.5;
}
`,fragmentShader:`
    varying vec2 vUv;
    uniform sampler2D inputBufferA;
    uniform sampler2D inputBufferB;

    // TODO: Why do we need these when postpro of framemode is enabled???
    layout(location = 1) out vec4 gVelocity;

    void main() {
	vec4 resA = texture2D(inputBufferA, vUv);
	vec4 resB = texture2D(inputBufferB, vUv);
    float a = resA.a + resB.a * ( 1.0 - resA.a );

	vec4 res;
	res.rgb =  resA.rgb + (resB.rgb * (1.0 - resA.a));
	res.a = resA.a + resB.a * (1.0 - resA.a);
	gl_FragColor = res;
    gVelocity = vec4(0.0);
    }
`}),Dke=class extends za{constructor(e){super("HelperPass",void 0,e),this.MRTCompatible=!1,this.fullscreenMaterial=Pke,this.helperPass=new oE(!1,void 0,this.camera),this.helperPass.hasTransmissionPass=!1,this.helperPass.clear=!1,this.helperPass.renderToScreen=!1,this.helperPassOnTop=new oE(!1,void 0,this.camera),this.helperPassOnTop.hasTransmissionPass=!1,this.helperPassOnTop.clear=!1,this.helperPassOnTop.renderToScreen=!1;let t=new FH({preset:vu.LOW,edgeDetectionMode:mw.COLOR});this.effectPass=new t1(this.camera,t),this.rt=new Ur(10,10,{minFilter:ur,magFilter:ur,wrapS:Si,wrapT:Si,depthBuffer:!0})}setSize(e,t){this.rt.setSize(e,t),this.effectPass.setSize(e,t)}set sceneHelpers(e){this.helperPass.setScene(e)}get sceneHelpers(){return this.helperPass.getScene()}set sceneHelpersOnTop(e){this.helperPassOnTop.setScene(e)}get sceneHelpersOnTop(){return this.helperPassOnTop.getScene()}setCamera(e){this.helperPass.setCamera(e),this.helperPassOnTop.setCamera(e)}initialize(e,t,r){super.initialize(e,t,r),this.effectPass.initialize(e,t,r)}dispose(){super.dispose(),this.rt.dispose(),this.effectPass.dispose()}render(e,t,r){this.rt.depthTexture=t.depthTexture;let i=e.getClearAlpha();e.setClearAlpha(0),this.helperPass.clearDepth=!0,this.helperPass.clearColorOnly=!0,this.helperPass.render(e,this.rt),this.helperPassOnTop.render(e,this.rt),this.effectPass.renderToScreen=!1,this.effectPass.render(e,this.rt,r),this.fullscreenMaterial.uniforms.inputBufferA.value=r.texture,this.fullscreenMaterial.uniforms.inputBufferB.value=t.texture,e.setClearAlpha(i),e.setRenderTarget(null),e.clear(),e.render(this.scene,this.camera)}},Oke=`#define GLSLIFY 1
#include <skinning_pars_vertex>
out vec3 n;void main(){
#include <beginnormal_vertex>
#include <skinbase_vertex>
#include <skinnormal_vertex>
#include <defaultnormal_vertex>
#include <begin_vertex>
#include <skinning_vertex>
vec4 view_space=viewMatrix*modelMatrix*vec4(transformed,1.0);gl_Position=projectionMatrix*view_space;n=normalize(transformedNormal);}`,Rke=`#define GLSLIFY 1
in vec3 n;void main(){gl_FragColor=vec4(n,1.0);}`,Ike=`#define GLSLIFY 1
out vec2 v_uv;void main(){v_uv=uv;gl_Position=vec4(position.xy,1.0,1.0);}`,zke=`#define GLSLIFY 1
in vec2 v_uv;const float pi=3.14159265;const float num_steps=4.0;const float num_directions=4.0;uniform float near;uniform float far;uniform float fov;uniform vec4 proj_info;uniform bool is_ortho;uniform vec2 resolution;uniform float radius_of_influence;uniform float radius_in_screen_space;uniform float exponent;uniform vec3 ao_color;uniform float bias;uniform sampler2D texture_depth;uniform sampler2D texture_normals;uniform sampler2D texture_blue_noise;uniform sampler2D texture_blue_noise_in_disk;uniform sampler2D texture_color_pass;uniform int frame_index;uniform bool fog_enabled;uniform float fog_near;uniform float fog_far;vec3 uv_to_view_space(vec2 uv,float eye_z){return vec3((uv*proj_info.xy+proj_info.zw)*(is_ortho ? 1.0 : eye_z),eye_z);}float linearize_depth(float depth_sampled){float z=is_ortho ? depth_sampled : depth_sampled*2.0-1.0;return mix((2.0*near*far)/(far+near-z*(far-near)),near+z*(far-near),float(is_ortho));}vec3 get_view_position(vec2 uv_coords){float linear_depth=linearize_depth(texture(texture_depth,uv_coords).x);return uv_to_view_space(uv_coords,linear_depth);}vec3 min_difference(vec3 p,vec3 right,vec3 left){vec3 v1=right-p;vec3 v2=p-left;return(dot(v1,v1)<dot(v2,v2))? v1 : v2;}vec3 rebuild_normal(in vec2 uv,in vec3 p){vec2 one_over_resolution=1.0/resolution;vec3 r=get_view_position(uv+vec2(one_over_resolution.x,0));vec3 l=get_view_position(uv+vec2(-one_over_resolution.x,0));vec3 t=get_view_position(uv+vec2(0,one_over_resolution.y));vec3 b=get_view_position(uv+vec2(0,-one_over_resolution.y));return normalize(cross(min_difference(p,r,l),min_difference(p,t,b)));}float falloff(float distance_squared){float neg_inv_r2=-1.0/(radius_of_influence*radius_of_influence);return distance_squared*neg_inv_r2+1.0;}float ao_contribution(vec3 P,vec3 N,vec3 S){vec3 to_sample=S-P;float norm_squared=dot(to_sample,to_sample);float norm=sqrt(norm_squared);float cos_theta=dot(N,to_sample)/norm;return clamp(cos_theta-bias,0.0,1.0)*clamp(falloff(norm_squared),0.0,1.0);}float compute_ambient_occlusion(vec2 uv,float radius_in_screen_space,vec3 pc,vec3 view_space_n){vec2 one_over_resolution=1.0/resolution;ivec2 noise_uv=ivec2(int(mod(gl_FragCoord.x,128.0)),int(mod(gl_FragCoord.y,128.0)));float noise=texelFetch(texture_blue_noise,noise_uv,0).r;noise=fract(noise+0.61803398875*float(frame_index));float theta=noise*2.0*3.1415;float ct=cos(theta);float st=sin(theta);float step_size=radius_in_screen_space/(num_steps+1.0);const float angle_step=2.0*pi/num_directions;float contribution=0.0;for(int i=0;i<int(num_directions);++i){float current_pixel=step_size+1.0;for(int j=0;j<int(num_steps);++j){int index=i*int(num_steps)+j;vec2 blue_noise_sample=texelFetch(texture_blue_noise_in_disk,ivec2(index,0),0).rg;vec2 disk_point;disk_point.x=blue_noise_sample.x*ct-blue_noise_sample.y*st;disk_point.y=blue_noise_sample.x*st+blue_noise_sample.y*ct;vec2 sample_direction=disk_point;vec2 snapped_uv=round(current_pixel*sample_direction)*one_over_resolution+uv;vec3 ps=get_view_position(snapped_uv);current_pixel+=step_size;contribution+=ao_contribution(pc,view_space_n,ps);}}float mult=1.0/(1.0-bias);contribution*=mult/(num_directions*num_steps);return clamp(1.0-contribution*2.0,0.0,1.0);}
#define USE_GBUFFER_NORMALS
void main(){vec3 view_space_p=get_view_position(v_uv);
#ifdef USE_GBUFFER_NORMALS
vec3 view_space_n=texture(texture_normals,v_uv).rgb;view_space_n.z*=-1.0;
#else
vec3 view_space_n=-rebuild_normal(v_uv,view_space_p);
#endif
float radius_ss=radius_in_screen_space/(is_ortho ? 1.0 : view_space_p.z);float ao=compute_ambient_occlusion(v_uv,radius_ss,view_space_p,view_space_n);float final=pow(ao,exponent);if(view_space_p.z>=far){final=1.0;}vec3 color=mix(ao_color,vec3(1.0),final);if(fog_enabled){float fog_factor=smoothstep(fog_near,fog_far,view_space_p.z);color=mix(color,vec3(1.0),fog_factor);}gl_FragColor=vec4(color,1.0);}`,kke=`#define GLSLIFY 1
out vec2 v_uv;void main(){gl_Position=vec4(position.xy,1.0,1.0);v_uv=uv;}`,Lke=`#define GLSLIFY 1
in vec2 v_uv;uniform sampler2D texture_ao_lrez;uniform sampler2D texture_depth_lrez;uniform sampler2D texture_depth_hrez;uniform float near;uniform float far;float linearize_depth(float depth_sampled){float z=depth_sampled*2.0-1.0;return(2.0*near*far)/(far+near-z*(far-near));}vec2 nearest_depth_filter(in vec2 uv){vec2 resolution=vec2(textureSize(texture_depth_lrez,0));vec2 texel_size=1.0/resolution;vec2 offset=uv-0.5*texel_size;float d_hrez=texture(texture_depth_hrez,uv).r;float a=abs(d_hrez-texture(texture_depth_lrez,offset).r);float b=abs(d_hrez-texture(texture_depth_lrez,offset+vec2(texel_size.x,0.0)).r);float c=abs(d_hrez-texture(texture_depth_lrez,offset+vec2(0.0,texel_size.y)).r);float d=abs(d_hrez-texture(texture_depth_lrez,offset+vec2(texel_size.x,texel_size.y)).r);float min_diff=min(a,min(b,min(c,d)));if(min_diff==a)return offset;if(min_diff==b)return offset+vec2(texel_size.x,0.0);if(min_diff==c)return offset+vec2(0.0,texel_size.y);if(min_diff==d)return offset+vec2(texel_size.x,texel_size.y);}void main(){
#ifdef DEBUG
float d_lrez=texture(texture_depth_lrez,v_uv).r;float d_hrez=texture(texture_depth_hrez,v_uv).r;float output_d=mix(linearize_depth(d_lrez)/far,linearize_depth(d_hrez)/far,step(0.5,v_uv.x));gl_FragColor=vec4(vec3(output_d),1.0);
#else
vec2 filtered_uv=nearest_depth_filter(v_uv);vec4 ao=texture(texture_ao_lrez,filtered_uv);gl_FragColor=vec4(ao.rgb,1.0);gl_FragColor=ao;
#endif
}`,Um=[[.478712,.875764],[-.337956,-.793959],[-.955259,-.028164],[.864527,.325689],[.209342,-.395657],[-.106779,.672585],[.156213,.235113],[-.413644,-.082856],[-.415667,.323909],[.141896,-.93998],[.954932,-.182516],[-.766184,.410799],[-.434912,-.458845],[.415242,-.078724],[.728335,-.491777],[-.058086,-.066401],[.20299,.686837],[-.808362,-.556402],[.507386,-.640839],[-.723494,-.22924],[.48974,.317826],[-.622663,.765301],[-.01064,.929347],[.663146,.647618],[-.096674,-.413835],[.525945,-.321063],[-.122533,.366019],[.195235,-.687983],[-.563203,.098748],[.418563,.561335],[-.378595,.800367],[.826922,.001024],[-.085372,-.766651],[-.92192,.183673],[-.590008,-.721799],[.167751,-.164393],[.032961,-.56253],[.6329,-.107059],[-.46408,.569669],[-.173676,-.958758],[-.242648,-.234303],[-.275362,.157163],[.382295,-.795131],[.562955,.115562],[.190586,.470121],[.770764,-.297576],[.237281,.93105],[-.666642,-.455871],[-.905649,-.298379],[.33952,.157829],[.701438,-.7041],[-.062758,.160346],[-.220674,.957141],[.642692,.432706],[-.77339,-.015272],[-.671467,.24688],[.158051,.062859],[.806009,.527232],[-.05762,-.247071],[.333436,-.51671],[-.550658,-.315773],[-.652078,.589846],[.008818,.530556],[-.210004,.519896]],Bke=new jr({vertexShader:Oke,fragmentShader:Rke}),df=new jr({vertexShader:kke,fragmentShader:Lke,uniforms:{texture_ao_lrez:new rt(null),texture_depth_lrez:new rt(null),texture_depth_hrez:new rt(null),near:new rt(null),far:new rt(null)}}),Fke=class extends za{constructor(e,t){super("AmbientOcclusionPass",void 0,t),this.fogEnabled=!1,this.fogNear=1,this.fogFar=1e3,this.frameIndex=0,this._runHalfRes=!0,this._width=1,this._height=1;let r=1024,i=1024;this.gBuffer=new Ur(r,i,{type:Qg?ec:on,depthTexture:new gp(r,i),minFilter:ur,magFilter:ur}),this.depthBufferHighRes=new Ur(r,i,{depthTexture:new gp(r,i)}),this.aoBuffer=new Ur(r,i,{minFilter:ur,magFilter:ur}),this.splineScene=e,this.splineCamera=t;let n=new Float32Array(Um.length*2);for(let o=0;o<Um.length;o++){let s=o*2;n[s+0]=Um[o][0],n[s+1]=Um[o][1]}this.blueNoiseInDiskTexture=new Po(n,Um.length,1,sx,on),this.blueNoiseInDiskTexture.wrapS=Hl,this.blueNoiseInDiskTexture.wrapT=Hl,this.blueNoiseInDiskTexture.needsUpdate=!0,this.hbaoMaterial=new jr({vertexShader:Ike,fragmentShader:zke,uniforms:{near:new rt(null),far:new rt(null),fov:new rt(null),proj_info:new rt(new Kt),is_ortho:new rt(!1),resolution:new rt(new ye),radius_of_influence:new rt(8),radius_in_screen_space:new rt(1),exponent:new rt(1),ao_color:new rt(new k),bias:new rt(.5),texture_depth:new rt(null),texture_normals:new rt(null),texture_blue_noise:new rt(null),texture_blue_noise_in_disk:new rt(this.blueNoiseInDiskTexture),frame_index:new rt(0),fog_enabled:new rt(!1),fog_near:new rt(1),fog_far:new rt(1e3)}}),this.radius=128,this.aoColor={r:0,g:0,b:0},this.bias=.5,this.hbaoMaterial.uniforms.texture_depth.value=this.gBuffer.depthTexture,this.hbaoMaterial.uniforms.texture_normals.value=this.gBuffer.texture,this.needsSwap=!0,this.aaBuffer=new Ur(r,i,{minFilter:ur,magFilter:ur,wrapS:Si,wrapT:Si,depthBuffer:!1,type:on});let a=new FH({preset:vu.ULTRA,edgeDetectionMode:mw.COLOR});this.effectPass=new t1(this.camera,a)}initialize(e,t,r){super.initialize(e,t,r),this.effectPass.initialize(e,t,r)}setBlueNoiseTexture(e){this.hbaoMaterial.uniforms.texture_blue_noise.value=e}setSize(e,t){this._width=e,this._height=t,this.depthBufferHighRes.setSize(e,t);let r=this._runHalfRes?.5:1,i=e*r,n=t*r;this.gBuffer.setSize(i,n),this.aoBuffer.setSize(i,n),this.hbaoMaterial.uniforms.resolution.value.set(i,n),this.aaBuffer.setSize(i,n),this.effectPass.setSize(i,n)}get runHalfRes(){return this._runHalfRes}set runHalfRes(e){this._runHalfRes=e,this.setSize(this._width,this._height)}setCamera(e){this.splineCamera=e}setScene(e){this.splineScene=e}setDepthTexture(e){this.depthBufferHighRes.depthTexture=e,df.uniforms.texture_depth_hrez.value=e,df.needsUpdate=!0}render(e,t,r){this.splineScene.overrideMaterial=Bke;let i=this.splineCamera.layers.mask;if(this.splineCamera.layers.set(5),e.setRenderTarget(this.gBuffer),e.clear(),e.render(this.splineScene,this.splineCamera),e.setRenderTarget(this.depthBufferHighRes),e.clear(),e.render(this.splineScene,this.splineCamera),this.splineScene.overrideMaterial=null,this.splineCamera.layers.mask=i,this.hbaoMaterial.uniforms.radius_of_influence.value=this.radius,this.hbaoMaterial.uniforms.ao_color.value.set(this.aoColor.r,this.aoColor.g,this.aoColor.b),this.hbaoMaterial.uniforms.bias.value=this.bias,this.hbaoMaterial.uniforms.fog_enabled.value=this.fogEnabled,this.hbaoMaterial.uniforms.fog_near.value=this.fogNear,this.hbaoMaterial.uniforms.fog_far.value=this.fogFar,this.hbaoMaterial.uniforms.frame_index.value=this.frameIndex,this.frameIndex++,this.splineCamera.isPerspectiveCamera){this.hbaoMaterial.uniforms.near.value=this.splineCamera.perspCamera.near,this.hbaoMaterial.uniforms.far.value=this.splineCamera.perspCamera.far;let n=this.splineCamera.perspCamera.projectionMatrix.elements,a=2/n[0],o=2/n[5],s=-(1-n[8])/n[0],l=-(1+n[9])/n[5];this.hbaoMaterial.uniforms.proj_info.value.set(a,o,s,l);let c=this.splineCamera.perspCamera.fov*(Math.PI/180),d=this.hbaoMaterial.uniforms.resolution.value.y/(Math.tan(c*.5)*2),u=this.hbaoMaterial.uniforms.radius_of_influence.value*.5*d;this.hbaoMaterial.uniforms.radius_in_screen_space.value=u,this.hbaoMaterial.uniforms.is_ortho.value=!1}else{this.hbaoMaterial.uniforms.near.value=this.splineCamera.orthoCamera.near,this.hbaoMaterial.uniforms.far.value=this.splineCamera.orthoCamera.far;let n=this.splineCamera.orthoCamera.projectionMatrix.elements,a=2/n[0],o=2/n[5],s=-(1+n[12])/n[0],l=-(1-n[13])/n[5];this.hbaoMaterial.uniforms.proj_info.value.set(a,o,s,l);let c=.5*(this.hbaoMaterial.uniforms.resolution.value.y/o),d=this.hbaoMaterial.uniforms.radius_of_influence.value*c;this.hbaoMaterial.uniforms.radius_in_screen_space.value=d,this.hbaoMaterial.uniforms.is_ortho.value=!0}this.runHalfRes?(this.fullscreenMaterial=this.hbaoMaterial,e.setRenderTarget(this.aoBuffer),e.clear(),e.render(this.scene,this.camera),this.fullscreenMaterial=df,df.uniforms.texture_ao_lrez.value=this.aoBuffer.texture,df.uniforms.texture_depth_lrez.value=this.gBuffer.depthTexture,df.uniforms.texture_depth_hrez.value=this.depthBufferHighRes.depthTexture,e.setRenderTarget(e.aoRenderTarget),e.clear(),e.render(this.scene,this.camera)):(this.fullscreenMaterial=this.hbaoMaterial,e.setRenderTarget(this.aaBuffer),e.clear(),e.render(this.scene,this.camera),this.effectPass.renderToScreen=!1,this.effectPass.render(e,this.aaBuffer,e.aoRenderTarget))}dispose(){this.gBuffer.dispose(),this.depthBufferHighRes.dispose(),this.aoBuffer.dispose()}},Nke=`
varying vec2 vUv;
void main() {
    vUv = uv;
    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,Uke=`
uniform sampler2D tInput;
uniform sampler2D tMap;
uniform vec2 resolution;
varying vec2 vUv;

uniform vec2 uResolution;
uniform vec2 uCoords;

// Draws a rectangle at center <st> with size <size>
float rectangle(vec2 st, vec2 size) {
    size = vec2(0.5) - size * 0.5;
    vec2 uv = vec2(step(size.x, st.x), step(size.y, st.y));
    uv *= vec2(step(size.x, 1.0 - st.x), step(size.y, 1.0 - st.y));

    return uv.x * uv.y;
}

uniform vec2 uSize;
uniform float uScale;
uniform float uDPR;
uniform float uCurrent;
uniform vec3 uSceneColor;

void main() {
    vec2 screenUv = gl_FragCoord.xy / uResolution.xy;
    screenUv *= 1.0 / uDPR;

    vec2 center = vec2(0.5, -0.5);
    vec2 outsideUv = screenUv;
    outsideUv += center;
    outsideUv -= uCoords.xy / uResolution.xy;
    outsideUv = (outsideUv - 0.5) + 0.5;
    outsideUv -= center;
    vec2 s = (uSize / uResolution) * uScale;
    float isOutside = 1.0 - rectangle(outsideUv, s);
    
    vec2 mid = vec2(0.5);
    vec2 insideUv = (screenUv - mid + s * mid) / s;
    vec4 background = texture2D(tInput, screenUv);
    vec4 image = texture2D(tMap, insideUv);
    gl_FragColor = mix(image, background, isOutside);
}
`,jke=class extends Zo{constructor(){super(new jr({vertexShader:Nke,fragmentShader:Uke,uniforms:{tInput:new rt(null),tMap:new rt(null),uResolution:new rt(new ye),uSize:new rt(new ye),uCoords:new rt(new ye),uScale:new rt(1),uSceneColor:new rt(new Lt(16711680)),uDPR:new rt(1),uCurrent:new rt(0)}}),"tInput"),this.needsSwap=!0}get uniforms(){return this.fullscreenMaterial.uniforms}get texture(){return this.uniforms.tMap.value}set texture(e){this.uniforms.tMap.value=e}},Vke=`
void main() {
    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,Hke=`
uniform sampler2D toScene;
uniform sampler2D fromScene;
uniform vec2 resolution;

uniform vec2 uResolution;
uniform float uDPR;

uniform float mixRatio;
uniform sampler2D tMixTexture;
uniform int useTexture;
uniform float threshold;

void main() {
	vec2 screenUv = gl_FragCoord.xy / uResolution.xy;
	screenUv *= 1.0 / uDPR;

	vec4 texel1 = texture2D( fromScene, screenUv );
	vec4 texel2 = texture2D( toScene, screenUv );

	if (useTexture==1) {
		
		vec4 transitionTexel = texture2D( tMixTexture, screenUv );
		float r = mixRatio * (1.0 + threshold * 2.0) - threshold;
		float mixf=clamp((transitionTexel.r - r)*(1.0/threshold), 0.0, 1.0);
		
		gl_FragColor = mix( texel1, texel2, mixf );
	} else {
		
		gl_FragColor = mix( texel1, texel2, mixRatio );
		
	}
}
`,Wke=[],Gke=class extends Zo{constructor(){super(new jr({vertexShader:Vke,fragmentShader:Hke,uniforms:{toScene:new rt(null),fromScene:new rt(null),uResolution:new rt(new ye),uDPR:new rt(1),mixRatio:new rt(0),threshold:new rt(.1),useTexture:new rt(0),tMixTexture:{value:Wke[0]}}}),"toScene"),this.needsSwap=!0}get uniforms(){return this.fullscreenMaterial.uniforms}get texture(){return this.uniforms.fromScene.value}set texture(e){this.uniforms.fromScene.value=e}},$ke=`
void main() {
    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,qke=`
uniform sampler2D inputBuffer;
uniform sampler2D blurredInputBuffer;
uniform sampler2D overlay;
uniform float blurIntensity;

uniform vec2 uResolution;
uniform float uDPR;

void main() {
	vec2 screenUv = gl_FragCoord.xy / uResolution.xy;
	screenUv *= 1.0 / uDPR;

	vec4 texel1 = texture2D( overlay, screenUv );
	vec4 texel2 = texture2D( inputBuffer, screenUv );
	vec4 texel3 = texture2D( blurredInputBuffer, screenUv );

	float blurMask2 = max(sign(texel1.a), 0.0) * blurIntensity;
    gl_FragColor = mix( mix(texel2, texel3, blurMask2), texel1, texel1.a );
}
`,Yke=class extends Zo{constructor(){super(new jr({vertexShader:$ke,fragmentShader:qke,uniforms:{inputBuffer:new rt(null),blurredInputBuffer:new rt(null),overlay:new rt(null),uResolution:new rt(new ye),uDPR:new rt(1),blurIntensity:new rt(0)}})),this._blurEnabled=!1,this.blurTarget=new Ur(1,1,{minFilter:ur,magFilter:ur,wrapS:Si,wrapT:Si}),this.blurPass=new uD({width:window.innerWidth,height:window.innerHeight,kernelSize:vw.HUGE,resolutionScale:.25}),this.blurPass.renderToScreen=!1,this.uniforms.blurredInputBuffer.value=this.blurTarget.texture}get uniforms(){return this.fullscreenMaterial.uniforms}get texture(){return this.uniforms.overlay.value}set texture(e){this.uniforms.overlay.value=e}setResolution(e,t,r=1){this.uniforms.uResolution.value.set(e,t),this.uniforms.uDPR.value=r,this.blurPass.setSize(e,t),this.blurTarget.setSize(e,t),this.blurPass.setSize(e,t)}get uiCanvas(){return this._uiCanvas}set uiCanvas(e){this._uiCanvas=e,e.texture&&(this.uniforms.overlay.value=e.texture);let t=e.frame;if(t){let r=t.data.backgroundBlur,i=r.radius;this._blurEnabled=r.enabled,this.uniforms.blurIntensity.value=this._blurEnabled?1:0,this.blurPass.scale=i/3}}render(e,t,r,i,n){this._blurEnabled&&(this.blurPass.setDepthTexture(this.getDepthTexture()),this.blurPass.render(e,t,this.blurTarget,i,n)),super.render(e,t,r,i,n)}};function FB(e,t){return t&&t.enabled&&e.push(t.effect),e}var Xke=e=>Object.values(Tr).includes(e)?e:Tr.NORMAL,Kke=class extends aa{constructor(e,t){super(),this._needsDOFResize=t,this.postprocessingState=Ux.defaultData,this._scene=new Js,this._camera=new va,this.effects=new Map,this.blueNoiseTexture=new Po,this._renderToScreen=!0,this._isUIOverlayEnabled=!1,this.clock=new L1e,this.renderer=e,this.debug=!1,this.effects.set("bloom",new hke),this.effects.set("chromaticAberration",new pke),this.effects.set("vignette",new yke),this.effects.set("noise",new gke),this.effects.set("colorAverage",new mke),this.effects.set("hueSaturation",new vke),this.effects.set("brightnessContrast",new fke),this.effects.set("depthOfField",new bke),this.effects.set("pixelation",new xke),this.effectComposer=new Tke(this.renderer),this.effectComposer.autoRenderToScreen=!1,this.opaquePass=new oE(!0,this.scene,this.camera),this.opaquePass.clear=!0,this.transmissionPass=new Mke(this.scene,this.camera,this.renderer),this.aoPass=new Fke(this.scene,this.camera),this.taaPass=new Ake,this.taaPass.renderToScreen=!1,this.helperPass=new Dke(this.camera),this.helperPass.renderToScreen=!1,this.stylesOverlayPass=new jke,this.stylesOverlayPass.enabled=!1,this.uiOverlayPass=new Yke,this.uiOverlayPass.enabled=!1,this.sceneTransitionPass=new Gke,this.sceneTransitionPass.enabled=!1,this._initCopyPass(),this._initPasses()}set overlayTexture(e){e!==void 0?(this.stylesOverlayPass.texture=e,this.stylesOverlayPass.enabled=!0):this.stylesOverlayPass.enabled=!1}get overlayTexture(){return this.stylesOverlayPass.texture}set sceneHelpers(e){this.helperPass.sceneHelpers=e}get sceneHelpers(){return this.helperPass.sceneHelpers}set sceneHelpersOnTop(e){this.helperPass.sceneHelpersOnTop=e}get sceneHelpersOnTop(){return this.helperPass.sceneHelpersOnTop}get scene(){return this._scene}set scene(e){this._scene=e,this.opaquePass.setScene(e),this.transmissionPass.setScene(e),this.aoPass.setScene(e)}get camera(){return this._camera}set camera(e){let t=this._camera!==e;this._camera=e,this.opaquePass.setCamera(e),this.transmissionPass.setCamera(e),t&&this.transmissionPass.updatePasses(this.renderer),this.aoPass.setCamera(e),this.helperPass.setCamera(e),this.effects.get("depthOfField").setCamera(e)}updateRenderToScreen(){let e=!1;for(let t=this.effectComposer.passes.length-1;t>=0;t--){let r=this.effectComposer.passes[t];if(r.enabled===!0&&!e&&this._renderToScreen){r.renderToScreen=!0,e=!0;continue}r.renderToScreen=!1}}get isUIOverlayEnabled(){return this._isUIOverlayEnabled}disableUIOverlay(){this._isUIOverlayEnabled=!1}enableUIOverlay(){this._isUIOverlayEnabled=!0}disableHelpers(){this.helperPass.enabled=!1,this.updateRenderToScreen()}enableHelpers(){this.helperPass.enabled=!0,this.updateRenderToScreen()}updateBlueNoiseTexture(e){this.blueNoiseTexture=new Po(e,128,128),this.blueNoiseTexture.wrapS=Hl,this.blueNoiseTexture.wrapT=Hl,this.blueNoiseTexture.minFilter=Hr,this.blueNoiseTexture.magFilter=Hr,this.blueNoiseTexture.needsUpdate=!0}setAmbientOcclusionParams(e,t,r,i,n,a,o,s){this.aoPass.enabled=e,this.aoPass.radius=t,this.aoPass.bias=r,this.aoPass.aoColor=i,this.aoPass.fogEnabled=n,this.aoPass.fogNear=a,this.aoPass.fogFar=o,this.aoPass.runHalfRes!==!s&&(this.aoPass.runHalfRes=!s)}setTransmissionPassEnabled(e){this.transmissionPass.enabled=e,this.opaquePass.hasTransmissionPass=e}_initPasses(){var e,t,r;if((e=this.uvEffectPass)==null||e.dispose(),(t=this.effectPass)==null||t.dispose(),this.effectComposer.removeAllPasses(),this.transmissionPass.updatePasses(this.renderer),this.effectComposer.addPass(this.aoPass),this.effectComposer.addPass(this.opaquePass),this.effectComposer.addPass(this.transmissionPass),this.effectComposer.addPass(this.taaPass),this.postprocessingState.enabled){let i=[this.effects.get("pixelation")].reduce(FB,[]);i.length>0&&(this.uvEffectPass=new t1(this.camera,...i),this.uvEffectPass.renderToScreen=!1,this.effectComposer.addPass(this.uvEffectPass));let n=[this.effects.get("chromaticAberration"),this.effects.get("bloom"),this.effects.get("depthOfField"),this.effects.get("colorAverage"),this.effects.get("hueSaturation"),this.effects.get("brightnessContrast"),this.effects.get("vignette"),this.effects.get("noise")].reduce(FB,[]);if(n.length>0&&(this.effectPass=new t1(this.camera,...n),this.effectPass.renderToScreen=!1,this.effectComposer.addPass(this.effectPass),this._needsDOFResize&&((r=this.effects.get("depthOfField"))==null?void 0:r.enabled)&&window!==void 0)){let a=this.renderer.viewportWidth,o=this.renderer.viewportHeight;this.renderer.setSize(a-1,o-1),this.renderer.setSize(a,o)}}this.effectComposer.addPass(this.stylesOverlayPass),this.effectComposer.addPass(this.uiOverlayPass),this.effectComposer.addPass(this.sceneTransitionPass),this.effectComposer.addPass(this.helperPass)}_initCopyPass(){if(this._savePass)return;let e=new ye;this.renderer.getDrawingBufferSize(e),this._rt=new Ur(e.x,e.y,{depthBuffer:!1,stencilBuffer:!1,wrapS:Hl,wrapT:Hl}),this._rt.samples=0,this._savePass=new nE(this._rt,!1),this._savePass.renderToScreen=!1}setCopyPass(e){this._rt=e,this._savePass=new nE(this._rt,!1),this.renderToScreen=!1}get renderToScreen(){return this._renderToScreen}set renderToScreen(e){if(this._renderToScreen===e)return;let t=this.effectComposer;!t||(e===!0?t.removePass(this._savePass):t.addPass(this._savePass),this._renderToScreen=e,this.updateRenderToScreen())}set sceneTransitionFromTexture(e){e!==this.sceneTransitionPass.texture&&(e!==null?this.sceneTransitionPass.enabled=!0:(this.sceneTransitionPass.enabled=!1,this.updateRenderToScreen()),this.sceneTransitionPass.texture=e)}get texture(){return this._rt&&this._rt.texture}get renderTarget(){return this._rt}updatePostprocessing(e){let{enabled:t,...r}=e,i=!1;t!==this.postprocessingState.enabled&&(i=!0);for(let n of Object.entries(r)){let a=n[1],o=this.effects.get(n[0]);if(o){o.enabled!==a.enabled&&(i=!0),o.enabled=a.enabled;for(let[s,l]of Object.entries(a))s==="blendFunction"?o.blendFunction=Xke(l):o[s]=l}}this.postprocessingState=e,i&&this._initPasses()}render(){this.effectComposer.render(this.clock.getDelta())}setScissor(e,t,r,i){e instanceof Kt?(this.effectComposer.inputBuffer.scissor.set(e.x,e.y,e.z,e.w),this.effectComposer.outputBuffer.scissor.set(e.x,e.y,e.z,e.w)):(this.effectComposer.inputBuffer.scissor.set(e,t,r,i),this.effectComposer.outputBuffer.scissor.set(e,t,r,i));let n=this.renderer.getPixelRatio();this.effectComposer.inputBuffer.scissor.multiplyScalar(n),this.effectComposer.outputBuffer.scissor.multiplyScalar(n),this.renderer.setScissor(e,t,r,i)}setScissorTest(e){this.effectComposer.inputBuffer.scissorTest=e,this.effectComposer.outputBuffer.scissorTest=e,this.renderer.setScissorTest(e)}setViewport(e,t,r,i){e instanceof Kt?(this.effectComposer.inputBuffer.viewport.copy(e),this.effectComposer.outputBuffer.viewport.copy(e)):(this.effectComposer.inputBuffer.viewport.set(e,t,r,i),this.effectComposer.outputBuffer.viewport.set(e,t,r,i))}resize(e,t,r){if(this.effectComposer.setSize(e,t,r),this._rt){let i=this.renderer.getPixelRatio();this._rt.setSize(e*i,t*i)}}dispose(){var e,t;(e=this.uvEffectPass)==null||e.dispose(),(t=this.effectPass)==null||t.dispose(),this.effectComposer.dispose()}},Qke=e=>`

// PCSS implementation based on:
// https://www.gamedev.net/articles/programming/graphics/contact-hardening-soft-shadows-made-fast-r4906/
// NOTE: This number affects how big the shadow blur can
// possibly get. Bigger number == bigger blur, but less precise results

const float  gPenumbraFilterSize = 80.0;
const int   gPenumbraSamples = ${e};
const int gShadowSamples = ${e};
const float gShadowSamplesRpc = 1.0f / float(gShadowSamples);

#ifdef USE_SHADOWMAP
    #if NUM_DIR_LIGHT_SHADOWS > 0

        uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
        varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];

        struct DirectionalLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
        };

        uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];

    #endif

    #if NUM_SPOT_LIGHT_SHADOWS > 0

        uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
        varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_SHADOWS ];

        struct SpotLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
        };

        uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];

    #endif

    #if NUM_POINT_LIGHT_SHADOWS > 0

        uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
        varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];

        struct PointLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
            float shadowCameraNear;
            float shadowCameraFar;
        };

        uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];

    #endif

    /*
    #if NUM_RECT_AREA_LIGHTS > 0

        // TODO (abelnation): create uniforms for area light shadows

    #endif
    */

float computePenumbra(int index, sampler2D shadowMap, float temporalAngle, float texelSize, vec2 uv, float compare, float texelScalar, float shadowRadius)
{
    float penumbra = 1.0;
    float blockerDepthAvg = 0.0;
    float blockerCount = 0.0;

    #pragma unroll_loop_start
    for(int i = 0; i < gPenumbraSamples; i ++)
    {
        vec2 offset = (vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize) * texelScalar;
        float depth = unpackRGBAToDepth( texture2D( shadowMap, uv + offset ) );

        if(depth < compare + 0.0001)
        {
            blockerDepthAvg += depth;
            blockerCount++;
        }
    }
    #pragma unroll_loop_end

    if (blockerCount > 0.0)
    {
        blockerDepthAvg /= blockerCount;

        // Compute penumbra
        penumbra = (compare - blockerDepthAvg) / (blockerDepthAvg);
        penumbra *= penumbra;
        penumbra *= 200.0 * penumbraSize[min(index, 5 - 1)]; // Magic number that affects how quickly the penumbra grows

        return clamp(penumbra, 0.00, 1.0);
    }
    return 0.0;
}

float vogelShadow(int index, sampler2D shadowMap, vec2 uv, float texelSize, float compare, float shadowRadius)
{
    float shadow         = 0.0f;

    // NOTE: When using TAA, we should use screen space interleaved gradient noise
    vec2 halton = haltonSequence[frameIndex];
    float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
    float temporalAngle  = temporalOffset * PI2;

    float texelScalar = (gPenumbraFilterSize) / (texelSize * 1024.);
    float penumbra = computePenumbra(index, shadowMap, temporalAngle, texelSize, uv, compare, texelScalar, shadowRadius);
    if (penumbra == -1.0) {
        return 1.0;
    }

    #pragma unroll_loop_start
    for (int i = 0; i < gShadowSamples; i++)
    {
        vec2 vogelSample =  vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;
        // Overall blurring offset
        vec2 offset = vogelSample * (shadowRadius * 2.);

        // Penumbra offset
        offset += vogelSample * (penumbra * texelScalar);

        shadow += step( compare, unpackRGBAToDepth( texture2D( shadowMap, uv + offset ) ) );
    }
    #pragma unroll_loop_end

    return shadow * gShadowSamplesRpc;
}


    float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {

        return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );

    }

    vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {

        return unpackRGBATo2Half( texture2D( shadow, uv ) );

    }

    float VSMShadow (sampler2D shadow, vec2 uv, float compare ){

        float occlusion = 1.0;

        vec2 distribution = texture2DDistribution( shadow, uv );

        float hard_shadow = step( compare , distribution.x ); // Hard Shadow

        if (hard_shadow != 1.0 ) {

            float distance = compare - distribution.x ;
            float variance = max( 0.00000, distribution.y * distribution.y );
            float softness_probability = variance / (variance + distance * distance ); // Chebeyshevs inequality
            softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 ); // 0.3 reduces light bleed
            occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );

        }
        return occlusion;

    }

    float getShadow( int i, sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {

        float shadow = 1.0;

        shadowCoord.xyz /= shadowCoord.w;
        shadowCoord.z += shadowBias;

        // if ( something && something ) breaks ATI OpenGL shader compiler
        // if ( all( something, something ) ) using this instead

        bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
        bool inFrustum = all( inFrustumVec );

        bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );

        bool frustumTest = all( frustumTestVec );

        if ( frustumTest ) {

        #if defined( SHADOWMAP_TYPE_PCF )

            vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
            return vogelShadow(i, shadowMap, shadowCoord.xy, texelSize.x, shadowCoord.z, shadowRadius );

        #elif defined( SHADOWMAP_TYPE_PCF_SOFT )

            vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
            float dx = texelSize.x;
            float dy = texelSize.y;

            vec2 uv = shadowCoord.xy;
            vec2 f = fract( uv * shadowMapSize + 0.5 );
            uv -= f * texelSize;

            shadow = (
                texture2DCompare( shadowMap, uv, shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
                mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
                     f.x ) +
                mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
                     f.x ) +
                mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
                     f.y ) +
                mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
                     f.y ) +
                mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
                          texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
                          f.x ),
                     mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
                          texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
                          f.x ),
                     f.y )
            ) * ( 1.0 / 9.0 );

        #elif defined( SHADOWMAP_TYPE_VSM )

            shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );

        #else // no percentage-closer filtering:

            shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );

        #endif

        }

        return shadow;

    }

    // cubeToUV() maps a 3D direction vector suitable for cube texture mapping to a 2D
    // vector suitable for 2D texture mapping. This code uses the following layout for the
    // 2D texture:
    //
    // xzXZ
    //  y Y
    //
    // Y - Positive y direction
    // y - Negative y direction
    // X - Positive x direction
    // x - Negative x direction
    // Z - Positive z direction
    // z - Negative z direction
    //
    // Source and test bed:
    // https://gist.github.com/tschw/da10c43c467ce8afd0c4

    vec2 cubeToUV( vec3 v, float texelSizeY ) {

        // Number of texels to avoid at the edge of each square

        vec3 absV = abs( v );

        // Intersect unit cube

        float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
        absV *= scaleToCube;

        // Apply scale to avoid seams

        // two texels less per square (one texel will do for NEAREST)
        v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );

        // Unwrap

        // space: -1 ... 1 range for each square
        //
        // #X##         dim    := ( 4 , 2 )
        //  # #         center := ( 1 , 1 )

        vec2 planar = v.xy;

        float almostATexel = 1.5 * texelSizeY;
        float almostOne = 1.0 - almostATexel;

        if ( absV.z >= almostOne ) {

            if ( v.z > 0.0 )
                planar.x = 4.0 - v.x;

        } else if ( absV.x >= almostOne ) {

            float signX = sign( v.x );
            planar.x = v.z * signX + 2.0 * signX;

        } else if ( absV.y >= almostOne ) {

            float signY = sign( v.y );
            planar.x = v.x + 2.0 * signY + 2.0;
            planar.y = v.z * signY - 2.0;

        }

        // Transform to UV space

        // scale := 0.5 / dim
        // translate := ( center + 0.5 ) / dim
        return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );

    }

    float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {

        float shadow = 1.0;
        vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );

        // for point lights, the uniform @vShadowCoord is re-purposed to hold
        // the vector from the light to the world-space position of the fragment.
        vec3 lightToPosition = shadowCoord.xyz;

        // dp = normalized distance from light to fragment position
        float compare = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear ); // need to clamp?
        compare += shadowBias;

        // bd3D = base direction 3D
        vec3 bd3D = normalize( lightToPosition );

        vec2 halton = haltonSequence[frameIndex];
        float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
        float temporalAngle  = temporalOffset * PI2;

        #if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_VSM )
            for (int i = 0; i < gShadowSamples; i++) {
                vec2 vogelSample = vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;

                // Overall blurring offset
                vec3 offset = vec3(vogelSample.x, vogelSample.y, -vogelSample.x) * (shadowRadius + 5.);

                // NOTE: Removed for now
                // Penumbra offset
                //offset += vec3(vogelSample.x, vogelSample.y, vogelSample.y)  * (penumbra * gPenumbraFilterSize);

                shadow += texture2DCompare( shadowMap, cubeToUV( bd3D + offset, texelSize.y ), compare );

            }
            return shadow * gShadowSamplesRpc;

        #elif defined( SHADOWMAP_TYPE_PCF_SOFT )
            for (int i = 0; i < 16; i++) {
                vec2 vogelSample = vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;

                // Overall blurring offset
                vec3 offset = vec3(vogelSample.x, vogelSample.y, -vogelSample.x) * (shadowRadius + 5.);

                shadow += texture2DCompare( shadowMap, cubeToUV( bd3D + offset, texelSize.y ), compare );

            }
            return shadow * (1.0 / 16.0);
        #else // no percentage-closer filtering

            return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), compare );

        #endif

    }

#endif
`,Zke=lr.lights_fragment_begin,Jke=lr.shadowmask_pars_fragment,NB=null,eLe=e=>{switch(e){case"low":return 8;case"medium":return 16;case"high":return 32;default:return 16}},tLe=(e="medium")=>{if(NB===e)return!1;NB=e;let t=eLe(e);lr.shadowmap_pars_fragment=Qke(t);let r=Zke.slice();r=r.replace("getShadow( spotShadowMap[ i ]","getShadow( UNROLLED_LOOP_INDEX + 3, spotShadowMap[ i ]"),r=r.replace("getShadow( directionalShadowMap[ i ]","getShadow( UNROLLED_LOOP_INDEX, directionalShadowMap[ i ]"),lr.lights_fragment_begin=r;let i=Jke.slice();return i=i.replaceAll("getShadow(","getShadow( UNROLLED_LOOP_INDEX, "),lr.shadowmask_pars_fragment=i,!0},rLe=`
attribute vec3 randomColor;
varying vec3 vNormal;
flat out vec3 vColor;
#include <skinning_pars_vertex>

void main()
{
#include <beginnormal_vertex>
#include <skinbase_vertex>
#include <skinnormal_vertex>
vec3 transformed = vec3(position);
#include <skinning_vertex>

vNormal = normal;
vColor = randomColor;
gl_Position = projectionMatrix * (modelViewMatrix * vec4(transformed, 1.0));
}
`,iLe=`
uniform float depthContrast;
varying vec3 vNormal;
flat in vec3 vColor;
void main()
{
vec3 normal = (normalize(vNormal)).rgb;

float contrastDepth = (gl_FragCoord.z - 0.5) * depthContrast + 0.5;

vec3 resultColor = mix(mix(vColor, normal, 0.2), vec3(contrastDepth), 0.4);
gl_FragColor = vec4(resultColor, vColor.r);
gl_FragColor = vec4(resultColor, vColor.r);
}
`,i_=new jr({vertexShader:rLe,fragmentShader:iLe,uniforms:{depthContrast:{value:1}}}),UB=new Oi,nLe=new ye,aLe=class extends Cj{constructor(e){super(e),this._pixelRatio=this.getPixelRatio(),this.viewportWidth=1,this.viewportHeight=1,this.resolution=new ye,this.dummyCamera=new va,this.sceneTransitionDuration=0,this.sceneTransitionTimeRemaining=-1,this.isXRCopyPassSet=!1,this.clear=(n=!0,a=!0,o=!0)=>{let s=this.getContext(),l=0;n&&(l|=s.COLOR_BUFFER_BIT),a&&(l|=s.DEPTH_BUFFER_BIT),o&&(l|=s.STENCIL_BUFFER_BIT),s.clear(l),s.clearBufferfv(s.COLOR,1,[0,0,0,1])},this.pipeline=new Kke(this,(e==null?void 0:e.needsDOFResize)??!1),this.autoClear=!1;let t=this.setPixelRatio.bind(this),r=this.setSize.bind(this);this.shadowMap.enabled=!0,this.shadowMap.type=KT,this.dummyCamera.matrixAutoUpdate=!1,this.domElement.removeAttribute("data-engine");let i=this.getContext();if(i&&"drawingBufferColorSpace"in i)try{i.drawingBufferColorSpace="display-p3"}catch(n){console.warn(n)}this.setPixelRatio=n=>{this._pixelRatio!==n&&(this._pixelRatio=n,t(n))},this.setSize=(n,a,o=!0)=>{var s,l;(this.viewportWidth!==n||this.viewportHeight!==a)&&(this.viewportWidth=n,this.viewportHeight=a,r(n,a,o),(s=this.normalRenderTarget)==null||s.setSize(n*this._pixelRatio,a*this._pixelRatio),this._resizeTransmission(n,a),(l=this.transmissionDepthTarget)==null||l.setSize(n*this._pixelRatio/2,a*this._pixelRatio/2),this.pipeline.resize(n,a,o))},this._superDispose=this.dispose,this.dispose=this._currentDispose}createAORenderTarget(){this.aoRenderTarget===void 0&&(this.aoRenderTarget=new Ur(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio,{generateMipmaps:!1,minFilter:ur,magFilter:ur,wrapS:Si,wrapT:Si,depthBuffer:!1}))}_resizeTransmission(e,t){var r,i;(r=this.transmissionRenderTarget)==null||r.setSize(e*this._pixelRatio/(this.hdTransmission?1:2),t*this._pixelRatio/(this.hdTransmission?1:2)),(i=this.aoRenderTarget)==null||i.setSize(e*this._pixelRatio/1,t*this._pixelRatio/1)}get hdTransmission(){return jt.transmissionLod.value===1}set hdTransmission(e){jt.transmissionLod.value=e===!0?1:2,this._resizeTransmission(this.viewportWidth,this.viewportHeight)}createTransmissionRenderTarget(){this.transmissionRenderTarget===void 0&&(this.transmissionRenderTarget=new Ur(this.viewportWidth*this._pixelRatio/(this.hdTransmission?1:2),this.viewportHeight*this._pixelRatio/(this.hdTransmission?1:2),{generateMipmaps:!0,minFilter:mp,magFilter:ur,wrapS:Si,wrapT:Si,depthBuffer:!1}),this.transmissionDepthTarget=new Ur(this.viewportWidth*this._pixelRatio/2,this.viewportHeight*this._pixelRatio/2,{minFilter:Hr,magFilter:Hr,depthBuffer:!1}))}createNormalRenderTarget(){this.normalRenderTarget===void 0&&(this.normalRenderTarget=new Ur(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio,{generateMipmaps:!1,minFilter:Hr,magFilter:Hr,type:on,depthTexture:new gp(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio)}))}renderNormal(e,t,r){this.normalRenderTarget&&(this.setClearColor(0),r.layers.enable(8),r.layers.disable(0),r.layers.disable(3),t.traverseEntity(i=>{i.layers.isEnabled(8)&&(i.copyPreviousMatrix=!1)}),this.setRenderTarget(this.normalRenderTarget),this.clear(),r instanceof va?i_.uniforms.depthContrast.value=(r.far-r.near)/1e4:i_.uniforms.depthContrast.value=1,t.overrideMaterial=i_,this.render(t,r),this.setClearColor(t.bgColor,t.bgColor.a),this.setRenderTarget(null),t.overrideMaterial=e.wireframeState?fE:null,r.layers.enable(0),r.layers.enable(3),t.traverseEntity(i=>{i.layers.isEnabled(8)&&(i.copyPreviousMatrix=!0)}))}renderSplineSceneWithDummyCamera(e,t,r=1){this.dummyCamera.updateCameraState(t.dataPatched),this.dummyCamera.matrix.copy(t.matrixWorld);let i=t.height,n=t.width,a=this.viewportWidth/this.viewportHeight;n<i?n=i*a:i=n/a,this.dummyCamera.setViewplaneSize(n,i);for(let o=0;o<r;o++)this.renderSplineScene(e,this.dummyCamera)}renderSplineScene(e,t,{sceneHelpers:r=this.sceneHelpers,sceneHelpersOnTop:i=this.sceneHelpersOnTop,overrideTransmission:n=void 0,overrideNormal:a=void 0}={}){var h;let o=e instanceof bD?e.activePage:e,s=o.visible;o.visible=!0;let l=o.scene;this.xr.enabled&&(this.isXRCopyPassSet===!1&&this.getRenderTarget()!==null&&(this.pipeline.setCopyPass(this.getRenderTarget()),this.isXRCopyPassSet=!0),this.xr.updateCamera(t)),this.setClearColor(o.bgColor,o.bgColor.a),o.penumbraSizeArray.forEach((f,p)=>{jt.penumbraSize.value[p]=f}),jt.pixelRatioNode.value=this.getPixelRatio(),this.resolution.x!==0&&this.resolution.y!==0?jt.resolution.value.set(this.resolution.x,this.resolution.y):jt.resolution.value.set(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio),a!==void 0?(jt.normalRenderTarget.value=a,jt.normalRenderTargetDepth.value=UB):l.needsNormal()&&(this.createNormalRenderTarget(),jt.normalRenderTarget.value=this.normalRenderTarget.texture,jt.normalRenderTargetDepth.value=this.normalRenderTarget.depthTexture,this.renderNormal(l,o,t));let c=o.data.ao,d=c.occlusion;if(d&&(this.createAORenderTarget(),jt.aoRenderTarget.value=this.aoRenderTarget.texture),jt.aoEnabled.value=d,this.pipeline.setAmbientOcclusionParams(c.occlusion,c.radius,c.bias,o.aoColor,o.fog!==null,o.backupFog.near,o.backupFog.far,c.aoFullRes&&!Qg),this.pipeline.aoPass.setBlueNoiseTexture(this.pipeline.blueNoiseTexture),this.pipeline.isUIOverlayEnabled&&((h=o.uiCanvas)==null?void 0:h.enabled)&&o.uiCanvas.texture&&o.uiCanvas.texture.image.width>0){let f=this.getSize(nLe),p=this.getPixelRatio();(o.uiCanvas.width!==this.viewportWidth||o.uiCanvas.height!==this.viewportHeight||o.uiCanvas.dpr!==p)&&o.uiCanvas.applySize({width:this.viewportWidth,height:this.viewportHeight},p),o.uiCanvas.render(this),this.pipeline.uiOverlayPass.uiCanvas=o.uiCanvas,this.pipeline.uiOverlayPass.enabled=!0,this.pipeline.uiOverlayPass.setResolution(f.x,f.y,p),this.pipeline.updateRenderToScreen()}else this.pipeline.uiOverlayPass.enabled=!1,this.pipeline.updateRenderToScreen();let u=!1;if(n!==void 0)jt.transmissionRenderTarget.value=n,jt.transmissionRenderTargetDepth.value=UB,this.pipeline.setTransmissionPassEnabled(!1);else{let f=l.needsTransmission();f&&(this.transmissionRenderTarget===void 0&&(u=!0),this.createTransmissionRenderTarget(),jt.transmissionRenderTarget.value=this.transmissionRenderTarget.texture,jt.aspectRatio.value=QOe(this.viewportWidth,this.viewportHeight),jt.transmissionRenderTargetDepth.value=this.transmissionDepthTarget.texture),this.pipeline.setTransmissionPassEnabled(f)}t.layers.enable(3),t.layers.enable(8),this.pipeline.sceneHelpers=r,this.pipeline.sceneHelpersOnTop=i,this.pipeline.scene=o,this.pipeline.camera=t,u&&this.pipeline.transmissionPass.updatePasses(this),this.pipeline.postprocessingState!==o.postprocessing&&(this.pipeline.updatePostprocessing(o.postprocessing),!r&&!i&&this.pipeline.disableHelpers()),this.clearAlphaOverride!==void 0&&this.setClearAlpha(this.clearAlphaOverride),o.overrideMaterial=l.wireframeState?fE:null,this.pipeline.render(),jt.frameIndex.value=(jt.frameIndex.value+1)%16,t instanceof va&&t.copyHistory(),o.visible=s}renderFromSceneForSceneTransitionPass(e,t,r){this.pipeline.renderToScreen=!1,this.pipeline.renderTarget,this.renderSplineScene(e,t),this.pipeline.sceneTransitionFromTexture=this.pipeline.renderTarget.texture,this.sceneTransitionDuration=r,this.sceneTransitionTimeRemaining=r,this.pipeline.renderToScreen=!0;let i=this.pipeline.sceneTransitionPass.uniforms;i.uDPR.value=window.devicePixelRatio,i.uResolution.value.set(this.domElement.width,this.domElement.height).divideScalar(window.devicePixelRatio)}_currentDispose(){var e,t,r,i,n,a;this._superDispose(),this.pipeline.dispose(),(e=this.aoRenderTarget)==null||e.dispose(),(t=this.transmissionRenderTarget)==null||t.dispose(),(r=this.transmissionDepthTarget)==null||r.dispose(),(i=this.normalRenderTarget)==null||i.dispose(),(a=(n=this.normalRenderTarget)==null?void 0:n.depthTexture)==null||a.dispose()}},NH=class extends e0(Z1e){constructor(e,t=15,r=10066329){super(e,t,r),this.object=e,this.added=!1,this.name=`DirectionalLightHelper: ${e.uuid}`}raycast(e,t){t0(this.object,NH.geometryHelper,e,t)}},UH=class extends e0(Q1e){constructor(e,t=15,r=6710886){super(e,t,r),this.object=e,this.name=`PointLightHelper: ${e.uuid}`}raycast(e,t){t0(this.object,UH.geometryHelper,e,t)}},sE=class extends e0(K1e){constructor(e,t=6710886){super(e,t),this.object=e,this.name=`SpotLightHelper: ${e.uuid}`}raycast(e,t){t0(this.object,sE.geometryHelper,e,t)}update(){if(this.object!==void 0){let e=sE._vector,t=this.object.distance?this.object.distance:1e3,r=t*Math.tan(this.object.angle);this.cone.scale.set(r,r,t),e.setFromMatrixPosition(this.object.target.matrixWorld),this.cone.lookAt(e);let i=this.color!==void 0?this.color:this.light.color;if(this.cone.material instanceof Array)for(let n=0,a=this.cone.material.length;n<a;n++)this.cone.material[n].color.set(i);else this.cone.material.color.set(i)}}},jH=sE;jH._vector=new k;var VH=class extends $l{constructor(){super(),this.caretIndex=0,this._caretVisibleAlpha=1,this._selectionVisibleAlpha=.3,this.current={start:0,end:void 0},this.matrixAutoUpdate=!1,this.caretMesh=new Di(new rc(1,1),new tc({transparent:!0,opacity:0,side:fa})),this.add(this.caretMesh),this.selectionMesh=new Di(new rc(1,1),new tc({color:2857471,transparent:!0,depthTest:!1,depthWrite:!1,opacity:0,side:fa})),this.add(this.selectionMesh),this.hide()}get caretHeight(){var e;return((e=this.object)==null?void 0:e.AD)??0}show(e){this.visible=!0,this.object=e,this.caretMesh.scale.set(1,this.caretHeight,1),this.caretMesh.position.y=-this.caretHeight*.5,this.setCaretPosition(this.caretIndex),this.update()}hide(){this.visible=!1}update(){if(this.object===void 0)return;this.updateHelperMatrix();let{depth:e}=this.object.geometry.userData.parameters;this.caretMesh.position.z=e,this.selectionMesh.position.z=e}updateHelperMatrix(){if(this.object===void 0)return;let e=this.object,t=e.parent;t!==null&&t.updateWorldMatrix(!0,!1),e.matrixAutoUpdate&&e.updateMatrix(),t!==null?(this.matrixWorld.multiplyMatrices(t.matrixWorld,e.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,e.matrix)):this.matrixWorld.multiplyMatrices(e.hiddenMatrix,e.matrix),this.matrix.copy(this.matrixWorld);for(let r of this.children)r.matrixWorld.copy(this.matrixWorld);e.updateWorldMatrix(!0,!0)}setCaretColor(e){let t=this.caretMesh.material;t.color.setRGB(e.r,e.g,e.b);let r=this._caretVisibleAlpha===t.opacity;this._caretVisibleAlpha=e.a,r&&(t.opacity=this._caretVisibleAlpha)}setSelectionColor(e){this.selectionMesh.material.color.setRGB(e.r,e.g,e.b)}setCaretPosition(e,t={}){if(this.object===void 0)return;this.caretIndex=e;let r=this.object.wrappedText,[i,n]=r1(r,e),[a,o]=e>0?r1(r,e-1):[null,null];(e>0&&r.length?r[a].charAt(o):null)===`
`&&(i++,n=0),this.current.start=e,this.current.end=void 0;let[s,l]=n_(this.object,i,n),{AD:c,descender:d}=this.object,u=d+c*.5,{width:h,height:f,depth:p}=this.object.geometry.userData.parameters,v=typeof h=="string"?0:h,m=typeof f=="string"?0:f;this.caretMesh.scale.set(1,this.caretHeight,1),this.caretMesh.position.set(s-v*.5,l+u+m*.5,p),this.hideSelectionMesh(),this.showCaretMesh()}setSelection(e,t){if(this.object===void 0)return;let r=this.object.wrappedText;this.current.start=e,this.current.end=t;let i=[],n=[],a=oLe(r,e,t),{lineHeight:o,AD:s,descender:l}=this.object,c=l+s*.5-o*.5;for(let[m,g,y]of a)if(g!==y){let[b,x]=n_(this.object,m,g),[S,w]=n_(this.object,m,y);x+=c,w+=c,w+=o;let _=i.length/3;i.push(b,x,0),i.push(S,x,0),i.push(S,w,0),i.push(b,w,0),n.push(_+0,_+1,_+2),n.push(_+2,_+3,_+0)}let d=new Ot;d.setIndex(n),d.setAttribute("position",new yt(i,3));let{width:u,height:h,depth:f}=this.object.geometry.userData.parameters,p=typeof u=="string"?0:u,v=typeof h=="string"?0:h;this.selectionMesh.geometry.dispose(),this.selectionMesh.geometry=d,this.selectionMesh.position.x=-p*.5,this.selectionMesh.position.y=v*.5,this.selectionMesh.position.z=f,this.showSelectionMesh(),this.hideCaretMesh()}getSelectionFromPosition(e,t,r="previous"){if(this.object===void 0||this.object.font===void 0)return;let i=this.object.wrappedText,n=i.length,a=this.object.lineHeight,o=n*a,{height:s,verticalAlign:l}=this.object.geometry.userData.parameters,c=typeof s=="string"?0:s,d=0;l===3?d=c-o:l===2&&(d=c*.5-o*.5);let u=Math.min(Math.floor(Math.max(Math.min(-t-d,o),0)/a),n-1),h=this.object.charCoords[u],f=this.object.charWidths[u],p=0,v=!1;if(r==="previous"){for(let m=0;m<h.length;m++)if(h[m][0]+f[m]*.5-e>0){p=m,v=!0;break}}else if(r==="closest"){let m=1/0;for(let g=0;g<h.length;g++){let y=h[g][0]+f[g]*.5,b=Math.abs(y-e);b<m&&(m=b,p=g,v=!0)}}else for(let m=0;m<h.length;m++){let g=h[m][0],y=h[m][0]+f[m];if(e>=g&&e<y){p=m,v=!0;break}}return v||(p=h.length),{index:this.getGlobalIndexFromLineAndCharIndexes(i,u,p),lineIndex:u,characterIndex:p}}getGlobalIndexFromLineAndCharIndexes(e,t,r){return e.slice(0,t).reduce((i,n)=>i+=n.length,0)+r}showSelectionMesh(){this.selectionMesh.material.opacity=this._selectionVisibleAlpha}hideSelectionMesh(){this.selectionMesh.material.opacity=0}showCaretMesh(){this.caretMesh.material.opacity=this._caretVisibleAlpha}hideCaretMesh(){this.caretMesh.material.opacity=0}};function n_(e,t,r){let{charCoords:i,charWidths:n,initialOffsetY:a,lineHeight:o}=e;if(i[t]&&i[t].length===0||i.length===0){let d=0,{horizontalAlign:u}=e.data.geometry,h=e.wrappedText,{width:f}=e.geometry.userData.parameters;return h.length===1&&h[0].length===0&&(u===3?d=f*.5:u===2&&(d=f)),[d,a-o*t]}let s=i[t];if(s===void 0||s.length===0)return[0,0];let[l,c]=s[Math.min(r,s.length-1)];return r>=s.length&&(l+=n[t][r-1]),[l,c]}function r1(e,t){var i;let r=0;for(let n=0;n<e.length;n++){let a=e[n],o=t-r;if(o<=a.length)return[n,o];r+=a.length}return[Math.max(0,e.length-1),((i=e[e.length-1])==null?void 0:i.length)??0]}function oLe(e,t,r){let[i,n]=r1(e,t),[a,o]=r1(e,r),s=[];n>=e[i].length&&(i++,n=0);for(let l=i;l<=a;l++){let c=e[l],d=l===i?n:0,u=l===a?o:c.length;s.push([l,d,u])}return s}function sLe(e,t){let r=Qn.fromHex(3223857),i=.8;for(let n of e.layers){if(n.data.type==="light"||n.data.type==="displace"||n.data.type==="fresnel"||n.data.type==="matcap"||n.data.type==="texture"||n.data.type==="toon"||n.data.type==="outline"||n.data.type==="transmission"||n.data.type==="noise")continue;let a=typeof n.data.alpha=="string"?Number(t.getVariable(n.data.alpha)):n.data.alpha;if(n.data.type==="color"&&a>.3){r=lLe(n.data.color,t),i=a;break}else if((n.data.type==="depth"||n.data.type==="gradient")&&a>.3){let o=cLe(n.data);r={r:o[0],g:o[1],b:o[2]},i=typeof n.data.alpha=="string"?1:n.data.alpha;break}}return{...r,a:i}}function lLe(e,t){return typeof e=="string"?t.data.colors[e]:e}function cLe(e){return e.colors[0]}function dLe(e,t){e.shadow.camera.right=t/2,e.shadow.camera.left=-t/2,e.shadow.camera.top=t/2,e.shadow.camera.bottom=-t/2,e.shadow.needsUpdate=!0}var HH=class extends cD(k1e,NH){constructor(e,t,r){super(),this.super_Entity(e,t),this.castShadow=!0,this.shadow.mapSize.width=2048,this.shadow.mapSize.height=2048,this.shadow.normalBias=1,this.layers.enable(3);let i=this.shadow.camera;i.top=1250,i.bottom=-1250,i.right=1250,i.left=-1250,i.near=-1e4,i.far=2500;let n=new bx(this.shadow.camera);n.visible=!1,this.gizmos.shadowmap=n}update(){this.shadow.camera.updateProjectionMatrix();for(let e in this.gizmos){let t=this.gizmos[e];t instanceof bx&&t.update()}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.objectHelper&&this.objectHelper.update()}updateState(e,t){this.updateState_Light(e,t);let r=e.depth!==void 0&&e.depth!==this.shadow.camera.far||e.size!==void 0&&e.size/2!==this.shadow.camera.right;e.size!==void 0&&dLe(this,e.size),e.shadowRadius!==void 0&&(this.shadow.radius=e.shadowRadius),e.shadowResolution!==void 0&&(this.shadow.mapSize.set(e.shadowResolution,e.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null)),e.penumbraSize!==void 0&&t.scene.markPenumbraSizeDirty(),r&&this.update()}},jB=new k,VB=new k,HB=new Xt,WH=class extends cD(O1e,jH){constructor(e,t,r){super(),this.super_Entity(e,t),this.castShadow=!0,this.shadow.mapSize.width=1024,this.shadow.mapSize.height=1024,this.shadow.normalBias=1,this.layers.enable(3);let i=this.shadow.camera;i.fov=St.RAD2DEG*2*this.angle,i.aspect=1,i.near=100,i.far=2500;let n=new bx(this.shadow.camera);n.visible=!1,this.gizmos.shadowmap=n,this.update()}update(){this.shadow.camera.updateProjectionMatrix();for(let e in this.gizmos){let t=this.gizmos[e];t instanceof bx&&t.update()}}updateMatrixWorld(e){super.updateMatrixWorld(e),VB.setFromMatrixPosition(this.matrixWorld),HB.setFromRotationMatrix(this.matrixWorld),jB.copy(this.up).applyQuaternion(HB).negate().multiplyScalar(this.distance),this.target.position.copy(VB).add(jB),this.target.updateMatrixWorld(),this.objectHelper&&this.objectHelper.update()}updateState(e,t){this.updateState_Light(e,t),e.distance!==void 0&&(this.distance=e.distance),e.decay!==void 0&&(this.decay=e.decay),e.angle!==void 0&&(this.angle=e.angle),e.penumbra!==void 0&&(this.penumbra=e.penumbra),e.shadowRadius!==void 0&&(this.shadow.radius=e.shadowRadius),e.penumbraSize!==void 0&&t.scene.markPenumbraSizeDirty(),e.shadowResolution!==void 0&&(this.shadow.mapSize.set(e.shadowResolution,e.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null))}};function uLe(e){let t=(e[0][0]+e[1][1])/2,r=(e[0][0]-e[1][1])/2,i=(e[1][0]+e[0][1])/2,n=(e[1][0]-e[0][1])/2,a=Math.sqrt(t*t+n*n),o=Math.sqrt(r*r+i*i),s=a+o,l=a-o,c=Math.atan2(i,r),d=Math.atan2(n,t),u=(d-c)/2,h=(d+c)/2,f=[[Math.cos(h),Math.sin(h)],[-Math.sin(h),Math.cos(h)]],p=[[s,0],[0,l]],v=[[Math.cos(u),Math.sin(u)],[-Math.sin(u),Math.cos(u)]];return f[0][0]*=-1,f[0][1]*=-1,v[0][0]*=-1,v[1][0]*=-1,[f,p,v]}function _b(e,t){return[[e[0][0]*t[0][0]+e[0][1]*t[1][0],e[0][0]*t[0][1]+e[0][1]*t[1][1]],[e[1][0]*t[0][0]+e[1][1]*t[1][0],e[1][0]*t[0][1]+e[1][1]*t[1][1]]]}function WB(e){return[[e[0][0],e[1][0]],[e[0][1],e[1][1]]]}function hLe(e){let[t,r,i]=uLe(e),n=_b(t,WB(i)),a=_b(_b(i,r),WB(i)),o=Math.atan2(n[1][0],n[0][0]),s=[a[0][0],a[1][1]],l=[a[0][1]/a[1][1],a[1][0]/a[0][0]];return{rotation:o,scale:s,shear:l}}function fLe({rotation:e,scale:t,shear:r}){let i=Math.cos(e),n=Math.sin(e),a=[[i,-n],[n,i]],o=[[t[0],r[0]*t[1]],[r[1]*t[0],t[1]]],s=_b(a,o);return[s[0][0],s[1][0],s[0][1],s[1][1]]}var kr;(e=>{function t(){return[1,0,0,0,1,0,0,0,1]}e.identity=t;function r(w,_=e.identity()){for(let C=0,A=w.length;C<A;C++)_[C]=w[C];return _}e.copy=r;function i(w,_,C,A,M,P){return e.setAbcdef(e.identity(),w,_,C,A,M,P)}e.create=i;function n(w,_,C,A,M,P,T){return w[0]=_,w[1]=A,w[2]=P,w[3]=C,w[4]=M,w[5]=T,w}e.setAbcdef=n;function a(w,_){let[C,A,M,P,T,R]=s(w),[z,F,H,N,U,ie]=s(_),te=z*C+F*M,X=z*A+F*P,W=H*C+N*M,q=H*A+N*P,$=U*C+ie*M+T,le=U*A+ie*P+R;return e.create(te,X,W,q,$,le)}e.append=a;function o(w,_){let[C,A,M,P,T,R]=s(w),[z,F,H,N,U,ie]=s(_),te=C,X=A,W=M,q=P;(z!==1||F!==0||H!==0||N!==1)&&(te=C*z+A*H,X=C*F+A*N,W=M*z+P*H,q=M*F+P*N);let $=T*z+R*H+U,le=T*F+R*N+ie;return e.create(te,X,W,q,$,le)}e.prepend=o;function s(w){return[w[0],w[3],w[1],w[4],w[2],w[5]]}e.getAbcdef=s;function l(w){let[_,C,A,M,P,T]=e.getAbcdef(w),R=_*M-C*A,z=M/R,F=-C/R,H=-A/R,N=_/R,U=(A*T-M*P)/R,ie=-(_*T-C*P)/R;return e.create(z,F,H,N,U,ie)}e.invert=l;function c([w,_],C){let[A,M,P,T,R,z]=e.getAbcdef(C);return[A*w+P*_+R,M*w+T*_+z]}e.apply=c;function d(w,_){let[C,A,M,P,T,R]=e.getAbcdef(_),z=1/(C*P+M*-A),[F,H]=w;return[P*z*F+-M*z*H+(R*M-T*P)*z,C*z*H+-A*z*F+(-R*C+T*A)*z]}e.applyInverse=d;function u(w,_,C=_){let[A,M,P,T,R,z]=e.getAbcdef(w);return e.setAbcdef(w,A*_,M*C,P*_,T*C,R*_,z*C),w}e.scale=u;function h(w,_){let C=Math.cos(_),A=Math.sin(_),[M,P,T,R,z,F]=e.getAbcdef(w);return e.setAbcdef(w,M*C-P*A,M*A+P*C,T*C-R*A,T*A+R*C,z*C-F*A,z*A+F*C),w}e.rotate=h;function f(w,_,C){let[A,M]=C,P=e.translate(w,-A,-M);return P=e.rotate(P,_),P=e.translate(P,A,M),P}e.rotateAround=f;function p(w,_,C){let[A,M,P,T,R,z]=e.getAbcdef(w);return e.setAbcdef(w,A,M,P,T,R+_,z+C),w}e.translate=p;function v(w,_,C){let[A,M,P,T]=e.getAbcdef(w);return e.setAbcdef(w,A,M,P,T,_,C),w}e.setTranslate=v;function m(w,_,C){let[A,M,P,T]=e.getAbcdef(w);return e.setAbcdef(w,A,M,P,T,_,C),w}e.setPosition=m;function g(w){let[_,C,A,M]=e.getAbcdef(w),P=Math.sqrt(_*_+C*C),T=Math.sqrt(A*A+M*M);return[P,T]}e.getScale=g;function y(w){let[,,,,_,C]=e.getAbcdef(w);return[_,C]}e.getPosition=y;function b(w,_){return e.decompose(w,_).rotation}e.getRotation=b;function x(w,_){let[C,A,M,P,T,R]=e.getAbcdef(w),{rotation:z,scale:F,shear:H}=hLe([[C,M],[A,P]]);return{position:[T+(_[0]*C+_[1]*M)-_[0],R+(_[0]*A+_[1]*P)-_[1]],scale:F,rotation:z,shear:H,pivot:_}}e.decompose=x;function S(w,_,C,A,M=[0,0]){let[P,T]=w,[R,z]=A,[F,H,N,U]=fLe({rotation:C,scale:_,shear:M}),ie=P-(R*F+z*N)+R,te=T-(R*H+z*U)+z;return e.create(F,H,N,U,ie,te)}e.compose=S})(kr||(kr={}));var pLe=Math.PI/180;function mLe(e,t,r,i,n,a){let o=e-r,s=t-i;return o*o/(n*n)+s*s/(a*a)<=1}function vLe(e){return e*pLe}var Nn=class{constructor(e,t,r){this.uuid=e,this.data=t,this.localMatrix=kr.identity(),this.worldMatrix=kr.identity(),this.ignoreCameraZoom=!1,this.visible=!0,this._singleBBox=new lE,this._recursiveBBox=new lE,this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0,this.stateSelection=null,this.prevState=null,this.currentState=null,this.reversibleToState=null,this.currentTransitionEvent=null,this.previousAction=null,this.name="",this.position=[0,0],this.scale=[1,1],this.rotation=0,this.shear=[0,0],this.emitter=nD(),this.dpr=r.dpr??1,this.dataPatched=t}project(e,t){let r=this.worldMatrix;return t&&(r=kr.append(t.worldMatrix,r)),kr.applyInverse(e,r)}intersects(e,t,r,i=!1){return this.visible&&!this.data.raycastLock&&this.intersectsInLocalSpace(...this.project([e,t],r),i)}intersectsInLocalSpace(e,t,r=!1){let{min:i,max:n}=r?this.recursiveBBox:this.singleBBox;return e>=i[0]&&e<=n[0]&&t>=i[1]&&t<=n[1]}applyTransforms(e){e.setTransform(this.worldMatrix,this.ignoreCameraZoom)}get singleBBox(){return this.singleBBoxNeedsUpdate&&(this.singleBBoxNeedsUpdate=!1,this._singleBBox.setFromObjectSize(this,!1),this._singleBBox.computeVertices(),this._singleBBox.computeEdges()),this._singleBBox}get recursiveBBox(){return this.recursiveBBoxNeedsUpdate&&(this.recursiveBBoxNeedsUpdate=!1,this._recursiveBBox.setFromObjectSize(this,!0),this._recursiveBBox.computeVertices(),this._recursiveBBox.computeEdges()),this._recursiveBBox}updateLocalMatrix(){this.localMatrix=kr.compose(this.position,this.scale,vLe(this.rotation),Hu.getPivot(this.dataPatched),this.shear)}updateWorldMatrix(e,t,r){let i=this.parent;t&&i!==null&&i!==void 0&&i.updateWorldMatrix(e,!0,!1),e&&this.updateLocalMatrix(),this.parent?this.worldMatrix=kr.append(this.parent.worldMatrix,this.localMatrix):this.worldMatrix=kr.copy(this.localMatrix),this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0}get pivot(){return Hu.getPivot(this.data)}getCenter(){return[0,0]}getHalfSize(){return[0,0]}get id(){return this.uuid}resetBBoxNeedsUpdateSelf(){this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0}resetBBoxNeedsUpdate(){this.resetBBoxNeedsUpdateSelf(),this.traverseAncestors(e=>{e.resetBBoxNeedsUpdateSelf()})}updateTransformState(e){let t=!1;e.position!==void 0&&(t=!0,this.position=e.position),e.rotation!==void 0&&(t=!0,this.rotation=e.rotation),e.scale!==void 0&&(t=!0,this.scale=e.scale),e.shear!==void 0&&(t=!0,this.shear=e.shear),t&&(this.updateWorldMatrix(!0,!1,!0),this.resetBBoxNeedsUpdate())}updateByOp(e,t,r){e.type===0&&e.props.visible!==void 0&&(this.visible=e.props.visible),this.data=t,this.data=t;let i=e,n=si(e.path,["states","*"]);if(n!==null){if(e.type===0){let[a]=n;if((this==null?void 0:this.stateSelection)===a){let o={...e.props};if(delete o.name,Object.values(e.props).some(s=>s===void 0)){let s=this.data;if(s!==void 0){let l=gn.zoom(s,e.path.slice(2));if(l)for(let c in e.props)e.props[c]===void 0&&c in l&&(o[c]=l[c])}}i={...e,props:o,path:e.path.slice(2)}}}}else if(e.type===0){let a=this.stateSelection?this.data.states.data(this.stateSelection):void 0;if(a!==void 0){if(e.props.name!==void 0&&a.name){let{name:s,...l}=a;a=l}let o=gn.removeOverridden(e.path,e.props,a);i={...e,props:o}}}this.updateByPatchedOpBase(i,Tu.patch(this.data,this.stateSelection?this.data.states.data(this.stateSelection):void 0),r)}changeSelectedState(e,t,r=!1){if(!(this.data.states.length===0&&!r)){for(let i of this.data.states)Tu.toOps(this.data,i.data).forEach(n=>{let a=Dx.replaceProps(n,this.data);this.dataPatched=this.data,this.updateByPatchedOp(a,this.data,t)});if(e!==null){let i=this.data.states.data(e);i&&(this.dataPatched=Tu.patch(this.data,i),Tu.toOps(this.data,i).forEach(n=>{this.updateByPatchedOp(n,this.dataPatched,t)}))}r&&this.updateTransformState(this.dataPatched),this.stateSelection=e}}updateState(e,t){e.name!==void 0&&(this.name=e.name),e.visible!==void 0&&(this.visible=e.visible),this.updateTransformState(e)}updateByPatchedOpBase(e,t,r){this.dataPatched=t,this.updateByPatchedOp(e,t,r)}updateByPatchedOp(e,t,r){e.path.length===0&&e.type===0&&this.updateState(e.props,r),this.requestRender()}traverseFrameAncestors(e){this.traverseAncestors(t=>{t.data.type==="frame2d"&&e(t)})}traverseAncestors(e){let t=this.parent;for(;t;)e(t),t=t.parent}requestRender(){this.traverseFrameAncestors(e=>{e.requestRender()})}clone(e){let t=new Nn(this.uuid,this.data,e);return t.parent=void 0,t}addEventListener(e,t){this.emitter.on(e,t)}removeEventListener(e,t){this.emitter.off(e,t)}dispatchEvent(e){this.emitter.emit(e.type,{...e,target:e.target??this})}traverseSortNextHelper(){let e=this.parent;if(e){let t=e.children;if(t){let r=t.indexOf(this)+1;return t[r]?t[r]:e.traverseSortNextHelper()}}}sortNext(){let e=this.children;return e&&e.length>0&&e[0]?e[0]:this.traverseSortNextHelper()}isDescendantOf(e){e instanceof Nn&&(e=e.uuid);let t=this;for(;t.parent;){if(t.parent.uuid===e)return!0;t=t.parent}return!1}},es=class extends Nn{constructor(e,t,r){super(e,t,r),this.uuid=e,this.data=t,this.context=r,this.children=[]}add(e){e.parent&&e.parent instanceof es&&e.parent.remove(e),this.children.push(e),e.parent=this}remove(e){let t=this.children.indexOf(e);t>=0&&(this.children.splice(t,1),e.parent=void 0)}traverse(e){let t=e(this);if(t!==!0)for(let r of this.children)r instanceof es?r.traverse(e):t=e(r)}intersectsChildrenHelper(e,t,r,i,n){for(let a of this.children)if(a.intersects(e,t,r,!1)&&(n.push(a),i)||a instanceof es&&a.intersectsChildrenHelper(e,t,r,i,n))return!0;return!1}intersectsChildren(e,t,r,i=!1,n=[],a=!1){return this.intersectsChildrenHelper(e,t,r,i,n),n}intersectsChildrenHelperReverse(e,t,r,i,n){for(let a of this.children)if(a instanceof es&&a.intersectsChildrenHelperReverse(e,t,r,i,n)||a.intersects(e,t,r,!1)&&(n.push(a),i))return!0;return!1}intersectsChildrenReverse(e,t,r,i=!1,n=[],a=!1){return this.intersectsChildrenHelperReverse(e,t,r,i,n),n}updateWorldMatrix(e,t,r){if(super.updateWorldMatrix(e,t,r),r&&this.children)for(let i of this.children)i.updateWorldMatrix(e,!1,!0)}find(e){let t;return this.traverse(r=>{r.uuid===e&&(t=r)}),t}innerDrawChildren(e){for(let t=this.children.length-1;t>=0;t--)this.children[t].draw(e)}resetBBoxNeedsUpdate(){super.resetBBoxNeedsUpdate(),this.traverse(e=>{e.resetBBoxNeedsUpdateSelf()})}clone(e){let t=new es(this.uuid,this.data,e);t.parent=void 0;for(let r of this.children)t.add(r.clone(e));return t}},Md=class extends es{constructor(e,t,r){super(e,t,r),this.uuid=e,this.data=t,this.updateState(t,r)}draw(e){!this.visible||(e.save(),this.applyTransforms(e),this.innerDrawChildren(e),e.restore())}clone(e){let t=new Md(this.uuid,this.data,e);t.parent=void 0;for(let r of this.children)t.add(r.clone(e));return t}};function gLe(e,t){let[[r,i],[n,a]]=e,[[o,s],[l,c]]=t,d=(r-n)*(s-c)-(i-a)*(o-l);if(d===0)return!1;let u=((r-o)*(s-c)-(i-s)*(o-l))/d,h=-((r-n)*(i-s)-(i-a)*(r-o))/d;return u>=0&&u<=1&&h>=0&&h<=1}var GH=[[-1,1],[-1,-1],[1,-1],[1,1]],GB=(e,t,r)=>{let i=e.getCenter(),n=e.getHalfSize(),a=kr.append(t,e.worldMatrix);n[0]===0&&n[1]===0?r.push(kr.apply(i,a)):GH.forEach(o=>{let s=[o[0]*n[0]+i[0],o[1]*n[1]+i[1]];r.push(kr.apply(s,a))})},lE=class{constructor(){this.matrix=kr.identity(),this.min=[1/0,1/0],this.max=[-1/0,-1/0],this.vertices=[],this.edges=[]}setFromObjectSize(e,t=!1){e.updateWorldMatrix(),this.makeEmpty(),kr.copy(e.worldMatrix,this.matrix);let r=kr.invert(e.worldMatrix);this.expandByObjectSize(e,r,t)}expandByObjectSize(e,t,r=!1){let i=[];r===!0&&e instanceof es?e.traverse(n=>{n.visible&&GB(n,t,i)}):GB(e,t,i),this.setFromPoints(i)}setFromSize(e,t,r){this.makeEmpty(),kr.copy(r,this.matrix),this.expandBySize(e,t,r)}expandBySize(e,t,r){[kr.apply([0,0],r),kr.apply([0,t],r),kr.apply([e,t],r),kr.apply([e,0],r)].forEach(i=>this.expandByPoint(i))}getCenter(){let[e,t]=this.min,[r,i]=this.getHalfSize();return kr.apply([e+r,t+i],this.matrix)}getSize(){return[this.max[0]-this.min[0],this.max[1]-this.min[1]]}getHalfSize(){return[(this.max[0]-this.min[0])*.5,(this.max[1]-this.min[1])*.5]}makeEmpty(){this.min=[1/0,1/0],this.max=[-1/0,-1/0]}setFromPoints(e){this.makeEmpty();for(let t of e)this.expandByPoint(t)}expandByPoint(e){this.min=[Math.min(this.min[0],e[0]),Math.min(this.min[1],e[1])],this.max=[Math.max(this.max[0],e[0]),Math.max(this.max[1],e[1])]}computeVertices(){let[e,t]=this.getHalfSize(),r=this.getCenter(),[i,n,a,o]=kr.getAbcdef(this.matrix),s=kr.create(i,n,a,o,r[0],r[1]);this.vertices=GH.map(([l,c])=>kr.apply([l*e,c*t],s))}computeEdges(){this.edges=[];for(let e=0,t=this.vertices.length;e<t;++e)this.edges.push([this.vertices[e],this.vertices[(e+1)%t]])}project(e,t){let r=this.matrix;return t&&(r=kr.append(t.worldMatrix,r)),kr.applyInverse(e,r)}intersects(e,t,r){return this.intersectsInLocalSpace(...this.project([e,t],r))}intersectsInLocalSpace(e,t){let{min:r,max:i}=this;return e>=r[0]&&e<=i[0]&&t>=r[1]&&t<=i[1]}containsPoint(e){let[t,r]=e,[i,n]=this.min,[a,o]=this.max;return t>=i&&t<=a&&r>=n&&r<=o}intersectsBBox2D(e){for(let t=0,r=this.edges.length;t<r;t++){let i=this.edges[t];for(let n=0,a=e.edges.length;n<a;n++){let o=e.edges[n];if(gLe(i,o))return!0}}for(let t=0,r=e.vertices.length;t<r;t++){let i=e.vertices[t];if(this.containsPoint(i))return!0}return!1}ensureMinMax(){let e=this.min,t=this.max;this.min=[Math.min(e[0],t[0]),Math.min(e[1],t[1])],this.max=[Math.max(e[0],t[0]),Math.max(e[1],t[1])]}copy(e){this.min=[...e.min],this.max=[...e.max],kr.copy(e.matrix,this.matrix),this.computeVertices(),this.computeEdges()}clone(){let e=new lE;return e.copy(this),e}},$H,yLe=new Promise(e=>{$H=e}),$B=!1,qy;function bLe(){if($B)return;if(qy)return qy;async function e(){let t=await Nd(()=>import("./ui-L7l3pL7d.js"),[]);$H(t.default??t),$B=!0}return qy=e(),qy}function qB(e){let t=!1;return e.scene.objects.traverse((r,i)=>{(i.type==="Mesh"&&i.geometry.type==="UIGeometry"||i.type==="Page"&&i.uiFrame!==void 0)&&(t=!0)}),t}var er,a_;async function xLe(e){let t=await yLe;er||(a_||(a_=t({locateFile:()=>e})),er=await a_)}var YB=kr.identity(),qH=class{constructor(e,t=1){this.canvas=e,this._dpr=t,this._width=0,this._height=0,this._strokeMode="inside",this._layerBlur=0,this._backgroundBlur=0,this._dropShadowBlur=0,this._dropShadowOffsetX=0,this._dropShadowOffsetY=0,this._dropShadowColor=ri.transparent,this._innerShadowBlur=0,this._innerShadowOffsetX=0,this._innerShadowOffsetY=0,this._innerShadowSpread=0,this._innerShadowColor=ri.transparent,this._fonts=new Map,this._isSizeDirty=!1;try{let r=e.getBoundingClientRect();e.width=r.width*t,e.height=r.height*t}catch{console.log(e.width,t)}this._currentM3Transform=YB,this._currentTransform=new Float32Array(YB)}get dpr(){return this._dpr}set dpr(e){this._dpr=e,this._isSizeDirty=!0}async init(){var e,t;if(!this.wasmURL)throw Error("Your must set the wasm binary url with renderer.wasmURL = ... before you can call renderer.init");await xLe(this.wasmURL),this._surface=er.MakeWebGLCanvasSurface(this.canvas),this.ctx=(e=this._surface)==null?void 0:e.getCanvas(),this._paint=new er.Paint,this._paint.setAntiAlias(!0),this._paintFill=this._paint.copy(),this._paintFill.setStyle(er.PaintStyle.Fill),this._paintStroke=this._paint.copy(),this._paintStroke.setStyle(er.PaintStyle.Stroke),(t=this.ctx)==null||t.scale(this.dpr,this.dpr)}get currentTransform(){return this._currentM3Transform}get currentTransformBuffer(){return this._currentTransform}set currentTransform(e){this._currentM3Transform=e,this._currentTransform.set(e)}async loadFont(e,t){let r=await(await fetch(e)).arrayBuffer();this.registerFont(r,t)}registerFont(e,t){if(this._fonts.has(t))return;let r=er.FontMgr.FromData(e);if(r)this._fonts.set(t,r);else throw new Error("Invalid font data for "+t)}get width(){return this._width}get height(){return this._height}set strokeColor(e){this._paintStroke&&this._paintStroke.setColor(Yy(e),er.ColorSpace.DISPLAY_P3)}set fillColor(e){this._paintFill&&this._paintFill.setColor(Yy(e),er.ColorSpace.DISPLAY_P3)}set lineWidth(e){this._paintStroke&&this._paintStroke.setStrokeWidth(this._strokeMode==="center"?e:e*2)}set strokeMode(e){this._strokeMode=e}set dropShadowBlur(e){this._dropShadowBlur=e}set dropShadowColor(e){this._dropShadowColor=e}set dropShadowOffsetX(e){this._dropShadowOffsetX=e}set dropShadowOffsetY(e){this._dropShadowOffsetY=e}set innerShadowBlur(e){this._innerShadowBlur=e}set innerShadowColor(e){this._innerShadowColor=e}set innerShadowOffsetX(e){this._innerShadowOffsetX=e}set innerShadowOffsetY(e){this._innerShadowOffsetY=e}set innerShadowSpread(e){this._innerShadowSpread=e}set layerBlur(e){this._layerBlur=e}set backgroundBlur(e){this._backgroundBlur=e}clear(){var e;(e=this.ctx)==null||e.clear(er.TRANSPARENT)}save(){var e;(e=this.ctx)==null||e.save()}restore(){var e;(e=this.ctx)==null||e.restore()}beginPath(){var e;(e=this._currentPath)==null||e.delete(),this._currentPath=new er.Path}closePath(){let e=this._currentPath;if(e){if(e.isEmpty())return;let t=e.getBounds();(t[3]-t[1]||t[2]-t[0])&&e.close()}}fill(){this._paintInner(this._paintFill,!0)}stroke(){this._paintInner(this._paintStroke,!1)}clipRect(e,t,r,i,n=0,a=0,o=0,s=0){var c,d;let l=er.XYWHRect(e,t,r,i);if(n===0&&a===0&&s===0&&o===0)(c=this.ctx)==null||c.clipRect(l,er.ClipOp.Intersect,!0);else{let u=er.RRectXY(l,n,n);u[4]=u[5]=n,u[6]=u[7]=a,u[8]=u[9]=o,u[10]=u[11]=s,(d=this.ctx)==null||d.clipRRect(u,er.ClipOp.Intersect,!0)}}_applyShadowOffsetMatrix(){if(this.ctx){let e=kr.invert(this.currentTransform);this.ctx.concat(e);let t=kr.translate(kr.identity(),this._dropShadowOffsetX,this._dropShadowOffsetY);this.ctx.concat(t),this.ctx.concat(this._currentTransform)}}_applyEffectsToPaint(e,t,r=!0){var i,n,a,o;if(this.ctx&&this._currentPath){let s,l=!1;if(r&&this._hasDropShadow()){let c=e.copy();c.setColor(Yy(this._dropShadowColor));let d;this._dropShadowBlur>0&&(d=er.MaskFilter.MakeBlur(er.BlurStyle.Normal,this._dropShadowBlur*this.dpr*(((i=this.camera)==null?void 0:i.scale)??1),!1),c.setMaskFilter(d)),this.ctx.save(),this.ctx.clipPath(this._currentPath,er.ClipOp.Difference,!0),this._applyShadowOffsetMatrix(),t(c),this.ctx.restore(),c.delete(),d==null||d.delete()}if(this._backgroundBlur>0&&r){this.ctx.save(),this.ctx.clipPath(this._currentPath,er.ClipOp.Intersect,!0);let c=er.ImageFilter.MakeBlur(this._backgroundBlur,this._backgroundBlur,er.TileMode.Clamp,null),d=e.copy();d.setImageFilter(c),d.setAlphaf(1);let u=this._currentPath.computeTightBounds();this.ctx.saveLayer(d,u,null,er.SaveLayerInitWithPrevious),this.ctx.drawColor(e.getColor()),this.ctx.restore(),this.ctx.restore(),d.delete(),c.delete(),l=!0}if(this._layerBlur>0){let c=e.copy();s=er.MaskFilter.MakeBlur(er.BlurStyle.Normal,this._layerBlur*this.dpr*(((n=this.camera)==null?void 0:n.scale)??1),!1),c.setMaskFilter(s),t(c),c.delete(),s.delete(),l=!0}if(l||t(e),r&&this._hasInnerShadow()){let c=new er.Paint;c.setAntiAlias(!0),c.setStyle(er.PaintStyle.Fill),c.setColor(Yy(this._innerShadowColor));let d;this._innerShadowBlur>0&&(d=er.MaskFilter.MakeBlur(er.BlurStyle.Normal,this._innerShadowBlur*this.dpr*(((a=this.camera)==null?void 0:a.scale)??1),!1),c.setMaskFilter(d));let u=this._currentPath.computeTightBounds(),[h,f,p,v]=u,m=p-h,g=v-f;this.ctx.save(),this.ctx.clipPath(this._currentPath,er.ClipOp.Intersect,!0),this.ctx.saveLayer(c,u,null,er.SaveLayerInitWithPrevious),(o=this.ctx)==null||o.translate(this._innerShadowOffsetX,this._innerShadowOffsetY),this.ctx.drawRect(er.XYWHRect(-1e3-this._innerShadowOffsetX,-1e3-this._innerShadowOffsetY,2e3+m+Math.abs(this._innerShadowOffsetX*2),2e3+g+Math.abs(this._innerShadowOffsetY*2)),c),c.setBlendMode(er.BlendMode.Clear),this.ctx.drawPath(this._currentPath,c),this.ctx.restore(),this.ctx.restore(),c.delete(),d==null||d.delete()}}}_paintInner(e,t=!0){if(this.ctx&&this._currentPath&&e){let r=this.ctx,i=this._currentPath;this._applyEffectsToPaint(e,n=>{let a=!1;!t&&this._strokeMode!=="center"&&(r.save(),r.clipPath(i,this._strokeMode==="outside"?er.ClipOp.Difference:er.ClipOp.Intersect,!0),a=!0),r.drawPath(i,n),a&&r.restore()},t)}}_hasDropShadow(){var e;return((e=this._dropShadowColor)==null?void 0:e.a)>0}_hasInnerShadow(){var e;return((e=this._innerShadowColor)==null?void 0:e.a)>0}path(e){var t;(t=this._currentPath)==null||t.addPath(er.Path.MakeFromSVGString(e))}ellipse(e,t,r,i,n,a,o,s){var c;if(!XB([e,t,r,i])||!this._currentPath)return;if(r<0||i<0)throw Error("radii cannot be negative");let l=er.XYWHRect(e-r,t-i,r*2,i*2);(c=this._currentPath)==null||c.addOval(l)}rect(e,t,r,i,n=0,a=0,o=0,s=0){var c,d;let l=er.XYWHRect(e,t,r,i);if(XB(l))if(n===0&&a===0&&s===0&&o===0)(c=this._currentPath)==null||c.addRect(l);else{let u=er.RRectXY(l,n,n);u[4]=u[5]=n,u[6]=u[7]=a,u[8]=u[9]=o,u[10]=u[11]=s,(d=this._currentPath)==null||d.addRRect(u)}}getHorizontalAlign(e){switch(e){case 2:return er.TextAlign.Right;case 3:return er.TextAlign.Center;case 4:return er.TextAlign.Justify;case 1:default:return er.TextAlign.Left}}drawTextInner(e,t,r,[i,n,a,o],s,l,c=!0){let d=0,{ctx:u}=this;if(!u)return d;let h=l.copy(),f=l.copy();return f.setAlphaf(0),this._applyEffectsToPaint(h,p=>{t.pushPaintStyle(r,p,f),t.addText(e);let v=t.build();v.layout(a);let m=n;s===2?m+=(o-v.getHeight())/2:s===3&&(m+=o-v.getHeight()),u.drawParagraph(v,i,m),d=v.getHeight(),t.reset(),v.delete()},c),h.delete(),f.delete(),d}drawText(e,t){let r=0,i=this._fonts.get(t.font),{ctx:n,_paintFill:a,_paintStroke:o}=this;if(i&&n){let s=new er.TextStyle({fontFamilies:[t.font],fontSize:t.fontSize,heightMultiplier:t.lineHeight,letterSpacing:t.letterSpacing}),l=new er.ParagraphStyle({textStyle:s,textAlign:this.getHorizontalAlign(t.horizontalAlign)}),c=er.XYWHRect(t.x,t.y,t.width,t.height),d=er.ParagraphBuilder.Make(l,i);a&&(r=this.drawTextInner(e,d,s,c,t.verticalAlign,a,!0)),o&&(r=this.drawTextInner(e,d,s,c,t.verticalAlign,o,!1)),d.delete()}return{height:r}}render(){var e;(e=this._surface)==null||e.flush()}moveTo(e,t){var r;(r=this._currentPath)==null||r.moveTo(e,t)}lineTo(e,t){var r;(r=this._currentPath)==null||r.lineTo(e,t)}bezierCurveTo(e,t,r,i,n,a){var o;(o=this._currentPath)==null||o.cubicTo(e,t,r,i,n,a)}quadraticCurveTo(e,t,r,i){var n;(n=this._currentPath)==null||n.quadTo(e,t,r,i)}setTransform(e,t=!1){var n,a,o,s,l;if(!this.ctx)return;let r=this.ctx.getTotalMatrix(),i=kr.invert(r);if(i&&this.ctx.concat(i),(n=this.ctx)==null||n.scale(this.dpr,this.dpr),((a=this.camera)==null?void 0:a.enabled)&&((o=this.ctx)==null||o.concat(this.camera.worldMatrix),t)){let c=kr.getScale(this.camera.worldMatrix);(s=this.ctx)==null||s.scale(1/c[0],1/c[1])}(l=this.ctx)==null||l.concat(e),this.currentTransform=e}transform(e){var t;(t=this.ctx)==null||t.concat(e)}setSize(e,t){var r;!this._isSizeDirty&&e===this._width&&t===this._height||(this._isSizeDirty=!1,this._width=e,this._height=t,this.canvas.style.width=e+"px",this.canvas.style.height=t+"px",this.canvas.width=e*this.dpr,this.canvas.height=t*this.dpr,this._surface&&(this._surface=er.MakeWebGLCanvasSurface(this.canvas),this.ctx=(r=this._surface)==null?void 0:r.getCanvas()))}};function XB(e){for(let t=0;t<e.length;t++)if(e[t]!==void 0&&!Number.isFinite(e[t]))return!1;return!0}function Yy({r:e,g:t,b:r,a:i}){return er.Color4f(e,t,r,i)}var KB=class{constructor(e,t,r){this.uuid=e,this.data=t,this.enabled=!1,this.color=ri.transparent,this.blurRadius=0,this.offset=[0,0],this.spread=0,this.update(t)}update(e){e.color!==void 0&&(this.color=e.color),e.enabled!==void 0&&(this.enabled=e.enabled),e.blurRadius!==void 0&&(this.blurRadius=e.blurRadius),e.offset!==void 0&&(this.offset=e.offset),e.spread!==void 0&&(this.spread=e.spread)}},QB=class{constructor(e,t,r){this.uuid=e,this.data=t,this.enabled=!1,this.radius=0,this.update(t)}update(e){e.enabled!==void 0&&(this.enabled=e.enabled),e.radius!==void 0&&(this.radius=e.radius)}},wLe=class{constructor(e,t,r){this.uuid=e,this.data=t,this.enabled=!1,this.color=ri.transparent,this.update(t)}update(e){e.enabled!==void 0&&(this.enabled=e.enabled),e.color!==void 0&&(this.color=e.color)}},SLe=class{constructor(e,t,r){this.uuid=e,this.data=t,this.enabled=!1,this.color=ri.transparent,this.thickness=0,this.mode="inside",this.update(t)}update(e){e.enabled!==void 0&&(this.enabled=e.enabled),e.color!==void 0&&(this.color=e.color),e.thickness!==void 0&&(this.thickness=e.thickness),e.mode!==void 0&&(this.mode=e.mode)}},Dn=class extends Nn{constructor(e,t,r){super(e,t,r),this.uuid=e,this.data=t,this.autoClose=!0,this.fill=new wLe(e+"-fill",t.fill,r),this.stroke=new SLe(e+"-stroke",t.stroke,r),this.dropShadow=new KB(e+"-dropShadow",t.dropShadow,r),this.innerShadow=new KB(e+"-innerShadow",t.innerShadow,r),this.backgroundBlur=new QB(e+"-backgroundBlur",t.backgroundBlur,r),this.layerBlur=new QB(e+"-layerBlur",t.layerBlur,r)}applyFillStroke(e){e.fillColor=this.fill.enabled?this.fill.color:ri.transparent,e.strokeColor=this.stroke.enabled&&this.stroke.thickness>0?this.stroke.color:ri.transparent,e.strokeMode=this.stroke.mode,e.lineWidth=this.stroke.thickness}applyFilters(e){this.layerBlur.enabled?e.layerBlur=this.layerBlur.radius*5:e.layerBlur=0,this.backgroundBlur.enabled?e.backgroundBlur=this.backgroundBlur.radius*5:e.backgroundBlur=0,this.dropShadow.enabled?(e.dropShadowBlur=this.dropShadow.blurRadius*5,e.dropShadowColor=this.dropShadow.color,e.dropShadowOffsetX=this.dropShadow.offset[0],e.dropShadowOffsetY=this.dropShadow.offset[1]):e.dropShadowColor=ri.transparent,this.innerShadow.enabled?(e.innerShadowSpread=this.innerShadow.spread,e.innerShadowBlur=this.innerShadow.blurRadius*5,e.innerShadowColor=this.innerShadow.color,e.innerShadowOffsetX=this.innerShadow.offset[0],e.innerShadowOffsetY=this.innerShadow.offset[1]):e.innerShadowColor=ri.transparent}innerDraw(e){}draw(e){!this.visible||(e.save(),this.applyTransforms(e),this.applyFilters(e),this.applyFillStroke(e),e.beginPath(),this.innerDraw(e),this.autoClose&&e.closePath(),this.fill.enabled&&e.fill(),this.stroke.enabled&&e.stroke(),e.restore())}updateByPatchedOp(e,t,r){super.updateByPatchedOp(e,t,r),e.type===0&&(si(e.path,["fill"])?this.fill.update(e.props):si(e.path,["stroke"])?this.stroke.update(e.props):si(e.path,["dropShadow"])?this.dropShadow.update(e.props):si(e.path,["innerShadow"])?this.innerShadow.update(e.props):si(e.path,["layerBlur"])?this.layerBlur.update(e.props):si(e.path,["backgroundBlur"])?this.backgroundBlur.update(e.props):this.resetBBoxNeedsUpdate())}updateState(e,t){super.updateState(e,t),e.fill!==void 0&&this.fill.update(e.fill),e.stroke!==void 0&&this.stroke.update(e.stroke),e.dropShadow!==void 0&&this.dropShadow.update(e.dropShadow),e.innerShadow!==void 0&&this.innerShadow.update(e.innerShadow),e.layerBlur!==void 0&&this.layerBlur.update(e.layerBlur),e.backgroundBlur!==void 0&&this.backgroundBlur.update(e.backgroundBlur)}clone(e){let t=new Dn(this.uuid,this.data,e);return t.parent=void 0,t}},hD=class extends Dn{constructor(e,t,r){super(e,t,r),this.uuid=e,this.data=t,this.width=0,this.height=0,this.updateState(t,r)}innerDraw(e){e.ellipse(this.width*.5,this.height*.5,this.width*.5,this.height*.5,0,0,Math.PI*2)}intersectsInLocalSpace(e,t){return mLe(e,t,this.width*.5,this.height*.5,this.width*.5,this.height*.5)}getCenter(){return[this.width*.5,this.height*.5]}getHalfSize(){return[this.width*.5,this.height*.5]}updateSizeState(e){let t=!1;e.width!==void 0&&(this.width=typeof e.width=="number"?e.width:this.width,t=!0),e.height!==void 0&&(this.height=typeof e.height=="number"?e.height:this.height,t=!0),t&&this.updateWorldMatrix(!0,!1,!0)}updateState(e,t){super.updateState(e,t),this.updateSizeState(e)}clone(e){let t=new hD(this.uuid,this.data,e);return t.parent=void 0,t}},n0=class extends Dn{constructor(e,t,r){super(e,t,r),this.uuid=e,this.data=t,this.width=0,this.height=0,this.cornerRadius=[0,0,0,0],this.updateState(t,r)}innerDraw(e){e.rect(0,0,this.width,this.height,...this.cornerRadius)}getCenter(){return[this.width*.5,this.height*.5]}getHalfSize(){return[this.width*.5,this.height*.5]}updateCornerState(e){e.cornerRadius!==void 0&&(this.cornerRadius=e.cornerRadius)}updateSizeState(e){let t=!1;e.width!==void 0&&(this.width=typeof e.width=="number"?e.width:this.width,t=!0),e.height!==void 0&&(this.height=typeof e.height=="number"?e.height:this.height,t=!0),t&&this.updateWorldMatrix(!0,!1,!0)}updateState(e,t){super.updateState(e,t),this.updateSizeState(e),this.updateCornerState(e)}clone(e){let t=new n0(this.uuid,this.data,e);return t.parent=void 0,t}},fD=class extends Dn{constructor(e,t,r){super(e,t,r),this.uuid=e,this.data=t,this._textHeight=0,this._textHeightDirty=!0,this.width=0,this.height=0,this.updateState(t,r)}get textHeight(){return this._textHeight}applyFillStroke(e){e.fillColor=this.fill.enabled?this.fill.color:ri.transparent,e.strokeColor=this.stroke.enabled&&this.stroke.thickness>0?this.stroke.color:ri.transparent,e.strokeMode="center",e.lineWidth=this.stroke.thickness}innerDraw(e){var a;(a=this._fontHolder)!=null&&a.arrayBuffer&&this._fontHolder.arrayBuffer.byteLength>1&&this.data.font&&e.registerFont(this._fontHolder.arrayBuffer,this.data.font);let t=this.data.textTransform,r=this.data.text.textValue.toString(),i=t===2?r.toUpperCase():t===3?r.toLowerCase():r,{height:n}=e.drawText(i,{x:0,y:0,width:this.width,height:this.height,fontSize:this.data.fontSize,lineHeight:this.data.lineHeight??1,letterSpacing:this.data.letterSpacing??0,horizontalAlign:this.data.horizontalAlign,verticalAlign:this.data.verticalAlign,font:this.data.font});this._textHeight=n}getCenter(){return[this.width*.5,this.height*.5]}getHalfSize(){return[this.width*.5,this.height*.5]}updateSizeState(e){let t=!1;e.width!==void 0&&(this.width=typeof e.width=="number"?e.width:this.width,t=!0),e.height!==void 0&&(this.height=typeof e.height=="number"?e.height:this.height,t=!0),t&&this.updateWorldMatrix(!0,!1,!0)}updateFontState(e,{shared:t}){e.font!==void 0&&(this._fontHolder=t.getFont(e.font),this._fontHolder&&!this._fontHolder.isLoaded&&this._fontHolder.loadingPromise.then(()=>{this.requestRender()}))}updateState(e,t){super.updateState(e,t),this.updateSizeState(e),this.updateFontState(e,t)}clone(e){let t=new fD(this.uuid,this.data,e);return t.parent=void 0,t}},YH=class extends Dn{constructor(e,t,r){super(e,t,r),this.uuid=e,this.data=t,this.curves=[],this.extremasBBox={min:[0,0],max:[0,0]},this.updateState(t,r)}computeExtremas(){this.curves.length===0&&this.computeCurves();let e=this.curves.map(i=>i1.extremas(i)),t=[1/0,1/0],r=[-1/0,-1/0];for(let i=0,n=e.length;i<n;i++){let a=e[i];a[0][0]<t[0]&&(t[0]=a[0][0]),a[0][1]<t[1]&&(t[1]=a[0][1]),a[1][0]>r[0]&&(r[0]=a[1][0]),a[1][1]>r[1]&&(r[1]=a[1][1])}return this.extremasBBox.min=[t[0],t[1]],this.extremasBBox.max=[r[0],r[1]],this.extremasBBox}computeCurves(){this.curves=[];for(let r=1,i=this.data.points.length;r<i;r++){let n=this.data.points[r].data,a=this.data.points[r-1].data,o={start:a.position,cp1:a.controlNext.position,cp2:n.controlPrevious.position,end:n.position};this.curves.push(o)}let e=this.data.points[0].data,t=this.data.points[this.data.points.length-1].data;if(this.data.isClosed){let r={start:t.position,cp1:t.controlNext.position,cp2:e.controlPrevious.position,end:e.position};this.curves.push(r)}}getCenter(){let[e,t]=this.extremasBBox.min,[r,i]=this.getHalfSize();return[e+r,t+i]}getHalfSize(){let{min:e,max:t}=this.extremasBBox;return[(t[0]-e[0])*.5,(t[1]-e[1])*.5]}innerDraw(e){for(let i=0,n=this.data.points.length;i<n;i++){let a=this.data.points[i].data;if(i===0){let[o,s]=a.position;e.moveTo(o,s)}else{let o=this.data.points[i-1].data,[s,l]=o.controlNext.position,[c,d]=a.controlPrevious.position,[u,h]=a.position,f={start:o.position,cp1:o.controlNext.position,cp2:a.controlPrevious.position,end:a.position};i1.derive(f),e.bezierCurveTo(s,l,c,d,u,h)}}let t=this.data.points[0].data,r=this.data.points[this.data.points.length-1].data;if(this.data.isClosed){let[i,n]=r.controlNext.position,[a,o]=t.controlPrevious.position,[s,l]=t.position;e.bezierCurveTo(i,n,a,o,s,l)}}updateState(e,t){super.updateState(e,t),this.computeExtremas()}clone(e){let t=new YH(this.uuid,this.data,e);return t.parent=void 0,t}},i1;(e=>{function t(o){let s=o.start,l=o.cp1,c=o.cp2,d=o.end,u=[3*(l[0]-s[0]),3*(l[1]-s[1])],h=[3*(c[0]-l[0]),3*(c[1]-l[1])],f=[3*(d[0]-c[0]),3*(d[1]-c[1])],p={start:u,cp:h,end:f};return o.derivative=p,p.derivative=cE.derive(p),p}e.derive=t;function r(o,s,l,c=!1){let d=o-2*s+l;if(d!==0){let u=-Math.sqrt(Math.abs(s*s-o*l)),h=-o+s,f=-(u+h)/d,p=-(-u+h)/d;return[f,p]}else if(s!==l&&d===0)return[(2*s-l)/(2*(s-l))];return[]}function i(o){let s=o.derivative??e.derive(o),l=s.start,c=s.cp,d=s.end;return[r(l[0],c[0],d[0]),r(l[1],c[1],d[1])]}e.droot=i;function n(o){let[s,l]=e.droot(o),c=[o.start[0],o.end[0]],d=[o.start[1],o.end[1]];for(let u of s)c.push(e.compute(o,Math.min(1,Math.max(0,u)))[0]);for(let u of l)d.push(e.compute(o,Math.min(1,Math.max(0,u)))[1]);return c.sort((u,h)=>u-h),d.sort((u,h)=>u-h),[[c[0],d[0]],[c[c.length-1],d[d.length-1]]]}e.extremas=n;function a(o,s){if(s===0)return[...o.start];if(s===1)return[...o.end];let l=1-s,c=l*l,d=s*s,u=c*l,h=c*s*3,f=l*d*3,p=s*d;return[u*o.start[0]+h*o.cp1[0]+f*o.cp2[0]+p*o.end[0],u*o.start[1]+h*o.cp1[1]+f*o.cp2[1]+p*o.end[1]]}e.compute=a})(i1||(i1={}));var cE;(e=>{function t(n){let a=n.start,o=n.cp,s=n.end,l=[2*(o[0]-a[0]),2*(o[1]-a[1])],c=[2*(s[0]-o[0]),2*(s[1]-o[1])],d={start:l,end:c};return d.derivative=dE.derive(d),n.derivative=d,d}e.derive=t;function r(n){let a=n.derivative??e.derive(n),o=a.start,s=a.end;return[o[0]!==s[0]?o[0]/(o[0]-s[0]):0,o[1]!==s[1]?o[1]/(o[1]-s[1]):0]}e.droot=r;function i(n,a){if(a===0)return[...n.start];if(a===1)return[...n.end];let o=1-a,s=o*o,l=a*a,c=s,d=o*a*2,u=l;return[c*n.start[0]+d*n.cp[0]+u*n.end[0],c*n.start[1]+d*n.cp[1]+u*n.end[1]]}e.compute=i})(cE||(cE={}));var dE;(e=>{function t(i){let n=i.start,a=i.end,o=[a[0]-n[0],a[1]-n[1]];return i.derivative=o,i.derivative}e.derive=t;function r(i,n){if(n===0)return[...i.start];if(n===1)return[...i.end];let a=i.start,o=i.end;return[a[0]+(o[0]-a[0])*n,a[1]+(o[1]-a[1])*n]}e.compute=r})(dE||(dE={}));var tl=class extends es{constructor(e,t,r){super(e,t,r),this.uuid=e,this.width=0,this.height=0,this.clipped=!0,this.background=new n0(e+"-background",yg.defaultData,r),this.background.parent=this,this.updateState(t,r)}get fill(){return this.background.fill}get stroke(){return this.background.stroke}get backgroundBlur(){return this.background.backgroundBlur}get layerBlur(){return this.background.layerBlur}get dropShadow(){return this.background.dropShadow}get innerShadow(){return this.background.innerShadow}get cornerRadius(){return this.background.cornerRadius}set cornerRadius(e){this.background.cornerRadius=e}updateLocalMatrix(){var e;super.updateLocalMatrix(),(e=this.background)==null||e.updateLocalMatrix()}updateWorldMatrix(e,t,r){var i;super.updateWorldMatrix(e,t,r),(i=this.background)==null||i.updateWorldMatrix(e,t,r)}draw(e){if(!this.visible)return;e.save();let t=this.width,r=this.height;this.applyTransforms(e),this.background.width=t,this.background.height=r,this.background.draw(e),this.clipped&&e.clipRect(0,0,t,r,...this.cornerRadius),this.innerDrawChildren(e),e.restore()}getCenter(){return[this.width*.5,this.height*.5]}getHalfSize(){return[this.width*.5,this.height*.5]}updateCornerState(e){e.cornerRadius!==void 0&&(this.cornerRadius=e.cornerRadius)}updateSizeState(e){let t=!1;e.width!==void 0&&(this.width=typeof e.width=="number"?e.width:this.width,t=!0),e.height!==void 0&&(this.height=typeof e.height=="number"?e.height:this.height,t=!0),t&&this.updateWorldMatrix(!0,!1,!0)}updateState(e,t){super.updateState(e,t),this.updateSizeState(e),this.updateCornerState(e),e.fill!==void 0&&this.fill.update(e.fill),e.stroke!==void 0&&this.stroke.update(e.stroke),e.dropShadow!==void 0&&this.dropShadow.update(e.dropShadow),e.innerShadow!==void 0&&this.innerShadow.update(e.innerShadow),e.layerBlur!==void 0&&this.layerBlur.update(e.layerBlur),e.backgroundBlur!==void 0&&this.backgroundBlur.update(e.backgroundBlur),e.clipped!==void 0&&(this.clipped=e.clipped)}requestRender(){super.requestRender(),this.dispatchEvent({type:"render"})}dispose(){this.removeEventListener("render")}updateByPatchedOp(e,t,r){super.updateByPatchedOp(e,t,r),e.type===0&&(si(e.path,["fill"])?this.fill.update(e.props):si(e.path,["stroke"])?this.stroke.update(e.props):si(e.path,["dropShadow"])?this.dropShadow.update(e.props):si(e.path,["innerShadow"])?this.innerShadow.update(e.props):si(e.path,["layerBlur"])?this.layerBlur.update(e.props):si(e.path,["backgroundBlur"])?this.backgroundBlur.update(e.props):this.resetBBoxNeedsUpdate())}clone(e){let t=new tl(this.uuid,this.data,e);t.parent=void 0;for(let r of this.children)t.add(r.clone(e));return t}},CLe=fc(J6(),1),gw=class extends Dn{constructor(e,t,r){super(e,t,r),this.uuid=e,this.data=t,this._pathBBox=new DOMRect,this.path="",this.updateState(t,r),this.autoClose=!1,this.computeSVGBBox()}computeSVGBBox(){let e=document.createElementNS("http://www.w3.org/2000/svg","svg"),t=document.createElementNS("http://www.w3.org/2000/svg","path");document.body.appendChild(e),t.setAttribute("d",this.path),e.appendChild(t),this._pathBBox=t.getBBox(),e.remove()}innerDraw(e){e.path(this.path)}intersectsInLocalSpace(e,t){return e>=this._pathBBox.x&&e<=this._pathBBox.x+this._pathBBox.width&&t>=this._pathBBox.y&&t<=this._pathBBox.y+this._pathBBox.height}getCenter(){return[(this._pathBBox.x+this._pathBBox.width)/2,(this._pathBBox.y+this._pathBBox.height)/2]}getHalfSize(){return[(this._pathBBox.x+this._pathBBox.width)/2,(this._pathBBox.y+this._pathBBox.height)/2]}updateState(e,t){super.updateState(e,t),e.path!==void 0&&(this.path=e.path,this.computeSVGBBox())}clone(e){let t=new gw(this.uuid,this.data,e);return t.parent=void 0,t}};function _Le(e,t=1,r=1){if(t<=0||r<=0)return e;let i=(0,CLe.parseSVG)(e).map(n=>{let a={...n};return"x"in a&&(a.x=a.x*t),"y"in a&&(a.y=a.y*r),"x1"in a&&(a.x1=a.x1*t),"x2"in a&&(a.x2=a.x2*t),"y1"in a&&(a.y1=a.y1*r),"y2"in a&&(a.y2=a.y2*r),"rx"in a&&(a.rx=a.rx*t),"ry"in a&&(a.ry=a.ry*r),a});return ALe(i)}function ALe(e){let t=["rx","ry","xAxisRotation","largeArc","sweep","x1","y1","x2","y2","x","y"],r;return e.map(i=>{let n=[];t.forEach(o=>{if(o in i){let s=i[o]*1;n.length&&s>=0&&n.push(","),n.push(s)}});let a=(r===i.code?n[0]<0?"":",":i.code)+n.join("");return r=i.code,a}).join("")}function MLe(e,t,r){switch(t.type){case"ellipse2d":return new hD(e,t,r);case"rectangle2d":return new n0(e,t,r);case"text2d":return new fD(e,t,r);case"vector2d":return new YH(e,t,r);case"path2d":return new gw(e,t,r);case"frame2d":return new tl(e,t,r);case"group2d":default:return new Md(e,t,r)}}var XH=class{constructor(e,t,r){this.uuid=e,this.data=t,this.group=new Md(XH.GROUP_ID,{...Xx.defaultData},r),this.createChildrenObjects(t.objects,this.group,r)}createObject(e,t,r,i,n,a){let o=MLe(e,t,a);o&&(i.add(o),i.children.splice(n,0,i.children.pop()),o.updateWorldMatrix(),r.length>0&&(o instanceof Md||o instanceof tl)&&this.createChildrenObjects(r,o,a))}createChildrenObjects(e,t,r){let i=0;for(let n of e)this.createObject(n.id,n.data,n.children,t,i,r),i+=1}draw(e){this.group.draw(e)}updateEntityByOp(e,t,r,i){let n=this.find(e);if(n)try{n.updateByOp(t,r,{shared:i})}catch(a){console.error(a)}}updateTreeByOp(e,t){if(e.path.length===0&&e.type===7){let r=e.parent===null?this.group:this.find(e.parent);r!==void 0&&r instanceof es&&(this.createObject(e.id,e.data,e.children,r,e.localIndex,t),r.requestRender())}else if(e.path.length===0&&e.type===8){let r=this.find(e.id);if(r!==void 0&&r.parent!==void 0&&r.parent instanceof es){let i=r.parent;r.resetBBoxNeedsUpdate(),i==null||i.remove(r),i==null||i.requestRender()}}else if(e.path.length===0&&e.type===9){let r=this.find(e.id);if(r!==void 0){let i=r.parent,n=e.parent===null?this:this.find(e.parent);if(n instanceof es||n===this){n.add(r);let a=e.localIndex;n.children.splice(a,0,n.children.pop()),r.updateWorldMatrix(!0,!1,!0),i==null||i.requestRender(),r.requestRender()}r.resetBBoxNeedsUpdate()}}}add(e){this.group.add(e)}remove(e){this.group.remove(e)}traverse(e){this.group.traverse(t=>{t!==this.group&&e(t)})}intersectsChildren(e,t,r,i=!1,n=[]){return this.group.intersectsChildren(e,t,r,i,n,!0)}intersectsChildrenReverse(e,t,r,i=!1,n=[]){return this.group.intersectsChildrenReverse(e,t,r,i,n,!0)}find(e){return this.group.find(e)}get children(){return this.group.children}project(e,t){return this.group.project(e,t)}getWithSortKey(e){let t=this.find(e);if(t===void 0)return;let r=[],i=t;for(;i!==this.group;){let n=i;i=i.parent;let a=i.children.indexOf(n);r.splice(0,0,a)}return{entity:t,sortKey:r}}getAllSorted(e){let t=[];for(let r of e){let i=this.getWithSortKey(r.id);i!==void 0&&t.push(i)}return t.sort((r,i)=>OV(r.sortKey,i.sortKey)),t.map(r=>r.entity)}},pD=XH;pD.GROUP_ID="scene2d";function KH({constraints:e,newParentWidth:t,newParentHeight:r,initialParentWidth:i,initialParentHeight:n,objectInitialWidth:a,objectInitialHeight:o,objectInitialPosition:s}){let{horizontalConstraint:l,verticalConstraint:c}=e,d=t-i,u=r-n,h=a,f=o,p=s[0],v=s[1];if(l!==0){if(l===1)p+=d;else if(l===3)p+=d/2;else if(l===2)h=Math.max(1,h+d);else if(l===4){let m=t/i;h*=m,p*=m}}if(c!==0){if(c===1)v+=u;else if(c===3)v+=u/2;else if(c===2)f=Math.max(1,f+u);else if(c===4){let m=r/n;f*=m,v*=m}}return{width:h,height:f,position:[p,v]}}fc(J6(),1);var ELe=`
	varying vec2 vUv;
	void main() {
		vUv = uv;
		gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
	}`,TLe=`
	uniform sampler2D tDiffuse;
	varying vec2 vUv;
	void main() {
		vec4 texel = texture2D( tDiffuse, vUv );
		gl_FragColor = texel;
	}`,PLe=new K1(-1,1,1,-1,0,1),DLe=class extends Ot{constructor(){super(),this.setAttribute("position",new yt([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new yt([0,2,0,0,2,0],2))}},OLe=new DLe,RLe=class{constructor(e){this._mesh=new Di(OLe,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,PLe)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}},QH=new jr({defines:{},uniforms:{tDiffuse:new rt(null)},vertexShader:ELe,fragmentShader:TLe}),ILe=new RLe(QH),o_=null,s_=null,zLe=()=>(o_===null&&(o_=document.createElement("canvas")),o_),kLe=e=>(s_===null&&(s_=new qH(e)),s_),LLe=kr.identity(),ZH=class{constructor(e,t,r,i){this.uuid=e,this.width=t,this.height=r,this.context=i,this.enabled=!0,this.isScreenSpace=!1,this.dpr=window.devicePixelRatio,this.isFrameDirty=!1,this.onRenderRequestedDownstream=()=>{this.isFrameDirty=!0,this.context.shared.requestRender()},this._innerApplySize=()=>{let n=this.width,a=this.height,o=this.dpr;this.renderer.dpr=this.isScreenSpace?o:Math.floor(2048/Math.max(n,a)),this.renderer.setSize(n,a)},this.onFrameOverrideObjectEvent=n=>{var a,o;if(((a=n.target)==null?void 0:a.uuid)!==void 0){let s=(o=this.frameRoot)==null?void 0:o.find(n.target.uuid);s&&s.dispatchEvent({...n,target:s})}},this.scene2d=new pD(St.generateUUID(),IM.defaultData,{dpr:window.devicePixelRatio,shared:i.shared}),this.canvas=zLe(),this.renderer=kLe(this.canvas),this.promise=this.init(),this.renderTarget=new Ur(1,1,{type:ec,stencilBuffer:!1,depthBuffer:!1}),i.shared.addUIBuffer(this.uuid,this.renderTarget),this.textureHolder=i.shared.uiBuffer(this.uuid)}get canvasTexture(){return this._canvasTexture||(this._canvasTexture=new Wxe(this.canvas)),this._canvasTexture}async init(){this.renderer instanceof qH&&(this.renderer.wasmURL=xH.skiaWasmUrl),await this.renderer.init()}render(e){var t,r;if(this.isFrameDirty){this.isFrameDirty=!1,this._innerApplySize(),this.renderer.clear(),(t=this.frameOverride)==null||t.draw(this.renderer),this.renderer.render(),QH.uniforms.tDiffuse.value=this.canvasTexture,this.canvasTexture.needsUpdate=!0;let i=e.getRenderTarget();e.setRenderTarget(this.renderTarget),e.clear(),ILe.render(e),e.setRenderTarget(i),(r=this.textureHolder)==null||r.setNeedsUpdate(!0)}}updateEntity2DByOp(e,t,r,i){this.scene2d.updateEntityByOp(e,t,r,i),this.applySize()}updateTreeByOp(e,t){this.scene2d.updateTreeByOp(e,t),this.applySize()}applyOverrides(e){if(this.frameOverride&&this.frameRoot){this.frameOverride.position=[0,0],this.frameOverride.rotation=0;let t=(e==null?void 0:e.width)??this.width,r=(e==null?void 0:e.height)??this.height;this.frameOverride.width=t,this.frameOverride.height=r,this.frameOverride.localMatrix=LLe,this.isScreenSpace&&(this.frameOverride.fill.color=ri.from0to1([0,0,0,0])),this.frameOverride.data={...this.frameOverride.data,width:t,height:r},JH({objectOverride:this.frameOverride,objectRoot:this.frameRoot,newParentWidth:this.frameOverride.width,newParentHeight:this.frameOverride.height,initialParentWidth:this.frameRoot.width,initialParentHeight:this.frameRoot.height}),this.frameOverride.updateWorldMatrix(!0,!1,!0)}}applySize(e,t=window.devicePixelRatio){var s,l;let r=(e==null?void 0:e.width)??this.width,i=(e==null?void 0:e.height)??this.height;this.dpr=t,this.width=r,this.height=i,this._innerApplySize();let n=1,a=512,o=512;(r*t<a||i*t<o)&&(n=Math.max(a/(r*t),o/(i*t))),this.renderTarget.setSize(r*t*n,i*t*n),(s=this._canvasTexture)==null||s.dispose(),this._canvasTexture=void 0,this.applyOverrides(e),(l=this.frameOverride)==null||l.requestRender()}applyFrame(e){var r,i;let t=this.context.scene.find2D(e);if(!(!t||!(t instanceof tl)))return this.disposeFrameOverride(),this.frameRoot=t,this.frameOverride=t.clone({dpr:this.renderer.dpr,shared:this.context.shared}),this.scene2d.add(this.frameOverride),this.applySize(),(r=this.frame)==null||r.addEventListener("render",this.onRenderRequestedDownstream),this.frameOverride.traverse(n=>{n.addEventListener("beginState",this.onFrameOverrideObjectEvent)}),this.frameOverride.traverse(n=>{n.addEventListener("completeState",this.onFrameOverrideObjectEvent)}),(i=this.frame)==null||i.requestRender(),t}get frame(){return this.frameOverride}get frameId(){var e;return(e=this.frame)==null?void 0:e.uuid}find(e){return this.scene2d.find(e)}get texture(){var e;return(e=this.textureHolder)==null?void 0:e.getTexture(1001)}disposeFrameOverride(){var e,t,r;(e=this.frameOverride)==null||e.removeEventListener("render",this.onRenderRequestedDownstream),(t=this.frameOverride)==null||t.traverse(i=>{i.removeEventListener("beginStateChange",this.onFrameOverrideObjectEvent)}),(r=this.frameOverride)==null||r.traverse(i=>{i.removeEventListener("completeState",this.onFrameOverrideObjectEvent)}),this.frameOverride&&this.scene2d.remove(this.frameOverride)}};function JH({objectOverride:e,objectRoot:t,newParentWidth:r,newParentHeight:i,initialParentWidth:n,initialParentHeight:a}){if(e instanceof tl&&t instanceof tl||e instanceof Md&&t instanceof Md)for(let o=0,s=e.children.length;o<s;o++){let l=e.children[o],c=t.children[o];l&&c&&l.uuid===c.uuid&&FLe({objectOverride:l,objectRoot:c,newParentWidth:r,newParentHeight:i,initialParentWidth:n,initialParentHeight:a})}}function BLe(e){if(uE(e))return[e.width,e.height];if(e instanceof gw){let[t,r]=e.getHalfSize();return[t*2,r*2]}else if(e instanceof Md){let[t,r]=e.recursiveBBox.getHalfSize();return[t*2,r*2]}return[0,0]}function FLe({objectOverride:e,objectRoot:t,newParentWidth:r,newParentHeight:i,initialParentWidth:n,initialParentHeight:a}){let[o,s]=BLe(t),{width:l,height:c,position:d}=KH({constraints:e.data,newParentWidth:r,newParentHeight:i,initialParentWidth:n,initialParentHeight:a,objectInitialWidth:o,objectInitialHeight:s,objectInitialPosition:t.position});if(e.position=d,e.data={...e.data,position:d},e.states)for(let u in e.states)NLe({stateId:u,objectOverride:e,objectRoot:t,newParentWidth:r,newParentHeight:i,initialParentWidth:n,initialParentHeight:a});if(uE(e)||e instanceof Md)uE(e)&&(e.width=l,e.height=c,e.data={...e.data,width:l,height:c}),JH({objectOverride:e,objectRoot:t,newParentWidth:l,newParentHeight:c,initialParentWidth:o,initialParentHeight:s});else if(e instanceof gw){let u=t,h=o!==0?l/o:1,f=s!==0?c/s:1;e.path=_Le(u.path,h,f),e.data={...e.data,path:e.path}}}function NLe({stateId:e,objectOverride:t,objectRoot:r,newParentWidth:i,newParentHeight:n,initialParentWidth:a,initialParentHeight:o}){var c,d;let s=(c=t.states)==null?void 0:c[e],l=(d=r.states)==null?void 0:d[e];if(s&&l){let{width:u,height:h,position:f}=KH({constraints:t.data,newParentWidth:i,newParentHeight:n,initialParentWidth:a,initialParentHeight:o,objectInitialWidth:Hu.isResizeable(l)?l.width:0,objectInitialHeight:Hu.isResizeable(l)?l.height:0,objectInitialPosition:l.position});Object.assign(t.states[e],{position:f}),Hu.isResizeable(s)&&Object.assign(t.states[e],{width:u,height:h})}}function uE(e){return e instanceof n0||e instanceof tl||e instanceof hD||e instanceof fD}var Pn=class extends HP(Js){constructor(e,t,r){super(),this.data=t,this.bgColor=new ia(1,1,1,1),this.fog=null,this.backupFog=new _j(16777215,.1,2e3),this.fogUseBGColor=!1,this.isActive=!1,this.aoColor=new Lt,this.penumbraSizeArrayCache=null,this.super_Entity(e,t),this.personalCamera=new va(Zp,{...mg.defaultData,...t.camera,name:"Personal Camera"}),this.personalCamera.objectHelper.visible=!1,this.add(this.personalCamera),this.activeCamera=this.personalCamera,this.ambientLight=new P1e(13882323,8553090,.75),this.ambientLight.name="Default Ambient Light",this.ambientLight.layers.enable(3),this.ambientLight.removeFromParent(),this.add(this.ambientLight),t.uiScene?this.uiScene=new pD((Array.isArray(e)?e[0]:e)+"-ui",t.uiScene,{dpr:window.devicePixelRatio,shared:r.shared}):t.uiFrame&&this.createUICanvas(t.uiFrame,r)}get scene(){return this.parent}get postprocessing(){return this.data.postprocessing}get frameId(){return this.data.uiFrame}get frame(){var e;return(e=this.uiCanvas)==null?void 0:e.frame}createUICanvas(e,t){this.uiCanvas=new ZH(this.uuid+"-uiscreen",window.innerWidth,window.innerHeight,t),this.uiCanvas.isScreenSpace=!0,this.uiCanvas.promise.then(()=>{var r,i;(r=this.uiCanvas)==null||r.applyFrame(e),(i=this.uiCanvas)==null||i.applySize()})}updateVisible(){}setBackgroundColor(e){this.bgColor=e,this.fogUseBGColor===!0&&(this.backupFog.color=e)}entityChildrenCount(){return this.uiScene?this.uiScene.children.length:super.entityChildrenCount()}updateAmbientLight(e,t){e.color!==void 0&&(this.ambientLight.color=Pa(e.color,t)),e.intensity!==void 0&&(this.ambientLight.intensity=e.intensity),e.enabled!==void 0&&(e.enabled?this.add(this.ambientLight):this.remove(this.ambientLight))}onDeactive(){this.isActive=!1}onActive(e){this.isActive=!0,e.fog=this.fog,this.traverseEntity(t=>{t instanceof sh&&t.recomputeBoolean()}),this.updateShadow(this.data.shadow)}forceMaterialsUpdate(){this.traverseEntity(e=>{if(e instanceof tm)if(Array.isArray(e.material))for(let t of e.material)t.needsUpdate=!0;else e.material.needsUpdate=!0,e.material.dispose()})}updateShadow(e){e.softShadowQuality!==void 0&&this.isActive&&tLe(e.softShadowQuality)&&this.forceMaterialsUpdate()}updateFog(e,t){if(e.enabled?this.fog=this.backupFog:this.fog=null,this.isActive){let r=this.scene;r.fog=this.fog}this.fogUseBGColor=e.useBackgroundColor,e.useBackgroundColor?this.backupFog.color.set(this.bgColor):this.backupFog.color=Pa(e.color,t),this.backupFog.near=e.near,this.backupFog.far=e.far}updateAo(e,t){e.aoColor!==void 0&&(this.aoColor=Pa(e.aoColor,t))}updateByOp(e,t,r,i){let n=this.data.uiFrame;super.updateByOp(e,t,r,i);let a=t;si(e.path,["fog"])?this.updateFog(a.fog,r.shared):si(e.path,["ao"])?this.updateAo(a.ao,r.shared):si(e.path,["ambient"])?this.updateAmbientLight(a.ambient,r.shared):si(e.path,["shadow"])?this.updateShadow(a.shadow):e.type===0&&e.path.length===0&&(e.props.uiFrame!==void 0||n!==a.uiFrame)&&this.updateUIFrame(e.props.uiFrame,r)}updateUIFrame(e,t){e?(this.uiCanvas||this.createUICanvas(e,t),this.uiCanvas.enabled=!0,this.uiCanvas.applyFrame(e)):this.uiCanvas&&(this.uiCanvas.enabled=!1)}updateState(e,t){this.updateState_Entity(e,t),e.backgroundColor!==void 0&&this.setBackgroundColor(Pa(e.backgroundColor,t.shared)),e.fog!==void 0&&this.updateFog(e.fog,t.shared),e.ambient!==void 0&&this.updateAmbientLight(e.ambient,t.shared),e.ao!==void 0&&this.updateAo(e.ao,t.shared),e.shadow!==void 0&&this.updateShadow(e.shadow)}createFrame(e,t){}raycast(e,t){super.raycast(e,t)}switchActiveCamera(e){e&&e.isDescendantOf(this)&&(this.activeCamera!==this.personalCamera&&(this.activeCamera.objectHelper.visible=!0),this.activeCamera=e,e.objectHelper.visible=!1)}get playCamera(){var e;return((e=this.scene)==null?void 0:e.find(this.data.publish.playCamera))??this.personalCamera}switchToPlayCamera(){this.switchActiveCamera(this.playCamera)}get penumbraSizeArray(){return this.penumbraSizeArrayCache===null&&this.updatePenumbraSizeArray(),this.penumbraSizeArrayCache}updatePenumbraSizeArray(){this.penumbraSizeArrayCache=new Array(5).fill(.5);let e=0,t=0;this.traverseEntity(r=>{if(!r.visible)return!0;r instanceof HH&&r.visible&&e<3&&(this.penumbraSizeArrayCache[e]=r.data.penumbraSize??.5,e+=1),r instanceof WH&&r.visible&&e<2&&(this.penumbraSizeArrayCache[3+t]=r.data.penumbraSize??.5,t+=1)})}raycastWithClones(e){let t=[],r=i=>{for(let n of i.children){let a=n.cloner;Cr.is(n)&&(n.visible||a!=null&&a.object.data.visible)&&((Jo(n)||tE(n)&&this.scene.enableHelpers&&n.objectHelper.visible)&&(e.intersectObject(n,!1,t),hE(n,e,t,!0)),r(n))}};return r(this),t}updateEntity2DByOp(e,t,r,i){var n;(n=this.uiCanvas)==null||n.updateEntity2DByOp(e,t,r,i)}},ULe=class extends cD(I1e,UH){constructor(e,t,r){super(),this.super_Entity(e,t),this.castShadow=!0,this.shadow.mapSize.width=1024,this.shadow.mapSize.height=1024,this.shadow.normalBias=1,this.layers.enable(3);let i=this.shadow.camera;i.fov=90,i.aspect=1,i.near=100,i.far=2500;let n=new k(-i.far+this.position.x,-i.far+this.position.y,-i.far+this.position.z),a=new k(i.far+this.position.x,i.far+this.position.y,i.far+this.position.z),o=new Zi(n,a),s=new xx(o,new Lt(16755200));s.visible=!1,this.gizmos.shadowmap=s,this.update()}update(){if(this.shadow&&(this.shadow.camera.updateProjectionMatrix(),this.gizmos))for(let e in this.gizmos){let t=this.gizmos[e];if(t instanceof xx){let r=this.shadow.camera,i=new k(-r.far+this.position.x,-r.far+this.position.y,-r.far+this.position.z),n=new k(r.far+this.position.x,r.far+this.position.y,r.far+this.position.z);t.box.set(i,n),t.updateMatrixWorld(!0)}}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.objectHelper&&this.objectHelper.update()}updateState(e,t){this.updateState_Light(e,t),e.distance!==void 0&&(this.distance=e.distance),e.decay!==void 0&&(this.decay=e.decay),e.shadowRadius!==void 0&&(this.shadow.radius=e.shadowRadius),e.shadowResolution!==void 0&&(this.shadow.mapSize.set(e.shadowResolution,e.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null))}},jLe=class extends ma{get forceComputeSize(){return!0}get shape(){return this.geometry.userData.shape}updateEntityBoxSize(e,t){let r=this.geometry.getAttribute("position");r!==void 0?QP(r,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:r.count,e,t):super.updateEntityBoxSize(e,t)}},mD=class extends ma{constructor(e,t,r){super(e,t,r),this._shapeId=null,this._context=r}updateState(e,t){super.updateState(e,t),this.updateShape()}updateShape(){var i;let e={...this.data.geometry.extrusion.shape};for(let n in e)typeof e[n]=="string"&&(e[n]=this._context.shared.getVariable(e[n],[this.uuid,"geometry","extrusion","shape",n]));let t;if(e.type==="Custom"){let n=e.shapeId;if(n!==this._shapeId&&this.detachShape(),n){this._shapeId=n;let a=this._context.scene.find(n);a!=null&&a.data&&(a.attachedPaths.add(this),t=(i=a.geometry.userData)==null?void 0:i.shape),t||this._context.scene.addPendingCommand(()=>this.updateShape())}}else{let n;switch(e.type){case"Rectangle":n=KP;break;case"Ellipse":n=XP;break;case"Polygon":n=F8;break;case"Star":n=N8;break;default:throw new Error(`Unknown shape type: ${e.type}`)}t=n.create({parameters:e}).userData.shape}let r=this.geometry;t&&r.inputs&&(r.inputs.shapeData=t,r.build(),this.attachedSurfaceCloners.forEach(n=>n.update()))}detachShape(){var e;this._shapeId!==null&&((e=this._context.scene.find(this._shapeId))==null||e.attachedPaths.delete(this))}createGeometryDelayed(e){this.geometryCreateDeleyed=e.shared,this.updateShape(),this.refreshAttachedPaths(e)}updateTransformState(e,t){return super.updateTransformState(e,t)}updateGeometryInteractions(e,t){super.updateGeometryInteractions(e,t),this.updateShape()}updateEntityBoxSize(e,t){let r=this.geometry.getAttribute("position");r!==void 0?QP(r,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:r.count,e,t):super.updateEntityBoxSize(e,t)}},vD=class extends lD{constructor(e,t,r){super(e,t,r),this.data=t}},Jf=class extends rm($l,r0){constructor(e,t,r){super(),t.type==="Instance"&&typeof e=="string"&&(t=this.transformAssignData(t,r)),this.super_Entity(e,t),this.objectHelper.update()}get isComponentRoot(){return this.data.type==="Component"&&typeof this.identity=="string"}get isInstanceRoot(){return this.data.type==="Instance"&&typeof this.identity=="string"}transformAssignData(e,t){let r=Gx.getComponentData({scene:t.scene.data,shared:t.shared.data},e.component);if(r){let i,n;for(let a of rd.rootOverrideProps)e[a]===void 0?(i===void 0&&(i={...e}),i[a]=r.data[a]):(n===void 0&&(n={}),n[a]=e[a],i===void 0&&(i={...e}),i[a]=fd.apply(r.data[a],e[a]));return this.overrideData=n,i}else return{...Bn.defaultData,...e,...Kl(Bn.defaultData,rd.rootOverrideProps)}}updateByOp(e,t,r,i){let n;if(this.isInstanceRoot&&!i){if(t=this.transformAssignData(t,r),e.type===0&&e.path.length===0&&this.component)for(let a of rd.rootOverrideProps)a in e.props&&e.props[a]===void 0&&(n===void 0&&(n={...e,props:{...e.props}}),n.props[a]=this.component.data[a]);else if(e.type===0&&e.path.length>0&&rd.rootOverrideProps.includes(e.path[0])){let a=e.path[0];n===void 0&&(n={...e,path:[],props:{[a]:t[a]}})}}super.updateByOp(n??e,t,r,i)}updateState(e,t){this.updateState_Entity(e,t)}expandInstanceChildren(e){let t=this.data;if(this.component===void 0){let r=e.scene.find(t.component)??null,i=!1;if(r!==this.oldComponent){if(this.oldComponent){let n=0;for(let a of this.children)if(Cr.is(a))e.scene.disposeAndUnregisterEntityRecursivelyIfNotReregistered(a),gD(a),n+=1;else break;this.children.splice(0,n)}i=!0}if(r){let n={};eW(e,[this.uuid],t.overrides,this,r,r,0,i,n);for(let a of this.children)if(Cr.is(a)){let o=a.data;o.type==="Empty"&&o.animations&&a.traverseEntity(s=>{let l=s.dataPatched;if(s instanceof ma&&l.bones&&l.boneInverses){let c=s.dataPatched;if(c.bones&&c.boneInverses){let d=c.bones.map(f=>e.scene.find(n[f])),u=c.boneInverses.map(f=>new it().fromArray(f)),h=new nP(d,u);s.bind(h,s.bindMatrix)}}else s.matrixAutoUpdate=!0})}}this.oldComponent=this.component}}};function gD(e){if(e.component){let t=e.component.instances.indexOf(e);t>=0&&e.component.instances.splice(t,1);for(let r of e.children)Cr.is(r)&&gD(r)}}function ZB(e,t,r,i){return e.component===t&&DP(e.identity,i)?e.overrideData===r?2:1:0}function eW(e,t,r,i,n,a,o,s,l){if(o>50)return!1;if(i.component!==n){if(i.component){let d=i.component.instances.indexOf(i);d>=0&&i.component.instances.splice(d,1)}n.instances.find(d=>d===i)||n.instances.push(i),i.component=n}n instanceof Jf&&n.isInstanceRoot&&n.expandInstanceChildren(e);let c=0;for(let d of n.children)if(Cr.is(d)){let u=[...t,...typeof d.identity=="string"?[d.identity]:d.identity],h=jx.resolve(r,u,1);h!=null&&!(h instanceof cn)&&(Object.setPrototypeOf(h,cn.prototype),console.error("wrong prototype"));let f=null,p;if(!s){let v=i.children[c];if(f=Cr.is(v)?v:null,f!==null){let m=ZB(f,d,h,u);p=m>=1?f.stateSelection:void 0,m!==2&&(f=null)}if(f===null&&(f=e.scene.findInstance(u)??null,f!==null)){let m=ZB(f,d,h,u);if(p=m>=1?f.stateSelection:void 0,m!==2)f=null;else{let g=f.parent.children.indexOf(f);f.parent.children.splice(g,1),i.children.splice(c,0,f),f.parent===i?g<=c&&console.error("not possible"):(f.parent=i,f.matrixWorldNeedsUpdate=!0,f.resetBBoxNeedsUpdate(),f.updateVisible(),e.pendingDeletes.delete(f))}}}if(f===null){let v=h?fd.apply(d.data,h):d.data;ah.is(v.type)&&(v={...v,type:"Empty"}),f=nd.createEntity(u,v,e),f.overrideData=h,i.add(f),i.children.splice(i.children.length-1,1),i.children.splice(c,0,f),f.updateState(f.data,e),p&&f.changeSelectedState(p,e),e.scene.registerInstanceAndSetUuid(f)}if(f.isBone){let v=f.identity[f.identity.length-1];l[v]=f.uuid}c+=1,eW(e,t,r,f,d,a,o+1,s,l)}if(!s){let d=c;for(;;){let u=i.children[c];if(Cr.is(u))e.pendingDeletes.add(u);else break;c+=1}i.children.splice(d,c-d)}return!0}var VLe=class extends rm(Aj,r0){constructor(e,t){super(),this.super_Entity(e,t),this.objectHelper.update(),this.matrixAutoUpdate=!0}updateState(e,t){this.updateState_Entity(e,t)}},ha=class extends ma{constructor(e,t,r){super(e,t,r),this.onBeforeRender=i=>{this.uiCanvas.render(i)},this.uiCanvas=new ZH(e+"-canvas",t.geometry.width,t.geometry.height,r),this.uiCanvas.promise.then(()=>{this.applyFrame(this.dataPatched.geometry.frame,r.shared)})}updateByPatchedOpGeometry(e,t,r){super.updateByPatchedOpGeometry(e,t,r),e.type===0&&(e.props.frame!==void 0&&this.applyFrame(e.props.frame,r.shared),(e.props.width!==void 0||e.props.height!==void 0)&&this.applySize(e.props,r.shared))}applySize(e,t){let r=(e==null?void 0:e.width)??this.dataPatched.geometry.width,i=(e==null?void 0:e.height)??this.dataPatched.geometry.height;this.uiCanvas.applySize({width:r,height:i}),this.applyGeometryParametersFromFrame(t)}applyFrame(e,t){this.uiCanvas.applyFrame(e),this.applyGeometryParametersFromFrame(t),this.applyMaterialParametersFromFrame({shared:t})}applyGeometryParametersFromFrame(e){var r;let t=this.frame;t&&(Object.assign(this.data,{geometry:Object.assign(this.data.geometry,{cornerRadius:t.cornerRadius,cornerType:0})}),Object.assign(this.dataPatched,{geometry:Object.assign(this.dataPatched.geometry,{cornerRadius:t.cornerRadius,cornerType:0})}),(r=this.localGeometry)==null||r.dispose(),this.localGeometry=Cg(this.dataPatched.geometry,e,this.data.flatShading,this))}applyMaterialParametersFromFrame(e){let t=this.frame;if(t){let r=t.data.backgroundBlur;Object.assign(this.data.material.layers[0].data.texture,{image:this.uiCanvas.uuid}),Object.assign(this.data.material.layers[1].data,{roughness:r.radius,alpha:r.enabled?1:0}),Object.assign(this.dataPatched.material.layers[0].data.texture,{image:this.uiCanvas.uuid}),Object.assign(this.dataPatched.material.layers[1].data,{roughness:r.radius,alpha:r.enabled?1:0}),this.material.reset(this.dataPatched.material,e,!0)}}updateEntity2DByOp(e,t,r,i){this.uiCanvas.updateEntity2DByOp(e,t,r,i),e===this.frameId&&t.type===0&&(t.props.cornerRadius!==void 0?this.applyGeometryParametersFromFrame(i):si(t.path,["backgroundBlur"])&&this.applyMaterialParametersFromFrame({shared:i}))}get frame(){return this.uiCanvas.frame}get frameId(){var e;return(e=this.frame)==null?void 0:e.uuid}removeInteractionGeometry(e){super.removeInteractionGeometry(e),this.applySize({},e)}updateGeometryInteractions(e,t){super.updateGeometryInteractions(e,t),this.applySize({width:e.width,height:e.height},t)}},HLe=class{constructor(e,t,r){this.variables=[],this.currentTextureIndex=0;let i=on,n=new Js,a=new xh;a.position.z=1;let o={passThruTexture:{value:null}},s=d(h(),o),l=new Di(new rc(2,2),s);n.add(l),this.setDataType=function(f){return i=f,this},this.addVariable=function(f,p,v){let m=this.createShaderMaterial(p),g={name:f,initialValueTexture:v,material:m,dependencies:null,renderTargets:[],wrapS:null,wrapT:null,minFilter:Hr,magFilter:Hr};return this.variables.push(g),g},this.setVariableDependencies=function(f,p){f.dependencies=p},this.init=function(){if(r.capabilities.isWebGL2===!1&&r.extensions.has("OES_texture_float")===!1)return"No OES_texture_float support for float textures.";if(r.capabilities.maxVertexTextures===0)return"No support for vertex shader textures.";for(let f=0;f<this.variables.length;f++){let p=this.variables[f];p.renderTargets[0]=this.createRenderTarget(e,t,p.wrapS,p.wrapT,p.minFilter,p.magFilter),p.renderTargets[1]=this.createRenderTarget(e,t,p.wrapS,p.wrapT,p.minFilter,p.magFilter),this.renderTexture(p.initialValueTexture,p.renderTargets[0]),this.renderTexture(p.initialValueTexture,p.renderTargets[1]);let v=p.material,m=v.uniforms;if(p.dependencies!==null)for(let g=0;g<p.dependencies.length;g++){let y=p.dependencies[g];if(y.name!==p.name){let b=!1;for(let x=0;x<this.variables.length;x++)if(y.name===this.variables[x].name){b=!0;break}if(!b)return"Variable dependency not found. Variable="+p.name+", dependency="+y.name}m[y.name]={value:null},v.fragmentShader=`
uniform sampler2D `+y.name+`;
`+v.fragmentShader}}return this.currentTextureIndex=0,null},this.compute=function(){let f=this.currentTextureIndex,p=this.currentTextureIndex===0?1:0;for(let v=0,m=this.variables.length;v<m;v++){let g=this.variables[v];if(g.dependencies!==null){let y=g.material.uniforms;for(let b=0,x=g.dependencies.length;b<x;b++){let S=g.dependencies[b];y[S.name].value=S.renderTargets[f].texture}}this.doRenderTarget(g.material,g.renderTargets[p])}this.currentTextureIndex=p},this.getCurrentRenderTarget=function(f){return f.renderTargets[this.currentTextureIndex]},this.getAlternateRenderTarget=function(f){return f.renderTargets[this.currentTextureIndex===0?1:0]},this.dispose=function(){l.geometry.dispose(),l.material.dispose();let f=this.variables;for(let p=0;p<f.length;p++){let v=f[p];v.initialValueTexture&&v.initialValueTexture.dispose();let m=v.renderTargets;for(let g=0;g<m.length;g++)m[g].dispose()}};function c(f){f.defines.resolution="vec2( "+e.toFixed(1)+", "+t.toFixed(1)+" )"}this.addResolutionDefine=c;function d(f,p){p=p||{};let v=new jr({uniforms:p,vertexShader:u(),fragmentShader:f});return c(v),v}this.createShaderMaterial=d,this.createRenderTarget=function(f,p,v,m,g,y){return f=f||e,p=p||t,v=v||Si,m=m||Si,g=g||Hr,y=y||Hr,new Ur(f,p,{wrapS:v,wrapT:m,minFilter:g,magFilter:y,format:In,type:i,depthBuffer:!1})},this.createTexture=function(){let f=new Float32Array(e*t*4),p=new Po(f,e,t,In,on);return p.needsUpdate=!0,p},this.renderTexture=function(f,p){o.passThruTexture.value=f,this.doRenderTarget(s,p),o.passThruTexture.value=null},this.doRenderTarget=function(f,p){let v=r.getRenderTarget(),m=r.xr.enabled,g=r.shadowMap.autoUpdate,y=r.outputEncoding,b=r.toneMapping;r.xr.enabled=!1,r.shadowMap.autoUpdate=!1,r.outputEncoding=hs,r.toneMapping=Zs,l.material=f,r.setRenderTarget(p),r.render(n,a),l.material=s,r.xr.enabled=m,r.shadowMap.autoUpdate=g,r.outputEncoding=y,r.toneMapping=b,r.setRenderTarget(v)};function u(){return`void main()	{

	gl_Position = vec4( position, 1.0 );

}
`}function h(){return`uniform sampler2D passThruTexture;

void main() {

	vec2 uv = gl_FragCoord.xy / resolution.xy;

	gl_FragColor = texture2D( passThruTexture, uv );

}
`}}},Wn=new Zn,Xy=new k,WLe=class{constructor(e){let t=e.geometry;if(!t.isBufferGeometry||t.attributes.position.itemSize!==3)throw new Error("THREE.MeshSurfaceSampler: Requires BufferGeometry triangle mesh.");t.index&&(console.warn("THREE.MeshSurfaceSampler: Converting geometry to non-indexed BufferGeometry."),t=t.toNonIndexed()),this.geometry=t,this.randomFunction=Math.random,this.positionAttribute=this.geometry.getAttribute("position"),this.colorAttribute=this.geometry.getAttribute("color"),this.weightAttribute=null,this.distribution=null}setWeightAttribute(e){return this.weightAttribute=e?this.geometry.getAttribute(e):null,this}build(){let e=this.positionAttribute,t=this.weightAttribute,r=new Float32Array(e.count/3);for(let n=0;n<e.count;n+=3){let a=1;t&&(a=t.getX(n)+t.getX(n+1)+t.getX(n+2)),Wn.a.fromBufferAttribute(e,n),Wn.b.fromBufferAttribute(e,n+1),Wn.c.fromBufferAttribute(e,n+2),a*=Wn.getArea(),r[n/3]=a}this.distribution=new Float32Array(e.count/3);let i=0;for(let n=0;n<r.length;n++)i+=r[n],this.distribution[n]=i;return this}setRandomGenerator(e){return this.randomFunction=e,this}sample(e,t,r){let i=this.distribution[this.distribution.length-1],n=this.binarySearch(this.randomFunction()*i);return this.sampleFace(n,e,t,r)}binarySearch(e){let t=this.distribution,r=0,i=t.length-1,n=-1;for(;r<=i;){let a=Math.ceil((r+i)/2);if(a===0||t[a-1]<=e&&t[a]>e){n=a;break}else e<t[a]?i=a-1:r=a+1}return n}sampleFace(e,t,r,i){let n=this.randomFunction(),a=this.randomFunction();return n+a>1&&(n=1-n,a=1-a),Wn.a.fromBufferAttribute(this.positionAttribute,e*3),Wn.b.fromBufferAttribute(this.positionAttribute,e*3+1),Wn.c.fromBufferAttribute(this.positionAttribute,e*3+2),t.set(0,0,0).addScaledVector(Wn.a,n).addScaledVector(Wn.b,a).addScaledVector(Wn.c,1-(n+a)),r!==void 0&&Wn.getNormal(r),i!==void 0&&this.colorAttribute!==void 0&&(Wn.a.fromBufferAttribute(this.colorAttribute,e*3),Wn.b.fromBufferAttribute(this.colorAttribute,e*3+1),Wn.c.fromBufferAttribute(this.colorAttribute,e*3+2),Xy.set(0,0,0).addScaledVector(Wn.a,n).addScaledVector(Wn.b,a).addScaledVector(Wn.c,1-(n+a)),i.r=Xy.x,i.g=Xy.y,i.b=Xy.z),this}};function GLe(e){let t=new Float32Array(e*e*2);for(let r=0;r<e;r++)for(let i=0;i<e;i++){let n=r*e+i;t[n*2+0]=r/(e-1),t[n*2+1]=i/(e-1)}return t}function $Le(e){let t=Math.ceil(Math.sqrt(e));return Math.max(t,1)}function qLe(e,t){let r=new Di(e.geometry,e.material),i=[],n=[],a=new k,o=new k;r.geometry.index!==null&&(r.geometry=r.geometry.toNonIndexed());let s=new WLe(r).build();for(let d=0;d<t;d++)s.sample(a,o),i.push(a.x,a.y,a.z),n.push(o.x,o.y,o.z);let l=new Float32Array(i),c=new Float32Array(n);return{positions:l,normals:c}}function JB(e,t){let r=e,i=new Float32Array(4*t*t);for(let a=0;a<t*t;a++)i[4*a]=r[3*a],i[4*a+1]=r[3*a+1],i[4*a+2]=r[3*a+2],i[4*a+3]=0;let n=new Po(i,t,t,In,on);return n.needsUpdate=!0,n}function YLe({size:e}){let t=new Float32Array(4*e*e);for(let i=0;i<e*e;i++)t[4*i]=i,t[4*i+1]=0,t[4*i+2]=0,t[4*i+3]=0;let r=new Po(t,e,e,In,on);return r.needsUpdate=!0,r}function XLe(e){let t=new Float32Array(4*e*e);for(let i=0;i<e*e;i++)t[4*i]=0,t[4*i+1]=0,t[4*i+2]=0,t[4*i+3]=0;let r=new Po(t,e,e,In,on);return r.needsUpdate=!0,r}var KLe=`
// uniform sampler2D uCurrentPosition; // Pass in the variable from GPGPU
// uniform sampler2D uCurrentVelocity; // Pass in the variable from GPGPU
// uniform sampler2D uCurrentEmissionRate; // Pass in the variable from GPGPU
uniform sampler2D uOriginalPosition;
uniform float uTime;
uniform float uSpeed;     // update speed of the particles
uniform vec3 uWorldOffset;    
uniform vec4 uWorldQuaternion;
uniform float uMaxLifeTime;
uniform vec3 uEmitterSize;
uniform float uFPSRatio;     // 1  for 60 FPS

float random (vec2 st) {
    return fract(sin(dot(st.xy,
        vec2(12.9898,78.233)))*
        43758.5453123);
}
vec3 applyQuaternionToVector( vec4 q, vec3 v ){
    return v + 2.0 * cross( q.xyz, cross( q.xyz, v ) + q.w * v );
}

vec3 applyForce(vec3 force, float mass) {
    vec3 acceleration = force / mass;
    
    return acceleration;
  }
  

void main() {
    vec2 vUv = gl_FragCoord.xy / resolution.xy;
    vec3 position = texture2D( uCurrentPosition, vUv ).xyz;
    float currentLife = texture2D( uCurrentPosition, vUv ).w;   // from 1 to 0
    float isSpawning = texture2D( uCurrentEmissionRate, vUv ).r;        // 1. = spawning, 0. = not spawning
    float isActive = texture2D( uCurrentEmissionRate, vUv ).g;          // 1. = active, 0. = not active
    float timeStart = texture2D( uCurrentEmissionRate, vUv ).b;         // timeStart in seconds when the particle was emitted
    vec3 originalPosition = ((texture2D( uOriginalPosition, vUv ).xyz) * uEmitterSize);
    vec3 velocity = texture2D( uCurrentVelocity, vUv ).xyz;
    float collisionFlag = texture2D( uCurrentVelocity, vUv ).w;             // 1. = collided, 0. = not collided
    float lifeTime = uMaxLifeTime;

    // Calculate the position adjustment based on collision
    //     if (collisionFlag > .5) {  
    float isColliding = step(0.5, collisionFlag); // 1.0 if collisionFlag > 0.5, otherwise 0.0
    float bounceOffset = 3.0 * isColliding; // Becomes 3.0 if colliding, 0.0 otherwise
    vec3 collisionAdjustedVelocity = velocity * (1.0 + bounceOffset);

    // Update position based on collision or normal movement
    vec3 fpsVelocity = velocity * min(uFPSRatio, 5.0);
    position += mix(fpsVelocity, collisionAdjustedVelocity, isColliding);

    // EMISSION RATE - BIRTH
    // if (isSpawning == 1.0) {
    // Better Approach to avoid If statement
    vec3 newPosition = applyQuaternionToVector(uWorldQuaternion, originalPosition) + uWorldOffset;
    originalPosition = mix(originalPosition, newPosition, isSpawning);
    position = mix(position, originalPosition, isSpawning);;
    timeStart = mix(timeStart, uTime, isSpawning);

    // Calculate timeLeft for life normalization
    float timeLeft = max(lifeTime - (uTime - timeStart), 0.0);
    float life_Normalize = timeLeft / lifeTime;

    // Use isActive to blend between the calculated color and black
    vec4 activeColor = vec4(position, life_Normalize);
    // if (isActive == 1.0) {
    gl_FragColor = mix(vec4(0.0), activeColor, isActive);

}
`,QLe=`

    vec3 mod289(vec3 x) {
      return x - floor(x * (1.0 / 289.0)) * 289.0;
    }
    
    vec4 mod289(vec4 x) {
    return x - floor(x * (1.0 / 289.0)) * 289.0;
    }
    
    vec4 permute(vec4 x) {
        return mod289(((x*34.0)+1.0)*x);
    }
    
    vec4 taylorInvSqrt(vec4 r)
    {
    return 1.79284291400159 - 0.85373472095314 * r;
    }
    
    vec3 fade(vec3 t) {
  return t*t*t*(t*(t*6.0-15.0)+10.0);
}

    float snoise(vec3 v)
    {
    const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;
    const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);
    vec3 i  = floor(v + dot(v, C.yyy) );
    vec3 x0 =   v - i + dot(i, C.xxx) ;
    vec3 g = step(x0.yzx, x0.xyz);
    vec3 l = 1.0 - g;
    vec3 i1 = min( g.xyz, l.zxy );
    vec3 i2 = max( g.xyz, l.zxy );
    vec3 x1 = x0 - i1 + C.xxx;
    vec3 x2 = x0 - i2 + C.yyy; // 2.0*C.x = 1/3 = C.y
    vec3 x3 = x0 - D.yyy;      // -1.0+3.0*C.x = -0.5 = -D.y
    
    // Permutations
    i = mod289(i);
    vec4 p = permute( permute( permute(
                i.z + vec4(0.0, i1.z, i2.z, 1.0 ))
              + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))
              + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));
    
    // Gradients: 7x7 points over a square, mapped onto an octahedron.
    // The ring size 17*17 = 289 is close to a multiple of 49 (49*6 = 294)
    float n_ = 0.142857142857; // 1.0/7.0
    vec3  ns = n_ * D.wyz - D.xzx;
    
    vec4 j = p - 49.0 * floor(p * ns.z * ns.z);  //  mod(p,7*7)
    
    vec4 x_ = floor(j * ns.z);
    vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)
    
    vec4 x = x_ *ns.x + ns.yyyy;
    vec4 y = y_ *ns.x + ns.yyyy;
    vec4 h = 1.0 - abs(x) - abs(y);
    
    vec4 b0 = vec4( x.xy, y.xy );
    vec4 b1 = vec4( x.zw, y.zw );
    
    vec4 s0 = floor(b0)*2.0 + 1.0;
    vec4 s1 = floor(b1)*2.0 + 1.0;
    vec4 sh = -step(h, vec4(0.0));
    
    vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;
    vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;
    
    vec3 p0 = vec3(a0.xy,h.x);
    vec3 p1 = vec3(a0.zw,h.y);
    vec3 p2 = vec3(a1.xy,h.z);
    vec3 p3 = vec3(a1.zw,h.w);
    
    //Normalise gradients
    vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));
    p0 *= norm.x;
    p1 *= norm.y;
    p2 *= norm.z;
    p3 *= norm.w;
    
    // Mix final noise value
    vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);
    m = m * m;
    return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1),
                                  dot(p2,x2), dot(p3,x3) ) );
    }
    
    vec3 snoiseVec3( vec3 x ){
    
      float s  = snoise(vec3( x ));
      float s1 = snoise(vec3( x.y - 19.1 , x.z + 33.4 , x.x + 47.2 ));
      float s2 = snoise(vec3( x.z + 74.2 , x.x - 124.5 , x.y + 99.4 ));
      vec3 c = vec3( s , s1 , s2 );
      return c;
    
    }
    
      
    vec3 curlNoise( vec3 p, float seed){
      p += seed;
      const float e = .1;
      vec3 dx = vec3( e   , 0.0 , 0.0 );
      vec3 dy = vec3( 0.0 , e   , 0.0 );
      vec3 dz = vec3( 0.0 , 0.0 , e   );
    
      vec3 p_x0 = snoiseVec3( p - dx );
      vec3 p_x1 = snoiseVec3( p + dx );
      vec3 p_y0 = snoiseVec3( p - dy );
      vec3 p_y1 = snoiseVec3( p + dy );
      vec3 p_z0 = snoiseVec3( p - dz );
      vec3 p_z1 = snoiseVec3( p + dz );
    
      float x = p_y1.z - p_y0.z - p_z1.y + p_z0.y;
      float y = p_z1.x - p_z0.x - p_x1.z + p_x0.z;
      float z = p_x1.y - p_x0.y - p_y1.x + p_y0.x;
    
      const float divisor = 1.0 / ( 2.0 * e );
      return normalize( vec3( x , y , z ) * divisor );
    
    }


// Classic Perlin noise
float cnoise(vec3 P)
{
  vec3 Pi0 = floor(P); // Integer part for indexing
  vec3 Pi1 = Pi0 + vec3(1.0); // Integer part + 1
  Pi0 = mod289(Pi0);
  Pi1 = mod289(Pi1);
  vec3 Pf0 = fract(P); // Fractional part for interpolation
  vec3 Pf1 = Pf0 - vec3(1.0); // Fractional part - 1.0
  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);
  vec4 iy = vec4(Pi0.yy, Pi1.yy);
  vec4 iz0 = Pi0.zzzz;
  vec4 iz1 = Pi1.zzzz;

  vec4 ixy = permute(permute(ix) + iy);
  vec4 ixy0 = permute(ixy + iz0);
  vec4 ixy1 = permute(ixy + iz1);

  vec4 gx0 = ixy0 * (1.0 / 7.0);
  vec4 gy0 = fract(floor(gx0) * (1.0 / 7.0)) - 0.5;
  gx0 = fract(gx0);
  vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);
  vec4 sz0 = step(gz0, vec4(0.0));
  gx0 -= sz0 * (step(0.0, gx0) - 0.5);
  gy0 -= sz0 * (step(0.0, gy0) - 0.5);

  vec4 gx1 = ixy1 * (1.0 / 7.0);
  vec4 gy1 = fract(floor(gx1) * (1.0 / 7.0)) - 0.5;
  gx1 = fract(gx1);
  vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);
  vec4 sz1 = step(gz1, vec4(0.0));
  gx1 -= sz1 * (step(0.0, gx1) - 0.5);
  gy1 -= sz1 * (step(0.0, gy1) - 0.5);

  vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);
  vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);
  vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);
  vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);
  vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);
  vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);
  vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);
  vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);

  vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));
  g000 *= norm0.x;
  g010 *= norm0.y;
  g100 *= norm0.z;
  g110 *= norm0.w;
  vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));
  g001 *= norm1.x;
  g011 *= norm1.y;
  g101 *= norm1.z;
  g111 *= norm1.w;

  float n000 = dot(g000, Pf0);
  float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));
  float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));
  float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));
  float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));
  float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));
  float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));
  float n111 = dot(g111, Pf1);

  vec3 fade_xyz = fade(Pf0);
  vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);
  vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);
  float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x); 
  return 2.2 * n_xyz;
}


vec3 fbm_vec3(vec3 p, float frequency, float offset)
{
  return vec3(
    cnoise((p+vec3(offset))*frequency),
    cnoise((p+vec3(offset+20.0))*frequency),
    cnoise((p+vec3(offset-30.0))*frequency)
  );
}

`,ZLe=`
  #ifdef USE_COLLIDER
    float restitution = max(uBounce * 2., .01); // Energy Loss
    // SPHERE COLLIDER
    // **************************************************************
    #ifdef USE_SPHERE_COLLIDER       
      // Convert collider size to radii (assuming uColliderSize is the diameter in each axis)
      vec3 radii = uColliderSize;
      // Adjust position relative to collider
      vec3 relPos = position - uColliderPos;
      // Apply rotation of the collider to the relative position
      relPos = applyQuaternionToVector(uColliderQuaternionInvert, relPos);            
      // Scale relative position by radii (for ellipsoid collision detection)
      vec3 scaledPos = relPos / radii;
      // Calculate ellipsoidal distance
      float dist = length(scaledPos); // Distance in terms of ellipsoid
      
      // Check for collision
      if (dist <= 1. + particleSize / length(radii) && collisionFlag == 0.0) {
          // Compute the normal at the collision point, accounting for particle size
        vec3 adjustedPos = scaledPos * (1.0 + particleSize / length(radii));          
        // Compute the normal at the collision point
        vec3 normal = ellipsoidNormal(adjustedPos, radii);
        // Rotate the normal back to world space
        normal = applyQuaternionToVector(uColliderQuaternion, normal);
        // Reflect the velocity vector off the normal
        velocity = reflect(velocity, normal) * restitution;

        collisionFlag = 1.0;
      } else {
        collisionFlag = 0.0;
      }
    #endif

    // BOX COLLIDER or PLANE COLLIDER 
    // **************************************************************
    #ifdef USE_BOX_COLLIDER
      // Box dimensions and repulsion variables
      vec3 boxHalfSize = uColliderSize / 2.0;
      // Convert world position to box's local space
      vec3 localPos = applyQuaternionToVector(uColliderQuaternionInvert, position - uColliderPos);      
      // Collision detection
      vec3 localDistance = abs(localPos) - boxHalfSize;
      float distToSurface = max(localDistance.x, max(localDistance.y, localDistance.z));    

      // Collision Detected
      if (distToSurface <= particleSize * 0.5 && collisionFlag == 0.0) {      
        // Find the nearest face normal for bounce direction
        vec3 normal;
        if (localDistance.x > localDistance.y && localDistance.x > localDistance.z) {
            normal = vec3(sign(localPos.x), 0.0, 0.0);
        } else if (localDistance.y > localDistance.z) {
            normal = vec3(0.0, sign(localPos.y), 0.0);
        } else {
            normal = vec3(0.0, 0.0, sign(localPos.z));
        }            
        // Rotate normal back to world space
        normal = applyQuaternionToVector(uColliderQuaternion, normal);      
        // Reflect velocity and apply repulsion force
        velocity = reflect(velocity, normal) * restitution;
        
        collisionFlag = 1.0;
      } else {
        collisionFlag = 0.0;
      }
    #endif      
  #endif      
  // END COLLIDER    
`,JLe=`
  #ifdef USE_ATTRACTOR

      #ifdef USE_SPHERE_COLLIDER      
        // Convert collider size to radii (assuming uColliderSize is the diameter in each axis)
        vec3 radii = uColliderSize;
        // Adjust position relative to collider
        vec3 relPos = position - uColliderPos;
        // Apply rotation of the collider to the relative position
        relPos = applyQuaternionToVector(uColliderQuaternionInvert, relPos);            
        // Scale relative position by radii (for ellipsoid collision detection)
        vec3 scaledPos = relPos / radii;
        // Calculate ellipsoidal distance
        float distToSurface = length(scaledPos); // Distance in terms of ellipsoid
        float insideCheck = 1.0;

      #endif


      #ifdef USE_BOX_COLLIDER
        // Box dimensions
        vec3 boxHalfSize = uColliderSize / 2.0;
        // Convert world position to box's local space
        vec3 localPos = applyQuaternionToVector(uColliderQuaternionInvert, position - uColliderPos);      
        vec3 localDistance = abs(localPos) - boxHalfSize;
        float distToSurface = max(localDistance.x, max(localDistance.y, localDistance.z));
        float insideCheck = particleSize;
      #endif      
  
      // Apply vortex force inside the Helper
      #ifdef USE_FORCE_LOCAL_SPACE
        if (distToSurface <= insideCheck ) {    
            // Define parameters for the attractor field
            #ifdef USE_SPHERE_COLLIDER      
              float attractorStrength = (1.0 - distToSurface ) * uForceIntensity; // Adjust as needed
            #endif

            #ifdef USE_BOX_COLLIDER
              float attractorStrength = max((1.0 - insideCheck / distToSurface), 0.) * uForceIntensity; // Adjust as needed
              #endif

            float attractorDamping = uForceDamping;  // Adjust as needed (higher values will attenuate velocity more)
          
            // Use the same radii calculation code as for the collider
            vec3 attractorRadii = uColliderSize;
            // Adjust position relative to attractor center
            vec3 relPos = position - uColliderPos;
            // Apply rotation of the collider to the relative position
            relPos = applyQuaternionToVector(uColliderQuaternionInvert, relPos);            
            // Scale relative position by radii (for ellipsoid attraction)
            vec3 scaledPos = relPos / attractorRadii;

            // Calculate ellipsoidal distance as attractor radius
            float attractorRadius = length(scaledPos);
            // Calculate the distance from the attractor center
            vec3 relativePosition = position - uColliderPos;
            // Calculate the force vector towards the attractor center
            vec3 attractorForce = normalize(relativePosition) * attractorStrength;
            // Apply the attractor force to the particle
            velocity -= attractorForce;
            // Attenuate the particle's velocity
            velocity *= attractorDamping;
        }
      #else 
            // Calculate the distance from the attractor center
            vec3 relativePosition = position - uColliderPos;
            // Calculate the force vector towards the attractor center
            vec3 attractorForce = normalize(relativePosition) * uForceIntensity;
            // Apply the attractor force to the particle
            velocity -= attractorForce;
            // Attenuate the particle's velocity
            velocity *= uForceDamping;
      #endif    
  #endif      
`,eBe=`
  #ifdef USE_VORTEX
    // Box dimensions
    vec3 boxHalfSize = uColliderSize / 2.0;
    // Convert world position to box's local space
    vec3 localPos = applyQuaternionToVector(uColliderQuaternionInvert, position - uColliderPos);      
    vec3 localDistance = abs(localPos) - boxHalfSize;
    float distToSurface = max(localDistance.x, max(localDistance.y, localDistance.z));

    // Apply vortex force inside the box
    if (distToSurface <= particleSize) {
      float vortexStrength = uForceIntensity;
      vec3 localTopCenter = vec3(0.0, 0., 0.0);

      // Transform the local top center to the world space
      vec3 vortexCenter = uColliderPos + applyQuaternionToVector(uColliderQuaternion, localTopCenter);
      // Calculate the vector from particle to vortex center
      vec3 vortexVector = vortexCenter - position;

      // Calculate the rotation axis from the inverse of the collider's quaternion and the fixed up vector
      // Note: important to add a tiny z component to the up vector to avoid instability
      vec3 upVector = vec3(0.0, 1.0, 0.01);
      vec3 rotationAxis = cross(upVector, applyQuaternionToVector(uColliderQuaternion, vortexVector));
      rotationAxis = normalize(rotationAxis);

      // Add rotational component to velocity
      float rotationSpeed = length(vortexVector * vortexStrength * 3.0) ; 

      vec3 rotationVelocity = rotationAxis * rotationSpeed;
      // velocity += rotationVelocity * 0.005 ;
      velocity = rotationVelocity * 0.005 ;

      // Calculate vortex force
      // vec3 vortexForce = normalize(vortexVector) * uSpeed * .1 ;
      // Apply the vortex force to the particle
      vec3 originDirection = applyQuaternionToVector(uWorldQuaternion, directions);
      velocity += applyForce( originDirection * uSpeed * (1. - uForceDamping) , mass * .5);
    }
  #endif      
`,tBe=`
// uniform sampler2D uCurrentPosition; // Pass in the variable from GPGPU
// uniform sampler2D uCurrentVelocity; // Pass in the variable from GPGPU
// uniform sampler2D uCurrentEmissionRate; // Pass in the variable from GPGPU
uniform sampler2D uOriginalPosition;
uniform sampler2D uDirections;     
uniform vec3 uDirectionsAxis;
uniform vec4 uWorldQuaternion;
uniform vec3 uGravity;        
uniform float uNoiseStrength;     // Variation of the noise
uniform float uNoiseScale;        // Scale of the noise
uniform float uNoiseSeed;         // Seed of the noise
uniform float particleSize;
uniform float uSpeed;     // update speed of the particles
uniform float uRandomMassFactor;

// COLLIDER
uniform vec3 uColliderPos;                // Collider Position
uniform vec3 uColliderSize;               // Collider Dimension
uniform vec4 uColliderQuaternion;         // Collider Rotation
uniform vec4 uColliderQuaternionInvert;   // Collider Rotation
uniform float uBounce;                    // Bounce factor
uniform float uForceDamping;
uniform float uForceIntensity;


`+QLe+`
float rand(vec2 co){
    return fract(sin(dot(co, vec2(12.9898, 78.233))) * 43758.5453);
}
vec3 applyQuaternionToVector( vec4 q, vec3 v ){
    return v + 2.0 * cross( q.xyz, cross( q.xyz, v ) + q.w * v );
 } 
vec3 applyForce(vec3 force, float mass) {
  vec3 acceleration = force / mass;
  
  return acceleration;
}

vec4 conjugate(vec4 q) {
  return vec4(q.w, -q.x, -q.y, -q.z);
}

// Function to compute the normal of the ellipsoid at a given point
vec3 ellipsoidNormal(vec3 p, vec3 radii) {
  return normalize(p / (radii * radii));
}

float friction = .3;

void main() {
    vec2 vUv = gl_FragCoord.xy / resolution.xy;
    vec3 position = texture2D( uCurrentPosition, vUv ).xyz;
    vec3 originalPosition = texture2D( uOriginalPosition, vUv ).xyz;
    float timeLeft = texture2D( uCurrentPosition, vUv ).w;
    vec3 directions = texture2D( uDirections, vUv ).xyz;    
    vec3 velocity = texture2D( uCurrentVelocity, vUv ).xyz;
    float mass = rand(originalPosition.xy) * 0.5 + 0.5;
    float isSpawning = texture2D( uCurrentEmissionRate, vUv ).x;        // 1. = spawning, 0. = not spawning
    float isActive = texture2D( uCurrentEmissionRate, vUv ).y;          // 1. = active, 0. = not active
    float collisionFlag =texture2D( uCurrentVelocity, vUv ).w;          // Indicate collision

    // Randomness Mass
    mass = (1.0 - (uRandomMassFactor * mass));
    
    if (isActive == 1.0) {
      // **************************************************************
      // FORCES NOISES
      // **************************************************************
      #ifdef USE_CURL_NOISE
        if (uNoiseScale > 0.0 ) {
          velocity = curlNoise(position * uNoiseScale * .002, uNoiseSeed) * ( uNoiseStrength + 1.0) * .05 * uSpeed;
        }
        // Variation of the noise Over Time
        if (uNoiseStrength > 0.0 && uNoiseScale == 0.0 ) {
          velocity += curlNoise( position, uNoiseSeed)  * uNoiseStrength * 0.05 * uSpeed;
        }
      #endif
      // **************************************************************
      #ifdef USE_SIMPLEX_NOISE
        if (uNoiseScale > 0.0 ) {
          velocity = vec3(snoise(position * uNoiseScale * .001) * ( uNoiseStrength + 1.0) * .1);
          velocity *= uSpeed;
        }
        // Variation of the noise Over Time
        if (uNoiseStrength > 0.0 && uNoiseScale == 0.0) {
          velocity += vec3(snoise(position * uNoiseStrength * .001) * .05 * uSpeed);
        }
      #endif
      // ************************************************************** 
      #ifdef USE_FBM_NOISE
        if (uNoiseScale > 0.0 ) {
          velocity = fbm_vec3(position * uNoiseScale * .001, ( uNoiseStrength + 1.0), uNoiseSeed);
          velocity *= uSpeed;
        }
        // Variation of the noise Over Time
        if (uNoiseStrength > 0.0 && uNoiseScale == 0.0 ) {      
          velocity += fbm_vec3(position * uNoiseStrength * .001, ( uNoiseStrength + 1.0), uNoiseSeed) * .1 * uSpeed;
        }
      #endif

      // COLLIDER
      ${ZLe}
      // ATTRACTION
      ${JLe}  
      // VORTEX
      ${eBe}
    } 
    // End isActive

    // SPAWN BIRTH 
    // **************************************************************
    // if (isSpawning == 1.)
    #ifdef USE_NORMALS
      velocity = mix(velocity, applyQuaternionToVector(uWorldQuaternion, directions) * uSpeed, isSpawning);
    #else
      velocity = mix(velocity, applyQuaternionToVector(uWorldQuaternion, uDirectionsAxis) * uSpeed, isSpawning);    
    #endif
    
    // if (collisionFlag == 0.0)
    velocity += applyForce(uGravity, mass * .5) * (1.0 - collisionFlag);

    gl_FragColor = vec4(velocity, collisionFlag);
}
`,tW=`

  // Linear Fade In
  float linearFadeIn(float t) {
    return t;
  }


  // linear fade out
  float linearFadeOut(float t) {
    return 1.0 - t;
  }
  
  float linearInOut(float t) {
    return t < 0.5 ? t :  (1.0 - t);  
  }

    // lerp
    float lerp(float a, float b, float t) {
      return a + (b - a) * t;
    }

  // Ease In Out Quart
  float exponentialInOut(float t) {
    return t < 0.4 ? lerp(0.0, 1.0, t / 0.4) :
    t > 0.6 ? lerp(1.0, 0.0, (t - 0.6) / 0.4) :
    1.0;
   }

  // constant
  float constant(float t) {
    return 1.0;
  } 
`,rBe=`

float rand(vec3 co){
  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
}

vec3 applyQuaternionToVector( vec4 q, vec3 v ){
  return v + 2.0 * cross( q.xyz, cross( q.xyz, v ) + q.w * v );
}

vec3 applyForce(vec3 force, float mass) {
  vec3 acceleration = force / mass;
    
  return acceleration;
}
`,iBe=`
vec3 rgb2xyz (in vec3 rgb) {
    float r = rgb.r;
	float g = rgb.g;
	float b = rgb.b;

	r = r > 0.04045 ? pow(((r + 0.055) / 1.055), 2.4) : (r / 12.92);
	g = g > 0.04045 ? pow(((g + 0.055) / 1.055), 2.4) : (g / 12.92);
	b = b > 0.04045 ? pow(((b + 0.055) / 1.055), 2.4) : (b / 12.92);

	float x = (r * 0.4124) + (g * 0.3576) + (b * 0.1805);
	float y = (r * 0.2126) + (g * 0.7152) + (b * 0.0722);
	float z = (r * 0.0193) + (g * 0.1192) + (b * 0.9505);
    
    vec3 xyz = vec3(
        (r * 0.4124) + (g * 0.3576) + (b * 0.1805) * 100.0,
        (r * 0.2126) + (g * 0.7152) + (b * 0.0722) * 100.0,
        (r * 0.0193) + (g * 0.1192) + (b * 0.9505) * 100.0
    );
    return(xyz);
}

vec3 xyz2lab (in vec3 xyz) {
	float x = xyz.x / 95.047;
	float y = xyz.y / 100.0;
	float z = xyz.z / 108.883;

	x = x > 0.008856 ? pow(x, 1.0 / 3.0) : (7.787 * x) + (16.0 / 116.0);
	y = y > 0.008856 ? pow(y, 1.0 / 3.0) : (7.787 * y) + (16.0 / 116.0);
	z = z > 0.008856 ? pow(z, 1.0 / 3.0) : (7.787 * z) + (16.0 / 116.0);

    vec3 lab = vec3((116.0 * y) - 16.0, 500.0 * (x - y), 200.0 * (y - z));
    return(lab);
}

vec3 rgb2lab(in vec3 rgb) {
    vec3 xyz = rgb2xyz(rgb);
    vec3 lab = xyz2lab(xyz);
    return(lab);
}

vec3 xyz2rgb (in vec3 xyz) {
	float x = xyz.x / 100.0;
	float y = xyz.y / 100.0;
	float z = xyz.z / 100.0;
	
    
	float r = (x *  3.2406) + (y * -1.5372) + (z * -0.4986);
	float g = (x * -0.9689) + (y *  1.8758) + (z *  0.0415);
	float b = (x *  0.0557) + (y * -0.2040) + (z *  1.0570);

	r = r > 0.0031308 ? ((1.055 * pow(r, 1.0 / 2.4)) - 0.055) : r * 12.92;
	g = g > 0.0031308 ? ((1.055 * pow(g, 1.0 / 2.4)) - 0.055) : g * 12.92;
	b = b > 0.0031308 ? ((1.055 * pow(b, 1.0 / 2.4)) - 0.055) : b * 12.92;

	r = min(max(0.0, r), 1.0);
	g = min(max(0.0, g), 1.0);
	b = min(max(0.0, b), 1.0);

	return(vec3(r, g, b));
}

vec3 lab2xyz (in vec3 lab) {
    float l = lab.x;
	float a = lab.y;
	float b = lab.z;

  	float y = (l + 16.0) / 116.0;
	float x = a / 500.0 + y;
	float z = y - b / 200.0;

	float y2 = pow(y, 3.0);
	float x2 = pow(x, 3.0);
	float z2 = pow(z, 3.0);

  	y = y2 > 0.008856 ? y2 : (y - 16.0 / 116.0) / 7.787;
	x = x2 > 0.008856 ? x2 : (x - 16.0 / 116.0) / 7.787;
	z = z2 > 0.008856 ? z2 : (z - 16.0 / 116.0) / 7.787;

	x *= 95.047;
	y *= 100.0;
	z *= 108.883;

	return(vec3(x, y, z));
}
vec3 lab2rgb (in vec3 lab) {
    vec3 xyz = lab2xyz(lab);
    vec3 rgb = xyz2rgb(xyz);
    return(rgb);
}

`,nBe=`
  uniform sampler2D uPosition;
  uniform float uSize;
  uniform float uSizeEnd;
  uniform vec3 uWorldOffset;
  uniform vec4 uWorldQuaternion;
  // Billboard Behavior - Currently at Zero, but we can change that
  uniform float uRotation;
  uniform float uRotationEnd;
  uniform vec2 center;

  // Randomness
  uniform float uRandScaleFactor;
  uniform float uRandRotationFactor;

  attribute vec2 ref;

  varying float v_LifeLeft;    // normalized lifetime 1 to 0
  varying vec2 vUv;
  varying vec2 vRef;

  ${rBe}
  ${tW}
`,aBe=({easeSize:e="linearFadeOut"})=>`
  vUv = uv;  
  vRef = ref;
  // Normalized LifeTime 1 to 0
  float lifeLeft = texture2D(uPosition, ref).w;
  v_LifeLeft = lifeLeft;
  // Position From DataTexture Simulation
  vec3 pos = texture2D(uPosition, ref).rgb - uWorldOffset;
  // Apply World Quaternion
  pos = applyQuaternionToVector(uWorldQuaternion, pos);  
            
  #ifdef  USE_SIZE_END
    // Scaled Over Time
    float t = 1. - lifeLeft;
    float currentSize = mix(uSize, uSizeEnd, t); // Linearly interpolate between uSize and uSizeEnd
    vec3 scaledPosition = position * vec3(currentSize);
  #else
    // Change Size Behavior over LifeTime
    float easeSize = ${e}(1. - lifeLeft);
    // Scaled Over Time
    vec3 scaledPosition = position * vec3(uSize * easeSize);
  #endif

  // Billboard Behavior
  vec2 scale;
  scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
  scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );    
  // Randomness 
  float randRef = rand(ref);
  scale *= (1.0 - (uRandScaleFactor * randRef));
  // Rotation
  float randRotation =  2.0 * PI * ( uRandRotationFactor * randRef);
  float originalRotation = (1.0 - uRotation) * 2.0 * PI;
  float originalRotationEnd = (1.0 - uRotationEnd) * 2.0 * PI;
  // OverTime
  float finalRotation = mix(originalRotation + randRotation, originalRotationEnd + randRotation, lifeLeft);

  vec2 alignedPosition = ( scaledPosition.xy - ( center - vec2( 0.5 ) ) ) * scale;
  vec2 rotatedPosition;
  rotatedPosition.x = cos( finalRotation ) * alignedPosition.x - sin( finalRotation ) * alignedPosition.y;
  rotatedPosition.y = sin( finalRotation ) * alignedPosition.x + cos( finalRotation ) * alignedPosition.y;
  
  mat4 instanceMatrix = mat4(
    vec4(1.0, 0.0, 0.0, 0.0),
    vec4(0.0, 1.0, 0.0, 0.0),
    vec4(0.0, 0.0, 1.0, 0.0),
    vec4(pos.x, pos.y, pos.z, 1.0)
  );  

  mvPosition = modelViewMatrix * instanceMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
  mvPosition.xy += rotatedPosition;
  gl_Position = projectionMatrix  * mvPosition;   
`,oBe=`
  uniform vec4 uColor;                // start color
  uniform vec4 uColor2;               // end color
  uniform sampler2D uTexture;         // texture
  varying float v_LifeLeft;   // normalized lifetime 1 to 0
  varying vec2 vUv;
  varying vec2 vRef;

  float random(vec2 co) {
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
  }
  `+tW+`  
  ${iBe}

`,sBe=({easeOpacity:e="linearFadeOut"})=>`  
  // if Particle is dead, hide it
  if (v_LifeLeft <= 0.005 ) {
    discard;
  }

  #ifdef USE_RANDOM_COLORING
    float randVal = random(vRef); // Generate a random value based on the reference
    vec4 color = mix(uColor, uColor2, randVal); // Interpolate between the two colors
  #else
    vec4 color = mix(uColor, uColor2, 1. - v_LifeLeft);
  #endif

  // Opacity over Life Time
  float finalAlpha = ${e}(1. - v_LifeLeft);  
  vec4 textureColor = texture2D(uTexture, vUv).rgba; 
  finalColor = textureColor.rgb * color.rgb;
  finalAlpha = color.a * textureColor.a * finalAlpha;
  
  gl_FragColor = vec4(finalColor, finalAlpha);     

`,lBe=class extends jr{constructor(e,t){super(),this.needsJitter=!0,this.type="ParticleMaterial",this.easeOpacity="linearFadeIn",this.easeSize="linearFadeIn",this.useSizeEnd=!1,this.isColoringRandom=!1,this.init(e,t),this.context=t}reset(){}init(e,t){this.transparent=!0,this.depthTest=!0,this.depthWrite=!1,this.easeOpacity=e.ease,this.easeSize=e.easeSize,this.layers=[],mn.startContext(mn.globalContext),this.lightLayer=new Ls(0,"",{...Tn.defaultData("light","phong"),visible:!1},new rD,{},t.shared),mn.endContext(mn.globalContext),this.build()}updateState(e){e.coloring!==void 0&&(this.isColoringRandom=e.coloring==="random"),e.color!==void 0&&(e.color instanceof Array?this.uniforms.uColor.value=e.color:this.uniforms.uColor.value=this.context.shared.color(e.color)),e.color2!==void 0&&(e.color2 instanceof Array?this.uniforms.uColor2.value=e.color2:this.uniforms.uColor2.value=this.context.shared.color(e.color2)),e.size!==void 0&&(this.uniforms.uSize.value=e.size[0],this.uniforms.uSizeEnd.value=e.size[1],e.size[0]!==e.size[1]?this.useSizeEnd=!0:this.useSizeEnd=!1),e.ease!==void 0&&(this.easeOpacity=e.ease,this.build()),e.easeSize!==void 0&&(this.easeSize=e.easeSize,this.build()),this.needsUpdate=!0}onBeforeCompile(e){this.build(),e.defines=this.defines,e.uniforms=this.uniforms,e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader}build(){let e=new Z8;return e.needsJitter=this.needsJitter,e.addFragmentParsCode(VOe),e.buildShader("vertex",this.fragment),e.buildShader("fragment",this.fragment),e.addFragmentFinalCode(HOe),this.isColoringRandom&&e.define("USE_RANDOM_COLORING"),this.useSizeEnd&&e.define("USE_SIZE_END"),e.addVertexParsCode(nBe),e.addFragmentParsCode(oBe),e.addVertexFinalCode(aBe({easeSize:this.easeSize})),e.addFragmentFinalCode(sBe({easeOpacity:this.easeOpacity})),this.vertexShader=e.getCode("vertex"),this.fragmentShader=e.getCode("fragment"),this.defines=e.defines,this.uniforms={...e.uniforms,...this.uniforms},this.extensions=e.extensions,this}get nodeMaterial(){return this}get fragment(){return this.lightLayer.node}getDefines(){return this.defines}nodeMaterialDispose(){this.layers.forEach(e=>e.dispose()),super.dispose()}},l_=class{constructor(e,t,r,i){this.type="SphereEmitterShape",this.targetMesh=void 0,this.size=e,this.type=r,this.textureSize=$Le(t);let n=1;this.targetMesh=(i==null?void 0:i.type)==="Mesh"&&i?i:this.getMesh(r,n);let{positions:a,dataTexture:o,dataTextureNormals:s}=this.createPositions(this.textureSize,this.targetMesh??this.getMesh(r,n));this.positionsTexture=o,this.positionsAttribute=a,this.directionsTexture=s}createPositions(e,t){let{positions:r,normals:i}=qLe(t,e*e),n=JB(r,e),a=JB(i,e);return{dataTexture:n,positions:r,dataTextureNormals:a}}getMesh(e,t){let r=null;switch(e){case"SphereEmitterShape":{r=new Hf(t*.5,32,32);break}case"TorusEmitterShape":{r=new kj(t*.5,.3,15,40);break}case"ConeEmitterShape":{r=new lP(t,t,15);break}case"BoxEmitterShape":{r=new fs(t,t,t);break}case"PlaneEmitterShape":{r=new rc(t,t),r.rotateX(-Math.PI/2);break}case"MeshEmitterShape":{r=new Hf(t,32,32);break}default:{r=new Hf(t,32,32);break}}return new Di(r,new tc({color:16711680}))}applyToShader(e,t){this.size=new k().fromArray(t.size),e.uEmitterSize.value=this.size}dispose(){this.positionsTexture.dispose(),this.directionsTexture.dispose(),this.positionsAttribute=new Float32Array}};function _f(e){let t={...e},r=kx.defaultData;t.forceFieldObjectId&&(t.colliderEntityId=t.forceFieldObjectId);let i={...r.shape,...t.shape},n={...r.renderMaterial,...t.renderMaterial};return{...r,...t,shape:i,renderMaterial:n}}var cBe=`
// uniform sampler2D uCurrentPosition; // Pass in the variable from GPGPU
// uniform sampler2D uCurrentVelocity; // Pass in the variable from GPGPU
// uniform sampler2D uCurrentEmissionRate; // Pass in the variable from GPGPU

uniform sampler2D uIndex; // Texture with corresponding index
uniform float uLastIndexEmitted; // Last emitted index
uniform float uParticlesToEmit; // Number of particles to emit on that frame
uniform float uTime;

void main() {
    vec2 vUv = gl_FragCoord.xy / resolution.xy;
    float particleIndex = texture(uIndex, vUv).x;
    float timeLeft = texture2D( uCurrentPosition, vUv ).w;
    float isActive = texture2D( uCurrentEmissionRate, vUv ).g;    // 1. = active, 0. = not active
    float timeStart = texture2D( uCurrentEmissionRate, vUv ).b;


    // ********** Detect Colision to Create a flag and use it in position **********
    // We are doing this here, so

    // ********** Emit Particles **********
    // X = isSpawning 0.0 or 1.0
    // Y = isActive 0.0 or 1.0
    // Check if the vertex index is between the first value and the last value
    // if (particleIndex >= uLastIndexEmitted && particleIndex < uLastIndexEmitted + uParticlesToEmit) {
    //     // Emit a particle by writing 1 to the red channel of the color output
    //     // r: 1. == emit the particle
    //     // g: 1. == particle is now active
    //     timeStart = uTime;
    //     gl_FragColor = vec4(1.0, 1.0, timeStart, 1.0);
    // } else {
    //     // The Particle is either already emitted or not in the range of the particles to emit
    //     // Do not emit a particle by writing 0 to the red channel of the color output        
    //     gl_FragColor = vec4(0.0, isActive, timeStart, 1.0);
    // }
    // Determine if the particle is within the emission range
    float emitLowerBound = step(uLastIndexEmitted, particleIndex);
    float emitUpperBound = step(particleIndex, uLastIndexEmitted + uParticlesToEmit - 1.0);
    float emitParticle = emitLowerBound * emitUpperBound; // 1.0 if in range, 0.0 otherwise

    // Set timeStart and color
    timeStart = mix(timeStart, uTime, emitParticle);
    gl_FragColor = vec4(emitParticle, mix(isActive, 1.0, emitParticle), timeStart, 1.0);


}
`,c_=10,dBe=class extends Yr{constructor(e,t){super(),this.type="ParticleEmitter",this.debugMode=!1,this.worldSpace=!0,this.rootObject=null,this.gpuCompute=null,this.positionSimRT=null,this.velocitySimRT=null,this.emissionRateSimRT=null,this.emitterShape=void 0,this.isEmitting=!1,this.hasBeenReset=!1,this.emittedParticlesAmount=0,this.lastEmitTime=0,this.globalTime=0,this.targetFPS=60,this.previousRatio=1,this.lerpFactor=.4,this.particlesAmount=0,this.noiseStrength=0,this.noiseScale=0,this.isBillboardBased=!0,this.simFeaturesDefinition={USE_COLLIDER:!1,USE_ATTRACTOR:!1,USE_VORTEX:!1,USE_SPHERE_COLLIDER:!1,USE_BOX_COLLIDER:!1,USE_FORCE_LOCAL_SPACE:!1,USE_NORMALS:!1,USE_CURL_NOISE:!0,USE_SIMPLEX_NOISE:!1,USE_FBM_NOISE:!1},this.textureLoader=new T1e,this.currentWorldPosition=new k,this.systemQuaternion=new Xt,this.worldGravity=new k(0,0,0),this.directionAxis=new k(0,0,0),this.colliderV3=new k(0,0,0),this.colliderQuaternion=new Xt(0,0,0,1),this.matrixAutoUpdate=!0,this.renderer=e,this.system=t,this.shared=t.context.shared;let r=t.data;this.material=new lBe(r.renderMaterial,t.context),this.material.uniforms={uSize:{value:0},uSizeEnd:{value:0},uColor:{value:r.renderMaterial.color},uColor2:{value:r.renderMaterial.color2},uPosition:{value:new k(0,0,0)},uEmissionData:{value:new k(0,0,0)},uTexture:{value:this.defaultTexture},uWorldOffset:{value:new k(0,0,0)},uWorldQuaternion:{value:new Kt(0,0,0,1)},uRandScaleFactor:{value:r.randomScale??0},uRandRotationFactor:{value:r.randomRotation??0},uRotation:{value:r.renderMaterial.spriteRotation[0]??0},uRotationEnd:{value:r.renderMaterial.spriteRotation[1]??0}},this.setTexture(this.material.uniforms,r.renderMaterial.texture),this.init(r)}setTexture(e,t){let r=t.data;if(typeof t=="string"){let i=this.shared.image(t),n=new Oi(i.img);n.needsUpdate=!0,e.uTexture.value=n;return}if(typeof r!="string"){let i=new Image;i.onload=()=>{let o=new Oi(i);o.needsUpdate=!0,e.uTexture.value=o};let n=new Blob([r],{type:"image/*"}),a=URL.createObjectURL(n);i.src=a}}updateGeometryAttributes(e,t){var i;let r=GLe(t);!((i=this.emitterShape)!=null&&i.positionsAttribute)||e.geometry.setAttribute("ref",new ag(r,2))}applyWorldSpace(){if(!this.system.started||!this.worldSpace||!this.positionSimRT||!this.velocitySimRT)return;let e=this.system;e.getWorldQuaternion(this.systemQuaternion),this.systemQuaternion.invert(),e.getWorldPosition(this.currentWorldPosition),this.material.uniforms.uWorldOffset.value=this.currentWorldPosition,this.material.uniforms.uWorldQuaternion.value.copy(this.systemQuaternion.normalize()),this.positionSimRT.material.uniforms.uWorldOffset.value=this.currentWorldPosition,this.systemQuaternion.invert(),this.positionSimRT.material.uniforms.uWorldQuaternion.value.copy(this.systemQuaternion.normalize()),this.velocitySimRT.material.uniforms.uWorldQuaternion.value.copy(this.systemQuaternion.normalize())}update(e,t){var o;if(!this.gpuCompute||!this.positionSimRT||!this.velocitySimRT||!this.emissionRateSimRT||this.hasBeenReset)return;if(this.checkIfAllParticlesAreDead()&&!this.hasBeenReset){this.reset();return}this.applyWorldSpace(),this.globalTime=e,this.positionSimRT.material.uniforms.uTime.value=e,this.emissionRateSimRT.material.uniforms.uTime.value=e;let r=1e3/t,i=this.targetFPS/r,n=this.previousRatio+(i-this.previousRatio)*this.lerpFactor;this.positionSimRT.material.uniforms.uFPSRatio.value=n,this.previousRatio=n;let a=this.isEmitting?this.GoEmitSomeParticles(e,this.system.data.birthRatePerSec):0;this.emissionRateSimRT.material.uniforms.uLastIndexEmitted.value=this.emittedParticlesAmount,this.emissionRateSimRT.material.uniforms.uParticlesToEmit.value=a,this.material.uniforms.uPosition.value=(o=this.gpuCompute.getCurrentRenderTarget(this.positionSimRT))==null?void 0:o.texture,this.system.colliderEntities.length>0&&this.renderColliders(),this.gpuCompute.compute()}renderColliders(){if(!this.velocitySimRT)return;let e=this.system.colliderEntities[0],t=this.simFeaturesDefinition.USE_COLLIDER||this.simFeaturesDefinition.USE_ATTRACTOR||this.simFeaturesDefinition.USE_VORTEX;if(e.destroyedInAction&&t&&this.init(_f({...this.system.data,colliderEntityId:null})),!e||e.destroyedInAction)return;e.getWorldPosition(this.colliderV3),this.colliderV3.y===0&&(this.colliderV3.y=1e-4),this.velocitySimRT.material.uniforms.uColliderPos.value.copy(this.colliderV3);let r=e.data.size;this.colliderV3.fromArray(r),this.velocitySimRT.material.uniforms.uColliderSize.value.copy(this.simFeaturesDefinition.USE_SPHERE_COLLIDER?this.colliderV3.multiplyScalar(.5):this.colliderV3),e.getWorldQuaternion(this.colliderQuaternion),this.velocitySimRT.material.uniforms.uColliderQuaternion.value.copy(this.colliderQuaternion.normalize()),this.velocitySimRT.material.uniforms.uColliderQuaternionInvert.value.copy(this.colliderQuaternion.normalize().invert())}updateState(e){!this.velocitySimRT||!this.positionSimRT||(e.renderMaterial&&this.updateMaterialState(e.renderMaterial),this.updateParticleState(e))}updateVariableState(e,t){if(!this.velocitySimRT||!this.positionSimRT)return;t[2]==="size"&&this.material.updateState({size:[e,this.material.uniforms.uSizeEnd.value]}),t[2]==="sizeEnd"&&this.material.updateState({size:[this.material.uniforms.uSize.value,e]});let r=(i,n)=>{let a=[...this.system.data.shape.size];a[i]=n,this.updateParticleState({shape:{...this.system.data.shape,size:a}})};t[2]==="shape_size_0"&&r(0,e),t[2]==="shape_size_1"&&r(1,e),t[2]==="shape_size_2"&&r(2,e),t[2]==="speed"&&(this.velocitySimRT.material.uniforms.uSpeed.value=e/c_),t[2]==="gravity"&&this.worldGravity.set(0,e/100,0),t[2]==="noiseStrength"&&(this.noiseStrength=e,this.velocitySimRT.material.uniforms.uNoiseStrength.value=this.noiseStrength),t[2]==="noiseScale"&&(this.noiseScale=e,this.velocitySimRT.material.uniforms.uNoiseScale.value=this.noiseScale),t[2]==="direction_x"&&(this.directionAxis=this.getDirectionAxis([Number(e),this.system.data.direction[1],this.system.data.direction[2]])),t[2]==="direction_y"&&(this.directionAxis=this.getDirectionAxis([this.system.data.direction[0],Number(e),this.system.data.direction[2]])),t[2]==="direction_z"&&(this.directionAxis=this.getDirectionAxis([this.system.data.direction[0],this.system.data.direction[1],Number(e)]))}updateMaterialState(e){this.material.updateState({...e,size:e.size?[Number(this.shared.getVariable(e.size[0],[this.uuid,"particles","size"])),Number(this.shared.getVariable(e.size[1],[this.uuid,"particles","sizeEnd"]))]:[0,0]}),e.texture&&(this.setTexture(this.material.uniforms,e.texture),this.material.needsUpdate=!0)}updateParticleState(e){var t,r,i;if(!(!this.positionSimRT||!this.velocitySimRT)){if(this.shouldReInitGPUCompute(e)&&this.init(_f(this.system.data)),e.life!==void 0&&(this.positionSimRT.material.uniforms.uMaxLifeTime.value=e.life),e.speed!==void 0&&(this.velocitySimRT.material.uniforms.uSpeed.value=Number(this.shared.getVariable(e.speed,[this.uuid,"particles","speed"]))/c_),e.collisionBounce!==void 0&&(this.velocitySimRT.material.uniforms.uBounce.value=e.collisionBounce),e.noiseStrength!==void 0&&(this.noiseStrength=Number(this.shared.getVariable(e.noiseStrength,[this.uuid,"particles","noiseStrength"])),this.velocitySimRT.material.uniforms.uNoiseStrength.value=this.noiseStrength),e.noiseScale!==void 0&&(this.noiseScale=Number(this.shared.getVariable(e.noiseScale,[this.uuid,"particles","noiseScale"])),this.velocitySimRT.material.uniforms.uNoiseScale.value=this.noiseScale),e.noiseSeed!==void 0&&(this.velocitySimRT.material.uniforms.uNoiseSeed.value=e.noiseSeed),e.randomMass!==void 0&&(this.velocitySimRT.material.uniforms.uRandomMassFactor.value=e.randomMass),((t=e.renderMaterial)==null?void 0:t.size)!==void 0){let n=this.shared.getVariable(e.renderMaterial.size[0],[this.uuid,"particles","size"]);this.velocitySimRT.material.uniforms.particleSize.value=Number(n)}if(((r=e.renderMaterial)==null?void 0:r.spriteRotation)!==void 0&&(this.material.uniforms.uRotation.value=e.renderMaterial.spriteRotation[0],this.material.uniforms.uRotationEnd.value=e.renderMaterial.spriteRotation[1]),e.shape!==void 0){let n=e.shape.size??this.system.data.shape.size,a=[Number(this.shared.getVariable(n[0],[this.uuid,"particles","shape_size_0"])),Number(this.shared.getVariable(n[1],[this.uuid,"particles","shape_size_1"])),Number(this.shared.getVariable(n[2],[this.uuid,"particles","shape_size_2"]))],o={..._f(this.system.data).shape,size:a};(i=this.emitterShape)==null||i.applyToShader(this.positionSimRT.material.uniforms,o)}if(e.gravity!==void 0&&(this.worldGravity.set(0,Number(this.shared.getVariable(this.system.data.gravity,[this.uuid,"particles","gravity"]))/100,0),this.velocitySimRT.material.uniforms.uGravity={value:this.worldGravity}),e.direction!==void 0){let n=this.getDirectionFromVariable(e.direction);this.directionAxis=this.getDirectionAxis(n),this.velocitySimRT.material.uniforms.uDirectionsAxis.value=this.directionAxis}e.randomRotation!==void 0&&(this.material.uniforms.uRandRotationFactor.value=e.randomRotation),e.randomScale!==void 0&&(this.material.uniforms.uRandScaleFactor.value=e.randomScale)}}updateForceFieldParameters(e){!this.velocitySimRT||(e.forceIntensity!==void 0&&(this.velocitySimRT.material.uniforms.uForceIntensity.value=e.forceIntensity),e.forceDambing!==void 0&&(this.velocitySimRT.material.uniforms.uForceDamping.value=e.forceDambing))}getDirectionAxis(e){let t=[Number(e[0])*St.DEG2RAD,Number(e[1])*St.DEG2RAD,Number(e[2])*St.DEG2RAD],r=new vn(t[0],t[1],t[2],"XYZ");return this.directionAxis.set(0,1,0).applyEuler(r).normalize(),this.velocitySimRT&&(this.velocitySimRT.material.uniforms.uDirectionsAxis.value=this.directionAxis),this.directionAxis}shouldReInitGPUCompute(e){let{birthRatePerSec:t,rootObjectType:r,colliderEntityId:i,shape:n,emitTimeDuration:a,emitTimeCycle:o,life:s,directionMode:l,noiseType:c}=e;return t!==void 0||r!==void 0||i||i===null||o!==void 0||n!==void 0||s!==void 0||a!==void 0||l!==void 0||c!==void 0}init(e){this.dispose(),this.particlesAmount=this.getMaxParticlesAmount({birthRatePerSecond:e.birthRatePerSec,particleMaxLifeTime:e.life,loopDuration:e.emitTimeCycle==="infinity"?0:e.emitTimeDuration}),this.particlesAmount>1e5&&(console.warn("The maximum number of particles is limited to 100000."),this.particlesAmount=1e5),this.emitterShape=this.createShape(e.shape,this.particlesAmount);let t=setInterval(()=>{if(this.emitterShape)if(isNaN(this.emitterShape.positionsTexture.source.data.data[0])){this.init(e);return}else clearInterval(t)},100);if(!this.emitterShape)return;let r=new HLe(this.emitterShape.textureSize,this.emitterShape.textureSize,this.renderer),i=this.updateSimulationDefinition(e),n=r.addVariable("uCurrentPosition",i+KLe,this.emitterShape.positionsTexture),a=r.addVariable("uCurrentVelocity",i+tBe,this.emitterShape.directionsTexture),o=r.addVariable("uCurrentEmissionRate",cBe,XLe(this.emitterShape.textureSize));r.setVariableDependencies(n,[n,a,o]),r.setVariableDependencies(a,[n,a,o]),r.setVariableDependencies(o,[n,a,o]);let s=YLe({size:this.emitterShape.textureSize}),l={uOriginalPosition:{value:this.emitterShape.positionsTexture},uWorldOffset:{value:new k(0,0,0)},uWorldQuaternion:{value:new Kt(0,0,0,1)},uTime:{value:0},uFPSRatio:{value:1},uMaxLifeTime:{value:e.life},uEmitterSize:{value:new k(Number(this.shared.getVariable(e.shape.size[0],[this.uuid,"particles","shape_size_0"])),Number(this.shared.getVariable(e.shape.size[1],[this.uuid,"particles","shape_size_1"])),Number(this.shared.getVariable(e.shape.size[2],[this.uuid,"particles","shape_size_2"])))},particleSize:{value:0}};n.material.uniforms=l;let c=this.getDirectionFromVariable(e.direction);this.directionAxis=this.getDirectionAxis(c),this.worldGravity.set(0,Number(this.shared.getVariable(this.system.data.gravity,[this.uuid,"particles","gravity"]))/100,0),this.noiseStrength=Number(this.shared.getVariable(e.noiseStrength,[this.uuid,"particles","noiseStrength"])),this.noiseScale=Number(this.shared.getVariable(e.noiseScale,[this.uuid,"particles","noiseScale"]));let d=e.colliderEntityId&&this.system.getColliderData(e.colliderEntityId),u={uOriginalPosition:{value:this.emitterShape.positionsTexture},uDirections:{value:this.emitterShape.directionsTexture},uDirectionsAxis:{value:this.directionAxis},uWorldQuaternion:{value:new Kt(0,0,0,1)},uColliderPos:{value:new k(0,0,0)},uColliderSize:{value:new k(0,0,0)},uForceIntensity:{value:d?d.forceIntensity:0},uForceDamping:{value:d?d.forceDambing:0},uColliderQuaternion:{value:new Kt(0,0,0,1)},uColliderQuaternionInvert:{value:new Kt(0,0,0,1)},particleSize:{value:0},uGravity:{value:this.worldGravity},uNoiseStrength:{value:this.noiseStrength},uNoiseScale:{value:this.noiseScale},uNoiseSeed:{value:e.noiseSeed},uRandomMassFactor:{value:e.randomMass},uBounce:{value:e.collisionBounce},uSpeed:{value:Number(this.shared.getVariable(e.speed,[this.uuid,"particles","speed"]))/c_}};a.material.uniforms=u;let h={uIndex:{value:s},uTime:{value:0},uLastIndexEmitted:{value:0},uParticlesToEmit:{value:0}};o.material.uniforms=h;let f=[Number(this.shared.getVariable(e.shape.size[0],[this.uuid,"particles","shape_size_0"])),Number(this.shared.getVariable(e.shape.size[1],[this.uuid,"particles","shape_size_1"])),Number(this.shared.getVariable(e.shape.size[2],[this.uuid,"particles","shape_size_2"]))],p={..._f(this.system.data).shape,size:f};this.emitterShape.applyToShader(n.material.uniforms,p),r.init(),this.gpuCompute=r,this.positionSimRT=n,this.velocitySimRT=a,this.emissionRateSimRT=o,this.rootObject=this.createPrimaryEmitter(this.emitterShape.textureSize),this.add(this.rootObject),this.material.needsUpdate=!0}getDirectionFromVariable(e){let t=Number(this.shared.getVariable(e[0],[this.uuid,"particles","direction_x"])),r=Number(this.shared.getVariable(e[1],[this.uuid,"particles","direction_y"])),i=Number(this.shared.getVariable(e[2],[this.uuid,"particles","direction_z"]));return[t,r,i]}updateSimulationDefinition(e){if(this.simFeaturesDefinition.USE_COLLIDER=!1,this.simFeaturesDefinition.USE_ATTRACTOR=!1,this.simFeaturesDefinition.USE_VORTEX=!1,this.simFeaturesDefinition.USE_SPHERE_COLLIDER=!1,this.simFeaturesDefinition.USE_BOX_COLLIDER=!1,this.simFeaturesDefinition.USE_FORCE_LOCAL_SPACE=!1,this.simFeaturesDefinition.USE_NORMALS=!1,this.simFeaturesDefinition.USE_CURL_NOISE=!1,this.simFeaturesDefinition.USE_SIMPLEX_NOISE=!1,this.simFeaturesDefinition.USE_FBM_NOISE=!1,e.colliderEntityId&&this.system.colliderEntities.length>0){let r=this.system.getColliderData(e.colliderEntityId);switch(r==null?void 0:r.forceType){case"attractor":this.simFeaturesDefinition.USE_ATTRACTOR=!0;break;case"collider":this.simFeaturesDefinition.USE_COLLIDER=!0;break;case"vortex":this.simFeaturesDefinition.USE_VORTEX=!0;break}let i=r==null?void 0:r.colliderType;i==="sphere"&&(this.simFeaturesDefinition.USE_SPHERE_COLLIDER=!0),i==="box"&&(this.simFeaturesDefinition.USE_BOX_COLLIDER=!0),(r==null?void 0:r.forceRange)==="helper"&&(this.simFeaturesDefinition.USE_FORCE_LOCAL_SPACE=!0)}e.directionMode==="normals"&&(this.simFeaturesDefinition.USE_NORMALS=!0),e.noiseType==="curl"&&(this.simFeaturesDefinition.USE_CURL_NOISE=!0),e.noiseType==="simplex"&&(this.simFeaturesDefinition.USE_SIMPLEX_NOISE=!0),e.noiseType==="fbm"&&(this.simFeaturesDefinition.USE_FBM_NOISE=!0);let t="";for(let[r,i]of Object.entries(this.simFeaturesDefinition))i&&(t+=`#define ${r}
`);return t}createShape(e,t){this.emitterShape&&this.emitterShape.dispose();let r=new k(Number(this.shared.getVariable(e.size[0],[this.uuid,"particles","shape_size_0"])),Number(this.shared.getVariable(e.size[1],[this.uuid,"particles","shape_size_1"])),Number(this.shared.getVariable(e.size[2],[this.uuid,"particles","shape_size_2"])));if(e.type==="MeshEmitterShape"){let i=null;return this.system.context.scene.traverseEntity(n=>{n.uuid===e.fromMeshId&&(i=n)}),i?new l_(r,t,e.type,i):new l_(r,t,"SphereEmitterShape")}else return new l_(r,t,e.type)}createPrimaryEmitter(e){let t,r=e*e;return t=new Vxe(new rc(1,1,1),this.material,r),this.updateGeometryAttributes(t,e),this.material.needsUpdate=!0,t.onBeforeRender=()=>{this.applyWorldSpace()},t}getMaxParticlesAmount({birthRatePerSecond:e,particleMaxLifeTime:t,loopDuration:r=0}){return Math.ceil(e*(t+r))}dispose(){var e,t,r;!this.gpuCompute||((t=(e=this.rootObject)==null?void 0:e.parent)==null||t.remove(this.rootObject),this.gpuCompute.dispose(),this.material.nodeMaterialDispose(),(r=this.emitterShape)==null||r.dispose())}GoEmitSomeParticles(e,t){let r=e-this.lastEmitTime,i=1/t;if(r>=i){let n=Math.max(1,Math.floor(r/i));return this.lastEmitTime=e,this.emittedParticlesAmount+n>this.particlesAmount&&(this.emittedParticlesAmount=0),this.emittedParticlesAmount+=n,n}return 0}checkIfAllParticlesAreDead(){return this.lastEmitTime+this.system.data.life+1<this.globalTime}reset(){this.hasBeenReset=!0,this.lastEmitTime=0,this.emittedParticlesAmount=0,this.gpuCompute&&this.init(_f(this.system.data))}startEmitting(e){this.isEmitting=!0,this.hasBeenReset=!1,this.lastEmitTime=e}stopEmitting(){this.isEmitting=!1}},Ab=class extends Ra{constructor(e,t,r){super(e,t),this.type="ParticleSystem",this.geometry=new Ot,this.actualTime=0,this.currentLoopTime=0,this.started=!1,this.stopped=!1,this.timeoutId=void 0,this.isFrozen=!1,this.isIdle=!0,this.emitter=null,this.colliderEntities=[],this.renderer=null,this.isPreWarm=!1,this._hasOnAfterRenderBeenCalled=!1,this.onAfterRender=i=>{this._hasOnAfterRenderBeenCalled||(this._hasOnAfterRenderBeenCalled=!0,this.init(i))},this.context=r,this.data={...t,..._f(t)},this.geometry.setAttribute("position",new yt([],3)),this.material=new tc({colorWrite:!1}),this.frustumCulled=!1}init(e){this.renderer=e,this.emitter=new dBe(e,this),this.add(this.emitter),this.updateParticleState(this.data)}update(e){if(!this.isReady||!this.started||this.isFrozen||this.isIdle)return;this.actualTime+=e,this.stopped||(this.currentLoopTime+=e);let t=this.data.emitTimeCycle==="one_time";if((this.data.emitTimeCycle==="loop"||t)&&this.currentLoopTime>this.data.emitTimeDuration*1e3&&(this.stopped||(this.stop(),t||this.start(this.data.emitTimeDelay*1e3))),this.emitter&&this.started){let r=this.actualTime/1e3;this.emitter.update(r,e)}this.scale.set(1,1,1),this.updateMatrix()}isReady(){return!!this.emitter}hasCollider(e){return this.colliderEntities.some(t=>t.identity===e)}getColliderData(e){let t=this.colliderEntities.find(r=>r.identity===e);return t?t.data:null}updateByPatchedOp(e,t,r){super.updateByPatchedOp(e,t,r),si(e.path,["renderMaterial"])&&this.updateParticleState({renderMaterial:{...this.data.renderMaterial,...zn.drop(e,1).props}}),si(e.path,["shape"])&&this.updateParticleState({shape:{...this.data.shape,...zn.drop(e,1).props}})}updateState(e,t){super.updateState(e,t),this.updateParticleState(e)}updateParticleState(e){if(this.emitter){if(e.colliderEntityId!==void 0&&e.colliderEntityId!==null){let t=this.context.scene.find(e.colliderEntityId);this.colliderEntities=t?[t]:[]}e.colliderEntityId===null&&(this.colliderEntities=[]),this.emitter.updateState(e),e.emitTimeCycle&&this.started&&this.start()}}updateFromColliderEntity(e){!this.emitter||(this.emitter.updateForceFieldParameters(e),this.stop(),this.start())}start(e=0){var t;if(this.currentLoopTime=0,e){this.timeoutId=window.setTimeout(()=>{this.start(0)},e);return}this.started=!0,this.stopped=!1,this.isFrozen=!1,(t=this.emitter)==null||t.startEmitting(this.actualTime/1e3)}froze(){this.isFrozen=!0}unFroze(){this.isFrozen=!1}stop(){var e;this.stopped=!0,this.currentLoopTime=0,(e=this.emitter)==null||e.stopEmitting(),clearTimeout(this.timeoutId)}reset(){var e;this.started=!1,this.stopped=!1,(e=this.emitter)==null||e.reset()}wakeUp(){this.isIdle=!1}sleep(){this.isIdle=!0,this.reset()}};function uBe(){try{let e=window.location.href;if(e.includes("reducesubdiv=")){let t=e.indexOf("reducesubdiv=")+13;return parseInt(e.slice(t,t+1))}}catch{}}var d_=uBe();function hBe(e,t,r){var n;d_!==void 0&&(((n=t==null?void 0:t.geometry)==null?void 0:n.subdivisions)??0)>d_&&(console.log("reducing subdivisions",t.name,t.geometry.subdivisions),t.geometry.subdivisions=d_);let i;return t.geometry.type==="TextGeometry"?new lD(e,t,r):t.geometry.type==="InputGeometry"?new vD(e,t,r):(t.geometry.type==="SubdivGeometry"?i=new _g(e,t,r):t.geometry.type==="PathGeometry"?i=new mD(e,t,r):t.geometry.type==="VectorGeometry"?i=new jLe(e,t,r):t.geometry.type==="BooleanGeometry"?i=new sh(e,t,r):t.geometry.type==="UIGeometry"?i=new ha(e,t,r):i=new ma(e,t,r),i)}function yD(e,t,r){return console.assert(t.type!==void 0),t.type==="Mesh"?hBe(e,t,r):t.type==="Empty"?new Zf(e,t):t.type==="Particle"?new Ab(e,t,r):t.type==="ParticleCollider"?new Cb(e,t,r):t.type==="Splat"?new Zf(e,t):t.type==="Bone"?new VLe(e,t):t.type==="Page"?new Pn(e,t,r):t.type==="PointLight"?new ULe(e,t,r):t.type==="SpotLight"?new WH(e,t,r):t.type==="DirectionalLight"?new HH(e,t,r):t.type==="Component"||t.type==="Instance"?new Jf(e,t,r):ah.is(t.type)?new va(e,t):(console.error(t),new Zf(e,t))}nd.createEntity=yD;function fBe(e,t,r){let i=yD(e.identity,t,r),n=e.children,a=e.attachedPaths,o=e.parent,s=e.component,l=e.instances,c=e.overrideData,d=e.uuid,u=e.stateSelection;e.dispose();for(let h of Object.keys(e))delete e[h];Object.setPrototypeOf(e,Object.getPrototypeOf(i));for(let h of Object.keys(i))e[h]=i[h];e.children=[...e.children,...n],e.attachedPaths=a,e.parent=o,e.component=s,e.instances=l,e.uuid=d,e.overrideData=c,e.updateState(e.data,r),u&&e.changeSelectedState(u,r),e.resetBBoxNeedsUpdate()}nd.changeEntityProptotype=fBe;nd.Cloner=ns;function pBe(e,t,r,i){e.updateByOp(t,r,i,!1)}function e4(e,t){let r=!1,i=t.getLayersOfType("transmission"),n=t.getLayersOfType("outline");return n.length>0&&(e.layers.set(8),i.length>0&&e.layers.enable(3),r=!0,sD(e),oD(e)),i.length===0&&n.length===0&&e.layers.set(0),e instanceof tm&&e.needsAO&&e.layers.enable(5),r}function t4(e,t){if(!t.layers)return!1;let r=!1,i=t.getLayersOfType("transmission").filter(a=>a.data.visible),n=t.getLayersOfType("outline").filter(a=>a.data.visible);return i.length>0&&(e.layers.set(3),n.length>0&&e.layers.enable(8),r=!0),i.length===0&&n.length===0&&e.layers.set(0),e.needsAO&&e.layers.enable(5),r}function mBe(e){let t=!1;return e.traverseEntity(r=>{if(r instanceof tm)if(Array.isArray(r.material))for(let i=0;i<r.material.length;i++)e4(r,r.material[i])&&(t=!0);else e4(r,r.material)&&(t=!0)}),t}function vBe(e){let t=!1;return e.traverseEntity(r=>{if(r instanceof tm)if(Array.isArray(r.material))for(let i=0;i<r.material.length;i++)t4(r,r.material[i])&&(t=!0);else t4(r,r.material)&&(t=!0)}),t}var gBe=new Wj,yBe=new it,bBe=new jp;function hE(e,t,r,i=!1){let n=e.cloner;if(n)for(let a of n.children){let o=yBe.copy(a.matrixWorld).invert(),s=bBe.copy(t.ray).applyMatrix4(o),l=e.matrixWorld;s.applyMatrix4(l);let c=gBe;c.set(s.origin,s.direction),c.near=t.near,c.far=t.far;let d=c.intersectObject(e,!1);d.length>0&&r.push({...d[0],object:i?a:e})}}var xBe=class{constructor(){this._constraints=new Map}setConstraint(e,t){t===null?this._constraints.delete(e):this._constraints.set(e,t)}removeDependencies(e){this._constraints.delete(e)}applyConstraints(e){let t=new Set;this._constraints.forEach((r,i)=>{let n=[i,r],a=r;for(;this._constraints.has(a);){if(a=this._constraints.get(a),n.includes(a)){console.warn(`circular dependency detected: ${n.join(" -> ")}`);break}t.has(a)||n.push(a)}for(let o=n.length-2;o>=0;o--)if(!t.has(n[o])){let s=e.find(n[o]);s?s.applyPathSnapping(e):console.warn(`missing entity ${n[o]}`),t.add(n[o])}})}findDependency(e,t){let r=e;for(;this._constraints.has(r);)if(r=this._constraints.get(r),r===t)return!0;return!1}},wBe="AGFzbQEAAAAADwhkeWxpbmsuMAEEAAAAAAETA2AAAGAIf39/f39/f38AYAABfwISAQNlbnYGbWVtb3J5AgMAgIAEAwQDAAECBzkDEV9fd2FzbV9jYWxsX2N0b3JzAAALc29ydEluZGV4ZXMAARNlbXNjcmlwdGVuX3Rsc19pbml0AAIK3gMDAwABC9IDAwF/BnwBfgJAIAdFDQAgAysDUCEMIAMrAzAhDSADKwMQIQ5BACEDRP///////+9/IQtEAAAAAAAAEAAhCgNAIAIgA0ECdGoCfyAOIAEgA0EMbGoiCCoCALuiIA0gCCoCBLuioCAMIAgqAgi7oqBEAAAAAAAAsECiIgmZRAAAAAAAAOBBYwRAIAmqDAELQYCAgIB4CzYCACAJIAsgCSALYxshCyAJIAogCSAKZBshCiADQQFqIgMgB0cNAAsgB0UNACAGuCAKIAuhoyEJQQAhAwNAAn8gCSACIANBAnRqIgEoAgC3IAuhoiIKmUQAAAAAAADgQWMEQCAKqgwBC0GAgICAeAshCCABIAg2AgAgBCAIQQJ0aiIBIAEoAgBBAWo2AgAgA0EBaiIDIAdHDQALCyAGQQJPBEAgBCgCACEIQQEhAwNAIAQgA0ECdGoiASABKAIAIAhqIgg2AgAgA0EBaiIDIAZHDQALCyAHQQFrIgGtIQ8DQCAEIAIgD6dBAnQiA2ooAgBBAnRqIgcgBygCAEEBayIHNgIAIAUgASAHa0ECdGogACADaigCADYCACAPUCEDIA9CAX0hDyADRQ0ACyAGBEAgBEEAIAZBAnT8CwALCwQAQQAL",od=class{};Qm(od,"DepthMapRange",65536),Qm(od,"MemoryPageSize",65536),Qm(od,"BytesPerFloat",4),Qm(od,"BytesPerInt",4);function SBe(e){let t,r,i,n,a,o,s,l,c,d,u,h,f,p,v,m;function g(P){let T=new Float64Array(d,o,16);for(let z=0;z<16;z++)T[z]=P[z];let R;if(i>1){t.exports.sortIndexes(n,a,c,o,s,l,h.DepthMapRange,i);let z=new Uint32Array(i);R=z.buffer,z.set(new Uint32Array(d,l,i))}else if(i===1){let z=new Uint32Array(i);z[0]=new Uint32Array(d,n,r)[0],R=z.buffer}else R=new ArrayBuffer(0);e.postMessage({sortDone:!0,indexesBuffer:R},[R])}function y(P,T,R){let z=new Float32Array(d,a,r*3);i=0;let F=new Uint32Array(d,n,r);for(let H=0;H<R.length-1;H++){let N=T[H],U=P[H].elements,ie=N.filter(X=>X.enabled&&X.mode==="Include").map(X=>X.type==="Box"?w(X):A(X)),te=N.filter(X=>X.enabled&&X.mode==="Exclude").map(X=>X.type==="Box"?w(X):A(X));for(let X=R[H];X<R[H+1];X++){let W=f[X*3],q=f[X*3+1],$=f[X*3+2];if((ie.length===0||x(W,q,$,ie))&&(te.length===0||!x(W,q,$,te))){let le=1/(U[3]*W+U[7]*q+U[11]*$+U[15]);z[i*3]=(U[0]*W+U[4]*q+U[8]*$+U[12])*le,z[i*3+1]=(U[1]*W+U[5]*q+U[9]*$+U[13])*le,z[i*3+2]=(U[2]*W+U[6]*q+U[10]*$+U[14])*le,F[i]=X,i++}}}}function b(P,T){let R=[],z=T.filter(N=>N.enabled&&N.mode==="Include").map(N=>N.type==="Box"?w(N):A(N)),F=T.filter(N=>N.enabled&&N.mode==="Exclude").map(N=>N.type==="Box"?w(N):A(N)),H=P.length;for(let N=0;N<H;N+=3){let U=P[N],ie=P[N+1],te=P[N+2];(z.length===0||x(U,ie,te,z))&&(F.length===0||!x(U,ie,te,F))||R.push(N/3)}return R}function x(P,T,R,z,F){return z.some(H=>{let N=S(P,T,R,H.invRotationMatrix,H.cropCenter);return Array.isArray(H)?C(N.x,N.y,N.z,H):M(N.x,N.y,N.z,H)})}function S(P,T,R,z,F){let H=P-F[0],N=T-F[1],U=R-F[2],ie=1/(z[3]*H+z[7]*N+z[11]*U+z[15]);return{x:(z[0]*H+z[4]*N+z[8]*U+z[12])*ie+F[0],y:(z[1]*H+z[5]*N+z[9]*U+z[13])*ie+F[1],z:(z[2]*H+z[6]*N+z[10]*U+z[14])*ie+F[2]}}function w(P){let T=P.cropSize[0]/2,R=P.cropSize[1]/2,z=P.cropSize[2]/2,F=[P.cropCenter[0]-T,P.cropCenter[1]-R,P.cropCenter[2]-z,P.cropCenter[0]+T,P.cropCenter[1]+R,P.cropCenter[2]+z],H=_(P.cropRotation);return Object.assign(F,{invRotationMatrix:H,cropCenter:P.cropCenter})}function _(P){let T=[],R=P[0]*Math.PI/180,z=P[1]*Math.PI/180,F=P[2]*Math.PI/180,H=Math.cos(R),N=Math.sin(R),U=Math.cos(z),ie=Math.sin(z),te=Math.cos(F),X=Math.sin(F),W=H*te,q=H*X,$=N*te,le=N*X;return T[0]=U*te,T[1]=-U*X,T[2]=ie,T[4]=q+$*ie,T[5]=W-le*ie,T[6]=-N*U,T[8]=le-W*ie,T[9]=$+q*ie,T[10]=H*U,T[12]=0,T[13]=0,T[14]=0,T[3]=0,T[7]=0,T[11]=0,T[15]=1,T}function C(P,T,R,z){return P>=z[0]&&P<=z[3]&&T>=z[1]&&T<=z[4]&&R>=z[2]&&R<=z[5]}function A(P){let T=2/P.cropSize[0],R=2/P.cropSize[1],z=2/P.cropSize[2],F=_(P.cropRotation);return{invRadiusX:T,invRadiusY:R,invRadiusZ:z,cropCenter:P.cropCenter,invRotationMatrix:F}}function M(P,T,R,z){let F=(P-z.cropCenter[0])*z.invRadiusX,H=(T-z.cropCenter[1])*z.invRadiusY,N=(R-z.cropCenter[2])*z.invRadiusZ;return F*F+H*H+N*N<=1}e.onmessage=P=>{if(P.data.getCroppedIndexes){let T=new Uint32Array(b(new Float32Array(P.data.positions),P.data.crops)).buffer;e.postMessage({outOfBoundsIndexes:T},[T])}else if(P.data.positions)u=P.data.positions,f=new Float32Array(u),v=P.data.meshMatrixWorlds,m=P.data.cropsArray,p=P.data.meshIndexIntervals,y(v,m,p),e.postMessage({sortSetupComplete:!0});else if(P.data.sort||P.data.newMatrixWorlds||P.data.newCropsArray)(P.data.newMatrixWorlds||P.data.newCropsArray)&&(m=P.data.newCropsArray||m,v=P.data.newMatrixWorlds||v,y(v,m,p)),g(P.data.sort.view,P.data.sort.cameraPosition);else if(P.data.init){h=P.data.init.Constants,r=P.data.init.splatCount;let T=h.BytesPerInt,R=h.BytesPerFloat*3,z=new Uint8Array(P.data.init.sorterWasmBytes),F=T+R,H=r*F,N=r*h.BytesPerInt*2+h.DepthMapRange*h.BytesPerInt*2,U=h.MemoryPageSize*32,ie=H+N+U,te=Math.floor(ie/h.MemoryPageSize)+1,X={module:{},env:{memory:new WebAssembly.Memory({initial:te*2,maximum:te*3,shared:!0})}};WebAssembly.compile(z).then(W=>WebAssembly.instantiate(W,X)).then(W=>{t=W,n=0,a=r*T,o=a+r*R,c=o+16*h.BytesPerFloat*2,s=c+r*h.BytesPerInt,l=s+h.DepthMapRange*h.BytesPerInt,d=X.env.memory.buffer,e.postMessage({sortSetupPhase1Complete:!0})})}}}function CBe(e){let t=new Worker(URL.createObjectURL(new Blob(["(",SBe.toString(),")(self)"],{type:"application/javascript"}))),r=atob(wBe),i=new Uint8Array(r.length);for(let n=0;n<r.length;n++)i[n]=r.charCodeAt(n);return t.postMessage({init:{sorterWasmBytes:i.buffer,splatCount:e,Constants:{BytesPerFloat:od.BytesPerFloat,BytesPerInt:od.BytesPerInt,DepthMapRange:od.DepthMapRange,MemoryPageSize:od.MemoryPageSize}}}),t}var u_=function(){let e=new Float32Array(1),t=new Int32Array(e.buffer);return function(r){return e[0]=r,t[0]}}(),_Be=function(e,t,r,i){return e+(t<<8)+(r<<16)+(i<<24)},Ky=new ye;function r4(e){let t=!1;return e.scene.objects.traverse((r,i)=>{if(i.visible===!1)return!0;i.type==="Splat"&&(t=!0)}),t}var Mb=class extends Di{constructor(e,t,r,i,n=!1,a=1,o,s){super(r,i),this.splatCount=t,this.meshIndexIntervals=o,this.meshMatrixWorlds=s,this.splatBuffers=e,this.geometry=r,this.material=i,this.splatDataTextures=null,this.halfPrecisionCovariancesOnGPU=n,this.devicePixelRatio=a,this.resetLocalSplatDataAndTexturesFromSplatBuffer()}static buildMesh(e,t,r=!1,i=1,n,a){let o=Mb.buildGeomtery(t),s=Mb.buildMaterial(n);return new Mb(e,t,o,s,r,i,n,a)}static buildMaterial(e){let t=`
            precision highp float;
            #include <common>

            attribute uint splatIndex;

            uniform highp sampler2D covariancesTexture;
            uniform highp usampler2D centersColorsTexture;
            uniform vec2 focal;
            uniform vec2 viewport;
            uniform vec2 basisViewport;
            uniform vec2 covariancesTextureSize;
            uniform vec2 centersColorsTextureSize;
						uniform highp sampler2D meshMatrixWorldsTexture;
						uniform uint meshIndexIntervals[257];
						uniform float orthoZoom;

            varying vec4 vColor;
            varying vec2 vUv;

            varying vec2 vPosition;

            const vec4 encodeNorm4 = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0);
            const uvec4 mask4 = uvec4(uint(0x000000FF), uint(0x0000FF00), uint(0x00FF0000), uint(0xFF000000));
            const uvec4 shift4 = uvec4(0, 8, 16, 24);
            vec4 uintToRGBAVec (uint u) {
               uvec4 urgba = mask4 & u;
               urgba = urgba >> shift4;
               vec4 rgba = vec4(urgba) * encodeNorm4;
               return rgba;
            }

            vec2 getDataUV(in int stride, in int offset, in vec2 dimensions) {
                vec2 samplerUV = vec2(0.0, 0.0);
                float d = float(splatIndex * uint(stride) + uint(offset)) / dimensions.x;
                samplerUV.y = float(floor(d)) / dimensions.y;
                samplerUV.x = fract(d);
                return samplerUV;
            }

            void main () {
                uvec4 sampledCenterColor = texture(centersColorsTexture, getDataUV(1, 0, centersColorsTextureSize));
                vec3 splatCenter = uintBitsToFloat(uvec3(sampledCenterColor.gba));
                vColor = uintToRGBAVec(sampledCenterColor.r);

                vPosition = position.xy * 2.0;

								uint meshIndex;
								for (int i = 1; i < 257; i++) {
									if (splatIndex < meshIndexIntervals[i]) {
										meshIndex = uint(i - 1);
										break;
									}
								}

								float strideMulmeshIndex = float(4u*meshIndex);
								float meshMatrixWorldsTextureLength = float(256*4);

								mat4 modelMat = mat4(
									texture(meshMatrixWorldsTexture, vec2((strideMulmeshIndex+0.0)/meshMatrixWorldsTextureLength, 0)),
									texture(meshMatrixWorldsTexture, vec2((strideMulmeshIndex+1.0)/meshMatrixWorldsTextureLength, 0)),
									texture(meshMatrixWorldsTexture, vec2((strideMulmeshIndex+2.0)/meshMatrixWorldsTextureLength, 0)),
									texture(meshMatrixWorldsTexture, vec2((strideMulmeshIndex+3.0)/meshMatrixWorldsTextureLength, 0))
								);
								mat4 modelViewMat = viewMatrix * modelMat;
								vec4 viewCenter = modelViewMat * vec4(splatCenter, 1.0); 
                vec4 clipCenter = projectionMatrix * viewCenter;

                vec2 sampledCovarianceA = texture(covariancesTexture, getDataUV(3, 0, covariancesTextureSize)).rg;
                vec2 sampledCovarianceB = texture(covariancesTexture, getDataUV(3, 1, covariancesTextureSize)).rg;
                vec2 sampledCovarianceC = texture(covariancesTexture, getDataUV(3, 2, covariancesTextureSize)).rg;

                vec3 cov3D_M11_M12_M13 = vec3(sampledCovarianceA.rg, sampledCovarianceB.r);
                vec3 cov3D_M22_M23_M33 = vec3(sampledCovarianceB.g, sampledCovarianceC.rg);

                // Compute the 2D covariance matrix from the upper-right portion of the 3D covariance matrix
                mat3 Vrk = mat3(
                    cov3D_M11_M12_M13.x, cov3D_M11_M12_M13.y, cov3D_M11_M12_M13.z,
                    cov3D_M11_M12_M13.y, cov3D_M22_M23_M33.x, cov3D_M22_M23_M33.y,
                    cov3D_M11_M12_M13.z, cov3D_M22_M23_M33.y, cov3D_M22_M23_M33.z
                );
                float s = 1.0 / (viewCenter.z * viewCenter.z);

                mat3 W = transpose(mat3(modelViewMat));
                mat3 T = orthoZoom > 0.0 ? W : W * mat3(
									focal.x / viewCenter.z, 0., -(focal.x * viewCenter.x) * s,
									0., focal.y / viewCenter.z, -(focal.y * viewCenter.y) * s,
									0., 0., 0.
								);
                mat3 cov2Dm = transpose(T) * Vrk * T;
                cov2Dm[0][0] += 0.3;
                cov2Dm[1][1] += 0.3;

                // We are interested in the upper-left 2x2 portion of the projected 3D covariance matrix because
                // we only care about the X and Y values. We want the X-diagonal, cov2Dm[0][0],
                // the Y-diagonal, cov2Dm[1][1], and the correlation between the two cov2Dm[0][1]. We don't
                // need cov2Dm[1][0] because it is a symetric matrix.
                vec3 cov2Dv = vec3(cov2Dm[0][0], cov2Dm[0][1], cov2Dm[1][1]);

                vec3 ndcCenter = clipCenter.xyz / clipCenter.w;

                // We now need to solve for the eigen-values and eigen vectors of the 2D covariance matrix
                // so that we can determine the 2D basis for the splat. This is done using the method described
                // here: https://people.math.harvard.edu/~knill/teaching/math21b2004/exhibits/2dmatrices/index.html
                //
                // This is a different approach than in the original work at INRIA. In that work they compute the
                // max extents of the 2D covariance matrix in screen space to form an axis aligned bounding rectangle
                // which forms the geometry that is actually rasterized. They then use the inverse 2D covariance
                // matrix (called 'conic') to determine fragment opacity.
                float a = cov2Dv.x;
                float d = cov2Dv.z;
                float b = cov2Dv.y;
                float D = a * d - b * b;
                float trace = a + d;
                float traceOver2 = 0.5 * trace;
                float term2 = sqrt(trace * trace / 4.0 - D);
                float eigenValue1 = traceOver2 + term2;
								float eigenValue2 = max(traceOver2 - term2, 0.00); // prevent negative eigen value

                const float maxSplatSize = 1024.0;
                vec2 eigenVector1 = normalize(vec2(b, eigenValue1 - a));
                // since the eigen vectors are orthogonal, we derive the second one from the first
                vec2 eigenVector2 = vec2(eigenVector1.y, -eigenVector1.x);
                vec2 basisVector1 = eigenVector1 * min(sqrt(2.0 * eigenValue1), maxSplatSize);
                vec2 basisVector2 = eigenVector2 * min(sqrt(2.0 * eigenValue2), maxSplatSize);

                vec2 ndcOffset = vec2(vPosition.x * basisVector1 + vPosition.y * basisVector2) * basisViewport;

								if (orthoZoom > 0.0) {
									ndcOffset *= orthoZoom;
								}

                gl_Position = vec4(ndcCenter.xy + ndcOffset, ndcCenter.z, 1.0);
            }`,r=`
            precision highp float;
            #include <common>

            uniform vec3 debugColor;

            varying vec4 vColor;
            varying vec2 vUv;

            varying vec2 vPosition;
						layout(location = 1) out vec4 gVelocity; 

            void main () {
                // compute the negative squared distance from the center of the splat to the
                // current fragment in the splat's local space.
                float A = -dot(vPosition, vPosition);
                if (A < -4.0) discard;
                vec3 color = vColor.rgb;
                A = exp(A) * vColor.a;
                gl_FragColor = vec4(color.rgb, A);
								gVelocity = vec4(0.0); // so it is ignored by TAA
            }`,i={covariancesTexture:{type:"t",value:null},centersColorsTexture:{type:"t",value:null},meshIndexIntervals:{value:e},meshMatrixWorldsTexture:{type:"t",value:null},focal:{type:"v2",value:new ye},viewport:{type:"v2",value:new ye},basisViewport:{type:"v2",value:new ye},debugColor:{type:"v3",value:new Lt},covariancesTextureSize:{type:"v2",value:new ye(1024,1024)},centersColorsTextureSize:{type:"v2",value:new ye(1024,1024)},orthoZoom:{type:"f",value:-1}};return new jr({uniforms:i,vertexShader:t,fragmentShader:r,transparent:!0,alphaTest:1,blending:Fu,depthTest:!0,depthWrite:!1,side:fa})}static buildGeomtery(e){let t=new Ot;t.setIndex([0,1,2,0,2,3]);let r=new Float32Array(4*3),i=new $t(r,3);t.setAttribute("position",i),i.setXYZ(0,-1,-1,0),i.setXYZ(1,-1,1,0),i.setXYZ(2,1,1,0),i.setXYZ(3,1,-1,0),i.needsUpdate=!0;let n=new Vj().copy(t),a=new Uint32Array(e),o=new ag(a,1,!1);return o.setUsage(Eve),n.setAttribute("splatIndex",o),n.instanceCount=e,n}resetLocalSplatDataAndTexturesFromSplatBuffer(){this.updateLocalSplatDataFromSplatBuffer(),this.allocateAndStoreLocalSplatDataInTextures()}updateLocalSplatDataFromSplatBuffer(){this.splatBuffers.forEach(i=>i.buildPreComputedBuffers()),this.covariances=new Float32Array(this.splatCount*6),this.colors=new Uint8Array(this.splatCount*4),this.centers=new Float32Array(this.splatCount*3);let e=0,t=0,r=0;for(let i of this.splatBuffers){let n=i.nsplats;this.colors.subarray(e,e+n*4).set(i.colorsA),e+=n*4,this.centers.subarray(t,t+n*3).set(i.decoded.xyz.denormDequant().data),t+=n*3,this.covariances.subarray(r,r+n*6).set(new Float32Array(i.precomputedCovarianceBufferData)),r+=n*6}}allocateAndStoreLocalSplatDataInTextures(){let e=this.splatCount,t=new ye(4096,1024);for(;t.x*t.y*2<e*6;)t.y*=2;let r=new ye(4096,1024);for(;r.x*r.y*4<e*4;)r.y*=2;let i,n;if(this.halfPrecisionCovariancesOnGPU){n=new Uint16Array(t.x*t.y*2);for(let d=0;d<this.covariances.length;d++)n[d]=iwe.toHalfFloat(this.covariances[d]);i=new Po(n,t.x,t.y,sx,ec)}else n=new Float32Array(t.x*t.y*2),n.set(this.covariances),i=new Po(n,t.x,t.y,sx,on);i.needsUpdate=!0,this.material.uniforms.covariancesTexture.value=i,this.material.uniforms.covariancesTextureSize.value.copy(t);let a=new Uint32Array(r.x*r.y*4);for(let d=0;d<e;d++){let u=d*4,h=d*3,f=d*4;a[f]=_Be(this.colors[u],this.colors[u+1],this.colors[u+2],this.colors[u+3]),a[f+1]=u_(this.centers[h]),a[f+2]=u_(this.centers[h+1]),a[f+3]=u_(this.centers[h+2])}let o=new Po(a,r.x,r.y,aj,Wl);o.internalFormat="RGBA32UI",o.needsUpdate=!0,this.material.uniforms.centersColorsTexture.value=o,this.material.uniforms.centersColorsTextureSize.value.copy(r);let s=256*4,l=new Float32Array(256*16);for(let d=0;d<this.meshMatrixWorlds.length;d++)l.set(this.meshMatrixWorlds[d].elements,d*16);let c=new Po(l,s,1,In,on);c.needsUpdate=!0,this.material.uniforms.meshMatrixWorldsTexture.value=c,this.material.uniformsNeedUpdate=!0,this.splatDataTextures={covariances:{data:n,texture:i,size:t},centerColors:{data:a,texture:o,size:r},meshMatrixWorlds:{data:l,texture:c}}}updateIndexes(e){let t=this.geometry;t.attributes.splatIndex.set(e),t.attributes.splatIndex.needsUpdate=!0,t.instanceCount=e.length}updateUniforms(e,t,r,i){this.splatCount>0&&(Ky.set(e.x*this.devicePixelRatio,e.y*this.devicePixelRatio),this.material.uniforms.viewport.value.copy(Ky),this.material.uniforms.basisViewport.value.set(2/Ky.x,2/Ky.y),this.material.uniforms.focal.value.set(t,r),this.material.uniforms.orthoZoom.value=i,this.material.uniformsNeedUpdate=!0)}getSplatDataTextures(){return this.splatDataTextures}getSplatCount(){return this.splatCount}getCenters(){return this.centers}getColors(){return this.colors}getCovariances(){return this.covariances}dispose(){this.geometry.dispose(),this.material.dispose(),this.splatDataTextures&&(this.splatDataTextures.covariances.texture.dispose(),this.splatDataTextures.centerColors.texture.dispose(),this.splatDataTextures.meshMatrixWorlds.texture.dispose()),this.removeFromParent()}},rW,ABe=new Promise(e=>{rW=e}),i4=!1,Qy;function MBe(){if(i4)return;if(Qy)return Qy;async function e(){let t=await Nd(()=>import("./gaussian-splat-compression-ro4O0smp.js"),[]);rW(t),i4=!0}return Qy=e(),Qy}var iW;ABe.then(e=>iW=e);var EBe=class{constructor(e={}){Qm(this,"updateView",function(){let t=new it,r=[],i=new k(0,0,-1),n=new k(0,0,-1),a=new k,o=new k;return function(s=!1,l){let c=this.updateMatrixWorldsInWorkerIfNeeded(),d=this.cropsChanged();if(!s){n.set(0,0,-1).applyQuaternion(l.quaternion);let h=!1,f=!1;if(n.dot(i)<=.95&&(h=!0),o.copy(l.position).sub(a).length()>=1&&(f=!0),!h&&!f&&!c&&!d&&!this.needsInitialRender)return}this.needsInitialRender=!1,a.copy(l.position),i.copy(n),t.copy(l.matrixWorld).invert(),t.premultiply(this.dummyPerspectiveMatrix),r[0]=l.position.x,r[1]=l.position.y,r[2]=l.position.z;let u={sort:{view:t.elements,cameraPosition:r,splatRenderCount:this.splatRenderCount,splatSortCount:this.splatRenderCount},...c?{newMatrixWorlds:this.meshMatrixWorlds}:{},...d?{newCropsArray:this.cropsArray}:{}};this.sortRunning?this.queuedMessage=u:(this.queuedMessage=null,this.sortRunning=!0,this.sortWorker.postMessage(u))}}()),this.scene=e.scene,this.currentPage=null,this.devicePixelRatio=window.devicePixelRatio,this.sortWorker=null,this.splatRenderCount=0,this.splatSortCount=0,this.splatMesh=null,this.sortRunning=!1,this.meshMatrixWorlds=null,this.meshMatrixWorldsOld=null,this.cropsArray=null,this.splatEntries=null,this.queuedMessage=null,this.needsInitialRender=!0,this.dummyPerspectiveMatrix=new it().makePerspective(-1,1,-1,1,.1,1e3)}updateSplatMeshUniforms(e,t){let r=new ye;this.splatMesh!==null&&this.splatMesh.getSplatCount()>0&&(e.getSize(r),this.cameraFocalLengthX=t.projectionMatrix.elements[0]*this.devicePixelRatio*r.x*.45,this.cameraFocalLengthY=t.projectionMatrix.elements[5]*this.devicePixelRatio*r.y*.45,this.splatMesh.updateUniforms(r,this.cameraFocalLengthX,this.cameraFocalLengthY,t.isPerspectiveCamera?-1:t.zoom*this.devicePixelRatio))}loadSplat(e={}){this.activePage=this.scene.activePage,e.position&&(e.position=new k().fromArray(e.position)),e.orientation&&(e.orientation=new Xt().fromArray(e.orientation)),e.halfPrecisionCovariances=!!e.halfPrecisionCovariances;let t=[];if(this.splatEntries=t,this.activePage.traverseVisibleEntity(a=>{a.data.type==="Splat"&&t.push(a)}),this.splatMesh&&this.splatMesh.dispose(),t.length===0)return this.splatMesh=null,!1;this.meshMatrixWorlds=t.map(a=>a.matrixWorld),this.meshMatrixWorldsOld=t.map(a=>a.matrixWorld.clone()),this.cropsArray=t.map(a=>a.data.crops.map(o=>o.data));let r=t.map(a=>new iW.GSplineBuffer(new Uint8Array(a.data.buffer).buffer)),i=0,n=[0];for(let a of r)i+=a.getSplatCount(),n.push(i);return this.setupSplatMesh(r,i,e.position,e.orientation,e.halfPrecisionCovariances,this.devicePixelRatio,n,this.meshMatrixWorlds),this.setupSortWorker(i),!0}updateMatrixWorldsInWorkerIfNeeded(){let e=this.splatDataTextures.meshMatrixWorlds.data;for(let t=0;t<this.meshMatrixWorlds.length;t++)e.set(this.meshMatrixWorlds[t].elements,t*16);return this.splatDataTextures.meshMatrixWorlds.texture.needsUpdate=!0,this.meshMatrixWorlds.every((t,r)=>t.equals(this.meshMatrixWorldsOld[r]))?!1:(this.meshMatrixWorldsOld=this.meshMatrixWorlds.map(t=>t.clone()),!0)}cropsChanged(){let e=!1;return this.splatEntries.forEach((t,r)=>{var i;t.data.crops.forEach((n,a)=>{this.cropsArray[r][a]===void 0?(e=!0,this.cropsArray[r][a]=n.data):Object.entries(n.data).forEach(([o,s])=>{var l;Array.isArray(s)&&s.some((c,d)=>c!==this.cropsArray[r][a][o][d])?(e=!0,this.cropsArray[r][a][o]=s):s!==((l=this.cropsArray[r][a])==null?void 0:l[o])&&(e=!0,this.cropsArray[r][a][o]=s)})}),t.data.crops.length!==((i=this.cropsArray[r])==null?void 0:i.length)&&(this.cropsArray[r].length=t.data.crops.length,e=!0)}),e}setupSplatMesh(e,t,r=new k,i=new Xt,n=!1,a=1,o,s){this.splatMesh=Mb.buildMesh(e,t,n,a,o,s),this.splatMesh.position.copy(r),this.splatMesh.quaternion.copy(i),this.splatMesh.frustumCulled=!1,this.splatMesh.renderOrder=99999,this.splatRenderCount=t,this.splatMesh.onBeforeRender=(l,c,d)=>this.update(l,d)}setupSortWorker(e){this.sortWorker=CBe(e),this.sortWorker.onmessage=t=>{var r;t.data.sortDone?(this.sortRunning=!1,(r=this.splatMesh)==null||r.updateIndexes(new Uint32Array(t.data.indexesBuffer)),this.lastSortTime=t.data.sortTime,this.queuedMessage&&(this.sortWorker.postMessage(this.queuedMessage),this.queuedMessage=null)):t.data.sortCanceled?this.sortRunning=!1:t.data.sortSetupPhase1Complete?this.sortWorker.postMessage({positions:this.splatMesh.getCenters().buffer,meshMatrixWorlds:this.splatMesh.meshMatrixWorlds,meshIndexIntervals:this.splatMesh.meshIndexIntervals,cropsArray:this.cropsArray}):t.data.sortSetupComplete&&(this.splatDataTextures=this.splatMesh.getSplatDataTextures(),this.scene.activePage.add(this.splatMesh),this.needsInitialRender=!0)}}update(e,t){this.splatMesh!==null&&(this.updateSplatMeshUniforms(e,t),this.updateView(!1,t))}getSplatMesh(){return this.splatMesh}},fE=new tc;fE.wireframe=!0;var n4=new k,bD=class extends Js{constructor(e,t){super(),this.data=e,this.sharedAssets=t,this.enableHelpers=!1,this.wireframeState=!1,this.needsTransmissionDirty=!0,this.needsNormalDirty=!0,this._needsTransmission=!1,this._needsNormal=!1,this.geometryCacheChanged=!1,this.splatViewer=null,this.entityByUuid={},this.entityIdentityToEntity={},this.toExpandCloner=new Set,this.toUpdateCloner=new Set,this.pendingCommands=[],this.pathConstraints=new xBe,this.invisibleObjects=new Zf("jflkdsafjasdifjaslk",{...xM.defaultData,visible:!1,name:"buildin invisible"}),this.needsRecomputeInstances=!1,this.init(e,t),this.matrixAutoUpdate=!1,this.errorPage=new Pn("fdasfa",{...Mp.defaultData,name:""},{shared:t,scene:this})}markGeometryCacheDirty(){this.geometryCacheChanged=!0}markNeedsUpdateRendererDirty(){this.needsTransmissionDirty=!0,this.needsNormalDirty=!0}needsTransmission(){return this.needsTransmissionDirty&&(this._needsTransmission=vBe(this),this.needsTransmissionDirty=!1),this._needsTransmission}needsNormal(){return this.needsNormalDirty&&(this._needsNormal=mBe(this),this.needsNormalDirty=!1),this._needsNormal}registerInstanceAndSetUuid(e){let t=e.identity.join("-"),r=this.entityIdentityToEntity[t];r&&(e.uuid=r.uuid),this.entityIdentityToEntity[t]=e,this.entityByUuid[e.uuid]=e}markPenumbraSizeDirty(){for(let e of this.children)e instanceof Pn&&(e.penumbraSizeArrayCache=null)}findInstance(e){return this.entityIdentityToEntity[e.join("-")]}get bgColor(){return this.activePage.bgColor}get postprocessing(){return this.activePage.data.postprocessing}getWithSortKey(e){let t=this.find(e);if(t===void 0)return;let r=[],i=t;for(;i!==this;){let n=i;i=i.parent;let a=i.children.indexOf(n);r.splice(0,0,a)}return{entity:t,sortKey:r}}getAllSorted(e){let t=[];for(let r of e){let i=this.getWithSortKey(r.id);i!==void 0&&t.push(i)}return t.sort((r,i)=>OV(r.sortKey,i.sortKey)),t.map(r=>r.entity)}nonExistOrDescendantOf(e,t){let r=this.find(e);if(r===void 0)return!0;for(;r;){if(r.uuid===t)return!0;r=r.parent}return!1}find(e){if(this.activePage&&this.activePage.personalCamera.parent){if(e==="f23858d0-4a3b-4bd8-8173-66ed0af7f6fb-personalCamera")return this.activePage.personalCamera;if(e===Zp)return this.activePage.personalCamera}if(e===""||e===void 0)return;let t=this.entityByUuid[e];return t===void 0?this.getObjectByProperty("uuid",e):t}find2D(e){for(let t of this.children)if(t instanceof Pn&&t.uiScene){let r=t.uiScene.find(e);if(r)return r}}findScene2DfromObject2D(e){for(let t of this.children)if(t instanceof Pn&&t.uiScene&&t.uiScene.find(e))return t.uiScene}find2DInUIObjects(e){let t;return this.traverseEntity(r=>{t===void 0&&r instanceof ha&&(t=r.uiCanvas.find(e))}),t}traverse2D(e){for(let t of this.children)t instanceof Pn&&t.uiScene&&t.uiScene.traverse(e)}debugEnsureEntity(e){let t=this.find(e);if(t){if(Array.isArray(t.identity)&&this.findInstance(t.identity)===void 0){console.error("not found instance");debugger}}else{console.error("not found");debugger}}addPendingExpandCloner(e){this.toExpandCloner.add(e)}addPendingUpdateCloner(e){this.toUpdateCloner.add(e)}markToExpandCloner(e){this.toExpandCloner.add(e),e.traverseEntityAncestors(t=>{this.toExpandCloner.add(t)})}doPendingExpandCloner(){this.toExpandCloner.forEach(e=>{e.expandCloner(this)}),this.toExpandCloner.clear()}doPendingUpdateCloner(){this.toUpdateCloner.forEach(e=>{var t;(t=e.cloner)==null||t.update()}),this.toUpdateCloner.clear()}doPendingUpdates(){this.doPendingExpandCloner(),this.doPendingUpdateCloner(),this.applyPendingCommands()}addPendingCommand(e){this.pendingCommands.push(e)}applyPendingCommands(){this.pendingCommands.forEach(e=>e()),this.pendingCommands.length=0}updateByLibOp(e,t){e.path.length===1&&e.path[0]==="components"&&e.type===1&&this.createChildrenObjects([{...e.data.asset,id:e.id}],this.invisibleObjects,t)}updateTreeByOp(e,t){var r;if(e.path.length===0&&e.type===7){let i=e.parent===null?this:this.find(e.parent);if(i===void 0)throw new Error("unexpected");let n=this.createObject(e.id,e.data,e.children,i,e.localIndex,t);n.updateVisible(this),n.resetBBoxNeedsUpdate(),Jo(n)&&Yl(n.parent)&&(n.invalidateUpstreamBooleanData(),n.parent.invalidateDownstreamBooleanData().recomputeBoolean()),this.markNeedsRecomputeInstancesForAncessors(i),this.markNeedsRecomputeInstancesForChildren(n),this.markToExpandCloner(n),this.markPenumbraSizeDirty(),n.updatePathSnapping()}else if(e.path.length===0&&e.type===8){let i=this.find(e.id);if(i===void 0)throw new Error("unexpected");this.markToExpandCloner(i),i.resetBBoxNeedsUpdate(),this.unregisterObject(i);let n=i.parent;this.markNeedsRecomputeInstancesForAncessors(n),this.markNeedsRecomputeInstancesForChildren(i),this.markPenumbraSizeDirty(),i.parent.remove(i),Yl(i.parent)&&(i.parent.invalidateUpstreamBooleanData(),i.parent.invalidateDownstreamBooleanData().recomputeBoolean()),Jo(i)&&(i.freeBooleanPointer(),n instanceof sh&&n.invalidateDownstreamBooleanData().recomputeBoolean()),i instanceof mD&&i.detachShape(),this.disposeAndUnregisterEntityRecursivelyIfNotReregistered(i),this.pathConstraints.removeDependencies(i.uuid),i.updatePathSnapping()}else if(e.path.length===0&&e.type===9){let i=this.find(e.id);if(i===void 0)throw new Error("unexpected");this.markNeedsRecomputeInstancesForChildren(i);let n=i.parent;this.markNeedsRecomputeInstancesForAncessors(n),(r=i.cloner)==null||r.resetOnMove(),this.markToExpandCloner(i);let a=e.parent===null?this:this.find(e.parent);if(a===void 0)throw new Error("unexpected");a.add(i),this.markNeedsRecomputeInstancesForAncessors(a),this.markToExpandCloner(i),i.invalidateClonerTransform(i),i.updateVisible(this),i.resetBBoxNeedsUpdate(),this.markPenumbraSizeDirty();let o=e.localIndex;a.children.splice(o,0,a.children.pop()),Jo(i)&&(i.invalidateUpstreamBooleanData(),Yl(i.parent)?i.parent.invalidateDownstreamBooleanData().recomputeBoolean():n instanceof sh&&n.invalidateDownstreamBooleanData().recomputeBoolean()),i.updatePathSnapping()}this.markNeedsUpdateRendererDirty(),this.markGeometryCacheDirty()}get playPage(){return this.find(this.data.publish.playPage)??this.errorPage}updatePage(e){var t;this.activePage&&this.activePage.onDeactive(),this.activePage=this.errorPage;for(let r of this.children)r instanceof Pn&&(r.visible=r.uuid===e,r.visible&&(this.activePage=r,this.activePage.onActive(this)));this.activePage!==((t=this.splatViewer)==null?void 0:t.activePage)&&this.reloadSplats()}updateEntityByOp(e,t,r,i){if(t.type===0){if(("overrides"in t.props||"component"in t.props)&&this.markNeedsRecomputeInstances(),"visible"in t.props&&this.markPenumbraSizeDirty(),t.path.includes("overrides")&&"states"in t.props){let{rest:a}=t.props;t={...t,props:a},this.markNeedsRecomputeInstances()}t.path[0]==="pathSnapping"&&t.props.pathId!==void 0&&this.pathConstraints.setConstraint(e,t.props.pathId)}let n=this.find(e);if(n)try{pBe(n,t,r,{scene:this,shared:i}),n instanceof ma&&n.updateGeometryGroupsIfNeeded()}catch(a){console.error(a)}}updateEntity2DByOp(e,t,r,i,n,a=[]){e.updateEntityByOp(t,r,i,n),this.traverseEntity(o=>{(o instanceof ha||o instanceof Pn)&&(a.includes(o.frameId??"")||o.frameId===t)&&o.updateEntity2DByOp(t,r,i,n)})}get activeCamera(){return this.activePage.activeCamera}switchActiveCamera(e){this.activePage.switchActiveCamera(e)}isInvisibleObjects(e){return e===this.invisibleObjects||e.hasAnccestor(this.invisibleObjects)}init(e,t){let r=Object.entries(t.data.lib.components).map((i,n)=>({data:i[1].asset.data,children:i[1].asset.children,id:i[0],fi:n}));this.invisibleObjects.updateState(this.invisibleObjects.data,{scene:this,shared:t}),this.add(this.invisibleObjects),this.createChildrenObjects(r,this.invisibleObjects,t),this.createChildrenObjects(e.objects,this,t),this.updatePage(e.publish.playPage),this.activePage.switchToPlayCamera(),this.expandInstances(t,!0),this.traverseEntity(i=>{i instanceof va&&i.updateUp()}),this.doPendingExpandCloner(),this.applyPendingCommands()}markNeedsRecomputeInstances(){this.needsRecomputeInstances=!0}markNeedsRecomputeInstancesForChildren(e){e.traverseEntity(t=>{(t.data.type==="Component"||t.data.type==="Instance")&&this.markNeedsRecomputeInstances()})}markNeedsRecomputeInstancesForAncessors(e){Cr.is(e)&&(e.data.type==="Component"&&this.markNeedsRecomputeInstances(),e.traverseAncestors(t=>{Cr.is(t)&&t.data.type==="Component"&&this.markNeedsRecomputeInstances()}))}relativeizeInner(e,t,r,i,n,a,o){if(e){let s=i.find(e);s&&s!==i&&n.forInstancesRec(l=>{l.data=pg(l.data,c=>{let d=c.events.data(o.id),u=l.goUp(a);if(u){let h=[...DV(u.identity),e].join("-"),f=this.entityIdentityToEntity[h];if(f){let p=f.uuid,v=gn.zoom(d,t);v[r]=p}else console.warn("cannot find instance")}}).data})}}rewriteActions(e,t,r,i,n,a){e.forEach(o=>{o.data.type==="Transition"?this.relativeizeInner(o.data.object,[...t,o.id],"object",r,i,n,a):o.data.type==="Animation"?this.relativeizeInner(o.data.object,[...t,o.id],"object",r,i,n,a):o.data.type==="Conditional"&&(this.rewriteActions(o.data.ifActions,[...t,o.id,"ifActions"],r,i,n,a),this.rewriteActions(o.data.elseActions,[...t,o.id,"elseActions"],r,i,n,a))})}rewriteEventsBeforeGoToPlayMode(){this.traverseEntity(e=>{if(e instanceof Jf&&typeof e.identity=="string"&&e.data.type==="Component")return e.traverseEntity((t,r)=>{t.data.events.forEach(i=>{if(i.data.type==="GameControl"){let n=!1;if(t.forInstancesRec(a=>{a.data=pg(a.data,o=>{a.isInstanceRoot||(o.events.delete(i.id),n=!0)}).data}),n===!1)for(let a of Hx.list)this.rewriteActions(i.data.gameActions[a],["gameActions",a],e,t,r,i)}else i.data.type==="Conditional"?(i.data.condition.type==="Distance"?(this.relativeizeInner(i.data.condition.fromObject,["condition"],"fromObject",e,t,r,i),this.relativeizeInner(i.data.condition.toObject,["condition"],"toObject",e,t,r,i)):i.data.condition.type==="State"?this.relativeizeInner(i.data.condition.object,["condition"],"object",e,t,r,i):i.data.condition.type==="Comparison"&&(i.data.condition.lOperand.type==="Property"&&this.relativeizeInner(i.data.condition.lOperand.value[0],["condition","lOperand","value"],0,e,t,r,i),i.data.condition.rOperand.type==="Property"&&this.relativeizeInner(i.data.condition.rOperand.value[0],["condition","rOperand","value"],0,e,t,r,i)),this.rewriteActions(i.data.inActions,["inActions"],e,t,r,i),this.rewriteActions(i.data.outActions,["outActions"],e,t,r,i)):"actions"in i.data&&this.rewriteActions(i.data.actions,["actions"],e,t,r,i)})}),!0})}expandInstances(e,t,r){let i=new Set;this.traverseEntity(n=>{if(n instanceof Jf&&n.isInstanceRoot)return n.expandInstanceChildren({scene:this,shared:e,pendingDeletes:i}),t||n.resetBBoxNeedsUpdate(),r&&n.traverseEntity(a=>{r.addClip(a)}),!0});for(let n of i)this.disposeAndUnregisterEntityRecursivelyIfNotReregistered(n),gD(n)}recomputeInstances(e,t){this.needsRecomputeInstances&&(this.needsRecomputeInstances=!1,this.traverseEntity(r=>{r instanceof Jf&&r.isInstanceRoot&&(r.component=void 0)}),this.expandInstances(e,!1,t))}disposeAndUnregisterEntityRecursivelyIfNotReregistered(e){e.traverseEntity(t=>{let r=typeof t.identity=="string"?t.identity:t.identity.join("-");this.entityIdentityToEntity[r]===t&&(delete this.entityByUuid[t.uuid],delete this.entityIdentityToEntity[r]),t.dispose()})}clearScene(){for(let e of this.children)Cr.is(e)&&e.disposeRecursively();this.children.length=0}resetAfterClear(e,t){this.init(e,t)}raycast(e){return this.raycast1(e,!1)}raycast1(e,t){let r=[],i=n=>{for(let a of n.children){let o=a.cloner;if(Cr.is(a)&&!a.raycastLock&&(a.visible||o!=null&&o.object.data.visible))if(t===!0&&a.isInstanceRoot){let s=[];if(e.intersectObject(a,!0,s),s.length){let l=s[0];l.object=a,l.point.applyMatrix4(l.object.matrixWorld);let c=a.matrixWorld.clone().invert();l.point.applyMatrix4(c),r.push(l)}}else(Jo(a)||tE(a)&&this.enableHelpers&&a.objectHelper.visible)&&(e.intersectObject(a,!1,r),hE(a,e,r)),i(a)}};return i(this.activePage),r}raycastWithClones(e){let t=[],r=i=>{for(let n of i.children){let a=n.cloner;Cr.is(n)&&(n.visible||a!=null&&a.object.data.visible)&&((Jo(n)||tE(n)&&this.enableHelpers&&n.objectHelper.visible)&&(e.intersectObject(n,!1,t),hE(n,e,t,!0)),r(n))}};return r(this),t}forEachEntity(e){for(let t of this.children)Cr.is(t)&&e(t)}traverseConcreteEntity(e){for(let t of this.children)Cr.is(t)&&t.isConcreteEntity&&t.traverseEntity(e)}traverseEntity(e){for(let t of this.children)Cr.is(t)&&t.traverseEntity(e)}updateFont(e,t){this.traverseEntity(r=>{if(r instanceof ma&&r.data.type==="Mesh"&&(r.data.geometry.type==="TextGeometry"||r.data.geometry.type==="InputGeometry")&&r.data.geometry.font===e){let i=r.geometry,n=r.data.geometry;i.updateFont(e,t).then(()=>{i.update(n);let a=r.invalidateDownstreamBooleanData();Yl(a)&&a.recomputeBoolean()})}})}traverseObject(e){for(let t of this.children)Sg.is(t)&&t.traverseObject(e)}traverseVisibleEntity(e){for(let t of this.children)Cr.is(t)&&t.visible&&t.traverseVisibleEntity(e)}dispose(){this.clearScene()}createChildrenObjects(e,t,r){let i=0;for(let n of e)this.createObject(n.id,n.data,n.children,t,i,r),i+=1}registerObjectCreatedInLegacy(e){this.entityByUuid[e.uuid]=e}unregisterObject(e){delete this.entityByUuid[e.uuid];for(let t of e.children)this.unregisterObject(t)}createObject(e,t,r,i,n,a){var l;let o={scene:this,shared:a},s=yD(e,t,o);return s&&(this.entityByUuid[e]=s,i.add(s),i.children.splice(n,0,i.children.pop()),r.length>0&&(s.isInstanceRoot?console.error("instance should not have children!"):this.createChildrenObjects(r,s,a)),s.updateState(t,o),s instanceof ma&&s.updateGeometryGroupsIfNeeded(),s.updateVisible(this),s.cloner&&this.toExpandCloner.add(s),(l=t.pathSnapping)!=null&&l.pathId&&this.pathConstraints.setConstraint(e,t.pathSnapping.pathId)),t.type==="Empty"&&t.animations&&s.traverseEntity(c=>{let d=c.dataPatched;if(c instanceof ma&&d.bones&&d.boneInverses){let u=d.bones.map(p=>this.find(p)),h=d.boneInverses.map(p=>new it().fromArray(p)),f=new nP(u,h);c.bind(f,c.bindMatrix)}else c.matrixAutoUpdate=!0}),s}getCenter(e){let t=[];for(let i=0,n=e.length;i<n;++i){let{id:a,recursive:o}=e[i],s=this.find(a),l=o?s.recursiveBBox:s.singleBBox;t.push(...l.vertices)}let r=new Zi;return r.setFromPoints(t),r.getCenter(n4),n4}copyMatrixWorld(e,t){if(e===null){t.identity();return}let r=this.find(e);r?t.copy(r.matrixWorld):t.identity()}copyParentMatrixWorld(e,t){var i;if(e===null){t.identity();return}let r=(i=this.find(e))==null?void 0:i.parent;r?t.copy(r.matrixWorld):t.identity()}traverseMaterial(e){this.traverseEntity(t=>{if(t instanceof Ra)if(Array.isArray(t.material))for(let r=0;r<t.material.length;r++)t.material[r]instanceof Ad&&e(t.material[r]);else t.material instanceof Ad&&e(t.material)})}updateViewPlaneSize(e,t,r=!1){this.traverseConcreteEntity(i=>{i instanceof va&&i.setViewplaneSize(e,t,r)})}initializeSplatViewer(){this.splatViewer=new EBe({scene:this}),this.reloadSplats()}reloadSplats(){var e;(e=this.splatViewer)==null||e.loadSplat()}},Eb=(e,t)=>{let r=t.x-e.x,i=t.y-e.y;return Math.sqrt(r*r+i*i)},TBe=(e,t)=>{let r=t.x-e.x,i=t.y-e.y;return DBe(Math.atan2(i,r))},PBe=(e,t,r)=>{let i={x:0,y:0};return r=pE(r),i.x=e.x-t*Math.cos(r),i.y=e.y-t*Math.sin(r),i},pE=e=>e*(Math.PI/180),DBe=e=>e*(180/Math.PI),OBe=e=>isNaN(e.buttons)?e.pressure!==0:e.buttons!==0,h_=new Map,a4=e=>{h_.has(e)&&clearTimeout(h_.get(e)),h_.set(e,setTimeout(e,100))},n1=(e,t,r)=>{let i=t.split(/[ ,]+/g),n;for(let a=0;a<i.length;a+=1)n=i[a],e.addEventListener?e.addEventListener(n,r,!1):e.attachEvent&&e.attachEvent(n,r)},o4=(e,t,r)=>{let i=t.split(/[ ,]+/g),n;for(let a=0;a<i.length;a+=1)n=i[a],e.removeEventListener?e.removeEventListener(n,r):e.detachEvent&&e.detachEvent(n,r)},nW=e=>(e.preventDefault(),e.type.match(/^touch/)?e.changedTouches:e),s4=()=>{if(typeof window>"u")return;let e=window.pageXOffset!==void 0?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,t=window.pageYOffset!==void 0?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop;return{x:e,y:t}},mE=(e,t)=>{t.top||t.right||t.bottom||t.left?(e.style.top=t.top,e.style.right=t.right,e.style.bottom=t.bottom,e.style.left=t.left):(e.style.left=t.x+"px",e.style.top=t.y+"px")},xD=(e,t,r)=>{let i=aW(e);for(let n in i)if(i.hasOwnProperty(n))if(typeof t=="string")i[n]=t+" "+r;else{let a="";for(let o=0,s=t.length;o<s;o+=1)a+=t[o]+" "+r+", ";i[n]=a.slice(0,-2)}return i},RBe=(e,t)=>{let r=aW(e);for(let i in r)r.hasOwnProperty(i)&&(r[i]=t);return r},aW=e=>{let t={};return t[e]="",["webkit","Moz","o"].forEach(function(r){t[r+e.charAt(0).toUpperCase()+e.slice(1)]=""}),t},f_=(e,t)=>{for(let r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e},IBe=(e,t)=>{let r={};for(let i in e)e.hasOwnProperty(i)&&t.hasOwnProperty(i)?r[i]=t[i]:e.hasOwnProperty(i)&&(r[i]=e[i]);return r},vE=(e,t)=>{if(e.length)for(let r=0,i=e.length;r<i;r+=1)t(e[r]);else t(e)},zBe=(e,t,r)=>({x:Math.min(Math.max(e.x,t.x-r),t.x+r),y:Math.min(Math.max(e.y,t.y-r),t.y+r)});typeof window<"u"&&(oW="ontouchstart"in window,sW=!!window.PointerEvent,lW=!!window.MSPointerEvent);var oW,sW,lW,jm={touch:{start:"touchstart",move:"touchmove",end:"touchend, touchcancel"},mouse:{start:"mousedown",move:"mousemove",end:"mouseup"},pointer:{start:"pointerdown",move:"pointermove",end:"pointerup, pointercancel"},MSPointer:{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}},Rf,Ag={};sW?Rf=jm.pointer:lW?Rf=jm.MSPointer:oW?(Rf=jm.touch,Ag=jm.mouse):Rf=jm.mouse;function Ah(){}Ah.prototype.on=function(e,t){var r=this,i=e.split(/[ ,]+/g),n;r._handlers_=r._handlers_||{};for(var a=0;a<i.length;a+=1)n=i[a],r._handlers_[n]=r._handlers_[n]||[],r._handlers_[n].push(t);return r};Ah.prototype.off=function(e,t){var r=this;return r._handlers_=r._handlers_||{},e===void 0?r._handlers_={}:t===void 0?r._handlers_[e]=null:r._handlers_[e]&&r._handlers_[e].indexOf(t)>=0&&r._handlers_[e].splice(r._handlers_[e].indexOf(t),1),r};Ah.prototype.trigger=function(e,t){var r=this,i=e.split(/[ ,]+/g),n;r._handlers_=r._handlers_||{};for(var a=0;a<i.length;a+=1)n=i[a],r._handlers_[n]&&r._handlers_[n].length&&r._handlers_[n].forEach(function(o){o.call(r,{type:n,target:r},t)})};Ah.prototype.config=function(e){var t=this;t.options=t.defaults||{},e&&(t.options=IBe(t.options,e))};Ah.prototype.bindEvt=function(e,t){var r=this;return r._domHandlers_=r._domHandlers_||{},r._domHandlers_[t]=function(){typeof r["on"+t]=="function"?r["on"+t].apply(r,arguments):console.warn('[WARNING] : Missing "on'+t+'" handler.')},n1(e,Rf[t],r._domHandlers_[t]),Ag[t]&&n1(e,Ag[t],r._domHandlers_[t]),r};Ah.prototype.unbindEvt=function(e,t){var r=this;return r._domHandlers_=r._domHandlers_||{},o4(e,Rf[t],r._domHandlers_[t]),Ag[t]&&o4(e,Ag[t],r._domHandlers_[t]),delete r._domHandlers_[t],this};var wD=Ah;function Cn(e,t){return this.identifier=t.identifier,this.position=t.position,this.frontPosition=t.frontPosition,this.collection=e,this.defaults={size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:1,mode:"dynamic",zone:document.body,lockX:!1,lockY:!1,shape:"circle"},this.config(t),this.options.mode==="dynamic"&&(this.options.restOpacity=0),this.id=Cn.id,Cn.id+=1,this.buildEl().stylize(),this.instance={el:this.ui.el,on:this.on.bind(this),off:this.off.bind(this),show:this.show.bind(this),hide:this.hide.bind(this),add:this.addToDom.bind(this),remove:this.removeFromDom.bind(this),destroy:this.destroy.bind(this),setPosition:this.setPosition.bind(this),resetDirection:this.resetDirection.bind(this),computeDirection:this.computeDirection.bind(this),trigger:this.trigger.bind(this),position:this.position,frontPosition:this.frontPosition,ui:this.ui,identifier:this.identifier,id:this.id,options:this.options},this.instance}Cn.prototype=new wD;Cn.constructor=Cn;Cn.id=0;Cn.prototype.buildEl=function(e){return this.ui={},this.options.dataOnly?this:(this.ui.el=document.createElement("div"),this.ui.back=document.createElement("div"),this.ui.front=document.createElement("div"),this.ui.el.className="nipple collection_"+this.collection.id,this.ui.back.className="back",this.ui.front.className="front",this.ui.el.setAttribute("id","nipple_"+this.collection.id+"_"+this.id),this.ui.el.appendChild(this.ui.back),this.ui.el.appendChild(this.ui.front),this)};Cn.prototype.stylize=function(){if(this.options.dataOnly)return this;var e=this.options.fadeTime+"ms",t=RBe("borderRadius","50%"),r=xD("transition","opacity",e),i={};return i.el={position:"absolute",opacity:this.options.restOpacity,display:"block",zIndex:999},i.back={position:"absolute",display:"block",width:this.options.size+"px",height:this.options.size+"px",marginLeft:-this.options.size/2+"px",marginTop:-this.options.size/2+"px",background:"rgba(255, 255, 255, .4)",border:"solid 2px rgba(0, 0, 0, .1)"},i.front={width:this.options.size/2+"px",height:this.options.size/2+"px",position:"absolute",display:"block",marginLeft:-this.options.size/4+"px",marginTop:-this.options.size/4+"px",background:"rgba(255, 255, 255, .8)",border:"solid 2px rgba(0, 0, 0, .1)"},f_(i.el,r),this.options.shape==="circle"&&f_(i.back,t),f_(i.front,t),this.applyStyles(i),this};Cn.prototype.applyStyles=function(e){for(var t in this.ui)if(this.ui.hasOwnProperty(t))for(var r in e[t])this.ui[t].style[r]=e[t][r];return this};Cn.prototype.addToDom=function(){return this.options.dataOnly||document.body.contains(this.ui.el)?this:(this.options.zone.appendChild(this.ui.el),this)};Cn.prototype.removeFromDom=function(){return this.options.dataOnly||!document.body.contains(this.ui.el)?this:(this.options.zone.removeChild(this.ui.el),this)};Cn.prototype.destroy=function(){clearTimeout(this.removeTimeout),clearTimeout(this.showTimeout),clearTimeout(this.restTimeout),this.trigger("destroyed",this.instance),this.removeFromDom(),this.off()};Cn.prototype.show=function(e){var t=this;return t.options.dataOnly||(clearTimeout(t.removeTimeout),clearTimeout(t.showTimeout),clearTimeout(t.restTimeout),t.addToDom(),t.restCallback(),setTimeout(function(){t.ui.el.style.opacity=1},0),t.showTimeout=setTimeout(function(){t.trigger("shown",t.instance),typeof e=="function"&&e.call(this)},t.options.fadeTime)),t};Cn.prototype.hide=function(e){var t=this;if(t.options.dataOnly)return t;if(t.ui.el.style.opacity=t.options.restOpacity,clearTimeout(t.removeTimeout),clearTimeout(t.showTimeout),clearTimeout(t.restTimeout),t.removeTimeout=setTimeout(function(){var r=t.options.mode==="dynamic"?"none":"block";t.ui.el.style.display=r,typeof e=="function"&&e.call(t),t.trigger("hidden",t.instance)},t.options.fadeTime),t.options.restJoystick){let r=t.options.restJoystick,i={};i.x=r===!0||r.x!==!1?0:t.instance.frontPosition.x,i.y=r===!0||r.y!==!1?0:t.instance.frontPosition.y,t.setPosition(e,i)}return t};Cn.prototype.setPosition=function(e,t){var r=this;r.frontPosition={x:t.x,y:t.y};var i=r.options.fadeTime+"ms",n={};n.front=xD("transition",["top","left"],i);var a={front:{}};a.front={left:r.frontPosition.x+"px",top:r.frontPosition.y+"px"},r.applyStyles(n),r.applyStyles(a),r.restTimeout=setTimeout(function(){typeof e=="function"&&e.call(r),r.restCallback()},r.options.fadeTime)};Cn.prototype.restCallback=function(){var e=this,t={};t.front=xD("transition","none",""),e.applyStyles(t),e.trigger("rested",e.instance)};Cn.prototype.resetDirection=function(){this.direction={x:!1,y:!1,angle:!1}};Cn.prototype.computeDirection=function(e){var t=e.angle.radian,r=Math.PI/4,i=Math.PI/2,n,a,o;if(t>r&&t<r*3&&!e.lockX?n="up":t>-r&&t<=r&&!e.lockY?n="left":t>-r*3&&t<=-r&&!e.lockX?n="down":e.lockY||(n="right"),e.lockY||(t>-i&&t<i?a="left":a="right"),e.lockX||(t>0?o="up":o="down"),e.force>this.options.threshold){var s={},l;for(l in this.direction)this.direction.hasOwnProperty(l)&&(s[l]=this.direction[l]);var c={};this.direction={x:a,y:o,angle:n},e.direction=this.direction;for(l in s)s[l]===this.direction[l]&&(c[l]=!0);if(c.x&&c.y&&c.angle)return e;(!c.x||!c.y)&&this.trigger("plain",e),c.x||this.trigger("plain:"+a,e),c.y||this.trigger("plain:"+o,e),c.angle||this.trigger("dir dir:"+n,e)}else this.resetDirection();return e};var kBe=Cn;function Ji(e,t){var r=this;r.nipples=[],r.idles=[],r.actives=[],r.ids=[],r.pressureIntervals={},r.manager=e,r.id=Ji.id,Ji.id+=1,r.defaults={zone:document.body,multitouch:!1,maxNumberOfNipples:10,mode:"dynamic",position:{top:0,left:0},catchDistance:200,size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:1,lockX:!1,lockY:!1,shape:"circle",dynamicPage:!1,follow:!1},r.config(t),(r.options.mode==="static"||r.options.mode==="semi")&&(r.options.multitouch=!1),r.options.multitouch||(r.options.maxNumberOfNipples=1);let i=getComputedStyle(r.options.zone.parentElement);return i&&i.display==="flex"&&(r.parentIsFlex=!0),r.updateBox(),r.prepareNipples(),r.bindings(),r.begin(),r.nipples}Ji.prototype=new wD;Ji.constructor=Ji;Ji.id=0;Ji.prototype.prepareNipples=function(){var e=this,t=e.nipples;t.on=e.on.bind(e),t.off=e.off.bind(e),t.options=e.options,t.destroy=e.destroy.bind(e),t.ids=e.ids,t.id=e.id,t.processOnMove=e.processOnMove.bind(e),t.processOnEnd=e.processOnEnd.bind(e),t.get=function(r){if(r===void 0)return t[0];for(var i=0,n=t.length;i<n;i+=1)if(t[i].identifier===r)return t[i];return!1}};Ji.prototype.bindings=function(){var e=this;e.bindEvt(e.options.zone,"start"),e.options.zone.style.touchAction="none",e.options.zone.style.msTouchAction="none"};Ji.prototype.begin=function(){var e=this,t=e.options;if(t.mode==="static"){var r=e.createNipple(t.position,e.manager.getIdentifier());r.add(),e.idles.push(r)}};Ji.prototype.createNipple=function(e,t){var r=this,i=r.manager.scroll,n={},a=r.options,o={x:r.parentIsFlex?i.x:i.x+r.box.left,y:r.parentIsFlex?i.y:i.y+r.box.top};if(e.x&&e.y)n={x:e.x-o.x,y:e.y-o.y};else if(e.top||e.right||e.bottom||e.left){var s=document.createElement("DIV");s.style.display="hidden",s.style.top=e.top,s.style.right=e.right,s.style.bottom=e.bottom,s.style.left=e.left,s.style.position="absolute",a.zone.appendChild(s);var l=s.getBoundingClientRect();a.zone.removeChild(s),n=e,e={x:l.left+i.x,y:l.top+i.y}}var c=new kBe(r,{color:a.color,size:a.size,threshold:a.threshold,fadeTime:a.fadeTime,dataOnly:a.dataOnly,restJoystick:a.restJoystick,restOpacity:a.restOpacity,mode:a.mode,identifier:t,position:e,zone:a.zone,frontPosition:{x:0,y:0},shape:a.shape});return a.dataOnly||(mE(c.ui.el,n),mE(c.ui.front,c.frontPosition)),r.nipples.push(c),r.trigger("added "+c.identifier+":added",c),r.manager.trigger("added "+c.identifier+":added",c),r.bindNipple(c),c};Ji.prototype.updateBox=function(){var e=this;e.box=e.options.zone.getBoundingClientRect()};Ji.prototype.bindNipple=function(e){var t=this,r,i=function(n,a){r=n.type+" "+a.id+":"+n.type,t.trigger(r,a)};e.on("destroyed",t.onDestroyed.bind(t)),e.on("shown hidden rested dir plain",i),e.on("dir:up dir:right dir:down dir:left",i),e.on("plain:up plain:right plain:down plain:left",i)};Ji.prototype.pressureFn=function(e,t,r){var i=this,n=0;clearInterval(i.pressureIntervals[r]),i.pressureIntervals[r]=setInterval((function(){var a=e.force||e.pressure||e.webkitForce||0;a!==n&&(t.trigger("pressure",a),i.trigger("pressure "+t.identifier+":pressure",a),n=a)}).bind(i),100)};Ji.prototype.onstart=function(e){var t=this,r=t.options,i=e;e=nW(e),t.updateBox();var n=function(a){t.actives.length<r.maxNumberOfNipples?t.processOnStart(a):i.type.match(/^touch/)&&(Object.keys(t.manager.ids).forEach(function(o){if(Object.values(i.touches).findIndex(function(l){return l.identifier===o})<0){var s=[e[0]];s.identifier=o,t.processOnEnd(s)}}),t.actives.length<r.maxNumberOfNipples&&t.processOnStart(a))};return vE(e,n),t.manager.bindDocument(),!1};Ji.prototype.processOnStart=function(e){var t=this,r=t.options,i,n=t.manager.getIdentifier(e),a=e.force||e.pressure||e.webkitForce||0,o={x:e.pageX,y:e.pageY},s=t.getOrCreate(n,o);s.identifier!==n&&t.manager.removeIdentifier(s.identifier),s.identifier=n;var l=function(d){d.trigger("start",d),t.trigger("start "+d.id+":start",d),d.show(),a>0&&t.pressureFn(e,d,d.identifier),t.processOnMove(e)};if((i=t.idles.indexOf(s))>=0&&t.idles.splice(i,1),t.actives.push(s),t.ids.push(s.identifier),r.mode!=="semi")l(s);else{var c=Eb(o,s.position);if(c<=r.catchDistance)l(s);else{s.destroy(),t.processOnStart(e);return}}return s};Ji.prototype.getOrCreate=function(e,t){var r=this,i=r.options,n;return/(semi|static)/.test(i.mode)?(n=r.idles[0],n?(r.idles.splice(0,1),n):i.mode==="semi"?r.createNipple(t,e):(console.warn("Coudln't find the needed nipple."),!1)):(n=r.createNipple(t,e),n)};Ji.prototype.processOnMove=function(e){var t=this,r=t.options,i=t.manager.getIdentifier(e),n=t.nipples.get(i),a=t.manager.scroll;if(!OBe(e)){this.processOnEnd(e);return}if(!n){console.error("Found zombie joystick with ID "+i),t.manager.removeIdentifier(i);return}if(r.dynamicPage){var o=n.el.getBoundingClientRect();n.position={x:a.x+o.left,y:a.y+o.top}}n.identifier=i;var s=n.options.size/2,l={x:e.pageX,y:e.pageY};r.lockX&&(l.y=n.position.y),r.lockY&&(l.x=n.position.x);var c=Eb(l,n.position),d=TBe(l,n.position),u=pE(d),h=c/s,f={distance:c,position:l},p,v;if(n.options.shape==="circle"?(p=Math.min(c,s),v=PBe(n.position,p,d)):(v=zBe(l,n.position,s),p=Eb(v,n.position)),r.follow){if(c>s){let b=l.x-v.x,x=l.y-v.y;n.position.x+=b,n.position.y+=x,n.el.style.top=n.position.y-(t.box.top+a.y)+"px",n.el.style.left=n.position.x-(t.box.left+a.x)+"px",c=Eb(l,n.position)}}else l=v,c=p;var m=l.x-n.position.x,g=l.y-n.position.y;n.frontPosition={x:m,y:g},r.dataOnly||mE(n.ui.front,n.frontPosition);var y={identifier:n.identifier,position:l,force:h,pressure:e.force||e.pressure||e.webkitForce||0,distance:c,angle:{radian:u,degree:d},vector:{x:m/s,y:-g/s},raw:f,instance:n,lockX:r.lockX,lockY:r.lockY};y=n.computeDirection(y),y.angle={radian:pE(180-d),degree:180-d},n.trigger("move",y),t.trigger("move "+n.id+":move",y)};Ji.prototype.processOnEnd=function(e){var t=this,r=t.options,i=t.manager.getIdentifier(e),n=t.nipples.get(i),a=t.manager.removeIdentifier(n.identifier);!n||(r.dataOnly||n.hide(function(){r.mode==="dynamic"&&(n.trigger("removed",n),t.trigger("removed "+n.id+":removed",n),t.manager.trigger("removed "+n.id+":removed",n),n.destroy())}),clearInterval(t.pressureIntervals[n.identifier]),n.resetDirection(),n.trigger("end",n),t.trigger("end "+n.id+":end",n),t.ids.indexOf(n.identifier)>=0&&t.ids.splice(t.ids.indexOf(n.identifier),1),t.actives.indexOf(n)>=0&&t.actives.splice(t.actives.indexOf(n),1),/(semi|static)/.test(r.mode)?t.idles.push(n):t.nipples.indexOf(n)>=0&&t.nipples.splice(t.nipples.indexOf(n),1),t.manager.unbindDocument(),/(semi|static)/.test(r.mode)&&(t.manager.ids[a.id]=a.identifier))};Ji.prototype.onDestroyed=function(e,t){var r=this;r.nipples.indexOf(t)>=0&&r.nipples.splice(r.nipples.indexOf(t),1),r.actives.indexOf(t)>=0&&r.actives.splice(r.actives.indexOf(t),1),r.idles.indexOf(t)>=0&&r.idles.splice(r.idles.indexOf(t),1),r.ids.indexOf(t.identifier)>=0&&r.ids.splice(r.ids.indexOf(t.identifier),1),r.manager.removeIdentifier(t.identifier),r.manager.unbindDocument()};Ji.prototype.destroy=function(){var e=this;e.unbindEvt(e.options.zone,"start"),e.nipples.forEach(function(r){r.destroy()});for(var t in e.pressureIntervals)e.pressureIntervals.hasOwnProperty(t)&&clearInterval(e.pressureIntervals[t]);e.trigger("destroyed",e.nipples),e.manager.unbindDocument(),e.off()};var LBe=Ji;function Vn(e){var t=this;t.ids={},t.index=0,t.collections=[],t.scroll=s4(),t.config(e),t.prepareCollections();var r=function(){var n;t.collections.forEach(function(a){a.forEach(function(o){n=o.el.getBoundingClientRect(),o.position={x:t.scroll.x+n.left,y:t.scroll.y+n.top}})})};if(typeof window>"u")return t.collections;n1(window,"resize",function(){a4(r)});var i=function(){t.scroll=s4()};return n1(window,"scroll",function(){a4(i)}),t.collections}Vn.prototype=new wD;Vn.constructor=Vn;Vn.prototype.prepareCollections=function(){var e=this;e.collections.create=e.create.bind(e),e.collections.on=e.on.bind(e),e.collections.off=e.off.bind(e),e.collections.destroy=e.destroy.bind(e),e.collections.get=function(t){var r;return e.collections.every(function(i){return r=i.get(t),!r}),r}};Vn.prototype.create=function(e){return this.createCollection(e)};Vn.prototype.createCollection=function(e){var t=this,r=new LBe(t,e);return t.bindCollection(r),t.collections.push(r),r};Vn.prototype.bindCollection=function(e){var t=this,r,i=function(n,a){r=n.type+" "+a.id+":"+n.type,t.trigger(r,a)};e.on("destroyed",t.onDestroyed.bind(t)),e.on("shown hidden rested dir plain",i),e.on("dir:up dir:right dir:down dir:left",i),e.on("plain:up plain:right plain:down plain:left",i)};Vn.prototype.bindDocument=function(){var e=this;e.binded||(e.bindEvt(document,"move").bindEvt(document,"end"),e.binded=!0)};Vn.prototype.unbindDocument=function(e){var t=this;(!Object.keys(t.ids).length||e===!0)&&(t.unbindEvt(document,"move").unbindEvt(document,"end"),t.binded=!1)};Vn.prototype.getIdentifier=function(e){var t;return e?(t=e.identifier===void 0?e.pointerId:e.identifier,t===void 0&&(t=this.latest||0)):t=this.index,this.ids[t]===void 0&&(this.ids[t]=this.index,this.index+=1),this.latest=t,this.ids[t]};Vn.prototype.removeIdentifier=function(e){var t={};for(var r in this.ids)if(this.ids[r]===e){t.id=r,t.identifier=this.ids[r],delete this.ids[r];break}return t};Vn.prototype.onmove=function(e){var t=this;return t.onAny("move",e),!1};Vn.prototype.onend=function(e){var t=this;return t.onAny("end",e),!1};Vn.prototype.oncancel=function(e){var t=this;return t.onAny("end",e),!1};Vn.prototype.onAny=function(e,t){var r=this,i,n="processOn"+e.charAt(0).toUpperCase()+e.slice(1);t=nW(t);var a=function(s,l,c){c.ids.indexOf(l)>=0&&(c[n](s),s._found_=!0)},o=function(s){i=r.getIdentifier(s),vE(r.collections,a.bind(null,s,i)),s._found_||r.removeIdentifier(i)};return vE(t,o),!1};Vn.prototype.destroy=function(){var e=this;e.unbindDocument(!0),e.ids={},e.index=0,e.collections.forEach(function(t){t.destroy()}),e.off()};Vn.prototype.onDestroyed=function(e,t){var r=this;if(r.collections.indexOf(t)<0)return!1;r.collections.splice(r.collections.indexOf(t),1)};var BBe=Vn,l4=new BBe,FBe={create:function(e){return l4.create(e)},factory:l4},cW=new Map,Rv=new Map,Du=class{constructor(e,t,r,i){this.data=t;let{audio:n,volume:a,delay:o,loop:s}=t;if(!n)throw new Error("Missing property");let l=typeof n=="string"?i.getAudio(n).src:n.data;this.audioPlayer=new ov({src:l,volume:a,delay:o,loop:s}),Rv.has(r.uuid)?Rv.get(r.uuid).push(this):Rv.set(r.uuid,[this]),cW.set(e,this)}playByToggle(){this.data.toggle==="stop"?this.audioPlayer.status==="playing"?this.audioPlayer.stop():(this.audioPlayer.stop(),this.audioPlayer.play()):this.data.toggle==="pause"?this.audioPlayer.status==="playing"?this.audioPlayer.pause():this.audioPlayer.play():(this.audioPlayer.stop(),this.audioPlayer.play())}dispose(){this.audioPlayer.stop()}},gE=class{constructor(e){this.data=e}dispatch(){this.data.playAudio?this.pauseAudio(this.data.playAudio):this.data.object?this.pauseAllAudiosFromObject(this.data.object):this.pauseAllAudios()}pauseAudio(e){let t=cW.get(e);!t||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{t.audioPlayer[this.data.interaction](),this.disposeDelay()},this.data.delay)):t.audioPlayer[this.data.interaction]())}pauseAllAudiosFromObject(e){let t=Rv.get(e);!(t!=null&&t.length)||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{t.forEach(r=>r.audioPlayer[this.data.interaction]()),this.disposeDelay()},this.data.delay)):t.forEach(r=>r.audioPlayer[this.data.interaction]()))}pauseAllAudios(){let e=[...Rv.values()];!e.length||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{e.forEach(t=>{t.forEach(r=>{r.audioPlayer[this.data.interaction]()})}),this.disposeDelay()},this.data.delay)):e.forEach(t=>{t.forEach(r=>{r.audioPlayer[this.data.interaction]()})}))}disposeDelay(){clearTimeout(this.timeoutId),delete this.timeoutId}dispose(){clearTimeout(this.timeoutId),delete this.timeoutId}},dW=class{constructor(e,t,r,i,n){if(this.data=t,this.shared=i,this.condition=n,t.interaction==="play")this.interaction=new Du(e,t,r,i);else if(t.interaction==="pause"||t.interaction==="stop")this.interaction=new gE(t);else throw new Error("Missing property")}dispatchBasic(){if(vi(this.shared,this.condition)===!1)return!1;this.interaction instanceof Du?this.interaction.playByToggle():this.interaction.dispatch()}dispatchConditional(){if(vi(this.shared,this.condition)===!1)return!1;this.interaction instanceof Du?this.interaction.audioPlayer.play():this.interaction.dispatch()}dispatchGameControl(e){if(vi(this.shared,this.condition)===!1)return!1;this.interaction instanceof Du&&(e==="start"?this.interaction.audioPlayer.play():this.interaction.audioPlayer.stop())}dispose(){this.interaction.dispose()}},uW=class{constructor(e,t,r,i){this.data=e,this.page=t,this.shared=r,this.condition=i,this.delay=0,this.emission=e.emission,e.delay!==void 0&&(this.delay=e.delay),this.particleSystem=this.page.scene.find(this.data.emitterObjectId)}toggleEmitting(){this.particleSystem.started&&!this.particleSystem.stopped?this.stop(this.delay):this.start(this.delay)}toggleFroze(){this.particleSystem.started&&!this.particleSystem.isFrozen?this.freeze(this.delay):this.unFreeze(this.delay)}start(e=0){if(e){this.delayTimerId=window.setTimeout(()=>{this.start(0),this.clearDelay()},e);return}this.particleSystem.start()}stop(e=0){if(e){this.delayTimerId=window.setTimeout(()=>{this.stop(0),this.clearDelay()},e);return}this.particleSystem.stop()}freeze(e=0){if(e){this.delayTimerId=window.setTimeout(()=>{this.freeze(0),this.clearDelay()},e);return}this.particleSystem.froze()}unFreeze(e=0){if(e){this.delayTimerId=window.setTimeout(()=>{this.unFreeze(0),this.clearDelay()},e);return}this.particleSystem.unFroze()}reset(e=0){if(e){this.delayTimerId=window.setTimeout(()=>{this.reset(0),this.clearDelay()},e);return}this.particleSystem.reset()}reverseFromCurrent(){switch(this.emission){case"emitToggle":this.toggleEmitting();break;case"pauseToggle":this.toggleFroze();break}}dispatchBasic(){if(vi(this.shared,this.condition)===!1||!this.particleSystem)return!1;switch(this.emission){case"start":this.start(this.delay);break;case"emitToggle":this.toggleEmitting();break;case"pause":this.freeze(this.delay);break;case"pauseToggle":this.toggleFroze();break;case"stop":this.stop(this.delay);break;case"reset":this.reset(this.delay);break}}dispatchConditional(){if(vi(this.shared,this.condition)===!1||!this.particleSystem)return!1;switch(this.emission){case"start":this.start(this.delay);break;case"stop":this.stop(this.delay);break;case"reset":this.reset(this.delay);break}}dispatchGameControl(e){if(vi(this.shared,this.condition)===!1||!this.particleSystem)return!1;e==="start"?this.start(this.delay):this.stop(this.delay)}dispose(){!this.particleSystem||(this.particleSystem.reset(),this.clearDelay())}clearDelay(){this.delayTimerId&&(clearTimeout(this.delayTimerId),delete this.delayTimerId)}},NBe="text/plain",UBe="us-ascii",c4=(e,t)=>t.some(r=>r instanceof RegExp?r.test(e):r===e),jBe=(e,{stripHash:t})=>{let r=/^data:(?<type>[^,]*?),(?<data>[^#]*?)(?:#(?<hash>.*))?$/.exec(e);if(!r)throw new Error(`Invalid URL: ${e}`);let{type:i,data:n,hash:a}=r.groups,o=i.split(";");a=t?"":a;let s=!1;o[o.length-1]==="base64"&&(o.pop(),s=!0);let l=(o.shift()||"").toLowerCase(),c=[...o.map(d=>{let[u,h=""]=d.split("=").map(f=>f.trim());return u==="charset"&&(h=h.toLowerCase(),h===UBe)?"":`${u}${h?`=${h}`:""}`}).filter(Boolean)];return s&&c.push("base64"),(c.length>0||l&&l!==NBe)&&c.unshift(l),`data:${c.join(";")},${s?n.trim():n}${a?`#${a}`:""}`};function VBe(e,t){if(t={defaultProtocol:"http:",normalizeProtocol:!0,forceHttp:!1,forceHttps:!1,stripAuthentication:!0,stripHash:!1,stripTextFragment:!0,stripWWW:!0,removeQueryParameters:[/^utm_\w+/i],removeTrailingSlash:!0,removeSingleSlash:!0,removeDirectoryIndex:!1,sortQueryParameters:!0,...t},e=e.trim(),/^data:/i.test(e))return jBe(e,t);if(/^view-source:/i.test(e))throw new Error("`view-source:` is not supported as it is a non-standard protocol");let r=e.startsWith("//");!r&&/^\.*\//.test(e)||(e=e.replace(/^(?!(?:\w+:)?\/\/)|^\/\//,t.defaultProtocol));let i=new URL(e);if(t.forceHttp&&t.forceHttps)throw new Error("The `forceHttp` and `forceHttps` options cannot be used together");if(t.forceHttp&&i.protocol==="https:"&&(i.protocol="http:"),t.forceHttps&&i.protocol==="http:"&&(i.protocol="https:"),t.stripAuthentication&&(i.username="",i.password=""),t.stripHash?i.hash="":t.stripTextFragment&&(i.hash=i.hash.replace(/#?:~:text.*?$/i,"")),i.pathname){let a=/\b[a-z][a-z\d+\-.]{1,50}:\/\//g,o=0,s="";for(;;){let c=a.exec(i.pathname);if(!c)break;let d=c[0],u=c.index,h=i.pathname.slice(o,u);s+=h.replace(/\/{2,}/g,"/"),s+=d,o=u+d.length}let l=i.pathname.slice(o,i.pathname.length);s+=l.replace(/\/{2,}/g,"/"),i.pathname=s}if(i.pathname)try{i.pathname=decodeURI(i.pathname)}catch{}if(t.removeDirectoryIndex===!0&&(t.removeDirectoryIndex=[/^index\.[a-z]+$/]),Array.isArray(t.removeDirectoryIndex)&&t.removeDirectoryIndex.length>0){let a=i.pathname.split("/"),o=a[a.length-1];c4(o,t.removeDirectoryIndex)&&(a=a.slice(0,-1),i.pathname=a.slice(1).join("/")+"/")}if(i.hostname&&(i.hostname=i.hostname.replace(/\.$/,""),t.stripWWW&&/^www\.(?!www\.)[a-z\-\d]{1,63}\.[a-z.\-\d]{2,63}$/.test(i.hostname)&&(i.hostname=i.hostname.replace(/^www\./,""))),Array.isArray(t.removeQueryParameters))for(let a of[...i.searchParams.keys()])c4(a,t.removeQueryParameters)&&i.searchParams.delete(a);if(t.removeQueryParameters===!0&&(i.search=""),t.sortQueryParameters){i.searchParams.sort();try{i.search=decodeURIComponent(i.search)}catch{}}t.removeTrailingSlash&&(i.pathname=i.pathname.replace(/\/$/,""));let n=e;return e=i.toString(),!t.removeSingleSlash&&i.pathname==="/"&&!n.endsWith("/")&&i.hash===""&&(e=e.replace(/\/$/,"")),(t.removeTrailingSlash||i.pathname==="/")&&i.hash===""&&t.removeSingleSlash&&(e=e.replace(/\/$/,"")),r&&!t.normalizeProtocol&&(e=e.replace(/^http:\/\//,"//")),t.stripProtocol&&(e=e.replace(/^(?:https?:)?\/\//,"")),e}var HBe=class{constructor({url:e,context:t},r,i,n){if(this.controlsManager=r,this.shared=i,this.condition=n,!e)throw new Error("Missing property");this.url=e.startsWith("mailto:")?e:VBe(e,{removeTrailingSlash:!1,removeSingleSlash:!1,stripWWW:!1}),this.context=t??"tab"}dispatch(){var e;if(vi(this.shared,this.condition)===!1)return!1;Qg?window.location.assign(this.url):(this.context==="tab"||PV&&this.context==="none"?window.open(this.url,"_blank"):this.context==="window"?window.open(this.url,"_blank",`width=${window.innerWidth}, height=${window.innerHeight}`):window.open(this.url,"_parent"),(e=this.controlsManager.orbitControls)==null||e.onPointerUp(Ht[0]),ITe())}},hW=class{constructor(e,t,r,i,n){this.data=e,this.page=t,this.controlsManager=r,this.shared=i,this.condition=n,this.timeoutIdQueue=[],this.dispatchInner=()=>{this.objects.forEach(this.destroyCallback)},this.destroyCallback=a=>{var c,d;this.timeoutIdQueue.shift();let o=this.page.scene.find(a);if(o===void 0)return;let s=this.controlsManager.sharedGameControlGlobals.rapierWorld,l=s?(c=o.dataPatched.physics)==null?void 0:c.fusedBody:!0;if(o.cloner){for(let u of o.cloner.children)l?(u.playModeVisible=!1,u.rigidBody&&((d=o.dataPatched.physics)==null?void 0:d.rigidBody)==="positioned"&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(u.rigidBody.collider(0).handle),s.removeRigidBody(u.rigidBody),u.rigidBody=void 0),u.bvhGeometry&&(u.bvhGeometry=void 0)):this.clone===void 0||this.clone===u?(u.playModeVisible=!1,u.rigidBody&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(u.rigidBody.collider(0).handle),s.removeRigidBody(u.rigidBody),u.rigidBody=void 0)):u.playModeVisible===void 0&&(u.playModeVisible=!0);(l||this.clone===void 0||this.clone===!1)&&(o.visible=!1,o.rigidBody&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(o.rigidBody.collider(0).handle),s.removeRigidBody(o.rigidBody),o.rigidBody=void 0),o.bvhGeometry&&(o.bvhGeometry=void 0))}else o.rigidBody&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(o.rigidBody.collider(0).handle),s.removeRigidBody(o.rigidBody),o.rigidBody=void 0),o.bvhGeometry&&(o.bvhGeometry=void 0),o.visible=!1;s===void 0?this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim=this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.filter(u=>u.bvhGeometry!==void 0):this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim=this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.filter(u=>u.rigidBody!==void 0),o.destroyedInAction=!0,this.controlsManager.requestRender()},this.objects=[...e.objects]}dispatch(e){if(vi(this.shared,this.condition)===!1)return!1;this.clone=e,this.data.delay?this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3)):this.dispatchInner()}dispatchFromStart(){if(vi(this.shared,this.condition)===!1)return!1;this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3))}dispose(){this.timeoutIdQueue.forEach(e=>window.clearTimeout(e))}},fW=class{constructor(e,t,r,i,n){this.data=e,this.page=t,this.shared=r,this.eventManager=i,this.condition=n,this.shared=r}dispatch(){if(vi(this.shared,this.condition)===!1)return!1;clearTimeout(this.timeoutId),delete this.timeoutId,this.timeoutId=window.setTimeout(()=>{var e;this.shared.reset(this.shared.data,!0),RD(this.page,this.shared,!0),this.eventManager.reset(),(e=this.eventManager.controlsManager.gameControl)==null||e.reset(!0),this.page.switchToPlayCamera(),this.eventManager.controlsManager.requestRender(),delete this.timeoutId},(this.data.delay??0)*1e3)}dispose(){clearTimeout(this.timeoutId),delete this.timeoutId}},pW={update:null,begin:null,loopBegin:null,changeBegin:null,change:null,changeComplete:null,timelineChangeComplete:null,loopComplete:null,complete:null,loop:1,direction:"normal",autoplay:!0,timelineOffset:0,rewind:!0},SD={duration:1e3,delay:0,endDelay:0,startOnceDelay:0,pingPongDelayCorrection:0,pingPongEndDelayCorrection:0,easing:"easeOutElastic(1, .5)",round:0},WBe=["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective","matrix","matrix3d"],a1={CSS:{},springs:{}};function as(e,t,r){return Math.min(Math.max(e,t),r)}function Iv(e,t){return e.indexOf(t)>-1}function p_(e,t){return e.apply(null,t)}var Gt={arr:function(e){return Array.isArray(e)},obj:function(e){return Iv(Object.prototype.toString.call(e),"Object")},pth:function(e){return Gt.obj(e)&&e.hasOwnProperty("totalLength")},svg:function(e){return e instanceof SVGElement},inp:function(e){return e instanceof HTMLInputElement},dom:function(e){return!("isNode"in e)&&(e.nodeType||Gt.svg(e))},str:function(e){return typeof e=="string"},fnc:function(e){return typeof e=="function"},und:function(e){return typeof e>"u"},hex:function(e){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(e)},rgb:function(e){return/^rgb/.test(e)},hsl:function(e){return/^hsl/.test(e)},col:function(e){return Gt.hex(e)||Gt.rgb(e)||Gt.hsl(e)},key:function(e){return!pW.hasOwnProperty(e)&&!SD.hasOwnProperty(e)&&e!=="targets"&&e!=="keyframes"}};function mW(e){var t=/\(([^)]+)\)/.exec(e);return t?t[1].split(",").map(function(r){return parseFloat(r)}):[]}function vW(e,t){var r=mW(e),i=as(Gt.und(r[0])?1:r[0],.1,100),n=as(Gt.und(r[1])?100:r[1],.1,100),a=as(Gt.und(r[2])?10:r[2],.1,100),o=as(Gt.und(r[3])?0:r[3],.1,100),s=Math.sqrt(n/i),l=a/(2*Math.sqrt(n*i)),c=l<1?s*Math.sqrt(1-l*l):0,d=1,u=l<1?(l*s+-o)/c:-o+s;function h(p){var v=t?t*p/1e3:p;return l<1?v=Math.exp(-v*l*s)*(d*Math.cos(c*v)+u*Math.sin(c*v)):v=(d+u*v)*Math.exp(-v*s),p===0||p===1?p:1-v}function f(){var p=a1.springs[e];if(p)return p;for(var v=1/6,m=0,g=0;;)if(m+=v,h(m)===1){if(g++,g>=16)break}else g=0;var y=m*v*1e3;return a1.springs[e]=y,y}return t?h:f}function GBe(e){return e===void 0&&(e=10),function(t){return Math.ceil(as(t,1e-6,1)*e)*(1/e)}}var $Be=function(){var e=11,t=1/(e-1);function r(d,u){return 1-3*u+3*d}function i(d,u){return 3*u-6*d}function n(d){return 3*d}function a(d,u,h){return((r(u,h)*d+i(u,h))*d+n(u))*d}function o(d,u,h){return 3*r(u,h)*d*d+2*i(u,h)*d+n(u)}function s(d,u,h,f,p){var v,m,g=0;do m=u+(h-u)/2,v=a(m,f,p)-d,v>0?h=m:u=m;while(Math.abs(v)>1e-7&&++g<10);return m}function l(d,u,h,f){for(var p=0;p<4;++p){var v=o(u,h,f);if(v===0)return u;var m=a(u,h,f)-d;u-=m/v}return u}function c(d,u,h,f){if(!(0<=d&&d<=1&&0<=h&&h<=1))return;var p=new Float32Array(e);if(d!==u||h!==f)for(var v=0;v<e;++v)p[v]=a(v*t,d,h);function m(g){for(var y=0,b=1,x=e-1;b!==x&&p[b]<=g;++b)y+=t;--b;var S=(g-p[b])/(p[b+1]-p[b]),w=y+S*t,_=o(w,d,h);return _>=.001?l(g,w,d,h):_===0?w:s(g,y,y+t,d,h)}return function(g){return d===u&&h===f||g===0||g===1?g:a(m(g),u,f)}}return c}(),gW=function(){var e={linear:function(){return function(i){return i}}},t={Sine:function(){return function(i){return 1-Math.cos(i*Math.PI/2)}},Circ:function(){return function(i){return 1-Math.sqrt(1-i*i)}},Back:function(){return function(i){return i*i*(3*i-2)}},Bounce:function(){return function(i){for(var n,a=4;i<((n=Math.pow(2,--a))-1)/11;);return 1/Math.pow(4,3-a)-7.5625*Math.pow((n*3-2)/22-i,2)}},Elastic:function(i,n){i===void 0&&(i=1),n===void 0&&(n=.5);var a=as(i,1,10),o=as(n,.1,2);return function(s){return s===0||s===1?s:-a*Math.pow(2,10*(s-1))*Math.sin((s-1-o/(Math.PI*2)*Math.asin(1/a))*(Math.PI*2)/o)}}},r=["Quad","Cubic","Quart","Quint","Expo"];return r.forEach(function(i,n){t[i]=function(){return function(a){return Math.pow(a,n+2)}}}),Object.keys(t).forEach(function(i){var n=t[i];e["easeIn"+i]=n,e["easeOut"+i]=function(a,o){return function(s){return 1-n(a,o)(1-s)}},e["easeInOut"+i]=function(a,o){return function(s){return s<.5?n(a,o)(s*2)/2:1-n(a,o)(s*-2+2)/2}}}),e}();function CD(e,t){if(Gt.fnc(e))return e;var r=e.split("(")[0],i=gW[r],n=mW(e);switch(r){case"spring":return vW(e,t);case"cubicBezier":return p_($Be,n);case"steps":return p_(GBe,n);default:return p_(i,n)}}function yW(e){try{var t=document.querySelectorAll(e);return t}catch{return}}function yw(e,t){for(var r=e.length,i=arguments.length>=2?arguments[1]:void 0,n=[],a=0;a<r;a++)if(a in e){var o=e[a];t.call(i,o,a,e)&&n.push(o)}return n}function bw(e){return e.reduce(function(t,r){return t.concat(Gt.arr(r)?bw(r):r)},[])}function d4(e){return Gt.arr(e)?e:(Gt.str(e)&&(e=yW(e)||e),e instanceof NodeList||e instanceof HTMLCollection?[].slice.call(e):[e])}function _D(e,t){return e.some(function(r){return r===t})}function AD(e){var t={};for(var r in e)t[r]=e[r];return t}function yE(e,t){var r=AD(e);for(var i in e)r[i]=t.hasOwnProperty(i)?t[i]:e[i];return r}function xw(e,t){var r=AD(e);for(var i in t)r[i]=Gt.und(e[i])?t[i]:e[i];return r}function qBe(e){var t=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g.exec(e);return t?"rgba("+t[1]+",1)":e}function YBe(e){var t=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,r=e.replace(t,function(s,l,c,d){return l+l+c+c+d+d}),i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(r),n=parseInt(i[1],16),a=parseInt(i[2],16),o=parseInt(i[3],16);return"rgba("+n+","+a+","+o+",1)"}function XBe(e){var t=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(e)||/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g.exec(e),r=parseInt(t[1],10)/360,i=parseInt(t[2],10)/100,n=parseInt(t[3],10)/100,a=t[4]||1;function o(h,f,p){return p<0&&(p+=1),p>1&&(p-=1),p<1/6?h+(f-h)*6*p:p<1/2?f:p<2/3?h+(f-h)*(2/3-p)*6:h}var s,l,c;if(i==0)s=l=c=n;else{var d=n<.5?n*(1+i):n+i-n*i,u=2*n-d;s=o(u,d,r+1/3),l=o(u,d,r),c=o(u,d,r-1/3)}return"rgba("+s*255+","+l*255+","+c*255+","+a+")"}function KBe(e){if(Gt.rgb(e))return qBe(e);if(Gt.hex(e))return YBe(e);if(Gt.hsl(e))return XBe(e)}function Zl(e){var t=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/.exec(e);if(t)return t[1]}function QBe(e){if(Iv(e,"translate")||e==="perspective")return"px";if(Iv(e,"rotate")||Iv(e,"skew"))return"deg"}function bE(e,t){return Gt.fnc(e)?e(t.target,t.id,t.total):e}function Ys(e,t){return e.getAttribute(t)}function MD(e,t,r){var i=Zl(t);if(_D([r,"deg","rad","turn"],i))return t;var n=a1.CSS[t+r];if(!Gt.und(n))return n;var a=100,o=document.createElement(e.tagName),s=e.parentNode&&e.parentNode!==document?e.parentNode:document.body;s.appendChild(o),o.style.position="absolute",o.style.width=a+r;var l=a/o.offsetWidth;s.removeChild(o);var c=l*parseFloat(t);return a1.CSS[t+r]=c,c}function bW(e,t,r){if(t in e.style){var i=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),n=e.style[t]||getComputedStyle(e).getPropertyValue(i)||"0";return r?MD(e,n,r):n}}function ED(e,t){if(Gt.dom(e)&&!Gt.inp(e)&&(Ys(e,t)||Gt.svg(e)&&e[t]))return"attribute";if(Gt.dom(e)&&_D(WBe,t))return"transform";if(Gt.dom(e)&&t!=="transform"&&bW(e,t))return"css";if(e[t]!=null)return"object"}function xW(e){if(Gt.dom(e)){for(var t=e.style.transform||"",r=/(\w+)\(([^)]*)\)/g,i=new Map,n;n=r.exec(t);)i.set(n[1],n[2]);return i}}function ZBe(e,t,r,i){var n=Iv(t,"scale")?1:0+QBe(t),a=xW(e).get(t)||n;return r&&(r.transforms.list.set(t,a),r.transforms.last=t),i?MD(e,a,i):a}function TD(e,t,r,i){switch(ED(e,t)){case"transform":return ZBe(e,t,i,r);case"css":return bW(e,t,r);case"attribute":return Ys(e,t);default:return e[t]||0}}function PD(e,t){var r=/^(\*=|\+=|-=)/.exec(e);if(!r)return e;var i=Zl(e)||0,n=parseFloat(t),a=parseFloat(e.replace(r[0],""));switch(r[0][0]){case"+":return n+a+i;case"-":return n-a+i;case"*":return n*a+i}}function wW(e,t){if(Gt.col(e))return KBe(e);if(/\s/g.test(e))return e;var r=Zl(e),i=r?e.substr(0,e.length-r.length):e;return t?i+t:i}function DD(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function JBe(e){return Math.PI*2*Ys(e,"r")}function e4e(e){return Ys(e,"width")*2+Ys(e,"height")*2}function t4e(e){return DD({x:Ys(e,"x1"),y:Ys(e,"y1")},{x:Ys(e,"x2"),y:Ys(e,"y2")})}function SW(e){for(var t=e.points,r=0,i,n=0;n<t.numberOfItems;n++){var a=t.getItem(n);n>0&&(r+=DD(i,a)),i=a}return r}function r4e(e){var t=e.points;return SW(e)+DD(t.getItem(t.numberOfItems-1),t.getItem(0))}function CW(e){if(e.getTotalLength)return e.getTotalLength();switch(e.tagName.toLowerCase()){case"circle":return JBe(e);case"rect":return e4e(e);case"line":return t4e(e);case"polyline":return SW(e);case"polygon":return r4e(e)}}function i4e(e){var t=CW(e);return e.setAttribute("stroke-dasharray",t),t}function n4e(e){for(var t=e.parentNode;Gt.svg(t)&&Gt.svg(t.parentNode);)t=t.parentNode;return t}function _W(e,t){var r=t||{},i=r.el||n4e(e),n=i.getBoundingClientRect(),a=Ys(i,"viewBox"),o=n.width,s=n.height,l=r.viewBox||(a?a.split(" "):[0,0,o,s]);return{el:i,viewBox:l,x:l[0]/1,y:l[1]/1,w:o/l[2],h:s/l[3]}}function a4e(e,t){var r=Gt.str(e)?yW(e)[0]:e,i=t||100;return function(n){return{property:n,el:r,svg:_W(r),totalLength:CW(r)*(i/100)}}}function o4e(e,t){function r(s){s===void 0&&(s=0);var l=t+s>=1?t+s:0;return e.el.getPointAtLength(l)}var i=_W(e.el,e.svg),n=r(),a=r(-1),o=r(1);switch(e.property){case"x":return(n.x-i.x)*i.w;case"y":return(n.y-i.y)*i.h;case"angle":return Math.atan2(o.y-a.y,o.x-a.x)*180/Math.PI}}function u4(e,t){var r=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?/g,i=wW(Gt.pth(e)?e.totalLength:e,t)+"";return{original:i,numbers:i.match(r)?i.match(r).map(Number):[0],strings:Gt.str(e)||t?i.split(r):[]}}function AW(e){var t=e?bw(Gt.arr(e)?e.map(d4):d4(e)):[];return yw(t,function(r,i,n){return n.indexOf(r)===i})}function MW(e){var t=AW(e);return t.map(function(r,i){return{target:r,id:i,total:t.length,transforms:{list:xW(r)}}})}function s4e(e,t){var r=AD(t);if(/^spring/.test(r.easing)&&(r.duration=vW(r.easing)),Gt.arr(e)){var i=e.length,n=i===2&&!Gt.obj(e[0]);n?e={value:e}:Gt.fnc(t.duration)||(r.duration=t.duration/i)}var a=Gt.arr(e)?e:[e];return a.map(function(o,s){var l=Gt.obj(o)&&!Gt.pth(o)?o:{value:o};return Gt.und(l.delay)&&(l.delay=s?0:t.delay),Gt.und(l.endDelay)&&(l.endDelay=s===a.length-1?t.endDelay:0),l}).map(function(o){return xw(o,r)})}function l4e(e){for(var t=yw(bw(e.map(function(a){return Object.keys(a)})),function(a){return Gt.key(a)}).reduce(function(a,o){return a.indexOf(o)<0&&a.push(o),a},[]),r={},i=function(a){var o=t[a];r[o]=e.map(function(s){var l={};for(var c in s)Gt.key(c)?c==o&&(l.value=s[c]):l[c]=s[c];return l})},n=0;n<t.length;n++)i(n);return r}function c4e(e,t){var r=[],i=t.keyframes;i&&(t=xw(l4e(i),t));for(var n in t)Gt.key(n)&&r.push({name:n,tweens:s4e(t[n],e)});return r}function d4e(e,t){var r={};for(var i in e){var n=bE(e[i],t);Gt.arr(n)&&(n=n.map(function(a){return bE(a,t)}),n.length===1&&(n=n[0])),r[i]=n}return r.duration=parseFloat(r.duration),r.delay=parseFloat(r.delay),r}function u4e(e,t){var r;return e.tweens.map(function(i){var n=d4e(i,t),a=n.value,o=Gt.arr(a)?a[1]:a,s=Zl(o),l=TD(t.target,e.name,s,t),c=r?r.to.original:l,d=Gt.arr(a)?a[0]:c,u=Zl(d)||Zl(l),h=s||u;return Gt.und(o)&&(o=c),n.from=u4(d,h),n.to=u4(PD(o,d),h),n.start=r?r.end:0,n.end=n.start+n.delay+n.duration+n.endDelay,n.easing=CD(n.easing,n.duration),n.isPath=Gt.pth(a),n.isColor=Gt.col(n.from.original),n.isColor&&(n.round=1),r=n,n})}var EW={css:function(e,t,r){return e.style[t]=r},attribute:function(e,t,r){return e.setAttribute(t,r)},object:function(e,t,r){return e[t]=r},transform:function(e,t,r,i,n){if(i.list.set(t,r),t===i.last||n){var a="";i.list.forEach(function(o,s){a+=s+"("+o+") "}),e.style.transform=a}}};function TW(e,t){var r=MW(e);r.forEach(function(i){for(var n in t){var a=bE(t[n],i),o=i.target,s=Zl(a),l=TD(o,n,s,i),c=s||Zl(l),d=PD(wW(a,c),l),u=ED(o,n);EW[u](o,n,d,i.transforms,!0)}})}function h4e(e,t){var r=ED(e.target,t.name);if(r){var i=u4e(t,e),n=i[i.length-1];return{type:r,property:t.name,animatable:e,tweens:i,duration:n.end,delay:i[0].delay,endDelay:n.endDelay}}}function f4e(e,t){return yw(bw(e.map(function(r){return t.map(function(i){return h4e(r,i)})})),function(r){return!Gt.und(r)})}function PW(e,t){var r=e.length,i=function(a){return a.timelineOffset?a.timelineOffset:0},n={};return n.duration=r?Math.max.apply(Math,e.map(function(a){let o=a.startOnceDelay??0,s=a.pingPongDelayCorrection??0,l=a.pingPongEndDelayCorrection??0;return i(a)+o+s+l+a.duration*(a.loop??1)})):t.duration,n.delay=r?Math.min.apply(Math,e.map(function(a){let o=a.startOnceDelay??0,s=a.pingPongDelayCorrection??0;return i(a)+o+s+a.delay})):t.delay,n.endDelay=r?n.duration-Math.max.apply(Math,e.map(function(a){let o=a.startOnceDelay??0,s=a.pingPongDelayCorrection??0,l=a.pingPongEndDelayCorrection??0;return i(a)+o+s+a.duration*(a.loop??1)-a.endDelay-l})):t.endDelay,n}var h4=0;function p4e(e){var t=yE(pW,e),r=yE(SD,e),i=c4e(r,e),n=MW(e.targets),a=f4e(n,i),o=PW(a,r),s=h4;return h4++,xw(t,{id:s,children:[],animatables:n,animations:a,duration:o.duration,delay:o.delay,endDelay:o.endDelay,startOnceDelay:r.startOnceDelay,pingPongDelayCorrection:r.pingPongDelayCorrection,pingPongEndDelayCorrection:r.pingPongEndDelayCorrection})}var ko=[],f4=[],Tb,m4e=function(){function e(){Tb=requestAnimationFrame(t)}function t(r){var i=ko.length;if(i){for(var n=0;n<i;){var a=ko[n];a.paused?(ko.splice(n,1),i-=1):(a.tick(r),n++)}e()}else Tb=cancelAnimationFrame(Tb)}return e}();function v4e(e){document.hidden?(ko.forEach(function(t){return t.pause(e.timeStamp)}),f4=ko.slice(0),Yi.running=ko=[]):f4.forEach(function(t){return t.play(e.timeStamp)})}typeof document<"u"&&document.addEventListener("visibilitychange",v4e);function Yi(e){e===void 0&&(e={});var t=0,r=0,i=0,n,a,o=0,s=null;function l(w){var _=window.Promise&&new Promise(function(C){return s=C});return w.finished=_,_}var c=p4e(e);l(c);function d(){var w=c.direction;w!=="alternate"&&(c.direction=w!=="normal"?"normal":"reverse"),c.reversed=!c.reversed,a.forEach(function(_){(_.loop===1||_.loop%2===0)&&(_.reversed=c.reversed)})}function u(){c.direction="normal",c.reversed=!1,a.forEach(function(w){return w.reversed=!1})}function h(w){return c.reversed?c.duration-w:w}function f(){t=0,r=h(c.currentTime)*(1/Yi.speed)}function p(w,_,C=!1){_&&(c.reversed?_.seek(_.duration*_.loop-(w-_.timelineOffset-_.pingPongDelayCorrection),C):_.seek(w-_.timelineOffset-_.startOnceDelay-_.pingPongDelayCorrection,C))}function v(w,_=!1){if(c.reversed)for(var C=o;C--;)p(w,a[C],_);else for(var A=0;A<o;A++)p(w,a[A],_)}function m(w){var Q,ne,V,de,me,Ce,G,Z,ue,Se;var _=0,C=c.animations,A=C.length;for(c.direction!=="alternate"&&((Q=c.parent)==null?void 0:Q.direction)==="alternate"?((ne=c.parent)==null?void 0:ne.rewind)===!1&&c.reversePlayback===!0&&c.rewind===!1&&((V=c.parent)!=null&&V.reversed&&c.direction==="alternate"?w=c.duration-c.delay+c.endDelay-w:w=c.duration+c.delay-c.endDelay-w):x(!1,(de=c.parent)==null?void 0:de.rewind,c.rewind,(me=c.parent)==null?void 0:me.reversePlayback,c.reversePlayback)&&((Ce=c.parent)!=null&&Ce.reversed&&c.direction==="alternate"?w=c.duration-c.delay+c.endDelay-w:w=c.duration+c.delay-c.endDelay-w);_<A;){var M=C[_],P=M.animatable,T=M.tweens,R=T.length-1,z=T[R];R&&(z=yw(T,function(_e){return w<_e.end})[0]||z);let we;(G=c.parent)!=null&&G.reversed&&c.direction==="alternate"?we=as(w-z.start-z.endDelay,0,z.duration)/z.duration:we=as(w-z.start-z.delay,0,z.duration)/z.duration;for(var F=isNaN(we)?1:z.easing(we),H=z.to.strings,N=z.round,U=[],ie=z.to.numbers.length,te=void 0,X=0;X<ie;X++){var W=void 0;let _e,Ee;c.direction!=="alternate"?((Z=c.parent)==null?void 0:Z.rewind)===!1&&c.reversePlayback===!0&&c.rewind===!1?(_e=z.to.numbers[X],Ee=z.from.numbers[X]||0):(Ee=z.to.numbers[X],_e=z.from.numbers[X]||0):x(!0,(ue=c.parent)==null?void 0:ue.rewind,c.rewind,(Se=c.parent)==null?void 0:Se.reversePlayback,c.reversePlayback)?(_e=z.to.numbers[X],Ee=z.from.numbers[X]||0):(Ee=z.to.numbers[X],_e=z.from.numbers[X]||0),z.isPath?W=o4e(z.value,F*Ee):W=_e+F*(Ee-_e),N&&(z.isColor&&X>2||(W=Math.round(W*N)/N)),U.push(W)}var q=H.length;if(!q)te=U[0];else{te=H[0];for(var $=0;$<q;$++){H[$];var le=H[$+1],ee=U[$];isNaN(ee)||(le?te+=ee+le:te+=ee+" ")}}EW[M.type](P.target,M.property,te,P.transforms),M.currentValue=te,_++}}function g(w){c[w]&&!c.passThrough&&c[w](c)}function y(){c.remaining&&c.remaining!==!0&&c.remaining--}let b={0:!1,1:!0,2:!1,3:!0,4:!1,5:!1,6:!1,7:!1,8:!1,9:!0,10:!0,11:!1,12:!1,13:!1,14:!0,15:!0,16:!1,17:!0,18:!0,19:!1,20:!1,21:!1,22:!0,23:!0,24:!1,25:!0,26:!1,27:!0,28:!1,29:!1,30:!1,31:!1};function x(w,_,C,A,M){return b[w<<4|_<<3|C<<2|A<<1|M]}function S(w,_=!1){var T;var C=c.duration;let A=c.delay,M=C-c.endDelay;(T=c.parent)!=null&&T.reversed&&c.direction==="alternate"&&(A=c.endDelay,M=C-c.delay);var P=h(w);if(c.progress=as(P/C*100,0,100),_||(c.reversePlayback=P<c.currentTime),o&&v(P,_),!c.began&&c.currentTime>=0&&(c.began=!0,g("begin")),!c.loopBegan&&c.currentTime>0&&(c.loopBegan=!0,g("loopBegin")),(c.reversed||P>=0)&&P<=A&&c.currentTime!==0&&(m(0),g("change")),(P>=M&&c.currentTime!==C+c.pingPongDelayCorrection||!C)&&(m(C),g("change")),P>A&&P<M?(c.changeBegan||(c.changeBegan=!0,c.changeCompleted=!1,g("changeBegin")),m(P),g("change")):c.changeBegan?(c.changeCompleted=!0,c.changeBegan=!1,g("change"),o&&g("timelineChangeComplete")):c.began&&P>M&&g("changeComplete"),c.currentTime=as(P,0,C+c.pingPongDelayCorrection),c.began&&g("update"),w>=C)if(y(),!c.remaining)c.paused=!0,c.completed||(c.completed=!0,g("loopComplete"),g("complete"),!c.passThrough&&"Promise"in window&&(s(),l(c)));else{o?t+=c.duration/Yi.speed:t+=c.duration;for(let R of a)R.setStartTime(0),R.remaining=R.loop;g("loopComplete"),c.loopBegan=!1,c.direction==="alternate"?d():o&&u()}}return c.reset=function(){var w=c.direction;c.passThrough=!1,c.currentTime=0,c.progress=0,c.paused=!0,c.began=!1,c.loopBegan=!1,c.changeBegan=!1,c.completed=!1,c.changeCompleted=!1,c.reversePlayback=!1,c.reversed=w==="reverse",c.remaining=c.loop,a=c.children,o=a.length;for(var _=o;_--;)c.children[_].reset();m(c.reversed?c.duration:0)},c.setStartTime=function(w){t=w},c.set=function(w,_){return TW(w,_),c},c.tick=function(w){i=w,t||(t=i),S((i+(r-t))*Yi.speed)},c.seek=function(w,_=!1){S(w-t,_)},c.pause=function(w){c.paused=!0,o&&(n=w??performance.now())},c.play=function(w){!c.paused||(c.completed&&c.reset(),c.paused=!1,ko.push(c),o&&n!==void 0&&(t+=(w??performance.now())-n),Tb||m4e())},c.reverse=function(){d(),c.completed=!c.reversed,f()},c.restart=function(){c.reset(),c.play()},c.reset(),c.autoplay&&c.play(),c}function p4(e,t){for(var r=t.length;r--;)_D(e,t[r].animatable.target)&&t.splice(r,1)}function g4e(e){for(var t=AW(e),r=ko.length;r--;){var i=ko[r],n=i.animations,a=i.children;p4(t,n);for(var o=a.length;o--;){var s=a[o],l=s.animations;p4(t,l),!l.length&&!s.children.length&&a.splice(o,1)}!n.length&&!a.length&&i.pause()}}function y4e(e,t){t===void 0&&(t={});var r=t.direction||"normal",i=t.easing?CD(t.easing):null,n=t.grid,a=t.axis,o=t.from||0,s=o==="first",l=o==="center",c=o==="last",d=Gt.arr(e),u=parseFloat(d?e[0]:e),h=d?parseFloat(e[1]):0,f=Zl(d?e[1]:e)||0,p=t.start||0+(d?u:0),v=[],m=0;return function(g,y,b){if(s&&(o=0),l&&(o=(b-1)/2),c&&(o=b-1),!v.length){for(var x=0;x<b;x++){if(!n)v.push(Math.abs(o-x));else{var S=l?(n[0]-1)/2:o%n[0],w=l?(n[1]-1)/2:Math.floor(o/n[0]),_=x%n[0],C=Math.floor(x/n[0]),A=S-_,M=w-C,P=Math.sqrt(A*A+M*M);a==="x"&&(P=-A),a==="y"&&(P=-M),v.push(P)}m=Math.max.apply(Math,v)}i&&(v=v.map(function(R){return i(R/m)*m})),r==="reverse"&&(v=v.map(function(R){return a?R<0?R*-1:-R:Math.abs(m-R)}))}var T=d?(h-u)/m:u;return p+T*(Math.round(v[y]*100)/100)+f}}function b4e(e){e===void 0&&(e={});var t=Yi(e);return t.duration=0,t.add=function(r,i){var n=ko.indexOf(t),a=t.children;n>-1&&ko.splice(n,1);function o(h){h.passThrough=!0}for(var s=0;s<a.length;s++)o(a[s]);var l=xw(r,yE(SD,e));l.targets=l.targets||e.targets;var c=t.duration;l.autoplay=!1,l.timelineOffset=Gt.und(i)?c:PD(i,c),o(t);var d=Yi(l);o(d),a.push(d),d.parent=t;var u=PW(a,e);return t.delay=u.delay,t.endDelay=u.endDelay,t.duration=u.duration,d.loop===!0&&(t.duration=1/0),t.seek(0),t.reset(),t.autoplay&&t.play(),t},t}Yi.version="3.2.0";Yi.speed=1;Yi.running=ko;Yi.remove=g4e;Yi.get=TD;Yi.set=TW;Yi.convertPx=MD;Yi.path=a4e;Yi.setDashoffset=i4e;Yi.stagger=y4e;Yi.timeline=b4e;Yi.easing=CD;Yi.penner=gW;Yi.random=function(e,t){return Math.floor(Math.random()*(t-e+1))+e};var DW=Yi,m4=new k,v4=new k,g4=new Xt;function x4e(e,t,r,i){if(i===0)return r.copy(e);if(i===1)return r.copy(t);let n=e.w*t.w+e.x*t.x+e.y*t.y+e.z*t.z;if(n>=1)return r.copy(e);let a=1-n*n;if(a<=Number.EPSILON){let d=1-i;return r.w=d*e.w+i*t.w,r.x=d*e.x+i*t.x,r.y=d*e.y+i*t.y,r.z=d*e.z+i*t.z,r.normalize(),r}let o=Math.sqrt(a),s=Math.atan2(o,n),l=Math.sin((1-i)*s)/o,c=Math.sin(i*s)/o;return r.w=e.w*l+t.w*c,r.x=e.x*l+t.x*c,r.y=e.y*l+t.y*c,r.z=e.z*l+t.z*c,r}function Kn(e,t,r,i,n,a){let o=r[e]!==void 0?r[e]:void 0,s=i[e];if(s==null)return;let l=o!=null?typeof o=="string"?Number(n.getVariable(o)??0):o:t[e],c=typeof s=="string"?Number(n.getVariable(s)??0):s;if(l!==c)return{update:d=>{let u=St.lerp(l,c,d);a?t[e]=Math.trunc(u):t[e]=u},start:()=>{t[e]=l},end:()=>{t[e]=c}}}function OD(e,t,r,i,n,a){let o=r[e]?r[e]:void 0,s=i[e];if(!s)return;let l=t[e],c=[...o??l].map(u=>typeof u=="string"?Number(n.getVariable(u)??0):u),d=[...s].map(u=>typeof u=="string"?Number(n.getVariable(u)??0):u);if(!(c.length!==d.length||DP(c,d)))return{update:u=>{c.forEach((h,f)=>{let p=St.lerp(h,d[f],u);t[e][f]=a?Math.trunc(p):p})},start:()=>{Object.assign(t[e],c)},end:()=>{Object.assign(t[e],d)}}}function o1(e,t,r){return t.forEach((i,n)=>{e.setComponent(n,typeof i=="string"?Number(r.getVariable(i)??0):i)}),e}function y4(e,t,r,i,n){let a=r[e]?r[e]:void 0,o=i[e];if(!o)return;let s=t[e],l=a?o1(new k,a,n):s.clone(),c=o1(new k,o,n);if(!l.equals(c))return{update:d=>{s.lerpVectors(l,c,d)},start:()=>{s.copy(l)},end:()=>{s.copy(c)}}}function b4(e,t,r){return t.forEach((i,n)=>{e.setComponent(n,typeof i=="string"?Number(r.getVariable(i)??0):i)}),e}function s1(e,t,r,i,n){let a=r[e]?r[e]:void 0,o=i[e];if(!o)return;let s=t[e],l=!(s instanceof ye),c=s instanceof ye?s:new ye().fromArray(s),d=a?b4(new ye,a,n):c.clone(),u=b4(new ye,o,n);if(!d.equals(u))return{update:h=>{c.lerpVectors(d,u,h),l&&(t[e]=c.toArray())},start:()=>{c.copy(d),l&&(t[e]=c.toArray())},end:()=>{c.copy(u),l&&(t[e]=c.toArray())}}}function w4e(e,t,r,i){let n=r[e]?r[e]:void 0,a=i[e];if(!a)return;let o=t[e],s=n?new it().fromArray(n):o.clone(),l=new k,c=new Xt,d=new k;s.decompose(l,c,d);let u=new it().fromArray(a),h=new k,f=new Xt,p=new k;if(u.decompose(h,f,p),!s.equals(u))return{update:v=>{g4.slerpQuaternions(c,f,v),m4.lerpVectors(l,h,v),v4.lerpVectors(d,p,v),o.compose(m4,g4,v4)},start:()=>{o.compose(l,c,d)},end:()=>{o.compose(h,f,p)}}}function S4e(e,t,r,i,n){let a=r[e]?r[e]:void 0,o=i[e];if(!o)return;let s=t[e],l=a?typeof a=="string"?n.getColor(a).clone():new Lt().setRGB(a.r,a.g,a.b):s.clone(),c=typeof o=="string"?n.getColor(o).clone():new Lt().setRGB(o.r,o.g,o.b);if(l.equals(c))return;let d=s.clone();return t[e]=d,{update:u=>{d.lerpColors(l,c,u)},start:()=>{d.copy(l)},end:()=>{d.copy(c)}}}function Zy(e,t,r,i,n){let a=r[e]?r[e]:void 0,o=i[e];if(!o)return;let s=t[e],l=new ia(s.r,s.g,s.b,s.a),c=a?typeof a=="string"?n.getColor(a).clone():new ia(a.r,a.g,a.b,a.a):l.clone(),d=typeof o=="string"?n.getColor(o).clone():new ia(o.r,o.g,o.b,o.a);if(!c.equals(d))return{update:u=>{l.lerpColors(c,d,u);let h=St.lerp(c.a,d.a,u);l.a=h,t[e]={r:l.r,g:l.g,b:l.b,a:l.a}},start:()=>{l.copy(c)},end:()=>{l.copy(d)}}}function jd(e,t,r,i,n){if(typeof t[e]=="number")return Kn(e,t,r??{},i,n);if(Array.isArray(t[e]))return OD(e,t,r??{},i,n)}function C4e(e,t,r,i){var s,l,c,d;let n=[],a=e.cameraType==="OrthographicCamera"?(s=t.orthographic)==null?void 0:s.zoom:(l=t.perspective)==null?void 0:l.zoom,o=e.cameraType==="OrthographicCamera"?(c=r.orthographic)==null?void 0:c.zoom:(d=r.perspective)==null?void 0:d.zoom;if(o!==void 0){let u=a??e.zoom,h=o;u!==h&&n.push({update:f=>{e.zoom=St.lerp(u,h,f),e.updateProjectionMatrix()},start:()=>{e.zoom=u,e.updateProjectionMatrix()},end:()=>{e.zoom=h,e.updateProjectionMatrix()}})}if(r.targetOffset!==void 0){let u=Kn("targetOffset",e,t,r,i);u&&n.push(u)}return n}function _4e(e,t,r,i){if(r.scaleBaked===void 0)return;let n=(t.scaleBaked??e.data.geometry.scaleBaked).map(s=>typeof s=="string"?Number(i.getVariable(s)??0):s),a=r.scaleBaked.map(s=>typeof s=="string"?Number(i.getVariable(s)??0):s);if(Vu.isEqual(n,a))return;let o=[];return o.push({update:s=>{e.updateGeometryInteractions({scaleBaked:[St.lerp(n[0],a[0],s),St.lerp(n[1],a[1],s),St.lerp(n[2],a[2],s)]},i),e.invalidateDownstreamBooleanData(),e.refreshAttachedClonersInteractions()},start:()=>{e.updateGeometryInteractions({scaleBaked:n},i),e.invalidateDownstreamBooleanData(),e.refreshAttachedClonersInteractions()},end:()=>{e.updateGeometryInteractions({scaleBaked:a},i),e.invalidateDownstreamBooleanData(),e.refreshAttachedClonersInteractions()}}),o}function A4e(e,t,r,i){if(!r.extrusion)return;let n=e.extrusion,a=t.extrusion??{},o=r.extrusion,s=[];return h8.forEach(l=>{let c=jd(l,n,a,o,i);c&&s.push(c)}),s}function M4e(e,t,r,i){let n=[];if(!("geometry"in r))return n;let a=e.geometry.userData.parameters,o="geometry"in t?t.geometry:{},s=r.geometry;if(e instanceof _g){let l=_4e(e,o,s,i);l&&n.push(...l)}else{let l={};if(Object.assign(l,Kl(a,qk)),qk.forEach(c=>{let d=jd(c,l,o,s,i);d&&n.push(d)}),e instanceof mD){Object.assign(l,{extrusion:{...a.extrusion}});let c=A4e(l,o,s,i);c&&n.push(...c)}n.length&&n.push({update:c=>{e.updateGeometryInteractions(l,i),e.updateGeometryGroupsIfNeeded(),e.refreshAttachedClonersInteractions()},start:c=>{e.updateGeometryInteractions(l,i),e.updateGeometryGroupsIfNeeded(),e.refreshAttachedClonersInteractions()},end:c=>{e.updateGeometryInteractions(l,i),e.updateGeometryGroupsIfNeeded(),e.refreshAttachedClonersInteractions()}})}return n}function E4e(e,t,r,i){let n=[];if(r.intensity!==void 0){let a=Kn("intensity",e,t,r,i);a&&n.push(a)}if(r.color!==void 0){let a=S4e("color",e,t,r,i);a&&n.push(a)}return n}function T4e(e,t,r,i){let n=[];if(Array.isArray(e.material)){if(!("materials"in r&&r.materials))return n;let a="materials"in t&&t.materials?t.materials:[],o=r.materials;e.material.forEach((s,l)=>{if(!o[l])return;let c=a[l]??{},d=o[l];typeof c=="string"||typeof d=="string"||n.push(...x4(s,c,d,i))})}else{if(!("material"in r&&r.material))return n;let a="material"in t&&t.material?t.material:{},o=r.material;if(typeof a=="string"||typeof o=="string")return n;n.push(...x4(e.material,a,o,i))}return n}function x4(e,t,r,i){var o;let n=[],a=Of(r,i)||!!t.layers&&Of(t,i);n.push(B4e(e,a));for(let s of e.layers){let l=(o=t.layers)==null?void 0:o.data(s.uuid),c=r.layers.data(s.uuid);if(!c||s.type!=="light"&&(!(s.visible??!0)||!(c.visible??!0)))continue;let d=s.getNames().filter(u=>!c8.some(h=>u.includes(h)));for(let u of d)try{let h=s.getValue(u),f;if(u==="colors")f=k4e(s,l,c,u);else if(Array.isArray(h))u==="steps"&&(f=z4e(s,l,c,u));else if(typeof h=="number")f=P4e(s,l,c,u,i);else{if(typeof h=="boolean")continue;h instanceof ye?f=D4e(s,l,c,u):h instanceof k?f=O4e(s,l,c,u,i):h instanceof ia?f=I4e(s,l,c,u,i):h instanceof Lt?f=R4e(s,l,c,u,i):"isTexture"in h&&(f=L4e(s,l,c,u))}f&&(Array.isArray(f)?n.push(...f):n.push(f))}catch(h){console.error(`lerpMaterial: unexpected material layer for ${u}`,h)}}return n}function P4e(e,t,r,i,n){if(!e.hasValue(i)||!(i in r))return;let a=t?t[i]:e.getValue(i),o=r[i],s=typeof a=="string"?Number(n.getVariable(a)??0):a,l=typeof o=="string"?Number(n.getVariable(o)??0):o;if(s!==l)return{update:c=>{e.setValue(i,St.lerp(s,l,c))},start:()=>{e.setValue(i,s)},end:()=>{e.setValue(i,l)}}}function D4e(e,t,r,i){if(!e.hasValue(i)||!(i in r))return;let n=e.getValue(i),a=t?new ye().fromArray(t[i]):n.clone(),o=new ye().fromArray(r[i]);if(!a.equals(o))return{update:s=>{n.lerpVectors(a,o,s)},start:()=>{n.copy(a)},end:()=>{n.copy(o)}}}function O4e(e,t,r,i,n){if(!e.hasValue(i)||!(i in r))return;let a=e.getValue(i),o=t?t[i]:void 0,s=r[i],l=o?o1(new k,o,n):a.clone(),c=o1(new k,s,n);if(!l.equals(c))return{update:d=>{a.lerpVectors(l,c,d)},start:()=>{a.copy(l)},end:()=>{a.copy(c)}}}function R4e(e,t,r,i,n){if(!e.hasValue(i)||!(i in r))return;let a=t?t[i]:void 0,o=r[i],s=e.getValue(i),l=a?typeof a=="string"?n.getColor(a).clone():new Lt().setRGB(a.r,a.g,a.b):s.clone(),c=typeof o=="string"?n.getColor(o).clone():new Lt().setRGB(o.r,o.g,o.b);if(l.equals(c))return;let d=s.clone();return{update:u=>{e.getValue(i)!==d&&e.setValue(i,d),d.lerpColors(l,c,u)},start:()=>{d.copy(l)},end:()=>{d.copy(c)}}}function I4e(e,t,r,i,n){if(!e.hasValue(i)||!(i in r))return;let a=t?t[i]:void 0,o=r[i],s=e.getValue(i),l=a?typeof a=="string"?n.getColor(a).clone():new Lt().setRGB(a.r,a.g,a.b):s.clone(),c=typeof o=="string"?n.getColor(o).clone():new ia(o.r,o.g,o.b,o.a);if(l.equals(c))return;let d=s.clone();return{update:u=>{e.getValue(i)!==d&&e.setValue(i,d),d.lerpColors(l,c,u)},start:()=>{d.copy(l)},end:()=>{d.copy(c)}}}function z4e(e,t,r,i="steps"){if(!e.hasValue(i)||!(i in r))return;let n=[],a=e.getValue(i),o=t?t[i]:a,s=r[i];return DP(o,s)||n.push({update:l=>{let c=[...a];for(let d=0;d<a.length;++d){let u=o[d],h=s[d];c[d]=St.lerp(u,h,l)}e.setValue(i,c)},start:()=>{e.setValue(i,o)},end:()=>{e.setValue(i,s)}}),n.length?n:void 0}function k4e(e,t,r,i="colors"){if(!e.hasValue(i)||!(i in r))return;let n=[],a=e.getValue(i),o=t?t[i]:a.map(l=>l.toArray()),s=r[i];for(let l=0;l<a.length;++l){let c=[...o[l]],d=[...s[l]];zx.isEqual(c,d)||n.push({update:u=>{a[l].fromArray(zx.lerp(c,d,u))},start:()=>{a[l].fromArray(c)},end:()=>{a[l].fromArray(d)}})}return n.length?n:void 0}function L4e(e,t,r,i="texture"){var m,g;if(!e.hasValue(i)||!(i in r))return;let n=e.getNode("rotation"),a=((m=t==null?void 0:t[i])==null?void 0:m.rotation)??0,o=((g=r[i])==null?void 0:g.rotation)??0;if(n&&a!==o)return{update:y=>{n.value=St.lerp(a,o,y)*St.DEG2RAD},start:()=>{n.value=a*St.DEG2RAD},end:()=>{n.value=o*St.DEG2RAD}};let s=e.getNode("mat");if(!s)return;let l=t?t[i]:s,c=r[i],d=[...l.repeat],u=[...l.offset],h=[...c.repeat],f=[...c.offset],p=l.rotation??0,v=c.rotation??0;if(!ql.isEqual(d,h)||!ql.isEqual(u,f)||p!==v)return{update:y=>{s.repeat=ql.lerp(d,h,y),s.offset=ql.lerp(u,f,y),s.rotation=St.lerp(p,v,y),s.updateMatrix()},start:()=>{s.repeat=[...d],s.offset=[...u],s.rotation=p,s.updateMatrix()},end:()=>{s.repeat=[...h],s.offset=[...f],s.rotation=v,s.updateMatrix()}}}function B4e(e,t){return{update:()=>{e.transparent=t}}}var m_=new k,w4=new vn;function F4e(e,t,r,i,n){var p,v,m,g,y,b;let a=[],o,s,l,c,d,u,h,f;if(e instanceof Nn?(o=s1("position",e,t,r,n),o&&a.push(o),l=Kn("rotation",e,t,r,n),l&&a.push(l),c=s1("shear",e,t,r,n),c&&a.push(c)):(f={slide:((p=t.pathSnapping)==null?void 0:p.slide)??((v=e.updatedPathSnapping)==null?void 0:v.slide)??((m=e.dataPatched.pathSnapping)==null?void 0:m.slide)??0,offset:((g=t.pathSnapping)==null?void 0:g.offset)??((y=e.updatedPathSnapping)==null?void 0:y.offset)??((b=e.dataPatched.pathSnapping)==null?void 0:b.offset)??0},u=Kn("slide",f,t.pathSnapping??e.updatedPathSnapping??e.dataPatched.pathSnapping,r.pathSnapping??e.dataPatched.pathSnapping,n),u&&a.push(u),h=Kn("offset",f,t.pathSnapping??e.updatedPathSnapping??e.dataPatched.pathSnapping,r.pathSnapping??e.dataPatched.pathSnapping,n),h&&a.push(h),!u&&!h&&(o=y4("position",e,t,r,n),o&&a.push(o),s=y4("scale",e,t,r,n),s&&a.push(s),l=N4e(e,t,r,i,n),l&&a.push(l),d=w4e("hiddenMatrix",e,t,r),d&&a.push(d))),o||s||l||d||u||h){let x=e instanceof Nn?()=>{e.updateWorldMatrix(!0)}:()=>{var S;e.updateMatrix(),e.hasNonUniformScale&&(e.updateMatrixWorld(),e.updateMatrixWorldSVD()),(S=e.parent)!=null&&S.matrixWorldFusedFalse&&(e.matrixWorld.multiplyMatrices(e.parent.matrixWorldFusedFalse,e.matrix),e.matrixWorldNeedsUpdate=!1),Jo(e)&&Yl(e.parent)&&e.invalidateDownstreamBooleanData(!0),e.updatePathSnapping(Object.assign({},t.pathSnapping,f))};a.push({update:x,start:x,end:x})}return a}function N4e(e,t,r,i,n){var d;let a=t!=null&&t.rotation?t.rotation.map(u=>(typeof u=="string"?Number(n.getVariable(u)??0):u)*St.DEG2RAD):void 0,o=(d=r.rotation)==null?void 0:d.map(u=>(typeof u=="string"?Number(n.getVariable(u)??0):u)*St.DEG2RAD);if(!o)return;let s=a?new k().fromArray(a):new k().setFromEuler(e.rotation),l=new k().fromArray(o);if(s.equals(l))return;let c=m_.subVectors(l,s);if(i&&c.toArray().every(u=>Math.abs(u)<2*Math.PI)){let u=new Xt().setFromEuler(w4.setFromVector3(s)),h=new Xt().setFromEuler(w4.setFromVector3(l));return{update:f=>{x4e(u,h,e.quaternion,f)},start:()=>{e.rotation.setFromVector3(s)},end:()=>{e.rotation.setFromVector3(l)}}}else return{update:u=>{m_.lerpVectors(s,l,u),e.rotation.setFromVector3(m_)},start:()=>{e.rotation.setFromVector3(s)},end:()=>{e.rotation.setFromVector3(l)}}}function U4e(e,t,r,i){let n=[];if(!("cloner"in r)||!e.cloner)return n;let a=e.cloner,o="cloner"in t?t.cloner:{},s=r.cloner;i8.forEach(f=>{let p;f==="count"?p=Kn("count",a.parameters,o,s,i,!0):p=jd(f,a.parameters,o??{},s,i),p&&n.push(p)});let l=j4e(a,o,s,i);l!=null&&l.length&&n.push(...l);let c=V4e(a,o,s,i);c!=null&&c.length&&n.push(...c);let d=H4e(a,o,s,i);d!=null&&d.length&&n.push(...d);let u=W4e(a,o,s,i);u!=null&&u.length&&n.push(...u);let h=G4e(a,o,s,i);return h!=null&&h.length&&n.push(...h),n.length&&n.push({update:()=>{a.update()}}),n}function j4e(e,t,r,i){if(e.parameters.type!=="radial")return;let n=t.radial,a=r.radial;if(!a)return;let o=e.parameters.radial,s=[];return n8.forEach(l=>{let c=jd(l,o,n??{},a,i);c&&s.push(c)}),s}function V4e(e,t,r,i){if(e.parameters.type!=="linear")return;let n=t.linear,a=r.linear;if(!a)return;let o=[],s=e.parameters.linear;return a8.forEach(l=>{let c=jd(l,s,n??{},a,i);c&&o.push(c)}),o}function H4e(e,t,r,i){if(e.parameters.type!=="grid")return;let n=t.grid,a=r.grid;if(!a)return;let o=[],s=e.parameters.grid;return o8.forEach(l=>{let c;l==="count"?c=OD(l,s,n??{},a,i,!0):c=jd(l,s,n??{},a,i),c&&o.push(c)}),o}function W4e(e,t,r,i){if(e.parameters.type!=="toObject")return;let n=t.toObject,a=r.toObject;if(!a)return;let o=[],s=e.parameters.toObject;return s8.forEach(l=>{let c;l==="count"?c=Kn(l,s,n??{},a,i,!0):c=jd(l,s,n??{},a,i),c&&o.push(c)}),o}function G4e(e,t,r,i){if(!e.parameters.randomness)return;let n=t.randomnessObject,a=r.randomnessObject;if(!a)return;let o=[],s=e.parameters.randomnessObject;return l8.forEach(l=>{let c=jd(l,s,n??{},a,i);c&&o.push(c)}),o}function $4e(e,t){return{update:()=>{e instanceof Dn&&(e.fill.enabled=t)}}}function q4e(e,t){return{update:()=>{e instanceof Dn&&(e.stroke.enabled=t)}}}function Y4e(e,t){return{update:()=>{e instanceof Dn&&(e.dropShadow.enabled=t)}}}function X4e(e,t){return{update:()=>{e instanceof Dn&&(e.innerShadow.enabled=t)}}}function K4e(e,t){return{update:()=>{e instanceof Dn&&(e.backgroundBlur.enabled=t)}}}function Q4e(e,t){return{update:()=>{e instanceof Dn&&(e.layerBlur.enabled=t)}}}function Z4e(e,t,r,i,n){let a=[],o,s,l,c,d,u,h,f,p,v,m,g,y,b,x;if("width"in e&&(o=Kn("width",e,t,r,n),o&&a.push(o)),"height"in e&&(s=Kn("height",e,t,r,n),s&&a.push(s)),e instanceof Dn||e instanceof tl){let S={...t.fill},w={...r.fill};S.enabled!==void 0&&S.enabled!==w.enabled&&(a.push($4e(e,!0)),S.enabled||Object.assign(S,{enabled:!0,color:{...S.color,a:0}}),w.enabled||Object.assign(w,{enabled:!0,color:{...w.color,a:0}})),l=Zy("color",e.fill,S,w,n),l&&a.push(l)}if(e instanceof Dn){let S={...t.stroke},w={...r.stroke};(S.enabled||w.enabled)&&(a.push(q4e(e,!0)),S.enabled||Object.assign(S,{enabled:!0,color:{...S.color,a:0}}),w.enabled||Object.assign(w,{enabled:!0,color:{...w.color,a:0}})),c=Zy("color",e.stroke,S,w,n),c&&a.push(c),d=Kn("thickness",e.stroke,S,w,n),d&&a.push(d)}if(e instanceof Dn){let S={...t.dropShadow},w={...r.dropShadow};(S.enabled||w.enabled)&&(a.push(Y4e(e,!0)),S.enabled||Object.assign(S,{enabled:!0,color:{...S.color,a:0}}),w.enabled||Object.assign(w,{enabled:!0,color:{...w.color,a:0}})),u=Zy("color",e.dropShadow,S,w,n),u&&a.push(u),h=Kn("blurRadius",e.dropShadow,S,w,n),h&&a.push(h),p=Kn("spread",e.dropShadow,S,w,n),p&&a.push(p),f=s1("offset",e.dropShadow,S,w,n),f&&a.push(f)}if(e instanceof Dn){let S={...t.innerShadow},w={...r.innerShadow};(S.enabled||w.enabled)&&(a.push(X4e(e,!0)),S.enabled||Object.assign(S,{enabled:!0,color:{...S.color,a:0}}),w.enabled||Object.assign(w,{enabled:!0,color:{...w.color,a:0}})),v=Zy("color",e.innerShadow,S,w,n),v&&a.push(v),m=Kn("blurRadius",e.innerShadow,S,w,n),m&&a.push(m),y=Kn("spread",e.innerShadow,S,w,n),y&&a.push(y),g=s1("offset",e.innerShadow,S,w,n),g&&a.push(g)}if(e instanceof Dn||e instanceof tl){let S={...t.backgroundBlur},w={...r.backgroundBlur};(S.enabled||w.enabled)&&(a.push(K4e(e,!0)),S.enabled||Object.assign(S,{enabled:!0,radius:0}),w.enabled||Object.assign(w,{enabled:!0,radius:0})),b=Kn("radius",e.backgroundBlur,S,w,n),b&&a.push(b)}if(e instanceof Dn){let S={...t.layerBlur},w={...r.layerBlur};(S.enabled||w.enabled)&&(a.push(Q4e(e,!0)),S.enabled||Object.assign(S,{enabled:!0,radius:0}),w.enabled||Object.assign(w,{enabled:!0,radius:0})),x=Kn("radius",e.layerBlur,S,w,n),x&&a.push(x)}if(e instanceof tl||e instanceof n0){let S=OD("cornerRadius",e,t,r,n);S&&a.push(S)}return a}function S4(e,t,r,i,n){let a=[];return e.data.visible&&a.push(...F4e(e,t,r,n,i)),e instanceof Nn?a.push(...Z4e(e,t,r,n,i)):(e.data.visible&&a.push(...U4e(e,t,r,i)),Jo(e)?(e instanceof ma&&e.data.visible&&a.push(...M4e(e,t,r,i)),e.data.visible&&a.push(...T4e(e,t,r,i))):$Ie(e)?e.data.visible&&a.push(...E4e(e,t,r,i)):GIe(e)&&a.push(...C4e(e,t,r,i))),a.length?{update:o=>{a.forEach(s=>s.update(o))},start:o=>{a.forEach(s=>{var l;return(l=s.start)==null?void 0:l.call(s,o)})},end:o=>{a.forEach(s=>{var l;return(l=s.end)==null?void 0:l.call(s,o)})}}:void 0}var C4=new k;function RD(e,t,r=!1){var a;let i=[],n=o=>{let s=o.data;delete o.states,o.currentState=null,o.reversibleToState=null,o.currentTransitionEvent=null;for(let l of s.states){let c={...l.data};o.states||(o.states={}),o.states[l.id]=Tu.patch(s,c)}A4(e.scene,o,null,t,s.events.find(l=>l.data.type==="Follow"||l.data.type==="LookAt")!==void 0),_4(e)};e.scene.traverse2D(n),e.traverseChildren(o=>{var d,u,h,f,p,v;if(r&&((d=o.rigidBody)==null||d.setTranslation(o.position0,!0),(u=o.rigidBody)==null||u.setRotation(o.rotation0,!0),(h=o.rigidBody)==null||h.setLinvel(C4,!0),(f=o.rigidBody)==null||f.setAngvel(C4,!0)),!Cr.is(o))return;let s=o.uuid,l=o.data;if(delete o.states,o.uuid===Zp)return;let c=!1;i.some(m=>{var g;return(g=e.scene.find(s))==null?void 0:g.isDescendantOf(m)})?c=!0:((p=l.physics)==null?void 0:p.fusedBody)===!0&&l.physics.rigidBody==="dynamic"&&i.push(s),o.data=l,o.currentState=null,o.reversibleToState=null,o.currentTransitionEvent=null;for(let m of l.states){let g={...m.data};e.data.globalPhysics.usePhysics===!0&&l.physics&&(l.physics.rigidBody==="dynamic"||c)&&(m.data.position!==void 0&&delete g.position,m.data.rotation!==void 0&&delete g.rotation,m.data.hiddenMatrix!==void 0&&delete g.hiddenMatrix),o.states||(o.states={}),o.states[m.id]=Au.patch(l,g)}A4(e.scene,o,null,t,l.events.find(m=>m.data.type==="Follow"||m.data.type==="LookAt")!==void 0),_4(e),o instanceof ha&&o.frame&&(o.frame.traverse(m=>n(m)),(v=o.uiCanvas)==null||v.applySize())}),e.frame&&(e.frame.traverse(o=>n(o)),(a=e.uiCanvas)==null||a.applySize())}function _4(e){e.traverseEntity(t=>{for(let r of t.data.events){let i=[];switch(r.data.type){case"Follow":case"MouseHover":case"Scroll":case"MouseDown":case"MouseUp":case"MousePress":case"KeyUp":case"KeyDown":case"KeyPress":case"Collision":i.push(...r.data.actions);break;case"GameControl":for(let n of Object.values(r.data.gameActions))i.push(...n);break;case"DragDrop":i.push(...r.data.dragDropActions.drag,...r.data.dragDropActions.drop);break;case"Conditional":i.push(...r.data.inActions,...r.data.outActions);break}for(let n of i)if(n.data.type==="Create"&&n.data.hideBase==="Yes"){let a=e.scene.find(n.data.object);a&&(a.visible=!1)}}})}function A4(e,t,r,i,n=!1){if(t instanceof ma&&t.removeInteractionGeometry(i),t instanceof Nn?t.changeSelectedState(r,{shared:i},n):t.changeSelectedState(r,{scene:e,shared:i},n),t instanceof ma&&t.updateGeometryGroupsIfNeeded(),t instanceof va&&t.updateCameraState(t.dataPatched,{scene:e,shared:i}),!(t instanceof Nn)){if(t.cloner)for(let a of t.cloner.children)a.playModeVisible=void 0;t.updateVisible()}}function OW(e){let t;if(e.easing===5){let{control1:r,control2:i}=e;t=`cubicBezier(
			${r[0]}, ${r[1]}, ${i[0]}, ${i[1]}
		)`}else if(e.easing===6){let{mass:r,stiffness:i,damping:n,velocity:a}=e;t=`spring( ${r}, ${i}, ${n}, ${a} )`}else{let r;switch(e.easing){case 0:r=Gc.linear;break;case 1:r=Gc.ease;break;case 2:r=Gc.easeIn;break;case 3:r=Gc.easeOut;break;case 4:r=Gc.easeInOut;break;default:r=Gc.linear}let[i,n,a,o]=r;t=`cubicBezier( ${i}, ${n}, ${a}, ${o} )`}return{duration:Math.max(e.duration,1e-4),easing:t}}function xE(e){let t={delay:0,loop:e.repeat===-1?!0:e.repeat+1};if(e.repeat===0)t.direction="normal",t.rewind=!1;else switch(e.direction){case"pingpong":t.direction="alternate",t.rewind=!1;break;case"pingpong-rewind":t.direction="alternate",t.rewind=!0;break;default:t.direction="normal",t.rewind=!1;break}switch(t.delay=0,t.endDelay=0,t.startOnceDelay=0,t.pingPongDelayCorrection=0,t.pingPongEndDelayCorrection=0,e.delayDirection){case"start-once":t.startOnceDelay=e.delay;break;case"start":t.delay=e.delay;break;case"end":t.endDelay=e.delay;break;case"start-end":case void 0:t.delay=e.delay,t.endDelay=e.delay;break}return t.direction==="alternate"&&(t.delay/=2,t.endDelay/=2,e.delayDirection==="start"?(t.pingPongDelayCorrection=t.delay,typeof t.loop=="number"&&t.loop%2===0&&(t.pingPongEndDelayCorrection=t.delay)):e.delayDirection==="end"?typeof t.loop=="number"&&t.loop%2!==0&&(t.pingPongEndDelayCorrection=t.endDelay):e.delayDirection==="start-end"&&(t.pingPongDelayCorrection=t.delay,t.pingPongEndDelayCorrection=t.endDelay)),t}var J4e={type:"beginState"},eFe={type:"completeState",isfromEntity:!1},M4=class{constructor(e,t,r,i,n,a){if(this.object=e,this.data=i,this.sharedAssets=n,this.allowSlerp=a,this.targets={t:0},this.firstLoop=!0,this._changeBegan=!1,this._changeCompleted=!0,this.onChange=()=>{this.callback&&(this.callback.update(this.targets.t),this.object.requestRender()),this.targets.t===0||this.targets.t===1?this._changeCompleted||(this._changeCompleted=!0,this._changeBegan=!1,this.onChangeComplete()):(this._changeCompleted&&(this._changeCompleted=!1),this._changeBegan||(this._changeBegan=!0,this.onChangeBegin()))},this.onChangeBegin=()=>{this.object.reversibleToState=this.to.id;let o=this.targets.t>.5?this.from.id:this.to.id;this.object.prevState!==this.object.currentState&&(this.object.prevState=this.object.currentState),this.object.currentState=o,this.object.dispatchEvent({type:"beginState",state:o}),this.object instanceof Nn||this.object.traverseEntity(s=>{s!==this.object&&s instanceof va&&s.dispatchEvent(J4e)})},this.onChangeComplete=()=>{this.firstLoop&&(this.onFirstLoop(),this.firstLoop=!1),this.object.reversibleToState=this.to.id;let o=this.targets.t<.5?this.from.id:this.to.id;this.object.prevState!==this.object.currentState&&(this.object.prevState=this.object.currentState),this.object.currentState=o,this.object.dispatchEvent({type:"completeState",state:o}),this.object instanceof Nn||this.object.traverseEntity(s=>{s!==this.object&&s instanceof va&&s.dispatchEvent(eFe)})},this.onFirstLoop=()=>{this.useCurrentState&&(this.callback=S4(this.object,this.from.data,this.to.data,this.sharedAssets,this.allowSlerp))},t===void 0){let o=Pb(this.object,this.object.currentState===r?this.object.prevState:this.object.currentState);if(!o)throw new Error("Missing property");this.from=o}else{let o=Pb(this.object,t);if(!o)throw new Error("Missing property");this.from=o}if(r===void 0)throw new Error("Missing property");{let o=Pb(this.object,r);if(!o)throw new Error("Missing property");this.to=o}this.useCurrentState=t===void 0||r===void 0,this.params={targets:this.targets,t:1,autoplay:!1,...xE(i),...OW(i),change:this.onChange},this.callback=S4(this.object,t===void 0?{}:this.from.data,r===void 0?{}:this.to.data,this.sharedAssets,this.allowSlerp)}get changeBegan(){return this._changeBegan}get changeCompleted(){return this._changeCompleted}},RW=class extends aa{constructor(e,t,r,i,n){var o;if(super(),this.eventType=e,this.data=t,this.page=r,this.shared=i,this.condition=n,this.toggleIsForward=!1,this.timelineNeedsRebuild=!1,this.hasPlayedOnce=!1,this.onTimelineChangeComplete=()=>{var s;this.data.tweens[0].data.direction!=="normal"&&(this.toggleIsForward=!this.toggleIsForward),this.timelineNeedsRebuild!==!1&&((s=this.timeline)==null||s.pause(),this.buildTimeline({isForward:this.toggleIsForward,needsRebuild:!1,isRebuild:!0}),this.timeline.play())},!t.object)throw new Error("Missing property");let a=this.page.scene.find(t.object)??((o=this.page.uiCanvas)==null?void 0:o.find(t.object))??this.page.scene.find2DInUIObjects(t.object);if(!a)throw new Error("Missing property");if(!a.states)throw new Error("Missing property");if(this.object=a,t.tweens.length<2)throw new Error("Missing property");this.tweens=Array(this.data.tweens.length-1),this.startOnceDelay=t.tweens[0].data.delayDirection==="start-once"?t.tweens[0].data.delay:0,this.init()}get playing(){var e;return((e=this.timeline)==null?void 0:e.paused)===!1}get changeBegan(){return this.tweens.some(e=>e.changeBegan)??!1}init(){this.initialCurrentState=Pb(this.object,this.object.currentState).id,this.toggleIsForward=!1}get currentState(){return this.data.runMode==="Toggle"&&Tk(this.eventType)?this.initialCurrentState:this.object.currentState}buildTimeline({isForward:e=!0,needsRebuild:t=!1,isRebuild:r=!1}={}){var i,n,a,o;try{let s=xE(this.data.tweens[0].data);r&&typeof s.loop=="number"&&s.loop--,(i=this.timeline)==null||i.pause(),this.timeline=DW.timeline({autoplay:!1,...s,...s.loop===!0||s.loop>1?{timelineChangeComplete:this.onTimelineChangeComplete}:{}});let l=this.tweens.findIndex(c=>c==null?void 0:c.changeBegan);if(t===!0&&(this.timelineNeedsRebuild=!0),e){let c=l===-1?0:l;for(let d=c;d<this.data.tweens.length-1;d++){let u=this.data.tweens[d],h=this.data.tweens[d+1],f;d===c&&(this.object.wasMovedByUser===!0||((n=this.object.previousAction)==null?void 0:n.changeBegan)===!0)?(f=void 0,this.object instanceof va&&(this.object.wasMovedByUser=!1)):f=u.data.state===void 0?this.currentState:u.data.state;let p=new M4(this.object,f,h.data.state===void 0?this.currentState:h.data.state,h.data,this.shared,this.data.allowSlerp??!1);l!==-1&&d===c&&Object.assign(p.params,{startOnceDelay:0}),this.tweens[d]=p,this.timeline.add(p.params,this.timeline.duration+(d===c?s.delay:0))}this.timeline.duration+=s.endDelay}else{let c=l===-1?this.data.tweens.length-1:l+1;for(let d=c;d>0;d--){let u=this.data.tweens[d],h=this.data.tweens[d-1],f;d===c&&(this.object.wasMovedByUser===!0||((a=this.object.previousAction)==null?void 0:a.changeBegan)===!0)?(f=void 0,this.object instanceof va&&(this.object.wasMovedByUser=!1)):f=u.data.state===void 0?this.currentState:u.data.state;let p=new M4(this.object,f,h.data.state===void 0?this.currentState:h.data.state,u.data,this.shared,this.data.allowSlerp??!1);l!==-1&&d===c&&Object.assign(p.params,{startOnceDelay:0}),this.tweens[d-1]=p,this.timeline.add(p.params,this.timeline.duration+(d===c?s.endDelay:0))}this.timeline.duration+=s.delay}}catch(s){s instanceof Error&&console.error(s.message)}((o=this.object.previousAction)==null?void 0:o.playing)===!0&&this.object.previousAction.pause(),this.object.previousAction=this}play(){if(vi(this.shared,this.condition)===!1||Tk(this.eventType)&&this.data.runMode==="Once"&&this.hasPlayedOnce||(this.hasPlayedOnce=!0,this.playing))return!1;clearTimeout(this.timeoutId);let e=xE(this.data.tweens[0].data).pingPongDelayCorrection;this.timeoutId=window.setTimeout(()=>{try{this.buildTimeline(),this.timeline.play()}catch(t){t instanceof Error&&console.error(t.message)}},this.startOnceDelay+e)}pause(){var e;(e=this.timeline)==null||e.pause(),clearTimeout(this.timeoutId),this.tweens=Array(this.data.tweens.length-1),delete this.timeoutId}stop(){this.pause();let e=this.data.tweens[0].data.state===void 0?this.initialCurrentState:this.data.tweens[0].data.state;this.object instanceof Nn?this.object.changeSelectedState(e,{shared:this.shared}):this.object.changeSelectedState(e,{scene:this.page.scene,shared:this.shared}),this.object.currentState=e}seek(e){var t;if(vi(this.shared,this.condition)===!1)return!1;this.timeline===void 0&&this.buildTimeline(),(t=this.timeline)==null||t.seek(e*this.timeline.duration,!0)}toggle(e){var t;if(vi(this.shared,this.condition)===!1)return!1;clearTimeout(this.timeoutId),this.toggleIsForward=e??!this.toggleIsForward,this.playing?((t=this.timeline)==null||t.pause(),this.buildTimeline({isForward:this.toggleIsForward,needsRebuild:!0}),this.timeline.play()):this.timeoutId=window.setTimeout(()=>{var r;(r=this.timeline)==null||r.pause(),this.buildTimeline({isForward:this.toggleIsForward}),this.timeline.play()},this.startOnceDelay)}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){this.pause()}};function Pb(e,t){var n;let r,i;if(typeof t=="string"?(r=t,i=(n=e.states)==null?void 0:n[r]):t===null&&(r=null,i=e.data),!(r===void 0||i===void 0))return{id:r,data:i}}var tFe={type:"beginState"},E4={type:"completeState",isfromEntity:!1},T4={type:"requestRender"},IW=class extends aa{constructor(e,t,r,i){super(),this.data=e,this.page=t,this.shared=r,this.condition=i,this.toggleIsForward=!1,this.posStart=new k,this.posEnd=new k,this.qStart=new Xt,this.qEnd=new Xt,this.zoomStart=1,this.zoomEnd=1}init(){}get playing(){return this.animation&&this.animation.began&&!this.animation.completed}buildAnimation(e=!1){if(!this.data.animate)return;let t=this.page.scene.find(this.data.targetCamera);if(!t||!t.visible)throw new ReferenceError("Target camera not founded or not visible");let r={t:0};this.posStart.copy(this.page.activeCamera.position),this.qStart.copy(this.page.activeCamera.quaternion),this.zoomStart=this.page.activeCamera.zoom,this.animation=DW({targets:r,t:1,...OW(this.data),update:()=>{r.t===0&&(this.data.runMode==="Toggle"&&!this.toggleIsForward?this.fromCamera&&(this.posEnd.copy(this.fromCamera.position),this.qEnd.copy(this.fromCamera.quaternion),this.zoomEnd=this.fromCamera.zoom,this.switchCamera(this.fromCamera.uuid)):(this.posEnd.copy(t.position),this.qEnd.copy(t.quaternion),this.zoomEnd=t.zoom,this.fromCamera=this.page.activeCamera,this.switchCamera(t.uuid)),this.page.activeCamera.dispatchEvent(tFe));let i=this.page.activeCamera;i.position.lerpVectors(this.posStart,this.posEnd,r.t),i.quaternion.slerpQuaternions(this.qStart,this.qEnd,r.t),i.zoom=this.zoomStart+(this.zoomEnd-this.zoomStart)*r.t,i.wasMovedBySwitchCameraAction=!0,i.updateMatrix(),i.updateMatrixWorld(),i.updateProjectionMatrix(),i.dispatchEvent(T4),r.t===1&&i.dispatchEvent(E4)}})}switchCamera(e){let t=this.page.activeCamera,r=this.page.scene.find(e);if(!r||!r.visible)throw new ReferenceError("Target camera not founded or not visible");this.page.switchActiveCamera(r),t.dispatchEvent({type:"cameraChange",camera:r})}play(){if(vi(this.shared,this.condition)===!1)return!1;if(!this.playing&&this.page.activeCamera.uuid!==this.data.targetCamera)try{clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{var e;delete this.timeoutId,this.data.animate?(this.buildAnimation(),(e=this.animation)==null||e.play()):this.switchCamera(this.data.targetCamera)},this.data.delay*1e3)}catch{}}pause(){var e;(e=this.animation)==null||e.pause(),clearTimeout(this.timeoutId),delete this.timeoutId}toggle(e){var t,r;if(vi(this.shared,this.condition)===!1)return!1;if(window.clearTimeout(this.timeoutId),delete this.timeoutId,e!==this.toggleIsForward)try{this.playing?((t=this.animation)==null||t.pause(),this.toggleIsForward=e??!this.toggleIsForward,this.buildAnimation(!0),(r=this.animation)==null||r.play()):this.timeoutId=window.setTimeout(()=>{var i,n;this.toggleIsForward=e??!this.toggleIsForward,this.data.animate?((i=this.animation)==null||i.pause(),this.buildAnimation(),(n=this.animation)==null||n.play()):(this.toggleIsForward?(this.fromCamera=this.page.activeCamera,this.switchCamera(this.data.targetCamera)):this.fromCamera&&this.switchCamera(this.fromCamera.uuid),this.page.activeCamera.dispatchEvent(E4),this.page.activeCamera.dispatchEvent(T4))},this.data.delay*1e3)}catch{}}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){this.pause(),this.toggleIsForward=!1}};function zW(e){let t=e==null?void 0:e.tracks.filter(r=>r.ValueTypeName==="vector"||r.ValueTypeName==="quaternion").map(r=>r.times.length);if(t!=null&&t.length){let r=iTe(t);return r&&r>2?r:2}return 2}var kW=class extends aa{constructor(e,t,r,i,n){var l,c,d;super(),this.data=e,this.page=t,this.animationControls=r,this.shared=i,this.condition=n,this.startOnceDelay=0,this.toggleIsForward=!1;let a=e.object,o=t.scene.find(e.object);o&&Array.isArray(o.identity)&&(a=o.identity[0]),this.data={...e,object:a};let s=this.animationControls.clipIdToAction[e.clipId+"/"+a];if(this.duration=((l=s==null?void 0:s.getClip())==null?void 0:l.duration)??1,this.data.crop2){let u=zW(s==null?void 0:s.getClip());this.leftFrameTime=this.data.crop2[0]/(u-1)*this.duration,this.rightFrameTime=this.data.crop2[1]/(u-1)*this.duration}else{let u=(d=(c=s==null?void 0:s.getClip())==null?void 0:c.tracks[0])==null?void 0:d.times.length;u&&u>1?(this.leftFrameTime=this.data.crop[0]/u*this.duration,this.rightFrameTime=this.data.crop[1]/u*this.duration):(this.leftFrameTime=0,this.rightFrameTime=this.duration)}this.startOnceDelay=e.delay}get playing(){var e;return((e=this.threeAnimAction)==null?void 0:e.isRunning())??!1}play(e=!1){if(vi(this.shared,this.condition)===!1)return!1;window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{var r;if(this.threeAnimAction=this.animationControls.play(this.data),!this.threeAnimAction)return;this.threeAnimAction.reset(),this.threeAnimAction.time=this.leftFrameTime,this.threeAnimAction._clip.start=this.leftFrameTime,this.threeAnimAction._clip.duration=this.rightFrameTime;let t=this.data.object;Object.entries(this.animationControls.clipIdToAction).forEach(([i,n])=>{let a=i.split("/")[1];this.threeAnimAction!==n&&a===t&&n.isRunning()&&(e?n.fadeOut(.2):n.stop())}),e&&((r=this.threeAnimAction)==null||r.fadeIn(.2))},this.startOnceDelay)}pause(){this.threeAnimAction&&(this.threeAnimAction.paused=!0),window.clearTimeout(this.timeoutId),delete this.timeoutId}stop(){var e;(e=this.threeAnimAction)==null||e.fadeOut(.2)}seek(e){this.threeAnimAction=this.animationControls.play(this.data),this.threeAnimAction&&(this.threeAnimAction.paused=!0,this.threeAnimAction.time=St.clamp(this.threeAnimAction.time+1/60*e,this.leftFrameTime,this.rightFrameTime-16e-5),this.animationControls.needsUpdate=!0,this.animationControls.requestRender())}toggle(e,t=!1){if(vi(this.shared,this.condition)===!1)return!1;this.toggleIsForward=e??!this.toggleIsForward,this.threeAnimAction&&(this.threeAnimAction._loopCount=0),this.playing?this.threeAnimAction&&(this.threeAnimAction.timeScale=this.toggleIsForward?1:-1,this.toggleIsForward?(this.threeAnimAction._clip.start=this.leftFrameTime,this.threeAnimAction._clip.duration=this.rightFrameTime):(this.threeAnimAction._clip.start=this.rightFrameTime,this.threeAnimAction._clip.duration=this.leftFrameTime)):this.timeoutId=window.setTimeout(()=>{var r;if(this.threeAnimAction=this.animationControls.play(this.data),this.threeAnimAction){this.toggleIsForward?(this.threeAnimAction.time=this.leftFrameTime,this.threeAnimAction._clip.start=this.leftFrameTime,this.threeAnimAction._clip.duration=this.rightFrameTime):(this.threeAnimAction.time=this.rightFrameTime,this.threeAnimAction._clip.start=this.rightFrameTime,this.threeAnimAction._clip.duration=this.leftFrameTime),this.threeAnimAction.paused=!1,this.threeAnimAction.timeScale=this.toggleIsForward?1:-1;let i=this.data.clipId.split("/")[1];Object.entries(this.animationControls.clipIdToAction).forEach(([n,a])=>{let o=n.split("/")[1];this.threeAnimAction!==a&&o===i&&a.isRunning()&&(t?a.fadeOut(.2):a.stop())}),t&&((r=this.threeAnimAction)==null||r.fadeIn(.2))}},this.startOnceDelay)}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){var t;let e=(t=this.animationControls.clipIdToAction[this.data.clipId+"/"+this.data.object])==null?void 0:t.getClip();e&&(e.duration=this.duration),this.pause()}},LW=class{constructor(e,t,r,i,n){this.data=e,this.page=t,this.eventManager=r,this.shared=i,this.condition=n,this.timeOutId=-1,this.scene=t.scene}dispatch(){if(vi(this.shared,this.condition)===!1)return!1;this.data.target!==this.page.uuid&&(window.clearTimeout(this.timeOutId),this.timeOutId=window.setTimeout(()=>{this.play()},this.data.delay*1e3))}dispose(){window.clearTimeout(this.timeOutId)}play(){if(this.scene.children.every(t=>t.uuid!==this.data.target))return;this.data.transition==="fade"&&this.data.duration>0&&this.eventManager.eventContext.renderer.renderFromSceneForSceneTransitionPass(this.scene,this.scene.activeCamera,this.data.duration*1e3),this.eventManager.deactivate(),this.eventManager.controlsManager.deactivate();let e=this.scene.activeCamera;this.scene.updatePage(this.data.target),this.scene.traverseVisibleEntity(t=>{t.type==="ParticleSystem"&&(t.sleep(),t.wakeUp(),t.data.autoPlay?t.start():t.stop())}),this.scene.activePage.switchToPlayCamera(),this.scene.activeCamera.copyViewPlaneSize(e),RD(this.scene.activePage,this.shared),this.eventManager.activate(),this.eventManager.controlsManager.activate(this.eventManager)}},BW=class{constructor(e,t,r,i){this.data=e,this.page=t,this.shared=r,this.condition=i,this.evaluatedCondition=!1}checkConditions(){this.evaluatedCondition=vi(this.shared,this.condition)}dispatch(){if(this.evaluatedCondition===!1)return!1;let e=this.shared.getVariable(this.data.variableId),t=U8(this.data.expression,this.shared,ta.typeOfVariable(e));t!==void 0&&this.shared.updateVariable(this.data.variableId,typeof t=="string"?{textValue:t}:t)}dispose(){}},FW=class{constructor(e,t,r,i){this.data=e,this.page=t,this.shared=r,this.condition=i,this.timeoutId=null}dispatchInner(){if(vi(this.shared,this.condition)===!1)return!1;let e=this.shared.getDynamicVariablePlayState(this.data.variableId);if(this.data.mode==="PlayPause")this.shared.getDynamicVariableToggleIsForward(this.data.variableId)===void 0&&this.shared.setDynamicVariableToggleIsForward(this.data.variableId,!0),this.shared.setDynamicVariablePlayState(this.data.variableId,e==="Playing"?"Paused":"Playing");else if(this.data.mode==="Play"&&e!=="Playing")this.shared.getDynamicVariableToggleIsForward(this.data.variableId)===void 0&&this.shared.setDynamicVariableToggleIsForward(this.data.variableId,!0),this.shared.setDynamicVariablePlayState(this.data.variableId,"Playing");else if(this.data.mode==="Stop"&&e!=="Stopped")this.shared.setDynamicVariablePlayState(this.data.variableId,"Stopped");else if(this.data.mode==="Pause"&&e!=="Paused")this.shared.setDynamicVariablePlayState(this.data.variableId,"Paused");else if(this.data.mode==="Restart")this.shared.setDynamicVariablePlayState(this.data.variableId,"Restarted");else if(this.data.mode==="Toggle"){let t=this.shared.getDynamicVariableToggleIsForward(this.data.variableId);e==="Playing"?this.shared.setDynamicVariableToggleIsForward(this.data.variableId,t===void 0?!1:!t):(this.shared.setDynamicVariableToggleIsForward(this.data.variableId,!t),this.shared.setDynamicVariablePlayState(this.data.variableId,"Playing"))}}dispatch(){let e=this.data.delay,t=this.shared.getDynamicVariablePlayState(this.data.variableId);this.data.mode==="PlayPause"&&t==="Playing"&&(e=this.data.pauseDelay),e!==0?(this.timeoutId&&window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{this.timeoutId=null,this.dispatchInner()},e)):this.dispatchInner()}dispose(){this.timeoutId&&window.clearTimeout(this.timeoutId)}},rFe=class{constructor(e,t,r,i){this.data=e,this.page=t,this.shared=r,this.condition=i}dispatch(){if(vi(this.shared,this.condition)===!1)return!1;(this.data.target==="single"?this.data.variableId?[this.data.variableId]:[]:Object.keys(this.shared.getVariables())).forEach(e=>{var r;this.shared.getVariable(e);let t=(r=this.shared.data.variables.data(e))==null?void 0:r.value;t!==void 0&&this.shared.updateVariable(e,t),this.shared.enableLocalStorageForPersistentVariables&&localStorage.removeItem(ZM(e))})}dispose(){}},iFe=class{constructor(e,t,r,i){this.data=e,this.page=t,this.shared=r,this.condition=i}dispatch(){var e;if(vi(this.shared,this.condition)===!1)return!1;this.data.userAPIId&&((e=this.shared.getUserAPI(this.data.userAPIId))==null||e.callUserAPI(this.shared))}dispose(){}};function vi(e,t){if(t===void 0)return!0;if(t.expression.length===0)return!1;let r=U8(t.expression,e,"boolean");return t.negate?!r:!!r}function Hn(e,t,r,i,n,a){let o={Audio:[],Video:[],Particles:[],Link:[],Destroy:[],Create:[],Reset:[],Transition:[],SwitchCamera:[],Animation:[],SceneTransition:[],SetVariable:[],DynamicVariablePlay:[],ClearLocalStorage:[],UserAPI:[]},s=l=>({id:c,data:d})=>{try{d.type==="Audio"?la[e.type].includes("Audio")&&o.Audio.push(new dW(c,d,a,i,l)):d.type==="Video"&&!(a instanceof Nn)?la[e.type].includes("Video")&&o.Video.push(new UW(c,d,a,i,l)):d.type==="Particles"?la[e.type].includes("Particles")&&o.Particles.push(new uW(d,r,i,l)):d.type==="Link"?la[e.type].includes("Link")&&o.Link.push(new HBe(d,n.controlsManager,i,l)):d.type==="Create"?la[e.type].includes("Create")&&o.Create.push(new jW(d,r,n.controlsManager,i,l)):d.type==="Destroy"?la[e.type].includes("Destroy")&&o.Destroy.push(new hW(d,r,n.controlsManager,i,l)):d.type==="Reset"?la[e.type].includes("Reset")&&o.Reset.push(new fW(d,r,i,n,l)):d.type==="Transition"?la[e.type].includes("Transition")&&o.Transition.push(new RW(e.type,d,r,i,l)):d.type==="SwitchCamera"?la[e.type].includes("SwitchCamera")&&o.SwitchCamera.push(new IW(d,r,i,l)):d.type==="SceneTransition"?la[e.type].includes("SceneTransition")&&o.SceneTransition.push(new LW(d,r,n,i,l)):d.type==="Animation"?la[e.type].includes("Animation")&&o.Animation.push(new kW(d,r,n.animationControls,i,l)):d.type==="SetVariable"?la[e.type].includes("SetVariable")&&o.SetVariable.push(new BW(d,r,i,l)):d.type==="DynamicVariablePlay"?la[e.type].includes("DynamicVariablePlay")&&o.DynamicVariablePlay.push(new FW(d,r,i,l)):d.type==="Conditional"?la[e.type].includes("Conditional")&&(d.ifActions.forEach(s({expression:d.condition,negate:!1})),d.elseActions.forEach(s({expression:d.condition,negate:!0}))):d.type==="ClearLocalStorage"?la[e.type].includes("ClearLocalStorage")&&o.ClearLocalStorage.push(new rFe(d,r,i,l)):d.type==="UserAPI"&&la[e.type].includes("UserAPI")&&o.UserAPI.push(new iFe(d,r,i,l))}catch{}};return t.forEach(s()),o}function Fn(e){Object.values(e).forEach(t=>{t.forEach(r=>{(r instanceof dW||r instanceof UW||r instanceof uW||r instanceof kW||r instanceof RW||r instanceof jW||r instanceof hW||r instanceof IW||r instanceof LW||r instanceof fW||r instanceof BW||r instanceof FW)&&r.dispose()})})}function nFe(e,t){let r;if("material"in e){let i=e.material;Array.isArray(i)?r=e.material[0].layers.find(n=>n.uuid===t):r=e.material.layers.find(n=>n.uuid===t)}if(r)return r.color.texture.image.img instanceof HTMLVideoElement?r.color.texture.image.img:void 0}var NW=new Map,zv=new Map,ep=class{constructor(e,t,r){this.data=t,this.delay=0,this.status="stopped";let{layerId:i,loop:n,volume:a,delay:o}=t;if(this.object=r,i===void 0)throw new Error("Missing property");let s=nFe(r,i);s&&(this.videoElement=s,this.videoElement.loop=n===1/0,Qg&&(this.videoElement.autoplay=!0),a!==void 0&&(this.videoElement.volume=a)),o!==void 0&&(this.delay=o),zv.has(r.uuid)?zv.get(r.uuid).push(this):zv.set(r.uuid,[this]),NW.set(e,this),this.pause()}mute(){!this.videoElement||(this.videoElement.muted=!0)}unMute(){!this.videoElement||(this.videoElement.muted=!1)}play(e){if(!this.videoElement)return;let t=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);e?(this.mute(),this.delay+=150):t?(this.mute(),window.setTimeout(()=>{this.unMute()},100)):this.unMute(),this.delayTimerId=window.setTimeout(()=>{if(!this.videoElement)return;let r=this.videoElement.play();r!==void 0&&r.then(i=>{}).catch(i=>{this.play()}),this.clearDelay()},this.delay),this.status="playing"}clearDelay(){this.delayTimerId&&(clearTimeout(this.delayTimerId),delete this.delayTimerId)}pause(){!this.videoElement||(this.videoElement.pause(),this.status="paused")}stop(){!this.videoElement||(this.videoElement.pause(),this.videoElement.currentTime=0,this.status="stopped",this.clearDelay())}playByToggle(){this.data.toggle==="stop"?this.status==="playing"?this.stop():(this.stop(),this.play()):this.data.toggle==="pause"?this.status==="playing"?this.pause():this.play():(this.stop(),this.play())}dispose(){!this.videoElement||(this.stop(),this.videoElement.muted=!0)}},wE=class{constructor(e){this.data=e}dispatch(){this.data.playVideo?this.pauseVideo(this.data.playVideo):this.data.object?this.pauseAllVideosFromObject(this.data.object):this.pauseAllVideos()}pauseVideo(e){let t=NW.get(e);!t||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{t[this.data.interaction](),this.disposeDelay()},this.data.delay)):t[this.data.interaction]())}pauseAllVideosFromObject(e){let t=zv.get(e);!(t!=null&&t.length)||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{t.forEach(r=>r[this.data.interaction]()),this.disposeDelay()},this.data.delay)):t.forEach(r=>r[this.data.interaction]()))}pauseAllVideos(){let e=[...zv.values()];!e.length||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{e.forEach(t=>{t.forEach(r=>{r[this.data.interaction]()})}),this.disposeDelay()},this.data.delay)):e.forEach(t=>{t.forEach(r=>{r[this.data.interaction]()})}))}disposeDelay(){clearTimeout(this.timeoutId),delete this.timeoutId}dispose(){clearTimeout(this.timeoutId),delete this.timeoutId}},UW=class{constructor(e,t,r,i,n){if(this.data=t,this.shared=i,this.condition=n,t.interaction==="play")this.interaction=new ep(e,t,r);else if(t.interaction==="pause"||t.interaction==="stop")this.interaction=new wE(t);else throw new Error("Missing property")}dispatchBasic(){if(vi(this.shared,this.condition)===!1)return!1;this.interaction instanceof ep?this.interaction.playByToggle():this.interaction.dispatch()}dispatchConditional(){if(vi(this.shared,this.condition)===!1)return!1;this.interaction instanceof ep?this.interaction.play():this.interaction.dispatch()}dispose(){this.interaction.dispose()}},P4=(()=>{let e,t,r,i;function n(s){!e&&!D4()&&(t==null?void 0:t.sharedGameControlGlobals.createdObjects.length)>0&&(e=requestAnimationFrame(a)),s&&(t=s,i=s.requestRender)}function a(s){let l=r?s-r:0,c=t.sharedGameControlGlobals.createdObjects,d=t.sharedGameControlGlobals.nCreatedPerAction,u=c.length,h=0;for(;h<u;){let f=c[h];f.userData.createdTime===void 0&&(f.userData.createdTime=s),f.userData.lifetime===void 0&&f.userData.quantity===void 0||f.userData.lifetime&&s-f.userData.createdTime<f.userData.lifetime||f.userData.quantity&&d[f.userData.actionId]<=f.userData.quantity?(f.userData.velocity&&(f.position.addScaledVector(f.userData.velocity,l/1e3),f.updateMatrix(),i()),h++):(d[f.userData.actionId]>f.userData.quantity&&d[f.userData.actionId]--,c.splice(h,1),f.removeFromParent(),t.sharedGameControlGlobals.rapierWorld&&f.rigidBody?(t.sharedGameControlGlobals.colliderToEntity.delete(f.rigidBody.collider(0).handle),t.sharedGameControlGlobals.rapierWorld.removeRigidBody(f.rigidBody)):(f.bvhGeometry=void 0,t.sharedGameControlGlobals.entitiesWithTransformAnim=t.sharedGameControlGlobals.entitiesWithTransformAnim.filter(p=>p.bvhGeometry!==void 0)),u--,i())}e=h>0?requestAnimationFrame(a):void 0,r=h>0?s:void 0}function o(){D4()?e&&(cancelAnimationFrame(e),e=void 0,r=void 0):n()}return typeof document<"u"&&document.addEventListener("visibilitychange",o),n})();function D4(){return!!document&&document.hidden}var O4=new Xt,aFe=new k,oFe=new k,jW=class{constructor(e,t,r,i,n){this.data=e,this.page=t,this.controlsManager=r,this.shared=i,this.condition=n,this.intervalId=null,this.timeoutIdQueue=[],this.uniqueId=St.generateUUID(),this.dispatch=()=>{if(vi(this.shared,this.condition)===!1)return!1;this.data.delay?this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3)):this.dispatchInner()},this.dispatchFromStart=()=>{if(vi(this.shared,this.condition)===!1)return!1;this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3))},this.dispatchThrottled=wTe(this.dispatch,1e3/this.data.creationSpeed),this.dispatchStart=()=>{this.intervalId===null&&(this.intervalId=window.setInterval(this.dispatch,1e3/this.data.creationSpeed))},this.dispatchStop=()=>{this.intervalId!==null&&(window.clearInterval(this.intervalId),this.intervalId=null)},this.dispatchInner=()=>{this.timeoutIdQueue.shift();let o=new pa(this.object);if(o.playModeVisible=!0,o.expand(),this.data.coordinateSystem!=="world"){let l=this.data.coordinateSystem,c=this.page.scene.find(l);c&&(c.updateMatrixWorldSVD(),o.hiddenMatrix.copy(c.matrixWorldRigid))}o.scale.copy(this.object.scale),o.position.fromArray(this.data.position),o.rotation.fromArray(this.data.rotation),o.updateMatrix(),this.page.add(o);let s=this.controlsManager.sharedGameControlGlobals;s.createdObjects.push(o),s.nCreatedPerAction[this.uniqueId]===void 0?s.nCreatedPerAction[this.uniqueId]=1:s.nCreatedPerAction[this.uniqueId]++,o.updateWorldMatrix(!0,!0),o.traverseObject(this.traverseObjectCB),P4(),this.controlsManager.requestRender()},this.traverseObjectCB=o=>{var d,u,h,f;o.hasNonUniformScale&&o.updateMatrixWorldSVD();let s;if(this.controlsManager.sharedGameControlGlobals.rapierWorld){if(o instanceof ns)if(o.objectForSample){if(o.objectForSample.dataPatched.physics.fusedBody)return;s=o.object}else return o.object.dataPatched.physics.fusedBody===!0&&o.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(o instanceof pa)s=o.object;else if(s=o,(d=s.dataPatched.cloner)==null?void 0:d.hideBase)return!0}else{if(o instanceof ns)return;o instanceof pa?s=o.object:s=o}this.data.destroy==="Time"?o.userData.lifetime=this.data.lifetime*1e3:this.data.destroy==="Quantity"&&(o.userData.quantity=this.data.destroyAfterQuantity,o.userData.actionId=this.uniqueId);let l=new k().fromArray(this.data.velocity),c=s.dataPatched;if(!(c.physics.enabled==="visibility"?!c.visible:!c.physics.enabled)&&(this.controlsManager.sharedGameControlGlobals.rapierWorld?(this.controlsManager.addRigidBody(o,s,{fromCreate:!0,dynamic:this.data.dynamic}),this.data.destroy==="Collision"&&((u=o.rigidBody)==null||u.collider(0).setActiveEvents(1),o.userData.hasCollisionDestroy=!0),o.matrixWorld.decompose(aFe,O4,oFe),l.applyQuaternion(O4),this.data.velocity.some(p=>p!==0)&&this.data.dynamic&&((h=o.rigidBody)==null||h.setLinvel(l.divideScalar(this.controlsManager.pixelsPerMeter),!0))):("geometry"in o.object&&this.controlsManager.addBoundsTree(o),this.data.velocity.some(p=>p!==0)&&this.data.dynamic&&(o.userData.velocity=l)),((f=s.dataPatched.physics)==null?void 0:f.fusedBody)===!0))return!0};let a=this.page.scene.find(this.data.object);if(!a)throw new Error("Missing Property");if(this.object=a,this.data.coordinateSystem!=="world"&&!this.page.scene.find(this.data.coordinateSystem))throw new Error("Missing Property");P4(r)}dispose(){this.intervalId!==null&&(window.clearInterval(this.intervalId),this.intervalId=null),this.timeoutIdQueue.forEach(e=>window.clearTimeout(e)),this.dispatchThrottled.cancel(),this.page.remove(...this.controlsManager.sharedGameControlGlobals.createdObjects),this.controlsManager.sharedGameControlGlobals.createdObjects=[]}},VW=200,v_=.02,g_=.3,sFe=65;new k;var R4=new k,I4=new k,lFe=new k,wa=new k,Ba=new k,zc=new k,y_=new it,z4=new it,cFe=new it;new it;var Yo=new Xt,Al=new Xt,Ds=new vn(0,0,0,"YXZ"),dFe=new k(1,0,0),Xo=new k(0,1,0),uFe=new k(0,0,1),k4=new k(1,1,1);new Za;var hFe=1,fFe=.025,pFe=16e-6,L4=12,mFe=20,Mn=new zo,yo=new Zi,vFe={type:"requestRender"},gFe={type:"updateMatrix"},B4=Math.PI/6,SE=class extends aa{constructor(e,t,r,i,n,a,o,s,l){var p;super(),this.object=e,this.domElement=t,this.data=r,this.gloabalPhysics=i,this.controlsManager=n,this.cameraFollow=a,this.camera=o,this.page=s,this.sharedAssets=l,this.enableDamping=!0,this.hiddenMatrix0=new it,this.target0=new k,this.zoom0=1,this.rotForce=1,this.moveForce=1,this.pixelsPerMeter=VW,this.euler0=new vn(0,0,0,"YXZ"),this.position0Cam=new k,this.quat0Cam=new Xt,this.scale0Cam=new k,this.hiddenMatrix0Cam=new it,this.threshEndTranslate=.01,this.threshEndRotate=1e-8,this.threshEndRotVel=.005,this.collider={type:"capsule",radius:40,segment:new zo(new k(0,-40,0),new k(0,40,0)),matrix:new it,position:new k,rotation:new Xt},this.euler=new vn(0,0,0,"YXZ"),this.eulerDelta=new k,this.lastPosition=new k,this.lastCameraQuaternion=new Xt,this.lastCameraPosition=new k,this.PI_2=Math.PI/2,this.prevMouse=new ye,this.velocityTarget=new k,this.velocity=new k,this.directionXZ=new k,this.rotVelocityStick=new k,this.rotVelocityTarget=new k,this.rotVelocity=new k,this.rotDirection=new k,this.nonColliderRotOffset=new it,this.nonColliderPosOffset=new it,this.firstPointerId=-1,this.rot=new k,this.path=[],this.movementState={moveNegZ:0,movePosZ:0,moveNegX:0,movePosX:0,moveNegY:0,movePosY:0,rotPosX:0,rotNegX:0,rotPosY:0,rotNegY:0,jump:0,run:0},this.vrEulerYOffset=0,this.onObject=!1,this.actionState={},this.keyAssignments=[["moveNegZ","W"],["moveNegX","A"],["movePosZ","S"],["movePosX","D"],["rotPosX","ArrowUp"],["rotPosY","ArrowLeft"],["rotNegX","ArrowDown"],["rotNegY","ArrowRight"],["jump"," "]],this.collisionEnabled=!0,this.offsetMatrix=new it,this.objectToTarget=new k,this.objectToTarget0=new k,this.objectToCamXZ=new k,this.objectToCamXZ0=new k,this.targetToCamera=new k,this.targetToCamera0=new k,this.cameraPolarAxis0=new k,this.targetPos=new k,this.targetQuat=new Xt,this.lerpFactorPos=new k().setScalar(.3),this.lerpFactorPosStart=.3,this.lerpFactorPosEnd=.3,this.lerpFactorRotStart=.3,this.lerpFactorRotEnd=.3,this.lerpFactorPosCamera=.3,this.lerpFactorRotCamera=.3,this.objXZQuat=new Xt,this.objXZQuatInv=new Xt,this.objXZRotMat=new it,this.isFirstPerson=!1,this.didHit=!1,this.groundVelocity=new k,this.pushedVelocity=new k,this.groundYRotation=0,this.objectRealQuat=new Xt,this.colliderWorldQuat=new Xt,this.groundNormal=new k,this.groundTilt=new Xt,this.groundTiltInv=new Xt,this.lastHitObj=null,this.isFirstFrame=!0,this.rotationAccumWhenOrientWithCamera=0,this.navMeshPathDest=null,this.position=new k,this.quaternion=new Xt,this.scale=new k,this.initialAction=!0,this.onPointerDown=v=>{var m;!(v.target===this.domElement||v.target instanceof HTMLElement&&v.target.tagName==="SPLINE-VIEWER"&&((m=v.target.shadowRoot)!=null&&m.contains(this.domElement)))||this.firstPointerId!==-1||(this.firstPointerId=v.pointerId,this.domElement.ownerDocument.addEventListener("pointermove",this.onPointerMove),this.domElement.ownerDocument.addEventListener("pointerup",this.onPointerUp),this.rotBy!=="keys"&&!lo&&!fk&&this.domElement.requestPointerLock(),this.prevMouse.set(v.clientX,v.clientY))},this.onPointerUp=v=>{this.firstPointerId=-1,this.domElement.ownerDocument.removeEventListener("pointermove",this.onPointerMove),this.domElement.ownerDocument.removeEventListener("pointerup",this.onPointerUp),v.pointerType==="mouse"&&this.domElement.ownerDocument.exitPointerLock()},this.onPointerMove=v=>{if(v.pointerId!==this.firstPointerId)return;let m=v.clientX-this.prevMouse.x,g=v.clientY-this.prevMouse.y;this.prevMouse.set(v.clientX,v.clientY),v.pointerType==="mouse"&&this.rotBy!=="keys"&&(fk&&OTe<15.5&&!lo?(this.eulerDelta.y=-m*this.mouseOrbitSensitivity,this.eulerDelta.x=-g*this.mouseOrbitSensitivity):(this.eulerDelta.y=-v.movementX*this.mouseOrbitSensitivity,this.eulerDelta.x=-v.movementY*this.mouseOrbitSensitivity)),v.pointerType!=="mouse"&&this.rotByTouch==="drag"&&(this.eulerDelta.y=-m*this.mouseOrbitSensitivity*5,this.eulerDelta.x=-g*this.mouseOrbitSensitivity*5),this.controlsManager.requestRender()},this.onPointerlockChange=v=>{this.domElement.ownerDocument.pointerLockElement===this.domElement?SE.isLocked=!0:SE.isLocked=!1},this.onPointerlockError=()=>{console.error("SPE.GameControls: Unable to use Pointer Lock API")},this.handleVisibilityChange=()=>{if(document!=null&&document.hidden)for(let v in this.movementState)this.movementState[v]=0},this.onKeyDown=v=>{!(v.target instanceof HTMLInputElement)&&(v.code==="ArrowLeft"||v.code==="ArrowUp"||v.code==="ArrowRight"||v.code==="ArrowDown"||v.code==="Space")&&v.preventDefault();for(let m of this.keyAssignments)if(v.key.toUpperCase()===m[1]||v.key===m[1]){this.movementState[m[0]]=1;break}this.controlsManager.requestRender()},this.onKeyUp=v=>{for(let m of this.keyAssignments)if(v.key.toUpperCase()===m[1]||v.key===m[1]||v.code.slice(3,v.code.length).toUpperCase()===m[1]){this.movementState[m[0]]=0;break}},this.copyVRGamePadValues=(v,m)=>{for(let g=2;g<4;g++){let y=v.axes[g];m===0?g===2?this.movementState.movePosX=y:this.movementState.movePosZ=y:(v.buttons[3].pressed?this.movementState.jump=1:this.movementState.jump=0,g===2?(Math.abs(this.movementState.rotPosY)<.3&&Math.abs(y)>=.3&&(this.vrEulerYOffset+=y<0?1:-1),this.movementState.rotPosY=y):this.moveMode==="fly"&&(this.movementState.moveNegY=y))}},this.sharedGameControlGlobals=n.sharedGameControlGlobals,e===o&&(this.isFirstPerson=!0),this.hiddenMatrix0.copy(this.object.hiddenMatrix),this.object.parent?this.object.hiddenMatrix.copy(this.object.parent.matrixWorld).invert():this.object.hiddenMatrix.identity(),this.object.matrix.copy(this.object.matrixWorld),this.object.matrix.decompose(this.position,this.quaternion,this.scale),this.euler0.setFromQuaternion(this.quaternion,"YXZ");let c=this.euler0.clone(),d=c.y;if(this.objectRealQuat.copy(this.quaternion),c.y=0,this.quaternion.setFromEuler(c),this.objXZQuat.copy(this.quaternion),this.objXZQuatInv.copy(this.objXZQuat).invert(),this.objXZRotMat.makeRotationFromQuaternion(this.quaternion),c.set(0,d,0),this.quaternion.setFromEuler(c),this.rot.setFromEuler(c),this.object.matrixAutoUpdate=!1,(this.isFirstPerson||this.cameraFollow===!0)&&(this.target0.copy(this.camera.getTarget()),this.zoom0=this.camera.zoom),this.cameraFollow===!0){this.position0Cam.copy(this.camera.position),this.quat0Cam.copy(this.camera.quaternion),this.scale0Cam.copy(this.camera.scale),this.hiddenMatrix0Cam.copy(this.camera.hiddenMatrix),this.camera.parent?(this.camera.hiddenMatrix.copy((p=this.camera)==null?void 0:p.parent.matrixWorld),this.camera.matrix.copy(this.camera.matrixWorld)):this.camera.hiddenMatrix.identity(),this.camera.matrix.copy(this.camera.matrixWorld),this.camera.matrix.decompose(this.camera.position,this.camera.quaternion,this.camera.scale),this.camera.matrixAutoUpdate=!1,this.offsetMatrix.copy(this.object.matrix).invert().multiply(this.camera.matrix);let v=new k(0,0,-1).applyQuaternion(this.camera.quaternion),m=new k().subVectors(this.position,this.camera.position);this.objectToCamXZ.copy(m),this.objectToCamXZ.y=0,this.objectToCamXZ0.copy(this.objectToCamXZ);let g,y;Math.abs(v.y)<1e-6?(m.y=0,v.y=0,y=m.projectOnVector(v)):m.y/v.y>0?y=v.multiplyScalar(m.y/v.y):y=v.multiplyScalar(m.length()),this.targetToCamera0.copy(y).negate(),g=this.camera.position.clone().add(y),this.objectToTarget0.subVectors(g,this.position);let b=new vn().setFromQuaternion(this.camera.quaternion,"YXZ");this.cameraPolarOffset=-b.x,b.x=0,b.z=0,b.y-=Math.PI/2,this.cameraPolarAxis0.set(0,0,-1).applyEuler(b)}if(this.object instanceof va&&(this.object.matrixAutoUpdate=!1),this.euler.setFromQuaternion(this.quaternion,"YXZ"),this.rotByTouch=r.rotByTouch??"joystick",this.rotBy=r.rotBy??"keys",this.rotationMode=r.rotationMode??"normal",this.moveMode=r.moveMode??"walk",this.collisionEnabled=r.collisionEnabled,this.speedTranslate=(r.speedTranslate??250)*hFe,this.speedOrbit=(r.speedRotate??100)*fFe,this.mouseOrbitSensitivity=(r.speedRotate??100)*pFe,this.keyAssignments=r.keyAssignments.map(v=>{let m=[v[0],v[1]];return m[1]==="▲"?m[1]="ArrowUp":m[1]==="◀"?m[1]="ArrowLeft":m[1]==="▼"?m[1]="ArrowDown":m[1]==="▶"?m[1]="ArrowRight":m[1]==="⇧"?m[1]="Shift":m[1]==="↵"?m[1]="Enter":m[1]==="Space"?m[1]=" ":m[1]==="⌘"?m[1]="Meta":m[1]==="Ctrl"?m[1]="Control":m[1]==="Esc"&&(m[1]="Escape"),m}),r.rotBy==="mouse"){let v;v=this.keyAssignments.findIndex(m=>m[0]==="rotNegX"),v!==-1&&(this.keyAssignments[v][1]=""),v=this.keyAssignments.findIndex(m=>m[0]==="rotPosX"),v!==-1&&(this.keyAssignments[v][1]=""),v=this.keyAssignments.findIndex(m=>m[0]==="rotPosY"),v!==-1&&(this.keyAssignments[v][1]=""),v=this.keyAssignments.findIndex(m=>m[0]==="rotNegY"),v!==-1&&(this.keyAssignments[v][1]="")}this.lerpFactorPosStart=1-.02**(1/((r.delayPos[0]??.3)*60)),this.lerpFactorPosEnd=1-.02**(1/((r.delayPos[1]??.3)*60)),this.lerpFactorPos.setScalar(this.lerpFactorPosStart),this.lerpFactorRotStart=1-.02**(1/((r.delayRot[0]??.3)*60)),this.lerpFactorRotEnd=1-.02**(1/((r.delayRot[1]??.3)*60)),this.lerpFactorPosCamera=1-.02**(1/((r.delayPosCamera??.3)*60)),this.lerpFactorRotCamera=1-.02**(1/((r.delayRotCamera??.3)*60)),this.gravity=(this.gloabalPhysics.gravity??_p.defaultData.gravity)*L4,this.usePhysics=this.gloabalPhysics.usePhysics??_p.defaultData.usePhysics,this.jumpPower=r.jumpPower*mFe,this.resetYPosition=this.position.y+Math.abs(r.resetYPosition)*(this.gravity>0?1:-1),this.alignToGround=r.alignToGround??!1,this.orientMode=r.autoOrientMove?r.orientMode:"none",this.orientWith=r.orientWith??Wx.defaultDataThirdPerson.orientWith,this.slopeThresh=sFe*Math.PI/180,r.collider.type==="capsule"?(this.collider.radius=r.collider.radius,this.collider.segment.start.y=r.collider.height/2-r.collider.radius,this.collider.segment.end.y=-this.collider.segment.start.y,this.offset=r.collider.height*v_/this.pixelsPerMeter,this.stepThresh=r.collider.height*g_/this.pixelsPerMeter,this.colliderHeight=r.collider.height):r.collider.type==="sphere"?(this.collider.radius=r.collider.radius,this.collider.segment.start.y=0,this.collider.segment.end.y=0,this.offset=2*r.collider.radius*v_/this.pixelsPerMeter,this.stepThresh=2*r.collider.radius*g_/this.pixelsPerMeter,this.colliderHeight=r.collider.radius*2):(this.offset=r.collider.height*v_/this.pixelsPerMeter,this.stepThresh=r.collider.height*g_/this.pixelsPerMeter,this.colliderHeight=r.collider.height),this.collider.type=r.collider.type;let u=new k().fromArray(r.collider.position),h=new Xt().setFromEuler(new vn().fromArray([...r.collider.rotation,"XYZ"]));this.collider.position.copy(u).multiply(this.scale),this.collider.rotation.copy(h),this.collider.matrix.compose(u,h,k4),r.cameraXAxis!==void 0&&(this.cameraXAxis=r.cameraXAxis,this.cameraYAxis=r.cameraYAxis,this.minPolarAngle=r.cameraRotXLimits[0],this.maxPolarAngle=r.cameraRotXLimits[1],this.minAzimuthAngleRel=r.cameraRotYLimits[0],this.maxAzimuthAngleRel=r.cameraRotYLimits[1]),this.forwardDir=r.forwardDirection??"-z",this.isFirstPerson&&(this.forwardDir="-z"),this.runMultiplier=r.runMultiplier??2;let f=r.navmesh.destinationHelperRadius*2;if(f>0){let v=new Dt;v.push({fi:0,data:{...Tn.defaultData("light","phong"),alpha:0},id:"layer1"}),v.push({fi:0,data:{...Tn.defaultData("color"),color:r.navmesh.destinationHelperColor,alpha:r.navmesh.destinationHelperColor.a},id:"layer2"});let m=new iD({layers:v},{scene:this.page.scene,shared:this.sharedAssets});this.navMeshPathDest=new Di(w8.create({parameters:{width:f,height:f/10,hollow:.7}}),m),this.navMeshPathDest.material.userData.opacity0=r.navmesh.destinationHelperColor.a}this.activate()}reset(e=!1){if(this.object.hiddenMatrix.copy(this.hiddenMatrix0),e){this.object.updateMatrix(),this.object.updateMatrixWorld(),this.object.matrix.copy(this.object.matrixWorld),this.object.matrix.decompose(this.position,this.quaternion,this.scale),this.object.parent?this.object.hiddenMatrix.copy(this.object.parent.matrixWorld).invert():this.object.hiddenMatrix.identity();let t=new vn().setFromQuaternion(this.quaternion,"YXZ"),r=t.y;this.objectRealQuat.copy(this.quaternion),t.y=0,this.quaternion.setFromEuler(t),this.objXZQuat.copy(this.quaternion),this.objXZQuatInv.copy(this.objXZQuat).invert(),this.objXZRotMat.makeRotationFromQuaternion(this.quaternion),t.set(0,r,0),this.quaternion.setFromEuler(t),this.rot.setFromEuler(t),this.euler.setFromQuaternion(this.quaternion,"YXZ"),this.velocityTarget.set(0,0,0),this.velocity.set(0,0,0)}else this.object instanceof va?this.object.matrixAutoUpdate=!0:this.object.updateMatrix();this.cameraFollow===!0&&(this.camera.quaternion.copy(this.quat0Cam),this.camera.position.copy(this.position0Cam),this.camera.scale.copy(this.scale0Cam),this.camera.hiddenMatrix.copy(this.hiddenMatrix0Cam),this.camera.matrixAutoUpdate=!0),this.controlsManager.requestRender()}activate(){this.instantiateActions(),this.domElement.ownerDocument.addEventListener("pointerdown",this.onPointerDown),this.domElement.ownerDocument.addEventListener("keydown",this.onKeyDown),this.domElement.ownerDocument.addEventListener("keyup",this.onKeyUp),this.domElement.ownerDocument.addEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.addEventListener("pointerlockerror",this.onPointerlockError),this.domElement.ownerDocument.addEventListener("visibilitychange",this.handleVisibilityChange)}deactivate(){this.disposeActions(),this.domElement.ownerDocument.removeEventListener("pointerdown",this.onPointerDown),this.domElement.ownerDocument.removeEventListener("keydown",this.onKeyDown),this.domElement.ownerDocument.removeEventListener("keyup",this.onKeyUp),this.domElement.ownerDocument.removeEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.removeEventListener("pointerlockerror",this.onPointerlockError),this.domElement.ownerDocument.removeEventListener("visibilitychange",this.handleVisibilityChange)}dispose(){var e;this.deactivate(),(e=this.navMeshPathDest)!=null&&e.parent&&this.page.remove(this.navMeshPathDest)}instantiateActions(){let e=this.data,t=this.sharedAssets;e.gameActions!==void 0&&(this.actions={},Hx.list.forEach(r=>{this.actions[r]=Hn({...e,disabled:!1,type:"GameControl"},e.gameActions[r],this.page,t,this.controlsManager.eventManager,this.object)})),this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.dispatchStopEvent("jump"),this.dispatchStartEvent("idle"),this.initialAction&&(this.initialAction=!1)}disposeActions(){this.initialAction=!1,this.dispatchStopEvent("idle"),this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.dispatchStopEvent("jump"),Fn(this.actions.idle),Fn(this.actions.move),Fn(this.actions.run),Fn(this.actions.jump)}dispatchStartEvent(e){this.actions[e]!==void 0&&(this.actionState[e]||(this.actionState[e]=!0,this.actions[e].Transition.forEach(t=>{t.play()}),this.actions[e].Animation.forEach(t=>{t.play(this.initialAction===!1)}),this.actions[e].Create.forEach(t=>{t.dispatchStart()}),this.actions[e].Audio.forEach(t=>{t.dispatchGameControl("start")}),this.actions[e].Particles.forEach(t=>{t.dispatchGameControl("start")})))}dispatchStopEvent(e){this.actions[e]!==void 0&&(!this.actionState[e]||(this.actionState[e]=!1,this.actions[e].Transition.forEach(t=>{t.stop(),t.object.currentState!==null&&t.object.changeSelectedState(null,{scene:this.page.scene,shared:this.sharedAssets})}),this.actions[e].Create.forEach(t=>{t.dispatchStop()}),this.actions[e].Audio.forEach(t=>{t.dispatchGameControl("stop")}),this.actions[e].Particles.forEach(t=>{t.dispatchGameControl("stop")})))}get colliderWorldPosition(){return wa.copy(this.collider.position).applyQuaternion(this.objectRealQuat).add(this.position)}update(e,t,r){var s,l,c,d,u,h,f,p,v;if(this.gravity<0?this.position.y<this.resetYPosition:this.position.y>this.resetYPosition)return this.reset(!0),!0;this.sharedGameControlGlobals.gamePads.forEach(this.copyVRGamePadValues);let i=(this.isFirstFrame?16.6:e)/1e3;this.isFirstFrame&&(this.isFirstFrame=!1);let n=i*60,a=!1;if(this.usePhysics&&this.collisionEnabled){let m=Ba.set(0,(this.velocity.y===0?this.pixelsPerMeter*Math.max(Math.abs(this.gravity)/(10*L4),1)*(this.gravity>0?1:-1):this.velocity.y)*i,0).divideScalar(this.pixelsPerMeter),g=this.sharedGameControlGlobals.rapierWorld.castShape(this.colliderWorldPosition.divideScalar(this.pixelsPerMeter),this.colliderWorldQuat,m,(s=this.object.rigidBody)==null?void 0:s.collider(0).shape,1,!1,16,void 0,void 0,this.object.rigidBody);if(g){this.onObject=!0,this.groundNormal.set(g.normal2.x,g.normal2.y,g.normal2.z).applyQuaternion(this.colliderWorldQuat).negate(),this.alignToGround&&this.groundTiltAdjustment(this.groundNormal),Math.acos(this.groundNormal.y)<this.slopeThresh&&(a=!0),((l=g.collider.parent())==null?void 0:l.bodyType())===0&&Math.acos(this.groundNormal.y)*(180/Math.PI)>45&&(this.onObject=!1);let y=g.collider.parent();this.groundYRotation=0,this.groundVelocity.set(0,0,0);for(let b of this.sharedGameControlGlobals.entitiesWithTransformAnim)if(b.rigidBody===y&&b.userData.isFollowingObj!==this.object.uuid){(b.hasNonUniformScale?b.matrixWorldRigid:b.matrixWorld).decompose(wa,Al,Ba),this.groundVelocity.subVectors(wa,b.prevT),this.object.getWorldPosition(Ba).add(this.collider.position).sub(wa),this.groundYRotation=Ds.setFromQuaternion(Al).y-b.prevR.y,zc.copy(Ba).applyAxisAngle(Xo,this.groundYRotation),this.groundVelocity.add(zc.sub(Ba)).divideScalar(i);break}}else this.onObject=!1}if(this.moveMode==="walk"&&this.collisionEnabled&&(this.movementState.jump===1&&this.onObject&&(this.velocityTarget.y=this.jumpPower,this.movementState.jump=0,this.dispatchStopEvent("idle"),this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.dispatchStopEvent("jump"),this.dispatchStartEvent("jump"),this.onObject=!1),this.onObject?this.velocityTarget.y/=2:this.velocityTarget.y+=this.gravity*n),this.moveMode==="fly"&&(this.velocityTarget.y=(this.movementState.movePosY-this.movementState.moveNegY)*this.speedTranslate),this.directionXZ.z=this.movementState.movePosZ-this.movementState.moveNegZ,this.directionXZ.x=this.movementState.movePosX-this.movementState.moveNegX,this.forwardDir==="+z"&&this.directionXZ.multiplyScalar(-1),this.directionXZ.manhattanLength()>0&&(this.path=[]),this.navMeshPathDest){let m=this.navMeshPathDest.material;if(this.moveMode==="walk"&&this.path.length>1){this.navMeshPathDest.position.copy(this.path[this.path.length-1]),this.navMeshPathDest.parent||this.page.add(this.navMeshPathDest);let g=wa.subVectors(this.path[1],this.position),y=Ba.subVectors(this.path[1],this.path[0]);g.dot(y)<0?this.path.shift():(this.directionXZ.x=y.x,this.directionXZ.z=y.z),m.opacity=m.userData.opacity0}else m.opacity-=.05*m.userData.opacity0,this.navMeshPathDest.material.opacity<=0&&this.navMeshPathDest.parent&&this.page.remove(this.navMeshPathDest)}this.directionXZ.normalize(),this.movementState.run?this.moveForce=this.runMultiplier:this.moveForce=1,this.velocityTarget.z=this.directionXZ.z*this.speedTranslate*this.moveForce,this.velocityTarget.x=this.directionXZ.x*this.speedTranslate*this.moveForce,(this.moveMode==="walk"?this.velocityTarget.x+this.velocityTarget.z===0:this.velocityTarget.manhattanLength()===0)?this.lerpFactorPos.setScalar(this.lerpFactorPosEnd):this.lerpFactorPos.setScalar(this.lerpFactorPosStart),this.moveMode==="walk"&&(this.lerpFactorPos.y=1),this.didHit===!1&&this.pushedVelocity.manhattanLength()===0||this.usePhysics===!1?(this.velocity.x+=(this.velocityTarget.x-this.velocity.x)*(1-(1-this.lerpFactorPos.x)**n),this.velocity.y+=(this.velocityTarget.y-this.velocity.y)*(1-(1-this.lerpFactorPos.y)**n),this.velocity.z+=(this.velocityTarget.z-this.velocity.z)*(1-(1-this.lerpFactorPos.z)**n)):this.velocity.copy(this.velocityTarget),(this.moveMode==="walk"?this.velocity.x**2+this.velocity.z**2<this.speedTranslate:this.velocity.lengthSq()<this.speedTranslate)?(this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.onObject&&(this.dispatchStopEvent("jump"),this.dispatchStartEvent("idle"))):(this.dispatchStopEvent("idle"),this.onObject&&(this.dispatchStopEvent("jump"),this.movementState.run?(this.dispatchStopEvent("move"),this.dispatchStartEvent("run")):(this.dispatchStopEvent("run"),this.dispatchStartEvent("move"))));let o=lFe.copy(this.velocity);if(this.orientMode!=="none"&&this.isFirstPerson===!1){let m=Ba.copy(o);m.y=0,o.set(0,o.y,m.length()*(this.forwardDir==="+z"?1:-1))}if(this.directionXZ.manhattanLength()>0&&this.orientMode!=="none"&&this.isFirstPerson===!1)if(this.orientWith==="camera"&&this.path.length<=1){let m=wa;this.camera.getWorldDirection(m);let g=zc.copy(Xo).multiplyScalar(m.dot(Xo));m.sub(g);let y=Ba.copy(this.directionXZ);y.x*=-1,this.rot.y=m.angleTo(y)*(m.cross(y).y>0?-1:1)+this.rotationAccumWhenOrientWithCamera}else this.rot.y=(this.path.length>1?0:this.euler.y)+Math.atan2(-this.directionXZ.z,this.directionXZ.x)+Math.PI/2*(this.forwardDir==="+z"?1:-1);if(Ds.setFromVector3(this.rot),this.moveMode==="walk"&&(Ds.x=0),o.applyEuler(Ds),a&&(Al.setFromUnitVectors(Xo,this.groundNormal),o.applyQuaternion(Al)),r){let m=Ds.set(0,this.vrEulerYOffset*B4,0);r.applyEuler(m),o.x+=r.x,o.z+=r.z,this.nonColliderPosOffset.elements[13]+=r.y*i}if(this.usePhysics===!0){let m=Ba;this.pushedVelocity.set(0,0,0);for(let g of this.sharedGameControlGlobals.entitiesWithTransformAnim){let y=zc.setFromMatrixPosition(g.matrixWorld).sub(g.prevT).divideScalar(i).divideScalar(this.pixelsPerMeter),b=g.rigidBody.collider(0).castCollider(y,this.object.rigidBody.collider(0),wa.copy(o).divideScalar(this.pixelsPerMeter),i,!1);y.multiplyScalar(this.pixelsPerMeter);let x=Cr.is(g)?g:g.object;if(b!==null&&this.lastHitObj!==x){let S;g instanceof pa&&(S=g);let w=this.sharedGameControlGlobals.entityToCollisionEvents[x.uuid];if(w)for(let _ of w)_.data.target==="character"&&(_.dispatch(S),x.dispatchEvent(_E));this.lastHitObj=x}if(b!==null){this.pushedVelocity.copy(y),m.copy(b.normal1).applyQuaternion(g.quaternion);break}}if(this.pushedVelocity.manhattanLength()!==0){let g=m.dot(o);g<0&&o.addScaledVector(m,-g),o.add(this.pushedVelocity)}else o.add(this.groundVelocity)}if(this.rotDirection.y=Number(this.movementState.rotPosY)-Number(this.movementState.rotNegY),this.rotDirection.x=Number(this.movementState.rotPosX)-Number(this.movementState.rotNegX),this.rotDirection.normalize(),this.rotationMode==="normal"&&(this.movementState.rotPosX||this.movementState.rotNegX)||this.rotationMode==="steer"&&(this.movementState.rotPosX||this.movementState.rotNegX)&&(this.movementState.movePosZ||this.movementState.moveNegZ||this.moveMode==="walk")?this.rotVelocityStick.x=-this.rotDirection.x*this.speedOrbit*this.rotForce:this.rotVelocityStick.x=0,this.rotationMode==="normal"&&(this.movementState.rotPosY||this.movementState.rotNegY)||this.rotationMode==="steer"&&(this.movementState.rotPosY||this.movementState.rotNegY)&&(this.movementState.movePosZ||this.movementState.moveNegZ)?this.rotVelocityStick.y=-this.rotDirection.y*this.speedOrbit*this.rotForce:this.rotVelocityStick.y=0,this.rotVelocityTarget.subVectors(this.eulerDelta.divideScalar(i),this.rotVelocityStick),this.rotVelocityTarget.manhattanLength()===0?this.rotVelocity.lerp(this.rotVelocityTarget,1-(1-this.lerpFactorRotEnd)**n):this.rotVelocity.lerp(this.rotVelocityTarget,1-(1-this.lerpFactorRotStart)**n),this.euler.x+=this.rotVelocity.x*i,this.euler.y+=this.rotVelocity.y*i+this.groundYRotation,this.rotVelocityTarget.y===0&&this.directionXZ.manhattanLength()===0?this.rotationAccumWhenOrientWithCamera=0:(this.cameraFollow===!1||this.cameraYAxis==="Locked")&&(this.rotationAccumWhenOrientWithCamera+=this.rotVelocity.y*i),this.isFirstPerson===!1&&this.orientMode!=="none"&&this.directionXZ.manhattanLength()>0){if(this.orientMode==="radial"){this.objectToCamXZ.copy(this.objectToCamXZ0).applyAxisAngle(Xo,this.euler.y-this.euler0.y);let m=Ba.copy(this.objectToCamXZ).normalize(),g=zc.copy(o).multiplyScalar(i);g.y=0;let y=g.sub(wa.copy(m).multiplyScalar(g.dot(m))).cross(m).y;this.euler.y-=Math.atan2(y,this.objectToCamXZ.length())}}else this.rot.y+=this.rotVelocity.y*i+this.groundYRotation,this.rotVelocityTarget.y!==0&&(this.cameraFollow===!1||this.cameraYAxis==="Locked")&&(this.euler.y=this.rot.y);if(this.cameraFollow===!0&&(this.moveMode==="walk"?this.cameraXAxis==="Limit"?this.euler.x=St.clamp(this.euler.x,-this.maxPolarAngle+this.cameraPolarOffset+1e-6,-this.minPolarAngle+this.cameraPolarOffset-1e-6):this.euler.x=St.clamp(this.euler.x,-this.PI_2+this.cameraPolarOffset,this.PI_2+this.cameraPolarOffset):this.cameraXAxis==="Limit"&&(this.euler.x=St.clamp(this.euler.x,-this.PI_2,this.PI_2))),this.moveMode==="fly"?this.rot.x=this.euler.x:this.isFirstPerson&&(t?(Ds.copy(t),Ds.y=0):(Ds.copy(this.euler),Ds.y=0),this.nonColliderRotOffset.makeRotationFromEuler(Ds)),t&&(this.moveMode==="walk"?(this.rot.y=t.y,this.rot.x=0,this.rot.z=0):this.rot.setFromEuler(t),this.rot.y+=this.vrEulerYOffset*B4),Yo.setFromAxisAngle(dFe,this.rot.x),Al.setFromAxisAngle(Xo,this.rot.y),Al.multiply(Yo),Yo.setFromAxisAngle(uFe,this.rot.z),Al.multiply(Yo),this.quaternion.copy(Al),this.objectRealQuat.multiplyQuaternions(this.quaternion,this.objXZQuat),this.colliderWorldQuat.copy(this.objectRealQuat).multiply(this.collider.rotation),this.collisionEnabled)if(this.usePhysics){let m=Ba.copy(o).multiplyScalar(i/this.pixelsPerMeter),g=null;this.didHit=!1;let y=new k;for(let b=0;b<5;b++){let x=m.length(),S=zc.copy(m).normalize();if(g=this.sharedGameControlGlobals.rapierWorld.castShape(this.colliderWorldPosition.divideScalar(this.pixelsPerMeter).add(y),this.colliderWorldQuat,S,(c=this.object.rigidBody)==null?void 0:c.collider(0).shape,x,!1,24,void 0,void 0,this.object.rigidBody),g!==null){this.didHit=!0;let w=this.sharedGameControlGlobals.colliderToEntity.get(g.collider.handle);if(w!==this.lastHitObj&&b===0){this.lastHitObj=w;let M=this.sharedGameControlGlobals.entityToCollisionEvents[w==null?void 0:w.uuid];if(M){for(let P of M)if(P.data.target==="character"){let T=((d=this.sharedGameControlGlobals.rapierWorld)==null?void 0:d.getCollider(g.collider.handle))._parent,R;if(w.cloner){for(let z of w.cloner.children)if(z.rigidBody===T){R=z;break}}P.dispatch(R),w.dispatchEvent(_E)}}}let _=R4.set(g.normal2.x,g.normal2.y,g.normal2.z).applyQuaternion(this.colliderWorldQuat),C=I4.copy(S).multiplyScalar(g.toi).dot(_),A=g.toi;if(A===0&&(this.position.y+=this.offset*this.pixelsPerMeter),C>this.offset&&(A=g.toi*(C-this.offset)/C,y.addScaledVector(S,A)),m.copy(S).multiplyScalar(x-A),Math.acos(-_.y)>this.slopeThresh){let M=this.colliderWorldPosition.divideScalar(this.pixelsPerMeter).add(y),P=zc.copy(g.witness2).applyQuaternion(this.colliderWorldQuat);P.y=0;let T=M.add(P);T.y+=this.stepThresh;let R=this.sharedGameControlGlobals.rapierWorld.castShape(T,this.colliderWorldQuat,m,(u=this.object.rigidBody)==null?void 0:u.collider(0).shape,1,!1,24,void 0,void 0,this.object.rigidBody);R!==null&&R.toi===0&&(_.y=0,_.normalize())}m.addScaledVector(_,-m.dot(_))}else{b===0&&this.directionXZ.manhattanLength()!==0&&(this.lastHitObj=null),y.add(m);break}}this.position.addScaledVector(y,this.pixelsPerMeter),(h=this.object.rigidBody)==null||h.setTranslation(wa.copy(this.position).divideScalar(this.pixelsPerMeter),!0),(f=this.object.rigidBody)==null||f.setRotation(Yo.copy(this.quaternion).premultiply(this.groundTilt).multiply(this.objXZQuat),!0)}else{let m=this.onObject?1:5,g=o.multiplyScalar(i/m);for(let y=0;y<m;y++)this.position.add(g),this.collisionAdjustment(i/m)}else this.position.addScaledVector(o,i);if(this.moveMode==="walk"&&this.onObject&&(this.velocityTarget.y=0,this.velocity.y=0),this.quaternion.premultiply(this.groundTilt).multiply(this.objXZQuat),this.object.matrix.compose(this.position,this.quaternion,this.scale),this.object.matrixWorldNeedsUpdate=!0,this.object.matrix.multiply(this.nonColliderPosOffset).multiply(this.nonColliderRotOffset),this.quaternion.premultiply(this.groundTiltInv).multiply(this.objXZQuatInv),this.cameraFollow===!0){this.updateFollowArms();let m=this.objectToTarget.add(this.position),g=this.targetToCamera.add(m);y_.lookAt(g,m,Xo).setPosition(g),y_.decompose(this.targetPos,this.targetQuat,wa),this.camera.quaternion.slerp(this.targetQuat,1-(1-this.lerpFactorRotCamera)**n),this.camera.position.lerp(this.targetPos,1-(1-this.lerpFactorPosCamera)**n),this.camera.updateMatrix(),this.camera.updateMatrixWorld(),this.cameraYAxis==="Limit"&&this.orientMode==="cartesian"&&(this.euler.y=St.clamp(this.euler.y,this.minAzimuthAngleRel,this.maxAzimuthAngleRel)),this.euler.x=St.clamp(this.euler.x,-this.PI_2+(this.cameraPolarOffset<0?this.cameraPolarOffset:0),this.PI_2+(this.cameraPolarOffset>0?this.cameraPolarOffset:0))}return this.eulerDelta.set(0,0,0),this.object.dispatchEvent(gFe),this.path.length<2&&this.lastPosition.distanceToSquared(this.position)<this.threshEndTranslate&&Math.abs(this.rotVelocity.x)<this.threshEndRotVel&&Math.abs(this.rotVelocity.y)<this.threshEndRotVel&&(this.camera===void 0||this.isFirstPerson||this.lastCameraPosition.distanceToSquared(this.camera.position)<this.threshEndTranslate&&8*(1-this.lastCameraQuaternion.dot(this.camera.quaternion))<this.threshEndRotate)&&(this.moveMode==="fly"||this.onObject===!0||this.collisionEnabled===!1)&&(this.navMeshPathDest===null||this.navMeshPathDest.material.opacity<-.04*((v=(p=this.navMeshPathDest)==null?void 0:p.material)==null?void 0:v.userData.opacity0))?!1:(this.camera&&(this.lastCameraPosition.copy(this.camera.position),this.lastCameraQuaternion.copy(this.camera.quaternion)),this.lastPosition.copy(this.position),this.object.dispatchEvent(vFe),!0)}updateFollowArms(){this.objectToTarget.copy(this.objectToTarget0),this.targetToCamera.copy(this.targetToCamera0);let e=Yo.setFromAxisAngle(Xo,this.cameraYAxis==="Limit"&&this.orientMode!=="radial"?St.clamp(this.euler.y-this.euler0.y,this.minAzimuthAngleRel,this.maxAzimuthAngleRel):this.euler.y-this.euler0.y);(this.cameraYAxis!=="Locked"||this.orientMode==="radial")&&this.objectToTarget.applyQuaternion(e);let t;this.cameraXAxis==="Limit"?t=St.clamp(this.euler.x,-this.maxPolarAngle+this.cameraPolarOffset+1e-6,-this.minPolarAngle+this.cameraPolarOffset-1e-6):t=St.clamp(this.euler.x,-this.PI_2+this.cameraPolarOffset+1e-6,this.PI_2+this.cameraPolarOffset-1e-6);let r=wa.copy(this.cameraPolarAxis0);(this.cameraYAxis!=="Locked"||this.orientMode==="radial")&&r.applyQuaternion(e);let i=Al.setFromAxisAngle(r,t);this.cameraYAxis!=="Locked"&&this.targetToCamera.applyQuaternion(e),this.cameraXAxis!=="Locked"&&this.targetToCamera.applyQuaternion(i)}groundTiltAdjustment(e){Xo.angleTo(e)*180/Math.PI<15||Xo.angleTo(e)*180/Math.PI>85?Yo.identity():Yo.setFromUnitVectors(Xo,e),this.groundTilt.slerp(Yo,.06),this.groundTiltInv.copy(this.groundTilt).invert()}collisionAdjustment(e){var n;let t=I4.set(0,0,0);this.object.matrix.compose(this.position,this.quaternion,this.scale);let r=y_.multiplyMatrices(this.object.matrix,this.objXZRotMat).multiply(this.collider.matrix).decompose(wa,Yo,Ba).compose(wa,Yo,k4);this.sharedGameControlGlobals.entitiesWithTransformAnim.forEach(a=>{if(a===this.object||a.isDescendantOf(this.object))return;yo.makeEmpty(),a.updateMatrixWorldSVD();let o=a.matrixWorldRigid,s=z4.copy(o).invert(),l=cFe.copy(z4).multiply(r);Mn.copy(this.collider.segment),Mn.start.applyMatrix4(l),Mn.end.applyMatrix4(l);let c=R4.copy(this.position).applyMatrix4(s);yo.expandByPoint(Mn.start),yo.expandByPoint(Mn.end),yo.min.addScalar(-this.collider.radius),yo.max.addScalar(this.collider.radius),a.bvhGeometry.boundsTree.shapecast({traverseBoundsOrder(d){return d.distanceToPoint(Mn.end)},intersectsBounds:d=>d.intersectsBox(yo),intersectsTriangle:d=>{let u=wa,h=Ba,f=d.closestPointToSegment(Mn,u,h);if(f<this.collider.radius){let p=this.collider.radius-f,v=h.sub(u).normalize(),m=zc.copy(c);m.addScaledVector(v,p);let g=m.applyMatrix4(o).sub(this.position);t.add(g),Mn.start.addScaledVector(v,p),Mn.end.addScaledVector(v,p)}}})}),yo.makeEmpty(),Mn.copy(this.collider.segment),Mn.start.applyMatrix4(r),Mn.end.applyMatrix4(r),yo.expandByPoint(Mn.start),yo.expandByPoint(Mn.end),yo.min.addScalar(-this.collider.radius),yo.max.addScalar(this.collider.radius),(n=this.sharedGameControlGlobals.staticMeshBVH)==null||n.shapecast({traverseBoundsOrder(a){return a.distanceToPoint(Mn.end)},intersectsBounds:a=>a.intersectsBox(yo),intersectsTriangle:a=>{let o=wa,s=Ba,l=a.closestPointToSegment(Mn,o,s);if(l<this.collider.radius){let c=this.collider.radius-l,d=s.sub(o).normalize();this.alignToGround&&this.groundTiltAdjustment(d),t.addScaledVector(d,c),Mn.start.addScaledVector(d,c),Mn.end.addScaledVector(d,c)}}}),this.onObject=Math.abs(t.y)>Math.abs(e*this.velocity.y*.25),this.onObject&&this.dispatchStopEvent("jump");let i=Math.max(0,t.length()-1e-5);t.normalize().multiplyScalar(i),this.position.add(t)}},HW=SE;HW.isLocked=!1;var yFe=fc(Z6());function Nl(e,t){let r=new Ot;if(!e.getAttribute("position"))return r.setAttribute("position",new yt([],3)),r.setIndex([]),r;let{positions:i,triIndices:n}=pw(e.getAttribute("position"),e.getIndex());return r.setAttribute("position",new yt(i,3)),r.setIndex(n),t&&r.applyMatrix4(t),r}var bFe=new it,xFe=new it,Os=[[0,0,0],[0,0,0],[0,0,0]];function WW(e){let t=e.elements;Os[0][0]=t[0],Os[0][1]=t[4],Os[0][2]=t[8],Os[1][0]=t[1],Os[1][1]=t[5],Os[1][2]=t[9],Os[2][0]=t[2],Os[2][1]=t[6],Os[2][2]=t[10];let{u:r,v:i}=(0,yFe.SVD)(Os),n=bFe.set(r[0][0],r[0][1],r[0][2],0,r[1][0],r[1][1],r[1][2],0,r[2][0],r[2][1],r[2][2],0,0,0,0,1),a=xFe.set(i[0][0],i[0][1],i[0][2],0,i[1][0],i[1][1],i[1][2],0,i[2][0],i[2][1],i[2][2],0,0,0,0,1);return n.multiply(a.transpose())}var wFe=class extends Wj{constructor(){super(),this.layers.enable(3),this.layers.enable(8)}setFromCamera(e,t){t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,-1).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):t.isPerspectiveCamera?(this.ray.origin.set(e.x,e.y,-1).unproject(t),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):console.error("Raycaster: Unsupported camera type.")}intersectVisibleObjects(e,t=!0,r=[]){return e.forEach(i=>{i.visible&&this.intersectObject(i,t,r)}),r}createRaycastLineHelper(){let e=new Ud({color:65280,linewidth:10}),t=new k(this.ray.origin.x,this.ray.origin.y,this.ray.origin.z),r=new k(this.ray.direction.x,this.ray.direction.y,this.ray.direction.z),i=this.camera.far-this.camera.near,n=new k().addVectors(t,r.multiplyScalar(i)),a=new Ot;return a.setFromPoints([t,n]),new fx(a,e)}},GW=e=>e instanceof Zf||e instanceof Jf;function SFe(e,t){return e.distance-t.distance}function $W(e,t,r){if(!(!Fl(t)||!t.visible)){Jo(t)&&t.raycast(e,r);for(let i of t.children)$W(e,i,r)}}function Db(e,t,r,i=!1){if(!i&&!r.some(a=>l1(e,a)!==void 0))return[];let n=[];return t.children.forEach(a=>$W(e,a,n)),n.sort(SFe),n}function CE(e){let t=[];if(e.length){let r=e[0].object;Fl(r)&&t.push(r);let i=r.parent;for(;i;)GW(i)&&t.push(i),i=i.parent}return t}function Ul(e,t,r,i){let n=e.frame;if(n){let a=t[0]*n.width,o=(1-t[1])*n.height;for(let s of r){let l=s===n.uuid?n:n.find(s);if(l!=null&&l.intersects(a,o))return i(l),!0}}return!1}function l1(e,t){if(Jo(t)){if(t.visible){let r=[];return t.raycast(e,r),r.length?r[0]:void 0}}else if(GW(t))return qW(e,t)}function qW(e,t){if(!(!Fl(t)||!t.visible)){if(Jo(t)){let r=[];if(t.raycast(e,r),r.length)return r[0]}for(let r of t.children){let i=qW(e,r);if(i)return i}}}function CFe(e,t,r){return{x:(e-(r.left+window.scrollX))/r.width*2-1,y:-((t-(r.top+window.scrollY))/r.height)*2+1}}function _Fe(e,t,r){return{x:(e-(r.left+window.scrollX))/r.width,y:1-(t-(r.top+window.scrollY))/r.height}}var AFe=class{constructor(e,t,r,i,n,a,o,s){this.renderer=e,this.publish=t,this.scene=r,this.getCamera=i,this.sharedAssets=n,this.requestRender=a,this.isExport=o,this.frame=s,this.raycaster=new wFe,this._useWindowEvents=!1,this.pointerWorld={x:0,y:0},this.pointerScreen={x:0,y:0},this._useWindowEvents=t.mouseEventTarget==="window",this.domElement=e.domElement,this.eventElement=this._useWindowEvents?window:e.domElement,this._domRect=this.domElement.getBoundingClientRect()}get stopRaycast(){return this.publish.stopRaycast}get page(){return this.scene.activePage}set useWindowEvents(e){this._useWindowEvents=e,this.eventElement=e?window:this.renderer.domElement}get useWindowEvents(){return this._useWindowEvents}set domRect(e){this._domRect=e}get domRect(){return this._domRect}updateRaycaster(e){var i;let{pageX:t,pageY:r}=((i=e.touches)==null?void 0:i.length)>0?e.touches[0]:e;this.pointerWorld=CFe(t,r,this._domRect),this.pointerScreen=_Fe(t,r,this._domRect),this.raycaster.setFromCamera(this.pointerWorld,this.getCamera())}},to=class{constructor(e){this.eventContext=e,this.domEventsNeeded=new Set,this.hasVideoAction=!1}connect(){}disconnect(){}},ID=[["start","Start"],["keyDown","KeyDown"],["keyUp","KeyUp"],["mouseDown","MouseDown"],["mouseUp","MouseUp"],["mouseHover","MouseHover"],["collision","Collision"],["lookAt","LookAt"],["follow","Follow"],["scroll","Scroll"]],YW=e=>{var t;return(t=ID.find(([r,i])=>i===e))==null?void 0:t[0]},a0=e=>{var t;return(t=ID.find(([r])=>r===e))==null?void 0:t[1]},MFe=(e,t)=>{let r=YW(e);if(r){let i=new CustomEvent(r,{bubbles:!0});return Object.defineProperty(i,"target",{writable:!1,value:t}),i}},EFe=class extends to{constructor(){super(...arguments),this.objectsPerEvents=new Map,this.splineEvents={},this.onBeginEvent=e=>{var i;if(!e.eventName||!e.target||e.eventName==="Scroll")return;let t=(i=this.splineEvents[YW(e.eventName)])==null?void 0:i[e.target.uuid];if(!t)return;e.eventName==="Scroll"&&e.deltaY!==void 0&&Object.assign(t,{deltaY:e.deltaY});let{domElement:r}=this.eventContext;r.dispatchEvent(t)}}connect(){let{page:e}=this.eventContext;e.traverseEntity(t=>{var r,i;if((r=t.data)!=null&&r.events.length){for(let[n,a]of ID)if(t.data.events.some(o=>o.data.type===a&&!o.data.disabled)){this.objectsPerEvents.has(n)?(i=this.objectsPerEvents.get(n))==null||i.push(t):this.objectsPerEvents.set(n,[t]);let o={id:t.uuid,name:t.name},s=MFe(a,o),l=this.splineEvents[n];l?l[t.uuid]=s:this.splineEvents[n]={[t.uuid]:s}}}}),this.objectsPerEvents.forEach(t=>{t.forEach(r=>{r.addEventListener("beginEvent",this.onBeginEvent)})})}disconnect(){this.objectsPerEvents.forEach(e=>{e.forEach(t=>{t.removeEventListener("beginEvent",this.onBeginEvent)})})}},TFe=class{constructor(e,t,r,i,n,a){if(this.id=e,this.data=t,this.object=r,this.entered=!1,(t.type==="KeyDown"||t.type==="KeyUp"||t.type==="KeyPress")&&!t.key)throw new Error("Missing property");this.actions=Hn(t,t.actions,i,n,a,r)}disconnect(){Fn(this.actions)}dispatchHeld(e){this.actions.Create.forEach(t=>{e&&t.dispatchThrottled.cancel(),t.dispatchThrottled()})}dispatch(e=!1){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),this.data.type==="MousePress"||this.data.type==="KeyPress"?this.entered||(this.entered=!0,this.actions.Transition.forEach(t=>t.playFromCurrent()),this.actions.Animation.forEach(t=>t.playFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.playFromCurrent()),this.actions.Create.forEach(t=>t.dispatchStart())):(this.actions.Transition.some(t=>t.playing&&t.data.runMode!=="Toggle")||this.actions.Transition.forEach(t=>{t.data.runMode==="Toggle"?t.toggle():t.play()}),this.actions.SwitchCamera.some(t=>t.playing&&t.data.runMode!=="Toggle")||this.actions.SwitchCamera.forEach(t=>{t.data.runMode==="Toggle"?t.toggle():t.play()}),this.actions.Animation.forEach(t=>{t.data.runMode==="Toggle"?t.toggle():t.play()})),this.actions.Link.forEach(t=>{t.dispatch()}),this.actions.SceneTransition.forEach(t=>{t.dispatch()}),e===!1&&this.actions.Create.forEach(t=>{t.dispatch()}),this.actions.Destroy.forEach(t=>{t.dispatch()}),this.actions.Reset.forEach(t=>{t.dispatch()}),this.actions.Audio.forEach(t=>{t.dispatchBasic()}),this.actions.Video.forEach(t=>{t.dispatchBasic()}),this.actions.Particles.forEach(t=>{t.dispatchBasic()}),this.actions.SetVariable.forEach(t=>t.checkConditions()),this.actions.SetVariable.forEach(t=>t.dispatch()),this.actions.DynamicVariablePlay.forEach(t=>t.dispatch()),this.actions.ClearLocalStorage.forEach(t=>t.dispatch()),this.actions.UserAPI.forEach(t=>t.dispatch())}dispatchRelease(){this.entered&&(this.entered=!1,this.actions.Transition.forEach(e=>e.reverseFromCurrent()),this.actions.Particles.forEach(e=>e.reverseFromCurrent()),this.actions.Animation.forEach(e=>e.reverseFromCurrent()),this.actions.SwitchCamera.forEach(e=>e.reverseFromCurrent()),this.actions.Create.forEach(e=>e.dispatchStop()))}dispatchUserEvent(e){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),e?(this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.Animation.forEach(t=>t.reverseFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.reverseFromCurrent())):(this.actions.Transition.forEach(t=>t.playFromCurrent()),this.actions.Animation.forEach(t=>t.playFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.playFromCurrent())),this.actions.Link.forEach(t=>{t.dispatch()}),this.actions.SceneTransition.forEach(t=>{t.dispatch()}),this.actions.Create.forEach(t=>{t.dispatch()}),this.actions.Destroy.forEach(t=>{t.dispatch()}),this.actions.Reset.forEach(t=>{t.dispatch()}),this.actions.Audio.forEach(t=>{t.dispatchBasic()}),this.actions.Video.forEach(t=>{t.dispatchBasic()}),this.actions.Particles.forEach(t=>{t.dispatchBasic()}),this.actions.SetVariable.forEach(t=>t.checkConditions()),this.actions.SetVariable.forEach(t=>t.dispatch()),this.actions.DynamicVariablePlay.forEach(t=>t.dispatch()),this.actions.ClearLocalStorage.forEach(t=>t.dispatch()),this.actions.UserAPI.forEach(t=>t.dispatch())}},PFe=class extends to{constructor(e,t,r){super(e),this.eventManager=t,this.useForRaycastProperty=r,this.objectsPerTypes={MouseDown:[],MouseUp:[],MousePress:[],KeyDown:[],KeyUp:[],KeyPress:[]},this.canvasMouseEvents=[],this.eventsPerObjects={MouseDown:{},MouseUp:{},MousePress:{},KeyDown:{},KeyUp:{},KeyPress:{}},this.heldKeys={},this.heldKeysPress={},this._prevObjects=[],this.sceneInterects=null,this.onCanvasRaycast=i=>{if(this.useForRaycastProperty===!0&&this.sceneInterects===null){this.eventContext.updateRaycaster(i);let{raycaster:n,page:a}=this.eventContext,o=Db(n,a,[],!0);this.sceneInterects=o,o.length&&(this.eventContext.sharedAssets.raycastProperty={x:o[0].point.x,y:o[0].point.y,z:o[0].point.z,objX:o[0].object.matrixWorld.elements[12],objY:o[0].object.matrixWorld.elements[13],objZ:o[0].object.matrixWorld.elements[14]})}},this.onCanvasMouseDown=i=>{(i.target===this.eventContext.domElement||i.target.tagName==="SPLINE-VIEWER")&&this.canvasMouseEvents.forEach(n=>{(n.data.type==="MouseDown"||n.data.type==="MousePress")&&(this.onCanvasRaycast(i),n.dispatch())})},this.onCanvasMouseUp=i=>{(i.target===this.eventContext.domElement||i.target.tagName==="SPLINE-VIEWER")&&this.canvasMouseEvents.forEach(n=>{n.data.type==="MouseUp"?(this.onCanvasRaycast(i),n.dispatch()):n.data.type==="MousePress"&&n.dispatchRelease()})},this.onMouseDown=i=>{Ht.length>1||(this.eventContext.updateRaycaster(i),this.handleMouseEvent("MouseDown"))},this.onMouseUp=i=>{Ht.length>1||(this.eventContext.updateRaycaster(i),this.handleMouseEvent("MouseUp"))},this.onMousePressDown=i=>{Ht.length>1||(this.eventContext.updateRaycaster(i),this.handleMousePressEvent())},this.onMousePressRelease=i=>{Ht.length>1||(this.eventContext.updateRaycaster(i),this.handleMousePressEvent(!0))},this.onKeyDown=i=>{this.heldKeys[i.key]||(this.handleKeyEvent(i,"KeyDown"),this.handleKeyEventHeld(i,"KeyDown",!0)),this.heldKeys[i.key]=!0},this.onKeyUp=i=>{this.handleKeyEvent(i,"KeyUp"),this.handleKeyEventHeld(i,"KeyUp",!0)},this.onKeyPressDown=i=>{this.heldKeysPress[i.key]?this.handleKeyEventHeld(i,"KeyPress"):(this.handleKeyEvent(i,"KeyPress"),this.handleKeyEventHeld(i,"KeyPress",!0)),this.heldKeysPress[i.key]=!0},this.onKeyPressUp=i=>{this.handleKeyEvent(i,"KeyPress",!0)},this.releaseHeldKey=i=>{delete this.heldKeys[i.key]},this.releaseHeldKeyPress=i=>{delete this.heldKeysPress[i.key]},this._onUserEvent=({eventName:i,target:n,reverse:a})=>{var s,l,c,d;if(!i||!n)return;let o=a0(i);o&&(o==="MouseDown"||o==="MouseUp"||o==="MousePress"?(n.dispatchEvent({type:"beginEvent",eventName:o}),(l=(s=this.eventsPerObjects[o])==null?void 0:s[n.uuid])==null||l.forEach(u=>{u.dispatchUserEvent(a)})):(o==="KeyDown"||o==="KeyUp"||o==="KeyPress")&&(n.dispatchEvent({type:"beginEvent",eventName:o}),(d=(c=this.eventsPerObjects[o])==null?void 0:c[n.uuid])==null||d.forEach(u=>{u.dispatchUserEvent()})))}}connect(){var n,a,o,s,l,c;let{page:e,sharedAssets:t,domElement:r}=this.eventContext,i=(d,u)=>{var f,p;if(!((f=d.data)!=null&&f.events.length))return;let h=["MouseDown","MouseUp","MousePress","KeyDown","KeyUp","KeyPress"];for(let v of h){let m=this.eventsPerObjects[v];d.data.events.filter(({data:g})=>g.type===v&&g.disabled!==!0).forEach(({id:g,data:y})=>{try{let b=new TFe(g,y,d,e,t,this.eventManager);b.actions.Video.length&&(this.hasVideoAction=!0),(y.type==="MouseDown"||y.type==="MouseUp"||y.type==="MousePress")&&(y.mode==="Canvas"||y.mode==="Window")?this.canvasMouseEvents.push(b):m[d.uuid]?m[d.uuid].some(x=>x.id===b.id)||m[d.uuid].push(b):m[d.uuid]=[b]}catch{}}),(p=m[d.uuid])!=null&&p.length&&this.objectsPerTypes[v].push(d instanceof Nn&&(v==="MouseDown"||v==="MouseUp"||v==="MousePress")?u:d)}};e.traverseEntity(d=>{var u;(d instanceof ha||d instanceof Pn)&&((u=d.frame)==null||u.traverse(h=>{i(h,d)})),i(d)}),this.heldKeys={},this.heldKeysPress={},this.domEventsNeeded.clear(),r.addEventListener("pointerdown",this.onCanvasMouseDown),r.addEventListener("pointerup",this.onCanvasMouseUp),((n=this.objectsPerTypes.MouseDown)!=null&&n.length||this.useForRaycastProperty)&&(this.domEventsNeeded.add("pointerdown"),r.addEventListener("pointerdown",this.onMouseDown)),(a=this.objectsPerTypes.MouseUp)!=null&&a.length&&(this.domEventsNeeded.add("pointerup"),r.addEventListener("pointerup",this.onMouseUp)),(o=this.objectsPerTypes.MousePress)!=null&&o.length&&(this.domEventsNeeded.add("pointerdown"),r.addEventListener("pointerdown",this.onMousePressDown),this.domEventsNeeded.add("pointerup"),r.addEventListener("pointerup",this.onMousePressRelease)),(s=this.objectsPerTypes.KeyDown)!=null&&s.length&&(this.domEventsNeeded.add("keydown"),document.addEventListener("keydown",this.onKeyDown),document.addEventListener("keyup",this.releaseHeldKey)),(l=this.objectsPerTypes.KeyUp)!=null&&l.length&&(this.domEventsNeeded.add("keyup"),document.addEventListener("keyup",this.onKeyUp)),(c=this.objectsPerTypes.KeyPress)!=null&&c.length&&(this.domEventsNeeded.add("keydown"),document.addEventListener("keydown",this.onKeyPressDown),document.addEventListener("keyup",this.releaseHeldKeyPress),this.domEventsNeeded.add("keyup"),document.addEventListener("keyup",this.onKeyPressUp)),Object.entries(this.objectsPerTypes).forEach(([d,u])=>{u.forEach(h=>{h.addEventListener("userEvent",this._onUserEvent)})})}disconnect(){let{domElement:e}=this.eventContext;this.domEventsNeeded.clear(),this.heldKeys={},this.heldKeysPress={},e.removeEventListener("pointerdown",this.onCanvasMouseDown),e.removeEventListener("pointerup",this.onCanvasMouseUp),e.removeEventListener("pointerdown",this.onMouseDown),e.removeEventListener("pointerdown",this.onMousePressDown),e.removeEventListener("pointerup",this.onMouseUp),e.removeEventListener("pointerup",this.onMousePressRelease),document.removeEventListener("keydown",this.onKeyDown),document.removeEventListener("keyup",this.onKeyUp),document.removeEventListener("keydown",this.onKeyPressDown),document.removeEventListener("keyup",this.onKeyPressUp),document.removeEventListener("keyup",this.releaseHeldKey),Object.values(this.eventsPerObjects).forEach(t=>{Object.values(t).forEach(r=>{r.forEach(i=>{i.disconnect()})})}),this.canvasMouseEvents.forEach(t=>{t.disconnect()}),Object.entries(this.objectsPerTypes).forEach(([t,r])=>{r.forEach(i=>{i.removeEventListener("userEvent",this._onUserEvent)})})}handleMouseEvent(e){var s,l,c,d;let{stopRaycast:t,raycaster:r,page:i,pointerScreen:n}=this.eventContext,a=this.objectsPerTypes[e],o=a.filter(u=>!(u instanceof Nn));if(!(!a.length&&!this.useForRaycastProperty)&&!(i.uiCanvas&&Ul(i,[n.x,n.y],Object.keys(this.eventsPerObjects[e]),u=>{this.handleObjectMouseEventDispatch(u,e)}))){if(t||this.useForRaycastProperty){let u;if(this.sceneInterects===null?u=Db(r,i,o,this.useForRaycastProperty):(u=this.sceneInterects,this.sceneInterects=null),this.useForRaycastProperty&&u.length&&(this.eventContext.sharedAssets.raycastProperty={x:u[0].point.x,y:u[0].point.y,z:u[0].point.z,objX:u[0].object.matrixWorld.elements[12],objY:u[0].object.matrixWorld.elements[13],objZ:u[0].object.matrixWorld.elements[14]}),t){let h=[((l=(s=u[0])==null?void 0:s.uv)==null?void 0:l.x)??0,((d=(c=u[0])==null?void 0:c.uv)==null?void 0:d.y)??0];CE(u).forEach(f=>{f instanceof ha&&Ul(f,h,Object.keys(this.eventsPerObjects[e]),p=>{this.handleObjectMouseEventDispatch(p,e)}),this.eventsPerObjects[e][f.uuid]&&this.handleObjectMouseEventDispatch(f,e)})}}t||o.forEach(u=>{var f,p;let h=l1(r,u);h&&(this.handleObjectMouseEventDispatch(u,e),u instanceof ha&&Ul(u,[((f=h==null?void 0:h.uv)==null?void 0:f.x)??0,((p=h==null?void 0:h.uv)==null?void 0:p.y)??0],Object.keys(this.eventsPerObjects[e]),v=>{this.handleObjectMouseEventDispatch(v,e)}))})}}handleMousePressEvent(e=!1){let t="MousePress",r=this.objectsPerTypes[t],i=r.filter(a=>!(a instanceof Nn)),n=[];if(r.length){if(!e){let{stopRaycast:a,raycaster:o,page:s,pointerScreen:l}=this.eventContext,c=!1;if(s.uiCanvas&&(c=Ul(s,[l.x,l.y],Object.keys(this.eventsPerObjects[t]),d=>{n.push(d)})),a&&!c){let d=Db(o,s,i);n=CE(d),d.forEach(u=>{var h,f;u.object instanceof ha&&Ul(u.object,[((h=u==null?void 0:u.uv)==null?void 0:h.x)??0,((f=u==null?void 0:u.uv)==null?void 0:f.y)??0],Object.keys(this.eventsPerObjects[t]),p=>{n.push(p)})})}else i.forEach(d=>{var h,f;let u=l1(o,d);u&&(n.push(d),d instanceof ha&&Ul(d,[((h=u==null?void 0:u.uv)==null?void 0:h.x)??0,((f=u==null?void 0:u.uv)==null?void 0:f.y)??0],Object.keys(this.eventsPerObjects[t]),p=>{n.push(p)}))})}this._prevObjects.length&&this._prevObjects.forEach(a=>{n.includes(a)||this.handleObjectMouseEventDispatchRelease(a,t)}),n.length&&n.forEach(a=>{this.handleObjectMouseEventDispatch(a,t)}),this._prevObjects=n}}handleObjectMouseEventDispatch(e,t){var r,i;e.dispatchEvent({type:"beginEvent",eventName:t}),(i=(r=this.eventsPerObjects[t])==null?void 0:r[e.uuid])==null||i.forEach(n=>{n.dispatch()})}handleObjectMouseEventDispatchRelease(e,t){var r,i;e.dispatchEvent({type:"beginEvent",eventName:t}),(i=(r=this.eventsPerObjects[t])==null?void 0:r[e.uuid])==null||i.forEach(n=>{n.dispatchRelease()})}handleKeyEvent(e,t,r=!1){this.objectsPerTypes[t].forEach(i=>{let n=this.eventsPerObjects[t][i.uuid];n.some(({data:a})=>"key"in a&&a.key===e.key)&&i.dispatchEvent({type:"beginEvent",eventName:t}),n.forEach(a=>{"key"in a.data&&a.data.key===e.key&&(r?a.dispatchRelease():a.dispatch(!0))})})}handleKeyEventHeld(e,t,r=!1){this.objectsPerTypes[t].forEach(i=>{this.eventsPerObjects[t][i.uuid].forEach(n=>{"key"in n.data&&n.data.key===e.key&&n.dispatchHeld(r)})})}},DFe=new k,OFe=new k,XW=class{constructor(e,t,r,i,n){this.actionsIn=Hn(e,e.inActions,r,i,n,t),this.actionsOut=Hn(e,e.outActions,r,i,n,t)}disconnect(){Fn(this.actionsIn),Fn(this.actionsOut)}},RFe=class extends XW{constructor(e,t,r,i,n,a){super(t,r,i,n,a),this.id=e,this.data=t,this.object=r,this.stage="out",this.objects=[],this.onUpdateMatrixWorld=()=>{for(let h of this.objects)if(!h.visible)return;let c=DFe.setFromMatrixPosition(this.objects[0].matrixWorld),d=OFe.setFromMatrixPosition(this.objects[1].matrixWorld),u=c.distanceTo(d)<=this.distance?"in":"out";if(this.stage!==u){this.stage=u;let h=u==="in"?this.actionsIn:this.actionsOut;h.Audio.forEach(f=>f.dispatchConditional()),h.Particles.forEach(f=>f.dispatchConditional()),h.Video.forEach(f=>f.dispatchConditional()),h.Link.forEach(f=>f.dispatch()),h.Create.forEach(f=>f.dispatch()),h.Destroy.forEach(f=>f.dispatch()),h.Reset.forEach(f=>f.dispatch()),h.Transition.forEach(f=>{f.object.currentTransitionEvent!==this&&(f.object.currentTransitionEvent=this),f.init()}),h.Transition.forEach(f=>f.play()),h.Animation.forEach(f=>f.play()),h.SwitchCamera.forEach(f=>f.play()),h.SceneTransition.forEach(f=>f.dispatch()),h.SetVariable.forEach(f=>f.checkConditions()),h.SetVariable.forEach(f=>f.dispatch()),h.DynamicVariablePlay.forEach(f=>f.dispatch()),h.ClearLocalStorage.forEach(f=>f.dispatch()),h.UserAPI.forEach(f=>f.dispatch())}};let{distance:o,fromObject:s,toObject:l}=t.condition;this.distance=o;for(let c of[s,l]){if(!c)throw new Error("Missing property");let d=i.find(c);if(!d)throw new Error("Missing property");this.objects.push(d)}}connect(){window.setTimeout(()=>{this.objects.forEach(e=>{e.addEventListener("updateMatrixWorld",this.onUpdateMatrixWorld)}),this.onUpdateMatrixWorld()},0)}disconnect(){super.disconnect(),this.stage="out",this.objects.forEach(e=>{e.removeEventListener("updateMatrixWorld",this.onUpdateMatrixWorld)})}},IFe=class extends XW{constructor(e,t,r,i,n,a){var l;super(t,r,i,n,a),this.id=e,this.data=t,this.object=r,this.onBegin=({target:c,state:d})=>{this.toState!==d&&(this.actionsOut.Audio.forEach(u=>u.dispatchConditional()),this.actionsOut.Particles.forEach(u=>u.dispatchConditional()),this.actionsOut.Video.forEach(u=>u.dispatchConditional()),this.actionsOut.Link.forEach(u=>u.dispatch()),this.actionsOut.Create.forEach(u=>u.dispatch()),this.actionsOut.Destroy.forEach(u=>u.dispatch()),this.actionsOut.Reset.forEach(u=>u.dispatch()),this.actionsIn.Transition.forEach(u=>u.pause()),this.object.currentTransitionEvent=this,this.actionsOut.Transition.forEach(u=>u.play()),this.actionsOut.Animation.forEach(u=>u.play()),this.actionsIn.SwitchCamera.forEach(u=>u.pause()),this.actionsOut.SwitchCamera.forEach(u=>u.play()),this.actionsOut.SceneTransition.forEach(u=>u.dispatch()),this.actionsOut.SetVariable.forEach(u=>u.checkConditions()),this.actionsOut.SetVariable.forEach(u=>u.dispatch()),this.actionsOut.DynamicVariablePlay.forEach(u=>u.dispatch()),this.actionsOut.ClearLocalStorage.forEach(u=>u.dispatch()),this.actionsOut.UserAPI.forEach(u=>u.dispatch()))},this.onComplete=({target:c,state:d})=>{this.toState===d&&(this.actionsIn.Audio.forEach(u=>u.dispatchConditional()),this.actionsIn.Particles.forEach(u=>u.dispatchConditional()),this.actionsIn.Video.forEach(u=>u.dispatchConditional()),this.actionsIn.Link.forEach(u=>u.dispatch()),this.actionsIn.Create.forEach(u=>u.dispatch()),this.actionsIn.Destroy.forEach(u=>u.dispatch()),this.actionsIn.Reset.forEach(u=>u.dispatch()),this.actionsOut.Transition.forEach(u=>u.pause()),this.actionsOut.Transition.forEach(u=>u.pause()),this.object.currentTransitionEvent=this,this.actionsIn.Transition.forEach(u=>u.play()),this.actionsIn.Animation.forEach(u=>u.play()),this.actionsOut.SwitchCamera.forEach(u=>u.pause()),this.actionsIn.SwitchCamera.forEach(u=>u.play()),this.actionsIn.SceneTransition.forEach(u=>u.dispatch()),this.actionsIn.SetVariable.forEach(u=>u.checkConditions()),this.actionsIn.SetVariable.forEach(u=>u.dispatch()),this.actionsIn.DynamicVariablePlay.forEach(u=>u.dispatch()),this.actionsOut.ClearLocalStorage.forEach(u=>u.dispatch()),this.actionsOut.UserAPI.forEach(u=>u.dispatch()))};let{condition:o}=t;if(!o.object)throw new Error("Missing property");let s=i.find(o.object)??i.scene.find2D(o.object);if(!s)throw new Error("Missing property");if(this.toObject=s,o.state&&!((l=this.toObject.states)!=null&&l[o.state]))throw new Error("Missing property");this.toState=o.state}connect(){Su(this.actionsOut).forEach(e=>{var t;(t=this.actionsOut[e])!=null&&t.length&&this.toObject.addEventListener("beginState",this.onBegin)}),Su(this.actionsIn).forEach(e=>{var t;(t=this.actionsIn[e])!=null&&t.length&&this.toObject.addEventListener("completeState",this.onComplete)})}disconnect(){super.disconnect(),Su(this.actionsOut).forEach(e=>{var t;(t=this.actionsIn[e])!=null&&t.length&&this.toObject.removeEventListener("beginState",this.onBegin)}),Su(this.actionsIn).forEach(e=>{var t;(t=this.actionsIn[e])!=null&&t.length&&this.toObject.removeEventListener("completeState",this.onComplete)})}},zFe=class extends to{constructor(e,t){super(e),this.eventManager=t,this.eventsPerConditions={Comparison:[],Distance:[],State:[]},this.hasVideoAction=!1}connect(){super.connect();let{page:e,sharedAssets:t}=this.eventContext;e.traverseEntity(r=>{var i;if((i=r.data)!=null&&i.events.length){for(let{id:n,data:a}of r.data.events)if(!a.disabled&&a.type==="Conditional")try{let o;a.condition.type==="Comparison"||(a.condition.type==="Distance"?o=new RFe(n,a,r,e,t,this.eventManager):a.condition.type==="State"&&(o=new IFe(n,a,r,e,t,this.eventManager))),o&&(this.eventsPerConditions[a.condition.type].push(o),(o.actionsIn.Video.length||o.actionsOut.Video.length)&&(this.hasVideoAction=!0))}catch{}}}),Object.values(this.eventsPerConditions).forEach(r=>r.forEach(i=>i.connect()))}disconnect(){super.disconnect(),Object.values(this.eventsPerConditions).forEach(e=>e.forEach(t=>t.disconnect()))}},Vm=new k,kc=new k,Jd=new k,F4=new Va,kFe=.01,Vr=new k,pn=new k,N4=new k,Ou=new Xt,b_=new vn,LFe=new it,x_=new sn,uf=new k,Rs=new k,hf=.2;function w_(e,t){!t||(t[0]<t[1]&&(e.x=Math.min(Math.max(e.x,t[0]),t[1])),t[2]<t[3]&&(e.y=Math.min(Math.max(e.y,t[2]),t[3])),t[4]<t[5]&&(e.z=Math.min(Math.max(e.z,t[4]),t[5])))}var BFe=function(){let e=new it;return(t,r,i)=>{let n=t.obj;e.copy(n.hiddenMatrix),n.parent!==null&&e.premultiply(n.parent.matrixWorld),e.invert(),n.position.copy(r),t.reference==="global"&&w_(n.position,t.limits),n.position.applyMatrix4(e),t.reference==="parent"?w_(n.position,t.limits):t.reference==="local"&&(Ou.copy(t.quat0).invert(),n.position.sub(t.position0),n.position.applyQuaternion(Ou),w_(n.position,t.limits),Ou.invert(),n.position.applyQuaternion(Ou),n.position.add(t.position0)),e.multiply(i??n.matrixWorld).decompose(Vr,n.quaternion,pn),n.updateMatrix(),n.hasNonUniformScale&&(n.updateMatrixWorld(),n.updateMatrixWorldSVD()),n instanceof Ra&&Yl(n.parent)&&n.invalidateDownstreamBooleanData(!0)}}(),FFe=class{constructor(e,t,r,i,n,a,o){this.object=e,this.id=t,this.data=r,this.dropDestIds=[],this.activeIdx=null,this.wasDragEventTriggered=!1,this.resetDampingFactor=this.data.resetSpeed===0?1:8/this.data.resetSpeed+1,this.snapDampingFactor=this.data.snapSpeed===0?1:8/this.data.snapSpeed+1,this.actionsDrag=Hn(r,r.dragDropActions.drag,i,n,a,this.object),this.actionsDrop=Hn(r,r.dragDropActions.drop,i,n,a,this.object);let s=[];this.data.objects.forEach(l=>{let c=i.find(l);!c||c.data.visible!==!1&&(s.push(c),o[c.uuid]&&o[c.uuid].forEach(d=>{let u=i.find(d);!u||u.data.visible!==!1&&s.push(u)}))}),this.data.dropDestinations.forEach(l=>{let c=i.find(l);!c||c.data.visible!==!1&&(this.dropDestIds.push(c.uuid),o[c.uuid]&&o[c.uuid].forEach(d=>{let u=i.find(d);!u||u.data.visible!==!1&&this.dropDestIds.push(u.uuid)}))}),this.dragItems=s.map(l=>(this.data.planeMode==="locked"&&(l.userData.lockedPlane=!0),l.userData.worldPosition0=new k().setFromMatrixPosition(l.matrixWorld),{obj:l,fromPosition:new k().setFromMatrixPosition(l.matrixWorld),pointStart:new k,pointEnd:new k,paused:!0,currentDampingFactor:this.data.dampingFactor,reset:!1,position0:new k().copy(l.position),quat0:new Xt().copy(l.quaternion),snapped:!1,orientationMatrix:new it,limits:this.data.limits,reference:this.data.referenceFrame}))}get activeDragItem(){return this.activeIdx!==null?this.dragItems[this.activeIdx]:null}dispose(){Fn(this.actionsDrag),Fn(this.actionsDrop),this.dragItems.forEach(e=>{e.fromPosition.copy(e.obj.userData.worldPosition0),e.pointStart.copy(e.fromPosition),e.pointEnd.copy(e.pointStart),e.obj.recursiveBBoxNeedsUpdate=!0,e.obj.userData.lockedPlane=void 0,e.obj.position.copy(e.position0),e.obj.quaternion.copy(e.quat0),e.obj.updateMatrix()})}},NFe=class extends to{constructor(e,t){super(e),this.eventManager=t,this.events=[],this.lastDropDestination=null,this.dragTimeout=null,this.onPointerDown=r=>{var o;if(Ht.length>1)return;this.eventContext.updateRaycaster(r);let{raycaster:i,page:n}=this.eventContext,a=n.raycastWithClones(i);if(this.lastDropDestination=null,a.length===0){this.activeEvent=null;return}for(let s of this.events){let l=0;for(let{obj:c,pointEnd:d,pointStart:u}of s.dragItems){if(c===a[0].object||c===a[0].object.object||Cr.is(c)&&c.isAncestorOf(a[0].object.uuid)){if(s.activeIdx=l,s.activeDragItem.reset=!1,s.activeDragItem.currentDampingFactor=s.data.dampingFactor,s.activeDragItem.snapped=!1,s.data.cursor==="hand"&&this.setCursor("grabbing"),this.eventManager.controlsManager.usePhysics){s.activeDragItem.obj.rigidBody&&s.activeDragItem.obj.rigidBody.setBodyType(2,!0);let h=s.activeDragItem.obj;c.hasNonUniformScale&&c.updateMatrixWorldSVD(),(h.hasNonUniformScale?h.matrixWorldRigid:h.matrixWorld).decompose(Vr,Ou,pn),b_.setFromQuaternion(Ou),h.prevR===void 0?(h.prevR=b_.clone(),h.prevT=Vr.clone()):(h.prevR.copy(b_),h.prevT.copy(Vr)),this.eventManager.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.push(s.activeDragItem.obj)}this.calcPlaneIntersectPos(c,u,s.data.plane,s.data.referenceFrame),d.copy(u),(this.eventManager.controlsManager.usePhysics&&((o=c.data.physics)==null?void 0:o.rigidBody)==="dynamic"||s.data.drop===!1||s.data.resetOnSnapFail===!1)&&s.activeDragItem.fromPosition.setFromMatrixPosition(s.activeDragItem.obj.matrixWorld),this.activeEvent=s,this.eventManager.controlsManager.orbitControls&&(this.eventManager.controlsManager.orbitControls.enabled=!1);return}l++}}this.activeEvent=null},this.onPointerMove=r=>{var o,s,l,c;if(Ht.length>1)return;this.eventContext.updateRaycaster(r);let{raycaster:i,page:n}=this.eventContext,a=n.raycastWithClones(i);if(Ht.length===0){let d=!1;for(let u of this.events){for(let{obj:h}of u.dragItems)if(h===((o=a[0])==null?void 0:o.object)||h===((l=(s=a[0])==null?void 0:s.object)==null?void 0:l.object)||Cr.is(h)&&h.isAncestorOf((c=a[0])==null?void 0:c.object.uuid)){switch(d=!0,u.data.cursor){case"hand":this.setCursor("grab");break;case"move":this.setCursor("move");break}break}if(d)break}d||this.setCursor("default");return}if(this.activeEvent&&this.activeEvent.activeDragItem){let d=this.activeEvent.activeDragItem;d.snapped=!1;let u;if(this.activeEvent.data.drop&&(u=a.filter(h=>d.obj!==h.object&&!d.obj.isAncestorOf(h.object.uuid)&&!(h.object instanceof Zf)&&(this.activeEvent.data.dropOn==="all"||this.activeEvent.dropDestIds.some(f=>f===h.object.uuid||n.scene.find(f).isAncestorOf(h.object.uuid))))[0]),u){let h=N4.copy(u.face.normal).applyMatrix3(x_.getNormalMatrix(u.object.matrixWorld));if(this.activeEvent.data.snapTo==="center")d.fromPosition.setFromMatrixPosition(u.object.matrixWorld);else if(this.activeEvent.data.snapTo==="surface"){if(d.fromPosition.copy(u.point),this.activeEvent.data.snapSurfaceMode==="bbox"){Vr.copy(h).applyMatrix3(x_.setFromMatrix4(d.obj.matrixWorld).transpose());let f=d.obj;Vr.x>hf?pn.x=-f.recursiveBBox.min.x:Vr.x<-hf&&(pn.x=-f.recursiveBBox.max.x),Vr.y>hf?pn.y=-f.recursiveBBox.min.y:Vr.y<-hf&&(pn.y=-f.recursiveBBox.max.y),Vr.z>hf?pn.z=-f.recursiveBBox.min.z:Vr.z<-hf&&(pn.z=-f.recursiveBBox.max.z),pn.applyMatrix3(x_.invert())}else pn.copy(h).multiplyScalar(this.activeEvent.data.snapSurfaceOffset);d.fromPosition.add(pn)}this.activeEvent.data.autoOrient&&(Vr.set(0,1,0).cross(h),Vr.length()<1e-4&&Vr.set(-1,0,0).cross(h),pn.crossVectors(N4,Vr),d.orientationMatrix.makeBasis(Vr,pn,h)),d.pointStart.copy(d.fromPosition),d.pointEnd.copy(d.pointStart),d.currentDampingFactor=this.activeEvent.snapDampingFactor,d.snapped=!0,this.lastDropDestination!==u.object&&(this.lastDropDestination=u.object,this.activeEvent.actionsDrop.Transition.forEach(f=>{f.play()}),this.activeEvent.actionsDrop.Animation.forEach(f=>{f.play()}),this.activeEvent.actionsDrop.Audio.forEach(f=>{f.dispatchGameControl("start")}),this.activeEvent.actionsDrop.Particles.forEach(f=>{f.dispatchGameControl("start")}),this.activeEvent.actionsDrop.Create.forEach(f=>{f.dispatchThrottled()}))}else d.orientationMatrix.makeRotationFromQuaternion(d.quat0),this.lastDropDestination=null,d.currentDampingFactor=this.activeEvent.data.dampingFactor,this.calcPlaneIntersectPos(d.obj,d.pointEnd,this.activeEvent.data.plane,this.activeEvent.data.referenceFrame),this.activeEvent.actionsDrop.Transition.forEach(h=>{h.stop(),h.object.currentState!==null&&h.object.changeSelectedState(null,{scene:this.eventContext.page.scene,shared:this.eventContext.sharedAssets})}),this.activeEvent.actionsDrop.Animation.forEach(h=>{h.stop()}),this.activeEvent.actionsDrop.Audio.forEach(h=>{h.dispatchGameControl("stop")}),this.activeEvent.actionsDrop.Particles.forEach(h=>{h.dispatchGameControl("stop")});this.activeEvent.actionsDrag.Create.forEach(h=>{h.dispatchThrottled()}),this.activeEvent.actionsDrag.SetVariable.forEach(h=>h.checkConditions()),this.activeEvent.actionsDrag.SetVariable.forEach(h=>h.dispatch()),this.activeEvent.actionsDrag.DynamicVariablePlay.forEach(h=>h.dispatch()),this.activeEvent.actionsDrag.ClearLocalStorage.forEach(h=>h.dispatch()),this.activeEvent.actionsDrag.UserAPI.forEach(h=>h.dispatch()),this.activeEvent.wasDragEventTriggered===!1&&(this.activeEvent.wasDragEventTriggered=!0,this.activeEvent.actionsDrag.Transition.forEach(h=>{h.play()}),this.activeEvent.actionsDrag.Animation.forEach(h=>{h.play()}),this.activeEvent.actionsDrag.Audio.forEach(h=>{h.dispatchGameControl("start")}),this.activeEvent.actionsDrag.Particles.forEach(h=>{h.dispatchGameControl("start")})),this.dragTimeout&&window.clearTimeout(this.dragTimeout),this.dragTimeout=window.setTimeout(()=>{!this.activeEvent||(this.activeEvent.wasDragEventTriggered=!1,this.activeEvent.actionsDrag.Audio.forEach(h=>{h.dispatchGameControl("stop")}),this.activeEvent.actionsDrag.Particles.forEach(h=>{h.dispatchGameControl("stop")}),this.activeEvent.actionsDrag.Transition.forEach(h=>{h.stop(),h.object.currentState!==null&&h.object.changeSelectedState(null,{scene:this.eventContext.page.scene,shared:this.eventContext.sharedAssets})}),this.activeEvent.actionsDrag.Animation.forEach(h=>{h.stop()}))},500),this.updateDragItem(d),d.obj.dispatchEvent({type:"requestRender"})}},this.onPointerUp=r=>{var i;if(this.activeEvent&&this.activeEvent.activeDragItem){this.activeEvent.data.cursor==="hand"&&this.setCursor("grab");let n=((i=this.activeEvent.activeDragItem.obj.data.physics)==null?void 0:i.rigidBody)==="dynamic";this.activeEvent.activeDragItem.snapped===!1&&this.activeEvent.data.drop&&this.activeEvent.data.resetOnSnapFail&&(this.eventManager.controlsManager.usePhysics===!1||!n)&&(this.activeEvent.activeDragItem.reset=this.activeEvent.data.resetOnSnapFail,this.activeEvent.activeDragItem.paused=!1,this.activeEvent.activeDragItem.currentDampingFactor=this.activeEvent.resetDampingFactor),this.eventManager.controlsManager.usePhysics&&n&&(this.eventManager.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.pop(),this.activeEvent.activeDragItem.obj.rigidBody.setBodyType(0,!0),this.activeEvent.activeDragItem.paused=!0),this.activeEvent.wasDragEventTriggered===!0&&(this.activeEvent.wasDragEventTriggered=!1,this.activeEvent.actionsDrag.Transition.forEach(a=>{a.stop(),a.object.currentState!==null&&a.object.changeSelectedState(null,{scene:this.eventContext.page.scene,shared:this.eventContext.sharedAssets})}),this.activeEvent.actionsDrag.Animation.forEach(a=>{a.stop()}),this.activeEvent.actionsDrag.Audio.forEach(a=>{a.dispatchGameControl("stop")}),this.activeEvent.actionsDrag.Particles.forEach(a=>{a.dispatchGameControl("stop")}),this.activeEvent.actionsDrop.SetVariable.forEach(a=>a.checkConditions()),this.activeEvent.actionsDrop.SetVariable.forEach(a=>a.dispatch()),this.activeEvent.actionsDrop.DynamicVariablePlay.forEach(a=>a.dispatch()),this.activeEvent.actionsDrop.ClearLocalStorage.forEach(a=>a.dispatch()),this.activeEvent.actionsDrop.UserAPI.forEach(a=>a.dispatch())),this.eventManager.controlsManager.orbitControls&&(this.eventManager.controlsManager.orbitControls.enabled=!0)}}}connect(){let e={};if(this.eventContext.page.traverseEntity(r=>{r.component&&(e[r.component.uuid]?e[r.component.uuid].push(r.uuid):e[r.component.uuid]=[r.uuid])}),this.eventContext.page.traverseEntity(r=>{var i;(i=r.data)==null||i.events.filter(n=>n.data.type==="DragDrop"&&!n.data.disabled).forEach(n=>{this.events.push(new FFe(r,n.id,n.data,this.eventContext.page,this.eventContext.sharedAssets,this.eventManager,e))})}),!this.events.length)return;this.domEventsNeeded.clear(),this.domEventsNeeded.add("pointerdown");let t=this.eventContext.domElement;t.addEventListener("pointerdown",this.onPointerDown),t.addEventListener("pointermove",this.onPointerMove),t.addEventListener("pointerup",this.onPointerUp),this.domEventsNeeded.add("pointermove")}disconnect(){if(!this.events.length)return;this.domEventsNeeded.clear();let e=this.eventContext.domElement;e.removeEventListener("pointerdown",this.onPointerDown),e.removeEventListener("pointermove",this.onPointerMove),e.removeEventListener("pointerup",this.onPointerUp),this.events.forEach(t=>t.dispose())}setCursor(e){this.eventContext.domElement.style.cursor=e}onAnimationFrameDamping(){for(let e of this.events)for(let t of e.dragItems)t.paused||this.updateDragItem(t,!0)}calcPlaneIntersectPos(e,t,r,i){let{getCamera:n,raycaster:a}=this.eventContext;n().getWorldDirection(kc),kc.negate();let o=Ou.identity();switch(i==="parent"?LFe.multiplyMatrices(e.parent.matrixWorld,e.hiddenMatrix).decompose(Vr,o,pn):i==="local"&&e.matrixWorld.decompose(Vr,o,pn),r){case"x":Vr.set(1,0,0).applyQuaternion(o),uf.copy(kc).cross(Vr),Rs.copy(Vr).cross(uf);break;case"y":Vr.set(0,1,0).applyQuaternion(o),uf.copy(kc).cross(Vr),Rs.copy(Vr).cross(uf);break;case"z":Vr.set(0,0,1).applyQuaternion(o),uf.copy(kc).cross(Vr),Rs.copy(Vr).cross(uf);break;case"xy":Rs.set(0,0,1).applyQuaternion(o);break;case"yz":Rs.set(1,0,0).applyQuaternion(o);break;case"xz":Rs.set(0,1,0).applyQuaternion(o);break;case"adaptive":kc.angleTo(pn.set(0,1,0))>Math.PI/6?(Vr.crossVectors(pn.set(0,1,0),kc),Rs.crossVectors(Vr,pn)):Rs.set(0,1,0);break;default:Rs.copy(kc);break}Jd.setFromMatrixPosition(e.matrixWorld);let s=e.userData.lockedPlane?e.userData.worldPosition0:Jd;if(F4.setFromNormalAndCoplanarPoint(Rs,s),!!a.ray.intersectPlane(F4,t)&&(r==="x"||r==="y"||r==="z")){let l=pn.subVectors(t,s).dot(Vr);t.copy(s).addScaledVector(Vr,l)}}updateDragItem(e,t=!1){var r,i;Jd.setFromMatrixPosition(e.obj.matrixWorld),e.reset==="current"?Vm.subVectors(e.fromPosition,Jd).divideScalar(e.currentDampingFactor):e.reset==="original"?(Vm.subVectors(e.obj.userData.worldPosition0,Jd).divideScalar(e.currentDampingFactor),e.fromPosition.copy(e.obj.userData.worldPosition0),e.pointStart.copy(e.fromPosition),e.pointEnd.copy(e.pointStart)):Vm.subVectors(e.pointEnd,e.pointStart).add(e.fromPosition).sub(Jd).divideScalar(e.currentDampingFactor),e.paused=e.currentDampingFactor>1?Vm.length()<kFe:!0,(this.activeEvent&&this.activeEvent.data.dampingFactor===1||t)&&BFe(e,Vm.add(Jd),(r=this.activeEvent)!=null&&r.data.drop&&((i=this.activeEvent)!=null&&i.data.autoOrient)?e.orientationMatrix:null),e.obj.dispatchEvent({type:"beginEvent",eventName:"DragDrop"}),this.eventManager.requestRender()}},ff=new k,S_=new k,Ml=new k,El=new k,U4=new Va,UFe=.01,jFe={type:"requestRender"},VFe=function(){let e=new k,t=new k;return(r,i,n)=>n>0?(e.subVectors(r,i),e.length()<=n?r:t.copy(i).add(e.normalize().multiplyScalar(n))):i}(),j4=function(){let e=new it;return(t,r)=>{t.position.copy(r),t.parent!==null&&(e.copy(t.parent.matrixWorld).invert(),t.position.applyMatrix4(e)),e.copy(t.hiddenMatrix).invert(),t.position.applyMatrix4(e),t.updateMatrix(),t.hasNonUniformScale&&(t.updateMatrixWorld(),t.updateMatrixWorldSVD()),t instanceof Ra&&Yl(t.parent)&&t.invalidateDownstreamBooleanData(!0)}}(),HFe=class{constructor(e,t,r,i,n,a){this.data=e,this.id=t,this.object=r,this.paused=!1,this.currentDampingFactor=1,this.snapComplete=!1,this.isReset=!1,this.worldPosition0=new k,this.timeoutId=null,this.delayFinished=!0,this.wasOutside=!1,this.data={...eM.defaultData,...e,...e.resetOnPointerLeave===void 0&&{resetOnPointerLeave:!1}},e.target===void 0||e.target==="cursor"||(this.target=i.find(e.target)),this.data.dampingFactor&&(this.currentDampingFactor=this.data.dampingFactor),this.resetDampingFactor=80/this.data.resetSpeed+1,this.object.getWorldPosition(this.worldPosition0),this.actions=Hn(e,e.actions,i,n,a,r)}},WFe=class extends to{constructor(e,t){super(e),this.eventManager=t,this.events=[],this.pairOfEventListeners=[],this.onMouseMove=r=>{if(!(Ht.length>1)){this.eventContext.updateRaycaster(r);for(let i of this.events)i.target===void 0&&this.updateSingleEvent(i)}},this.onMouseEnter=r=>{for(let i of this.events)i.target===void 0&&(i.isReset=!1,i.currentDampingFactor=i.data.dampingFactor)},this.onMouseLeave=r=>{for(let i of this.events)i.target===void 0&&(i.data.resetOnPointerLeave&&(i.isReset=!0,i.currentDampingFactor=i.resetDampingFactor),this.updateSingleEvent(i))},this.onTargetChange=r=>()=>{this.updateSingleEvent(r)}}connect(){let{page:e}=this.eventContext;if(e.traverseEntity(i=>{var a,o;let n=(a=i.data)==null?void 0:a.events.find(s=>s.data.type==="Follow"&&!s.data.disabled);n&&(!e.data.globalPhysics.usePhysics||((o=i.dataPatched.physics)==null?void 0:o.rigidBody)!=="dynamic")&&this.events.push(new HFe(n.data,n.id,i,e,this.eventContext.sharedAssets,this.eventManager))}),!this.events.length)return;let{domElement:t,eventElement:r}=this.eventContext;this.domEventsNeeded.clear(),lo&&(this.domEventsNeeded.add("pointerdown"),t.addEventListener("pointerdown",this.onMouseMove)),this.domEventsNeeded.add("pointermove"),r.addEventListener("pointermove",this.onMouseMove),this.eventContext.useWindowEvents||(t.addEventListener("pointerenter",this.onMouseEnter),t.addEventListener("pointerleave",this.onMouseLeave));for(let i of this.events)if(i.target!==void 0){let n=i.target,a=this.onTargetChange(i);this.pairOfEventListeners.push([n,a]),n.addEventListener("requestRender",a)}}disconnect(){if(!this.events.length)return;let{domElement:e,eventElement:t}=this.eventContext;this.domEventsNeeded.clear(),lo&&e.removeEventListener("pointerdown",this.onMouseMove),t.removeEventListener("pointermove",this.onMouseMove),e.removeEventListener("pointerenter",this.onMouseEnter),e.removeEventListener("pointerleave",this.onMouseLeave);for(let[r,i]of this.pairOfEventListeners)r.removeEventListener("requestRender",i);for(let r of this.events)r.paused=!0,r.isReset=!1,Fn(r.actions)}onAnimationFrameDamping(){for(let e of this.events)e.paused||this.updateSingleEvent(e,!0)}updateSingleEvent(e,t=!1){var o;this.events.forEach(s=>{s.actions.Create.forEach(l=>{l.dispatchThrottled()})});let{plane:r,limitDistance:i,limitDistanceEnabled:n}=e.data;if(e.object.getWorldPosition(Ml),e.isReset)El.copy(e.worldPosition0);else if(e.target)e.target.getWorldPosition(El);else{let{getCamera:s,raycaster:l}=this.eventContext;if(r==="custom"?(s().getWorldDirection(S_),S_.negate(),ff.copy(S_)):r==="xy"?ff.set(0,0,1):r==="xz"?ff.set(0,1,0):r==="yz"&&ff.set(1,0,0),U4.setFromNormalAndCoplanarPoint(ff,Ml),!l.ray.intersectPlane(U4,El))return}if(!e.isReset){if(El.distanceTo(e.worldPosition0)>i&&n&&e.target)if(e.snapComplete=!1,e.data.snapDelay&&(e.delayFinished=!1,typeof window<"u"&&e.timeoutId!==null&&(window.clearTimeout(e.timeoutId),e.timeoutId=null)),e.wasOutside=!0,e.data.resetAfterDistanceLimit)El.copy(e.worldPosition0),e.currentDampingFactor=e.resetDampingFactor;else return;else if(e.wasOutside&&(e.data.snapDelay&&typeof window<"u"&&(e.timeoutId=window.setTimeout(()=>{e.delayFinished=!0,e.paused=!1,this.updateSingleEvent(e)},e.data.snapDelay*1e3)),e.currentDampingFactor=e.data.dampingFactor,e.wasOutside=!1),e.delayFinished===!1)return}e.data.enabledTranslation[0]===!1&&(El.x=Ml.x),e.data.enabledTranslation[1]===!1&&(El.y=Ml.y),e.data.enabledTranslation[2]===!1&&(El.z=Ml.z);let a=VFe(Ml,El,e.wasOutside?0:e.data.maxDelta);if(e.currentDampingFactor>1){let s=ff.subVectors(a,Ml).divideScalar(e.currentDampingFactor);Ml.add(s),t&&j4(e.object,Ml),e.paused=s.length()<UFe}else j4(e.object,a),e.paused=!0;(o=e.object)==null||o.dispatchEvent({type:"beginEvent",eventName:"Follow"}),e.object.dispatchEvent(jFe)}},Hm=new k,Jy=new k,Wm=new it,pf=new Xt,Lc=new Xt,Gm=new k,$m=new k,eu=new k,Tl=new k,C_=new Va,GFe=1e-6,$Fe={type:"requestRender"},qFe={type:"changeRotation"},V4=function(){let e=new it;return function(t,r){t.parent!==null?e.multiplyMatrices(t.parent.matrixWorld,t.hiddenMatrix):e.copy(t.hiddenMatrix),r.premultiply(WW(e).invert()),t.rotation.setFromRotationMatrix(r),t.updateMatrix(),t instanceof Ra&&Yl(t.parent)&&t.invalidateDownstreamBooleanData(!0)}}(),YFe=class{constructor(e,t,r,i){this.id=t,this.object=r,this.paused=!1,this.currentDampingFactor=1,this.isReset=!1,this.worldQuaternion0=new Xt,this.timeoutId=null,this.delayFinished=!0,this.wasOutside=!1,this.data={...tM.defaultData,...e,...e.resetOnPointerLeave===void 0&&{resetOnPointerLeave:!1}},e.target===void 0||e.target==="cursor"||(this.target=i.find(e.target)),this.data.dampingFactor&&(this.currentDampingFactor=this.data.dampingFactor),this.object.getWorldQuaternion(this.worldQuaternion0),this.resetDampingFactor=80/this.data.resetSpeed+1}},XFe=class extends to{constructor(){super(...arguments),this.events=[],this.pairOfEventListeners=[],this.pairOfUserEventListeners=[],this.onMouseMove=e=>{if(!(Ht.length>1)){this._lastMouseEvent=e,this.eventContext.updateRaycaster(e);for(let t of this.events)t.target===void 0&&this.updateSingleEvent(t)}},this.onMouseEnter=e=>{for(let t of this.events)t.target===void 0&&(t.isReset=!1,t.currentDampingFactor=t.data.dampingFactor)},this.onMouseLeave=e=>{for(let t of this.events)t.target===void 0&&(t.data.resetOnPointerLeave&&(t.isReset=!0,t.currentDampingFactor=t.resetDampingFactor),this.updateSingleEvent(t))},this.onScroll=e=>{if(this._lastMouseEvent){let t=new PointerEvent("pointermove",{clientX:this._lastMouseEvent.clientX,clientY:this._lastMouseEvent.clientY,bubbles:!0,cancelable:!0,view:window});this.eventContext.eventElement.dispatchEvent(t)}},this.onTargetChange=e=>()=>{this.updateSingleEvent(e)},this.createUserEventListener=e=>({eventName:t,target:r})=>{if(!t||!r)return;let i=a0(t);i&&i==="LookAt"&&this.updateSingleEvent(e)}}connect(){let{page:e}=this.eventContext;if(e.traverseEntity(i=>{var a,o;let n=(a=i.data)==null?void 0:a.events.find(s=>s.data.type==="LookAt"&&!s.data.disabled);n&&(!e.data.globalPhysics.usePhysics||((o=i.dataPatched.physics)==null?void 0:o.rigidBody)!=="dynamic")&&this.events.push(new YFe(n.data,n.id,i,e))}),!this.events.length)return;let{domElement:t,eventElement:r}=this.eventContext;this.domEventsNeeded.clear(),lo&&(this.domEventsNeeded.add("pointerdown"),t.addEventListener("pointerdown",this.onMouseMove)),this.domEventsNeeded.add("pointermove"),r.addEventListener("pointermove",this.onMouseMove),this.eventContext.useWindowEvents?r.addEventListener("scroll",this.onScroll):(t.addEventListener("pointerenter",this.onMouseEnter),t.addEventListener("pointerleave",this.onMouseLeave));for(let i of this.events){if(i.target!==void 0){let o=this.onTargetChange(i),s=i.target;this.pairOfEventListeners.push([s,o]),s.addEventListener("requestRender",o)}let n=this.createUserEventListener(i),a=i.object;this.pairOfUserEventListeners.push([a,n]),a.addEventListener("userEvent",n)}}disconnect(){if(!this.events.length)return;let{domElement:e,eventElement:t}=this.eventContext;this.domEventsNeeded.clear(),lo&&e.removeEventListener("pointerdown",this.onMouseMove),t.removeEventListener("pointermove",this.onMouseMove),e.removeEventListener("pointerenter",this.onMouseEnter),e.removeEventListener("pointerleave",this.onMouseLeave),t.removeEventListener("scroll",this.onScroll);for(let[r,i]of this.pairOfEventListeners)r.removeEventListener("requestRender",i);for(let[r,i]of this.pairOfUserEventListeners)r.removeEventListener("userEvent",i);for(let r of this.events)r.paused=!0,r.isReset=!1}onAnimationFrameDamping(){for(let e of this.events)e.paused||this.updateSingleEvent(e)}updateSingleEvent(e){var h;let{tilt:t,axis:r,distance:i,plane:n,limitDistance:a,enabledRotation:o,limitDistanceEnabled:s}=e.data,{getCamera:l,raycaster:c}=this.eventContext,{object:d,target:u}=e;if(d.getWorldPosition(Gm),!e.isReset)if(e.target)e.target.getWorldPosition($m);else{if(n==="custom"?(l().getWorldDirection(Jy),Jy.negate(),C_.setFromNormalAndCoplanarPoint(Jy,Gm)):(n==="xy"?Hm.set(0,0,1):n==="xz"?Hm.set(0,1,0):n==="yz"&&Hm.set(1,0,0),C_.setFromNormalAndCoplanarPoint(Hm,Gm)),!c.ray.intersectPlane(C_,$m))return;i>0&&(n==="custom"||n===void 0)&&$m.addScaledVector(Jy,i)}if(e.isReset||(u?t==="target"?eu.copy(u.up).applyMatrix4(Wm.extractRotation(u.matrixWorld)).normalize():o.some(f=>f===!1)?(r==="x"?(Tl.set(0,0,1),o[2]===!1&&Tl.set(0,1,0)):r==="y"?(Tl.set(1,0,0),o[0]===!1&&Tl.set(0,0,1)):(Tl.set(0,1,0),o[1]===!1&&Tl.set(1,0,0)),eu.copy(Tl).applyQuaternion(e.worldQuaternion0).normalize()):eu.set(0,1,0):n==="custom"?eu.set(0,1,0):eu.copy(Hm)),e.isReset)Lc.copy(e.worldQuaternion0);else if(Gm.distanceTo($m)>a&&s&&u)if(e.data.snapDelay&&(e.delayFinished=!1,typeof window<"u"&&e.timeoutId!==null&&(window.clearTimeout(e.timeoutId),e.timeoutId=null)),e.wasOutside=!0,e.data.resetAfterDistanceLimit)Lc.copy(e.worldQuaternion0),e.currentDampingFactor=e.resetDampingFactor;else return;else{if(e.wasOutside&&(e.data.snapDelay&&typeof window<"u"&&(e.timeoutId=window.setTimeout(()=>{e.delayFinished=!0,e.paused=!1,this.updateSingleEvent(e)},e.data.snapDelay*1e3)),e.currentDampingFactor=e.data.dampingFactor,e.wasOutside=!1),e.delayFinished===!1)return;KFe(Wm,$m,Gm,eu,r,Tl),Lc.setFromRotationMatrix(Wm),pf.setFromUnitVectors(Tl.applyQuaternion(Lc),eu),o.some(f=>f===!1)&&t!=="target"&&Lc.premultiply(pf).normalize()}e.currentDampingFactor>1?(d.updateWorldMatrix(!0,!1),pf.setFromRotationMatrix(WW(d.matrixWorld)),pf.slerp(Lc,1/e.currentDampingFactor),V4(d,Wm.makeRotationFromQuaternion(pf)),e.paused=8*(1-pf.dot(Lc))<GFe):(V4(d,Wm.makeRotationFromQuaternion(Lc)),e.paused=!0),(h=e.object)==null||h.dispatchEvent({type:"beginEvent",eventName:"LookAt"}),d.dispatchEvent($Fe),d.dispatchEvent(qFe)}},bo=new k,fn=new k,Hi=new k;function KFe(e,t,r,i,n,a){let o=e.elements;Hi.subVectors(t,r),Hi.lengthSq()===0&&(Hi.z=1),Hi.normalize(),fn.crossVectors(i,Hi),fn.lengthSq()===0&&(Math.abs(i.z)===1?Hi.x+=1e-4:Hi.z+=1e-4,Hi.normalize(),fn.crossVectors(i,Hi)),fn.normalize(),bo.crossVectors(Hi,fn),n==="x"?a.z===1?[fn,bo,Hi]=[Hi,fn,bo]:(fn.negate(),[fn,Hi]=[Hi,fn]):n==="y"?a.x===1?[fn,bo,Hi]=[bo,Hi,fn]:(fn.negate(),[bo,Hi]=[Hi,bo]):a.x===1&&(fn.negate(),[fn,bo]=[bo,fn]),o[0]=fn.x,o[4]=bo.x,o[8]=Hi.x,o[1]=fn.y,o[5]=bo.y,o[9]=Hi.y,o[2]=fn.z,o[6]=bo.z,o[10]=Hi.z}var QFe=class{constructor(e,t,r,i,n,a){this.id=e,this.data=t,this.object=r,this.entered=!1,this.actions=Hn(t,t.actions,i,n,a,r)}disconnect(){Fn(this.actions)}dispatchEnter(){this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),this.entered||(this.entered=!0,this.actions.Transition.forEach(e=>e.playFromCurrent()),this.actions.Animation.forEach(e=>e.play()),this.actions.Create.forEach(e=>e.dispatchStart()),this.actions.Particles.forEach(e=>e.dispatchBasic()),this.actions.Destroy.forEach(e=>e.dispatch()),this.actions.SwitchCamera.forEach(e=>e.playFromCurrent()),this.actions.SceneTransition.forEach(e=>e.dispatch()),this.actions.SetVariable.forEach(e=>e.checkConditions()),this.actions.SetVariable.forEach(e=>e.dispatch()),this.actions.DynamicVariablePlay.forEach(e=>e.dispatch()),this.actions.ClearLocalStorage.forEach(e=>e.dispatch()),this.actions.UserAPI.forEach(e=>e.dispatch()))}dispatchLeave(){this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),this.entered&&(this.entered=!1,this.actions.Create.forEach(e=>e.dispatchStop()),this.actions.Transition.forEach(e=>e.reverseFromCurrent()),this.actions.Particles.forEach(e=>e.reverseFromCurrent()),this.actions.SwitchCamera.forEach(e=>e.reverseFromCurrent()))}dispatchUserEvent(e){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),e?(this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.Particles.forEach(t=>t.reverseFromCurrent()),this.actions.Animation.forEach(t=>t.reverseFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.reverseFromCurrent())):(this.actions.Transition.forEach(t=>t.playFromCurrent()),this.actions.Animation.forEach(t=>t.playFromCurrent()),this.actions.Create.forEach(t=>t.dispatch()),this.actions.Particles.forEach(t=>t.dispatchBasic()),this.actions.Destroy.forEach(t=>t.dispatch()),this.actions.SwitchCamera.forEach(t=>t.playFromCurrent())),this.actions.SceneTransition.forEach(t=>t.dispatch()),this.actions.SetVariable.forEach(t=>t.checkConditions()),this.actions.SetVariable.forEach(t=>t.dispatch()),this.actions.DynamicVariablePlay.forEach(t=>t.dispatch()),this.actions.ClearLocalStorage.forEach(t=>t.dispatch()),this.actions.UserAPI.forEach(t=>t.dispatch())}},ZFe=class extends to{constructor(e,t){super(e),this.eventManager=t,this.eventsPerObjects={},this.objects=[],this.objects2D=[],this._prevObjects=[],this.onMouseDown=r=>{Ht.length>1||(this.eventContext.updateRaycaster(r),this.handleMouseHoverEvent())},this.onMouseUp=r=>{Ht.length>1||this.handleMouseHoverEvent(!0)},this.onMouseMove=r=>{Ht.length>1||(this.eventContext.updateRaycaster(r),this.handleMouseHoverEvent())},this.onUserEvent=({eventName:r,target:i,reverse:n})=>{var o;if(!r||!i)return;let a=a0(r);a&&a==="MouseHover"&&(i.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),(o=this.eventsPerObjects[i.uuid])==null||o.forEach(s=>s.dispatchUserEvent(n)))}}connect(){let{page:e,sharedAssets:t}=this.eventContext,r=(n,a)=>{var o,s;if(!(!n.visible||!((o=n.data)!=null&&o.events.length))){for(let{id:l,data:c}of n.data.events)if(!c.disabled&&c.type==="MouseHover")try{let d=new QFe(l,c,n,e,t,this.eventManager);this.eventsPerObjects[n.uuid]?this.eventsPerObjects[n.uuid].push(d):this.eventsPerObjects[n.uuid]=[d]}catch{}(s=this.eventsPerObjects[n.uuid])!=null&&s.length&&this.objects.push(n instanceof Nn?a:n)}};if(e.traverseEntity(n=>{var a;(n instanceof ha||n instanceof Pn)&&((a=n.frame)==null||a.traverse(o=>{r(o,n)})),r(n)}),!this.objects.length)return;let{domElement:i}=this.eventContext;this.domEventsNeeded.clear(),lo&&(this.domEventsNeeded.add("pointerdown"),i.addEventListener("pointerdown",this.onMouseDown),this.domEventsNeeded.add("pointerup"),i.addEventListener("pointerup",this.onMouseUp)),this.domEventsNeeded.add("pointermove"),i.addEventListener("pointermove",this.onMouseMove),this.objects.forEach(n=>{n.addEventListener("userEvent",this.onUserEvent)})}disconnect(){if(!this.objects.length)return;let{domElement:e}=this.eventContext;this.domEventsNeeded.clear(),lo&&(e.removeEventListener("pointerdown",this.onMouseDown),e.removeEventListener("pointerup",this.onMouseUp)),e.removeEventListener("pointermove",this.onMouseMove),Object.values(this.eventsPerObjects).forEach(t=>{t.forEach(r=>{r.disconnect()})}),this.objects.forEach(t=>{t.removeEventListener("userEvent",this.onUserEvent)})}handleMouseHoverEvent(e=!1){let t=[];if(!e){let{stopRaycast:r,raycaster:i,page:n,pointerScreen:a}=this.eventContext,o=!1;if(n.uiCanvas&&(o=Ul(n,[a.x,a.y],Object.keys(this.eventsPerObjects),s=>{t.push(s)})),r&&!o){let s=Db(i,n,this.objects);t=CE(s),s.forEach(l=>{var c,d;l.object instanceof ha&&Ul(l.object,[((c=l==null?void 0:l.uv)==null?void 0:c.x)??0,((d=l==null?void 0:l.uv)==null?void 0:d.y)??0],Object.keys(this.eventsPerObjects),u=>{t.push(u)})})}else this.objects.forEach(s=>{var c,d;let l=l1(i,s);l&&(t.push(s),s instanceof ha&&Ul(s,[((c=l==null?void 0:l.uv)==null?void 0:c.x)??0,((d=l==null?void 0:l.uv)==null?void 0:d.y)??0],Object.keys(this.eventsPerObjects),u=>{t.push(u)}))})}this._prevObjects.length&&this._prevObjects.forEach(r=>{var i;t.includes(r)||(r.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),(i=this.eventsPerObjects[r.uuid])==null||i.forEach(n=>n.dispatchLeave()))}),t.length&&t.forEach(r=>{var i;r.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),(i=this.eventsPerObjects[r.uuid])==null||i.forEach(n=>n.dispatchEnter())}),this._prevObjects=t}},JFe=class{constructor(e,t,r,i,n,a){this.id=e,this.data=t,this.object=r,this.scrollCounter=0,this.actions=Hn(t,t.actions,i,n,a,r)}connect(){this.scrollCounter=0}disconnect(){Fn(this.actions)}dispatch(e){this.actions.Transition.forEach(i=>{i.object.currentTransitionEvent!==this&&(i.object.currentTransitionEvent=this,i.init())});let t=e>0?1:-1;this.scrollCounter+=t,this.scrollCounter=Math.min(Math.max(this.scrollCounter,0),this.data.steps);let r=this.scrollCounter/this.data.steps;this.actions.Transition.forEach(i=>i.seek(r)),this.actions.Animation.forEach(i=>i.seek(t)),this.actions.Create.forEach(i=>i.dispatchThrottled()),this.actions.SetVariable.forEach(i=>i.checkConditions()),this.actions.SetVariable.forEach(i=>i.dispatch()),this.actions.DynamicVariablePlay.forEach(i=>i.dispatch()),this.actions.ClearLocalStorage.forEach(i=>i.dispatch()),this.actions.UserAPI.forEach(i=>i.dispatch())}dispatchUserEvent(e){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),e?(this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.Animation.forEach(t=>t.reverseFromCurrent())):(this.actions.Transition.forEach(t=>{t.playFromCurrent()}),this.actions.Animation.forEach(t=>{t.playFromCurrent()})),this.actions.Create.forEach(t=>t.dispatchThrottled()),this.actions.SetVariable.forEach(t=>t.checkConditions()),this.actions.SetVariable.forEach(t=>t.dispatch()),this.actions.DynamicVariablePlay.forEach(t=>t.dispatch()),this.actions.ClearLocalStorage.forEach(t=>t.dispatch()),this.actions.UserAPI.forEach(t=>t.dispatch())}},e5e=class{constructor(e,t,r,i,n,a,o){this.id=e,this.data=t,this.object=r,this.domElement=a,this.eventManager=o,this.scrollStart=0,this.scrollEnd=0,this.actions=Hn(t,t.actions,i,n,o,r)}getStickyParentElement(){let e=this.domElement;for(;e;){if(window.getComputedStyle(e).position==="sticky")return e;e=e.parentElement}return null}computeScrollBounds(){let e=this.getStickyParentElement(),t=e==null?void 0:e.parentElement,r=this.domElement.getBoundingClientRect(),i={top:r.top,bottom:r.bottom,left:r.left,right:r.right,width:r.width,height:r.height};if(t){let c=t.getBoundingClientRect(),d=window.getComputedStyle(e),u=parseFloat(d.marginTop)+parseFloat(d.marginBottom),h=parseFloat(d.top),f=parseFloat(d.bottom),p=c.height-u;if(!isNaN(h))r.top===h?(i.top+=c.top-h,i.bottom+=c.top-h):r.top<0&&(i.top-=p-r.height,i.bottom-=p-r.height);else if(!isNaN(f)){let v=document.body.clientHeight??window.innerHeight,m=window.innerWidth-(document.documentElement.clientWidth??window.innerWidth);r.bottom===v-f?(i.top+=c.top-r.height+f+m,i.bottom+=c.top-r.height+f+m):r.bottom<v-f&&(i.top-=p-r.height,i.bottom-=p-r.height)}}let n=document.body,a=document.documentElement,o=window.pageYOffset||a.scrollTop||n.scrollTop,s=a.clientTop||n.clientTop||0,l=Math.round(i.top+o-s);if(this.data.startFrom==="enter"){let c=window.innerHeight,d=i.height,u=this.data.enterAnchor,h=u==="top"?c:u==="bottom"?c-d:c-d*.5;this.scrollStart=l-h}else this.scrollStart=0;this.scrollStart+=this.data.startOffset??0,this.scrollEnd=this.scrollStart+(this.data.endAfter??400),this.box=i,this.computeScroll({x:window.scrollX,y:window.scrollY})}connect(){this.computeScrollBounds()}disconnect(){Fn(this.actions)}handleResize(){this.computeScrollBounds()}get isInvalidBox(){return this.box===void 0||this.box.width===0&&this.box.height===0&&this.box.top===0&&this.box.bottom===0}computeScroll({x:e,y:t}){this.actions.Transition.forEach(n=>{n.object.currentTransitionEvent!==this&&(n.object.currentTransitionEvent=this,n.init())});let r=this.scrollEnd-this.scrollStart,i=Math.min(1,Math.max(0,(t-this.scrollStart)/r));this.actions.Transition.forEach(n=>n.seek(i)),this.actions.Animation.forEach(n=>n.seek(i)),this.actions.Create.forEach(n=>n.dispatchThrottled()),this.actions.SetVariable.forEach(n=>n.checkConditions()),this.actions.SetVariable.forEach(n=>n.dispatch()),this.actions.DynamicVariablePlay.forEach(n=>n.dispatch()),this.actions.ClearLocalStorage.forEach(n=>n.dispatch()),this.actions.UserAPI.forEach(n=>n.dispatch())}dispatch(e){this.isInvalidBox&&this.computeScrollBounds(),this.computeScroll(e)}dispatchUserEvent(e){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),e?(this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.Animation.forEach(t=>t.reverseFromCurrent())):(this.actions.Transition.forEach(t=>{t.playFromCurrent()}),this.actions.Animation.forEach(t=>{t.playFromCurrent()})),this.actions.Create.forEach(t=>t.dispatchThrottled()),this.actions.SetVariable.forEach(t=>t.checkConditions()),this.actions.SetVariable.forEach(t=>t.dispatch()),this.actions.DynamicVariablePlay.forEach(t=>t.dispatch()),this.actions.ClearLocalStorage.forEach(t=>t.dispatch()),this.actions.UserAPI.forEach(t=>t.dispatch())}},t5e=class extends to{constructor(e,t){super(e),this.managers=t,this.wheelEventsPerObject=new Map,this.scrollEventsPerObject=new Map,this.isInview=!0,this.handleResize=()=>{[...this.scrollEventsPerObject.entries()].forEach(([r,i])=>{i.forEach(n=>n.handleResize())})},this.onScroll=r=>{if(!this.isInview)return;let i={y:window.scrollY,x:window.scrollX};[...this.scrollEventsPerObject.entries()].forEach(([n,a])=>{n.dispatchEvent({type:"beginEvent",eventName:"Scroll",scroll:i}),a.forEach(o=>o.dispatch(i))})},this.onWheel=r=>{!this.isInview||r.ctrlKey||[...this.wheelEventsPerObject.entries()].forEach(([i,n])=>{i.dispatchEvent({type:"beginEvent",eventName:"Scroll",deltaY:r.deltaY}),n.forEach(a=>a.dispatch(r.deltaY))})},this.onUserEvent=({eventName:r,target:i,reverse:n})=>{var o;if(!r||!i)return;let a=a0(r);a&&a==="Scroll"&&(i.dispatchEvent({type:"beginEvent",eventName:"Scroll"}),(o=this.wheelEventsPerObject.get(i))==null||o.forEach(s=>{s.dispatchUserEvent(n)}))}}connect(){let{page:e,sharedAssets:t,domElement:r,isExport:i}=this.eventContext,n=a=>{var o,s,l;if((o=a.data)!=null&&o.events.length){for(let{id:c,data:d}of a.data.events)if(!d.disabled&&d.type==="Scroll")if(d.trigger==="load"||!i){let u=new JFe(c,d,a,e,t,this.managers);this.wheelEventsPerObject.has(a)?(s=this.wheelEventsPerObject.get(a))==null||s.push(u):this.wheelEventsPerObject.set(a,[u])}else{let u=new e5e(c,d,a,e,t,r,this.managers);this.scrollEventsPerObject.has(a)?(l=this.scrollEventsPerObject.get(a))==null||l.push(u):this.scrollEventsPerObject.set(a,[u])}}};e.traverseEntity(a=>{var o;(a instanceof ha||a instanceof Pn)&&((o=a.frame)==null||o.traverse(s=>{n(s)})),n(a)}),this.intersectionObserver=new IntersectionObserver(a=>{let o=a[0];o&&(this.isInview=o.isIntersecting)},{root:null}),this.intersectionObserver.observe(this.eventContext.domElement),[...this.wheelEventsPerObject.entries()].forEach(([a,o])=>{o.forEach(s=>s.connect()),a.addEventListener("userEvent",this.onUserEvent)}),[...this.scrollEventsPerObject.entries()].forEach(([a,o])=>{o.forEach(s=>s.connect()),a.addEventListener("userEvent",this.onUserEvent)}),[...this.wheelEventsPerObject.values()].some(a=>a.length)&&(this.domEventsNeeded.add("wheel"),window.addEventListener("wheel",this.onWheel)),[...this.scrollEventsPerObject.values()].some(a=>a.length)&&(this.domEventsNeeded.add("scroll"),window.addEventListener("scroll",this.onScroll),window.addEventListener("resize",this.handleResize))}disconnect(){window.removeEventListener("wheel",this.onWheel),window.removeEventListener("scroll",this.onScroll),window.removeEventListener("resize",this.handleResize),this.intersectionObserver.unobserve(this.eventContext.domElement),this.domEventsNeeded.clear(),[...this.wheelEventsPerObject.entries()].forEach(([e,t])=>{t.forEach(r=>r.disconnect()),e.removeEventListener("userEvent",this.onUserEvent)}),[...this.scrollEventsPerObject.entries()].forEach(([e,t])=>{t.forEach(r=>r.disconnect()),e.removeEventListener("userEvent",this.onUserEvent)})}},r5e=class{constructor(e,t,r,i,n,a){this.id=e,this.data=t,this.object=r,this.actions=Hn(t,t.actions,i,n,a,r)}disconnect(){Fn(this.actions)}dispatch(){this.actions.Transition.forEach(e=>{e.play()}),this.actions.Animation.forEach(e=>{e.play()}),this.actions.SwitchCamera.forEach(e=>{e.play()}),this.actions.SceneTransition.forEach(e=>{e.dispatch()}),this.actions.Reset.forEach(e=>e.dispatch()),this.actions.SetVariable.forEach(e=>e.checkConditions()),this.actions.SetVariable.forEach(e=>e.dispatch()),this.actions.DynamicVariablePlay.forEach(e=>e.dispatch()),this.actions.ClearLocalStorage.forEach(e=>e.dispatch()),this.actions.UserAPI.forEach(e=>e.dispatch()),this.actions.Create.forEach(e=>{e.dispatchFromStart()}),this.actions.Destroy.forEach(e=>{e.dispatchFromStart()})}dispatchAfter(e){this.actions.Audio.forEach(t=>{(t.interaction.data.triggerAfter??"any")===e&&(t.interaction instanceof Du?t.interaction.audioPlayer.play():t.interaction instanceof gE&&t.interaction.dispatch())}),this.actions.Video.forEach(t=>{let r=t.interaction.data.triggerAfter??"autoplay";r===e&&(t.interaction instanceof ep?t.interaction.play(r==="autoplay"):t.interaction instanceof wE&&t.interaction.dispatch())}),this.actions.Particles.forEach(t=>{(t.data.triggerAfter??"any")===e&&t.dispatchBasic()})}dispatchUserEvent(e){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),e?(this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.Animation.forEach(t=>t.reverseFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.reverseFromCurrent())):(this.actions.Transition.forEach(t=>t.playFromCurrent()),this.actions.Animation.forEach(t=>t.playFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.playFromCurrent())),this.actions.SceneTransition.forEach(t=>t.dispatch()),this.actions.Reset.forEach(t=>t.dispatch()),this.actions.SetVariable.forEach(t=>t.checkConditions()),this.actions.SetVariable.forEach(t=>t.dispatch()),this.actions.DynamicVariablePlay.forEach(t=>t.dispatch()),this.actions.ClearLocalStorage.forEach(t=>t.dispatch()),this.actions.UserAPI.forEach(t=>t.dispatch()),this.actions.Create.forEach(t=>{t.dispatch()}),this.actions.Destroy.forEach(t=>{t.dispatch()}),this.actions.Audio.forEach(t=>{t.interaction instanceof Du?t.interaction.audioPlayer.play():t.interaction instanceof gE&&t.interaction.dispatch()}),this.actions.Video.forEach(t=>{t.interaction instanceof ep?t.interaction.play():t.interaction instanceof wE&&t.interaction.dispatch()}),this.actions.Particles.forEach(t=>{t.dispatchBasic()})}},i5e=class extends to{constructor(e,t){super(e),this.eventManager=t,this.eventsPerObject=new Map,this.eventsAfterPerObject=new Map,this.onMouseDown=()=>{[...this.eventsAfterPerObject.entries()].forEach(([r,i])=>{r.dispatchEvent({type:"beginEvent",eventName:"Start"}),i.forEach(n=>{n.dispatchAfter("mouseDown")})})},this.onKeyDown=()=>{[...this.eventsAfterPerObject.entries()].forEach(([r,i])=>{r.dispatchEvent({type:"beginEvent",eventName:"Start"}),i.forEach(n=>{n.dispatchAfter("keyDown")})})},this.onAny=()=>{let{domElement:r,isExport:i}=this.eventContext,n=i?document:r;n.removeEventListener("pointerdown",this.onAny),n.removeEventListener("mousedown",this.onAny),document.removeEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach(([a,o])=>{a.dispatchEvent({type:"beginEvent",eventName:"Start"}),o.forEach(s=>{s.dispatchAfter("any")})})},this.onSceneTransitionAudioVideoPlay=()=>{[...this.eventsAfterPerObject.entries()].forEach(([r,i])=>{r.dispatchEvent({type:"beginEvent",eventName:"Start"}),i.forEach(n=>{n.actions.Audio.forEach(a=>{a.interaction instanceof Du&&a.interaction.audioPlayer.play()}),n.actions.Video.forEach(a=>{let o=a.interaction.data.triggerAfter??"autoplay";a.interaction instanceof ep&&a.interaction.play(o==="autoplay")}),n.actions.Particles.forEach(a=>{a.dispatchBasic()})})})},this.onPlay=()=>{[...this.eventsAfterPerObject.entries()].forEach(([r,i])=>{r.dispatchEvent({type:"beginEvent",eventName:"Start"}),i.forEach(n=>{n.dispatchAfter("autoplay")})})},this.onUserEvent=({eventName:r,target:i,reverse:n})=>{var o,s;if(!r||!i)return;let a=a0(r);a&&a==="Start"&&(i instanceof Nn||i.dispatchEvent({type:"beginEvent",eventName:"Start"}),(o=this.eventsPerObject.get(i))==null||o.forEach(l=>{l.dispatchUserEvent(n)}),(s=this.eventsAfterPerObject.get(i))==null||s.forEach(l=>{l.dispatchUserEvent(n)}))}}connect(){let{sharedAssets:e,page:t}=this.eventContext,r=i=>{var n,a,o,s,l;if((n=i.data)!=null&&n.events.length)for(let{id:c,data:d}of i.data.events){if(d.disabled||d.type!=="Start")continue;let u=new r5e(c,d,i,t,e,this.eventManager);(u.actions.Transition.length||u.actions.Animation.length||u.actions.SwitchCamera.length||u.actions.Create.length||u.actions.Destroy.length||u.actions.SceneTransition.length||u.actions.Reset.length||u.actions.SetVariable.length||u.actions.DynamicVariablePlay.length||u.actions.ClearLocalStorage.length||u.actions.UserAPI.length)&&(this.eventsPerObject.has(i)?(a=this.eventsPerObject.get(i))==null||a.push(u):this.eventsPerObject.set(i,[u])),u.actions.Audio.length&&(this.eventsAfterPerObject.has(i)?(o=this.eventsAfterPerObject.get(i))==null||o.push(u):this.eventsAfterPerObject.set(i,[u])),u.actions.Video.length&&(this.hasVideoAction=!0,this.eventsAfterPerObject.has(i)?(s=this.eventsAfterPerObject.get(i))==null||s.push(u):this.eventsAfterPerObject.set(i,[u])),u.actions.Particles.length&&(this.eventsAfterPerObject.has(i)?(l=this.eventsAfterPerObject.get(i))==null||l.push(u):this.eventsAfterPerObject.set(i,[u]))}};if(t.traverseEntity(i=>{var n;(i instanceof ha||i instanceof Pn)&&((n=i.frame)==null||n.traverse(a=>{r(a)})),r(i)}),[...this.eventsAfterPerObject.values()].some(i=>i.length)){if(this.eventManager.activateCount===0){let{domElement:i,isExport:n}=this.eventContext,a=n?document:i;a.addEventListener("pointerdown",this.onMouseDown,{once:!0}),a.addEventListener("mousedown",this.onMouseDown,{once:!0}),document.addEventListener("keydown",this.onKeyDown,{once:!0}),a.addEventListener("pointerdown",this.onAny),a.addEventListener("mousedown",this.onAny),document.addEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach(([o,s])=>{o.addEventListener("userEvent",this.onUserEvent)})}else this.onSceneTransitionAudioVideoPlay();this.onPlay()}[...this.eventsPerObject.entries()].forEach(([i,n])=>{i.dispatchEvent({type:"beginEvent",eventName:"Start"}),n.forEach(a=>a.dispatch()),i.addEventListener("userEvent",this.onUserEvent)})}disconnect(){if([...this.eventsAfterPerObject.values()].some(e=>e.length)){let{domElement:e,isExport:t}=this.eventContext,r=t?document:e;r.removeEventListener("pointerdown",this.onMouseDown),r.removeEventListener("mousedown",this.onMouseDown),document.removeEventListener("keydown",this.onKeyDown),r.removeEventListener("pointerdown",this.onAny),r.removeEventListener("mousedown",this.onAny),document.removeEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach(([i,n])=>{i.removeEventListener("userEvent",this.onUserEvent),n.forEach(a=>a.disconnect())})}[...this.eventsPerObject.entries()].forEach(([e,t])=>{e.removeEventListener("userEvent",this.onUserEvent),t.forEach(r=>r.disconnect())}),this.eventsPerObject.clear(),this.eventsAfterPerObject.clear()}},n5e=class{constructor(e,t,r,i,n,a){this.id=e,this.data=t,this.object=r,this.initialDisabled=!1,this.actions=Hn(t,t.actions,i,n,a,r),this.target=t.target}disconnect(){Fn(this.actions)}dispatch(e){this.initialDisabled||(this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),this.object.dispatchEvent({type:"beginEvent",eventName:"Collision"}),this.actions.Transition.forEach(t=>{t.data.runMode==="Toggle"?t.toggle():t.play()}),this.actions.Animation.forEach(t=>{t.data.runMode==="Toggle"?t.toggle():t.play()}),this.actions.Reset.forEach(t=>{t.dispatch()}),this.actions.Link.forEach(t=>{t.dispatch()}),this.actions.Reset.forEach(t=>{t.dispatch()}),this.actions.Create.forEach(t=>{t.dispatch()}),this.actions.Destroy.forEach(t=>{t.dispatch(e??!1)}),this.actions.SetVariable.forEach(t=>t.checkConditions()),this.actions.SetVariable.forEach(t=>t.dispatch()),this.actions.DynamicVariablePlay.forEach(t=>t.dispatch()),this.actions.Audio.forEach(t=>{t.dispatchBasic()}),this.actions.Particles.forEach(t=>{t.dispatchBasic()}),this.actions.Video.forEach(t=>{t.dispatchBasic()}),this.actions.ClearLocalStorage.forEach(t=>t.dispatch()),this.actions.UserAPI.forEach(t=>t.dispatch()))}},a5e=class extends to{constructor(e,t,r,i,n){super(e),this.sharedVariables=t,this.eventManager=r,this.needsMouse=i,this.needsRaycast=n,this.dynamicVars=[],this.variablesToWatch=[],this.prevMouseProperty=null,this.prevRaycastProperty=null,this.pauseTime=0,this.isOutOfFocus=!1,this.events=[],this.onFrame=a=>{let o=this.eventContext.sharedAssets;if(this.rafId=window.requestAnimationFrame(this.onFrame),this.isOutOfFocus)return;let s=new Date,l=[],c=[];for(let h=0;h<this.propertiesToWatch.length;h++){let{objectId:f,property:p,prevValue:v}=this.propertiesToWatch[h],m=this.eventContext.scene.find(f),g=iM.propertyPaths[p];if(g[0]==="width"||g[0]==="height"||g[0]==="depth")m=m.geometry.userData.parameters[g[0]];else for(let y=0;y<g.length;y++)m=m[g[y]];v===null?this.propertiesToWatch[h].prevValue=m instanceof k?m.clone():m:(m instanceof k?!m.equals(v):v!==m)&&(c.push({objId:f,property:p}),m instanceof k?this.propertiesToWatch[h].prevValue.copy(m):this.propertiesToWatch[h].prevValue=m)}for(let h=0;h<this.variablesToWatch.length;h++){let{id:f,prevValue:p}=this.variablesToWatch[h],v=o.getVariable(f);v!==p&&(l.push(f),this.variablesToWatch[h].prevValue=v)}for(let h=0;h<this.dynamicVars.length;h++){let{id:f,expectedTime:p,last:v,data:m,timerSeconds:g,startValue:y}=this.dynamicVars[h],b=1e3;if((m.dynamicVariableType==="timer"||m.dynamicVariableType==="stopwatch")&&m.format==="number3decimal"?b=1:m.dynamicVariableType==="counter"?b=m.updateInterval:m.dynamicVariableType==="random"&&(b=m.isStatic?1/0:m.updateInterval),p===-1){this.dynamicVars[h].last=a,this.dynamicVars[h].expectedTime=a+b;continue}if(!((o.getDynamicVariablePlayState(f)==="Stopped"||o.getDynamicVariablePlayState(f)==="Restarted")&&(this.dynamicVars[h].last=a,this.dynamicVars[h].expectedTime=a+b,m.dynamicVariableType==="counter"&&o.getVariable(f)!==y&&(o.updateVariable(f,y),this.eventManager.requestRender()),(m.dynamicVariableType==="timer"||m.dynamicVariableType==="stopwatch")&&this.dynamicVars[h].timerSeconds!==y&&(this.dynamicVars[h].timerSeconds=y,o.updateVariable(f,_o.getFormattedTimerTime(y,m)),this.eventManager.requestRender()),o.getDynamicVariablePlayState(f)==="Restarted"&&o.setDynamicVariablePlayState(f,"Playing"),o.getDynamicVariablePlayState(f)==="Stopped"))){if(o.getDynamicVariablePlayState(f)==="Paused"){this.dynamicVars[h].deltaToExpectedTime===void 0&&(this.dynamicVars[h].deltaToExpectedTime=Math.max(this.dynamicVars[h].expectedTime-a,0)),this.dynamicVars[h].last=a-(b-this.dynamicVars[h].deltaToExpectedTime),this.dynamicVars[h].expectedTime=a+this.dynamicVars[h].deltaToExpectedTime;continue}else this.dynamicVars[h].deltaToExpectedTime=void 0;if(a>=p)if(this.dynamicVars[h].last=a,this.dynamicVars[h].expectedTime+=b,m.dynamicVariableType==="random"){let x=m.min+Math.random()*(m.max-m.min),S=m.decimals;x=Math.round(x*Math.pow(10,S))/Math.pow(10,S),o.updateVariable(f,x),l.push(f),this.eventManager.requestRender()}else if(m.dynamicVariableType==="counter"){let x=o.getVariable(f),S=o.getDynamicVariableToggleIsForward(f)??!0,w=o.getVariable(f)+m.increment*(S?1:-1);m.hasEnd&&(w=m.increment>0?St.clamp(w,y,m.endValue):St.clamp(w,m.endValue,y),w===y&&o.setDynamicVariableToggleIsForward(f,void 0),m.repeat?w===m.endValue&&(w=y):(w===y||w===m.endValue)&&o.setDynamicVariablePlayState(f,"Paused")),w!==x&&(l.push(f),o.updateVariable(f,w),this.eventManager.requestRender())}else if(m.dynamicVariableType==="time"){let x=o.getVariable(f),S=sB(s,m);if(typeof x=="object"&&"textValue"in x&&typeof S=="object"&&"textValue"in S){if(Array.isArray(x.textValue)&&Array.isArray(S.textValue)){if(x.textValue.every((w,_)=>w===S.textValue[_]))continue}else if(x.textValue===S.textValue)continue}else if(x===S)continue;o.updateVariable(f,S),l.push(f),this.eventManager.requestRender()}else{let x=ta.isTextValue(m.endValue)?H4(m.endValue.textValue):m.endValue,S=o.getDynamicVariableToggleIsForward(f)??!0,w=g+(a-v)/1e3*(m.dynamicVariableType==="timer"?-1:1)*(S?1:-1);w=Math.max(w,0),m.hasEnd&&(w=m.dynamicVariableType==="stopwatch"?St.clamp(w,y,x):St.clamp(w,x,y),w===y&&o.setDynamicVariableToggleIsForward(f,void 0),m.repeat?Math.abs(w-x)<(m.format==="number3decimal"?1e-4:.1)&&(w=y):(Math.abs(w-y)<(m.format==="number3decimal"?1e-4:.1)||Math.abs(w-x)<(m.format==="number3decimal"?1e-4:.1))&&o.setDynamicVariablePlayState(f,"Paused")),w!==g&&(l.push(f),this.dynamicVars[h].timerSeconds=w,o.updateVariable(f,_o.getFormattedTimerTime(w,m)),this.eventManager.requestRender())}}}let d=!1;o.mouseProperty!==this.prevMouseProperty&&(this.prevMouseProperty=o.mouseProperty,d=!0);let u=!1;o.raycastProperty!==this.prevRaycastProperty&&(this.prevRaycastProperty=o.raycastProperty,u=!0),this.events.forEach(h=>{(l.includes(h.data.variableId)||c.find(f=>f.objId===h.data.objectId&&f.property===h.data.property)||h.data.variableId==="mouseProperty"&&d||h.data.variableId==="raycastProperty"&&u)&&(h.dispatch(),this.eventManager.requestRender())})},this.onBlur=()=>{this.pause()},this.onFocus=()=>{this.resume()}}pause(){this.isOutOfFocus||(this.isOutOfFocus=!0,this.pauseTime=Date.now())}resume(){if(!this.isOutOfFocus)return;this.isOutOfFocus=!1;let e=Date.now()-this.pauseTime;for(let t=0;t<this.dynamicVars.length;t++)this.dynamicVars[t].last+=e,this.dynamicVars[t].expectedTime+=e}connect(){this.eventContext.page.traverseEntity(t=>{var r;(r=t.data)==null||r.events.filter(i=>i.data.type==="VariableChange"&&!i.data.disabled).forEach(i=>{this.events.push(new o5e(i.id,i.data,t,this.eventContext.page,this.eventContext.sharedAssets,this.eventManager))})}),this.propertiesToWatch=this.events.filter(t=>t.data.variableId==="objectProperty"&&t.data.objectId!==null).map(t=>({objectId:t.data.objectId,property:t.data.property,prevValue:null}));let e=this.eventContext.sharedAssets;this.sharedVariables.forEach(({id:t,data:r})=>{if(!("dynamicVariableType"in r)){this.events.find(n=>n.data.variableId===t)&&this.variablesToWatch.push({id:t,prevValue:e.getVariable(t)});return}let i;if(r.dynamicVariableType==="timer"||r.dynamicVariableType==="stopwatch"){let n;if(ta.isTextValue(r.value)&&Array.isArray(r.value.textValue)){let a=r.value.textValue;a.length===3?n=a[2]+a[1]*60+a[0]*3600:n=a[1]+a[0]*60}else n=r.value;i=n,this.dynamicVars.push({id:t,last:-1,expectedTime:-1,data:r,timerSeconds:n,startValue:i})}else r.dynamicVariableType==="time"&&e.updateVariable(t,sB(new Date,r)),r.dynamicVariableType==="counter"&&(i=ta.isTextValue(r.value)?H4(r.value.textValue):r.value),this.dynamicVars.push({id:t,last:-1,expectedTime:-1,data:r,startValue:i})}),this.rafId=window.requestAnimationFrame(this.onFrame),window.addEventListener("blur",this.onBlur),window.addEventListener("focus",this.onFocus)}disconnect(){window.removeEventListener("blur",this.onBlur),window.removeEventListener("focus",this.onFocus),this.rafId&&(window.cancelAnimationFrame(this.rafId),this.rafId=void 0),this.events.forEach(e=>e.dispose())}},o5e=class{constructor(e,t,r,i,n,a){this.id=e,this.data=t,this.object=r,this.actions=Hn(t,t.actions,i,n,a,r)}dispatch(){let e=this.actions;e.Audio.forEach(t=>t.dispatchConditional()),e.Particles.forEach(t=>t.dispatchConditional()),e.Video.forEach(t=>t.dispatchConditional()),e.Create.forEach(t=>t.dispatch()),e.Destroy.forEach(t=>t.dispatch()),e.Reset.forEach(t=>t.dispatch()),e.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this),t.init()}),e.Transition.forEach(t=>t.play()),e.Animation.forEach(t=>t.play()),e.SwitchCamera.forEach(t=>t.play()),e.SceneTransition.forEach(t=>t.dispatch()),e.SetVariable.forEach(t=>t.checkConditions()),e.SetVariable.forEach(t=>t.dispatch()),e.DynamicVariablePlay.forEach(t=>t.dispatch()),e.ClearLocalStorage.forEach(t=>t.dispatch()),e.UserAPI.forEach(t=>t.dispatch())}dispose(){Fn(this.actions)}};function H4(e){return e.length===3?e[2]+e[1]*60+e[0]*3600:e[1]+e[0]*60}var s5e="https://unpkg.com/@splinetool/runtime@1.9.21/build/",l5e="https://unpkg.com/@splinetool/navmesh-wasm@1.9.21/build/",c5e=`
(async function() {
	const [wasmImport, wasmBinary] = await Promise.all([
		import('${s5e}' + 'navmesh.js'),
		fetch('${l5e}' + 'navmesh.wasm').then((res) => res.arrayBuffer()),
	]);
	const wasmModule = wasmImport.default;
	self.module = await wasmModule({ wasmBinary });
	postMessage('ready');
})();
`,d5e=`
(async function() {
	const [wasmImport, wasmBinary] = await Promise.all([
		import(self.location.origin + '/_libraries/navmesh.js'),
		fetch(self.location.origin + '/_libraries/navmesh.wasm').then((res) => res.arrayBuffer()),
	]);
	const wasmModule = wasmImport.default;
	self.module = await wasmModule({ wasmBinary });
	postMessage('ready');
})();
`,u5e=`

onmessage = function(messageEvent) {
	const meshData = messageEvent.data;
	const positions = meshData[0];
	const offset = meshData[1];
	const indices = meshData[2];
	const indicesLength = meshData[3];
	const parameters = meshData[4];

	const module = self.module;
	const rc = new module.rcConfig();
	rc.cs = parameters.cs;
	rc.ch = parameters.ch;
	rc.borderSize = parameters.borderSize ? parameters.borderSize : 0;
	rc.tileSize = parameters.tileSize ? parameters.tileSize : 0;
	rc.walkableSlopeAngle = parameters.walkableSlopeAngle;
	rc.walkableHeight = parameters.walkableHeight;
	rc.walkableClimb = parameters.walkableClimb;
	rc.walkableRadius = parameters.walkableRadius;
	rc.maxEdgeLen = parameters.maxEdgeLen;
	rc.maxSimplificationError = parameters.maxSimplificationError;
	rc.minRegionArea = parameters.minRegionArea;
	rc.mergeRegionArea = parameters.mergeRegionArea;
	rc.maxVertsPerPoly = parameters.maxVertsPerPoly;
	rc.detailSampleDist = parameters.detailSampleDist;
	rc.detailSampleMaxError = parameters.detailSampleMaxError;

	if (!self.navMesh) {
		self.navMesh = new module.NavMesh();
	}
	self.navMesh.build(positions, offset, indices, indicesLength, rc);

	const navmeshData = navMesh.getNavmeshData();
	const arrView = new Uint8Array(module.HEAPU8.buffer, navmeshData.dataPointer, navmeshData.size);
	const ret = new Uint8Array(navmeshData.size);
	ret.set(arrView);
	navMesh.freeNavmeshData(navmeshData);

	postMessage(ret);
}
`,h5e=.001,f5e={cs:6,ch:2,walkableSlopeAngle:90,walkableHeight:20,walkableClimb:5,walkableRadius:0,maxEdgeLen:12,maxSimplificationError:1.3,minRegionArea:8,mergeRegionArea:20,maxVertsPerPoly:6,detailSampleDist:6,detailSampleMaxError:1},KW,xr,$n;LTe.then(e=>{KW=e,xr=new e.Vec3,$n=new e.Vec3});var p5e=new k,m5e=class{constructor(e=!1,t=!1){this.usePhysics=e,this.isExport=t,this.onPointerDown=r=>{if(Ht.length!==1)return;let{raycaster:i,page:n}=this.eventContext;this.eventContext.updateRaycaster(r);let a=n.raycastWithClones(i);if(a.length!==0){if(this.gameControl){let o=p5e.copy(this.gameControl.colliderWorldPosition);o.y-=this.gameControl.colliderHeight/2,this.gameControl.path=this.computePath(o,a[0].point)}this.eventContext.requestRender()}},this.traverseWithPhysics=(r,i)=>n=>{var h,f,p,v,m,g,y;let a;if(n instanceof ns)if(n.objectForSample){if(n.objectForSample.dataPatched.physics.fusedBody)return;a=n.object}else return n.object.dataPatched.physics.fusedBody===!0&&n.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(n instanceof pa)a=n.object;else if(a=n,((h=a.dataPatched.cloner)==null?void 0:h.disabled)===!1&&((f=a.dataPatched.cloner)==null?void 0:f.hideBase)&&((p=a.dataPatched.physics)==null?void 0:p.fusedBody)!==!0)return!0;if(i&&!a.userData.navmesh)return;let o=a.dataPatched;if(!o.visible&&((v=o.physics)==null?void 0:v.enabled)!==!0)return!0;n.updateMatrixWorldSVD();let s=c1(o),l=a.userData.hasDestroy,c=a.userData.hasDrag,d=!1,u=!1;for(let b of o.events)b.data.disabled!==!0&&(b.data.type==="GameControl"?d=!0:b.data.type==="Follow"&&(u=!0));if(d||s||u||l||c)return!0;if(this.usePhysics&&((m=o.physics)==null?void 0:m.rigidBody)==="dynamic"){if(this.usePhysics&&((g=o.physics)!=null&&g.fusedBody))return!0}else if("geometry"in n&&n.geometry&&r.push(Nl(n.geometry,n.matrixWorld)),this.usePhysics&&((y=o.physics)==null?void 0:y.fusedBody))return n.traverseObject((b,x)=>{var _,C;if(x===0)return;let S;if(b instanceof ns)if(b.objectForSample){if(b.objectForSample.dataPatched.physics.fusedBody)return;S=b.object}else return b.object.dataPatched.physics.fusedBody===!0&&b.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(b instanceof pa)S=b.object;else if(S=b,(_=b.dataPatched.cloner)==null?void 0:_.hideBase)return!0;let w=S.dataPatched;if(!w.visible&&((C=w.physics)==null?void 0:C.enabled)!==!0)return!0;"geometry"in b&&b.geometry&&r.push(Nl(b.geometry,b.matrixWorld))}),!0},this.traverseNoPhysics=(r,i)=>n=>{let a;if(n instanceof ns)return;n instanceof pa?a=n.object:a=n;let o=a.dataPatched;if(o.physics.enabled==="visibility"?!o.visible:!o.physics.enabled)return!0;if(i&&!a.userData.navmesh)return;let s=n.geometry,l=a.userData.hasDestroy===!0,c=a.userData.hasDrag===!0;if(c1(o)||l||c||a.dataPatched.events.some(d=>d.data.disabled!==!0&&d.data.type==="GameControl"))return!0;s&&r.push(Nl(s,n.matrixWorld))},this.navmeshWasm=KW,this.navMesh=new this.navmeshWasm.NavMesh,this._workerURL=URL.createObjectURL(new Blob([(t?c5e:d5e)+u5e])),this._worker=new Worker(this._workerURL)}init(e,t,r){this.gameControl=t,this.eventContext=r,this.setDefaultQueryExtent(new k().setScalar(e.ch*e.walkableRadius*1.2)),this._worker.onmessage=()=>{this.createNavMesh(r.page,e,i=>{this.buildFromNavmeshData(i.data)})},this.eventContext.renderer.domElement.addEventListener("pointerdown",this.onPointerDown)}createNavMesh(e,t,r){t.objects.forEach(l=>{var d;let c=e.scene.find(l);c.traverseEntity(u=>{u.userData.navmesh=!0}),(d=c.cloner)==null||d.traverseObject(u=>{u.userData.navmesh=!0})});let i=[],n=(this.usePhysics?this.traverseWithPhysics:this.traverseNoPhysics)(i,t.zones==="custom");if(e.traverseChildren(n),t.objects.forEach(l=>{var d;let c=e.scene.find(l);c.traverseEntity(u=>{u.userData.navmesh=void 0}),(d=c.cloner)==null||d.traverseObject(u=>{u.userData.navmesh=void 0})}),i.length===0)return!1;let a=Pu(i),{positions:o,triIndices:s}=pw(a.getAttribute("position"),a.getIndex());return this._worker.postMessage([o,o.length/3,s,s.length,{...f5e,...t}]),this._worker.onmessage=r,!0}createDebugNavGeometry(){let e,t,r=this.navMesh.getDebugNavMesh(),i=r.getTriangleCount(),n=new Uint32Array(i*3),a=new Float32Array(i*3*3);for(e=0;e<i*3;e++)n[e]=e;for(e=0;e<i;e++)for(t=0;t<3;t++){let s=r.getTriangle(e).getPoint(t);a[e*9+t*3+0]=s.x,a[e*9+t*3+1]=s.y,a[e*9+t*3+2]=s.z}let o=new Ot;return o.setIndex(new $t(n,1)),o.setAttribute("position",new $t(a,3)),o}getClosestPoint(e){return xr.x=e.x,xr.y=e.y,xr.z=e.z,this.navMesh.getClosestPoint(xr)}getClosestPointToRef(e,t){xr.x=e.x,xr.y=e.y,xr.z=e.z;let r=this.navMesh.getClosestPoint(xr);t.set(r.x,r.y,r.z)}getRandomPointAround(e,t){return xr.x=e.x,xr.y=e.y,xr.z=e.z,this.navMesh.getRandomPointAround(xr,t)}getRandomPointAroundToRef(e,t,r){xr.x=e.x,xr.y=e.y,xr.z=e.z;let i=this.navMesh.getRandomPointAround(xr,t);r.set(i.x,i.y,i.z)}moveAlong(e,t){return xr.x=e.x,xr.y=e.y,xr.z=e.z,$n.x=t.x,$n.y=t.y,$n.z=t.z,this.navMesh.moveAlong(xr,$n)}moveAlongToRef(e,t,r){return xr.x=e.x,xr.y=e.y,xr.z=e.z,$n.x=t.x,$n.y=t.y,$n.z=t.z,this.navMesh.moveAlong(xr,$n)}computePath(e,t){let r=this.getClosestPoint(t);if($n.x=r.x,$n.y=r.y,$n.z=r.z,Math.sqrt(Math.pow(t.x-r.x,2)+Math.pow(t.y-r.y,2)+Math.pow(t.z-r.z,2))>this.getDefaultQueryExtent().y)return[];this.getClosestPoint(e);let i=this.navMesh.computePath(xr,$n),n=i.getPointCount(),a=[];for(let o=0;o<n;o++){let s=i.getPoint(o);a.push(new k(s.x,s.y,s.z))}return a}createCrowd(e,t){return new v5e(this,e,t)}setDefaultQueryExtent(e){xr.x=e.x,xr.y=e.y,xr.z=e.z,this.navMesh.setDefaultQueryExtent(xr)}getDefaultQueryExtent(){return this.navMesh.getDefaultQueryExtent()}buildFromNavmeshData(e){let t=e.length*e.BYTES_PER_ELEMENT,r=this.navmeshWasm._malloc(t),i=new Uint8Array(this.navmeshWasm.HEAPU8.buffer,r,t);i.set(e);let n=new this.navmeshWasm.NavmeshData;n.dataPointer=i.byteOffset,n.size=e.length,this.navMesh.buildFromNavmeshData(n),this.navmeshWasm._free(i.byteOffset)}getNavmeshData(){let e=this.navMesh.getNavmeshData(),t=new Uint8Array(this.navmeshWasm.HEAPU8.buffer,e.dataPointer,e.size),r=new Uint8Array(e.size);return r.set(t),this.navMesh.freeNavmeshData(e),r}getDefaultQueryExtentToRef(e){let t=this.navMesh.getDefaultQueryExtent();e.set(t.x,t.y,t.z)}dispose(){var e;this.navMesh.destroy(),this._worker.terminate(),URL.revokeObjectURL(this._workerURL),(e=this.eventContext)==null||e.renderer.domElement.removeEventListener("pointerdown",this.onPointerDown)}addCylinderObstacle(e,t,r){return xr.x=e.x,xr.y=e.y,xr.z=e.z,this.navMesh.addCylinderObstacle(xr,t,r)}addBoxObstacle(e,t,r){return xr.x=e.x,xr.y=e.y,xr.z=e.z,$n.x=t.x,$n.y=t.y,$n.z=t.z,this.navMesh.addBoxObstacle(xr,$n,r)}removeObstacle(e){this.navMesh.removeObstacle(e)}isSupported(){return this.navmeshWasm!==void 0}},v5e=class{constructor(e,t,r){this.navmeshWasmWrapper=e,this.transforms=[],this.agents=new Array,this.reachRadii=new Array,this._agentDestinationArmed=new Array,this._agentDestination=new Array,this.crowd=new this.navmeshWasmWrapper.navmeshWasm.Crowd(t,r,this.navmeshWasmWrapper.navMesh.getNavMesh())}onReachTarget(e,t){}addAgent(e,t,r){let i=new this.navmeshWasmWrapper.navmeshWasm.dtCrowdAgentParams;i.radius=t.radius,i.height=t.height,i.maxAcceleration=t.maxAcceleration,i.maxSpeed=t.maxSpeed,i.collisionQueryRange=t.collisionQueryRange,i.pathOptimizationRange=t.pathOptimizationRange,i.separationWeight=t.separationWeight,i.updateFlags=7,i.obstacleAvoidanceType=0,i.queryFilterType=0,i.userData=0;let n=this.crowd.addAgent(new this.navmeshWasmWrapper.navmeshWasm.Vec3(e.x,e.y,e.z),i);return this.transforms.push(r),this.agents.push(n),this.reachRadii.push(t.reachRadius?t.reachRadius:t.radius),this._agentDestinationArmed.push(!1),this._agentDestination.push(new k(0,0,0)),n}getAgentPosition(e){return this.crowd.getAgentPosition(e)}getAgentPositionToRef(e,t){let r=this.crowd.getAgentPosition(e);t.set(r.x,r.y,r.z)}getAgentVelocity(e){return this.crowd.getAgentVelocity(e)}getAgentVelocityToRef(e,t){let r=this.crowd.getAgentVelocity(e);t.set(r.x,r.y,r.z)}getAgentNextTargetPath(e){return this.crowd.getAgentNextTargetPath(e)}getAgentNextTargetPathToRef(e,t){let r=this.crowd.getAgentNextTargetPath(e);t.set(r.x,r.y,r.z)}getAgentState(e){return this.crowd.getAgentState(e)}overOffmeshConnection(e){return this.crowd.overOffmeshConnection(e)}agentGoto(e,t){this.crowd.agentGoto(e,new this.navmeshWasmWrapper.navmeshWasm.Vec3(t.x,t.y,t.z));let r=this.agents.indexOf(e);r>-1&&(this._agentDestinationArmed[r]=!0,this._agentDestination[r].set(t.x,t.y,t.z))}agentTeleport(e,t){this.crowd.agentTeleport(e,new this.navmeshWasmWrapper.navmeshWasm.Vec3(t.x,t.y,t.z))}updateAgentParameters(e,t){let r=this.crowd.getAgentParameters(e);t.radius!==void 0&&(r.radius=t.radius),t.height!==void 0&&(r.height=t.height),t.maxAcceleration!==void 0&&(r.maxAcceleration=t.maxAcceleration),t.maxSpeed!==void 0&&(r.maxSpeed=t.maxSpeed),t.collisionQueryRange!==void 0&&(r.collisionQueryRange=t.collisionQueryRange),t.pathOptimizationRange!==void 0&&(r.pathOptimizationRange=t.pathOptimizationRange),t.separationWeight!==void 0&&(r.separationWeight=t.separationWeight),this.crowd.setAgentParameters(e,r)}removeAgent(e){this.crowd.removeAgent(e);let t=this.agents.indexOf(e);t>-1&&(this.agents.splice(t,1),this.transforms.splice(t,1),this.reachRadii.splice(t,1),this._agentDestinationArmed.splice(t,1),this._agentDestination.splice(t,1))}getAgents(){return this.agents}update(e){if(this.navmeshWasmWrapper.navMesh.update(),e<=h5e)return;let t=1/60,r=10;{let i=Math.floor(e/t);i>r&&(i=r),i<1&&(i=1);let n=e/i;for(let a=0;a<i;a++)this.crowd.update(n)}for(let i=0;i<this.agents.length;i++){let n=this.agents[i],a=this.getAgentPosition(n);if(this.transforms[i].copy(a),this._agentDestinationArmed[i]){let o=a.x-this._agentDestination[i].x,s=a.z-this._agentDestination[i].z,l=this.reachRadii[i],c=this._agentDestination[i].y-this.reachRadii[i],d=this._agentDestination[i].y+this.reachRadii[i],u=o*o+s*s;a.y>c&&a.y<d&&u<l*l&&(this.onReachTarget(n,this._agentDestination[i]),this._agentDestinationArmed[i]=!1)}}}setDefaultQueryExtent(e){let t=new this.navmeshWasmWrapper.navmeshWasm.Vec3(e.x,e.y,e.z);this.crowd.setDefaultQueryExtent(t)}getDefaultQueryExtent(){return this.crowd.getDefaultQueryExtent()}getDefaultQueryExtentToRef(e){let t=this.crowd.getDefaultQueryExtent();e.set(t.x,t.y,t.z)}getCorners(e){let t,r=this.crowd.getCorners(e),i=r.getPointCount(),n=[];for(t=0;t<i;t++){let a=r.getPoint(t);n.push(new k(a.x,a.y,a.z))}return n}dispose(){this.crowd.destroy()}};function g5e(e){let t=!1;return e.scene.objects.forEach(r=>{r.data.type==="Page"&&!t&&r.data.publish.gameControlObject&&vg.traverseModuleInstances(e,r.id,(i,n,a)=>{for(let o of a)o.data.type==="GameControl"&&o.data.navmesh.enabled&&(t=!0)})}),t}var y5e={type:"change"},W4={type:"changeZoom"},b5e={type:"changePan"},tu={type:"start"},ru={type:"end",changed:!0},x5e={type:"end",changed:!1},__=new Xt,G4=new ye,w5e=2*Math.PI,S5e=1e-8,C5e=.01,A_=new k,eb=new ye,M_=new k,tb=new Xt,$4=new it,_5e={type:"requestRender"},QW=class extends aa{constructor(e,t,r={isPlayMode:!1,isExport:!1}){super(),this.object=e,this.domElement=t,this.options=r,this.enabled=!0,this.useKeyEvents=!0,this.enableDamping=!1,this.enableZoom=!0,this.enableRotate=!0,this.enablePan=!0,this.autoRotate=!1,this.rotationLimitsMode=0,this.panLimitsMode=0,this.rotationSoftLimit=2,this.panSoftLimit=2,this.hoverRotatePanMode=0,this.zoomLimitsEnabled=!1,this.mouseButtons=[0,5],this.mouseButtonsPlay=[3,4,5],this.touches=[null,po.DOLLY_ROTATE,po.PAN],this.offset=new k,this.eye=new k,this.lastPosition=new k,this.lastQuaternion=new Xt,this.current=new ye,this.overShoot=new ye,this.overRatio=new ye,this.spherical=new Az,this.sphericalDelta=new Az,this.panOffset=new k,this.panLeftV=new k,this.panUpV=new k,this.panV=new k,this.rotateStart=new ye,this.rotateEnd=new ye,this.rotateDelta=new ye,this.panStart=new ye,this.panEnd=new ye,this.panDelta=new ye,this.dollyStart=new ye,this.dollyEnd=new ye,this.dollyDelta=new ye,this.rotationRangeFactor=new ye,this.panRangeFactor=new ye,this.state=-1,this.zoomChanged=!1,this.isPointerDown=!1,this.isThetaFlipped=!1,this.prevScale=0,this.scale=1,this.gesture=!1,this.timer=-1,this.timerHover=-1,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPhi=0,this.maxPhi=Math.PI,this.minTheta=-1/0,this.maxTheta=1/0,this.minH=0,this.maxH=Math.PI,this.minV=-1/0,this.maxV=1/0,this.autoRotateClockwise=!0,this.isPanOverShoot=!1,this.isRotateOverShoot=!1,this.resetHoverEffectOnPointerLeave=!1,this.hasChange=!1,this.useWindowEvents=!1,this.isTouchZoom=!0,this.autoRotateSpeed=2,this.dampingFactor=.125,this.zoomSpeed=2,this.rotateSpeed=1,this.panSpeed=1,this.hoverRotatePanStrength=.1,this.hoverRotateDamping=this.dampingFactor,this.thetaIsFree=!1,this.phiIsFree=!1,this.needsUpdate=!0,this.onCameraChange=i=>{this.object.removeEventListener("beginState",this.onBeginState),this.object.removeEventListener("completeState",this.onCompleteState),this.object.removeEventListener("cameraChange",this.onCameraChange),this.object=i.camera,this.object.addEventListener("beginState",this.onBeginState),this.object.addEventListener("completeState",this.onCompleteState),this.object.addEventListener("cameraChange",this.onCameraChange)},this.update=()=>{this.object.updateWorldMatrix(!0,!1),this.object.matrixWorld.decompose(M_,tb,A_),this.offset.copy(M_).sub(this.target),this.spherical.setFromVector3(this.offset),this.object.isUpVectorFlipped&&(this.spherical.phi*=-1,this.spherical.theta-=Math.PI),this.autoRotate&&this.state===-1&&this.rotateLeft((this.autoRotateClockwise===!0?1:-1)*this.getAutoRotationAngle()),this.rotationLimitsMode!==0&&this.applyLimits(this.sphericalDelta,this.rotationLimitsMode,this.rotationSoftLimit,this.maxTheta,this.minTheta,this.maxPhi,this.minPhi,this.rotationRangeFactor),this.rotationLimitsMode!==2&&(this.spherical.phi+=this.sphericalDelta.phi),(this.rotationLimitsMode!==1||this.autoRotate===!0)&&(this.spherical.theta+=this.sphericalDelta.theta),this.spherical.radius*=this.scale,this.zoomLimitsEnabled&&this.object.isPerspectiveCamera&&(this.spherical.radius=Math.max(this.minDistance,Math.min(this.maxDistance,this.spherical.radius))),this.panLimitsMode!==0&&(this.target.applyQuaternion(__.copy(tb).invert()),this.panOffset.applyQuaternion(__),this.applyLimits(this.panOffset,this.panLimitsMode,this.panSoftLimit,this.maxH,this.minH,this.maxV,this.minV,this.panRangeFactor),this.target.applyQuaternion(tb),this.panOffset.applyQuaternion(tb)),this.panLimitsMode===2&&(this.panOffset.y=0),this.panLimitsMode===1&&(this.panOffset.x=0),this.state===-1&&!this.gesture?(this.panOffset.multiplyScalar(1-this.dampingFactor),this.target.add(this.panOffset)):(this.target.add(this.panOffset),this.panOffset.set(0,0,0)),this.offset.setFromSpherical(this.spherical),M_.copy(this.target).add(this.offset),this.object.position.copy(this.target).add(this.offset),this.object.parent&&($4.copy(this.object.parent.matrixWorld).invert(),this.object.position.applyMatrix4($4));let i=this.spherical.phi%w5e;if(this.eye.copy(this.offset).normalize(),this.object.up.copy(Yr.DEFAULT_UP).applyAxisAngle(this.eye,this.object.angleOffsetFromUp),i>0&&i>Math.PI||i<0&&i>-Math.PI?(this.object.up.negate(),this.object.lookAt(this.target),this.object.isUpVectorFlipped=!0):(this.object.lookAt(this.target),this.object.isUpVectorFlipped=!1),this.state===-1||this.enableDamping===!0){let n=this.hoverRotatePanMode===1?this.hoverRotateDamping:this.dampingFactor;this.sphericalDelta.theta*=1-n,this.sphericalDelta.phi*=1-n}else this.sphericalDelta.set(0,0,0);return this.scale=1,this.zoomChanged||this.lastPosition.distanceToSquared(this.object.position)>C5e||8*(1-this.lastQuaternion.dot(this.object.quaternion))>S5e?(this.dispatchEvent(y5e),this.object.dispatchEvent(_5e),this.lastPosition.copy(this.object.position),this.lastQuaternion.copy(this.object.quaternion),this.zoomChanged=!1,!0):(this.isPanOverShoot=!1,this.isRotateOverShoot=!1,this.object.wasMovedBySwitchCameraAction=!1,this.sphericalDelta.set(0,0,0),this.panOffset.set(0,0,0),!1)},this.onPointerDown=i=>{this.enabled!==!1&&(i.pointerType==="touch"||i.pointerType==="pen"&&lo?this.onPointerDownTouch(i):this.onPointerDownMouse(i),this.state!==-1&&(this.isPointerDown=!0,this.dispatchEvent(tu),this.domElement.addEventListener("pointermove",this.onPointerMove),this.domElement.addEventListener("pointerup",this.onPointerUp),i.stopPropagation(),i.pointerType==="touch"||i.pointerType==="pen"&&lo||this.domElement.setPointerCapture(i.pointerId)))},this.onPointerLeave=i=>{this.resetHoverEffectOnPointerLeave&&!this.useWindowEvents?(this.hoverRotatePanMode===1?(this.sphericalDelta.theta=-this.spherical.theta,this.sphericalDelta.phi=-this.spherical.phi,A_.subVectors(this.position0,this.target0),this.spherical.setFromVector3(A_),this.sphericalDelta.theta+=this.spherical.theta,this.sphericalDelta.phi+=this.spherical.phi,this.sphericalDelta.theta/=8,this.sphericalDelta.phi/=8):this.hoverRotatePanMode===2&&this.panOffset.subVectors(this.target0,this.target).divideScalar(8),this.update()):this.pointerLeaveEvent=i},this.onPointerEnter=i=>{this.resetHoverEffectOnPointerLeave||this.pointerLeaveEvent===void 0?eb.set(i.clientX-this.domElement.clientWidth/2,i.clientY-this.domElement.clientHeight/2):eb.set(i.clientX-this.pointerLeaveEvent.clientX,i.clientY-this.pointerLeaveEvent.clientY),this.hoverRotatePanMode===1?(this.rotateDelta.copy(eb).multiplyScalar(this.rotateSpeed*this.hoverRotatePanStrength).rotateAround(G4,-this.object.angleOffsetFromUp),this.rotateLeft(2*Math.PI*this.rotateDelta.x/this.domElement.clientHeight),this.rotateUp(2*Math.PI*this.rotateDelta.y/this.domElement.clientHeight),this.rotateStart.set(i.clientX,i.clientY)):this.hoverRotatePanMode===2&&(this.panDelta.copy(eb).multiplyScalar(this.panSpeed*this.hoverRotatePanStrength),this.pan(this.panDelta.x,this.panDelta.y),this.panStart.set(i.clientX,i.clientY)),this.update()},this.onPointerMove=i=>{this.enabled!==!1&&(this.checkRaycastLock()||(i.pointerType==="touch"||i.pointerType==="pen"&&lo?this.onPointerMoveTouch(i):this.onPointerMoveMouse(i),i.stopPropagation()))},this.onPointerUp=i=>{this.isPointerDown=!1,Ht.length===0&&(this.domElement.removeEventListener("pointermove",this.onPointerMove),this.domElement.removeEventListener("pointerup",this.onPointerUp)),Ht.length>1&&i.preventDefault(),this.hasChange?this.dispatchEvent(ru):this.dispatchEvent(x5e),this.state=-1,i&&(i.stopPropagation(),i.pointerType==="touch"||i.pointerType==="pen"&&lo||this.domElement.releasePointerCapture(i.pointerId))},this.onPointerDownMouse=i=>{let n;switch(this.useKeyEvents?n=this.mouseButtons[i.button]:n=this.mouseButtonsPlay[i.button],n){case 0:if(i.altKey===!0&&!i.shiftKey&&!hy(i)){if(this.enableRotate===!1)return;this.handleMouseDownRotate(i),this.state=0}else if(this.key===" "){if(this.enablePan===!1)return;this.handleMouseDownPan(i),this.state=2}break;case 4:if(this.enablePan===!1)return;this.handleMouseDownPan(i),this.state=2;break;case 3:if(hy(i)||i.shiftKey){if(this.enablePan===!1)return;this.handleMouseDownPan(i),this.state=2}else{if(this.enableRotate===!1)return;this.handleMouseDownRotate(i),this.state=0}break;case 5:if(hy(i)||i.shiftKey){if(this.enableRotate===!1)return;this.handleMouseDownRotate(i),this.state=0}else{if(this.enablePan===!1)return;this.handleMouseDownPan(i),this.state=2}break;default:this.state=-1}},this.onPointerMoveMouse=i=>{switch(this.state){case 0:if(this.enableRotate===!1)return;this.handleMouseMoveRotate(i);break;case 1:if(this.enableZoom===!1)return;this.handleMouseMoveDolly(i);break;case 2:if(this.enablePan===!1)return;this.handleMouseMovePan(i);break}this.object.wasMovedByUser=!0},this.onPointerDownTouch=i=>{switch(Ht.length>1&&i.preventDefault(),this.touches[Ht.length-1]){case po.ROTATE:if(this.enableRotate===!1){this.state=-1;return}this.handleTouchStartRotate(),this.state=3;break;case po.PAN:if(this.enablePan===!1){this.state=-1;return}this.handleTouchStartPan(),this.state=4;break;case po.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this.handleTouchStartDollyPan(),this.state=5;break;case po.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this.handleTouchStartDollyRotate(),this.state=6;break;default:this.state=-1}},this.onPointerMoveTouch=i=>{switch(Ht.length>1&&i.preventDefault(),this.state){case 3:if(this.enableRotate===!1)return;this.handleTouchMoveRotate(i),this.update();break;case 4:if(this.enablePan===!1)return;this.handleTouchMovePan(i),this.update();break;case 5:if(this.enableZoom===!1&&this.enablePan===!1)return;this.handleTouchMoveDollyPan(i),this.update();break;case 6:if(this.enableZoom===!1&&this.enableRotate===!1)return;this.handleTouchMoveDollyRotate(i),this.update();break;default:this.state=-1}this.object.wasMovedByUser=!0},this.dispatchEndDebounced=PP(()=>this.dispatchEvent(ru),33),this.onMouseWheel=i=>{this.enabled===!1||this.enableZoom===!1&&this.enablePan===!1||this.checkRaycastLock()||(!this.options.isExport&&this.domElement.clientHeight===document.body.clientHeight&&this.domElement.clientWidth===document.body.clientWidth&&i.preventDefault(),this.dispatchEvent(tu),this.handleMouseWheel(i),this.dispatchEndDebounced(),this.object.wasMovedByUser=!0)},this.onGesture=i=>{if(i.preventDefault(),this.enabled!==!1&&!this.checkRaycastLock()&&!Qg)if(i.type==="gesturechange"){if(this.enableZoom===!1||this.isTouchZoom===!1)return;this.dispatchEvent(tu),i.scale>this.prevScale?this.dollyIn(this.getZoomScale()):i.scale<this.prevScale&&this.dollyOut(this.getZoomScale()),this.prevScale=i.scale,this.update(),this.object.wasMovedByUser=!0}else this.dispatchEvent(ru)},this.onContextMenu=i=>{i.preventDefault()},this.onTouchEnd=i=>{i.preventDefault()},this.onKeyDown=i=>{this.enabled!==!1&&(this.key=i.key,i.key===" "&&this.dispatchEvent(tu))},this.onKeyUp=i=>{this.enabled!==!1&&(this.key=void 0,this.state!==-1&&i.key==="Alt"&&this.onPointerUp(Ht[0]),i.key===" "&&this.dispatchEvent(ru))},this.onPointerHover=i=>{i.pointerType!=="mouse"||this.enabled===!1||this.state!==-1||this.hoverRotatePanMode===2&&this.isPanOverShoot||this.hoverRotatePanMode===1&&this.isRotateOverShoot||(this.isPointerDown=!0,this.hoverRotatePanMode===2?this.handleMouseMovePan(i,this.hoverRotatePanStrength):this.hoverRotatePanMode===1&&this.handleMouseMoveRotate(i,this.hoverRotatePanStrength))},this.onBeginState=()=>{this.enabled=!1,this.needsUpdate=!1},this.onCompleteState=i=>{i.isfromEntity&&this.options.isPlayMode||(this.enabled=!0,this.needsUpdate=!0,this.object.updateUp(),this.object.getTarget(this.target))},this.target=this.object.getTarget(),this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.quat0=this.object.quaternion.clone(),this.isUpVectorFlipped0=this.object.isUpVectorFlipped,this.offset.copy(this.object.position).sub(this.target),this.spherical.setFromVector3(this.offset),this.object.isUpVectorFlipped&&(this.spherical.phi*=-1,this.spherical.theta-=Math.PI),this.initialSphericalRadius=this.spherical.radius,this.addEventListenersToCamera()}dispatchEvent(e){e.type==="start"?this.hasChange=!1:this.hasChange=!0,super.dispatchEvent(e)}addEventListenersToCamera(){this.object.addEventListener("beginState",this.onBeginState),this.object.addEventListener("completeState",this.onCompleteState),this.object.addEventListener("cameraChange",this.onCameraChange)}removeEventListenersFromCamera(){this.object.removeEventListener("beginState",this.onBeginState),this.object.removeEventListener("completeState",this.onCompleteState),this.object.removeEventListener("cameraChange",this.onCameraChange)}updateUseWindowEvents(e){if(window.removeEventListener("pointermove",this.onPointerHover),this.domElement.removeEventListener("pointermove",this.onPointerHover),this.useWindowEvents=e,this.hoverRotatePanMode!==0&&(this.useWindowEvents?window.addEventListener("pointermove",this.onPointerHover):this.domElement.addEventListener("pointermove",this.onPointerHover)),this.domElement.removeEventListener("pointerleave",this.onPointerLeave),this.domElement.removeEventListener("pointerenter",this.onPointerEnter),window.removeEventListener("pointerleave",this.onPointerLeave),window.removeEventListener("pointerenter",this.onPointerEnter),this.hoverRotatePanMode!==0&&!this.useWindowEvents){let t=this.useWindowEvents?window:this.domElement;t.addEventListener("pointerleave",this.onPointerLeave),t.addEventListener("pointerenter",this.onPointerEnter)}}fromJSON(e,t){this.setEnableDampingSpeed(e.enableDamping),this.enablePan=e.enablePan,this.enableZoom=e.enableZoom,this.enableRotate=e.enableRotate,this.rotationLimitsMode=e.rotationLimitsMode,this.thetaIsFree=e.rotationHorizontalOffset.min===e.rotationHorizontalOffset.max&&e.rotationHorizontalOffset.min===Math.PI,this.phiIsFree=e.rotationVerticalOffset.min===e.rotationVerticalOffset.max&&e.rotationVerticalOffset.min===Math.PI,this.panLimitsMode=e.panLimitsMode,this.panSoftLimit=e.panSoftLimit,this.rotationSoftLimit=e.rotationSoftLimit,this.hoverRotatePanMode=e.hoverRotatePanMode,this.hoverRotateDamping=e.hoverRotateDamping??this.dampingFactor,this.useWindowEvents=t==="window",this.hoverRotatePanMode!==0&&(this.useWindowEvents?window.addEventListener("pointermove",this.onPointerHover):this.domElement.addEventListener("pointermove",this.onPointerHover));let r=e.hoverRotatePanStrength/100;this.hoverRotatePanStrength=r**2,this.zoomLimitsEnabled=e.zoomLimitsEnabled,this.minZoom=e.zoomLimits.min,this.maxZoom=Math.max(e.zoomLimits.min,e.zoomLimits.max),this.minDistance=1e3/e.zoomLimits.max,this.maxDistance=Math.max(this.minDistance,1e3/e.zoomLimits.min),this.autoRotate=e.autoRotate,this.autoRotateSpeed=e.autoRotateSpeed,this.autoRotateClockwise=e.autoRotateClockwise;let i=this.object.getTarget().applyQuaternion(__.copy(this.object.quaternion).invert());this.minV=-e.panVerticalOffset.min+i.y,this.maxV=e.panVerticalOffset.max+i.y,this.minH=-e.panHorizontalOffset.min+i.x,this.maxH=e.panHorizontalOffset.max+i.x,this.panRangeFactor.set(this.maxH-this.minH,this.maxV-this.minV).divideScalar(2),this.rotationRangeFactor.setScalar(Math.PI).divideScalar(4),this.minPhi=Is(this.spherical.phi-e.rotationVerticalOffset.min),this.maxPhi=Is(this.spherical.phi+e.rotationVerticalOffset.max),this.minTheta=Is(Is(this.spherical.theta)-e.rotationHorizontalOffset.min),this.maxTheta=Is(Is(this.spherical.theta)+e.rotationHorizontalOffset.max),this.isThetaFlipped=this.minTheta>this.maxTheta,e.orbitTouches===1&&(this.touches[0]=po.ROTATE),e.panTouches===1&&(this.touches[0]=po.PAN),e.orbitTouches===2&&(this.touches[1]=po.DOLLY_ROTATE),e.panTouches===2&&(this.touches[1]=po.DOLLY_PAN),e.orbitTouches===3&&(this.touches[2]=po.ROTATE),e.panTouches===3&&(this.touches[2]=po.PAN),this.isTouchZoom=e.isTouchZoom,this.resetHoverEffectOnPointerLeave=e.resetHoverEffectOnPointerLeave??!1}connect(){if(this.domElement.addEventListener("contextmenu",this.onContextMenu),this.domElement.addEventListener("pointerdown",this.onPointerDown),this.domElement.addEventListener("wheel",this.onMouseWheel),window.addEventListener("keydown",this.onKeyDown,!1),window.addEventListener("keyup",this.onKeyUp,!1),this.domElement.addEventListener("gesturestart",this.onGesture),this.domElement.addEventListener("gesturechange",this.onGesture),this.domElement.addEventListener("gestureend",this.onGesture),this.domElement.addEventListener("touchend",this.onTouchEnd),this.hoverRotatePanMode!==0&&!this.useWindowEvents){let e=this.useWindowEvents?window:this.domElement;e.addEventListener("pointerleave",this.onPointerLeave),e.addEventListener("pointerenter",this.onPointerEnter)}this.pointerLeaveEvent=void 0}dispose(){this.removeEventListenersFromCamera(),this.domElement.removeEventListener("contextmenu",this.onContextMenu),this.domElement.removeEventListener("pointerdown",this.onPointerDown),this.domElement.removeEventListener("wheel",this.onMouseWheel),window.removeEventListener("keydown",this.onKeyDown,!1),window.removeEventListener("keyup",this.onKeyUp,!1),this.domElement.removeEventListener("pointermove",this.onPointerHover),window.removeEventListener("pointermove",this.onPointerHover),this.domElement.removeEventListener("gesturestart",this.onGesture),this.domElement.removeEventListener("gesturechange",this.onGesture),this.domElement.removeEventListener("gestureend",this.onGesture),this.domElement.removeEventListener("touchend",this.onTouchEnd),this.domElement.removeEventListener("pointerleave",this.onPointerLeave),this.domElement.removeEventListener("pointerenter",this.onPointerEnter),window.removeEventListener("pointerleave",this.onPointerLeave),window.removeEventListener("pointerenter",this.onPointerEnter),this.domElement.removeEventListener("pointermove",this.onPointerMove),this.domElement.removeEventListener("pointerup",this.onPointerUp)}applyLimits(e,t,r,i,n,a,o,s){this.overShoot.set(0,0);let l,c,d;e instanceof k?(l=e.x,c=e.y,this.current.set(this.target.x,this.target.y),d=!0):(l=e.theta,c=e.phi,this.current.set(Is(this.spherical.theta),Is(this.spherical.phi)),d=!1),r===0&&(this.current.x+=l,this.current.y+=c),(t===3||t===2)&&(!d&&this.isThetaFlipped?this.current.x>i&&this.current.x<0?this.overShoot.x=i-this.current.x:this.current.x<n&&this.current.x>0&&(this.overShoot.x=n-this.current.x):this.current.x>i?this.overShoot.x=i-this.current.x:this.current.x<n&&(this.overShoot.x=n-this.current.x)),(t===3||t===1)&&(this.current.y>a?this.overShoot.y=a-this.current.y:this.current.y<o&&(this.overShoot.y=o-this.current.y)),d||(this.overShoot.x=Is(this.overShoot.x),this.overShoot.y=Is(this.overShoot.y)),r!==0?(this.overRatio.copy(this.overShoot).divide(s),this.overRatio.x=Math.min(Math.abs(this.overRatio.x),1),this.overRatio.y=Math.min(Math.abs(this.overRatio.y),1),r===1&&(this.overRatio.x=q4(Math.abs(this.overRatio.x)),this.overRatio.y=q4(Math.abs(this.overRatio.y))),this.isPointerDown||r===1?r===2&&(this.overRatio.x>.9&&!this.thetaIsFree||this.overRatio.y>.9&&!this.phiIsFree)?this.isPointerDown=!1:(l*this.overShoot.x<0&&!this.thetaIsFree&&(l*=1-this.overRatio.x),c*this.overShoot.y<0&&!this.phiIsFree&&(c*=1-this.overRatio.y)):r===2&&(!d&&(this.overRatio.x>.002&&!this.thetaIsFree||this.overRatio.y>.002&&!this.phiIsFree)||d&&(Math.abs(this.overShoot.x)>2||Math.abs(this.overShoot.y)>2)?(this.thetaIsFree||(l=this.overShoot.x*.05),this.phiIsFree||(c=this.overShoot.y*.05),d?this.isPanOverShoot=!0:this.isRotateOverShoot=!0):d?this.isPanOverShoot=!1:this.isRotateOverShoot=!1)):(l+=this.overShoot.x,c+=this.overShoot.y),e instanceof k?(e.x=l,e.y=c):(this.thetaIsFree||(e.theta=l),this.phiIsFree||(e.phi=c))}setEnableDampingSpeed(e){this.enableDamping=e,this.rotateSpeed=e===!0?.2:1}stopDamping(){this.sphericalDelta.theta=0,this.sphericalDelta.phi=0}getAutoRotationAngle(){return 2*Math.PI/60/60*this.autoRotateSpeed}getZoomScale(){return Math.pow(.95,this.zoomSpeed)}rotateLeft(e){this.sphericalDelta.theta-=e}rotateUp(e){this.sphericalDelta.phi-=e}panLeft(e,t){this.panLeftV.setFromMatrixColumn(t,0),this.panLeftV.multiplyScalar(-e),this.panOffset.add(this.panLeftV)}panUp(e,t){this.panUpV.setFromMatrixColumn(t,1),this.panUpV.multiplyScalar(e),this.panOffset.add(this.panUpV)}pan(e,t){let r=this.domElement;if(r&&this.object.isPerspectiveCamera){let i=this.object.position;this.panV.copy(i).sub(this.target);let n=this.panV.length();n*=Math.tan(this.object.fov/2*Math.PI/180),this.panLeft(2*e*n/r.clientHeight,this.object.matrixWorld),this.panUp(2*t*n/r.clientHeight,this.object.matrixWorld)}else r&&this.object.isOrthographicCamera&&(this.panLeft(e*(this.object.right-this.object.left)/this.object.zoom/r.clientWidth,this.object.matrixWorld),this.panUp(t*(this.object.top-this.object.bottom)/this.object.zoom/r.clientHeight,this.object.matrixWorld));this.dispatchEvent(b5e)}dollyOut(e){this.object.isPerspectiveCamera?this.scale/=e:this.object.isOrthographicCamera&&(this.object.zoom*=e,this.zoomLimitsEnabled&&(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom))),this.object.updateProjectionMatrix(),this.zoomChanged=!0),this.dispatchEvent(W4)}dollyIn(e){this.object.isPerspectiveCamera?this.scale*=e:this.object.isOrthographicCamera&&(this.object.zoom/=e,this.zoomLimitsEnabled&&(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom))),this.object.updateProjectionMatrix(),this.zoomChanged=!0),this.dispatchEvent(W4)}zoomOut(e=this.getZoomScale()){this.dispatchEvent(tu),this.dollyOut(e),this.dispatchEvent(ru)}zoomIn(e=this.getZoomScale()){this.dispatchEvent(tu),this.dollyIn(e),this.dispatchEvent(ru)}setZoom(e){if(this.dispatchEvent(tu),this.object.isPerspectiveCamera){let t=this.initialSphericalRadius/e/this.spherical.radius;this.scale=t}else this.object.isOrthographicCamera&&(this.object.zoom=e,this.zoomLimitsEnabled&&(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom))),this.object.updateProjectionMatrix(),this.zoomChanged=!0);this.dispatchEvent(ru)}handleMouseDownRotate(e){this.rotateStart.set(e.clientX,e.clientY)}handleMouseDownDolly(e){this.dollyStart.set(e.clientX,e.clientY)}handleMouseDownPan(e){this.panStart.set(e.clientX,e.clientY)}handleMouseMoveRotate(e,t=1){e.movementX!==void 0?this.rotateDelta.set(e.movementX,e.movementY):(this.rotateEnd.set(e.clientX,e.clientY),this.rotateDelta.subVectors(this.rotateEnd,this.rotateStart),this.rotateStart.copy(this.rotateEnd)),this.rotateDelta.multiplyScalar(this.rotateSpeed*t).rotateAround(G4,-this.object.angleOffsetFromUp);let r=this.domElement,i=this.useWindowEvents?window.innerHeight:r.clientHeight,n=2*Math.PI*this.rotateDelta.x/i,a=2*Math.PI*this.rotateDelta.y/i;this.rotateLeft(n),this.rotateUp(a),this.update()}handleMouseMoveDolly(e){this.dollyEnd.set(e.clientX,e.clientY),this.dollyDelta.subVectors(this.dollyEnd,this.dollyStart),this.dollyDelta.y>0?this.dollyOut(this.getZoomScale()):this.dollyDelta.y<0&&this.dollyIn(this.getZoomScale()),this.dollyStart.copy(this.dollyEnd),this.update()}handleMouseMovePan(e,t=1){e.movementX!==void 0?this.panDelta.set(e.movementX,e.movementY):(this.panEnd.set(e.clientX,e.clientY),this.panDelta.subVectors(this.panEnd,this.panStart),this.panStart.copy(this.panEnd)),this.panDelta.multiplyScalar(this.panSpeed*t),this.pan(this.panDelta.x,this.panDelta.y),this.update()}handleMouseWheel(e){if(DTe===!1&&hy(e)===!1&&RTe(e)===!0){if(this.enablePan===!1)return;this.gesture?(this.panDelta.set(-e.deltaX,-e.deltaY).multiplyScalar(this.panSpeed),this.panDelta.x=Math.min(Math.abs(this.panDelta.x),100)*(this.panDelta.x<0?-1:1),this.panDelta.y=Math.min(Math.abs(this.panDelta.y),100)*(this.panDelta.y<0?-1:1),e.altKey?this.pan(0,this.panDelta.y):e.shiftKey?this.pan(this.panDelta.x,0):this.pan(this.panDelta.x,this.panDelta.y),this.update()):(this.gesture=!0,this.isPointerDown=!0),window.clearTimeout(this.timer),this.timer=window.setTimeout(()=>{this.gesture=!1,this.isPointerDown=!1},30)}else{if(this.enableZoom===!1||this.gesture)return;e.deltaY===0?e.deltaX<0?this.dollyIn(this.getZoomScale()):e.deltaX>0&&this.dollyOut(this.getZoomScale()):e.deltaY<0?this.dollyIn(this.getZoomScale()):e.deltaY>0&&this.dollyOut(this.getZoomScale()),this.update(),this.gesture=!1,this.isPointerDown=!1}}handleTouchStartRotate(){if(Ht.length===2){let e=.5*(Ht[0].pageX+Ht[1].pageX),t=.5*(Ht[0].pageY+Ht[1].pageY);this.rotateStart.set(e,t)}else this.rotateStart.set(Ht[0].pageX,Ht[0].pageY)}handleTouchStartPan(){if(Ht.length===2){let e=.5*(Ht[0].pageX+Ht[1].pageX),t=.5*(Ht[0].pageY+Ht[1].pageY);this.panStart.set(e,t)}else this.panStart.set(Ht[0].pageX,Ht[0].pageY)}handleTouchStartDolly(){let e=Ht[0].pageX-Ht[1].pageX,t=Ht[0].pageY-Ht[1].pageY,r=Math.sqrt(e*e+t*t);this.dollyStart.set(0,r)}handleTouchStartDollyPan(){this.enableZoom&&this.isTouchZoom===!0&&this.handleTouchStartDolly(),this.enablePan&&this.handleTouchStartPan()}handleTouchStartDollyRotate(){this.enableZoom&&this.isTouchZoom===!0&&this.handleTouchStartDolly(),this.enableRotate&&this.handleTouchStartRotate()}handleTouchMoveRotate(e){if(Ht.length===2){let r=mC(e),i=.5*(e.pageX+r.x),n=.5*(e.pageY+r.y);this.rotateEnd.set(i,n)}else{if(e.pointerId!==Ht[0].pointerId)return;this.rotateEnd.set(e.pageX,e.pageY)}this.rotateDelta.subVectors(this.rotateEnd,this.rotateStart).multiplyScalar(this.rotateSpeed);let t=this.domElement;t&&(this.rotateLeft(2*Math.PI*this.rotateDelta.x/t.clientHeight),this.rotateUp(2*Math.PI*this.rotateDelta.y/t.clientHeight)),this.rotateStart.copy(this.rotateEnd)}handleTouchMovePan(e){if(Ht.length===2){let t=mC(e),r=.5*(e.pageX+t.x),i=.5*(e.pageY+t.y);this.panEnd.set(r,i)}else{if(e.pointerId!==Ht[0].pointerId)return;this.panEnd.set(e.pageX,e.pageY)}this.panDelta.subVectors(this.panEnd,this.panStart).multiplyScalar(this.panSpeed),this.pan(this.panDelta.x,this.panDelta.y),this.panStart.copy(this.panEnd)}handleTouchMoveDolly(e){let t=mC(e),r=e.pageX-t.x,i=e.pageY-t.y,n=Math.sqrt(r*r+i*i);this.dollyEnd.set(0,n),this.dollyDelta.set(0,Math.pow(this.dollyEnd.y/this.dollyStart.y,this.zoomSpeed)),this.dollyOut(this.dollyDelta.y),this.dollyStart.copy(this.dollyEnd)}handleTouchMoveDollyPan(e){this.enableZoom&&this.isTouchZoom===!0&&this.handleTouchMoveDolly(e),this.enablePan&&this.handleTouchMovePan(e)}handleTouchMoveDollyRotate(e){this.enableZoom&&this.isTouchZoom===!0&&this.handleTouchMoveDolly(e),this.enableRotate&&this.handleTouchMoveRotate(e)}checkRaycastLock(){var e;if(this.object.data.raycastLock){if(this.options.isPlayMode)return!1;{let t=(e=this.options)==null?void 0:e.showCameraLock;return t&&t(),!0}}else return!1}};function Is(e){let t=Math.PI*2;for(;e<=-Math.PI;)e+=t;for(;e>Math.PI;)e-=t;return e}function q4(e){return 1-Math.pow(1-e,4)}var Y4=class{constructor(e,t,r,i,n,a){this.id=e,this.data=t,this.object=r,this.page=i,this.currentIntersectedObjects=[],this.actions=Hn(t,t.actions,i,n,a,r),this.target=t.target,this.triggeringObjects=[];for(let o of t.triggeringObjects){let s=i.scene.find(o);s&&this.triggeringObjects.push(s)}}isValidTriggeringObject(e){return this.target==="all"?!0:this.triggeringObjects.some(t=>t===e||t.isAncestorOf(e.uuid)||e.isAncestorOf(t.uuid))}disconnect(){Fn(this.actions)}dispatch(){this.object.destroyedInAction||(this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),this.object.dispatchEvent({type:"beginEvent",eventName:"Trigger"}),this.actions.Transition.forEach(e=>{e.data.runMode==="Toggle"?e.toggle():e.play()}),this.actions.SwitchCamera.forEach(e=>{e.data.runMode==="Toggle"?e.toggle():e.play()}),this.actions.Link.forEach(e=>{e.dispatch()}),this.actions.Reset.forEach(e=>{e.dispatch()}),this.actions.Create.forEach(e=>{e.dispatch()}),this.actions.Destroy.forEach(e=>{e.dispatch(!1)}),this.actions.Audio.forEach(e=>{e.dispatchBasic()}),this.actions.Particles.forEach(e=>{e.dispatchBasic()}),this.actions.Video.forEach(e=>{e.dispatchBasic()}),this.actions.SceneTransition.forEach(e=>{e.dispatch()}),this.actions.SetVariable.forEach(e=>e.checkConditions()),this.actions.SetVariable.forEach(e=>e.dispatch()),this.actions.DynamicVariablePlay.forEach(e=>e.dispatch()),this.actions.ClearLocalStorage.forEach(e=>e.dispatch()),this.actions.UserAPI.forEach(e=>e.dispatch()))}},Er;FTe.then(e=>Er=e);var tn=new k,Ko=new Xt,Bc=new k,E_=new vn(0,0,0,"YXZ"),X4=new vn(0,0,0,"XYZ"),Qo=new k,T_=new k,P_=new k(1,1,1),mf=new Xt,rb=new it,K4=new it,A5e={type:"updateMatrix"},Q4=new Xt,D_=new Za,_E={type:"beginEvent",eventName:"Collision"},M5e={type:"beginEvent",eventName:"Trigger"};function E5e(e){if(vg.physicsEnabled(e.scene.objects))return!0;let t=!1;return e.scene.objects.traverse((r,i)=>{if(i.events){if(Array.isArray(i.events)){for(let n of i.events)if(n.data.disabled!==!0&&n.data.type==="GameControl"&&n.data.collisionEnabled){t=!0;break}}else for(let n of Object.values(i.events))if(n.disabled!==!0&&n.type==="GameControl"&&n.collisionEnabled){t=!0;break}}}),t}var c1=e=>e.states.some(t=>t.data.position!==void 0||t.data.rotation!==void 0||t.data.hiddenMatrix!==void 0||t.data.cloner!==void 0||t.data.pathSnapping!==void 0),T5e=class{constructor(e){this.eventContext=e,this.isEnabled=!1,this.gameControl=null,this.joysticks=[],this.joystickToGameControls=[],this.sharedGameControlGlobals={entitiesWithTransformAnim:[],entityToCollisionEvents:{},colliderToEntity:new Map,triggers:[],gamePads:[],createdObjects:[],nCreatedPerAction:{}},this.sensorToTriggerEvent={},this.eventManager=void 0,this.needsCollisionDetection=!1,this.initializationCounter=-1,this.rigidBodyToMesh=new Map,this.nActiveRigidBodies=0,this.collisionEvents=[],this.isExport=!1,this.processRigidBody=t=>{if(t.bodyType()!==Er.RigidBodyType.Dynamic)return;t.isSleeping()||this.nActiveRigidBodies++;let[r,i,n]=this.rigidBodyToMesh.get(t.handle);if(tn.copy(t.translation()).multiplyScalar(this.pixelsPerMeter),Ko.copy(t.rotation()),r.matrixWorld.compose(tn,Ko,i),r.hasNonUniformScale&&r.matrixWorld.multiply(r.shearScale),r.dispatchEvent(A5e),n){let a=r.cloner;if(a&&a.objectForSample===void 0){a.matrixWorld.copy(r.matrixWorld);for(let o of a.children)o.updateMatrixWorld(!0)}for(let o of r.children)o.updateMatrixWorld(!0)}},this.accumulator=0,this.handleCollisionEvents=(t,r,i)=>{var o,s,l,c;if(i===!1)return;let n,a;if(this.sensorToTriggerEvent[t]?(n=this.sensorToTriggerEvent[t],a=this.sharedGameControlGlobals.colliderToEntity.get(r)):this.sensorToTriggerEvent[r]&&(n=this.sensorToTriggerEvent[r],a=this.sharedGameControlGlobals.colliderToEntity.get(t)),n&&a&&n.isValidTriggeringObject(a)){n.dispatch();return}for(let d=this.sharedGameControlGlobals.createdObjects.length-1;d>=0;d--){let u=this.sharedGameControlGlobals.createdObjects[d];if(u.userData.hasCollisionDestroy&&(((o=u.rigidBody)==null?void 0:o.collider(0).handle)===t||((s=u.rigidBody)==null?void 0:s.collider(0).handle)===r)){this.sharedGameControlGlobals.createdObjects.splice(d,1),u.removeFromParent(),requestAnimationFrame(()=>{var h;return(h=this.sharedGameControlGlobals.rapierWorld)==null?void 0:h.removeRigidBody(u.rigidBody)});break}}if(((l=this.gameControl)==null?void 0:l.object)!==void 0&&this.gameControl.object===this.sharedGameControlGlobals.colliderToEntity.get(t)){let d=this.sharedGameControlGlobals.colliderToEntity.get(r),u=this.sharedGameControlGlobals.entityToCollisionEvents[d.uuid];if(u===void 0)return;for(let h of u)h.data.target==="character"&&this.dispatchCollisionEvent(h,d,r)}else if(((c=this.gameControl)==null?void 0:c.object)!==void 0&&this.gameControl.object===this.sharedGameControlGlobals.colliderToEntity.get(r)){let d=this.sharedGameControlGlobals.colliderToEntity.get(t),u=this.sharedGameControlGlobals.entityToCollisionEvents[d.uuid];if(u===void 0)return;for(let h of u)h.data.target==="character"&&this.dispatchCollisionEvent(h,d,t)}else{let d=this.sharedGameControlGlobals.colliderToEntity.get(t),u=this.sharedGameControlGlobals.entityToCollisionEvents[d.uuid];if(u!==void 0)for(let p of u)p.data.target==="scene"&&this.dispatchCollisionEvent(p,d,t);let h=this.sharedGameControlGlobals.colliderToEntity.get(r),f=this.sharedGameControlGlobals.entityToCollisionEvents[h==null?void 0:h.uuid];if(f!==void 0)for(let p of f)p.data.target==="scene"&&this.dispatchCollisionEvent(p,h,r)}},this.isExport=e.isExport,this.sharedAssets=e.sharedAssets,this.renderer=e.renderer,this.requestRender=e.requestRender,this.domElement=this.renderer.domElement,this.pixelsPerMeter=VW,this.gravity=this.page.data.globalPhysics.gravity}get page(){return this.eventContext.page}attachVRControllers(e){e.forEach(t=>{t.addEventListener("connected",r=>{"gamepad"in r.data&&"axes"in r.data.gamepad&&this.sharedGameControlGlobals.gamePads.push(r.data.gamepad)})})}markIsDestroyTarget(){this.page.traverseVisibleEntity(e=>{var r,i;let t=e.dataPatched;for(let n of t.events){if(n.data.disabled===!0)continue;let a=(i=(r=n.data.actions)==null?void 0:r.find(o=>o.data.type==="Destroy"))==null?void 0:i.data;if(a)for(let o of a.objects){let s=this.page.scene.find(o);s&&(s.userData.hasDestroy=!0)}}})}markIsDragObject(){this.page.traverseVisibleEntity(e=>{let t=e.dataPatched;for(let r of t.events)if(!(r.data.disabled===!0||r.data.type!=="DragDrop"))for(let i of r.data.objects){let n=this.page.scene.find(i);n&&(n.userData.hasDrag=!0)}})}initBVH(){let e=[];if(this.page.traverseChildren(t=>{var c,d;let r,i=t instanceof Cb,n=t instanceof Ab;if(t instanceof ns||i||n)return;t instanceof pa?r=t.object:r=t;let a=r.dataPatched;if(((c=a.physics)==null?void 0:c.enabled)==="visibility"?!a.visible:!((d=a.physics)!=null&&d.enabled))return!0;let o=t.geometry,s=r.userData.hasDestroy===!0,l=r.userData.hasDrag===!0;if(c1(a)||s||l||r.dataPatched.events.some(u=>u.data.disabled!==!0&&u.data.type==="GameControl"))return t.updateMatrixWorldSVD(),this.addBoundsTree(t),!0;o&&e.push(Nl(o,t.matrixWorld))}),e.length>0){let t=Pu(e,!1);this.sharedGameControlGlobals.staticMeshBVH=new Dv(t)}}addRigidBody(e,t,r){let i=[],n="geometry"in e?e.geometry:void 0,a=t.dataPatched;if((n==null?void 0:n.getAttribute("position"))!==void 0&&i.push(Nl(n,e.shearScale)),a.physics.fusedBody){let o=this.gatherChildrenGeom(e,i);e.traverseObject(o),e.children.forEach(l=>l.updateMatrixWorld(!0));let s=e.cloner;s&&s.objectForSample===void 0&&a.physics.rigidBody==="dynamic"&&(s.traverseObject(o),s.children.forEach(l=>l.updateMatrixWorld(!0)))}if(i.length>0){let o,s=!r.fromCreate&&a.physics.rigidBody==="dynamic"||r.fromCreate&&r.dynamic;s?(o=Er.RigidBodyDesc.dynamic(),o.setLinearDamping(a.physics.damping).setAngularDamping(a.physics.damping).setAdditionalMass(1e-9).setGravityScale(a.physics.gravityScale).enabledRotations(...a.physics.enabledRotation).enabledTranslations(...a.physics.enabledTranslation)):(r.hasTransformAnim||r.hasFollow||r.hasDrag)&&!r.fromCreate?(o=Er.RigidBodyDesc.kinematicPositionBased(),this.sharedGameControlGlobals.entitiesWithTransformAnim.push(e)):o=Er.RigidBodyDesc.fixed();let l=Pu(i);(e.hasNonUniformScale?e.matrixWorldRigid:e.matrixWorld).decompose(tn,Ko,Bc),e.position0=tn.clone().divideScalar(this.pixelsPerMeter),e.rotation0=Ko.clone(),tn.divideScalar(this.pixelsPerMeter),o.setTranslation(tn.x,tn.y,tn.z).setRotation(Ko),n?l==null||l.scale(1/this.pixelsPerMeter,1/this.pixelsPerMeter,1/this.pixelsPerMeter):l==null||l.scale(Bc.x/this.pixelsPerMeter,Bc.y/this.pixelsPerMeter,Bc.z/this.pixelsPerMeter);let c=this.sharedGameControlGlobals.rapierWorld.createRigidBody(o);s&&this.rigidBodyToMesh.set(c.handle,[e,Bc.clone(),a.physics.fusedBody]);let d=!(a.geometry===void 0||a.geometry.type==="SubdivGeometry"||a.geometry.type==="NonParametricGeometry"||a.geometry.type==="BooleanGeometry"||a.geometry.type==="VectorGeometry"||a.geometry.type==="StarGeometry"||a.geometry.type==="RectangleGeometry"||a.geometry.type==="EllipseGeometry"||a.geometry.type==="TriangleGeometry"||a.geometry.type==="TorusGeometry"||a.geometry.type==="HelixGeometry");try{this.addCollider(c,a.physics,l,t,d)}catch{try{this.addCollider(c,a.physics,l,t,!1)}catch(u){console.error(u)}}e.rigidBody=c}}addBoundsTree(e){var r,i;let t=[];if(((r=e.geometry)==null?void 0:r.getAttribute("position"))!==void 0&&((i=e.geometry)==null?void 0:i.getAttribute("position").count)>0&&t.push(Nl(e.geometry,e.shearScale)),e.traverseObject(this.gatherChildrenGeom(e,t)),e.children.forEach(n=>n.updateMatrixWorld(!0)),t.length>0){let n=Pu(t,!1);e.bvhGeometry=n,n.getAttribute("position").count>0&&(e.bvhGeometry.boundsTree=new Dv(n),this.sharedGameControlGlobals.entitiesWithTransformAnim.push(e))}}addCollider(e,t,r,i,n=!0){var s,l;if((r==null?void 0:r.getAttribute("position").count)===0||((s=r==null?void 0:r.getIndex())==null?void 0:s.count)===0)return;let a;r&&(t.colliderType==="trimesh"?a=Er.ColliderDesc.trimesh(r.getAttribute("position").array,r.getIndex().array):a=Er.ColliderDesc.convexMesh(r.getAttribute("position").array,n?r.getIndex().array:void 0)),a.setFrictionCombineRule(Er.CoefficientCombineRule.Average).setRestitutionCombineRule(Er.CoefficientCombineRule.Average).setDensity(t.density).setFriction(t.friction).setRestitution(t.restitution);let o=this.sharedGameControlGlobals.rapierWorld.createCollider(a,e);this.sharedGameControlGlobals.colliderToEntity.set(o.handle,i),(l=this.sharedGameControlGlobals.entityToCollisionEvents[i.uuid])!=null&&l.some(c=>c.target==="scene")&&o.setActiveEvents(Er.ActiveEvents.COLLISION_EVENTS)}gatherChildrenGeom(e,t){return(r,i)=>{var s;if(i===0)return;let n;if(r instanceof ns)if(r.objectForSample){if(r.objectForSample.dataPatched.physics.fusedBody)return;n=r.object}else return r.object.dataPatched.physics.fusedBody===!0&&r.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(r instanceof pa)n=r.object;else if(n=r,(s=n.dataPatched.cloner)==null?void 0:s.hideBase)return!0;let a=n.dataPatched;if(a.physics.enabled==="visibility"?!a.visible:!a.physics.enabled)return!0;i===1?e.hasNonUniformScale?r.matrixWorld.multiplyMatrices(e.shearScale,r.hiddenMatrix):r.matrixWorld.copy(r.hiddenMatrix):r.matrixWorld.multiplyMatrices(r.parent.matrixWorld,r.hiddenMatrix),r.matrixWorld.multiply(r.matrix);let o=r.geometry;(o==null?void 0:o.getAttribute("position"))!==void 0&&t.push(Nl(o,r.matrixWorld))}}activate(e){var h,f;if(this.isEnabled)return;this.isEnabled=!0,this.eventManager=e,this.usePhysics=this.page.data.globalPhysics.usePhysics;let t=this.page.playCamera,r=!1,i=5,n=8,a=9,o="drag",s=this.page.data.publish.gameControlObject,l=s!==null?this.page.find(s):null,c=null;if(l)for(let p of l.data.events){if(p.data.disabled||p.data.type!=="GameControl")continue;let v=l;for(;this.usePhysics&&((h=v=v.parent)==null?void 0:h.parent)!==null;)(f=v.data.physics)==null||f.fusedBody;p.data.collisionEnabled&&(this.needsCollisionDetection=!0),c===null&&(c=p.data)}if(this.page.traverseEntity(p=>{for(let v of p.dataPatched.events)if(v.data.disabled===!1&&v.data.type==="Trigger")return this.needsCollisionDetection=!0,!0}),l&&c&&(l.data.visible===!0||l.data.physics.enabled===!0)){r=r||c.camera===t.uuid||l.uuid===t.uuid;let p=new HW(l,this.renderer.domElement,c,this.eventContext.page.data.globalPhysics,this,l.uuid!==t.uuid&&c.camera===t.uuid,t,this.page,this.sharedAssets);this.gameControl=p,i=c.joystickPosLoc,n=c.joystickRotLoc,a=c.jumpTouchButtonLoc,o=c.rotByTouch,lo&&c.touchControl&&(this.joystickToGameControls[i]="pos",c.moveMode==="walk"&&(this.joystickToGameControls[a]="jmp"),o==="joystick"&&(this.joystickToGameControls[n]="rot"))}if(this.gameControl&&this.gameControl.data.navmesh.enabled){let p=this.gameControl.data;if(!this.navigationMeshWrapper){this.navigationMeshWrapper=new m5e(this.usePhysics,this.isExport);let v;p.collider.type==="sphere"?v=p.collider.radius*2:v=p.collider.height,v=Math.floor(v/p.navmesh.ch-1),this.navigationMeshWrapper.init({...p.navmesh,walkableHeight:v},this.gameControl,this.eventContext)}}if(r===!1){let{enableRotate:p,enablePan:v,enableZoom:m,autoRotate:g,hoverRotatePanMode:y}=this.eventManager.publish.orbitControls;(p||v||m||g||y!==0)&&(this.orbitControls=new QW(t,this.renderer.domElement,{isExport:this.isExport,isPlayMode:!0}),this.orbitControls.addEventListener("change",this.requestRender),this.orbitControls.addEventListener("end",this.requestRender),this.orbitControls.addEventListener("start",this.requestRender),this.orbitControls.fromJSON(this.eventManager.publish.orbitControls,this.eventManager.publish.mouseEventTarget),this.orbitControls.useKeyEvents=!1,this.orbitControls.addEventListenersToCamera(),this.orbitControls.connect(),this.orbitControls.update())}let d=this.renderer.domElement.width/this.renderer.getPixelRatio(),u=this.renderer.domElement.height/this.renderer.getPixelRatio();this.joystickToGameControls.forEach((p,v)=>{let m=document.body.appendChild(document.createElement("div")),[g,y,b]=this.eventManager.eventContext.publish.joystickSizeAndXYOffset[v],x=(d-5*g)/4+g,S={},w=p==="jmp",_=w?0:g;v<10?(v<5?S.top=_/2:S.bottom=_/2,S.left=_/2+v%5*x):v===10?(S.left=_/2,S.top=u/2):(S.right=_/2,S.top=u/2),S.top?S.top-=y[1]:S.bottom+=y[1],S.left?S.left+=y[0]:S.right-=y[0];for(let M in S)S[M]+="px";if(w){let M=m.appendChild(document.createElement("div"));Object.assign(M.style,S,{position:"absolute",width:g+"px",height:g+"px",backgroundColor:`rgba(255,255,255,${b==="show"?.4:0})`,zIndex:"9999",borderRadius:g+"px",border:b==="show"?"solid 2px rgba(0, 0, 0, .1)":"none",display:"flex",alignItems:"center",justifyContent:"center",touchAction:"none"});let P=g/16*16*.4;b==="show"&&(M.innerHTML=`
						<svg width="${P}" height="${g*.4}" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
							<path d="M2 10L8 4L14 10" stroke="black" stroke-opacity="40%" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
						</svg>
					`),M.addEventListener("pointerdown",()=>{this.gameControl.movementState.jump=1,this.requestRender()}),M.addEventListener("touchend",T=>T.preventDefault()),this.joysticks[v]=[void 0,m];return}let C={zone:m,mode:"static",position:S,size:g};b==="hide"&&(C.restOpacity=0);let A=FBe.create(C);A.on("move",(M,P)=>{let T=this.gameControl;p==="pos"?P.force<.2?T.moveForce=0:(T.movementState.movePosZ=Math.sin(-P.angle.radian),T.movementState.movePosX=Math.cos(-P.angle.radian),P.force>1.2?T.movementState.run=1:T.movementState.run=0,P.force<.3?T.moveForce=(P.force-.2)/.1:T.moveForce=1):p==="rot"&&(P.force<.2?T.rotForce=0:(T.movementState.rotPosX=P.vector.y,T.movementState.rotPosY=-P.vector.x,P.force<.3?T.rotForce=(P.force-.2)/.1:T.rotForce=1)),this.requestRender()}),A.on("end",(M,P)=>{let T=this.gameControl;p==="pos"?(T.movementState.movePosZ=0,T.movementState.movePosX=0,T.moveForce=1):p==="rot"&&(T.movementState.rotPosX=0,T.movementState.rotPosY=0,T.rotForce=1)}),this.joysticks[v]=[A,m]}),this.markIsDestroyTarget(),this.markIsDragObject(),this.rebuildBVH(),this.initializationCounter++,window.setTimeout(()=>{this.collisionEvents.forEach(p=>p.initialDisabled=!1)},80)}initPhysics(){var o;(o=this.sharedGameControlGlobals.rapierWorld)==null||o.free(),this.sharedGameControlGlobals.rapierWorld=new Er.World(new Er.Vector3(0,this.gravity,0)),this.events=new Er.EventQueue(!0);let e=[],t=[];if(this.page.traverseChildren(s=>{var g,y,b,x;let l;if(s instanceof ns)if(s.objectForSample){if(s.objectForSample.dataPatched.physics.fusedBody)return;l=s.object}else return s.object.dataPatched.physics.fusedBody===!0&&s.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(s instanceof pa)l=s.object;else{if(s instanceof Ab||s instanceof Cb)return;if(l=s,((g=l.dataPatched.cloner)==null?void 0:g.disabled)===!1&&((y=l.dataPatched.cloner)==null?void 0:y.hideBase)&&((b=l.dataPatched.physics)==null?void 0:b.fusedBody)!==!0)return!0}let c=l.dataPatched,d;for(let S of c.events)S.data.disabled!==!0&&S.data.type==="GameControl"&&(d=S.data);if(!c.physics||(c.physics.enabled==="visibility"?!c.visible:!c.physics.enabled))return!0;s.updateMatrixWorldSVD();let u=c1(c),h=!1,f=l.userData.hasDestroy,p=l.userData.hasDrag,v=!1;for(let S of c.events)if(S.data.disabled!==!0){if(S.data.type==="Collision"){h=!0;let w=new n5e(S.id,S.data,l,this.page,this.sharedAssets,this.eventManager);w.initialDisabled=!0,this.collisionEvents.push(w),this.sharedGameControlGlobals.entityToCollisionEvents[l.uuid]&&this.sharedGameControlGlobals.entityToCollisionEvents[l.uuid].every(_=>_.id!==S.id)?this.sharedGameControlGlobals.entityToCollisionEvents[l.uuid].push(w):this.sharedGameControlGlobals.entityToCollisionEvents[l.uuid]=[w]}else if(S.data.type==="Follow"){v=!0;let w=S.data.target;s.traverseVisible(_=>{_.userData.isFollowingObj=w})}}c.physics.rigidBody==="dynamic"&&c.physics.fusedBody===!1&&(s.matrixWorldFusedFalse=s.matrixWorld.clone());let m=s.geometry;if(d!==void 0){let S=Er.RigidBodyDesc.kinematicPositionBased();(s.hasNonUniformScale?s.matrixWorldRigid:s.matrixWorld).decompose(tn,Ko,Bc),s.position0=tn.clone().divideScalar(this.pixelsPerMeter),s.rotation0=Ko.clone(),tn.divideScalar(this.pixelsPerMeter),S.setTranslation(tn.x,tn.y,tn.z).setRotation(Ko);let w=this.sharedGameControlGlobals.rapierWorld.createRigidBody(S);s.rigidBody=w;let _;d.collider.type==="sphere"?_=Er.ColliderDesc.ball(d.collider.radius/this.pixelsPerMeter):d.collider.type==="capsule"?_=Er.ColliderDesc.capsule((d.collider.height/2-d.collider.radius)/this.pixelsPerMeter,d.collider.radius/this.pixelsPerMeter):_=Er.ColliderDesc.cuboid(d.collider.width/this.pixelsPerMeter/2,d.collider.height/this.pixelsPerMeter/2,d.collider.depth/this.pixelsPerMeter/2),_.setFrictionCombineRule(Er.CoefficientCombineRule.Average).setRestitutionCombineRule(Er.CoefficientCombineRule.Average).setDensity(c.physics.density).setFriction(c.physics.friction).setRestitution(c.physics.restitution);let C=this.sharedGameControlGlobals.rapierWorld.createCollider(_,w);this.sharedGameControlGlobals.colliderToEntity.set(C.handle,l),tn.fromArray(d.collider.position).multiply(Bc.setFromMatrixScale(l.matrixWorld)).divideScalar(this.pixelsPerMeter),C.setTranslationWrtParent(tn);let A=new Xt().setFromEuler(new vn().setFromVector3(new k().fromArray(d.collider.rotation)));C.setRotationWrtParent(A),C.setActiveEvents(Er.ActiveEvents.COLLISION_EVENTS),this.generateSensorColliderDescs(l,!0)}else c.physics.rigidBody==="dynamic"||u||v||f||p||h?(this.addRigidBody(s,l,{hasFollow:v,hasTransformAnim:u,hasDrag:p}),this.generateSensorColliderDescs(l,c.physics.fusedBody)):(m&&e.push(Nl(m,s.matrixWorld)),c.physics.fusedBody&&s.traverseObject((S,w)=>{var M;if(w===0)return;let _;if(S instanceof ns)if(S.objectForSample){if(S.objectForSample.dataPatched.physics.fusedBody)return;_=S.object}else return S.object.dataPatched.physics.fusedBody===!0&&S.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else{if(S instanceof Ab||S instanceof Cb)return;if(S instanceof pa)_=S.object;else if(_=S,(M=_.dataPatched.cloner)==null?void 0:M.hideBase)return!0}let C=_.dataPatched;if(C.physics.enabled==="visibility"?!C.visible:!C.physics.enabled)return!0;let A=S.geometry;(A==null?void 0:A.getAttribute("position"))!==void 0&&e.push(Nl(A,S.matrixWorld))}),this.generateSensorColliderDescs(l,c.physics.fusedBody,t));if(((x=c.physics)==null?void 0:x.fusedBody)===!0||d)return!0}),e.length===0)return;let r=Pu(e);r.scale(1/this.pixelsPerMeter,1/this.pixelsPerMeter,1/this.pixelsPerMeter);let i=Er.RigidBodyDesc.fixed(),n=this.sharedGameControlGlobals.rapierWorld.createRigidBody(i),a=Er.ColliderDesc.trimesh(r.getAttribute("position").array,r.getIndex().array).setFrictionCombineRule(Er.CoefficientCombineRule.Multiply).setRestitutionCombineRule(Er.CoefficientCombineRule.Multiply).setFriction(1).setRestitution(1);this.sharedGameControlGlobals.rapierWorld.createCollider(a,n);for(let[s,l]of t){let c=this.sharedGameControlGlobals.rapierWorld.createCollider(s,n);this.sensorToTriggerEvent[c.handle]=l}}updatePositions(){return this.nActiveRigidBodies=0,this.sharedGameControlGlobals.rapierWorld.forEachRigidBody(this.processRigidBody),this.nActiveRigidBodies>0}rebuildBVH(){this.usePhysics?this.initPhysics():(this.page.traverseEntity(e=>{for(let t of e.dataPatched.events)if(t.data.type==="Trigger"&&t.data.disabled!==!0){let r=new Y4(t.id,t.data,e,this.page,this.sharedAssets,this.eventManager),i=new it().compose(Qo.fromArray(t.data.position),mf.setFromEuler(X4.fromArray(t.data.rotation)),P_);if(t.data.triggerZone==="box"){let n=new Zi;n.min.fromArray(t.data.size).multiplyScalar(-.5),n.max.fromArray(t.data.size).multiplyScalar(.5),this.sharedGameControlGlobals.triggers.push([n,i,e,r])}else this.sharedGameControlGlobals.triggers.push([t.data.radius,i,e,r])}}),this.needsCollisionDetection&&this.initBVH())}disconnectEvents(){this.collisionEvents.forEach(e=>e.disconnect()),this.sharedGameControlGlobals.triggers.forEach(e=>e[3].disconnect()),this.sharedGameControlGlobals.triggers.length=0}deactivate(){var e,t,r,i;if(this.isEnabled){this.isEnabled=!1,this.page.traverse(n=>{let a=n;a.matrixWorldFusedFalse&&(a.matrixWorldFusedFalse=void 0),a.rigidBody&&(a.rigidBody=void 0),a.position0&&(a.position0=void 0),a.rotation0&&(a.rotation0=void 0)}),(e=this.sharedGameControlGlobals.rapierWorld)==null||e.free(),this.sharedGameControlGlobals.rapierWorld=void 0,this.sharedGameControlGlobals.staticMeshBVH=void 0,this.accumulator=0,this.sharedGameControlGlobals.entitiesWithTransformAnim=[],this.disconnectEvents(),(t=this.gameControl)==null||t.reset(),(r=this.gameControl)==null||r.dispose(),this.gameControl=null,this.initializationCounter=-1,this.joysticks.forEach(([n,a])=>{n==null||n.destroy(),a.remove()}),this.joystickToGameControls=[],this.joysticks=[],this.orbitControls&&(this.orbitControls.dispose(),this.orbitControls=void 0),(i=this.navigationMeshWrapper)==null||i.dispose(),this.navigationMeshWrapper=void 0;for(let n of Object.values(this.sharedGameControlGlobals.entityToCollisionEvents))n.forEach(a=>a.disconnect());this.sharedGameControlGlobals.entityToCollisionEvents={},this.page.updateMatrixWorld(!0)}}update(e,t,r){if(!this.isEnabled)return!0;let i=!0;if(this.orbitControls!==void 0&&this.orbitControls.needsUpdate&&(i=!this.orbitControls.update()),this.initializationCounter>=0&&this.initializationCounter<2?(this.initializationCounter++,i=!1):this.initializationCounter===2&&this.gameControl&&(i=!this.gameControl.update(e,t,r)&&i),this.usePhysics===!1&&this.checkTrigger(),this.usePhysics){let n=.016666666666666666;if(e===0)i=this.stepPhysics()&&i;else{let a=e/1e3;a<n&&a>n*.55&&(a=n),this.accumulator+=a;let o=performance.now(),s=0,l=6;for(;this.accumulator>=n&&s<l&&(i=this.stepPhysics()&&i,this.accumulator-=n,s++,!(performance.now()-o>n*1e3)););this.accumulator=this.accumulator%n}}return i}stepPhysics(){var e;for(let t of this.sharedGameControlGlobals.entitiesWithTransformAnim){(t.hasNonUniformScale?t.matrixWorldRigid:t.matrixWorld).decompose(tn,Ko,Bc),E_.setFromQuaternion(Ko);let r=t;r.prevR===void 0?(r.prevR=E_.clone(),r.prevT=tn.clone()):(r.prevR.copy(E_),r.prevT.copy(tn)),t.rigidBody&&(t.rigidBody.setNextKinematicTranslation(tn.divideScalar(this.pixelsPerMeter)),t.rigidBody.setNextKinematicRotation(Ko))}return this.sharedGameControlGlobals.rapierWorld.step(this.events),(e=this.events)==null||e.drainCollisionEvents(this.handleCollisionEvents),!this.updatePositions()}dispatchCollisionEvent(e,t,r){var a;let i=((a=this.sharedGameControlGlobals.rapierWorld)==null?void 0:a.getCollider(r))._parent,n;if(t.cloner){for(let o of t.cloner.children)if(o.rigidBody===i){n=o;break}}e.dispatch(n),t.dispatchEvent(_E)}updateUseWindowEvents(e){var t;(t=this.orbitControls)==null||t.updateUseWindowEvents(e)}generateSensorColliderDescs(e,t,r){let i=K4.copy(e.matrixWorld).invert();e.traverseEntity((n,a)=>{if(t===!1&&a===1)return!0;for(let o of n.dataPatched.events)if(o.data.type==="Trigger"&&o.data.disabled!==!0){let s=new Y4(o.id,o.data,n,this.page,this.sharedAssets,this.eventManager),l;if(o.data.triggerZone==="box"?l=Er.ColliderDesc.cuboid(...o.data.size.map(c=>c/(2*this.pixelsPerMeter))):l=Er.ColliderDesc.ball(o.data.radius/this.pixelsPerMeter),l.setDensity(0).setSensor(!0).setActiveEvents(Er.ActiveEvents.COLLISION_EVENTS),Qo.fromArray(o.data.position),mf.setFromEuler(X4.fromArray(o.data.rotation)),rb.compose(Qo,mf,P_).premultiply(n.matrixWorld),r?(rb.decompose(Qo,mf,T_),l.setActiveCollisionTypes(Er.ActiveCollisionTypes.KINEMATIC_FIXED|Er.ActiveCollisionTypes.DYNAMIC_FIXED)):(rb.premultiply(i).decompose(Qo,mf,T_),e.rigidBody.bodyType()===Er.RigidBodyType.Dynamic||(e.rigidBody.bodyType()===Er.RigidBodyType.Fixed?l.setActiveCollisionTypes(Er.ActiveCollisionTypes.KINEMATIC_FIXED|Er.ActiveCollisionTypes.DYNAMIC_FIXED):l.setActiveCollisionTypes(Er.ActiveCollisionTypes.KINEMATIC_KINEMATIC|Er.ActiveCollisionTypes.DYNAMIC_KINEMATIC))),Qo.divideScalar(this.pixelsPerMeter),l.setTranslation(Qo.x,Qo.y,Qo.z),l.setRotation(mf),r)r.push([l,s]);else{let c=this.sharedGameControlGlobals.rapierWorld.createCollider(l,e.rigidBody);this.sensorToTriggerEvent[c.handle]=s}}})}checkTrigger(){let e;for(let t=0;t<this.sharedGameControlGlobals.triggers.length;t++){let[r,i,n,a]=this.sharedGameControlGlobals.triggers[t];for(let o=0;o<this.sharedGameControlGlobals.entitiesWithTransformAnim.length;o++){let s=this.sharedGameControlGlobals.entitiesWithTransformAnim[o];if(n===s||a.isValidTriggeringObject(Cr.is(s)?s:s.object)===!1)continue;let l=K4.copy(n.matrixWorld).decompose(Qo,Q4,T_).compose(Qo,Q4,P_).multiply(i),c=rb.copy(s.matrixWorld).invert().multiply(l);r instanceof Zi?e=s.bvhGeometry.boundsTree.intersectsBox(r,c):(D_.radius=r,D_.center.setFromMatrixPosition(c),e=s.bvhGeometry.boundsTree.intersectsSphere(D_)),e?a.currentIntersectedObjects.indexOf(s)===-1&&(a.currentIntersectedObjects.push(s),a.dispatch(),n.dispatchEvent(M5e)):a.currentIntersectedObjects=a.currentIntersectedObjects.filter(d=>d!==s)}}}};function P5e(e){let t=this._clip.duration,r=this._clip.start??0,i=this.loop,n=this.time+e,a=this._loopCount,o=i===QT;if(e===0)return a===-1?n:o&&(a&1)===1?t-(n-r):n;if(i===oj){a===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(n>=t)n=t;else if(n<0)n=0;else{this.time=n;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=n,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(a===-1&&(e>=0?(a=0,this._setEndings(!0,this.repetitions===0,o)):this._setEndings(this.repetitions===0,!0,o)),n>=t||n<r){let s=Math.floor((n-r)/(t-r));n-=(t-r)*s,a+=Math.abs(s);let l=this.repetitions-a;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,o||(n=e>0?t:r,this.repetitions===1&&(n=t)),this.time=n,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(l===1){let c=e<0;this._setEndings(c,!c,o)}else this._setEndings(!1,!1,o);this._loopCount=a,this.time=n,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:s})}}else this.time=n;if(o&&(a&1)===1)return t-(n-r)}return n}var Z4=!1,D5e=class{constructor(e,t,r,i){this.scene=e,this.requestRender=t,this.updateDisplayProgress=r,this.animationInspectorState=i,this.clipIdToAction={},this.activeClip=null,this.needsUpdate=!1,this.addClip=n=>{n.data.type==="Empty"&&n.data.animations&&n.data.animations.forEach((a,o)=>{let s=a[0]+"/";if(Array.isArray(n.identity)?s+=n.identity[0]:s+=n.uuid,this.clipIdToAction[s])return;let l=LA.parse(JSON.parse(a[2]));n.animations[o]=l;let c=this.mixer.clipAction(l,n);Z4===!1&&(Object.getPrototypeOf(c)._updateTime=P5e,Z4=!0),c.clampWhenFinished=!0,this.clipIdToAction[s]=c})},this.mixer=new X1e(e),this.scene.traverseEntity(this.addClip)}deleteClip(e,t){let r=this.scene.find(t);if(!r)return;let i=r.animations.find(a=>a.uuid===e);if(!i)return;let n=this.clipIdToAction[e];!n||(n.stop(),this.mixer.uncacheClip(i),delete this.clipIdToAction[e],r.animations=r.animations.filter(a=>a.uuid!==e))}get isPlaying(){return Object.values(this.clipIdToAction).some(e=>e.isRunning())}playFromInspector(e){this.mixer.stopAllAction();let t=this.clipIdToAction[e];!t||(t.play(),this.activeClip=t.getClip(),this.requestRender())}onExitPlayMode(){Object.values(this.clipIdToAction).forEach(e=>{e.repetitions=1/0,e.loop=sj}),this.mixer.stopAllAction(),this.requestRender()}play(e){let t=e.clipId+"/"+e.object,r=this.clipIdToAction[t];if(r)return e&&(e.repeat>=0&&(r.repetitions=e.repeat+1),e.direction==="pingpong"&&e.repeat!==0&&(r.loop=QT)),r.play(),r.paused=!1,this.requestRender(),r}resumeFromInspector(e){let t=this.clipIdToAction[e];!t||(t.play(),t.paused=!1,this.requestRender())}pauseFromInspector(e){let t=this.clipIdToAction[e];!t||(t.paused=!0)}stop(){this.mixer.stopAllAction(),this.requestRender()}update(e){var t;if(this.needsUpdate)this.needsUpdate=!1;else if(this.isPlaying===!1||(t=this.animationInspectorState)!=null&&t.isScrubbing)return;this.mixer.update(e/1e3),this.activeClip&&this.updateDisplayProgress(Math.round(this.mixer.time/this.activeClip.duration*(this.maxFrames-1)%(this.maxFrames-1))),this.requestRender()}get maxFrames(){return zW(this.activeClip??void 0)}setProgressFromInspector(e,t){if(!this.clipIdToAction[t])return;this.activeClip!==this.clipIdToAction[t].getClip()&&this.playFromInspector(t);let r=this.clipIdToAction[t].paused;this.clipIdToAction[t].paused=!1,this.mixer.setTime(Math.min(e/(this.maxFrames-1),.9999)*this.activeClip.duration),this.requestRender(),r&&(this.clipIdToAction[t].paused=!0)}},O_=new WeakMap,O5e=class extends qg{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,r,i){let n=new BA(this.manager);n.setPath(this.path),n.setResponseType("arraybuffer"),n.setRequestHeader(this.requestHeader),n.setWithCredentials(this.withCredentials),n.load(e,a=>{this.decodeDracoFile(a,t).catch(i)},r,i)}decodeDracoFile(e,t,r,i){let n={attributeIDs:r||this.defaultAttributeIDs,attributeTypes:i||this.defaultAttributeTypes,useUniqueIDs:!!r};return this.decodeGeometry(e,n).then(t)}decodeGeometry(e,t){let r=JSON.stringify(t);if(O_.has(e)){let s=O_.get(e);if(s.key===r)return s.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let i,n=this.workerNextTaskID++,a=e.byteLength,o=this._getWorker(n,a).then(s=>(i=s,new Promise((l,c)=>{i._callbacks[n]={resolve:l,reject:c},i.postMessage({type:"decode",id:n,taskConfig:t,buffer:e},[e])}))).then(s=>this._createGeometry(s.geometry));return o.catch(()=>!0).then(()=>{i&&n&&this._releaseTask(i,n)}),O_.set(e,{key:r,promise:o}),o}_createGeometry(e){let t=new Ot;e.index&&t.setIndex(new $t(e.index.array,1));for(let r=0;r<e.attributes.length;r++){let i=e.attributes[r],n=i.name,a=i.array,o=i.itemSize;t.setAttribute(n,new $t(a,o))}return t}_loadLibrary(e,t){let r=new BA(this.manager);return r.setPath(this.decoderPath),r.setResponseType(t),r.setWithCredentials(this.withCredentials),new Promise((i,n)=>{r.load(e,i,void 0,n)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;let e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(r=>{let i=r[0];e||(this.decoderConfig.wasmBinary=r[1]);let n=R5e.toString(),a=["/* draco decoder */",i,"","/* worker */",n.substring(n.indexOf("{")+1,n.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([a]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){let i=new Worker(this.workerSourceURL);i._callbacks={},i._taskCosts={},i._taskLoad=0,i.postMessage({type:"init",decoderConfig:this.decoderConfig}),i.onmessage=function(n){let a=n.data;switch(a.type){case"decode":i._callbacks[a.id].resolve(a);break;case"error":i._callbacks[a.id].reject(a);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+a.type+'"')}},this.workerPool.push(i)}else this.workerPool.sort(function(i,n){return i._taskLoad>n._taskLoad?-1:1});let r=this.workerPool[this.workerPool.length-1];return r._taskCosts[e]=t,r._taskLoad+=t,r})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this.workerSourceURL!==""&&URL.revokeObjectURL(this.workerSourceURL),this}};function R5e(){let e,t;onmessage=function(o){let s=o.data;switch(s.type){case"init":e=s.decoderConfig,t=new Promise(function(d){e.onModuleLoaded=function(u){d({draco:u})},DracoDecoderModule(e)});break;case"decode":let l=s.buffer,c=s.taskConfig;t.then(d=>{let u=d.draco,h=new u.Decoder,f=new u.DecoderBuffer;f.Init(new Int8Array(l),l.byteLength);try{let p=r(u,h,f,c),v=p.attributes.map(m=>m.array.buffer);p.index&&v.push(p.index.array.buffer),self.postMessage({type:"decode",id:s.id,geometry:p},v)}catch(p){console.error(p),self.postMessage({type:"error",id:s.id,error:p.message})}finally{u.destroy(f),u.destroy(h)}});break}};function r(o,s,l,c){let d=c.attributeIDs,u=c.attributeTypes,h,f,p=s.GetEncodedGeometryType(l);if(p===o.TRIANGULAR_MESH)h=new o.Mesh,f=s.DecodeBufferToMesh(l,h);else if(p===o.POINT_CLOUD)h=new o.PointCloud,f=s.DecodeBufferToPointCloud(l,h);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!f.ok()||h.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+f.error_msg());let v={index:null,attributes:[]};for(let m in d){let g=self[u[m]],y,b;if(c.useUniqueIDs)b=d[m],y=s.GetAttributeByUniqueId(h,b);else{if(b=s.GetAttributeId(h,o[d[m]]),b===-1)continue;y=s.GetAttribute(h,b)}v.attributes.push(n(o,s,h,m,g,y))}return p===o.TRIANGULAR_MESH&&(v.index=i(o,s,h)),o.destroy(h),v}function i(o,s,l){let c=l.num_faces()*3,d=c*4,u=o._malloc(d);s.GetTrianglesUInt32Array(l,d,u);let h=new Uint32Array(o.HEAPF32.buffer,u,c).slice();return o._free(u),{array:h,itemSize:1}}function n(o,s,l,c,d,u){let h=u.num_components(),f=l.num_points()*h,p=f*d.BYTES_PER_ELEMENT,v=a(o,d),m=o._malloc(p);s.GetAttributeDataArrayForAllPoints(l,u,v,p,m);let g=new d(o.HEAPF32.buffer,m,f).slice();return o._free(m),{name:c,array:g,itemSize:h}}function a(o,s){switch(s){case Float32Array:return o.DT_FLOAT32;case Int8Array:return o.DT_INT8;case Int16Array:return o.DT_INT16;case Int32Array:return o.DT_INT32;case Uint8Array:return o.DT_UINT8;case Uint16Array:return o.DT_UINT16;case Uint32Array:return o.DT_UINT32}}}var sd;function I5e(){return sd||(sd=new O5e,sd.setDecoderPath("https://www.gstatic.com/draco/versioned/decoders/1.5.2/").preload()),sd.decoderPending}async function z5e(e){if(sd){let t={attributeIDs:sd.defaultAttributeIDs,attributeTypes:sd.defaultAttributeTypes,useUniqueIDs:!1},r;try{r=await sd.decodeGeometry(new Int8Array(e).buffer,t)}catch(i){console.error(i)}if(r)return{index:r.index?{array:r.index.array}:void 0,attributes:Object.entries(r.attributes).map(([i,n])=>({name:i,itemSize:n.itemSize,array:n.array}))}}return null}async function k5e(e,t){let[r,i]=WV(ZA.deserialize(new Uint8Array(e)));return m8(r),i.result().data}function L5e(e){let t=[];return e.scene.objects.traverse((r,i)=>{i.type==="Mesh"&&i.geometry.type==="NonParametricGeometry"&&i.geometry.data.draco!==void 0&&t.push(i)}),t}async function B5e(e){for(let t of e){let r=await z5e(t.geometry.data.draco);if(r){let i=t.geometry.data;r.index&&(i.index={array:r.index.array,itemSize:1,normalized:!1,type:"Uint32Array"});let n={};r.attributes.forEach(({name:a,array:o,itemSize:s})=>{n[a]={array:o,itemSize:s,type:"Float32Array",normalized:!1}}),i.attributes=n,i.draco=void 0}}}var F5e=class{constructor(){this._clickCount=0,this._lastTime=0,this._lastPosition=[0,0],this._delay=500,this._distance=2,this._onMouseDown=e=>{let t=[e.clientX,e.clientY],r=new Date().getTime();if(this._clickCount>0){let i=t[0]-this._lastPosition[0],n=t[1]-this._lastPosition[1];Math.sqrt(i*i+n*n)>this._distance&&(this._clickCount=0)}this._lastPosition=t,this._clickCount=r-this._lastTime>this._delay?1:this._clickCount+1,this._lastTime=r},this._onMouseUp=e=>{}}start(e,t=500,r=2){this._target&&this.stop(),this.reset(),this._delay=t,this._distance=r,this._target=e,this._target.addEventListener("pointerdown",this._onMouseDown,!1),this._target.addEventListener("pointerup",this._onMouseUp,!1)}stop(){this._target&&(this._target.removeEventListener("pointerdown",this._onMouseDown,!1),this._target.removeEventListener("pointerup",this._onMouseUp,!1),this._target=void 0)}get clickCount(){return this._clickCount}reset(){this._clickCount=0,this._lastTime=0,this._lastPosition=[0,0]}},N5e=class{constructor(e,t,r,i,n,a,o,s){this.eventId=e,this.id=t,this.data=r,this.dataEvent=i,this.object=n,this.stage=!1,this.actions=Hn(i,r.actions,a,o,s,n)}disconnect(){Fn(this.actions)}dispatchIn(){this.actions.Audio.forEach(e=>e.dispatchBasic()),this.actions.Particles.forEach(e=>e.dispatchBasic()),this.actions.Video.forEach(e=>e.dispatchBasic()),this.actions.Create.forEach(e=>e.dispatch()),this.actions.Destroy.forEach(e=>e.dispatch()),this.actions.Reset.forEach(e=>e.dispatch()),this.actions.Link.forEach(e=>e.dispatch()),this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),this.actions.Transition.forEach(e=>e.toggle()),this.actions.Animation.forEach(e=>e.play()),this.actions.SwitchCamera.forEach(e=>e.play()),this.actions.SceneTransition.forEach(e=>e.dispatch()),this.actions.SetVariable.forEach(e=>e.checkConditions()),this.actions.SetVariable.forEach(e=>e.dispatch()),this.actions.DynamicVariablePlay.forEach(e=>e.dispatch()),this.actions.ClearLocalStorage.forEach(e=>e.dispatch()),this.actions.UserAPI.forEach(e=>e.dispatch())}dispatchOut(){this.actions.Transition.forEach(e=>{e.toggle()})}},U5e=class extends to{constructor(e,t){super(e),this.eventManager=t,this.breakpoints=[],this.resize=(r,i)=>{this.breakpoints.forEach(n=>{let a=rM.deviceToSize(n.data.size),o=n.dataEvent.orientation==="horizontal"?r:i,s;switch(n.data.operator){case"<":s=o<a[0];break;case">":s=o>a[0];break;case"<>":s=o>a[0]&&o<a[1];break}n.stage!==s&&(n.stage=s,n.stage?n.dispatchIn():n.dispatchOut())})},this.onResizeObserver=new ResizeObserver(r=>{for(let i of r){let{width:n,height:a}=i.contentRect;this.resize(n,a)}})}connect(){let{page:e,sharedAssets:t,domElement:r}=this.eventContext;this.onResizeObserver.observe(r);let i=n=>{var a;if(!(!n.visible||!((a=n.data)!=null&&a.events.length)))for(let{data:o,id:s}of n.data.events)o.disabled||o.type==="Resize"&&o.breakpoints.forEach(({data:l,id:c})=>{try{let d=new N5e(s,c,l,o,n,e,t,this.eventManager);this.breakpoints.push(d)}catch{}})};e.traverseEntity(n=>{var a;(n instanceof ha||n instanceof Pn)&&((a=n.frame)==null||a.traverse(o=>{i(o)})),i(n)})}disconnect(){this.onResizeObserver.disconnect(),this.breakpoints.forEach(e=>{e.disconnect()}),this.breakpoints=[]}},j5e=class extends to{constructor(e,t){super(e),this.eventManager=t,this.userAPIs={},this.events=[],this.onSuccess=({userAPIId:r})=>{this.events.forEach(i=>{i.data.userAPIId===r&&i.dispatchSuccess()})},this.onError=({userAPIId:r})=>{this.events.forEach(i=>{i.data.userAPIId===r&&i.dispatchError()})},this.userAPIs=e.sharedAssets.getUserAPIs()}connect(){this.eventContext.page.traverseEntity(e=>{var t;(t=e.data)==null||t.events.filter(r=>r.data.type==="API"&&!r.data.disabled).forEach(r=>{this.events.push(new V5e(r.id,r.data,e,this.eventContext.page,this.eventContext.sharedAssets,this.eventManager))})}),Object.entries(this.userAPIs).forEach(([e,t])=>{t.on("success",this.onSuccess),t.on("error",this.onError),t.autostart&&t.callUserAPI(this.eventContext.sharedAssets)})}disconnect(){Object.entries(this.userAPIs).forEach(([e,t])=>{t.off("success",this.onSuccess),t.off("error",this.onError)})}},V5e=class{constructor(e,t,r,i,n,a){this.id=e,this.data=t,this.object=r,this.successActions=Hn(t,t.successActions,i,n,a,r),this.errorActions=Hn(t,t.errorActions,i,n,a,r)}dispatchSuccess(){this.dispatchActions(this.successActions)}dispatchError(){this.dispatchActions(this.errorActions)}dispatchActions(e){e.Audio.forEach(t=>t.dispatchConditional()),e.Particles.forEach(t=>t.dispatchConditional()),e.Video.forEach(t=>t.dispatchConditional()),e.Create.forEach(t=>t.dispatch()),e.Destroy.forEach(t=>t.dispatch()),e.Reset.forEach(t=>t.dispatch()),e.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this),t.init()}),e.Transition.forEach(t=>t.play()),e.Animation.forEach(t=>t.play()),e.SwitchCamera.forEach(t=>t.play()),e.SceneTransition.forEach(t=>t.dispatch()),e.SetVariable.forEach(t=>t.checkConditions()),e.SetVariable.forEach(t=>t.dispatch()),e.DynamicVariablePlay.forEach(t=>t.dispatch()),e.ClearLocalStorage.forEach(t=>t.dispatch()),e.UserAPI.forEach(t=>t.dispatch())}},H5e=class extends to{constructor(e,t){super(e),this.eventManager=t,this.userWebhooks={},this.events=[],this.onMessage=({userWebhookId:r})=>{this.events.forEach(i=>{i.data.userWebhookId===r&&i.dispatch()})},this.userWebhooks=e.sharedAssets.getUserWebhooks()}connect(){this.eventContext.page.traverseEntity(e=>{var t;(t=e.data)==null||t.events.filter(r=>r.data.type==="WEBHOOK"&&!r.data.disabled).forEach(r=>{this.events.push(new W5e(r.id,r.data,e,this.eventContext.page,this.eventContext.sharedAssets,this.eventManager))})}),Object.entries(this.userWebhooks).forEach(([e,t])=>{t.connect(),t.on("message",this.onMessage)})}disconnect(){Object.entries(this.userWebhooks).forEach(([e,t])=>{t.off("message",this.onMessage),t.disconnect()})}},W5e=class{constructor(e,t,r,i,n,a){this.id=e,this.data=t,this.object=r,this.actions=Hn(t,t.actions,i,n,a,r)}dispatch(){let e=this.actions;e.Audio.forEach(t=>t.dispatchConditional()),e.Particles.forEach(t=>t.dispatchConditional()),e.Video.forEach(t=>t.dispatchConditional()),e.Create.forEach(t=>t.dispatch()),e.Destroy.forEach(t=>t.dispatch()),e.Reset.forEach(t=>t.dispatch()),e.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this),t.init()}),e.Transition.forEach(t=>t.play()),e.Animation.forEach(t=>t.play()),e.SwitchCamera.forEach(t=>t.play()),e.SceneTransition.forEach(t=>t.dispatch()),e.SetVariable.forEach(t=>t.checkConditions()),e.SetVariable.forEach(t=>t.dispatch()),e.DynamicVariablePlay.forEach(t=>t.dispatch()),e.ClearLocalStorage.forEach(t=>t.dispatch()),e.UserAPI.forEach(t=>t.dispatch())}};function G5e(){let e=document.createElement("textarea");return e.style.position="fixed",e.style.top="200px",e.style.left="400px",e.style.zIndex="-1",e.style.border="1px solid rgba(255,0,0,0.5)",e.style.width="10px",e.style.height="500px",e.style.color="white",e.style.opacity="0.5",e.style.background="transparent",e.style.display="none",e.style.margin="0px",e.style.padding="0px",e.style.boxSizing="content-box",e.style.pointerEvents="none",e}var $5e=new k(0,0,1),J4=new k,eF=new k,tF=new sn,q5e=class{constructor(e,t,r,i,n){this.containerScene=e,this.raycaster=t,this.sharedAssets=r,this.requestRender=i,this.onExit=n,this.htmlInput=null,this.virtualInput=null,this.helper=new VH,this.doubleClickHandler=new F5e,this.isDragging=!1,this.plane=new Va,this.caretInterval=0,this.planeIntersection=new k,this.projected=new ye,this._lastIndex=0,this._isFirstDragMove=!1,this.selectionOnDragStart=0,this.onTextMaterialChanged=()=>{var o;let a=(o=this.virtualInput)==null?void 0:o.data;if(this.virtualInput!==void 0&&a){let s=a.material,l=typeof s=="string"?this.sharedAssets.data.materials[s]:s,c=sLe(l,this.sharedAssets);this.helper.setCaretColor(c)}},this.stopAnimateTextCursor=()=>{clearInterval(this.caretInterval),this.helper&&(this.helper.caretMesh.visible=!1)},this.startAnimateTextCursor=()=>{this.stopAnimateTextCursor(),this.helper&&(this.helper.caretMesh.visible=!0,this.caretInterval=setInterval(()=>{this.helper&&(this.helper.caretMesh.visible=!this.helper.caretMesh.visible),this.requestRender()},600))},this.handleCaretUpdate=a=>{if(!this.htmlInput||!this.virtualInput)return;let o=this.helper,s=(a==null?void 0:a.key)==="ArrowLeft"||(a==null?void 0:a.key)==="ArrowRight",l=(a==null?void 0:a.key)==="ArrowUp"||(a==null?void 0:a.key)==="ArrowDown";this.htmlInput.selectionStart===this.htmlInput.selectionEnd?(o.setCaretPosition(this.htmlInput.selectionStart,{horizontalKeyMove:s,verticalKeyMove:l}),this.startAnimateTextCursor()):o.setSelection(this.htmlInput.selectionStart,this.htmlInput.selectionEnd),this.requestRender()},this.containerScene.add(this.helper)}createInput(){return this.htmlInput=G5e(),this.htmlInput}connect(){}disconnect(){var e;this.stopAnimateTextCursor(),this.helper.hide(),(e=this.htmlInput)==null||e.remove(),this.doubleClickHandler.stop()}handleMouseDown(){var a;if(!this.htmlInput||!this.virtualInput)return!0;this.getPointOnPlane();let e=this.doubleClickHandler.clickCount,{index:t,lineIndex:r,characterIndex:i}=this.helper.getSelectionFromPosition(this.projected.x,this.projected.y,e>1?"inside":"previous")??{index:0,lineIndex:0,characterIndex:0};((a=this.virtualInput)==null?void 0:a.wrappedText[r][Math.max(0,i-1)])===`
`&&(t--,i--),this._lastIndex=t,this._isFirstDragMove=!0;let n=this.checkClickedObject();if(e===1){if(n===null)return this.onExit(this.virtualInput),!0;this.selectionOnDragStart=t,this.isDragging=!0,this.setInputSelection(t)}else n===this.virtualInput&&(e===2?this.selectClosestWord(r,i):e>2&&(this.setInputSelection(0,this.htmlInput.value.length),this.doubleClickHandler.reset()))}handleMouseUp(){this.applyRangeToTextInput(),this.isDragging=!1,this._isFirstDragMove=!1}handleMouseMove(){!this.virtualInput||(this._isFirstDragMove&&this.doubleClickHandler.clickCount>1&&(this.selectionOnDragStart=this._lastIndex,this.isDragging=!0,this.setInputSelection(this._lastIndex)),this._isFirstDragMove=!1,this.getPointOnPlane(),this.applyRangeToTextInput())}focus(e){var t;if(this.virtualInput=e,this.updateTextInputStyles(),this.htmlInput)if(e){let r=(t=this.data)==null?void 0:t.geometry.text;this.htmlInput.value=typeof r=="string"?"":(r==null?void 0:r.textValue.toString())??""}else this.htmlInput.value=""}blur(){}get data(){let{virtualInput:e}=this;if(e)return e.dataPatched}applyRangeToTextInput(){var n;if(!this.isDragging||!this.virtualInput||!this.htmlInput)return;let e=this.selectionOnDragStart,{index:t,lineIndex:r,characterIndex:i}=this.helper.getSelectionFromPosition(this.projected.x,this.projected.y,this.doubleClickHandler.clickCount>2?"inside":"previous")??{index:0};r!==void 0&&i!==void 0&&((n=this.virtualInput)==null?void 0:n.wrappedText[r][i-1])===`
`&&t--,this.htmlInput.setSelectionRange(Math.min(e,t),Math.max(e,t))}checkClickedObject(){if(this.virtualInput){let e=this.raycaster.intersectObject(this.virtualInput,!1);if(e.length>0){let t=e[0];if(t.object instanceof vD)return t.object}}return null}selectClosestWord(e,t){if(!this.virtualInput)return;let r=this.virtualInput.wrappedText,i=r[e],n=t+1,a=t;i[t]!==" "&&(n=this.findNextCharOccurence(i,t,"forward"," "),a=this.findNextCharOccurence(i,t,"backward"," "),a>0&&a++,n>=i.length-1&&e===r.length-1&&n++);let o=this.helper,s=o.getGlobalIndexFromLineAndCharIndexes(r,e,a),l=o.getGlobalIndexFromLineAndCharIndexes(r,e,n);this.setInputSelection(s,l)}findNextCharOccurence(e,t,r,i=" "){let n=Math.max(0,e.length-1),a=r==="forward"?n:0,o=r==="forward"?1:-1,s=Math.max(Math.min(t,n),0);for(;s!==a;)if(s+=o,e.charAt(s)===i)return s;return a}getPointOnPlane(){var t;let e=(t=this.virtualInput)==null?void 0:t.data;if(!(!this.virtualInput||!e)&&this.raycaster.ray.intersectsPlane(this.plane)){this.planeIntersection===null&&(this.planeIntersection=new k);let r=this.raycaster.ray.intersectPlane(this.plane,this.planeIntersection);if(r){this.planeIntersection.copy(this.virtualInput.worldToLocal(r));let i=typeof e.geometry.width=="number"?e.geometry.width:1,n=typeof e.geometry.height=="number"?e.geometry.height:1;this.projected.set(r.x+i*.5,r.y-n*.5)}}}updatePlane(){var t;let e=(t=this.virtualInput)==null?void 0:t.data;this.virtualInput&&e&&(tF.getNormalMatrix(this.virtualInput.matrixWorld),J4.copy($5e).applyMatrix3(tF).normalize(),this.virtualInput.localToWorld(eF.set(0,0,e.geometry.depth)),this.plane.setFromNormalAndCoplanarPoint(J4,eF))}setInputSelection(e,t=e){var r;(r=this.htmlInput)==null||r.setSelectionRange(e,t),setTimeout(()=>{var i;(i=this.htmlInput)==null||i.focus()})}updateTextInputStyles(){var t;let e=(t=this.virtualInput)==null?void 0:t.data;this.virtualInput&&e&&this.htmlInput&&(this.htmlInput.style.fontSize=e.geometry.fontSize+"px",this.htmlInput.style.letterSpacing=e.geometry.letterSpacing*e.geometry.fontSize+"px",this.htmlInput.style.lineHeight=e.geometry.fontSize*e.geometry.lineHeight+"px",this.htmlInput.style.width=e.geometry.width+"px",this.htmlInput.style.height=e.geometry.height+"px",this.htmlInput.style.textAlign=Y5e(e.geometry.horizontalAlign))}};function Y5e(e){return e===4?"justify":e===2?"right":e===3?"center":"left"}var ZW=(e,t)=>{if(typeof e=="string"){let r=t.data(e);if(r)return ZW(r.value,t)}return ta.getDisplayedValue(e)};function rF(e,t){let r=e.text,i="";if(typeof r=="string"){let n=t.variables.data(i);n&&(i=ZW(n.value,t.variables))}else i=r.textValue.toString();return i}var X5e=class extends to{constructor(e,t){super(e),this.eventManager=t,this._textInputs=[],this.sceneHelpers=new Js,this.helper=new VH,this._onMouseDownFocusIn=r=>{if(Ht.length>1)return;this.eventContext.updateRaycaster(r);let i=null;if(this.eventContext.raycaster){for(let n of this._textInputs)if(this.eventContext.raycaster.intersectObject(n,!0).length>0){i=n;break}}this.focusOnTextInput(i),this._onCaretUpdate(),this._onMouseUp(),this.textInputManager.doubleClickHandler.start(this.eventContext.domElement),this.textInputManager.doubleClickHandler._onMouseDown(r),this._onMouseDown(r)},this.onExit=()=>{let{virtualInput:r}=this.textInputManager;if(r===null)return;let i=this.textInputManager.htmlInput;this.helper.hide(),i==null||i.setSelectionRange(i.value.length,i.value.length),this.eventManager.controlsManager.orbitControls&&(this.eventManager.controlsManager.orbitControls.enabled=!0);let{domElement:n}=this.eventContext;n.removeEventListener("pointerdown",this._onMouseDown,!1),n.removeEventListener("pointerup",this._onMouseUp,!1),n.removeEventListener("pointermove",this._onMouseMove,!1),window.removeEventListener("keydown",this._onKeyPress),this.textInputManager.doubleClickHandler.reset(),n.addEventListener("pointerdown",this._onMouseDownFocusIn),this.eventContext.renderer.sceneHelpersOnTop=void 0,this.eventContext.renderer.pipeline.disableHelpers()},this._onMouseDown=r=>{this.eventContext.updateRaycaster(r),this.textInputManager.handleMouseDown(),this.textInputManager.virtualInput&&this.eventContext.raycaster.intersectObject(this.textInputManager.virtualInput,!0).length>0&&this.eventManager.controlsManager.orbitControls&&(this.eventManager.controlsManager.orbitControls.enabled=!1)},this._onMouseUp=()=>{this.textInputManager.handleMouseUp(),this.eventManager.controlsManager.orbitControls&&!this.eventManager.controlsManager.orbitControls.enabled&&(this.eventManager.controlsManager.orbitControls.enabled=!0)},this._onMouseMove=r=>{this.eventContext.updateRaycaster(r),this.textInputManager.handleMouseMove()},this._onTextEdit=r=>{let{htmlInput:i,virtualInput:n,helper:a}=this.textInputManager;if(!i||!n)return;let o=i.value;n.textGeometry.setText(o).then(()=>{this.eventContext.requestRender()});let s=n.data;a.update();let l=s.geometry.text;if(typeof l=="string"){let c=l;this.eventContext.sharedAssets.updateVariable(c,{textValue:o})}this.textInputManager.updateTextInputStyles(),this._onCaretUpdate()},this._onCaretUpdate=r=>{this.textInputManager.handleCaretUpdate(r)},this._onKeyPress=r=>{r.key==="Escape"&&this.onExit()},this.textInputManager=new q5e(this.sceneHelpers,e.raycaster,e.sharedAssets,e.requestRender,this.onExit)}connect(){let e=[];if(this.eventContext.scene.traverseEntity(i=>{i instanceof vD&&e.push(i)}),this._textInputs=e,e.length===0)return;let{domElement:t}=this.eventContext;t.addEventListener("pointerdown",this._onMouseDownFocusIn),this.textInputManager.connect();let r=this.textInputManager.createInput();document.body.appendChild(r),r.style.display="none",r.addEventListener("keyup",this._onCaretUpdate),r.addEventListener("keydown",this._onCaretUpdate),r.addEventListener("beforeinput",this._onCaretUpdate),r.addEventListener("paste",this._onCaretUpdate),r.addEventListener("cut",this._onCaretUpdate),r.addEventListener("select",this._onCaretUpdate),r.addEventListener("selectstart",this._onCaretUpdate)}disconnect(){let e=this.textInputManager.htmlInput,{domElement:t}=this.eventContext;t.removeEventListener("pointerdown",this._onMouseDownFocusIn),e==null||e.removeEventListener("keyup",this._onCaretUpdate),e==null||e.removeEventListener("keydown",this._onCaretUpdate),e==null||e.removeEventListener("beforeinput",this._onCaretUpdate),e==null||e.removeEventListener("paste",this._onCaretUpdate),e==null||e.removeEventListener("cut",this._onCaretUpdate),e==null||e.removeEventListener("select",this._onCaretUpdate),e==null||e.removeEventListener("selectstart",this._onCaretUpdate),this._textInputs.forEach(r=>{let i=rF(r.data.geometry,this.eventContext.sharedAssets.data);r.textGeometry.setText(i)}),t.removeEventListener("pointerdown",this._onMouseDown,!1),t.removeEventListener("pointerup",this._onMouseUp,!1),t.removeEventListener("pointermove",this._onMouseMove,!1),window.addEventListener("keydown",this._onKeyPress),this.eventContext.renderer.sceneHelpersOnTop=void 0,this.eventContext.renderer.pipeline.disableHelpers(),this.textInputManager.disconnect()}focusOnTextInput(e){this.textInputManager.focus(e),this.textInputManager.onTextMaterialChanged();let t=this.textInputManager.htmlInput;if(!t||e===null)return;this.textInputManager.updateTextInputStyles(),this.eventContext.renderer.sceneHelpersOnTop=this.sceneHelpers,this.eventContext.renderer.pipeline.enableHelpers(),this.textInputManager.isDragging=!1;let r=rF(e.textGeometry.userData.parameters,this.eventContext.sharedAssets.data);t.value=r,t.setSelectionRange(0,0),this.textInputManager.helper.show(e),t.style.display="block",t.addEventListener("input",this._onTextEdit),this.textInputManager.updatePlane();let{domElement:i}=this.eventContext;i.removeEventListener("pointerdown",this._onMouseDownFocusIn),i.addEventListener("pointerdown",this._onMouseDown,!1),i.addEventListener("pointerup",this._onMouseUp,!1),i.addEventListener("pointermove",this._onMouseMove,!1),window.addEventListener("keydown",this._onKeyPress)}},K5e=class{constructor(e,t,r,i,n){this.publish=e,this.controlsManager=t,this.animationControls=r,this.eventContext=i,this.sharedVariables=n,this.isEnabled=!1,this.activateCount=0,this.needsMouse=!1,this.needsRaycast=!1,this.onTouchMovePreventScroll=a=>{let o=window.parent!==window,s=document.documentElement.scrollHeight>document.documentElement.clientHeight||document.documentElement.scrollWidth>document.documentElement.clientWidth;(a.touches.length>1||this.preventTouchScroll||o===!1&&s===!1)&&a.preventDefault()},this.onMouseWheelPreventScroll=a=>{this.preventScroll&&a.preventDefault()},this.onMouseMove=a=>{this.eventContext.sharedAssets.mouseProperty={...this.getMousePosition(a),pressed:a.buttons>0}},this.onMouseDown=a=>{this.eventContext.sharedAssets.mouseProperty={...this.getMousePosition(a),pressed:!0}},this.onMouseUp=a=>{this.eventContext.sharedAssets.mouseProperty={...this.getMousePosition(a),pressed:!1}},this.getMousePosition=a=>{var c;let{domRect:o}=this.eventContext,{pageX:s,pageY:l}=((c=a.touches)==null?void 0:c.length)>0?a.touches[0]:a;return{x:s-(o.left+window.scrollX),y:l-(o.top+window.scrollY)}},this.stopRaycast=e.stopRaycast,this.preventScroll=e.preventScroll,this.preventTouchScroll=e.preventTouchScroll,this.hideCursor=e.hideCursor,this.requestRender=i.requestRender}activate(){if(this.isEnabled)return;this.isEnabled=!0,this.initializeActionsDependentStates(),this.needsMouse&&(this.eventContext.domElement.addEventListener("pointermove",this.onMouseMove),this.eventContext.domElement.addEventListener("pointerdown",this.onMouseDown)),this.handlers={Spline:new EFe(this.eventContext),VariableChange:new a5e(this.eventContext,this.sharedVariables,this,this.needsMouse,this.needsRaycast),API:new j5e(this.eventContext,this),WEBHOOK:new H5e(this.eventContext,this),Conditional:new zFe(this.eventContext,this),Start:new i5e(this.eventContext,this),Basic:new PFe(this.eventContext,this,this.needsRaycast),MouseHover:new ZFe(this.eventContext,this),Scroll:new t5e(this.eventContext,this),Follow:new WFe(this.eventContext,this),DragDrop:new NFe(this.eventContext,this),LookAt:new XFe(this.eventContext),Resize:new U5e(this.eventContext,this),Textfields:new X5e(this.eventContext,this)};let{page:e,domElement:t}=this.eventContext;this.hideCursor&&(t.style.cursor="none"),e.traverseEntity(r=>{r.addEventListener("requestRender",this.requestRender)}),Object.values(this.handlers).forEach(r=>r.connect()),t.addEventListener("wheel",this.onMouseWheelPreventScroll),t.addEventListener("touchmove",this.onTouchMovePreventScroll),this.activateCount++}deactivate(){var r;if(!this.isEnabled)return;this.isEnabled=!1,this.eventContext.domElement.removeEventListener("pointermove",this.onMouseMove),this.eventContext.domElement.removeEventListener("pointerdown",this.onMouseDown),this.eventContext.domElement.removeEventListener("pointerup",this.onMouseUp),this.eventContext.sharedAssets.mouseProperty=null,this.eventContext.sharedAssets.raycastProperty=null;let{page:e,domElement:t}=this.eventContext;t.style.cursor="",Object.values(this.handlers).forEach(i=>i.disconnect()),(r=this.controlsManager.gameControl)==null||r.disposeActions(),this.controlsManager.disconnectEvents(),e.traverseEntity(i=>{i.removeEventListener("requestRender",this.requestRender),i.destroyedInAction=!1}),t.removeEventListener("touchmove",this.onTouchMovePreventScroll),t.removeEventListener("wheel",this.onMouseWheelPreventScroll),this.animationControls.onExitPlayMode()}get isPaused(){return this.isEnabled}pause(){this.deactivate()}resume(){this.activate()}reset(){this.deactivate(),this.activate(),this.controlsManager.page.updateMatrixWorld(!0),this.controlsManager.rebuildBVH()}updateUseWindowEvents(e){let t=this.isEnabled;t&&this.deactivate(),this.eventContext.useWindowEvents=e,t&&this.activate()}initializeActionsDependentStates(){let e=this.eventContext.sharedAssets;e.resetDynamicVariablePlayState();let t=r=>{if(r.data.type==="Conditional"&&(r.data.ifActions.forEach(t),r.data.elseActions.forEach(t)),r.data.type==="Conditional"||r.data.type==="SetVariable")for(let i of r.data.type==="Conditional"?r.data.condition:r.data.expression)"id"in i&&Array.isArray(i.id)&&(i.id[0]==="mouse"&&(this.needsMouse=!0),i.id[0]==="raycast"&&(this.needsRaycast=!0));r.data.type==="DynamicVariablePlay"&&r.data.variableId!==""&&(r.data.mode==="Play"||r.data.mode==="PlayPause"||r.data.mode==="Toggle")&&e.setDynamicVariablePlayState(r.data.variableId,"Stopped")};this.eventContext.page.traverseEntity(r=>{var i;if((i=r.data)!=null&&i.events.length)for(let n of r.data.events)if(n.data.type==="VariableChange"&&(n.data.variableId==="mouseProperty"&&(this.needsMouse=!0),n.data.variableId==="raycastProperty"&&(this.needsRaycast=!0)),n.data.type==="Conditional")for(let a of["inActions","outActions"])n.data[a].forEach(t);else if(n.data.type==="DragDrop")for(let a of["drag","drop"])n.data.dragDropActions[a].forEach(t);else if(n.data.type==="GameControl")for(let a of["idle","move","jump","run"])n.data.gameActions[a].forEach(t);else if(n.data.type==="Resize")for(let a of n.data.breakpoints)a.data.actions.forEach(t);else n.data.type==="LookAt"||n.data.type==="API"||n.data.actions.forEach(t)})}},Q5e=class{constructor(e,t,r,i,n){this._aspect=1,this.enableResponsive=!1,this._renderer=e,this._camera=t,this._frameSize=new ye().copy(r),this._editorSize=new ye().copy(i),this._aspect=t.aspect,this._fov=n??t.fov}set frameSize(e){this._frameSize.copy(e)}updateRenderer(){!this._renderer||this._renderer.setSize(this._frameSize.x,this._frameSize.y)}updateViewport(){if(!this._renderer||!this._camera||this._camera.cameraType!=="PerspectiveCamera")return;let e=this._frameSize.x,t=this._frameSize.y,r=this._editorSize.y;this._aspect=e/t,t<=r&&(this._camera.zoom*=r/t),this._renderer.setViewport(0,0,e,t)}updateCamera(e=!0){if(this._camera)if(this._camera.cameraType==="PerspectiveCamera"){let t=this._frameSize.y,r=this._editorSize.y,i=this._fov;if(e&&t>r){let n=Z5e(t,1080,2160,1,15)/100;i*=t/r,i*=1-n}this._camera.aspect=this._aspect,this._camera.fov=i,this._camera.updateProjectionMatrix()}else this._camera.setViewplaneSize(this._frameSize.x,this._frameSize.y,this.enableResponsive)}setCamera(e){this._camera=e,this._aspect=e.aspect,this._fov=e.fov}revert(){let e=window.innerWidth,t=window.innerHeight;this._renderer&&(this._renderer.setViewport(0,0,e,t),this._renderer.setSize(e,t)),this._camera&&(this._camera.aspect=e/t,this._camera.fov=this._fov,this._camera.setViewplaneSize(e,t,this.enableResponsive),this._camera.updateProjectionMatrix())}};function Z5e(e,t,r,i,n){return(e-t)/(r-t)*(n-i)+i}var J5e=class{get sharedAssets(){return this.shared}constructor(e,t={},r=!0){this.shared=new aD(e.shared,t,!0,r),this.scene=new bD(e.scene,this.sharedAssets),this.shared.setEntityOpContext({scene:this.scene,shared:this.shared})}reset(e,t){this.scene.clearScene(),this.sharedAssets.reset(e.shared),this.scene.resetAfterClear(e.scene,this.sharedAssets)}resetPersonalCameraFromDocumentData(){for(let e of this.scene.children)e instanceof Pn&&!e.uiScene&&e.personalCamera.updateState(e.data.camera,{scene:this.scene,shared:this.shared})}dispose(){this.scene.dispose(),this.shared.dispose()}gc(){this.shared.geometryCache.startGc(),this.shared.geometryCache2.startGc(),this.scene.traverseEntity(e=>{e instanceof ma&&e.markGeometryAsReachable(this.shared)}),this.shared.geometryCache.endGc(),this.shared.geometryCache2.endGc()}},eNe=class{constructor({x:e=10,y:t=10}){this._startTime=0;let r=document.getElementById("spe-perfs");r?this.element=r:(this.element=document.createElement("div"),document.body.appendChild(this.element),this.element.style.position="absolute",this.element.style.zIndex="10000",this.element.style.fontFamily="monospace",this.element.style.background="black",this.element.style.color="white",this.element.style.padding="10px",this.element.style.opacity="0.5",this.element.style.fontSize="11px",this.element.setAttribute("id","spe-perfs")),this.element.style.left=`${e}px`,this.element.style.top=`${t}px`}dispose(){var e;(e=this.element.parentElement)==null||e.removeChild(this.element)}start(){this._startTime=performance.now()}end(){let e=performance.now()-this._startTime;this.element.innerHTML=e.toFixed(3)+" ms"}};function tNe(e){let t;if(e.index)for(let r=0;r<e.index.array.length;r+=3)t=e.index.array[r],e.index.array[r]=e.index.array[r+2],e.index.array[r+2]=t}function kv(e){return e instanceof _g?"SubdivObject":e.geometry.type==="NonParametricGeometry"?"NonParametric":"Mesh"}function rNe(e,t){let r={};return e.traverseEntity(i=>{var l;if(!i.visible||!(i instanceof Ra)||i.type!=="Mesh"||Array.isArray(i.material)||i.states&&Object.keys(i.states).length)return;let n=i.parent;for(;n;){if(n instanceof Ra&&i.states&&Object.keys(i.states).length)return;n=n.parent}let a=i.material.uuid,o=t.shared.materials[a];if(o){if(!ea.isMergable(o))return}else{let c=(l=t.scene.objects.get(i.uuid))==null?void 0:l.data;if(c&&"material"in c&&typeof c.material!="string"){if(!ea.isMergable(c.material))return;a=ea.getHash(c.material)}}r[a]||(r[a]={});let s=r[a][kv(i)];if(s){if(s.push(i),i.cloner)for(let c of i.cloner.children)s.push(c)}else if(r[a][kv(i)]=[i],i.cloner)for(let c of i.cloner.children)r[a][kv(i)].push(c)}),r}function iNe(e){let t=0;return Object.values(e).forEach(r=>{Object.values(r).forEach(i=>{let n=i.length;n>t&&(t=n)})}),t}function nNe(e,t){let r=rNe(t,e),i=iNe(r),n=new Array(i),a=0,o=new Array(i),s=0,l=new Array(i),c=0,d=new Array(i),u=0;for(let[h,f]of Object.entries(r))for(let p of Object.values(f)){if(s=0,c=0,p.forEach(m=>{m instanceof Ra&&(o[s++]=m.geometry.clone(),l[c++]=m)}),c<2)continue;for(let m=0;m<c;m++)l[m].updateWorldMatrix(!0,!1),o[m].applyMatrix4(l[m].matrixWorld),l[m].matrixWorld.determinant()<0&&tNe(o[m]);let v=Pu(o.slice(0,s),!1);if(v){let m;switch(h){case"SubdivObject":{console.warn("Turning subdiv object into mesh"),m=new Di(v,l[0].material);break}default:{m=new Di(v,l[0].material);break}}m.castShadow=l[0].castShadow,m.receiveShadow=l[0].receiveShadow,t.add(m);let g=y=>{u=0;for(let b of y)b.children&&g(b.children),b instanceof Ra&&(Array.isArray(b.material)||r[b.material.uuid]&&r[b.material.uuid][kv(b)]&&r[b.material.uuid][kv(b)].length>1||(d[u++]=b));for(let b=0;b<u;b++)t.attach(d[b])};for(let y=0;y<c;y++){let b=l[y];g(b.children),n[a++]=b}}}for(let h=0;h<a;h++)n[h].removeFromParent()}var aNe=fc(Ime(),1),oNe=new ye;function sNe(e){let t="The Spline Runtime only accepts .splinecode files that are generated from Spline export panel.";e.endsWith(".spline")?console.warn(t+" The .spline files are only meant to be used by the Editor."):e.endsWith(".splinecode")||console.warn(t)}var lNe=class{constructor(e,{renderOnDemand:t,renderMode:r="auto"}={}){this._viewportMode=1,this._viewportWidth=window.innerWidth,this._viewportHeight=window.innerHeight,this._proxyObjectCache=new Map,this._variablesCache=new Map,this._isPaused=!1,this._renderRequested=!1,this._skipRender=!1,this.time=performance.now(),this.dt=0,this.currentTAAFrame=0,this.disposed=!1,this._requestRenderAutoMode=()=>{this._skipRender=!1},this.requestRender=()=>{this._renderRequested=!0},this.render=i=>{var n,a,o,s,l,c,d,u,h,f,p,v,m;if(this.time=i,this._lastTime&&(this.dt=this.time-this._lastTime),this._lastTime=this.time,(n=this._perfs)==null||n.start(),!this._renderer){(a=this._perfs)==null||a.end();return}if(!this._isPaused&&(this.renderMode==="manual"&&!this._renderRequested||this.renderMode==="auto"&&this._skipRender)){(o=this._perfs)==null||o.end();return}if(this._renderRequested=!1,this._skipRender=!0,this._controls&&(this._skipRender=this._controls.update(this.dt)),this._eventManager&&((s=this._eventManager.handlers)!=null&&s.Start.hasVideoAction||(l=this._eventManager.handlers)!=null&&l.Basic.hasVideoAction||(c=this._eventManager.handlers)!=null&&c.Conditional.hasVideoAction)&&(this._skipRender=!1),(d=this._animationControls)==null||d.update(this.dt),this._skipRender?(this.currentTAAFrame++,this.currentTAAFrame<32?this._skipRender=!1:this.currentTAAFrame=0):this.currentTAAFrame=0,(u=this._scene)==null||u.traverseVisibleEntity(g=>{g.type==="ParticleSystem"&&(g.update(this.dt),this._skipRender=!1)}),this._scene&&this._scene.activeCamera!==this._camera&&(this._camera=this._scene.activeCamera),(h=this._eventManager)!=null&&h.isEnabled&&(((f=this._eventManager.handlers)==null?void 0:f.Follow).onAnimationFrameDamping(),((p=this._eventManager.handlers)==null?void 0:p.LookAt).onAnimationFrameDamping(),((v=this._eventManager.handlers)==null?void 0:v.DragDrop).onAnimationFrameDamping()),this._scene&&this._camera){if(this._scene.pathConstraints.applyConstraints(this._scene),this._renderer.sceneTransitionTimeRemaining>0){this._renderer.sceneTransitionTimeRemaining-=this.dt;let g=1-this._renderer.sceneTransitionTimeRemaining/this._renderer.sceneTransitionDuration;this._renderer.pipeline.sceneTransitionPass.uniforms.mixRatio.value=g,this._skipRender=!1}else this._renderer.pipeline.sceneTransitionFromTexture=null;this._renderer.renderSplineScene(this._scene,this._camera)}this.canvas.dispatchEvent(this._renderedEvent),(m=this._perfs)==null||m.end()},this._resize=i=>{var n,a,o,s,l,c,d,u,h,f;if(this._renderer){if(this._viewportMode===1&&this._frameView&&(this._frameView.frameSize=oNe.set(this._viewportWidth,this._viewportHeight)),i){let p=this._viewportWidth,v=this._viewportHeight;this._renderer.setSize(p-1,v-1,!1),this._renderer.setSize(p,v,!1)}else this._renderer.setSize(this._viewportWidth,this._viewportHeight,!1);if(this._camera=(n=this._scene)==null?void 0:n.activeCamera,(d=this._scene)==null||d.updateViewPlaneSize(((o=(a=this._frameView)==null?void 0:a.frameSize)==null?void 0:o.x)??this._viewportWidth,((l=(s=this._frameView)==null?void 0:s.frameSize)==null?void 0:l.y)??this._viewportHeight,((c=this._frameView)==null?void 0:c.enableResponsive)??!1),this._camera){let p=Object.values(((u=this._data)==null?void 0:u.frames)??{})[0].preset??"fullscreen";(h=this._frameView)==null||h.setCamera(this._camera),(f=this._frameView)==null||f.updateCamera(p!=="fullscreen"),this._camera.cameraType==="PerspectiveCamera"&&(this._camera.aspect=this._viewportWidth/this._viewportHeight),this._camera.updateProjectionMatrix()}this.eventManager&&(this.eventManager.eventContext.domRect=this.canvas.getBoundingClientRect()),this._requestRenderAutoMode()}},this._debouncedResize=PP(this._resize,10),this._onScroll=i=>{this.eventManager&&(this.eventManager.eventContext.domRect=this.canvas.getBoundingClientRect())},this.canvas=e,this.renderMode=t?"auto":r,this._renderedEvent=new CustomEvent("rendered",{bubbles:!0}),Object.defineProperty(this._renderedEvent,"target",{writable:!1,value:this}),window.location.search.includes("perfs")&&(this._perfs=new eNe({x:10,y:10})),zTe(e)}async load(e,t,r){sNe(e),this.disposed=!1;let i=await(await fetch(e,r)).arrayBuffer();await this.start(i,{variables:t})}async start(e,{interactive:t=!0,variables:r}={}){var l,c,d,u;if(this.disposed)return;let i=await k5e(e);this._data=i;let n=L5e(i);i.version&&(0,aNe.default)(i.version,"1.9.21")>0&&console.warn("Your .splinecode file is more recent than the library. Please upgrade @splinetool/runtime to the latest version."),await Promise.all([n.length&&I5e(),EB(i)&&xOe(),_Ie(i)&&vOe(),vg.physicsEnabled(i.scene.objects)&&NTe(),CB(i)&&tIe(),r4(i)&&MBe(),JRe(i)&&ZRe(),qB(i)&&bLe(),g5e(i)&&BTe()].filter(Boolean)),n.length&&await B5e(n),(l=this._eventManager)==null||l.deactivate(),(c=this._controls)==null||c.deactivate(),(d=this._scene)==null||d.dispose();let a=new J5e(i);if(a.resetPersonalCameraFromDocumentData(),this._scene=a.scene,this._sharedAssetsManager=a.sharedAssets,this._camera=this._scene.activeCamera,window.location.search.includes("merge-geometries")){let h=performance.now();nNe(i,a.scene);let f=performance.now();console.log("Merged geometries in ",f-h," ms")}EB(i)&&this._scene.traverse(h=>{Yl(h)&&h.recomputeBoolean()}),this._sharedAssetsManager.setRequestRender(()=>{var h;this._requestRenderAutoMode(),(h=this._scene)==null||h.traverse(f=>{f instanceof ns&&f.pendingMediaLoad&&f.update()})}),(u=this._scene)==null||u.traverse(h=>{h.type==="ParticleSystem"&&(h.wakeUp(),h.data.autoPlay?h.start():h.stop())});let o=Object.keys(i.shared.fonts).map(h=>this._sharedAssetsManager.getFont(h).loadingPromise);if(Promise.all(o).then(()=>{a.scene.markNeedsUpdateRendererDirty(),this._requestRenderAutoMode()}),CB(i)&&E5e(i)&&await Promise.all(o),qB(i)){let h=[];this._scene.traverseEntity(f=>{(f instanceof ha||f instanceof Pn)&&f.uiCanvas&&h.push(f.uiCanvas)}),await Promise.all(h.map(f=>f.promise))}this._scene.rewriteEventsBeforeGoToPlayMode(),RD(this._scene.activePage,this._sharedAssetsManager),this._renderer||(this._renderer=new aLe({canvas:this.canvas,antialias:!1,alpha:!0,stencil:!1,depth:!1,powerPreference:"high-performance"}),this._renderer.hdTransmission=i.scene.publish.hdTransmission===!0,this._renderer.setPixelRatio(window.devicePixelRatio),this._renderer.pipeline.enableUIOverlay(),this._renderer.pipeline.addEventListener("smaaloaded",this._requestRenderAutoMode)),r4(i)&&this._scene.initializeSplatViewer(),i.scene.blueNoiseTextureData!==void 0&&this._renderer.pipeline.updateBlueNoiseTexture(i.scene.blueNoiseTextureData);let s=Object.values(i.frames)[0];if(this._frameView?this._frameView.setCamera(this._camera):(s.preset==="fullscreen"?(this._viewportMode=1,this.canvas.style.display="block",this.canvas.parentElement&&(this._viewportWidth=this.canvas.parentElement.clientWidth||300,this.canvas.style.width="100%"),this.canvas.parentElement&&(this._viewportHeight=this.canvas.parentElement.clientHeight||150,this.canvas.style.height="100%")):(this._viewportMode=2,this._viewportWidth=s.size[0],this._viewportHeight=s.size[1],this.canvas.style.width=`${this._viewportWidth}px`,this.canvas.style.height=`${this._viewportHeight}px`),this._renderer.setSize(this._viewportWidth,this._viewportHeight,!1),this._frameView=new Q5e(this._renderer,this._camera,new ye(this._viewportWidth,this._viewportHeight),new ye(window.innerWidth,window.innerHeight)),this._frameView.enableResponsive=(s.allowResponsive??!1)&&s.preset==="fullscreen"),t){let h=new AFe(this._renderer,this.data.scene.publish,this._scene,()=>this._scene.activeCamera,this._sharedAssetsManager,this._requestRenderAutoMode,!0,s);this._scene.updateMatrixWorld(!0),this._controls=new T5e(h),this._animationControls=new D5e(this._scene,this._requestRenderAutoMode),this._eventManager=new K5e(i.scene.publish,this._controls,this._animationControls,h,i.shared.variables),this._eventManager.activate(),this._controls.activate(this._eventManager)}this._resize(),this._scene.activePage.data.postprocessing.depthOfField.enabled&&Promise.all(this._sharedAssetsManager.getImageLoadPromises()).then(()=>{this._resize(!0)}),r!==void 0&&this.setVariables(r),this.dt===0&&(this.render(performance.now()),setTimeout(()=>{var h;(h=this._renderer)==null||h.setAnimationLoop(this.render)},0)),this._resizeObserverTimeout=setTimeout(()=>{!this._resizeObserver&&this.canvas.parentElement&&(this._resizeObserver=new ResizeObserver(()=>{this._viewportWidth=this.canvas.clientWidth,this._viewportHeight=this.canvas.clientHeight,this._debouncedResize()}),this._resizeObserver.observe(this.canvas.parentElement))},300),document.addEventListener("scroll",this._onScroll)}setVariables(e){if(this._data!==void 0){let t=Object.entries(e);for(let[r,i]of t)this.setVariable(r,i)}}setVariable(e,t){var i;let r=this._getVariableByName(e);if(r&&!("dynamicVariableType"in r.data)){let n=t;typeof r.data.value=="number"?n=typeof t=="number"?t:typeof t=="boolean"?t===!0?1:0:parseFloat(t):typeof r.data.value=="boolean"?n=typeof t=="number"?!!t:typeof t=="boolean"?t:t.toLocaleLowerCase()==="false"?!1:!!t:typeof r.data.value!="string"&&r.data.value.textValue!==void 0&&(n=t.toString());let a=typeof n=="string"?{textValue:n}:n;(i=this._sharedAssetsManager)==null||i.updateVariable(r.id,a),this.requestRender(),this._requestRenderAutoMode()}else r===void 0?console.warn(`No variable named ${e} was found in your Spline file. Make sure to create it from Spline editor.`):"dynamicVariableType"in r.data&&console.warn(`Dynamic variables like ${e} cannot be updated from code.`)}getVariables(){let e={};return this._data&&this._data.shared.variables.forEach(t=>{e[t.data.name]===void 0&&(e[t.data.name]=this._getVariableValue(this._sharedAssetsManager.getVariable(t.id)))}),e}getVariable(e){let t=this._getVariableByName(e);if(t){let r=this._sharedAssetsManager.getVariable(t.id);return this._getVariableValue(r)}}_getVariableValue(e){return typeof e!="string"&&ta.isTextValue(e)?ta.getDisplayedValue(e):e}_getVariableByName(e){if(this._data){if(this._variablesCache.has(e))return this._variablesCache.get(e);let t=this._data.shared.variables.find(r=>r.data.name===e);return t&&this._variablesCache.set(e,t),t}}findObjectById(e){var r;let t=(r=this._scene)==null?void 0:r.getObjectByProperty("uuid",e);return this._createProxyObject(t)}findObjectByName(e){var r;let t=(r=this._scene)==null?void 0:r.getObjectByName(e);return this._createProxyObject(t)}getAllObjects(){var t;let e=[];return(t=this._scene)==null||t.traverseEntity(r=>{if(r.uuid!==Zp&&!this._scene.isInvisibleObjects(r)&&!(r instanceof Pn)){let i=this._createProxyObject(r);i&&e.push(i)}}),e}getSplineEvents(){var e,t;return((t=(e=this._eventManager)==null?void 0:e.handlers)==null?void 0:t.Spline).splineEvents}emitEvent(e,t){var r;(r=this.findObjectById(t)||this.findObjectByName(t))==null||r.emitEvent(e)}emitEventReverse(e,t){var r;(r=this.findObjectById(t)||this.findObjectByName(t))==null||r.emitEventReverse(e)}addEventListener(e,t){this.canvas.addEventListener(e,t)}removeEventListener(e,t){this.canvas.removeEventListener(e,t)}setZoom(e){var t,r;((t=this._controls)==null?void 0:t.orbitControls)instanceof QW&&((r=this._controls)==null||r.orbitControls.setZoom(e))}get eventManager(){return this._eventManager}get controls(){return this._controls}setSize(e,t){this._viewportWidth=e,this._viewportHeight=t,this._viewportMode=2,this._resize()}setBackgroundColor(e){var o;let{r:t,g:r,b:i,a:n}={r:0,g:0,b:0,a:1},a=new ia(t,r,i,n);try{a.setStyle(e)}catch{console.error("This is not a valid css color",e)}(o=this._scene)==null||o.activePage.setBackgroundColor(a),this._requestRenderAutoMode()}dispose(){var e,t,r,i,n,a,o;this.disposed=!0,(e=this._eventManager)==null||e.deactivate(),(t=this._scene)==null||t.dispose(),(r=this._sharedAssetsManager)==null||r.dispose(),this._proxyObjectCache.forEach(s=>{kz.unsubscribe(s)}),this._variablesCache.clear(),(i=this._renderer)==null||i.setAnimationLoop(null),(n=this._renderer)==null||n.dispose(),this._renderer=void 0,(a=this._sharedAssetsManager)==null||a.dispose(),this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=void 0),this._resizeObserverTimeout!==void 0&&clearTimeout(this._resizeObserverTimeout),this.canvas.style.width="",this.canvas.style.height="",this.canvas.removeAttribute("width"),this.canvas.removeAttribute("height"),this._frameView&&(this._frameView=void 0),(o=this._controls)==null||o.deactivate(),this.dt=0,kTe(this.canvas),document.removeEventListener("scroll",this._onScroll)}get isStopped(){return this._isPaused}stop(){var e,t,r;this._isPaused||((e=this._renderer)==null||e.setAnimationLoop(null),this._isPaused=!0,(t=this._eventManager)==null||t.pause(),(r=this._controls)!=null&&r.orbitControls&&(this._controls.orbitControls.enabled=!1))}play(){var e,t,r;!this._isPaused||(this._isPaused=!1,(e=this._eventManager)==null||e.resume(),(t=this._controls)!=null&&t.orbitControls&&(this._controls.orbitControls.enabled=!0),(r=this._renderer)==null||r.setAnimationLoop(this.render))}setGlobalEvents(e){var t;(t=this._eventManager)==null||t.updateUseWindowEvents(e)}get data(){return this._data}_createProxyObject(e){var n;if(e==null)return;if(this._proxyObjectCache.has(e.uuid))return this._proxyObjectCache.get(e.uuid);let t;e.traverseAncestors(a=>{a instanceof Pn&&(t=a.name)});let r={name:e.name,uuid:e.uuid,visible:e.visible,intensity:e.intensity,position:e.position,rotation:e.rotation,scale:e.scale,type:e.data.type,page:t,parentUuid:e.parent instanceof Pn||e instanceof bD||(n=e.parent)==null?void 0:n.uuid,emitEvent(a){e.dispatchEvent({type:"userEvent",eventName:a})},emitEventReverse(a){e.dispatchEvent({type:"userEvent",eventName:a,reverse:!0})}},i=kz(r,(a,o)=>{var s;typeof e[a]!="object"&&((s=Object.getOwnPropertyDescriptor(e,a))!=null&&s.writable)&&(e[a]=o),this._requestRenderAutoMode(),e.updateMatrix()});return this._proxyObjectCache.set(e.uuid,i),i}setUIWasmUrl(e){xH.skiaWasmUrl=e}};const cNe={class:"w-full h-full"},dNe=Ve({__name:"Spline",props:{url:{type:String,default:""},class:{type:String,default:""}},setup(e,{emit:t}){const r=e,i=t,n=ge(),a=()=>{const o=new lNe(n.value);o.load(r.url).then(()=>{i("loaded",o)})};return Or(async()=>{a()}),(o,s)=>(ft(),Pt("div",cNe,[st("canvas",{class:Do(["canvas-3d",r.class]),ref_key:"ref3d",ref:n},null,2)]))}}),uNe={class:"main"},hNe={class:"container"},fNe={class:"content"},pNe=Ve({__name:"WaterCard",props:{to:{type:String,default:"/"},header:{type:String,default:"01"},title:{type:String,default:"Read More"},color:{type:String,default:"#ff0f5b"},class:{type:String,default:""}},setup(e){const t=e;return(r,i)=>{const n=Od("RouterLink");return ft(),Pt("div",uNe,[st("div",hNe,[st("div",{class:Do(["drop size-72 3xl:size-96 shadow-fancy-1",t.class]),style:tp(`--clr:${t.color};`)},[st("div",fNe,[st("h2",null,mi(t.header),1),st("p",null,[il(r.$slots,"default",{},void 0,!0)]),Be(n,{to:t.to},{default:tt(()=>[Pr(mi(t.title),1)]),_:1},8,["to"])])],6)])])}}}),iF=ul(pNe,[["__scopeId","data-v-4236aaae"]]),mNe={class:"fixed top-0 left-0 right-0 h-[8vh] pt-3 px-3 shadow-sm"},vNe={class:"flex flex-col py-16 md:flex-row inset-0 h-screen bg-gradient-to-r from-zinc-100 to-neutral-500"},gNe={class:"flex flex-col flex-1"},yNe={class:"flex-1 flex justify-center items-center"},bNe={class:"flex-1 flex justify-center items-center"},xNe={class:"flex-1 hidden md:flex justify-center items-center"},wNe={class:"size-[32rem]"},SNe=Ve({__name:"HomeView",setup(e){const t=ge(!1),r=ge(""),i=()=>{window.matchMedia("(min-width: 1920px)").matches?r.value="3xl":window.matchMedia("(min-width: 1536px)").matches?r.value="2xl":window.matchMedia("(min-width: 1280px)").matches?r.value="xl":window.matchMedia("(min-width: 1024px)").matches?r.value="lg":window.matchMedia("(min-width: 768px)").matches?r.value="md":r.value="sm"};Or(()=>{i(),window.addEventListener("resize",i)}),Eg(()=>{window.removeEventListener("resize",i)});const n=a=>{console.log("spline loaded",a),a._camera.zoom=.15,setTimeout(()=>{t.value=!0},500)};return(a,o)=>(ft(),Pt(pr,null,[st("div",mNe,[Be(V1)]),st("div",vNe,[st("div",gNe,[st("div",yNe,[Be(iF,{to:"/annotator",title:"Annotator",class:Do("rounded-fancy-1")},{default:tt(()=>[Pr(" Clinical Description Annotator ")]),_:1})]),st("div",bNe,[Be(iF,{to:"/fhir",header:"02",title:"DigitalTWINs",class:Do("rounded-fancy-2"),color:"#01b4ff"},{default:tt(()=>[Pr(" DigitalTWINs on FHIR ")]),_:1})])]),st("div",xNe,[Ka(st("div",wNe,[Be(dNe,{url:"https://prod.spline.design/FVZWbQH2B6ndj9UU/scene.splinecode",onLoaded:n,class:Do("rounded-fancy-4 shadow-fancy-2 hover:rounded-full transition-all duration-500 ease-in-out")})],512),[[Gu,t.value]])])])],64))}}),CNe=Qle({history:Mle("/DigitalTWINonFHIRFrontend/"),routes:[{path:"/",name:"home",component:SNe},{path:"/annotator",name:"index-annotator",component:pfe},{path:"/annotator",component:Nhe,children:[{path:"/annotator",name:"home-annotator",component:Yhe},{path:"/measurements",name:"measurements",component:mme},{path:"/primary/test",name:"annotatortest",component:vme}]},{path:"/fhir",component:Hde,children:[{path:"/fhir",name:"home-fhir",component:rce},{path:"/fhir/measurements",name:"fhir-measurements",component:Ihe,children:[{path:"/fhir/measurements/patients",name:"fhir-patients",component:Bhe}]}]}]});function _Ne(e){e.use(CNe).use(Xse)}const JW=BG(jse);_Ne(JW);JW.mount("#app");export{kie as c,kg as g};
